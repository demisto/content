id: playbook0
version: -1
name: Default
description: Default playbook to help classify incoming incidents
starttaskid: "0"
system: true
fromversion: 2.5.0
tasks:
  "0":
    id: "0"
    taskid: 96dbf98e-bc4e-4d21-808f-54cf03241207
    type: start
    task:
      id: 96dbf98e-bc4e-4d21-808f-54cf03241207
      version: -1
      name: start_task
      issystemtask: true
      type: start
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    view: |-
      {
        "position": {
          "x": 1677.5,
          "y": 50
        }
      }
  "2":
    id: "2"
    taskid: 6a0aef28-d546-47af-8947-99f46d77d48a
    type: condition
    task:
      id: 6a0aef28-d546-47af-8947-99f46d77d48a
      version: -1
      name: Is this an email
      scriptName: Exists
      issystemtask: true
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "34"
      "yes":
      - "22"
    scriptarguments:
      key: Label/Email/from
      value: ${incident.labels.Email/from}
    view: |-
      {
        "position": {
          "x": 1677.5,
          "y": 195
        }
      }
  "4":
    id: "4"
    taskid: 610f12ea-ce4f-444c-8dfe-3a4ffb6df6f9
    type: regular
    task:
      id: 610f12ea-ce4f-444c-8dfe-3a4ffb6df6f9
      version: -1
      name: SplunkEmailParser
      scriptName: SplunkEmailParser
      issystemtask: true
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      body: ${incident.labels.Email/html}
      subject: ${incident.labels.Email/subject}
    view: |-
      {
        "position": {
          "x": 1158,
          "y": 712
        }
      }
  "6":
    id: "6"
    taskid: cda168ea-c74d-40b4-89cb-67014f85409d
    type: regular
    task:
      id: cda168ea-c74d-40b4-89cb-67014f85409d
      version: -1
      name: NexposeEmailParser
      scriptName: NexposeEmailParser
      issystemtask: true
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "30"
    view: |-
      {
        "position": {
          "x": 207,
          "y": 807
        }
      }
  "8":
    id: "8"
    taskid: d7ea35bb-e794-4c1a-80d9-24137e2bd9db
    type: regular
    task:
      id: d7ea35bb-e794-4c1a-80d9-24137e2bd9db
      version: -1
      name: Set incident type and playbook to SentinelOne
      scriptName: IncidentSet
      issystemtask: true
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      addLabels: ""
      customFieldName: ""
      customFieldValue: ""
      details: ""
      labels: ""
      name: ""
      owner: ""
      playbook: ""
      severity: ""
      stage: ""
      type: set-to-sentinelone-type
      updatePlaybookForType: "yes"
    view: |-
      {
        "position": {
          "x": 905,
          "y": 865
        }
      }
  "9":
    id: "9"
    taskid: cf75ade9-a303-4814-8d99-6ec9d09fbc02
    type: regular
    task:
      id: cf75ade9-a303-4814-8d99-6ec9d09fbc02
      version: -1
      name: Set type and playbook to Phishing (default type for emails)
      scriptName: IncidentSet
      issystemtask: true
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      addLabels: ""
      customFieldName: ""
      customFieldValue: ""
      details: ""
      labels: ""
      name: ""
      owner: ""
      playbook: ""
      severity: ""
      stage: ""
      type: Phishing
      updatePlaybookForType: "yes"
    view: |-
      {
        "position": {
          "x": 525,
          "y": 1129
        }
      }
  "22":
    id: "22"
    taskid: cedcbabe-7b14-4b7c-843d-60b04f66e9b2
    type: title
    task:
      id: cedcbabe-7b14-4b7c-843d-60b04f66e9b2
      version: -1
      name: Mail Classifier
      issystemtask: true
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "33"
    view: |-
      {
        "position": {
          "x": 695,
          "y": 385
        }
      }
  "23":
    id: "23"
    taskid: 40ab3f30-8252-4f50-8aec-dbcd2f85a1ec
    type: title
    task:
      id: 40ab3f30-8252-4f50-8aec-dbcd2f85a1ec
      version: -1
      name: Classify by Brand
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "27"
    view: |-
      {
        "position": {
          "x": 2005,
          "y": 560
        }
      }
  "26":
    id: "26"
    taskid: 8cb3c6b3-18fd-4814-871c-9f8bd44f3e4d
    type: regular
    task:
      id: 8cb3c6b3-18fd-4814-871c-9f8bd44f3e4d
      version: -1
      name: QRadar Classifier
      scriptName: QRadarClassifier
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "30"
    view: |-
      {
        "position": {
          "x": 2608,
          "y": 865
        }
      }
  "27":
    id: "27"
    taskid: 8bf6dc34-f9e0-4502-829a-995cd5c7332f
    type: condition
    task:
      id: 8bf6dc34-f9e0-4502-829a-995cd5c7332f
      version: -1
      name: Get Brand
      description: Prints text to war room
      scriptName: Print
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "30"
      QRadar:
      - "26"
      Trend Micro:
      - "29"
      Vectra:
      - "28"
    scriptarguments:
      value: ${incident.labels.Brand}
    view: |-
      {
        "position": {
          "x": 2005,
          "y": 692
        }
      }
  "28":
    id: "28"
    taskid: a4bf35f1-1ba6-41cf-8ecf-963e4342abff
    type: regular
    task:
      id: a4bf35f1-1ba6-41cf-8ecf-963e4342abff
      version: -1
      name: 'Vectra Classifier '
      scriptName: VectraClassifier
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "30"
    view: |-
      {
        "position": {
          "x": 2193,
          "y": 902
        }
      }
  "29":
    id: "29"
    taskid: 37ef2cf4-f0f1-4f02-8083-c8e9355c3eb7
    type: regular
    task:
      id: 37ef2cf4-f0f1-4f02-8083-c8e9355c3eb7
      version: -1
      name: Trendmicro Classifier
      scriptName: TrendMicroClassifier
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "30"
    view: |-
      {
        "position": {
          "x": 1713,
          "y": 865
        }
      }
  "30":
    id: "30"
    taskid: e3e6429a-96e9-4e6a-8fe2-2882c8033ba4
    type: regular
    task:
      id: e3e6429a-96e9-4e6a-8fe2-2882c8033ba4
      version: -1
      name: Manually decide playbook
      description: Could not decide incident type automatically, please set playbook
        Manually
      type: regular
      iscommand: false
      brand: ""
    view: |-
      {
        "position": {
          "x": 1677.5,
          "y": 1108
        }
      }
  "33":
    id: "33"
    taskid: 34ab0da0-429c-41a3-85a4-246bbcd982d6
    type: condition
    task:
      id: 34ab0da0-429c-41a3-85a4-246bbcd982d6
      version: -1
      name: Get Email Sender
      description: Prints text to war room
      scriptName: Print
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "9"
      NEXPOSE_SENDER@PLACEHOLDER.COM:
      - "6"
      SENTINELONE_SENDER@PLACEHOLDER.COM:
      - "8"
      SPLUNK_SENDER@PLACEHOLDER.COM:
      - "4"
    scriptarguments:
      value: ${incident.labels.Email/from}
    view: |-
      {
        "position": {
          "x": 542,
          "y": 545
        }
      }
  "34":
    id: "34"
    taskid: 5ae67300-d763-4671-8f0c-78a34bb2bb41
    type: condition
    task:
      id: 5ae67300-d763-4671-8f0c-78a34bb2bb41
      version: 1
      name: Does incident include "Brand" label?
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      scriptName: Exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "30"
      "yes":
      - "23"
    scriptarguments:
      value: ${incident.labels.Brand}
    view: |-
      {
        "position": {
          "x": 1779,
          "y": 394
        }
      }
view: |-
  {
    "linkLabelsPosition": {
      "27_30_#default#": 0.21,
      "2_34_#default#": 0.62,
      "33_4_SPLUNK_SENDER@PLACEHOLDER.COM": 0.62,
      "33_6_NEXPOSE_SENDER@PLACEHOLDER.COM": 0.56,
      "33_8_SENTINELONE_SENDER@PLACEHOLDER.COM": 0.63,
      "33_9_#default#": 0.64,
      "34_30_#default#": 0.16
    },
    "paper": {
      "dimensions": {
        "height": 1174,
        "width": 2781,
        "x": 207,
        "y": 50
      }
    }
  }
