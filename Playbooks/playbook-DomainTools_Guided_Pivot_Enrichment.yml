id: DomainTools_Guided_Pivot_Enrichment
version: -1
name: DomainTools_Guided_Pivot_Enrichment
starttaskid: "0"
description: ""
tasks:
  "0":
    id: "0"
    taskid: cbcfa0db-280f-420e-81ac-b3ac83e18b2c
    type: start
    task:
      id: cbcfa0db-280f-420e-81ac-b3ac83e18b2c
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ""
    nexttasks:
      '#none#':
      - "16"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 700,
          "y": -530
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "2":
    id: "2"
    taskid: cef6726f-bf56-422c-8390-f2ec859b30cf
    type: regular
    task:
      id: cef6726f-bf56-422c-8390-f2ec859b30cf
      version: -1
      name: SetIndicatorTableData
      scriptName: SetIndicatorTableData
      type: regular
      iscommand: false
      brand: ""
      description: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      domain:
        simple: ${inputs.Domain}
      domaintools_data:
        simple: ${DomainTools.PivotedDomains}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 790,
          "y": 830
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "3":
    id: "3"
    taskid: 2619fc26-ca1e-459b-8fdc-49c48214e5b3
    type: title
    task:
      id: 2619fc26-ca1e-459b-8fdc-49c48214e5b3
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 790,
          "y": 1120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "4":
    id: "4"
    taskid: 762ade16-800b-4b5c-8170-b96baf37c12a
    type: condition
    task:
      id: 762ade16-800b-4b5c-8170-b96baf37c12a
      version: -1
      name: Auto Pivot Email Check
      type: condition
      iscommand: false
      brand: ""
      description: ""
    nexttasks:
      '#default#':
      - "2"
      technical_email:
      - "5"
    separatecontext: false
    conditions:
    - label: technical_email
      condition:
      - - operator: isExists
          left:
            value:
              simple: DomainTools.Domains.Identity.TechnicalContact.Email
            iscontext: true
      - - operator: lessThan
          left:
            value:
              simple: DomainTools.Domains.Identity.TechnicalContact.Email.count
            iscontext: true
          right:
            value:
              simple: "500"
    view: |-
      {
        "position": {
          "x": -320,
          "y": 160
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "5":
    id: "5"
    taskid: 0ace8960-21be-4de2-8a98-092a29641fe8
    type: regular
    task:
      id: 0ace8960-21be-4de2-8a98-092a29641fe8
      version: -1
      name: Email Pivot
      script: DomainTools Iris|||domaintoolsiris-pivot
      type: regular
      iscommand: true
      brand: DomainTools Iris
      description: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      email:
        simple: ${DomainTools.Domains.Identity.TechnicalContact.Email.value}
      ip: {}
      mailserver_host: {}
      nameserver_host: {}
      nameserver_ip: {}
      ssl_hash: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -300,
          "y": 360
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "6":
    id: "6"
    taskid: 960b3774-fc65-4a74-893e-9781b3fec620
    type: regular
    task:
      id: 960b3774-fc65-4a74-893e-9781b3fec620
      version: -1
      name: IP Pivot
      script: DomainTools Iris|||domaintoolsiris-pivot
      type: regular
      iscommand: true
      brand: DomainTools Iris
      description: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      email: {}
      ip:
        simple: ${DomainTools.Domains.Hosting.IPAddresses.address.value}
      mailserver_host: {}
      nameserver_host: {}
      nameserver_ip: {}
      ssl_hash: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 100,
          "y": 360
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "7":
    id: "7"
    taskid: abf8b5aa-4baf-4b6e-8a7c-55398121dfd1
    type: regular
    task:
      id: abf8b5aa-4baf-4b6e-8a7c-55398121dfd1
      version: -1
      name: NameServer IP Pivot
      script: DomainTools Iris|||domaintoolsiris-pivot
      type: regular
      iscommand: true
      brand: DomainTools Iris
      description: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      email: {}
      ip: {}
      mailserver_host: {}
      nameserver_host: {}
      nameserver_ip:
        simple: ${DomainTools.Domains.NameServers.ip.value}
      ssl_hash: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 550,
          "y": 350
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "8":
    id: "8"
    taskid: 555460f1-466e-4bc3-8360-ed706fc5ab28
    type: regular
    task:
      id: 555460f1-466e-4bc3-8360-ed706fc5ab28
      version: -1
      name: SSL Hash Pivot
      script: DomainTools Iris|||domaintoolsiris-pivot
      type: regular
      iscommand: true
      brand: DomainTools Iris
      description: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      email: {}
      ip: {}
      mailserver_host: {}
      nameserver_host: {}
      nameserver_ip: {}
      ssl_hash:
        simple: ${DomainTools.Domains.Hosting.SSLCertificate.hash.value}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1000,
          "y": 350
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "9":
    id: "9"
    taskid: 3e76371b-4184-44ec-8a90-29627f99a5a0
    type: regular
    task:
      id: 3e76371b-4184-44ec-8a90-29627f99a5a0
      version: -1
      name: NameServer HostName Pivot
      script: DomainTools Iris|||domaintoolsiris-pivot
      type: regular
      iscommand: true
      brand: DomainTools Iris
      description: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      email: {}
      ip: {}
      mailserver_host: {}
      nameserver_host:
        simple: ${DomainTools.Domains.NameServers.host.value}
      nameserver_ip: {}
      ssl_hash: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1460,
          "y": 340
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "10":
    id: "10"
    taskid: 0e897443-3fe5-491c-8c56-c772a8c6e6b3
    type: regular
    task:
      id: 0e897443-3fe5-491c-8c56-c772a8c6e6b3
      version: -1
      name: MailServer HostName
      script: DomainTools Iris|||domaintoolsiris-pivot
      type: regular
      iscommand: true
      brand: DomainTools Iris
      description: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      email: {}
      ip: {}
      mailserver_host:
        simple: ${DomainTools.Domains.Hosting.MailServers.host.value}
      nameserver_host: {}
      nameserver_ip: {}
      ssl_hash: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1900,
          "y": 350
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "11":
    id: "11"
    taskid: 4e4f85ca-45e5-45fc-8b4f-81b38d90e3db
    type: condition
    task:
      id: 4e4f85ca-45e5-45fc-8b4f-81b38d90e3db
      version: -1
      name: Auto Pivot IP Check
      type: condition
      iscommand: false
      brand: ""
      description: ""
    nexttasks:
      '#default#':
      - "2"
      ip:
      - "6"
    separatecontext: false
    conditions:
    - label: ip
      condition:
      - - operator: isExists
          left:
            value:
              simple: DomainTools.Domains.Hosting.IPAddresses.address
            iscontext: true
      - - operator: lessThan
          left:
            value:
              simple: DomainTools.Domains.Hosting.IPAddresses.address.count
            iscontext: true
          right:
            value:
              simple: "500"
    view: |-
      {
        "position": {
          "x": 90,
          "y": 160
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "12":
    id: "12"
    taskid: 132b40ed-9f57-4024-8b43-4f04db08b9d6
    type: condition
    task:
      id: 132b40ed-9f57-4024-8b43-4f04db08b9d6
      version: -1
      name: Auto Pivot NameServer IP Check
      type: condition
      iscommand: false
      brand: ""
      description: ""
    nexttasks:
      '#default#':
      - "2"
      nameserver_ip:
      - "7"
    separatecontext: false
    conditions:
    - label: nameserver_ip
      condition:
      - - operator: isExists
          left:
            value:
              simple: DomainTools.Domains.NameServers.ip
            iscontext: true
      - - operator: lessThan
          left:
            value:
              simple: DomainTools.Domains.NameServers.ip.count
            iscontext: true
          right:
            value:
              simple: "500"
    view: |-
      {
        "position": {
          "x": 550,
          "y": 160
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "13":
    id: "13"
    taskid: 6168e778-58a8-4083-862f-d5b0a8e3db72
    type: condition
    task:
      id: 6168e778-58a8-4083-862f-d5b0a8e3db72
      version: -1
      name: Auto Pivot SSL Hash Check
      type: condition
      iscommand: false
      brand: ""
      description: ""
    nexttasks:
      '#default#':
      - "2"
      ssl_hash:
      - "8"
    separatecontext: false
    conditions:
    - label: ssl_hash
      condition:
      - - operator: isExists
          left:
            value:
              simple: DomainTools.Domains.Hosting.SSLCertificate.hash
            iscontext: true
      - - operator: lessThan
          left:
            value:
              simple: DomainTools.Domains.Hosting.SSLCertificate.hash.count
            iscontext: true
          right:
            value:
              simple: "500"
    view: |-
      {
        "position": {
          "x": 1000,
          "y": 170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "14":
    id: "14"
    taskid: af772c32-296c-4daf-8618-68de89c9e549
    type: condition
    task:
      id: af772c32-296c-4daf-8618-68de89c9e549
      version: -1
      name: Auto Pivot NameServer HostName Check
      type: condition
      iscommand: false
      brand: ""
      description: ""
    nexttasks:
      '#default#':
      - "2"
      nameserver_host:
      - "9"
    separatecontext: false
    conditions:
    - label: nameserver_host
      condition:
      - - operator: isExists
          left:
            value:
              simple: DomainTools.Domains.NameServers.host
            iscontext: true
      - - operator: lessThan
          left:
            value:
              simple: DomainTools.Domains.NameServers.host.count
            iscontext: true
          right:
            value:
              simple: "500"
    view: |-
      {
        "position": {
          "x": 1450,
          "y": 180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "15":
    id: "15"
    taskid: 653061c0-8714-4a25-8845-2e3a75774346
    type: condition
    task:
      id: 653061c0-8714-4a25-8845-2e3a75774346
      version: -1
      name: Auto Pivot MailServer HostName Check
      type: condition
      iscommand: false
      brand: ""
      description: ""
    nexttasks:
      '#default#':
      - "2"
      mailserver_host:
      - "10"
    separatecontext: false
    conditions:
    - label: mailserver_host
      condition:
      - - operator: isExists
          left:
            value:
              simple: DomainTools.Domains.Hosting.MailServers.host
            iscontext: true
      - - operator: lessThan
          left:
            value:
              simple: DomainTools.Domains.Hosting.MailServers.host.count
            iscontext: true
          right:
            value:
              simple: "500"
    view: |-
      {
        "position": {
          "x": 1910,
          "y": 180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "16":
    id: "16"
    taskid: 451e56c5-031f-4865-85be-ae178e62b620
    type: regular
    task:
      id: 451e56c5-031f-4865-85be-ae178e62b620
      version: -1
      name: DomainTools Profile Domain
      script: DomainTools Iris|||domain
      type: regular
      iscommand: true
      brand: DomainTools Iris
      description: ""
    nexttasks:
      '#none#':
      - "12"
      - "11"
      - "4"
      - "13"
      - "14"
      - "15"
    scriptarguments:
      domain:
        simple: ${inputs.domain_name}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 710,
          "y": -200
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1715,
        "width": 2610,
        "x": -320,
        "y": -530
      }
    }
  }
inputs:
- key: domain_name
  value:
    simple: ${Domain.Name}
  required: false
  description: ""
outputs: []
tests:
- DomainTools Iris - Test
fromversion: 4.1.0