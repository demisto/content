id: Detonate File - Generic
version: -1
name: Detonate File - Generic
fromversion: "4.0.0"
description: Detonate file through active integrations that support file detonation
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 73eadb3f-61fa-41d5-87b3-6d6a67a04e63
    type: start
    task:
      id: 73eadb3f-61fa-41d5-87b3-6d6a67a04e63
      version: -1
      name: ""
      description: Playbook start point
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "8"
      - "10"
      - "9"
      - "11"
      - "12"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 695,
          "y": 50
        }
      }
    note: false
  "3":
    id: "3"
    taskid: fcaa5290-1c7a-448a-84e6-87662adf9a2e
    type: title
    task:
      id: fcaa5290-1c7a-448a-84e6-87662adf9a2e
      version: -1
      name: Done
      description: Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 695,
          "y": 370
        }
      }
    note: false
  "8":
    id: "8"
    taskid: 48accd3a-0c84-484c-87ad-f8e83acd168b
    type: playbook
    task:
      id: 48accd3a-0c84-484c-87ad-f8e83acd168b
      version: -1
      name: Detonate File - JoeSecurity
      description: |-
        Detonates one or more files using the Joe Security - Joe Sandbox integration.
        Returns relevant reports to the War Room and file reputations to the context data.
        All file types are supported.
      playbookName: Detonate File - JoeSecurity
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      File:
        complex:
          root: inputs.File
      comments: {}
      internet-access:
        simple: "True"
      interval:
        simple: "1"
      report-file-type: {}
      systems: {}
      timeout:
        simple: "15"
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
    view: |-
      {
        "position": {
          "x": 480,
          "y": 195
        }
      }
    note: false
  "9":
    id: "9"
    taskid: 9b2b52ec-bd2d-4249-803b-b68009f24234
    type: playbook
    task:
      id: 9b2b52ec-bd2d-4249-803b-b68009f24234
      version: -1
      name: ATD - Detonate File
      playbookName: ATD - Detonate File
      type: playbook
      iscommand: false
      brand: ""
      description: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      File:
        complex:
          root: inputs.File
      interval:
        simple: "1"
      playbook:
        simple: default
      private: {}
      source: {}
      tags: {}
      timeout:
        simple: "15"
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 195
        }
      }
    note: false
  "10":
    id: "10"
    taskid: ae898390-2466-46de-8ea7-8d78e2fd0f04
    type: playbook
    task:
      id: ae898390-2466-46de-8ea7-8d78e2fd0f04
      version: -1
      name: Detonate File - ThreatGrid
      playbookName: Detonate File - ThreatGrid
      type: playbook
      iscommand: false
      brand: ""
      description: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      File:
        complex:
          root: inputs.File
      FileName:
        simple: file-detonated-via-demisto
      interval:
        simple: "1"
      playbook:
        simple: default
      private: {}
      source: {}
      tags: {}
      timeout:
        simple: "15"
      vm: {}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
    view: |-
      {
        "position": {
          "x": 910,
          "y": 195
        }
      }
    note: false
  "11":
    id: "11"
    taskid: 46bc4d02-5636-4098-8772-3b7ac7c798cb
    type: playbook
    task:
      id: 46bc4d02-5636-4098-8772-3b7ac7c798cb
      version: -1
      name: CrowdStrike Falcon Sandbox - Detonate file
      description: Detonate one or more files using the CrowdStrike integration. This
        playbook returns relevant reports to the War Room and file reputations to
        the context data. The detonation supports the following file types - EXE,
        DLL, JAR, JS, PDF, DOC, DOCX, RTF, XLS, PPT, PPTX, XML, ZIP, VBN, SEP, XZ,
        GZ, BZ2, TAR, MHTML, SWF, LNK, URL, MSI, JTD, JTT, JTDC, JTTC, HWP, HWT, HWPX,
        BAT, HTA, PS1, VBS, WSF, JSE, VBE, CHM
      playbookName: CrowdStrike Falcon Sandbox - Detonate file
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      EnvironmentID:
        simple: "100"
      File:
        complex:
          root: inputs.File
      Interval:
        simple: "5"
      Timeout:
        simple: "30"
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
    view: |-
      {
        "position": {
          "x": 50,
          "y": 195
        }
      }
    note: false
  "12":
    id: "12"
    taskid: f5308484-aab1-47dc-82a7-f883a4ab8a34
    type: playbook
    task:
      id: f5308484-aab1-47dc-82a7-f883a4ab8a34
      version: -1
      name: WildFire - Detonate file
      description: "-"
      playbookName: WildFire - Detonate file
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      File:
        complex:
          root: inputs.File
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
    view: |-
      {
        "position": {
          "x": 1750,
          "y": 195
        }
      }
    note: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 385,
        "width": 2080,
        "x": 50,
        "y": 50
      }
    }
  }
inputs:
- key: EntryID
  value:
    complex:
      root: File
      accessor: EntryID
  required: false
  description: Entry ID of file to be detonated
- key: File
  value:
    complex:
      root: File
  required: false
  description: File object of file to be detonated
outputs:
- contextPath: File
  description: The File's object
  type: unknown
- contextPath: File.MD5
  description: MD5 of the file
  type: string
- contextPath: File.Name
  description: Filename (only in case of report type=json)
  type: string
- contextPath: File.SHA1
  description: SHA1 of the file
  type: string
- contextPath: File.SHA256
  description: SHA256 of the file
  type: string
- contextPath: File.Size
  description: File size (only in case of report type=json)
  type: number
- contextPath: File.Type
  description: File type e.g. "PE" (only in case of report type=json)
  type: string
- contextPath: File.Malicious
  description: The File malicious description
  type: unknown
- contextPath: File.Malicious.Description
  description: For malicious files, the reason for the vendor to make the decision
  type: string
- contextPath: File.Malicious.Vendor
  description: For malicious files, the vendor that made the decision
  type: string
- contextPath: DBotScore
  description: The Indicator's object
  type: unknown
- contextPath: DBotScore.Indicator
  description: The indicator we tested
  type: string
- contextPath: DBotScore.Score
  description: The actual score
  type: number
- contextPath: DBotScore.Type
  description: The type of the indicator
  type: string
- contextPath: DBotScore.Vendor
  description: Vendor used to calculate the score
  type: string
- contextPath: IP.Address
  description: IP's relevant to the sample
  type: string
- contextPath: DBotScore.Malicious.Vendor
  description: Vendor used to calculate the score
  type: string
- contextPath: DBotScore.Malicious.Detections
  description: The sub analysis detection statuses
  type: string
- contextPath: DBotScore.Malicious.SHA1
  description: The SHA1 of the file
  type: string
- contextPath: Sample.State
  description: The sample state
- contextPath: Sample.ID
  description: The sample ID
- contextPath: Joe.Analysis.WebID
  description: Web ID
  type: string
- contextPath: Joe.Analysis.SampleName
  description: Sample Data, could be a file name or URL
  type: string
- contextPath: Joe.Analysis.Status
  description: Analysis Status
  type: string
- contextPath: Joe.Analysis.Comments
  description: Analysis Comments
  type: string
- contextPath: Joe.Analysis.Time
  description: Submitted Time
  type: date
- contextPath: Joe.Analysis.Runs
  description: Sub-Analysis Information
  type: unknown
- contextPath: Joe.Analysis.Result
  description: Analysis Results
  type: string
- contextPath: Joe.Analysis.Errors
  description: Raised errors during sampling
  type: unknown
- contextPath: Joe.Analysis.Systems
  description: Analysis OS
  type: unknown
- contextPath: Joe.Analysis.MD5
  description: MD5 of analysis sample
  type: string
- contextPath: Joe.Analysis.SHA1
  description: SHA1 of analysis sample
  type: string
- contextPath: Joe.Analysis.SHA256
  description: SHA256 of analysis sample
  type: string
- contextPath: InfoFile.Name
  description: FileName of the report file
  type: string
- contextPath: InfoFile.EntryID
  description: The EntryID of the report file
  type: string
- contextPath: InfoFile.Size
  description: File Size
  type: number
- contextPath: InfoFile.Type
  description: File type e.g. "PE"
  type: string
- contextPath: InfoFile.Info
  description: Basic information of the file
  type: string
- contextPath: File.Extension
  description: File Extension
  type: string
- contextPath: InfoFile
  description: The report file's object
  type: unknown
releaseNotes: "-"