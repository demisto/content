id: e99cae7c-1a1e-49d5-8a6b-4e8d6e54a4d2
version: 9
name: Yara Scan
description: This playbook takes a Yara rule / rules and file entryIDs as inputs and
  then scans the files using the Yara rule(s).
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 696b10e1-4901-473e-8a76-2663cd270a23
    type: start
    task:
      id: 696b10e1-4901-473e-8a76-2663cd270a23
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "1":
    id: "1"
    taskid: 30a70837-1371-4119-8760-64eda9c655d7
    type: regular
    task:
      id: 30a70837-1371-4119-8760-64eda9c655d7
      version: -1
      name: YaraScan
      description: Performs a Yara scan against a file
      scriptName: YaraScan
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      entryIDs:
        simple: ${inputs.entryIDs}
      yaraRule:
        simple: ${inputs.yaraRule}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 275,
        "width": 380,
        "x": 450,
        "y": 50
      }
    }
  }
inputs:
- key: entryIDs
  value: {}
  required: true
  description: A list or single entryID of a file or files to be scanned.
- key: yaraRule
  value: {}
  required: true
  description: The Yara rule to use to scan the file(s) with.
outputs:
- contextPath: Yara
- contextPath: Yara.Filename
  description: The filename of the file that was scanned
  type: string
- contextPath: Yara.HasError
  description: Whether or not there was an error when performing the scan
  type: boolean
- contextPath: Yara.HasMatch
  description: Whether or not the file matched any of the rules.
  type: boolean
- contextPath: Yara.entryID
  description: The entry ID of the file being scanned.
  type: string
- contextPath: Yara.fileID
  description: The file ID of the file being scanned.
  type: string
- contextPath: Yara.MatchCount
  description: The count of ruls that matched the file.
  type: number
- contextPath: Matches
- contextPath: Matches.Meta
  description: Metadata about the rule (as defined in the rule itself)
- contextPath: Matches.Namespace
  description: The namespace defined in the rule
  type: string
- contextPath: Matches.RuleName
  description: The rule name that matched
  type: string
- contextPath: Matches.Strings
  description: A list of strings that the rule matched
  type: string
- contextPath: Matches.Tags
  description: A list of tags that are defined in the rule
- contextPath: Errors
  description: A list of errors that occurred during the scan
