id: Frontline.Cloud - Scan Asset Not Recently Scanned
version: -1
name: Frontline.Cloud - Scan Asset Not Recently Scanned
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 88b9b394-6c20-4f43-89f0-2577b3b86c16
    type: start
    task:
      id: 88b9b394-6c20-4f43-89f0-2577b3b86c16
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "1":
    id: "1"
    taskid: 666db8ce-232c-400f-8f49-1096833be613
    type: regular
    task:
      id: 666db8ce-232c-400f-8f49-1096833be613
      version: -1
      name: frontline-get-assets (scanned within last 60 days)
      description: Pull asset information from FrontlineVM
      script: Digital Defense Inc. FrontlineVM|||frontline-get-assets
      type: regular
      iscommand: true
      brand: Digital Defense Inc. FrontlineVM
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      hostname: {}
      ip_address:
        simple: ${incident.details}
      ipAddress:
        simple: ${incident.details}
      label_name: {}
      labelName: {}
      scanned_within_last:
        simple: "60"
      scannedWithinLast:
        simple: "60"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "2":
    id: "2"
    taskid: 02689001-949f-4075-8cc8-590a7cfe6e9e
    type: condition
    task:
      id: 02689001-949f-4075-8cc8-590a7cfe6e9e
      version: -1
      name: Has been scanned within the last 60 days?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "4"
      "yes":
      - "3"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: FrontlineVM.Hosts
            iscontext: true
    view: |-
      {
        "position": {
          "x": 450,
          "y": 420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "3":
    id: "3"
    taskid: 642bf18c-816d-4564-890e-959a15f980db
    type: regular
    task:
      id: 642bf18c-816d-4564-890e-959a15f980db
      version: -1
      name: Asset has already been scanned.
      description: Prints text to war room (Markdown supported)
      scriptName: Print
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      value:
        simple: |-
          The following asset has already been scanned within the last 60 days:

          ${FrontlineVM.Hosts}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 160,
          "y": 630
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "4":
    id: "4"
    taskid: 68c26db0-6bf7-48a2-828c-a828c7e17613
    type: condition
    task:
      id: 68c26db0-6bf7-48a2-828c-a828c7e17613
      version: -1
      name: Asset has not been scanned.
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, no is returned.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      No, do not perform scan:
      - "5"
      Yes, perform scan:
      - "6"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 710,
          "y": 630
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to:
        simple: Administrator
      subject:
        simple: Perform Scan on asset
      body:
        simple: "The following asset has not been scanned within the past 60 days.\nPerform
          scan on asset: \n\n${incident.details}"
      methods:
      - email
      format: ""
      bcc: null
      cc: null
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
      replyOptions:
      - Yes, perform scan
      - No, do not perform scan
  "5":
    id: "5"
    taskid: bf811638-a03f-4103-86a8-6db566430572
    type: regular
    task:
      id: bf811638-a03f-4103-86a8-6db566430572
      version: -1
      name: Will not perform scan
      description: Prints text to war room (Markdown supported)
      scriptName: Print
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      value:
        simple: "Admin chose not to perform a scan on asset: \n\n${incident.details}"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 420,
          "y": 840
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "6":
    id: "6"
    taskid: 4e2754cd-6550-483e-84db-6e65661ab638
    type: regular
    task:
      id: 4e2754cd-6550-483e-84db-6e65661ab638
      version: -1
      name: Performing scan
      script: Digital Defense Inc. FrontlineVM|||frontline-scan-asset
      type: regular
      iscommand: true
      brand: Digital Defense Inc. FrontlineVM
    scriptarguments:
      ip_address:
        simple: ${incident.details}
      scan_policy: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 880,
          "y": 830
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 885,
        "width": 1100,
        "x": 160,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
