id: vulnerability_handling_-_qualys_-_add _ustom_fields_to_default_layout
version: -1
name: Vulnerability Handling - Qualys - Add custom fields to default layout
fromversion: 3.6.0
description: Add information about the vulnerability and asset from the "Vulnerability
  Handling - Qualys" playbook data to the default "Vulnerability" layout.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 7c0a6113-ccc4-4b67-8ae0-5b6ebed288fb
    type: start
    task:
      id: 7c0a6113-ccc4-4b67-8ae0-5b6ebed288fb
      version: -1
      name: ""
      description: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "15"
      - "17"
      - "18"
      - "19"
      - "20"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1062.5,
          "y": 50
        }
      }
  "2":
    id: "2"
    taskid: 2115cdff-522d-4787-822c-39684be05294
    type: title
    task:
      id: 2115cdff-522d-4787-822c-39684be05294
      version: -1
      name: Done
      description: ""
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1062.5,
          "y": 545
        }
      }
  "3":
    id: "3"
    taskid: 8e4fc911-843f-47ff-8a54-1b3efb8470b8
    type: regular
    task:
      id: 8e4fc911-843f-47ff-8a54-1b3efb8470b8
      version: -1
      name: Set "Vulnerability Category"
      description: Populate the custom field.
      scriptName: IncidentSet
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      addLabels: {}
      customFieldName:
        simple: vulnerabilitycategory
      customFieldValue:
        complex:
          root: inputs.Qualys
          accessor: Category
          transformers:
          - operator: general.uniq
          - operator: general.join
            args:
              separator:
                value:
                  simple: ','
      details: {}
      labels: {}
      name: {}
      owner: {}
      playbook: {}
      severity: {}
      stage: {}
      type: {}
      updatePlaybookForType: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 370
        }
      }
  "8":
    id: "8"
    taskid: e041a676-db54-4695-8ecd-34befbfbc79c
    type: regular
    task:
      id: e041a676-db54-4695-8ecd-34befbfbc79c
      version: -1
      name: Set "Signature"
      description: Populate the custom field.
      scriptName: IncidentSet
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      addLabels: {}
      customFieldName:
        simple: signature
      customFieldValue:
        complex:
          root: inputs.Qualys
          accessor: Title
          transformers:
          - operator: general.join
            args:
              separator:
                value:
                  simple: ', '
      details: {}
      labels: {}
      name: {}
      owner: {}
      playbook: {}
      severity: {}
      stage: {}
      type: {}
      updatePlaybookForType: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1400,
          "y": 370
        }
      }
  "9":
    id: "9"
    taskid: 7c7cb394-27b8-470b-8503-fca384538827
    type: regular
    task:
      id: 7c7cb394-27b8-470b-8503-fca384538827
      version: -1
      name: Set "Bugtraq"
      description: Populate the custom field.
      scriptName: IncidentSet
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      addLabels: {}
      customFieldName:
        simple: bugtraq
      customFieldValue:
        complex:
          root: inputs.Qualys
          accessor: Bugtraq.ID
          transformers:
          - operator: general.join
            args:
              separator:
                value:
                  simple: ', '
      details: {}
      labels: {}
      name: {}
      owner: {}
      playbook: {}
      severity: {}
      stage: {}
      type: {}
      updatePlaybookForType: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1850,
          "y": 370
        }
      }
  "11":
    id: "11"
    taskid: b79b6492-0fe9-47ea-8712-25e67bb05384
    type: regular
    task:
      id: b79b6492-0fe9-47ea-8712-25e67bb05384
      version: -1
      name: Set "CVE"
      description: Populate the custom field.
      scriptName: IncidentSet
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      addLabels: {}
      customFieldName:
        simple: cve
      customFieldValue:
        complex:
          root: inputs.CVE
          accessor: ID
          transformers:
          - operator: general.uniq
          - operator: general.join
            args:
              separator:
                value:
                  simple: ','
      details: {}
      labels: {}
      name: {}
      owner: {}
      playbook: {}
      severity: {}
      stage: {}
      type: {}
      updatePlaybookForType: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 950,
          "y": 370
        }
      }
  "13":
    id: "13"
    taskid: 12f3c186-65f1-41b8-89bb-b2e47b2b358b
    type: regular
    task:
      id: 12f3c186-65f1-41b8-89bb-b2e47b2b358b
      version: -1
      name: Set "CVSS"
      description: Populate the custom field.
      scriptName: IncidentSet
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      addLabels: {}
      customFieldName:
        simple: cvss
      customFieldValue:
        complex:
          root: inputs.CVE
          accessor: CVSS
          transformers:
          - operator: general.join
            args:
              separator:
                value:
                  simple: ',  '
      details: {}
      labels: {}
      name: {}
      owner: {}
      playbook: {}
      severity: {}
      stage: {}
      type: {}
      updatePlaybookForType: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 500,
          "y": 370
        }
      }
  "15":
    id: "15"
    taskid: e23eb213-9603-4c62-8825-9c3fb601e139
    type: condition
    task:
      id: e23eb213-9603-4c62-8825-9c3fb601e139
      version: -1
      name: Is there a valid "Vulnerability Category"?
      description: Check if there’s a "Vulnerability Category" in the playbook inputs.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "3"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: general.isExists
          left:
            value:
              complex:
                root: inputs.Qualys
                accessor: Category
            iscontext: true
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 195
        }
      }
  "17":
    id: "17"
    taskid: 6c1b4f4a-5d12-4d78-81d3-02892cc3ad37
    type: condition
    task:
      id: 6c1b4f4a-5d12-4d78-81d3-02892cc3ad37
      version: -1
      name: Is there a valid "CVSS"?
      description: Check if there’s a "CVSS" in the playbook inputs.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "13"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: general.isExists
          left:
            value:
              complex:
                root: inputs.CVE
                accessor: CVSS
            iscontext: true
    view: |-
      {
        "position": {
          "x": 612.5,
          "y": 195
        }
      }
  "18":
    id: "18"
    taskid: 360bab9f-806f-48c0-8080-fbbbe2efd466
    type: condition
    task:
      id: 360bab9f-806f-48c0-8080-fbbbe2efd466
      version: -1
      name: Is there a valid "CVE"?
      description: Check if there’s a "CVE" in the playbook inputs.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "11"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: general.isExists
          left:
            value:
              complex:
                root: inputs.CVE
                accessor: ID
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1062.5,
          "y": 195
        }
      }
  "19":
    id: "19"
    taskid: 19976cc4-28dd-4594-8972-1c512a7dd3f5
    type: condition
    task:
      id: 19976cc4-28dd-4594-8972-1c512a7dd3f5
      version: -1
      name: Is there a valid "Signature"?
      description: Check if there’s a "Signature" in the playbook inputs.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "8"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: general.isExists
          left:
            value:
              complex:
                root: inputs.Qualys
                accessor: Title
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1512.5,
          "y": 195
        }
      }
  "20":
    id: "20"
    taskid: a3def47b-593f-4a87-8ce5-356ad232dc95
    type: condition
    task:
      id: a3def47b-593f-4a87-8ce5-356ad232dc95
      version: -1
      name: Is there a valid "Bugtraq"?
      description: Check if there’s a "Bugtraq" in the playbook inputs.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "9"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: general.isExists
          left:
            value:
              complex:
                root: inputs.Qualys
                accessor: Bugtraq.ID
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1962.5,
          "y": 195
        }
      }
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 560,
        "width": 2292.5,
        "x": 50,
        "y": 50
      }
    }
  }
inputs:
- key: Qualys
  value:
    complex:
      root: Qualys
  required: false
  description: The Qualys object containing the vulnerability data
- key: CVE
  value:
    complex:
      root: CVE
  required: false
  description: The CVE object containing the vulnerability data
outputs: []
