description: Add information about the vulnerability and asset from the "Vulnerability
  Handling - Qualys" playbook data to the default "Vulnerability" layout.
id: vulnerability_handling_-_qualys_-_add _ustom_fields_to_default_layout
inputs:
- description: The Qualys object containing the vulnerability data
  key: Qualys
  required: false
  value:
    complex:
      root: Qualys
- description: The CVE object containing the vulnerability data
  key: CVE
  required: false
  value:
    complex:
      root: CVE
name: Vulnerability Handling - Qualys - Add custom fields to default layout
outputs: []
starttaskid: "0"
system: true
tasks:
  "0":
    id: "0"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "15"
      - "17"
      - "18"
      - "19"
      - "20"
    note: false
    separatecontext: false
    task:
      brand: ""
      id: 7c0a6113-ccc4-4b67-8ae0-5b6ebed288fb
      iscommand: false
      name: ""
      version: -1
    taskid: 7c0a6113-ccc4-4b67-8ae0-5b6ebed288fb
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 1062.5,
          "y": 50
        }
      }
  "2":
    id: "2"
    ignoreworker: false
    note: false
    separatecontext: false
    task:
      brand: ""
      id: 2115cdff-522d-4787-822c-39684be05294
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 2115cdff-522d-4787-822c-39684be05294
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1062.5,
          "y": 545
        }
      }
  "3":
    id: "3"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    scriptarguments:
      addLabels: {}
      customFieldName:
        simple: vulnerabilitycategory
      customFieldValue:
        complex:
          accessor: Category
          root: inputs.Qualys
          transformers:
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      details: {}
      labels: {}
      name: {}
      owner: {}
      playbook: {}
      severity: {}
      stage: {}
      type: {}
      updatePlaybookForType: {}
    separatecontext: false
    task:
      brand: ""
      description: Populate the custom field.
      id: 8e4fc911-843f-47ff-8a54-1b3efb8470b8
      iscommand: false
      name: Set "Vulnerability Category"
      scriptName: IncidentSet
      type: regular
      version: -1
    taskid: 8e4fc911-843f-47ff-8a54-1b3efb8470b8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 370
        }
      }
  "8":
    id: "8"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    scriptarguments:
      addLabels: {}
      customFieldName:
        simple: signature
      customFieldValue:
        complex:
          accessor: Title
          root: inputs.Qualys
          transformers:
          - args:
              separator:
                value:
                  simple: ', '
            operator: join
      details: {}
      labels: {}
      name: {}
      owner: {}
      playbook: {}
      severity: {}
      stage: {}
      type: {}
      updatePlaybookForType: {}
    separatecontext: false
    task:
      brand: ""
      description: Populate the custom field.
      id: e041a676-db54-4695-8ecd-34befbfbc79c
      iscommand: false
      name: Set "Signature"
      scriptName: IncidentSet
      type: regular
      version: -1
    taskid: e041a676-db54-4695-8ecd-34befbfbc79c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1400,
          "y": 370
        }
      }
  "9":
    id: "9"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    scriptarguments:
      addLabels: {}
      customFieldName:
        simple: bugtraq
      customFieldValue:
        complex:
          accessor: Bugtraq.ID
          root: inputs.Qualys
          transformers:
          - args:
              separator:
                value:
                  simple: ', '
            operator: join
      details: {}
      labels: {}
      name: {}
      owner: {}
      playbook: {}
      severity: {}
      stage: {}
      type: {}
      updatePlaybookForType: {}
    separatecontext: false
    task:
      brand: ""
      description: Populate the custom field.
      id: 7c7cb394-27b8-470b-8503-fca384538827
      iscommand: false
      name: Set "Bugtraq"
      scriptName: IncidentSet
      type: regular
      version: -1
    taskid: 7c7cb394-27b8-470b-8503-fca384538827
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1850,
          "y": 370
        }
      }
  "11":
    id: "11"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    scriptarguments:
      addLabels: {}
      customFieldName:
        simple: cve
      customFieldValue:
        complex:
          accessor: ID
          root: inputs.CVE
          transformers:
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      details: {}
      labels: {}
      name: {}
      owner: {}
      playbook: {}
      severity: {}
      stage: {}
      type: {}
      updatePlaybookForType: {}
    separatecontext: false
    task:
      brand: ""
      description: Populate the custom field.
      id: b79b6492-0fe9-47ea-8712-25e67bb05384
      iscommand: false
      name: Set "CVE"
      scriptName: IncidentSet
      type: regular
      version: -1
    taskid: b79b6492-0fe9-47ea-8712-25e67bb05384
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 950,
          "y": 370
        }
      }
  "13":
    id: "13"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    scriptarguments:
      addLabels: {}
      customFieldName:
        simple: cvss
      customFieldValue:
        complex:
          accessor: CVSS
          root: inputs.CVE
          transformers:
          - args:
              separator:
                value:
                  simple: ',  '
            operator: join
      details: {}
      labels: {}
      name: {}
      owner: {}
      playbook: {}
      severity: {}
      stage: {}
      type: {}
      updatePlaybookForType: {}
    separatecontext: false
    task:
      brand: ""
      description: Populate the custom field.
      id: 12f3c186-65f1-41b8-89bb-b2e47b2b358b
      iscommand: false
      name: Set "CVSS"
      scriptName: IncidentSet
      type: regular
      version: -1
    taskid: 12f3c186-65f1-41b8-89bb-b2e47b2b358b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 500,
          "y": 370
        }
      }
  "15":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Category
                root: inputs.Qualys
          operator: isExists
      label: "yes"
    id: "15"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "3"
    note: false
    separatecontext: false
    task:
      brand: ""
      description: Check if there’s a "Vulnerability Category" in the playbook inputs.
      id: e23eb213-9603-4c62-8825-9c3fb601e139
      iscommand: false
      name: Is there a valid "Vulnerability Category"?
      type: condition
      version: -1
    taskid: e23eb213-9603-4c62-8825-9c3fb601e139
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 195
        }
      }
  "17":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: CVSS
                root: inputs.CVE
          operator: isExists
      label: "yes"
    id: "17"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "13"
    note: false
    separatecontext: false
    task:
      brand: ""
      description: Check if there’s a "CVSS" in the playbook inputs.
      id: 6c1b4f4a-5d12-4d78-81d3-02892cc3ad37
      iscommand: false
      name: Is there a valid "CVSS"?
      type: condition
      version: -1
    taskid: 6c1b4f4a-5d12-4d78-81d3-02892cc3ad37
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 612.5,
          "y": 195
        }
      }
  "18":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: ID
                root: inputs.CVE
          operator: isExists
      label: "yes"
    id: "18"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "11"
    note: false
    separatecontext: false
    task:
      brand: ""
      description: Check if there’s a "CVE" in the playbook inputs.
      id: 360bab9f-806f-48c0-8080-fbbbe2efd466
      iscommand: false
      name: Is there a valid "CVE"?
      type: condition
      version: -1
    taskid: 360bab9f-806f-48c0-8080-fbbbe2efd466
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1062.5,
          "y": 195
        }
      }
  "19":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Title
                root: inputs.Qualys
          operator: isExists
      label: "yes"
    id: "19"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "8"
    note: false
    separatecontext: false
    task:
      brand: ""
      description: Check if there’s a "Signature" in the playbook inputs.
      id: 19976cc4-28dd-4594-8972-1c512a7dd3f5
      iscommand: false
      name: Is there a valid "Signature"?
      type: condition
      version: -1
    taskid: 19976cc4-28dd-4594-8972-1c512a7dd3f5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1512.5,
          "y": 195
        }
      }
  "20":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Bugtraq.ID
                root: inputs.Qualys
          operator: isExists
      label: "yes"
    id: "20"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "9"
    note: false
    separatecontext: false
    task:
      brand: ""
      description: Check if there’s a "Bugtraq" in the playbook inputs.
      id: a3def47b-593f-4a87-8ce5-356ad232dc95
      iscommand: false
      name: Is there a valid "Bugtraq"?
      type: condition
      version: -1
    taskid: a3def47b-593f-4a87-8ce5-356ad232dc95
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1962.5,
          "y": 195
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 560,
        "width": 2292.5,
        "x": 50,
        "y": 50
      }
    }
  }
