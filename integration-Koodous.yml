category: Forensics & Malware Analysis
commonfields:
  id: Koodous
  version: -1
configuration:
- defaultvalue: ""
  display: API Key
  name: APIKey
  required: false
  type: 0
- defaultvalue: https://api.koodous.com/
  display: Server URL
  name: ServerURL
  required: false
  type: 0
description: Check Android app samples (APK) against Koodous API
display: Koodous
image: data:image/png;base64,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
name: Koodous
script:
  commands:
  - arguments:
    - description: The hash of the sample (MD5, SHA1 or SHA256)
      name: hash
      required: true
    description: Check APK sample.
    name: k-check-hash
  runonce: false
  script: |-
    var request = function(method, path, parameters){
        var headers = {'Content-Type': ['application/json']};
        if (params.APIKey){
            headers['Authorization'] = "Token " + params.APIKey;
        }

        var result = http(
            params.serverURL + path + parameters.hash,
            {
                Headers: headers,
                Method: method,
            }
        );

        if (result.StatusCode !== 200) {
            throw 'Failed to perform request ' + path + ', request status code: ' + result.StatusCode;
        }
        return result.Body;
    };
    switch (command) {
        case 'test-module':
            return 'ok';
        case 'k-check-hash':
            return request('GET', 'apks?search=', args);
        default:
    }
  type: javascript
system: true
