category: Data Enrichment & Threat Intelligence
commonfields:
  id: Trend Micro Vision One Commands
  version: -1
name: Trend Micro Vision One Commands
display: Trend Micro Vision One Commands
description: Trend Micro Vision One is a purpose-built threat defense platform that
  provides added value and new benefits beyond XDR solutions, allowing you to see
  more and respond faster. Providing deep and broad extended detection and response(XDR)
  capabilities that collect and automatically correlate data across multiple security
  layers—email, endpoints, servers, cloud workloads, and networks—Trend Micro Vision
  One prevents the majority of attacks with automated protection.
configuration:
- display: Server URL (e.g. https://api.xdr.trendmicro.com)
  name: url
  defaultvalue: https://api.xdr.trendmicro.com
  type: 0
  required: true
  additionalinfo: 'The Base url for the endpoints '
- display: API Key
  name: apikey
  type: 0
  required: true
  additionalinfo: The API token to access data
script:
  script: '-'
  type: python
  commands:
  - name: trendmicro-visionone-add-to-block-list
    arguments:
    - name: valueType
      required: true
      description: 'Enum: "file_sha1" "ip" "domain" "url" "mailbox" block item value
        type'
    - name: targetValue
      required: true
      description: Item value info
    - name: productId
      description: Target product
    - name: description
      description: Action description
    outputs:
    - contextPath: VisionOne.BlockList.actionId
      description: Action id of task adding file SHA-1, IP address, domain, or URL
        object that was added to the User-Defined Suspicious Objects List from block
        list
      type: string
    - contextPath: VisionOne.BlockList.taskStatus
      description: Task Status of adding file SHA-1, IP address, domain, or URL object
        that was added to the User-Defined Suspicious Objects List from block list
      type: string
    description: Adds a file SHA-1, IP address, domain, or URL object to the User-Defined
      Suspicious Objects List, which blocks the objects on subsequent detections
  - name: trendmicro-visionone-remove-from-block-list
    arguments:
    - name: valueType
      required: true
      description: 'Enum: "file_sha1" "ip" "domain" "url" "mailbox" block item value
        type'
    - name: targetValue
      required: true
      description: Item value info
    - name: productId
      description: Target product
    - name: description
      description: Action description
    outputs:
    - contextPath: VisionOne.BlockList.actionId
      description: Action id of task removing file SHA-1, IP address, domain, or URL
        object that was added to the User-Defined Suspicious Objects List from block
        list
      type: string
    - contextPath: VisionOne.BlockList.taskStatus
      description: Task Status of removing file SHA-1, IP address, domain, or URL
        object that was added to the User-Defined Suspicious Objects List from block
        list
      type: string
    description: Removes a file SHA-1, IP address, domain, or URL object that was
      added to the User-Defined Suspicious Objects List using the "Add to block list"
      action
  - name: trendmicro-visionone-quarantine-email-message
    arguments:
    - name: messageId
      required: true
      description: Email message id
    - name: mailBox
      required: true
      description: Email message's mailbox
    - name: messageDeliveryTime
      required: true
      description: Email message's delivery time
    - name: productId
      default: true
      description: Target product
      defaultValue: sca
    - name: description
      description: Action description
    outputs:
    - contextPath: VisionOne.Email.actionId
      description: The Action Id of moving a message from a mailbox to the quarantine
        folder
      type: string
    - contextPath: VisionOne.Email.taskStatus
      description: The status of moving a message from a mailbox to the quarantine
        folder
      type: string
    description: Moves a message from a mailbox to the quarantine folder
  - name: trendmicro-visionone-delete-email-message
    arguments:
    - name: messageId
      required: true
      description: Email message id
    - name: mailBox
      required: true
      description: Email message's mailbox
    - name: messageDeliveryTime
      required: true
      description: Email message's delivery time
    - name: productId
      default: true
      description: Target product
      defaultValue: sca
    - name: description
      description: Action description
    outputs:
    - contextPath: VisionOne.Email.actionId
      description: The action id of deleting a message from a mailbox
      type: string
    - contextPath: VisionOne.Email.taskStatus
      description: The task status of deleting a message from a mailbox
      type: string
    description: Deletes a message from a mailbox
  - name: trendmicro-visionone-isolate-endpoint
    arguments:
    - name: field
      required: true
      description: 'Which field would like to search for agent info, acceptable value:
        hostname/macaddr/ip'
    - name: value
      required: true
      description: Value of particular field
    - name: productId
      required: true
      default: true
      description: Target product
      defaultValue: sao
    - name: description
      description: Action description
    outputs:
    - contextPath: VisionOne.Endpoint_Connection.actionId
      description: The action ID of isolate endpoint task
      type: string
    - contextPath: VisionOne.Endpoint_Connection.taskStatus
      description: 'The task status of isolate endpoint '
      type: string
    description: Disconnects an endpoint from the network (but allows communication
      with the managing Trend Micro server product)
  - name: trendmicro-visionone-restore-endpoint-connection
    arguments:
    - name: field
      required: true
      description: 'Which field would like to search for agent info, acceptable value:
        hostname/macaddr/ip'
    - name: value
      required: true
      description: Value of particular field
    - name: productId
      required: true
      default: true
      description: Target product
      defaultValue: sao
    - name: description
      description: Action description
    outputs:
    - contextPath: VisionOne.Endpoint_Connection.actionId
      description: The action ID of the restore endpoint connection
      type: string
    - contextPath: VisionOne.Endpoint_Connection.taskStatus
      description: The task status of restore endpoint connection
      type: string
    description: Restores network connectivity to an endpoint that applied the "Isolate
      endpoint" action
  - name: trendmicro-visionone-add-objects-to-exception-list
    arguments:
    - name: type
      required: true
      description: Object record type Enum- "domain" "ip" "sha1" "url". 
    - name: value
      required: true
      description: The object value Full and partial matches supported.DOMAIN partial match, (with a wildcard as the subdomain, example, .example.com) IP partial match, (IP range example, 192.168.35.1-192.168.35.254, cidr example, 192.168.35.1/24) URL Partial match, (Supports wildcards 'http://.'', 'https://.'' at beginning, or ''' at the end. Multiple wild cards also supported, such as , https://.example.com/path1/) SHA1 Only full match"
    - name: description
      description: Exception description.
    outputs:
    - contextPath: VisionOne.Exception_List.message
      description: status message success after task completion
      type: string
    - contextPath: VisionOne.Exception_List.status_code
      description: status code of response
      type: string
    - contextPath: VisionOne.Exception_List.total_items
      description: count of item present in exception list
      type: string
    description: Adds domains, file SHA-1 values, IP addresses, or URLs to the Exception
      List and prevents these objects from being added to the Suspicious Object List
  - name: trendmicro-visionone-delete-objects-from-exception-list
    arguments:
    - name: type
      required: true
      description: The object type Enum- "domain" "ip" "sha1" "url".
    - name: value
      required: true
      description: The object value.
    outputs:
    - contextPath: VisionOne.Exception_List.message
      description: status message success after task completion
      type: string
    - contextPath: VisionOne.Exception_List.status_code
      description: status code of response
      type: number
    - contextPath: VisionOne.Exception_List.total_items
      description: count of item present in exception list
      type: string
    description: Deletes domains, file SHA-1 values, IP addresses, or URLs from the
      Exception List.
  - name: trendmicro-visionone-add-objects-to-suspicious-list
    arguments:
    - name: type
      required: true
      description: The Suspicious Object type Enum- "domain" "ip" "sha1" "url".
    - name: value
      required: true
      description: The Suspicious Object value.
    - name: description
      description: The Suspicious Object description info
    - name: scanAction
      description: The Suspicious Object scan action. If you don't use this parameter,
        the scan action specified in default_settings.riskLevel.type will be used
        instead Enum- "block" "log".
    - name: riskLevel
      description: The Suspicious Object risk level. If you don't use this parameter,
        high will be used instead Enum- "high" "medium" "low".
    - name: expiredDay
      description: The Suspicious Object expiry day. If you don't use this parameter,
        the default_settings.expiredDay scan action will be used instead.
    outputs:
    - contextPath: VisionOne.Suspicious_List.message
      description: Status message of adding item to suspicious object list
      type: string
    - contextPath: VisionOne.Suspicious_List.status_code
      description: Response code of adding item to suspicious object list
      type: number
    - contextPath: VisionOne.Suspicious_List.total_items
      description: Number of items present in suspicious object list
      type: number
    description: Adds domains, file SHA-1 values, IP addresses, or URLs to the Suspicious
      Object List.
  - name: trendmicro-visionone-delete-objects-from-suspicious-list
    arguments:
    - name: type
      required: true
      description: The Suspicious Object type Enum- "domain" "ip" "sha1" "url".
    - name: value
      required: true
      description: The value of the Suspicious Object to be deleted from the Suspicious
        Object List.
    outputs:
    - contextPath: VisionOne.Suspicious_List.message
      description: Status message of removing item from suspicious object list
      type: string
    - contextPath: VisionOne.Suspicious_List.status_code
      description: Response code of removing item from suspicious object list
      type: number
    - contextPath: VisionOne.Suspicious_List.total_items
      description: Number of items present in suspicious object list
      type: number
    description: Deletes domains, file SHA-1 values, IP addresses, or URLs from the
      Suspicious Object List
  - name: trendmicro-visionone-terminate-process
    arguments:
    - name: field
      required: true
      description: 'which field would like to search for agent info, acceptable value:
        hostname/macaddr/ip'
    - name: value
      required: true
      description: 'Value of above filed '
    - name: fileSha1
      required: true
      description: file sha1
    - name: productId
      default: true
      description: target product
      defaultValue: sao
    - name: description
      description: action description
    - name: filename
      description: optional file name list for log
    outputs:
    - contextPath: VisionOne.Terminate_Process.actionId
      description: Action Id of the current running task
      type: string
    - contextPath: VisionOne.Terminate_Process.taskStatus
      description: Status of current running task
      type: string
    description: Terminates a process that is running on an endpoint
  - name: trendmicro-visionone-get-file-analysis-status
    arguments:
    - name: taskId
      required: true
      description: Task ID of particular file
    outputs:
    - contextPath: VisionOne.File_Analysis_Status.message
      description: 'status message of file '
      type: string
    - contextPath: VisionOne.File_Analysis_Status.code
      description: code message of file
      type: string
    - contextPath: VisionOne.File_Analysis_Status.task_id
      description: ID to get the sample analysis status.
      type: string
    - contextPath: VisionOne.File_Analysis_Status.task_status
      description: When the status is finished, could check analysis Summary to get
        the analysis result.
      type: string
    - contextPath: VisionOne.File_Analysis_Status.digest
      description: 'The hash value of file submitted '
      type: string
    - contextPath: VisionOne.File_Analysis_Status.analysis_completion_time
      description: Sample analysis completed time.
      type: string
    - contextPath: VisionOne.File_Analysis_Status.risk_level
      description: Risk Level of this sample.
      type: string
    - contextPath: VisionOne.File_Analysis_Status.descritption
      description: Scan result description for NotAnalyzed.
      type: string
    - contextPath: VisionOne.File_Analysis_Status.detection_name_list
      description: Detection name of this sample.
      type: unknown
    - contextPath: VisionOne.File_Analysis_Status.threat_type_list
      description: Threat type of this sample.
    - contextPath: VisionOne.File_Analysis_Status.file_type
      description: File type of this sample.
      type: string
    - contextPath: VisionOne.File_Analysis_Status.report_id
      description: ID used to get the report and suspicious object. Empty means no
        report.
      type: string
    description: Retrieves the status of a submitted file
  - name: trendmicro-visionone-get-file-analysis-report
    arguments:
    - name: reportId
      required: true
      description: file reportId
    - name: type
      required: true
      description: 'Enum: "vaReport" "investigationPackage" "suspiciousObject" report
        type'
    outputs:
    - contextPath: VisionOne.File_Analysis_Report.message
      description: Status message of file report
      type: string
    - contextPath: VisionOne.File_Analysis_Report.code
      description: status code of file report
      type: string
    - contextPath: VisionOne.File_Analysis_Report.type
      description: Suspicious object type
      type: string
    - contextPath: VisionOne.File_Analysis_Report.value
      description: Suspicious object value
      type: string
    - contextPath: VisionOne.File_Analysis_Report.risklevel
      description: Risk Level of suspicious object
      type: string
    - contextPath: VisionOne.File_Analysis_Report.analysisCompletionTime
      description: Analyze time of suspicious object
      type: string
    - contextPath: VisionOne.File_Analysis_Report.expiredTime
      description: Expire time of suspicious object
      type: string
    - contextPath: VisionOne.File_Analysis_Report.rootFileSha1
      description: Sample sha1 generate this suspicious object
      type: string
    description: Retrieves the analysis report, investigation package, or Suspicious
      Object List of a submitted file
  - name: trendmicro-visionone-collect-forensic-file
    arguments:
    - name: field
      required: true
      description: 'Enum: "hostname" "macaddr" "ip" which field would like to search
        for agent info, acceptable value: hostname/macaddr/ip'
    - name: value
      required: true
      description: Value of above field.
    - name: productId
      required: true
      description: 'Product Id of the file. Enum: "sao" "xes" "sds"'
    - name: filePath
      required: true
      description: Path to the file to collect.
    - name: os
      required: true
      description: 'Type of OS. Enum: "windows" "mac" "linux"'
    - name: description
      description: Description of the file.
    outputs:
    - contextPath: VisionOne.Collect_Forensic_File.actionId
      description: Action ID of the particular file.
      type: string
    - contextPath: VisionOne.Collect_Forensic_File.taskStatus
      description: Task status of collected file
      type: string
    description: Compresses a file on an endpoint in a password-protected archive
      and then sends the archive to the XDR service platform
  - name: trendmicro-visionone-download-information-for-collected-forensic-file
    arguments:
    - name: actionId
      required: true
      description: Action Id of file information needed.
    outputs:
    - contextPath: VisionOne.Download_Information_For_Collected_Forensic_File.url
      description: Url of the collected file to download
      type: string
    - contextPath: VisionOne.Download_Information_For_Collected_Forensic_File.expires
      description: 'Expire date of the collected file '
      type: string
    - contextPath: VisionOne.Download_Information_For_Collected_Forensic_File.password
      description: Password of the protected forensic file
      type: string
    - contextPath: VisionOne.Download_Information_For_Collected_Forensic_File.filename
      description: Name of the forensic file
      type: string
    description: Retrieves a URL and other information required to download a collected
      file
  - name: trendmicro-visionone-submit-file-to-sandbox
    arguments:
    - name: fileUrl
      required: true
      description: name of the file to upload the content
    - name: fileName
      required: true
      description: Name of the collected file
    - name: documentPassword
      description: Indicate the password for decrypting the submitted document-type1
        sample.
    - name: archivePassword
      description: 'Indicate the password for decrypting the submitted archive-type1
        sample. '
    outputs:
    - contextPath: VisionOne.Submit_File_to_Sandbox.message
      description: Status message of the file submitted to sandbox.
      type: string
    - contextPath: VisionOne.Submit_File_to_Sandbox.code
      description: status code of the file submitted to sandbox
      type: string
    - contextPath: VisionOne.Submit_File_to_Sandbox.task_id
      description: Task ID of the submitted file
      type: string
    - contextPath: VisionOne.Submit_File_to_Sandbox.digest
      description: The hash value of the file
    description: Submits a file to the sandbox for analysis (Note. For more information
      about the supported file types, see the Trend Micro Vision One Online Help.
      Submissions require credits. Does not require credits in regions where Sandbox
      Analysis has not been officially released.)
  dockerimage: demisto/python3:3.9.9.25564
  runonce: false
  subtype: python3
fromversion: 5.5.0
tests:
- No tests (auto formatted)