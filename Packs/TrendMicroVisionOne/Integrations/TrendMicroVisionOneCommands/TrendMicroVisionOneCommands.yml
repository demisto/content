category: Data Enrichment & Threat Intelligence
commonfields:
  id: Trend Micro Vision One Commands
  version: -1
name: Trend Micro Vision One Commands
display: Trend Micro Vision One Commands
description: Trend Micro Vision One is a purpose-built threat defense platform that
  provides added value and new benefits beyond XDR solutions, allowing you to see
  more and respond faster. Providing deep and broad extended detection and response (XDR)
  capabilities that collect and automatically correlate data across multiple security
  layers—email, endpoints, servers, cloud workloads, and networks—Trend Micro Vision
  One prevents the majority of attacks with automated protection.
configuration:
- display: API URL (e.g. https://api.xdr.trendmicro.com)
  name: url
  defaultvalue: https://api.xdr.trendmicro.com
  type: 0
  required: true
  additionalinfo: The base url for the Vision One API
- display: API Key
  name: apikey
  type: 0
  required: true
  additionalinfo: The API token to access data
script:
  script: '-'
  type: python
  commands:
  - name: trendmicro-visionone-add-to-block-list
    arguments:
    - name: value_type
      required: true
      description: 'The type of object you would like to add to the block list: "file_sha1", "ip", "domain", "url" or "mailbox"'
    - name: target_value
      required: true
      description: The object you would like to add that matches the value-type
    - name: product_id
      description: Target product
    - name: description
      description: Optional description for reference
    outputs:
    - contextPath: VisionOne.BlockList.action_id
      description: Action ID of task adding file SHA-1, IP address, domain, or URL
        to the User-Defined Suspicious Objects List
      type: string
    - contextPath: VisionOne.BlockList.task_status
      description: Task status of adding file SHA-1, IP address, domain, or URL object
        to the User-Defined Suspicious Objects List
      type: string
    description: Adds a file SHA-1, IP address, domain, or URL object to the User-Defined
      Suspicious Objects List, which blocks the objects on subsequent detections
  - name: trendmicro-visionone-remove-from-block-list
    arguments:
    - name: value_type
      required: true
      description: 'The type of object you would like to remove from the block list: "file_sha1", "ip", "domain", "url" or "mailbox"'
    - name: target_value
      required: true
      description: The object you would like to add that matches the value-type
    - name: product_id
      description: Target product
    - name: description
      description: Optional description for reference
    outputs:
    - contextPath: VisionOne.BlockList.action_id
      description: Action ID of task removing file SHA-1, IP address, domain, or URL
        object from the User-Defined Suspicious Objects List
      type: string
    - contextPath: VisionOne.BlockList.task_status
      description: Task Status of removing file SHA-1, IP address, domain, or URL
        object that was added to the User-Defined Suspicious Objects List from block
        list
      type: string
    description: Removes a file SHA-1, IP address, domain, or URL from the
      User-Defined Suspicious Objects List
  - name: trendmicro-visionone-quarantine-email-message
    arguments:
    - name: message_id
      required: true
      description: Email Message ID from Vision One message activity data
    - name: mailbox
      required: true
      description: Email mailbox where the message will be quarantined from
    - name: message_delivery_time
      required: true
      description: Email message's original delivery time
    - name: product_id
      default: true
      description: Target product
      defaultValue: sca
    - name: description
      description: Optional description for reference
    outputs:
    - contextPath: VisionOne.Email.action_id
      description: The Action Id of moving a message from a mailbox to the quarantine
        folder
      type: string
    - contextPath: VisionOne.Email.task_status
      description: The status of moving a message from a mailbox to the quarantine
        folder
      type: string
    description: Moves a message from a mailbox to the quarantine folder
  - name: trendmicro-visionone-delete-email-message
    arguments:
    - name: message_id
      required: true
      description: Email Message ID from Vision One message activity data
    - name: mailbox
      required: true
      description: Email mailbox where the message will be quarantined from
    - name: message_delivery_time
      required: true
      description: Email message's delivery time
    - name: product_id
      default: true
      description: Target product
      defaultValue: sca
    - name: description
      description: Optional description for reference
    outputs:
    - contextPath: VisionOne.Email.action_id
      description: The action id of deleting a message from a mailbox
      type: string
    - contextPath: VisionOne.Email.task_status
      description: The task status of deleting a message from a mailbox
      type: string
    description: Deletes a message from a mailbox
  - name: trendmicro-visionone-isolate-endpoint
    arguments:
    - name: field
      required: true
      description: 'Field to use to lookup computer_id. "hostname", "macaddr" or "ip"'
    - name: value
      required: true
      description: Value to lookup
    - name: product_id
      required: true
      default: true
      description: 'Target product: "sao" or "sds"'
      defaultValue: sao
    - name: description
      description: Description
    outputs:
    - contextPath: VisionOne.Endpoint_Connection.action_id
      description: The action ID of isolate endpoint task
      type: string
    - contextPath: VisionOne.Endpoint_Connection.task_status
      description: 'The task status of isolate endpoint '
      type: string
    description: Disconnects an endpoint from the network (but allows communication
      with the managing Trend Micro product)
  - name: trendmicro-visionone-restore-endpoint-connection
    arguments:
    - name: field
      required: true
      description: 'Field to use to lookup computer_id. "hostname", "macaddr" or "ip"'
    - name: value
      required: true
      description: Value to lookup
    - name: product_id
      required: true
      default: true
      description: 'Target product: "sao" or "sds"'
      defaultValue: sao
    - name: description
      description: Description
    outputs:
    - contextPath: VisionOne.Endpoint_Connection.action_id
      description: The action ID of the restore endpoint connection
      type: string
    - contextPath: VisionOne.Endpoint_Connection.task_status
      description: The task status of restore endpoint connection
      type: string
    description: Restores network connectivity to an endpoint that applied the "isolate
      endpoint" action
  - name: trendmicro-visionone-add-objects-to-exception-list
    arguments:
    - name: type
      required: true
      description: 'Object type: "domain", "ip", "sha1", or "url".' 
    - name: value
      required: true
      description: The object value. Full and partial matches supported. Domain partial match, (with a wildcard as the subdomain, example, .example.com) IP partial match, (IP range example, 192.168.35.1-192.168.35.254, cidr example, 192.168.35.1/24) URL Partial match, (Supports wildcards 'http://.'', 'https://.'' at beginning, or ''' at the end. Multiple wild cards also supported, such as , https://.example.com/path1/) SHA1 Only full match"
    - name: description
      description: Exception description.
    outputs:
    - contextPath: VisionOne.Exception_List.message
      description: status message success after task completion
      type: string
    - contextPath: VisionOne.Exception_List.status_code
      description: status code of response
      type: string
    - contextPath: VisionOne.Exception_List.total_items
      description: count of item present in exception list
      type: string
    description: Adds domains, file SHA-1 values, IP addresses, or URLs to the Exception
      List and prevents these objects from being added to the Suspicious Object List
  - name: trendmicro-visionone-delete-objects-from-exception-list
    arguments:
    - name: type
      required: true
      description: 'Object type: "domain", "ip", "sha1", or "url".'
    - name: value
      required: true
      description: The object value.
    outputs:
    - contextPath: VisionOne.Exception_List.message
      description: status message success after task completion
      type: string
    - contextPath: VisionOne.Exception_List.status_code
      description: status code of response
      type: number
    - contextPath: VisionOne.Exception_List.total_items
      description: count of item present in exception list
      type: string
    description: Deletes domains, file SHA-1 values, IP addresses, or URLs from the
      Exception List.
  - name: trendmicro-visionone-add-objects-to-suspicious-list
    arguments:
    - name: type
      required: true
      description: 'Object type: "domain", "ip", "sha1", or "url".'
    - name: value
      required: true
      description: The object value.
    - name: description
      description: Description
    - name: scan_action
      description: The action to take if object is found. If you don't use this parameter,
        the scan action specified in default_settings.riskLevel.type will be used
        instead. "block" or "log".
    - name: risk_level
      description: The Suspicious Object risk level. If you don't use this parameter,
        high will be used instead. "high", "medium" or "low".
    - name: expiry_days
      description: The number of days to keep the object in the Suspicious Object List.
        If you don't use this parameter, the default_settings.expiredDay scan action
        will be used instead.
    outputs:
    - contextPath: VisionOne.Suspicious_List.message
      description: Status message of adding item to suspicious object list
      type: string
    - contextPath: VisionOne.Suspicious_List.status_code
      description: Response code of adding item to suspicious object list
      type: number
    - contextPath: VisionOne.Suspicious_List.total_items
      description: Number of items present in suspicious object list
      type: number
    description: Adds domains, file SHA-1 values, IP addresses, or URLs to the Suspicious
      Object List.
  - name: trendmicro-visionone-delete-objects-from-suspicious-list
    arguments:
    - name: type
      required: true
      description: 'Object type: "domain", "ip", "sha1", or "url".'
    - name: value
      required: true
      description: The object value.
    outputs:
    - contextPath: VisionOne.Suspicious_List.message
      description: Status message of removing item from suspicious object list
      type: string
    - contextPath: VisionOne.Suspicious_List.status_code
      description: Response code of removing item from suspicious object list
      type: number
    - contextPath: VisionOne.Suspicious_List.total_items
      description: Number of items present in suspicious object list
      type: number
    description: Deletes domains, file SHA-1 values, IP addresses, or URLs from the
      Suspicious Object List
  - name: trendmicro-visionone-terminate-process
    arguments:
    - name: field
      required: true
      description: 'Field to use to lookup computer_id. "hostname", "macaddr" " or "ip"'
    - name: value
      required: true
      description: 'Value to lookup'
    - name: file_sha1
      required: true
      description: SHA1 hash of the process to terminate
    - name: product_id
      default: true
      description: Target product
      defaultValue: sao
    - name: description
      description: Description
    - name: filename
      description: Optional file name list for log
    outputs:
    - contextPath: VisionOne.Terminate_Process.action_id
      description: Action Id of the current running task
      type: string
    - contextPath: VisionOne.Terminate_Process.task_status
      description: Status of current running task
      type: string
    description: Terminates a process that is running on an endpoint
  - name: trendmicro-visionone-get-file-analysis-status
    arguments:
    - name: task_id
      required: true
      description: task_id from the trendmicro-visionone-submit-file-to-sandbox command output
    outputs:
    - contextPath: VisionOne.File_Analysis_Status.message
      description: 'Status of the sandbox analysis'
      type: string
    - contextPath: VisionOne.File_Analysis_Status.code
      description: Response code
      type: string
    - contextPath: VisionOne.File_Analysis_Status.task_id
      description: task_id of the task queried
      type: string
    - contextPath: VisionOne.File_Analysis_Status.task_status
      description: Sandbox analysis status
      type: string
    - contextPath: VisionOne.File_Analysis_Status.digest
      description: 'The hash values of file analyzed'
      type: string
    - contextPath: VisionOne.File_Analysis_Status.analysis_completion_time
      description: Sample analysis completed time.
      type: string
    - contextPath: VisionOne.File_Analysis_Status.risk_level
      description: Risk Level of the analyzed file.
      type: string
    - contextPath: VisionOne.File_Analysis_Status.descritption
      description: Scan result description for NotAnalyzed.
      type: string
    - contextPath: VisionOne.File_Analysis_Status.detection_name_list
      description: Detection name of this sample, if applicable.
      type: unknown
    - contextPath: VisionOne.File_Analysis_Status.threat_type_list
      description: Threat type of this sample.
    - contextPath: VisionOne.File_Analysis_Status.file_type
      description: File type of this sample.
      type: string
    - contextPath: VisionOne.File_Analysis_Status.report_id
      description: ID used to get the report and suspicious object. Empty means no
        report.
      type: string
    description: Retrieves the status of a sandbox analysis submission
  - name: trendmicro-visionone-get-file-analysis-report
    arguments:
    - name: report_id
      required: true
      description: report_id of the sandbox submission retrieved from the trendmicro-visionone-get-file-analysis-status command
    - name: type
      required: true
      description: 'Type of report to retrieve: "vaReport", "investigationPackage", or "suspiciousObject"'
    outputs:
    - contextPath: VisionOne.File_Analysis_Report.message
      description: Status message of file report
      type: string
    - contextPath: VisionOne.File_Analysis_Report.code
      description: status code of file report
      type: string
    - contextPath: VisionOne.File_Analysis_Report.type
      description: Suspicious object type
      type: string
    - contextPath: VisionOne.File_Analysis_Report.value
      description: Suspicious object value
      type: string
    - contextPath: VisionOne.File_Analysis_Report.risk_level
      description: Risk Level of suspicious object
      type: string
    - contextPath: VisionOne.File_Analysis_Report.analysis_completion_time
      description: Analyze time of suspicious object
      type: string
    - contextPath: VisionOne.File_Analysis_Report.expired_time
      description: Expire time of suspicious object
      type: string
    - contextPath: VisionOne.File_Analysis_Report.root_file_sha1
      description: Sample sha1 generate this suspicious object
      type: string
    description: Retrieves the analysis report, investigation package, or Suspicious
      Object List of a submitted file
  - name: trendmicro-visionone-collect-forensic-file
    arguments:
    - name: field
      required: true
      description: 'Field to use to lookup computer_id. "hostname", "macaddr" " or "ip"'
    - name: value
      required: true
      description: Value to lookup.
    - name: product_id
      required: true
      description: 'Product: "sao" "xes" "sds"'
    - name: file_path
      required: true
      description: Path to the file to collect.
    - name: os
      required: true
      description: 'Type of OS. "windows", "mac" or "linux"'
    - name: description
      description: Description of the file.
    outputs:
    - contextPath: VisionOne.Collect_Forensic_File.action_id
      description: Action ID of the particular file.
      type: string
    - contextPath: VisionOne.Collect_Forensic_File.task_status
      description: Task status of collected file
      type: string
    description: Compresses a file on an endpoint in a password-protected archive
      and then sends the archive to the XDR service platform
  - name: trendmicro-visionone-download-information-for-collected-forensic-file
    arguments:
    - name: action_id
      required: true
      description: action_id output from the collect command used to collect the file.
    outputs:
    - contextPath: VisionOne.Download_Information_For_Collected_Forensic_File.url
      description: URL of the collected file
      type: string
    - contextPath: VisionOne.Download_Information_For_Collected_Forensic_File.expires
      description: 'URL expiration date'
      type: string
    - contextPath: VisionOne.Download_Information_For_Collected_Forensic_File.password
      description: Archive password for the protected forensic file
      type: string
    - contextPath: VisionOne.Download_Information_For_Collected_Forensic_File.filename
      description: Name of the collected file
      type: string
    description: Retrieves a URL and other information required to download a collected
      file via the trendmicro-visionone-collect-forensic-file command
  - name: trendmicro-visionone-submit-file-to-sandbox
    arguments:
    - name: file_url
      required: true
      description: URL pointing to the location of the file to be submitted.
    - name: filename
      required: true
      description: Name of the file to be analyzed
    - name: document_password
      description: The Base64 encoded password for decrypting the submitted document.
        sample.
    - name: archive_password
      description: 'The Base64 encoded password for decrypting the submitted archive.'
    outputs:
    - contextPath: VisionOne.Submit_File_to_Sandbox.message
      description: Status message of the file submitted to sandbox.
      type: string
    - contextPath: VisionOne.Submit_File_to_Sandbox.code
      description: status code of the file submitted to sandbox
      type: string
    - contextPath: VisionOne.Submit_File_to_Sandbox.task_id
      description: Task ID of the submitted file
      type: string
    - contextPath: VisionOne.Submit_File_to_Sandbox.digest
      description: The hash value of the file
    description: Submits a file to the sandbox for analysis (Note. For more information
      about the supported file types, see the Trend Micro Vision One Online Help.
      Submissions require credits. Does not require credits in regions where Sandbox
      Analysis has not been officially released.)
  dockerimage: demisto/python3:3.9.9.25564
  runonce: false
  subtype: python3
fromversion: 5.5.0
tests:
- No tests (auto formatted)