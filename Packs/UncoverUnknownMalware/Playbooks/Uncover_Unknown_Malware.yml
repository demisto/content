id: 9457296e-2a44-4955-8c51-f7ae49a959f3
version: 46
vcShouldKeepItemLegacyProdMachine: false
name: Uncover Unknown Malware_dev
description: |-
  This playbook leverages the case management and TIM aspects of XSOAR to uncover unknown malware.
  The playbook does the following:
  - Gets the SSDeep hash of a known malicious MD5 or SHA256 hash by enriching the hash via VirusTotal, and attempting to retrieve the related file from an endpoint.
  - Creates relationships between otherwise unknown indicators - based on their correspondence to the SSDeep that was deemed similar to the original SSDeep of the malicious hash.
  - Links incidents that had any of the indicators which were found related based on the SSDeep hash similarity.
  - Hunts for the presence of the related indicators across the different organization assets.
  - Enriches the original hash to get the threat actor, malware family and VirusTotal community comments.

  These steps allow the analyst to find new files, incidents and endpoints which could be related to the the original hash that was searched simply based on the similarity of SSDeep hashes.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 6c2383b2-e7e4-455f-8d3b-052960c0983f
    type: start
    task:
      id: 6c2383b2-e7e4-455f-8d3b-052960c0983f
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "38"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": -840
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: b3700116-b760-4728-8b45-b3248cf042dc
    type: regular
    task:
      id: b3700116-b760-4728-8b45-b3248cf042dc
      version: -1
      name: Search all existing hashes
      description: commands.local.cmd.find.indicators
      script: Builtin|||findIndicators
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      extend-context:
        simple: AllHashes=
      fromdate:
        complex:
          root: inputs.SearchFromDate
      ignore-outputs:
        simple: "true"
      query:
        simple: type:File
    reputationcalc: 1
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 470,
          "y": 1320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: 98108458-2041-40ec-89b2-e718dbe512c4
    type: regular
    task:
      id: 98108458-2041-40ec-89b2-e718dbe512c4
      version: -1
      name: Save SSDeep hashes of all hashes
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "55"
    scriptarguments:
      key:
        simple: AllSSDeeps.SSDeep
      value:
        complex:
          root: AllHashes.CustomFields.ssdeep
          filters:
          - - operator: isNotEmpty
              left:
                value:
                  simple: AllHashes.CustomFields.ssdeep
                iscontext: true
          - - operator: isNotEqualString
              left:
                value:
                  simple: AllHashes.CustomFields.ssdeep
                iscontext: true
              right:
                value:
                  simple: InputHash
                iscontext: true
          transformers:
          - operator: toLowerCase
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 470,
          "y": 2360
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 080ae8ed-7a31-4cf4-8ee8-bf9b22f95080
    type: regular
    task:
      id: 080ae8ed-7a31-4cf4-8ee8-bf9b22f95080
      version: -1
      name: Check SSDeep similarity
      description: This script finds similar files that can be related to each other
        by fuzzy hash (SSDeep).
      scriptName: SSDeepSimilarity
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      ssdeep_hash:
        complex:
          root: InputHash
          transformers:
          - operator: toLowerCase
          - operator: uniq
      ssdeep_hashes_to_compare:
        complex:
          root: AllSSDeeps.SSDeep
          filters:
          - - operator: isNotEmpty
              left:
                value:
                  simple: AllSSDeeps.SSDeep
                iscontext: true
          transformers:
          - operator: toLowerCase
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 780,
          "y": 2890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: ecc3ee54-82c2-4f38-8e87-c3ecd50a2e50
    type: regular
    task:
      id: ecc3ee54-82c2-4f38-8e87-c3ecd50a2e50
      version: -1
      name: Create relationships between similar hashes
      description: This automation creates a relationship between indicator objects.
      scriptName: CreateIndicatorRelationship
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "47"
    scriptarguments:
      description:
        simple: Detected while comparing SSDeep hashes.
      entity_a:
        complex:
          root: inputs.fileHash
          transformers:
          - operator: toLowerCase
      entity_a_type:
        simple: File
      entity_b:
        complex:
          root: similarIndicators.CustomFields
          accessor: md5
          transformers:
          - operator: append
            args:
              item:
                value:
                  simple: similarIndicators.CustomFields.sha1
                iscontext: true
          - operator: append
            args:
              item:
                value:
                  simple: similarIndicators.CustomFields.sha256
                iscontext: true
          - operator: append
            args:
              item:
                value:
                  simple: similarIndicators.CustomFields.ssdeep
                iscontext: true
          - operator: toLowerCase
      entity_b_type:
        simple: File
      relationship:
        simple: similar-to
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1020,
          "y": 4220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 94e85ca1-1c40-4b7f-8f38-fc15619eb9d1
    type: title
    task:
      id: 94e85ca1-1c40-4b7f-8f38-fc15619eb9d1
      version: -1
      name: Create Relationships with Similar Files & Incidents
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "8"
      - "14"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1270,
          "y": 3725
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 0be61b08-d93a-4236-8be6-f330a3b6b975
    type: regular
    task:
      id: 0be61b08-d93a-4236-8be6-f330a3b6b975
      version: -1
      name: Find incidents with any related hash
      description: Searches Demisto incidents
      scriptName: SearchIncidentsV2
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      query:
        complex:
          root: similarIndicators.CustomFields
          accessor: md5
          transformers:
          - operator: append
            args:
              item:
                value:
                  simple: similarIndicators.CustomFields.sha1
                iscontext: true
          - operator: append
            args:
              item:
                value:
                  simple: similarIndicators.CustomFields.sha256
                iscontext: true
          - operator: append
            args:
              item:
                value:
                  simple: similarIndicators.CustomFields.ssdeep
                iscontext: true
          - operator: toLowerCase
          - operator: uniq
          - operator: join
            args:
              separator:
                value:
                  simple: ' OR '
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1530,
          "y": 3870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    fieldMapping:
    - incidentfield: Number of Related Incidents
      output:
        complex:
          root: foundIncidents
          accessor: id
          transformers:
          - operator: count
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: 17fdc1d8-098d-431d-8d24-34945b37f1b5
    type: condition
    task:
      id: 17fdc1d8-098d-431d-8d24-34945b37f1b5
      version: -1
      name: Are there any related incidents?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "11"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: foundIncidents
                accessor: id
                transformers:
                - operator: uniq
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1530,
          "y": 4040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: b9e6336c-471f-40fb-8ac5-0e2a2856f989
    type: regular
    task:
      id: b9e6336c-471f-40fb-8ac5-0e2a2856f989
      version: -1
      name: Link to all related incidents
      description: commands.local.cmd.linkIncidents
      script: Builtin|||linkIncidents
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      incidentId:
        complex:
          root: incident
          accessor: id
      linkedIncidentIDs:
        complex:
          root: foundIncidents.id
          filters:
          - - operator: isNotEqualString
              left:
                value:
                  simple: foundIncidents.id
                iscontext: true
              right:
                value:
                  simple: incident.id
                iscontext: true
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1900,
          "y": 4210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: 29d880e5-6ea8-4cc7-84a2-13fe9be80125
    type: condition
    task:
      id: 29d880e5-6ea8-4cc7-84a2-13fe9be80125
      version: -1
      name: Were SSDeeps with high similarity found?
      description: Checks whether the SSDeep hashes have a high similarity to the
        SSDeep hash of the file we're hunting for.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "22"
      High Similarity:
      - "13"
    separatecontext: false
    conditions:
    - label: High Similarity
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: SSDeepSimilarity
                filters:
                - - operator: greaterThanOrEqual
                    left:
                      value:
                        simple: SSDeepSimilarity.compared_hashes.similarityValue
                      iscontext: true
                    right:
                      value:
                        simple: inputs.SimilarityThreshold
                      iscontext: true
                transformers:
                - operator: uniq
            iscontext: true
    view: |-
      {
        "position": {
          "x": 780,
          "y": 3215
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: 0610ee18-192a-4cf9-8215-fbf177f94c25
    type: regular
    task:
      id: 0610ee18-192a-4cf9-8215-fbf177f94c25
      version: -1
      name: Save Hashes with high SSDeep similarity
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      key:
        simple: HighSimilarity
      value:
        complex:
          root: SSDeepSimilarity.compared_hashes
          filters:
          - - operator: greaterThan
              left:
                value:
                  simple: SSDeepSimilarity.compared_hashes.similarityValue
                iscontext: true
              right:
                value:
                  simple: inputs.SimilarityThreshold
                iscontext: true
          accessor: hash
          transformers:
          - operator: toLowerCase
          - operator: uniq
    reputationcalc: 1
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1170,
          "y": 3400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    fieldMapping:
    - incidentfield: Number of similar files
      output:
        complex:
          root: HighSimilarity
          transformers:
          - operator: uniq
          - operator: count
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 22adac8b-1ed7-440a-8238-8e65c7f22888
    type: regular
    task:
      id: 22adac8b-1ed7-440a-8238-8e65c7f22888
      version: -1
      name: Find relationships between similar hashes
      description: This automation outputs the indicator relationships to context
        according to the provided query, using the entities, entityTypes, and relationships
        arguments. All arguments will use the AND operator. For example, using the
        following arguments entities=8.8.8.8 entities_types=Domain will provide only
        relationships that the 8.8.8.8 indicator has with indicators of type domain.
      scriptName: SearchIndicatorRelationships
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      entities:
        complex:
          root: similarIndicators.CustomFields
          accessor: md5
          transformers:
          - operator: append
            args:
              item:
                value:
                  simple: similarIndicators.CustomFields.sha1
                iscontext: true
          - operator: append
            args:
              item:
                value:
                  simple: similarIndicators.CustomFields.sha256
                iscontext: true
          - operator: append
            args:
              item:
                value:
                  simple: similarIndicators.CustomFields.ssdeep
                iscontext: true
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1020,
          "y": 3870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 28f2b2b3-36ee-4208-8608-e736024486e9
    type: regular
    task:
      id: 28f2b2b3-36ee-4208-8608-e736024486e9
      version: -1
      name: Get additional indicators from linked incidents
      description: commands.local.cmd.find.indicators
      script: Builtin|||findIndicators
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      extend-context:
        simple: IndicatorsFromLinkedIncidents=
      query:
        complex:
          root: foundIncidents
          accessor: id
          transformers:
          - operator: uniq
          - operator: replaceMatch
            args:
              regex:
                value:
                  simple: (.*)
              replaceWith:
                value:
                  simple: incident.id:$1
          - operator: join
            args:
              separator:
                value:
                  simple: ' OR '
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1900,
          "y": 4400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: 162dafda-bbfd-4597-892b-bf9c18514359
    type: regular
    task:
      id: 162dafda-bbfd-4597-892b-bf9c18514359
      version: -1
      name: Set additional indicators from linked incidents
      description: commands.local.cmd.set.incident
      script: Builtin|||setIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      additionalindicators:
        complex:
          root: IndicatorsFromLinkedIncidents
          accessor: value
          transformers:
          - operator: toLowerCase
          - operator: uniq
          - operator: join
            args:
              separator:
                value:
                  simple: ','
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1900,
          "y": 4560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: 128d975c-3c3e-4c1a-80b3-154b96f35981
    type: title
    task:
      id: 128d975c-3c3e-4c1a-80b3-154b96f35981
      version: -1
      name: Hunt For Assets with Indicators Related By SSDeep Similarity
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "18"
      - "19"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1520,
          "y": 5550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: c10d81d6-e904-4a90-8f02-a4f31bfdc4af
    type: playbook
    task:
      id: c10d81d6-e904-4a90-8f02-a4f31bfdc4af
      version: -1
      name: Threat Hunting - Generic
      description: "This playbook enables threat hunting for IOCs in your enterprise.
        It currently supports the following integrations: - Splunk\n- Qradar\n- Pan-os
        \n- Cortex data lake \n- Autofocus\n- Microsoft 365 Defender"
      playbookName: Threat Hunting - Generic
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      MD5:
        simple: ${similarIndicators.CustomFields.md5}
      QRadarTimeFrame:
        simple: LAST 7 DAYS
      SHA1:
        simple: ${similarIndicators.CustomFields.sha1}
      SHA256:
        simple: ${similarIndicators.CustomFields.sha256}
      SplunkEarliestTime:
        simple: -7d@d
      SplunkLatestTime:
        simple: now
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 1300,
          "y": 5700
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: 1e1ce804-d649-474f-8d32-16951fb8ca9f
    type: playbook
    task:
      id: 1e1ce804-d649-474f-8d32-16951fb8ca9f
      version: -1
      name: Search Endpoints By Hash - Generic V2
      description: Hunt using available tools
      playbookName: Search Endpoints By Hash - Generic V2
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "60"
    scriptarguments:
      MD5Hash:
        complex:
          root: similarIndicators.CustomFields
          accessor: md5
          transformers:
          - operator: uniq
      SHA1Hash:
        complex:
          root: similarIndicators.CustomFields
          accessor: sha1
          transformers:
          - operator: uniq
      SHA256Hash:
        complex:
          root: similarIndicators.CustomFields
          accessor: sha256
          transformers:
          - operator: uniq
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 1760,
          "y": 5700
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 8d95179d-8301-4081-8efc-a44c75f609c3
    type: condition
    task:
      id: 8d95179d-8301-4081-8efc-a44c75f609c3
      version: -1
      name: Are there hashes that are missing an SSDeep value?
      description: |-
        Checks whether there are hashes in XSOAR which are missing SSDeep hash values.
        Also checks whether the indicators can be enriched according to the EnrichExistingIndicators playbook input.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "21"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: AllHashes
                filters:
                - - operator: isEmpty
                    left:
                      value:
                        simple: AllHashes.CustomFields.ssdeep
                      iscontext: true
                accessor: value
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              complex:
                root: inputs.EnrichExistingIndicators
            iscontext: true
          right:
            value:
              simple: "True"
    view: |-
      {
        "position": {
          "x": 470,
          "y": 1490
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: 99416d11-0860-4f54-8a73-3cdae230da35
    type: title
    task:
      id: 99416d11-0860-4f54-8a73-3cdae230da35
      version: -1
      name: Enrich File Indicators to Expand SSDeep Pool
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "35"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 790,
          "y": 1690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 6c35e554-1227-49a5-8fd9-4035c4ca3727
    type: title
    task:
      id: 6c35e554-1227-49a5-8fd9-4035c4ca3727
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 470,
          "y": 6240
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: b8b8ecb5-db3c-48ae-8611-55c2c3fe8a50
    type: title
    task:
      id: b8b8ecb5-db3c-48ae-8611-55c2c3fe8a50
      version: -1
      name: Malware Family and Threat Actor Enrichment
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "58"
      - "59"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1510,
          "y": 4760
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: fabc2761-ee35-4268-8b2c-7bfff8166615
    type: regular
    task:
      id: fabc2761-ee35-4268-8b2c-7bfff8166615
      version: -1
      name: Get VirusTotal community comments
      description: Retrieves comments for a given resource.
      tags:
      - vt-community-comments
      script: '|||vt-comments-get'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      resource:
        complex:
          root: inputs.fileHash
          transformers:
          - operator: append
            args:
              item:
                value:
                  simple: similarIndicators.CustomFields.md5
                iscontext: true
      resource_type:
        simple: file
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1800,
          "y": 5170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: 8d325307-9434-4d3a-8d07-30df6ed35028
    type: regular
    task:
      id: 8d325307-9434-4d3a-8d07-30df6ed35028
      version: -1
      name: Search for SSDeep of the hash in VirusTotal
      description: Checks the file reputation of the specified hash.
      script: VirusTotal (API v3)|||file
      type: regular
      iscommand: true
      brand: VirusTotal (API v3)
    nexttasks:
      '#none#':
      - "49"
    scriptarguments:
      extend-context:
        simple: sourceHash=
      file:
        complex:
          root: inputs.fileHash
      ignore-outputs:
        simple: "true"
    reputationcalc: 2
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 250,
          "y": 70
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    fieldMapping:
    - incidentfield: File MD5
      output:
        simple: ${sourceHash.data.attributes.md5}
    - incidentfield: File SHA1
      output:
        simple: ${sourceHash.data.attributes.sha1}
    - incidentfield: File SHA256
      output:
        simple: ${sourceHash.data.attributes.sha256}
    - incidentfield: SSDeep
      output:
        simple: ${sourceHash.data.attributes.ssdeep}
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: 10765461-5e42-4f24-8f18-4130218131e9
    type: regular
    task:
      id: 10765461-5e42-4f24-8f18-4130218131e9
      version: -1
      name: Get MD5/SHA1/SHA256 for high similarity SSDeeps
      description: commands.local.cmd.find.indicators
      script: Builtin|||findIndicators
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      extend-context:
        simple: similarIndicators=
      ignore-outputs:
        simple: "true"
      query:
        complex:
          root: HighSimilarity
          transformers:
          - operator: toLowerCase
          - operator: uniq
          - operator: concat
            args:
              prefix:
                value:
                  simple: '"'
              suffix:
                value:
                  simple: '"'
          - operator: join
            args:
              separator:
                value:
                  simple: ' OR '
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1270,
          "y": 3570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: 7324188a-fb04-4035-8fe0-171e4ae16579
    type: regular
    task:
      id: 7324188a-fb04-4035-8fe0-171e4ae16579
      version: -1
      name: Analyze hashes using Intezer
      description: Checks file reputation of the given hash, supports SHA256, SHA1
        and MD5
      script: Intezer v2|||intezer-analyze-by-hash
      type: regular
      iscommand: true
      brand: Intezer v2
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      file_hash:
        complex:
          root: similarIndicators.CustomFields
          accessor: md5
          transformers:
          - operator: append
            args:
              item:
                value:
                  simple: inputs.fileHash
                iscontext: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1240,
          "y": 5170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: 5aa4877b-51bd-481f-8e01-f2015b34c4f9
    type: regular
    task:
      id: 5aa4877b-51bd-481f-8e01-f2015b34c4f9
      version: -1
      name: Get Intezer analysis results
      description: Check the analysis status and get analysis result, support file
        and endpoint analysis
      script: Intezer v2|||intezer-get-analysis-result
      type: regular
      iscommand: true
      brand: Intezer v2
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      analysis_id:
        complex:
          root: Intezer.Analysis
          accessor: ID
      analysis_type:
        simple: File
      extend-context:
        simple: IntezerAnalysis=
      ignore-outputs:
        simple: "true"
      retry-count:
        simple: "3"
      retry-interval:
        simple: "10"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1240,
          "y": 5350
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    fieldMapping:
    - incidentfield: Malware Family
      output:
        complex:
          root: IntezerAnalysis
          accessor: family_name
          transformers:
          - operator: uniq
          - operator: join
            args:
              separator:
                value:
                  simple: ', '
    - incidentfield: Analysis Report
      output:
        complex:
          root: IntezerAnalysis
          accessor: analysis_url
          transformers:
          - operator: uniq
          - operator: split
            args:
              delimiter:
                value:
                  simple: ', '
    - incidentfield: Verdict
      output:
        complex:
          root: IntezerAnalysis
          accessor: verdict
          transformers:
          - operator: uniq
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: 2a442fa9-da70-4d8a-8543-0a0811a7c7f3
    type: regular
    task:
      id: 2a442fa9-da70-4d8a-8543-0a0811a7c7f3
      version: -1
      name: Enrich files that are missing SSDeep hashes
      description: commands.local.cmd.enrich.indicators
      script: Builtin|||enrichIndicators
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "53"
    scriptarguments:
      indicatorsValues:
        complex:
          root: AllHashes
          filters:
          - - operator: isEmpty
              left:
                value:
                  simple: AllHashes.CustomFields.ssdeep
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: AllHashes.CustomFields.md5
                iscontext: true
          accessor: value
          transformers:
          - operator: append
            args:
              item:
                value:
                  simple: AllHashes.CustomFields.sha1
                iscontext: true
          - operator: append
            args:
              item:
                value:
                  simple: AllHashes.CustomFields.sha1
                iscontext: true
          - operator: append
            args:
              item:
                value:
                  simple: AdditionalHashesToEnrich.CustomFields.md5
                iscontext: true
          - operator: append
            args:
              item:
                value:
                  simple: AdditionalHashesToEnrich.CustomFields.sha1
                iscontext: true
          - operator: append
            args:
              item:
                value:
                  simple: AdditionalHashesToEnrich.CustomFields.sha256
                iscontext: true
          - operator: append
            args:
              item:
                value:
                  simple: AdditionalHashesToEnrich.value
                iscontext: true
          - operator: uniq
    continueonerror: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 790,
          "y": 1820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: 96bde57f-83d7-4cc8-8d5d-6fe26625118a
    type: regular
    task:
      id: 96bde57f-83d7-4cc8-8d5d-6fe26625118a
      version: -1
      name: Display SSDeep similarity grid
      description: Creates a Grid table from items or key-value pairs.
      scriptName: SetGridField
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      columns:
        simple: Similarity Score,File SSDeep
      context_path:
        simple: SSDeepSimilarity.compared_hashes
      grid_id:
        simple: similarfilehashesbasedonssdeep
      keys:
        simple: similarityValue,hash
      sort_by:
        simple: Similarity Score
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 780,
          "y": 3050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: bc55001b-8c84-4a8d-8d10-8e6b5e3f3d06
    type: regular
    task:
      id: bc55001b-8c84-4a8d-8d10-8e6b5e3f3d06
      version: -1
      name: Save SSDeep of the file hash
      description: Saves the SSDeep found in the XSOAR / VirusTotal search to a context
        key. This is used for normalization.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "39"
    scriptarguments:
      key:
        simple: InputHash
      value:
        complex:
          root: sourceHash.data.attributes
          accessor: ssdeep
          transformers:
          - operator: toLowerCase
          - operator: uniq
          - operator: SetIfEmpty
            args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: foundssdeep
                iscontext: true
          - operator: SetIfEmpty
            args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: File.SSDeep
                iscontext: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 470,
          "y": 990
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: 1f06d07c-2d9d-49ff-87a4-a94f10b0a41e
    type: title
    task:
      id: 1f06d07c-2d9d-49ff-87a4-a94f10b0a41e
      version: -1
      name: Set Source SSDeep Indicator
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "50"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": -700
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: db205757-da3d-46ca-8785-6a0a02e67644
    type: title
    task:
      id: db205757-da3d-46ca-8785-6a0a02e67644
      version: -1
      name: Creating an SSDeep Pool
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 470,
          "y": 1175
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: a0fd8f4d-0291-43cf-8d89-e16a6f161fd9
    type: title
    task:
      id: a0fd8f4d-0291-43cf-8d89-e16a6f161fd9
      version: -1
      name: Search Similar Files Based on SSDeeps
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "4"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 780,
          "y": 2745
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: a7bb4506-9ae7-46bb-8914-0c09187fba4f
    type: regular
    task:
      id: a7bb4506-9ae7-46bb-8914-0c09187fba4f
      version: -1
      name: Display relationships in layout
      description: Creates a Grid table from items or key-value pairs.
      scriptName: SetGridField
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      columns:
        simple: Relationship Type,Relationship Target
      context_path:
        simple: Relationships
      grid_id:
        simple: filerelationships
      keys:
        simple: Relationship,EntityB
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1020,
          "y": 4370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: e06faf2d-b138-4114-8869-62055fa8c056
    type: regular
    task:
      id: e06faf2d-b138-4114-8869-62055fa8c056
      version: -1
      name: Display related endpoints
      description: commands.local.cmd.set.incident
      script: Builtin|||setIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      relatedendpoints:
        complex:
          root: Endpoint
          accessor: Hostname
          transformers:
          - operator: uniq
          - operator: join
            args:
              separator:
                value:
                  simple: ', '
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1760,
          "y": 6040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: d2d0fb6f-345a-4a56-85c1-c4d59b3d13f1
    type: condition
    task:
      id: d2d0fb6f-345a-4a56-85c1-c4d59b3d13f1
      version: -1
      name: Was an SSDeep hash found?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "52"
      "yes":
      - "37"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: sourceHash.data.attributes.ssdeep
            iscontext: true
    view: |-
      {
        "position": {
          "x": 250,
          "y": 250
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: c85e790b-8932-4173-8a34-140c86a02958
    type: regular
    task:
      id: c85e790b-8932-4173-8a34-140c86a02958
      version: -1
      name: Search XSOAR for SSDeep hash of the provided hash
      description: commands.local.cmd.find.indicators
      script: Builtin|||findIndicators
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "51"
    scriptarguments:
      extend-context:
        simple: foundssdeep=CustomFields.ssdeep.[0]::foundmd5=CustomFields.md5::foundsha1=CustomFields.sha1::foundsha256=CustomFields.sha256
      ignore-outputs:
        simple: "true"
      value:
        complex:
          root: inputs.fileHash
    reputationcalc: 1
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": -560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    fieldMapping:
    - incidentfield: File MD5
      output:
        simple: ${foundmd5}
    - incidentfield: File SHA256
      output:
        simple: ${foundsha256}
    - incidentfield: SSDeep
      output:
        simple: ${foundssdeep}
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: a3421e7c-358c-4b0c-8e5a-895121b1fec0
    type: condition
    task:
      id: a3421e7c-358c-4b0c-8e5a-895121b1fec0
      version: -1
      name: Was an SSDeep hash found in XSOAR?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "61"
      "yes":
      - "37"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: foundssdeep
            iscontext: true
    view: |-
      {
        "position": {
          "x": 310,
          "y": -370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "52":
    id: "52"
    taskid: eb72aec6-793b-4746-831a-db7725416310
    type: title
    task:
      id: eb72aec6-793b-4746-831a-db7725416310
      version: -1
      name: Attempt File Retrieval to Obtain SSDeep
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "56"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -110,
          "y": 440
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: c2d091ab-46c2-43a9-8858-65cb5a300f96
    type: regular
    task:
      id: c2d091ab-46c2-43a9-8858-65cb5a300f96
      version: -1
      name: Remove previously searched hashes
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "54"
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: AllHashes
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 790,
          "y": 1990
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "54":
    id: "54"
    taskid: 06193399-74bf-4ef3-81ec-bfce82428789
    type: regular
    task:
      id: 06193399-74bf-4ef3-81ec-bfce82428789
      version: -1
      name: Get available SSDeep hashes after enrichment
      description: commands.local.cmd.find.indicators
      script: Builtin|||findIndicators
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      extend-context:
        simple: AllHashes=
      fromdate:
        complex:
          root: inputs.SearchFromDate
      ignore-outputs:
        simple: "true"
      query:
        simple: type:File ssdeep:*
    reputationcalc: 1
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 790,
          "y": 2150
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
    isoversize: false
    isautoswitchedtoquietmode: false
  "55":
    id: "55"
    taskid: 9004cb2b-861c-483e-8fa7-7aa370731156
    type: condition
    task:
      id: 9004cb2b-861c-483e-8fa7-7aa370731156
      version: -1
      name: Do we have an SSDeep pool to compare against?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "22"
      "yes":
      - "40"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: AllSSDeeps.SSDeep
            iscontext: true
    view: |-
      {
        "position": {
          "x": 470,
          "y": 2540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "56":
    id: "56"
    taskid: 09c3255c-26bb-44e6-84d2-4299d6df0ded
    type: playbook
    task:
      id: 09c3255c-26bb-44e6-84d2-4299d6df0ded
      version: -1
      name: Retrieve File from Endpoint - Generic V3
      description: |-
        'This playbook retrieves a file sample from an endpoint using the following playbooks:'
        - Get File Sample From Path - Generic v2.
        - Get File Sample By Hash - Generic v3.
      playbookName: Retrieve File from Endpoint - Generic V3
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "57"
    scriptarguments:
      MD5:
        complex:
          root: inputs.fileHash
          filters:
          - - operator: hasLength
              left:
                value:
                  simple: inputs.fileHash
                iscontext: true
              right:
                value:
                  simple: "32"
      SHA256:
        complex:
          root: inputs.fileHash
          filters:
          - - operator: hasLength
              left:
                value:
                  simple: inputs.fileHash
                iscontext: true
              right:
                value:
                  simple: "64"
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": -110,
          "y": 570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "57":
    id: "57"
    taskid: 3fdae635-0fa7-423b-80e8-e4f470953619
    type: condition
    task:
      id: 3fdae635-0fa7-423b-80e8-e4f470953619
      version: -1
      name: Was a file retrieved?
      description: |-
        Checks whether a file which has an MD5/SHA256 hash of the input hash we are hunting for, was retrieved.
        If a file was retrieved then we should have an SSDeep hash that we can compare against other SSDeep hashes.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "22"
      "yes":
      - "37"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: File
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: File.MD5
                      iscontext: true
                    right:
                      value:
                        simple: inputs.fileHash
                      iscontext: true
                  - operator: isEqualString
                    left:
                      value:
                        simple: File.SHA256
                      iscontext: true
                    right:
                      value:
                        simple: inputs.fileHash
                      iscontext: true
                accessor: SSDeep
            iscontext: true
    view: |-
      {
        "position": {
          "x": -110,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "58":
    id: "58"
    taskid: 94bb0391-91b8-4ed7-8801-42c65b3e8d94
    type: condition
    task:
      id: 94bb0391-91b8-4ed7-8801-42c65b3e8d94
      version: -1
      name: Is VirusTotal (API v3) enabled?
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'
      scriptName: IsIntegrationAvailable
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "17"
      "yes":
      - "29"
    scriptarguments:
      brandname:
        simple: VirusTotal (API v3)
    results:
    - brandInstances
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1800,
          "y": 4920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "59":
    id: "59"
    taskid: d4dc3ebc-8866-4887-8a3d-c57827a99bf0
    type: condition
    task:
      id: d4dc3ebc-8866-4887-8a3d-c57827a99bf0
      version: -1
      name: Is Intezer v2 enabled?
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'
      scriptName: IsIntegrationAvailable
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "17"
      "yes":
      - "33"
    scriptarguments:
      brandname:
        simple: Intezer v2
    results:
    - brandInstances
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1240,
          "y": 4920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: 05d11ed9-e0e7-4c80-85f5-02f944546fb7
    type: condition
    task:
      id: 05d11ed9-e0e7-4c80-85f5-02f944546fb7
      version: -1
      name: Were related endpoints found?
      description: Checks whether endpoints were found for the related hashes.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "22"
      "yes":
      - "48"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Endpoint
                accessor: Hostname
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1760,
          "y": 5850
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    id: "61"
    taskid: 96f63971-5fc9-435c-833f-dd0bc457c894
    type: condition
    task:
      id: 96f63971-5fc9-435c-833f-dd0bc457c894
      version: -1
      name: Is VirusTotal (API v3) enabled?
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'
      scriptName: IsIntegrationAvailable
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "52"
      "yes":
      - "30"
    scriptarguments:
      brandname:
        simple: VirusTotal (API v3)
    results:
    - brandInstances
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 20,
          "y": -190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "12_13_High Similarity": 0.32,
      "12_22_#default#": 0.1,
      "20_2_#default#": 0.21,
      "49_37_yes": 0.2,
      "49_52_#default#": 0.31,
      "51_37_yes": 0.16,
      "55_22_#default#": 0.11,
      "55_40_yes": 0.57,
      "57_22_#default#": 0.1,
      "57_37_yes": 0.15,
      "58_17_#default#": 0.21,
      "58_29_yes": 0.26,
      "59_17_#default#": 0.35,
      "59_33_yes": 0.36,
      "60_22_#default#": 0.2,
      "60_48_yes": 0.46,
      "61_30_yes": 0.23,
      "61_52_#default#": 0.28,
      "9_11_yes": 0.37,
      "9_5_#default#": 0.18
    },
    "paper": {
      "dimensions": {
        "height": 7145,
        "width": 2390,
        "x": -110,
        "y": -840
      }
    }
  }
inputs:
- key: fileHash
  value:
    complex:
      root: incident
      accessor: filehash
  required: true
  description: The file hash to hunt for.
  playbookInputQuery: null
- key: SimilarityThreshold
  value:
    simple: "18"
  required: true
  description: SSDeep hashes with a similarity value equal to or greater than the
    value specified, will be considered as similar hashes.
  playbookInputQuery: null
- key: SearchFromDate
  value:
    simple: 2020-01-01T00:00:00
  required: false
  description: |-
    When looking for existing hashes in the system, this is the date that it will look for hashes from.
    The value should be in YYYY-MM-DDTHH:MM:SS.
    For example: 2022-02-15T08:31:00
  playbookInputQuery: null
- key: EnrichExistingIndicators
  value:
    simple: "False"
  required: false
  description: 'Whether indicators found in XSOAR will be enriched using the enrichIndicators
    command. Note: this may use up quota in your threat intelligence products. This
    is used to increase the SSDeep pool size to improve the coverage when comparing
    the input hash against other SSDeeps in the system.'
  playbookInputQuery: null
outputs: []
sourceplaybookid: d88693b5-2dc6-47a8-8ed6-f91c24e623a5
