id: Gmail Single User - Test
version: -1
name: Gmail Single User - Test
description: ""
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: cb2177e2-0357-4b85-8d62-5cc724fb1318
    type: start
    task:
      id: cb2177e2-0357-4b85-8d62-5cc724fb1318
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: edf2c61d-59ff-48cf-88b7-ee93a5a94b75
    type: regular
    task:
      id: edf2c61d-59ff-48cf-88b7-ee93a5a94b75
      version: -1
      name: Delete context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "39"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: 4e7ed453-0e86-4214-8fd7-99f610a771b3
    type: regular
    task:
      id: 4e7ed453-0e86-4214-8fd7-99f610a771b3
      version: -1
      name: Send mail using Gmail Single User
      description: Sends mail using Gmail.
      script: Gmail Single User|||send-mail
      type: regular
      iscommand: true
      brand: Gmail Single User
    nexttasks:
      '#none#':
      - "38"
    scriptarguments:
      body:
        simple: this is a test by playbook
      subject:
        simple: special test via playbook (${RandomString})
      to:
        simple: yarden@demistodev.com
      transientFile:
        simple: test.txt
      transientFileContent:
        simple: this is a test text inside a test attachment mail!
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 39240bb5-c4c4-4011-86ba-6a8c9e231a0d
    type: regular
    task:
      id: 39240bb5-c4c4-4011-86ba-6a8c9e231a0d
      version: -1
      name: Wait for mail to be received
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      seconds:
        simple: "10"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: daabaf36-034b-48c1-86a3-792951e2608b
    type: regular
    task:
      id: daabaf36-034b-48c1-86a3-792951e2608b
      version: -1
      name: Search for email sent and get ID
      description: Searches for Gmail records of a specified Google user.
      script: Gmail|||gmail-search
      type: regular
      iscommand: true
      brand: Gmail
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      include-spam-trash:
        simple: "true"
      query:
        simple: from:${Testmail.Sender} subject:special test via playbook (${RandomString})
          newer_than:1d
      user-id:
        simple: ${Testmail.Sender}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: b6962ca5-5b44-4548-80c4-f0e9f126c2e2
    type: condition
    task:
      id: b6962ca5-5b44-4548-80c4-f0e9f126c2e2
      version: -1
      name: Check if email was found (if ID exists)
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "8"
      "yes":
      - "7"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: Email.ID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 564f694c-9365-4213-844b-0273b0491fa3
    type: regular
    task:
      id: 564f694c-9365-4213-844b-0273b0491fa3
      version: -1
      name: Delete email list from context
      description: |-
        Because of how the googleapps integration is built, both fetching meta-data about the email ID and fetching the email itself, create record under Email key, which in turn duplicated a record with the same key&value of ID, thus preventing us from verifying our data later.

        The simple solution: delete the old entry after the ID was stored in the context.
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      key:
        simple: Email
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: 5b32c2e3-ae0b-47bb-81c0-e1f64b3db242
    type: regular
    task:
      id: 5b32c2e3-ae0b-47bb-81c0-e1f64b3db242
      version: -1
      name: Save the retrieved mail's ID under a key for search in inbox
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      key:
        simple: Testmail.ID
      value:
        complex:
          root: Email
          accessor: ID
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 4efc2fd1-d1fc-4893-8732-3b1d4d7f713f
    type: regular
    task:
      id: 4efc2fd1-d1fc-4893-8732-3b1d4d7f713f
      version: -1
      name: Wait for mail to receive
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      seconds:
        simple: "10"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 172.5,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: f8c528ba-f70c-4a94-8988-38b307c55a92
    type: regular
    task:
      id: f8c528ba-f70c-4a94-8988-38b307c55a92
      version: -1
      name: Search for email sent (ID)
      description: Searches for Gmail records of a specified Google user.
      script: Gmail|||gmail-search
      type: regular
      iscommand: true
      brand: Gmail
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      include-spam-trash:
        simple: "true"
      query:
        simple: from:${Testmail.Sender} subject:special test via playbook (${RandomString})
          newer_than:1d
      user-id:
        simple: ${Testmail.Sender}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 172.5,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: 608a7024-24d0-4b52-86e9-57848ea0080d
    type: condition
    task:
      id: 608a7024-24d0-4b52-86e9-57848ea0080d
      version: -1
      name: Check if email was found
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "16"
      "yes":
      - "7"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: Email.ID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 172.5,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 20723448-eba3-4ba4-8c6d-4dd0715e7acf
    type: regular
    task:
      id: 20723448-eba3-4ba4-8c6d-4dd0715e7acf
      version: -1
      name: Fetch email from google mail using message ID
      description: Retrieves the Gmail message sent to a specified user.
      script: Gmail|||gmail-get-mail
      type: regular
      iscommand: true
      brand: Gmail
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      message-id:
        simple: ${Testmail.ID}
      user-id:
        simple: ${Testmail.Sender}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": 2820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: 0a1bb710-0f13-4133-82b1-c25c184a279c
    type: condition
    task:
      id: 0a1bb710-0f13-4133-82b1-c25c184a279c
      version: -1
      name: Check for attachments
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "14"
      "yes":
      - "13"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: Email.Attachments
            iscontext: true
          right:
            value: {}
      - - operator: isEqualString
          left:
            value:
              simple: Email.ID
            iscontext: true
          right:
            value:
              simple: Testmail.ID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": 2995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: f7a3a224-65a6-4623-8ded-434b5f86cf27
    type: title
    task:
      id: f7a3a224-65a6-4623-8ded-434b5f86cf27
      version: -1
      name: Test email was found with the attachment!
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "19"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 705,
          "y": 3185
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 7c8cf212-6e9c-4fb5-89f7-789d2946b621
    type: regular
    task:
      id: 7c8cf212-6e9c-4fb5-89f7-789d2946b621
      version: -1
      name: Email found without attachment
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: Email found without attachment
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 275,
          "y": 3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 4d3be60b-a9e3-403a-8c44-a02b0fd542f0
    type: regular
    task:
      id: 4d3be60b-a9e3-403a-8c44-a02b0fd542f0
      version: -1
      name: Test failed
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: Email was not found
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: 7930b2c1-a187-4784-8b40-28df4e7197bc
    type: regular
    task:
      id: 7930b2c1-a187-4784-8b40-28df4e7197bc
      version: -1
      name: Wait for mail to receive
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      seconds:
        simple: "10"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: 94d6e6cf-77f2-4f9f-86a0-12328480529c
    type: regular
    task:
      id: 94d6e6cf-77f2-4f9f-86a0-12328480529c
      version: -1
      name: Search for email sent (ID)
      description: Searches for Gmail records of a specified Google user.
      script: Gmail|||gmail-search
      type: regular
      iscommand: true
      brand: Gmail
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      include-spam-trash:
        simple: "true"
      query:
        simple: from:${Testmail.Sender} subject:special test via playbook (${RandomString})
          newer_than:1d
      user-id:
        simple: ${Testmail.Sender}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: dc341360-39a1-4676-889b-bfcfd5152d6e
    type: condition
    task:
      id: dc341360-39a1-4676-889b-bfcfd5152d6e
      version: -1
      name: Check if email was found
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "15"
      "yes":
      - "7"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: Email.ID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: d0d96fda-dcce-4ed1-812c-6fe6bca4557e
    type: regular
    task:
      id: d0d96fda-dcce-4ed1-812c-6fe6bca4557e
      version: -1
      name: Start Over - Send several files
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "33"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 705,
          "y": 3345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 3a275048-98b6-409e-88b7-552a18297bbd
    type: regular
    task:
      id: 3a275048-98b6-409e-88b7-552a18297bbd
      version: -1
      name: Send mail with transient attachments and file
      description: Sends mail using Gmail.
      script: Gmail Single User|||send-mail
      type: regular
      iscommand: true
      brand: Gmail Single User
    nexttasks:
      '#none#':
      - "21"
    scriptarguments:
      attachIDs:
        simple: ${File.EntryID}
      attachNames:
        simple: attach.txt
      body:
        simple: this is a test by playbook
      subject:
        simple: multi attachment test via playbook (${RandomString})
      to:
        simple: yarden@demistodev.com
      transientFile:
        simple: test.txt,test2.txt
      transientFileContent:
        simple: this is a test text inside a test attachment mail!,another mail content.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 705,
          "y": 3695
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: 0aa13f04-cef0-4634-8947-0dfea5f8dae9
    type: regular
    task:
      id: 0aa13f04-cef0-4634-8947-0dfea5f8dae9
      version: -1
      name: Wait for mail to be received
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      seconds:
        simple: "10"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 705,
          "y": 3870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 19fc1d3d-4ed5-4531-8e25-c71dfa241279
    type: regular
    task:
      id: 19fc1d3d-4ed5-4531-8e25-c71dfa241279
      version: -1
      name: Search for email sent and get ID
      description: Searches for Gmail records of a specified Google user.
      script: Gmail|||gmail-search
      type: regular
      iscommand: true
      brand: Gmail
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      include-spam-trash:
        simple: "true"
      query:
        simple: from:${Testmail.Sender} subject:multi attachment test via playbook
          (${RandomString}) newer_than:1d
      user-id:
        simple: ${Testmail.Sender}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 705,
          "y": 4045
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: 1dbfa847-9b29-41bd-8e94-c5a2dee15e4e
    type: condition
    task:
      id: 1dbfa847-9b29-41bd-8e94-c5a2dee15e4e
      version: -1
      name: Check if email was found (if ID exists)
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "24"
      "yes":
      - "30"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: Email.ID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 705,
          "y": 4220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: ca791a0c-a7e6-4b9b-8bec-e85365673025
    type: regular
    task:
      id: ca791a0c-a7e6-4b9b-8bec-e85365673025
      version: -1
      name: Wait for mail to be received
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "25"
    scriptarguments:
      seconds:
        simple: "10"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 602.5,
          "y": 4395
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "25":
    id: "25"
    taskid: 55d49392-3779-422e-8dba-6a80b3bc905d
    type: regular
    task:
      id: 55d49392-3779-422e-8dba-6a80b3bc905d
      version: -1
      name: Search for email sent and get ID
      description: Searches for Gmail records of a specified Google user.
      script: Gmail|||gmail-search
      type: regular
      iscommand: true
      brand: Gmail
    nexttasks:
      '#none#':
      - "26"
    scriptarguments:
      include-spam-trash:
        simple: "true"
      query:
        simple: from:${Testmail.Sender} subject:multi attachment test via playbook
          (${RandomString}) newer_than:1d
      user-id:
        simple: ${Testmail.Sender}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 602.5,
          "y": 4570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: 0c15a66a-5340-489a-8af1-7ce26810deab
    type: condition
    task:
      id: 0c15a66a-5340-489a-8af1-7ce26810deab
      version: -1
      name: Check if email was found (if ID exists)
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "28"
      "yes":
      - "30"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: Email.ID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 602.5,
          "y": 4745
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: 2e98d2f6-ebff-4b14-891f-afa6a8914b60
    type: condition
    task:
      id: 2e98d2f6-ebff-4b14-891f-afa6a8914b60
      version: -1
      name: Check if email was found (if ID exists)
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "15"
      "yes":
      - "30"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: Email.ID
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 490,
          "y": 5270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: adbd856a-e373-408a-80dc-dc45c5625c5b
    type: regular
    task:
      id: adbd856a-e373-408a-80dc-dc45c5625c5b
      version: -1
      name: Wait for mail to be received
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      seconds:
        simple: "10"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 490,
          "y": 4920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: b86ee19d-a832-4651-8dc0-07f9a11d2ce3
    type: regular
    task:
      id: b86ee19d-a832-4651-8dc0-07f9a11d2ce3
      version: -1
      name: Search for email sent and get ID
      description: Searches for Gmail records of a specified Google user.
      script: Gmail|||gmail-search
      type: regular
      iscommand: true
      brand: Gmail
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      include-spam-trash:
        simple: "true"
      query:
        simple: from:${Testmail.Sender} subject:multi attachment test via playbook
          (${RandomString}) newer_than:1d
      user-id:
        simple: ${Testmail.Sender}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 490,
          "y": 5095
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: 98fb2feb-b9d9-4da6-8311-d279e4326b27
    type: regular
    task:
      id: 98fb2feb-b9d9-4da6-8311-d279e4326b27
      version: -1
      name: Save the retrieved mail's ID under a key for search in inbox
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      key:
        simple: Testmail.ID
      value:
        complex:
          root: Email
          accessor: ID
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 725,
          "y": 5445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: bb582f2f-cc3b-4e6d-8a03-a389fac6d9c9
    type: regular
    task:
      id: bb582f2f-cc3b-4e6d-8a03-a389fac6d9c9
      version: -1
      name: Delete email list from context
      description: |-
        Because of how the googleapps integration is built, both fetching meta-data about the email ID and fetching the email itself, create record under Email key, which in turn duplicated a record with the same key&value of ID, thus preventing us from verifying our data later.

        The simple solution: delete the old entry after the ID was stored in the context.
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      key:
        simple: Email
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 725,
          "y": 5620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: 419c3811-3f22-48d6-8d61-355f2aa0b73a
    type: regular
    task:
      id: 419c3811-3f22-48d6-8d61-355f2aa0b73a
      version: -1
      name: Fetch email from google mail using message ID
      description: Retrieves the Gmail message sent to a specified user.
      script: '|||gmail-get-mail'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      message-id:
        simple: ${Testmail.ID}
      user-id:
        simple: ${Testmail.Sender}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 725,
          "y": 5795
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: 390a42ca-18a1-482b-8c9d-a04e9326c7b8
    type: regular
    task:
      id: 390a42ca-18a1-482b-8c9d-a04e9326c7b8
      version: -1
      name: Create a new File
      scriptName: FileCreateAndUpload
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      data:
        simple: WarRoom File
      filename:
        simple: attachment1.txt
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 705,
          "y": 3520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: cd15953e-9124-4ecf-8ffe-9828e68593e2
    type: condition
    task:
      id: cd15953e-9124-4ecf-8ffe-9828e68593e2
      version: -1
      name: Check for attachments
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "35"
      "yes":
      - "37"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: Email.Attachments
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Email.ID
            iscontext: true
          right:
            value:
              simple: Testmail.ID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 725,
          "y": 5970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: 32e2bf9d-55cf-4898-8983-d77356e03215
    type: regular
    task:
      id: 32e2bf9d-55cf-4898-8983-d77356e03215
      version: -1
      name: Email found without attachment
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: Email found without attachment
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 510,
          "y": 6320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: 4450b3aa-d3b3-4cb1-8135-aa7d3e568166
    type: title
    task:
      id: 4450b3aa-d3b3-4cb1-8135-aa7d3e568166
      version: -1
      name: Finished Successfully
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 940,
          "y": 6335
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: d625865f-36e2-4ec5-87e6-5729a8fbbf37
    type: condition
    task:
      id: d625865f-36e2-4ec5-87e6-5729a8fbbf37
      version: -1
      name: Check for attachments
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "35"
      "yes":
      - "36"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: Email.Attachments
            iscontext: true
      - - operator: isEqualNumber
          left:
            value:
              complex:
                root: Email
                accessor: Attachments
                transformers:
                - operator: count
            iscontext: true
          right:
            value:
              simple: "3"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 6145
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: 2ab051df-145f-4773-88c4-aa1f7beeac84
    type: regular
    task:
      id: 2ab051df-145f-4773-88c4-aa1f7beeac84
      version: -1
      name: Set the email sender
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      key:
        simple: Testmail.Sender
      value:
        simple: ${Gmail.SentMail.From}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: 2160e46b-ad65-4703-8cf2-88e660a64b18
    type: regular
    task:
      id: 2160e46b-ad65-4703-8cf2-88e660a64b18
      version: -1
      name: Generate random string
      description: Generates random string
      scriptName: GenerateRandomString
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      Digits:
        simple: "True"
      Length:
        simple: "8"
      Lowercase:
        simple: "False"
      Punctuation:
        simple: "False"
      Uppercase:
        simple: "False"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "10_16_#default#": 0.9,
      "10_7_yes": 0.34,
      "18_7_yes": 0.37
    },
    "paper": {
      "dimensions": {
        "height": 6365,
        "width": 1270,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
fromversion: 5.0.0