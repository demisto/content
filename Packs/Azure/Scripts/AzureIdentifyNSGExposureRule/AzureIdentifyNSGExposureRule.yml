args:
- description: The Azure subscription ID where the NSG resides.
  name: subscription_id
  required: true
- description: The Azure resource group name where the NSG resides.
  name: resource_group_name
  required: true
- description: The Azure Network Security Group (NSG) name to analyze for exposure rules.
  name: network_security_group_name
  required: true
- description: The destination private IP address(es) of the Virtual Machine interface.
  name: private_ip_addresses
  required: true
  isArray: true
- description: The TCP/UDP port to restrict.
  name: port
  required: true
- description: The protocol of the port to restrict.
  auto: PREDEFINED
  name: protocol
  predefined:
  - tcp
  - udp
  required: true
- description: The number of available priority values below the matching rule to return.
  name: priority_count
  defaultValue: '2'
- description: The Azure integration instance to use.
  name: integration_instance
comment: Identifies the first inbound Allow rule in a specified NSG that matches network exposure criteria. Returns rule details and a list of available priority numbers for inserting higher-priority rules.
commonfields:
  id: AzureIdentifyNSGExposureRule
  version: -1
enabled: true
name: AzureIdentifyNSGExposureRule
outputs:
- contextPath: AzurePublicExposure.MatchingRuleName
  description: The name of the matching inbound security rule in the NSG that allows exposure.
  type: String
- contextPath: AzurePublicExposure.MatchingRulePriority
  description: The priority number of the matching inbound security rule.
  type: Number
- contextPath: AzurePublicExposure.NextAvailablePriorityValues
  description: The available priority values, in descending order, for inserting rules before the matching rule.
  type: Unknown
- contextPath: AzurePublicExposure.IntegrationInstance
  description: The Azure integration instance used for identification.
  type: String
script: ''
system: false
timeout: '0'
type: python
subtype: python3
dependson:
  must:
  - Azure|||azure-nsg-security-rules-list
dockerimage: demisto/python3:3.12.12.6922358
fromversion: 6.10.0
tests:
- No tests (auto formatted)
