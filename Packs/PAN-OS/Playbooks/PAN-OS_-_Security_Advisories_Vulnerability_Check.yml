description: This playbook takes a CVE ID as published on the Palo Alto Networks Security
  Advisories page as input and checks if any Palo Alto Networks firewalls in your
  environment have PAN-OS software versions or GlobalProtect client package versions
  that are vulnerable to the specified CVE. It accepts an optional target parameter
  to check a specific firewall by serial number. If a non-Palo Alto Networks CVE is provided,
  the playbook will return an empty json output.
id: PAN-OS - Security Advisories Vulnerability Check
inputSections:
- description: Generic group for inputs
  inputs:
  - cve_id
  - target
  name: General (Inputs group)
inputs:
- description: The CVE ID published on the Palo Alto Networks Security Advisories
    page to check if any firewalls are impacted by it.
  key: cve_id
  playbookInputQuery: null
  required: true
  value: {}
- description: The serial number of a specific firewall to check for impact by the
    above mentioned CVE.
  key: target
  playbookInputQuery: null
  required: false
  value: {}
name: PAN-OS - Security Advisories Vulnerability Check
outputSections:
- description: Generic group for outputs
  name: General (Outputs group)
  outputs:
  - CVE_Check.CVE_ID
  - CVE_Check.Result
  - CVE_Check.Severity
outputs:
- contextPath: CVE_Check.CVE_ID
  description: ID of the CVE being checked.
  type: string
- contextPath: CVE_Check.Result
  description: |-
    Result of the assessment for the input CVE with details about the firewall in the following json format:
    {
     Hostname : string,
     IPAddress : string,
     SWVersion : string,
     IsFirewallVersionAffected : True/False,
     GlobalProtectVersion : string,
     GlobalProtectVersionAffected: True/False
    }
  type: unknown
- contextPath: CVE_Check.Severity
  description: Severity of the CVE being assessed.
  type: string
quiet: true
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: aa3f93f2-095d-467c-86d1-ffca90fa7947
      description: Start task to initialize playbook execution
      iscommand: false
      name: ""
      version: -1
    taskid: aa3f93f2-095d-467c-86d1-ffca90fa7947
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 450,
          "y": 50
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2954c1f1-4f78-4757-8f19-53f0b75ba31b
      description: Section header for tasks to enrich cve and validate it.
      iscommand: false
      name: Gather CVE Info
      type: title
      version: -1
    taskid: 2954c1f1-4f78-4757-8f19-53f0b75ba31b
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 450,
          "y": 190
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      cve_id:
        simple: ${inputs.cve_id}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: This script enriches CVEs published by Palo Alto Networks with
        detailed vulnerability information from the official Palo Alto Networks Security
        Advisories website https://security.paloaltonetworks.com.
      id: 3f813a0a-9c0d-4137-83a6-6f6994bb2701
      iscommand: false
      name: PAN-OS_Security_Advisories_Enrichment
      script: PAN-OS_Security_Advisories_Enrichment
      type: regular
      version: -1
    taskid: 3f813a0a-9c0d-4137-83a6-6f6994bb2701
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 340
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 82e2a4f3-e343-466c-8604-9b35fa10ba95
      description: Section header for tasks to retrieve PAN-OS system information for vulnerability assessment
      iscommand: false
      name: Get PAN-OS system info
      type: title
      version: -1
    taskid: 82e2a4f3-e343-466c-8604-9b35fa10ba95
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 450,
          "y": 680
        }
      }
  "4":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: state
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: modules.brand
                    operator: isEqualString
                    right:
                      value:
                        simple: Panorama
                root: modules
          operator: isEqualString
          right:
            value:
              simple: active
      label: "yes"
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "8"
      "yes":
      - "5"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Conditional task to check if Panorama integration is enabled.
      id: bacd3b82-02bf-4394-805a-5a95e0850ed3
      iscommand: false
      name: Is Panorama integration enabled?
      type: condition
      version: -1
    taskid: bacd3b82-02bf-4394-805a-5a95e0850ed3
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 450,
          "y": 830
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      target:
        simple: ${inputs.target}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Panorama
      description: Gets information from all PAN-OS systems in the topology.
      id: 0249a399-61a2-4722-839d-ee79b7550ac1
      iscommand: true
      name: pan-os-platform-get-system-info
      script: Panorama|||pan-os-platform-get-system-info
      type: regular
      version: -1
    taskid: 0249a399-61a2-4722-839d-ee79b7550ac1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1010
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9de36e2f-0644-4336-8bec-34e8b8748222
      description: Section header for tasks to analyze and identify firewall vulnerabilities based on retrieved system information and CVE details
      iscommand: false
      name: Check firewalls for impact
      type: title
      version: -1
    taskid: 9de36e2f-0644-4336-8bec-34e8b8748222
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1340
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      cve_json:
        simple: ${PANOSSecurityAdvisories.Advisory}
      pan_os_system_info_list:
        complex:
          accessor: Result
          root: PANOS.ShowSystemInfo
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if the software version or global protect client package
        version of any firewalls is impacted by this CVE.
      id: 2b34aef1-f1af-4f02-adc9-1c2c3855c8c7
      iscommand: false
      name: CheckFirewallAndGPForCVEs
      script: CheckFirewallAndGPForCVEs
      type: regular
      version: -1
    taskid: 2b34aef1-f1af-4f02-adc9-1c2c3855c8c7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1490
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a06c4b8f-3ab4-4d32-8903-058884ecb153
      description: Final task to mark the completion of the PAN-OS Security Advisory Vulnerability Check playbook
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: a06c4b8f-3ab4-4d32-8903-058884ecb153
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1660
        }
      }
  "9":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: PANOSSecurityAdvisories.Advisory.cve_id
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "8"
      "yes":
      - "3"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6ef5bc35-5213-47a6-93ad-21655981b9ac
      description: Checks if a valid CVE has been identified in the security advisory enrichment process
      iscommand: false
      name: Was it a valid CVE?
      type: condition
      version: -1
    taskid: 6ef5bc35-5213-47a6-93ad-21655981b9ac
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 450,
          "y": 490
        }
      }
  "10":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: PANOS.ShowSystemInfo.Summary.sw_version
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "8"
      "yes":
      - "6"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 78e210c6-fe3b-4740-aeef-c3c0660c7e6d
      description: Checks if system information was successfully retrieved from PAN-OS device
      iscommand: false
      name: Was System Info retrieved?
      type: condition
      version: -1
    taskid: 78e210c6-fe3b-4740-aeef-c3c0660c7e6d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1150
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "10_6_yes": 0.54,
      "10_8_#default#": 0.25,
      "4_5_yes": 0.45,
      "4_8_#default#": 0.2,
      "9_3_yes": 0.56,
      "9_8_#default#": 0.14
    },
    "paper": {
      "dimensions": {
        "height": 1670,
        "width": 380,
        "x": 450,
        "y": 50
      }
    }
  }
fromversion: 6.0.0