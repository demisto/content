id: 'PAN-OS - Security Advisories Vulnerability Check'
inputSections:
- description: Generic group for inputs
  inputs:
  - cve_id
  - target
  name: General (Inputs group)
inputs:
- description: The CVE ID published on the Palo Alto Networks Security Advisories page to check if any firewalls are impacted by it.
  key: cve_id
  playbookInputQuery:
  required: true
  value: {}
- description: The serial number of a specific firewall to check for impact by the above mentioned CVE.
  key: target
  playbookInputQuery:
  required: false
  value: {}
name: PAN-OS - Security Advisories Vulnerability Check
description: This playbook takes a CVE ID as published on the Palo Alto Networks Security Advisories page as input and checks if any Palo Alto Networks firewalls in your environment have PAN-OS software versions or GlobalProtect client package versions that are vulnerable to the specified CVE. The playbook will error if a non-PANW CVE is provided. It accepts an optional target parameter to check a specific firewall by serial number.
outputSections:
- description: Generic group for outputs
  name: General (Outputs group)
  outputs:
  - CVE_Check.CVE_ID
  - CVE_Check.Result
  - CVE_Check.Severity
outputs:
- contextPath: CVE_Check.CVE_ID
  description: ID of the CVE checked.
- contextPath: CVE_Check.Result
  description: |-
    Result of the assessment for the input CVE with details about the firewall in the following json format:
    {
     Hostname : string,
     IPAddress : string,
     SWVersion : string,
     IsFirewallVersionAffected : True/False,
     GlobalProtectVersion : string,
     IsGlobalProtectVersionAffected: True/False
    }
- contextPath: CVE_Check.Severity
  description: Severity of the CVE checked.
quiet: true
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ac6b1bf6-d3b3-40e1-88f4-14700a5adbf2
      iscommand: false
      name: ""
      version: -1
      description: ''
    taskid: ac6b1bf6-d3b3-40e1-88f4-14700a5adbf2
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 450,
          "y": 50
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      cve_id:
        simple: ${inputs.cve_id}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Enrich PANW CVEs from the Security Advisories website
      id: ec566c12-10ed-42fd-850a-29c07dfa9d37
      iscommand: false
      name: Enrich CVE
      script: CVEEnrichment_PANWSecurityAdvisories
      type: regular
      version: -1
    taskid: ec566c12-10ed-42fd-850a-29c07dfa9d37
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 210
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 77c5f9ba-2587-4441-b5e2-855b14baa854
      iscommand: false
      name: Gather PAN-OS and GP version info
      type: title
      version: -1
      description: ''
    taskid: 77c5f9ba-2587-4441-b5e2-855b14baa854
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 450,
          "y": 374
        }
      }
  "4":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: state
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: modules.brand
                    operator: isEqualString
                    right:
                      value:
                        simple: Panorama
                root: modules
          operator: isEqualString
          right:
            value:
              simple: active
      label: "yes"
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "6"
      "yes":
      - "5"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether the values provided in arguments are equal. If either of the arguments are missing, no is returned.
      id: 20a19b12-e4e4-4458-8777-60ce2a7d1f9f
      iscommand: false
      name: Is Panorama Integration configured and enabled?
      type: condition
      version: -1
    taskid: 20a19b12-e4e4-4458-8777-60ce2a7d1f9f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 450,
          "y": 538
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      target:
        simple: ${inputs.target}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Gets information from all PAN-OS systems in the topology.
      id: 2f7ef380-7431-4bee-9e2e-b16dbb35c6a7
      iscommand: true
      name: Get PAN-OS System Info
      script: '|||pan-os-platform-get-system-info'
      type: regular
      version: -1
    taskid: 2f7ef380-7431-4bee-9e2e-b16dbb35c6a7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 722
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cc71af6a-d97f-40ed-9f9a-c489c75295b7
      iscommand: false
      name: Panorama integration not configured
      type: title
      version: -1
      description: ''
    taskid: cc71af6a-d97f-40ed-9f9a-c489c75295b7
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1000,
          "y": 722
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      cve_json:
        simple: ${PAN_OS_Security_Advisories.Advisory}
      panos_system_info_list:
        simple: ${PANOS.ShowSystemInfo.Result}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b8aeccaa-d3b3-4368-a3df-6bd90207c01e
      iscommand: false
      name: Check if FW or GP are impacted by the CVE
      script: CheckFirewallAndGPForCVEs
      version: -1
    taskid: b8aeccaa-d3b3-4368-a3df-6bd90207c01e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 898
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cdbe8a4a-32b1-4d41-8728-38c41faa3328
      iscommand: false
      name: Done
      type: title
      version: -1
      description: ''
    taskid: cdbe8a4a-32b1-4d41-8728-38c41faa3328
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1084
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "4_5_yes": 0.46
    },
    "paper": {
      "dimensions": {
        "height": 1094,
        "width": 931,
        "x": 450,
        "y": 50
      }
    }
  }
fromversion: 6.0.0
tests:
- PAN-OS-firewall-topology-test-pb
- PAN-OS-panorama-topology-test-pb
