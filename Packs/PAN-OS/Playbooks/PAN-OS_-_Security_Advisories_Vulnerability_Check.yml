id: 'PAN-OS - Security Advisories Vulnerability Check'
inputSections:
- description: Generic group for inputs
  inputs:
  - cve_id
  - target
  name: General (Inputs group)
inputs:
- description: The CVE ID published on the Palo Alto Networks Security Advisories page to check if any firewalls are impacted by it.
  key: cve_id
  playbookInputQuery:
  required: true
  value: {}
- description: The serial number of a specific firewall to check for impact by the above mentioned CVE.
  key: target
  playbookInputQuery:
  required: false
  value: {}
name: PAN-OS - Security Advisories Vulnerability Check
outputSections:
- description: Generic group for outputs
  name: General (Outputs group)
  outputs:
  - CVE_Check.CVE_ID
  - CVE_Check.Result
  - CVE_Check.Severity
outputs:
- contextPath: CVE_Check.CVE_ID
  description: ID of the CVE being checked.
  type: string
- contextPath: CVE_Check.Result
  description: |-
    Result of the assessment for the input CVE with details about the firewall in the following json format:
    {
     Hostname : string,
     IPAddress : string,
     SWVersion : string,
     IsFirewallVersionAffected : True/False,
     GlobalProtectVersion : string,
     GlobalProtectVersionAffected: True/False
    }
  type: unknown
- contextPath: CVE_Check.Severity
  description: Severity of the CVE being assessed.
  type: string
quiet: true
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4cf66334-15a3-4e41-8424-40afbdc0af5b
      iscommand: false
      name: ""
      version: -1
      description: ''
    taskid: 4cf66334-15a3-4e41-8424-40afbdc0af5b
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 450,
          "y": 50
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 843f152a-72b8-4314-aedd-54d6e2a0374e
      iscommand: false
      name: Gather CVE Info
      type: title
      version: -1
      description: ''
    taskid: 843f152a-72b8-4314-aedd-54d6e2a0374e
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 450,
          "y": 190
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      cve_id:
        simple: ${inputs.cve_id}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: This script enriches CVEs published by Palo Alto Networks with detailed vulnerability information from the official Palo Alto Networks Security Advisories website https://security.paloaltonetworks.com.
      id: fcf80ffd-dcbe-469b-a8ab-4d2d52b0ed2e
      iscommand: false
      name: PAN-OS_Security_Advisories_Enrichment
      script: PAN-OS_Security_Advisories_Enrichment
      type: regular
      version: -1
    taskid: fcf80ffd-dcbe-469b-a8ab-4d2d52b0ed2e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 340
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b67246a1-9644-44f4-9d94-16fda6b8cd6c
      iscommand: false
      name: Get PAN-OS system info
      type: title
      version: -1
      description: ''
    taskid: b67246a1-9644-44f4-9d94-16fda6b8cd6c
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 450,
          "y": 490
        }
      }
  "4":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: state
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: modules.brand
                    operator: isEqualString
                    right:
                      value:
                        simple: Panorama
                root: modules
          operator: isEqualString
          right:
            value:
              simple: active
      label: "yes"
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "8"
      "yes":
      - "5"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 12d37635-fe77-422e-84b5-cc2e915e7477
      iscommand: false
      name: Is Panorama integration enabled?
      type: condition
      version: -1
    taskid: 12d37635-fe77-422e-84b5-cc2e915e7477
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 450,
          "y": 640
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      target:
        simple: ${inputs.target}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Panorama
      description: Gets information from all PAN-OS systems in the topology.
      id: e698cfce-93d0-4883-9973-77942f6fdaae
      iscommand: true
      name: pan-os-platform-get-system-info
      script: Panorama|||pan-os-platform-get-system-info
      type: regular
      version: -1
    taskid: e698cfce-93d0-4883-9973-77942f6fdaae
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 820
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1b9c30f2-51bb-4a03-bc22-dd747c2d284d
      iscommand: false
      name: Check firewalls for impact
      type: title
      version: -1
      description: ''
    taskid: 1b9c30f2-51bb-4a03-bc22-dd747c2d284d
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 450,
          "y": 990
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      cve_json:
        simple: ${PAN-OS_Security_Advisories.Advisory}
      pan_os_system_info_list:
        simple: ${PANOS.ShowSystemInfo.Result}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 07ae10ab-11f0-471b-92ae-c4b7fe7f254d
      iscommand: false
      name: CheckFirewallAndGPForCVEs
      script: CheckFirewallAndGPForCVEs
      type: regular
      version: -1
    taskid: 07ae10ab-11f0-471b-92ae-c4b7fe7f254d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1150
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 87df800b-2c2b-4d1d-aefb-50d7c7a5bd38
      iscommand: false
      name: Done
      type: title
      version: -1
      description: ''
    taskid: 87df800b-2c2b-4d1d-aefb-50d7c7a5bd38
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1330
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "4_5_yes": 0.45
    },
    "paper": {
      "dimensions": {
        "height": 1340,
        "width": 380,
        "x": 450,
        "y": 50
      }
    }
  }
tests:
- No tests (auto formatted)
fromversion: 6.0.0