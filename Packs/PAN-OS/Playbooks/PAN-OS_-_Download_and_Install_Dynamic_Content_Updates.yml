description: "This playbook automates the download and installation of the following Dynamic Update types on Palo Alto firewalls:\n  - App/Threat\n  - Anti-Virus\n  - WildFire\n  - GlobalProtect Clientless VPN\n\nUse the \"itemsToUpdate\" input to control which update type(s) to download and install.  All types are updated by default.\n\nNOTE: This playbook is intended for use with a single PAN-OS Integration Instance."
id: PAN-OS - Download and Install Dynamic Content Updates
inputSections:
- description: Generic group for inputs
  inputs:
  - targetDevice
  - itemsToUpdate
  name: General (Inputs group)
inputs:
- description: "The serial number of a specific firewall to target (Used when connected to Panorama) [Optional].\n"
  key: targetDevice
  playbookInputQuery:
  required: false
  value: {}
- description: "Specifies which item types to download and install.  Select ONE of the following options:\nall\napp/threat\nanti-virus\nwildfire\ngp"
  key: itemsToUpdate
  playbookInputQuery:
  required: true
  value:
    simple: all
name: PAN-OS - Download and Install Dynamic Content Updates
outputSections:
- description: Generic group for outputs
  name: General (Outputs group)
  outputs:
  - DynamicUpdates
outputs:
- contextPath: DynamicUpdates
  description: A dictionary containing details of the Dynamic Update type(s) downloaded and installed, including their version number and associated job IDs.
  type: unknown
quiet: true
starttaskid: '0'
tasks:
  '0':
    continueonerrortype: ''
    id: '0'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '1'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: ae08e3f3-db0a-454b-8f86-d5b01a78e5df
      iscommand: false
      name: ''
      version: -1
      description: ''
    taskid: ae08e3f3-db0a-454b-8f86-d5b01a78e5df
    timertriggers: []
    type: start
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 70\n  }\n}"
  '1':
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              simple: inputs.itemsToUpdate
          operator: containsGeneral
          right:
            value:
              simple: all
      label: All Types
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              simple: inputs.itemsToUpdate
          operator: containsGeneral
          right:
            value:
              simple: app/threat
      label: App/Threat
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              simple: inputs.itemsToUpdate
          operator: containsGeneral
          right:
            value:
              simple: anti-virus
      label: Anti-Virus
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              simple: inputs.itemsToUpdate
          operator: containsGeneral
          right:
            value:
              simple: wildfire
      label: WildFire
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              simple: inputs.itemsToUpdate
          operator: containsGeneral
          right:
            value:
              simple: gp
      label: GP
    continueonerrortype: ''
    id: '1'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      All Types:
      - '2'
      Anti-Virus:
      - '12'
      App/Threat:
      - '11'
      GP:
      - '14'
      WildFire:
      - '13'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Determine dynamic update type(s) to install based on playbook input.
      id: b1e1b6a3-c43f-4cb2-9237-c4177bc92269
      iscommand: false
      name: Identify Dynamic Update Type(s) To Download/Install
      type: condition
      version: -1
    taskid: b1e1b6a3-c43f-4cb2-9237-c4177bc92269
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 250\n  }\n}"
  '2':
    continueonerrortype: ''
    id: '2'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '3'
      - '5'
      - '7'
      - '9'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: 398bcca4-8b0e-41b0-a699-c248b4c72781
      iscommand: false
      name: Update All Types
      type: title
      version: -1
      description: ''
    taskid: 398bcca4-8b0e-41b0-a699-c248b4c72781
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 450\n  }\n}"
  '3':
    continueonerrortype: ''
    id: '3'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '4'
    note: false
    quietmode: 0
    scriptarguments:
      polling:
        simple: 'true'
      target:
        simple: ${inputs.targetDevice}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Downloads the latest app/threat dynamic update.
      id: af78fea2-5a0d-4622-b4d7-7d2e409b642e
      iscommand: true
      name: Download Latest App/Threat Update
      script: '|||pan-os-download-latest-content-update'
      type: regular
      version: -1
    taskid: af78fea2-5a0d-4622-b4d7-7d2e409b642e
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": -420,\n    \"y\": 670\n  }\n}"
  '4':
    continueonerrortype: ''
    id: '4'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '15'
    note: false
    quietmode: 0
    scriptarguments:
      polling:
        simple: 'true'
      target:
        simple: ${inputs.targetDevice}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Installs the latest app/threat dynamic update.
      id: 12b78d3c-6e7c-40df-8848-a8bf8bfa6e95
      iscommand: true
      name: Install Latest App/Threat Update
      script: '|||pan-os-install-latest-content-update'
      type: regular
      version: -1
    taskid: 12b78d3c-6e7c-40df-8848-a8bf8bfa6e95
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": -420,\n    \"y\": 890\n  }\n}"
  '5':
    continueonerrortype: ''
    id: '5'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '6'
    note: false
    quietmode: 0
    scriptarguments:
      target:
        simple: ${inputs.targetDevice}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Downloads the latest antivirus dynamic update.
      id: e0715674-719c-4179-b3a7-e5b8e15bb0e9
      iscommand: true
      name: Download Latest Anti-Virus Update
      script: '|||pan-os-download-latest-antivirus-update'
      type: regular
      version: -1
    taskid: e0715674-719c-4179-b3a7-e5b8e15bb0e9
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 20,\n    \"y\": 670\n  }\n}"
  '6':
    continueonerrortype: ''
    id: '6'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '16'
    note: false
    quietmode: 0
    scriptarguments:
      target:
        simple: ${inputs.targetDevice}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Installs the latest Antivirus update.
      id: b3244c7a-9b57-4fc0-8f7d-205aee1d3d56
      iscommand: true
      name: Install Latest Anti-Virus Update
      script: '|||pan-os-install-latest-antivirus-update'
      type: regular
      version: -1
    taskid: b3244c7a-9b57-4fc0-8f7d-205aee1d3d56
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 20,\n    \"y\": 890\n  }\n}"
  '7':
    continueonerrortype: ''
    id: '7'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '8'
    note: false
    quietmode: 0
    scriptarguments:
      target:
        simple: ${inputs.targetDevice}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Downloads the latest WildFire dynamic update.
      id: 6f02f605-8d84-4f88-abf2-ca5230bf192c
      iscommand: true
      name: Download Latest WildFire Update
      script: '|||pan-os-download-latest-wildfire-update'
      type: regular
      version: -1
    taskid: 6f02f605-8d84-4f88-abf2-ca5230bf192c
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 890,\n    \"y\": 670\n  }\n}"
  '8':
    continueonerrortype: ''
    id: '8'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '17'
    note: false
    quietmode: 0
    scriptarguments:
      target:
        simple: ${inputs.targetDevice}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Installs the latest WildFire dynamic update.
      id: 30e46b47-600c-4a84-97d0-2866e651b938
      iscommand: true
      name: Install Latest WildFire Update
      script: '|||pan-os-install-latest-wildfire-update'
      type: regular
      version: -1
    taskid: 30e46b47-600c-4a84-97d0-2866e651b938
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 890,\n    \"y\": 890\n  }\n}"
  '9':
    continueonerrortype: ''
    id: '9'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '10'
    note: false
    quietmode: 0
    scriptarguments:
      target:
        simple: ${inputs.targetDevice}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Downloads the latest GlobalProtect Clientless VPN dynamic update.
      id: c1eefc32-ce5e-4858-b73c-fb6e3c63455c
      iscommand: true
      name: Download Latest GP Clientless VPN Update
      script: '|||pan-os-download-latest-gp-update'
      type: regular
      version: -1
    taskid: c1eefc32-ce5e-4858-b73c-fb6e3c63455c
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1320,\n    \"y\": 670\n  }\n}"
  '10':
    continueonerrortype: ''
    id: '10'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '18'
    note: false
    quietmode: 0
    scriptarguments:
      target:
        simple: ${inputs.targetDevice}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Installs the latest GlobalProtect Clientless VPN dynamic update.
      id: a953a1b0-f293-44df-9131-df3a21548d69
      iscommand: true
      name: Install Latest GP Clientless VPN Update
      script: '|||pan-os-install-latest-gp-update'
      type: regular
      version: -1
    taskid: a953a1b0-f293-44df-9131-df3a21548d69
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1320,\n    \"y\": 890\n  }\n}"
  '11':
    continueonerrortype: ''
    id: '11'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '3'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: 5232d21f-2ca6-4123-9a11-b74d7852615c
      iscommand: false
      name: App/Threat Only
      type: title
      version: -1
      description: ''
    taskid: 5232d21f-2ca6-4123-9a11-b74d7852615c
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": -420,\n    \"y\": 450\n  }\n}"
  '12':
    continueonerrortype: ''
    id: '12'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '5'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: 19ba4187-000d-47dd-a69e-bb0ac562dbc1
      iscommand: false
      name: Anti-Virus Only
      type: title
      version: -1
      description: ''
    taskid: 19ba4187-000d-47dd-a69e-bb0ac562dbc1
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 20,\n    \"y\": 450\n  }\n}"
  '13':
    continueonerrortype: ''
    id: '13'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '7'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: f88cb4f2-ef2e-49d0-9806-9a97f0ac9ab7
      iscommand: false
      name: WildFire Only
      type: title
      version: -1
      description: ''
    taskid: f88cb4f2-ef2e-49d0-9806-9a97f0ac9ab7
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 890,\n    \"y\": 450\n  }\n}"
  '14':
    continueonerrortype: ''
    id: '14'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '9'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: b4365e9c-3cc3-48f2-b3af-f4017833350d
      iscommand: false
      name: GP Only
      type: title
      version: -1
      description: ''
    taskid: b4365e9c-3cc3-48f2-b3af-f4017833350d
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 1320,\n    \"y\": 450\n  }\n}"
  '15':
    continueonerrortype: ''
    id: '15'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '19'
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: AppThreat
      value:
        simple: '{"AppThreat":{"DownloadJobID":"${Panorama.Content.Download.JobID}","VersionDownloaded":"${Panorama.Content.Download.Details.details.line.[2]}","InstallJobID": "${Panorama.Content.Install.JobID}"}}'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Set a value in context under the key you entered.
      id: 604eacdb-7323-47eb-8cbc-411b3fbc2709
      iscommand: false
      name: Store Formatted Details
      script: Set
      type: regular
      version: -1
    taskid: 604eacdb-7323-47eb-8cbc-411b3fbc2709
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": -420,\n    \"y\": 1080\n  }\n}"
  '16':
    continueonerrortype: ''
    id: '16'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '19'
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: AntiVirus
      value:
        simple: '{"AntiVirus":{"DownloadJobID":"${Panorama.AntiVirus.Download.JobID}","VersionDownloaded":"${Panorama.AntiVirus.Download.Details.details.line.[2]}","InstallJobID": "${Panorama.AntiVirus.Install.JobID}"}}'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Set a value in context under the key you entered.
      id: 8fb320b2-752b-47d6-92bc-8d695d083d1f
      iscommand: false
      name: Store Formatted Details
      script: Set
      type: regular
      version: -1
    taskid: 8fb320b2-752b-47d6-92bc-8d695d083d1f
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 20,\n    \"y\": 1080\n  }\n}"
  '17':
    continueonerrortype: ''
    id: '17'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '19'
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: WildFire
      value:
        simple: '{"WildFire": {"DownloadJobID":"${Panorama.WildFire.Download.JobID}","VersionDownloaded":"${Panorama.WildFire.Download.Details.details.line.[2]}","InstallJobID": "${Panorama.WildFire.Install.JobID}"}}'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Set a value in context under the key you entered.
      id: 2ae1939f-0d9e-4944-94a8-663d7caf3729
      iscommand: false
      name: Store Formatted Details
      script: Set
      type: regular
      version: -1
    taskid: 2ae1939f-0d9e-4944-94a8-663d7caf3729
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 890,\n    \"y\": 1080\n  }\n}"
  '18':
    continueonerrortype: ''
    id: '18'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '19'
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: GP
      value:
        simple: '{"GP": {"DownloadJobID": "${Panorama.GP.Download.JobID}","VersionDownloaded":"${Panorama.GP.Download.Details.details.line.[2]}","InstallJobID":"${Panorama.GP.Install.JobID}"}}'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Set a value in context under the key you entered.
      id: 358fe409-821d-4a9b-b225-01dc055098ae
      iscommand: false
      name: Store Formatted Details
      script: Set
      type: regular
      version: -1
    taskid: 358fe409-821d-4a9b-b225-01dc055098ae
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1320,\n    \"y\": 1080\n  }\n}"
  '19':
    continueonerrortype: ''
    id: '19'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '20'
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: DynamicUpdates
      value:
        complex:
          root: AppThreat
          transformers:
          - args:
              item:
                iscontext: true
                value:
                  simple: AntiVirus
            operator: append
          - args:
              item:
                iscontext: true
                value:
                  simple: WildFire
            operator: append
          - args:
              item:
                iscontext: true
                value:
                  simple: GP
            operator: append
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: "Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.\n\nThis automation runs using the default Limited User role, unless you explicitly change the permissions.\nFor more information, see the section about permissions here:\n- For Cortex XSOAR 6 see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n- For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      id: 6d86fc0c-be5a-43a5-a012-353c545b00b2
      iscommand: false
      name: Combine Update Details
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 6d86fc0c-be5a-43a5-a012-353c545b00b2
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 1270\n  }\n}"
  '20':
    continueonerrortype: ''
    id: '20'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: bce60651-e397-45f3-b0c1-13de9a91153d
      iscommand: false
      name: Done
      type: title
      version: -1
      description: ''
    taskid: bce60651-e397-45f3-b0c1-13de9a91153d
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 1430\n  }\n}"
version: -1
view: "{\n  \"linkLabelsPosition\": {\n    \"1_13_WildFire\": 0.72\n  },\n  \"paper\": {\n    \"dimensions\": {\n      \"height\": 1420,\n      \"width\": 2120,\n      \"x\": -420,\n      \"y\": 70\n    }\n  }\n}"
fromversion: 6.10.0
tests:
- No tests (auto formatted)
