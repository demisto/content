description: This playbook checks if your firewalls have a sw version that is vulnerable
  to a Palo Alto Networks PAN-OS CVE or if the global protect version installed on
  it is vulnerable to a Global Protect App CVE. It handles both single cve manually
  triggered incident and a feed triggered job scenarios.
dirtyInputs: true
id: 'PAN-OS Security Advisories Vulnerability Check'
inputSections:
- description: Generic group for inputs
  inputs:
  - cve_id
  - target
  name: General (Inputs group)
inputs:
- description: ""
  key: cve_id
  playbookInputQuery: null
  required: true
  value: {}
- description: 'serial number of the target firewall'
  key: target
  playbookInputQuery: null
  required: false
  value: {}
name: PAN-OS Security Advisories Vulnerability Check
outputSections:
- description: Generic group for outputs
  name: General (Outputs group)
  outputs:
  - CVE_Check.CVE_ID
  - CVE_Check.Result
  - CVE_Check.Severity
outputs:
- contextPath: CVE_Check.CVE_ID
  description: ID of the CVE checked
  type: string
- contextPath: CVE_Check.Result
  description: |-
    Result of the assessment for the input CVE with details about the firewall in the following json format:
    {
     Hostname : string,
     IPAddress : string,
     SWVersion : string,
     IsFirewallVersionAffected : True/False,
     GlobalProtectVersion : string,
     IsGlobalProtectVersionAffected: True/False
    }
  type: unknown
- contextPath: CVE_Check.Severity
  description: Severity of the CVE checked
  type: string
quiet: true
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 705e7b80-68d8-4ceb-879c-28359214f5b5
      iscommand: false
      name: ""
      version: -1
    taskid: 705e7b80-68d8-4ceb-879c-28359214f5b5
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 626.25,
          "y": 35
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      target:
        simple: ${inputs.target}
      using:
        simple: Panorama_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Panorama
      description: Gets information from all PAN-OS systems in the topology.
      id: 53b3022f-2031-4089-85b2-eb4eee892d73
      iscommand: true
      name: Get PAN-OS System Info
      script: Panorama|||pan-os-platform-get-system-info
      type: regular
      version: -1
    taskid: 53b3022f-2031-4089-85b2-eb4eee892d73
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 626.25,
          "y": 872
        }
      }
  "11":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: state
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: modules.brand
                    operator: isEqualString
                    right:
                      value:
                        simple: Panorama
                root: modules
          operator: isEqualString
          right:
            value:
              simple: active
      label: "yes"
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "12"
      "yes":
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, no is returned.
      id: 294474fb-05e0-4388-9b1a-83da3a2037e9
      iscommand: false
      name: Is Panorama Integration configured and enabled?
      type: condition
      version: -1
    taskid: 294474fb-05e0-4388-9b1a-83da3a2037e9
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 626.25,
          "y": 659
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b432065f-c01c-4211-84d8-cf7c2488c1be
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: b432065f-c01c-4211-84d8-cf7c2488c1be
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 626.25,
          "y": 1340
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c7c19e65-5d6d-486b-83cd-444d6264b26d
      iscommand: false
      name: Gather PAN-OS and GP info
      type: title
      version: -1
    taskid: c7c19e65-5d6d-486b-83cd-444d6264b26d
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 626.25,
          "y": 511
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 33f04a72-ce2a-41e3-8cea-d41432fb2455
      iscommand: false
      name: Gather CVE Info
      type: title
      version: -1
    taskid: 33f04a72-ce2a-41e3-8cea-d41432fb2455
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 626.25,
          "y": 185
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 2
    scriptarguments:
      cve_json:
        simple: ${PAN_OS_Security_Advisories.Advisory}
      panos_system_info_list:
        simple: ${PANOS.ShowSystemInfo.Result}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 76cc307b-ed43-47ad-a434-05538c98f083
      iscommand: false
      name: Check FW and GP for CVE Vulnerability
      script: CheckFirewallAndGPForCVEs
      type: regular
      version: -1
    taskid: 76cc307b-ed43-47ad-a434-05538c98f083
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 626.25,
          "y": 1177
        }
      }
  "37":
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 2
    scriptarguments:
      cve_id:
        simple: ${inputs.CVE ID}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Enrich PANW CVEs from the Security Advisories website
      id: 1175de5f-c521-4e6b-9e79-e2fd065db6d7
      iscommand: false
      name: Enrich CVEs
      script: PAN_OS_Security_Advisories_Enrichment
      type: regular
      version: -1
    taskid: 1175de5f-c521-4e6b-9e79-e2fd065db6d7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 626.25,
          "y": 338
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "11_1_yes": 0.61
    },
    "paper": {
      "dimensions": {
        "height": 1365,
        "width": 976.75,
        "x": 626.25,
        "y": 35
      }
    }
  }
