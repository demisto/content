id: tenable-sc-test
version: -1
vcShouldKeepItemLegacyProdMachine: false
name: Tenable.sc Test
description: Test playbook for Tenable.sc integration
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 6d7b6e63-a98f-40b0-806f-2daeac03ea07
    type: start
    task:
      id: 6d7b6e63-a98f-40b0-806f-2daeac03ea07
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": -750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: a4d1f78a-45b0-4151-887d-11ee8cace454
    type: title
    task:
      id: a4d1f78a-45b0-4151-887d-11ee8cace454
      version: -1
      name: Create a scan and delete it
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 860
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: de1e8381-b99b-4e36-86d1-3572e54b9130
    type: regular
    task:
      id: de1e8381-b99b-4e36-86d1-3572e54b9130
      version: -1
      name: Get manageable policies
      description: Get a list of Tenable.sc scan policies
      script: Tenable.sc|||tenable-sc-list-policies
      type: regular
      iscommand: true
      brand: Tenable.sc
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      manageable:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1005
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 80d3b7f9-1dae-4490-8391-208698aef545
    type: regular
    task:
      id: 80d3b7f9-1dae-4490-8391-208698aef545
      version: -1
      name: Get repositories
      description: Get a list of Tenable.sc scan repositories
      script: Tenable.sc|||tenable-sc-list-repositories
      type: regular
      iscommand: true
      brand: Tenable.sc
    nexttasks:
      '#none#':
      - "4"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: b6256c8f-4c4f-406c-885a-3939e5d193d2
    type: regular
    task:
      id: b6256c8f-4c4f-406c-885a-3939e5d193d2
      version: -1
      name: Get zones
      description: Get a list of Tenable.sc scan zones
      script: Tenable.sc|||tenable-sc-list-zones
      type: regular
      iscommand: true
      brand: Tenable.sc
    nexttasks:
      '#none#':
      - "5"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1355
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: a4a40261-4d0d-4f33-845d-de51c22891f5
    type: regular
    task:
      id: a4a40261-4d0d-4f33-845d-de51c22891f5
      version: -1
      name: Get credentials
      description: Get a list of Tenable.sc credentials
      script: Tenable.sc|||tenable-sc-list-credentials
      type: regular
      iscommand: true
      brand: Tenable.sc
    nexttasks:
      '#none#':
      - "6"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1530
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 3099831c-7aac-4f81-8872-96e0bf5a9f52
    type: regular
    task:
      id: 3099831c-7aac-4f81-8872-96e0bf5a9f52
      version: -1
      name: Get current time for name
      description: |
        Retrieves the current date and time.
      scriptName: GetTime
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1705
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: 4d6291a6-22e0-4a26-84dc-495180342be9
    type: regular
    task:
      id: 4d6291a6-22e0-4a26-84dc-495180342be9
      version: -1
      name: Create scan
      description: Create a scan on Tenable.sc
      script: Tenable.sc|||tenable-sc-create-scan
      type: regular
      iscommand: true
      brand: Tenable.sc
    nexttasks:
      '#none#':
      - "46"
    scriptarguments:
      asset_ids:
        simple: ${TenableSC.Asset.ID}
      credentials:
        complex:
          root: TenableSC
          accessor: Credential
          transformers:
          - operator: WhereFieldEquals
            args:
              equalTo:
                value:
                  simple: Test
              field:
                value:
                  simple: Name
              getField:
                value:
                  simple: ID
      description:
        simple: Test scan
      dhcp_tracking:
        simple: "true"
      ip_list:
        simple: 10.0.0.1
      max_scan_time:
        simple: "2"
      name:
        simple: test_scan_${TimeNowUnix}
      policy_id:
        complex:
          root: TenableSC
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: TenableSC.ScanPolicy.Type
                iscontext: true
              right:
                value:
                  simple: Host Discovery
          accessor: ScanPolicy.ID
      report_ids:
        complex:
          root: TenableSC
          accessor: ReportDefinition
          transformers:
          - operator: WhereFieldEquals
            args:
              equalTo:
                value:
                  simple: Critical and Exploitable Vulnerabilities Report
              field:
                value:
                  simple: Name
              getField:
                value:
                  simple: ID
      repository_id:
        complex:
          root: TenableSC.ScanRepository
          accessor: ID
      scan_virtual_hosts:
        simple: "false"
      schedule:
        simple: never
      zone_id:
        complex:
          root: TenableSC
          filters:
          - - operator: isNotEqualString
              left:
                value:
                  simple: TenableSC.ScanZone.ID
                iscontext: true
              right:
                value:
                  simple: "0"
          accessor: ScanZone.ID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2055
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: d5779f57-ed71-4f9a-862f-ec2e5b496e93
    type: regular
    task:
      id: d5779f57-ed71-4f9a-862f-ec2e5b496e93
      version: -1
      name: Get manageable report definitions
      description: Get a list of Tenable.sc report definitions
      script: Tenable.sc|||tenable-sc-list-report-definitions
      type: regular
      iscommand: true
      brand: Tenable.sc
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      manageable:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: e165b8b5-48a0-4618-83f6-4bc1c50ae577
    type: regular
    task:
      id: e165b8b5-48a0-4618-83f6-4bc1c50ae577
      version: -1
      name: Delete the scan
      description: Delete a scan in Tenable.sc
      script: Tenable.sc|||tenable-sc-delete-scan
      type: regular
      iscommand: true
      brand: Tenable.sc
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      scan_id:
        simple: ${TenableSC.Scan.ID}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 610,
          "y": 3535
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: 62e3f64a-e853-4c5e-88f2-55553c1ce0b1
    type: title
    task:
      id: 62e3f64a-e853-4c5e-88f2-55553c1ce0b1
      version: -1
      name: Launch scan
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 02c5425c-9fbf-4268-89b8-92e7e10dc1a9
    type: regular
    task:
      id: 02c5425c-9fbf-4268-89b8-92e7e10dc1a9
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": -620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: c76704a7-622a-4f6f-8dfa-1d17b266073d
    type: regular
    task:
      id: c76704a7-622a-4f6f-8dfa-1d17b266073d
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3125
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: 9b07246f-6ad8-4130-880f-5dca072829da
    type: regular
    task:
      id: 9b07246f-6ad8-4130-880f-5dca072829da
      version: -1
      name: List scans
      description: Get a list of Tenable.sc existing scans
      script: Tenable.sc|||tenable-sc-list-scans
      type: regular
      iscommand: true
      brand: Tenable.sc
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      manageable:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3630
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: d79240d9-fa06-428f-8157-3ca509a1a688
    type: regular
    task:
      id: d79240d9-fa06-428f-8157-3ca509a1a688
      version: -1
      name: Launch my_test_scan
      description: Launch an existing scan from Tenable.sc
      script: Tenable.sc|||tenable-sc-launch-scan
      type: regular
      iscommand: true
      brand: Tenable.sc
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      scan_id:
        complex:
          root: TenableSC.Scan
          accessor: ID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3440
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: c7ce702c-721f-4db4-8f45-b37f841e050d
    type: regular
    task:
      id: c7ce702c-721f-4db4-8f45-b37f841e050d
      version: -1
      name: Get scan status
      description: Get the status of a specific scan in Tenable.sc
      script: Tenable.sc|||tenable-sc-get-scan-status
      type: regular
      iscommand: true
      brand: Tenable.sc
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      scan_results_id:
        simple: ${TenableSC.ScanResults.ID}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3795
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: 9102fd37-5cd1-4b23-8aaa-8ff5804afc64
    type: regular
    task:
      id: 9102fd37-5cd1-4b23-8aaa-8ff5804afc64
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: 1e79e7b6-b6d1-433a-826d-d2b091f01b51
    type: title
    task:
      id: 1e79e7b6-b6d1-433a-826d-d2b091f01b51
      version: -1
      name: Get scan results
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "43"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4145
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: e4e0dc94-1c31-4b05-8828-6347323f69d9
    type: regular
    task:
      id: e4e0dc94-1c31-4b05-8828-6347323f69d9
      version: -1
      name: Get report from a complete scan
      description: Get a report with a Tenable.sc scan results
      script: Tenable.sc|||tenable-sc-get-scan-report
      type: regular
      iscommand: true
      brand: Tenable.sc
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      scan_results_id:
        complex:
          root: TenableSC.ScanResults
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: TenableSC.ScanResults.Status
                iscontext: true
              right:
                value:
                  simple: Completed
          - - operator: isNotEqualString
              left:
                value:
                  simple: TenableSC.ScanResults.ImportStatus
                iscontext: true
              right:
                value:
                  simple: Error
          accessor: ID
          transformers:
          - operator: FirstArrayElement
      vulnerability_severity:
        simple: Medium,Low,Info
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4465
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: 01d006b5-3ec8-4f65-8a8f-909f32ae63c2
    type: regular
    task:
      id: 01d006b5-3ec8-4f65-8a8f-909f32ae63c2
      version: -1
      name: Get scan vulnerability
      description: 'Get details about a given vulnerability from a given Tenable.sc
        scan '
      script: Tenable.sc|||tenable-sc-get-vulnerability
      type: regular
      iscommand: true
      brand: Tenable.sc
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      scan_results_id:
        complex:
          root: TenableSC.ScanResults
          filters:
          - - operator: isNotEqualString
              left:
                value:
                  simple: TenableSC.ScanResults.ImportStatus
                iscontext: true
              right:
                value:
                  simple: Error
          - - operator: isEqualString
              left:
                value:
                  simple: TenableSC.ScanResults.Status
                iscontext: true
              right:
                value:
                  simple: Completed
          accessor: ID
          transformers:
          - operator: FirstArrayElement
      vulnerability_id:
        complex:
          root: TenableSC.ScanResults.Vulnerability
          accessor: ID
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4640
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: ba4dd94f-e7a3-4e67-8718-ee557e2ad738
    type: condition
    task:
      id: ba4dd94f-e7a3-4e67-8718-ee557e2ad738
      version: -1
      name: Verify get vulnerability
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "21"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: TenableSC.ScanResults
                accessor: ID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4815
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: 1cf17bb5-718d-4009-8c2b-362d3f84d06c
    type: regular
    task:
      id: 1cf17bb5-718d-4009-8c2b-362d3f84d06c
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4975
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: dac5aae1-1613-4584-8948-8b6f2e08db2f
    type: title
    task:
      id: dac5aae1-1613-4584-8948-8b6f2e08db2f
      version: -1
      name: Create asset
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "23"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": -450
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: aa344557-9b9b-4d8f-835f-fbaa4dbdad4f
    type: regular
    task:
      id: aa344557-9b9b-4d8f-835f-fbaa4dbdad4f
      version: -1
      name: Get current time for name
      description: |
        Retrieves the current date and time.
      scriptName: GetTime
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "54"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": -330
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: 94efed27-a06e-424a-8392-ec87036397d5
    type: regular
    task:
      id: 94efed27-a06e-424a-8392-ec87036397d5
      version: -1
      name: Create asset
      description: Create an Asset in Tenable.sc with provided IP addresses
      script: Tenable.sc|||tenable-sc-create-asset
      type: regular
      iscommand: true
      brand: Tenable.sc
    nexttasks:
      '#none#':
      - "60"
    scriptarguments:
      description:
        simple: desc
      ip_list:
        simple: 10.0.0.1
      name:
        simple: test_asset_${TimeNow}
      owner_id:
        simple: ${TenableSC.User.ID}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "25":
    id: "25"
    taskid: 3c64770c-124e-4406-8bcf-b3f2e6a00809
    type: regular
    task:
      id: 3c64770c-124e-4406-8bcf-b3f2e6a00809
      version: -1
      name: Get user
      description: List users in Tenable.sc
      script: Tenable.sc|||tenable-sc-list-users
      type: regular
      iscommand: true
      brand: Tenable.sc
    nexttasks:
      '#none#':
      - "56"
    scriptarguments:
      id:
        simple: ${TenableSC.User.ID}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: 67feff1c-10d7-45b2-8ae6-5319ec4cc3aa
    type: regular
    task:
      id: 67feff1c-10d7-45b2-8ae6-5319ec4cc3aa
      version: -1
      name: Delete the asset
      description: Delete the Asset with the given ID from Tenable.sc
      script: Tenable.sc|||tenable-sc-delete-asset
      type: regular
      iscommand: true
      brand: Tenable.sc
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      asset_id:
        simple: ${TenableSC.Asset.ID}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2950
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: 8db98577-36ed-4147-8858-517ec3d312fd
    type: title
    task:
      id: 8db98577-36ed-4147-8858-517ec3d312fd
      version: -1
      name: Alerts
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "28"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5150
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: f9ff94ff-2dbf-4a81-89dd-aa397f57a617
    type: regular
    task:
      id: f9ff94ff-2dbf-4a81-89dd-aa397f57a617
      version: -1
      name: Get manageable alerts
      description: List alerts from Tenable.sc
      script: Tenable.sc|||tenable-sc-list-alerts
      type: regular
      iscommand: true
      brand: Tenable.sc
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      manageable:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: 6b8f5c5f-9380-4ec3-8c21-bb510a9f6462
    type: regular
    task:
      id: 6b8f5c5f-9380-4ec3-8c21-bb510a9f6462
      version: -1
      name: Get alert
      description: Get information about a given alert in tenabel.sc
      script: Tenable.sc|||tenable-sc-get-alert
      type: regular
      iscommand: true
      brand: Tenable.sc
    nexttasks:
      '#none#':
      - "41"
    scriptarguments:
      alert_id:
        simple: ${TenableSC.Alert.ID}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: 76fb6551-0464-4881-8581-b7f9b293a53e
    type: regular
    task:
      id: 76fb6551-0464-4881-8581-b7f9b293a53e
      version: -1
      name: FetchFromInstance
      scriptName: FetchFromInstance
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "33"
    scriptarguments:
      instance_name:
        complex:
          root: modules
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: modules.brand
                iscontext: true
              right:
                value:
                  simple: Tenable.sc
          - - operator: isEqualString
              left:
                value:
                  simple: modules.state
                iscontext: true
              right:
                value:
                  simple: active
          accessor: name
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: aa036c4f-5a5e-422b-8625-6db308bc59ee
    type: title
    task:
      id: aa036c4f-5a5e-422b-8625-6db308bc59ee
      version: -1
      name: List items
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: f4f64e1d-5978-4e2d-8058-0e9cd054e361
    type: regular
    task:
      id: f4f64e1d-5978-4e2d-8058-0e9cd054e361
      version: -1
      name: List assets
      description: Get a list of Tenable.sc Assets
      script: Tenable.sc|||tenable-sc-list-assets
      type: regular
      iscommand: true
      brand: Tenable.sc
    nexttasks:
      '#none#':
      - "35"
    scriptarguments:
      manageable:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6315
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: ebfd3c31-d9f0-4174-89dc-ce705abd154a
    type: regular
    task:
      id: ebfd3c31-d9f0-4174-89dc-ce705abd154a
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: 87e78dcc-d7b5-4ab3-8629-2370a33120ac
    type: regular
    task:
      id: 87e78dcc-d7b5-4ab3-8629-2370a33120ac
      version: -1
      name: Get device
      description: Gets the device information from the current user in Tenable.sc
      script: Tenable.sc|||tenable-sc-get-device
      type: regular
      iscommand: true
      brand: Tenable.sc
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      ip:
        simple: 10.0.0.4
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6490
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: 069fd62f-a89a-492b-8fdf-340c342be11c
    type: regular
    task:
      id: 069fd62f-a89a-492b-8fdf-340c342be11c
      version: -1
      name: Get licensing
      description: Retrieve licensing information from Tenable.sc
      script: Tenable.sc|||tenable-sc-get-system-licensing
      type: regular
      iscommand: true
      brand: Tenable.sc
    nexttasks:
      '#none#':
      - "37"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6665
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: f17c2296-f04e-4507-8d91-bf420d6f535c
    type: regular
    task:
      id: f17c2296-f04e-4507-8d91-bf420d6f535c
      version: -1
      name: Verify lists
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "38"
    scriptarguments:
      fields:
        simple: Status,Device,Asset
      path:
        simple: TenableSC
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6840
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: 978859ae-3512-4a5d-827d-1902181a26dc
    type: regular
    task:
      id: 978859ae-3512-4a5d-827d-1902181a26dc
      version: -1
      name: Verify Endpoint
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "48"
    scriptarguments:
      expectedValue:
        simple: 10.0.0.4
      path:
        simple: Endpoint.IPAddress
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7015
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: f6162da5-4007-4e85-88c5-8afcc5ad220b
    type: regular
    task:
      id: f6162da5-4007-4e85-88c5-8afcc5ad220b
      version: -1
      name: Get the asset
      description: Get details for a given asset in Tenable.sc
      script: Tenable.sc|||tenable-sc-get-asset
      type: regular
      iscommand: true
      brand: Tenable.sc
    nexttasks:
      '#none#':
      - "47"
    scriptarguments:
      asset_id:
        simple: ${TenableSC.Asset.ID}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: c6a4a7f2-60f8-47af-8fa3-049d6f91b783
    type: regular
    task:
      id: c6a4a7f2-60f8-47af-8fa3-049d6f91b783
      version: -1
      name: Verify Alert
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      fields:
        simple: Actions,Action
      path:
        simple: TenableSC.Alert
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: 4d9cd97f-1bc6-412c-8e44-5d3b134933a4
    type: title
    task:
      id: 4d9cd97f-1bc6-412c-8e44-5d3b134933a4
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: 624721d5-34c0-4b97-8296-ecea982e7639
    type: regular
    task:
      id: 624721d5-34c0-4b97-8296-ecea982e7639
      version: -1
      name: Get all scan results
      description: Get all scan results in Tenable.sc
      script: Tenable.sc|||tenable-sc-get-all-scan-results
      type: regular
      iscommand: true
      brand: Tenable.sc
    nexttasks:
      '#none#':
      - "18"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4290
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: 1cb46508-ccae-4720-8894-470ec0c257cf
    type: regular
    task:
      id: 1cb46508-ccae-4720-8894-470ec0c257cf
      version: -1
      name: Update asset description
      description: Requires security manager role. Update an asset.
      script: '|||tenable-sc-update-asset'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "40"
    scriptarguments:
      asset_id:
        simple: ${TenableSC.Asset.ID}
      description:
        simple: This is my test asset.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: 98c6e89a-03e0-4c7c-8f86-88c17fc46f27
    type: condition
    task:
      id: 98c6e89a-03e0-4c7c-8f86-88c17fc46f27
      version: -1
      name: Verify update asset
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "26"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: TenableSC.Asset.Description
            iscontext: true
          right:
            value:
              simple: This is my test asset.
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2780
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: 1d51fc88-f726-4800-80f1-269f7676ef39
    type: regular
    task:
      id: 1d51fc88-f726-4800-80f1-269f7676ef39
      version: -1
      name: List queries
      description: Requires security manager role. Lists queries.
      script: '|||tenable-sc-list-query'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "49"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: 29ce3233-cd78-4e7d-8396-25fa889a561a
    type: condition
    task:
      id: 29ce3233-cd78-4e7d-8396-25fa889a561a
      version: -1
      name: Verify list queries
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "50"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: TenableSC.Query.Manageable.ID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7350
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: 85140e28-1f6b-465f-8d92-04213328dcfa
    type: regular
    task:
      id: 85140e28-1f6b-465f-8d92-04213328dcfa
      version: -1
      name: Create policy
      description: Requires security manager role. This command is prerequisite for
        creating remediation scan. creates policy.
      script: '|||tenable-sc-create-policy'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "51"
    scriptarguments:
      family_id:
        simple: "1"
      plugins_id:
        simple: "1"
      policy_template_id:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: 47ee30bd-4ccb-4d0b-8529-7fbfc031c5da
    type: condition
    task:
      id: 47ee30bd-4ccb-4d0b-8529-7fbfc031c5da
      version: -1
      name: Verify create policy
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "52"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: TenableSC.ScanPolicy.ID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7700
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "52":
    id: "52"
    taskid: 8a5fe836-4146-411d-8e50-22c605b4aa1f
    type: regular
    task:
      id: 8a5fe836-4146-411d-8e50-22c605b4aa1f
      version: -1
      name: List plugin family
      description: Requires security manager role. list plugin families / return information
        about a plugin family given ID.
      script: '|||tenable-sc-list-plugin-family'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "53"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: 0e2b92e9-1cf4-4040-8d5a-99184f84e926
    type: condition
    task:
      id: 0e2b92e9-1cf4-4040-8d5a-99184f84e926
      version: -1
      name: Verify list plugin
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "58"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: TenableSC.PluginFamily.ID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "54":
    id: "54"
    taskid: 82b6d961-5c84-4f52-8f2c-ad97a75ae869
    type: regular
    task:
      id: 82b6d961-5c84-4f52-8f2c-ad97a75ae869
      version: -1
      name: Create user
      description: This command can be executed with both roles (admin or security
        manager) based on the roll_id you with to choose. Creates a new user.
      script: '|||tenable-sc-create-user'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "55"
    scriptarguments:
      last_name:
        simple: test
      password:
        simple: test
      role_id:
        simple: "4"
      user_name:
        simple: test_user_${TimeNow}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": -160
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "55":
    id: "55"
    taskid: ad3f2a34-a8b0-4753-88ae-e851aeed622b
    type: regular
    task:
      id: ad3f2a34-a8b0-4753-88ae-e851aeed622b
      version: -1
      name: Update user
      description: update user details by given user_id.
      script: Tenable.sc|||tenable-sc-update-user
      type: regular
      iscommand: true
      brand: Tenable.sc
    nexttasks:
      '#none#':
      - "25"
    scriptarguments:
      first_name:
        simple: test
      user_id:
        simple: ${TenableSC.User.ID}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 15
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "56":
    id: "56"
    taskid: 27abd085-6f81-4757-8440-bb670a035be8
    type: condition
    task:
      id: 27abd085-6f81-4757-8440-bb670a035be8
      version: -1
      name: Verify create and update user
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "24"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: TenableSC.User.FirstName
            iscontext: true
          right:
            value:
              simple: test
      - - operator: isEqualString
          left:
            value:
              simple: TenableSC.User.LastName
            iscontext: true
          right:
            value:
              simple: test
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 350
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "57":
    id: "57"
    taskid: b5d42fc5-719a-4e5a-88a7-fb1bfcf35aa6
    type: regular
    task:
      id: b5d42fc5-719a-4e5a-88a7-fb1bfcf35aa6
      version: -1
      name: Delete user
      description: This command can be executed with both roles (admin or security
        manager). Delete a user by given user_id.
      script: '|||tenable-sc-delete-user'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    scriptarguments:
      user_id:
        simple: ${TenableSC.User.ID}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "58":
    id: "58"
    taskid: 465cc62d-1a98-4b6c-80f4-9e77e0291602
    type: regular
    task:
      id: 465cc62d-1a98-4b6c-80f4-9e77e0291602
      version: -1
      name: List groups
      description: Requires security manager role. list all groups.
      script: '|||tenable-sc-list-groups'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "59"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "59":
    id: "59"
    taskid: 6d56b3fc-ac11-49e8-8f58-0c0d7e5d0a29
    type: condition
    task:
      id: 6d56b3fc-ac11-49e8-8f58-0c0d7e5d0a29
      version: -1
      name: Verify list groups
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "42"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: TenableSC.Group.ID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: c8f26835-0ea2-4017-856a-98a0d528532d
    type: regular
    task:
      id: c8f26835-0ea2-4017-856a-98a0d528532d
      version: -1
      name: Sleep 15 seconds
      description: Sleep for X seconds
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "57"
    scriptarguments:
      seconds:
        simple: "15"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 510,
          "y": 595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 9365,
        "width": 940,
        "x": 50,
        "y": -750
      }
    }
  }
inputs: []
outputs: []
fromversion: 5.0.0
