# Symantec Cloud Secure Web Gateway

<~XSIAM>

## Cortex XSIAM SIEM Content

This pack includes Cortex XSIAM SIEM content for parsing and modeling the access logs that are received from Symantec Cloud SWG (Secure Web Gateway) via the Symantec Cloud SWG (Secure Web Gateway) Event Collector integration. 

After configuring the Symantec Cloud SWG Event Collector integration in Cortex XSIAM, the Symantec Cloud SWG access logs are searchable in XQL Search using the **symantec_swg_raw** dataset. 

In addition, data is normalized to the Cortex Data Model (XDM).

The following XQL Queries demonstrates the parsing and XDM modeling for the Symantec Cloud SWG Access Logs:

1. **Raw Field Extraction**
   ```javascript
    config timeframe = 1H
    | dataset = symantec_swg_raw 
    | alter field_separator = "#", quoted_fields = regextract(_raw_log, "\"(\S[^\"]+)")
    | alter field_list = split(arraystring(arraymap(arrayfilter(arraymap(split(_raw_log, "\""), trim("@element")), len("@element") > 0), if(quoted_fields contains trim("@element"), "@element", arraystring(regextract("@element", "\S+"), field_separator))), field_separator), field_separator)
    | alter x_bluecoat_request_tenant_id = arrayindex(field_list, 0), date = arrayindex(field_list, 1), time = arrayindex(field_list, 2), x_bluecoat_appliance_name = arrayindex(field_list, 3), time_taken = arrayindex(field_list, 4), c_ip = arrayindex(field_list, 5), cs_userdn = arrayindex(field_list, 6), cs_auth_groups = arrayindex(field_list, 7), x_exception_id = arrayindex(field_list, 8), sc_filter_result = arrayindex(field_list, 9), cs_categories = arrayindex(field_list, 10), cs_referer = arrayindex(field_list, 11), sc_status = arrayindex(field_list, 12), s_action = arrayindex(field_list, 13), cs_method = arrayindex(field_list, 14), rs_content_type = arrayindex(field_list, 15), cs_uri_scheme = arrayindex(field_list, 16), cs_host = arrayindex(field_list, 17), cs_uri_port = arrayindex(field_list, 18), cs_uri_path = arrayindex(field_list, 19), cs_uri_query = arrayindex(field_list, 20), cs_uri_extension = arrayindex(field_list, 21), cs_user_agent = arrayindex(field_list, 22), s_ip = arrayindex(field_list, 23), sc_bytes = arrayindex(field_list, 24), cs_bytes = arrayindex(field_list, 25), x_icap_reqmod_header = arrayindex(field_list, 26), x_icap_respmod_header = arrayindex(field_list, 27), x_data_leak_detected = arrayindex(field_list, 28), x_virus_id = arrayindex(field_list, 29), x_bluecoat_location_id = arrayindex(field_list, 30), x_bluecoat_location_name = arrayindex(field_list, 31), x_bluecoat_access_type = arrayindex(field_list, 32), x_bluecoat_application_name = arrayindex(field_list, 33), x_bluecoat_application_operation = arrayindex(field_list, 34), r_ip = arrayindex(field_list, 35), r_supplier_country = arrayindex(field_list, 36), x_rs_certificate_validate_status = arrayindex(field_list, 37), x_rs_certificate_observed_errors = arrayindex(field_list, 38), x_cs_ocsp_error = arrayindex(field_list, 39), x_rs_ocsp_error = arrayindex(field_list, 40), x_rs_connection_negotiated_ssl_version = arrayindex(field_list, 41), x_rs_connection_negotiated_cipher = arrayindex(field_list, 42), x_rs_connection_negotiated_cipher_size = arrayindex(field_list, 43), x_rs_certificate_hostname = arrayindex(field_list, 44), x_rs_certificate_hostname_categories = arrayindex(field_list, 45), x_cs_connection_negotiated_ssl_version = arrayindex(field_list, 46), x_cs_connection_negotiated_cipher = arrayindex(field_list, 47), x_cs_connection_negotiated_cipher_size = arrayindex(field_list, 48), x_cs_certificate_subject = arrayindex(field_list, 49), cs_icap_status = arrayindex(field_list, 50), cs_icap_error_details = arrayindex(field_list, 51), rs_icap_status = arrayindex(field_list, 52), rs_icap_error_details = arrayindex(field_list, 53), s_supplier_ip = arrayindex(field_list, 54), s_supplier_country = arrayindex(field_list, 55), s_supplier_failures = arrayindex(field_list, 56), x_cs_client_ip_country = arrayindex(field_list, 57), cs_threat_risk = arrayindex(field_list, 58), x_rs_certificate_hostname_threat_risk = arrayindex(field_list, 59), x_client_agent_type = arrayindex(field_list, 60), x_client_os = arrayindex(field_list, 61), x_client_agent_sw = arrayindex(field_list, 62), x_client_device_id = arrayindex(field_list, 63), x_client_device_name = arrayindex(field_list, 64), x_client_device_type = arrayindex(field_list, 65), x_client_security_posture_details = arrayindex(field_list, 66), x_client_security_posture_risk_score = arrayindex(field_list, 67), x_bluecoat_reference_id = arrayindex(field_list, 68), x_sc_connection_issuer_keyring = arrayindex(field_list, 69), x_sc_connection_issuer_keyring_alias = arrayindex(field_list, 70), x_cloud_rs = arrayindex(field_list, 71), x_bluecoat_placeholder = arrayindex(field_list, 72), cs_x_requested_with = arrayindex(field_list, 73), x_random_ipv6 = arrayindex(field_list, 74), x_bluecoat_transaction_uuid = arrayindex(field_list, 75)
    | fields - field_separator, quoted_fields, field_list
    ```
2. **XDM Mapped Fields** 
    ```javascript
    config timeframe = 1H
    | datamodel dataset = symantec_swg_raw 
    | fields _time, xdm.alert.original_alert_id, xdm.alert.original_threat_id, xdm.alert.risks, xdm.alert.severity, xdm.event.duration, xdm.event.id, xdm.event.operation, xdm.event.operation_sub_type, xdm.event.outcome, xdm.event.outcome_reason, xdm.intermediate.application.name, xdm.intermediate.cloud.zone, xdm.intermediate.host.device_id, xdm.intermediate.host.hostname, xdm.intermediate.host.ipv4_addresses, xdm.intermediate.host.ipv6_addresses, xdm.intermediate.ipv4, xdm.intermediate.ipv6, xdm.intermediate.is_proxy, xdm.intermediate.location.country, xdm.network.application_protocol, xdm.network.http.content_type, xdm.network.http.http_header.header, xdm.network.http.http_header.value, xdm.network.http.method, xdm.network.http.referrer, xdm.network.http.response_code, xdm.network.http.url, xdm.network.http.url_category, xdm.network.rule, xdm.network.tls.cipher, xdm.network.tls.client_certificate.subject, xdm.network.tls.protocol_version, xdm.network.tls.server_certificate.issuer, xdm.network.tls.server_certificate.subject, xdm.network.tls.server_name, xdm.observer.action, xdm.observer.type, xdm.source.agent.type, xdm.source.agent.version, xdm.source.host.device_category, xdm.source.host.device_id, xdm.source.host.hostname, xdm.source.host.os, xdm.source.host.os_family, xdm.source.ipv4, xdm.source.ipv6, xdm.source.location.country, xdm.source.sent_bytes, xdm.source.user.groups, xdm.source.user.username, xdm.source.user_agent, xdm.target.file.extension, xdm.target.host.hostname, xdm.target.host.ipv4_addresses, xdm.target.host.ipv6_addresses, xdm.target.ipv4, xdm.target.ipv6, xdm.target.location.country, xdm.target.port, xdm.target.resource.value, xdm.target.sent_bytes, xdm.target.url
    ```
   
</~XSIAM>