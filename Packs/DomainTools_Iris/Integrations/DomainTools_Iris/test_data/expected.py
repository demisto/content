import json

domaintools_investigate_readable = """### DomainTools Iris Investigate for domaintools.com. Investigate [domaintools.com](https://research.domaintools.com/iris/search/?q=domaintools.com) in Iris.
|Name|Last Enriched|Overall Risk Score|Proximity Risk Score|Threat Profile Risk Score|Threat Profile Threats|Threat Profile Evidence|Website Response Code|Tags|Registrant Name|Registrant Org|Registrant Contact|Registrar|SOA Email|SSL Certificate Email|Admin Contact|Technical Contact|Billing Contact|Email Domains|Additional Whois Emails|Domain Registrant|Registrar Status|Domain Status|Create Date|Expiration Date|IP Addresses|IP Country Code|Mail Servers|SPF Record|Name Servers|SSL Certificate|Redirects To|Redirect Domain|Google Adsense Tracking Code|Google Analytic Tracking Code|Website Title|First Seen|Server Type|Popularity|
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
| [domaintools.com](https://domaintools.com) | 2023-11-10 | 0 | 0 | 0 |  |  | 200 |  | {"value": "REDACTED FOR PRIVACY", "count": 132267110} | {"value": "REDACTED FOR PRIVACY", "count": 48508017} | name: {"value": "REDACTED FOR PRIVACY", "count": 131643982}<br>org: {"value": "REDACTED FOR PRIVACY", "count": 120617938}<br>street: {"value": "REDACTED FOR PRIVACY", "count": 118863405}<br>city: {"value": "REDACTED FOR PRIVACY", "count": 122675278}<br>state: {"value": "WA", "count": 7027354}<br>postal: {"value": "REDACTED FOR PRIVACY", "count": 123526354}<br>country: {"value": "us", "count": 274018662}<br>phone: {"value": "", "count": 0}<br>fax: {"value": "", "count": 0}<br>email: {'value': 'https://tieredaccess.com/contact/784fb607-c3ec-4640-b40f-30fc9f61b9ce', 'count': 1} | {"value": "ENOM, INC.", "count": 3984318} | {'value': 'hostmaster@nsone.net', 'count': 6623371} |  | name: {"value": "REDACTED FOR PRIVACY", "count": 131643982}<br>org: {"value": "REDACTED FOR PRIVACY", "count": 120617938}<br>street: {"value": "REDACTED FOR PRIVACY", "count": 118863405}<br>city: {"value": "REDACTED FOR PRIVACY", "count": 122675278}<br>state: {"value": "REDACTED FOR PRIVACY", "count": 118764947}<br>postal: {"value": "REDACTED FOR PRIVACY", "count": 123526354}<br>country: {"value": "REDACTED FOR PRIVACY", "count": 119229051}<br>phone: {"value": "", "count": 0}<br>fax: {"value": "", "count": 0}<br>email: {'value': 'redacted for privacy', 'count': 9920089} | name: {"value": "REDACTED FOR PRIVACY", "count": 131643982}<br>org: {"value": "REDACTED FOR PRIVACY", "count": 120617938}<br>street: {"value": "REDACTED FOR PRIVACY", "count": 118863405}<br>city: {"value": "REDACTED FOR PRIVACY", "count": 122675278}<br>state: {"value": "REDACTED FOR PRIVACY", "count": 118764947}<br>postal: {"value": "REDACTED FOR PRIVACY", "count": 123526354}<br>country: {"value": "REDACTED FOR PRIVACY", "count": 119229051}<br>phone: {"value": "", "count": 0}<br>fax: {"value": "", "count": 0}<br>email: {'value': 'redacted for privacy', 'count': 9915617} | name: {"value": "", "count": 0}<br>org: {"value": "", "count": 0}<br>street: {"value": "", "count": 0}<br>city: {"value": "", "count": 0}<br>state: {"value": "", "count": 0}<br>postal: {"value": "", "count": 0}<br>country: {"value": "", "count": 0}<br>phone: {"value": "", "count": 0}<br>fax: {"value": "", "count": 0}<br>email:  | {'value': 'enom.com', 'count': 21797646},<br>{'value': 'nsone.net', 'count': 6273096} | {'value': 'abuse@enom.com', 'count': 12520125} |  | clienttransferprohibited | true | {"value": "1998-08-02", "count": 881} | {"value": "2027-08-01", "count": 8614} | {'address': {'value': '141.193.213.20', 'count': 67508}, 'asn': [{'value': 209242, 'count': 1195750}], 'country_code': {'value': 'us', 'count': 197557302}, 'isp': {'value': 'WPEngine Inc.', 'count': 264650}},<br>{'address': {'value': '141.193.213.21', 'count': 64201}, 'asn': [{'value': 209242, 'count': 1195750}], 'country_code': {'value': 'us', 'count': 197557302}, 'isp': {'value': 'WPEngine Inc.', 'count': 264650}} | us | {'host': {'value': 'aspmx4.googlemail.com', 'count': 1445502}, 'domain': {'value': 'googlemail.com', 'count': 7834197}, 'ip': [{'value': '142.250.152.26', 'count': 8072705}], 'priority': 10},<br>{'host': {'value': 'aspmx2.googlemail.com', 'count': 7144886}, 'domain': {'value': 'googlemail.com', 'count': 7834197}, 'ip': [{'value': '142.250.115.27', 'count': 10961898}], 'priority': 10},<br>{'host': {'value': 'alt1.aspmx.l.google.com', 'count': 23734997}, 'domain': {'value': 'google.com', 'count': 27642606}, 'ip': [{'value': '142.250.115.27', 'count': 10961898}], 'priority': 5},<br>{'host': {'value': 'aspmx.l.google.com', 'count': 24146461}, 'domain': {'value': 'google.com', 'count': 27642606}, 'ip': [{'value': '142.250.99.26', 'count': 1071342}], 'priority': 1},<br>{'host': {'value': 'alt2.aspmx.l.google.com', 'count': 23642821}, 'domain': {'value': 'google.com', 'count': 27642606}, 'ip': [{'value': '64.233.171.27', 'count': 11245269}], 'priority': 5},<br>{'host': {'value': 'aspmx3.googlemail.com', 'count': 7030977}, 'domain': {'value': 'googlemail.com', 'count': 7834197}, 'ip': [{'value': '64.233.171.27', 'count': 11245269}], 'priority': 10} |  | {'host': {'value': 'dns4.p04.nsone.net', 'count': 402494}, 'domain': {'value': 'nsone.net', 'count': 3878719}, 'ip': [{'value': '198.51.45.68', 'count': 402483}]},<br>{'host': {'value': 'dns3.p04.nsone.net', 'count': 400519}, 'domain': {'value': 'nsone.net', 'count': 3878719}, 'ip': [{'value': '198.51.44.68', 'count': 400500}]},<br>{'host': {'value': 'dns1.p04.nsone.net', 'count': 400560}, 'domain': {'value': 'nsone.net', 'count': 3878719}, 'ip': [{'value': '198.51.44.4', 'count': 400568}]},<br>{'host': {'value': 'dns2.p04.nsone.net', 'count': 400314}, 'domain': {'value': 'nsone.net', 'count': 3878719}, 'ip': [{'value': '198.51.45.4', 'count': 400326}]} | {'hash': {'value': '7d4887aaaad43f8e68e359366dce8063635699e3', 'count': 1}, 'subject': {'value': 'CN=domaintools.com', 'count': 1}, 'organization': {'value': '', 'count': 0}, 'email': [], 'alt_names': [{'value': 'domaintools.com', 'count': 0}, {'value': 'blog.domaintools.com', 'count': 0}, {'value': 'www.domaintools.com', 'count': 0}], 'common_name': {'value': 'domaintools.com', 'count': 1}, 'issuer_common_name': {'value': 'Sectigo RSA Domain Validation Secure Server CA', 'count': 14181540}, 'not_after': {'value': 20240726, 'count': 310808}, 'not_before': {'value': 20230626, 'count': 256705}, 'duration': {'value': 397, 'count': 2562623}} | {"value": "", "count": 0} | {"value": "", "count": 0} | {"value": "", "count": 0} | {"value": "", "count": 0} | {"value": "DomainTools - The first place to go when you need to know.", "count": "[2](https://iris.domaintools.com/investigate/search/?q=domain:\\"domaintools.com\\")"} | {"value": "2001-10-26T00:00:00Z", "count": 0} | {"value": "Golfe2", "count": 1903001} | 3625 |
"""

domaintools_investigate_context = json.loads('{"domain": {"Name": "domaintools.com", "CreationDate": "1998-08-02", "DomainStatus": true, "ExpirationDate": "2027-08-01", "DNS": [{"type": "DNS", "ip": "141.193.213.20"}, {"type": "DNS", "ip": "141.193.213.21"}, {"type": "MX", "ip": "142.250.152.26", "host": "aspmx4.googlemail.com"}, {"type": "MX", "ip": "142.250.115.27", "host": "aspmx2.googlemail.com"}, {"type": "MX", "ip": "142.250.115.27", "host": "alt1.aspmx.l.google.com"}, {"type": "MX", "ip": "142.250.99.26", "host": "aspmx.l.google.com"}, {"type": "MX", "ip": "64.233.171.27", "host": "alt2.aspmx.l.google.com"}, {"type": "MX", "ip": "64.233.171.27", "host": "aspmx3.googlemail.com"}, {"type": "NS", "ip": "198.51.45.68", "host": "dns4.p04.nsone.net"}, {"type": "NS", "ip": "198.51.44.68", "host": "dns3.p04.nsone.net"}, {"type": "NS", "ip": "198.51.44.4", "host": "dns1.p04.nsone.net"}, {"type": "NS", "ip": "198.51.45.4", "host": "dns2.p04.nsone.net"}], "Registrant": {"Name": "REDACTED FOR PRIVACY", "Organization": "REDACTED FOR PRIVACY"}, "Geo": {"Country": "us us"}, "WHOIS": [{"key": "Admin Name", "value": "REDACTED FOR PRIVACY"}, {"key": "Admin Organization", "value": "REDACTED FOR PRIVACY"}, {"key": "Admin Email", "value": "redacted for privacy"}, {"key": "Admin Address", "value": "Street: REDACTED FOR PRIVACY, City: REDACTED FOR PRIVACY, State: REDACTED FOR PRIVACY, Postal: REDACTED FOR PRIVACY, Country: REDACTED FOR PRIVACY"}, {"key": "Registrant Name", "value": "REDACTED FOR PRIVACY"}, {"key": "Registrant Organization", "value": "REDACTED FOR PRIVACY"}, {"key": "Registrant Email", "value": "https://tieredaccess.com/contact/784fb607-c3ec-4640-b40f-30fc9f61b9ce"}, {"key": "Registrant Address", "value": "Street: REDACTED FOR PRIVACY, City: REDACTED FOR PRIVACY, State: WA, Postal: REDACTED FOR PRIVACY, Country: us"}, {"key": "Billing Address", "value": "Street: , City: , State: , Postal: , Country: "}, {"key": "Technical Name", "value": "REDACTED FOR PRIVACY"}, {"key": "Technical Organization", "value": "REDACTED FOR PRIVACY"}, {"key": "Technical Email", "value": "redacted for privacy"}, {"key": "Technical Address", "value": "Street: REDACTED FOR PRIVACY, City: REDACTED FOR PRIVACY, State: REDACTED FOR PRIVACY, Postal: REDACTED FOR PRIVACY, Country: REDACTED FOR PRIVACY"}, {"key": "Registrar", "value": {"value": "ENOM, INC.", "count": 3984318}}], "Rank": [{"source": "DomainTools Popularity Rank", "rank": 3625}], "ThreatTypes": [{"threatcategory": "risk_score", "threatcategoryconfidence": 0}, {"threatcategory": "zerolist", "threatcategoryconfidence": 0}], "Tags": ""}, "domaintools": {"Name": "domaintools.com", "LastEnriched": "2023-10-18", "Analytics": {"OverallRiskScore": 0, "ProximityRiskScore": 0, "ThreatProfileRiskScore": {"RiskScore": 0, "Threats": "", "Evidence": ""}, "WebsiteResponseCode": 200, "GoogleAdsenseTrackingCode": {"value": "", "count": 0}, "GoogleAnalyticTrackingCode": {"value": "", "count": 0}, "Tags": []}, "Identity": {"RegistrantName": "REDACTED FOR PRIVACY", "RegistrantOrg": "REDACTED FOR PRIVACY", "RegistrantContact": {"Country": {"value": "us", "count": 274018662}, "Email": [{"value": "https://tieredaccess.com/contact/784fb607-c3ec-4640-b40f-30fc9f61b9ce", "count": 1}], "Name": {"value": "REDACTED FOR PRIVACY", "count": 131643982}, "Phone": {"value": "", "count": 0}, "Street": {"value": "REDACTED FOR PRIVACY", "count": 118863405}, "City": {"value": "REDACTED FOR PRIVACY", "count": 122675278}, "State": {"value": "WA", "count": 7027354}, "Postal": {"value": "REDACTED FOR PRIVACY", "count": 123526354}, "Org": {"value": "REDACTED FOR PRIVACY", "count": 120617938}}, "Registrar": {"value": "ENOM, INC.", "count": 3984318}, "SOAEmail": [{"value": "hostmaster@nsone.net", "count": 6623371}], "SSLCertificateEmail": [], "AdminContact": {"Country": {"value": "REDACTED FOR PRIVACY", "count": 119229051}, "Email": [{"value": "redacted for privacy", "count": 9920089}], "Name": {"value": "REDACTED FOR PRIVACY", "count": 131643982}, "Phone": {"value": "", "count": 0}, "Street": {"value": "REDACTED FOR PRIVACY", "count": 118863405}, "City": {"value": "REDACTED FOR PRIVACY", "count": 122675278}, "State": {"value": "REDACTED FOR PRIVACY", "count": 118764947}, "Postal": {"value": "REDACTED FOR PRIVACY", "count": 123526354}, "Org": {"value": "REDACTED FOR PRIVACY", "count": 120617938}}, "TechnicalContact": {"Country": {"value": "REDACTED FOR PRIVACY", "count": 119229051}, "Email": [{"value": "redacted for privacy", "count": 9915617}], "Name": {"value": "REDACTED FOR PRIVACY", "count": 131643982}, "Phone": {"value": "", "count": 0}, "Street": {"value": "REDACTED FOR PRIVACY", "count": 118863405}, "City": {"value": "REDACTED FOR PRIVACY", "count": 122675278}, "State": {"value": "REDACTED FOR PRIVACY", "count": 118764947}, "Postal": {"value": "REDACTED FOR PRIVACY", "count": 123526354}, "Org": {"value": "REDACTED FOR PRIVACY", "count": 120617938}}, "BillingContact": {"Country": {"value": "", "count": 0}, "Email": [], "Name": {"value": "", "count": 0}, "Phone": {"value": "", "count": 0}, "Street": {"value": "", "count": 0}, "City": {"value": "", "count": 0}, "State": {"value": "", "count": 0}, "Postal": {"value": "", "count": 0}, "Org": {"value": "", "count": 0}}, "EmailDomains": ["enom.com", "nsone.net"], "AdditionalWhoisEmails": [{"value": "abuse@enom.com", "count": 12520125}]}, "Registration": {"RegistrarStatus": ["clienttransferprohibited"], "DomainStatus": true, "CreateDate": "1998-08-02", "ExpirationDate": "2027-08-01"}, "Hosting": {"IPAddresses": [{"address": {"value": "141.193.213.20", "count": 67508}, "asn": [{"value": 209242, "count": 1195750}], "country_code": {"value": "us", "count": 197557302}, "isp": {"value": "WPEngine Inc.", "count": 264650}}, {"address": {"value": "141.193.213.21", "count": 64201}, "asn": [{"value": 209242, "count": 1195750}], "country_code": {"value": "us", "count": 197557302}, "isp": {"value": "WPEngine Inc.", "count": 264650}}], "IPCountryCode": "us", "MailServers": [{"host": {"value": "aspmx4.googlemail.com", "count": 1445502}, "domain": {"value": "googlemail.com", "count": 7834197}, "ip": [{"value": "142.250.152.26", "count": 8072705}], "priority": 10}, {"host": {"value": "aspmx2.googlemail.com", "count": 7144886}, "domain": {"value": "googlemail.com", "count": 7834197}, "ip": [{"value": "142.250.115.27", "count": 10961898}], "priority": 10}, {"host": {"value": "alt1.aspmx.l.google.com", "count": 23734997}, "domain": {"value": "google.com", "count": 27642606}, "ip": [{"value": "142.250.115.27", "count": 10961898}], "priority": 5}, {"host": {"value": "aspmx.l.google.com", "count": 24146461}, "domain": {"value": "google.com", "count": 27642606}, "ip": [{"value": "142.250.99.26", "count": 1071342}], "priority": 1}, {"host": {"value": "alt2.aspmx.l.google.com", "count": 23642821}, "domain": {"value": "google.com", "count": 27642606}, "ip": [{"value": "64.233.171.27", "count": 11245269}], "priority": 5}, {"host": {"value": "aspmx3.googlemail.com", "count": 7030977}, "domain": {"value": "googlemail.com", "count": 7834197}, "ip": [{"value": "64.233.171.27", "count": 11245269}], "priority": 10}], "SPFRecord": "", "NameServers": [{"host": {"value": "dns4.p04.nsone.net", "count": 402494}, "domain": {"value": "nsone.net", "count": 3878719}, "ip": [{"value": "198.51.45.68", "count": 402483}]}, {"host": {"value": "dns3.p04.nsone.net", "count": 400519}, "domain": {"value": "nsone.net", "count": 3878719}, "ip": [{"value": "198.51.44.68", "count": 400500}]}, {"host": {"value": "dns1.p04.nsone.net", "count": 400560}, "domain": {"value": "nsone.net", "count": 3878719}, "ip": [{"value": "198.51.44.4", "count": 400568}]}, {"host": {"value": "dns2.p04.nsone.net", "count": 400314}, "domain": {"value": "nsone.net", "count": 3878719}, "ip": [{"value": "198.51.45.4", "count": 400326}]}], "SSLCertificate": [{"hash": {"value": "7d4887aaaad43f8e68e359366dce8063635699e3", "count": 1}, "subject": {"value": "CN=domaintools.com", "count": 1}, "organization": {"value": "", "count": 0}, "email": [], "alt_names": [{"value": "domaintools.com", "count": 0}, {"value": "blog.domaintools.com", "count": 0}, {"value": "www.domaintools.com", "count": 0}], "common_name": {"value": "domaintools.com", "count": 1}, "issuer_common_name": {"value": "Sectigo RSA Domain Validation Secure Server CA", "count": 14181540}, "not_after": {"value": 20240726, "count": 310808}, "not_before": {"value": 20230626, "count": 256705}, "duration": {"value": 397, "count": 2562623}}], "RedirectsTo": {"value": "", "count": 0}, "RedirectDomain": {"value": "", "count": 0}}, "WebsiteTitle": "DomainTools - The first place to go when you need to know.", "FirstSeen": "2001-10-26T00:00:00Z", "ServerType": "Golfe2"}, "dbotscore": {"Indicator": "domaintools.com", "Type": "domain", "Vendor": "DomainTools Iris", "Score": 1, "Reliability": null}}')

domaintools_enrich_readable = """### DomainTools Iris Enrich for domaintools.com. Investigate [domaintools.com](https://research.domaintools.com/iris/search/?q=domaintools.com) in Iris.
|Name|Last Enriched|Overall Risk Score|Proximity Risk Score|Threat Profile Risk Score|Threat Profile Threats|Threat Profile Evidence|Website Response Code|Tags|Registrant Name|Registrant Org|Registrant Contact|Registrar|SOA Email|SSL Certificate Email|Admin Contact|Technical Contact|Billing Contact|Email Domains|Additional Whois Emails|Domain Registrant|Registrar Status|Domain Status|Create Date|Expiration Date|IP Addresses|IP Country Code|Mail Servers|SPF Record|Name Servers|SSL Certificate|Redirects To|Redirect Domain|Google Adsense Tracking Code|Google Analytic Tracking Code|Website Title|First Seen|Server Type|Popularity|
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
| domaintools.com | 2023-11-10 | 0 | 0 | 0 |  |  | 200 |  | REDACTED FOR PRIVACY | REDACTED FOR PRIVACY | Country: {"value": "us", "count": 274018662}<br>Email: {'value': 'https://tieredaccess.com/contact/784fb607-c3ec-4640-b40f-30fc9f61b9ce', 'count': 1}<br>Name: {"value": "REDACTED FOR PRIVACY", "count": 131643982}<br>Phone: {"value": "", "count": 0}<br>Street: {"value": "REDACTED FOR PRIVACY", "count": 118863405}<br>City: {"value": "REDACTED FOR PRIVACY", "count": 122675278}<br>State: {"value": "WA", "count": 7027354}<br>Postal: {"value": "REDACTED FOR PRIVACY", "count": 123526354}<br>Org: {"value": "REDACTED FOR PRIVACY", "count": 120617938} | value: ENOM, INC.<br>count: 3984318 | {'value': 'hostmaster@nsone.net', 'count': 6623371} |  | Country: {"value": "REDACTED FOR PRIVACY", "count": 119229051}<br>Email: {'value': 'redacted for privacy', 'count': 9920089}<br>Name: {"value": "REDACTED FOR PRIVACY", "count": 131643982}<br>Phone: {"value": "", "count": 0}<br>Street: {"value": "REDACTED FOR PRIVACY", "count": 118863405}<br>City: {"value": "REDACTED FOR PRIVACY", "count": 122675278}<br>State: {"value": "REDACTED FOR PRIVACY", "count": 118764947}<br>Postal: {"value": "REDACTED FOR PRIVACY", "count": 123526354}<br>Org: {"value": "REDACTED FOR PRIVACY", "count": 120617938} | Country: {"value": "REDACTED FOR PRIVACY", "count": 119229051}<br>Email: {'value': 'redacted for privacy', 'count': 9915617}<br>Name: {"value": "REDACTED FOR PRIVACY", "count": 131643982}<br>Phone: {"value": "", "count": 0}<br>Street: {"value": "REDACTED FOR PRIVACY", "count": 118863405}<br>City: {"value": "REDACTED FOR PRIVACY", "count": 122675278}<br>State: {"value": "REDACTED FOR PRIVACY", "count": 118764947}<br>Postal: {"value": "REDACTED FOR PRIVACY", "count": 123526354}<br>Org: {"value": "REDACTED FOR PRIVACY", "count": 120617938} | Country: {"value": "", "count": 0}<br>Email: <br>Name: {"value": "", "count": 0}<br>Phone: {"value": "", "count": 0}<br>Street: {"value": "", "count": 0}<br>City: {"value": "", "count": 0}<br>State: {"value": "", "count": 0}<br>Postal: {"value": "", "count": 0}<br>Org: {"value": "", "count": 0} | enom.com,<br>nsone.net | {'value': 'abuse@enom.com', 'count': 12520125} |  | clienttransferprohibited | true | 1998-08-02 | 2027-08-01 | {'address': {'value': '141.193.213.20', 'count': 67508}, 'asn': [{'value': 209242, 'count': 1195750}], 'country_code': {'value': 'us', 'count': 197557302}, 'isp': {'value': 'WPEngine Inc.', 'count': 264650}},<br>{'address': {'value': '141.193.213.21', 'count': 64201}, 'asn': [{'value': 209242, 'count': 1195750}], 'country_code': {'value': 'us', 'count': 197557302}, 'isp': {'value': 'WPEngine Inc.', 'count': 264650}} | us | {'host': {'value': 'aspmx4.googlemail.com', 'count': 1445502}, 'domain': {'value': 'googlemail.com', 'count': 7834197}, 'ip': [{'value': '142.250.152.26', 'count': 8072705}], 'priority': 10},<br>{'host': {'value': 'aspmx2.googlemail.com', 'count': 7144886}, 'domain': {'value': 'googlemail.com', 'count': 7834197}, 'ip': [{'value': '142.250.115.27', 'count': 10961898}], 'priority': 10},<br>{'host': {'value': 'alt1.aspmx.l.google.com', 'count': 23734997}, 'domain': {'value': 'google.com', 'count': 27642606}, 'ip': [{'value': '142.250.115.27', 'count': 10961898}], 'priority': 5},<br>{'host': {'value': 'aspmx.l.google.com', 'count': 24146461}, 'domain': {'value': 'google.com', 'count': 27642606}, 'ip': [{'value': '142.250.99.26', 'count': 1071342}], 'priority': 1},<br>{'host': {'value': 'alt2.aspmx.l.google.com', 'count': 23642821}, 'domain': {'value': 'google.com', 'count': 27642606}, 'ip': [{'value': '64.233.171.27', 'count': 11245269}], 'priority': 5},<br>{'host': {'value': 'aspmx3.googlemail.com', 'count': 7030977}, 'domain': {'value': 'googlemail.com', 'count': 7834197}, 'ip': [{'value': '64.233.171.27', 'count': 11245269}], 'priority': 10} |  | {'host': {'value': 'dns4.p04.nsone.net', 'count': 402494}, 'domain': {'value': 'nsone.net', 'count': 3878719}, 'ip': [{'value': '198.51.45.68', 'count': 402483}]},<br>{'host': {'value': 'dns3.p04.nsone.net', 'count': 400519}, 'domain': {'value': 'nsone.net', 'count': 3878719}, 'ip': [{'value': '198.51.44.68', 'count': 400500}]},<br>{'host': {'value': 'dns1.p04.nsone.net', 'count': 400560}, 'domain': {'value': 'nsone.net', 'count': 3878719}, 'ip': [{'value': '198.51.44.4', 'count': 400568}]},<br>{'host': {'value': 'dns2.p04.nsone.net', 'count': 400314}, 'domain': {'value': 'nsone.net', 'count': 3878719}, 'ip': [{'value': '198.51.45.4', 'count': 400326}]} | {'hash': {'value': '7d4887aaaad43f8e68e359366dce8063635699e3', 'count': 1}, 'subject': {'value': 'CN=domaintools.com', 'count': 1}, 'organization': {'value': '', 'count': 0}, 'email': [], 'alt_names': [{'value': 'domaintools.com', 'count': 0}, {'value': 'blog.domaintools.com', 'count': 0}, {'value': 'www.domaintools.com', 'count': 0}], 'common_name': {'value': 'domaintools.com', 'count': 1}, 'issuer_common_name': {'value': 'Sectigo RSA Domain Validation Secure Server CA', 'count': 14181540}, 'not_after': {'value': 20240726, 'count': 310808}, 'not_before': {'value': 20230626, 'count': 256705}, 'duration': {'value': 397, 'count': 2562623}} | value: <br>count: 0 | value: <br>count: 0 | value: <br>count: 0 | value: <br>count: 0 | DomainTools - The first place to go when you need to know. | 2001-10-26T00:00:00Z | Golfe2 | {'source': 'DomainTools Popularity Rank', 'rank': 3625} |
"""

domaintools_enrich_context = json.loads('{"domain": {"Name": "domaintools.com", "CreationDate": "1998-08-02", "DomainStatus": true, "ExpirationDate": "2027-08-01", "DNS": [{"type": "DNS", "ip": "141.193.213.20"}, {"type": "DNS", "ip": "141.193.213.21"}, {"type": "MX", "ip": "142.250.152.26", "host": "aspmx4.googlemail.com"}, {"type": "MX", "ip": "142.250.115.27", "host": "aspmx2.googlemail.com"}, {"type": "MX", "ip": "142.250.115.27", "host": "alt1.aspmx.l.google.com"}, {"type": "MX", "ip": "142.250.99.26", "host": "aspmx.l.google.com"}, {"type": "MX", "ip": "64.233.171.27", "host": "alt2.aspmx.l.google.com"}, {"type": "MX", "ip": "64.233.171.27", "host": "aspmx3.googlemail.com"}, {"type": "NS", "ip": "198.51.45.68", "host": "dns4.p04.nsone.net"}, {"type": "NS", "ip": "198.51.44.68", "host": "dns3.p04.nsone.net"}, {"type": "NS", "ip": "198.51.44.4", "host": "dns1.p04.nsone.net"}, {"type": "NS", "ip": "198.51.45.4", "host": "dns2.p04.nsone.net"}], "Registrant": {"Name": "REDACTED FOR PRIVACY", "Organization": "REDACTED FOR PRIVACY"}, "Geo": {"Country": "us us"}, "WHOIS": [{"key": "Admin Name", "value": "REDACTED FOR PRIVACY"}, {"key": "Admin Organization", "value": "REDACTED FOR PRIVACY"}, {"key": "Admin Email", "value": "redacted for privacy"}, {"key": "Admin Address", "value": "Street: REDACTED FOR PRIVACY, City: REDACTED FOR PRIVACY, State: REDACTED FOR PRIVACY, Postal: REDACTED FOR PRIVACY, Country: REDACTED FOR PRIVACY"}, {"key": "Registrant Name", "value": "REDACTED FOR PRIVACY"}, {"key": "Registrant Organization", "value": "REDACTED FOR PRIVACY"}, {"key": "Registrant Email", "value": "https://tieredaccess.com/contact/784fb607-c3ec-4640-b40f-30fc9f61b9ce"}, {"key": "Registrant Address", "value": "Street: REDACTED FOR PRIVACY, City: REDACTED FOR PRIVACY, State: WA, Postal: REDACTED FOR PRIVACY, Country: us"}, {"key": "Billing Address", "value": "Street: , City: , State: , Postal: , Country: "}, {"key": "Technical Name", "value": "REDACTED FOR PRIVACY"}, {"key": "Technical Organization", "value": "REDACTED FOR PRIVACY"}, {"key": "Technical Email", "value": "redacted for privacy"}, {"key": "Technical Address", "value": "Street: REDACTED FOR PRIVACY, City: REDACTED FOR PRIVACY, State: REDACTED FOR PRIVACY, Postal: REDACTED FOR PRIVACY, Country: REDACTED FOR PRIVACY"}, {"key": "Registrar", "value": {"value": "ENOM, INC.", "count": 3984318}}], "Rank": [{"source": "DomainTools Popularity Rank", "rank": 3625}], "ThreatTypes": [{"threatcategory": "risk_score", "threatcategoryconfidence": 0}, {"threatcategory": "zerolist", "threatcategoryconfidence": 0}], "Tags": ""}, "domaintools": {"Name": "domaintools.com", "LastEnriched": "2023-10-18", "Analytics": {"OverallRiskScore": 0, "ProximityRiskScore": 0, "ThreatProfileRiskScore": {"RiskScore": 0, "Threats": "", "Evidence": ""}, "WebsiteResponseCode": 200, "GoogleAdsenseTrackingCode": {"value": "", "count": 0}, "GoogleAnalyticTrackingCode": {"value": "", "count": 0}, "Tags": []}, "Identity": {"RegistrantName": "REDACTED FOR PRIVACY", "RegistrantOrg": "REDACTED FOR PRIVACY", "RegistrantContact": {"Country": {"value": "us", "count": 274018662}, "Email": [{"value": "https://tieredaccess.com/contact/784fb607-c3ec-4640-b40f-30fc9f61b9ce", "count": 1}], "Name": {"value": "REDACTED FOR PRIVACY", "count": 131643982}, "Phone": {"value": "", "count": 0}, "Street": {"value": "REDACTED FOR PRIVACY", "count": 118863405}, "City": {"value": "REDACTED FOR PRIVACY", "count": 122675278}, "State": {"value": "WA", "count": 7027354}, "Postal": {"value": "REDACTED FOR PRIVACY", "count": 123526354}, "Org": {"value": "REDACTED FOR PRIVACY", "count": 120617938}}, "Registrar": {"value": "ENOM, INC.", "count": 3984318}, "SOAEmail": [{"value": "hostmaster@nsone.net", "count": 6623371}], "SSLCertificateEmail": [], "AdminContact": {"Country": {"value": "REDACTED FOR PRIVACY", "count": 119229051}, "Email": [{"value": "redacted for privacy", "count": 9920089}], "Name": {"value": "REDACTED FOR PRIVACY", "count": 131643982}, "Phone": {"value": "", "count": 0}, "Street": {"value": "REDACTED FOR PRIVACY", "count": 118863405}, "City": {"value": "REDACTED FOR PRIVACY", "count": 122675278}, "State": {"value": "REDACTED FOR PRIVACY", "count": 118764947}, "Postal": {"value": "REDACTED FOR PRIVACY", "count": 123526354}, "Org": {"value": "REDACTED FOR PRIVACY", "count": 120617938}}, "TechnicalContact": {"Country": {"value": "REDACTED FOR PRIVACY", "count": 119229051}, "Email": [{"value": "redacted for privacy", "count": 9915617}], "Name": {"value": "REDACTED FOR PRIVACY", "count": 131643982}, "Phone": {"value": "", "count": 0}, "Street": {"value": "REDACTED FOR PRIVACY", "count": 118863405}, "City": {"value": "REDACTED FOR PRIVACY", "count": 122675278}, "State": {"value": "REDACTED FOR PRIVACY", "count": 118764947}, "Postal": {"value": "REDACTED FOR PRIVACY", "count": 123526354}, "Org": {"value": "REDACTED FOR PRIVACY", "count": 120617938}}, "BillingContact": {"Country": {"value": "", "count": 0}, "Email": [], "Name": {"value": "", "count": 0}, "Phone": {"value": "", "count": 0}, "Street": {"value": "", "count": 0}, "City": {"value": "", "count": 0}, "State": {"value": "", "count": 0}, "Postal": {"value": "", "count": 0}, "Org": {"value": "", "count": 0}}, "EmailDomains": ["enom.com", "nsone.net"], "AdditionalWhoisEmails": [{"value": "abuse@enom.com", "count": 12520125}]}, "Registration": {"RegistrarStatus": ["clienttransferprohibited"], "DomainStatus": true, "CreateDate": "1998-08-02", "ExpirationDate": "2027-08-01"}, "Hosting": {"IPAddresses": [{"address": {"value": "141.193.213.20", "count": 67508}, "asn": [{"value": 209242, "count": 1195750}], "country_code": {"value": "us", "count": 197557302}, "isp": {"value": "WPEngine Inc.", "count": 264650}}, {"address": {"value": "141.193.213.21", "count": 64201}, "asn": [{"value": 209242, "count": 1195750}], "country_code": {"value": "us", "count": 197557302}, "isp": {"value": "WPEngine Inc.", "count": 264650}}], "IPCountryCode": "us", "MailServers": [{"host": {"value": "aspmx4.googlemail.com", "count": 1445502}, "domain": {"value": "googlemail.com", "count": 7834197}, "ip": [{"value": "142.250.152.26", "count": 8072705}], "priority": 10}, {"host": {"value": "aspmx2.googlemail.com", "count": 7144886}, "domain": {"value": "googlemail.com", "count": 7834197}, "ip": [{"value": "142.250.115.27", "count": 10961898}], "priority": 10}, {"host": {"value": "alt1.aspmx.l.google.com", "count": 23734997}, "domain": {"value": "google.com", "count": 27642606}, "ip": [{"value": "142.250.115.27", "count": 10961898}], "priority": 5}, {"host": {"value": "aspmx.l.google.com", "count": 24146461}, "domain": {"value": "google.com", "count": 27642606}, "ip": [{"value": "142.250.99.26", "count": 1071342}], "priority": 1}, {"host": {"value": "alt2.aspmx.l.google.com", "count": 23642821}, "domain": {"value": "google.com", "count": 27642606}, "ip": [{"value": "64.233.171.27", "count": 11245269}], "priority": 5}, {"host": {"value": "aspmx3.googlemail.com", "count": 7030977}, "domain": {"value": "googlemail.com", "count": 7834197}, "ip": [{"value": "64.233.171.27", "count": 11245269}], "priority": 10}], "SPFRecord": "", "NameServers": [{"host": {"value": "dns4.p04.nsone.net", "count": 402494}, "domain": {"value": "nsone.net", "count": 3878719}, "ip": [{"value": "198.51.45.68", "count": 402483}]}, {"host": {"value": "dns3.p04.nsone.net", "count": 400519}, "domain": {"value": "nsone.net", "count": 3878719}, "ip": [{"value": "198.51.44.68", "count": 400500}]}, {"host": {"value": "dns1.p04.nsone.net", "count": 400560}, "domain": {"value": "nsone.net", "count": 3878719}, "ip": [{"value": "198.51.44.4", "count": 400568}]}, {"host": {"value": "dns2.p04.nsone.net", "count": 400314}, "domain": {"value": "nsone.net", "count": 3878719}, "ip": [{"value": "198.51.45.4", "count": 400326}]}], "SSLCertificate": [{"hash": {"value": "7d4887aaaad43f8e68e359366dce8063635699e3", "count": 1}, "subject": {"value": "CN=domaintools.com", "count": 1}, "organization": {"value": "", "count": 0}, "email": [], "alt_names": [{"value": "domaintools.com", "count": 0}, {"value": "blog.domaintools.com", "count": 0}, {"value": "www.domaintools.com", "count": 0}], "common_name": {"value": "domaintools.com", "count": 1}, "issuer_common_name": {"value": "Sectigo RSA Domain Validation Secure Server CA", "count": 14181540}, "not_after": {"value": 20240726, "count": 310808}, "not_before": {"value": 20230626, "count": 256705}, "duration": {"value": 397, "count": 2562623}}], "RedirectsTo": {"value": "", "count": 0}, "RedirectDomain": {"value": "", "count": 0}}, "WebsiteTitle": "DomainTools - The first place to go when you need to know.", "FirstSeen": "2001-10-26T00:00:00Z", "ServerType": "Golfe2"}, "dbotscore": {"Indicator": "domaintools.com", "Type": "domain", "Vendor": "DomainTools Iris", "Score": 1, "Reliability": null}}')


parsed_domain_rdap_table = """### DomainTools parsed domain rdap result for domaintools.com
|domain|handle|domain_statuses|creation_date|last_changed_date|expiration_date|dnssec|nameservers|conformance|emails|email_domains|unclassified_emails|registrar_name|registrar_iana_id|registrar_contacts_name|registrar_contacts_email|registrar_contacts_phone|registrar_contacts_roles|contact_name_1|contact_email_1|contact_street_1|contact_city_1|contact_postal_1|contact_region_1|contact_country_1|contact_roles_1|contact_name_2|contact_email_2|contact_roles_2|contact_name_3|contact_email_3|contact_roles_3|contact_roles_4|
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
| DOMAINTOOLS.COM | 1697312_DOMAIN_COM-VRSN | client transfer prohibited | 1998-08-02T04:00:00+00:00 | 2020-01-09T23:06:29+00:00 | 2027-08-01T04:00:00+00:00 | signed: false | DNS1.P04.NSONE.NET., DNS2.P04.NSONE.NET., DNS3.P04.NSONE.NET., DNS4.P04.NSONE.NET. | rdap_level_0, icann_rdap_response_profile_0, icann_rdap_technical_implementation_guide_0 | abuse@enom.com, redacted for privacy | enom.com |  | ENOM, INC. | 48 | ENOM, INC. | ABUSE@ENOM.COM | tel:+1.4259744689 | abuse | REDACTED FOR PRIVACY | REDACTED FOR PRIVACY |  |  |  | WA | US | registrant | REDACTED FOR PRIVACY | REDACTED FOR PRIVACY | administrative | REDACTED FOR PRIVACY | REDACTED FOR PRIVACY | technical | reseller |
"""
