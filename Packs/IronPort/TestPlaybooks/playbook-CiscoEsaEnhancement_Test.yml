id: CiscoEsaEnhancement_Test
name: CiscoEsaEnhancement_Test
version: -1
fromversion: 6.14.0
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: "0"
    type: start
    task:
      id: "0"
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ""
    nexttasks:
      "#none#":
        - "1"
    separatecontext: false
    view: '{"position":{"x":50,"y":50}}'
    note: false
    timertriggers: []
    ignoreworker: false
  "1":
    id: 1
    taskid: "1"
    type: regular
    task:
      id: "1"
      version: -1
      name: DeleteContext
      description: ""
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "2"
    scriptarguments:
      all:
        simple: yes
    separatecontext: false
    view: '{"position":{"x":50,"y":200}}'
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
  "2":
    id: 2
    taskid: "2"
    type: regular
    task:
      id: "2"
      version: -1
      name: cisco-esa-message-amp-details-get
      description: ""
      script: CiscoESA|||cisco-esa-message-amp-details-get
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "3"
    scriptarguments:
      message_ids:
        simple: "123"
      injection_connection_id:
        simple: "123"
      serial_number:
        simple: "123"
      limit:
        simple: "1"
    separatecontext: false
    view: '{"position":{"x":50,"y":400}}'
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
  "3":
    id: "3"
    taskid: "3"
    type: condition
    task:
      id: "3"
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      description: ""
      brand: ""
    nexttasks:
      yes:
        - "4"
    separatecontext: false
    conditions:
      - label: yes
        condition:
          - - operator: isExists
              left:
                value:
                  simple: CiscoESA.AMPDetail.showampdetails
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.AMPDetail.direction
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.AMPDetail.smtpauthid
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.AMPDetail.sender
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.AMPDetail.midheader
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.AMPDetail.timestamp
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.AMPDetail.hostname
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.AMPDetail.mid
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.AMPDetail.sendinghostsummary
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.AMPDetail.attachments
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.AMPDetail.messagesize
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.AMPDetail.ampdetails
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.AMPDetail.sendergroup
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.AMPDetail.recipient
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.AMPDetail.subject
                iscontext: true
    view: '{"position":{"x":50,"y":600}}'
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
  "4":
    id: 4
    taskid: "4"
    type: regular
    task:
      id: "4"
      version: -1
      name: cisco-esa-message-url-details-get
      description: ""
      script: CiscoESA|||cisco-esa-message-url-details-get
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "5"
    scriptarguments:
      message_ids:
        simple: "123"
      injection_connection_id:
        simple: "123"
      serial_number:
        simple: "123"
      limit:
        simple: "1"
    separatecontext: false
    view: '{"position":{"x":50,"y":800}}'
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
  "5":
    id: "5"
    taskid: "5"
    type: condition
    task:
      id: "5"
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      description: ""
      brand: ""
    nexttasks:
      yes:
        - "6"
    separatecontext: false
    conditions:
      - label: yes
        condition:
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.URLDetail.direction
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.URLDetail.smtpauthid
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.URLDetail.sdrage
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.URLDetail.sender
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.URLDetail.midheader
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.URLDetail.urldetails
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.URLDetail.sdrcategory
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.URLDetail.hostname
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.URLDetail.mids
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.URLDetail.sendinghostsummary
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.URLDetail.attachments
                iscontext: true
          - - operator: isExists
              left:
                value:
                  simple: CiscoESA.URLDetail.showurldetails
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.URLDetail.sendergroup
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.URLDetail.recipient
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.URLDetail.subject
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.URLDetail.sdr_reputation
                iscontext: true
    view: '{"position":{"x":50,"y":1000}}'
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
  "6":
    id: 6
    taskid: "6"
    type: regular
    task:
      id: "6"
      version: -1
      name: cisco-esa-dictionary-words-update
      description: ""
      script: CiscoESA|||cisco-esa-dictionary-words-update
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "7"
    scriptarguments:
      dictionary_name:
        simple: test
      words:
        simple: "['a1',1]"
    separatecontext: false
    view: '{"position":{"x":50,"y":1200}}'
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
  "7":
    id: 7
    taskid: "7"
    type: regular
    task:
      id: "7"
      version: -1
      name: cisco-esa-url-list
      description: ""
      script: CiscoESA|||cisco-esa-url-list
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "8"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    view: '{"position":{"x":50,"y":1400}}'
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
  "8":
    id: "8"
    taskid: "8"
    type: condition
    task:
      id: "8"
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      description: ""
      brand: ""
    nexttasks:
      yes:
        - "9"
    separatecontext: false
    conditions:
      - label: yes
        condition:
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.URLList.used_by
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.URLList.urls_count
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.URLList.name
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.URLList.urls
                iscontext: true
    view: '{"position":{"x":50,"y":1600}}'
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
  "9":
    id: 9
    taskid: "9"
    type: regular
    task:
      id: "9"
      version: -1
      name: cisco-esa-url-list-create
      description: ""
      script: CiscoESA|||cisco-esa-url-list-create
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "10"
    scriptarguments:
      url_list_name:
        simple: testurllist
      urls:
        simple: test.com
    separatecontext: false
    view: '{"position":{"x":50,"y":1800}}'
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
  "10":
    id: 10
    taskid: "10"
    type: regular
    task:
      id: "10"
      version: -1
      name: cisco-esa-url-list-update
      description: ""
      script: CiscoESA|||cisco-esa-url-list-update
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "11"
    scriptarguments:
      url_list_name:
        simple: testurllist
      urls:
        simple: test2.com
    separatecontext: false
    view: '{"position":{"x":50,"y":2000}}'
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
  "11":
    id: 11
    taskid: "11"
    type: regular
    task:
      id: "11"
      version: -1
      name: cisco-esa-url-list-delete
      description: ""
      script: CiscoESA|||cisco-esa-url-list-delete
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "12"
    scriptarguments:
      url_list_names:
        simple: testurllist
    separatecontext: false
    view: '{"position":{"x":50,"y":2200}}'
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
  "12":
    id: 12
    taskid: "12"
    type: regular
    task:
      id: "12"
      version: -1
      name: cisco-esa-file-hash-list
      description: ""
      script: CiscoESA|||cisco-esa-file-hash-list
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "13"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    view: '{"position":{"x":50,"y":2400}}'
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
  "13":
    id: "13"
    taskid: "13"
    type: condition
    task:
      id: "13"
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      description: ""
      brand: ""
    nexttasks:
      yes:
        - "14"
    separatecontext: false
    conditions:
      - label: yes
        condition:
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.FileHashList.filehashes
                iscontext: true
          - - operator: isExists
              left:
                value:
                  simple: CiscoESA.FileHashList.description
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.FileHashList.list_type
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.FileHashList.name
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.FileHashList.filehashes_count
                iscontext: true
    view: '{"position":{"x":50,"y":2600}}'
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
  "14":
    id: 14
    taskid: "14"
    type: regular
    task:
      id: "14"
      version: -1
      name: cisco-esa-file-hash-create
      description: ""
      script: CiscoESA|||cisco-esa-file-hash-create
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "15"
    scriptarguments:
      file_hash_list_name:
        simple: testfilehash
      description:
        simple: test
      filehashes:
        simple: 2286f6ffea7d0e58dcb3ecfd874041b1
      list_type:
        simple: any
    separatecontext: false
    view: '{"position":{"x":50,"y":2800}}'
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
  "15":
    id: 15
    taskid: "15"
    type: regular
    task:
      id: "15"
      version: -1
      name: cisco-esa-file-hash-update
      description: ""
      script: CiscoESA|||cisco-esa-file-hash-update
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "16"
    scriptarguments:
      file_hash_list_name:
        simple: testfilehash
      filehashes:
        simple: 2286f6ffea7d0e58dcb3ecfd874041b2
    separatecontext: false
    view: '{"position":{"x":50,"y":3000}}'
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
  "16":
    id: 16
    taskid: "16"
    type: regular
    task:
      id: "16"
      version: -1
      name: cisco-esa-pvo-quarantine-list
      description: ""
      script: CiscoESA|||cisco-esa-pvo-quarantine-list
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "17"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    view: '{"position":{"x":50,"y":3200}}'
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
  "17":
    id: "17"
    taskid: "17"
    type: condition
    task:
      id: "17"
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      description: ""
      brand: ""
    nexttasks:
      yes:
        - "18"
    separatecontext: false
    conditions:
      - label: yes
        condition:
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.QuarantineRule.number_of_messages
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.QuarantineRule.capacity
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.QuarantineRule.rule_id
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.QuarantineRule.total_size
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.QuarantineRule.rule_description
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.QuarantineRule.average_message_size
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.QuarantineRule.rid
                iscontext: true
    view: '{"position":{"x":50,"y":3400}}'
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
  "18":
    id: 18
    taskid: "18"
    type: regular
    task:
      id: "18"
      version: -1
      name: cisco-esa-pvo-quarantine-message-release
      description: ""
      script: CiscoESA|||cisco-esa-pvo-quarantine-message-release
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "19"
    scriptarguments:
      rule_ids:
        simple: "12"
    separatecontext: false
    view: '{"position":{"x":50,"y":3600}}'
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
  "19":
    id: 19
    taskid: "19"
    type: regular
    task:
      id: "19"
      version: -1
      name: cisco-esa-pvo-quarantine-message-delete
      description: ""
      script: CiscoESA|||cisco-esa-pvo-quarantine-message-delete
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "20"
    scriptarguments:
      rule_ids:
        simple: "12"
    separatecontext: false
    view: '{"position":{"x":50,"y":3800}}'
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
  "20":
    id: 20
    taskid: "20"
    type: regular
    task:
      id: "20"
      version: -1
      name: cisco-esa-user-entry-list
      description: ""
      script: CiscoESA|||cisco-esa-user-entry-list
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "21"
    scriptarguments:
      policy_name:
        simple: test
      limit:
        simple: "1"
    separatecontext: false
    view: '{"position":{"x":50,"y":4000}}'
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
  "21":
    id: "21"
    taskid: "21"
    type: condition
    task:
      id: "21"
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      description: ""
      brand: ""
    nexttasks:
      yes:
        - "22"
    separatecontext: false
    conditions:
      - label: yes
        condition:
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.IncomingMailPolicyUser.sender_config.Sender.domain_entries
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.IncomingMailPolicyUser.receiver_config.operation
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.IncomingMailPolicyUser.receiver_config.receiver.domain_entries
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.IncomingMailPolicyUser.receiver_config.receiver_not.domain_entries
                iscontext: true
    view: '{"position":{"x":50,"y":4200}}'
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
  "22":
    id: 22
    taskid: "22"
    type: regular
    task:
      id: "22"
      version: -1
      name: cisco-esa-user-entry-update
      description: ""
      script: CiscoESA|||cisco-esa-user-entry-update
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "23"
    scriptarguments:
      policy_name:
        simple: test
      receiver_domain_entries:
        simple: test2@
      receiver_operation:
        simple: and
      sender_domain_entries:
        simple: test2@
    separatecontext: false
    view: '{"position":{"x":50,"y":4400}}'
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
  "23":
    id: 23
    taskid: "23"
    type: regular
    task:
      id: "23"
      version: -1
      name: cisco-esa-message-connection-details-get
      description: ""
      script: CiscoESA|||cisco-esa-message-connection-details-get
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "24"
    scriptarguments:
      message_ids:
        simple: "123"
      injection_connection_id:
        simple: "123"
      serial_number:
        simple: "123"
      limit:
        simple: "1"
    separatecontext: false
    view: '{"position":{"x":50,"y":4600}}'
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
  "24":
    id: "24"
    taskid: "24"
    type: condition
    task:
      id: "24"
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      description: ""
      brand: ""
    nexttasks:
      yes:
        - "25"
    separatecontext: false
    conditions:
      - label: yes
        condition:
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.MessageConnection.sendergroup
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.MessageConnection.Message.timestamp
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.MessageConnection.Message.description
                iscontext: true
          - - operator: isExists
              left:
                value:
                  simple: CiscoESA.MessageConnection.Message.last_event
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.MessageConnection.sbrs
                iscontext: true
    view: '{"position":{"x":50,"y":4800}}'
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
  "25":
    id: 25
    taskid: "25"
    type: regular
    task:
      id: "25"
      version: -1
      name: cisco-esa-message-remediation-details-get
      description: ""
      script: CiscoESA|||cisco-esa-message-remediation-details-get
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "26"
    scriptarguments:
      message_ids:
        simple: "123"
      injection_connection_id:
        simple: "123"
      serial_number:
        simple: "123"
      limit:
        simple: "1"
    separatecontext: false
    view: '{"position":{"x":50,"y":5000}}'
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
  "26":
    id: "26"
    taskid: "26"
    type: condition
    task:
      id: "26"
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      description: ""
      brand: ""
    nexttasks:
      yes:
        - "27"
    separatecontext: false
    conditions:
      - label: yes
        condition:
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.MessageRemediation.batch_details.b_init_username
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.MessageRemediation.batch_details.mor_action
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.MessageRemediation.batch_details.b_init_time
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.MessageRemediation.batch_details.batch_name
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.MessageRemediation.batch_details.batch_desc
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.MessageRemediation.batch_details.b_init_source
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.MessageRemediation.message_details.delivered_at
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.MessageRemediation.message_details.mid
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.MessageRemediation.message_details.from_email
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.MessageRemediation.message_details.recipient_email
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.MessageRemediation.message_details.mor_status
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: CiscoESA.MessageRemediation.message_details.msg_read
                iscontext: true
    view: '{"position":{"x":50,"y":5200}}'
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
  "27":
    id: "27"
    taskid: "27"
    type: title
    task:
      id: "27"
      version: -1
      name: Test Done
      type: title
      iscommand: false
      brand: ""
      description: ""
    separatecontext: false
    view: '{"position":{"x":50,"y":5400}}'
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
view: '{"linkLabelsPosition":{},"paper":{"dimensions":{"height":200,"width":380,"x":50,"y":50}}}'
inputs: []
outputs: []
