commonfields:
  id: CiscoWSA
  version: -1
name: CiscoWSA
display: Cisco WSA
category: Network Security
description: Cisco Secure Web Appliance protects your organisation by automatically blocking risky sites and testing unknown sites before allowing users to click on them.
configuration:
- name: base_url
  display: Server URL
  required: true
  type: 0
  additionalinfo: Base URL, e.g., https://XXX.eu.iphmx.com
- name: credentials
  display: Username
  required: true
  type: 9
  additionalinfo: ""
  displaypassword: Password
  hiddenusername: false
- name: proxy
  display: Use system proxy
  defaultvalue: 'false'
  type: 8
  required: false
- name: insecure
  display: Trust any certificate
  defaultvalue: 'false'
  type: 8
  required: false
script:
  type: python
  subtype: python3
  script: '-'
  dockerimage: demisto/python3:3.10.8.37233
  isfetch: false
  commands:
  - name: cisco-wsa-access-policy-list
    description: |-
      Retrieve access policies.
      Access policies containing allowed/blocked URL categories in the network.   
    arguments:
    - name: policy_names
      description: Policy names to retrieve.
      required: false
      isArray: true
    - name: page
      description: |-
        Page number of paginated results.
        Minimum value is 1.
      isArray: false
      required: false
    - name: page_size
      description: Number of results per page. Maximum value is 100.
      isArray: false
      required: false
    - name: limit
      defaultValue: 50
      description: The maximum number of records to retrieve.
      isArray: false
      required: false
    outputs:
    - type: String
      contextPath: CiscoWSA.AccessPolicy.policy_expiry
      description: Policy expiry date.
    - type: String
      contextPath: CiscoWSA.AccessPolicy.policy_status
      description: Policy status.
    - type: String
      contextPath: CiscoWSA.AccessPolicy.policy_name
      description: Policy name.
    - type: String
      contextPath: CiscoWSA.AccessPolicy.policy_description
      description: Policy description.
    - type: Unknown
      contextPath: CiscoWSA.AccessPolicy.membership.identification_profiles
      description: Identification Profiles info.
    - type: Unknown
      contextPath: CiscoWSA.AccessPolicy.objects
      description: Policy custom objects blocking settings.
    - type: Unknown
      contextPath: CiscoWSA.AccessPolicy.protocols_user_agents
      description: Policy protocols and user agents settings.
    - type: Unknown
      contextPath: CiscoWSA.AccessPolicy.http_rewrite_profile
      description: Policy HTTP rewrite profile settings.
    - type: Unknown
      contextPath: CiscoWSA.AccessPolicy.avc.applications
      description: Application visibility and control.
    - type: Unknown
      contextPath: CiscoWSA.AccessPolicy.url_filtering
      description: URL filtering settings.
    - type: Unknown
      contextPath: CiscoWSA.AccessPolicy.amw_reputation
      description: Anti-Malware and reputation settings.
  - name: cisco-wsa-access-policy-create
    description: Create access policy.
    arguments:
    - name: policy_name
      description: Policy name.
      required: true
      isArray: false
    - name: policy_status
      description: Policy status.
      required: true
      isArray: false
      auto: PREDEFINED
      predefined:
      - enable
      - disable
    - name: policy_description
      description: Policy description
      required: false
      isArray: false
    - name: policy_order
      description: Policy order, index of policy in the collection.
      required: true
      isArray: false
    - name: policy_expiry
      description: Policy expiry date, format MM/DD/YYYY HH:MM, e.g. 01/25/2023 08:30
      required: false
      isArray: false
    - name: identification_profile_name
      description: Valid identification profile name.
      required: true
      isArray: false
  - name: cisco-wsa-access-policy-update
    description: Update access policy.
    arguments:
    - name: policy_name
      description: Policy name to update.
      required: true
      isArray: false
    - name: new_policy_name
      description: New policy name.
      required: false
      isArray: false
    - name: policy_status
      description: Policy status.
      required: false
      isArray: false
      auto: PREDEFINED
      predefined:
      - enable
      - disable
    - name: policy_order
      description: Policy order, index of policy in the collection. Not applicable for global_policy.
      required: false
      isArray: false
    - name: policy_expiry
      description: Policy expiry date, format MM/DD/YYYY HH:MM, e.g. 01/25/2023 08:30
      required: false
      isArray: false
    - name: policy_description
      description: Policy description to update.
      required: false
      isArray: false
  - name: cisco-wsa-access-policy-protocols-user-agents-update
    description: Update Protocols and User Agents policy for access policy.
    arguments:
    - name: policy_name
      description: Policy name to update.
      required: true
      isArray: false
    - name: block_custom_user_agents
      description: |- 
        Custom user agents to block, in regular expression format.
        Pattern examples:
        All Firefox versions: "Mozilla/.* Gecko/.* Firefox/"	
        Firefox versions 1.5.x: "Mozilla/.* Gecko/.* Firefox/1\.5"	
        All Internet Explorer versions: "Mozilla/.*compatible; MSIE"
        Internet Explorer version 5.5: "Mozilla/.*compatible; MSIE 5\.5"
        Specific user agent: Mozilla/4.0 (compatible; MSIE 5.5;): "Mozilla/4.0 \(compatible; MSIE 5.5;\)"
      required: false
      isArray: true
    - name: allow_connect_ports
      description: |-
        HTTP CONNECT enables applications to tunnel outbound traffic over HTTP,
        unless the protocol is blocked above.
        Traffic tunneled through HTTP CONNECT will not be scanned,
        except for SSL ports (specified on Security Services > HTTPS Proxy)
        e.g. 1-65535,20,21
      required: false
      isArray: true
    - name: block_protocols
      description: Block network protocols.
      required: false
      isArray: true
      auto: PREDEFINED
      predefined:
      - ftp
      - http
  - name: cisco-wsa-access-policy-url-filtering-update
    description: Update URL filtering policy for access policy.
    arguments:
    - name: policy_name
      description: Policy name to update.
      required: true
      isArray: false
    - name: predefined_categories_action
      description: Predefined categories action.
      required: false
      isArray: false
      auto: PREDEFINED
      predefined:
      - block
      - monitor
      - allow
    - name: predefined_categories
      description: Predefined categories.
      required: false
      isArray: true
    - name: youtube_categories_action
      description: Youtube categories action.
      required: false
      isArray: false
      auto: PREDEFINED
      predefined:
      - block
      - monitor
      - allow
    - name: youtube_categories
      description: Youtube categories.
      required: false
      isArray: true
    - name: custom_categories_action
      description: Policy description to update.
      required: false
      isArray: false
      auto: PREDEFINED
      predefined:
      - block
      - monitor
      - allow
    - name: custom_categories
      description: Policy description to update.
      required: false
      isArray: true
    - name: uncategorized_url
      description: Uncategorized url action
      required: false
      isArray: false
      auto: PREDEFINED
      predefined:
      - use_global
      - block
      - monitor
      - warn
    - name: update_categories_action
      description: |-
        When predefined URL categories are periodically updated,
        new categories may be introduced, or two (or more) existing categories may be merged.
        Select whether the most or least restrictive action should be applied in these cases.
        For new categories, in Access policies,
        most restrictive is always Block and least restrictive is always Monitor.
        For merged categories, the most or least restrictive setting will be selected out of the
        settings previously assigned.
        For instance, if category A was set to Block, and category B was set to Warn,
        and the two are merged into category C,
        the most restrictive action will be Block and the least restrictive action will be Warn.
      required: false
      isArray: false
      auto: PREDEFINED
      predefined:
      - use_global
      - most restrictive
      - least restrictive
    - name: content_rating_status
      description: |-
        When Site Content Rating is enabled, user access to web content rated as adult oriented or
        explicit on sites that support content rating will be denied.
        Supported sites include Flickr, Craigslist and YouTube.
        However, users can still access content on these websites that is not rated as adult oriented or explicit.
      required: false
      isArray: false
      auto: PREDEFINED
      predefined:
      - enable
      - disable
    - name: content_rating_action
      description: Action if site setting (content_rating_status) allows adult/explicit content.
      required: false
      isArray: false
      auto: PREDEFINED
      predefined:
      - block
      - warn
    - name: safe_search_status
      description: |-
        When Safe Search is enabled, non-safe content, including the cached non-safe content
        will be blocked from the search result from the following search engines:
        Dogpile, Yandex, Google, Yahoo, Bing, WebCrawler, DuckDuckGo, Dailymotion and eBay.
        If safe search failed to be enforced on a supported search engine, it will be blocked.
      required: false
      isArray: false
      auto: PREDEFINED
      predefined:
      - enable
      - disable
    - name: unsupported_safe_search_engine
      description: Action for search engines that don't support safe search.
      required: false
      isArray: false
      auto: PREDEFINED
      predefined:
      - block
      - monitor
  - name: cisco-wsa-access-policy-applications-update
    description: Update applications policy for access policy. only applicable for global_policy
    arguments:
    - name: policy_name
      description: Policy name to update.
      required: true
      isArray: false
    - name: application
      description: Application type to perform action on.
      required: true
      isArray: false
      auto: PREDEFINED
      predefined:
      - Games
      - Enterprise Applications
      - Media
      - Collaboration
      - Instant Messaging
      - Facebook
      - Social Networking
      - Internet Utilities
      - Webmail
      - Proxies
      - Presentation / Conferencing
      - Software Updates
      - iTunes
      - Google+
      - File Sharing
      - Myspace
      - Blogging
      - LinkedIn
      - Office Suites
    - name: action
      description: Application action.
      required: true
      isArray: false
      auto: PREDEFINED
      predefined:
      - monitor
      - block
    - name: values
      description: Application values to perform action on.
      required: true
      isArray: true
  - name: cisco-wsa-access-policy-objects-update
    description: Update objects policy for access policy.
    arguments:
    - name: policy_name
      description: Policy name to update.
      required: true
      isArray: false
    - name: object_type
      description: Object type to perform action on.
      required: false
      isArray: false
      auto: PREDEFINED
      predefined:
      - Executable Code
      - Web Page Content
      - Media
      - P2P Metafiles
      - Miscellaneous
      - Document Types
      - Archives
      - Installers
      - Inspectable Archives
    - name: object_action
      description: |-
        Object action.
        Note: "inspect" and "allow" actions only valid when object type is "Inspectable Archives".
        Note: adding values with block/inspect action will overwrite the existing values
        and will set previous values on monitor action.
      required: false
      isArray: false
      auto: PREDEFINED
      predefined:
      - monitor
      - block
      - allow
      - inspect
    - name: object_values
      description: Object values to perform action on.
      required: false
      isArray: true
    - name: block_custom_mime_types
      description: Block custom MIME types, e.g. audio/x-mpeg3 or audio/*.
      required: false
      isArray: false
    - name: http_or_https_max_object_size_mb
      description: HTTP/HTTPS Max Download Size.
      required: false
      isArray: false
    - name: ftp_max_object_size_mb
      description: FTP Max Download Size.
      required: false
      isArray: false
  - name: cisco-wsa-access-policy-anti-malware-update
    description: Update anti malware policy for access policy.
    arguments:
    - name: policy_name
      description: Policy name to update.
      required: true
      isArray: false
    - name: web_reputation_status
      description: |-
        Web Reputation Filters will automatically block transactions with a low Web Reputation score.
        For transactions with a higher Web Reputation score,
        scanning will be performed using the services selected by Adaptive Scanning.
        If Web Reputation Filtering is disabled in this policy,
        transactions will not be automatically blocked based on low Web Reputation Score.
        Blocking of sites that contain malware or other high-risk content is controlled by the additional arguments.
      required: false
      isArray: false
      auto: PREDEFINED
      predefined:
      - enable
      - disable
    - name: file_reputation_filtering_status
      description: |-
        File Reputation Filters will identify transactions containing known malicious or high-risk files.
        Files that are unknown may be forwarded to the cloud for File Analysis.
      required: false
      isArray: false
      auto: PREDEFINED
      predefined:
      - enable
      - disable
    - name: file_reputation_action
      description: |-
        File Reputation action.
      required: false
      isArray: false
      auto: PREDEFINED
      predefined:
      - monitor
      - block
    - name: suspect_user_agent_scanning
      description: |-
        Suspect user agent scanning action.
      required: false
      isArray: false
      auto: PREDEFINED
      predefined:
      - block
      - scan
      - none
    - name: malware_categories_action
      description: Malware categories action.
      required: false
      isArray: false
      auto: PREDEFINED
      predefined:
      - monitor
      - block
    - name: malware_categories_values
      description: Malware categories values to perform action on.
      required: false
      isArray: true
    - name: other_categories_action
      description: Other categories action.
      required: false
      isArray: false
      auto: PREDEFINED
      predefined:
      - monitor
      - block
    - name: other_categories_values
      description: Other categories values to perform action on.
      required: false
      isArray: true
  - name: cisco-wsa-access-policy-delete
    description: Delete access policy.
    arguments:
    - name: policy_names
      description: Comma separated policy names to delete.
      required: true
      isArray: true
  - name: cisco-wsa-domain-map-list
    description: |-
      Retrieve domain mappings.
      Domain maps are DNS mappings of domain to IP addresses.
    arguments:
    - name: domain_names
      description: Comma separated domain names to retrieve.
      required: false
      isArray: true
    - name: page
      description: |-
        Page number of paginated results.
        Minimum value is 1.
      isArray: false
      required: false
    - name: page_size
      description: Number of results per page. Maximum value is 100.
      isArray: false
      required: false
    - name: limit
      defaultValue: 50
      description: The maximum number of records to retrieve.
      isArray: false
      required: false
    outputs:
    - type: String
      contextPath: CiscoWSA.DomainMap.domain_name
      description: Domain name.
    - type: String
      contextPath: CiscoWSA.DomainMap.IP_addresses
      description: Mapped IP addresses.
    - type: Number
      contextPath: CiscoWSA.DomainMap.order
      description: Domain map order, index of domain map in the collection.
  - name: cisco-wsa-domain-map-create
    description: Create domain mapping for IP addresses.
    arguments:
    - name: domain_name
      description: Domain name to create.
      required: true
      isArray: false
    - name: order
      description: Domain map order, index of domain map in the collection.
      required: true
      isArray: false
    - name: ip_addresses
      description: IP addresses to map for the domain.
      required: true
      isArray: true
  - name: cisco-wsa-domain-map-update
    description: Update domain map.
    arguments:
    - name: domain_name
      description: Domain name to update.
      required: true
      isArray: false
    - name: new_domain_name
      description: New domain name.
      required: false
      isArray: false
    - name: order
      description: Domain map order, index of domain map in the collection.
      required: false
      isArray: false
    - name: ip_addresses
      description: IP addresses to map for the domain.
      required: false
      isArray: true
  - name: cisco-wsa-domain-map-delete
    description: Delete domain map.
    arguments:
    - name: domain_names
      description: Domain names to delete.
      required: true
      isArray: true
  - name: cisco-wsa-identification-profiles-list
    description: |-
      Retrieve identification profiles.
      Identification Profiles	are classifications	of users, defining authentication requirements.
    arguments:
    - name: profile_names
      description: Comma separated profile names to retrieve.
      required: false
      isArray: true
    - name: page
      description: |-
        Page number of paginated results.
        Minimum value is 1.
      isArray: false
      required: false
    - name: page_size
      description: Number of results per page. Maximum value is 100.
      isArray: false
      required: false
    - name: limit
      defaultValue: 50
      description: The maximum number of records to retrieve.
      isArray: false
      required: false
    outputs:
    - type: String
      contextPath: CiscoWSA.IdentificationProfile.status
      description: Identification Profile status.
    - type: String
      contextPath: CiscoWSA.IdentificationProfile.profile_name
      description: Identification Profile name
    - type: String
      contextPath: CiscoWSA.IdentificationProfile.description
      description: Identification Profile description
  - name: cisco-wsa-identification-profiles-create
    description: Create identification profile.
    arguments:
    - name: profile_name
      description: Profile name to create.
      required: true
      isArray: false
    - name: status
      description: Status of new identification profile.
      defaultValue: enable
      required: false
      isArray: false
      auto: PREDEFINED
      predefined:
      - enable
      - disable
    - name: description
      description: Description of new identification profile.
      required: true
      isArray: false
    - name: protocols
      description: Network protocols of identification profile.
      required: false
      defaultValue: HTTPS
      isArray: false
      auto: PREDEFINED
      predefined:
      - HTTPS
      - SOCKS
    - name: order
      description: |-
        Identification profile order, index of Identification profile in the collection.
        Not applicable for global_identification_profile.
      defaultValue: 1
      required: true
      isArray: false
  - name: cisco-wsa-identification-profiles-update
    description: Update identification profile.
    arguments:
    - name: profile_name
      description: Profile name to update.
      required: true
      isArray: false
    - name: new_profile_name
      description: New profile name for identification profile.
      required: false
      isArray: false
    - name: status
      description: Updated status of identification profile.
      required: false
      isArray: false
      auto: PREDEFINED
      predefined:
      - enable
      - disable
    - name: description
      description: Updated description of identification profile.
      required: false
      isArray: false
    - name: protocols
      description: Network protocols of identification profile.
      required: false
      isArray: false
      auto: PREDEFINED
      predefined:
      - HTTPS
      - SOCKS
    - name: order
      description: |-
        Identification profile order, index of Identification profile in the collection.
        Not applicable for global_identification_profile.
      required: false
      isArray: false
  - name: cisco-wsa-identification-profiles-delete
    description: Delete identification profiles.
    arguments:
    - name: profile_names
      description: Profile names to delete.
      required: true
      isArray: true
  - name: cisco-wsa-url-categories-list
    description: Retrieve URL categories of available categories to allow/block in access policies.
    outputs:
    - type: String
      contextPath: CiscoWSA.UrlCategory.predefined
      description: Predefined URL categories.
    - type: String
      contextPath: CiscoWSA.UrlCategory.custom
      description: Custom URL categories.
