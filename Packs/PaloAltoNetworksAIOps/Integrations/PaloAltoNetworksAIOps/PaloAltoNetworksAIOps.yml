category: Utilities
commonfields:
  id: PaloAltoNetworksAIOps
  version: -1
configuration:
- section: Connect
  display: Pan-OS/Panorama Server URL
  name: url
  type: 0
  required: true
- section: Connect
  display: ""
  displaypassword: Pan-OS/Panorama API Key
  name: credentials
  type: 9
  required: true
  hiddenusername: true
- section: Connect
  display: TSG ID
  name: tsg_id
  type: 0
  required: true
- section: Connect
  display: ""
  displaypassword: Client ID
  name: client_id
  type: 9
  required: true
  hiddenusername: true
- section: Connect
  display: ""
  displaypassword: Client Secret
  name: client_secret
  type: 9
  required: true
  hiddenusername: true
- display: Trust any certificate (not secure)
  name: insecure
  type: 8
  required: false
description: Palo Alto Networks Best Practice Assessment (BPA) analyzes NGFW and Panorama configurations and compares them to the best practices.
display: Palo Alto Networks AIOps
name: PaloAltoNetworksAIOps
script:
  commands:
  - name: aiops-bpa-report-generate
    arguments:
    - name: entry_id
      description: |-
        - Entry_id from xsoar war-room after uploading a file - should be a config file in xml format.
        - If you used this argument and the process failed or reached time out- make sure the config file is in format.
    - name: requester_email
      required: true
      description: Requester email.
    - name: requester_name
      required: true
      description: Requester name.
    - name: interval_in_seconds
      description: Interval for polling mechanism.
      defaultValue: "30"
    - name: timeout
      default: true
      description: Timeout for downloading the file.
      defaultValue: "600"
    - name: export_as_file
      auto: PREDEFINED
      description: Export the generated report as a file.
      defaultValue: true
      type: boolean
      predefined: 
      - true
      - false
    - name: show_in_context
      auto: PREDEFINED
      description: Show the report data inside the context.
      defaultValue: false
      type: boolean
      predefined: 
      - true
      - false
    description: |- 
      Generates a bpa report. Steps - 
      - Get information about Pan-OS/Panorama device.
      - Get configuration file of Pan-OS/Panorama, if the user provides an entry_id to a config file this steps is skipped.
      - Use the two above in order to generate a bpa report.
      - During this process the API generates also a report_id for internal use.
    polling: true
  - name: aiops-polling-upload-report
    arguments:
    - name: report_id
      description: Report_id recieved from generate_bpa_report_request.
      required: true
    - name: hide_polling_output
      description: Hide polling output from war-room.
      required: true
      defaultValue: true
      type: boolean
    - name: export_as_file
      description: Export the generated report as a file.
      defaultValue: true
      type: boolean
    - name: show_in_context
      description: Show the report data inside the context.
      defaultValue: false
      type: boolean
    - name: first_round
      description: Does this polling round is the first round.
      defaultValue: false
      type: boolean
    description: Polling mechanism to upload report.
    polling: true
    hidden: true
  runonce: false
  script: '-'
  type: python
  subtype: python3
  dockerimage: demisto/python3:3.10.14.91134
fromversion: 6.10.0
tests:
- PaloAltoNetworksAIOps-Test
