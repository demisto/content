Netskope API v2 provides a powerful interface for managing and monitoring Netskope deployments. It enables users to retrieve alerts and events, manage URL lists, and control clients. With Netskope API v2, organizations can proactively respond to security threats, enforce web access policies, and efficiently administer their Netskope environment.
This integration was integrated and tested with version 2 of netskope_(api_v2)

## Configure Netskope (API v2) on Cortex XSOAR

1. Navigate to **Settings** > **Integrations** > **Servers & Services**.
2. Search for Netskope (API v2).
3. Click **Add instance** to create and configure a new integration instance.

    | **Parameter** | **Description** | **Required** |
    | --- | --- | --- |
    | Server URL |  | True |
    | Use system proxy settings |  | False |
    | Trust any certificate (not secure) |  | False |
    | API token | Netskope API access token \(make sure to generate token for the following endpoints: api/v2/events/data/application, api/v2/events/data/audit, api/v2/events/data/page, api/v2/events/data/network, api/v2/events/data/infrastructure, api/v2/events/data/alert, api/v2/policy/urllist \(read \+ write\), api/v2/policy/urllist/deploy \(read \+ write\), api/v2/scim/Users\). | True |
    | First fetch timestamp | First alert created date to fetch. e.g., "1 min ago","2 weeks ago","3 months ago" | False |
    | Maximum incidents per fetch | Maximum number of incidents per fetch. Default is 50. The maximum is 100. | False |
    | Maximum events as incidents per fetch. Max value is 200. |  | False |
    | Fetch Events | Fetch events as incidents, in addition to the alerts. | False |
    | Event types to fetch. | The event types to fetch as incidents. | False |
    | Alerts Query | Free text query to filter the fetched alerts. | False |
    | Events Query | Free text query to filter the fetched events \(if configured\). | False |
    | Incident type |  | False |
    | Fetch incidents |  |  |

4. Click **Test** to validate the URLs, token, and connection.

## Commands

You can execute these commands from the Cortex XSOAR CLI, as part of an automation, or in a playbook.
After you successfully execute a command, a DBot message appears in the War Room with the command details.

### netskope-alert-list

***
Retrieve alerts generated by Netskope. Select desired alerts using the alert_type parameter. Mandatory inputs include start_time and end_time, or insertion_start_time and insertion_end_time (Please note that if end_time or insertion_end_time is not provided, it will default to the current date and time). Additionally, it is not permissible to supply a combination of the aforementioned options.

#### Base Command

`netskope-alert-list`

#### Input

| **Argument Name** | **Description** | **Required** |
| --- | --- | --- |
| start_time | Restrict events to those that have dates greater than the provided date string (for example "YYYY-MM-DDThh:mm", "1 min ago", "2 weeks ago"). When this argument is provided, the ‘end_time’ argument must be provided as well. . | Optional |
| end_time | Restrict events to those that have dates less than or equal to the provided date string (for example "YYYY-MM-DDThh:mm", "1 min ago", "2 weeks ago").  When this argument is provided, the ‘start_time’ argument must be provided as well. If start_time argument is provided and this argument is not - the default value will be set for now. | Optional |
| insertion_start_time | Restrict events to those that were inserted to the system after the provided date string (for example "YYYY-MM-DDThh:mm", "1 min ago", "2 weeks ago"). When this argument is provided, the ‘insertion_end_time’ argument must be provided as well. | Optional |
| insertion_end_time | Restrict events to those that were inserted to the system before the provided date string (for example "YYYY-MM-DDThh:mm", "1 min ago", "2 weeks ago"). When this argument is provided, the ‘insertion_start_time’ argument must be provided as well. If insertion_start_time argument is provided and this argument is not - the default value will be set for now. | Optional |
| query | Free query to filter the alerts. For example, "alert_name like test". For more information, please visit Netskope documentation: https://docs.netskope.com/en/get-alerts-data.html. | Optional |
| alert_type | Select alerts by their type. | Optional |
| acked | Whether to retrieve acknowledged alerts or not. Possible values are: True, False. | Optional |
| page | Page number of paginated results. Minimum value: 1. | Optional |
| limit | The maximum number of records to retrieve. Default is 50. | Optional |

#### Context Output

| **Path** | **Type** | **Description** |
| --- | --- | --- |
| Netskope.Alert._appsession_start | String | Alert app session start |
| Netskope.Alert._category_id | String | Alert category id |
| Netskope.Alert._category_name | String | Alert category name |
| Netskope.Alert._category_tags | Number | Alert category tags |
| Netskope.Alert._content_version | Number | Alert content version |
| Netskope.Alert._correlation_id | String | Alert correlation id |
| Netskope.Alert._creation_timestamp | Number | Alert creation timestamp |
| Netskope.Alert._ef_received_at | Date | Alert ef received at |
| Netskope.Alert._event_id | String | Alert event id |
| Netskope.Alert._forwarded_by | String | Alert forwarded by |
| Netskope.Alert._gef_src_dp | String | Alert gef source dp |
| Netskope.Alert._id | String | Alert id |
| Netskope.Alert._insertion_epoch_timestamp | Number | Alert insertion epoch timestamp |
| Netskope.Alert._nshostname | String | Alert ns host name |
| Netskope.Alert._raw_event_inserted_at | Date | Alert raw event inserted at |
| Netskope.Alert._service_identifier | String | Alert service identifier |
| Netskope.Alert._session_begin | String | Alert session begin |
| Netskope.Alert._skip_geoip_lookup | String | Alert skip geo ip lookup |
| Netskope.Alert._src_epoch_now | Number | Alert source epoch now |
| Netskope.Alert.access_method | String | Alert access method |
| Netskope.Alert.acked | String | Alert acked |
| Netskope.Alert.action | String | Alert action |
| Netskope.Alert.activity | String | Alert activity |
| Netskope.Alert.alert | String | Alert alert |
| Netskope.Alert.alert_name | String | Alert name |
| Netskope.Alert.alert_type | String | Alert type |
| Netskope.Alert.app | String | Alert app |
| Netskope.Alert.app_session_id | Number | Alert app session id |
| Netskope.Alert.appcategory | String | Alert app category |
| Netskope.Alert.appsuite | String | Alert app suite |
| Netskope.Alert.browser | String | Alert browser |
| Netskope.Alert.browser_session_id | Number | Alert browser_session_id |
| Netskope.Alert.category | String | Alert category |
| Netskope.Alert.cci | Number | Alert cci |
| Netskope.Alert.ccl | String | Alert ccl |
| Netskope.Alert.connection_id | Number | Alert connection id |
| Netskope.Alert.count | Number | Alert count |
| Netskope.Alert.device | String | Alert device |
| Netskope.Alert.device_classification | String | Alert device classification |
| Netskope.Alert.domain | String | Alert domain |
| Netskope.Alert.dst_country | String | Alert destination country |
| Netskope.Alert.dst_latitude | Number | Alert destination latitude |
| Netskope.Alert.dst_location | String | Alert destination location |
| Netskope.Alert.dst_longitude | Number | Alert destination longitude |
| Netskope.Alert.dst_region | String | Alert destination region |
| Netskope.Alert.dst_timezone | String | Alert destination timezone |
| Netskope.Alert.dst_zipcode | String | Alert destination zip code |
| Netskope.Alert.dstip | String | Alert destination ip |
| Netskope.Alert.hostname | String | Alert hostname |
| Netskope.Alert.incident_id | Number | Alert incident id |
| Netskope.Alert.ja3 | String | Alert ja3 |
| Netskope.Alert.ja3s | String | Alert ja3s |
| Netskope.Alert.managed_app | String | Alert managed app |
| Netskope.Alert.managementID | String | Alert management ID |
| Netskope.Alert.netskope_pop | String | Alert netskope pop |
| Netskope.Alert.notify_template | String | Alert notify template |
| Netskope.Alert.nsdeviceuid | String | Alert ns device uid |
| Netskope.Alert.organization_unit | String | Alert organization unit |
| Netskope.Alert.os | String | Alert os |
| Netskope.Alert.os_version | String | Alert os version |
| Netskope.Alert.other_categories | String | Alert other categories |
| Netskope.Alert.page | String | Alert page |
| Netskope.Alert.page_site | String | Alert page site |
| Netskope.Alert.policy | String | Alert policy |
| Netskope.Alert.policy_id | String | Alert policy id |
| Netskope.Alert.port | String | Alert port |
| Netskope.Alert.protocol | String | Alert protocol |
| Netskope.Alert.request_id | Number | Alert request id |
| Netskope.Alert.severity | String | Alert severity |
| Netskope.Alert.site | String | Alert site |
| Netskope.Alert.src_country | String | Alert source country |
| Netskope.Alert.src_latitude | Number | Alert source latitude |
| Netskope.Alert.src_location | String | Alert source location |
| Netskope.Alert.src_longitude | Number | Alert source longitude |
| Netskope.Alert.src_region | String | Alert source region |
| Netskope.Alert.src_time | Date | Alert source time |
| Netskope.Alert.src_timezone | String | Alert source timezone |
| Netskope.Alert.src_zipcode | String | Alert source zip code |
| Netskope.Alert.srcip | String | Alert source ip |
| Netskope.Alert.telemetry_app | String | Alert telemetry app |
| Netskope.Alert.timestamp | Number | Alert timestamp |
| Netskope.Alert.traffic_type | String | Alert traffic type |
| Netskope.Alert.transaction_id | Number | Alert transaction id |
| Netskope.Alert.type | String | Alert type |
| Netskope.Alert.ur_normalized | String | Alert ur normalized |
| Netskope.Alert.url | String | Alert url |
| Netskope.Alert.user | String | Alert user |
| Netskope.Alert.useragent | String | Alert useragent |
| Netskope.Alert.userip | String | Alert user ip |
| Netskope.Alert.userkey | String | Alert user key |
| Netskope.Alert._client_timeout | Number | Alert client timeout |
| Netskope.Alert._dlp_backup_profile | String | Alert dlp backup profile |
| Netskope.Alert._nsp_dur_back | Number | Alert nsp due back |
| Netskope.Alert._nsp_dur_front | Number | Alert nsp due front |
| Netskope.Alert._nsp_retrans_back | Number | Alert nsp retrans back |
| Netskope.Alert._nsp_retrans_front | Number | Alert nsp retrans front |
| Netskope.Alert._nsp_rtt_back | Number | Alert nsp rtt back |
| Netskope.Alert._nsp_rtt_front | Number | Alert nsp rtt front |
| Netskope.Alert._resource_name | String | Alert resource name |
| Netskope.Alert._scan_source | String | Alert scan source |
| Netskope.Alert._tenant_max_file_size | Number | Alert tenant max file size |
| Netskope.Alert.all_policy_matches | String | Alert all policy matches |
| Netskope.Alert.browser_version | String | Alert browser version |
| Netskope.Alert.file_size | Number | Alert file size |
| Netskope.Alert.file_type | String | Alert file type |
| Netskope.Alert.md5 | String | Alert md5 |
| Netskope.Alert.object | String | Alert object |
| Netskope.Alert.object_type | String | Alert object type |
| Netskope.Alert.web_universal_connector | String | Alert web universal connector |

#### Command example
```!netskope-alert-list start_time="2023-05-05 11:06" alert_type=policy limit=2```
#### Context Example
```json
{
    "Netskope": {
        "Alert": [
            {
                "_appsession_start": "yes",
                "_category_id": "8",
                "_category_name": "Collaboration",
                "_category_tags": [
                    10001,
                    564,
                    8
                ],
                "_content_version": 1687272302,
                "_correlation_id": "011c0f84-9938-460b-8cbe-dab38fa6cb31",
                "_creation_timestamp": 1687656279,
                "_ef_received_at": 1687656276462,
                "_event_id": "724d1174-d78c-4197-8243-4fbd3644b192",
                "_forwarded_by": "msg-relayer",
                "_gef_src_dp": "IL-TLV1",
                "_id": "c3c98336e9d6807dd821b8dc",
                "_insertion_epoch_timestamp": 1687656283,
                "_nshostname": "dppool1-2-egress",
                "_raw_event_inserted_at": 1687656276776,
                "_service_identifier": "service-nsproxy",
                "_session_begin": "1",
                "_skip_geoip_lookup": "yes",
                "_src_epoch_now": 1687667040,
                "access_method": "Client",
                "acked": "false",
                "action": "block",
                "activity": "Browse",
                "alert": "yes",
                "alert_id": "c3c98336e9d6807dd821b8dc",
                "alert_name": "365 block",
                "alert_type": "policy",
                "app": "Microsoft Teams",
                "app_session_id": 3379014715943843300,
                "appcategory": "Collaboration",
                "appsuite": "Office365",
                "browser": "Native",
                "browser_session_id": 2893692091617575400,
                "category": "Collaboration",
                "cci": 92,
                "ccl": "excellent",
                "connection_id": 1717056737521399300,
                "count": 1,
                "device": "Windows Device",
                "device_classification": "unmanaged",
                "domain": "config.teams.microsoft.com",
                "dst_country": "US",
                "dst_latitude": 47.682899475097656,
                "dst_location": "Redmond",
                "dst_longitude": -122.12090301513672,
                "dst_region": "Washington",
                "dst_timezone": "America/Los_Angeles",
                "dst_zipcode": "N/A",
                "dstip": "8.8.8.8",
                "hostname": "DESKTOP-TOR2VO7",
                "incident_id": 6782360912641091000,
                "ja3": "a0e9f5d64349fb13191bc781f81f42e1",
                "ja3s": "NotAvailable",
                "managed_app": "no",
                "managementID": "",
                "netskope_pop": "IL-TLV1",
                "notify_template": "block_page.html",
                "nsdeviceuid": "A633E874-D3B2-0FB7-F5CC-AF89F428B182",
                "organization_unit": "",
                "os": "Windows 10",
                "os_version": "Windows 10",
                "other_categories": [
                    "Test web Policy Beni",
                    "Technology",
                    "Collaboration"
                ],
                "page": "config.teams.microsoft.com",
                "page_site": "Microsoft Teams",
                "policy": "365 block",
                "policy_id": "84BE7DC6087E38BCA19B3788C5E02A67 2023-06-22 14:42:51.404368",
                "port": "443",
                "protocol": "HTTPS/1.1",
                "request_id": 2605870162901070000,
                "severity": "unknown",
                "site": "Microsoft Teams",
                "src_country": "IL",
                "src_latitude": 32.0803,
                "src_location": "Tel Aviv",
                "src_longitude": 34.7805,
                "src_region": "Tel Aviv",
                "src_time": "Sun Jun 25 04:24:00 2023",
                "src_timezone": "Asia/Jerusalem",
                "src_zipcode": "N/A",
                "srcip": "8.8.8.8",
                "telemetry_app": "",
                "timestamp": "2023-06-25T01:24:36.000Z",
                "traffic_type": "CloudApp",
                "transaction_id": 6782360912641091000,
                "type": "nspolicy",
                "ur_normalized": "example@qmasters.co",
                "url": "config.teams.microsoft.com/config/v1/ODSP_Sync_Client/23.119.0606.0001",
                "user": "example@qmasters.co",
                "useragent": "OneDrive-23.119.0606.0001",
                "userip": "8.8.8.8",
                "userkey": "example@qmasters.co"
            },
            {
                "_appsession_start": "yes",
                "_category_id": "8",
                "_category_name": "Collaboration",
                "_category_tags": [
                    10001,
                    564,
                    8
                ],
                "_content_version": 1687272302,
                "_correlation_id": "46647142-2f24-4802-b8f5-22814e80353a",
                "_creation_timestamp": 1687659879,
                "_ef_received_at": 1687659876494,
                "_event_id": "6827a5eb-de85-48af-8eae-6d3034084fd6",
                "_forwarded_by": "msg-relayer",
                "_gef_src_dp": "IL-TLV1",
                "_id": "da711d311019f02d79ebc8f4",
                "_insertion_epoch_timestamp": 1687659883,
                "_nshostname": "dppool1-2-egress",
                "_raw_event_inserted_at": 1687659876771,
                "_service_identifier": "service-nsproxy",
                "_session_begin": "1",
                "_skip_geoip_lookup": "yes",
                "_src_epoch_now": 1687670640,
                "access_method": "Client",
                "acked": "false",
                "action": "block",
                "activity": "Browse",
                "alert": "yes",
                "alert_id": "da711d311019f02d79ebc8f4",
                "alert_name": "365 block",
                "alert_type": "policy",
                "app": "Microsoft Teams",
                "app_session_id": 4359394467077842400,
                "appcategory": "Collaboration",
                "appsuite": "Office365",
                "browser": "Native",
                "browser_session_id": 2893692091617575400,
                "category": "Collaboration",
                "cci": 92,
                "ccl": "excellent",
                "connection_id": 8981978357397935000,
                "count": 1,
                "device": "Windows Device",
                "device_classification": "unmanaged",
                "domain": "config.teams.microsoft.com",
                "dst_country": "AT",
                "dst_latitude": 48.2049,
                "dst_location": "Vienna",
                "dst_longitude": 16.3662,
                "dst_region": "Vienna",
                "dst_timezone": "Europe/Vienna",
                "dst_zipcode": "1010",
                "dstip": "8.8.8.8",
                "hostname": "DESKTOP-TOR2VO7",
                "incident_id": 1478029261577663500,
                "ja3": "a0e9f5d64349fb13191bc781f81f42e1",
                "ja3s": "NotAvailable",
                "managed_app": "no",
                "managementID": "",
                "netskope_pop": "IL-TLV1",
                "notify_template": "block_page.html",
                "nsdeviceuid": "A633E874-D3B2-0FB7-F5CC-AF89F428B182",
                "organization_unit": "",
                "os": "Windows 10",
                "os_version": "Windows 10",
                "other_categories": [
                    "Test web Policy Beni",
                    "Technology",
                    "Collaboration"
                ],
                "page": "config.teams.microsoft.com",
                "page_site": "Microsoft Teams",
                "policy": "365 block",
                "policy_id": "84BE7DC6087E38BCA19B3788C5E02A67 2023-06-22 14:42:51.404368",
                "port": "443",
                "protocol": "HTTPS/1.1",
                "request_id": 2605900362175087600,
                "severity": "unknown",
                "site": "Microsoft Teams",
                "src_country": "IL",
                "src_latitude": 32.0803,
                "src_location": "Tel Aviv",
                "src_longitude": 34.7805,
                "src_region": "Tel Aviv",
                "src_time": "Sun Jun 25 05:24:00 2023",
                "src_timezone": "Asia/Jerusalem",
                "src_zipcode": "N/A",
                "srcip": "8.8.8.8",
                "telemetry_app": "",
                "timestamp": "2023-06-25T02:24:36.000Z",
                "traffic_type": "CloudApp",
                "transaction_id": 1478029261577663500,
                "type": "nspolicy",
                "ur_normalized": "example@qmasters.co",
                "url": "config.teams.microsoft.com/config/v1/ODSP_Sync_Client/23.119.0606.0001",
                "user": "example@qmasters.co",
                "useragent": "OneDrive-23.119.0606.0001",
                "userip": "8.8.8.8",
                "userkey": "example@qmasters.co"
            }
        ]
    }
}
```

#### Human Readable Output

>### Alert List
>Showing page 1.
> Current page size: 2.
>|Alert Id|Alert Name|Alert Type|Severity|Action|Activity|Type|Category Name|Event Id|Domain|Dst Country|Policy|Port|Protocol|Md5|Timestamp|
>|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
>| c3c98336e9d6807dd821b8dc | 365 block | policy | unknown | block | Browse | nspolicy | Collaboration | 724d1174-d78c-4197-8243-4fbd3644b192 | config.teams.microsoft.com | US | 365 block | 443 | HTTPS/1.1 |  | 2023-06-25T01:24:36.000Z |
>| da711d311019f02d79ebc8f4 | 365 block | policy | unknown | block | Browse | nspolicy | Collaboration | 6827a5eb-de85-48af-8eae-6d3034084fd6 | config.teams.microsoft.com | AT | 365 block | 443 | HTTPS/1.1 |  | 2023-06-25T02:24:36.000Z |


### netskope-event-list

***
Get events extracted from SaaS traffic. You may choose what events to receive with the event_type parameter. You must provide start_time and end_time, or insertion_start_time and insertion_end_time (Note that if end_time or insertion_end_time don't provided - it would be set with the now date time). Also, you cannot provide a combination of the options mentioned above.

#### Base Command

`netskope-event-list`

#### Input

| **Argument Name** | **Description** | **Required** |
| --- | --- | --- |
| event_type | Select events by their type. Available types: page,application,audit,infrastructure,network. Possible values are: page, application, audit, infrastructure, network. | Required |
| query | Free query to filter the events. For example, "app eq Dropbox". For more information, please visit Netskope documentation: https://docs.netskope.com/en/get-events-data.html. | Optional |
| start_time | Restrict events to those that have dates greater than the provided date string (for example "YYYY-MM-DDThh:mm", "1 min ago", "2 weeks ago"). When this argument is provided, the ‘end_time’ argument must be provided as well. | Optional |
| end_time | Restrict events to those that have dates less than or equal to the provided date string (for example "YYYY-MM-DDThh:mm", "1 min ago", "2 weeks ago"). When this argument is provided, the ‘start_time’ argument must be provided as well. If start_time argument is provided and this argument is not - the default value will be set for now. | Optional |
| insertion_start_time | Restrict events to those that were inserted to the system after the provided date string (for example "YYYY-MM-DDThh:mm", "1 min ago", "2 weeks ago"). When this argument is provided, the ‘insertion_end_time’ argument must be provided as well. | Optional |
| insertion_end_time | Restrict events to those that were inserted to the system before the provided date string (for example "YYYY-MM-DDThh:mm", "1 min ago", "2 weeks ago"). When this argument is provided, the ‘insertion_start_time’ argument must be provided as well. If insertion_start_time argument is provided and this argument is not - the default value will be set for now. | Optional |
| page | Page number of paginated results. Minimum value: 1. | Optional |
| limit | The maximum number of records to retrieve. Default is 50. | Optional |

#### Context Output

| **Path** | **Type** | **Description** |
| --- | --- | --- |
| Netskope.Event._appsession_start | String | Event app session start |
| Netskope.Event._category_id | String | Event category id |
| Netskope.Event._category_name | String | Event category name |
| Netskope.Event._category_tags | Number | Event category tags |
| Netskope.Event._content_version | Number | Event content version |
| Netskope.Event._correlation_id | String | Event correlation id |
| Netskope.Event._creation_timestamp | Number | Event creation timestamp |
| Netskope.Event._ef_received_at | Date | Event ef received at |
| Netskope.Event._event_id | String | Event event id |
| Netskope.Event._forwarded_by | String | Event forwarded by |
| Netskope.Event._gef_src_dp | String | Event gef source dp |
| Netskope.Event._id | String | Event id |
| Netskope.Event._insertion_epoch_timestamp | Number | Event insertion epoch timestamp |
| Netskope.Event._nshostname | String | Event ns host name |
| Netskope.Event._raw_event_inserted_at | Date | Event raw event inserted at |
| Netskope.Event._service_identifier | String | Event service identifier |
| Netskope.Event._session_begin | String | Event session begin |
| Netskope.Event._skip_geoip_lookup | String | Event skip geo ip lookup |
| Netskope.Event._src_epoch_now | Number | Event source epoch now |
| Netskope.Event.access_method | String | Event access_method |
| Netskope.Event.action | String | Event action |
| Netskope.Event.activity | String | Event activity |
| Netskope.Event.alert | String | Event alert |
| Netskope.Event.app | String | Event app |
| Netskope.Event.app_session_id | Number | Event app session id |
| Netskope.Event.appcategory | String | Event app category |
| Netskope.Event.appsuite | String | Event app suite |
| Netskope.Event.browser | String | Event browser |
| Netskope.Event.browser_session_id | Number | Event browser session id |
| Netskope.Event.category | String | Event category |
| Netskope.Event.cci | Number | Event cci |
| Netskope.Event.ccl | String | Event ccl |
| Netskope.Event.connection_id | Number | Event connection id |
| Netskope.Event.count | Number | Event count |
| Netskope.Event.device | String | Event device |
| Netskope.Event.device_classification | String | Event device_classification |
| Netskope.Event.dom | String | Event dom |
| Netskope.Event.dst_country | String | Event destination country |
| Netskope.Event.dst_latitude | Number | Event destination latitude |
| Netskope.Event.dst_location | String | Event destination location |
| Netskope.Event.dst_longitude | Number | Event destination longitude |
| Netskope.Event.dst_region | String | Event destination region |
| Netskope.Event.dst_timezone | String | Event destination timezone |
| Netskope.Event.dst_zipcode | String | Event destination zipcode |
| Netskope.Event.dstip | String | Event destination ip |
| Netskope.Event.hostname | String | Event host name |
| Netskope.Event.incident_id | Number | Event incident id |
| Netskope.Event.ja3 | String | Event ja3 |
| Netskope.Event.ja3s | String | Event ja3s |
| Netskope.Event.managed_app | String | Event managed app |
| Netskope.Event.managementID | String | Event management ID |
| Netskope.Event.netskope_pop | String | Event netskope pop |
| Netskope.Event.notify_template | String | Event notify template |
| Netskope.Event.nsdeviceuid | String | Event ns device uid |
| Netskope.Event.organization_unit | String | Event organization unit |
| Netskope.Event.os | String | Event os |
| Netskope.Event.os_version | String | Event os version |
| Netskope.Event.other_categories | String | Event other categories |
| Netskope.Event.page | String | Event page |
| Netskope.Event.page_site | String | Event page site |
| Netskope.Event.policy | String | Event policy |
| Netskope.Event.policy_id | String | Event policy id |
| Netskope.Event.port | Number | Event port |
| Netskope.Event.protocol | String | Event protocol |
| Netskope.Event.request_id | Number | Event request id |
| Netskope.Event.severity | String | Event severity |
| Netskope.Event.site | String | Event site |
| Netskope.Event.src_country | String | Event source country |
| Netskope.Event.src_latitude | Number | Event source latitude |
| Netskope.Event.src_location | String | Event source location |
| Netskope.Event.src_longitude | Number | Event source longitude |
| Netskope.Event.src_region | String | Event source region |
| Netskope.Event.src_time | Date | Event source time |
| Netskope.Event.src_timezone | String | Event source timezone |
| Netskope.Event.src_zipcode | String | Event source zip code |
| Netskope.Event.srcip | String | Event source ip |
| Netskope.Event.telemetry_app | String | Event telemetry app |
| Netskope.Event.timestamp | Number | Event timestamp |
| Netskope.Event.traffic_type | String | Event traffic type |
| Netskope.Event.transaction_id | Number | Event transaction id |
| Netskope.Event.type | String | Event type |
| Netskope.Event.ur_normalized | String | Event ur normalized |
| Netskope.Event.url | String | Event url |
| Netskope.Event.user | String | Event user |
| Netskope.Event.useragent | String | Event useragent |
| Netskope.Event.userip | String | Event user ip |
| Netskope.Event.userkey | String | Event user key |

#### Command example
```!netskope-event-list event_type=page start_time="10 days ago" limit=2```
#### Human Readable Output

>### Event List
>Showing page 1.
> Current page size: 2.
>**No entries.**


### netskope-url-list-update

***
Update the URL List with the values provided. please note that this command overrides the list.

#### Base Command

`netskope-url-list-update`

#### Input

| **Argument Name** | **Description** | **Required** |
| --- | --- | --- |
| url_list_id | The URL list ID to update (use netskope-url-list-list command to get URL list ID). | Required |
| name | The updated URL list name. | Required |
| urls | The updated URL list items (For Exact - Enter URLs like  *.example.com, or IP addresses, separated by new line. For Regex - Enter URLs like ^client[0-9]\\.google\\.com , ^app\\.slack\\.com/.*/netskope, or ^google.com, separated by new line). | Required |
| list_type | The updated URL list type. Possible values are: exact, regex. | Required |
| deploy | Whether to deploy URL list changes or not. Default is False. Possible values are: True, False. | Optional |

#### Context Output

| **Path** | **Type** | **Description** |
| --- | --- | --- |
| Netskope.URLList.id | Number | Url list id |
| Netskope.URLList.name | String | Url list name |
| Netskope.URLList.data.urls | String | Url data urls |
| Netskope.URLList.data.type | String | Url data type |
| Netskope.URLList.data.json_version | Number | Url data json version |
| Netskope.URLList.modify_by | String | Url modify by |
| Netskope.URLList.modify_time | Date | Url modify time |
| Netskope.URLList.modify_type | String | Url modify type |
| Netskope.URLList.pending | Number | Url pending |

#### Command example
```!netskope-url-list-update url_list_id=11 name="QMASTERS list" urls="google.com" list_type=regex deploy=false```
#### Context Example
```json
{
    "Netskope": {
        "URLList": {
            "id": 11,
            "json_version": 2,
            "modify_by": "Tal New Token",
            "modify_time": "2023-07-18",
            "modify_type": "Edited",
            "name": "QMASTERS list",
            "pending": "pending",
            "type": "regex",
            "urls": [
                "google.com"
            ]
        }
    }
}
```

#### Human Readable Output

>### URL List
>|Id|Json Version|Modify By|Modify Time|Modify Type|Name|Pending|Type|Urls|
>|---|---|---|---|---|---|---|---|---|
>| 11 | 2 | Tal New Token | 2023-07-18 | Edited | QMASTERS list | pending | regex | google.com |


### netskope-url-list-create

***
Create a new URL list.

#### Base Command

`netskope-url-list-create`

#### Input

| **Argument Name** | **Description** | **Required** |
| --- | --- | --- |
| name | The unique name for the URL list. | Required |
| urls | The URL list items (For Exact - Enter URLs like  *.example.com, or IP addresses, separated by new line. For Regex - Enter URLs like ^client[0-9]\\.google\\.com , ^app\\.slack\\.com/.*/netskope, or ^google.com, separated by new line). | Required |
| list_type | The URL list type. Possible values are: exact, regex. | Required |
| deploy | Whether to deploy URL list changes or not. Default is False. Possible values are: True, False. | Optional |

#### Context Output

| **Path** | **Type** | **Description** |
| --- | --- | --- |
| Netskope.URLList.id | Number | Url list id |
| Netskope.URLList.name | String | Url list name |
| Netskope.URLList.data.urls | String | Url data urls |
| Netskope.URLList.data.type | String | Url data type |
| Netskope.URLList.data.json_version | Number | Url data json version |
| Netskope.URLList.modify_type | String | Url modify type |
| Netskope.URLList.modify_by | String | Url modify by |
| Netskope.URLList.modify_time | Date | Url modify time |
| Netskope.URLList.pending | Number | Url pending |

#### Command example
```!netskope-url-list-create name="New QMASTERS list" urls="xsoar.com,qmasters.com,google.com" list_type=regex deploy=false```
#### Context Example
```json
{
    "Netskope": {
        "URLList": {
            "id": 12,
            "json_version": 2,
            "modify_by": "Tal New Token",
            "modify_time": "2023-07-18",
            "modify_type": "Created",
            "name": "New QMASTERS list",
            "pending": "pending",
            "type": "regex",
            "urls": [
                "xsoar.com",
                "qmasters.com",
                "google.com"
            ]
        }
    }
}
```

#### Human Readable Output

>### URL List
>|Id|Json Version|Modify By|Modify Time|Modify Type|Name|Pending|Type|Urls|
>|---|---|---|---|---|---|---|---|---|
>| 12 | 2 | Tal New Token | 2023-07-18 | Created | New QMASTERS list | pending | regex | xsoar.com,<br/>qmasters.com,<br/>google.com |


### netskope-url-lists-list

***
Get all URL Lists or a specific by specifying the list ID.

#### Base Command

`netskope-url-lists-list`

#### Input

| **Argument Name** | **Description** | **Required** |
| --- | --- | --- |
| url_list_id | The URL list ID to get. | Optional |
| pending | Get a list of only applied or pending URL lists. Possible values are: applied, pending. | Optional |
| field | Comma separated data values to return in response call (for example: name, id, data, modify_by, modify_time, modify_type, pending). Defaults to all values. | Optional |
| all_results | Whether to retrieve all results or not. Defaults is false. Possible values are: True, False. | Optional |
| limit | The maximum number of records to retrieve. Default is 50. | Optional |

#### Context Output

| **Path** | **Type** | **Description** |
| --- | --- | --- |
| Netskope.URLList.id | Number | Url list id |
| Netskope.URLList.name | String | Url list name |
| Netskope.URLList.data.urls | String | Url data urls |
| Netskope.URLList.modify_by | String | Url modify by |
| Netskope.URLList.modify_time | Date | Url modify time |
| Netskope.URLList.modify_type | String | Url modify type |
| Netskope.URLList.pending | String | Url pending status |

#### Command example
```!netskope-url-lists-list```
#### Context Example
```json
{
    "Netskope": {
        "URLList": [
            {
                "data": {
                    "json_version": 2,
                    "type": "exact",
                    "urls": [
                        "g.g"
                    ]
                },
                "id": 1,
                "modify_by": "example@qmasters.co",
                "modify_time": "2023-07-16T00:00:00.000Z",
                "modify_type": "Edited",
                "name": "myList",
                "pending": 0
            },
            {
                "data": {
                    "json_version": 2,
                    "type": "regex",
                    "urls": [
                        "google.com"
                    ]
                },
                "id": 2,
                "modify_by": "Tal New Token",
                "modify_time": "2023-07-18T00:00:00.000Z",
                "modify_type": "Edited",
                "name": "NewURLList",
                "pending": 0
            },
            {
                "data": {
                    "json_version": 2,
                    "type": "exact",
                    "urls": [
                        "google.com",
                        "www.abc.com",
                        "example.com",
                        "lulu.com"
                    ]
                },
                "id": 4,
                "modify_by": "Netskope REST API",
                "modify_time": "2023-07-05T10:24:57.000Z",
                "modify_type": "Edited",
                "name": "Tal-newURLlist",
                "pending": 0
            },
            {
                "data": {
                    "json_version": 2,
                    "type": "exact",
                    "urls": [
                        "google.com",
                        "example.com",
                        "lulu.com"
                    ]
                },
                "id": 5,
                "modify_by": "Netskope REST API",
                "modify_time": "2023-07-05T00:00:00.000Z",
                "modify_type": "Created",
                "name": "New URL list",
                "pending": 0
            },
            {
                "data": {
                    "json_version": 2,
                    "type": "exact",
                    "urls": [
                        "google.com",
                        "example.com",
                        "lulu.com"
                    ]
                },
                "id": 6,
                "modify_by": "Netskope REST API",
                "modify_time": "2023-07-05T00:00:00.000Z",
                "modify_type": "Created",
                "name": "New URL list 2",
                "pending": 0
            },
            {
                "data": {
                    "json_version": 2,
                    "type": "regex",
                    "urls": [
                        "xsoar.com",
                        "qmasters.com"
                    ]
                },
                "id": 8,
                "modify_by": "Netskope REST API",
                "modify_time": "2023-07-17T00:00:00.000Z",
                "modify_type": "Created",
                "name": "NewNewURLlist",
                "pending": 0
            },
            {
                "data": {
                    "json_version": 2,
                    "type": "regex",
                    "urls": [
                        "xsoar.com",
                        "qmasters.com"
                    ]
                },
                "id": 9,
                "modify_by": "Netskope REST API",
                "modify_time": "2023-07-17T00:00:00.000Z",
                "modify_type": "Created",
                "name": "NewNewURLlist1",
                "pending": 0
            }
        ]
    }
}
```

#### Human Readable Output

>### URL List
>|Id|Json Version|Modify By|Modify Time|Modify Type|Name|Pending|Type|Urls|
>|---|---|---|---|---|---|---|---|---|
>| 1 | 2 | example@qmasters.co | 2023-07-16T00:00:00.000Z | Edited | myList | applied | exact | g.g |
>| 2 | 2 | Tal New Token | 2023-07-18T00:00:00.000Z | Edited | NewURLList | applied | regex | google.com |
>| 4 | 2 | Netskope REST API | 2023-07-05T10:24:57.000Z | Edited | Tal-newURLlist | applied | exact | google.com,<br/>www.abc.com,<br/>example.com,<br/>lulu.com |
>| 5 | 2 | Netskope REST API | 2023-07-05T00:00:00.000Z | Created | New URL list | applied | exact | google.com,<br/>example.com,<br/>lulu.com |
>| 6 | 2 | Netskope REST API | 2023-07-05T00:00:00.000Z | Created | New URL list 2 | applied | exact | google.com,<br/>example.com,<br/>lulu.com |
>| 8 | 2 | Netskope REST API | 2023-07-17T00:00:00.000Z | Created | NewNewURLlist | applied | regex | xsoar.com,<br/>qmasters.com |
>| 9 | 2 | Netskope REST API | 2023-07-17T00:00:00.000Z | Created | NewNewURLlist1 | applied | regex | xsoar.com,<br/>qmasters.com |


### netskope-url-list-delete

***
Delete a URL list by the list ID.

#### Base Command

`netskope-url-list-delete`

#### Input

| **Argument Name** | **Description** | **Required** |
| --- | --- | --- |
| url_list_id | The URL list ID to delete (use netskope-url-list-list to get the URL list ID). | Required |
| deploy | Whether to deploy URL list changes or not. Default is False. Possible values are: True, False. | Optional |

#### Context Output

| **Path** | **Type** | **Description** |
| --- | --- | --- |
| Netskope.URLList.id | Number | Url list id |
| Netskope.URLList.name | String | Url list name |

#### Command example
```!netskope-url-list-delete url_list_id=10```
#### Context Example
```json
{
    "Netskope": {
        "URLList": {
            "data": {
                "json_version": 2,
                "type": "regex",
                "urls": [
                    "xsoar.com",
                    "qmasters.com"
                ]
            },
            "id": 10,
            "modify_by": "Netskope REST API",
            "modify_time": "2023-07-17T00:00:00.000Z",
            "modify_type": "Deleted",
            "name": "TalURLlist",
            "pending": 1
        }
    }
}
```

#### Human Readable Output

>The URL list 10 was deleted successfully

### netskope-client-list

***
Get information about Netskope SCIM users. The command provides a list of users who have been imported into the Netskope tenant through SCIM integration. Users imported through other methods, such as manual CSV import or manual creation, will not be included in the returned results.

#### Base Command

`netskope-client-list`

#### Input

| **Argument Name** | **Description** | **Required** |
| --- | --- | --- |
| filter | Filter the Netskope user by 'key eq value' template. For example: userName eq "someUserName" OR externalId eq "User-Ext_id". | Optional |
| page | Page number of paginated results. Minimum value: 1. | Optional |
| limit | The maximum number of records to retrieve. Default is 50. | Optional |

#### Context Output

| **Path** | **Type** | **Description** |
| --- | --- | --- |
| Netskope.Client.id | Number | Client id |
| Netskope.Client.name | String | Client name |
| Netskope.Client.userName | String | Client user name |
| Netskope.Client.externalId | String | Client external id |
| Netskope.Client.active | Boolean | Client activate |
| Netskope.Client.emails | String | Client emails |

#### Command example
```!netskope-client-list page=1 limit=2```
#### Context Example
```json
{
    "Netskope": {
        "Client": [
            {
                "active": true,
                "client_id": "6a4dbb07-f465-4a6c-8af2-1c84ced65010",
                "emails": [
                    "email1@netskope.local"
                ],
                "family_name": "last_name",
                "given_name": "first_name",
                "user_name": "upn1"
            },
            {
                "active": true,
                "client_id": "f8d26597-e4a4-400d-a24b-40318a9e80e5",
                "emails": [
                    "email11@netskope.local"
                ],
                "family_name": "last_name1",
                "given_name": "first_name1",
                "user_name": "upn2"
            }
        ]
    }
}
```

#### Human Readable Output

>### Client List
>Showing page 1.
> Current page size: 2.
>|Client Id|User Name|Given Name|Family Name|Emails|Active|
>|---|---|---|---|---|---|
>| 6a4dbb07-f465-4a6c-8af2-1c84ced65010 | upn1 | first_name | last_name | email1@netskope.local | true |
>| f8d26597-e4a4-400d-a24b-40318a9e80e5 | upn2 | first_name1 | last_name1 | email11@netskope.local | true |

