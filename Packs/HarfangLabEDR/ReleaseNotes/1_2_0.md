
#### Classifiers

##### New: Hurukai classifier

The original Hurukai classifier has been modified to handle both `Hurukai alerts` and `Hurukai threats`. 


#### Incident Fields

- New: **HarfangLab EDR Critical Security Event Count**
- New: **HarfangLab EDR Top Impacted Users**
- New: **HarfangLab EDR Total Security Event Count**
- New: **HarfangLab EDR High Security Event Count**
- New: **HarfangLab EDR Low Security Event Count**
- New: **HarfangLab EDR Top Rules**
- New: **HarfangLab EDR Medium Security Event Count**
- New: **HarfangLab EDR Top Agents**
- New: **HarfangLab EDR Threat ID**

#### Incident Types

- New: **Hurukai threat**

- New: **Hurukai threat** correspond to a set of security events since they belon to the same attack context.

#### Integrations

##### HarfangLab EDR

- Fetch both Security Events (aka alerts) and Threats.
- Added `max_fetch` parameter in `fetch-incidents` command.
- Added endpoint policy name and endpoint groups in the collected security events.
- Handle mirroring of security events and threats between HarfangLab EDR and XSOAR (only status mirroring for Security Events/Threats and Threat note mirroring are supported). 
- Added new generic command `harfanglab-api-call` to call any HarfangLab EDR API endpoint (GET, POST...).
- Added new telemetry commands `harfanglab-telemetry-dns`, `harfanglab-telemetry-authentication-windows`, `harfanglab-telemetry-authentication-linux`, `harfanglab-telemetry-authentication-macos`.
- Added new command `harfanglab-telemetry-authentication-users` to get the most frequent interactive authentications on an endpoint in order to guess the endpoint owner.
- Added new command `harfanglab-telemetry-process-graph` to get the process graph (nodes, edges...) from a process UUID.
- Added new commands to manage whitelists `harfanglab-whitelist-search`, `harfanglab-whitelist-add`, `harfanglab-whitelist-add-criterion`, `harfanglab-whitelist-delete`.
- Added new commands for security events/threat mirroring: `get-modified-remote-data`, `get-remote-data`, `update-remote-system`, `get-mapping-fields`.
- Removed deprecated `demisto.results` calls, entrycontext specifications.
- Fixed commands `harfanglab-job-processlist`, `harfanglab-job-networkconnectionlist`.
- Removed LongRunning option in the integration.
- Changed `API token` type as a password type.



#### Layouts

##### New: Hurukai threat layout

- New: Layout for Hurukai threats.

##### New: Hurukai threat layout

The new layout allows to display both Security Events (a.k.a alerts) or Threats. 

#### Mappers

##### New: Hurukai - Outgoing mapper

- New: Mapping for mirroring out XSOAR incidents.

##### Hurukai alert mapper

The Hurukai alert mapper has been modified to handle both `Hurukai alerts` and `Hurukai threats`. It has been extended with a couple of fields (`dbotMirrorDirection`, `dbotMirrorId`, `dbotMirrorInstance`) in order to manage mirroring of alert/threats' statuses between a HarfangLab EDR manager and an XSOAR. 

#### Playbooks

##### Hurukai - Alert management

- Fixed wrong text in the human input tasks

