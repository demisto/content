description: Parse files
id: Log Analysis Read All files
inputs: []
name: Log Analysis Read All files
outputs: []
starttaskid: "0"
tasks:
  "0":
    id: "0"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6eb1da5d-781f-411e-838b-76c1080cc490
      iscommand: false
      name: ""
      version: -1
      description: ''
    taskid: 6eb1da5d-781f-411e-838b-76c1080cc490
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 705,
          "y": 50
        }
      }
  "7":
    fieldMapping:
    - incidentfield: XSOAR Version
      output:
        simple: ${DemistoVersion.version}
    - incidentfield: XSOAR Build
      output:
        simple: ${DemistoVersion.buildNumber}
    id: "7"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Return the Demisto server version.
      id: 7e23c838-4c71-45d6-897e-515d375104a8
      iscommand: false
      name: Get version
      script: DemistoVersion
      type: regular
      version: -1
    taskid: 7e23c838-4c71-45d6-897e-515d375104a8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": 340
        }
      }
  "10":
    id: "10"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "61"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: endWith
              right:
                value:
                  simple: license_data.log
          root: File
      maxFileSize: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Read license_data.log and set customer name, license end date
      id: 9b1d2825-1817-45d6-8c3b-a1457c97ef88
      iscommand: false
      name: Read license_data.log and set customer name, license end date
      script: e382ff7b-32fd-44ee-8863-e4d01df09d89
      type: regular
      version: -1
    taskid: 9b1d2825-1817-45d6-8c3b-a1457c97ef88
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1535
        }
      }
  "12":
    id: "12"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "59"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: endWith
              right:
                value:
                  simple: web-app.log
          root: File
          transformers:
          - args:
              index:
                value:
                  simple: "0"
            operator: atIndex
      maxFileSize: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Read web-app file
      id: c11c14c7-be99-427b-8367-27f20bf0bdae
      iscommand: false
      name: Read web-app file
      script: eceedb9b-6a40-424d-89b9-d12c182d4561
      type: regular
      version: -1
    taskid: c11c14c7-be99-427b-8367-27f20bf0bdae
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 920,
          "y": 1535
        }
      }
  "18":
    id: "18"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    scriptarguments:
      IncidentID:
        simple: ${incident.id}
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: startWith
              right:
                value:
                  simple: server
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: endWith
              right:
                value:
                  simple: .log
          root: File
      maxFileSize: {}
      since:
        simple: ${incident.lasince}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Read server log file line by line and display warnings, fatal errors
        and keyword results in a table to the war room
      id: c077622e-382a-43b6-8630-400874063b5d
      iscommand: false
      name: Read server.log file and display
      script: 635cba01-1955-45b7-8a2a-c37b895ac7fd
      tags:
      - ServerResults
      type: regular
      version: -1
    taskid: c077622e-382a-43b6-8630-400874063b5d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1885
        }
      }
  "26":
    id: "26"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "7"
      - "55"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f3a1e0a8-3c1a-4bbe-8870-1a0e026b03db
      iscommand: false
      name: Read all files
      type: title
      version: -1
      description: ''
    taskid: f3a1e0a8-3c1a-4bbe-8870-1a0e026b03db
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 705,
          "y": 195
        }
      }
  "36":
    id: "36"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "56"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: endWith
              right:
                value:
                  simple: docker.log
          root: File
      maxFileSize: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Read docker log file
      id: 81546975-d607-4ab3-8782-2f69e9324095
      iscommand: false
      name: Read the Docker.log file
      script: b02c78b9-9792-4753-892e-cb6855fceaa4
      type: regular
      version: -1
    taskid: 81546975-d607-4ab3-8782-2f69e9324095
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 1040
        }
      }
  "37":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: File.Name
          operator: isEqualString
          right:
            value:
              simple: docker.log
      label: "yes"
    id: "37"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "56"
      "yes":
      - "36"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if docker log exist
      id: d1c8f938-969b-472a-869b-56457d0b605a
      iscommand: false
      name: 'Do we have a docker log in the bundle ? '
      type: condition
      version: -1
    taskid: d1c8f938-969b-472a-869b-56457d0b605a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 705,
          "y": 865
        }
      }
  "38":
    id: "38"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "39"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: endWith
              right:
                value:
                  simple: workers.log
          root: File
      maxFileSize: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Read workers logfile
      id: 7b7106c7-7973-442f-80de-9843c4d8bc21
      iscommand: false
      name: Read the workers.log file
      script: 4cfe787f-41ac-4419-8ecb-3b1f226bb72e
      type: regular
      version: -1
    taskid: 7b7106c7-7973-442f-80de-9843c4d8bc21
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": 515
        }
      }
  "39":
    id: "39"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: endWith
              right:
                value:
                  simple: filesystem.log
          root: File
      minFileSize: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Read the filesystem.log file extracted from the log bundle
      id: e0ffd674-6085-4bfe-8f93-229014f469d4
      iscommand: false
      name: Read the filesystem.log file
      script: cf23925a-f797-476f-8bea-c4923fd8dbb3
      type: regular
      version: -1
    taskid: e0ffd674-6085-4bfe-8f93-229014f469d4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": 690
        }
      }
  "40":
    id: "40"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "43"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: endWith
              right:
                value:
                  simple: confserver.log
          root: File
      maxFileSize: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Read the license_data.log file extracted from the log bundle
      id: 5f1281d0-6126-4210-8aa0-87bf08e75adf
      iscommand: false
      name: Read the confserver.log file
      script: b5042a5f-9bb3-4eaa-8c96-e4b53ab3eef8
      type: regular
      version: -1
    taskid: 5f1281d0-6126-4210-8aa0-87bf08e75adf
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 920,
          "y": 515
        }
      }
  "42":
    id: "42"
    ignoreworker: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 71dd3996-b52a-4b12-8648-99724afd5292
      iscommand: false
      name: Done
      type: title
      version: -1
      description: ''
    taskid: 71dd3996-b52a-4b12-8648-99724afd5292
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 920,
          "y": 2060
        }
      }
  "43":
    id: "43"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: endWith
              right:
                value:
                  simple: conf.log
          root: File
      maxFileSize: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Read the conf.log file extracted from the log bundle
      id: ce73449d-c01f-4298-80f8-d87f859987d2
      iscommand: false
      name: Read the conf.log file
      script: 2b5de551-cd4c-4223-8e2f-7ca5f7c10002
      type: regular
      version: -1
    taskid: ce73449d-c01f-4298-80f8-d87f859987d2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 920,
          "y": 690
        }
      }
  "52":
    continueonerror: true
    id: "52"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: endWith
              right:
                value:
                  simple: telemetry.log
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Read Telemetry file
      id: 9f717efd-66eb-45d9-80ab-83301094b2a2
      iscommand: false
      name: Read Telemetry file
      script: 33759f86-c018-417c-8602-7054314fed21
      type: regular
      version: -1
    taskid: 9f717efd-66eb-45d9-80ab-83301094b2a2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1360
        }
      }
  "55":
    id: "55"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "40"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: endWith
              right:
                value:
                  simple: version_control.log
          root: File
      maxFileSize: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Read the version_control.log file extracted from the log bundle
      id: 71ad98ce-c9ab-4428-8fd6-6b28cda6a054
      iscommand: false
      name: Read the version_control.log file
      script: 94f29c66-ca5f-47f0-855e-9724688218f1
      type: regular
      version: -1
    taskid: 71ad98ce-c9ab-4428-8fd6-6b28cda6a054
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 920,
          "y": 340
        }
      }
  "56":
    id: "56"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "58"
      - "52"
      - "62"
      - "63"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d0e1665f-4d38-4139-88d8-dd63d420c476
      iscommand: false
      name: Continue
      type: title
      version: -1
      description: ''
    taskid: d0e1665f-4d38-4139-88d8-dd63d420c476
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 705,
          "y": 1215
        }
      }
  "57":
    id: "57"
    ignoreworker: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 44afa2eb-2599-4b46-811a-938a8180a0a5
      iscommand: false
      name: 84e9588a-b0e0-4ada-8607-2f6736061627
      playbookId: 84e9588a-b0e0-4ada-8607-2f6736061627
      type: playbook
      version: -1
      description: ''
    taskid: 44afa2eb-2599-4b46-811a-938a8180a0a5
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1885
        }
      }
  "58":
    id: "58"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bd3e229d-aed0-437e-8d7a-40105907414d
      iscommand: false
      name: Content
      type: title
      version: -1
      description: ''
    taskid: bd3e229d-aed0-437e-8d7a-40105907414d
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 920,
          "y": 1375
        }
      }
  "59":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: File.Name
          operator: isEqualString
          right:
            value:
              simple: installedpacks.json
      label: "yes"
    id: "59"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "42"
      "yes":
      - "60"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check for PACKS
      id: 052e5f2c-5509-4b34-84e4-0818438b59ac
      iscommand: false
      name: Check for PACKS
      type: condition
      version: -1
    taskid: 052e5f2c-5509-4b34-84e4-0818438b59ac
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 920,
          "y": 1710
        }
      }
  "60":
    id: "60"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          accessor: EntryID}
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: isEqualString
              right:
                value:
                  simple: installedpacks.json
          root: ${File
      maxFileSize: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Read the installedpacks.json. \n\nCount and get pacs names"
      id: 5eaf3b0d-2925-4670-86f7-3290b58a402e
      iscommand: false
      name: Read installedpacks.json
      script: f41e0e48-f95c-49a7-8f63-bbc75ec786e9
      type: regular
      version: -1
    taskid: 5eaf3b0d-2925-4670-86f7-3290b58a402e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1032.5,
          "y": 1885
        }
      }
  "61":
    id: "61"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "57"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9b0ac18d-aa02-49bf-8794-0027793f9f61
      iscommand: false
      name: 'Architecture: DR/HA/MultiRepo/DD/Elastic'
      type: title
      version: -1
      description: ''
    taskid: 9b0ac18d-aa02-49bf-8794-0027793f9f61
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1725
        }
      }
  "62":
    id: "62"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2df3717d-83e7-48f6-80bd-7f6a225d7501
      iscommand: false
      name: Server Logs Logic
      type: title
      version: -1
      description: ''
    taskid: 2df3717d-83e7-48f6-80bd-7f6a225d7501
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1725
        }
      }
  "63":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: justKey
          operator: isExists
      label: "yes"
    id: "63"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "42"
      "yes":
      - "64"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Collect Large Investigation
      id: 49021c0c-c9bd-4387-8b1d-ae2c67882058
      iscommand: false
      name: Collect Large Investigation
      type: condition
      version: -1
    taskid: 49021c0c-c9bd-4387-8b1d-ae2c67882058
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1370,
          "y": 1535
        }
      }
  "64":
    id: "64"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "65"
    note: false
    quietmode: 0
    scriptarguments:
      from: {}
      table_result: {}
      to: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns inputs and outputs larger than 1 MB from all Cortex XSOAR
        investigations.
      id: c2c92562-625e-46b6-8414-f48c1c66ff2c
      iscommand: false
      name: Get Large IO Incidents
      script: GetLargestInputsAndOuputsInIncidents
      type: regular
      version: -1
    taskid: c2c92562-625e-46b6-8414-f48c1c66ff2c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1482.5,
          "y": 1695
        }
      }
  "65":
    id: "65"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    scriptarguments:
      from: {}
      table_result: {}
      to: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns all investigations larger than 1 MB from all Cortex XSOAR.
      id: 0ccb703d-1a59-42ef-854f-0d95cdac8d3f
      iscommand: false
      name: Get Large Investigations
      script: GetLargestInvestigations
      type: regular
      version: -1
    taskid: 0ccb703d-1a59-42ef-854f-0d95cdac8d3f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1482.5,
          "y": 1885
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2075,
        "width": 1812.5,
        "x": 50,
        "y": 50
      }
    }
  }
tests:
- No tests (auto formatted)
fromversion: 5.5.0
