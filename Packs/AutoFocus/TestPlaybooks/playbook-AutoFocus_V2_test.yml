id: AutoFocus V2 test
version: -1
fromversion: 5.0.0
name: AutoFocus V2 test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: e8224052-4007-42bd-8c2e-d36206643e7c
    type: start
    task:
      id: e8224052-4007-42bd-8c2e-d36206643e7c
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 8feee596-903b-4489-86b1-389dc3226a76
    type: regular
    task:
      id: 8feee596-903b-4489-86b1-389dc3226a76
      version: -1
      name: autofocus-search-samples
      description: Searches for samples in AutoFocus. To view results, run the autofocus-samples-search-results
        command with the returned AF Cookie. The AF Cookie expires 120 seconds after
        the search completes. `Autofocus Query Samples, Sessions and Tags` Playbook
        is recommended for querying and polling.
      script: AutoFocus V2|||autofocus-search-samples
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      artifact:
        simple: "true"
      query:
        simple: '{"operator":"all","children":[{"field":"sample.malware","operator":"is","value":1},{"field":"sample.tag","operator":"is
          in the list","value":["Unit42.RunOnce"]}]}'
      scope:
        simple: Public
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: 26d362cd-0772-4d1b-8dcf-3ec9319e9d48
    type: regular
    task:
      id: 26d362cd-0772-4d1b-8dcf-3ec9319e9d48
      version: -1
      name: autofocus-search-sessions
      description: Searches for sessions in AutoFocus. To view results, run the autofocus-sessions-search-results
        command with the returned AF Cookie. The AF Cookie expires 120 seconds after
        the search completes. `Autofocus Query Samples, Sessions and Tags` Playbook
        is recommended for querying and polling.
      script: AutoFocus V2|||autofocus-search-sessions
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      query:
        simple: '{"operator": "all","children": [{"field": "sample.malware","operator":
          "is","value": "1"}]}'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: d03574c5-30f3-4879-8d71-b60e2d5f8cd1
    type: condition
    task:
      id: d03574c5-30f3-4879-8d71-b60e2d5f8cd1
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "22"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesSearch.AFCookie
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesSearch.Status
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4045
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: cf304eaa-b871-43da-8ad4-3e6bdb12dcae
    type: condition
    task:
      id: cf304eaa-b871-43da-8ad4-3e6bdb12dcae
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "23"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsSearch.AFCookie
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsSearch.Status
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 75eb8f65-a1f4-4b44-8be4-9d4224341b43
    type: regular
    task:
      id: 75eb8f65-a1f4-4b44-8be4-9d4224341b43
      version: -1
      name: autofocus-samples-search-results
      description: Get results of a previous samples search
      script: AutoFocus V2|||autofocus-samples-search-results
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      af_cookie:
        simple: ${AutoFocus.SamplesSearch.AFCookie}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4395
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: c14c564b-7b38-410a-87ec-be7a44a22e1e
    type: regular
    task:
      id: c14c564b-7b38-410a-87ec-be7a44a22e1e
      version: -1
      name: autofocus-sessions-search-results
      description: Get results of a previous sessions search
      script: AutoFocus V2|||autofocus-sessions-search-results
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      af_cookie:
        simple: ${AutoFocus.SessionsSearch.AFCookie}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: 60817259-6c93-4b00-8f9e-5ea63ff632d5
    type: condition
    task:
      id: 60817259-6c93-4b00-8f9e-5ea63ff632d5
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "10"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesResults.Size
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesResults.SHA1
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesResults.SHA256
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesResults.Created
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesResults.Finished
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesResults.Region
            iscontext: true
      - - operator: inList
          left:
            value:
              simple: AutoFocus.SamplesSearch.Status
            iscontext: true
          right:
            value:
              simple: in progress,complete
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: Size
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: SHA1
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: SHA256
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: Type
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: Tags
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 634e5924-8c89-425f-817c-5d3c2a91ba64
    type: condition
    task:
      id: 634e5924-8c89-425f-817c-5d3c2a91ba64
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "11"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsResults.FileName
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsResults.ID
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsResults.Industry
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsResults.Region
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsResults.SHA256
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsResults.Seen
            iscontext: true
      - - operator: inList
          left:
            value:
              simple: AutoFocus.SessionsSearch.Status
            iscontext: true
          right:
            value:
              simple: in progress,complete
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: Name
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: SHA256
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: Tags
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: 5b2f3dc6-5a06-4548-88e7-b625d97e1f10
    type: regular
    task:
      id: 5b2f3dc6-5a06-4548-88e7-b625d97e1f10
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "26"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: fc982907-9d0a-4dbb-8104-9d64e202085e
    type: regular
    task:
      id: fc982907-9d0a-4dbb-8104-9d64e202085e
      version: -1
      name: autofocus-sample-analysis
      description: |-
        Get properties, behaviors, and activities observed for a sample.
        Run the command once to get the fields and os's under HTTP,Coverage,Behavior,Registry,Files,Processes,Connections,DNS.
      script: AutoFocus V2|||autofocus-sample-analysis
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      sample_id:
        simple: dd0d26ceea034b3ae32a4f6a477466ac598ee17f811f88cf14b2c708240fb993
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4745
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 85376dad-83c9-4d55-8946-07b5837acfcc
    type: regular
    task:
      id: 85376dad-83c9-4d55-8946-07b5837acfcc
      version: -1
      name: autofocus-get-session-details
      description: Get session details by session ID
      script: AutoFocus V2|||autofocus-get-session-details
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      session_id:
        complex:
          root: AutoFocus
          accessor: SessionsResults.ID
          transformers:
          - operator: atIndex
            args:
              index:
                value:
                  simple: "0"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: 7c97d449-8300-4066-8e94-52d8ccaecc52
    type: condition
    task:
      id: 7c97d449-8300-4066-8e94-52d8ccaecc52
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "15"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SampleAnalysis.Analysis.Coverage
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SampleAnalysis.Analysis.Behavior
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SampleAnalysis.Analysis.Registry
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SampleAnalysis.Analysis.Files
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SampleAnalysis.Analysis.Processes
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SampleAnalysis.Analysis.Mutex
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 1d28878e-68b7-47e6-863b-dc8099459621
    type: condition
    task:
      id: 1d28878e-68b7-47e6-863b-dc8099459621
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "52"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Sessions.FileName
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Sessions.Industry
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Sessions.Region
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Sessions.SHA256
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Sessions.Seen
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Sessions.UploadSource
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: Name
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: SHA256
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 26c8ba06-1507-431b-86d2-572ade968ee5
    type: regular
    task:
      id: 26c8ba06-1507-431b-86d2-572ade968ee5
      version: -1
      name: autofocus-top-tags-search
      description: Perform a search to Identify the most popular tags
      script: AutoFocus V2|||autofocus-top-tags-search
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      class:
        simple: Malicious Behavior
      private:
        simple: "True"
      public:
        simple: "True"
      scope:
        simple: all
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5095
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: e267ab3d-61cd-44d0-8474-10f3fa5751a3
    type: regular
    task:
      id: e267ab3d-61cd-44d0-8474-10f3fa5751a3
      version: -1
      name: autofocus-top-tags-results
      description: Get the results of a previous top tags search
      script: AutoFocus V2|||autofocus-top-tags-results
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      af_cookie:
        simple: ${AutoFocus.TopTagsSearch.AFCookie}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: 6c1f2dac-1ea9-42e5-8605-ff6c6e5ed0fe
    type: regular
    task:
      id: 6c1f2dac-1ea9-42e5-8605-ff6c6e5ed0fe
      version: -1
      name: autofocus-tag-details
      description: Get details on a given tag
      script: AutoFocus V2|||autofocus-tag-details
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      tag_name:
        complex:
          root: AutoFocus
          accessor: TopTagsResults.PublicTagName
          transformers:
          - operator: atIndex
            args:
              index:
                value:
                  simple: "0"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: f98f9091-f18b-4a38-8dc5-07b46689bdfc
    type: condition
    task:
      id: f98f9091-f18b-4a38-8dc5-07b46689bdfc
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "24"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.TopTagsSearch.AFCookie
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.TopTagsSearch.Status
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: b1d53370-4bdf-4c1d-8bd7-2739cc2b954a
    type: condition
    task:
      id: b1d53370-4bdf-4c1d-8bd7-2739cc2b954a
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "17"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.TopTagsResults.Count
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.TopTagsResults.PublicTagName
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.TopTagsResults.TagName
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.TopTagsResults.Lasthit
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5795
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: faf7622f-f80a-4e76-81b7-0fd7f8a31c4c
    type: condition
    task:
      id: faf7622f-f80a-4e76-81b7-0fd7f8a31c4c
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "39"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Tag.TagName
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Tag.PublicTagName
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Tag.Count
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Tag.Lasthit
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Tag.TagDefinitionScope
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Tag.TagClass
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Tag.TagDefinitionStatus
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Tag.Description
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6145
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 98adf75c-ef60-40d3-8d96-927d80f22131
    type: regular
    task:
      id: 98adf75c-ef60-40d3-8d96-927d80f22131
      version: -1
      name: Sleep
      description: Sleep for X seconds
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      seconds:
        simple: "60"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: 1541783f-f21e-4602-85d4-4863f6e6e5f4
    type: regular
    task:
      id: 1541783f-f21e-4602-85d4-4863f6e6e5f4
      version: -1
      name: Sleep
      description: Sleep for X seconds
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      seconds:
        simple: "60"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: 51175115-b5bc-4e7a-8183-7881db73c399
    type: regular
    task:
      id: 51175115-b5bc-4e7a-8183-7881db73c399
      version: -1
      name: Sleep
      description: Sleep for X seconds
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      seconds:
        simple: "60"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: 717d8872-9924-432c-86cd-e8178e81d8dc
    type: regular
    task:
      id: 717d8872-9924-432c-86cd-e8178e81d8dc
      version: -1
      name: autofocus-search-samples
      description: Searches for samples in AutoFocus. To view results, run the autofocus-samples-search-results
        command with the returned AF Cookie. The AF Cookie expires 120 seconds after
        the search completes. `Autofocus Query Samples, Sessions and Tags` Playbook
        is recommended for querying and polling.
      script: AutoFocus V2|||autofocus-search-samples
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "33"
    scriptarguments:
      file_hash:
        simple: 0df433c3858949036eee16a241fa52311402f55163acb40b85c5301c0a9a2036
      scope:
        simple: Public
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: c6642c19-fea6-460c-840d-4bbd732dec62
    type: regular
    task:
      id: c6642c19-fea6-460c-840d-4bbd732dec62
      version: -1
      name: autofocus-search-sessions
      description: Searches for sessions in AutoFocus. To view results, run the autofocus-sessions-search-results
        command with the returned AF Cookie. The AF Cookie expires 120 seconds after
        the search completes. `Autofocus Query Samples, Sessions and Tags` Playbook
        is recommended for querying and polling.
      script: AutoFocus V2|||autofocus-search-sessions
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      ip:
        simple: 10.2.2.20
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: cf04b550-57c2-420d-88db-a1536193eb7c
    type: regular
    task:
      id: cf04b550-57c2-420d-88db-a1536193eb7c
      version: -1
      name: Sleep
      description: Sleep for X seconds
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      seconds:
        simple: "60"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: 06a19a4b-8834-4eb8-85c2-a04a014efdd2
    type: regular
    task:
      id: 06a19a4b-8834-4eb8-85c2-a04a014efdd2
      version: -1
      name: Sleep
      description: Sleep for X seconds
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "35"
    scriptarguments:
      seconds:
        simple: "100"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: fbd5a3be-966e-4cfc-8d03-ea04ae9b95e8
    type: regular
    task:
      id: fbd5a3be-966e-4cfc-8d03-ea04ae9b95e8
      version: -1
      name: autofocus-samples-search-results
      description: Returns results of a previous samples search. `Autofocus Query
        Samples, Sessions and Tags` Playbook is recommended for querying and polling.
      script: AutoFocus V2|||autofocus-samples-search-results
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "37"
    scriptarguments:
      af_cookie:
        simple: ${AutoFocus.SamplesSearch.AFCookie}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: 5b596902-a5db-4ff6-8d72-b7e24e5309c0
    type: condition
    task:
      id: 5b596902-a5db-4ff6-8d72-b7e24e5309c0
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "30"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesSearch.AFCookie
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesSearch.Status
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: da2d2fac-5b50-46ab-8ccc-2e8e2cd865ef
    type: condition
    task:
      id: da2d2fac-5b50-46ab-8ccc-2e8e2cd865ef
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "31"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsSearch.AFCookie
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsSearch.Status
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: dae09fd9-2f3b-4c7f-8a3e-ea051eee309c
    type: regular
    task:
      id: dae09fd9-2f3b-4c7f-8a3e-ea051eee309c
      version: -1
      name: autofocus-sessions-search-results
      description: Returns results of a previous sessions search. `Autofocus Query
        Samples, Sessions and Tags` Playbook is recommended for querying and polling.
      script: AutoFocus V2|||autofocus-sessions-search-results
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      af_cookie:
        simple: ${AutoFocus.SessionsSearch.AFCookie}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: 24fd8fdf-1b31-405c-89cd-62021825a6c2
    type: condition
    task:
      id: 24fd8fdf-1b31-405c-89cd-62021825a6c2
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "51"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsResults.FileName
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsResults.ID
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsResults.Industry
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsResults.Region
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsResults.SHA256
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsResults.Seen
            iscontext: true
      - - operator: inList
          left:
            value:
              simple: AutoFocus.SessionsSearch.Status
            iscontext: true
          right:
            value:
              simple: in progress,complete
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: Name
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: SHA256
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: c3be23ec-9ac1-4644-87f7-df638f5ad601
    type: condition
    task:
      id: c3be23ec-9ac1-4644-87f7-df638f5ad601
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "38"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesResults.Size
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesResults.SHA1
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesResults.SHA256
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesResults.Created
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesResults.Finished
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesResults.Region
            iscontext: true
      - - operator: inList
          left:
            value:
              simple: AutoFocus.SamplesSearch.Status
            iscontext: true
          right:
            value:
              simple: in progress,complete
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: Size
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: SHA1
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: SHA256
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: Type
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: ed90c8b6-2409-4abd-876c-7fe4e5ec1a15
    type: regular
    task:
      id: ed90c8b6-2409-4abd-876c-7fe4e5ec1a15
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: cf9ec624-dcc8-4e88-8020-36aeeeffdb96
    type: title
    task:
      id: cf9ec624-dcc8-4e88-8020-36aeeeffdb96
      version: -1
      name: Indicators Reputation
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "40"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: 8199bf30-6cbe-4399-814e-6c7efe1d622f
    type: regular
    task:
      id: 8199bf30-6cbe-4399-814e-6c7efe1d622f
      version: -1
      name: Check multiple URL Reputation
      description: Checks the reputation of the url in Autofocus.
      script: AutoFocus V2|||url
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "41"
    scriptarguments:
      retry-count:
        simple: "5"
      url:
        simple: www.andromedaa.ir/ir/andromedaa/likebegir/ap.smali/,www.google.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6465
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: 2ae2dc03-20a2-42b1-84e4-eda98458fb66
    type: condition
    task:
      id: 2ae2dc03-20a2-42b1-84e4-eda98458fb66
      version: -1
      name: Validate URL Reputation
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "43"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
      - - operator: containsGeneral
          left:
            value:
              simple: URL.Data
            iscontext: true
          right:
            value:
              simple: www.google.com
      - - operator: isNotEmpty
          left:
            value:
              simple: AutoFocus.URL.IndicatorValue
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6640
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: 555626f1-aabf-4203-8a3f-06c1cb31bc31
    type: title
    task:
      id: 555626f1-aabf-4203-8a3f-06c1cb31bc31
      version: -1
      name: done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9935
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: 328806ef-2d29-4e09-8742-11a17526d313
    type: regular
    task:
      id: 328806ef-2d29-4e09-8742-11a17526d313
      version: -1
      name: Check multiple IP Reputation
      description: Checks the reputation of an IP address in Autofocus.
      script: AutoFocus V2|||ip
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "44"
    scriptarguments:
      ip:
        simple: 8.8.8.8,1.1.1.1
      retry-count:
        simple: "5"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6815
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "44":
    id: "44"
    taskid: 40255240-0227-459b-8ae5-984ccd8e4b35
    type: condition
    task:
      id: 40255240-0227-459b-8ae5-984ccd8e4b35
      version: -1
      name: Validate IP Reputation
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "45"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
      - - operator: containsGeneral
          left:
            value:
              simple: IP.Address
            iscontext: true
          right:
            value:
              simple: 1.1.1.1
      - - operator: isNotEmpty
          left:
            value:
              simple: AutoFocus.IP.IndicatorValue
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: IP.Tags
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: IP.MalwareFamily
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6990
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: eab20eea-de91-4133-8e71-aa2817e158f2
    type: regular
    task:
      id: eab20eea-de91-4133-8e71-aa2817e158f2
      version: -1
      name: CheckFile Reputation
      description: Checks the reputation of a file in Autofocus.
      script: AutoFocus V2|||file
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "46"
    scriptarguments:
      file:
        simple: 9040e9fda52931c9472c90ecad5b74295cdb9cf7b68e2b89219700f6a8bff5ac,e3fce71af74414f5c632265de2f7ee1f287b97c3b086e5a54bb285e6997fae43
      retry-count:
        simple: "5"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7165
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: 4149ced7-13a8-479d-8c2e-e33ab6a18bea
    type: condition
    task:
      id: 4149ced7-13a8-479d-8c2e-e33ab6a18bea
      version: -1
      name: Validate File Reputation
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "47"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AutoFocus.File.IndicatorValue
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: File.SHA256
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: File.Tags
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: File.MalwareFamily
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7340
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: 368c755f-e3d7-405f-838c-5f03bf8e45ba
    type: regular
    task:
      id: 368c755f-e3d7-405f-838c-5f03bf8e45ba
      version: -1
      name: Check Multiple Domain Reputation
      description: Checks the reputation of a domain in Autofocus.
      script: AutoFocus V2|||domain
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "48"
    scriptarguments:
      domain:
        simple: dropwellsfargo.com,google.com,terraini.com
      retry-count:
        simple: "5"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7515
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: d808dc2c-e853-4064-8c9b-251b9ee69a90
    type: condition
    task:
      id: d808dc2c-e853-4064-8c9b-251b9ee69a90
      version: -1
      name: Validate Domain Reputation
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "49"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
      - - operator: containsGeneral
          left:
            value:
              simple: Domain.Name
            iscontext: true
          right:
            value:
              simple: google.com
      - - operator: isNotEmpty
          left:
            value:
              simple: AutoFocus.Domain.IndicatorValue
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: c5070419-50fa-4cbe-8469-babdaf8198a6
    type: regular
    task:
      id: c5070419-50fa-4cbe-8469-babdaf8198a6
      version: -1
      name: Check Upper Case File Reputation
      description: Checks the reputation of a file in Autofocus.
      script: AutoFocus V2|||file
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "50"
    scriptarguments:
      file:
        simple: 9040E9FDA52931C9472C90ECAD5B74295CDB9CF7B68E2B89219700F6A8BFF5AC
      retry-count:
        simple: "5"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7865
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: 2cdc63c2-0b04-47a0-80fe-87e090ff24ed
    type: condition
    task:
      id: 2cdc63c2-0b04-47a0-80fe-87e090ff24ed
      version: -1
      name: Validate Upper Case File Reputation
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "53"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AutoFocus.File.IndicatorValue
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: File.SHA256
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: 3e4d51f4-2394-4e8c-80c3-dcee57343d83
    type: regular
    task:
      id: 3e4d51f4-2394-4e8c-80c3-dcee57343d83
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "52":
    id: "52"
    taskid: 2fda67d1-6260-40da-8918-0eaf23152b73
    type: regular
    task:
      id: 2fda67d1-6260-40da-8918-0eaf23152b73
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3695
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: 2ad8e13d-788b-4ef8-8b4e-b877d7ee222d
    type: regular
    task:
      id: 2ad8e13d-788b-4ef8-8b4e-b877d7ee222d
      version: -1
      name: Get Demisto Version
      description: Return the Demisto server version.
      scriptName: DemistoVersion
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "54"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8215
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "54":
    id: "54"
    taskid: cc33affb-d0a1-4351-88f5-7a169f234a48
    type: condition
    task:
      id: cc33affb-d0a1-4351-88f5-7a169f234a48
      version: -1
      name: Is Demisto Version 6.2.0+
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "42"
      "yes":
      - "55"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: greaterThanOrEqual
          left:
            value:
              complex:
                root: DemistoVersion
                accessor: version
                transformers:
                - operator: split
                  args:
                    delimiter:
                      value:
                        simple: .
                - operator: FirstArrayElement
            iscontext: true
          right:
            value:
              simple: "6"
      - - operator: greaterThanOrEqual
          left:
            value:
              complex:
                root: DemistoVersion
                accessor: version
                transformers:
                - operator: split
                  args:
                    delimiter:
                      value:
                        simple: .
                - operator: FirstArrayElement
            iscontext: true
          right:
            value:
              simple: "7"
        - operator: greaterThanOrEqual
          left:
            value:
              complex:
                root: DemistoVersion
                accessor: version
                transformers:
                - operator: split
                  args:
                    delimiter:
                      value:
                        simple: .
                - operator: splice
                  args:
                    deleteCount:
                      value:
                        simple: "1"
                    index:
                      value:
                        simple: "0"
                    item: {}
                - operator: FirstArrayElement
            iscontext: true
          right:
            value:
              simple: "2"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "55":
    id: "55"
    taskid: 13d1b2ce-e785-42d8-8037-ebdbc035b25f
    type: title
    task:
      id: 13d1b2ce-e785-42d8-8037-ebdbc035b25f
      version: -1
      name: Polling Commands
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "62"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 8565
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "56":
    id: "56"
    taskid: 1b5494d9-0fff-487f-883e-f41fdc8db4c3
    type: regular
    task:
      id: 1b5494d9-0fff-487f-883e-f41fdc8db4c3
      version: -1
      name: autofocus-search-sessions
      description: Searches for sessions in AutoFocus. To view results, run the autofocus-sessions-search-results
        command with the returned AF Cookie. The AF Cookie expires 120 seconds after
        the search completes. `Autofocus Query Samples, Sessions and Tags` Playbook
        is recommended for querying and polling.
      script: AutoFocus V2|||autofocus-search-sessions
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "64"
    scriptarguments:
      ip:
        simple: 10.2.2.20
      max_results:
        simple: "1"
      polling:
        simple: "true"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 9235
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "58":
    id: "58"
    taskid: 3a002af7-4cb4-43ca-8265-4c31ec201940
    type: regular
    task:
      id: 3a002af7-4cb4-43ca-8265-4c31ec201940
      version: -1
      name: autofocus-search-samples
      description: Searches for samples in AutoFocus. To view results, run the autofocus-samples-search-results
        command with the returned AF Cookie. The AF Cookie expires 120 seconds after
        the search completes. `Autofocus Query Samples, Sessions and Tags` Playbook
        is recommended for querying and polling.
      script: AutoFocus V2|||autofocus-search-samples
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "61"
    scriptarguments:
      file_hash:
        simple: 0df433c3858949036eee16a241fa52311402f55163acb40b85c5301c0a9a2036
      polling:
        simple: "true"
      scope:
        simple: Public
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 8885
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: 8805f8b4-5286-4667-8b30-18432701a437
    type: regular
    task:
      id: 8805f8b4-5286-4667-8b30-18432701a437
      version: -1
      name: autofocus-top-tags-search
      description: Perform a search to Identify the most popular tags
      script: AutoFocus V2|||autofocus-top-tags-search
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "66"
    scriptarguments:
      class:
        simple: Malicious Behavior
      polling:
        simple: "true"
      private:
        simple: "True"
      public:
        simple: "True"
      scope:
        simple: all
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 9585
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    id: "61"
    taskid: cf423a61-7261-4398-8a5d-a4b771acccbd
    type: condition
    task:
      id: cf423a61-7261-4398-8a5d-a4b771acccbd
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "56"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesResults.Size
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesResults.SHA1
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesResults.SHA256
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesResults.Created
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesResults.Finished
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesResults.Region
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: AutoFocus.SamplesSearch.Status
            iscontext: true
          right:
            value:
              simple: complete
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: Size
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: SHA1
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: SHA256
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: Type
            iscontext: true
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 9060
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "62":
    id: "62"
    taskid: b9348f1d-9f5d-45f1-8801-dfaabb67fc41
    type: regular
    task:
      id: b9348f1d-9f5d-45f1-8801-dfaabb67fc41
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "58"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 8710
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "64":
    id: "64"
    taskid: c91987c0-d533-4d40-83bc-cfcfa91fec10
    type: condition
    task:
      id: c91987c0-d533-4d40-83bc-cfcfa91fec10
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "60"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsResults.FileName
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsResults.ID
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsResults.Industry
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsResults.Region
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsResults.SHA256
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsResults.Seen
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: AutoFocus.SessionsSearch.Status
            iscontext: true
          right:
            value:
              simple: complete
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: Name
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: SHA256
            iscontext: true
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 9410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "66":
    id: "66"
    taskid: 78b03e3d-3201-4e8c-8d60-6e5c107dd009
    type: condition
    task:
      id: 78b03e3d-3201-4e8c-8d60-6e5c107dd009
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "42"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.TopTagsResults.Count
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.TopTagsResults.PublicTagName
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.TopTagsResults.TagName
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.TopTagsResults.Lasthit
            iscontext: true
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 9760
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "54_42_#default#": 0.87
    },
    "paper": {
      "dimensions": {
        "height": 9950,
        "width": 492.5,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
