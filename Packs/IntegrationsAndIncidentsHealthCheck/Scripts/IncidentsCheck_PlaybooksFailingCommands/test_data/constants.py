INCIDENT_RESULT_NO_FAILED_COMMANDS = [{'CustomFields': {'dbotpredictionprobability': 0,
                                                        'detectionsla': {'accumulatedPause': 0,
                                                                         'breachTriggered': False,
                                                                         'dueDate': '0001-01-01T00:00:00Z',
                                                                         'endDate': '0001-01-01T00:00:00Z',
                                                                         'lastPauseDate': '0001-01-01T00:00:00Z',
                                                                         'runStatus': 'idle',
                                                                         'sla': 20, 'slaStatus': -1,
                                                                         'startDate': '0001-01-01T00:00:00Z',
                                                                         'totalDuration': 0},
                                                        'integrationscategories': [
                                                            'Endpoint', 'Utilities', 'Utilities',
                                                            'Utilities',
                                                            'Utilities', 'Endpoint', 'Messaging',
                                                            'Data Enrichment & Threat Intelligence'],
                                                        'integrationsfailedcategories': [
                                                            'Data Enrichment & Threat Intelligence',
                                                            'Vulnerability Management', 'Endpoint',
                                                            'Forensics & Malware Analysis',
                                                            'Data Enrichment & Threat Intelligence',
                                                            'Endpoint'], 'integrationstestgrid': [
        {'analystnote': '(2020-09-30) (2020-09-30) Need to get the new password', 'brand': 'Active Directory Query v2',
         'category': 'Data Enrichment & Threat Intelligence',
         'information': 'Failed to access LDAP server. Please validate the server '
                        'host and port are configured correctly (85)',
         'instance': 'Active Directory Query v2_instance_1'},
        {'brand': 'BigFix', 'category': 'Vulnerability Management',
         'information': "Invalid URL '\\xd7\\x91\\xd7\\x94\\xd7\\xa0/api/help': No schema "
                        "supplied. Perhaps you meant http://בהנ/api/help? (85)",
         'instance': 'BigFix_instance_1'}, {'brand': 'Tanium Threat Response', 'category': 'Endpoint',
                                            'information': "Error in Tanium Threat Response Integration: "
                                                           "Invalid URL 'sfgdfg/api/v2/session/login': No schema "
                                                           "supplied. Perhaps you meant "
                                                           "http://sfgdfg/api/v2/session/login? (85)",
                                            'instance': 'Tanium Threat Response_instance_1'},
        {'brand': 'Threat Grid', 'category': 'Forensics & Malware Analysis',
         'information': 'Error in API call to Threat Grid service api/v3/session/whoami - '
                        '{"api_version":3,"id":2907192,"error":{"message":"Unauthorized","code":401,"errors":'
                        '[{"code":401,"message":"Unauthorized","help":"/doc/main/index.html","report":'
                        '"support@threatgrid.com"}]}} (85)',
         'instance': 'Threat Grid_instance_1'},
        {'analystnote': '(2020-09-30) (2020-09-30) Creating a new API key', 'brand': 'VirusTotal',
         'category': 'Data Enrichment & Threat Intelligence',
         'information': '403 Forbidden - The API key is not valid (85)', 'instance': 'VirusTotal_instance_1'},
        {'brand': 'remoteaccess', 'category': 'Endpoint',
         'information': 'ssh: handshake failed: ssh: unable to authenticate, attempted methods [none], '
                        'no supported methods remain',
         'instance': 'remoteaccess_instance_1'}], 'numberofentriesiderrors': 8, 'numberoffailedincidents': 4,
                                                        'playbooknameswithfailedtasks': [
                                                            'AutoFocusPolling',
                                                            'JOB - Integrations and Playbooks Health Check',
                                                            'JOB - Integrations and Playbooks Health Check',
                                                            'Account Enrichment - Generic v2.1'],
                                                        'playbooktaskserrors': [
                                                            {'analystnote': '(2020-09-30) (2020-09-30) John checking',
                                                             'commandname': 'RunPollingCommand',
                                                             'creationdate': '2020-09-29 16:48:30.261438285Z',
                                                             'incidentid': '7',
                                                             'numberoferrors': 2, 'owner': '',
                                                             'playbookname': 'AutoFocusPolling', 'task_id': None,
                                                             'taskid': '3',
                                                             'taskname': 'RunPollingCommand'},
                                                            {'commandname': 'SetGridField',
                                                             'creationdate': '2020-09-29 14:02:45.82647067Z',
                                                             'incidentid': '3',
                                                             'numberoferrors': 2, 'owner': 'admin',
                                                             'playbookname':
                                                                 'JOB - Integrations and Playbooks Health Check',
                                                             'task_id': None, 'taskid': '132',
                                                             'taskname': 'Creates failed Integrations grid'},
                                                            {'commandname': 'SetGridField',
                                                             'creationdate': '2020-09-29 14:02:45.82647067Z',
                                                             'incidentid': '3',
                                                             'numberoferrors': 2, 'owner': 'admin',
                                                             'playbookname':
                                                                 'JOB - Integrations and Playbooks Health Check',
                                                             'task_id': None, 'taskid': '131',
                                                             'taskname': 'Set empty fields to incident grid'},
                                                            {
                                                                'analystnote':
                                                                    '(2020-09-30) (2020-09-30) Need to fix integration',
                                                                'commandname': 'ad-get-user',
                                                                'creationdate': '2020-09-30 15:44:06.930751906Z',
                                                                'incidentid': '48',
                                                                'numberoferrors': 2, 'owner': 'admin',
                                                                'playbookname': 'Account Enrichment - Generic v2.1',
                                                                'task_id': None,
                                                                'taskid': '5',
                                                                'taskname': 'Get account info from Active Directory'}],
                                                        'remediationsla': {'accumulatedPause': 0,
                                                                           'breachTriggered': False,
                                                                           'dueDate': '0001-01-01T00:00:00Z',
                                                                           'endDate': '0001-01-01T00:00:00Z',
                                                                           'lastPauseDate': '0001-01-01T00:00:00Z',
                                                                           'runStatus': 'idle',
                                                                           'sla': 7200, 'slaStatus': -1,
                                                                           'startDate': '0001-01-01T00:00:00Z',
                                                                           'totalDuration': 0},
                                                        'similarincident': ['50'],
                                                        'timetoassignment': {'accumulatedPause': 0,
                                                                             'breachTriggered': False,
                                                                             'dueDate': '0001-01-01T00:00:00Z',
                                                                             'endDate': '0001-01-01T00:00:00Z',
                                                                             'lastPauseDate': '0001-01-01T00:00:00Z',
                                                                             'runStatus': 'idle',
                                                                             'sla': 0, 'slaStatus': -1,
                                                                             'startDate': '0001-01-01T00:00:00Z',
                                                                             'totalDuration': 0},
                                                        'totalfailedinstances': 6, 'totalgoodinstances': 8,
                                                        'totalinstances': 14,
                                                        'unassignedincidents': ['7'], 'urlsslverification': []},
                                       'ShardID': 0,
                                       'account': '', 'activated': '0001-01-01T00:00:00Z', 'allRead': False,
                                       'allReadWrite': False,
                                       'attachment': None, 'autime': 1601727064144482161, 'canvases': None,
                                       'category': '',
                                       'closeNotes': '', 'closeReason': '', 'closed': '0001-01-01T00:00:00Z',
                                       'closingUserId': '',
                                       'created': '2020-10-03T12:11:04.144482161Z', 'dbotCreatedBy': 'admin',
                                       'dbotCurrentDirtyFields': None, 'dbotDirtyFields': None,
                                       'dbotMirrorDirection': '',
                                       'dbotMirrorId': '', 'dbotMirrorInstance': '',
                                       'dbotMirrorLastSync': '0001-01-01T00:00:00Z',
                                       'dbotMirrorTags': None, 'details': '', 'droppedCount': 0,
                                       'dueDate': '0001-01-01T00:00:00Z',
                                       'feedBased': False, 'hasRole': False, 'id': '51', 'investigationId': '51',
                                       'isPlayground': False,
                                       'labels': [{'type': 'Instance', 'value': 'admin'},
                                                  {'type': 'Brand', 'value': 'Manual'}],
                                       'lastJobRunTime': '0001-01-01T00:00:00Z', 'lastOpen': '0001-01-01T00:00:00Z',
                                       'linkedCount': 0,
                                       'linkedIncidents': None, 'modified': '2020-10-03T13:44:07.136165794Z',
                                       'name': 'for ut',
                                       'notifyTime': '2020-10-03T12:11:14.727373393Z',
                                       'occurred': '2020-10-03T12:11:04.144481967Z',
                                       'openDuration': 0, 'owner': 'admin', 'parent': '', 'phase': '',
                                       'playbookId': 'JOB - Integrations and Playbooks Health Check',
                                       'previousAllRead': False,
                                       'previousAllReadWrite': False, 'previousRoles': None, 'rawCategory': '',
                                       'rawCloseReason': '',
                                       'rawJSON': '', 'rawName': 'for ut', 'rawPhase': '',
                                       'rawType': 'Integrations and Incidents Health Check', 'reason': '',
                                       'reminder': '0001-01-01T00:00:00Z', 'roles': None, 'runStatus': 'waiting',
                                       'severity': 0, 'sla': 0,
                                       'sortValues': None, 'sourceBrand': 'Manual', 'sourceInstance': 'admin',
                                       'status': 1,
                                       'type': 'Integrations and Incidents Health Check', 'version': 21}]

INCIDENT_RESULT_NO_FAILED_COMMANDS_EXPECTED = {'params': {'layout': 'vertical'},
                                               'stats': [{'color': 'rgb(255, 23, 68)',
                                                          'data': [0],
                                                          'groups': None,
                                                          'label': 'N/A',
                                                          'name': 'N/A'}]}

INCIDENT_RESULT = [{'CustomFields': {'dbotpredictionprobability': 0,
                                     'detectionsla': {'accumulatedPause': 0,
                                                      'breachTriggered': False,
                                                      'dueDate': '0001-01-01T00:00:00Z',
                                                      'endDate': '0001-01-01T00:00:00Z',
                                                      'lastPauseDate': '0001-01-01T00:00:00Z',
                                                      'runStatus': 'idle', 'sla': 20,
                                                      'slaStatus': -1,
                                                      'startDate': '0001-01-01T00:00:00Z',
                                                      'totalDuration': 0},
                                     'integrationscategories': ['Endpoint', 'Utilities', 'Utilities',
                                                                'Utilities', 'Utilities', 'Endpoint',
                                                                'Messaging',
                                                                'Data Enrichment & Threat Intelligence'],
                                     'integrationsfailedcategories': [
                                         'Data Enrichment & Threat Intelligence',
                                         'Vulnerability Management', 'Endpoint',
                                         'Forensics & Malware Analysis',
                                         'Data Enrichment & Threat Intelligence', 'Endpoint'],
                                     'integrationstestgrid': [{
                                         'analystnote': '(2020-09-30) (2020-09-30) Need to get the new password',
                                         'brand': 'Active Directory Query v2',
                                         'category': 'Data Enrichment & Threat Intelligence',
                                         'information': 'Failed to access LDAP server. Please validate the server '
                                                        'host and port are configured correctly (85)',
                                         'instance': 'Active Directory Query v2_instance_1'},
                                         {'brand': 'BigFix',
                                          'category': 'Vulnerability Management',
                                          'information': "Invalid URL '\\xd7\\x91\\xd7\\x94\\xd7\\xa0/api/help': "
                                                         "No schema supplied. Perhaps you meant http://בהנ/api/help? "
                                                         "(85)",
                                          'instance': 'BigFix_instance_1'},
                                         {'brand': 'Tanium Threat Response',
                                          'category': 'Endpoint',
                                          'information': "Error in Tanium Threat Response Integration: Invalid URL "
                                                         "'sfgdfg/api/v2/session/login': No schema supplied. Perhaps "
                                                         "you meant http://sfgdfg/api/v2/session/login? (85)",
                                          'instance': 'Tanium Threat Response_instance_1'},
                                         {'brand': 'Threat Grid',
                                          'category': 'Forensics & Malware Analysis',
                                          'information': 'Error in API call to Threat Grid service api/v3/session/'
                                                         'whoami - {"api_version":3,"id":2907192,"error":{"message":'
                                                         '"Unauthorized","code":401,"errors":[{"code":401,"message":'
                                                         '"Unauthorized","help":"/doc/main/index.html","report":'
                                                         '"support@threatgrid.com"}]}} (85)',
                                          'instance': 'Threat Grid_instance_1'},
                                         {
                                             'analystnote': '(2020-09-30) (2020-09-30) Creating a new API key',
                                             'brand': 'VirusTotal',
                                             'category': 'Data Enrichment & Threat Intelligence',
                                             'information': '403 Forbidden - The API key is not valid (85)',
                                             'instance': 'VirusTotal_instance_1'},
                                         {'brand': 'remoteaccess',
                                          'category': 'Endpoint',
                                          'information': 'ssh: handshake failed: ssh: unable to authenticate, '
                                                         'attempted methods [none], no supported methods remain',
                                          'instance': 'remoteaccess_instance_1'}],
                                     'numberofentriesiderrors': 8, 'numberoffailedincidents': 4,
                                     'playbooknameswithfailedtasks': ['AutoFocusPolling',
                                                                      'JOB - Integrations and Playbooks Health Check',
                                                                      'JOB - Integrations and Playbooks Health Check',
                                                                      'Account Enrichment - Generic v2.1'],
                                     'playbooksfailedcommands': ['RunPollingCommand', 'SetGridField',
                                                                 'SetGridField', 'ad-get-user'],
                                     'playbooktaskserrors': [
                                         {'analystnote': '(2020-09-30) (2020-09-30) John checking',
                                          'commandname': 'RunPollingCommand',
                                          'creationdate': '2020-09-29 16:48:30.261438285Z',
                                          'incidentid': '7', 'numberoferrors': 2, 'owner': '',
                                          'playbookname': 'AutoFocusPolling', 'task_id': None,
                                          'taskid': '3', 'taskname': 'RunPollingCommand'},
                                         {'commandname': 'SetGridField',
                                          'creationdate': '2020-09-29 14:02:45.82647067Z',
                                          'incidentid': '3', 'numberoferrors': 2, 'owner': 'admin',
                                          'playbookname': 'JOB - Integrations and Playbooks Health Check',
                                          'task_id': None, 'taskid': '132',
                                          'taskname': 'Creates failed Integrations grid'},
                                         {'commandname': 'SetGridField',
                                          'creationdate': '2020-09-29 14:02:45.82647067Z',
                                          'incidentid': '3', 'numberoferrors': 2, 'owner': 'admin',
                                          'playbookname': 'JOB - Integrations and Playbooks Health Check',
                                          'task_id': None, 'taskid': '131',
                                          'taskname': 'Set empty fields to incident grid'}, {
                                             'analystnote': '(2020-09-30) (2020-09-30) Need to fix integration',
                                             'commandname': 'ad-get-user',
                                             'creationdate': '2020-09-30 15:44:06.930751906Z',
                                             'incidentid': '48', 'numberoferrors': 2,
                                             'owner': 'admin',
                                             'playbookname': 'Account Enrichment - Generic v2.1',
                                             'task_id': None, 'taskid': '5',
                                             'taskname': 'Get account info from Active Directory'}],
                                     'remediationsla': {'accumulatedPause': 0,
                                                        'breachTriggered': False,
                                                        'dueDate': '0001-01-01T00:00:00Z',
                                                        'endDate': '0001-01-01T00:00:00Z',
                                                        'lastPauseDate': '0001-01-01T00:00:00Z',
                                                        'runStatus': 'idle', 'sla': 7200,
                                                        'slaStatus': -1,
                                                        'startDate': '0001-01-01T00:00:00Z',
                                                        'totalDuration': 0},
                                     'similarincident': ['50'],
                                     'timetoassignment': {'accumulatedPause': 0,
                                                          'breachTriggered': False,
                                                          'dueDate': '0001-01-01T00:00:00Z',
                                                          'endDate': '0001-01-01T00:00:00Z',
                                                          'lastPauseDate': '0001-01-01T00:00:00Z',
                                                          'runStatus': 'idle', 'sla': 0,
                                                          'slaStatus': -1,
                                                          'startDate': '0001-01-01T00:00:00Z',
                                                          'totalDuration': 0},
                                     'totalfailedinstances': 6, 'totalgoodinstances': 8,
                                     'totalinstances': 14, 'unassignedincidents': ['7'],
                                     'urlsslverification': []}, 'ShardID': 0, 'account': '',
                    'activated': '0001-01-01T00:00:00Z', 'allRead': False, 'allReadWrite': False,
                    'attachment': None, 'autime': 1601727064144482161, 'canvases': None,
                    'category': '', 'closeNotes': '', 'closeReason': '',
                    'closed': '0001-01-01T00:00:00Z', 'closingUserId': '',
                    'created': '2020-10-03T12:11:04.144482161Z', 'dbotCreatedBy': 'admin',
                    'dbotCurrentDirtyFields': None, 'dbotDirtyFields': None,
                    'dbotMirrorDirection': '', 'dbotMirrorId': '', 'dbotMirrorInstance': '',
                    'dbotMirrorLastSync': '0001-01-01T00:00:00Z', 'dbotMirrorTags': None,
                    'details': '', 'droppedCount': 0, 'dueDate': '0001-01-01T00:00:00Z',
                    'feedBased': False, 'hasRole': False, 'id': '51', 'investigationId': '51',
                    'isPlayground': False, 'labels': [{'type': 'Instance', 'value': 'admin'},
                                                      {'type': 'Brand', 'value': 'Manual'}],
                    'lastJobRunTime': '0001-01-01T00:00:00Z', 'lastOpen': '0001-01-01T00:00:00Z',
                    'linkedCount': 0, 'linkedIncidents': None,
                    'modified': '2020-10-03T13:44:07.136165794Z', 'name': 'for ut',
                    'notifyTime': '2020-10-03T12:11:14.727373393Z',
                    'occurred': '2020-10-03T12:11:04.144481967Z', 'openDuration': 0,
                    'owner': 'admin', 'parent': '', 'phase': '',
                    'playbookId': 'JOB - Integrations and Playbooks Health Check',
                    'previousAllRead': False, 'previousAllReadWrite': False, 'previousRoles': None,
                    'rawCategory': '', 'rawCloseReason': '', 'rawJSON': '', 'rawName': 'for ut',
                    'rawPhase': '', 'rawType': 'Integrations and Incidents Health Check',
                    'reason': '', 'reminder': '0001-01-01T00:00:00Z', 'roles': None,
                    'runStatus': 'waiting', 'severity': 0, 'sla': 0, 'sortValues': None,
                    'sourceBrand': 'Manual', 'sourceInstance': 'admin', 'status': 1,
                    'type': 'Integrations and Incidents Health Check', 'version': 21}]

INCIDENT_RESULT_EXPECTED = {'params': {'layout': 'vertical'},
                            'stats': [{'color': '#0003e8',
                                       'data': [2],
                                       'groups': None,
                                       'label': 'SetGridField',
                                       'name': 'SetGridField'},
                                      {'color': '#0003e8',
                                       'data': [1],
                                       'groups': None,
                                       'label': 'RunPollingCommand',
                                       'name': 'RunPollingCommand'},
                                      {'color': '#0003e8',
                                       'data': [1],
                                       'groups': None,
                                       'label': 'ad-get-user',
                                       'name': 'ad-get-user'}]}
