category: IT Services
commonfields:
  id: AWS Security Lake
  version: -1
configuration:
  - name: name
    display: Name
    required: true
    defaultvalue: null
    type: 0
    additionalinfo: null
  - name: roleArn
    display: Role Arn
    required: false
    defaultvalue: null
    type: 0
    additionalinfo: null
  - name: roleSessionName
    display: Role Session Name
    required: false
    defaultvalue: null
    type: 0
    additionalinfo: null
  - name: sessionDuration
    display: Role Session Duration
    required: false
    defaultvalue: null
    type: 0
    additionalinfo: null
  - name: defaultRegion
    display: AWS Default Region
    required: false
    defaultvalue: null
    type: 15
    additionalinfo: null
    options:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - ca-central-1
      - eu-west-1
      - eu-central-1
      - eu-west-2
      - ap-northeast-1
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-south-1
      - sa-east-1
      - eu-north-1
      - eu-west-3
      - us-gov-east-1
      - us-gov-west-1
  - name: credentials
    display: Access Key
    required: false
    defaultvalue: null
    type: 9
    additionalinfo: null
    displaypassword: Secret Key
    hiddenusername: false
  - name: timeout
    display: Timeout
    required: false
    defaultvalue: 60,10
    type: 0
    additionalinfo: The time in seconds until a timeout exception is reached. You
      can specify just the read timeout (for example 60) or also the connect
      timeout followed after a comma (for example 60,10). If a connect timeout
      is not specified, a default of 10 second will be used.
  - name: retries
    display: Retries
    required: false
    defaultvalue: 5
    type: 0
    additionalinfo: "The maximum number of retry attempts when connection or
      throttling errors are encountered. Set to 0 to disable retries. The
      default value is 5 and the limit is 10. Note: Increasing the number of
      retries will increase the execution time."
  - name: insecure
    display: Trust any certificate (not secure)
    required: false
    defaultvalue: "true"
    type: 8
    additionalinfo: null
  - name: proxy
    display: Use system proxy settings
    required: false
    defaultvalue: "true"
    type: 8
    additionalinfo: null
description: "[Enter a comprehensive, yet concise, description of what the
  integration does, what use cases it is designed for, etc.]"
display: AWS-SecurityLake
name: AWS Security Lake
script:
  commands:
    - name: aws-security-lake-query-execute
      arguments:
        - name: query_string
          description: The SQL query statements to be executed.
          required: true
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: query_limit
          description: A limit (number) to use for the query. If the keyword 'LIMIT'
            exists within 'QueryString', this parameter will be ignored.
          required: false
          isArray: false
          defaultValue: "50"
          predefined:
            - ""
        - name: client_request_token
          description: A unique case-sensitive string used to ensure the request to create
            the query is idempotent (executes only once). If another
            StartQueryExecution request is received, the same response is
            returned and another query is not created.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: database
          description: The name of the database.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: output_location
          description: The location in Amazon S3 where your query results are stored, such
            as s3://path/to/query/bucket/.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: encryption_option
          description: Indicates whether Amazon S3 server-side encryption with Amazon
            S3-managed keys (SSE-S3 ), server-side encryption with KMS-managed
            keys (SSE-KMS ), or client-side encryption with KMS-managed keys
            (CSE-KMS) is used.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: kms_key
          description: For SSE-KMS and CSE-KMS , this is the KMS key ARN or ID.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: work_group
          description: The name of the workgroup in which the query is being started.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: roleArn
          description: The Amazon Resource Name (ARN) of the role to assume.
        - name: roleSessionName
          description: An identifier for the assumed role session.
        - name: roleSessionDuration
          description: The duration, in seconds, of the role session. The value can range
            from 900 seconds (15 minutes) up to the maximum session duration
            setting for the role.
        - name: region
          description: The AWS Region, if not specified the default region will be used.
        - name: QueryExecutionId
          hidden: true
          description: ID of the newly created query. Used internally for polling.
        - name: hide_polling_output
          hidden: true
          description: ""
      description: Execute a new query, wait for the query to complete (using
        polling), and return query's execution information, and query's results
        (if successful). Either 'OutputLocation' or 'WorkGroup' must be
        specified for the query to run.
      polling: true
      outputs:
        - contextPath: AWS.Athena.Query.QueryExecutionId
          description: The unique identifier for each query execution.
          type: String
        - contextPath: AWS.Athena.Query.Query
          description: The SQL query statements which the query execution ran.
          type: String
        - contextPath: AWS.Athena.Query.StatementType
          description: The type of query statement that was run.
          type: String
        - contextPath: AWS.Athena.Query.ResultConfiguration.OutputLocation
          description: The location in Amazon S3 where your query and calculation results
            are stored, such as 's3://path/to/query/bucket/'.
          type: String
        - contextPath: AWS.Athena.Query.ResultConfiguration.EncryptionConfiguration.EncryptionOption
          description: If query and calculation results are encrypted in Amazon S3,
            indicates the encryption option used (for example, SSE_KMS or
            CSE_KMS) and key information.
          type: String
        - contextPath: AWS.Athena.Query.ResultConfiguration.EncryptionConfiguration.KmsKey
          description: For SSE_KMS and CSE_KMS, this is the KMS key ARN or ID.
          type: String
        - contextPath: AWS.Athena.Query.ResultConfiguration.ExpectedBucketOwner
          description: The Amazon Web Services account ID that you expect to be the owner
            of the Amazon S3 bucket specified by
            ResultConfiguration.OutputLocation.
          type: String
        - contextPath: AWS.Athena.Query.ResultConfiguration.AclConfiguration.S3AclOption
          description: The Amazon S3 canned ACL that Athena should specify when storing
            query results.
          type: String
        - contextPath: AWS.Athena.Query.ResultReuseConfiguration.ResultReuseByAgeConfiguration.Enabled
          description: True if previous query results can be reused when the query is run;
            otherwise, false. The default is false.
          type: Boolean
        - contextPath: AWS.Athena.Query.ResultReuseConfiguration.ResultReuseByAgeConfiguration.MaxAgeInMinutes
          description: Specifies, in minutes, the maximum age of a previous query result
            that Athena should consider for reuse. The default is 60.
          type: Number
        - contextPath: AWS.Athena.Query.QueryExecutionContext.Database
          description: The name of the database used in the query execution.
          type: String
        - contextPath: AWS.Athena.Query.QueryExecutionContext.Catalog
          description: The name of the data catalog used in the query execution.
          type: String
        - contextPath: AWS.Athena.Query.Status.State
          description: The state of query execution.
          type: String
        - contextPath: AWS.Athena.Query.Status.StateChangeReason
          description: Further detail about the status of the query.
          type: String
        - contextPath: AWS.Athena.Query.Status.SubmissionDateTime
          description: The date and time that the query was submitted.
          type: String
        - contextPath: AWS.Athena.Query.Status.CompletionDateTime
          description: The date and time that the query completed.
          type: String
        - contextPath: AWS.Athena.Query.Status.AthenaError.ErrorCategory
          description: An integer value that specifies the category of a query failure
            error.
          type: Number
        - contextPath: AWS.Athena.Query.Status.AthenaError.ErrorType
          description: An integer value that provides specific information about an Athena
            query error. For the meaning of specific values, see the Error Type
            Reference in the Amazon Athena User Guide.
          type: Number
        - contextPath: AWS.Athena.Query.Status.AthenaError.Retryable
          description: True if the query might succeed if resubmitted.
          type: Boolean
        - contextPath: AWS.Athena.Query.Status.AthenaError.ErrorMessage
          description: Contains a short description of the error that occurred.
          type: String
        - contextPath: AWS.Athena.Query.Statistics.EngineExecutionTimeInMillis
          description: The number of milliseconds that the query took to execute.
          type: Number
        - contextPath: AWS.Athena.Query.Statistics.DataScannedInBytes
          description: The number of bytes in the data that was queried.
          type: Number
        - contextPath: AWS.Athena.Query.Statistics.DataManifestLocation
          description: The location and file name of a data manifest file. The manifest
            file is saved to the Athena query results location in Amazon S3.
          type: String
        - contextPath: AWS.Athena.Query.Statistics.TotalExecutionTimeInMillis
          description: The number of milliseconds that Athena took to run the query.
          type: Number
        - contextPath: AWS.Athena.Query.Statistics.QueryQueueTimeInMillis
          description: The number of milliseconds that the query was in your query queue
            waiting for resources.
          type: Number
        - contextPath: AWS.Athena.Query.Statistics.ServicePreProcessingTimeInMillis
          description: The number of milliseconds that Athena took to preprocess the query
            before submitting the query to the query engine.
          type: Number
        - contextPath: AWS.Athena.Query.Statistics.QueryPlanningTimeInMillis
          description: The number of milliseconds that Athena took to plan the query
            processing flow. This includes the time spent retrieving table
            partitions from the data source.
          type: Number
        - contextPath: AWS.Athena.Query.Statistics.ServiceProcessingTimeInMillis
          description: The number of milliseconds that Athena took to finalize and publish
            the query results after the query engine finished running the query.
          type: Number
        - contextPath: AWS.Athena.Query.ResultReuseInformation.ReusedPreviousResult
          description: True if a previous query result was reused; false if the result was
            generated from a new run of the query.
          type: Boolean
        - contextPath: AWS.Athena.Query.WorkGroup
          description: The name of the workgroup in which the query ran.
          type: String
        - contextPath: AWS.Athena.Query.EngineVersion.SelectedEngineVersion
          description: The engine version requested by the user. Possible values are
            determined by the output of ListEngineVersions, including AUTO.
          type: String
        - contextPath: AWS.Athena.Query.EngineVersion.EffectiveEngineVersion
          description: The engine version on which the query runs.
          type: String
        - contextPath: AWS.Athena.Query.ExecutionParameters
          description: A list of values for the parameters in a query. The values are
            applied sequentially to the parameters in the query in the order in
            which the parameters occur. The list of parameters is not returned
            in the response.
          type: List
        - contextPath: AWS.Athena.Query.SubstatementType
          description: The kind of query statement that was run.
          type: String
        - contextPath: AWS.Athena.QueryResults
          description: List of query results.
          type: List
    - name: aws-security-lake-data-catalogs-list
      description: Lists the data catalogs in the current Amazon Web Services account.
      deprecated: false
      arguments:
        - name: work_group
          description: The name of the workgroup. Required if making an IAM Identity
            Center request.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: region
          description: The AWS Region, if not specified the default region will be used.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: roleArn
          description: The Amazon Resource Name (ARN) of the role to assume.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: roleSessionName
          description: An identifier for the assumed role session.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: roleSessionDuration
          description: The duration, in seconds, of the role session. The value can range
            from 900 seconds (15 minutes) up to the maximum session duration
            setting for the role.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: limit
          description: Specifies the maximum number of data catalogs to return.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: next_token
          description: Specifies the maximum number of data catalogs to return.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
      outputs: []
    - name: aws-security-lake-databases-list
      description: Lists the databases in the specified data catalog.
      deprecated: false
      arguments:
        - name: catalog_name
          description: The name of the data catalog that contains the databases to return.
          required: true
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: work_group
          description: The name of the workgroup for which the metadata is being fetched.
            Required if requesting an IAM Identity Center enabled Glue Data
            Catalog.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: region
          description: The AWS Region, if not specified the default region will be used.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: roleArn
          description: The Amazon Resource Name (ARN) of the role to assume.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: roleSessionName
          description: An identifier for the assumed role session.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: roleSessionDuration
          description: The duration, in seconds, of the role session. The value can range
            from 900 seconds (15 minutes) up to the maximum session duration
            setting for the role.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: limit
          description: Specifies the maximum number of results to return.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: next_token
          description: A token generated by the Athena service that specifies where to
            continue pagination if a previous request was truncated. To obtain
            the next set of pages, pass in the NextToken from the response
            object of the previous page call.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
      outputs: []
    - name: aws-security-lake-table-metadata-list
      description: Lists the metadata for the tables in the specified data catalog database.
      deprecated: false
      arguments:
        - name: catalog_name
          description: The name of the data catalog that contains the databases to return.
          required: true
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: database_name
          description: The name of the database for which table metadata should be returned.
          required: true
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: expression
          description: A regex filter that pattern-matches table names. If no expression
            is supplied, metadata for all tables are listed.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: roleArn
          description: The Amazon Resource Name (ARN) of the role to assume.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: roleSessionName
          description: An identifier for the assumed role session.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: roleSessionDuration
          description: The duration, in seconds, of the role session. The value can range
            from 900 seconds (15 minutes) up to the maximum session duration
            setting for the role.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: limit
          description: Specifies the maximum number of results to return.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: next_token
          description: A token generated by the Athena service that specifies where to
            continue pagination if a previous request was truncated. To obtain
            the next set of pages, pass in the NextToken from the response
            object of the previous page call.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: work_group
          description: The name of the workgroup for which the metadata is being fetched.
            Required if requesting an IAM Identity Center enabled Glue Data
            Catalog.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
      outputs: []
    - name: aws-security-lake-user-mfalogin-query
      description: Runs query that takes a provided username and queries the AWS
        Security Lake for MFA login attempts (Success/Failed) associated with
        the user's account, using AWS CloudTrail logs.
      deprecated: false
      arguments:
        - name: database
          description: The Database to run the query against.
          required: true
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: table
          description: The Table to run the query against.
          required: true
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: user_name
          description: The username to search for MFA login attempts.
          required: true
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: output_location
          description: The location in Amazon S3 where your query results are stored, such
            as s3://path/to/query/bucket/.
          required: true
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: roleArn
          description: The Amazon Resource Name (ARN) of the role to assume.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: roleSessionName
          description: An identifier for the assumed role session.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: roleSessionDuration
          description: The duration, in seconds, of the role session. The value can range
            from 900 seconds (15 minutes) up to the maximum session duration
            setting for the role.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: region
          description: The AWS Region, if not specified the default region will be used.
        - name: query_limit
          description: A limit (number) to use for the query. If the keyword 'LIMIT'
            exists within 'QueryString', this parameter will be ignored.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
      outputs: []
    - name: aws-security-lake-source-ip-query
      description: Runs query takes a provided Source IP Address and queries the AWS
        Security Lake for Console login attempts (Success/Failed) associated
        with the IP Address, using AWS CloudTrail logs.
      deprecated: false
      arguments:
        - name: database
          description: The Database to run the query against.
          required: true
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: table
          description: The Table to run the query against.
          required: true
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: ip_src
          description: The source IP Address to search for console login attempts.
          required: true
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: output_location
          description: The location in Amazon S3 where your query results are stored, such
            as s3://path/to/query/bucket/.
          required: true
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: roleArn
          description: The Amazon Resource Name (ARN) of the role to assume.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: roleSessionName
          description: An identifier for the assumed role session.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: roleSessionDuration
          description: The duration, in seconds, of the role session. The value can range
            from 900 seconds (15 minutes) up to the maximum session duration
            setting for the role.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: region
          description: The AWS Region, if not specified the default region will be used.
        - name: query_limit
          description: A limit (number) to use for the query. If the keyword 'LIMIT'
            exists within 'QueryString', this parameter will be ignored.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
      outputs: []
    - name: aws-security-lake-guardduty-activity-query
      description: This command is used to search for Guard Duty logs for any
        criticality level activity.
      deprecated: false
      arguments:
        - name: database
          description: The Database to run the query against.
          required: true
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: table
          description: The Table to run the query against.
          required: true
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: severity
          description: The severity of searchingto search related events for
          required: true
          isArray: false
          defaultValue: ""
          predefined:
            - 0-Unknown
            - 1-Informational
            - 2-Low
            - 3-Medium
            - 4-High
            - 5-Critical
            - 6-Fatal
            - 99-Other
        - name: output_location
          description: The location in Amazon S3 where your query results are stored, such
            as s3://path/to/query/bucket/.
          required: true
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: roleArn
          description: The Amazon Resource Name (ARN) of the role to assume.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: roleSessionName
          description: An identifier for the assumed role session.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: roleSessionDuration
          description: The duration, in seconds, of the role session. The value can range
            from 900 seconds (15 minutes) up to the maximum session duration
            setting for the role.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: region
          description: The AWS Region, if not specified the default region will be used.
        - name: query_limit
          description: A limit (number) to use for the query. If the keyword 'LIMIT'
            exists within 'QueryString', this parameter will be ignored.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
      outputs: []
    - name: aws-security-lake-data-sources-list
      description: Retrieves a snapshot of the current Region, including whether Amazon Security Lake is enabled for those accounts and which sources Security Lake is collecting data from.
      deprecated: false
      arguments:
        - name: accounts
          description: The Amazon Web Services account ID for which a static snapshot of the current Amazon Web Services Region, including enabled accounts and log sources, is retrieved.
          required: false
          isArray: true
          defaultValue: ""
          predefined:
            - ""
        - name: limit
          description: Specifies the maximum number of results to return.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: next_token
          description: Lists if there are more results available. The value of nextToken is a unique pagination token for each page. Repeat the call using the returned token to retrieve the next page. Keep all other arguments unchanged.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: roleArn
          description: The Amazon Resource Name (ARN) of the role to assume.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: roleSessionName
          description: An identifier for the assumed role session.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: roleSessionDuration
          description: The duration, in seconds, of the role session. The value can range
            from 900 seconds (15 minutes) up to the maximum session duration
            setting for the role.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: region
          description: The AWS Region, if not specified the default region will be used.
        - name: query_limit
          description: A limit (number) to use for the query. If the keyword 'LIMIT'
            exists within 'QueryString', this parameter will be ignored.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
      outputs: []
    - name: aws-security-lake-data-lakes-list
      description: Retrieves the Amazon Security Lake configuration object for the specified Amazon Web Services Regions.
      deprecated: false
      arguments:
        - name: regions
          description: The list of regions where Security Lake is enabled.
          required: false
          isArray: true
          defaultValue: ""
          predefined:
            - ""
        - name: roleArn
          description: The Amazon Resource Name (ARN) of the role to assume.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: roleSessionName
          description: An identifier for the assumed role session.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: roleSessionDuration
          description: The duration, in seconds, of the role session. The value can range
            from 900 seconds (15 minutes) up to the maximum session duration
            setting for the role.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: region
          description: The AWS Region, if not specified the default region will be used.
        - name: query_limit
          description: A limit (number) to use for the query. If the keyword 'LIMIT'
            exists within 'QueryString', this parameter will be ignored.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
      outputs: []
    
  runonce: false
  script: "-"
  type: python
  subtype: python3
  dockerimage: demisto/boto3py3:1.0.0.83094
  feed: false
  isfetch: false
fromversion: 5.5.0
tests:
  - No tests (auto formatted)
