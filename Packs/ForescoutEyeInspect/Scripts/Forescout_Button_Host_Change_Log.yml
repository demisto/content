commonfields:
  id: Forescout_Button_Host_Change_Log
  version: -1
name: Forescout_Button_Host_Change_Log
script: |-
  hoursago='24'
  currenttime=demisto.incident()['occurred']

  def convertotime():
      converttime = demisto.executeCommand('GetTime', {'date': currenttime, 'dateFormat': 'ISO', 'hoursAgo': hoursago})[0]['Contents']
      date_time_obj = datetime.strptime(converttime, '%Y-%m-%dT%H:%M:%S.%fZ')
      return converttime

  try:
      res = demisto.executeCommand('forescout-ei-hosts-changelog-list', {'start_timestamp': convertotime()})
      demisto.results(res)
  except Exception as e:
      return_error(str(e))
type: python
tags:
  - incident-action-button
enabled: true
scripttarget: 0
subtype: python3
runonce: false
dockerimage: demisto/python3:3.10.1.27636
runas: DBotWeakRole
fromversion: 6.1.0
tests:
  - No tests (auto formatted)
