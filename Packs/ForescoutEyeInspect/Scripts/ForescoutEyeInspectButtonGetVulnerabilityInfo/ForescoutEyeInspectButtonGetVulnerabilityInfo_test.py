from pytest_mock.plugin import MockerFixture

import demistomock as demisto
from ForescoutEyeInspectButtonGetVulnerabilityInfo import get_cve


def test_get_cve(mocker: MockerFixture):
    cve_id = 'CVE-2020-0305'
    mock_cve = {
        'id': cve_id,
        'cve_id': cve_id,
        'icsa_id': '',
        'vendor_specific_id': 'SSB-439005',
        'published_date': '2018-11-27T01:00:00.000+01:00'
    }

    mocker.patch.object(demisto, 'args', return_value={'cve_id': cve_id})
    mocker.patch.object(demisto, 'executeCommand', return_value=mock_cve)

    assert get_cve()['cve_id'] == cve_id
