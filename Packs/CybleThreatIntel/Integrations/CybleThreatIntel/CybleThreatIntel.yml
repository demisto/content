commonfields:
  id: CybleThreatIntel
  version: -1

name: CybleThreatIntel
display: Cyble Threat Intel
category: Data Enrichment & Threat Intelligence

description: >
  Cyble Threat Intelligence integration for Vision Users.
  Provides IOC lookup and an IOC feed from the Cyble Vision API.

configuration:
  - display: Base URL
    name: base_url
    type: 0
    required: true
    section: Connect

  - displaypassword: Access Token
    name: access_token
    required: true
    hiddenusername: true
    type: 9
    section: Connect

  - display: First Fetch Time (hours)
    name: first_fetch
    type: 0
    required: true
    defaultvalue: 1
    additionalinfo: "How many hours back to fetch IOCs on first run. Max 3 hours."
    section: Collect

  - display: Maximum Indicators Per Fetch
    name: max_fetch
    type: 0
    required: true
    defaultvalue: '100'
    additionalinfo: Maximum number of indicators to fetch per execution.
    section: Collect

script:
  type: python
  subtype: python3
  script: '-'
  dockerimage: demisto/python3.12.12.5490952
  feed: true         # ‚Üê REQUIRED for feed integrations
  runonce: false
  ismappable: true

  commands:
    - name: cyble-vision-ioc-lookup
      description: Lookup a single IOC using the Cyble Vision API
      arguments:
        - name: ioc
          required: true
          description: IOC value
      outputs:
        - contextPath: CybleIntel.IOCLookup
          description: IOC lookup response
          type: String

fromversion: 6.2.0

tests:
  - No tests (auto formatted)

sectionorder:
  - Connect
  - Collect
