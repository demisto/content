commonfields:
  id: CybleThreatIntel
  version: -1

name: CybleThreatIntel
display: Cyble Threat Intel
category: Data Enrichment & Threat Intelligence

description: >
  Cyble Threat Intelligence integration for Vision Users.
  Provides IOC lookup and an IOC feed from the Cyble Vision API.

configuration:
  - display: Base URL
    name: base_url
    type: 0
    required: true
    section: Connect

  - displaypassword: Access Token
    name: access_token
    required: true
    hiddenusername: true
    type: 9
    section: Connect

  - display: First Fetch Time (hours)
    name: first_fetch
    type: 0
    required: true
    defaultvalue: 1
    additionalinfo: "How many hours back to fetch IOCs on first run. Max 3 hours."
    section: Collect

  - display: Maximum Indicators Per Fetch
    name: max_fetch
    type: 0
    required: true
    defaultvalue: '100'
    additionalinfo: Maximum number of indicators to fetch per execution.
    section: Collect

  # --------------------------
  # Deprecated legacy params
  # --------------------------
  - display: Traffic Light Protocol Color
    name: tlp_color
    type: 15
    required: false
    options:
      - RED
      - AMBER
      - GREEN
      - WHITE
    deprecated: true
    hidden: true

  - display: Feed Fetch Interval
    name: feedFetchInterval
    type: 19
    defaultvalue: "1440"
    required: false
    deprecated: true
    hidden: true

  - display: Discovery Service
    name: discovery_service
    type: 0
    required: false
    additionalinfo: Collection name to fetch indicators from.
    deprecated: true
    hidden: true

  - display: Username
    name: credentials
    type: 9
    required: false
    deprecated: true
    hidden: true

  - display: Trust any certificate (not secure)
    name: insecure
    type: 8
    defaultvalue: "false"
    required: false
    deprecated: true
    hidden: true

  - display: Use system proxy settings
    name: proxy
    type: 8
    defaultvalue: "false"
    required: false
    deprecated: true
    hidden: true

  - display: First fetch time (by days)
    name: initial_interval
    type: 0
    defaultvalue: "1"
    required: false
    additionalinfo: Time interval for first fetch (retroactive), by days only. Maximum of 7 days is allowed.
    deprecated: true
    hidden: true

  - display: Fetch indicators
    name: feed
    type: 8
    defaultvalue: "true"
    required: false
    deprecated: true
    hidden: true

  - display: Indicator Reputation
    name: feedReputation
    type: 18
    defaultvalue: None
    options:
      - None
      - Good
      - Suspicious
      - Bad
    required: false
    deprecated: true
    hidden: true

  - display: Source Reliability
    name: feedReliability
    type: 15
    options:
      - A - Completely reliable
      - B - Usually reliable
      - C - Fairly reliable
      - D - Not usually reliable
      - E - Unreliable
      - F - Reliability cannot be judged
    defaultvalue: A - Completely reliable
    required: false
    deprecated: true
    hidden: true

  - display: Indicator Fetch Limit
    name: limit
    type: 0
    required: false
    additionalinfo: Provide value to limit the indicator fetch per iteration
    deprecated: true
    hidden: true

  - display: Collection Name
    name: collection
    type: 0
    required: false
    deprecated: true
    hidden: true

  - display: ''
    name: feedExpirationPolicy
    type: 17
    options:
      - never
      - interval
      - indicatorType
      - suddenDeath
    required: false
    deprecated: true
    hidden: true

  - display: ''
    name: feedExpirationInterval
    type: 1
    required: false
    deprecated: true
    hidden: true

  - display: Bypass exclusion list
    name: feedBypassExclusionList
    type: 8
    required: false
    deprecated: true
    hidden: true

  - display: Tags
    name: feedTags
    type: 0
    required: false
    additionalinfo: Supports CSV values.
    deprecated: true
    hidden: true


script:
  type: python
  subtype: python3
  script: '-'
  dockerimage: demisto/python3:3.12.12.5490952
  feed: true         # ‚Üê REQUIRED for feed integrations
  runonce: false
  ismappable: true

  commands:
    - name: cyble-vision-ioc-lookup
      description: Lookup a single IOC using the Cyble Vision API
      arguments:
        - name: ioc
          required: true
          description: IOC value
      outputs:
        - contextPath: CybleIntel.IOCLookup
          description: IOC lookup response
          type: String

    - name: cyble-vision-fetch-taxii
      deprecated: true
      deprecated_reason: "This TAXII-based fetch command is no longer supported and replaced by API-based fetching."
      description: Deprecated command. Do not use.
      arguments: [ ]
      outputs: [ ]

    - name: cyble-vision-get-collection-names
      deprecated: true
      deprecated_reason: "This TAXII collection command is no longer supported."
      description: Deprecated command. Do not use.
      arguments: [ ]
      outputs: [ ]


fromversion: 6.2.0

tests:
  - No tests (auto formatted)

sectionorder:
  - Connect
  - Collect
