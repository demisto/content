commonfields:
  id: CybleThreatIntel
  version: -1

name: CybleThreatIntel
display: Cyble Threat Intel
category: Data Enrichment & Threat Intelligence
description: >
  Cyble Threat Intelligence integration for Vision Users.
  Provides IOC lookup and an IOC feed from the Cyble Vision API.

configuration:

  # --------------------------
  # Feed Parameters (Cannot be hidden, cannot be deprecated)
  # --------------------------

  - display: Traffic Light Protocol Color
    name: tlp_color
    type: 15
    options:
      - RED
      - AMBER
      - GREEN
      - WHITE
    required: false
    section: Collect


  - display: Source Reliability
    name: feedReliability
    type: 15
    required: true
    defaultvalue: A - Completely reliable
    additionalinfo: Reliability of the source providing the intelligence data.
    options:
      - A - Completely reliable
      - B - Usually reliable
      - C - Fairly reliable
      - D - Not usually reliable
      - E - Unreliable
      - F - Reliability cannot be judged
    section: Collect

  - display: Indicator Reputation
    name: feedReputation
    type: 18
    defaultvalue: None
    options:
      - None
      - Good
      - Suspicious
      - Bad
    required: false
    additionalinfo: Indicators from this integration instance will be marked with this reputation
    section: Collect

  - display: Tags
    name: feedTags
    type: 0
    required: false
    additionalinfo: Supports CSV values.
    section: Collect

  - display: Feed Expiration Policy
    name: feedExpirationPolicy
    type: 17
    options:
      - never
      - interval
      - indicatorType
      - suddenDeath
    required: false
    section: Collect

  - display: Feed Expiration Interval (days)
    name: feedExpirationInterval
    type: 1
    required: false
    section: Collect

  - display: Bypass exclusion list
    name: feedBypassExclusionList
    type: 8
    required: false
    section: Collect

  # --------------------------
  # Main Connect Params
  # --------------------------

  - display: Base URL
    name: base_url
    type: 0
    required: false      # ← Not required for BC compliance
    section: Connect

  - displaypassword: Access Token
    name: access_token
    type: 9
    hiddenusername: true
    required: false      # ← Not required for BC compliance
    section: Connect

  # --------------------------
  # Fetch params
  # --------------------------
  - display: First Fetch Time (hours)
    name: first_fetch
    type: 0
    defaultvalue: 1
    required: true
    additionalinfo: "How many hours back to fetch IOCs on first run. Max 3 hours."
    section: Collect

  - display: Maximum Indicators Per Fetch
    name: max_fetch
    type: 0
    required: true
    defaultvalue: '100'
    additionalinfo: Maximum number of indicators to fetch per execution.
    section: Collect

script:
  type: python
  subtype: python3
  script: "-"
  dockerimage: demisto/python3:3.12.12.5490952
  feed: true
  runonce: false
  ismappable: true

  commands:

    - name: cyble-vision-ioc-lookup
      description: Lookup a single IOC using the Cyble Vision API.
      arguments:
        - name: ioc
          required: true
          description: IOC value
      outputs:
        - contextPath: CybleIntel.IOCLookup
          description: IOC lookup response
          type: String

    # --------------------------
    # Deprecated commands — must retain outputs for BC
    # --------------------------
    - name: cyble-vision-fetch-taxii
      deprecated: true
      deprecated_reason: "This TAXII-based fetch command is no longer supported and replaced by API-based fetching."
      description: Deprecated command. Do not use.
      arguments: []
      outputs:
        - contextPath: CybleIntel.Threat.details
          description: Backward compatibility placeholder
          type: String

    - name: cyble-vision-get-collection-names
      deprecated: true
      deprecated_reason: "This TAXII collection command is no longer supported."
      description: Deprecated command. Do not use.
      arguments: []
      outputs:
        - contextPath: CybleIntel.collection.names
          description: Backward compatibility placeholder
          type: String

fromversion: 6.2.0

tests:
  - No tests (auto formatted)

sectionorder:
  - Connect
  - Collect
