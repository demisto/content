description: Detonate a file through OrionMalware
dirtyInputs: true
id: 'Detonate File - OrionMalware'
inputSections:
- description: Generic group for inputs
  inputs:
  - file_entryid
  name: General (Inputs group)
inputs:
- description: File entryID
  key: file_entryid
  playbookInputQuery: null
  required: true
  value:
    simple: ${File.EntryID}
name: Detonate File - OrionMalware
outputSections:
- description: Generic group for outputs
  name: General (Outputs group)
  outputs:
  - Orion.File.antivirus.antivirus_name
  - Orion.File.antivirus.threat_name
  - Orion.File.end_analysis
  - Orion.File.first_submission
  - Orion.File.last_updated
  - Orion.File.payloads
  - Orion.File.rules
  - Orion.File.start_analysis
  - Orion.File.identification.filename
  - Orion.File.identification.md5
  - Orion.File.identification.sha1
  - Orion.File.identification.sha256
  - Orion.File.identification.size
  - Orion.File.identification.type
  - Orion.File.matched_mitre_attacks.description
  - Orion.File.matched_mitre_attacks.id
  - Orion.File.matched_mitre_attacks.kill_chain_phases
  - Orion.File.matched_mitre_attacks.name
  - Orion.File.networks.address
  - Orion.File.risk.dynamic.descriptions.files
  - Orion.File.risk.dynamic.descriptions.network
  - Orion.File.risk.dynamic.descriptions.persistence
  - Orion.File.risk.dynamic.descriptions.processes
  - Orion.File.risk.dynamic.descriptions.system
  - Orion.File.risk.dynamic.scores
  - Orion.File.risk.level
  - Orion.File.risk.scanner.descriptions.system
  - Orion.File.risk.scanner.descriptions.processes
  - Orion.File.risk.scanner.descriptions.persistence
  - Orion.File.risk.scanner.descriptions.files
  - Orion.File.risk.scanner.descriptions.network
  - Orion.File.risk.scanner.scores
  - File.MD5
  - File.SHA1
  - File.SHA256
  - File.Orion.EngineDetections
  - File.Orion.EngineVendors
  - File.Orion.EngineDetectionNames
  - IP.Address
  - Orion.IP.Address
  - File.Relationships.EntityA
  - File.Relationships.EntityB
  - File.Relationships.EntityAType
  - File.Relationships.EntityBType
  - File.Relationships.Relationship
outputs:
- contextPath: Orion.File.antivirus.antivirus_name
  description: antivirus_name analysis
- contextPath: Orion.File.antivirus.threat_name
  description: threat detected by antivirus
- contextPath: Orion.File.end_analysis
  description: end_analysis
- contextPath: Orion.File.first_submission
  description: first_submission
- contextPath: Orion.File.last_updated
  description: last_updated
- contextPath: Orion.File.payloads
  description: payloads
- contextPath: Orion.File.rules
  description: rules
- contextPath: Orion.File.start_analysis
  description: start analysis date
- contextPath: Orion.File.identification.filename
  description: filename of the file corresponding to the hash
- contextPath: Orion.File.identification.md5
  description: md5 hash of the file
- contextPath: Orion.File.identification.sha1
  description: sha1 hash of the file
- contextPath: Orion.File.identification.sha256
  description: sha256 hash of the file
- contextPath: Orion.File.identification.size
  description: Byte size
- contextPath: Orion.File.identification.type
  description: type of file
- contextPath: Orion.File.matched_mitre_attacks.description
  description: mitre description
- contextPath: Orion.File.matched_mitre_attacks.id
  description: mitre ttp
- contextPath: Orion.File.matched_mitre_attacks.kill_chain_phases
  description: mitre tactics
- contextPath: Orion.File.matched_mitre_attacks.name
  description: technique name
- contextPath: Orion.File.networks.address
  description: network address detected
- contextPath: Orion.File.risk.dynamic.descriptions.files
  description: dynmaic file analysis
- contextPath: Orion.File.risk.dynamic.descriptions.network
  description: network dynamic analysis
- contextPath: Orion.File.risk.dynamic.descriptions.persistence
  description: persistence dynamic analysis
- contextPath: Orion.File.risk.dynamic.descriptions.processes
  description: processes dynamic analysis
- contextPath: Orion.File.risk.dynamic.descriptions.system
  description: system dynamic analysis
- contextPath: Orion.File.risk.dynamic.scores
  description: dynamic risk scoring
- contextPath: Orion.File.risk.level
  description: dynamic risk
- contextPath: Orion.File.risk.scanner.descriptions.system
  description: system static analysis
- contextPath: Orion.File.risk.scanner.descriptions.processes
  description: processes static analysis
- contextPath: Orion.File.risk.scanner.descriptions.persistence
  description: persistence static analysis
- contextPath: Orion.File.risk.scanner.descriptions.files
  description: files static analysis
- contextPath: Orion.File.risk.scanner.descriptions.network
  description: network static analysis
- contextPath: Orion.File.risk.scanner.scores
  description: static risk scoring
- contextPath: File.MD5
  description: Bad MD5 hash
- contextPath: File.SHA1
  description: bad SHA1 has h
- contextPath: File.SHA256
  description: bad SHA256 has h
- contextPath: File.Orion.EngineDetections
  description: Number of engines that flagged the file as malicious
- contextPath: File.Orion.EngineVendors
  description: engines
- contextPath: File.Orion.EngineDetectionNames
  description: threat name
- contextPath: IP.Address
  description: IP Linked to hash
- contextPath: Orion.IP.Address
- contextPath: File.Relationships.EntityA
  description: Source of relationship
- contextPath: File.Relationships.EntityB
  description: Destination of relationship
- contextPath: File.Relationships.EntityAType
  description: Source type of relationship
- contextPath: File.Relationships.EntityBType
  description: Destination type of relationship
- contextPath: File.Relationships.Relationship
  description: Kind of relation
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4f6cef1b-982e-4e9d-8c0e-06ea5ff9c4c7
      iscommand: false
      name: ""
      version: -1
    taskid: 4f6cef1b-982e-4e9d-8c0e-06ea5ff9c4c7
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 580,
          "y": 100
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 299c72ee-0126-4c4e-9b9f-abef2ee42953
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 299c72ee-0126-4c4e-9b9f-abef2ee42953
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 500,
          "y": 730
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        complex:
          root: inputs.file_entryid
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: OrionMalware
      description: Detonates the file in Orion Malware
      id: 98ed4aa4-49e6-4be3-a851-e0326a512003
      iscommand: true
      name: Send file to OrionMalware
      script: OrionMalware|||file-scan
      type: regular
      version: -1
    taskid: 98ed4aa4-49e6-4be3-a851-e0326a512003
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 830,
          "y": 570
        }
      }
  "4":
    continueonerrortype: ""
    fieldMapping:
    - incidentfield: Detection URL
      output:
        simple: ${Orion.File.report_url}
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    reputationcalc: 1
    nexttasks:
      "no":
      - "2"
      "yes":
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      brandname:
        simple: OrionMalware
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if integration OrionMalware is available. Returns 'yes' if integration brand is available. Otherwise returns
        'no'.
      id: 03c1ecfb-0927-4274-bba9-020ad4fd33b4
      iscommand: false
      name: IsIntegrationAvailable (OrionMalware)?
      script: IsIntegrationAvailable
      type: condition
      version: -1
    taskid: 03c1ecfb-0927-4274-bba9-020ad4fd33b4
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 580,
          "y": 230
        }
      }
  "5":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.file_entryid
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "3"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if there is a file to detonate
      id: fece293c-00e5-4fbf-86a5-89035ecc6a65
      iscommand: false
      name: Is there a file to detonate?
      type: condition
      version: -1
    taskid: fece293c-00e5-4fbf-86a5-89035ecc6a65
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 730,
          "y": 380
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "4_2_no": 0.43,
      "4_5_yes": 0.69,
      "5_2_#default#": 0.57
    },
    "paper": {
      "dimensions": {
        "height": 690,
        "width": 710,
        "x": 500,
        "y": 100
      }
    }
  }
fromversion: 8.0.0
