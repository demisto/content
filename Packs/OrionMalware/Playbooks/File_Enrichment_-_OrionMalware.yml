description: Get file information using the OrionMalware API integration.
dirtyInputs: true
id: 'File Enrichment - OrionMalware'
inputSections:
- description: Generic group for inputs
  inputs:
  - FileHash
  name: General (Inputs group)
inputs:
- description: ""
  key: FileHash
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: MD5
      root: File
      transformers:
      - args:
          item:
            iscontext: true
            value:
              simple: File.SHA1
        operator: append
      - args:
          item:
            iscontext: true
            value:
              simple: File.SHA256
        operator: append
name: File Enrichment - OrionMalware
outputSections:
- description: Generic group for outputs
  name: General (Outputs group)
  outputs:
  - Orion.File.antivirus.antivirus_name
  - Orion.File.antivirus.threat_name
  - Orion.File.end_analysis
  - Orion.File.first_submission
  - Orion.File.last_updated
  - Orion.File.payloads
  - Orion.File.rules
  - Orion.File.start_analysis
  - Orion.File.identification.filename
  - Orion.File.identification.md5
  - Orion.File.identification.sha1
  - Orion.File.identification.sha256
  - Orion.File.identification.size
  - Orion.File.identification.type
  - Orion.File.matched_mitre_attacks.description
  - Orion.File.matched_mitre_attacks.id
  - Orion.File.matched_mitre_attacks.kill_chain_phases
  - Orion.File.matched_mitre_attacks.name
  - Orion.File.networks.address
  - Orion.File.risk.dynamic.descriptions.files
  - Orion.File.risk.dynamic.descriptions.network
  - Orion.File.risk.dynamic.descriptions.persistence
  - Orion.File.risk.dynamic.descriptions.processes
  - Orion.File.risk.dynamic.descriptions.system
  - Orion.File.risk.dynamic.scores
  - Orion.File.risk.level
  - Orion.File.risk.scanner.descriptions.system
  - Orion.File.risk.scanner.descriptions.processes
  - Orion.File.risk.scanner.descriptions.persistence
  - Orion.File.risk.scanner.descriptions.files
  - Orion.File.risk.scanner.descriptions.network
  - Orion.File.risk.scanner.scores
  - File.Orion.EngineDetections
  - File.Orion.EngineVendors
  - File.Orion.EngineDetectionNames
  - IP.Address
  - Orion.IP.Address
  - File.Relationships.EntityA
  - File.Relationships.EntityB
  - File.Relationships.EntityAType
  - File.Relationships.EntityBType
  - File.Relationships.Relationship
  - Orion.File.report_url
outputs:
- contextPath: Orion.File.antivirus.antivirus_name
  description: antivirus_name analysis
  type: string
- contextPath: Orion.File.antivirus.threat_name
  description: threat detected by antivirus
  type: string
- contextPath: Orion.File.end_analysis
  description: end_analysis
- contextPath: Orion.File.first_submission
  description: first_submission
- contextPath: Orion.File.last_updated
  description: last_updated
- contextPath: Orion.File.payloads
  description: payloads
- contextPath: Orion.File.rules
  description: rules
- contextPath: Orion.File.start_analysis
  description: start analysis date
- contextPath: Orion.File.identification.filename
  description: filename of the file corresponding to the hash
- contextPath: Orion.File.identification.md5
  description: md5 hash of the file
- contextPath: Orion.File.identification.sha1
  description: sha1 hash of the file
- contextPath: Orion.File.identification.sha256
  description: sha256 hash of the file
- contextPath: Orion.File.identification.size
  description: Byte size
- contextPath: Orion.File.identification.type
  description: type of file
- contextPath: Orion.File.matched_mitre_attacks.description
  description: mitre description
- contextPath: Orion.File.matched_mitre_attacks.id
  description: mitre ttp
- contextPath: Orion.File.matched_mitre_attacks.kill_chain_phases
  description: mitre tactics
- contextPath: Orion.File.matched_mitre_attacks.name
  description: technique name
- contextPath: Orion.File.networks.address
  description: network address detected
- contextPath: Orion.File.risk.dynamic.descriptions.files
  description: dynmaic file analysis
- contextPath: Orion.File.risk.dynamic.descriptions.network
  description: network dynamic analysis
- contextPath: Orion.File.risk.dynamic.descriptions.persistence
  description: persistence dynamic analysis
- contextPath: Orion.File.risk.dynamic.descriptions.processes
  description: processes dynamic analysis
- contextPath: Orion.File.risk.dynamic.descriptions.system
  description: system dynamic analysis
- contextPath: Orion.File.risk.dynamic.scores
  description: dynamic risk scoring
- contextPath: Orion.File.risk.level
  description: dynamic risk
- contextPath: Orion.File.risk.scanner.descriptions.system
  description: system static analysis
- contextPath: Orion.File.risk.scanner.descriptions.processes
  description: processes static analysis
- contextPath: Orion.File.risk.scanner.descriptions.persistence
  description: persistence static analysis
- contextPath: Orion.File.risk.scanner.descriptions.files
  description: files static analysis
- contextPath: Orion.File.risk.scanner.descriptions.network
  description: network static analysis
- contextPath: Orion.File.risk.scanner.scores
  description: static risk scoring
- contextPath: File.Orion.EngineDetections
  description: Number of engines that flagged the file as malicious
- contextPath: File.Orion.EngineVendors
  description: engines
- contextPath: File.Orion.EngineDetectionNames
  description: threat name
- contextPath: IP.Address
  description: IP Linked to hash
- contextPath: Orion.IP.Address
- contextPath: File.Relationships.EntityA
  description: Source of relationship
- contextPath: File.Relationships.EntityB
  description: Destination of relationship
- contextPath: File.Relationships.EntityAType
  description: Source type of relationship
- contextPath: File.Relationships.EntityBType
  description: Destination type of relationship
- contextPath: File.Relationships.Relationship
  description: Kind of relation
- contextPath: Orion.File.report_url
  description: report url
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 057bf3b1-ba31-411e-8196-ce863501ffc9
      iscommand: false
      name: ""
      version: -1
    taskid: 057bf3b1-ba31-411e-8196-ce863501ffc9
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": -50,
          "y": -30
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 771b6995-a02f-41e5-b6f1-c61b4d1509b2
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 771b6995-a02f-41e5-b6f1-c61b4d1509b2
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -40,
          "y": 540
        }
      }
  "3":
    continueonerrortype: ""
    fieldMapping:
    - incidentfield: Detection URL
      output:
        simple: ${Orion.File.report_url}
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 2
    scriptarguments:
      file_hash:
        simple: ${inputs.FileHash}
      using:
        simple: OrionMalware_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: OrionMalware
      description: Checks hash value against Orion Malware database
      id: 082149e9-32ac-4bd9-acfe-12a825c69dfa
      iscommand: true
      name: Enriching file reputation
      script: OrionMalware|||hash-scan
      type: regular
      version: -1
    taskid: 082149e9-32ac-4bd9-acfe-12a825c69dfa
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 70,
          "y": 330
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    reputationcalc: 1
    nexttasks:
      "no":
      - "2"
      "yes":
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      brandname:
        simple: OrionMalware
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if integration OrionMalware is available. Returns 'yes' if integration brand is available. Otherwise returns
        'no'.
      id: 3122af0f-8b1f-4a18-9351-6e03e9f68aaf
      iscommand: false
      name: IsIntegrationAvailable (OrionMalware)?
      script: IsIntegrationAvailable
      type: condition
      version: -1
    taskid: 3122af0f-8b1f-4a18-9351-6e03e9f68aaf
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -50,
          "y": 100
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "4_2_no": 0.49
    },
    "paper": {
      "dimensions": {
        "height": 630,
        "width": 500,
        "x": -50,
        "y": -30
      }
    }
  }
