id: XSOAR Engineer Training - On Call Notification (Sub-Playbook)
version: -1
name: XSOAR Engineer Training - On Call Notification (Sub-Playbook)
description: "This sub-playbook can be used to send email notification if an Incidents severity is High or Critical.  By default it will take the current Incident severity as input, and requires a comma separated list of email addresses to send the notification to.\n\nInputs:\n\nemail: The email addresses to send the message to, can be comma separated. \nseverity: Defaults to the current incident severity in string format (critical, high, etc)\n\nOutputs:\n\nEscalationEmailSent: (Yes | No) : Whether a notification email was sent. "
tags:
- training
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 759e2ed0-b274-4de4-8857-5920738da1cf
    type: start
    task:
      id: 759e2ed0-b274-4de4-8857-5920738da1cf
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 6ab3d15f-53a0-4cf2-807d-75a83b6e42bc
    type: condition
    task:
      id: 6ab3d15f-53a0-4cf2-807d-75a83b6e42bc
      version: -1
      name: Is the Severity Critical or High?
      description: Check the severity of the Incident.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "2"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: inList
          left:
            value:
              complex:
                root: inputs.severity
            iscontext: true
          right:
            value:
              simple: critical,high
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: a037d69d-2ce7-433c-88be-43cbc9e31bb8
    type: regular
    task:
      id: a037d69d-2ce7-433c-88be-43cbc9e31bb8
      version: -1
      name: Send Notification for ${inputs.severity} alert
      description: In this case we would likely use the 'send-mail' command to send the notification, but not for training purposes
      scriptName: Print
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      value:
        simple: |-
          Sent Notification for ${inputs.severity} alert, to:

          ${inputs.email}
    reputationcalc: 1
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 66e338b6-2689-449c-84dc-9595cd9c2a18
    type: title
    task:
      id: 66e338b6-2689-449c-84dc-9595cd9c2a18
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 1a147589-5f29-4097-809e-12df4232ebed
    type: regular
    task:
      id: 1a147589-5f29-4097-809e-12df4232ebed
      version: -1
      name: Set EscalationEmail to Yes
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      key:
        simple: EscalationEmailSent
      stringify:
        simple: "true"
      value:
        simple: "Yes"
    reputationcalc: 1
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 1
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 401bfcf4-3491-4fee-89fc-3477950efbb5
    type: regular
    task:
      id: 401bfcf4-3491-4fee-89fc-3477950efbb5
      version: -1
      name: Set EscalationEmail to No
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: EscalationEmailSent
      stringify:
        simple: "true"
      value:
        simple: "No"
    reputationcalc: 1
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 1
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 968c2121-9fda-48f5-8409-59287f018bf7
    type: regular
    task:
      id: 968c2121-9fda-48f5-8409-59287f018bf7
      version: -1
      name: 'Send Email '
      description: Send an email (doesn't actually send an email)
      script: XSOAR Engineer Training|||send-mail
      type: regular
      iscommand: true
      brand: XSOAR Engineer Training
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      to:
        simple: rickroll@xet.com
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 910,
        "width": 810,
        "x": 50,
        "y": 50
      }
    }
  }
inputs:
- key: email
  value: {}
  required: true
  description: 'The email addresses to send the message to, can be comma separated. '
  playbookInputQuery:
- key: severity
  value:
    simple: ${incident.severityStr}
  required: false
  description: 'The Incident severity in string format '
  playbookInputQuery:
outputs:
- contextPath: EscalationEmailSent
  description: Whether an escalation email was sent, will be Yes or No
  type: string
tests:
- No tests (auto formatted)
fromversion: 6.8.0
