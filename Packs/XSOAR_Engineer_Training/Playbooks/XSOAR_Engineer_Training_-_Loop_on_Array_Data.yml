id: XSOAR Engineer Training - Loop on Array Data
version: -1
name: XSOAR Engineer Training - Loop on Array Data
description: "This playbook demonstrates how a playbook task loops over an array of data, and different ways to handle that.\n\nBy default when you pass an array into an integration command or an Automation script, it run the command for each item in the array.   \n\nThis behaviour can be changed by using the \"Is Array\" option on the argument, which tells XSOAR to expect an array in this field, and run once instead.\n\nThis playbook demonstrates this using 2 automations, one is IsIPinRanges, the other is CheckCIDRinList, which is a custom automation in this pack.  Both can be viewed from the Automations menu."
tags:
- training
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 6a0c24ae-c87e-4800-8329-2f868b3e5a07
    type: start
    task:
      id: 6a0c24ae-c87e-4800-8329-2f868b3e5a07
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "8"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 767372e3-61fd-4268-89df-c541a04d0c15
    type: title
    task:
      id: 767372e3-61fd-4268-89df-c541a04d0c15
      version: -1
      name: Done
      description: commands.local.cmd.close.inv
      type: title
      iscommand: false
      brand: Builtin
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 9946392e-3ddf-497a-859a-6bdcc379e141
    type: regular
    task:
      id: 9946392e-3ddf-497a-859a-6bdcc379e141
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      all:
        simple: "yes"
    reputationcalc: 1
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 7af6571a-3423-486e-8d3f-deb1adb4de65
    type: regular
    task:
      id: 7af6571a-3423-486e-8d3f-deb1adb4de65
      version: -1
      name: Print Playbook Overview
      description: Prints text to war room (Markdown supported)
      scriptName: Print
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      value:
        simple: "## XSOAR Engineer Training - Loop on Array Data\n\nBy default when you pass an array into an integration command or an Automation script, it run the command for each item in the array.   \n\nThis behaviour can be changed by using the \"Is Array\" option on the argument, which tells XSOAR to expect an array in this field, and run once instead.\n\nThis playbook demonstrates this using 2 automations, one is IsIPinRanges, the other is CheckCIDRinList, which is a custom automation in this pack.  Both can be viewed from the Automations menu."
    reputationcalc: 1
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 370
        }
      }
    note: true
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: 191d691e-e3df-48ba-8d8a-a323b873cf49
    type: regular
    task:
      id: 191d691e-e3df-48ba-8d8a-a323b873cf49
      version: -1
      name: Set Array of IPs to Context
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      key:
        simple: IPArray
      value:
        simple: '["8.8.8.1","8.8.8.2","8.8.8.3","10.8.8.1","10.8.8.2"]'
    reputationcalc: 1
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: f2701489-6023-4a87-8042-8e372c297dbc
    type: regular
    task:
      id: f2701489-6023-4a87-8042-8e372c297dbc
      version: -1
      name: Is IP in Ranges
      description: Returns yes if the IP is in one of the ranges provided, returns no otherwise.
      scriptName: IsIPInRanges
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      ip:
        complex:
          root: IPArray
      ipRanges:
        simple: ${lists.Internal IP Ranges}
    reputationcalc: 1
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 1ff5266d-b98f-4990-82f9-5b120ddc3d70
    type: regular
    task:
      id: 1ff5266d-b98f-4990-82f9-5b120ddc3d70
      version: -1
      name: CheckIPsinCIDRList (uses Is Array)
      description: Determines whether an IPv4 address is contained in one or more comma-delimited CIDR ranges.  You can pass in an array of IPs, and the name of the XSOAR list containing the comma separated list of CIDRs or /32 addresses.
      scriptName: CheckIPsinCIDRList
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      ips:
        complex:
          root: IPArray
      listname:
        simple: Internal IP Ranges
    reputationcalc: 1
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1085,
        "width": 380,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
fromversion: 6.8.0
tests:
- No tests (auto formatted)
