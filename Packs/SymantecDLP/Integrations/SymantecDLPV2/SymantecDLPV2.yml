category: Network Security
commonfields:
  id: Symantec Data Loss Prevention v2
  version: -1
configuration:
- display: Enforce Server (e.g. https://192.168.0.1)
  name: server
  required: true
  type: 0
- display: Username
  name: credentials
  required: true
  type: 9
- defaultvalue: 3 days
  display: First fetch timestamp (<number> <time unit>, e.g., 12 hours, 7 days)
  name: first_fetch
  required: false
  type: 0
- defaultvalue: '10'
  display: Fetch limit
  name: max_fetch
  required: false
  type: 0
- display: Incident type
  name: incidentType
  options:
  - Network
  - Discover
  - Endpoint
  required: false
  type: 16
- additionalinfo: The status ID of the incidents. In order to get status IDs, you
    should run the command `symantec-dlp-list-incident-status`
  display: Incident Status ID
  hidden: false
  name: incidentStatusId
  required: false
  type: 16
- display: Incident Severity
  hidden: false
  name: incidentSeverity
  options:
  - Info
  - Low
  - Medium
  - High
  required: false
  type: 16
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
- display: Fetch incidents
  name: isFetch
  required: false
  type: 8
description: Symantec Data Loss Prevention enables you to discover, monitor and protect
  your sensitive corporate information.
display: Symantec Data Loss Prevention v2
name: Symantec Data Loss Prevention v2
script:
  commands:
  - arguments:
    - default: false
      description: Get incidents with creation date later than specified. Support
        ISO (e.g 2021-12-28T00:00:00Z) and free text (e.g. '2 days').
      isArray: false
      name: creation_date
      required: false
      secret: false
    - default: false
      description: The status ID of the incidents. In order to get status IDs, you
        should run the command `symantec-dlp-list-incident-status`
      isArray: true
      name: status_id
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: 'The severity of the incidents. Can be: "High", "Medium", "Low",
        and "Info".'
      isArray: true
      name: severity
      predefined:
      - Info
      - Low
      - Medium
      - High
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: 'The incidents type. Can be: "Network", "Endpoint" and "Discover".'
      isArray: true
      name: incident_type
      predefined:
      - Network
      - Discover
      - Endpoint
      required: false
      secret: false
    - default: false
      defaultValue: '50'
      description: The limit of the incidents list per page. Default is 50.
      isArray: false
      name: limit
      required: false
      secret: false
    - default: false
      defaultValue: '1'
      description: The page of the incidents list. Default is 1.
      isArray: false
      name: page
      required: false
      secret: false
    deprecated: false
    description: Returns a list of incidents.
    execution: false
    name: symantec-dlp-list-incidents
    outputs:
    - contextPath: SymantecDLP.Incident.ID
      description: The ID of the Incident.
      type: Number
    - contextPath: SymantecDLP.Incident.messageType
      description: Indicates the Symantec DLP product component that generated the
        incident.
      type: String
    - contextPath: SymantecDLP.Incident.messageSource
      description: The localized label that corresponds to the Symantec DLP product
        that generated the incident.
      type: String
    - contextPath: SymantecDLP.Incident.detectionServerId
      description: The ID of the detection server that created the incident.
      type: Number
    - contextPath: SymantecDLP.Incident.policyVersion
      description: The version of the policy.
      type: Number
    - contextPath: SymantecDLP.Incident.matchCount
      description: Indicates the number of detection rule matches in the incident.
      type: Number
    - contextPath: SymantecDLP.Incident.policyId
      description: The ID of the policy.
      type: Number
    - contextPath: SymantecDLP.Incident.creationDate
      description: The creation date of the incident.
      type: Date
    - contextPath: SymantecDLP.Incident.detectionDate
      description: The detection date of the incident.
      type: Date
    - contextPath: SymantecDLP.Incident.severityId
      description: The severity ID of the incident.
      type: Number
    - contextPath: SymantecDLP.Incident.messageTypeId
      description: The ID of the Message Type.
      type: Number
    - contextPath: SymantecDLP.Incident.incidentStatusId
      description: The status ID of the incident.
      type: Number
  - arguments:
    - default: false
      description: Incident ID to get details of.
      isArray: false
      name: incident_id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: none
      description: "This argument can get the following values:\nall - If all custom\
        \ attributes are needed \nnone - If none of the custom attributes are needed\n\
        specific attributes - A list of custom attributes names, seperated by comma.\
        \ For example: ca1,ca2,ca3\ncustom attribute group name - A list of custom\
        \ attributes group names, seperated by comma. For example: cag1, cag2, cag3.\n\
        This value will retrive all custom attributes in the mentioned group. The\
        \ value \"none\" is default."
      isArray: false
      name: custom_attributes
      predefined:
      - all
      - none
      - specific attributes
      - custom attribute group name
      required: false
      secret: false
    - default: false
      description: 'A list of custom attributes names / custom attribute group names.
        List should be comma seperated. For example: item1,item2,item3'
      isArray: true
      name: custom_data
      required: false
      secret: false
    deprecated: false
    description: Returns the details of the specified incident.
    execution: false
    name: symantec-dlp-get-incident-details
    outputs:
    - contextPath: SymantecDLP.Incident.ID
      description: The ID of the incident.
      type: Number
    - contextPath: SymantecDLP.Incident.creationDate
      description: The creation date of the incident.
      type: Date
    - contextPath: SymantecDLP.Incident.detectionDate
      description: The detection date of the incident.
      type: Date
    - contextPath: SymantecDLP.Incident.severityId
      description: The severity ID of the incident.
      type: Number
    - contextPath: SymantecDLP.Incident.messageSource
      description: The localized label that corresponds to the Symantec DLP product
        that generated the incident.
      type: String
    - contextPath: SymantecDLP.Incident.messageType
      description: 'Indicates the Symantec DLP product that generated the incident.
        Can be: "NETWORK", "DISCOVER", "ENDPOINT".'
      type: String
    - contextPath: SymantecDLP.Incident.incidentStatusId
      description: The status ID of the incident.
      type: Number
    - contextPath: SymantecDLP.Incident.senderIPAddress
      description: The sender IP address.
      type: String
    - contextPath: SymantecDLP.Incident.policyName
      description: The name of the policy.
      type: String
    - contextPath: SymantecDLP.Incident.policyId
      description: The ID of the policy.
      type: Number
    - contextPath: SymantecDLP.Incident.endpointMachineIpAddress
      description: The IP address of the endpoint machine.
      type: String
    - contextPath: SymantecDLP.Incident.CustomAttribute.Name
      description: The custom attribute name.
      type: String
    - contextPath: SymantecDLP.Incident.CustomAttribute.Value
      description: The custom attribute value.
      type: String
    - contextPath: SymantecDLP.Incident.CustomAttribute.Index
      description: The custom attribute index.
      type: Number
    - contextPath: SymantecDLP.Incident.policyVersion
      description: The version of the policy.
      type: String
    - contextPath: SymantecDLP.Incident.detectionServerName
      description: The name of the detection server that created the incident.
      type: String
    - contextPath: SymantecDLP.Incident.policyGroupName
      description: The policy group name.
      type: String
    - contextPath: SymantecDLP.Incident.dataOwnerEmail
      description: The email of the data owner.
      type: String
    - contextPath: SymantecDLP.Incident.dataOwnerName
      description: The name of the data owner.
      type: String
  - arguments:
    - default: false
      description: Incident ID to update.
      isArray: false
      name: incident_id
      required: true
      secret: false
    - default: false
      description: The data owner email.
      isArray: false
      name: data_owner_email
      required: false
      secret: false
    - default: false
      description: The data owner name.
      isArray: false
      name: data_owner_name
      required: false
      secret: false
    - default: false
      description: The note to be added.
      isArray: false
      name: note
      required: false
      secret: false
    - default: false
      description: The status ID to update to. Run `symantec-dlp-list-incident-status`
        to get the status ID.
      isArray: false
      name: incident_status_id
      required: false
      secret: false
    - default: false
      description: Represents the remediation status name of an incident.
      isArray: false
      name: remediation_status_name
      required: false
      secret: false
    - default: false
      description: Represents the remediation location of the incident. Values can
        be user-defined.
      isArray: false
      name: remediation_location
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: 'Represents the severity level of the incident. Can be: "High",
        "Medium", "Low", and "Info".'
      isArray: false
      name: severity
      predefined:
      - Info
      - Low
      - Medium
      - High
      required: false
      secret: false
    - default: false
      description: |-
        The custom attributes to update. In order to get the custom attributes details, run `symantec-dlp-get-incident-details` command with `custom_attributes=all`
        Format:
        {columnIndex}:{newValue}
        E.g: 1:update, 4:att
      isArray: false
      name: custom_attributes
      required: false
      secret: false
    deprecated: false
    description: Updates the details of a specific incident.
    execution: false
    name: symantec-dlp-update-incident
  - deprecated: false
    description: Returns a list of the custom status values defined in the Symantec
      DLP deployment.
    execution: false
    name: symantec-dlp-list-incident-status
    outputs:
    - contextPath: SymantecDLP.IncidentStatus.id
      description: The ID of the status.
      type: Number
    - contextPath: SymantecDLP.IncidentStatus.name
      description: The name of the status.
      type: String
  - arguments:
    - default: false
      description: The incident ID.
      isArray: false
      name: incident_id
      required: true
      secret: false
    - default: true
      defaultValue: '50'
      description: The limit of the incident history list per page. Default is 50.
      isArray: false
      name: limit
      required: false
      secret: false
    deprecated: false
    description: Returns the history of the specified incident.
    execution: false
    name: symantec-dlp-get-incident-history
    outputs:
    - contextPath: SymantecDLP.IncidentHistory.incidentHistoryDate
      description: The date of the incident history.
      type: String
    - contextPath: SymantecDLP.IncidentHistory.dlpUserName
      description: The user name.
      type: String
    - contextPath: SymantecDLP.IncidentHistory.incidentHistoryAction
      description: The action of the incident history.
      type: String
    - contextPath: SymantecDLP.IncidentHistory.incidentHistoryDetail
      description: The incident history detail.
      type: String
    - contextPath: SymantecDLP.IncidentHistory.policyGroupId
      description: The policy group ID.
      type: Number
    - contextPath: SymantecDLP.IncidentHistory.detectionServerName
      description: The name of the detection server that created the incident.
      type: String
    - contextPath: SymantecDLP.IncidentHistory.incidentHistoryId
      description: The incident history ID.
      type: Number
    - contextPath: SymantecDLP.IncidentHistory.messageSource
      description: The localized label that corresponds to the Symantec DLP product
        that generated the incident.
      type: String
    - contextPath: SymantecDLP.IncidentHistory.messageDate
      description: The date of the message.
      type: String
    - contextPath: SymantecDLP.IncidentHistory.ID
      description: The ID of the incident
      type: Number
  - deprecated: false
    description: Returns a list of the remediation status values defined in the Symantec
      DLP deployment.
    execution: false
    name: symantec-dlp-list-remediation-status
    outputs:
    - contextPath: SymantecDLP.IncidentRemediationStatus.id
      description: The remediation status ID.
      type: Number
    - contextPath: SymantecDLP.IncidentRemediationStatus.name
      description: The remediation status name.
      type: String
  dockerimage: demisto/python3:3.10.1.26972
  feed: false
  isfetch: true
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  subtype: python3
  type: python
tests:
- Symantec Data Loss Prevention - Test
fromversion: 6.0.0
