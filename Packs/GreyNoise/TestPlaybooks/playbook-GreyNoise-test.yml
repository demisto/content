id: GreyNoise-Test
version: -1
name: GreyNoise-Test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: e341ba62-a046-41d8-86a1-c6c7ac74600a
    type: start
    task:
      id: e341ba62-a046-41d8-86a1-c6c7ac74600a
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "1":
    id: "1"
    taskid: 56b84340-d08a-4c38-80d6-929586dbf490
    type: regular
    task:
      id: 56b84340-d08a-4c38-80d6-929586dbf490
      version: -1
      name: DeleteContext
      description: Delete existing context data.
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "2":
    id: "2"
    taskid: e9121dc6-e068-461e-8be0-c25f7ce68894
    type: regular
    task:
      id: e9121dc6-e068-461e-8be0-c25f7ce68894
      version: -1
      name: ip
      description: Retrieves reputation of the IP.
      script: '|||ip'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      ip:
        complex:
          root: GreyNoise.IP
          accessor: address
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "3":
    id: "3"
    taskid: 953d454d-b91e-4cdc-8cdd-bb7b8785402b
    type: condition
    task:
      id: 953d454d-b91e-4cdc-8cdd-bb7b8785402b
      version: -1
      name: Verify Outputs
      description: Verify context data set by the previous command.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "13"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: DBotScore.Type
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: DBotScore.Vendor
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: IP.Address
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: IP.ASN
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: IP.Hostname
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: IP.Geo.Country
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: IP.Geo.Description
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "4":
    id: "4"
    taskid: 3f125445-7c18-4ee9-892c-553fcc0a584e
    type: regular
    task:
      id: 3f125445-7c18-4ee9-892c-553fcc0a584e
      version: -1
      name: greynoise-ip-context
      description: Retrieves context data for IP.
      script: '|||greynoise-ip-context'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      ip:
        complex:
          root: GreyNoise.IP
          accessor: address
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 680
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "5":
    id: "5"
    taskid: 8056096c-a255-4795-8c2b-83e93d558626
    type: condition
    task:
      id: 8056096c-a255-4795-8c2b-83e93d558626
      version: -1
      name: Verify Outputs
      description: Verify context data set by the previous command.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "6"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.IP.address
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.IP.first_seen
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.IP.last_seen
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.IP.seen
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.IP.actor
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.IP.spoofable
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.IP.classification
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.IP.metadata.asn
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.IP.metadata.city
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.IP.metadata.region
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.IP.metadata.country
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.IP.metadata.country_code
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.IP.metadata.organization
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.IP.metadata.category
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.IP.metadata.tor
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.IP.metadata.os
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 860
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "6":
    id: "6"
    taskid: 0826f47a-548e-4ef4-8fd3-c5f6fd6aec87
    type: regular
    task:
      id: 0826f47a-548e-4ef4-8fd3-c5f6fd6aec87
      version: -1
      name: greynoise-ip-quick-check
      description: Retrieves quick check data for IP.
      script: '|||greynoise-ip-quick-check'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      ip:
        complex:
          root: GreyNoise.IP
          accessor: address
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "7":
    id: "7"
    taskid: 2efad191-dc51-43ed-8b3e-7300c7ab8af0
    type: condition
    task:
      id: 2efad191-dc51-43ed-8b3e-7300c7ab8af0
      version: -1
      name: Verify Outputs
      description: Verify context data set by the previous command.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "2"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.IP.address
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.IP.noise
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.IP.code
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.IP.code_value
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1200
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "8":
    id: "8"
    taskid: f5cf34c4-31af-4e65-80e8-663f2fbec7a5
    type: regular
    task:
      id: f5cf34c4-31af-4e65-80e8-663f2fbec7a5
      version: -1
      name: greynoise-query
      description: Retrieves single record from GreyNoise using a query command.
      script: '|||greynoise-query'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      actor: {}
      advanced_query: {}
      classification: {}
      last_seen: {}
      next_token: {}
      organization: {}
      size:
        simple: "1"
      spoofable:
        simple: "false"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 330
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "9":
    id: "9"
    taskid: 21c83cf0-c1da-404c-84be-8c872355cb0d
    type: condition
    task:
      id: 21c83cf0-c1da-404c-84be-8c872355cb0d
      version: -1
      name: Verify Outputs
      description: Verify context data set by the previous command.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "4"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.IP.address
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.IP.first_seen
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.IP.last_seen
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.IP.seen
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.IP.tags
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.IP.actor
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.IP.spoofable
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.IP.classification
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.IP.metadata.asn
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.IP.metadata.city
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.IP.metadata.region
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.IP.metadata.country
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.IP.metadata.country_code
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.IP.metadata.organization
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.IP.metadata.category
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.IP.metadata.tor
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.IP.metadata.os
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.Query.count
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.Query.message
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.Query.query
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 490
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "10":
    id: "10"
    taskid: 06317841-a9fb-44d4-866a-cea0a6c4a79d
    type: regular
    task:
      id: 06317841-a9fb-44d4-866a-cea0a6c4a79d
      version: -1
      name: greynoise-stats
      description: Retrieves stats data from GreyNoise.
      script: '|||greynoise-stats'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      actor: {}
      advanced_query: {}
      classification: {}
      last_seen: {}
      organization: {}
      size:
        simple: "2"
      spoofable:
        simple: "false"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1930
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "11":
    id: "11"
    taskid: cd6078df-2524-4b59-8d61-6e471aac95b6
    type: condition
    task:
      id: cd6078df-2524-4b59-8d61-6e471aac95b6
      version: -1
      name: Verify Outputs
      description: Verify context data set by the previous command.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "12"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.Stats.query
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.Stats.count
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.Stats.stats.classifications.classification
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.Stats.stats.classifications.count
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.Stats.stats.spoofable.spoofable
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.Stats.stats.spoofable.count
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.Stats.stats.organizations.organization
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.Stats.stats.organizations.count
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.Stats.stats.actors.actor
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.Stats.stats.actors.count
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.Stats.stats.countries.country
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.Stats.stats.countries.count
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.Stats.stats.tags.tag
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.Stats.stats.tags.count
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.Stats.stats.operating_systems.operating_system
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.Stats.stats.operating_systems.count
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.Stats.stats.categories.category
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.Stats.stats.categories.count
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.Stats.stats.asns.asn
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: GreyNoise.Stats.stats.asns.count
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "12":
    id: "12"
    taskid: fbba2e24-65e1-44e2-81cb-42805de3380a
    type: title
    task:
      id: fbba2e24-65e1-44e2-81cb-42805de3380a
      version: -1
      name: Test Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2290
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "13":
    id: "13"
    taskid: e5381280-bf82-45a4-8a20-15f7346020ba
    type: regular
    task:
      id: e5381280-bf82-45a4-8a20-15f7346020ba
      version: -1
      name: DeleteContext
      description: Delete existing context data.
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2305,
        "width": 380,
        "x": 50,
        "y": 50
      }
    }
  }

inputs: []
outputs: []
tests:
- No tests (auto formatted)
fromversion: 5.0.0
description: A test playbook for GreyNoise integration commands
