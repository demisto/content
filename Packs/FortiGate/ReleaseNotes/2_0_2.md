
#### Modeling Rules

##### Fortinet FortiGate Modeling Rule

- Updated mappings for the following fields: 
| CEF Log Field Name      | Fortigate Field Name | Field Description     | XDM Target Field| 
| :---        | :----       | :---          | :---       | 
|FTNTFGTappcat ~~FTNTFGTcat~~|appcat|Application Category|xdm.network.application_protocol_category|
|FTNTFGTapp|app|Application Name|xdm.target.application.name ~~xdm.source.application.name~~|
|FTNTFGTdevtype ~~FTNTFGTsrcfamily~~|devtype|Device type of the source|xdm.source.host.device_category|

- Added XDM mappings for the following fields: 
| CEF Log Field Name      | Fortigate Field Name | Field Description     | XDM Target Field| 
| :---        | :----       | :---          | :---       | 
|FTNTFGTviruscat|viruscat|Virus Category|xdm.alert.category, xdm.alert.risks|
|FTNTFGTincidentserialno|incidentserialno|Incident serial number |xdm.alert.original_alert_id, xdm.alert.risks|
|FTNTFGTattackid|attackid|Attack ID|xdm.alert.original_threat_id, xdm.alert.risks|
|FTNTFGTvirusid|virusid|Virus ID (unique virus identifier)|xdm.alert.original_threat_id, xdm.alert.risks|
|dhost|dstname|Destination Hostname|xdm.target.host.hostname|
|FTNTFGTattack|attack|Attack Name|xdm.alert.original_threat_name, xdm.alert.risks|
|FTNTFGTthreattype|threattype|WIDS threat type |xdm.alert.original_threat_name, xdm.alert.risks|
|fname|filename|File name|xdm.target.file.filename|
|FTNTFGTvirus|virus|Virus Name|xdm.alert.original_threat_name, xdm.alert.risks|
|FTNTFGTcveid|cveid|CVE ID|xdm.alert.risks|
|FTNTFGTvulncat|vulncat|Vulnerability Category|xdm.alert.risks|
|FTNTFGTvulnid|vulnid|Vulnerability ID|xdm.alert.risks|
|FTNTFGTappcat|appcat|Application Category|xdm.network.application_protocol_category|
|FTNTFGTvulnname|vulnname|Vulnerability name|xdm.alert.risks|
|FTNTFGTapprisk|apprisk|Application Risk Level |xdm.alert.severity|
|FTNTFGTerror|error|DNS filter service error message|xdm.event.outcome_reason|
|FTNTFGTerror_num|error_num|Error Number |xdm.event.outcome_reason|
|FTNTFGTtunnelid|tunnelid|IPsec VPN tunnel ID|xdm.intermediate.host.device_id|
|FTNTFGTapsn|apsn|Access Point serial number |xdm.intermediate.host.hardware_uuid|
|FTNTFGTsnclosest|snclosest|SN of the AP closest to the rogue AP |xdm.intermediate.host.hardware_uuid|
|FTNTFGTap|ap|Access Point|xdm.intermediate.host.hostname|
|FTNTFGTvpntunnel|vpntunnel|IPsec VPN Tunnel Name|xdm.intermediate.host.hostname|
|FTNTFGTbssid|bssid|Basic service set ID of the WAP (Wireless Access Point)|xdm.intermediate.host.mac_addresses|
|FTNTFGTstamac|stamac|The MAC address of wifi station|xdm.intermediate.host.mac_addresses|
|FTNTFGTgateway|gateway|Gateway ip address for PPPoE status report |xdm.intermediate.ipv4, xdm.intermediate.ipv6, xdm.intermediate.host.ipv4_addresses, xdm.intermediate.host.ipv4_public_addresses, xdm.intermediate.host.ipv6_addresses|
|FTNTFGTopercountry|opercountry|The name of operating country on a AP|xdm.intermediate.location.country|
|FTNTFGTxauthgroup|xauthgroup|IPsec VPN Xauth user group name|xdm.intermediate.user.groups|
|FTNTFGTxauthuser|xauthuser|IPsec VPN Xauth user name |xdm.intermediate.user.username|
|FTNTFGTvoip_proto|voip_proto|VOIP protocol: SIP/SCCP/MGCP/h323|xdm.network.application_protocol|
|FTNTFGTlease|lease|DHCP lease time |xdm.network.dhcp.lease|
|FTNTFGTdhcp_msg|dhcp_msg|DHCP Message|xdm.network.dhcp.message_type|
|FTNTFGTqclass|qclass|DNS Query class|xdm.network.dns.dns_question.class, xdm.network.dns.dns_resource_record.class|
|FTNTFGTqname|qname|Query domain name|xdm.network.dns.dns_question.name, xdm.network.dns.dns_resource_record.name|
|FTNTFGTqtype|qtype|Query type description|xdm.network.dns.dns_question.type, xdm.network.dns.dns_resource_record.type|
|FTNTFGTipaddr|ipaddr|IP addresses from DNS response answer section|xdm.network.dns.dns_resource_record.value|
|FTNTFGTeventtype|eventtype|Event Type|xdm.network.dns.is_response|
|FTNTFGTforwardedfor|forwardedfor|X-Forwarded-For HTTP header |xdm.network.http.http_header.header, xdm.network.http.http_header.value, xdm.source.host.ipv4_addresses, xdm.source.host.ipv4_public_addresses, xdm.source.host.ipv6_addresses|
|FTNTFGThttpmethod|httpmethod|HTTP request method|xdm.network.http.method|
|FTNTFGTreferralurl|referralurl|Referrer URI|xdm.network.http.referrer|
|FTNTFGThttpcode|httpcode|HTTP Code|xdm.network.http.response_code|
|FTNTFGTcatdesc|catdesc|FortiGuard web filter category Description|xdm.network.http.url_category|
|requestContext|catdesc|DNS category description|xdm.network.http.url_category|
|FTNTFGTicmpcode|icmpcode|ICMP code|xdm.network.icmp.code|
|FTNTFGTicmptype|icmptype|The type of ICMP message|xdm.network.icmp.type|
|FTNTFGTapplist|applist|Application Control profile name |xdm.network.rule|
|FTNTFGTpolicy_id|policy_id|Name of the firewall policy governing the traffic which caused the log message|xdm.network.rule|
|FTNTFGTpolicyid|policyid|Name of the firewall policy governing the traffic which caused the log message|xdm.network.rule|
|FTNTFGTprofile|profile|Profile Name|xdm.network.rule|
|FTNTFGTshapingpolicyid|shapingpolicyid|Shaping Policy ID |xdm.network.rule|
|FTNTFGTcipher|cipher|Encryption Type|xdm.network.tls.cipher|
|FTNTFGTccertissuer|ccertissuer|Client certificate issuer|xdm.network.tls.client_certificate.issuer|
|FTNTFGTtlsver|tlsver|TLS version|xdm.network.tls.protocol_version|
|FTNTFGTassignip|assignip|IPsec VPN tunnel assigned IP address|xdm.network.vpn.allocated_ipv4, xdm.network.vpn.allocated_ipv6, xdm.intermediate.ipv4, xdm.intermediate.ipv6, xdm.intermediate.host.ipv4_addresses, xdm.intermediate.host.ipv4_public_addresses,  xdm.intermediate.host.ipv6_addresses|
|FTNTFGTtunnelip|tunnelip|IPsec VPN tunnel IP address|xdm.network.vpn.allocated_ipv4, xdm.network.vpn.allocated_ipv6, xdm.intermediate.ipv4, xdm.intermediate.ipv6, xdm.intermediate.host.ipv4_addresses, xdm.intermediate.host.ipv4_public_addresses,  xdm.intermediate.host.ipv6_addresses|
|FTNTFGTsslaction|sslaction|Action taken by ssl-ssh-profile|xdm.observer.action|
|FTNTFGTutmaction|utmaction|Security action performed by UTM|xdm.observer.action|
|dvchost|dvchost|Device Hostname|xdm.observer.name|
|externalID|sessionid|ID for the session|xdm.session_context_id, xdm.network.session_id|
|FTNTFGTdevtype|devtype|Device type of the source|xdm.source.host.device_category|
|FTNTFGTsrcuuid|srcuuid|UUID of the Source Address Object|xdm.source.host.device_id|
|FTNTFGTsrchwversion|srchwversion|Source hardware version|xdm.source.host.device_model|
|FTNTFGTsaddr|saddr|Source Address IP|xdm.source.host.ipv4_addresses|
|FTNTFGTassigned|assigned|Assigned IP Address through PPPoE|xdm.source.host.ipv4_addresses, xdm.source.host.ipv6_addresses, xdm.source.host.ipv4_public_addresses|
|FTNTFGTbanned_src|banned_src|NAC quarantine Banned Source IP |xdm.source.host.ipv4_addresses, xdm.source.host.ipv6_addresses, xdm.source.host.ipv4_public_addresses|
|FTNTFGTlocal|local|Local IP for a PPPD Connection|xdm.source.host.ipv4_addresses, xdm.source.host.ipv6_addresses, xdm.source.host.ipv4_public_addresses|
|FTNTFGTtrueclntip|trueclntip|True-Client-IP|xdm.source.host.ipv4_addresses, xdm.source.host.ipv6_addresses, xdm.source.host.ipv4_public_addresses| 
|sourceTranslatedAddress|transip|NAT source IP|xdm.source.host.ipv4_addresses, xdm.source.host.ipv6_addresses, xdm.source.host.ipv4_public_addresses| 
|FTNTFGTmastersrcmac|mastersrcmac|The master MAC address for a host that has multiple network interfaces|xdm.source.host.mac_addresses| 
|FTNTFGTtamac|tamac|The MAC address of Transmitter. If none, then Receiver |xdm.source.host.mac_addresses|
|FTNTFGTmanuf|manuf|Manufacturer name|xdm.source.host.manufacturer|
|FTNTFGTsrchwvendor|srchwvendor|Source hardware vendor|xdm.source.host.manufacturer|
|deviceInboundInterface|srcintf|Interface name of the traffic's origin|xdm.source.interface|
|FTNTFGTnat|nat|NAT IP Address|xdm.source.ipv4, xdm.source.ipv6, xdm.source.host.ipv4_addresses, xdm.source.host.ipv6_addresses|
|c6a2|c6a2|Source IPv6 Address|xdm.source.ipv6|
|FTNTFGTsrccity|srccity|Source host city|xdm.source.location.city|
|FTNTFGTsrccountry|srccountry|Source host country|xdm.source.location.country|
|FTNTFGTsrcregion|srcregion|Source Host Region|xdm.source.location.region|
|requestClientApplication|agent|User Agent|xdm.source.user_agent|
|FTNTFGTgroup|group|User Group Name|xdm.source.user.groups|
|FTNTFGTadgroup|adgroup|AD Group Name of FSSO user |xdm.source.user.groups|
|FTNTFGTfctuid|fctuid|FortiClient User ID |xdm.source.user.identifier|
|FTNTFGTinitiator|initiator|The initiator user for override|xdm.source.user.username|
|FTNTFGTlogin|login|SSH login Name |xdm.source.user.username|
|FTNTFGTappid|appid|ID of the application. |xdm.target.application.name|
|FTNTFGTapp|app|Application Name|xdm.target.application.name|
|FTNTFGTfiletype|filetype|File type|xdm.target.file.file_type |
|FTNTFGTfilehash|filehash|Used by Outbreak Prevention External Hash: the hash signature used in the detection|xdm.target.file.sha256, xdm.target.file.md5|
|fsize|filesize|File size in bytes|xdm.target.file.size|
|FTNTFGTdstdevtype|dstdevtype|Destination Device Type |xdm.target.host.device_category|
|FTNTFGTdstfamily|dstfamily|Destination Host OS Platform Family|xdm.target.host.device_category|
|FTNTFGTdsthwversion|dsthwversion|Destination hardware version|xdm.target.host.device_model|
|FTNTFGTserialno|serialno|Serial Number|xdm.target.host.hardware_uuid|
|FTNTFGTsn|sn|Serial Number|xdm.target.host.hardware_uuid|
|FTNTFGTdst_host|dst_host|Destination Host|xdm.target.host.hostname|
|FTNTFGTdstauthserver|dstauthserver|Destination Auth Server|xdm.target.host.hostname|
|FTNTFGTdaddr|daddr|Destination address |xdm.target.host.ipv4_addresses, xdm.target.host.ipv6_addresses, xdm.target.host.ipv4_public_addresses|
|FTNTFGTserver|server|Server IP Address|xdm.target.host.ipv4_addresses, xdm.target.host.ipv6_addresses, xdm.target.host.ipv4_public_addresses|
|FTNTFGTinvalidmac|invalidmac|Detected MAC address with invalid OUI|xdm.target.host.mac_addresses|
|FTNTFGTmasterdstmac|masterdstmac|Destination master MAC address |xdm.target.host.mac_addresses|
|FTNTFGTdstosname|dstosname|Destination OS name|xdm.target.host.os|
|FTNTFGTdstfamily|dstfamily|Destination OS family|xdm.target.host.os_family|
|deviceOutboundInterface|dstintf|Interface of the traffic's destination|xdm.target.interface|
|FTNTFGTdevintfname|devintfname|HA device interface name |xdm.target.interface|
|FTNTFGTremote|remote|IP Address of the PPP Remote end |xdm.target.ipv4, xdm.target.ipv6, xdm.target.host.ipv4_addresses, xdm.target.host.ipv4_public_addresses, xdm.target.host.ipv6_addresses|
|c6a3|c6a3|Destination IPv6 Address|xdm.target.ipv6|
|FTNTFGTdstcity|dstcity|Destination host city|xdm.target.location.city|
|FTNTFGTdstcountry|dstcountry|Destination country|xdm.target.location.country|
|FTNTFGTdstregion|dstregion|Destination Host Region|xdm.target.location.region|
|FTNTFGTcommand|command|Shell command|xdm.target.process.command_line|
|FTNTFGTold_status|old_status|Original Status|xdm.target.resource_before.value|
|FTNTFGTold_value|old_value|Original value|xdm.target.resource_before.value|
|FTNTFGToldvalue|oldvalue|Original value|xdm.target.resource_before.value|
|FTNTFGToldwprof|oldwprof|Old Web Filter Profile|xdm.target.resource_before.value|
|FTNTFGTcfgattr|cfgattr|Configuration attribute|xdm.target.resource.name|
|FTNTFGTpoolname|poolname|IP Pool Name |xdm.target.resource.name|
|FTNTFGTauditreporttype|auditreporttype|Security Rating report type|xdm.target.resource.type|
|FTNTFGTcfgpath|cfgpath|Configuration path|xdm.target.resource.type|
|FTNTFGTreporttype|reporttype|Report Type|xdm.target.resource.type|
|FTNTFGTcfgobj|cfgobj|Configuration object |xdm.target.resource.value|
|FTNTFGTnew_status|new_status|New status|xdm.target.resource.value|
|FTNTFGTnew_value|new_value|New value|xdm.target.resource.value|
|FTNTFGTnewvalue|newvalue|New value|xdm.target.resource.value|
|request|url|Target URL|xdm.target.url|
|shost|shost|Source Hostname| xdm.source.host.hostname|
|FTNTFGTdstuser|dstuser|Destination user|xdm.target.user.username|
|sourceTranslatedPort|transport|NAT source port|xdm.source.port|