{"type": "bundle", "id": "bundle--32cd1e04-c095-473b-baa8-11efda980da5", "objects": [{"type": "identity", "spec_version": "2.1", "id": "identity--477866fd-8784-46f9-ab40-5592ed4eddd7", "created": "2023-10-08T20:06:11.507598Z", "modified": "2023-10-08T20:06:11.507598Z", "name": "Feedly AI", "identity_class": "organization", "external_references": [{"source_name": "Feedly", "url": "https://feedly.com/i/landing/threatIntelligence"}]}, {"type": "report", "spec_version": "2.1", "id": "report--1c9014de-c4fd-5db7-b562-dd321a6f94e1", "created_by_ref": "identity--477866fd-8784-46f9-ab40-5592ed4eddd7", "created": "2023-10-09T05:29:08.986171+00:00", "modified": "2023-10-09T05:29:08.986171+00:00", "name": "Threat Actors Employ Remote Admin Tools to Gain Access over Corpora...", "description": "Recently, threat actors have adapted tactics, exploiting the appeal of banned apps in specific regions, making users more susceptible to cyberattacks through cleverly crafted campaigns.\n\n In a recent campaign, Chinese users were lured with a fake Telegram installer to illustrate this tactic.\n\n Cybersecurity researchers at CRIL (Cyble Research and Intelligence Labs) noted a campaign targeting Russian users, where threat actors created phishing sites mimicking restricted apps like-\n\n * ExpressVPN\n* WeChat\n* Skype\n\n    FREE Demo  [Deploy Advanced AI-Powered Email Security Solution](https://cybersecuritynews.com/threat-actors-employ-remote-admin-tools/#)\n------------------------------------------------------------------------------------------------------------------------------\n\n Implementing AI-Powered Email security solutions \u201cTrustifi\u201d can secure your business from today\u2019s most dangerous email threats, such as Email Tracking, Blocking, Modifying, Phishing, Account Take Over, Business Email Compromise, Malware & Ransomware\n\n    Experts [identified](https://cyble.com/blog/rms-tools-sneaky-comeback-phishing-campaign-mirroring-banned-applications/) the following phishing domains delivering RMS, disguising as legitimate OS applications but distributing malware:-\n\n * express-vpn[.]fun\n* we-chat[.]info\n* join-skype[.]com\n\n **Threat Actors Employ Remote Admin Tools**\n-------------------------------------------\n\n The consistent use of the same RMS executable across these phishing sites strongly suggests a single or closely coordinated threat actor group was behind these attacks.\n\n The phishing sites distributed either a malicious Self-extracting archive (SFX) or an RMS binary. For instance, the ExpressVPN [phishing site](https://cybersecuritynews.com/sophisticated-phishing-campaigns/) in this campaign downloads an SFX archive that mimics a genuine installer but delivers malware upon execution.\n\n After execution, the SFX file modifies the \u2018HKCU\\Software\\WinRAR SFX\u2019 Registry key and creates a \u2018expressvpn\\_windows\\_12.58.0.4\\_release\u2019 folder in %temp% with specific files:-\n\n * **expressvpn.exe:** This file is an RMS executable.\n* **expressvpn\\_windows\\_12.58.0.4\\_release.exe:** This file is a clean ExpressVPN installer.\n\n ![SFX Archive](https://lh3.googleusercontent.com/HVMUAg3bQx5KiR5Y0-xStUaZYYjVzbDVGMbzEHhAph1cM3pqIZHjrpNlzvcrntRVhi9uZiUBCCAnBFq6skEjNFNgXZfrZEK7rLhRbrjAmay9KWj4tJKMu8TOLjesN8pzCRe3m_3Dn__Y1zDrYerzTds)SFX Archive (Source \u2013 Cyble) The SFX file quietly runs an RMS executable in the background while simultaneously using the ExpressVPN installation wizard as a decoy to divert and confuse users.\n\n ![Process Tree ](https://lh3.googleusercontent.com/SxlJyO42OJdeXBATgQk5eHRPcimuVWOBOrAFj60oL0ONat_K432fVqb-LcZg2i1lVFfyigA2er6y6eYu_skVCgV6Z797-2W8OEr5-rNt8RBJDItiGboWSWI8w-8qhLcpRjQLAdc22D5_4bqnzZjyCms)Process Tree (Source \u2013 Cyble) RMS, initially a legitimate tool, has been used in campaigns by TA505 and other threat actors. It\u2019s free for non-commercial use and supports remote administration across multiple platforms, offering features like remote control and file transfers.\n\n After execution, \u2018expressvpn.exe\u2019 creates a unique folder in %temp%, drops \u2018host.msi,\u2019 silently installs it via msiexec.exe, and places RMS files in \u2018C:\\Program Files (x86)\\Remote Manipulator System \u2013 Host\u2019.\n\n The RMS client configuration is hex-encoded in a [Registry Key](https://cybersecuritynews.com/malicious-npm-and-pypi-packages/) and includes data for functions like:-\u00a0\n\n * Data transmission\n* Email alerts\n* Remote access\n* Screen recording\n\n The configuration data is organized into distinct sections, and here below, we have mentioned those sections:-\n\n * rms\\_inet\\_id\\_notification\n* security\\_settings\n* general\\_settings\n* rms\\_internet\\_id\\_settings\n* certificte\\_settings\n* sreen\\_record\\_option\n* local\\_settings\n\n RMS includes \u2018Internet-ID\u2019 for connecting to developer servers, sending an email notification containing victim details and remote access credentials, making attacks more accessible for less sophisticated threat actors.\n\n The notification email, sent via SMTP to \u201c31.31.194.65\u201d (resolved as \u201cmail.hosting.reg.ru\u201d), initiates C&C communications over TCP to transmit victim data.\n\n ![Network Connections](https://lh6.googleusercontent.com/Yikt0caFAsnOQHjqchVxCmSs9Wp7TSuP3ihLgbqgJBKxiX2T_H17eV8morHu90Yxe-grQlhOikiH19UpahSLk85Bxo0kgwb-aBQcDO_sZVn-sUs8qxqlTywoZNoSHPbX_NoUOuo5AyMQKW3o7u5y51U)Network Connections (Source \u2013 Cyble) Victim data, in Base64-encoded XML, goes to IP addresses 77.223.124.212 and 95.213.205.83 via port 5655. It mirrors registry-stored configuration data, including country code, device name, OS details, and an admin privilege flag.\n\n **Recommendations**\n-------------------\n\n Here below we have mentioned all the recommendations:-\n\n * Enforce application whitelisting to limit unapproved app execution, including remote admin tools, on endpoints.\n* Regularly check your system\u2019s services list, especially for \u201cRManService.\u201d If unsure, consider disabling or removing it.\n* Use network traffic tools to monitor outbound traffic, especially on port 5655, and set alerts for unusual patterns that could signal C&C server communication.\n\n Protect yourself from vulnerabilities using Patch Manager Plus to patch over 850 third-party applications quickly. Take advantage of the\u00a0**[free\u00a0trial](https://www.manageengine.com/patch-management/?utm_source=GBHackers&utm_medium=Website-CPM&utm_campaign=PMP-300x600)**\u00a0to ensure 100% security.\n\n The post [Threat Actors Employ Remote Admin Tools to Gain Access over Corporate Networks](https://cybersecuritynews.com/threat-actors-employ-remote-admin-tools/) appeared first on [Cyber Security News](https://cybersecuritynews.com).", "published": "2023-10-08T22:29:04.093Z", "object_refs": ["indicator--f75e3179-a61c-59eb-8289-17f81bb3f798", "indicator--b481fd72-1711-57b3-8f34-6fd9c63c4f9c", "indicator--1b844713-a2f5-59d6-9e1c-c58eccbb35f3", "indicator--7c8def1d-5256-5d51-bc12-08f32061ee6b", "indicator--90adec07-e9c8-5e3b-b68f-22e6405ab54f", "indicator--3bd554ee-d87d-5c43-9e05-22fc467c253c", "malware--94339b04-9332-4691-b820-5021368f1d3a", "threat-actor--03c80674-35f8-4fe0-be2b-226ed0fcd69f", "attack-pattern--04fd5427-79c7-44ea-ae13-11b24778ff1c", "attack-pattern--2e34237d-8574-43f6-aace-ae2915de8597", "attack-pattern--57340c81-c025-4189-8fa0-fc7ede51bae4", "attack-pattern--6faf650d-bf31-4eb4-802d-1000cf38efaf", "attack-pattern--a62a8db3-f23a-4d8f-afd6-9dbc77e7813b", "relationship--a36555cb-8add-43be-a33c-f962b0bfdbdb", "relationship--2b7379c8-7c83-4376-a362-f256fabd68d7", "relationship--74245dc1-1e4b-4b06-bf17-6216972008df", "relationship--c501cf08-3247-4c65-8598-22822e855423", "relationship--a1e8a44b-d902-4ddb-bc20-571e5b161086"], "labels": ["Feedly AI", "Domains", "IPs", "TTPs"], "external_references": [{"source_name": "Feedly article", "url": "https://feedly.com/i/entry/TUUqTqS5PmAnvMYxpxsJW4lVFUYs0KVkqWEL+fdotps=_18b12e9095d:b749c:e11a9d8"}, {"source_name": "Cyber Security News", "url": "https://cybersecuritynews.com/threat-actors-employ-remote-admin-tools/"}], "object_marking_refs": ["marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"]}, {"type": "indicator", "spec_version": "2.1", "id": "indicator--f75e3179-a61c-59eb-8289-17f81bb3f798", "created": "2023-10-09T05:29:08.914199Z", "modified": "2023-10-09T05:29:08.914199Z", "name": "Domain", "pattern": "[domain-name:value = 'express-vpn.fun']", "pattern_type": "stix", "pattern_version": "2.1", "valid_from": "2023-10-09T05:29:08.914199Z"}, {"type": "indicator", "spec_version": "2.1", "id": "indicator--b481fd72-1711-57b3-8f34-6fd9c63c4f9c", "created": "2023-10-09T05:29:08.967244Z", "modified": "2023-10-09T05:29:08.967244Z", "name": "Domain", "pattern": "[domain-name:value = 'join-skype.com']", "pattern_type": "stix", "pattern_version": "2.1", "valid_from": "2023-10-09T05:29:08.967244Z"}, {"type": "indicator", "spec_version": "2.1", "id": "indicator--1b844713-a2f5-59d6-9e1c-c58eccbb35f3", "created": "2023-10-09T05:29:08.969479Z", "modified": "2023-10-09T05:29:08.969479Z", "name": "Domain", "pattern": "[domain-name:value = 'we-chat.info']", "pattern_type": "stix", "pattern_version": "2.1", "valid_from": "2023-10-09T05:29:08.969479Z"}, {"type": "indicator", "spec_version": "2.1", "id": "indicator--7c8def1d-5256-5d51-bc12-08f32061ee6b", "created": "2023-10-09T05:29:08.972597Z", "modified": "2023-10-09T05:29:08.972597Z", "name": "IPv4", "pattern": "[ipv4-addr:value = '95.213.205.83']", "pattern_type": "stix", "pattern_version": "2.1", "valid_from": "2023-10-09T05:29:08.972597Z"}, {"type": "indicator", "spec_version": "2.1", "id": "indicator--90adec07-e9c8-5e3b-b68f-22e6405ab54f", "created": "2023-10-09T05:29:08.975362Z", "modified": "2023-10-09T05:29:08.975362Z", "name": "IPv4", "pattern": "[ipv4-addr:value = '31.31.194.65']", "pattern_type": "stix", "pattern_version": "2.1", "valid_from": "2023-10-09T05:29:08.975362Z"}, {"type": "indicator", "spec_version": "2.1", "id": "indicator--3bd554ee-d87d-5c43-9e05-22fc467c253c", "created": "2023-10-09T05:29:08.977076Z", "modified": "2023-10-09T05:29:08.977076Z", "name": "IPv4", "pattern": "[ipv4-addr:value = '77.223.124.212']", "pattern_type": "stix", "pattern_version": "2.1", "valid_from": "2023-10-09T05:29:08.977076Z"}, {"type": "malware", "spec_version": "2.1", "id": "malware--94339b04-9332-4691-b820-5021368f1d3a", "created": "2023-10-08T19:16:53.819646Z", "modified": "2023-10-08T19:16:53.819646Z", "name": "RMS", "description": "CyberInt states that Remote Manipulator System (RMS) is a legitimate tool developed by Russian organization TektonIT and has been observed in campaigns conducted by TA505 as well as numerous smaller campaigns likely attributable to other, disparate, threat actors. In addition to the availability of commercial licenses, the tool is free for non-commercial use and supports the remote administration of both Microsoft Windows and Android devices.", "is_family": true, "aliases": ["Gussdoor", "RemoteManipulatorSystem", "RuRAT", "Remote Manipulator System"], "external_references": [{"source_name": "Source", "url": "https://awakesecurity.com/blog/catching-the-white-stork-in-flight/"}, {"source_name": "Source", "url": "https://blog.malwarebytes.com/threat-analysis/2017/09/cve-2017-0199-used-to-deliver-modified-rms-agent-rat/"}, {"source_name": "Source", "url": "https://blog.yoroi.company/research/ta505-is-expanding-its-operations/"}, {"source_name": "Source", "url": "https://e.cyberint.com/hubfs/Report%20Legit%20Remote%20Access%20Tools%20Turn%20Into%20Threat%20Actors%20Tools/CyberInt_Legit%20Remote%20Access%20Tools%20Turn%20Into%20Threat%20Actors'%20Tools_Report.pdf"}, {"source_name": "Source", "url": "https://ics-cert.kaspersky.com/media/Kaspersky-Attacks-on-industrial-enterprises-using-RMS-and-TeamViewer-EN.pdf"}, {"source_name": "Source", "url": "https://ssu.gov.ua/uploads/files/DKIB/Technical%20report%20Armagedon.pdf"}, {"source_name": "Source", "url": "https://unit42.paloaltonetworks.com/unit-42-title-gamaredon-group-toolset-evolution"}, {"source_name": "Source", "url": "https://web.archive.org/web/20161223002016/https://www.symantec.com/connect/blogs/odinaff-new-trojan-used-high-level-financial-attacks"}]}, {"type": "threat-actor", "spec_version": "2.1", "id": "threat-actor--03c80674-35f8-4fe0-be2b-226ed0fcd69f", "created": "2023-10-08T19:16:55.704495Z", "modified": "2023-10-08T19:16:55.704495Z", "name": "TA505", "description": "TA505, the name given by Proofpoint, has been in the cybercrime business for at least four years. This is the group behind the infamous Dridex banking trojan and Locky ransomware, delivered through malicious email campaigns via Necurs botnet. Other malware associated with TA505 include Philadelphia and GlobeImposter ransomware families.", "aliases": ["TA 505", "GRACEFUL SPIDER", "Hive0065", "G0092", "GracefulSpider", "SectorJ04 Group", "GoldTahoe", "SectorJ04", "GOLD TAHOE", "CHIMBORAZO", "Dudear", "ATK103", "ATK 103"], "external_references": [{"source_name": "Source", "url": "https://www.bleepingcomputer.com/news/security/ta505-group-adopts-new-servhelper-backdoor-and-flawedgrace-rat/"}, {"source_name": "Source", "url": "https://www.proofpoint.com/sites/default/files/ta505_timeline_final4_0.png"}, {"source_name": "Source", "url": "https://www.proofpoint.com/us/threat-insight/post/threat-actor-profile-ta505-dridex-globeimposter"}, {"source_name": "Source", "url": "https://www.cybereason.com/blog/threat-actor-ta505-targets-financial-enterprises-using-lolbins-and-a-new-backdoor-malware"}, {"source_name": "Source", "url": "https://e.cyberint.com/hubfs/Report%20Legit%20Remote%20Access%20Tools%20Turn%20Into%20Threat%20Actors%20Tools/CyberInt_Legit%20Remote%20Access%20Tools%20Turn%20Into%20Threat%20Actors'%20Tools_Report.pdf"}, {"source_name": "Source", "url": "https://threatpost.com/ta505-servhelper-malware/140792/"}, {"source_name": "Source", "url": "https://blog.yoroi.company/research/the-stealthy-email-stealer-in-the-ta505-arsenal/"}, {"source_name": "Source", "url": "https://threatrecon.nshc.net/2019/08/29/sectorj04-groups-increased-activity-in-2019/"}, {"source_name": "Source", "url": "https://www.proofpoint.com/us/threat-insight/post/ta505-distributes-new-sdbbot-remote-access-trojan-get2-downloader"}, {"source_name": "Source", "url": "https://www.blueliv.com/cyber-security-and-cyber-threat-intelligence-blog-blueliv/research/servhelper-evolution-and-new-ta505-campaigns/"}, {"source_name": "Source", "url": "https://www.telekom.com/en/blog/group/article/cybersecurity-ta505-s-box-of-chocolate-597672"}, {"source_name": "Source", "url": "https://www.telekom.com/en/blog/group/article/cybersecurity-ta505-returns-with-a-new-bag-of-tricks-602104"}, {"source_name": "Source", "url": "https://www.secureworks.com/research/threat-profiles/gold-tahoe"}, {"source_name": "Source", "url": "https://www.telekom.com/en/blog/group/article/eager-beaver-a-short-overview-of-the-restless-threat-actor-ta505-609546"}, {"source_name": "Source", "url": "https://blog.fox-it.com/2020/11/16/ta505-a-brief-history-of-their-time/"}, {"source_name": "Source", "url": "https://www.secureworks.com/blog/how-cyber-adversaries-are-adapting-to-exploit-the-global-pandemic"}, {"source_name": "Source", "url": "https://cyberthreat.thalesgroup.com/attackers/ATK103"}, {"source_name": "Source", "url": "https://securityintelligence.com/posts/ta505-continues-to-infect-networks-with-sdbbot-rat/"}, {"source_name": "Source", "url": "https://www.tenable.com/blog/cve-2020-1472-advanced-persistent-threat-actors-use-zerologon-vulnerability-in-exploit-chain"}]}, {"type": "attack-pattern", "spec_version": "2.1", "id": "attack-pattern--04fd5427-79c7-44ea-ae13-11b24778ff1c", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "created": "2020-03-14T23:36:52.095Z", "modified": "2023-03-03T00:31:33.071Z", "name": "Standard Encoding", "description": "Adversaries may encode data with a standard data encoding system to make the content of command and control traffic more difficult to detect. Command and control (C2) information can be encoded using a standard data encoding system that adheres to existing protocol specifications. Common data encoding schemes include ASCII, Unicode, hexadecimal, Base64, and MIME.(Citation: Wikipedia Binary-to-text Encoding)(Citation: Wikipedia Character Encoding) Some data encoding systems may also result in data compression, such as gzip.", "kill_chain_phases": [{"kill_chain_name": "mitre-attack", "phase_name": "command-and-control"}], "external_references": [{"source_name": "mitre-attack", "url": "https://attack.mitre.org/techniques/T1132/001", "external_id": "T1132.001"}, {"source_name": "University of Birmingham C2", "description": "Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.", "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"}, {"source_name": "Wikipedia Binary-to-text Encoding", "description": "Wikipedia. (2016, December 26). Binary-to-text encoding. Retrieved March 1, 2017.", "url": "https://en.wikipedia.org/wiki/Binary-to-text_encoding"}, {"source_name": "Wikipedia Character Encoding", "description": "Wikipedia. (2017, February 19). Character Encoding. Retrieved March 1, 2017.", "url": "https://en.wikipedia.org/wiki/Character_encoding"}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "x_mitre_attack_spec_version": "3.1.0", "x_mitre_data_sources": ["Network Traffic: Network Traffic Content"], "x_mitre_deprecated": false, "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)", "x_mitre_domains": ["enterprise-attack"], "x_mitre_is_subtechnique": true, "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "x_mitre_platforms": ["Linux", "macOS", "Windows"], "x_mitre_version": "1.0"}, {"type": "attack-pattern", "spec_version": "2.1", "id": "attack-pattern--2e34237d-8574-43f6-aace-ae2915de8597", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "created": "2020-03-02T19:05:18.137Z", "modified": "2023-03-30T21:01:42.995Z", "name": "Spearphishing Attachment", "description": "Adversaries may send spearphishing emails with a malicious attachment in an attempt to gain access to victim systems. Spearphishing attachment is a specific variant of spearphishing. Spearphishing attachment is different from other forms of spearphishing in that it employs the use of malware attached to an email. All forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this scenario, adversaries attach a file to the spearphishing email and usually rely upon [User Execution](https://attack.mitre.org/techniques/T1204) to gain execution. Spearphishing may also involve social engineering techniques, such as posing as a trusted source.\n\nThere are many options for the attachment such as Microsoft Office documents, executables, PDFs, or archived files. Upon opening the attachment (and potentially clicking past protections), the adversary's payload exploits a vulnerability or directly executes on the user's system. The text of the spearphishing email usually tries to give a plausible reason why the file should be opened, and may explain how to bypass system protections in order to do so. The email may also contain instructions on how to decrypt an attachment, such as a zip file password, in order to evade email boundary defenses. Adversaries frequently manipulate file extensions and icons in order to make attached executables appear to be document files, or files exploiting one application appear to be a file for a different one. ", "kill_chain_phases": [{"kill_chain_name": "mitre-attack", "phase_name": "initial-access"}], "external_references": [{"source_name": "mitre-attack", "url": "https://attack.mitre.org/techniques/T1566/001", "external_id": "T1566.001"}, {"source_name": "Microsoft Anti Spoofing", "description": "Microsoft. (2020, October 13). Anti-spoofing protection in EOP. Retrieved October 19, 2020.", "url": "https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/anti-spoofing-protection?view=o365-worldwide"}, {"source_name": "ACSC Email Spoofing", "description": "Australian Cyber Security Centre. (2012, December). Mitigating Spoofed Emails Using Sender Policy Framework. Retrieved October 19, 2020.", "url": "https://www.cyber.gov.au/sites/default/files/2019-03/spoof_email_sender_policy_framework.pdf"}, {"source_name": "Elastic - Koadiac Detection with EQL", "description": "Stepanic, D.. (2020, January 13). Embracing offensive tooling: Building detections against Koadic using EQL. Retrieved November 30, 2020.", "url": "https://www.elastic.co/blog/embracing-offensive-tooling-building-detections-against-koadic-using-eql"}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "x_mitre_attack_spec_version": "3.1.0", "x_mitre_contributors": ["Philip Winther"], "x_mitre_data_sources": ["Network Traffic: Network Traffic Flow", "Application Log: Application Log Content", "File: File Creation", "Network Traffic: Network Traffic Content"], "x_mitre_detection": "Network intrusion detection systems and email gateways can be used to detect spearphishing with malicious attachments in transit. Detonation chambers may also be used to identify malicious attachments. Solutions can be signature and behavior based, but adversaries may construct attachments in a way to avoid these systems.\n\nFiltering based on DKIM+SPF or header analysis can help detect when the email sender is spoofed.(Citation: Microsoft Anti Spoofing)(Citation: ACSC Email Spoofing)\n\nAnti-virus can potentially detect malicious documents and attachments as they're scanned to be stored on the email server or on the user's computer. Endpoint sensing or network sensing can potentially detect malicious events once the attachment is opened (such as a Microsoft Word document or PDF reaching out to the internet or spawning Powershell.exe) for techniques such as [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203) or usage of malicious scripts.\n\nMonitor for suspicious descendant process spawning from Microsoft Office and other productivity software.(Citation: Elastic - Koadiac Detection with EQL)", "x_mitre_domains": ["enterprise-attack"], "x_mitre_is_subtechnique": true, "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "x_mitre_platforms": ["macOS", "Windows", "Linux"], "x_mitre_version": "2.2"}, {"type": "attack-pattern", "spec_version": "2.1", "id": "attack-pattern--57340c81-c025-4189-8fa0-fc7ede51bae4", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "created": "2017-05-31T21:31:23.587Z", "modified": "2023-04-21T12:19:38.962Z", "name": "Modify Registry", "description": "Adversaries may interact with the Windows Registry to hide configuration information within Registry keys, remove information as part of cleaning up, or as part of other techniques to aid in persistence and execution.\n\nAccess to specific areas of the Registry depends on account permissions, some requiring administrator-level access. The built-in Windows command-line utility [Reg](https://attack.mitre.org/software/S0075) may be used for local or remote Registry modification. (Citation: Microsoft Reg) Other tools may also be used, such as a remote access tool, which may contain functionality to interact with the Registry through the Windows API.\n\nRegistry modifications may also include actions to hide keys, such as prepending key names with a null character, which will cause an error and/or be ignored when read via [Reg](https://attack.mitre.org/software/S0075) or other utilities using the Win32 API. (Citation: Microsoft Reghide NOV 2006) Adversaries may abuse these pseudo-hidden keys to conceal payloads/commands used to maintain persistence. (Citation: TrendMicro POWELIKS AUG 2014) (Citation: SpectorOps Hiding Reg Jul 2017)\n\nThe Registry of a remote system may be modified to aid in execution of files as part of lateral movement. It requires the remote Registry service to be running on the target system. (Citation: Microsoft Remote) Often [Valid Accounts](https://attack.mitre.org/techniques/T1078) are required, along with access to the remote system's [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002) for RPC communication.", "kill_chain_phases": [{"kill_chain_name": "mitre-attack", "phase_name": "defense-evasion"}], "external_references": [{"source_name": "mitre-attack", "url": "https://attack.mitre.org/techniques/T1112", "external_id": "T1112"}, {"source_name": "Microsoft Reg", "description": "Microsoft. (2012, April 17). Reg. Retrieved May 1, 2015.", "url": "https://technet.microsoft.com/en-us/library/cc732643.aspx"}, {"source_name": "Microsoft Remote", "description": "Microsoft. (n.d.). Enable the Remote Registry Service. Retrieved May 1, 2015.", "url": "https://technet.microsoft.com/en-us/library/cc754820.aspx"}, {"source_name": "Microsoft 4657 APR 2017", "description": "Miroshnikov, A. & Hall, J. (2017, April 18). 4657(S): A registry value was modified. Retrieved August 9, 2018.", "url": "https://docs.microsoft.com/windows/security/threat-protection/auditing/event-4657"}, {"source_name": "SpectorOps Hiding Reg Jul 2017", "description": "Reitz, B. (2017, July 14). Hiding Registry keys with PSReflect. Retrieved August 9, 2018.", "url": "https://posts.specterops.io/hiding-registry-keys-with-psreflect-b18ec5ac8353"}, {"source_name": "Microsoft Reghide NOV 2006", "description": "Russinovich, M. & Sharkey, K. (2006, January 10). Reghide. Retrieved August 9, 2018.", "url": "https://docs.microsoft.com/sysinternals/downloads/reghide"}, {"source_name": "Microsoft RegDelNull July 2016", "description": "Russinovich, M. & Sharkey, K. (2016, July 4). RegDelNull v1.11. Retrieved August 10, 2018.", "url": "https://docs.microsoft.com/en-us/sysinternals/downloads/regdelnull"}, {"source_name": "TrendMicro POWELIKS AUG 2014", "description": "Santos, R. (2014, August 1). POWELIKS: Malware Hides In Windows Registry. Retrieved August 9, 2018.", "url": "https://blog.trendmicro.com/trendlabs-security-intelligence/poweliks-malware-hides-in-windows-registry/"}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "x_mitre_attack_spec_version": "3.1.0", "x_mitre_contributors": ["Bartosz Jerzman", "Travis Smith, Tripwire", "David Lu, Tripwire"], "x_mitre_data_sources": ["Process: OS API Execution", "Process: Process Creation", "Windows Registry: Windows Registry Key Deletion", "Windows Registry: Windows Registry Key Modification", "Command: Command Execution", "Windows Registry: Windows Registry Key Creation"], "x_mitre_defense_bypassed": ["Host forensic analysis"], "x_mitre_deprecated": false, "x_mitre_detection": "Modifications to the Registry are normal and occur throughout typical use of the Windows operating system. Consider enabling Registry Auditing on specific keys to produce an alertable event (Event ID 4657) whenever a value is changed (though this may not trigger when values are created with Reghide or other evasive methods). (Citation: Microsoft 4657 APR 2017) Changes to Registry entries that load software on Windows startup that do not correlate with known software, patch cycles, etc., are suspicious, as are additions or changes to files within the startup folder. Changes could also include new services and modification of existing binary paths to point to malicious files. If a change to a service-related entry occurs, then it will likely be followed by a local or remote service start or restart to execute the file.\n\nMonitor processes and command-line arguments for actions that could be taken to change or delete information in the Registry. Remote access tools with built-in features may interact directly with the Windows API to gather information. The Registry may also be modified through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001), which may require additional logging features to be configured in the operating system to collect necessary information for analysis.\n\nMonitor for processes, command-line arguments, and API calls associated with concealing Registry keys, such as Reghide. (Citation: Microsoft Reghide NOV 2006) Inspect and cleanup malicious hidden Registry entries using Native Windows API calls and/or tools such as Autoruns (Citation: SpectorOps Hiding Reg Jul 2017) and RegDelNull (Citation: Microsoft RegDelNull July 2016).", "x_mitre_domains": ["enterprise-attack"], "x_mitre_is_subtechnique": false, "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "x_mitre_platforms": ["Windows"], "x_mitre_version": "1.3"}, {"type": "attack-pattern", "spec_version": "2.1", "id": "attack-pattern--6faf650d-bf31-4eb4-802d-1000cf38efaf", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "created": "2017-05-31T21:31:37.917Z", "modified": "2023-03-30T21:01:37.205Z", "name": "Video Capture", "description": "An adversary can leverage a computer's peripheral devices (e.g., integrated cameras or webcams) or applications (e.g., video call services) to capture video recordings for the purpose of gathering information. Images may also be captured from devices or applications, potentially in specified intervals, in lieu of video files.\n\nMalware or scripts may be used to interact with the devices through an available API provided by the operating system or an application to capture video or images. Video or image files may be written to disk and exfiltrated later. This technique differs from [Screen Capture](https://attack.mitre.org/techniques/T1113) due to use of specific devices or applications for video recording rather than capturing the victim's screen.\n\nIn macOS, there are a few different malware samples that record the user's webcam such as FruitFly and Proton. (Citation: objective-see 2017 review)", "kill_chain_phases": [{"kill_chain_name": "mitre-attack", "phase_name": "collection"}], "external_references": [{"source_name": "mitre-attack", "url": "https://attack.mitre.org/techniques/T1125", "external_id": "T1125"}, {"source_name": "objective-see 2017 review", "description": "Patrick Wardle. (n.d.). Retrieved March 20, 2018.", "url": "https://objective-see.com/blog/blog_0x25.html"}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "x_mitre_attack_spec_version": "3.1.0", "x_mitre_contributors": ["Praetorian"], "x_mitre_data_sources": ["Command: Command Execution", "Process: OS API Execution"], "x_mitre_detection": "Detection of this technique may be difficult due to the various APIs that may be used. Telemetry data regarding API use may not be useful depending on how a system is normally used, but may provide context to other potentially malicious activity occurring on a system.\n\nBehavior that could indicate technique use include an unknown or unusual process accessing APIs associated with devices or software that interact with the video camera, recording devices, or recording software, and a process periodically writing files to disk that contain video or camera image data.", "x_mitre_domains": ["enterprise-attack"], "x_mitre_is_subtechnique": false, "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "x_mitre_permissions_required": ["User"], "x_mitre_platforms": ["Windows", "macOS", "Linux"], "x_mitre_version": "1.1"}, {"type": "attack-pattern", "spec_version": "2.1", "id": "attack-pattern--a62a8db3-f23a-4d8f-afd6-9dbc77e7813b", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "created": "2020-03-02T18:45:07.892Z", "modified": "2023-04-14T17:42:15.871Z", "name": "Phishing", "description": "Adversaries may send phishing messages to gain access to victim systems. All forms of phishing are electronically delivered social engineering. Phishing can be targeted, known as spearphishing. In spearphishing, a specific individual, company, or industry will be targeted by the adversary. More generally, adversaries can conduct non-targeted phishing, such as in mass malware spam campaigns.\n\nAdversaries may send victims emails containing malicious attachments or links, typically to execute malicious code on victim systems. Phishing may also be conducted via third-party services, like social media platforms. Phishing may also involve social engineering techniques, such as posing as a trusted source, as well as evasive techniques such as removing or manipulating emails or metadata/headers from compromised accounts being abused to send messages (e.g., [Email Hiding Rules](https://attack.mitre.org/techniques/T1564/008)).(Citation: Microsoft OAuth Spam 2022)(Citation: Palo Alto Unit 42 VBA Infostealer 2014) Another way to accomplish this is by forging or spoofing(Citation: Proofpoint-spoof) the identity of the sender which can be used to fool both the human recipient as well as automated security tools.(Citation: cyberproof-double-bounce) \n\nVictims may also receive phishing messages that instruct them to call a phone number where they are directed to visit a malicious URL, download malware,(Citation: sygnia Luna Month)(Citation: CISA Remote Monitoring and Management Software) or install adversary-accessible remote management tools onto their computer (i.e., [User Execution](https://attack.mitre.org/techniques/T1204)).(Citation: Unit42 Luna Moth)", "kill_chain_phases": [{"kill_chain_name": "mitre-attack", "phase_name": "initial-access"}], "external_references": [{"source_name": "mitre-attack", "url": "https://attack.mitre.org/techniques/T1566", "external_id": "T1566"}, {"source_name": "ACSC Email Spoofing", "description": "Australian Cyber Security Centre. (2012, December). Mitigating Spoofed Emails Using Sender Policy Framework. Retrieved October 19, 2020.", "url": "https://www.cyber.gov.au/sites/default/files/2019-03/spoof_email_sender_policy_framework.pdf"}, {"source_name": "CISA Remote Monitoring and Management Software", "description": "CISA. (n.d.). Protecting Against Malicious Use of Remote Monitoring and Management Software. Retrieved February 2, 2023.", "url": "https://www.cisa.gov/uscert/ncas/alerts/aa23-025a"}, {"source_name": "cyberproof-double-bounce", "description": "Itkin, Liora. (2022, September 1). Double-bounced attacks with email spoofing . Retrieved February 24, 2023.", "url": "https://blog.cyberproof.com/blog/double-bounced-attacks-with-email-spoofing-2022-trends"}, {"source_name": "Unit42 Luna Moth", "description": "Kristopher Russo. (n.d.). Luna Moth Callback Phishing Campaign. Retrieved February 2, 2023.", "url": "https://unit42.paloaltonetworks.com/luna-moth-callback-phishing/"}, {"source_name": "Microsoft Anti Spoofing", "description": "Microsoft. (2020, October 13). Anti-spoofing protection in EOP. Retrieved October 19, 2020.", "url": "https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/anti-spoofing-protection?view=o365-worldwide"}, {"source_name": "Microsoft OAuth Spam 2022", "description": "Microsoft. (2023, September 22). Malicious OAuth applications abuse cloud email services to spread spam. Retrieved March 13, 2023.", "url": "https://www.microsoft.com/en-us/security/blog/2022/09/22/malicious-oauth-applications-used-to-compromise-email-servers-and-spread-spam/"}, {"source_name": "sygnia Luna Month", "description": "Oren Biderman, Tomer Lahiyani, Noam Lifshitz, Ori Porag. (n.d.). LUNA MOTH: THE THREAT ACTORS BEHIND RECENT FALSE SUBSCRIPTION SCAMS. Retrieved February 2, 2023.", "url": "https://blog.sygnia.co/luna-moth-false-subscription-scams"}, {"source_name": "Proofpoint-spoof", "description": "Proofpoint. (n.d.). What Is Email Spoofing?. Retrieved February 24, 2023.", "url": "https://www.proofpoint.com/us/threat-reference/email-spoofing"}, {"source_name": "Palo Alto Unit 42 VBA Infostealer 2014", "description": "Vicky Ray and Rob Downs. (2014, October 29). Examining a VBA-Initiated Infostealer Campaign. Retrieved March 13, 2023.", "url": "https://unit42.paloaltonetworks.com/examining-vba-initiated-infostealer-campaign/"}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "x_mitre_attack_spec_version": "3.1.0", "x_mitre_contributors": ["Philip Winther", "Ohad Zaidenberg, @ohad_mz", "Liora Itkin", "Liran Ravich, CardinalOps", "Scott Cook, Capital One"], "x_mitre_data_sources": ["Application Log: Application Log Content", "File: File Creation", "Network Traffic: Network Traffic Content", "Network Traffic: Network Traffic Flow"], "x_mitre_deprecated": false, "x_mitre_detection": "Network intrusion detection systems and email gateways can be used to detect phishing with malicious attachments in transit. Detonation chambers may also be used to identify malicious attachments. Solutions can be signature and behavior based, but adversaries may construct attachments in a way to avoid these systems.\n\nFiltering based on DKIM+SPF or header analysis can help detect when the email sender is spoofed.(Citation: Microsoft Anti Spoofing)(Citation: ACSC Email Spoofing)\n\nURL inspection within email (including expanding shortened links) can help detect links leading to known malicious sites. Detonation chambers can be used to detect these links and either automatically go to these sites to determine if they're potentially malicious, or wait and capture the content if a user visits the link.\n\nBecause most common third-party services used for phishing via service leverage TLS encryption, SSL/TLS inspection is generally required to detect the initial communication/delivery. With SSL/TLS inspection intrusion detection signatures or other security gateway appliances may be able to detect malware.\n\nAnti-virus can potentially detect malicious documents and files that are downloaded on the user's computer. Many possible detections of follow-on behavior may take place once [User Execution](https://attack.mitre.org/techniques/T1204) occurs.", "x_mitre_domains": ["enterprise-attack"], "x_mitre_is_subtechnique": false, "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "x_mitre_platforms": ["Linux", "macOS", "Windows", "SaaS", "Office 365", "Google Workspace"], "x_mitre_version": "2.3"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--a36555cb-8add-43be-a33c-f962b0bfdbdb", "created": "2023-10-09T05:29:08.978905Z", "modified": "2023-10-09T05:29:08.978905Z", "relationship_type": "uses", "source_ref": "malware--94339b04-9332-4691-b820-5021368f1d3a", "target_ref": "attack-pattern--a62a8db3-f23a-4d8f-afd6-9dbc77e7813b"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--2b7379c8-7c83-4376-a362-f256fabd68d7", "created": "2023-10-09T05:29:08.979259Z", "modified": "2023-10-09T05:29:08.979259Z", "relationship_type": "uses", "source_ref": "malware--94339b04-9332-4691-b820-5021368f1d3a", "target_ref": "attack-pattern--a62a8db3-f23a-4d8f-afd6-9dbc77e7813b"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--74245dc1-1e4b-4b06-bf17-6216972008df", "created": "2023-10-09T05:29:08.9795Z", "modified": "2023-10-09T05:29:08.9795Z", "relationship_type": "uses", "source_ref": "malware--94339b04-9332-4691-b820-5021368f1d3a", "target_ref": "attack-pattern--a62a8db3-f23a-4d8f-afd6-9dbc77e7813b"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--c501cf08-3247-4c65-8598-22822e855423", "created": "2023-10-09T05:29:08.979751Z", "modified": "2023-10-09T05:29:08.979751Z", "relationship_type": "uses", "source_ref": "malware--94339b04-9332-4691-b820-5021368f1d3a", "target_ref": "attack-pattern--57340c81-c025-4189-8fa0-fc7ede51bae4"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--a1e8a44b-d902-4ddb-bc20-571e5b161086", "created": "2023-10-09T05:29:08.980034Z", "modified": "2023-10-09T05:29:08.980034Z", "relationship_type": "uses", "source_ref": "threat-actor--03c80674-35f8-4fe0-be2b-226ed0fcd69f", "target_ref": "malware--94339b04-9332-4691-b820-5021368f1d3a"}]}