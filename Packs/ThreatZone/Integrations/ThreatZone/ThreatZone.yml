commonfields:
  id: ThreatZone
  version: -1
name: ThreatZone
display: Malwation ThreatZone
category: Forensics & Malware Analysis
description: ThreatZone malware analysis sandboxing.
configuration:
- display: Server URL (e.g. https://app.threat.zone)
  name: url
  defaultvalue: https://app.threat.zone
  type: 0
  required: true
- display: ThreatZone API Key
  name: apikey
  type: 4
  required: true
- display: Source Reliability
  name: integrationReliability
  type: 15
  additionalinfo: Reliability of the source.
  defaultvalue: A - Completely reliable
  options:
  - A+ - 3rd party enrichment
  - A - Completely reliable
  - B - Usually reliable
  - C - Fairly reliable
  - D - Not usually reliable
  - E - Unreliable
  - F - Reliability cannot be judged
  required: false
- display: Trust any certificate (not secure)
  name: insecure
  defaultvalue: "false"
  type: 8
  required: false
- display: Use system proxy settings
  name: proxy
  defaultvalue: "false"
  type: 8
  required: false
script:
  script: '-'
  type: python
  commands:
  - name: tz-sandbox-upload-sample
    arguments:
    - name: environment
      required: true
      auto: PREDEFINED
      predefined:
      - w7_x64
      - w10_x64
      - w11_x64
      description: Choose what environment you want to run your submission.
      defaultValue: w7_x64
    - name: private
      required: true
      auto: PREDEFINED
      predefined:
      - "true"
      - "false"
      description: Privacy of the submission.
      defaultValue: "true"
    - name: entry_id
      description: Entry ID of the file to submit.
      predefined:
      - ''
      required: true
    - name: timeout
      auto: PREDEFINED
      predefined:
      - "60"
      - "120"
      - "180"
      - "300"
      description: Duration of the submission analysis.
      defaultValue: "60"
    - name: work_path
      auto: PREDEFINED
      predefined:
      - desktop
      - root
      - appdata
      - windows
      - temp
      description: The working path of the submission.
      defaultValue: desktop
    - name: mouse_simulation
      auto: PREDEFINED
      predefined:
      - "true"
      - "false"
      description: Enable mouse simulation.
      defaultValue: "false"
    - name: https_inspection
      auto: PREDEFINED
      predefined:
      - "true"
      - "false"
      description: Https inspection to read encrypted traffic.
      defaultValue: "false"
    - name: internet_connection
      auto: PREDEFINED
      predefined:
      - "true"
      - "false"
      description: Enable internet connection.
      defaultValue: "false"
    - name: raw_logs
      auto: PREDEFINED
      predefined:
      - "true"
      - "false"
      description: Raw logs.
      defaultValue: "false"
    - name: snapshot
      auto: PREDEFINED
      predefined:
      - "true"
      - "false"
      description: Snapshot.
      defaultValue: "false"
    outputs:
    - contextPath: ThreatZone.Analysis.UUID
      description: UUID of sample.
      type: String
    - contextPath: ThreatZone.Analysis.URL
      description: URL of analysis of sample.
      type: String
    description: Submits a sample to ThreatZone for sandbox analysis.
  - name: tz-static-upload-sample
    arguments:
    - name: entry_id
      description: Entry ID of the file to submit.
      predefined:
      - ''
      required: true
    outputs:
    - contextPath: ThreatZone.Analysis.UUID
      description: UUID of sample.
      type: String
    - contextPath: ThreatZone.Analysis.URL
      description: URL of analysis of sample.
      type: String
    description: Submits a sample to ThreatZone for static analysis.
  - name: tz-cdr-upload-sample
    arguments:
    - name: entry_id
      description: Entry ID of the file to submit.
      predefined:
      - ''
      required: true
    outputs:
    - contextPath: ThreatZone.Analysis.UUID
      description: UUID of sample.
      type: String
    - contextPath: ThreatZone.Analysis.URL
      description: URL of analysis of sample.
      type: String
    description: Submits a sample to ThreatZone for CDR.
  - name: tz-get-result
    arguments:
    - name: uuid
      required: true
      description: UUID of the submission.
    outputs:
    - contextPath: ThreatZone.Result.STATUS
      description: The status of the submission scanning process.
      type: String
    - contextPath: ThreatZone.Result.LEVEL
      description: Threat Level of the scanned file. (malicious, suspicious or informative).
      type: String
    - contextPath: ThreatZone.Result.URL
      description: The result page url of the submission.
      type: String
    - contextPath: ThreatZone.Result.INFO
      description: Contains the file name, scan process status and public status.
      type: String
    - contextPath: ThreatZone.Result.REPORT
      description: The analysis report of the submission.
      type: String
    - contextPath: ThreatZone.Result.MD5
      description: The md5 hash of the submission.
      type: String
    - contextPath: ThreatZone.Result.SHA1
      description: The sha1 hash of the submission.
      type: String
    - contextPath: ThreatZone.Result.SHA256
      description: The sha256 hash of the submission.
      type: String
    - contextPath: ThreatZone.Result.UUID
      description: The UUID of the submission.
      type: String
    - contextPath: ThreatZone.Result.SANITIZED
      description: The url of the sanitized file.
      type: String
    description: Retrive the analysis result from ThreatZone.
  - name: tz-check-limits
    arguments: []
    description: Check the plan limits from ThreatZone API.
    outputs:
    - contextPath: ThreatZone.Limits.API_Limit
      description: The remaining/total API request limits of the current plan.
      type: String
    - contextPath: ThreatZone.Limits.Concurrent_Limit
      description: The remaining/total concurrent analysis limits of the current plan.
      type: String
    - contextPath: ThreatZone.Limits.Daily_Submission_Limit
      description: The remaining/total daily submission limits of the current plan.
      type: String
  dockerimage: demisto/python3:3.10.13.74666
  runonce: false
  subtype: python3
fromversion: 6.9.0
tests:
- No tests (auto formatted)
