  alert_category: PRIVILEGE_ESCALATION
  alert_description: User''s permissions have changed from Guest to Owner
  alert_fields:
    actor_image: null
    actor_path: null
    cmd: null
    domain: null
    hash: null
    hostname: null
    local_ip: null
    remote_ip: xdm.source.ipv4
    remote_port: null
    username: xdm.target.resource.name
  alert_name: Gitlab - Guest user permission change
  crontab: null
  dataset: alerts
  description: Alert for change in user''s permissions change from Guest to Owner.
  drilldown_query_timeframe: ALERT
  execution_mode: REAL_TIME
  global_rule_id: 1ed16048-8af4-4ff6-a7df-665a08390b45
  investigation_query_link: "datamodel dataset in(gitlab_gitlab_raw )\r\n| fields\
    \ _time\r\n,xdm.event.id \r\n,xdm.source.user.identifier \r\n,xdm.target.resource.id\
    \ \r\n,xdm.target.resource.type \r\n,xdm.source.user.username \r\n,xdm.target.resource.sub_type\
    \ \r\n,xdm.target.resource.name \r\n,xdm.event.description \r\n,xdm.source.ipv4\
    \ \r\n,xdm.target.resource_before.value \r\n,xdm.target.resource.value \r\n,xdm.event.operation\
    \ \r\n,xdm.event.type \r\n,xdm.event.operation_sub_type \r\n| filter xdm.event.operation\
    \ = \"change_access_level\" and xdm.target.resource_before.value = \"Guest\" and\
    \ xdm.target.resource.value = \"Owner\""
  mapping_strategy: CUSTOM
  mitre_defs: {}
  name: Gitlab - User Permission Changed
  search_window: null
  severity: SEV_030_MEDIUM
  suppression_duration: null
  suppression_enabled: false
  suppression_fields: null
  user_defined_category: null
  user_defined_severity: null
  xql_query: "datamodel\r\n| filter xdm.observer.vendor = \"gitlab\" and xdm.observer.product = \"gitlab\"\r\n| fields _time\r\n,xdm.event.id\
    \ \r\n,xdm.source.user.identifier \r\n,xdm.target.resource.id \r\n,xdm.target.resource.type\
    \ \r\n,xdm.source.user.username \r\n,xdm.target.resource.sub_type \r\n,xdm.target.resource.name\
    \ \r\n,xdm.event.description \r\n,xdm.source.ipv4 \r\n,xdm.target.resource_before.value\
    \ \r\n,xdm.target.resource.value \r\n,xdm.event.operation \r\n,xdm.event.type\
    \ \r\n,xdm.event.operation_sub_type \r\n| filter xdm.event.operation = \"change_access_level\"\
    \ and xdm.target.resource_before.value = \"Guest\" and xdm.target.resource.value\
    \ = \"Owner\""
