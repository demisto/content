id: Cisco Umbrella Test
version: -1
name: Cisco Umbrella Test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: b92bbb38-b67f-4789-8e10-07cef2591a95
    type: start
    task:
      id: b92bbb38-b67f-4789-8e10-07cef2591a95
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "50"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 864f2f88-9cae-494a-8757-f2b6e190344b
    type: title
    task:
      id: 864f2f88-9cae-494a-8757-f2b6e190344b
      version: -1
      name: Legacy Commands
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
      - "3"
      - "4"
      - "5"
      - "6"
      - "7"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: 38266c2a-1ec6-4c65-88a8-c2ad02e9b1c7
    type: regular
    task:
      id: 38266c2a-1ec6-4c65-88a8-c2ad02e9b1c7
      version: -1
      name: umbrella-domain-categorization
      script: '|||umbrella-domain-categorization'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      domain:
        simple: cnn.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1330,
          "y": 420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: e1971be9-5e86-4574-8c72-4b760a9a9c60
    type: regular
    task:
      id: e1971be9-5e86-4574-8c72-4b760a9a9c60
      version: -1
      name: umbrella-domain-co-occurrences
      script: '|||umbrella-domain-co-occurrences'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      domain:
        simple: apple.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -650,
          "y": 420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 695193eb-3744-4daa-870e-898b522c9e1b
    type: regular
    task:
      id: 695193eb-3744-4daa-870e-898b522c9e1b
      version: -1
      name: umbrella-domain-related
      script: '|||umbrella-domain-related'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      domain:
        simple: google.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 410c06b0-41b6-4deb-8354-8df2378451d6
    type: regular
    task:
      id: 410c06b0-41b6-4deb-8354-8df2378451d6
      version: -1
      name: umbrella-domain-security
      script: '|||umbrella-domain-security'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      domain:
        simple: cnn.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 900,
          "y": 420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: aa44db69-1ff6-448f-8227-e12765e62cbe
    type: regular
    task:
      id: aa44db69-1ff6-448f-8227-e12765e62cbe
      version: -1
      name: umbrella-domain-dns-history
      script: '|||umbrella-domain-dns-history'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      domain:
        simple: cnn.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1650,
          "y": 420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: d140e0b7-4dd9-452c-839c-095fe2883fe0
    type: regular
    task:
      id: d140e0b7-4dd9-452c-839c-095fe2883fe0
      version: -1
      name: umbrella-ip-dns-history
      script: '|||umbrella-ip-dns-history'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      ip:
        simple: 1.2.3.99
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2330,
          "y": 420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 1649f1c1-89a8-42e0-8e51-9bb777e5ac2b
    type: condition
    task:
      id: 1649f1c1-89a8-42e0-8e51-9bb777e5ac2b
      version: -1
      name: Test Domain Categorization Context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "9"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Domain.ContentCategories
            iscontext: true
          right:
            value:
              simple: News/Media
    view: |-
      {
        "position": {
          "x": -1330,
          "y": 620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: af2fb11c-d0d0-4d6a-8faf-da0a509487e6
    type: regular
    task:
      id: af2fb11c-d0d0-4d6a-8faf-da0a509487e6
      version: -1
      name: Delete Context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "15"
      - "18"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: 7b3e9d03-4957-442f-8764-d06c24674b60
    type: condition
    task:
      id: 7b3e9d03-4957-442f-8764-d06c24674b60
      version: -1
      name: Test domain co-occurrences context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "9"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Domain.Name
            iscontext: true
          right:
            value:
              simple: apple.com
    view: |-
      {
        "position": {
          "x": -650,
          "y": 620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: c7c82e13-d5ee-444a-82b5-f7c01b98ef57
    type: condition
    task:
      id: c7c82e13-d5ee-444a-82b5-f7c01b98ef57
      version: -1
      name: Test related domains context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "9"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: in
          left:
            value:
              simple: Domain.Related.Name
            iscontext: true
          right:
            value:
              simple: google.com
        - operator: in
          left:
            value:
              simple: Domain.Related.Name
            iscontext: true
          right:
            value:
              simple: www.google.com
        - operator: in
          left:
            value:
              simple: Domain.Related.Name
            iscontext: true
          right:
            value:
              simple: yahoo.com
    view: |-
      {
        "position": {
          "x": 40,
          "y": 600
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: 676fe27b-ab9c-46ee-82d6-6c9b5b5355d2
    type: condition
    task:
      id: 676fe27b-ab9c-46ee-82d6-6c9b5b5355d2
      version: -1
      name: Test domain security context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "9"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Domain.Security.DGA
            iscontext: true
          right:
            value:
              simple: "0"
    view: |-
      {
        "position": {
          "x": 900,
          "y": 600
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: a710e45e-fad0-4b7c-892a-571d33312426
    type: condition
    task:
      id: a710e45e-fad0-4b7c-892a-571d33312426
      version: -1
      name: Test domain dns history context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "9"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Domain.DNSHistory.BaseDomain
            iscontext: true
          right:
            value:
              simple: cnn.com
    view: |-
      {
        "position": {
          "x": 1650,
          "y": 600
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 695d7328-4583-401a-83c0-5c42405e5089
    type: condition
    task:
      id: 695d7328-4583-401a-83c0-5c42405e5089
      version: -1
      name: Test ip dns history context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "9"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: IP.DNSHistory.RRS.Class
            iscontext: true
          right:
            value:
              simple: IN
    view: |-
      {
        "position": {
          "x": 2330,
          "y": 600
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: a3285687-c6b4-4d19-853e-7708118c4d8d
    type: regular
    task:
      id: a3285687-c6b4-4d19-853e-7708118c4d8d
      version: -1
      name: umbrella-ip-malicious-domains
      script: '|||umbrella-ip-malicious-domains'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      ip:
        simple: 8.8.8.8
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -50,
          "y": 1390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: dc4e5c7e-ea9a-47cd-8e9d-2dd28a2c0d58
    type: condition
    task:
      id: dc4e5c7e-ea9a-47cd-8e9d-2dd28a2c0d58
      version: -1
      name: Test IP malicious domains context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "17"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: Domain.Malicious.Vendor
            iscontext: true
          right:
            value:
              simple: Cisco Umbrella Investigate
      - - operator: containsGeneral
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "3"
        - operator: containsGeneral
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "2"
        - operator: containsGeneral
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "1"
        - operator: containsGeneral
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "0"
    view: |-
      {
        "position": {
          "x": -50,
          "y": 1590
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: 323b2edb-24b1-44a5-80e9-976b93d89d28
    type: regular
    task:
      id: 323b2edb-24b1-44a5-80e9-976b93d89d28
      version: -1
      name: Delete Context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "51"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 470,
          "y": 1900
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: 41f9b57a-0896-4a6c-882b-7959da68d31e
    type: regular
    task:
      id: 41f9b57a-0896-4a6c-882b-7959da68d31e
      version: -1
      name: umbrella-domain-search
      description: Regex search in the service, may take up to 10 sec to retrieve
        results due to the nature of regex.
      script: '|||umbrella-domain-search'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      regex:
        simple: googleapi.*
      start:
        simple: -7days
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 940,
          "y": 1390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: 416a0a50-113e-49d6-80a8-f263353afe69
    type: condition
    task:
      id: 416a0a50-113e-49d6-80a8-f263353afe69
      version: -1
      name: Test domain search context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "17"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: startWith
          left:
            value:
              simple: Domain.Name
            iscontext: true
          right:
            value:
              simple: googleapi
    view: |-
      {
        "position": {
          "x": 940,
          "y": 1570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 93c4b398-9f81-4ac3-8761-01c561719ded
    type: regular
    task:
      id: 93c4b398-9f81-4ac3-8761-01c561719ded
      version: -1
      name: Domain reputation
      script: Cisco Umbrella Investigate|||domain
      type: regular
      iscommand: true
      brand: Cisco Umbrella Investigate
    nexttasks:
      '#none#':
      - "21"
    scriptarguments:
      domain:
        simple: gauttam.com,google.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 470,
          "y": 2190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: 2cc68a85-780b-41f4-8df1-253a6579ca22
    type: condition
    task:
      id: 2cc68a85-780b-41f4-8df1-253a6579ca22
      version: -1
      name: Test domain reputation context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "22"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualNumber
          left:
            value:
              complex:
                root: Domain
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: Domain.Name
                      iscontext: true
                    right:
                      value:
                        simple: gauttam.com
                accessor: Umbrella.RiskScore
            iscontext: true
          right:
            value:
              simple: "0"
      - - operator: isEqualNumber
          left:
            value:
              complex:
                root: DBotScore
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DBotScore.Indicator
                      iscontext: true
                    right:
                      value:
                        simple: gauttam.com
                accessor: Score
            iscontext: true
          right:
            value:
              simple: "2"
    view: |-
      {
        "position": {
          "x": 470,
          "y": 2350
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 04ef9f98-037b-4056-82da-c9c6739fea3d
    type: regular
    task:
      id: 04ef9f98-037b-4056-82da-c9c6739fea3d
      version: -1
      name: Delete context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "23"
      - "24"
      - "25"
      - "26"
      - "27"
      - "28"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 470,
          "y": 2550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: ea88bc95-f984-4ca4-8d07-c23a2a1eefcc
    type: regular
    task:
      id: ea88bc95-f984-4ca4-8d07-c23a2a1eefcc
      version: -1
      name: umbrella-get-related-domains
      script: '|||umbrella-get-related-domains'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      coOccurences:
        simple: "true"
      domain:
        simple: walla.co.il
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1580,
          "y": 2750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: 1c124ee8-5b67-4e6f-8a4e-2874869fa35f
    type: regular
    task:
      id: 1c124ee8-5b67-4e6f-8a4e-2874869fa35f
      version: -1
      name: umbrella-get-domain-classifiers
      script: '|||umbrella-get-domain-classifiers'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      domain:
        simple: cosmos.furnipict.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -830,
          "y": 2750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "25":
    id: "25"
    taskid: 673d0e9e-97a6-44e9-810d-22897fae4639
    type: regular
    task:
      id: 673d0e9e-97a6-44e9-810d-22897fae4639
      version: -1
      name: umbrella-get-domain-queryvolume
      script: '|||umbrella-get-domain-queryvolume'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "33"
    scriptarguments:
      domain:
        simple: walla.com
      match:
        simple: all
      start:
        simple: -7days
      stop:
        simple: now
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -90,
          "y": 2750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: bb3a6192-9c40-4f72-80c1-574b317e6417
    type: regular
    task:
      id: bb3a6192-9c40-4f72-80c1-574b317e6417
      version: -1
      name: umbrella-get-domain-details
      script: '|||umbrella-get-domain-details'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      domain:
        simple: cnn.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1050,
          "y": 2750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: f604e7ce-1e42-4ecd-84e4-c0f9c85137c9
    type: regular
    task:
      id: f604e7ce-1e42-4ecd-84e4-c0f9c85137c9
      version: -1
      name: umbrella-get-domains-for-email-registrar
      script: '|||umbrella-get-domains-for-email-registrar'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "35"
    scriptarguments:
      emails:
        simple: dns@google.com,SomeMail@gmail.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1850,
          "y": 2750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: 039e94b3-d3d7-49cb-819f-510a2171e4c6
    type: regular
    task:
      id: 039e94b3-d3d7-49cb-819f-510a2171e4c6
      version: -1
      name: umbrella-get-domains-for-nameserver
      script: '|||umbrella-get-domains-for-nameserver'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      limit:
        simple: "5"
      nameservers:
        simple: ns1.google.com
      sort:
        simple: created
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2530,
          "y": 2750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: f42e9400-3a48-4b3e-856f-76c6f57357d6
    type: regular
    task:
      id: f42e9400-3a48-4b3e-856f-76c6f57357d6
      version: -1
      name: Delete Context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "37"
      - "38"
      - "39"
      - "40"
      - "41"
      - "42"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 410,
          "y": 3330
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: c4d3e103-fd85-4299-829b-7ebf46a03fff
    type: condition
    task:
      id: c4d3e103-fd85-4299-829b-7ebf46a03fff
      version: -1
      name: Test umbrella-get-related-domains Context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "30"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Umbrella.RelatedDomains.Domain
            iscontext: true
          right:
            value:
              simple: walla.co.il
    view: |-
      {
        "position": {
          "x": -1580,
          "y": 2970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: dd7c3e2d-b851-432d-83e3-164a07f6cf55
    type: condition
    task:
      id: dd7c3e2d-b851-432d-83e3-164a07f6cf55
      version: -1
      name: Test umbrella-get-domain-classifiers Context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "30"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Umbrella.DomainClassifiers.Data.MalwareCategories
            iscontext: true
          right:
            value:
              simple: Malware
    view: |-
      {
        "position": {
          "x": -830,
          "y": 2970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: 04617739-2fbe-43e9-80c0-9fe1c57a671a
    type: condition
    task:
      id: 04617739-2fbe-43e9-80c0-9fe1c57a671a
      version: -1
      name: Test umbrella-get-domain-queryvolume Context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "30"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEqualString
          left:
            value:
              simple: Umbrella.QueryVolume.Data.QueriesInfo.Queries
            iscontext: true
          right:
            value:
              simple: "0"
    view: |-
      {
        "position": {
          "x": -90,
          "y": 2970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: 14bc432c-8020-49a0-89e1-857a41442638
    type: condition
    task:
      id: 14bc432c-8020-49a0-89e1-857a41442638
      version: -1
      name: Test umbrella-get-domain-details Context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "30"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Umbrella.DomainDetails.Data.DGA
            iscontext: true
          right:
            value:
              simple: "0"
    view: |-
      {
        "position": {
          "x": 1050,
          "y": 2970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: ddc8ec81-2587-4519-83db-fd0bbe0dad08
    type: condition
    task:
      id: ddc8ec81-2587-4519-83db-fd0bbe0dad08
      version: -1
      name: Test umbrella-get-domains-for-email-registrar Context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "30"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: Umbrella.AssociatedDomains.Data.Domains.Name
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1850,
          "y": 2970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: f9e6b969-828c-4c37-8b43-ea18017c03de
    type: condition
    task:
      id: f9e6b969-828c-4c37-8b43-ea18017c03de
      version: -1
      name: Test umbrella-get-domains-for-nameserver Context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "30"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Umbrella.AssociatedDomains.Data.Domains.Name
            iscontext: true
          right:
            value:
              simple: google.cr
        - operator: isEqualString
          left:
            value:
              simple: Umbrella.AssociatedDomains.Data.Domains.Name.ContentCategories
            iscontext: true
          right:
            value:
              simple: Search Engines
    view: |-
      {
        "position": {
          "x": 2530,
          "y": 2970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: 06dd5e3d-65ba-4bc3-87e9-bb221facfd82
    type: regular
    task:
      id: 06dd5e3d-65ba-4bc3-87e9-bb221facfd82
      version: -1
      name: umbrella-get-whois-for-domain
      script: '|||umbrella-get-whois-for-domain'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "43"
    scriptarguments:
      domain:
        simple: cnn.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1580,
          "y": 3580
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: 4209cd31-3fa6-49eb-8bc4-9d606a015d39
    type: regular
    task:
      id: 4209cd31-3fa6-49eb-8bc4-9d606a015d39
      version: -1
      name: umbrella-get-malicious-domains-for-ip
      script: '|||umbrella-get-malicious-domains-for-ip'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "45"
    scriptarguments:
      ip:
        simple: 8.8.8.8
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -840,
          "y": 3580
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: 372ca09e-e238-48c8-87b5-17ae833ef714
    type: regular
    task:
      id: 372ca09e-e238-48c8-87b5-17ae833ef714
      version: -1
      name: umbrella-get-domains-using-regex
      script: '|||umbrella-get-domains-using-regex'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "46"
    scriptarguments:
      expression:
        simple: google.*.com
      includeCategory:
        simple: "true"
      limit:
        simple: "100"
      start:
        simple: -1days
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -90,
          "y": 3580
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: d8940a45-fbe0-4d27-8fc3-883e79bb1b93
    type: regular
    task:
      id: d8940a45-fbe0-4d27-8fc3-883e79bb1b93
      version: -1
      name: umbrella-get-domain-timeline
      script: '|||umbrella-get-domain-timeline'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "47"
    scriptarguments:
      domain:
        simple: cosmos.furnipict.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1050,
          "y": 3580
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: 925003d9-11b5-44e2-87bc-f397a7ccdf01
    type: regular
    task:
      id: 925003d9-11b5-44e2-87bc-f397a7ccdf01
      version: -1
      name: umbrella-get-ip-timeline
      script: '|||umbrella-get-ip-timeline'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "48"
    scriptarguments:
      ip:
        simple: 1.2.3.4
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1850,
          "y": 3580
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: 584709fc-0b6b-44f7-8596-ab4a0e19549b
    type: regular
    task:
      id: 584709fc-0b6b-44f7-8596-ab4a0e19549b
      version: -1
      name: umbrella-get-url-timeline
      script: '|||umbrella-get-url-timeline'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "49"
    scriptarguments:
      url:
        simple: http://gauttam.com/wp-includes/
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2530,
          "y": 3580
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: da96b158-877a-447a-897a-2fa75d541a9a
    type: condition
    task:
      id: da96b158-877a-447a-897a-2fa75d541a9a
      version: -1
      name: Test umbrella-get-whois-for-domain Context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "44"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Domain.Umbrella.Whois.IANAID
            iscontext: true
          right:
            value:
              simple: "299"
      - - operator: isExists
          left:
            value:
              complex:
                root: Domain
                accessor: Admin.Country
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: Domain
                accessor: Admin.Email
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: Domain
                accessor: Admin.Name
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: Domain
                accessor: Admin.Phone
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: Domain
                accessor: Registrant.Country
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: Domain
                accessor: Registrant.Email
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: Domain
                accessor: Registrant.Name
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: Domain
                accessor: Registrant.Phone
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: Domain
                accessor: CreationDate
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: Domain
                accessor: DomainStatus
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: Domain
                accessor: UpdatedDate
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: Domain
                accessor: ExpirationDate
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: Domain
                accessor: Registrar.Name
            iscontext: true
    view: |-
      {
        "position": {
          "x": -1580,
          "y": 3780
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "44":
    id: "44"
    taskid: 93da8d28-48f3-4116-8895-cf40237e99aa
    type: title
    task:
      id: 93da8d28-48f3-4116-8895-cf40237e99aa
      version: -1
      name: Check Bang Domain
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "52"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 440,
          "y": 4410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: fad294b4-b72a-4aa1-8e68-e40ea1a88b50
    type: condition
    task:
      id: fad294b4-b72a-4aa1-8e68-e40ea1a88b50
      version: -1
      name: Test umbrella-get-malicious-domains-for-ip Context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "44"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: Umbrella.MaliciousDomains.Data.MalwareCategories
            iscontext: true
          right:
            value:
              simple: Command and Control
        - operator: containsGeneral
          left:
            value:
              simple: Umbrella.MaliciousDomains.Data.MalwareCategories
            iscontext: true
          right:
            value:
              simple: Malware
        - operator: containsGeneral
          left:
            value:
              simple: Umbrella.MaliciousDomains.Data.MalwareCategories
            iscontext: true
          right:
            value:
              simple: Phishing
        - operator: in
          left:
            value:
              simple: Umbrella.MaliciousDomains.Data.ContentCategories
            iscontext: true
          right:
            value:
              simple: '[Infrastructure, Illegal Activities, Adware, Software/Technology]'
    view: |-
      {
        "position": {
          "x": -840,
          "y": 3770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: 3d0c2290-2f25-4fa1-88c0-37e746839efa
    type: condition
    task:
      id: 3d0c2290-2f25-4fa1-88c0-37e746839efa
      version: -1
      name: umbrella-get-domains-using-regex
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "44"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: Umbrella.DomainSearch.Data.SecurityCategories
            iscontext: true
          right:
            value:
              simple: Newly Seen Domains
        - operator: containsGeneral
          left:
            value:
              simple: Umbrella.DomainSearch.Data.SecurityCategories
            iscontext: true
          right:
            value:
              simple: Potentially Harmful
    view: |-
      {
        "position": {
          "x": -90,
          "y": 3770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: 923e971b-0735-46bb-8e54-6d13fca68493
    type: condition
    task:
      id: 923e971b-0735-46bb-8e54-6d13fca68493
      version: -1
      name: Test umbrella-get-domain-timeline Context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "44"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: Umbrella.Timeline.Data.Attacks
            iscontext: true
          right:
            value:
              simple: Neutrino
        - operator: containsGeneral
          left:
            value:
              simple: Umbrella.Timeline.Data.MalwareCategories
            iscontext: true
          right:
            value:
              simple: Malware
        - operator: containsGeneral
          left:
            value:
              simple: Umbrella.Timeline.Data.ThreatTypes
            iscontext: true
          right:
            value:
              simple: Exploit Kit
    view: |-
      {
        "position": {
          "x": 1050,
          "y": 3780
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: c6151edf-4540-4c67-8f7f-e11854f974d2
    type: condition
    task:
      id: c6151edf-4540-4c67-8f7f-e11854f974d2
      version: -1
      name: Test umbrella-get-ip-timeline Context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "44"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Umbrella.Timeline.IP
            iscontext: true
          right:
            value:
              simple: 1.2.3.4
    view: |-
      {
        "position": {
          "x": 1850,
          "y": 3770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: 6f3d97ff-a334-40e0-86f9-5120b4ebf15e
    type: condition
    task:
      id: 6f3d97ff-a334-40e0-86f9-5120b4ebf15e
      version: -1
      name: Test umbrella-get-url-timeline context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "44"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Umbrella.Timeline.Data.MalwareCategories
            iscontext: true
          right:
            value:
              simple: Malware
    view: |-
      {
        "position": {
          "x": 2530,
          "y": 3780
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: 1ed05c5c-bb02-4dd2-85b5-4c668d7a1948
    type: regular
    task:
      id: 1ed05c5c-bb02-4dd2-85b5-4c668d7a1948
      version: -1
      name: Delete Context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 20
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: 7287a7cf-3019-4da1-876c-6b322e733ddb
    type: title
    task:
      id: 7287a7cf-3019-4da1-876c-6b322e733ddb
      version: -1
      name: New Commands
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 470,
          "y": 2070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "52":
    id: "52"
    taskid: 0dafd447-d2f7-4a5b-82f2-75b04c1d1ae8
    type: regular
    task:
      id: 0dafd447-d2f7-4a5b-82f2-75b04c1d1ae8
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "53"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 440,
          "y": 4550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: ec968388-8f91-42cf-8520-e2f944579afb
    type: regular
    task:
      id: ec968388-8f91-42cf-8520-e2f944579afb
      version: -1
      name: domain
      description: Get Domain Reputation info using Cisco Umbrella Investigate. Domain
        reputation score is either true or false from the service and cannot be modified
        using a threshold.
      script: Cisco Umbrella Investigate|||domain
      type: regular
      iscommand: true
      brand: Cisco Umbrella Investigate
    nexttasks:
      '#none#':
      - "54"
    scriptarguments:
      domain:
        simple: www.cnn.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 440,
          "y": 4730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "54":
    id: "54"
    taskid: fc0657d6-e3df-4650-8d20-47f8740d88e1
    type: condition
    task:
      id: fc0657d6-e3df-4650-8d20-47f8740d88e1
      version: -1
      name: Test domain context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "55"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: Domain
                accessor: Admin.Country
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: Domain
                accessor: Admin.Email
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: Domain
                accessor: Admin.Name
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: Domain
                accessor: Admin.Phone
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: Domain
                accessor: Registrant.Country
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: Domain
                accessor: Registrant.Email
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: Domain
                accessor: Registrant.Name
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: Domain
                accessor: Registrant.Phone
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: Domain
                accessor: CreationDate
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: Domain
                accessor: DomainStatus
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: Domain
                accessor: UpdatedDate
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: Domain
                accessor: ExpirationDate
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: Domain
                accessor: Registrar.Name
            iscontext: true
    view: |-
      {
        "position": {
          "x": 440,
          "y": 4910
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "55":
    id: "55"
    taskid: b224c22d-3b8b-4fb4-802d-69776f9f68eb
    type: title
    task:
      id: b224c22d-3b8b-4fb4-802d-69776f9f68eb
      version: -1
      name: Test is complete
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 440,
          "y": 5090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 5255,
        "width": 4490,
        "x": -1580,
        "y": -100
      }
    }
  }
inputs: []
outputs: []
fromversion: 5.0.0
