id: EWS_O365_test
version: -1
vcShouldKeepItemLegacyProdMachine: false
name: EWS_O365_test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: b97e898d-deba-43eb-834b-785aeda63574
    type: start
    task:
      id: b97e898d-deba-43eb-834b-785aeda63574
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: effa0fe8-1942-4b1c-8750-f1f96a4d1a0e
    type: regular
    task:
      id: effa0fe8-1942-4b1c-8750-f1f96a4d1a0e
      version: -1
      name: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: daca302b-63bc-45df-81c7-a1627b5b3e5c
    type: regular
    task:
      id: daca302b-63bc-45df-81c7-a1627b5b3e5c
      version: -1
      name: ews-get-attachment
      script: '|||ews-get-attachment'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      item-id:
        simple: AAMkAGZiODc1MGY3LTBiODEtNDQ3ZC05YzdjLWVkYjhiMjFlMTk1MABGAAAAAAB4Hvam6Pd3Sqro7SBw8T0oBwDj9X3Q04QOTYf/bBd1+UDZAAK/iXNUAADj9X3Q04QOTYf/bBd1+UDZAAK/j6FuAAA=
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: aa829063-3469-42a3-8902-0d659b0923b3
    type: condition
    task:
      id: aa829063-3469-42a3-8902-0d659b0923b3
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "6"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: EWS.Items.FileAttachments.attachmentId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: EWS.Items.FileAttachments.attachmentName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: EWS.Items.FileAttachments.attachmentSHA256
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 5aeca111-2e2b-4da9-80e7-2b20021aa4bb
    type: regular
    task:
      id: 5aeca111-2e2b-4da9-80e7-2b20021aa4bb
      version: -1
      name: ews-get-searchable-mailboxes
      script: '|||ews-get-searchable-mailboxes'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      execution-timeout:
        simple: "300"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: 5fc01ae3-e26c-412d-8a84-08c12bf963a5
    type: condition
    task:
      id: 5fc01ae3-e26c-412d-8a84-08c12bf963a5
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "14"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: EWS.Mailboxes.mailbox
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: EWS.Mailboxes.mailboxId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: EWS.Mailboxes.displayName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: EWS.Mailboxes.isExternal
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 256c6d07-224c-436f-84f9-c34ef8203c36
    type: regular
    task:
      id: 256c6d07-224c-436f-84f9-c34ef8203c36
      version: -1
      name: ews-search-mailbox
      script: '|||ews-search-mailbox'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      execution-timeout:
        simple: "300"
      folder-path:
        simple: test_playbooks_emails
      query:
        simple: this is a test
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1060
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 19ccc3f4-a862-480d-8833-b3d2151f6be0
    type: condition
    task:
      id: 19ccc3f4-a862-480d-8833-b3d2151f6be0
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "16"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: EWS.Items.itemId
            iscontext: true
          right:
            value:
              simple: AAMkAGZiODc1MGY3LTBiODEtNDQ3ZC05YzdjLWVkYjhiMjFlMTk1MABGAAAAAAB4Hvam6Pd3Sqro7SBw8T0oBwDj9X3Q04QOTYf/bBd1+UDZAAK/iXNUAADj9X3Q04QOTYf/bBd1+UDZAAK/j6FuAAA=
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: f6df1433-5611-4272-8490-41b58e0dc1cb
    type: regular
    task:
      id: f6df1433-5611-4272-8490-41b58e0dc1cb
      version: -1
      name: ews-get-contacts
      script: '|||ews-get-contacts'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "18"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: 08c4a8b3-c7ee-4db1-8a9b-5960998d2d9d
    type: regular
    task:
      id: 08c4a8b3-c7ee-4db1-8a9b-5960998d2d9d
      version: -1
      name: ews-get-out-of-office
      script: '|||ews-get-out-of-office'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      target-mailbox:
        simple: avishai@demistodev.onmicrosoft.com
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: bb9c12c0-1d62-4429-8b9e-8cdb3bbd14c4
    type: condition
    task:
      id: bb9c12c0-1d62-4429-8b9e-8cdb3bbd14c4
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "24"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Account.Email.OutOfOffice.state
            iscontext: true
          right:
            value:
              simple: Disabled
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1740
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: 0df2b08a-9386-47d0-8654-8efe77f69ab9
    type: regular
    task:
      id: 0df2b08a-9386-47d0-8654-8efe77f69ab9
      version: -1
      name: ews-find-folders
      script: '|||ews-find-folders'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "25"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1910
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "25":
    id: "25"
    taskid: 7c7f6eb0-c685-4761-8451-0dcfa7195e48
    type: condition
    task:
      id: 7c7f6eb0-c685-4761-8451-0dcfa7195e48
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "26"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: EWS.Folders.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: EWS.Folders.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: EWS.Folders.totalCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: EWS.Folders.unreadCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: EWS.Folders.changeKey
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: EWS.Folders.childrenFolderCount
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2080
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: 625a0840-6132-4dcd-89cf-972c78891f8f
    type: regular
    task:
      id: 625a0840-6132-4dcd-89cf-972c78891f8f
      version: -1
      name: ews-get-items-from-folder
      script: '|||ews-get-items-from-folder'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "28"
    scriptarguments:
      folder-path:
        simple: AllItems
      limit:
        simple: "5"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2250
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: 105c4ff1-92f8-4dfb-87fc-83505a0f916e
    type: regular
    task:
      id: 105c4ff1-92f8-4dfb-87fc-83505a0f916e
      version: -1
      name: ews-get-items
      script: '|||ews-get-items'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      item-ids:
        simple: AAMkAGZiODc1MGY3LTBiODEtNDQ3ZC05YzdjLWVkYjhiMjFlMTk1MABGAAAAAAB4Hvam6Pd3Sqro7SBw8T0oBwDj9X3Q04QOTYf/bBd1+UDZAAK/iXNUAADj9X3Q04QOTYf/bBd1+UDZAAK/j6FuAAA=
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: 4e2667e5-c817-4c1d-816b-70e4781d2cb6
    type: condition
    task:
      id: 4e2667e5-c817-4c1d-816b-70e4781d2cb6
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "32"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: EWS.Items.itemId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: EWS.Items.datetimeReceived
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: EWS.Items.datetimeSent
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: EWS.Items.headers
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: EWS.Items.sender
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: EWS.Items.subject
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: EWS.Items.size
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2590
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: 38a7da5e-4bb1-45cc-8589-8b74ef1aaa21
    type: regular
    task:
      id: 38a7da5e-4bb1-45cc-8589-8b74ef1aaa21
      version: -1
      name: ews-get-folder
      script: '|||ews-get-folder'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "33"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2760
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: 820692b5-24de-4a19-86f2-983c6317e638
    type: condition
    task:
      id: 820692b5-24de-4a19-86f2-983c6317e638
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "34"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: EWS.Folders.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: EWS.Folders.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: EWS.Folders.changeKey
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: EWS.Folders.totalCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: EWS.Folders.childrenFolderCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: EWS.Folders.unreadCount
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2930
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: 637f7edd-e2d0-480e-81d6-de1e84f1e774
    type: regular
    task:
      id: 637f7edd-e2d0-480e-81d6-de1e84f1e774
      version: -1
      name: ews-expand-group
      script: '|||ews-expand-group'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "40"
    scriptarguments:
      email-address:
        simple: testgroup-1@demistodev.onmicrosoft.com
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: eb5942c4-e17f-462f-89c6-387ee3cb4b83
    type: title
    task:
      id: eb5942c4-e17f-462f-89c6-387ee3cb4b83
      version: -1
      name: Test Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3780
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: 1d76d82c-fc2b-41dc-8e09-1b9f6bc53f28
    type: regular
    task:
      id: 1d76d82c-fc2b-41dc-8e09-1b9f6bc53f28
      version: -1
      name: ews-get-items-as-eml
      description: Retrieves items by item ID and uploads its content as an EML file.
      script: '|||ews-get-items-as-eml'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "41"
    scriptarguments:
      item-id:
        simple: AAMkAGZiODc1MGY3LTBiODEtNDQ3ZC05YzdjLWVkYjhiMjFlMTk1MABGAAAAAAB4Hvam6Pd3Sqro7SBw8T0oBwDj9X3Q04QOTYf/bBd1+UDZAAK/iXNUAADj9X3Q04QOTYf/bBd1+UDZAAK/j6FuAAA=
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: f77a52d8-a4ca-41d5-8c74-f3073bab1747
    type: regular
    task:
      id: f77a52d8-a4ca-41d5-8c74-f3073bab1747
      version: -1
      name: Get public folder
      description: Retrieves a single folder.
      script: '|||ews-get-folder'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "42"
    scriptarguments:
      folder-path:
        simple: test_p
      is-public:
        simple: "True"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3440
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: bb9d648c-3d35-4c4d-be96-d56d553bac3e
    type: regular
    task:
      id: bb9d648c-3d35-4c4d-be96-d56d553bac3e
      version: -1
      name: send-mail
      description: Sends an email.
      script: EWSO365|||send-mail
      type: regular
      iscommand: true
      brand: EWSO365
    nexttasks:
      '#none#':
      - "39"
    scriptarguments:
      additionalHeader:
        simple: some_header=header_value
      attachIDs:
        simple: ${File.EntryID}
      attachNames:
        simple: changed_name.txt
      body:
        simple: some body
      htmlBody:
        simple: <html><body>Hello <b>World</b></body></html>
      subject:
        simple: This is a mail test for EWSO365 TPB
      to:
        simple: testbox@demistodev.onmicrosoft.com
      transientFileContent:
        simple: content of file
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3610
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 3790,
        "width": 380,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
fromversion: 6.0.0