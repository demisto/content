import demistomock as demisto  # noqa: F401
from CommonServerPython import *  # noqa: F401


def main() -> None:
    data = [{"actor":{"alternateId":"xdrqasystem@gmail.com","displayName":"xdr qa","id":"00u103k0l02QkMDFT5d7","type":"User"},"authenticationContext":{"externalSessionId":"102RMXJDR2dR2OHSMHAP42iNA"},"client":{"device":"Computer","geographicalContext":{"city":"Tel Aviv","country":"Israel","geolocation":{"lat":32.0668,"lon":34.7649},"state":"Tel Aviv"},"ipAddress":"34.99.231.242","userAgent":{"browser":"CHROME","os":"Mac OS X","rawUserAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.127 Safari/537.36"},"zone":"null"},"debugContext":{"debugData":{"origin":"https://dev-76515183.okta.com","requestUri":"/api/v1/authn","threatSuspected":"false","url":"/api/v1/authn?","deviceFingerprint":"9b7647f6b102c9ecf1dcc16df1fd102b","requestId":"YmZOoiOr2wRLa@7fgK1G0wAABHk"}},"displayMessage":"User login to Okta","eventType":"user.session.start","legacyEventType":"core.user_auth.login_success","outcome":{"result":"SUCCESS"},"published":"2022-04-25T07:32:50.752Z","request":{"ipChain":[{"geographicalContext":{"city":"Tel Aviv","country":"Israel","geolocation":{"lat":32.0668,"lon":34.7649},"state":"Tel Aviv"},"ip":"34.99.231.242","version":"V4"}]},"securityContext":{"asNumber":396982,"asOrg":"google","domain":"googleusercontent.com","isProxy":false,"isp":"google"},"severity":"INFO","transaction":{"detail":{},"id":"YmZOoiOr2wRLa@7fgK1G0wAABHk","type":"WEB"},"uuid":"e95e3cee-c469-11ec-9c48-476fa0c10471","version":"0"},
            {"actor":{"alternateId":"xdrqasystem@gmail.com","displayName":"xdr qa","id":"00u103k0l02QkMDFT5d7","type":"User"},"authenticationContext":{"externalSessionId":"102RMXJDR2dR2OHSMHAP42iNA"},"client":{"device":"Computer","geographicalContext":{"city":"Tel Aviv","country":"Israel","geolocation":{"lat":32.0668,"lon":34.7649},"state":"Tel Aviv"},"ipAddress":"34.99.231.242","userAgent":{"browser":"CHROME","os":"Mac OS X","rawUserAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.127 Safari/537.36"},"zone":"null"},"debugContext":{"debugData":{"requestUri":"/api/v1/authn","threatSuspected":"false","url":"/api/v1/authn?","deviceFingerprint":"9b7647f6b102c9ecf1dcc16df1fd102b","requestId":"YmZOoiOr2wRLa@7fgK1G0wAABHk"}},"displayMessage":"Verify user identity","eventType":"user.authentication.verify","outcome":{"result":"SUCCESS"},"published":"2022-04-25T07:32:50.815Z","request":{"ipChain":[{"geographicalContext":{"city":"Tel Aviv","country":"Israel","geolocation":{"lat":32.0668,"lon":34.7649},"state":"Tel Aviv"},"ip":"34.99.231.242","version":"V4"}]},"securityContext":{"asNumber":396982,"asOrg":"google","domain":"googleusercontent.com","isProxy":false,"isp":"google"},"severity":"INFO","transaction":{"detail":{},"id":"YmZOoiOr2wRLa@7fgK1G0wAABHk","type":"WEB"},"uuid":"e967d9e0-c469-11ec-9c48-476fa0c10471","version":"0"},
            {"actor":{"alternateId":"xdrqasystem@gmail.com","displayName":"xdr qa","id":"00u103k0l02QkMDFT5d7","type":"User"},"authenticationContext":{"externalSessionId":"102RMXJDR2dR2OHSMHAP42iNA"},"client":{"device":"Computer","geographicalContext":{"city":"Tel Aviv","country":"Israel","geolocation":{"lat":32.0668,"lon":34.7649},"state":"Tel Aviv"},"ipAddress":"34.99.231.242","userAgent":{"browser":"CHROME","os":"Mac OS X","rawUserAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.127 Safari/537.36"},"zone":"null"},"debugContext":{"debugData":{"requestUri":"/api/v1/authn","threatSuspected":"false","url":"/api/v1/authn?","deviceFingerprint":"9b7647f6b102c9ecf1dcc16df1fd102b","requestId":"YmZOoiOr2wRLa@7fgK1G0wAABHk"}},"displayMessage":"Evaluation of sign-on policy","eventType":"policy.evaluate_sign_on","outcome":{"reason":"Sign-on policy evaluation resulted in ALLOW","result":"ALLOW"},"published":"2022-04-25T07:32:50.808Z","request":{"ipChain":[{"geographicalContext":{"city":"Tel Aviv","country":"Israel","geolocation":{"lat":32.0668,"lon":34.7649},"state":"Tel Aviv"},"ip":"34.99.231.242","version":"V4"}]},"securityContext":{"asNumber":396982,"asOrg":"google","domain":"googleusercontent.com","isProxy":false,"isp":"google"},"severity":"INFO","target":[{"alternateId":"unknown","detailEntry":{"policyType":"OktaSignOn"},"displayName":"Default Policy","id":"00p103k0fhXXIn4Pz5d7","type":"PolicyEntity"},{"alternateId":"00p103k0fhXXIn4Pz5d7","displayName":"Default Rule","id":"0pr103k0fizTm7NAd5d7","type":"PolicyRule"}],"transaction":{"detail":{},"id":"YmZOoiOr2wRLa@7fgK1G0wAABHk","type":"WEB"},"uuid":"e966c86f-c469-11ec-9c48-476fa0c10471","version":"0"},
            {"actor":{"alternateId":"0oa103k0f4GLcb6gS5d7","displayName":"Okta Admin Console","id":"okta.b58d5b75-07d4-5f25-bf59-368a1261a405","type":"PublicClientApp"},"authenticationContext":{"externalSessionId":"102iLZ76aNnRlSsWJ5JObAZkg"},"client":{"device":"Computer","geographicalContext":{"city":"Tel Aviv","country":"Israel","geolocation":{"lat":32.0668,"lon":34.7649},"state":"Tel Aviv"},"id":"okta.b58d5b75-07d4-5f25-bf59-368a1261a405","ipAddress":"34.99.231.242","userAgent":{"browser":"CHROME","os":"Mac OS X","rawUserAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.127 Safari/537.36"},"zone":"null"},"debugContext":{"debugData":{"responseMode":"query","requestId":"YmZOozNnEKKpdKI1zngAwgAAAWM","requestUri":"/oauth2/v1/authorize/redirect","state":"mTYBnw2xeTf7KpeLWCvkNykm3tYOOGKt","userId":"00u103k0l02QkMDFT5d7","url":"/oauth2/v1/authorize/redirect?okta_key=dSd5W9-fyXJVKf7erkTzBsA1EZ5Mvk2Dwz_OZH7-kNM","redirectUri":"https://dev-76515183-admin.okta.com/admin/sso/callback","grantedScopes":"openid","responseType":"code","authnRequestId":"YmZOoiOr2wRLa@7fgK1G0wAABHk","requestedScopes":"openid","grantType":"authorization_code"}},"displayMessage":"OIDC authorization code request","eventType":"app.oauth2.authorize.code","legacyEventType":"app.oauth2.authorize.code_success","outcome":{"result":"SUCCESS"},"published":"2022-04-25T07:32:51.513Z","request":{"ipChain":[{"geographicalContext":{"city":"Tel Aviv","country":"Israel","geolocation":{"lat":32.0668,"lon":34.7649},"state":"Tel Aviv"},"ip":"34.99.231.242","version":"V4"}]},"securityContext":{"asNumber":396982,"asOrg":"google","domain":"googleusercontent.com","isProxy":false,"isp":"google"},"severity":"INFO","target":[{"id":"00u103k0l02QkMDFT5d7","type":"User"},{"displayName":"Authorization Code","id":"5P6uJP7OIL5sIM55LLbJqQ","type":"code"}],"transaction":{"detail":{},"id":"YmZOozNnEKKpdKI1zngAwgAAAWM","type":"WEB"},"uuid":"e9d25b3a-c469-11ec-865b-b936b9655927","version":"0"},
            {"actor":{"alternateId":"0oa103k0f4GLcb6gS5d7","displayName":"Okta Admin Console","id":"okta.b58d5b75-07d4-5f25-bf59-368a1261a405","type":"PublicClientApp"},"authenticationContext":{"externalSessionId":"unknown"},"client":{"device":"Unknown","geographicalContext":{"city":"Boardman","country":"United States","geolocation":{"lat":45.8234,"lon":-119.7257},"postalCode":"97818","state":"Oregon"},"id":"okta.b58d5b75-07d4-5f25-bf59-368a1261a405","ipAddress":"54.189.184.116","userAgent":{"browser":"UNKNOWN","os":"Unknown","rawUserAgent":"Okta-Integrations"},"zone":"null"},"debugContext":{"debugData":{"threatSuspected":"false","grantType":"authorization_code","clientAuthType":"none","redirectUri":"https://dev-76515183-admin.okta.com/admin/sso/callback","grantedScopes":"openid","requestUri":"/oauth2/v1/token","requestedScopes":"","authCode":"5P6uJP7OIL5sIM55LLbJqQ","requestId":"YmZOpLk7S3SfpGm7QvMqvQAAAr4","url":"/oauth2/v1/token?"}},"displayMessage":"OIDC access token is granted","eventType":"app.oauth2.token.grant.access_token","legacyEventType":"app.oauth2.token.grant.access_token_success","outcome":{"result":"SUCCESS"},"published":"2022-04-25T07:32:52.305Z","request":{"ipChain":[{"geographicalContext":{"city":"Boardman","country":"United States","geolocation":{"lat":45.8234,"lon":-119.7257},"postalCode":"97818","state":"Oregon"},"ip":"54.189.184.116","version":"V4"}]},"securityContext":{"asNumber":16509,"asOrg":"amazon.com  inc.","domain":"amazonaws.com","isProxy":false,"isp":"amazon.com%2C inc"},"severity":"INFO","target":[{"id":"00u103k0l02QkMDFT5d7","type":"User"},{"detailEntry":{"hash":"pEvRQx1v2olSUnLpuOMIcw","expires":"2022-04-25T08:32:52.000Z","subject":"00u103k0l02QkMDFT5d7"},"displayName":"Access Token","id":"AT.qPLYm7sgc_-Nzrxn5XUvTqtv4CLFeLJSvXRY9JFlV_E","type":"access_token"}],"transaction":{"detail":{},"id":"YmZOpLk7S3SfpGm7QvMqvQAAAr4","type":"WEB"},"uuid":"ea4b34d8-c469-11ec-a89d-8b224ecebfbc","version":"0"},
            {"actor":{"alternateId":"0oa103k0f4GLcb6gS5d7","displayName":"Okta Admin Console","id":"okta.b58d5b75-07d4-5f25-bf59-368a1261a405","type":"PublicClientApp"},"authenticationContext":{"externalSessionId":"unknown"},"client":{"device":"Unknown","geographicalContext":{"city":"Boardman","country":"United States","geolocation":{"lat":45.8234,"lon":-119.7257},"postalCode":"97818","state":"Oregon"},"id":"okta.b58d5b75-07d4-5f25-bf59-368a1261a405","ipAddress":"54.189.184.116","userAgent":{"browser":"UNKNOWN","os":"Unknown","rawUserAgent":"Okta-Integrations"},"zone":"null"},"debugContext":{"debugData":{"clientAuthType":"none","grantedScopes":"openid","authCode":"5P6uJP7OIL5sIM55LLbJqQ","requestedScopes":"","grantType":"authorization_code","url":"/oauth2/v1/token?","redirectUri":"https://dev-76515183-admin.okta.com/admin/sso/callback","requestId":"YmZOpLk7S3SfpGm7QvMqvQAAAr4","requestUri":"/oauth2/v1/token","threatSuspected":"false"}},"displayMessage":"OIDC id token is granted","eventType":"app.oauth2.token.grant.id_token","legacyEventType":"app.oauth2.token.grant.id_token_success","outcome":{"result":"SUCCESS"},"published":"2022-04-25T07:32:52.302Z","request":{"ipChain":[{"geographicalContext":{"city":"Boardman","country":"United States","geolocation":{"lat":45.8234,"lon":-119.7257},"postalCode":"97818","state":"Oregon"},"ip":"54.189.184.116","version":"V4"}]},"securityContext":{"asNumber":16509,"asOrg":"amazon.com  inc.","domain":"amazonaws.com","isProxy":false,"isp":"amazon.com%2C inc"},"severity":"INFO","target":[{"id":"00u103k0l02QkMDFT5d7","type":"User"},{"detailEntry":{"audience":"okta.b58d5b75-07d4-5f25-bf59-368a1261a405","expires":"2022-04-25T08:32:52.000Z","subject":"00u103k0l02QkMDFT5d7","hash":"cBG9tKAkZTGPcNgd_qAvzA"},"displayName":"ID Token","id":"ID.MnRvfl-ftNI-hUcJguMNGYEtDp0j_6yeuzaskTnICds","type":"id_token"}],"transaction":{"detail":{},"id":"YmZOpLk7S3SfpGm7QvMqvQAAAr4","type":"WEB"},"uuid":"ea4abfa6-c469-11ec-a89d-8b224ecebfbc","version":"0"},
            {"actor":{"alternateId":"xdrqasystem@gmail.com","displayName":"xdr qa","id":"00u103k0l02QkMDFT5d7","type":"User"},"authenticationContext":{"externalSessionId":"unknown"},"client":{"device":"Unknown","geographicalContext":{"city":"Boardman","country":"United States","geolocation":{"lat":45.8234,"lon":-119.7257},"postalCode":"97818","state":"Oregon"},"id":"okta.b58d5b75-07d4-5f25-bf59-368a1261a405","ipAddress":"54.189.184.116","userAgent":{"browser":"UNKNOWN","os":"Unknown","rawUserAgent":"Okta-Integrations"},"zone":"null"},"debugContext":{"debugData":{"threatSuspected":"false","url":"/oauth2/v1/token?","initiationType":"NA","redirectUri":"https://dev-76515183-admin.okta.com/admin/sso/callback","requestId":"YmZOpLk7S3SfpGm7QvMqvQAAAr4","signOnMode":"OpenID Connect","requestUri":"/oauth2/v1/token"}},"displayMessage":"User single sign on to app","eventType":"user.authentication.sso","legacyEventType":"app.auth.sso","outcome":{"result":"SUCCESS"},"published":"2022-04-25T07:32:52.303Z","request":{"ipChain":[{"geographicalContext":{"city":"Boardman","country":"United States","geolocation":{"lat":45.8234,"lon":-119.7257},"postalCode":"97818","state":"Oregon"},"ip":"54.189.184.116","version":"V4"}]},"securityContext":{"asNumber":16509,"asOrg":"amazon.com  inc.","domain":"amazonaws.com","isProxy":false,"isp":"amazon.com%2C inc"},"severity":"INFO","target":[{"alternateId":"Okta Admin Console","detailEntry":{"signOnModeType":"OPENID_CONNECT"},"displayName":"Okta Admin Console","id":"0oa103k0f4GLcb6gS5d7","type":"AppInstance"},{"alternateId":"unknown","displayName":"xdr qa","id":"0ua103k0l41wesBSo5d7","type":"AppUser"}],"transaction":{"detail":{},"id":"YmZOpLk7S3SfpGm7QvMqvQAAAr4","type":"WEB"},"uuid":"ea4ae6b7-c469-11ec-a89d-8b224ecebfbc","version":"0"},
            {"actor":{"alternateId":"xdrqasystem@gmail.com","displayName":"xdr qa","id":"00u103k0l02QkMDFT5d7","type":"User"},"authenticationContext":{"externalSessionId":"102BdMBk_QvSG2ZxtTW1mSXjQ"},"client":{"device":"Computer","geographicalContext":{"city":"Tel Aviv","country":"Israel","geolocation":{"lat":32.0668,"lon":34.7649},"state":"Tel Aviv"},"ipAddress":"34.99.231.242","userAgent":{"browser":"CHROME","os":"Mac OS X","rawUserAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.127 Safari/537.36"},"zone":"null"},"debugContext":{"debugData":{"requestId":"YmZOo7YTmJdKlEhC5h4QIQAAA4Y","requestUri":"/admin/sso/callback","url":"/admin/sso/callback?code=Idq_iaAZ-ZxMQdqsB7dC6JC6NVtFCwytNDzM5H3iL6w&state=mTYBnw2xeTf7KpeLWCvkNykm3tYOOGKt"}},"displayMessage":"User accessing Okta admin app","eventType":"user.session.access_admin_app","legacyEventType":"app.admin.sso.login.success","outcome":{"result":"SUCCESS"},"published":"2022-04-25T07:32:52.358Z","request":{"ipChain":[{"geographicalContext":{"city":"Tel Aviv","country":"Israel","geolocation":{"lat":32.0668,"lon":34.7649},"state":"Tel Aviv"},"ip":"34.99.231.242","version":"V4"}]},"securityContext":{"asNumber":396982,"asOrg":"google","domain":"googleusercontent.com","isProxy":false,"isp":"google"},"severity":"INFO","target":[{"alternateId":"xdrqasystem@gmail.com","displayName":"xdr qa","id":"00u103k0l02QkMDFT5d7","type":"AppUser"}],"transaction":{"detail":{},"id":"YmZOo7YTmJdKlEhC5h4QIQAAA4Y","type":"WEB"},"uuid":"ea534b29-c469-11ec-a89d-8b224ecebfbc","version":"0"}]
    send_events_to_xsiam(data, 'okta', 'sso')
    if demisto.command() == 'test-module':
        return_results('ok')


''' ENTRY POINT '''

if __name__ in ('__main__', '__builtin__', 'builtins'):
    main()
