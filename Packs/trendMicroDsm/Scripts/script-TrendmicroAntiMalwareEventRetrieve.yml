commonfields:
  id: TrendmicroAntiMalwareEventRetrieve
  version: -1
name: TrendmicroAntiMalwareEventRetrieve
script: |
  hostIds = argToList(demisto.get(demisto.args(),"hostID"))
  resps = []
  dArgs = demisto.args()
  err = []
  res = []

  if hostIds:
      for hostId in hostIds:
          dArgs["hostID"] = hostId
          temp_resp = demisto.executeCommand("trendmicro-anti-malware-event-retrieve", dArgs)
          if isError(temp_resp[0]):
              err += temp_resp
          else:
              resps += temp_resp
  else:
      resps = demisto.executeCommand("trendmicro-anti-malware-event-retrieve", dArgs)
  for resp in resps:
      data = demisto.get(resp, "Contents.antiMalwareEventRetrieveReturn.antiMalwareEvents.item")
      if data:
          data = data if isinstance(data, list) else [data]
          data = [{k: formatCell(row[k]) for k in row} for row in data]
          res += [{"ContentsFormat": formats["table"], "Type": entryTypes["note"], "Contents": data}]

      res += err
  if res:
      demisto.results(res)
  else:
      demisto.results("No results.")
type: python
subtype: python2
tags:
- Trend Micro
comment: Get anti malware events
system: true
args:
- name: rangeFrom
  default: true
  description: Time interval start
- name: rangeTo
  description: Time interval end
- name: specificTime
  description: Specific Time
- name: timeFilterType
  auto: PREDEFINED
  predefined:
  - LAST_HOUR
  - LAST_24_HOURS
  - LAST_7_DAYS
  - CUSTOM_RANGE
  - SPECIFIC_TIME
  description: Define time filter mode. mandatory if filtering by time.
- name: hostGroupID
  description: Filter by host group ID
- name: hostID
  description: Filter by host ID
- name: securityProfileID
  description: Filter by host security profile ID
- name: hostFilterType
  auto: PREDEFINED
  predefined:
  - ALL_HOSTS
  - HOSTS_IN_GROUP
  - HOSTS_USING_SECURITY_PROFILE
  - HOSTS_IN_GROUP_AND_ALL_SUBGROUPS
  - SPECIFIC_HOST
  - MY_HOSTS
  description: Define host filter mode. mandatory if filtering by host/s.
- name: eventID
  description: filter by event ID
- name: eventFilterOperator
  auto: PREDEFINED
  predefined:
  - GREATER_THAN
  - LESS_THAN
  - EQUAL
  description: event ID operator
scripttarget: 0
dependson:
  must:
  - trendmicro-anti-malware-event-retrieve
timeout: 0s
