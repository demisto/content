category: Analytics & SIEM
sectionOrder:
- Connect
- Collect
commonfields:
  id: Microsoft Graph
  version: -1
configuration:
- defaultvalue: https://graph.microsoft.com
  display: Host URL
  name: host
  required: true
  type: 0
  section: Connect
- defaultvalue: API v2
  display: MS graph security API version
  name: api_version
  type: 15
  options:
  - API V1
  - API V2
  section: Connect
- name: creds_auth_id
  required: false
  type: 9
  section: Connect
  displaypassword: Application ID or Client ID
  hiddenusername: true
- name: creds_tenant_id
  required: false
  type: 9
  section: Connect
  displaypassword: Token or Tenant ID
  hiddenusername: true
- name: creds_enc_key
  required: false
  type: 9
  section: Connect
  displaypassword: Key or Client Secret
  hiddenusername: true
- additionalinfo: See the Help tab.
  display: Application ID or Client ID
  name: auth_id
  required: false
  type: 4
  section: Connect
  hidden: true
- additionalinfo: See the Help tab.
  display: Token or Tenant ID
  name: tenant_id
  required: false
  type: 4
  section: Connect
  hidden: true
- display: Key or Client Secret
  name: enc_key
  required: false
  type: 4
  section: Connect
  additionalinfo: See the Help tab.
  hidden: true
- display: Certificate Thumbprint
  name: creds_certificate
  required: false
  type: 9
  section: Connect
  displaypassword: Private Key
- display: Certificate Thumbprint
  name: certificate_thumbprint
  required: false
  type: 4
  section: Connect
  additionalinfo: Used for certificate authentication as it appears in the "Certificates & secrets" page of the app.
  hidden: true
- display: Private Key
  name: private_key
  required: false
  type: 14
  section: Connect
  additionalinfo: Used for certificate authentication. The private key of the registered certificate.
  hidden: true
- additionalinfo: Relevant only if the integration is running on Azure VM. 
    If selected, authenticates based on the value provided for the Azure Managed Identities Client ID field.
    If no value is provided for the Azure Managed Identities Client ID field, authenticates based on the System Assigned Managed Identity.
    For additional information, see the Help tab.
  display: Use Azure Managed Identities
  name: use_managed_identities
  required: false
  type: 8
  section: Connect
- additionalinfo: The Managed Identities client ID for authentication - relevant only if the integration is running on Azure VM.
  displaypassword: Azure Managed Identities Client ID
  name: managed_identities_client_id
  required: false
  hiddenusername: true
  type: 9
  section: Connect
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
  section: Connect
  advanced: true
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
  section: Connect
  advanced: true
- display: Use a self-deployed Azure application
  name: self_deployed
  required: false
  type: 8
  section: Connect
  advanced: true
- display: Fetch incidents
  name: isFetch
  required: false
  type: 8
  section: Collect
- display: Incident type
  name: incidentType
  required: false
  type: 13
  section: Connect
- defaultvalue: 1 day
  display: First fetch timestamp (<number> <time unit>, e.g., 12 hours, 7 days)
  additionalinfo: <number> <time unit>, for example 1 hour, 30 minutes
  hidden: false
  name: fetch_time
  required: false
  type: 0
  section: Collect
- defaultvalue: '10'
  display: Max incidents per fetch
  hidden: false
  name: fetch_limit
  required: false
  type: 0
  section: Collect
- display: Fetch incidents of the given providers only.
  additionalinfo: Relevant only for V1. Multiple providers can be inserted separated by a comma, for example "{first_provider},{second_provioder}". If empty, incidents of all providers will be fetched.
  hidden: false
  name: fetch_providers
  required: false
  type: 0
  section: Collect
  advanced: true
- display: Fetch incidents of the given service sources only.
  additionalinfo: Relevant only for V2. Multiple serviceSource can be inserted separated by a comma, for example "microsoftDefenderForEndpoint,microsoftCloudAppSecurity",. If empty, incidents of all providers will be fetched.
  hidden: false
  name: fetch_service_sources
  required: false
  type: 0
  section: Collect
  advanced: true
- display: Fetched incidents filter
  additionalinfo: Use this field to filter fetched incidents according to any of the alert properties. Overrides the providers list, if given. Filter should be in the format "{property} eq '{property-value}'". Multiple filters can be applied separated with " and ", for example "createdDateTime eq YYYY-MM-DD and severity eq 'high'".
  hidden: false
  name: fetch_filter
  required: false
  type: 0
  section: Collect
  advanced: true
description: Unified gateway to security insights - all from a unified Microsoft Graph Security API.
display: Microsoft Graph Security
name: Microsoft Graph
script:
  commands:
  - arguments:
    - auto: PREDEFINED
      default: false
      description: When the alert was last modified in the following string format - YYYY-MM-DD
      isArray: false
      name: last_modified
      predefined:
      - Last24Hours
      - Last48Hours
      - LastWeek
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Alert severity - set by vendor/provider.
      isArray: false
      name: severity
      predefined:
      - unknown
      - informational
      - low
      - medium
      - high
      required: false
      secret: false
    - default: false
      description: Category of the alert, e.g. credentialTheft, ransomware (Categories can be added or removed by vendors.)
      isArray: false
      name: category
      required: false
      secret: false
    - default: false
      description: The start time (creation time of alert) for the search in the following string format - YYYY-MM-DD
      isArray: false
      name: time_from
      required: false
      secret: false
    - default: false
      description: The end time (creation time of alert) for the search in the following string format -  YYYY-MM-DD
      isArray: false
      name: time_to
      required: false
      secret: false
    - default: false
      description: Use this field to filter on any of the alert properties in the format "{property} eq '{property-value}'", e.g. "category eq 'ransomware'"
      isArray: false
      name: filter
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Relevant only for V2, Use this field to filter by alert's classification.
      isArray: false
      name: classification
      predefined:
      - unknown
      - truePositive
      - falsePositive
      - benignPositive
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Relevant only for V2, Use this field to filter the alerts by the service or product that created this alert.
      isArray: false
      name: service_source
      predefined:
      - microsoftDefenderForEndpoint
      - microsoftDefenderForIdentity
      - microsoftDefenderForOffice365
      - microsoft365Defender
      - microsoftAppGovernance
      - microsoftDefenderForCloudApps
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Relevant only for V2, Use this field to filter by alert's status.
      isArray: false
      name: status
      predefined:
      - unknown
      - new
      - inProgress
      - resolved
      required: false
      secret: false
    - description: Page number to return, zero indexed. The maximum number of alerts that can be skipped for API V1 is 500 (i.e page * page_size must be <= 500).
      isArray: false
      name: page
      required: false
    - description: Number of results in a page. default is 50, the limit for API V1 is 1000, the limit for API V2 is 2000.
      isArray: false
      name: page_size
      required: false
    - description: Number of total results to return. default is 50.
      isArray: false
      name: limit
      required: false
      defaultValue: 50
    deprecated: false
    description: List alertsÂ (security issues) within a customer's tenant that Microsoft or partner security solutions have identified.
    execution: false
    name: msg-search-alerts
    outputs:
    - contextPath: MsGraph.Alert.ID
      description: Relevant only for V1. Alert ID
      type: string
    - contextPath: MsGraph.Alert.Title
      description: Relevant only for V1. Alert title
      type: string
    - contextPath: MsGraph.Alert.Category
      description: Relevant only for V1. Alert category
      type: string
    - contextPath: MsGraph.Alert.Severity
      description: Relevant only for V1. Alert severity
      type: string
    - contextPath: MsGraph.Alert.CreatedDate
      description: Relevant only for V1. Alert created date
      type: date
    - contextPath: MsGraph.Alert.EventDate
      description: Relevant only for V1. Alert event time
      type: date
    - contextPath: MsGraph.Alert.Status
      description: Relevant only for V1. Alert status
      type: string
    - contextPath: MsGraph.Alert.Vendor
      description: Relevant only for V1. Alert vendor/provider
      type: string
    - contextPath: MsGraph.Alert.MalwareStates
      description: Relevant only for V1. Alert malware states
      type: string
    - contextPath: MsGraph.Alert.Vendor
      description: Relevant only for V1. Alert vendor
      type: string
    - contextPath: MsGraph.Alert.Provider
      description: Relevant only for V1. Alert provider
      type: string
    - contextPath: MsGraph.Alert.actorDisplayName
      description: Relevant only for V2. Alert actor name
      type: Unknown
    - contextPath: MsGraph.Alert.alertWebUrl
      description: Relevant only for V2. Alert web url
      type: String
    - contextPath: MsGraph.Alert.assignedTo
      description: Relevant only for V2. Alert assignee
      type: Unknown
    - contextPath: MsGraph.Alert.category
      description: Relevant only for V2. Alert category
      type: String
    - contextPath: MsGraph.Alert.classification
      description: Relevant only for V2. Alert classification
      type: Unknown
    - contextPath: MsGraph.Alert.createdDateTime
      description: Relevant only for V2. Alert creation time
      type: Date
    - contextPath: MsGraph.Alert.description
      description: Relevant only for V2. Alert description
      type: String
    - contextPath: MsGraph.Alert.detectionSource
      description: Relevant only for V2. Alert detection source
      type: String
    - contextPath: MsGraph.Alert.detectorId
      description: Relevant only for V2. Alert detector id
      type: String
    - contextPath: MsGraph.Alert.determination
      description: Relevant only for V2. Alert determination
      type: Unknown
    - contextPath: MsGraph.Alert.evidence.@odata.type
      description: Relevant only for V2. Alert evidence
      type: String
    - contextPath: MsGraph.Alert.evidence.azureAdDeviceId
      description: Relevant only for V2. Evidence azure device id
      type: String
    - contextPath: MsGraph.Alert.evidence.createdDateTime
      description: Relevant only for V2. Evidence creation time
      type: Date
    - contextPath: MsGraph.Alert.evidence.defenderAvStatus
      description: Relevant only for V2. Evidence defender AV status
      type: String
    - contextPath: MsGraph.Alert.evidence.deviceDnsName
      description: Relevant only for V2. Evidence device DNS name
      type: String
    - contextPath: MsGraph.Alert.evidence.firstSeenDateTime
      description: Relevant only for V2. Evidence first seen time
      type: Date
    - contextPath: MsGraph.Alert.evidence.healthStatus
      description: Relevant only for V2. Evidence health status
      type: String
    - contextPath: MsGraph.Alert.evidence.mdeDeviceId
      description: Relevant only for V2. Evidence MDE device id
      type: String
    - contextPath: MsGraph.Alert.evidence.onboardingStatus
      description: Relevant only for V2. Evidence onboarding status
      type: String
    - contextPath: MsGraph.Alert.evidence.osBuild
      description: Relevant only for V2. Evidence OS build
      type: Number
    - contextPath: MsGraph.Alert.evidence.osPlatform
      description: Relevant only for V2. Evidence OS platform
      type: String
    - contextPath: MsGraph.Alert.evidence.rbacGroupId
      description: Relevant only for V2. Evidence RBAC group id
      type: Number
    - contextPath: MsGraph.Alert.evidence.rbacGroupName
      description: Relevant only for V2. Evidence RBAC group name
      type: String
    - contextPath: MsGraph.Alert.evidence.remediationStatus
      description: Relevant only for V2. Evidence remediation status
      type: String
    - contextPath: MsGraph.Alert.evidence.remediationStatusDetails
      description: Relevant only for V2. Evidence remediation status details
      type: Unknown
    - contextPath: MsGraph.Alert.evidence.riskScore
      description: Relevant only for V2. Evidence risk score
      type: String
    - contextPath: MsGraph.Alert.evidence.tags
      description: Relevant only for V2. Evidence tags
      type: String
    - contextPath: MsGraph.Alert.evidence.verdict
      description: Relevant only for V2. Evidence verdict
      type: String
    - contextPath: MsGraph.Alert.evidence.version
      description: Relevant only for V2. Evidence version
      type: String
    - contextPath: MsGraph.Alert.evidence.vmMetadata
      description: Relevant only for V2. Evidence VM metadata
      type: Unknown
    - contextPath: MsGraph.Alert.firstActivityDateTime
      description: Relevant only for V2. Evidence first activity time
      type: Date
    - contextPath: MsGraph.Alert.id
      description: Relevant only for V2. Alert id
      type: String
    - contextPath: MsGraph.Alert.incidentId
      description: Relevant only for V2. Alert incident id
      type: String
    - contextPath: MsGraph.Alert.incidentWebUrl
      description: Relevant only for V2. Alert incident URL
      type: String
    - contextPath: MsGraph.Alert.lastActivityDateTime
      description: Relevant only for V2. Alert last activity time
      type: Date
    - contextPath: MsGraph.Alert.lastUpdateDateTime
      description: Relevant only for V2. Alert last update time
      type: Date
    - contextPath: MsGraph.Alert.providerAlertId
      description: Relevant only for V2. Alert provider id
      type: String
    - contextPath: MsGraph.Alert.recommendedActions
      description: Relevant only for V2. Alert recommended action
      type: String
    - contextPath: MsGraph.Alert.resolvedDateTime
      description: Relevant only for V2. Alert closing time
      type: Date
    - contextPath: MsGraph.Alert.serviceSource
      description: Relevant only for V2. Alert service source
      type: String
    - contextPath: MsGraph.Alert.severity
      description: Relevant only for V2. Alert severity
      type: String
    - contextPath: MsGraph.Alert.status
      description: Relevant only for V2. Alert status
      type: String
    - contextPath: MsGraph.Alert.tenantId
      description: Relevant only for V2. Alert tenant id
      type: String
    - contextPath: MsGraph.Alert.threatDisplayName
      description: Relevant only for V2. Alert threat display name
      type: Unknown
    - contextPath: MsGraph.Alert.threatFamilyName
      description: Relevant only for V2. Alert threat family name
      type: Unknown
    - contextPath: MsGraph.Alert.title
      description: Relevant only for V2. Alert title
      type: String
  - arguments:
    - default: true
      description: The Alert ID - Provider-generated GUID/unique identifier.
      isArray: false
      name: alert_id
      required: true
      secret: false
    - default: false
      defaultValue: All
      description: 'Relevant only for V1. Fields to fetch for specified Alert apart from the basic properties, given as comma separated values, e.g. NetworkConnections,Processes. Optional values: All,NetworkConnections,Processes,RegistryKeys,UserStates,HostStates,FileStates,CloudAppStates,MalwareStates,CustomerComment,Triggers,VendorInformation,VulnerabilityStates.'
      isArray: false
      name: fields_to_include
      required: false
      secret: false
    deprecated: false
    description: Get details for a specific alert.
    execution: false
    name: msg-get-alert-details
    outputs:
    - contextPath: MsGraph.Alert.ID
      description: Relevant only for V1. Alert ID
      type: string
    - contextPath: MsGraph.Alert.Title
      description: Relevant only for V1. Alert title
      type: string
    - contextPath: MsGraph.Alert.Category
      description: Relevant only for V1. Alert category
      type: string
    - contextPath: MsGraph.Alert.Severity
      description: Relevant only for V1. Alert severity
      type: string
    - contextPath: MsGraph.Alert.CreatedDate
      description: Relevant only for V1. Alert created date
      type: date
    - contextPath: MsGraph.Alert.EventDate
      description: Relevant only for V1. Alert event date
      type: date
    - contextPath: MsGraph.Alert.Status
      description: Relevant only for V1. Alert status
      type: string
    - contextPath: MsGraph.Alert.Vendor
      description: Relevant only for V1. Alert vendor
      type: string
    - contextPath: MsGraph.Alert.Provider
      description: Relevant only for V1. Alert provider
      type: Unknown
    - contextPath: MsGraph.Alert.@odata.context
      description: Relevant only for V2. Alert odata context
      type: String
    - contextPath: MsGraph.Alert.actorDisplayName
      description: Relevant only for V2. Alert actor name
      type: Unknown
    - contextPath: MsGraph.Alert.alertWebUrl
      description: Relevant only for V2. Alert web url 
      type: String
    - contextPath: MsGraph.Alert.assignedTo
      description: Relevant only for V2. Alert assignee
      type: Unknown
    - contextPath: MsGraph.Alert.category
      description: Relevant only for V2. Alert category
      type: String
    - contextPath: MsGraph.Alert.classification
      description: Relevant only for V2. Alert classification
      type: Unknown
    - contextPath: MsGraph.Alert.comments.comment
      description: Relevant only for V2. Alert comment
      type: String
    - contextPath: MsGraph.Alert.comments.createdByDisplayName
      description: Relevant only for V2. Alert comment creator name
      type: String
    - contextPath: MsGraph.Alert.comments.createdDateTime
      description: Relevant only for V2. Alert comment creation time
      type: Date
    - contextPath: MsGraph.Alert.createdDateTime
      description: Relevant only for V2. Alert creation time
      type: Date
    - contextPath: MsGraph.Alert.description
      description: Relevant only for V2. Alert description
      type: String
    - contextPath: MsGraph.Alert.detectionSource
      description: Relevant only for V2. Alert detection source
      type: String
    - contextPath: MsGraph.Alert.detectorId
      description: Relevant only for V2. Alert detector id
      type: String
    - contextPath: MsGraph.Alert.determination
      description: Relevant only for V2. Alert determination
      type: Unknown
    - contextPath: MsGraph.Alert.evidence.@odata.type
      description: Relevant only for V2. Alert evidence
      type: String
    - contextPath: MsGraph.Alert.evidence.createdDateTime
      description: Relevant only for V2. Evidence creation time
      type: Date
    - contextPath: MsGraph.Alert.evidence.detectionStatus
      description: Relevant only for V2. Evidence detection status
      type: Unknown
    - contextPath: MsGraph.Alert.evidence.imageFile.fileName
      description: Relevant only for V2. Evidence image file name
      type: String
    - contextPath: MsGraph.Alert.evidence.imageFile.filePath
      description: Relevant only for V2. Evidence image file path
      type: String
    - contextPath: MsGraph.Alert.evidence.imageFile.filePublisher
      description: Relevant only for V2. Evidence image file publisher
      type: Unknown
    - contextPath: MsGraph.Alert.evidence.imageFile.fileSize
      description: Relevant only for V2. Evidence image file size
      type: Unknown
    - contextPath: MsGraph.Alert.evidence.imageFile.issuer
      description: Relevant only for V2. Evidence image file issuer
      type: Unknown
    - contextPath: MsGraph.Alert.evidence.imageFile.sha1
      description: Relevant only for V2. Evidence image file sha1 hash
      type: String
    - contextPath: MsGraph.Alert.evidence.imageFile.sha256
      description: Relevant only for V2. Evidence image file sha256 hash
      type: String
    - contextPath: MsGraph.Alert.evidence.imageFile.signer
      description: Relevant only for V2. Evidence image file signer
      type: Unknown
    - contextPath: MsGraph.Alert.evidence.mdeDeviceId
      description: Relevant only for V2. Evidence MDE device id
      type: Unknown
    - contextPath: MsGraph.Alert.evidence.parentProcessCreationDateTime
      description: Relevant only for V2. Evidence parent process creation time
      type: Date
    - contextPath: MsGraph.Alert.evidence.parentProcessId
      description: Relevant only for V2. Evidence parent process process id
      type: Number
    - contextPath: MsGraph.Alert.evidence.parentProcessImageFile
      description: Relevant only for V2. Evidence parent process image file
      type: Unknown
    - contextPath: MsGraph.Alert.evidence.processCommandLine
      description: Relevant only for V2. Evidence process command line
      type: String
    - contextPath: MsGraph.Alert.evidence.processCreationDateTime
      description: Relevant only for V2.  Evidence process creation time
      type: Date
    - contextPath: MsGraph.Alert.evidence.processId
      description: Relevant only for V2.  Evidence process id
      type: Number
    - contextPath: MsGraph.Alert.evidence.remediationStatus
      description: Relevant only for V2. Evidence remediation status
      type: String
    - contextPath: MsGraph.Alert.evidence.remediationStatusDetails
      description: Relevant only for V2. Evidence remediation status details
      type: Unknown
    - contextPath: MsGraph.Alert.evidence.userAccount.accountName
      description: Relevant only for V2. Evidence user account name
      type: String
    - contextPath: MsGraph.Alert.evidence.userAccount.azureAdUserId
      description: Relevant only for V2. Evidence user account azure AD user id
      type: Unknown
    - contextPath: MsGraph.Alert.evidence.userAccount.displayName
      description: Relevant only for V2. Evidence user account display name
      type: String
    - contextPath: MsGraph.Alert.evidence.userAccount.domainName
      description: Relevant only for V2. Evidence user account domain name
      type: Unknown
    - contextPath: MsGraph.Alert.evidence.userAccount.userPrincipalName
      description: Relevant only for V2. Evidence user account user principal name
      type: Unknown
    - contextPath: MsGraph.Alert.evidence.userAccount.userSid
      description: Relevant only for V2. Evidence user account user Sid
      type: String
    - contextPath: MsGraph.Alert.evidence.verdict
      description: Relevant only for V2. Evidence verdict
      type: String
    - contextPath: MsGraph.Alert.evidence.fileDetails.fileName
      description: Relevant only for V2. Evidence file details file name
      type: String
    - contextPath: MsGraph.Alert.evidence.fileDetails.filePath
      description: Relevant only for V2. Evidence file details file path
      type: String
    - contextPath: MsGraph.Alert.evidence.fileDetails.filePublisher
      description: Relevant only for V2. Evidence file details file publisher
      type: Unknown
    - contextPath: MsGraph.Alert.evidence.fileDetails.fileSize
      description: Relevant only for V2. Evidence file details file size
      type: Unknown
    - contextPath: MsGraph.Alert.evidence.fileDetails.issuer
      description: Relevant only for V2. Evidence file details file issuer
      type: Unknown
    - contextPath: MsGraph.Alert.evidence.fileDetails.sha1
      description: Relevant only for V2. Evidence file details sha1 hash
      type: String
    - contextPath: MsGraph.Alert.evidence.fileDetails.sha256
      description: Relevant only for V2. Evidence file details sha256 hash
      type: String
    - contextPath: MsGraph.Alert.evidence.fileDetails.signer
      description: Relevant only for V2. Evidence file details file signer
      type: Unknown
    - contextPath: MsGraph.Alert.evidence.countryLetterCode
      description: Relevant only for V2. Evidence country letter code
      type: Unknown
    - contextPath: MsGraph.Alert.evidence.ipAddress
      description: Relevant only for V2. Evidence ip address
      type: String
    - contextPath: MsGraph.Alert.evidence.azureAdDeviceId
      description: Relevant only for V2. Evidence azure AD device id
      type: Unknown
    - contextPath: MsGraph.Alert.evidence.defenderAvStatus
      description: Relevant only for V2. Evidence defender AV status
      type: String
    - contextPath: MsGraph.Alert.evidence.deviceDnsName
      description: Relevant only for V2. Evidence device DNS name
      type: String
    - contextPath: MsGraph.Alert.evidence.firstSeenDateTime
      description: Relevant only for V2. Evidence first seen time
      type: Date
    - contextPath: MsGraph.Alert.evidence.healthStatus
      description: Relevant only for V2. Evidence health status
      type: String
    - contextPath: MsGraph.Alert.evidence.onboardingStatus
      description: Relevant only for V2. Evidence onboarding status
      type: String
    - contextPath: MsGraph.Alert.evidence.osBuild
      description: Relevant only for V2. Evidence OS build
      type: Unknown
    - contextPath: MsGraph.Alert.evidence.osPlatform
      description: Relevant only for V2. Evidence OS platform
      type: String
    - contextPath: MsGraph.Alert.evidence.rbacGroupId
      description: Relevant only for V2. Evidence RBAC group id
      type: Number
    - contextPath: MsGraph.Alert.evidence.rbacGroupName
      description: Relevant only for V2. Evidence RBAC group name
      type: String
    - contextPath: MsGraph.Alert.evidence.riskScore
      description: Relevant only for V2. Evidence risk score
      type: String
    - contextPath: MsGraph.Alert.evidence.version
      description: Relevant only for V2. Evidence version
      type: String
    - contextPath: MsGraph.Alert.evidence.vmMetadata
      description: Relevant only for V2. Evidence VM metadata
      type: Unknown
    - contextPath: MsGraph.Alert.firstActivityDateTime
      description: Relevant only for V2. Evidence first activity time
      type: Date
    - contextPath: MsGraph.Alert.id
      description: Relevant only for V2. Alert id
      type: String
    - contextPath: MsGraph.Alert.incidentId
      description: Relevant only for V2. Alert incident id
      type: String
    - contextPath: MsGraph.Alert.incidentWebUrl
      description: Relevant only for V2. Alert incident URL
      type: String
    - contextPath: MsGraph.Alert.lastActivityDateTime
      description: Relevant only for V2. Alert last activity time
      type: Date
    - contextPath: MsGraph.Alert.lastUpdateDateTime
      description: Relevant only for V2. Alert last update time
      type: Date
    - contextPath: MsGraph.Alert.providerAlertId
      description: Relevant only for V2. Alert provider id
      type: String
    - contextPath: MsGraph.Alert.recommendedActions
      description: Relevant only for V2. Alert recommended action
      type: String
    - contextPath: MsGraph.Alert.resolvedDateTime
      description: Relevant only for V2. Alert closing time
      type: Date
    - contextPath: MsGraph.Alert.serviceSource
      description: Relevant only for V2. Alert service source
      type: String
    - contextPath: MsGraph.Alert.severity
      description: Relevant only for V2. Alert severity
      type: String
    - contextPath: MsGraph.Alert.status
      description: Relevant only for V2. Alert status
      type: String
    - contextPath: MsGraph.Alert.tenantId
      description: Relevant only for V2. Alert tenant id
      type: String
    - contextPath: MsGraph.Alert.threatDisplayName
      description: Relevant only for V2. Alert threat display name
      type: Unknown
    - contextPath: MsGraph.Alert.threatFamilyName
      description: Relevant only for V2. Alert threat family name
      type: Unknown
    - contextPath: MsGraph.Alert.title
      description: Relevant only for V2. Alert title
      type: String
  - arguments:
    - default: false
      description: The Alert ID. Provider-generated GUID/unique identifier.
      isArray: false
      name: alert_id
      required: true
      secret: false
    - default: false
      description: Name of the analyst the alert is assigned to for triage, investigation, or remediation.
      isArray: false
      name: assigned_to
      required: false
      secret: false
    - default: false
      description: Relevant only for V1. Time the alert was closed in the string format MM/DD/YYYY.
      isArray: false
      name: closed_date_time
      required: false
      secret: false
    - default: false
      description: Relevant only for V1. Analyst comments on the alert (for customer alert management).
      isArray: false
      name: comments
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Relevant only for V1. Analyst feedback on the alert.
      isArray: false
      name: feedback
      predefined:
      - unknown
      - truePositive
      - falsePositive
      - benignPositive
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Alert lifecycle status (stage). newAlert is supported only by V1 and new is supported only by V2.
      isArray: false
      name: status
      predefined:
      - unknown
      - newAlert
      - inProgress
      - resolved
      - new
      required: false
      secret: false
    - default: false
      description: Relevant only for V1. User-definable labels that can be applied to an alert and can serve as filter conditions, for example "HVA", "SAW).
      isArray: false
      name: tags
      required: false
      secret: false
    - default: false
      description: Relevant only for V1. Details about the security service vendor, for example Microsoft.
      isArray: false
      name: vendor_information
      required: false
      secret: false
    - default: false
      description: Relevant only for V1. Details about the security service vendor, for example Windows Defender ATP.
      isArray: false
      name: provider_information
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Relevant only for V2, Use this field to update the alert's classification.
      isArray: false
      name: classification
      predefined:
      - unknown
      - truePositive
      - falsePositive
      - benignPositive
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Relevant only for V2, Use this field to update the alert's determination.
      isArray: false
      name: determination
      predefined:
      - unknown
      - apt
      - malware
      - phishing
      - other
      - securityPersonnel
      - securityTesting
      - multiStagedAttack
      - maliciousUserActivity
      - lineOfBusinessApplication
      - unwantedSoftware
      required: false
      secret: false
    deprecated: false
    description: Update an editable alert property within any integrated solution to keep alert status and assignments in sync across solutions using its reference ID.
    execution: false
    name: msg-update-alert
    outputs:
    - contextPath: MsGraph.Alert.ID
      description: Alert ID
      type: string
  - arguments:
    - default: true
      description: The Alert ID - Provider-generated GUID/unique identifier.
      isArray: false
      name: alert_id
      required: true
      secret: false
    - default: false
      description: The comment to add to each alert.
      isArray: true
      name: comment
      required: true
      secret: false
      type: string
    deprecated: False
    description: Relevant only for V2, create a comment for an existing alert.
    execution: false
    name: msg-create-alert-comment
    outputs:
    - contextPath: MsGraph.AlertComment.ID
      description: The alert id that the comment was added to.
      type: String
    - contextPath: MsGraph.AlertComment.Comments.comment
      description: The comment itself
      type: String
    - contextPath: MsGraph.AlertComment.Comments.createdByDisplayName
      description: The comment's creator display name
      type: String
    - contextPath: MsGraph.AlertComment.Comments.createdDateTime
      description: The comment's creation time
      type: Date
  - deprecated: true
    description: Deprecated. Use the Azure Active Directory Users integration instead.
    execution: false
    name: msg-get-users
    outputs:
    - contextPath: MsGraph.User.Email
      description: User email address
      type: string
    - contextPath: MsGraph.User.ID
      description: User ID
      type: string
    - contextPath: MsGraph.User.Title
      description: User job title
      type: string
    - contextPath: MsGraph.User.Name
      description: User name
      type: string
  - arguments:
    - default: true
      description: User ID of user to retreive
      isArray: false
      name: user_id
      required: true
      secret: false
    deprecated: true
    description: Deprecated. Use the Azure Active Directory Users integration instead.
    execution: false
    name: msg-get-user
    outputs:
    - contextPath: MsGraph.User.Email
      description: User email address
      type: string
    - contextPath: MsGraph.User.ID
      description: User ID
      type: string
    - contextPath: MsGraph.User.Title
      description: User job title
      type: string
    - contextPath: MsGraph.User.Name
      description: User name
      type: string
  dockerimage: demisto/crypto:1.0.0.54987
  feed: false
  isfetch: true
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  subtype: python3
  type: python
tests:
- Microsoft Graph Security Test dev
- Microsoft Graph Security Test prod
fromversion: 5.0.0