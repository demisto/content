{"test_case_1": {"args": {"alert_id": "alert_id", "fields_to_include": "All"},
                    "mock_response": {
                    "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#Security/alerts/$entity",
                    "id": "da637225970530734950_-1768941086", "azureTenantId": "<tenant id>",
                    "azureSubscriptionId": null, "riskScore": null, "tags": [], "activityGroupName": null,
                    "assignedTo": null, "category": "Malware", "closedDateTime": null, "comments": [],
                    "confidence": null, "createdDateTime": "2020-04-16T01:24:13.0578348Z",
                    "description": "V1 alert description",
                    "detectionIds": [], "eventDateTime": "2020-04-16T01:22:39.3222427Z", "feedback": null,
                    "lastModifiedDateTime": "2020-04-19T10:18:39.35Z", "recommendedActions": [], "severity": "medium",
                    "sourceMaterials": ["https://securitycenter.microsoft.com/alert/da637225970530734950_-1768941086"],
                    "status": "newAlert", "title": "An active 'Wintapp' backdoor was detected",
                    "vendorInformation": {"provider": "Microsoft Defender ATP", "providerVersion": null,
                                          "subProvider": "MicrosoftDefenderATP", "vendor": "Microsoft"},
                    "cloudAppStates": [], "fileStates": [
                        {"name": "<file_name>", "path": "<file_path>", "riskScore": null,
                         "fileHash": {"hashType": "sha1", "hashValue": "f809b926576cab647125a3907ef9265bdb130a0a"}}],
                    "hostStates": [
                        {"fqdn": "desktop-s2455r8", "isAzureAdJoined": true, "isAzureAdRegistered": null,
                         "isHybridAzureDomainJoined": null, "netBiosName": null, "os": "Windows10",
                         "privateIpAddress": "127.0.0.1",
                         "publicIpAddress": "127.0.0.1", "riskScore": "High"}], "historyStates": [], "malwareStates": [],
                    "networkConnections": [], "processes": [], "registryKeyStates": [], "triggers": [],
                    "userStates": [], "vulnerabilityStates": []},
                    "api_version": "Legacy Alerts",
                    "expected_ec": {"MsGraph.Alert(val.ID && val.ID === obj.ID)": {"ID": "da637225970530734950_-1768941086",
                                                                                "Title": "An active 'Wintapp' backdoor was detected",
                                                                                "Category": "Malware", "Severity": "medium",
                                                                                "CreatedDate": "2020-04-16T01:24:13.0578348Z",
                                                                                "EventDate": "2020-04-16T01:22:39.3222427Z",
                                                                                "Status": "newAlert", "Vendor": "Microsoft",
                                                                                "Provider": "Microsoft Defender ATP"}},
                    "expected_hr": "## Microsoft Security Graph Alert Details - alert_id\n### Basic Properties\n|AzureTenantID|Category|CreatedDate|Description|EventDate|LastModifiedDate|Severity|Status|Title|\n|---|---|---|---|---|---|---|---|---|\n| <tenant id> | Malware | 2020-04-16T01:24:13.0578348Z | V1 alert description | 2020-04-16T01:22:39.3222427Z | 2020-04-16T01:22:39.3222427Z | medium | newAlert | An active 'Wintapp' backdoor was detected |\n### File Security States for Alert\n|FileHash|Name|Path|\n|---|---|---|\n| f809b926576cab647125a3907ef9265bdb130a0a | <file_name> | <file_path> |\n### Host Security States for Alert\n|Fqdn|OS|PrivateIPAddress|PublicIPAddress|RiskScore|\n|---|---|---|---|---|\n| desktop-s2455r8 | Windows10 | 127.0.0.1 | 127.0.0.1 | High |\n### Vendor Information for Alert\n|Provider|SubProvider|Vendor|\n|---|---|---|\n| Microsoft Defender ATP | MicrosoftDefenderATP | Microsoft |\n"
                    },
                    "test_case_2": {"args": {"alert_id": "alert_id", "fields_to_include": "FileStates"},
                    "mock_response": {
                        "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#Security/alerts/$entity",
                        "id": "da637225970530734950_-1768941086", "azureTenantId": "<tenant id>",
                        "azureSubscriptionId": null, "riskScore": null, "tags": [], "activityGroupName": null,
                        "assignedTo": null, "category": "Malware", "closedDateTime": null, "comments": [],
                        "confidence": null, "createdDateTime": "2020-04-16T01:24:13.0578348Z",
                        "description": "V1 alert description",
                        "detectionIds": [], "eventDateTime": "2020-04-16T01:22:39.3222427Z", "feedback": null,
                        "lastModifiedDateTime": "2020-04-19T10:18:39.35Z", "recommendedActions": [], "severity": "medium",
                        "sourceMaterials": ["https://securitycenter.microsoft.com/alert/da637225970530734950_-1768941086"],
                        "status": "newAlert", "title": "An active 'Wintapp' backdoor was detected",
                        "vendorInformation": {"provider": "Microsoft Defender ATP", "providerVersion": null,
                                              "subProvider": "MicrosoftDefenderATP", "vendor": "Microsoft"},
                        "cloudAppStates": [], "fileStates": [
                            {"name": "<file_name>", "path": "<file_path>", "riskScore": null,
                             "fileHash": {"hashType": "sha1", "hashValue": "f809b926576cab647125a3907ef9265bdb130a0a"}}],
                        "hostStates": [
                            {"fqdn": "desktop-s2455r8", "isAzureAdJoined": true, "isAzureAdRegistered": null,
                             "isHybridAzureDomainJoined": null, "netBiosName": null, "os": "Windows10",
                             "privateIpAddress": "127.0.0.1",
                             "publicIpAddress": "127.0.0.1", "riskScore": "High"}], "historyStates": [], "malwareStates": [],
                        "networkConnections": [], "processes": [], "registryKeyStates": [], "triggers": [],
                        "userStates": [], "vulnerabilityStates": []},
                        "api_version": "Legacy Alerts",
                        "expected_ec": {"MsGraph.Alert(val.ID && val.ID === obj.ID)": {"ID": "da637225970530734950_-1768941086",
                                                                                "Title": "An active 'Wintapp' backdoor was detected",
                                                                                "Category": "Malware", "Severity": "medium",
                                                                                "CreatedDate": "2020-04-16T01:24:13.0578348Z",
                                                                                "EventDate": "2020-04-16T01:22:39.3222427Z",
                                                                                "Status": "newAlert", "Vendor": "Microsoft",
                                                                                "Provider": "Microsoft Defender ATP"}},
                    "expected_hr": "## Microsoft Security Graph Alert Details - alert_id\n### Basic Properties\n|AzureTenantID|Category|CreatedDate|Description|EventDate|LastModifiedDate|Severity|Status|Title|\n|---|---|---|---|---|---|---|---|---|\n| <tenant id> | Malware | 2020-04-16T01:24:13.0578348Z | V1 alert description | 2020-04-16T01:22:39.3222427Z | 2020-04-16T01:22:39.3222427Z | medium | newAlert | An active 'Wintapp' backdoor was detected |\n### File Security States for Alert\n|FileHash|Name|Path|\n|---|---|---|\n| f809b926576cab647125a3907ef9265bdb130a0a | <file_name> | <file_path> |\n"
                },
                "test_case_3": {"args": {"alert_id": "alert_id", "fields_to_include": "FileStates"},
                    "mock_response": {"@odata.context": "https://graph.microsoft.com/v1.0/$metadata#security/alerts_v2/$entity",
                                      "actorDisplayName": null,
                                      "alertWebUrl": "https://security.microsoft.com/alerts/alert_id?tid=tid", "assignedTo": null,
                                      "category": "SuspiciousActivity", "classification": null, "comments": [],
                                      "createdDateTime": "2022-10-16T01:48:05.8655909Z",
                                      "description": "Some description about the alert.", "detectionSource": "automatedInvestigation",
                                      "detectorId": "aaa", "determination": null, "id": "alert_id", "incidentId": "incidentId",
                                      "severity": "informational", "status": "resolved", "serviceSource": "microsoftDefenderForEndpoint",
                                      "title": "Automated", "lastUpdateDateTime": "2022-10-16T02:08:57.1233333Z"
                                    },
                    "api_version": "Alerts v2",
                    "expected_ec": {"MsGraph.Alert(val.ID && val.ID === obj.ID)": {"@odata.context": "https://graph.microsoft.com/v1.0/$metadata#security/alerts_v2/$entity",
                                                                                   "ActorDisplayName": null, "AlertWebUrl": "https://security.microsoft.com/alerts/alert_id?tid=tid",
                                                                                   "AssignedTo": null, "Category": "SuspiciousActivity", "Classification": null, "Comments": [],
                                                                                   "CreatedDate": "2022-10-16T01:48:05.8655909Z",
                                                                                   "Description": "Some description about the alert.", "DetectionSource": "automatedInvestigation",
                                                                                   "DetectorId": "aaa", "Determination": null, "ID": "alert_id", "IncidentId": "incidentId",
                                                                                   "Severity": "informational", "Status": "resolved", "ServiceSource": "microsoftDefenderForEndpoint",
                                                                                   "Title": "Automated", "LastUpdateDateTime": "2022-10-16T02:08:57.1233333Z"}},
                    "expected_hr": "## Microsoft Security Graph Alert Details - alert_id\n|ID|DetectionSource|ServiceSource|Title|Category|Severity|CreatedDate|LastUpdateDateTime|Status|IncidentId|\n|---|---|---|---|---|---|---|---|---|---|\n| alert_id | automatedInvestigation | microsoftDefenderForEndpoint | Automated | SuspiciousActivity | informational | 2022-10-16T01:48:05.8655909Z | 2022-10-16T02:08:57.1233333Z | resolved | incidentId |\n"
                }
}