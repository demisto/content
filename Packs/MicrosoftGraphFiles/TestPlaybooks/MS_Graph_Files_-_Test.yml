id: test_MsGraphFiles
version: -1
name: test_MsGraphFiles
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: b034ab7e-f25a-4d9f-8b3f-6b466e9b17b7
    type: start
    task:
      id: b034ab7e-f25a-4d9f-8b3f-6b466e9b17b7
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: fc251b7b-1d64-4227-868c-b287762376ea
    type: regular
    task:
      id: fc251b7b-1d64-4227-868c-b287762376ea
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "24"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: 93093fbd-d481-4e3a-8dc2-6cbb851714a3
    type: regular
    task:
      id: 93093fbd-d481-4e3a-8dc2-6cbb851714a3
      version: -1
      name: Upload New File To Demisto
      description: |
        Creates a file (using the given data input or entry ID) and uploads it to the current investigation War Room.
      scriptName: FileCreateAndUploadV2
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "40"
    scriptarguments:
      data:
        simple: test ms graph file
      filename:
        simple: playbook1.txt
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: aed09050-41ec-4504-88e5-17cbbd7441e5
    type: regular
    task:
      id: aed09050-41ec-4504-88e5-17cbbd7441e5
      version: -1
      name: Upload New File To Ms Graph
      script: '|||msgraph-upload-new-file'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      entry_id:
        complex:
          root: File
          accessor: EntryID
      file_name:
        simple: playbook1.txt
      object_type:
        simple: drives
      object_type_id:
        simple: b!ZAovhtvn4Eapf5FWtPaT7lybnnqOkQpPspFV4riUtXuy_S3BgrgsSp0DNvpsLWoV
      parent_id:
        simple: 01VX7CPKF6Y2GOVW7725BZO354PWSELRRZ
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 8c516ab3-2491-4cc8-8ce1-d78145c8a4a8
    type: condition
    task:
      id: 8c516ab3-2491-4cc8-8ce1-d78145c8a4a8
      version: -1
      name: Test If File Was Uploaded In Context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "8"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: MsGraphFiles.UploadedFiles.Name
            iscontext: true
          right:
            value:
              simple: playbook1.txt
      - - operator: isExists
          left:
            value:
              complex:
                root: MsGraphFiles
                accessor: UploadedFiles.ParentReference.ID
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: MsGraphFiles
                accessor: UploadedFiles.DownloadUrl
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: MsGraphFiles
                accessor: UploadedFiles.ID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2905
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 6333093f-061b-4e75-87cc-93a503f82895
    type: regular
    task:
      id: 6333093f-061b-4e75-87cc-93a503f82895
      version: -1
      name: Upload New File To Demisto
      description: |
        Creates a file (using the given data input or entry ID) and uploads it to the current investigation War Room.
      scriptName: FileCreateAndUploadV2
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      data:
        simple: test playbook 2
      filename:
        simple: playbook2.txt
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3955
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 74a966c0-b9a5-45ad-848b-8ddbc3499825
    type: regular
    task:
      id: 74a966c0-b9a5-45ad-848b-8ddbc3499825
      version: -1
      name: Replace File's Content In MS Graph
      description: Replaces the content of the file in the specified MS Graph resource.
      script: '|||msgraph-replace-existing-file'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "37"
    scriptarguments:
      entry_id:
        complex:
          root: File
          accessor: EntryID
      item_id:
        complex:
          root: UploadedFileID
      object_type:
        simple: groups
      object_type_id:
        simple: 83900b2c-617f-4642-b778-17303be19009
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4305
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: a2e91be4-66f2-4e1f-81ed-199d043771dd
    type: regular
    task:
      id: a2e91be4-66f2-4e1f-81ed-199d043771dd
      version: -1
      name: Delete File Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: File
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3080
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: a1f85dd4-0f60-4078-88fe-9d6981901ad0
    type: regular
    task:
      id: a1f85dd4-0f60-4078-88fe-9d6981901ad0
      version: -1
      name: Save File ID
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      key:
        simple: UploadedFileID
      value:
        complex:
          root: MsGraphFiles
          accessor: UploadedFiles.ID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3430
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: 67cda1f2-b087-42ed-8316-7cc8ef2ee871
    type: regular
    task:
      id: 67cda1f2-b087-42ed-8316-7cc8ef2ee871
      version: -1
      name: Delete MsGraphFiles Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "41"
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: ${MsGraphFiles}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3605
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 69cf8581-b91c-41a5-88e5-32449356ca29
    type: condition
    task:
      id: 69cf8581-b91c-41a5-88e5-32449356ca29
      version: -1
      name: Test If Replace Command
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "12"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: MsGraphFiles.ReplacedFiles.Name
            iscontext: true
          right:
            value:
              simple: playbook1.txt
      - - operator: isExists
          left:
            value:
              complex:
                root: MsGraphFiles
                accessor: ReplacedFiles.ParentReference.ID
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: MsGraphFiles
                accessor: ReplacedFiles.OdataContext
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: MsGraphFiles
                accessor: ReplacedFiles.File.Hashes
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4655
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: 194f7931-b7cb-440a-896b-c9c0b7e2b082
    type: title
    task:
      id: 194f7931-b7cb-440a-896b-c9c0b7e2b082
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "13"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4830
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: edd14b8c-3278-4d1a-879f-3ca7ec9bc4bd
    type: regular
    task:
      id: edd14b8c-3278-4d1a-879f-3ca7ec9bc4bd
      version: -1
      name: Create New Folder In MS Graph
      description: Creates a new folder in a drive with the specified parent item
        or path.
      script: '|||msgraph-create-new-folder'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      folder_name:
        simple: playbook_folder
      object_type:
        simple: drives
      object_type_id:
        simple: b!RDctFH7NTE-76fPa5-vcg-ouY54nVzJCtors1LmkYNRucDgOdrfDSYsD6zrQj9zi
      parent_id:
        simple: 01YGQTXW56Y2GOVW7725BZO354PWSELRRZ
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4975
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: a48fb6e6-edb7-487c-882c-3043677cc328
    type: condition
    task:
      id: a48fb6e6-edb7-487c-882c-3043677cc328
      version: -1
      name: Test If New Folder Was Uploaded
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "16"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: MsGraphFiles
                accessor: CreatedFolders.Name
            iscontext: true
          right:
            value:
              simple: playbook_folder
      - - operator: isExists
          left:
            value:
              complex:
                root: MsGraphFiles
                accessor: CreatedFolders.Folder.ChildCount
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: MsGraphFiles
                accessor: CreatedFolders.WebUrl
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: MsGraphFiles
                accessor: CreatedFolders.ID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5150
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 686b9886-eade-4635-8069-7d5da99ac4f0
    type: regular
    task:
      id: 686b9886-eade-4635-8069-7d5da99ac4f0
      version: -1
      name: Save Folder ID In Context
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      key:
        simple: UploadedFolderID
      value:
        complex:
          root: MsGraphFiles
          accessor: CreatedFolders.ID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: 64d23df2-5583-45e0-80d4-e2cde54ebd1f
    type: title
    task:
      id: 64d23df2-5583-45e0-80d4-e2cde54ebd1f
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "44"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5325
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: 7bce3793-a4c2-46ac-8f8e-63715127d0fd
    type: regular
    task:
      id: 7bce3793-a4c2-46ac-8f8e-63715127d0fd
      version: -1
      name: Test Download File From Graph
      description: Downloads the file contents of the drive item.
      script: '|||msgraph-download-file'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      item_id:
        complex:
          root: UploadedFileID
      object_type:
        simple: drives
      object_type_id:
        simple: b!ZAovhtvn4Eapf5FWtPaT7lybnnqOkQpPspFV4riUtXuy_S3BgrgsSp0DNvpsLWoV
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: 6926c7a6-6f22-4370-868a-af9895227cd3
    type: regular
    task:
      id: 6926c7a6-6f22-4370-868a-af9895227cd3
      version: -1
      name: Delete File Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "67"
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: File
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: 17ba4a3a-23de-4bac-8ef4-7c523b152f38
    type: condition
    task:
      id: 17ba4a3a-23de-4bac-8ef4-7c523b152f38
      version: -1
      name: Test If File Was Downloaded
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "35"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: File
                accessor: Name
            iscontext: true
          right:
            value:
              complex:
                root: UploadedFileID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 1772d989-fa83-47ec-86fb-4c3a6955c067
    type: title
    task:
      id: 1772d989-fa83-47ec-86fb-4c3a6955c067
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "33"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: cb085594-3314-421b-8ddb-2cfb582f8010
    type: regular
    task:
      id: cb085594-3314-421b-8ddb-2cfb582f8010
      version: -1
      name: Test List Sites
      description: Returns a list of the tenant sites.
      script: '|||msgraph-list-sharepoint-sites'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "39"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1710
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 4cc2f857-972a-4fd1-8b94-b51adb047da8
    type: condition
    task:
      id: 4cc2f857-972a-4fd1-8b94-b51adb047da8
      version: -1
      name: Test If Got Sites In Context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "23"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: MsGraphFiles
                accessor: ListSites.Value.[0].CreatedDateTime
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: MsGraphFiles
                accessor: ListSites.Value.[0].ID
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: MsGraphFiles
                accessor: ListSites.Value.[0].LastModifiedDateTime
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: MsGraphFiles
                accessor: ListSites.Value.[0].WebUrl
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2060
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: c3536f5a-4664-40c8-8f62-4af3b17ca629
    type: title
    task:
      id: c3536f5a-4664-40c8-8f62-4af3b17ca629
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2235
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: 847cd45d-11b1-459c-8af4-cacb7cba2e6c
    type: regular
    task:
      id: 847cd45d-11b1-459c-8af4-cacb7cba2e6c
      version: -1
      name: List Drives In Site
      description: Returns the list of document libraries (drives) available for a
        target site.
      script: '|||msgraph-list-drives-in-site'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      limit:
        simple: "3"
      site_id:
        simple: demistodev.sharepoint.com,defa2285-86ca-449f-911c-b5dbce34dfda,7a9e9b5c-918e-4f0a-b291-55e2b894b57b
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "25":
    id: "25"
    taskid: 18dab965-8cfe-4105-bb0e-767f1652e6ca
    type: condition
    task:
      id: 18dab965-8cfe-4105-bb0e-767f1652e6ca
      version: -1
      name: Test If Site's Drives Are Saved In Context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "26"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: MsGraphFiles
                accessor: ListDrives.Value.[0].CreatedDateTime
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: MsGraphFiles
                accessor: ListDrives.Value.[0].Owner.Group.ID
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: MsGraphFiles
                accessor: ListDrives.Value.[0].ID
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: MsGraphFiles
                accessor: ListDrives.Value.[0].CreatedBy.DisplayName
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: 00c3937e-cbb0-4a1f-80eb-6d4d653fdf07
    type: title
    task:
      id: 00c3937e-cbb0-4a1f-80eb-6d4d653fdf07
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "27"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: 041c39f3-5575-43e2-814b-ef73dd0143c2
    type: regular
    task:
      id: 041c39f3-5575-43e2-814b-ef73dd0143c2
      version: -1
      name: List All Drive's Children
      description: Returns a list of files and folders in the specified drive.
      script: '|||msgraph-list-drive-content'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "38"
    scriptarguments:
      limit:
        simple: "3"
      object_type:
        simple: sites
      object_type_id:
        simple: demistodev.sharepoint.com,defa2285-86ca-449f-911c-b5dbce34dfda,7a9e9b5c-918e-4f0a-b291-55e2b894b57b
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: 5c280c99-5840-48bd-8d84-d1662816ab9d
    type: condition
    task:
      id: 5c280c99-5840-48bd-8d84-d1662816ab9d
      version: -1
      name: Test If Drive Children List In Context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "29"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: MsGraphFiles
                accessor: ListChildren.Children.Value.[0].ParentReference.ID
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: MsGraphFiles
                accessor: ListChildren.ParentID
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: MsGraphFiles
                accessor: ListChildren.Children.Value.[0].ID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: 27fa2e1e-c555-42fd-8ddd-4d1221924a3c
    type: title
    task:
      id: 27fa2e1e-c555-42fd-8ddd-4d1221924a3c
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "21"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1565
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: 052acdcc-c658-48cf-8906-c64a3f3e1714
    type: regular
    task:
      id: 052acdcc-c658-48cf-8906-c64a3f3e1714
      version: -1
      name: Delete File From Graph
      description: Deletes an item from OneDrive.
      script: '|||msgraph-delete-file'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "43"
    scriptarguments:
      item_id:
        complex:
          root: UploadedFileID
      object_type:
        simple: drives
      object_type_id:
        complex:
          root: UploadedFileParent
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7365
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: a9c5d216-7529-493b-8cac-2011b2cb1b52
    type: regular
    task:
      id: a9c5d216-7529-493b-8cac-2011b2cb1b52
      version: -1
      name: Save File DriveID
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      key:
        simple: UploadedFileParent
      value:
        complex:
          root: MsGraphFiles
          accessor: UploadedFiles.ParentReference.DriveId
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3255
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: 876b0058-56f0-4d33-837d-aa88bd6ef89f
    type: regular
    task:
      id: 876b0058-56f0-4d33-837d-aa88bd6ef89f
      version: -1
      name: Save Folder Parent ID
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      key:
        simple: UploadedFolderParentID
      value:
        complex:
          root: MsGraphFiles
          accessor: CreatedFolders.ParentReference.DriveId
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: 964933f2-8979-4d4a-8c97-85e427018de0
    type: regular
    task:
      id: 964933f2-8979-4d4a-8c97-85e427018de0
      version: -1
      name: Delete Folder From Graph
      description: Deletes an item from OneDrive.
      script: '|||msgraph-delete-file'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "42"
    scriptarguments:
      item_id:
        complex:
          root: UploadedFolderID
      object_type:
        simple: drives
      object_type_id:
        complex:
          root: UploadedFolderParentID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7015
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: 0f71e9c8-c62c-4320-82b2-0e22b0050ca3
    type: regular
    task:
      id: 0f71e9c8-c62c-4320-82b2-0e22b0050ca3
      version: -1
      name: sleep
      description: Sleep for X seconds
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "25"
    scriptarguments:
      seconds:
        simple: "5"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: 4970fc35-af3e-4a29-838f-81dc0f0df7c7
    type: regular
    task:
      id: 4970fc35-af3e-4a29-838f-81dc0f0df7c7
      version: -1
      name: Sleep
      description: Sleep for X seconds
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      seconds:
        simple: "4"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6695
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: 7fb68746-c123-4f93-87e2-97df0aa68801
    type: regular
    task:
      id: 7fb68746-c123-4f93-87e2-97df0aa68801
      version: -1
      name: Sleep
      description: Sleep for X seconds
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      seconds:
        simple: "6"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4130
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: 9fb575a2-e8d5-45a8-8ae3-b7d322828468
    type: regular
    task:
      id: 9fb575a2-e8d5-45a8-8ae3-b7d322828468
      version: -1
      name: Sleep
      description: Sleep for X seconds
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      seconds:
        simple: "3"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4480
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: fa4d253b-44c7-495e-8cb5-5dc0f65ba0ab
    type: regular
    task:
      id: fa4d253b-44c7-495e-8cb5-5dc0f65ba0ab
      version: -1
      name: Sleep
      description: Sleep for X seconds
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "28"
    scriptarguments:
      seconds:
        simple: "3"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1215
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: 1d4ec122-a6af-4a23-8d2a-c4d1c64502d9
    type: regular
    task:
      id: 1d4ec122-a6af-4a23-8d2a-c4d1c64502d9
      version: -1
      name: Sleep
      description: Sleep for X seconds
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      seconds:
        simple: "3"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1885
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: a262c453-ff53-411b-884b-9923b3cda470
    type: regular
    task:
      id: a262c453-ff53-411b-884b-9923b3cda470
      version: -1
      name: Sleep
      description: Sleep for X seconds
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      seconds:
        simple: "2"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2555
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: b4643230-07ff-4a8c-8626-0945d4655000
    type: regular
    task:
      id: b4643230-07ff-4a8c-8626-0945d4655000
      version: -1
      name: Sleep
      description: Sleep for X seconds
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      seconds:
        simple: "2"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3780
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: ebdd9a3a-3e75-4820-8f32-a9d2d5f022c2
    type: regular
    task:
      id: ebdd9a3a-3e75-4820-8f32-a9d2d5f022c2
      version: -1
      name: sleep
      description: Sleep for X seconds
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      seconds:
        simple: "7"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: 6a6c09d1-111e-4dcd-8bd5-72003283c450
    type: title
    task:
      id: 6a6c09d1-111e-4dcd-8bd5-72003283c450
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "68"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "44":
    id: "44"
    taskid: e5c79e2b-75be-41b9-8d66-705aea43c5c8
    type: regular
    task:
      id: e5c79e2b-75be-41b9-8d66-705aea43c5c8
      version: -1
      name: sleep
      description: Sleep for X seconds
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      seconds:
        simple: "3"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: e998fce4-0160-4531-8c49-fe289d09ce1b
    type: title
    task:
      id: e998fce4-0160-4531-8c49-fe289d09ce1b
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 10310
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: dad64de1-8349-40f6-8040-bdf21a31e69e
    type: regular
    task:
      id: dad64de1-8349-40f6-8040-bdf21a31e69e
      version: -1
      name: get large file
      description: Sends http request. Returns the response as json.
      scriptName: http
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "61"
    scriptarguments:
      filename:
        simple: file_image.jpg
      method:
        simple: GET
      saveAsFile:
        simple: "yes"
      url:
        simple: https://github.com/demisto/content/raw/master/TestData/jpg_with_pdf_extension.pdf
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7860
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: 73be8228-98b8-4a6d-8217-fe0d835119a5
    type: regular
    task:
      id: 73be8228-98b8-4a6d-8217-fe0d835119a5
      version: -1
      name: 'upload  new file '
      description: Uploads a file from Cortex XSOAR to the specified MS Graph resource.
      script: '|||msgraph-upload-new-file'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "49"
    scriptarguments:
      entry_id:
        complex:
          root: File
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: File.Size
                iscontext: true
              right:
                value:
                  simple: "7450762"
          accessor: EntryID
      file_name:
        simple: ${FileName}
      object_type:
        simple: drives
      object_type_id:
        simple: b!RDctFH7NTE-76fPa5-vcg-ouY54nVzJCtors1LmkYNRucDgOdrfDSYsD6zrQj9zi
      parent_id:
        simple: 01YGQTXW56Y2GOVW7725BZO354PWSELRRZ
      retry-count:
        simple: "2"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: 2fcaeb7e-9e5f-47c3-8a3d-a392dc466fa6
    type: condition
    task:
      id: 2fcaeb7e-9e5f-47c3-8a3d-a392dc466fa6
      version: -1
      name: Verify Results
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "56"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: MsGraphFiles.UploadedFiles.Name
            iscontext: true
          right:
            value:
              simple: ${FileName}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8735
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: 8e29cd2c-2854-42a9-87c9-cbab5a451820
    type: regular
    task:
      id: 8e29cd2c-2854-42a9-87c9-cbab5a451820
      version: -1
      name: Replace existing file
      description: Replaces the content of the file in the specified MS Graph resource.
      script: '|||msgraph-replace-existing-file'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "54"
    scriptarguments:
      entry_id:
        complex:
          root: ${File
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: ${File.Size}
                iscontext: true
              right:
                value:
                  simple: "4154880"
          accessor: EntryID}
      item_id:
        simple: ${id_image}
      object_type:
        simple: drives
      object_type_id:
        simple: b!RDctFH7NTE-76fPa5-vcg-ouY54nVzJCtors1LmkYNRucDgOdrfDSYsD6zrQj9zi
    separatecontext: false
    continueonerror: true
    continueonerrortype: errorPath
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9785
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "54":
    id: "54"
    taskid: c54f3d73-04f3-4304-87d3-4d59f93520e7
    type: condition
    task:
      id: c54f3d73-04f3-4304-87d3-4d59f93520e7
      version: -1
      name: Verify Results
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "59"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: MsGraphFiles.ReplacedFiles.Name
            iscontext: true
          right:
            value:
              simple: ${FileName}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9960
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "55":
    id: "55"
    taskid: 32bf3332-c3cf-4771-82b2-35657c6d21e1
    type: regular
    task:
      id: 32bf3332-c3cf-4771-82b2-35657c6d21e1
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "60"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: id_image,FileName
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9435
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "56":
    id: "56"
    taskid: 2eba2c98-0535-4817-82d7-fc982e6fb730
    type: regular
    task:
      id: 2eba2c98-0535-4817-82d7-fc982e6fb730
      version: -1
      name: save id
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "63"
    scriptarguments:
      key:
        simple: id_image
      value:
        complex:
          root: MsGraphFiles.UploadedFiles
          filters:
          - - operator: isEqualNumber
              left:
                value:
                  simple: MsGraphFiles.UploadedFiles.Size
                iscontext: true
              right:
                value:
                  simple: "7450762"
          accessor: ID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8910
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "59":
    id: "59"
    taskid: 5d5e6814-8fc9-40ad-873a-1cf66b0b5dcc
    type: regular
    task:
      id: 5d5e6814-8fc9-40ad-873a-1cf66b0b5dcc
      version: -1
      name: delete file
      description: Deletes an item from OneDrive.
      script: '|||msgraph-delete-file'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "45"
    scriptarguments:
      item_id:
        simple: ${MsGraphFiles.ReplacedFiles.ID}
      object_type:
        simple: drives
      object_type_id:
        simple: b!RDctFH7NTE-76fPa5-vcg-ouY54nVzJCtors1LmkYNRucDgOdrfDSYsD6zrQj9zi
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 10135
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: 438bdb75-2ac3-4cd8-80e5-dd4e693568d7
    type: regular
    task:
      id: 438bdb75-2ac3-4cd8-80e5-dd4e693568d7
      version: -1
      name: get large file
      description: Sends http request. Returns the response as json.
      scriptName: http
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "53"
    scriptarguments:
      filename:
        simple: TestImage.jpg
      method:
        simple: GET
      saveAsFile:
        simple: "yes"
      url:
        simple: https://github.com/demisto/content/raw/master/TestData/TestImage.jpg.tar
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9610
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    id: "61"
    taskid: 840faf09-1e96-46fc-8835-d786a25f64d9
    type: regular
    task:
      id: 840faf09-1e96-46fc-8835-d786a25f64d9
      version: -1
      name: Sleep
      description: Sleep for X seconds
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "65"
    scriptarguments:
      seconds:
        simple: "30"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8035
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: c77bf55d-c81e-4a80-8ac6-6c46262a10e4
    type: regular
    task:
      id: c77bf55d-c81e-4a80-8ac6-6c46262a10e4
      version: -1
      name: list site content
      description: Returns a list of files and folders in the specified drive.
      script: '|||msgraph-list-drive-content'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "64"
    scriptarguments:
      item_id:
        simple: 01YGQTXW56Y2GOVW7725BZO354PWSELRRZ
      object_type:
        simple: drives
      object_type_id:
        simple: b!RDctFH7NTE-76fPa5-vcg-ouY54nVzJCtors1LmkYNRucDgOdrfDSYsD6zrQj9zi
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9085
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "64":
    id: "64"
    taskid: d71d24a5-0538-4af5-8564-9830dd806c11
    type: condition
    task:
      id: d71d24a5-0538-4af5-8564-9830dd806c11
      version: -1
      name: Verify Results
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "55"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: MsGraphFiles.ListChildren.Children.Value.Name
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: MsGraphFiles.ListChildren.Children.Value.Name
                      iscontext: true
                    right:
                      value:
                        simple: ${FileName}
            iscontext: true
          right:
            value:
              simple: ${FileName}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9260
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "65":
    id: "65"
    taskid: 70ccf950-5034-4f17-8562-9b11c233714f
    type: regular
    task:
      id: 70ccf950-5034-4f17-8562-9b11c233714f
      version: -1
      name: Generate_file_name
      description: Generates random string
      scriptName: GenerateRandomString
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "66"
    scriptarguments:
      Digits:
        simple: "True"
      Length:
        simple: "2"
      Lowercase:
        simple: "False"
      Punctuation:
        simple: "False"
      Uppercase:
        simple: "False"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "66":
    id: "66"
    taskid: 97ccb42f-8326-4538-8d16-a255878299de
    type: regular
    task:
      id: 97ccb42f-8326-4538-8d16-a255878299de
      version: -1
      name: save file name
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "47"
    scriptarguments:
      key:
        simple: FileName
      value:
        simple: ${RandomString}.jpeg
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8385
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "67":
    id: "67"
    taskid: b0041d7e-2634-4de1-8c2e-e26a7b6789b5
    type: regular
    task:
      id: b0041d7e-2634-4de1-8c2e-e26a7b6789b5
      version: -1
      name: Test If File Exists
      description: Returns a list of files and folders in the specified drive.
      script: '|||msgraph-list-drive-content'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      item_id:
        simple: ${UploadedFileID}
      object_type:
        simple: drives
      object_type_id:
        simple: b!ZAovhtvn4Eapf5FWtPaT7lybnnqOkQpPspFV4riUtXuy_S3BgrgsSp0DNvpsLWoV
    separatecontext: false
    continueonerror: true
    continueonerrortype: errorPath
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "68":
    id: "68"
    taskid: 9f3dac4e-7d7a-435b-853f-308ff39cbd07
    type: regular
    task:
      id: 9f3dac4e-7d7a-435b-853f-308ff39cbd07
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "46"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7685
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 10320,
        "width": 380,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
sourceplaybookid: test_MsGraphFiles
fromversion: 5.0.0
