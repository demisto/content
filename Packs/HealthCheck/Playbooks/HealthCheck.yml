id: HealthCheck
version: -1
name: HealthCheck
description: New version for HealthCheck main playbook
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: ed5462e8-ec2a-4894-8f3b-460ebb57f5de
    type: start
    task:
      id: ed5462e8-ec2a-4894-8f3b-460ebb57f5de
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "1":
    id: "1"
    taskid: 0495c94a-855f-4d96-8f6d-fbb79d1ba74a
    type: playbook
    task:
      id: 0495c94a-855f-4d96-8f6d-fbb79d1ba74a
      version: -1
      name: Health Check - Collect Log Bundle
      description: "Collect Log bundle  and parse data\n\nHolding the default Thresholds:\n\
        {\n\t\"LargeInvestigations\": {\n\t\t\"numberofincidentswithmorethan500entries\"\
        : 300,\n\t\t\"numberofincidentsbiggerthan10mb\": 1,\n\t\t\"numberofincidentsbiggerthan1mb\"\
        : 300\n\t},\n\t\"LargeInputsOutputs\": {\n\t\t\"numberofincidentsIObiggerthan10mb\"\
        : 1,\n\t\t\"numberofincidentsIObiggerthan1mb\": 10\n\t},\n\t\"Indicators\"\
        : {\n\t\t\"relatedIndicatorCount\": 100\n\t},\n\t\"CPU\": {\n\t\t\"CPUHighUsage\"\
        : 90,\n\t\t\"CPULowUsage\": 30,\n\t\t\"CPUMediumUsage\": 70\n\t},\n\t\"Disk\"\
        : {\n\t\t\"DiskUsageHigh\": 90,\n\t\t\"DiskUsageMedium\": 80,\n\t\t\"DiskUsageLow\"\
        : 70,\n\t\t\"DiskUsageDailyIncrease\": 2\n\t},\n\t\"Docker\": {\n\t\t\"DockerContainerCPUUsage\"\
        : 10,\n\t\t\"DockerContainerRAMUsage\": 10\n\t},\n\t\"DB\": {\n\t\t\"FSPartitionsMedium\"\
        : 12,\n\t\t\"FSPartitionsLow\": 6\n\t},\n\t\"Playbooks\": {\n\t\t\"CustomPlaybookLength\"\
        : 30,\n\t\t\"CustomPlaybookSetIncidentCount\": 4,\n\t\t\"CustomPlaybookDeprecatedScriptIds\"\
        : [\n\t\t\t\"Sleep\",\n\t\t\t\"EmailAskUser\"\n\t\t]\n\t},\n\t\"Incidents\"\
        : {\n\t\t\"NumberOfDroppedIncidents\": 2000\n\t}\n}"
      playbookName: Health Check - Collect Log Bundle
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      Thresholds:
        simple: |-
          {
            "LargeInvestigations": {
              "numberofincidentswithmorethan500entries": 300,
              "numberofincidentsbiggerthan10mb": 1,
              "numberofincidentsbiggerthan1mb": 300
            },
            "LargeInputsOutputs": {
              "numberofincidentsIObiggerthan10mb": 1,
              "numberofincidentsIObiggerthan1mb": 10
            },
            "Indicators": {
              "relatedIndicatorCount": 100
            },
            "CPU": {
              "CPUHighUsage": 90,
              "CPULowUsage": 30,
              "CPUMediumUsage": 70
            },
            "Disk": {
              "DiskUsageHigh": 90,
              "DiskUsageMedium": 80,
              "DiskUsageLow": 70,
              "DiskUsageDailyIncrease": 2
            },
            "Docker": {
              "DockerContainerCPUUsage": 10,
              "DockerContainerRAMUsage": 10
            },
            "DB": {
              "FSPartitionsMedium": 12,
              "FSPartitionsLow": 6
            },
            "Playbooks": {
              "CustomPlaybookLength": 30,
              "CustomPlaybookSetIncidentCount": 4,
              "CustomPlaybookDeprecatedScriptIds": [
                "Sleep",
                "EmailAskUser"
              ]
            },
            "Incidents": {
              "NumberOfDroppedIncidents": 2000
            }
          }
    separatecontext: false
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "3":
    id: "3"
    taskid: c2ad3b40-2372-473d-8eff-14c077c57923
    type: title
    task:
      id: c2ad3b40-2372-473d-8eff-14c077c57923
      version: -1
      name: Collect Information
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "26"
      - "27"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "4":
    id: "4"
    taskid: 81227961-0b1b-4b4d-87f7-02062e3004ce
    type: regular
    task:
      id: 81227961-0b1b-4b4d-87f7-02062e3004ce
      version: -1
      name: Version
      description: Return the Demisto server version.
      scriptName: DemistoVersion
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 515
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    fieldMapping:
    - incidentfield: XSOAR Version
      output:
        simple: ${DemistoVersion.version}
    - incidentfield: XSOAR Build
      output:
        simple: ${DemistoVersion.buildNumber}
    skipunavailable: false
    quietmode: 0
  "5":
    id: "5"
    taskid: e659a569-9eeb-4666-875d-377adfe26bfd
    type: regular
    task:
      id: e659a569-9eeb-4666-875d-377adfe26bfd
      version: -1
      name: Workers
      description: Present or analyze workers usage
      scriptName: HealthCheckWorkers
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      isWidget:
        simple: "False"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1650
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "6":
    id: "6"
    taskid: e61ba712-ab67-4530-8743-899cda9abf5e
    type: regular
    task:
      id: e61ba712-ab67-4530-8743-899cda9abf5e
      version: -1
      name: Installed Packs
      description: "Read the installedpacks.json. \n\nCount and get packs names"
      scriptName: HealthCheckInstalledPacks
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      entryID:
        simple: "0"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1330
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "7":
    id: "7"
    taskid: a7dc5ad5-94dd-49ec-80ce-a24e4d2f8eda
    type: regular
    task:
      id: a7dc5ad5-94dd-49ec-80ce-a24e4d2f8eda
      version: -1
      name: integrations instances
      description: Trend graph for incidents created per day
      scriptName: HealthCheckIntegrations
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "13"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1330
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "8":
    id: "8"
    taskid: 145f36b5-3d05-4167-86bf-a45ef58945ba
    type: title
    task:
      id: 145f36b5-3d05-4167-86bf-a45ef58945ba
      version: -1
      name: System Details
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "4"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "12":
    id: "12"
    taskid: 19fbee26-a6ca-4d6d-89b2-d5afac503244
    type: title
    task:
      id: 19fbee26-a6ca-4d6d-89b2-d5afac503244
      version: -1
      name: Packs and Integrations
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "7"
      - "6"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1185
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "13":
    id: "13"
    taskid: 84022264-dca4-4a99-817c-c8985cb5c33f
    type: title
    task:
      id: 84022264-dca4-4a99-817c-c8985cb5c33f
      version: -1
      name: System Resources
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "5"
      - "15"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1505
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "14":
    id: "14"
    taskid: a8bfd8b5-f5e7-454a-8913-819ed20b026b
    type: regular
    task:
      id: a8bfd8b5-f5e7-454a-8913-819ed20b026b
      version: -1
      name: HealthCheckCPU
      description: 'Present or parse CPU usage stats '
      scriptName: HealthCheckCPU
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      isWidget:
        simple: "False"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1825
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "15":
    id: "15"
    taskid: 0baaa5e4-2b8a-401c-8e65-512a496a5a93
    type: regular
    task:
      id: 0baaa5e4-2b8a-401c-8e65-512a496a5a93
      version: -1
      name: HealthCheckDiskUsage
      description: 'Present or parse Disk usage stats '
      scriptName: HealthCheckDiskUsage
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      isWidget:
        simple: "False"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1650
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "16":
    id: "16"
    taskid: e027f88b-ce7d-4c2e-8d65-4ed103e14f27
    type: regular
    task:
      id: e027f88b-ce7d-4c2e-8d65-4ed103e14f27
      version: -1
      name: HealthCheckContainersStatus
      description: Containers status
      scriptName: HealthCheckContainersStatus
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "17"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1825
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "17":
    id: "17"
    taskid: 47775dae-f1b9-4b8c-8181-eac9f67433e6
    type: title
    task:
      id: 47775dae-f1b9-4b8c-8181-eac9f67433e6
      version: -1
      name: Playbook Analysis
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "18"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2000
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "18":
    id: "18"
    taskid: e961f37e-bb17-4f50-8325-1f0185a6f84e
    type: regular
    task:
      id: e961f37e-bb17-4f50-8325-1f0185a6f84e
      version: -1
      name: Analyze playbooks
      description: Parsing playbooks
      scriptName: HealthCheckPlaybookAnalysis
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      Thresholds:
        simple: ${Health Check Thresholds.Playbooks}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2145
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "19":
    id: "19"
    taskid: 80c54090-ba16-44ad-8dbb-b2899528a4aa
    type: title
    task:
      id: 80c54090-ba16-44ad-8dbb-b2899528a4aa
      version: -1
      name: Incidents
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "20"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "20":
    id: "20"
    taskid: 25cda229-f8c8-4e4d-8bc6-e13ce083a5ad
    type: regular
    task:
      id: 25cda229-f8c8-4e4d-8bc6-e13ce083a5ad
      version: -1
      name: Dropped Incidents
      description: Number of dropped incidents
      scriptName: HealthChecknumberOfDroppedIncidents
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "21"
    scriptarguments:
      Thresholds:
        simple: ${Health Check Thresholds.Incidents}
      isWidget: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2465
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "21":
    id: "21"
    taskid: b5f2a5ac-927a-4c67-8661-c3fb2cb5900e
    type: title
    task:
      id: b5f2a5ac-927a-4c67-8661-c3fb2cb5900e
      version: -1
      name: Indicators
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "22"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2655
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "22":
    id: "22"
    taskid: 26ad0762-c07b-42f3-8aa3-98c91909ebb2
    type: regular
    task:
      id: 26ad0762-c07b-42f3-8aa3-98c91909ebb2
      version: -1
      name: Analyze Indicators
      description: Reports on common indicators
      scriptName: HealthCheckCommonIndicators
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      Thresholds:
        simple: ${Health Check Thresholds.Indicators}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2815
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "23":
    id: "23"
    taskid: 98401d4f-8bee-4b29-8170-3a43b131135e
    type: title
    task:
      id: 98401d4f-8bee-4b29-8170-3a43b131135e
      version: -1
      name: Conclusions
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "24"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2990
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "24":
    id: "24"
    taskid: aec3316d-7a0b-4bfe-8bf0-e78deb0d8e9b
    type: regular
    task:
      id: aec3316d-7a0b-4bfe-8bf0-e78deb0d8e9b
      version: -1
      name: Save to action items table
      description: Creates a Grid table from items or key-value pairs.
      scriptName: SetGridField
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "25"
    scriptarguments:
      columns:
        simple: category,severity,description,resolution
      context_path:
        simple: actionableitems
      grid_id:
        simple: actionableitems
      keys:
        simple: category,severity,description,resolution
      overwrite:
        simple: "false"
      sort_by:
        simple: severity
      unpack_nested_elements: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3135
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "25":
    id: "25"
    taskid: 530a690a-e2e4-4748-826f-6f69aa7cf443
    type: title
    task:
      id: 530a690a-e2e4-4748-826f-6f69aa7cf443
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 3430
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "26":
    id: "26"
    taskid: ada7a0e4-5d0f-455e-8be8-23fce9f54374
    type: playbook
    task:
      id: ada7a0e4-5d0f-455e-8be8-23fce9f54374
      version: -1
      name: Health Check - Log Analysis Read All files
      description: Parse files
      playbookName: Health Check - Log Analysis Read All files
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "30"
    separatecontext: false
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 265,
          "y": 835
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "27":
    id: "27"
    taskid: 01d31adb-00b9-4a12-8339-67cf19fffd2e
    type: regular
    task:
      id: 01d31adb-00b9-4a12-8339-67cf19fffd2e
      version: -1
      name: Large Investigations
      description: Analyze large investigation
      scriptName: HealthCheckAnalyzeLargeInvestigations
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "28"
    scriptarguments:
      Thresholds:
        simple: ${Health Check Thresholds.LargeInvestigations}
    continueonerror: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 920,
          "y": 2465
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "28":
    id: "28"
    taskid: 9653fd82-55ef-4798-838c-a7cfa8d0701c
    type: regular
    task:
      id: 9653fd82-55ef-4798-838c-a7cfa8d0701c
      version: -1
      name: Large inputs and outputs
      description: 'Returns inputs and outputs larger than 1 MB from all Cortex XSOAR
        investigations in the last 6 months '
      scriptName: HealthCheckGetLargestInputsAndOuputsInIncidents
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "33"
    scriptarguments:
      Thresholds:
        simple: ${Health Check Thresholds.LargeInputsOutputs}
      from: {}
      table_result: {}
      to: {}
    continueonerror: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 920,
          "y": 2640
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "30":
    id: "30"
    taskid: 10c02e7a-93c6-45bd-8922-7c81c137f34d
    type: regular
    task:
      id: 10c02e7a-93c6-45bd-8922-7c81c137f34d
      version: -1
      name: Server Configuration
      description: Read the license_data.log file extracted from the log bundle
      scriptName: HealthCheckServerConfiguration
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      entryID:
        simple: "0"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1010
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "31":
    id: "31"
    taskid: cc1a7be7-9bd2-41bf-8e77-3c4f35201a1c
    type: regular
    task:
      id: cc1a7be7-9bd2-41bf-8e77-3c4f35201a1c
      version: -1
      name: Save to action items table
      description: Creates a Grid table from items or key-value pairs.
      scriptName: SetGridField
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "25"
    scriptarguments:
      columns:
        simple: category,severity,description,resolution
      context_path:
        simple: dbstatactionableitems
      grid_id:
        simple: actionableitems
      keys:
        simple: category,severity,description,resolution
      overwrite:
        simple: "false"
      sort_by:
        simple: severity
      unpack_nested_elements: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 920,
          "y": 3135
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "32":
    id: "32"
    taskid: b4cd391d-e09d-4434-89ed-87f4eda8200a
    type: title
    task:
      id: b4cd391d-e09d-4434-89ed-87f4eda8200a
      version: -1
      name: DB Stats Conclusions
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "31"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 920,
          "y": 3000
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "33":
    id: "33"
    taskid: 3505de5c-e109-4e62-845c-75fff8fa2047
    type: condition
    task:
      id: 3505de5c-e109-4e62-845c-75fff8fa2047
      version: -1
      name: DB stats conclusions
      description: Check DB stats output
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "25"
      "yes":
      - "32"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: dbstatactionableitems
            iscontext: true
    view: |-
      {
        "position": {
          "x": 920,
          "y": 2815
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 3445,
        "width": 1250,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
tests:
- No tests (auto formatted)
fromversion: 6.0.0
