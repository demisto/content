description: New version for HealthCheck main playbook
id: HealthCheck
inputs:
- description: ""
  key: ChangeThresholdsRequired
  playbookInputQuery:
  required: false
  value:
    simple: "false"
name: HealthCheck
outputs: []
starttaskid: "0"
tasks:
  "0":
    id: "0"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bb43c945-9532-4e71-812e-aed1f69c9885
      iscommand: false
      name: ""
      version: -1
      description: ''
    taskid: bb43c945-9532-4e71-812e-aed1f69c9885
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 50
        }
      }
    isautoswitchedtoquietmode: false
    isoversize: false
    continueonerrortype: ""
  "1":
    id: "1"
    ignoreworker: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "34"
    note: false
    quietmode: 0
    scriptarguments:
      Thresholds:
        simple: |-
          {
            "LargeInvestigations": {
              "numberofincidentswithmorethan500entries": 300,
              "numberofincidentsbiggerthan10mb": 1,
              "numberofincidentsbiggerthan1mb": 300
            },
            "LargeInputsOutputs": {
              "numberofincidentsIObiggerthan10mb": 1,
              "numberofincidentsIObiggerthan1mb": 10
            },
            "Indicators": {
              "relatedIndicatorCount": 100
            },
            "CPU": {
              "CPUHighUsage": 90,
              "CPULowUsage": 30,
              "CPUMediumUsage": 70
            },
            "Disk": {
              "DiskUsageHigh": 90,
              "DiskUsageMedium": 80,
              "DiskUsageLow": 70,
              "DiskUsageDailyIncrease": 2
            },
            "Docker": {
              "DockerContainerCPUUsage": 10,
              "DockerContainerRAMUsage": 10
            },
            "DB": {
              "FSPartitionsMedium": 12,
              "FSPartitionsLow": 6
            },
            "Playbooks": {
              "CustomPlaybookLength": 30,
              "CustomPlaybookSetIncidentCount": 4,
              "CustomPlaybookDeprecatedScriptIds": [
                "Sleep",
                "EmailAskUser"
              ]
            },
            "Incidents": {
              "NumberOfDroppedIncidents": 2000
            }
          }
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: "Collect Log bundle and parse data\n\nHolding the default Thresholds:\n{\n\t\"LargeInvestigations\": {\n\t\t\"numberofincidentswithmorethan500entries\": 300,\n\t\t\"numberofincidentsbiggerthan10mb\": 1,\n\t\t\"numberofincidentsbiggerthan1mb\": 300\n\t},\n\t\"LargeInputsOutputs\": {\n\t\t\"numberofincidentsIObiggerthan10mb\": 1,\n\t\t\"numberofincidentsIObiggerthan1mb\": 10\n\t},\n\t\"Indicators\": {\n\t\t\"relatedIndicatorCount\": 100\n\t},\n\t\"CPU\": {\n\t\t\"CPUHighUsage\": 90,\n\t\t\"CPULowUsage\": 30,\n\t\t\"CPUMediumUsage\": 70\n\t},\n\t\"Disk\": {\n\t\t\"DiskUsageHigh\": 90,\n\t\t\"DiskUsageMedium\": 80,\n\t\t\"DiskUsageLow\": 70,\n\t\t\"DiskUsageDailyIncrease\": 2\n\t},\n\t\"Docker\": {\n\t\t\"DockerContainerCPUUsage\": 10,\n\t\t\"DockerContainerRAMUsage\": 10\n\t},\n\t\"DB\": {\n\t\t\"FSPartitionsMedium\": 12,\n\t\t\"FSPartitionsLow\": 6\n\t},\n\t\"Playbooks\": {\n\t\t\"CustomPlaybookLength\": 30,\n\t\t\"CustomPlaybookSetIncidentCount\": 4,\n\t\t\"CustomPlaybookDeprecatedScriptIds\": [\n\t\t\t\"Sleep\",\n\t\t\t\"EmailAskUser\"\n\t\t]\n\t},\n\t\"Incidents\": {\n\t\t\"NumberOfDroppedIncidents\": 2000\n\t}\n}"
      id: a2b6c5c3-ed1f-46df-869c-e4c2ac59ceb5
      iscommand: false
      name: Health Check - Collect Log Bundle
      type: playbook
      version: -1
      playbookName: Health Check - Collect Log Bundle
    taskid: a2b6c5c3-ed1f-46df-869c-e4c2ac59ceb5
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 370
        }
      }
    isautoswitchedtoquietmode: false
    isoversize: false
    continueonerrortype: ""
  "3":
    id: "3"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "26"
      - "39"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 022eaaa4-cb90-4c9d-860d-e5840667f504
      iscommand: false
      name: Collect Information
      type: title
      version: -1
      description: ''
    taskid: 022eaaa4-cb90-4c9d-860d-e5840667f504
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 1215
        }
      }
    isautoswitchedtoquietmode: false
    isoversize: false
    continueonerrortype: ""
  "4":
    fieldMapping:
    - incidentfield: XSOAR Version
      output:
        simple: ${DemistoVersion.version}
    - incidentfield: XSOAR Build
      output:
        simple: ${DemistoVersion.buildNumber}
    - incidentfield: name
      output:
        simple: System Diagnostics and Health Check Report
    id: "4"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Return the Demisto server version.
      id: 223ef49a-f07c-41ba-86f7-b267bb7797f3
      iscommand: false
      name: Set version and incident name
      type: regular
      version: -1
      scriptName: DemistoVersion
    taskid: 223ef49a-f07c-41ba-86f7-b267bb7797f3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 1040
        }
      }
    isautoswitchedtoquietmode: false
    isoversize: false
    continueonerrortype: ""
  "5":
    id: "5"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "14"
    note: false
    quietmode: 0
    scriptarguments:
      isWidget:
        simple: "False"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Present or analyze workers usage
      id: 81785232-a01b-45f9-80c9-2c9a0d335747
      iscommand: false
      name: HealthCheckWorkers
      type: regular
      version: -1
      scriptName: HealthCheckWorkers
    taskid: 81785232-a01b-45f9-80c9-2c9a0d335747
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2175
        }
      }
    isautoswitchedtoquietmode: false
    isoversize: false
    continueonerrortype: ""
  "6":
    id: "6"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        simple: "0"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Read the installedpacks.json. \n\nCount and get packs names"
      id: 7ef521c8-74cd-4f16-8103-21a34e9a5d81
      iscommand: false
      name: Installed Packs
      type: regular
      version: -1
      scriptName: HealthCheckInstalledPacks
    taskid: 7ef521c8-74cd-4f16-8103-21a34e9a5d81
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -360,
          "y": 1855
        }
      }
    isautoswitchedtoquietmode: false
    isoversize: false
    continueonerrortype: ""
  "7":
    id: "7"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Trend graph for incidents created per day
      id: 8b4d4dae-fd4b-4eaa-8938-2749adf18af8
      iscommand: false
      name: Integrations instances
      type: regular
      version: -1
      scriptName: HealthCheckIntegrations
    taskid: 8b4d4dae-fd4b-4eaa-8938-2749adf18af8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 55,
          "y": 1855
        }
      }
    isautoswitchedtoquietmode: false
    isoversize: false
    continueonerrortype: ""
  "8":
    id: "8"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2fc43150-2498-40ea-88e2-9e6b3dccfc79
      iscommand: false
      name: System Details
      type: title
      version: -1
      description: ''
    taskid: 2fc43150-2498-40ea-88e2-9e6b3dccfc79
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 895
        }
      }
    isautoswitchedtoquietmode: false
    isoversize: false
    continueonerrortype: ""
  "12":
    id: "12"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "7"
      - "6"
      - "37"
      - "41"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3f7d0fad-7bbc-4336-83af-3eab156c0bb2
      iscommand: false
      name: Packs and Integrations
      type: title
      version: -1
      description: ''
    taskid: 3f7d0fad-7bbc-4336-83af-3eab156c0bb2
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1710
        }
      }
    isautoswitchedtoquietmode: false
    isoversize: false
    continueonerrortype: ""
  "13":
    id: "13"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "5"
      - "15"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 731c3f28-1eed-4cf3-8ba4-5a63af8b8ae7
      iscommand: false
      name: System Resources
      type: title
      version: -1
      description: ''
    taskid: 731c3f28-1eed-4cf3-8ba4-5a63af8b8ae7
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2030
        }
      }
    isautoswitchedtoquietmode: false
    isoversize: false
    continueonerrortype: ""
  "14":
    id: "14"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      isWidget:
        simple: "False"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: 'Present or parse CPU usage stats '
      id: 7faf6d30-8b9e-41b9-8091-24d7369606f5
      iscommand: false
      name: HealthCheckCPU
      type: regular
      version: -1
      scriptName: HealthCheckCPU
    taskid: 7faf6d30-8b9e-41b9-8091-24d7369606f5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2350
        }
      }
    isautoswitchedtoquietmode: false
    isoversize: false
    continueonerrortype: ""
  "15":
    id: "15"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      isWidget:
        simple: "False"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: 'Present or parse Disk usage stats '
      id: 682d21e4-66f8-40ae-8d05-1d8776223da2
      iscommand: false
      name: HealthCheckDiskUsage
      type: regular
      version: -1
      scriptName: HealthCheckDiskUsage
    taskid: 682d21e4-66f8-40ae-8d05-1d8776223da2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2175
        }
      }
    isautoswitchedtoquietmode: false
    isoversize: false
    continueonerrortype: ""
  "16":
    id: "16"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Containers status
      id: dfa698be-1dbf-4313-8d38-73f45871e7ea
      iscommand: false
      name: HealthCheckContainersStatus
      type: regular
      version: -1
      scriptName: HealthCheckContainersStatus
    taskid: dfa698be-1dbf-4313-8d38-73f45871e7ea
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2350
        }
      }
    isautoswitchedtoquietmode: false
    isoversize: false
    continueonerrortype: ""
  "17":
    id: "17"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5d9fa11a-174f-4d4c-8e7f-f1a6f10254f4
      iscommand: false
      name: Playbook Analysis
      type: title
      version: -1
      description: ''
    taskid: 5d9fa11a-174f-4d4c-8e7f-f1a6f10254f4
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2525
        }
      }
    isautoswitchedtoquietmode: false
    isoversize: false
    continueonerrortype: ""
  "18":
    id: "18"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      Thresholds:
        simple: ${Health Check Thresholds.Playbooks}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Parsing playbooks
      id: 52c21c5b-efd1-4111-8f5f-346b378d7fda
      iscommand: false
      name: Analyze playbooks
      type: regular
      version: -1
      scriptName: HealthCheckPlaybookAnalysis
    taskid: 52c21c5b-efd1-4111-8f5f-346b378d7fda
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2670
        }
      }
    isautoswitchedtoquietmode: false
    isoversize: false
    continueonerrortype: ""
  "19":
    id: "19"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7c6d94ba-ce04-45f1-8e30-bca08299451b
      iscommand: false
      name: Incidents
      type: title
      version: -1
      description: ''
    taskid: 7c6d94ba-ce04-45f1-8e30-bca08299451b
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2845
        }
      }
    isautoswitchedtoquietmode: false
    isoversize: false
    continueonerrortype: ""
  "20":
    id: "20"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "21"
    note: false
    quietmode: 0
    scriptarguments:
      Thresholds:
        simple: ${Health Check Thresholds.Incidents}
      isWidget:
        simple: "False"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Number of dropped incidents
      id: 4a95127a-8a43-4490-88b2-4b8629f51cc4
      iscommand: false
      name: Dropped Incidents
      type: regular
      version: -1
      scriptName: HealthCheckNumberOfDroppedIncidents
    taskid: 4a95127a-8a43-4490-88b2-4b8629f51cc4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2990
        }
      }
    isautoswitchedtoquietmode: false
    isoversize: false
    continueonerrortype: ""
  "21":
    id: "21"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1495ac62-fe0a-48a6-8284-08b6e582f7e8
      iscommand: false
      name: Indicators
      type: title
      version: -1
      description: ''
    taskid: 1495ac62-fe0a-48a6-8284-08b6e582f7e8
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3180
        }
      }
    isautoswitchedtoquietmode: false
    isoversize: false
    continueonerrortype: ""
  "22":
    id: "22"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      Thresholds:
        simple: ${Health Check Thresholds.Indicators}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Reports on common indicators
      id: 2146c98d-c987-4738-867e-923cbd8880b4
      iscommand: false
      name: Analyze Indicators
      type: regular
      version: -1
      scriptName: HealthCheckCommonIndicators
    taskid: 2146c98d-c987-4738-867e-923cbd8880b4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3340
        }
      }
    isautoswitchedtoquietmode: false
    isoversize: false
    continueonerrortype: ""
  "23":
    id: "23"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 846f711e-861c-40f2-8de7-58c4912c6774
      iscommand: false
      name: Conclusions
      type: title
      version: -1
      description: ''
    taskid: 846f711e-861c-40f2-8de7-58c4912c6774
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3515
        }
      }
    isautoswitchedtoquietmode: false
    isoversize: false
    continueonerrortype: ""
  "24":
    id: "24"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    scriptarguments:
      columns:
        simple: category,severity,description,resolution
      context_path:
        simple: HealthCheck.ActionableItems
      grid_id:
        simple: healthcheckactionableitems
      keys:
        simple: category,severity,description,resolution
      overwrite:
        simple: "false"
      sort_by:
        simple: severity
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Creates a Grid table from items or key-value pairs.
      id: 4682c3d6-0c79-44f1-8095-f446b48aad74
      iscommand: false
      name: Save to action items table
      type: regular
      version: -1
      scriptName: SetGridField
    taskid: 4682c3d6-0c79-44f1-8095-f446b48aad74
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3660
        }
      }
    isautoswitchedtoquietmode: false
    isoversize: false
    continueonerrortype: ""
  "25":
    id: "25"
    ignoreworker: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: dc5b70dc-2544-4dc9-887c-b10abd3438c2
      iscommand: false
      name: Done
      type: title
      version: -1
      description: ''
    taskid: dc5b70dc-2544-4dc9-887c-b10abd3438c2
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 3835
        }
      }
    isautoswitchedtoquietmode: false
    isoversize: false
    continueonerrortype: ""
  "26":
    id: "26"
    ignoreworker: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "30"
    note: false
    quietmode: 0
    scriptarguments:
      LogFiles:
        simple: ${File}
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: Parse files
      id: 373b8598-b5b6-4873-8f6d-f41f7e4dc43f
      iscommand: false
      name: Health Check - Log Analysis Read All files
      type: playbook
      version: -1
      playbookName: Health Check - Log Analysis Read All files
    taskid: 373b8598-b5b6-4873-8f6d-f41f7e4dc43f
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1360
        }
      }
    isautoswitchedtoquietmode: false
    isoversize: false
    continueonerrortype: ""
  "27":
    continueonerror: true
    id: "27"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      Thresholds:
        simple: ${Health Check Thresholds.LargeInvestigations}
      Append:
        simple: "True"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Analyze large investigation
      id: bd215330-6c70-4030-8221-3f405a5a7756
      iscommand: false
      name: Large Investigations
      type: regular
      version: -1
      scriptName: HealthCheckAnalyzeLargeInvestigations
    taskid: bd215330-6c70-4030-8221-3f405a5a7756
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 960,
          "y": 2990
        }
      }
    isautoswitchedtoquietmode: false
    isoversize: false
    continueonerrortype: ""
  "28":
    continueonerror: true
    id: "28"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    scriptarguments:
      Thresholds:
        simple: ${Health Check Thresholds.LargeInputsOutputs}
      Append:
        simple: "True"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: 'Returns inputs and outputs larger than 1 MB from all Cortex XSOAR investigations in the last 6 months '
      id: 0a8657a8-440d-4784-8ccb-aaa78d9ff490
      iscommand: false
      name: Large inputs and outputs
      type: regular
      version: -1
      scriptName: HealthCheckGetLargestInputsAndOutputsInIncidents
    taskid: 0a8657a8-440d-4784-8ccb-aaa78d9ff490
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 960,
          "y": 3165
        }
      }
    isautoswitchedtoquietmode: false
    isoversize: false
    continueonerrortype: ""
  "30":
    id: "30"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        simple: "0"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Read the license_data.log file extracted from the log bundle
      id: 5c48e0d0-96db-4f37-897b-88507707cdaf
      iscommand: false
      name: Server Configuration
      type: regular
      version: -1
      scriptName: HealthCheckServerConfiguration
    taskid: 5c48e0d0-96db-4f37-897b-88507707cdaf
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1535
        }
      }
    isautoswitchedtoquietmode: false
    isoversize: false
    continueonerrortype: ""
  "31":
    id: "31"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    scriptarguments:
      columns:
        simple: category,severity,description,resolution
      context_path:
        simple: dbstatactionableitems
      grid_id:
        simple: healthcheckactionableitems
      keys:
        simple: category,severity,description,resolution
      overwrite:
        simple: "false"
      sort_by:
        simple: severity
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Creates a Grid table from items or key-value pairs.
      id: 3d2d0a15-0670-4f24-8040-412a2fac1c3a
      iscommand: false
      name: Save to action items table
      type: regular
      version: -1
      scriptName: SetGridField
    taskid: 3d2d0a15-0670-4f24-8040-412a2fac1c3a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 3660
        }
      }
    isautoswitchedtoquietmode: false
    isoversize: false
    continueonerrortype: ""
  "32":
    id: "32"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "31"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 57143829-e534-4f84-8367-1b712943b93a
      iscommand: false
      name: DB Stats Conclusions
      type: title
      version: -1
      description: ''
    taskid: 57143829-e534-4f84-8367-1b712943b93a
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 3515
        }
      }
    isautoswitchedtoquietmode: false
    isoversize: false
    continueonerrortype: ""
  "33":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: dbstatactionableitems
          operator: isNotEmpty
      label: "yes"
    id: "33"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "25"
      "yes":
      - "32"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check DB stats output
      id: 1db5217f-500e-490b-88e3-ad4ed9f5d2dd
      iscommand: false
      name: DB stats conclusions
      type: condition
      version: -1
    taskid: 1db5217f-500e-490b-88e3-ad4ed9f5d2dd
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 960,
          "y": 3340
        }
      }
    isautoswitchedtoquietmode: false
    isoversize: false
    continueonerrortype: ""
  "34":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.ChangeThresholdsRequired
          operator: isTrue
      label: "yes"
    id: "34"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "8"
      "yes":
      - "35"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checking if default thresholds were changed
      id: 412e6352-74eb-4f12-8fa0-284dc9e132e2
      iscommand: false
      name: Is Change Thresholds Required?
      type: condition
      version: -1
    taskid: 412e6352-74eb-4f12-8fa0-284dc9e132e2
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 545
        }
      }
    isautoswitchedtoquietmode: false
    isoversize: false
    continueonerrortype: ""
  "35":
    id: "35"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Health Check Thresholds
      value:
        simple: |-
          {
            "LargeInvestigations": {
              "numberofincidentswithmorethan500entries": 300,
              "numberofincidentsbiggerthan10mb": 1,
              "numberofincidentsbiggerthan1mb": 300
            },
            "LargeInputsOutputs": {
              "numberofincidentsIObiggerthan10mb": 1,
              "numberofincidentsIObiggerthan1mb": 10
            },
            "Indicators": {
              "relatedIndicatorCount": 100
            },
            "CPU": {
              "CPUHighUsage": 90,
              "CPULowUsage": 30,
              "CPUMediumUsage": 70
            },
            "Disk": {
              "DiskUsageHigh": 90,
              "DiskUsageMedium": 80,
              "DiskUsageLow": 70,
              "DiskUsageDailyIncrease": 2
            },
            "DB": {
              "FSPartitionsMedium": 12,
              "FSPartitionsLow": 6
            },
            "Playbooks": {
              "CustomPlaybookLength": 30,
              "CustomPlaybookSetIncidentCount": 4,
              "CustomPlaybookDeprecatedScriptIds": [
                "Sleep",
                "EmailAskUser"
              ]
            },
            "Incidents": {
              "NumberOfDroppedIncidents": 2000
            }
          }
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 75e631cf-8092-4606-86b9-c7688d53fd35
      iscommand: false
      name: Set Thresholds
      type: regular
      version: -1
      scriptName: Set
    taskid: 75e631cf-8092-4606-86b9-c7688d53fd35
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 705,
          "y": 720
        }
      }
    isautoswitchedtoquietmode: false
    isoversize: false
    continueonerrortype: ""
  "36":
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Validate if API Integration was defined correctly.
        If not detect what is the problem and warn about it.
      id: 4d35c035-931e-47c3-89fd-325aba810fbb
      iscommand: false
      name: Validate API Integration
      type: regular
      version: -1
      scriptName: HealthCheckAPIvalidation
    taskid: 4d35c035-931e-47c3-89fd-325aba810fbb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 195
        }
      }
    continueonerrortype: ""
  "37":
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Parsing custom fields to detect indexed fields for risky field types
      id: 92261192-20d2-4770-858f-ba34eab37b7b
      iscommand: false
      name: Fields settings
      type: regular
      version: -1
      scriptName: HealthCheckFields
    taskid: 92261192-20d2-4770-858f-ba34eab37b7b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 880,
          "y": 1855
        }
      }
    continueonerrortype: ""
  "38":
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Collect data from System Diagnostics tool
      id: a3a0017f-4731-446e-8a69-3a512d5d5456
      iscommand: false
      name: DB System Diagnostics
      type: regular
      version: -1
      scriptName: HealthCheckSystemDiagnostics
    taskid: a3a0017f-4731-446e-8a69-3a512d5d5456
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 960,
          "y": 2830
        }
      }
    continueonerrortype: ""
  "39":
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "40"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f31bf32d-1513-46dd-874d-d45101f262c9
      iscommand: false
      name: Database Diagnostics
      type: title
      version: -1
      description: ''
    taskid: f31bf32d-1513-46dd-874d-d45101f262c9
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 960,
          "y": 2365
        }
      }
    continueonerrortype: ""
  "40":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: DemistoVersion.buildNumber
          operator: greaterThanOrEqual
          right:
            value:
              simple: "1222475"
      label: "yes"
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "27"
      "yes":
      - "38"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Bypass System Diagnostics data for versions older than 6.2
      id: a61ec44a-50b3-4a18-8f1b-76ecfa6850ff
      iscommand: false
      name: Version newer than 6.2.0
      type: condition
      version: -1
    taskid: a61ec44a-50b3-4a18-8f1b-76ecfa6850ff
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 960,
          "y": 2670
        }
      }
    continueonerrortype: ""
  "41":
    id: "41"
    taskid: afe1f555-cbf2-4712-880d-a0ec0e1e3f31
    type: regular
    task:
      id: afe1f555-cbf2-4712-880d-a0ec0e1e3f31
      version: -1
      name: Types settings
      description: "Identify custom and detached system incidents type  \nChecking if 'Auto Extraction' is turned on for:\nExtract from all\nExtract from specific indicators doesn't have any settings"
      scriptName: HealthCheckIncidentTypes
      type: regular
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 470,
          "y": 1855
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 3850,
        "width": 1700,
        "x": -360,
        "y": 50
      }
    }
  }
fromversion: 6.0.0
tests:
- No tests (auto formatted)
