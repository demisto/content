description: New version for HealthCheck main playbook
dirtyInputs: true
id: HealthCheck
inputs:
- description: ""
  key: ChangeThresholdsRequired
  playbookInputQuery: null
  required: false
  value:
    simple: "false"
name: HealthCheckMain
outputs: []
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f66578ba-0804-4f09-8b88-de1d5766f62b
      iscommand: false
      name: ""
      version: -1
    taskid: f66578ba-0804-4f09-8b88-de1d5766f62b
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 1237.5,
          "y": 50
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      Thresholds:
        simple: |-
          {
            "LargeInvestigations": {
              "numberofincidentswithmorethan500entries": 300,
              "numberofincidentsbiggerthan10mb": 1,
              "numberofincidentsbiggerthan1mb": 300
            },
            "LargeInputsOutputs": {
              "numberofincidentsIObiggerthan10mb": 1,
              "numberofincidentsIObiggerthan1mb": 10
            },
            "Indicators": {
              "relatedIndicatorCount": 100
            },
            "CPU": {
              "CPUHighUsage": 90,
              "CPULowUsage": 30,
              "CPUMediumUsage": 70
            },
            "Disk": {
              "DiskUsageHigh": 90,
              "DiskUsageMedium": 80,
              "DiskUsageLow": 70,
              "DiskUsageDailyIncrease": 2
            },
            "Docker": {
              "DockerContainerCPUUsage": 10,
              "DockerContainerRAMUsage": 10
            },
            "DB": {
              "FSPartitionsMedium": 12,
              "FSPartitionsLow": 6
            },
            "Playbooks": {
              "CustomPlaybookLength": 30,
              "CustomPlaybookSetIncidentCount": 4,
              "CustomPlaybookDeprecatedScriptIds": [
                "Sleep",
                "EmailAskUser"
              ]
            },
            "Incidents": {
              "NumberOfDroppedIncidents": 2000
            }
          }
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: "Collect Log bundle and parse data\n\nHolding the default Thresholds:\n{\n\t\"LargeInvestigations\":
        {\n\t\t\"numberofincidentswithmorethan500entries\": 300,\n\t\t\"numberofincidentsbiggerthan10mb\":
        1,\n\t\t\"numberofincidentsbiggerthan1mb\": 300\n\t},\n\t\"LargeInputsOutputs\":
        {\n\t\t\"numberofincidentsIObiggerthan10mb\": 1,\n\t\t\"numberofincidentsIObiggerthan1mb\":
        10\n\t},\n\t\"Indicators\": {\n\t\t\"relatedIndicatorCount\": 100\n\t},\n\t\"CPU\":
        {\n\t\t\"CPUHighUsage\": 90,\n\t\t\"CPULowUsage\": 30,\n\t\t\"CPUMediumUsage\":
        70\n\t},\n\t\"Disk\": {\n\t\t\"DiskUsageHigh\": 90,\n\t\t\"DiskUsageMedium\":
        80,\n\t\t\"DiskUsageLow\": 70,\n\t\t\"DiskUsageDailyIncrease\": 2\n\t},\n\t\"Docker\":
        {\n\t\t\"DockerContainerCPUUsage\": 10,\n\t\t\"DockerContainerRAMUsage\":
        10\n\t},\n\t\"DB\": {\n\t\t\"FSPartitionsMedium\": 12,\n\t\t\"FSPartitionsLow\":
        6\n\t},\n\t\"Playbooks\": {\n\t\t\"CustomPlaybookLength\": 30,\n\t\t\"CustomPlaybookSetIncidentCount\":
        4,\n\t\t\"CustomPlaybookDeprecatedScriptIds\": [\n\t\t\t\"Sleep\",\n\t\t\t\"EmailAskUser\"\n\t\t]\n\t},\n\t\"Incidents\":
        {\n\t\t\"NumberOfDroppedIncidents\": 2000\n\t}\n}"
      id: bd44d79c-1936-422c-8196-bb9250ce5c58
      iscommand: false
      name: Health Check - Collect Log Bundle
      playbookId: Health Check - Collect Log Bundle
      type: playbook
      version: -1
    taskid: bd44d79c-1936-422c-8196-bb9250ce5c58
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1452.5,
          "y": 1215
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
      - "39"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 295b3ee9-533e-43a4-82cc-48e07512f64c
      iscommand: false
      name: Collect Information
      type: title
      version: -1
    taskid: 295b3ee9-533e-43a4-82cc-48e07512f64c
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1452.5,
          "y": 1390
        }
      }
  "4":
    continueonerrortype: ""
    fieldMapping:
    - incidentfield: XSOAR Version
      output:
        simple: ${DemistoVersion.version}
    - incidentfield: XSOAR Build
      output:
        simple: ${DemistoVersion.buildNumber}
    - incidentfield: name
      output:
        simple: System Diagnostics and Health Check Report
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Return the Demisto server version.
      id: b5a943a2-eec6-40b0-8c39-fd94999b8742
      iscommand: false
      name: Set version and incident name
      script: DemistoVersion
      type: regular
      version: -1
    taskid: b5a943a2-eec6-40b0-8c39-fd94999b8742
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1237.5,
          "y": 865
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "14"
    note: false
    quietmode: 0
    scriptarguments:
      isWidget:
        simple: "False"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Present or analyze workers usage
      id: dce6d4e3-d0da-414b-84e3-76a31cf4ee5d
      iscommand: false
      name: HealthCheckWorkers
      script: HealthCheckWorkers
      type: regular
      version: -1
    taskid: dce6d4e3-d0da-414b-84e3-76a31cf4ee5d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2385,
          "y": 1795
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        simple: "0"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Read the installedpacks.json. \n\nCount and get packs names"
      id: 35c2e227-8e9c-4387-84dc-ccc9047c095f
      iscommand: false
      name: Installed Packs
      script: HealthCheckInstalledPacks
      type: regular
      version: -1
    taskid: 35c2e227-8e9c-4387-84dc-ccc9047c095f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 2670
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Trend graph for incidents created per day
      id: f385fc4b-99a3-491f-8abc-ecb577b95a0f
      iscommand: false
      name: Integrations instances
      script: HealthCheckIntegrations
      type: regular
      version: -1
    taskid: f385fc4b-99a3-491f-8abc-ecb577b95a0f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2670
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5f9673c9-591a-4e33-8483-766bb3731d70
      iscommand: false
      name: System Details
      type: title
      version: -1
    taskid: 5f9673c9-591a-4e33-8483-766bb3731d70
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1237.5,
          "y": 720
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
      - "6"
      - "37"
      - "41"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 538f68f8-f788-4274-84ac-8646bb17bf8d
      iscommand: false
      name: Packs and Integrations
      type: title
      version: -1
    taskid: 538f68f8-f788-4274-84ac-8646bb17bf8d
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 695,
          "y": 2525
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
      - "15"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ea3b9fa7-e4d3-487c-82a6-ed170c371740
      iscommand: false
      name: System Resources
      type: title
      version: -1
    taskid: ea3b9fa7-e4d3-487c-82a6-ed170c371740
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2600,
          "y": 1650
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "43"
    note: false
    quietmode: 0
    scriptarguments:
      isWidget:
        simple: "False"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: 'Present or parse CPU usage stats '
      id: 1e3b18bb-36af-4e48-86ae-f0a88af39a82
      iscommand: false
      name: HealthCheckCPU
      script: HealthCheckCPU
      type: regular
      version: -1
    taskid: 1e3b18bb-36af-4e48-86ae-f0a88af39a82
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2385,
          "y": 1970
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      isWidget:
        simple: "False"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: 'Present or parse Disk usage stats '
      id: 3069b3f6-8018-4490-80e8-b9e15fdad62c
      iscommand: false
      name: HealthCheckDiskUsage
      script: HealthCheckDiskUsage
      type: regular
      version: -1
    taskid: 3069b3f6-8018-4490-80e8-b9e15fdad62c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2885,
          "y": 1795
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "43"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Containers status
      id: b8b08fa0-9004-4573-8cf7-297fa80c768d
      iscommand: false
      name: HealthCheckContainersStatus
      script: HealthCheckContainersStatus
      type: regular
      version: -1
    taskid: b8b08fa0-9004-4573-8cf7-297fa80c768d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2885,
          "y": 1970
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 720a1818-7e21-4c95-8c8d-747d0ad9abd7
      iscommand: false
      name: Playbook Analysis
      type: title
      version: -1
    taskid: 720a1818-7e21-4c95-8c8d-747d0ad9abd7
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 2845
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      Thresholds:
        simple: ${Health Check Thresholds.Playbooks}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Parsing playbooks
      id: 14b2d196-385d-48e0-8e73-87fd21560777
      iscommand: false
      name: Analyze playbooks
      script: HealthCheckPlaybookAnalysis
      type: regular
      version: -1
    taskid: 14b2d196-385d-48e0-8e73-87fd21560777
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 2990
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: acdf6142-c120-4337-85f2-976cbb25eba2
      iscommand: false
      name: Incidents
      type: title
      version: -1
    taskid: acdf6142-c120-4337-85f2-976cbb25eba2
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 3180
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "21"
    note: false
    quietmode: 0
    scriptarguments:
      Thresholds:
        simple: ${Health Check Thresholds.Incidents}
      isWidget:
        simple: "False"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Number of dropped incidents
      id: c9456fd0-4535-4daf-8148-30bdcce5b65d
      iscommand: false
      name: Dropped Incidents
      script: HealthCheckNumberOfDroppedIncidents
      type: regular
      version: -1
    taskid: c9456fd0-4535-4daf-8148-30bdcce5b65d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 3340
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 55495882-3bd2-46d9-89ad-94cba4aec4d2
      iscommand: false
      name: Indicators
      type: title
      version: -1
    taskid: 55495882-3bd2-46d9-89ad-94cba4aec4d2
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 3530
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      Thresholds:
        simple: ${Health Check Thresholds.Indicators}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Reports on common indicators
      id: f1d49982-c4c4-4f87-8a0e-c1b62e9ee09c
      iscommand: false
      name: Analyze Indicators
      script: HealthCheckCommonIndicators
      type: regular
      version: -1
    taskid: f1d49982-c4c4-4f87-8a0e-c1b62e9ee09c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 3690
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 825274de-efeb-4b98-8eeb-f82721edc9db
      iscommand: false
      name: Conclusions
      type: title
      version: -1
    taskid: 825274de-efeb-4b98-8eeb-f82721edc9db
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 3865
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    scriptarguments:
      columns:
        simple: category,severity,description,resolution
      context_path:
        simple: HealthCheck.ActionableItems
      grid_id:
        simple: healthcheckactionableitems
      keys:
        simple: category,severity,description,resolution
      overwrite:
        simple: "false"
      sort_by:
        simple: severity
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Creates a Grid table from items or key-value pairs.
      id: 7775bd59-21d4-4d25-829e-4fc206a70e0f
      iscommand: false
      name: Save to action items table
      script: SetGridField
      type: regular
      version: -1
    taskid: 7775bd59-21d4-4d25-829e-4fc206a70e0f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 4010
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9f2ad83a-8ae8-4031-875e-36079cd3cf7a
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 9f2ad83a-8ae8-4031-875e-36079cd3cf7a
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1565,
          "y": 4185
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      LogFiles:
        simple: ${File}
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: Parse files
      id: 67ecd196-8ad9-4537-8e85-65ebcc234264
      iscommand: false
      name: Health Check - Log Analysis Read All files
      playbookId: Health Check - Log Analysis Read All files
      type: playbook
      version: -1
    taskid: 67ecd196-8ad9-4537-8e85-65ebcc234264
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 2600,
          "y": 1475
        }
      }
  "27":
    continueonerror: true
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      Append:
        simple: "True"
      Thresholds:
        simple: ${Health Check Thresholds.LargeInvestigations}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Analyze large investigation
      id: 1d04647a-72fd-4af5-87df-77631ab4d48b
      iscommand: false
      name: Large Investigations
      script: HealthCheckAnalyzeLargeInvestigations
      type: regular
      version: -1
    taskid: 1d04647a-72fd-4af5-87df-77631ab4d48b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1892.5,
          "y": 3340
        }
      }
  "28":
    continueonerror: true
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    scriptarguments:
      Append:
        simple: "True"
      Thresholds:
        simple: ${Health Check Thresholds.LargeInputsOutputs}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: 'Returns inputs and outputs larger than 1 MB from all Cortex XSOAR
        investigations in the last 6 months '
      id: a1ac10b8-21f4-4d66-8f51-209678d3d5a4
      iscommand: false
      name: Large inputs and outputs
      script: HealthCheckGetLargestInputsAndOutputsInIncidents
      type: regular
      version: -1
    taskid: a1ac10b8-21f4-4d66-8f51-209678d3d5a4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1892.5,
          "y": 3515
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    scriptarguments:
      entryID:
        simple: "0"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Read the license_data.log file extracted from the log bundle
      id: 15d4d591-3606-4501-8cfb-7a0845ae0b27
      iscommand: false
      name: Server Configuration
      script: HealthCheckServerConfiguration
      type: regular
      version: -1
    taskid: 15d4d591-3606-4501-8cfb-7a0845ae0b27
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 695,
          "y": 2350
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    scriptarguments:
      columns:
        simple: category,severity,description,resolution
      context_path:
        simple: dbstatactionableitems
      grid_id:
        simple: healthcheckactionableitems
      keys:
        simple: category,severity,description,resolution
      overwrite:
        simple: "false"
      sort_by:
        simple: severity
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Creates a Grid table from items or key-value pairs.
      id: c56bd777-9d90-48df-8588-c60d4ac5924b
      iscommand: false
      name: Save to action items table
      script: SetGridField
      type: regular
      version: -1
    taskid: c56bd777-9d90-48df-8588-c60d4ac5924b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1667.5,
          "y": 4010
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "31"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: defacf8f-b148-4635-8cc3-8ed597dc6bd3
      iscommand: false
      name: DB Stats Conclusions
      type: title
      version: -1
    taskid: defacf8f-b148-4635-8cc3-8ed597dc6bd3
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1667.5,
          "y": 3865
        }
      }
  "33":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: dbstatactionableitems
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "25"
      "yes":
      - "32"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check DB stats output
      id: 9b323171-79d5-41e9-8755-54011b7e00ac
      iscommand: false
      name: DB stats conclusions
      type: condition
      version: -1
    taskid: 9b323171-79d5-41e9-8755-54011b7e00ac
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1892.5,
          "y": 3690
        }
      }
  "34":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.ChangeThresholdsRequired
          operator: isTrue
      label: "yes"
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "8"
      "yes":
      - "35"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checking if default thresholds were changed
      id: 31d5a422-8178-4012-83f8-3dd9a67dcb06
      iscommand: false
      name: Is Change Thresholds Required?
      type: condition
      version: -1
    taskid: 31d5a422-8178-4012-83f8-3dd9a67dcb06
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1237.5,
          "y": 370
        }
      }
  "35":
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Health Check Thresholds
      value:
        simple: |-
          {
            "LargeInvestigations": {
              "numberofincidentswithmorethan500entries": 300,
              "numberofincidentsbiggerthan10mb": 1,
              "numberofincidentsbiggerthan1mb": 300
            },
            "LargeInputsOutputs": {
              "numberofincidentsIObiggerthan10mb": 1,
              "numberofincidentsIObiggerthan1mb": 10
            },
            "Indicators": {
              "relatedIndicatorCount": 100
            },
            "CPU": {
              "CPUHighUsage": 90,
              "CPULowUsage": 30,
              "CPUMediumUsage": 70
            },
            "Disk": {
              "DiskUsageHigh": 90,
              "DiskUsageMedium": 80,
              "DiskUsageLow": 70,
              "DiskUsageDailyIncrease": 2
            },
            "DB": {
              "FSPartitionsMedium": 12,
              "FSPartitionsLow": 6
            },
            "Playbooks": {
              "CustomPlaybookLength": 30,
              "CustomPlaybookSetIncidentCount": 4,
              "CustomPlaybookDeprecatedScriptIds": [
                "Sleep",
                "EmailAskUser"
              ]
            },
            "Incidents": {
              "NumberOfDroppedIncidents": 2000
            }
          }
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: cf209d67-8f54-46df-880b-25ea843b15e9
      iscommand: false
      name: Set Thresholds
      script: Set
      type: regular
      version: -1
    taskid: cf209d67-8f54-46df-880b-25ea843b15e9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1350,
          "y": 545
        }
      }
  "36":
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "34"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Validate if API Integration was defined correctly.
        If not detect what is the problem and warn about it.
      id: 9fd5ae7a-9f73-4097-8d4e-4135b1882198
      iscommand: false
      name: Validate API Integration
      script: HealthCheckAPIvalidation
      type: regular
      version: -1
    taskid: 9fd5ae7a-9f73-4097-8d4e-4135b1882198
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1237.5,
          "y": 195
        }
      }
  "37":
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Parsing custom fields to detect indexed fields for risky field
        types
      id: 46adbcd1-6cb8-4e26-8e56-c983f2ea395e
      iscommand: false
      name: Fields settings
      script: HealthCheckFields
      type: regular
      version: -1
    taskid: 46adbcd1-6cb8-4e26-8e56-c983f2ea395e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2670
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Collect data from System Diagnostics tool
      id: ebf7c0f3-6afc-4d0e-8302-968e3b94b9bd
      iscommand: false
      name: DB System Diagnostics
      script: HealthCheckSystemDiagnostics
      type: regular
      version: -1
    taskid: ebf7c0f3-6afc-4d0e-8302-968e3b94b9bd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1667.5,
          "y": 3165
        }
      }
  "39":
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "40"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a3188ef9-b04d-4075-8651-9c50d294c1e6
      iscommand: false
      name: Database Diagnostics
      type: title
      version: -1
    taskid: a3188ef9-b04d-4075-8651-9c50d294c1e6
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1892.5,
          "y": 2845
        }
      }
  "40":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: DemistoVersion.buildNumber
          operator: greaterThanOrEqual
          right:
            value:
              simple: "1222475"
      label: "yes"
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "27"
      "yes":
      - "38"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Bypass System Diagnostics data for versions older than 6.2
      id: 672aaa15-b664-41ed-8a53-10c649a48a6c
      iscommand: false
      name: Version newer than 6.2.0
      type: condition
      version: -1
    taskid: 672aaa15-b664-41ed-8a53-10c649a48a6c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1892.5,
          "y": 2990
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Identify custom and detached system incidents type  \nChecking
        if 'Auto Extraction' is turned on for:\nExtract from all\nExtract from specific
        indicators doesn't have any settings"
      id: f4e3e759-6796-4b79-859d-efcf0ea9698f
      iscommand: false
      name: Types settings
      script: HealthCheckIncidentTypes
      type: regular
      version: -1
    taskid: f4e3e759-6796-4b79-859d-efcf0ea9698f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2670
        }
      }
  "42":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: version
                root: DemistoVersion
                transformers:
                - args:
                    delimiter:
                      value:
                        simple: .
                  operator: split
                - operator: FirstArrayElement
          operator: isEqualNumber
          right:
            value:
              simple: "8"
      label: V8
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: version
                root: DemistoVersion
                transformers:
                - args:
                    delimiter:
                      value:
                        simple: .
                  operator: split
                - operator: FirstArrayElement
          operator: isEqualNumber
          right:
            value:
              simple: "6"
      label: V6
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      V6:
      - "1"
      V8:
      - "43"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d4b7c09d-cbd6-4c17-8b68-860dc08df8c9
      iscommand: false
      name: XSOAR Version
      type: condition
      version: -1
    taskid: d4b7c09d-cbd6-4c17-8b68-860dc08df8c9
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1237.5,
          "y": 1040
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "30"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: aae5a176-31b6-41ab-8729-92509f4cd2ac
      iscommand: false
      name: Server Configuration
      type: title
      version: -1
    taskid: aae5a176-31b6-41ab-8729-92509f4cd2ac
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 695,
          "y": 2205
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 4200,
        "width": 3215,
        "x": 50,
        "y": 50
      }
    }
  }
