import Intel471MalwareIndicator as feed


def test_build_relationships():
    """
    Given:
        - relationships configuration.
    When:
        - getting indicators feed.
    Then:
        - validate the relationships is created correctly.
    """
    type_ = 'url'
    value_ = 'http://example_url.com'
    malware_family = 'test-malware'

    res = feed.build_relationships(type_, value_, malware_family)

    assert res[0] == {'entityA': 'http://example_url.com', 'entityAFamily': 'Indicator', 'entityAType': 'url',
                      'entityB': 'test-malware', 'entityBFamily': 'Indicator', 'entityBType': 'Malware',
                      'fields': {}, 'name': 'indicator-of', 'reverseName': 'indicated-by',
                      'type': 'IndicatorToIndicator'}
