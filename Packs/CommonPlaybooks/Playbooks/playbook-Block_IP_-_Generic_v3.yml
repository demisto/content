id: Block IP - Generic v3
version: -1
name: Block IP - Generic v3
description: "This playbook blocks malicious IP addresses using all integrations that\
  \ are enabled. The direction of the traffic that will be blocked is determined by\
  \ the XSOAR user (and set by default to outgoing)\nNote the following:\n-  some\
  \ of those integrations require specific parameters to run, which are based on the\
  \ playbook inputs. Also, certain integrations use FW rules or appended network objects.\n\
  - Note that the appended network objects should be specified in blocking rules inside\
  \ the system later on. \n\n\nSupported integrations for this playbook [Network security\
  \ products such as FW/WAF/IPs/etc.]: \n\n* Check Point Firewall\n* Palo Alto Networks\
  \ PAN-OS\n* Zscaler\n* FortiGate\n* Aria Packet Intelligence\n* Cisco Firepower\
  \ \n* Cisco Secure Cloud Analytics\n* Cisco ASA\n* Akamai WAF\n* F5 SilverLine\n\
  * ThreatX\n* Signal Sciences WAF\n* Sophos Firewall\n\n"
starttaskid: '0'
tasks:
  '0':
    id: '0'
    taskid: 2686e8f9-a0d6-4810-8750-99c1d6d9b510
    type: start
    task:
      id: 2686e8f9-a0d6-4810-8750-99c1d6d9b510
      version: -1
      name: ''
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '36'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2085,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '2':
    id: '2'
    taskid: 8bb87842-de6e-47f4-8247-6d36c5b75225
    type: title
    task:
      id: 8bb87842-de6e-47f4-8247-6d36c5b75225
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ''
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 3630,
          "y": 4715
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '5':
    id: '5'
    taskid: d7646141-09fa-4b2b-839b-fbaad3cf8486
    type: title
    task:
      id: d7646141-09fa-4b2b-839b-fbaad3cf8486
      version: -1
      name: Block IPs
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '17'
      - '18'
      - '20'
      - '26'
      - '30'
      - '55'
      - '60'
      - '64'
      - '63'
      - '67'
      - '71'
      - '79'
      - '74'
      - '104'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 4182.5,
          "y": 4075
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '7':
    id: '7'
    taskid: aa726b00-3476-4ff8-8f4e-abb4340d9b33
    type: condition
    task:
      id: aa726b00-3476-4ff8-8f4e-abb4340d9b33
      version: -1
      name: Is Check Point Firewall enabled?
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'
      scriptName: IsIntegrationAvailable
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - '2'
      yes:
      - '29'
    scriptarguments:
      brandname:
        simple: CheckPointFirewall_v2
    results:
    - brandInstances
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1547.5,
          "y": 4375
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '8':
    id: '8'
    taskid: f920f331-b63c-477e-84ed-f29e6d3a707f
    type: condition
    task:
      id: f920f331-b63c-477e-84ed-f29e6d3a707f
      version: -1
      name: Is there an IP to block?
      description: Verify that there is at least one IP to block.
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - '96'
      yes:
      - '43'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: isExists
          left:
            value:
              simple: BlockList.Input
            iscontext: true
        - operator: isExists
          left:
            value:
              simple: BlockList.Malicious
            iscontext: true
        - operator: isExists
          left:
            value:
              simple: BlockList.Suspicious
            iscontext: true
    view: |-
      {
        "position": {
          "x": 2320,
          "y": 3240
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '12':
    id: '12'
    taskid: 6cabaca1-2d12-4fa8-8b2b-c6c36185108c
    type: condition
    task:
      id: 6cabaca1-2d12-4fa8-8b2b-c6c36185108c
      version: -1
      name: Is Zscaler enabled?
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'
      scriptName: IsIntegrationAvailable
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - '2'
      yes:
      - '13'
    scriptarguments:
      brandname:
        simple: Zscaler
    results:
    - brandInstances
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1997.5,
          "y": 4375
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '13':
    id: '13'
    taskid: 9a193649-8c46-48e9-82da-e6e2c7f8bca3
    type: regular
    task:
      id: 9a193649-8c46-48e9-82da-e6e2c7f8bca3
      version: -1
      name: Block IP with Zscaler
      description: Block the IPs using Zscaler.
      script: Zscaler|||zscaler-blacklist-ip
      type: regular
      iscommand: true
      brand: Zscaler
    nexttasks:
      '#none#':
      - '2'
    scriptarguments:
      ip:
        complex:
          root: BlockList
          accessor: Final
          transformers:
          - operator: uniq
          - operator: join
            args:
              separator:
                value:
                  simple: ','
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2110,
          "y": 4550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '14':
    id: '14'
    taskid: 43c7e602-f55f-4b3c-81fc-2f85f8a21528
    type: playbook
    task:
      id: 43c7e602-f55f-4b3c-81fc-2f85f8a21528
      version: -1
      name: PAN-OS - Block IP - Custom Block Rule
      description: "This playbook blocks IP addresses using Custom Block Rules in\
        \ Palo Alto Networks Panorama or Firewall.\nThe playbook receives malicious\
        \ IP addresses as inputs, creates a custom bi-directional rule to block them,\
        \ and commits the configuration."
      playbookName: PAN-OS - Block IP - Custom Block Rule
      type: playbook
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '2'
    scriptarguments:
      AutoCommit:
        simple: ${inputs.AutoCommit}
      IP:
        complex:
          root: BlockList
          accessor: Final
          transformers:
          - operator: uniq
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ''
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 310,
          "y": 4550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '15':
    id: '15'
    taskid: 31aacd0b-e716-4f1f-8f32-3e218651f132
    type: playbook
    task:
      id: 31aacd0b-e716-4f1f-8f32-3e218651f132
      version: -1
      name: PAN-OS - Block IP - Static Address Group
      description: "This playbook blocks IP addresses using Static Address Groups\
        \ in Palo Alto Networks Panorama or Firewall.\nThe playbook receives malicious\
        \ IP addresses and an address group name as inputs, verifies that the addresses\
        \ are not already part of the address group, adds them and commits the configuration.\n\
        \n***Note - The playbook does not block the address group communication using\
        \ a policy block rule. This step will be taken once outside of the playbook."
      playbookName: PAN-OS - Block IP - Static Address Group
      type: playbook
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '2'
    scriptarguments:
      AddressGroupName:
        simple: ${inputs.StaticAddressGroup}
      AutoCommit:
        simple: ${inputs.AutoCommit}
      IP:
        complex:
          root: BlockList
          accessor: Final
          transformers:
          - operator: uniq
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ''
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 760,
          "y": 4550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '17':
    id: '17'
    taskid: 5ba1ed51-1d91-4e58-8218-5ee36149b73b
    type: title
    task:
      id: 5ba1ed51-1d91-4e58-8218-5ee36149b73b
      version: -1
      name: PAN-OS
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '22'
      - '23'
      - '25'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 545,
          "y": 4230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '18':
    id: '18'
    taskid: 9ef28a8c-3d0c-4083-81a1-77fd00e673b3
    type: title
    task:
      id: 9ef28a8c-3d0c-4083-81a1-77fd00e673b3
      version: -1
      name: CheckPoint FW
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '7'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1547.5,
          "y": 4230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '20':
    id: '20'
    taskid: d5adc878-c262-4ba9-8c7a-c1bf4d81849c
    type: title
    task:
      id: d5adc878-c262-4ba9-8c7a-c1bf4d81849c
      version: -1
      name: Zscaler
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '12'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1997.5,
          "y": 4230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '21':
    id: '21'
    taskid: a734501c-ebf6-4a1f-8949-7f05057fe189
    type: playbook
    task:
      id: a734501c-ebf6-4a1f-8949-7f05057fe189
      version: -1
      name: PAN-OS DAG Configuration
      description: "This playbook utilizes the Dynamic Address Group (DAG) capability\
        \ of PAN-OS.\nDAG enables analysts to create a rule one time, where the group\
        \ is the source/destination, and adds IP addresses dynamically without the\
        \ need to commit the configuration every time.\n\nThe playbook checks if the\
        \ given tag already exists. If the tag exists, then the IP address is added\
        \ to the tag.\n\nIf the tag does not exist, a new address group is created\
        \ with the given tag and a matching rule, and the configuration is committed.\
        \ \n"
      playbookName: PAN-OS DAG Configuration
      type: playbook
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '2'
    scriptarguments:
      action-type:
        simple: drop
      address_group_name:
        simple: ${inputs.StaticAddressGroup}
      auto_commit:
        simple: ${inputs.AutoCommit}
      inbound-or-outbound-rule:
        simple: ${inputs.RuleDirection}
      ip_list:
        complex:
          root: BlockList
          accessor: Final
          transformers:
          - operator: uniq
      pre-post-rulebase:
        simple: pre-rulebase
      rule-position:
        simple: top
      tag_name:
        simple: ${inputs.DAG}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ''
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 1210,
          "y": 4550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '22':
    id: '22'
    taskid: 36852417-0dc1-46cf-806b-60c62154f9b8
    type: condition
    task:
      id: 36852417-0dc1-46cf-806b-60c62154f9b8
      version: -1
      name: Use Custom Block Rules?
      description: Verify if custom block rule playbook input is set to true.
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - '2'
      yes:
      - '14'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: inputs.CustomBlockRule
                transformers:
                - operator: toLowerCase
            iscontext: true
          right:
            value:
              simple: 'true'
    view: |-
      {
        "position": {
          "x": 197.5,
          "y": 4375
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '23':
    id: '23'
    taskid: d2a9a096-543c-4531-875c-7e7dca19ad5a
    type: condition
    task:
      id: d2a9a096-543c-4531-875c-7e7dca19ad5a
      version: -1
      name: Use Static Address Group?
      description: Verify if there is a static address group name set as a playbook
        input.
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - '2'
      yes:
      - '15'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: inputs.StaticAddressGroup
            iscontext: true
    view: |-
      {
        "position": {
          "x": 647.5,
          "y": 4375
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '24':
    id: '24'
    taskid: e702c4a7-153e-4aaa-8013-4f89845ddffc
    type: condition
    task:
      id: e702c4a7-153e-4aaa-8013-4f89845ddffc
      version: -1
      name: Use External Dynamic List?
      description: Verify if there is a tag to mark IPs for an EDL/EIS query.
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - '2'
      yes:
      - '103'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: inputs.Tag
            iscontext: true
    view: |-
      {
        "position": {
          "x": 7557.5,
          "y": 4355
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '25':
    id: '25'
    taskid: 52e467e3-e7a1-4f15-8918-c89c704b8072
    type: condition
    task:
      id: 52e467e3-e7a1-4f15-8918-c89c704b8072
      version: -1
      name: Use Dynamic Address Group?
      description: Verify if there is a dynamic address group name set as a playbook
        input.
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - '2'
      yes:
      - '21'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: inputs.DAG
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1097.5,
          "y": 4375
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '26':
    id: '26'
    taskid: 910e5dfd-3878-47ab-8648-f2f53bd0e0a4
    type: title
    task:
      id: 910e5dfd-3878-47ab-8648-f2f53bd0e0a4
      version: -1
      name: Fortinet
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '27'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2447.5,
          "y": 4230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '27':
    id: '27'
    taskid: 6fded0d1-ce70-4798-8163-4cfda5e5f33a
    type: condition
    task:
      id: 6fded0d1-ce70-4798-8163-4cfda5e5f33a
      version: -1
      name: Is FortiGate enabled?
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'
      scriptName: IsIntegrationAvailable
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - '2'
      yes:
      - '28'
    scriptarguments:
      brandname:
        simple: FortiGate
    results:
    - brandInstances
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2447.5,
          "y": 4375
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '28':
    id: '28'
    taskid: af407ea4-dde4-4972-8580-573f9f63330b
    type: regular
    task:
      id: af407ea4-dde4-4972-8580-573f9f63330b
      version: -1
      name: 'FortiGate Ban IP '
      description: Adds IP addresses to the banned list.
      script: '|||fortigate-ban-ip'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '2'
    scriptarguments:
      ip_address:
        complex:
          root: BlockList
          accessor: Final
          transformers:
          - operator: uniq
          - operator: join
            args:
              separator:
                value:
                  simple: ','
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2560,
          "y": 4550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '29':
    id: '29'
    taskid: 61c96685-4200-48e1-8fbb-e9ce882dbba4
    type: playbook
    task:
      id: 61c96685-4200-48e1-8fbb-e9ce882dbba4
      version: -1
      name: Checkpoint - Block IP - Custom Block Rule
      description: "This playbook blocks IP addresses using Custom Block Rules in\
        \ Checkpoint Firewall.\nThe playbook receives malicious IP addresses as inputs,\
        \ creates a custom bi-directional rule to block them, and publishes the configuration."
      playbookName: Checkpoint - Block IP - Custom Block Rule
      type: playbook
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '2'
    scriptarguments:
      IP:
        simple: ${BlockList.Final}
      block_IP_error_handling:
        simple: Stop
      checkpoint_error_handling:
        simple: Stop
      install_policy:
        complex:
          root: inputs.AutoCommit
          transformers:
          - operator: If-Then-Else
            args:
              condition: {}
              else:
                value:
                  simple: 'False'
              equals:
                value:
                  simple: Yes
              lhs: {}
              options: {}
              rhs: {}
              then:
                value:
                  simple: 'True'
      policy_package:
        simple: Standard
      rule_layer:
        simple: Network
      rule_name:
        simple: ${inputs.RuleName}
      rule_position:
        simple: top
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ''
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 1660,
          "y": 4550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '30':
    id: '30'
    taskid: eb5c96df-b0b7-4bed-8c98-c4bf8bf48f38
    type: title
    task:
      id: eb5c96df-b0b7-4bed-8c98-c4bf8bf48f38
      version: -1
      name: F5 Silverline
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '32'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2897.5,
          "y": 4230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '31':
    id: '31'
    taskid: 01bd0464-1a56-4ea6-8c0d-bbb35b08b8b5
    type: regular
    task:
      id: 01bd0464-1a56-4ea6-8c0d-bbb35b08b8b5
      version: -1
      name: 'F5 Silverline - add IP to deny list '
      description: Adds a new particular threatening IP address object by its IP address.
      script: F5Silverline|||f5-silverline-ip-object-add
      type: regular
      iscommand: true
      brand: F5Silverline
    nexttasks:
      '#none#':
      - '2'
    scriptarguments:
      cidr_range:
        complex:
          root: BlockList
          accessor: Final
          transformers:
          - operator: join
            args:
              separator:
                value:
                  simple: ','
      list_type:
        simple: denylist
      note:
        simple: ${inputs.RuleName}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 3010,
          "y": 4550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '32':
    id: '32'
    taskid: 4c3fedae-b3ce-4d7b-85ac-df713046d1e2
    type: condition
    task:
      id: 4c3fedae-b3ce-4d7b-85ac-df713046d1e2
      version: -1
      name: Is F5 Silverline enabled?
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'
      scriptName: IsIntegrationAvailable
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - '2'
      yes:
      - '31'
    scriptarguments:
      brandname:
        simple: F5Silverline
    results:
    - brandInstances
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2897.5,
          "y": 4375
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '36':
    id: '36'
    taskid: 814e2ba6-0274-4c60-843f-5469ff4ac961
    type: condition
    task:
      id: 814e2ba6-0274-4c60-843f-5469ff4ac961
      version: -1
      name: Are there IPs in Inputs?
      description: Check if there are any IPs mentioned in the inputs section.
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - '8'
      yes:
      - '80'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: inputs.IP
                filters:
                - - operator: match
                    left:
                      value:
                        simple: inputs.IP
                      iscontext: true
                    right:
                      value:
                        simple: (\b25[0-5]|\b2[0-4][0-9]|\b[01]?[0-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 2085,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '41':
    id: '41'
    taskid: acfe5977-2735-48b3-8664-03f9be95d4fc
    type: condition
    task:
      id: acfe5977-2735-48b3-8664-03f9be95d4fc
      version: -1
      name: Are there any Malicious IPs?
      description: Check if there are any malicious IPs from the input IPs.
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - '8'
      yes:
      - '42'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: IP
                filters:
                - - operator: isExists
                    left:
                      value:
                        simple: IP.Malicious
                      iscontext: true
                accessor: Address
                transformers:
                - operator: uniq
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1560,
          "y": 1850
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '42':
    id: '42'
    taskid: d426cc42-ed05-44af-8e95-95b15ff76000
    type: regular
    task:
      id: d426cc42-ed05-44af-8e95-95b15ff76000
      version: -1
      name: Append Context List with IPs
      description: Set a value in context under the key you entered. If no value is
        entered, the script does nothing.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '8'
    scriptarguments:
      append:
        simple: 'true'
      key:
        simple: BlockList.Malicious
      value:
        complex:
          root: IP
          filters:
          - - operator: isExists
              left:
                value:
                  simple: IP.Malicious
                iscontext: true
          - - operator: inList
              left:
                value:
                  simple: IP.Address
                iscontext: true
              right:
                value:
                  simple: inputs.IP
                iscontext: true
              ignorecase: true
          accessor: Address
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1560,
          "y": 2205
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '43':
    id: '43'
    taskid: 79f69ebe-a058-48e1-8bd9-ada10a62c2a5
    type: title
    task:
      id: 79f69ebe-a058-48e1-8bd9-ada10a62c2a5
      version: -1
      name: User Verification Prompt
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '44'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 4182.5,
          "y": 2705
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '44':
    id: '44'
    taskid: 64fd6824-ef2f-458f-8b3d-574b3fdfa04e
    type: condition
    task:
      id: 64fd6824-ef2f-458f-8b3d-574b3fdfa04e
      version: -1
      name: Is User Verification required?
      description: Check if user verification is needed. Otherwise, proceed without
        asking questions.
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - '86'
      yes:
      - '95'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: inputs.UserVerification
            iscontext: true
          right:
            value:
              simple: 'True'
    view: |-
      {
        "position": {
          "x": 4182.5,
          "y": 2850
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '45':
    id: '45'
    taskid: a64c10cd-3cde-465b-8d1a-9aa30c0c60f2
    type: collection
    task:
      id: a64c10cd-3cde-465b-8d1a-9aa30c0c60f2
      version: -1
      name: 'Analyst Verification Prompt '
      description: "Ask the user what IPs should be blocked.\nNote that in this task\
        \ the following IPs are in your internal range:\n${BlockList.PIIP}\n\nRemember\
        \ that the direction you have decided is - ${inputs.RuleDirection}"
      type: collection
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '102'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 4612.5,
          "y": 3200
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to:
        simple: Analyst,Administrator
      subject:
        simple: Block IP Playbook - Analyst's Verification
      body:
        simple: "<p>Dear XSOAR user,</p>\n<p>This notification informs you that the\
          \ following list of IPs will be blocked on your XSOAR's integrated network\
          \ devices.</p>\n<p><br />(<strong>Note</strong>: the IPs will be added to\
          \ your company block list or be blocked in individual rules based on the\
          \ XSOAR integrated devices).</p>\n<p>Also, <strong>please note</strong>\
          \ that the following IPs are part of the <strong>internal range</strong>\
          \ mentioned in the playbook:</p>\n<p>${BlockList.PIIP}</p>\n<p>&nbsp;</p>\n\
          <p>For more information, click the link below.</p>"
      methods:
      - email
      format: html
      bcc:
      cc:
        simple: Administrator
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
        completeafterv2: false
        completeaftersla: false
    form:
      questions:
      - id: '0'
        label: ''
        labelarg:
          simple: Do you approve the blocking request for "Malicious IPs"?
        required: false
        gridcolumns: []
        defaultrows: []
        type: multiSelect
        options: []
        optionsarg:
        - complex:
            root: BlockList
            accessor: Malicious
        fieldassociated: ''
        placeholder: ''
        tooltip: ''
        readonly: false
      - id: '1'
        label: ''
        labelarg:
          simple: Do you approve the blocking request for "Suspicious IPs"?
        required: false
        gridcolumns: []
        defaultrows: []
        type: multiSelect
        options: []
        optionsarg:
        - complex:
            root: BlockList
            accessor: Suspicious
        fieldassociated: ''
        placeholder: ''
        tooltip: ''
        readonly: false
      - id: '2'
        label: ''
        labelarg:
          simple: Do you approve the blocking request for "Other IPs from Input"?
        required: false
        gridcolumns: []
        defaultrows: []
        type: multiSelect
        options: []
        optionsarg:
        - complex:
            root: BlockList.Input
            filters:
            - - operator: notIn
                left:
                  value:
                    simple: BlockList.Input
                  iscontext: true
                right:
                  value:
                    simple: BlockList.Suspicious
                  iscontext: true
            - - operator: notIn
                left:
                  value:
                    simple: BlockList.Input
                  iscontext: true
                right:
                  value:
                    simple: BlockList.Malicious
                  iscontext: true
                ignorecase: true
            - - operator: notIn
                left:
                  value:
                    simple: BlockList.Input
                  iscontext: true
                right:
                  value:
                    simple: BlockList.PIIP
                  iscontext: true
                ignorecase: true
        fieldassociated: ''
        placeholder: ''
        tooltip: ''
        readonly: false
      - id: '3'
        label: ''
        labelarg:
          simple: Do you approve the blocking request or "Internal Address"?
        required: false
        gridcolumns: []
        defaultrows: []
        type: multiSelect
        options: []
        optionsarg:
        - complex:
            root: BlockList.PIIP
            filters:
            - - operator: notIn
                left:
                  value:
                    simple: BlockList.PIIP
                  iscontext: true
                right:
                  value:
                    simple: BlockList.Suspicious
                  iscontext: true
            - - operator: notIn
                left:
                  value:
                    simple: BlockList.PIIP
                  iscontext: true
                right:
                  value:
                    simple: BlockList.Malicious
                ignorecase: true
            transformers:
            - operator: uniq
        - {}
        fieldassociated: ''
        placeholder: ''
        tooltip: ''
        readonly: false
      title: Please answer the following
      description: Please note that there are Internal IPs in this form!
      sender: Your SOC team
      expired: false
      totalanswers: 0
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '47':
    id: '47'
    taskid: 774acb51-4033-4c3a-8b1a-047a41acb9e2
    type: condition
    task:
      id: 774acb51-4033-4c3a-8b1a-047a41acb9e2
      version: -1
      name: Are there any Suspicious IPs?
      description: Check if any suspicious IPs were found during the IP enrichment
        process.
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - '8'
      YES:
      - '48'
    separatecontext: false
    conditions:
    - label: YES
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: DBotScore
                filters:
                - - operator: match
                    left:
                      value:
                        simple: DBotScore.Indicator
                      iscontext: true
                    right:
                      value:
                        simple: (\b25[0-5]|\b2[0-4][0-9]|\b[01]?[0-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}
                - - operator: inList
                    left:
                      value:
                        simple: DBotScore.Indicator
                      iscontext: true
                    right:
                      value:
                        simple: inputs.IP
                      iscontext: true
                accessor: Score
            iscontext: true
          right:
            value:
              simple: '2'
    view: |-
      {
        "position": {
          "x": 2160,
          "y": 1860
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '48':
    id: '48'
    taskid: 7bbd1ba9-ce60-489b-8702-99e0f1d2e799
    type: regular
    task:
      id: 7bbd1ba9-ce60-489b-8702-99e0f1d2e799
      version: -1
      name: Append Context List with IPs
      description: Set a value in context under the key you entered. If no value is
        entered, the script does nothing.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '8'
    scriptarguments:
      append:
        simple: 'true'
      key:
        simple: BlockList.Suspicious
      stringify:
        simple: 'false'
      value:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: '2'
          - - operator: match
              left:
                value:
                  simple: DBotScore.Indicator
                iscontext: true
              right:
                value:
                  simple: (\b25[0-5]|\b2[0-4][0-9]|\b[01]?[0-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}
          - - operator: inList
              left:
                value:
                  simple: DBotScore.Indicator
                iscontext: true
              right:
                value:
                  simple: inputs.IP
                iscontext: true
          accessor: Indicator
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2070,
          "y": 2200
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '51':
    id: '51'
    taskid: 0f6503c8-e512-4601-8ac8-28b581362ffe
    type: title
    task:
      id: 0f6503c8-e512-4601-8ac8-28b581362ffe
      version: -1
      name: Finalize Verdict For IP/s
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '41'
      - '47'
      - '85'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2160,
          "y": 1710
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '53':
    id: '53'
    taskid: d902efbe-8d9d-4d43-8556-9ada6a1fd915
    type: regular
    task:
      id: d902efbe-8d9d-4d43-8556-9ada6a1fd915
      version: -1
      name: Enrich Indicators
      description: commands.local.cmd.enrich.indicators
      script: Builtin|||enrichIndicators
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - '100'
    scriptarguments:
      indicatorsValues:
        complex:
          root: IP
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: IP.InRange
                iscontext: true
              right:
                value:
                  simple: No
              ignorecase: true
          - - operator: inList
              left:
                value:
                  simple: IP.Address
                iscontext: true
              right:
                value:
                  simple: inputs.IP
                iscontext: true
          accessor: Address
    reputationcalc: 2
    continueonerror: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2630,
          "y": 1320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '55':
    id: '55'
    taskid: 5969c1d1-b897-48d6-8cb4-5ea02ed70614
    type: title
    task:
      id: 5969c1d1-b897-48d6-8cb4-5ea02ed70614
      version: -1
      name: Cisco ASA
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '56'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 3407.5,
          "y": 4220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '56':
    id: '56'
    taskid: 6df919d4-f43c-4958-80ac-2c42927d6ca3
    type: condition
    task:
      id: 6df919d4-f43c-4958-80ac-2c42927d6ca3
      version: -1
      name: Is Cisco ASA enabled?
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'
      scriptName: IsIntegrationAvailable
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - '2'
      yes:
      - '57'
    scriptarguments:
      brandname:
        simple: Cisco ASA
    results:
    - brandInstances
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 3420,
          "y": 4370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '57':
    id: '57'
    taskid: 4b95bc79-65a6-466f-8757-6fc80f455142
    type: regular
    task:
      id: 4b95bc79-65a6-466f-8757-6fc80f455142
      version: -1
      name: Cisco ASA - Create Blocking Rule
      description: Creates a rule.
      script: '|||cisco-asa-create-rule'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '2'
    scriptarguments:
      active:
        complex:
          root: inputs.AutoCommit
          transformers:
          - operator: If-Then-Else
            args:
              condition: {}
              else:
                value:
                  simple: 'False'
              equals:
                value:
                  simple: Yes
              lhs: {}
              options: {}
              rhs: {}
              then:
                value:
                  simple: Ture
      destination:
        complex:
          root: inputs.RuleDirection
          transformers:
          - operator: If-Then-Else
            args:
              condition: {}
              else:
                value:
                  simple: 0.0.0.0
              equals:
                value:
                  simple: outbound
              lhs: {}
              options: {}
              rhs: {}
              then:
                value:
                  simple: ${BlockList.Final}
                iscontext: true
      interface_type:
        simple: Global
      log_level:
        simple: Default
      permit:
        simple: 'False'
      position:
        simple: top
      source:
        complex:
          root: inputs.RuleDirection
          transformers:
          - operator: If-Then-Else
            args:
              condition: {}
              else:
                value:
                  simple: ${BlockList.Final}
                iscontext: true
              equals:
                value:
                  simple: outbound
              lhs: {}
              options: {}
              rhs: {}
              then:
                value:
                  simple: 0.0.0.0
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 3620,
          "y": 4540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '58':
    id: '58'
    taskid: d22b840c-a735-4430-8fe5-19b43a7d891f
    type: condition
    task:
      id: d22b840c-a735-4430-8fe5-19b43a7d891f
      version: -1
      name: Is Cisco Secure Cloud Analytics enabled?
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'
      scriptName: IsIntegrationAvailable
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - '2'
      yes:
      - '59'
    scriptarguments:
      brandname:
        simple: Stealthwatch Cloud
    results:
    - brandInstances
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 3957.5,
          "y": 4365
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '59':
    id: '59'
    taskid: b8b1cfc2-4a27-4009-8315-4a7bf5a07c3c
    type: regular
    task:
      id: b8b1cfc2-4a27-4009-8315-4a7bf5a07c3c
      version: -1
      name: Cisco Secure Cloud Analytics - Add IP to Block List
      description: Add a domain or IP to the block list.
      script: '|||sw-block-domain-or-ip'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '2'
    scriptarguments:
      ip:
        complex:
          root: BlockList
          accessor: Final
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 4070,
          "y": 4540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '60':
    id: '60'
    taskid: a69684d6-d420-4dee-858d-a2698e0f6644
    type: title
    task:
      id: a69684d6-d420-4dee-858d-a2698e0f6644
      version: -1
      name: Cisco Secure Cloud Analytics
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '58'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 3957.5,
          "y": 4220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '61':
    id: '61'
    taskid: 06e19b2c-0a7d-4bdd-801b-430145f62523
    type: condition
    task:
      id: 06e19b2c-0a7d-4bdd-801b-430145f62523
      version: -1
      name: Is Cisco Firepower enabled?
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'
      scriptName: IsIntegrationAvailable
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - '2'
      yes:
      - '89'
    scriptarguments:
      brandname:
        simple: Cisco Firepower
    results:
    - brandInstances
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 4857.5,
          "y": 4365
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '63':
    id: '63'
    taskid: ed014993-13ef-4cc9-8853-2578605393e1
    type: title
    task:
      id: ed014993-13ef-4cc9-8853-2578605393e1
      version: -1
      name: 'Cisco Firepower '
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '61'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 4857.5,
          "y": 4220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '64':
    id: '64'
    taskid: 4dfbe12d-717b-477c-87fb-36cbde8083ac
    type: title
    task:
      id: 4dfbe12d-717b-477c-87fb-36cbde8083ac
      version: -1
      name: Akamai WAF
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '65'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 4407.5,
          "y": 4220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '65':
    id: '65'
    taskid: 7f8879bb-e9b1-4f60-80e3-fdff2de64bbf
    type: condition
    task:
      id: 7f8879bb-e9b1-4f60-80e3-fdff2de64bbf
      version: -1
      name: Is Akamai WAF enabled?
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'
      scriptName: IsIntegrationAvailable
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - '2'
      yes:
      - '66'
    scriptarguments:
      brandname:
        simple: Akamai WAF
    results:
    - brandInstances
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 4407.5,
          "y": 4365
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '66':
    id: '66'
    taskid: f747c56f-0a61-4d02-8b89-8cf1adc53c8e
    type: regular
    task:
      id: f747c56f-0a61-4d02-8b89-8cf1adc53c8e
      version: -1
      name: Akamai WAF - Add IP to a block list
      description: Adds elements to the specified network list.
      script: '|||akamai-add-elements-to-network-list'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '2'
    scriptarguments:
      elements:
        complex:
          root: BlockList
          accessor: Final
          transformers:
          - operator: join
            args:
              separator:
                value:
                  simple: ','
      network_list_id:
        simple: ${inputs.AkamaiNetworkListID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 4520,
          "y": 4540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '67':
    id: '67'
    taskid: 699a1683-a1ca-4ca8-8771-811b530774c1
    type: title
    task:
      id: 699a1683-a1ca-4ca8-8771-811b530774c1
      version: -1
      name: ThreatX
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '68'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 5670,
          "y": 4210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '68':
    id: '68'
    taskid: dd03c187-5984-44fa-86c8-452789c71188
    type: condition
    task:
      id: dd03c187-5984-44fa-86c8-452789c71188
      version: -1
      name: Is ThreatX enabled?
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'
      scriptName: IsIntegrationAvailable
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - '2'
      yes:
      - '69'
      - '93'
    scriptarguments:
      brandname:
        simple: ThreatX
    results:
    - brandInstances
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 5670,
          "y": 4355
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '69':
    id: '69'
    taskid: ca109f77-0896-4c1d-8f34-53e91d62fd2d
    type: regular
    task:
      id: ca109f77-0896-4c1d-8f34-53e91d62fd2d
      version: -1
      name: ThreatX - Block IP for 30 min
      description: Temporarily blocks an IP address or CIDR. Default is 30 minutes.
      script: '|||threatx-block-ip'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '2'
    scriptarguments:
      description:
        simple: ${inputs.RuleName}
      ip:
        complex:
          root: BlockList
          accessor: Final
          transformers:
          - operator: join
            args:
              separator:
                value:
                  simple: ','
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 5420,
          "y": 4540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '71':
    id: '71'
    taskid: 8802192f-9b17-47cb-8263-a175991a9e53
    type: title
    task:
      id: 8802192f-9b17-47cb-8263-a175991a9e53
      version: -1
      name: 'Signal Sciences WAF '
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '72'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 6207.5,
          "y": 4210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '72':
    id: '72'
    taskid: 39b851b8-fd3c-47a0-8579-2aa5185b45ed
    type: condition
    task:
      id: 39b851b8-fd3c-47a0-8579-2aa5185b45ed
      version: -1
      name: Is Signal Sciences WAF  enabled?
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'
      scriptName: IsIntegrationAvailable
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - '2'
      yes:
      - '73'
    scriptarguments:
      brandname:
        simple: Signal Sciences WAF
    results:
    - brandInstances
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 6207.5,
          "y": 4355
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '73':
    id: '73'
    taskid: 6389a4aa-7048-4c8a-88aa-a773b0bd15f6
    type: regular
    task:
      id: 6389a4aa-7048-4c8a-88aa-a773b0bd15f6
      version: -1
      name: Is Signal Sciences WAF   - Blacklist IPs
      description: Adding IPs to the Signal Sciences WAF integration.
      script: '|||sigsci-blacklist-add-ip'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '2'
    scriptarguments:
      ip:
        complex:
          root: BlockList
          accessor: Final
          transformers:
          - operator: join
            args:
              separator:
                value:
                  simple: ','
      note:
        simple: ${inputs.RuleName}
      siteName:
        simple: ${inputs.SiteName}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 6320,
          "y": 4530
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '74':
    id: '74'
    taskid: 438c0e02-ea9d-4764-86bb-69dcb8c6340e
    type: title
    task:
      id: 438c0e02-ea9d-4764-86bb-69dcb8c6340e
      version: -1
      name: Sophos Firewall
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '76'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 7107.5,
          "y": 4210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '75':
    id: '75'
    taskid: 9232361d-d035-4423-8125-9b2d0db7a6ea
    type: regular
    task:
      id: 9232361d-d035-4423-8125-9b2d0db7a6ea
      version: -1
      name: ARIA Packet Intelligence - Blacklist IPs
      description: Adds a rule that blocks packets destined for a specific IP address
        or range of IP addresses.
      script: '|||aria-block-dest-subnet'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '2'
    scriptarguments:
      rule_name:
        simple: ${inputs.RuleName}
      target_ip:
        complex:
          root: BlockList
          accessor: Final
          transformers:
          - operator: join
            args:
              separator:
                value:
                  simple: ','
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 6770,
          "y": 4530
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '76':
    id: '76'
    taskid: a4d5df6d-9ad0-4662-829b-0dd944d172de
    type: condition
    task:
      id: a4d5df6d-9ad0-4662-829b-0dd944d172de
      version: -1
      name: Is Sophos Firewall enabled?
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'
      scriptName: IsIntegrationAvailable
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - '2'
      yes:
      - '94'
    scriptarguments:
      brandname:
        simple: sophos_firewall
    results:
    - brandInstances
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 7107.5,
          "y": 4355
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '78':
    id: '78'
    taskid: 2e53e6e5-58e6-44a0-8690-5d7b5d4df0a1
    type: condition
    task:
      id: 2e53e6e5-58e6-44a0-8690-5d7b5d4df0a1
      version: -1
      name: Is ARIA Packet Intelligence enabled?
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'
      scriptName: IsIntegrationAvailable
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - '2'
      yes:
      - '75'
    scriptarguments:
      brandname:
        simple: ARIA Packet Intelligence
    results:
    - brandInstances
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 6657.5,
          "y": 4355
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '79':
    id: '79'
    taskid: 52301443-47b7-44ce-8611-30f685c538ae
    type: title
    task:
      id: 52301443-47b7-44ce-8611-30f685c538ae
      version: -1
      name: 'ARIA Packet Intelligence '
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '78'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 6657.5,
          "y": 4210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '80':
    id: '80'
    taskid: 986ad895-2b22-40dd-881d-6c9b30006e7c
    type: regular
    task:
      id: 986ad895-2b22-40dd-881d-6c9b30006e7c
      version: -1
      name: Check if there are internal IP addresses
      description: Returns 'yes' if the IP is in one of the ranges provided. Otherwise
        returns 'no'
      scriptName: IsIPInRanges
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - '105'
    scriptarguments:
      ip:
        complex:
          root: inputs.IP
          transformers:
          - operator: split
            args:
              delimiter:
                value:
                  simple: ','
      ipRanges:
        simple: ${inputs.InternalRange}
    continueonerror: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 3160,
          "y": 640
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '85':
    id: '85'
    taskid: 9c8a48c6-17cd-4264-88de-80dfbf609e69
    type: regular
    task:
      id: 9c8a48c6-17cd-4264-88de-80dfbf609e69
      version: -1
      name: Append Context List with Input IPs
      description: Add the IPs from the input.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '8'
    scriptarguments:
      append:
        simple: 'true'
      key:
        simple: BlockList.Input
      stringify:
        simple: 'false'
      value:
        complex:
          root: inputs.IP
          transformers:
          - operator: split
            args:
              delimiter:
                value:
                  simple: ','
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2690,
          "y": 1850
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '86':
    id: '86'
    taskid: f6367092-af8d-4cf8-845a-a832ee0a1e64
    type: regular
    task:
      id: f6367092-af8d-4cf8-845a-a832ee0a1e64
      version: -1
      name: Re-set the block list [Inputs]
      description: Set a value in context under the key you entered. If no value is
        entered, the script does nothing.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '5'
    scriptarguments:
      append:
        simple: 'true'
      key:
        simple: BlockList.Final
      value:
        simple: ${BlockList.Input}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 3470,
          "y": 3760
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '89':
    id: '89'
    taskid: 5570b158-bac4-4f60-858d-fea675f5f800
    type: playbook
    task:
      id: 5570b158-bac4-4f60-858d-fea675f5f800
      version: -1
      name: Cisco FirePower- Append network group object
      description: This playbook will append a network group object with new elements
        (IPs or network objects).
      playbookName: Cisco FirePower- Append network group object
      type: playbook
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '2'
    scriptarguments:
      IP:
        complex:
          root: BlockList
          accessor: Final
          transformers:
          - operator: join
            args:
              separator:
                value:
                  simple: ','
      Override:
        simple: 'False'
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ''
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 4970,
          "y": 4540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '90':
    id: '90'
    taskid: bb01d4ea-4a15-4a32-846f-25a478b853b1
    type: regular
    task:
      id: bb01d4ea-4a15-4a32-846f-25a478b853b1
      version: -1
      name: Re-set the block list [Inputs]
      description: Set a value in context under the key you entered. If no value is
        entered, the script does nothing.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '91'
    scriptarguments:
      append:
        simple: 'true'
      key:
        simple: BlockList.Final
      value:
        simple: ${Please answer the following.Answers.2}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 4397.5,
          "y": 3550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '91':
    id: '91'
    taskid: 6b935c1d-2e59-4fa3-8526-aac2802b133e
    type: regular
    task:
      id: 6b935c1d-2e59-4fa3-8526-aac2802b133e
      version: -1
      name: Re-set the block list [Malicious]
      description: Set a value in context under the key you entered. If no value is
        entered, the script does nothing.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '92'
    scriptarguments:
      append:
        simple: 'true'
      key:
        simple: BlockList.Final
      value:
        simple: ${Please answer the following.Answers.0}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 4397.5,
          "y": 3725
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '92':
    id: '92'
    taskid: d2e02b76-c1fb-400c-8cf2-5aff986e6abd
    type: regular
    task:
      id: d2e02b76-c1fb-400c-8cf2-5aff986e6abd
      version: -1
      name: Re-set the block list [Suspicious]
      description: Set a value in context under the key you entered. If no value is
        entered, the script does nothing.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '5'
    scriptarguments:
      append:
        simple: 'true'
      key:
        simple: BlockList.Final
      value:
        simple: ${Please answer the following.Answers.1}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 4397.5,
          "y": 3900
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '93':
    id: '93'
    taskid: 15d7e622-976c-4bbc-808e-40e2679a869f
    type: regular
    task:
      id: 15d7e622-976c-4bbc-808e-40e2679a869f
      version: -1
      name: ThreatX - add IP to a block list
      description: Adds an IP address or CIDR to the block list.
      script: '|||threatx-blacklist-ip'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '2'
    scriptarguments:
      description:
        simple: ${inputs.RuleName}
      ip:
        complex:
          root: BlockList
          accessor: Final
          transformers:
          - operator: join
            args:
              separator:
                value:
                  simple: ','
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 5870,
          "y": 4530
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '94':
    id: '94'
    taskid: cfc74163-8e71-4a6c-8a8b-90026747203a
    type: playbook
    task:
      id: cfc74163-8e71-4a6c-8a8b-90026747203a
      version: -1
      name: Sophos Firewall - Block IP
      description: "This playbook adds the IP address to a pre-configured firewall\
        \ rule. (The target firewall rule can be changed as requested.)\nPre-Requisite:\n\
        1) Create an IP host group.\n2) Create a firewall rule which refers to the\
        \ IP host group created in the previous step."
      playbookName: Sophos Firewall - Block IP
      type: playbook
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '2'
    scriptarguments:
      IP:
        complex:
          root: BlockList
          accessor: Final
          transformers:
          - operator: uniq
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ''
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 7220,
          "y": 4530
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '95':
    id: '95'
    taskid: 3ee9c547-fc6d-4e60-8eea-8ab54030bfa7
    type: condition
    task:
      id: 3ee9c547-fc6d-4e60-8eea-8ab54030bfa7
      version: -1
      name: Are There Any Internal IPs?
      description: Check if there are any internal IPs in the block requested IPs.
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - '98'
      yes:
      - '45'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: isExists
          left:
            value:
              simple: ${BlockList.PIIP}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 4397.5,
          "y": 3025
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '96':
    id: '96'
    taskid: 226a0ef3-9d2b-4a68-839c-1974fcbb4346
    type: title
    task:
      id: 226a0ef3-9d2b-4a68-839c-1974fcbb4346
      version: -1
      name: No IP to block
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '2'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2310,
          "y": 3540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '98':
    id: '98'
    taskid: a766bce9-cd2d-4030-80b3-3d5601dbe007
    type: collection
    task:
      id: a766bce9-cd2d-4030-80b3-3d5601dbe007
      version: -1
      name: Analyst Verification Prompt (without IP Internal List)
      description: "Ask the user what IPs should be blocked.\n\nRemember that the\
        \ direction you have decided is - ${inputs.RuleDirection}"
      type: collection
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '90'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 4157.5,
          "y": 3295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to:
        simple: Analyst,Administrator
      subject:
        simple: Block IP Playbook - Analyst's Verification
      body:
        simple: "<p>Dear XSOAR user,</p>\n<p>This notification informs you that the\
          \ following list of IPs will be blocked on your XSOAR's integrated network\
          \ devices.</p>\n<p><br />(<strong>Note</strong>: the IPs will be added to\
          \ your company block list or be blocked in individual rules based on the\
          \ XSOAR integrated devices).</p>\n<p>&nbsp;</p>\n<p>For more information,\
          \ click the link below.</p>"
      methods:
      - email
      format: html
      bcc:
      cc:
        simple: Administrator
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
        completeafterv2: false
        completeaftersla: false
    form:
      questions:
      - id: '0'
        label: ''
        labelarg:
          simple: Do you approve the blocking request for "Malicious IPs"?
        required: false
        gridcolumns: []
        defaultrows: []
        type: multiSelect
        options: []
        optionsarg:
        - complex:
            root: BlockList
            accessor: Malicious
        fieldassociated: ''
        placeholder: ''
        tooltip: ''
        readonly: false
      - id: '1'
        label: ''
        labelarg:
          simple: Do you approve the blocking request for "Suspiocus IPs"?
        required: false
        gridcolumns: []
        defaultrows: []
        type: multiSelect
        options: []
        optionsarg:
        - complex:
            root: BlockList
            accessor: Suspicious
        fieldassociated: ''
        placeholder: ''
        tooltip: ''
        readonly: false
      - id: '2'
        label: ''
        labelarg:
          simple: Do you approve the blocking request for "Other IPs from Input"?
        required: false
        gridcolumns: []
        defaultrows: []
        type: multiSelect
        options: []
        optionsarg:
        - complex:
            root: BlockList.Input
            filters:
            - - operator: notIn
                left:
                  value:
                    simple: BlockList.Input
                  iscontext: true
                right:
                  value:
                    simple: BlockList.Suspicious
                  iscontext: true
            - - operator: notIn
                left:
                  value:
                    simple: BlockList.Input
                  iscontext: true
                right:
                  value:
                    simple: BlockList.Malicious
                  iscontext: true
        fieldassociated: ''
        placeholder: ''
        tooltip: ''
        readonly: false
      title: Please answer the following
      description: ''
      sender: Your SOC team
      expired: false
      totalanswers: 0
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '99':
    id: '99'
    taskid: 2e4c6b8b-fb7f-4fc4-88ba-46e3fa25776d
    type: condition
    task:
      id: 2e4c6b8b-fb7f-4fc4-88ba-46e3fa25776d
      version: -1
      name: Should Inputs be enriched?
      description: Check if the user requests an IPs enrichment for determining if
        those are malicious or suspicious.
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - '100'
      yes:
      - '53'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: inputs.InputEnrichment
            iscontext: true
          right:
            value:
              simple: 'True'
    view: |-
      {
        "position": {
          "x": 3160,
          "y": 1110
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '100':
    id: '100'
    taskid: ee8f5670-7ca1-4cd5-8d53-48a6c86e2e3e
    type: regular
    task:
      id: ee8f5670-7ca1-4cd5-8d53-48a6c86e2e3e
      version: -1
      name: Append Internal IPs to a possible block list
      description: Set a value in context under the key you entered. If no value is
        entered, the script does nothing.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '51'
    scriptarguments:
      append:
        simple: 'true'
      key:
        simple: BlockList.PIIP
      value:
        complex:
          root: IP
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: IP.InRange
                iscontext: true
              right:
                value:
                  simple: Yes
              ignorecase: true
          - - operator: inList
              left:
                value:
                  simple: IP.Address
                iscontext: true
              right:
                value:
                  simple: inputs.IP
                iscontext: true
              ignorecase: true
          accessor: Address
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 3160,
          "y": 1495
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '102':
    id: '102'
    taskid: 84560d5f-ff8d-44b8-8773-6e585906939f
    type: regular
    task:
      id: 84560d5f-ff8d-44b8-8773-6e585906939f
      version: -1
      name: Re-set the block list [Internal Address]
      description: Set a value in context under the key you entered. If no value is
        entered, the script does nothing.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '90'
    scriptarguments:
      append:
        simple: 'true'
      key:
        simple: BlockList.Final
      value:
        simple: ${Please answer the following.Answers.3}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 4612.5,
          "y": 3375
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '103':
    id: '103'
    taskid: d3182d0b-6f84-491f-827a-4825b99c61d4
    type: regular
    task:
      id: d3182d0b-6f84-491f-827a-4825b99c61d4
      version: -1
      name: Update Indicator Tag for EDL
      description: commands.local.cmd.set.indicators
      script: Builtin|||setIndicators
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - '2'
    scriptarguments:
      indicatorsValues:
        complex:
          root: BlockList
          accessor: Final
          transformers:
          - operator: join
            args:
              separator:
                value:
                  simple: ','
      tags:
        simple: ${inputs.Tag}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 7670,
          "y": 4530
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '104':
    id: '104'
    taskid: 10b5745d-44cb-4c26-8912-76cf72862950
    type: title
    task:
      id: 10b5745d-44cb-4c26-8912-76cf72862950
      version: -1
      name: EDL/EIS
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '24'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 7557.5,
          "y": 4210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '105':
    id: '105'
    taskid: 1438bf7c-f448-49e0-8adc-a3067278e643
    type: regular
    task:
      id: 1438bf7c-f448-49e0-8adc-a3067278e643
      version: -1
      name: Create IP indicators in the system
      description: Create System indicators
      script: Builtin|||createNewIndicator
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - '99'
    scriptarguments:
      type:
        simple: IP
      value:
        complex:
          root: inputs.IP
          transformers:
          - operator: split
            args:
              delimiter:
                value:
                  simple: ','
    reputationcalc: 1
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 3160,
          "y": 865
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "12_2_#default#": 0.11,
      "22_2_#default#": 0.22,
      "23_2_#default#": 0.2,
      "24_2_#default#": 0.1,
      "25_2_#default#": 0.1,
      "27_2_#default#": 0.1,
      "32_2_#default#": 0.1,
      "36_8_#default#": 0.19,
      "41_42_yes": 0.65,
      "41_8_#default#": 0.38,
      "47_8_#default#": 0.12,
      "56_2_#default#": 0.11,
      "58_2_#default#": 0.14,
      "61_2_#default#": 0.1,
      "68_2_#default#": 0.1,
      "68_69_yes": 0.52,
      "68_93_yes": 0.52,
      "72_2_#default#": 0.1,
      "76_2_#default#": 0.12,
      "78_2_#default#": 0.1,
      "7_2_#default#": 0.39,
      "8_43_yes": 0.5,
      "8_96_#default#": 0.1,
      "99_100_#default#": 0.83,
      "99_53_yes": 0.62
    },
    "paper": {
      "dimensions": {
        "height": 4730,
        "width": 7852.5,
        "x": 197.5,
        "y": 50
      }
    }
  }
inputs:
- key: IP
  value: {}
  required: false
  description: 'An array of malicious IPs to block. Enter a comma-separated list of
    IPs (i.e.: 1.1.1.1,2.2.2.2).'
  playbookInputQuery:
- key: CustomBlockRule
  value:
    simple: 'True'
  required: false
  description: "This input determines whether Palo Alto Networks Panorama or Firewall\
    \ Custom Block Rules are used.\nSpecify \"True\" to create new Custom Block Rules\
    \ (2 FW rules inside the PAN-OS device). \nFor \"False\" - no rules will be created."
  playbookInputQuery:
- key: LogForwarding
  value: {}
  required: false
  description: Panorama log forwarding object name. Indicate what type of Log Forwarding
    setting will be specified in the PAN-OS custom rules.
  playbookInputQuery:
- key: AutoCommit
  value:
    simple: No
  required: false
  description: "This input determines whether to commit the configuration automatically\
    \ on PAN-OS devices and other FWs. \nYes - Commit automatically.\nNo - Commit\
    \ manually."
  playbookInputQuery:
- key: StaticAddressGroup
  value: {}
  required: false
  description: "This input determines whether Palo Alto Networks Panorama or Firewall\
    \ Static Address Groups are used.\nSpecify the Static Address Group name for IPs\
    \ list handling."
  playbookInputQuery:
- key: Tag
  value: {}
  required: false
  description: Insert a tag name with which indicators will get tagged. This tag can
    be used later in the External Dynamic Lists integration by using the tag for filtering
    IPs in the indicator query.
  playbookInputQuery:
- key: DAG
  value: {}
  required: false
  description: "This input determines whether Palo Alto Networks Panorama or Firewall\
    \ Dynamic Address Groups are used.\nSpecify the Dynamic Address Group tag name\
    \ for IPs list handling."
  playbookInputQuery:
- key: UserVerification
  value:
    simple: 'True'
  required: false
  description: "Possible values: True/False.  Default: True.\nWhether to provide user\
    \ verification for blocking those IPs. \n\nFalse - No prompt will be displayed\
    \ to the user.\nTrue - The server will ask the user for blocking verification\
    \ and will display the blocking list."
  playbookInputQuery:
- key: InternalRange
  value: {}
  required: false
  description: 'A list of internal IP ranges to check IP addresses against. The list
    should be provided in CIDR notation, separated by commas. An example of a list
    of ranges would be: "172.16.0.0/12,10.0.0.0/8,192.168.0.0/16" (without quotes).
    If a list is not provided, will use the default list provided in the IsIPInRanges
    script (the known IPv4 private address ranges).'
  playbookInputQuery:
- key: SiteName
  value: {}
  required: false
  description: Signal Sciences WAF - Enter the site name for the integration to be
    applied. The site name can be found in your instance console.
  playbookInputQuery:
- key: AkamaiNetworkListID
  value: {}
  required: false
  description: Akamai's WAF network list ID, which is mandatory to be mentioned for
    the integration. The chosen IPs will be added to this ID.
  playbookInputQuery:
- key: CiscoFWSource
  value: {}
  required: false
  description: Cisco ASA (firewall) value for the rule's source object in the created
    blocking rule. Can be the value of an IPv4, an address block, or the name of a
    network object.
  playbookInputQuery:
- key: InputEnrichment
  value:
    simple: 'False'
  required: false
  description: "Possible values: True/False . Default: False\nEnrich the input IP\
    \ address/es with reputation commands."
  playbookInputQuery:
- key: RuleName
  value:
    simple: XSOAR - Block IP playbook - ${incident.id}
  required: false
  description: "The rule name/description that will be presented on the created rule\
    \ in certain integrations (if there is a need).\nThe supported integrations: PAN-OS,\
    \ CheckPoint.\n\nDefault input- \"XSOAR - Block IP playbook - ${incident.id}\""
  playbookInputQuery:
- key: RuleDirection
  value:
    simple: outbound
  required: false
  description: "Determine if a newly created rule should be with the network direction\
    \ of outbound or inbound blocked traffic.\nPossible values: inbound or outbound\n\
    Default: outbound"
  playbookInputQuery:
outputs:
- contextPath: Aria.BlockDestSubnet.Rule
  description: The rule name/ID which was created in the system for this playbook.
  type: unknown
- contextPath: Aria.BlockDestSubnet.Status
  description: The status of the command that created the rule above.
  type: unknown
- contextPath: Stealthwatch.IP.id
  description: The ID of the object created in Cisco Secure Cloud Analytics.
  type: unknown
- contextPath: Stealthwatch.IP.identifier
  description: The value of the object created in Cisco Secure Cloud Analytics.
  type: unknown
- contextPath: CiscoASA.Rules.ID
  description: The rule ID that was created in Cisco ASA for this playbook.
  type: unknown
- contextPath: CiscoASA.Rules.Source
  description: The rule's source object that was set in the associated rule.
  type: unknown
- contextPath: CiscoASA.Rules.Dest
  description: The rule's destination object that was set in the associated rule.
  type: unknown
- contextPath: CiscoASA.Rules.IsActive
  description: The rule's state that was set in the associated rule.
  type: unknown
- contextPath: SigSciences.Corp.Site.Blacklist.ID
  description: Signal Sciences created rule ID.
  type: unknown
- contextPath: SigSciences.Corp.Site.Blacklist.Source
  description: Signal Sciences blocked address in a dedicated rule.
  type: unknown
- contextPath: SigSciences.Corp.Site.Blacklist.CreatedBy
  description: Signal Sciences - the blocking rule's creator name.
  type: unknown
tests:
- Block IP - Generic V3_Test
fromversion: 6.0.0
system: true
