id: Account Enrichment - Generic v2.1
version: -1
contentitemexportablefields:
  contentitemfields: {}
name: Account Enrichment - Generic v2.1
description: |-
  Enrich accounts using one or more integrations.
  Supported integrations:
  - Active Directory
  - Microsoft Graph User
  - SailPoint IdentityNow
  - SailPoint IdentityIQ
  - PingOne
  - Okta
  - AWS IAM
  - Cortex XDR (account enrichment and reputation)

  Also, the playbook supports the generic command 'iam-get-user' (implemented in IAM integrations). For more information, visit https://xsoar.pan.dev/docs/integrations/iam-integrations.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: a6743119-6f7b-4ad2-86f8-d7e6f17415a3
    type: start
    task:
      id: a6743119-6f7b-4ad2-86f8-d7e6f17415a3
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "1"
      - "68"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1080,
          "y": -200
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "1":
    id: "1"
    taskid: 7d3036d6-80da-4b4f-8534-c634c6264f50
    type: condition
    task:
      id: 7d3036d6-80da-4b4f-8534-c634c6264f50
      version: -1
      name: Is there an account to enrich (without domain prefix)?
      description: Checks if there is at least one username to enrich.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "67"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: inputs.Username
                filters:
                - - operator: notContainsGeneral
                    left:
                      value:
                        simple: inputs.Username
                      iscontext: true
                    right:
                      value:
                        simple: \
            iscontext: true
          right:
            value: {}
    view: |-
      {
        "position": {
          "x": -1080,
          "y": -7
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "3":
    id: "3"
    taskid: b5a047e4-ca2a-4881-8a80-de3d0886ea64
    type: title
    task:
      id: b5a047e4-ca2a-4881-8a80-de3d0886ea64
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1080,
          "y": 1560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "4":
    id: "4"
    taskid: 9b07e7c9-ff70-410d-881c-02389fbf4c1e
    type: condition
    task:
      id: 9b07e7c9-ff70-410d-881c-02389fbf4c1e
      version: -1
      name: Is Active Directory Query v2 enabled?
      description: Checks if thereâ€™s an active instance of the Active Directory Query v2 integration enabled.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "5"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: modules
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: brand
                      iscontext: true
                    right:
                      value:
                        simple: Active Directory Query v2
                - - operator: isEqualString
                    left:
                      value:
                        simple: state
                      iscontext: true
                    right:
                      value:
                        simple: active
            iscontext: true
    view: |-
      {
        "position": {
          "x": 230,
          "y": 565
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "5":
    id: "5"
    taskid: ae51230d-7996-44fd-821c-44f995a48545
    type: regular
    task:
      id: ae51230d-7996-44fd-821c-44f995a48545
      version: -1
      name: Get account info from Active Directory
      description: Queries Active Directory and returns information for the specified username.
      script: '|||ad-get-user'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "53"
    scriptarguments:
      username:
        complex:
          root: Usernames
          transformers:
          - operator: uniq
    reputationcalc: 1
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 230,
          "y": 760
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "9":
    id: "9"
    taskid: 148faf68-5ced-41f4-82c0-f98fa9d82037
    type: title
    task:
      id: 148faf68-5ced-41f4-82c0-f98fa9d82037
      version: -1
      name: SailPoint IdentityIQ
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "18"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -640,
          "y": 435
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "11":
    id: "11"
    taskid: 58620334-72c1-4be6-87a2-84ed544c4a8a
    type: title
    task:
      id: 58620334-72c1-4be6-87a2-84ed544c4a8a
      version: -1
      name: PingOne
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "20"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 650,
          "y": 435
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "16":
    id: "16"
    taskid: b5887cbc-9c89-47ba-8802-86c66ed0c85a
    type: title
    task:
      id: b5887cbc-9c89-47ba-8802-86c66ed0c85a
      version: -1
      name: Microsoft Active Directory
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "4"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 230,
          "y": 435
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "18":
    id: "18"
    taskid: 93b0d852-2215-4504-8179-64a62951fbcc
    type: condition
    task:
      id: 93b0d852-2215-4504-8179-64a62951fbcc
      version: -1
      name: Is SailPoint IdentityIQ Integration Enabled?
      description: Returns 'yes' if the integration brand is available. Otherwise returns 'no'
      scriptName: IsIntegrationAvailable
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "29"
    scriptarguments:
      brandname:
        simple: SailPointIdentityIQ
    results:
    - brandInstances
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -640,
          "y": 565
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "20":
    id: "20"
    taskid: 82adaccd-d799-44ae-85ec-ee4ca516aab6
    type: condition
    task:
      id: 82adaccd-d799-44ae-85ec-ee4ca516aab6
      version: -1
      name: Is PingOne Integration Enabled
      description: Returns 'yes' if the integration brand is available. Otherwise returns 'no'
      scriptName: IsIntegrationAvailable
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "31"
    scriptarguments:
      brandname:
        simple: PingOne
    results:
    - brandInstances
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 650,
          "y": 565
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "29":
    id: "29"
    taskid: 296fe8d2-4c2e-496b-86d2-8b9d2ca169ac
    type: regular
    task:
      id: 296fe8d2-4c2e-496b-86d2-8b9d2ca169ac
      version: -1
      name: Get account info from IdentityIQ
      description: Search identities by search/filter parameters (ID, email, risk & active) using IdentityIQ SCIM APIs.
      script: '|||identityiq-search-identities'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      id:
        complex:
          root: Usernames
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -640,
          "y": 760
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "31":
    id: "31"
    taskid: 4e0dd7fd-7f65-42b4-8f6b-c0eeb9dbd070
    type: regular
    task:
      id: 4e0dd7fd-7f65-42b4-8f6b-c0eeb9dbd070
      version: -1
      name: Get account info from PingOne
      description: Returns a PingOne user. One of the following has to be given - username or userId.
      script: '|||pingone-get-user'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      username:
        complex:
          root: Usernames
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 650,
          "y": 760
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "32":
    id: "32"
    taskid: 4e5ba461-1f35-4898-8f03-940b3e3dd950
    type: title
    task:
      id: 4e5ba461-1f35-4898-8f03-940b3e3dd950
      version: -1
      name: OKTA
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "33"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1070,
          "y": 435
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "33":
    id: "33"
    taskid: e0b7f17c-70f7-4330-8f06-c3729e226adb
    type: condition
    task:
      id: e0b7f17c-70f7-4330-8f06-c3729e226adb
      version: -1
      name: Is OKTA v2 integration enabled?
      description: Returns 'yes' if the integration brand is available. Otherwise returns 'no'
      scriptName: IsIntegrationAvailable
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "34"
    scriptarguments:
      brandname:
        simple: Okta v2
    results:
    - brandInstances
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1070,
          "y": 565
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "34":
    id: "34"
    taskid: 81e880c5-cf32-42f0-8871-2077a475a674
    type: regular
    task:
      id: 81e880c5-cf32-42f0-8871-2077a475a674
      version: -1
      name: Get account info from OKTA v2
      description: Fetches information for a single user. You must enter one or more parameters for the command to run.
      script: '|||okta-get-user'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      username:
        complex:
          root: Usernames
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1070,
          "y": 760
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "42":
    id: "42"
    taskid: ced5695a-76e7-4f6a-81b8-598925a8ea9d
    type: title
    task:
      id: ced5695a-76e7-4f6a-81b8-598925a8ea9d
      version: -1
      name: AWS
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "43"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1490,
          "y": 435
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "43":
    id: "43"
    taskid: 0f630de1-9988-461a-883a-6113d3dd6d2a
    type: condition
    task:
      id: 0f630de1-9988-461a-883a-6113d3dd6d2a
      version: -1
      name: Is AWS integration enabled?
      description: Returns 'yes' if the integration brand is available. Otherwise returns 'no'
      scriptName: IsIntegrationAvailable
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "44"
    scriptarguments:
      brandname:
        simple: AWS - IAM
    results:
    - brandInstances
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1490,
          "y": 565
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "44":
    id: "44"
    taskid: 8f66273e-887a-4da9-86aa-d793012b15d1
    type: regular
    task:
      id: 8f66273e-887a-4da9-86aa-d793012b15d1
      version: -1
      name: Get account info from AWS
      description: Retrieves information about the specified IAM user, including the user's creation date, path, unique ID, and ARN.
      script: '|||aws-iam-get-user'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      userName:
        complex:
          root: Usernames
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1490,
          "y": 760
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "48":
    id: "48"
    taskid: 4f4d3e42-0ec6-4b22-89b2-0b275eedc3c5
    type: title
    task:
      id: 4f4d3e42-0ec6-4b22-89b2-0b275eedc3c5
      version: -1
      name: IAM
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "63"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1500,
          "y": 425
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "50":
    id: "50"
    taskid: 61ad53d6-a0fd-4e1e-8608-1c8a9596d965
    type: title
    task:
      id: 61ad53d6-a0fd-4e1e-8608-1c8a9596d965
      version: -1
      name: SailPoint IdentityNow
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "51"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -200,
          "y": 435
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "51":
    id: "51"
    taskid: 21d70bb7-8b40-4f49-80ca-b78cb05b24aa
    type: condition
    task:
      id: 21d70bb7-8b40-4f49-80ca-b78cb05b24aa
      version: -1
      name: Is SailPoint IdentityNow integration enabled?
      description: Returns 'yes' if the integration brand is available. Otherwise returns 'no'
      scriptName: IsIntegrationAvailable
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "52"
    scriptarguments:
      brandname:
        simple: SailPointIdentityNow
    results:
    - brandInstances
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -200,
          "y": 565
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "52":
    id: "52"
    taskid: c3570a06-c795-4b8b-81e7-b66d4ac5bd43
    type: regular
    task:
      id: c3570a06-c795-4b8b-81e7-b66d4ac5bd43
      version: -1
      name: Get account info from IdentityNow
      description: Get accounts by search/filter parameters (ID, name, native_identity).
      script: '|||identitynow-get-accounts'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      name:
        complex:
          root: Usernames
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -200,
          "y": 760
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "53":
    id: "53"
    taskid: f1700d16-6e63-4a56-8157-42cecfc24657
    type: condition
    task:
      id: f1700d16-6e63-4a56-8157-42cecfc24657
      version: -1
      name: Is there a manager?
      description: Is there a manager?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "54"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Account.Manager
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 230,
          "y": 930
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "54":
    id: "54"
    taskid: 82a4d18b-fcb9-416a-87e9-0c1b07255560
    type: playbook
    task:
      id: 82a4d18b-fcb9-416a-87e9-0c1b07255560
      version: -1
      name: Active Directory - Get User Manager Details
      description: Takes an email address or a username of a user account in Active Directory, and returns the email address of the user's manager.
      playbookName: Active Directory - Get User Manager Details
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      UserEmail:
        complex:
          root: Account
          accessor: Email
          transformers:
          - operator: uniq
          - operator: FirstArrayElement
      Username:
        complex:
          root: Account
          accessor: Username
          transformers:
          - operator: uniq
          - operator: FirstArrayElement
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": -30,
          "y": 1100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "55":
    id: "55"
    taskid: 285753ae-d884-4485-881c-3a99f77be4d0
    type: title
    task:
      id: 285753ae-d884-4485-881c-3a99f77be4d0
      version: -1
      name: MSGraph Users
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "56"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1910,
          "y": 435
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "56":
    id: "56"
    taskid: be533930-e327-4945-8fb7-c47ada329a2f
    type: condition
    task:
      id: be533930-e327-4945-8fb7-c47ada329a2f
      version: -1
      name: Is Azure Active Directory Users integration enabled?
      description: Returns 'yes' if the integration brand is available. Otherwise returns 'no'.
      scriptName: IsIntegrationAvailable
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "57"
    scriptarguments:
      brandname:
        simple: Microsoft Graph User
    results:
    - brandInstances
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1910,
          "y": 565
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "57":
    id: "57"
    taskid: da04f484-d65e-40a4-82da-e5e1f4afd88b
    type: regular
    task:
      id: da04f484-d65e-40a4-82da-e5e1f4afd88b
      version: -1
      name: Get account info from Azure Active Directory
      description: |-
        Retrieves the properties and relationships of a user object. For more information, visit: https://docs.microsoft.com/en-us/graph/api/user-update?view=graph-rest-1.0).
        Permissions: - User.Read (Delegated) - User.Read.All (Application)
      script: '|||msgraph-user-get'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "58"
    scriptarguments:
      user:
        complex:
          root: Usernames
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1910,
          "y": 760
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 2
    isoversize: false
    isautoswitchedtoquietmode: false
  "58":
    id: "58"
    taskid: 56bea608-c34d-4914-8b16-594603971e22
    type: condition
    task:
      id: 56bea608-c34d-4914-8b16-594603971e22
      version: -1
      name: Is there a manager?
      description: Is there a manager?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "59"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Account.Manager
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              simple: MSGraphUser.ID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1910,
          "y": 930
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "59":
    id: "59"
    taskid: e5aab025-d489-4bc6-89d8-ffde4c23ac36
    type: regular
    task:
      id: e5aab025-d489-4bc6-89d8-ffde4c23ac36
      version: -1
      name: Azure Active Directory - Get manager details
      description: Retrieves the properties from the manager of a user.
      script: '|||msgraph-user-get-manager'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "60"
    scriptarguments:
      user:
        complex:
          root: MSGraphUser
          accessor: ID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1910,
          "y": 1220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: 83d6879d-694b-4091-84cd-6445167b9c75
    type: regular
    task:
      id: 83d6879d-694b-4091-84cd-6445167b9c75
      version: -1
      name: Set manager email address to context
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      key:
        simple: UserManagerEmail
      value:
        complex:
          root: MSGraphUserManager.Manager
          accessor: Mail
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1910,
          "y": 1390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    id: "61"
    taskid: 87b28b4e-4452-4597-8b4e-ab63aff6ae0c
    type: regular
    task:
      id: 87b28b4e-4452-4597-8b4e-ab63aff6ae0c
      version: -1
      name: IAM Get User - Without specifying a domain
      description: Retrieves a single user resource.
      script: '|||iam-get-user'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      user-profile:
        complex:
          root: Usernames
          transformers:
          - operator: Stringify
          - operator: RegexReplace
            args:
              action_dt: {}
              ignore_case: {}
              multi_line: {}
              output_format: {}
              period_matches_newline: {}
              regex:
                value:
                  simple: '[\w.0-9]*\\'
          - operator: concat
            args:
              prefix:
                value:
                  simple: '{"username":"'
              suffix:
                value:
                  simple: '"}'
          - operator: uniq
          - operator: split
            args:
              delimiter: {}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -1700,
          "y": 750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "62":
    id: "62"
    taskid: 3792ff2c-ca86-4767-8af5-0e50db675f53
    type: regular
    task:
      id: 3792ff2c-ca86-4767-8af5-0e50db675f53
      version: -1
      name: IAM Get User - with a domain
      description: Retrieves a single user resource.
      script: '|||iam-get-user'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      user-profile:
        complex:
          root: Usernames
          transformers:
          - operator: RegexReplace
            args:
              action_dt: {}
              ignore_case: {}
              multi_line: {}
              output_format: {}
              period_matches_newline: {}
              regex:
                value:
                  simple: '[\w.0-9]*\\'
          - operator: concat
            args:
              prefix:
                iscontext: true
              suffix:
                value:
                  simple: inputs.Domain
                iscontext: true
          - operator: concat
            args:
              prefix:
                value:
                  simple: '{"username":"'
              suffix:
                value:
                  simple: '"}'
          - operator: uniq
          - operator: split
            args:
              delimiter: {}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -1290,
          "y": 750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: e3d4077b-a586-494b-86b3-65e1f408c83a
    type: condition
    task:
      id: e3d4077b-a586-494b-86b3-65e1f408c83a
      version: -1
      name: Was a domain provided?
      description: Was a domain provided?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "61"
      "yes":
      - "62"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: inputs.Domain
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -1500,
          "y": 570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "64":
    id: "64"
    taskid: 30472917-7825-4a09-89d8-b531bf61958c
    type: title
    task:
      id: 30472917-7825-4a09-89d8-b531bf61958c
      version: -1
      name: Cortex XDR
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "65"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2330,
          "y": 435
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "65":
    id: "65"
    taskid: ed860996-40a3-4e32-8c7d-e4a961c6b7d5
    type: condition
    task:
      id: ed860996-40a3-4e32-8c7d-e4a961c6b7d5
      version: -1
      name: Is Cortex XDR - IR integration enabled?
      description: Returns 'yes' if the integration brand is available. Otherwise returns 'no'
      scriptName: IsIntegrationAvailable
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "66"
    scriptarguments:
      brandname:
        simple: Cortex XDR - IR
    results:
    - brandInstances
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2330,
          "y": 565
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "66":
    id: "66"
    taskid: b2c55827-8a8d-4e30-8662-383fbfdb55d0
    type: regular
    task:
      id: b2c55827-8a8d-4e30-8662-383fbfdb55d0
      version: -1
      name: Get account risk score
      description: Retrieve the risk score of a specific user or list of users with the highest risk score in the environment along with the reason affecting each score.
      script: '|||xdr-list-risky-users'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      user_id:
        complex:
          root: UsernamesWithDomains
          transformers:
          - operator: AppendIfNotEmpty
            args:
              item:
                value:
                  simple: Usernames
                iscontext: true
              raw: {}
          - operator: uniq
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2330,
          "y": 760
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "67":
    id: "67"
    taskid: 7212ec41-fb6c-4d2b-86c1-140108b79c04
    type: regular
    task:
      id: 7212ec41-fb6c-4d2b-86c1-140108b79c04
      version: -1
      name: Save account usernames
      description: |-
        Saves the usernames without domain prefixes under a new context key.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        - For Cortex XSOAR 6 see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations 
        - For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script
        - For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "48"
      - "9"
      - "50"
      - "16"
      - "11"
      - "32"
      - "42"
      - "55"
      - "64"
    scriptarguments:
      key:
        simple: Usernames
      value:
        complex:
          root: inputs.Username
          filters:
          - - operator: notContainsGeneral
              left:
                value:
                  simple: inputs.Username
                iscontext: true
              right:
                value:
                  simple: \
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -1390,
          "y": 180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "68":
    id: "68"
    taskid: 2524ddf8-40ab-4b7e-8019-8fdf102afc08
    type: condition
    task:
      id: 2524ddf8-40ab-4b7e-8019-8fdf102afc08
      version: -1
      name: Is there an account to enrich (with domain prefix)?
      description: Checks if there is at least one username to enrich.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "69"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: inputs.Username
                filters:
                - - operator: containsGeneral
                    left:
                      value:
                        simple: inputs.Username
                      iscontext: true
                    right:
                      value:
                        simple: \
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -640,
          "y": -7
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "69":
    id: "69"
    taskid: 59883712-8f94-4316-870e-21a76ae75517
    type: regular
    task:
      id: 59883712-8f94-4316-870e-21a76ae75517
      version: -1
      name: Save account usernames with domains
      description: |-
        Saves the usernames with domain prefixes under a new context key.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        - For Cortex XSOAR 6 see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations 
        - For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script
        - For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "64"
    scriptarguments:
      key:
        simple: UsernamesWithDomains
      value:
        complex:
          root: inputs.Username
          filters:
          - - operator: containsGeneral
              left:
                value:
                  simple: inputs.Username
                iscontext: true
              right:
                value:
                  simple: \
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2330,
          "y": 190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "18_3_#default#": 0.1,
      "1_3_#default#": 0.1,
      "20_3_#default#": 0.1,
      "33_3_#default#": 0.1,
      "43_3_#default#": 0.1,
      "4_3_#default#": 0.1,
      "51_3_#default#": 0.1,
      "56_3_#default#": 0.1,
      "58_3_#default#": 0.1,
      "65_66_yes": 0.59,
      "68_3_#default#": 0.11,
      "68_69_yes": 0.11
    },
    "paper": {
      "dimensions": {
        "height": 1825,
        "width": 4410,
        "x": -1700,
        "y": -200
      }
    }
  }
inputs:
- key: Username
  value:
    complex:
      root: Account
      accessor: Username
      transformers:
      - operator: uniq
  required: false
  description: |-
    The usernames to enrich. This input supports multiple usernames.
    Usernames can be with or without a domain prefix, in the format of "username" or "domain\username".
    Domain usernames will only be enriched in integrations that support  them.
  playbookInputQuery:
- key: Domain
  value: {}
  required: false
  description: |-
    Optional - This input is needed for the IAM-get-user command (used in the Account Enrichment - IAM playbook). Please provide the domain name that the user is related to.
    Example: @xsoar.com
  playbookInputQuery:
outputs:
- contextPath: Account
  description: The account object.
  type: string
- contextPath: ActiveDirectory.Users.sAMAccountName
  description: The user's SAM account name.
  type: string
- contextPath: ActiveDirectory.Users.userAccountControl
  description: The user's account control flag.
  type: string
- contextPath: ActiveDirectory.Users.mail
  description: The user's email address.
  type: string
- contextPath: ActiveDirectory.Users.memberOf
  description: Groups the user is a member of.
  type: string
- contextPath: IAM
  description: Generic IAM output.
  type: string
- contextPath: IdentityIQ.Identity
  description: Identity asset from IdentityIQ.
  type: string
- contextPath: PingOne.Account
  description: Account in PingID.
  type: string
- contextPath: ActiveDirectory.Users.manager
  description: The manager of the user.
  type: string
- contextPath: IAM.Vendor.active
  description: When true, indicates that the employee's status is active in the 3rd-party integration.
  type: string
- contextPath: IAM.Vendor.brand
  description: Name of the integration.
  type: string
- contextPath: IAM.Vendor.details
  description: Provides the raw data from the 3rd-party integration.
  type: string
- contextPath: IAM.Vendor.email
  description: The employee's email address.
  type: string
- contextPath: IAM.Vendor.errorCode
  description: HTTP error response code.
  type: string
- contextPath: IAM.Vendor.errorMessage
  description: Reason why the API failed.
  type: string
- contextPath: IAM.Vendor.id
  description: The employee's user ID in the app.
  type: string
- contextPath: IAM.Vendor.instanceName
  description: Name of the integration instance.
  type: string
- contextPath: IAM.Vendor.success
  description: When true, indicates that the command was executed successfully.
  type: string
- contextPath: IAM.Vendor.username
  description: The employee's username in the app.
  type: string
- contextPath: IdentityIQ.Identity.userName
  description: The IdentityIQ username (primary ID).
  type: string
- contextPath: IdentityIQ.Identity.id
  description: The IdentityIQ internal ID (UUID).
  type: string
- contextPath: IdentityIQ.Identity.active
  description: Indicates whether the ID is active or inactive in IdentityIQ.
  type: string
- contextPath: IdentityIQ.Identity.lastModified
  description: Timestamp of when the identity was last modified.
  type: string
- contextPath: IdentityIQ.Identity.displayName
  description: The display name of the identity.
  type: string
- contextPath: IdentityIQ.Identity.emails
  description: Array of email objects.
  type: string
- contextPath: IdentityIQ.Identity.entitlements
  description: Array of entitlement objects that the identity has.
  type: string
- contextPath: IdentityIQ.Identity.roles
  description: Array of role objects that the identity has.
  type: string
- contextPath: IdentityIQ.Identity.capabilities
  description: Array of string representations of the IdentityIQ capabilities assigned to this identity.
  type: string
- contextPath: IdentityIQ.Identity.name
  description: Account name.
  type: string
- contextPath: IdentityIQ.Identity.name.formatted
  description: The display name of the identity.
  type: string
- contextPath: IdentityIQ.Identity.name.familyName
  description: The last name of the identity.
  type: string
- contextPath: IdentityIQ.Identity.name.givenName
  description: The first name of the identity.
  type: string
- contextPath: IdentityIQ.Identity.manager
  description: The account's manager returned from IdentityIQ.
  type: string
- contextPath: IdentityIQ.Identity.manager.userName
  description: The IdentityIQ username (primary ID) of the identity's manager.
  type: string
- contextPath: IdentityIQ.Identity.emails.type
  description: Type of the email being returned.
  type: string
- contextPath: IdentityIQ.Identity.emails.value
  description: The email address of the identity.
  type: string
- contextPath: IdentityIQ.Identity.emails.primary
  description: Indicates if this email address is the identity's primary email.
  type: string
- contextPath: PingOne.Account.ID
  description: PingOne account ID.
  type: string
- contextPath: PingOne.Account.Username
  description: PingOne account username.
  type: string
- contextPath: PingOne.Account.DisplayName
  description: PingOne account display name.
  type: string
- contextPath: PingOne.Account.Email
  description: PingOne account email.
  type: string
- contextPath: PingOne.Account.Enabled
  description: PingOne account enabled status.
  type: string
- contextPath: PingOne.Account.CreatedAt
  description: PingOne account create date.
  type: string
- contextPath: PingOne.Account.UpdatedAt
  description: PingOne account updated date.
  type: string
- contextPath: Account.PasswordChanged
  description: Timestamp for when the user's password was last changed.
  type: string
- contextPath: Account.StatusChanged
  description: Timestamp for when the user's status was last changed.
  type: string
- contextPath: Account.Activated
  description: Timestamp for when the user was activated.
  type: string
- contextPath: Account.Created
  description: Timestamp for when the user was created.
  type: string
- contextPath: Account.Status
  description: Okta account status.
  type: string
- contextPath: Account.Username
  description: The user SAM account name.
  type: string
- contextPath: Account.Email
  description: The user email address.
  type: string
- contextPath: Account.ID
  description: The user distinguished name.
  type: string
- contextPath: ActiveDirectory.Users.dn
  description: The user distinguished name.
  type: string
- contextPath: ActiveDirectory.Users.displayName
  description: The user display name.
  type: string
- contextPath: ActiveDirectory.Users.name
  description: The user common name.
  type: string
- contextPath: ActiveDirectory.Users.userAccountControlFields
  description: The user account control fields.
  type: string
- contextPath: ActiveDirectory.Users.userAccountControlFields.SCRIPT
  description: Whether the login script is run. Works for *Windows Server 2012 R2*.
  type: string
- contextPath: ActiveDirectory.Users.userAccountControlFields.ACCOUNTDISABLE
  description: Whether the user account is disabled. Works for *Windows Server 2012 R2*.
  type: string
- contextPath: ActiveDirectory.Users.userAccountControlFields.HOMEDIR_REQUIRED
  description: Whether the home folder is required. Works for *Windows Server 2012 R2*.
  type: string
- contextPath: ActiveDirectory.Users.userAccountControlFields.LOCKOUT
  description: Whether the user is locked out. Works for *Windows Server 2012 R2*.
  type: string
- contextPath: ActiveDirectory.Users.userAccountControlFields.PASSWD_NOTREQD
  description: Whether the password is required. Works for *Windows Server 2012 R2*.
  type: string
- contextPath: ActiveDirectory.Users.userAccountControlFields.PASSWD_CANT_CHANGE
  description: Whether the user can change the password. Works for *Windows Server 2012 R2*.
  type: string
- contextPath: ActiveDirectory.Users.userAccountControlFields.ENCRYPTED_TEXT_PWD_ALLOWED
  description: Whether the user can send an encrypted password. Works for *Windows Server 2012 R2*.
  type: string
- contextPath: ActiveDirectory.Users.userAccountControlFields.TEMP_DUPLICATE_ACCOUNT
  description: Whether this is an account for users whose primary account is in another domain. Works for *Windows Server 2012 R2*.
  type: string
- contextPath: ActiveDirectory.Users.userAccountControlFields.NORMAL_ACCOUNT
  description: Whether this is a default account type that represents a typical user. Works for *Windows Server 2012 R2*.
  type: string
- contextPath: ActiveDirectory.Users.userAccountControlFields.INTERDOMAIN_TRUST_ACCOUNT
  description: Whether the account is permitted to trust a system domain that trusts other domains. Works for *Windows Server 2012 R2*.
  type: string
- contextPath: ActiveDirectory.Users.userAccountControlFields.WORKSTATION_TRUST_ACCOUNT
  description: Whether this is a computer account for a computer running Microsoft Windows NT 4.0 Workstation, Microsoft Windows NT 4.0 Server, Microsoft Windows 2000 Professional, or Windows 2000 Server and is a member of this domain.
  type: string
- contextPath: Account.Manager
  description: The user manager.
  type: string
- contextPath: Account.Groups
  description: Groups for which the user is a member.
  type: string
- contextPath: Account.DisplayName
  description: The user display name.
  type: string
- contextPath: ActiveDirectory.Users.userAccountControlFields.PARTIAL_SECRETS_ACCOUNT
  description: Whether the account is a read-only domain controller (RODC).
  type: string
- contextPath: ActiveDirectory.Users.userAccountControlFields.TRUSTED_TO_AUTH_FOR_DELEGATION
  description: Whether the account is enabled for delegation.
  type: string
- contextPath: ActiveDirectory.Users.userAccountControlFields.DONT_REQ_PREAUTH
  description: Whether this account require Kerberos pre-authentication for logging on.
  type: string
- contextPath: ActiveDirectory.Users.userAccountControlFields.USE_DES_KEY_ONLY
  description: Whether to restrict this principal to use only Data Encryption Standard (DES) encryption types for keys.
  type: string
- contextPath: ActiveDirectory.Users.userAccountControlFields.NOT_DELEGATED
  description: Whether the security context of the user isn't delegated to a service even if the service account is set as trusted for Kerberos delegation.
  type: string
- contextPath: ActiveDirectory.Users.userAccountControlFields.TRUSTED_FOR_DELEGATION
  description: Whether the service account (the user or computer account) under which a service runs is trusted for Kerberos delegation.
  type: string
- contextPath: ActiveDirectory.Users.userAccountControlFields.SMARTCARD_REQUIRED
  description: Whether to force the user to log in by using a smart card.
  type: string
- contextPath: ActiveDirectory.Users.userAccountControlFields.MNS_LOGON_ACCOUNT
  description: Whether this is an MNS login account.
  type: string
- contextPath: ActiveDirectory.Users.userAccountControlFields.SERVER_TRUST_ACCOUNT
  description: Whether this is a computer account for a domain controller that is a member of this domain. Works for *Windows Server 2012 R2*.
  type: string
- contextPath: IAM.Vendor
  description: The returning results vendor.
  type: string
- contextPath: IAM.Vendor.action
  description: The command name.
  type: string
- contextPath: IAM.UserProfile
  description: The user profile.
  type: string
- contextPath: SailPointIdentityNow.Account
  description: The IdentityNow account object.
  type: string
- contextPath: SailPointIdentityNow.Account.id
  description: The IdentityNow internal ID (UUID).
  type: string
- contextPath: SailPointIdentityNow.Account.name
  description: Name of the identity on this account.
  type: string
- contextPath: SailPointIdentityNow.Account.identityId
  description: The IdentityNow internal identity ID.
  type: string
- contextPath: SailPointIdentityNow.Account.nativeIdentity
  description: The IdentityNow internal native identity ID.
  type: string
- contextPath: SailPointIdentityNow.Account.sourceId
  description: Source ID that maps this account.
  type: string
- contextPath: SailPointIdentityNow.Account.created
  description: Timestamp when the account was created.
  type: string
- contextPath: SailPointIdentityNow.Account.modified
  description: Timestamp when the account was last modified.
  type: string
- contextPath: SailPointIdentityNow.Account.attributes
  description: Map of variable number of attributes unique to this account.
  type: string
- contextPath: SailPointIdentityNow.Account.authoritative
  description: Indicates whether the account is the true source for this identity.
  type: string
- contextPath: SailPointIdentityNow.Account.disabled
  description: Indicates whether the account is disabled.
  type: string
- contextPath: SailPointIdentityNow.Account.locked
  description: Indicates whether the account is locked.
  type: string
- contextPath: SailPointIdentityNow.Account.systemAccount
  description: Indicates whether the account is a system account.
  type: string
- contextPath: SailPointIdentityNow.Account.uncorrelated
  description: Indicates whether the account is uncorrelated.
  type: string
- contextPath: SailPointIdentityNow.Account.manuallyCorrelated
  description: Indicates whether the account was manually correlated.
  type: string
- contextPath: SailPointIdentityNow.Account.hasEntitlements
  description: Indicates whether the account has entitlement.
  type: string
- contextPath: UserManagerEmail
  description: The email of the user's manager.
  type: string
- contextPath: UserManagerDisplayName
  description: The display name of the user's manager.
  type: string
- contextPath: MSGraphUser.ID
  description: User's ID.
  type: string
- contextPath: MSGraphUser.DisplayName
  description: User's display name.
  type: string
- contextPath: MSGraphUser.GivenName
  description: User's given name.
  type: string
- contextPath: MSGraphUser.JobTitle
  description: User's job title.
  type: string
- contextPath: MSGraphUser.Mail
  description: User's mail address.
  type: string
- contextPath: MSGraphUser.Surname
  description: User's surname.
  type: string
- contextPath: MSGraphUser.UserPrincipalName
  description: User's principal name.
  type: string
- contextPath: MSGraphUserManager.Manager.ID
  description: Manager's user ID.
  type: string
- contextPath: MSGraphUserManager.Manager.DisplayName
  description: User's display name.
  type: string
- contextPath: MSGraphUserManager.Manager.GivenName
  description: User's given name.
  type: string
- contextPath: MSGraphUserManager.Manager.Mail
  description: User's mail address.
  type: string
- contextPath: MSGraphUserManager.Manager.Surname
  description: User's surname.
  type: string
- contextPath: MSGraphUserManager.Manager.UserPrincipalName
  description: User's principal name.
  type: string
- contextPath: PaloAltoNetworksXDR.RiskyUser
  description: The account object.
  type: string
- contextPath: PaloAltoNetworksXDR.RiskyUser.type
  description: Form of identification element.
  type: string
- contextPath: PaloAltoNetworksXDR.RiskyUser.id
  description: Identification value of the type field.
  type: string
- contextPath: PaloAltoNetworksXDR.RiskyUser.score
  description: The score assigned to the user.
  type: string
- contextPath: PaloAltoNetworksXDR.RiskyUser.reasons
  description: The account risk objects.
  type: string
- contextPath: PaloAltoNetworksXDR.RiskyUser.reasons.date created
  description: Date when the incident was created.
  type: string
- contextPath: PaloAltoNetworksXDR.RiskyUser.reasons.description
  description: Description of the incident.
  type: string
- contextPath: PaloAltoNetworksXDR.RiskyUser.reasons.severity
  description: The severity of the incident
  type: string
- contextPath: PaloAltoNetworksXDR.RiskyUser.reasons.status
  description: The incident status
  type: string
- contextPath: PaloAltoNetworksXDR.RiskyUser.reasons.points
  description: The score.
  type: string
- contextPath: ActiveDirectory.Users.userAccountControlFields.DONT_EXPIRE_PASSWORD
  description: Whether to never expire the password on the account.
  type: string
- contextPath: ActiveDirectory.Users.userAccountControlFields.PASSWORD_EXPIRED
  description: Whether the user password expired.
  type: string
- contextPath: Account.ManagerEmail
  description: The manager email.
  type: string
- contextPath: AWS.IAM.Users
  description: AWS IAM output.
  type: string
- contextPath: AWS.IAM.Users.UserName
  description: The friendly name identifying the user.
  type: string
- contextPath: AWS.IAM.Users.UserId
  description: The stable and unique string identifying the user.
  type: string
- contextPath: AWS.IAM.Users.Arn
  description: The Amazon Resource Name (ARN) that identifies the user.
  type: string
- contextPath: AWS.IAM.Users.CreateDate
  description: The date and time when the user was created.
  type: string
- contextPath: AWS.IAM.Users.Path
  description: The path to the user.
  type: string
- contextPath: AWS.IAM.Users.PasswordLastUsed
  description: The date and time,  when the user's password was last used to sign in to an AWS website.
  type: string
- contextPath: MSGraphUser.MobilePhone
  description: User's mobile phone number.
  type: string
- contextPath: MSGraphUser.OfficeLocation
  description: User's office location.
  type: string
- contextPath: Account.JobTitle
  description: Userâ€™s job title.
  type: string
- contextPath: Account.TelephoneNumber
  description: Userâ€™s mobile phone number.
  type: string
- contextPath: Account.Office
  description: Userâ€™s office location.
  type: string
- contextPath: Account.Type
  description: The account entity type.
  type: string
- contextPath: Account.Email.Address
  description: Userâ€™s mail address.
  type: string
- contextPath: MSGraphUserManager.Manager.BusinessPhones
  description: User's business phone numbers.
  type: string
- contextPath: MSGraphUser.BusinessPhones
  description: User's business phone numbers.
  type: string
- contextPath: MSGraphUserManager.Manager.JobTitle
  description: User's job title.
  type: string
- contextPath: MSGraphUserManager.Manager.MobilePhone
  description: User's mobile phone number.
  type: string
- contextPath: MSGraphUserManager.Manager.OfficeLocation
  description: User's office location.
  type: string
tests:
- Account Enrichment - Generic v2.1 - Test
fromversion: 6.5.0
system: true