id: Detonate File - Generic
version: -1
name: Detonate File - Generic
description: Detonate file through active integrations that support file detonation
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: bfe472b6-a9fd-40d6-846c-6219d9a54e72
    type: start
    task:
      id: bfe472b6-a9fd-40d6-846c-6219d9a54e72
      version: -1
      name: ""
      description: Playbook start point
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "8"
      - "10"
      - "9"
      - "13"
      - "14"
      - "15"
      - "17"
      - "18"
      - "19"
      - "20"
      - "21"
      - "22"
      - "23"
      - "24"
      - "25"
      - "27"
      - "28"
      - "29"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 3080,
          "y": 215
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: b0feb039-1a24-4bcb-8a2c-e9124b61cfa0
    type: title
    task:
      id: b0feb039-1a24-4bcb-8a2c-e9124b61cfa0
      version: -1
      name: Done
      description: Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 3080,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: ff7f9bd2-f158-4812-8c7a-98c3c53151c2
    type: playbook
    task:
      id: ff7f9bd2-f158-4812-8c7a-98c3c53151c2
      version: -1
      name: Detonate File - JoeSecurity
      description: |-
        Detonates one or more files using the Joe Security - Joe Sandbox integration.
        Returns relevant reports to the War Room and file reputations to the context data.
        All file types are supported.
      playbookName: Detonate File - JoeSecurity
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      File:
        complex:
          root: inputs.File
      InternetAccess:
        simple: "True"
      Interval:
        simple: "1"
      Timeout:
        simple: "15"
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 3080,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: 053c6544-8faa-447a-893b-069da330da1e
    type: playbook
    task:
      id: 053c6544-8faa-447a-893b-069da330da1e
      version: -1
      name: ATD - Detonate File
      description: |-
        Detonates a File using the McAfee Advanced Threat Defense sandbox.
        Advanced Threat Defense supports the following File Types:
        32-bit Portable Executables (PE)files; 64-bit PE+files
        exe, sys, dll, com, scr, cpl, ocx, cgi
        Microsoft Office Suite documents
        doc,dotm, docx, dotx, xls, ppam, xlsx, pps, xlsb, ppsx, xlsm, ppsm, ppt, ppt, pptx, pptm, rtf, shs, xltm, sldm, xltx, sldx, xlam, thmx, docm, xar
        Just Systems Ichitaro documents
        jtd, jtdc
        Adobe
        pdf, swf
        Compressed files
        gz, 7z, tgz, msi, zip, lzh, cab, lzma, rar
        Android application package
        apk, Java, JAR, CLASS, Java Script, Java bin files
        Image files
        jpeg, png, gif
        Other file types
        cmd, ace, bat, arj, vbs, chm, xml, lnk, url, mof, htm, ocx, html, potm, eml, potx, msg, ps1, vb, reg, vba, wsc, vbe, wsf, vbs, wsh
      playbookName: ATD - Detonate File
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      File:
        complex:
          root: inputs.File
      Interval:
        simple: "1"
      Timeout:
        simple: "15"
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 960,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: db5fa9e8-1134-4369-815c-e5992cbb5896
    type: playbook
    task:
      id: db5fa9e8-1134-4369-815c-e5992cbb5896
      version: -1
      name: Detonate File - ThreatGrid
      description: Detonate one or more files using the ThreatGrid integration. This playbook returns relevant reports to the War Room and file reputations to the context data. The detonation supports the following file types - EXE, DLL, JAR, JS, PDF, DOC, DOCX, RTF, XLS, PPT, PPTX, XML, ZIP, VBN, SEP, XZ, GZ, BZ2, TAR, MHTML, SWF, LNK, URL, MSI, JTD, JTT, JTDC, JTTC, HWP, HWT, HWPX, BAT, HTA, PS1, VBS, WSF, JSE, VBE, CHM
      playbookName: Detonate File - ThreatGrid
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      File:
        complex:
          root: inputs.File
      FileName:
        simple: file-detonated-via-demisto
      Interval:
        simple: "1"
      Timeout:
        simple: "15"
      playbook:
        simple: default
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 2660,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: cdc7dce0-1029-4a8f-8a7a-eee17d570ea7
    type: playbook
    task:
      id: cdc7dce0-1029-4a8f-8a7a-eee17d570ea7
      version: -1
      name: WildFire - Detonate file
      description: |-
        Detonate one or more files using the Wildfire integration. This playbook
        returns relevant reports to the War Room and file reputations to the context data.
        The detonation supports the following file types -
        APK, JAR, DOC, DOCX, RTF, XLS, XLSX, PPT, PPTX, XML, PE32, PDF, DMG, PKG, RAR, 7Z
      playbookName: WildFire - Detonate file
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      File:
        complex:
          root: inputs.File
      Interval:
        simple: "1"
      Timeout:
        simple: "15"
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 1390,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 13d629fd-83d1-4096-8e89-4d8ca6b4322e
    type: playbook
    task:
      id: 13d629fd-83d1-4096-8e89-4d8ca6b4322e
      version: -1
      name: Detonate File - Lastline v2
      description: |-
        Detonates a file using the Lastline sandbox.
        Lastline supports the following file types:
        EXE, SYS, DLL, COM, SCR, CPL, OCX, CGI, DOC, DOTM, DOCX, DOTX, XLS, PPAM, XSLX, PPS, XLSB, PPSX, XLSM, PPSM, PPT, PPTX, PPTM, RTF, SHS, XLTM, SLDM, XLTX, SLDX, XLAM, THMX, DOCM, XAR, JTD, JTDC, PDF, SWF, GZ, 7Z, TGZ, MSI, ZIP, LZH, CAB, LZMA, APK, JAR, CLASS, JPEG, PNG, GIF, CMD, ACE, BAT, ARJ, VBS, CHM, XML, LNK, URL, MOF, HTM, OCX, HTML, POTM, EML, POTX, MSG, PS, |VB, REG, VBA, WSC, VBE, WSF, VBS, WSH
      playbookName: Detonate File - Lastline v2
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      File:
        complex:
          root: inputs.File
      Interval:
        simple: "1"
      Timeout:
        simple: "15"
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 1820,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: d8ff24bf-a089-4590-89f1-6640c60c44ea
    type: playbook
    task:
      id: d8ff24bf-a089-4590-89f1-6640c60c44ea
      version: -1
      name: Detonate File - Cuckoo
      description: Detonates a file using Cuckoo sandbox
      playbookName: Detonate File - Cuckoo
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      File:
        complex:
          root: inputs.File
      interval:
        simple: "1"
      timeout:
        simple: "10"
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 2250,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: 4a119863-747d-410c-83d2-37adac1e083c
    type: playbook
    task:
      id: 4a119863-747d-410c-83d2-37adac1e083c
      version: -1
      name: Detonate File - HybridAnalysis
      description: |-
        Detonates one or more files using the Hybrid Analysis integration.
        Returns relevant reports to the War Room and file reputations to the context data.
        All file types are supported.
      playbookName: Detonate File - HybridAnalysis
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      EnvironmentID:
        simple: "100"
      File:
        complex:
          root: inputs.File
      InternetAccess:
        simple: "True"
      Interval:
        simple: "1"
      Timeout:
        simple: "15"
    separatecontext: true
    view: |-
      {
        "position": {
          "x": 3920,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: b8ddd535-06ef-401d-8981-a4abfae80dbf
    type: playbook
    task:
      id: b8ddd535-06ef-401d-8981-a4abfae80dbf
      version: -1
      name: Detonate File - ANYRUN
      description: |-
        Detonates one or more files using the ANYRUN sandbox integration.
        Returns relevant reports to the War Room and file reputations to the context data.
        All file types are supported.
      playbookName: Detonate File - ANYRUN
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      File:
        complex:
          root: inputs.File
      Interval:
        simple: "1"
      Timeout:
        simple: "15"
    separatecontext: true
    view: |-
      {
        "position": {
          "x": 540,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: 1b28b735-33ac-4ddd-8649-6f05613db05d
    type: playbook
    task:
      id: 1b28b735-33ac-4ddd-8649-6f05613db05d
      version: -1
      name: Detonate File - FireEye AX
      description: Detonate one or more files using the FireEye AX integration. This playbook returns relevant reports to the War Room and file reputations to the context data. The detonation supports the following file types - PE32, EXE, DLL, JAR, JS, PDF, DOC, DOCX, RTF, XLS, PPT, PPTX, XML, ZIP, VBN, SEP, XZ, GZ, BZ2, TAR, MHTML, SWF, LNK, URL, MSI, JTD, JTT, JTDC, JTTC, HWP, HWT, HWPX, BAT, HTA, PS1, VBS, WSF, JSE, VBE, CHM, JPG, JPEG, GIF, PNG, XLSX
      playbookName: Detonate File - FireEye AX
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      File:
        complex:
          root: inputs.File
      Interval:
        simple: "1"
      Timeout:
        simple: "30"
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 4340,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 9d20f56a-244d-4697-8d0a-f8453eb7e638
    type: playbook
    task:
      id: 9d20f56a-244d-4697-8d0a-f8453eb7e638
      version: -1
      name: Detonate File - VMRay
      description: Detonates a file using VMRay
      playbookName: Detonate File - VMRay
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      File:
        complex:
          root: inputs.File
          transformers:
          - operator: uniq
      interval:
        simple: "1"
      timeout:
        simple: "10"
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 4770,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: fd1dbf17-5b12-4369-86c7-8082f714df31
    type: playbook
    task:
      id: fd1dbf17-5b12-4369-86c7-8082f714df31
      version: -1
      name: Detonate File - Group-IB TDS Polygon
      description: 'Detonate file using Group-IB TDS Polygon integration. This playbook returns relevant reports to the War Room and file reputations to the context data. The detonation supports the following file types: 7z, ace, ar, arj, bat, bz2, cab, chm, cmd, com, cpgz, cpl, csv, dat, doc, docm, docx, dot, dotm, dotx, eml, exe, gz, gzip, hta, htm, html, iqy, iso, jar, js, jse, lnk, lz, lzma, lzo,  lzh, mcl, mht, msg, msi, msp, odp, ods, odt, ots, ott, pdf, pif, potm, potx, pps, ppsm, ppsx, ppt, pptm, pptx, ps1, pub, py, pyc, r*, rar, reg, rtf, scr, settingcontent-ms, stc, svg, sxc, sxw, tar, taz,  .tb2, .tbz, .tbz2, tgz, tlz, txz, tzo, txt, url, uue, vbe, vbs, wsf, xar, xls, xlsb, xlsm, xlsx, xml, xz, z*, zip.'
      playbookName: Detonate File - Group-IB TDS Polygon
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      Interval:
        simple: "1"
      Timeout:
        simple: "60"
      file_id:
        complex:
          root: inputs.EntryID
    separatecontext: true
    view: |-
      {
        "position": {
          "x": 5200,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 2418c5d7-65e3-40ff-8281-fa47ad0369ca
    type: playbook
    task:
      id: 2418c5d7-65e3-40ff-8281-fa47ad0369ca
      version: -1
      name: Detonate File - CrowdStrike Falcon Intelligence Sandbox
      description: |-
        Detonates a File using CrowdStrike Falcon Intelligence Sandbox sandbox.
        Accepted file formats:
        Portable executables: .exe, .scr, .pif, .dll, .com, .cpl, etc.
        Office documents: .doc, .docx, .ppt, .pps, .pptx, .ppsx, .xls, .xlsx, .rtf, .pub
        PDF
        APK
        Executable JAR
        Windows script component: .sct
        Windows shortcut: .lnk
        Windows help: .chm
        HTML application: .hta
        Windows script file: .wsf
        Javascript: .js
        Visual Basic: .vbs, .vbe
        Shockwave Flash: .swf
        Perl: .pl
        Powershell: .ps1, .psd1, .psm1
        Scalable vector graphics: .svg
        Python: .py
        Linux ELF executables
        Email files: MIME RFC 822 .eml, Outlook .msg.
      playbookName: Detonate File - CrowdStrike Falcon Intelligence Sandbox
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      File:
        complex:
          root: inputs.File
      Interval:
        simple: "1"
      Timeout:
        simple: "15"
    separatecontext: true
    view: |-
      {
        "position": {
          "x": 5630,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "23":
    id: "23"
    taskid: c28803a1-9938-4fa0-8994-4f1d01f7e800
    type: playbook
    task:
      id: c28803a1-9938-4fa0-8994-4f1d01f7e800
      version: -1
      name: Detonate File - SecneurX Analysis
      description: Detonates a file using the SecneurX Analysis Integration. Returns relevant reports to the War Room and file reputations to the context data.
      playbookName: Detonate File - SecneurX Analysis
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    separatecontext: true
    view: |-
      {
        "position": {
          "x": 110,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "24":
    id: "24"
    taskid: f19de2c0-c4f0-4e34-8922-c319d40a1781
    type: playbook
    task:
      id: f19de2c0-c4f0-4e34-8922-c319d40a1781
      version: -1
      name: Detonate File - JoeSecurity V2
      description: The Detonate File using Joe Sandbox Process is designed to streamline and enhance the security assessment of files. This automated system accepts a user-submitted file, sends it for in-depth analysis using Joe Sandbox technology, and returns comprehensive results as attachments to the user. The process is designed to be swift, efficient, and secure, providing users with valuable insights into potential threats and vulnerabilities within their files.
      playbookName: Detonate File - JoeSecurity V2
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      File:
        complex:
          root: inputs.File
      InternetAccess:
        simple: "True"
      Interval:
        simple: "1"
      Timeout:
        simple: "15"
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 3080,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "25":
    id: "25"
    taskid: c2d10c29-3ea1-4468-8298-a0a9bf8bbe01
    type: condition
    task:
      id: c2d10c29-3ea1-4468-8298-a0a9bf8bbe01
      version: -1
      name: Check if file exists
      description: Checks if there is a file to detonate.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "26"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: inputs.File.EntryID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6077.5,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: 512ffcd3-2846-46d5-8e47-edceba820870
    type: regular
    task:
      id: 512ffcd3-2846-46d5-8e47-edceba820870
      version: -1
      name: Detonate File - OPSWAT Filescan
      description: Detonates a file using the OPSWAT-Filescan Integration. Returns relevant reports to the War Room and file reputations to the context data.
      script: OPSWAT Filescan|||opswat-filescan-scan-file
      type: regular
      iscommand: true
      brand: OPSWAT Filescan
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      entry_id:
        simple: ${inputs.File.EntryID}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6190,
          "y": 540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: 8febf391-f313-4539-89c1-bd4df099dc51
    type: playbook
    task:
      id: 8febf391-f313-4539-89c1-bd4df099dc51
      version: -1
      name: Detonate file - CrowdStrike Falcon Sandbox v2
      description: Detonates a File using CrowdStrike Falcon.
      playbookName: Detonate file - CrowdStrike Falcon Sandbox v2
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      EnvironmentID:
        simple: "100"
      File:
        complex:
          root: inputs.File
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 3500,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: bcdde402-6c62-405b-8ed9-655e87f661d8
    type: playbook
    task:
      id: bcdde402-6c62-405b-8ed9-655e87f661d8
      version: -1
      name: CrowdStrike Falcon Sandbox - Detonate file
      playbookName: CrowdStrike Falcon Sandbox - Detonate file
      type: playbook
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      EnvironmentID:
        simple: "100"
      File:
        complex:
          root: inputs.File
      Interval:
        simple: "5"
      Timeout:
        simple: "30"
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 3500,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: 3136d7d0-e7cc-49e2-8a83-8ff39ee4c834
    type: playbook
    task:
      id: 3136d7d0-e7cc-49e2-8a83-8ff39ee4c834
      version: -1
      name: Detonate File - ThreatGrid v2
      description: Detonate one or more files using the ThreatGrid integration. This playbook returns relevant reports to the War Room and file reputations to the context data. The detonation supports the following file types - EXE, DLL, JAR, JS, PDF, DOC, DOCX, RTF, XLS, PPT, PPTX, XML, ZIP, VBN, SEP, XZ, GZ, BZ2, TAR, MHTML, SWF, LNK, URL, MSI, JTD, JTT, JTDC, JTTC, HWP, HWT, HWPX, BAT, HTA, PS1, VBS, WSF, JSE, VBE, CHM.
      playbookName: Detonate File - ThreatGrid v2
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      File:
        complex:
          root: inputs.File
      interval:
        simple: "60"
      timeout:
        simple: "900"
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 2660,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
system: true
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 570,
        "width": 6460,
        "x": 110,
        "y": 215
      }
    }
  }
inputs:
- key: EntryID
  value:
    complex:
      root: File
      accessor: EntryID
  required: false
  description: Entry ID of file to be detonated
  playbookInputQuery:
- key: File
  value:
    complex:
      root: File
  required: false
  description: File object of file to be detonated
  playbookInputQuery:
outputs:
- contextPath: Joe.Analysis.Status
  description: Analysis Status
  type: string
- contextPath: Joe.Analysis.WebID
  description: Web ID
  type: string
- contextPath: File.Name
  description: The file's name (only in case of report type=json)
  type: string
- contextPath: File.SHA1
  description: SHA1 hash of the file
  type: string
- contextPath: File.SHA256
  description: SHA256 hash of the file
  type: string
- contextPath: File.Size
  description: File size (only in case of report type=json)
  type: number
- contextPath: File.Type
  description: File type e.g. "PE" (only in case of report type=json)
  type: string
- contextPath: File.Malicious
  description: The File malicious description
  type: unknown
- contextPath: File.Malicious.Description
  description: For malicious files, the reason for the vendor to make the decision
  type: string
- contextPath: File.Malicious.Vendor
  description: For malicious files, the vendor that made the decision
  type: string
- contextPath: DBotScore
  description: The Indicator's object
  type: unknown
- contextPath: DBotScore.Indicator
  description: The indicator that was tested
  type: string
- contextPath: DBotScore.Score
  description: The actual score
  type: number
- contextPath: DBotScore.Type
  description: The type of the indicator
  type: string
- contextPath: DBotScore.Vendor
  description: Vendor used to calculate the score
  type: string
- contextPath: IP.Address
  description: IP's relevant to the sample
  type: string
- contextPath: DBotScore.Malicious.Vendor
  description: Vendor used to calculate the score
  type: string
- contextPath: DBotScore.Malicious.Detections
  description: The sub analysis detection statuses
  type: string
- contextPath: DBotScore.Malicious.SHA1
  description: The SHA1 of the file
  type: string
- contextPath: Sample.State
  description: The sample state
- contextPath: Sample.ID
  description: The sample ID
- contextPath: File
  description: The File's object
  type: unknown
- contextPath: File.MD5
  description: MD5 hash of the file
  type: string
- contextPath: Joe.Analysis.SampleName
  description: Sample Data, could be a file name or URL
  type: string
- contextPath: Joe.Analysis.Comments
  description: Analysis Comments
  type: string
- contextPath: Joe.Analysis.Time
  description: Submitted Time
  type: date
- contextPath: Joe.Analysis.Runs
  description: Sub-Analysis Information
  type: unknown
- contextPath: Joe.Analysis.Result
  description: Analysis Results
  type: string
- contextPath: Joe.Analysis.Errors
  description: Raised errors during sampling
  type: unknown
- contextPath: Joe.Analysis.Systems
  description: Analysis OS
  type: unknown
- contextPath: Joe.Analysis.MD5
  description: MD5 of analysis sample
  type: string
- contextPath: Joe.Analysis.SHA1
  description: SHA1 of analysis sample
  type: string
- contextPath: Joe.Analysis.SHA256
  description: SHA256 of analysis sample
  type: string
- contextPath: InfoFile.Name
  description: FileName of the report file
  type: string
- contextPath: InfoFile.EntryID
  description: The EntryID of the report file
  type: string
- contextPath: InfoFile.Size
  description: File Size
  type: number
- contextPath: InfoFile.Type
  description: File type e.g. "PE"
  type: string
- contextPath: InfoFile.Info
  description: Basic information of the file
  type: string
- contextPath: File.Extension
  description: The extension of the file
  type: string
- contextPath: InfoFile
  description: The report file's object
  type: unknown
- contextPath: WildFire.Report
  description: The submission object
  type: unknown
- contextPath: WildFire.Report.Status
  description: The status of the submission
  type: string
- contextPath: WildFire.Report.SHA256
  description: SHA256 of the submission
  type: string
- contextPath: WildFire.Report.MD5
  description: MD5 of the submission
  type: string
- contextPath: WildFire.Report.FileType
  description: The type of the submission
  type: string
- contextPath: WildFire.Report.Size
  description: The size of the submission
  type: number
- contextPath: Joe.Analysis
  description: The Analysis object
  type: unknown
- contextPath: Cuckoo.Task.Category
  description: Category of task
- contextPath: Cuckoo.Task.Machine
  description: Machine of task
- contextPath: Cuckoo.Task.Errors
  description: Errors of task
- contextPath: Cuckoo.Task.Target
  description: Target of task
- contextPath: Cuckoo.Task.Package
  description: Package of task
- contextPath: Cuckoo.Task.SampleID
  description: Sample ID of task
- contextPath: Cuckoo.Task.Guest
  description: Task guest
- contextPath: Cuckoo.Task.Custom
  description: Custom values of task
- contextPath: Cuckoo.Task.Owner
  description: Task owner
- contextPath: Cuckoo.Task.Priority
  description: Priority of task
- contextPath: Cuckoo.Task.Platform
  description: Platform of task
- contextPath: Cuckoo.Task.Options
  description: Task options
- contextPath: Cuckoo.Task.Status
  description: Task status
- contextPath: Cuckoo.Task.EnforceTimeout
  description: Is timeout of task enforced
- contextPath: Cuckoo.Task.Timeout
  description: Task timeout
- contextPath: Cuckoo.Task.Memory
  description: Task memory
- contextPath: Cuckoo.Task.Tags
  description: Task tags
- contextPath: Cuckoo.Task.ID
  description: ID of task
- contextPath: Cuckoo.Task.AddedOn
  description: Date on which the task was added
- contextPath: Cuckoo.Task.CompletedOn
  description: Date on which the task was completed
- contextPath: Cuckoo.Task.Score
  description: Reported score of the the task
- contextPath: Cuckoo.Task.Monitor
  description: Monitor of the reported task
- contextPath: SNDBOX.Analysis.ID
  description: Analysis ID
  type: string
- contextPath: SNDBOX.Analysis.SampleName
  description: Sample Data, could be a file name or URL
  type: string
- contextPath: SNDBOX.Analysis.Status
  description: Analysis Status
  type: string
- contextPath: SNDBOX.Analysis.Time
  description: Submitted Time
  type: date
- contextPath: SNDBOX.Analysis.Result
  description: Analysis Results
  type: string
- contextPath: SNDBOX.Analysis.Errors
  description: Raised errors during sampling
- contextPath: SNDBOX.Analysis.Link
  description: Analysis Link
  type: string
- contextPath: SNDBOX.Analysis.MD5
  description: MD5 of analysis sample
  type: string
- contextPath: SNDBOX.Analysis.SHA1
  description: SHA1 of analysis sample
  type: string
- contextPath: SNDBOX.Analysis.SHA256
  description: SHA256 of analysis sample
  type: string
- contextPath: SNDBOX.Analysis
  description: SNDBOX analysis
  type: unknown
- contextPath: HybridAnalysis.Submit.State
  description: The state of the process
  type: string
- contextPath: HybridAnalysis.Submit.SHA256
  description: The submission SHA256
  type: string
- contextPath: HybridAnalysis.Submit.JobID
  description: The JobID of the submission
  type: string
- contextPath: HybridAnalysis.Submit.EnvironmentID
  description: The environmentID of the submission
  type: string
- contextPath: HybridAnalysis.Submit
  description: The HybridAnalysis object
  type: unknown
- contextPath: ANYRUN.Task.AnalysisDate
  description: Date and time the analysis was executed.
  type: String
- contextPath: ANYRUN.Task.Behavior.Category
  description: Category of a process behavior.
  type: String
- contextPath: ANYRUN.Task.Behavior.Action
  description: Actions performed by a process.
  type: String
- contextPath: ANYRUN.Task.Behavior.ThreatLevel
  description: Threat score associated with a process behavior.
  type: Number
- contextPath: ANYRUN.Task.Behavior.ProcessUUID
  description: Unique ID of the process whose behaviors are being profiled.
  type: String
- contextPath: ANYRUN.Task.Connection.Reputation
  description: Connection reputation.
  type: String
- contextPath: ANYRUN.Task.Connection.ProcessUUID
  description: ID of the process that created the connection.
  type: String
- contextPath: ANYRUN.Task.Connection.ASN
  description: Connection autonomous system network.
  type: String
- contextPath: ANYRUN.Task.Connection.Country
  description: Connection country.
  type: String
- contextPath: ANYRUN.Task.Connection.Protocol
  description: Connection protocol.
  type: String
- contextPath: ANYRUN.Task.Connection.Port
  description: Connection port number.
  type: Number
- contextPath: ANYRUN.Task.Connection.IP
  description: Connection IP number.
  type: String
- contextPath: ANYRUN.Task.DnsRequest.Reputation
  description: Reputation of the DNS request.
  type: String
- contextPath: ANYRUN.Task.DnsRequest.IP
  description: IP addresses associated with a DNS request.
  type: Unknown
- contextPath: ANYRUN.Task.DnsRequest.Domain
  description: Domain resolution of a DNS request.
  type: String
- contextPath: ANYRUN.Task.Threat.ProcessUUID
  description: Unique process ID from where the threat originated.
  type: String
- contextPath: ANYRUN.Task.Threat.Msg
  description: Threat message.
  type: String
- contextPath: ANYRUN.Task.Threat.Class
  description: Class of the threat.
  type: String
- contextPath: ANYRUN.Task.Threat.SrcPort
  description: Port on which the threat originated.
  type: Number
- contextPath: ANYRUN.Task.Threat.DstPort
  description: Destination port of the threat.
  type: Number
- contextPath: ANYRUN.Task.Threat.SrcIP
  description: Source IP address where the threat originated.
  type: String
- contextPath: ANYRUN.Task.Threat.DstIP
  description: Destination IP address of the threat.
  type: String
- contextPath: ANYRUN.Task.HttpRequest.Reputation
  description: Reputation of the HTTP request.
  type: String
- contextPath: ANYRUN.Task.HttpRequest.Country
  description: HTTP request country.
  type: String
- contextPath: ANYRUN.Task.HttpRequest.ProcessUUID
  description: ID of the process making the HTTP request.
  type: String
- contextPath: ANYRUN.Task.HttpRequest.Body
  description: HTTP request body parameters and details.
  type: Unknown
- contextPath: ANYRUN.Task.HttpRequest.HttpCode
  description: HTTP request response code.
  type: Number
- contextPath: ANYRUN.Task.HttpRequest.Status
  description: Status of the HTTP request.
  type: String
- contextPath: ANYRUN.Task.HttpRequest.ProxyDetected
  description: Whether the HTTP request was made through a proxy.
  type: Boolean
- contextPath: ANYRUN.Task.HttpRequest.Port
  description: HTTP request port.
  type: Number
- contextPath: ANYRUN.Task.HttpRequest.IP
  description: HTTP request IP address.
  type: String
- contextPath: ANYRUN.Task.HttpRequest.URL
  description: HTTP request URL.
  type: String
- contextPath: ANYRUN.Task.HttpRequest.Host
  description: HTTP request host.
  type: String
- contextPath: ANYRUN.Task.HttpRequest.Method
  description: HTTP request method type.
  type: String
- contextPath: ANYRUN.Task.FileInfo
  description: Details of the submitted file.
  type: String
- contextPath: ANYRUN.Task.OS
  description: OS of the sandbox in which the file was analyzed.
  type: String
- contextPath: ANYRUN.Task.ID
  description: The unique ID of the task.
  type: String
- contextPath: ANYRUN.Task.MIME
  description: The MIME of the file submitted for analysis.
  type: String
- contextPath: ANYRUN.Task.MD5
  description: The MD5 hash of the file submitted for analysis.
  type: String
- contextPath: ANYRUN.Task.SHA1
  description: The SHA1 hash of the file submitted for analysis.
  type: String
- contextPath: ANYRUN.Task.SHA256
  description: The SHA256 hash of the file submitted for analysis.
  type: String
- contextPath: ANYRUN.Task.SSDeep
  description: SSDeep hash of the file submitted for analysis.
  type: String
- contextPath: ANYRUN.Task.Verdict
  description: ANY.RUN verdict for the maliciousness of the submitted file or URL.
  type: String
- contextPath: ANYRUN.Task.Process.FileName
  description: File name of the process.
  type: String
- contextPath: ANYRUN.Task.Process.PID
  description: Process identification number.
  type: Number
- contextPath: ANYRUN.Task.Process.PPID
  description: Parent process identification number.
  type: Number
- contextPath: ANYRUN.Task.Process.ProcessUUID
  description: Unique process ID (used by ANY.RUN).
  type: String
- contextPath: ANYRUN.Task.Process.CMD
  description: Process command.
  type: String
- contextPath: ANYRUN.Task.Process.Path
  description: Path of the executed command.
  type: String
- contextPath: ANYRUN.Task.Process.User
  description: User who executed the command.
  type: String
- contextPath: ANYRUN.Task.Process.IntegrityLevel
  description: The process integrity level.
  type: String
- contextPath: ANYRUN.Task.Process.ExitCode
  description: Process exit code.
  type: Number
- contextPath: ANYRUN.Task.Process.MainProcess
  description: Whether the process is the main process.
  type: Boolean
- contextPath: ANYRUN.Task.Process.Version.Company
  description: Company responsible for the program executed.
  type: String
- contextPath: ANYRUN.Task.Process.Version.Description
  description: Description of the type of program.
  type: String
- contextPath: ANYRUN.Task.Process.Version.Version
  description: Version of the program executed.
  type: String
- contextPath: File.SSDeep
  description: SSDeep hash of the file submitted for analysis.
  type: String
- contextPath: ANYRUN.Task.Status
  description: Task analysis status.
  type: String
- contextPath: VMRay.Job
  description: The Job Object
  type: unknown
- contextPath: VMRay.Job.JobID
  description: The ID of a new job.
  type: number
- contextPath: VMRay.Job.SampleID
  description: The ID of sample.
  type: number
- contextPath: VMRay.Job.Created
  description: The timestamp of the created job.
  type: date
- contextPath: VMRay.Job.VMName
  description: The name of virtual machine.
  type: string
- contextPath: VMRay.Job.VMID
  description: The ID of virtual machine.
  type: number
- contextPath: VMRay.Sample
  description: 'The Sample For Analysis'
  type: unknown
- contextPath: VMRay.Sample.SampleID
  description: The sample ID of the task.
  type: number
- contextPath: VMRay.Sample.Created
  description: The timestamp of the created sample.
  type: date
- contextPath: VMRay.Sample.FileName
  description: The file name of the sample.
  type: string
- contextPath: VMRay.Sample.MD5
  description: The MD5 hash of the sample.
  type: string
- contextPath: VMRay.Sample.SHA1
  description: The SHA1 hash of the sample.
  type: string
- contextPath: VMRay.Sample.SHA256
  description: The SHA256 hash of the sample.
  type: string
- contextPath: VMRay.Sample.SSDeep
  description: The SSDeep of the sample.
  type: string
- contextPath: VMRay.Sample.Verdict
  description: Verdict for the sample (Malicious, Suspicious, Clean, Not Available).
  type: String
- contextPath: VMRay.Sample.VerdictReason
  description: Description of the Verdict Reason.
  type: String
- contextPath: VMRay.Sample.Severity
  description: Severity of the sample (Malicious, Suspicious, Good, Blacklisted, Whitelisted, Unknown). Deprecated.
  type: string
- contextPath: VMRay.Sample.Type
  description: The file type.
  type: string
- contextPath: VMRay.Sample.Classifications
  description: The classifications of the sample.
  type: string
- contextPath: VMRay.Submission
  description: 'Submission Object'
  type: unknown
- contextPath: VMRay.Submission.SubmissionID
  description: The submission ID.
  type: number
- contextPath: VMRay.Submission.HadErrors
  description: Whether there are any errors in the submission.
  type: boolean
- contextPath: VMRay.Submission.IsFinished
  description: The status of submission. Can be, "true" or "false".
  type: boolean
- contextPath: VMRay.Submission.MD5
  description: The MD5 hash of the sample in submission.
  type: string
- contextPath: VMRay.Submission.SHA1
  description: The SHA1 hash of the sample in submission.
  type: string
- contextPath: VMRay.Submission.SHA256
  description: The SHA256 hash of the sample in submission.
  type: string
- contextPath: VMRay.Submission.Verdict
  description: Verdict for the sample (Malicious, Suspicious, Clean, Not Available).
  type: String
- contextPath: VMRay.Submission.VerdictReason
  description: Description of the Verdict Reason.
  type: String
- contextPath: VMRay.Submission.Severity
  description: Severity of the sample (Malicious, Suspicious, Good, Blacklisted, Whitelisted, Unknown). Deprecated.
  type: string
- contextPath: VMRay.Submission.SSDeep
  description: The SSDeep hash of the sample in submission.
  type: string
- contextPath: VMRay.Submission.SampleID
  description: The ID of the sample in submission.
  type: number
- contextPath: VMRay.Sample.IOC.File
  description: 'File Object'
  type: unknown
- contextPath: VMRay.Sample.IOC.File.AnalysisID
  description: The IDs of other analyses that contain the given file.
  type: number
- contextPath: VMRay.Sample.IOC.File.Name
  description: The name of the file.
  type: string
- contextPath: VMRay.Sample.IOC.File.Operation
  description: The operation of the given file.
  type: string
- contextPath: VMRay.Sample.IOC.File.ID
  description: The ID of the file.
  type: number
- contextPath: VMRay.Sample.IOC.File.Type
  description: The type of the file.
  type: string
- contextPath: VMRay.Sample.IOC.File.Hashes
  description: 'File Hashes Object'
  type: unknown
- contextPath: VMRay.Sample.IOC.File.Hashes.MD5
  description: The MD5 hash of the given file.
  type: string
- contextPath: VMRay.Sample.IOC.File.Hashes.SSDeep
  description: The SSDeep hash of the given file.
  type: string
- contextPath: VMRay.Sample.IOC.File.Hashes.SHA256
  description: The SHA256 hash of the given file.
  type: string
- contextPath: VMRay.Sample.IOC.File.Hashes.SHA1
  description: The SHA1 hash of the given file.
  type: string
- contextPath: VMRay.Sample.IOC.URL
  description: 'URL Object'
  type: unknown
- contextPath: VMRay.Sample.IOC.URL.AnalysisID
  description: The IDs of the other analyses that contain the given URL.
  type: number
- contextPath: VMRay.Sample.IOC.URL.URL
  description: The URL.
  type: string
- contextPath: VMRay.Sample.IOC.URL.Operation
  description: The operation of the specified URL.
  type: string
- contextPath: VMRay.Sample.IOC.URL.ID
  description: The ID of the URL.
  type: number
- contextPath: VMRay.Sample.IOC.URL.Type
  description: The type of the URL.
  type: string
- contextPath: VMRay.Sample.IOC.Domain
  description: 'Domain Object'
  type: unknown
- contextPath: VMRay.Sample.IOC.Domain.AnalysisID
  description: The IDs of the other analyses that contain the given domain.
  type: number
- contextPath: VMRay.Sample.IOC.Domain.Domain
  description: The domain.
  type: string
- contextPath: VMRay.Sample.IOC.Domain.ID
  description: The ID of the domain.
  type: number
- contextPath: VMRay.Sample.IOC.Domain.Type
  description: The type of the domain.
  type: string
- contextPath: VMRay.Sample.IOC.IP
  description: 'IP Object'
  type: unknown
- contextPath: VMRay.Sample.IOC.IP.AnalysisID
  description: The IDs of the other analyses that contain the given IP address.
  type: number
- contextPath: VMRay.Sample.IOC.IP.IP
  description: The IP address.
  type: string
- contextPath: VMRay.Sample.IOC.IP.Operation
  description: The operation of the given IP address.
  type: string
- contextPath: VMRay.Sample.IOC.IP.ID
  description: The ID of the IP address.
  type: number
- contextPath: VMRay.Sample.IOC.IP.Type
  description: The type of the IP address.
  type: string
- contextPath: VMRay.Sample.IOC.Mutex
  description: 'Mutex Object'
  type: unknown
- contextPath: VMRay.Sample.IOC.Mutex.AnalysisID
  description: The IDs of other analyses that contain the given IP address.
  type: number
- contextPath: VMRay.Sample.IOC.Mutex.Name
  description: The name of the mutex.
  type: string
- contextPath: VMRay.Sample.IOC.Mutex.Operation
  description: The operation of the given mutex
  type: string
- contextPath: VMRay.Sample.IOC.Mutex.ID
  description: The ID of the mutex.
  type: number
- contextPath: VMRay.Sample.IOC.Mutex.Type
  description: The type of the mutex.
  type: string
- contextPath: VMRay.ThreatIndicator
  description: 'Indicator Object'
  type: unknown
- contextPath: VMRay.ThreatIndicator.AnalysisID
  description: The list of connected analysis IDs.
  type: number
- contextPath: VMRay.ThreatIndicator.Category
  description: The category of threat indicators.
  type: string
- contextPath: VMRay.ThreatIndicator.Classification
  description: The classifications of threat indicators.
  type: string
- contextPath: VMRay.ThreatIndicator.ID
  description: The ID of the threat indicator.
  type: number
- contextPath: VMRay.ThreatIndicator.Operation
  description: The operation that caused the indicators.
  type: string
- contextPath: SecneurXAnalysis.Report.SHA256
  description: SHA256 value of the analyzed sample
  type: string
- contextPath: SecneurXAnalysis.Report.Verdict
  description: Summary result of the analyzed sample
  type: string
- contextPath: SecneurXAnalysis.Report.Tags
  description: More details of the analyzed sample
  type: string
- contextPath: SecneurXAnalysis.Report.IOC
  description: List of IOC's observed in the analyzed sample
  type: string
- contextPath: SecneurXAnalysis.Report.Status
  description: Analysis queued sample state
  type: String
fromversion: 5.0.0
tests:
- Detonate File - No Files test
- Detonate File - Generic Test
