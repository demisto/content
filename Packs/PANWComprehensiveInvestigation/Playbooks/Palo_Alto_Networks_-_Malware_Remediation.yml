id: Palo Alto Networks - Malware Remediation
version: -1
name: Palo Alto Networks - Malware Remediation
description: Deprecated. Use Malware Investigation and Response pack instead. For more information, refer to https://xsoar.pan.dev/docs/reference/packs/malware-investigation-and-response.This Playbook performs malicious IOC remediation using Palo Alto Networks integrations.
deprecated: true
starttaskid: "0"
fromversion: 5.0.0
tasks:
  "0":
    id: "0"
    taskid: 1b3ca4dc-e4c3-42f1-8f6c-572824481dd0
    type: start
    task:
      id: 1b3ca4dc-e4c3-42f1-8f6c-572824481dd0
      version: -1
      name: ""
      description: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "39"
      - "40"
      - "51"
      - "61"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1230,
          "y": 230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "3":
    id: "3"
    taskid: ed72f1bf-cd06-43cd-8005-bccfc2ad8eb3
    type: playbook
    task:
      id: ed72f1bf-cd06-43cd-8005-bccfc2ad8eb3
      version: -1
      name: Add Indicator to Miner - Palo Alto MineMeld
      description: Add indicators to the relevant Miner using MineMeld.
      playbookName: Add Indicator to Miner - Palo Alto MineMeld
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      Indicator:
        complex:
          root: inputs.IP
          transformers:
          - operator: append
            args:
              item:
                value:
                  simple: inputs.URL
                iscontext: true
          - operator: join
            args:
              separator:
                value:
                  simple: ','
      MinerName:
        complex:
          root: inputs.Miner
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 2490,
          "y": 1030
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
  "4":
    id: "4"
    taskid: 7c26d3ac-5930-43ad-8860-1568ed25f4d6
    type: title
    task:
      id: 7c26d3ac-5930-43ad-8860-1568ed25f4d6
      version: -1
      name: PAN OS - Custom URL Category
      description: ""
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "13"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 210,
          "y": 510
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "8":
    id: "8"
    taskid: 389eaa45-83ae-4600-80a1-5c8594a66178
    type: title
    task:
      id: 389eaa45-83ae-4600-80a1-5c8594a66178
      version: -1
      name: PAN OS - Dynamic Address Group
      description: ""
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "12"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 800,
          "y": 510
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "11":
    id: "11"
    taskid: f116f012-7b5d-48c7-891e-ce97346d4918
    type: title
    task:
      id: f116f012-7b5d-48c7-891e-ce97346d4918
      version: -1
      name: Done
      description: ""
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1180,
          "y": 1280
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "12":
    id: "12"
    taskid: 7266ec1f-ec70-4311-8ddc-2d9b720c8cb0
    type: condition
    task:
      id: 7266ec1f-ec70-4311-8ddc-2d9b720c8cb0
      version: -1
      name: Use Dynamic Address Group?
      description: ""
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "11"
      "yes":
      - "49"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: inputs.DAG
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: inputs.IP
            iscontext: true
    view: |-
      {
        "position": {
          "x": 800,
          "y": 640
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "13":
    id: "13"
    taskid: 7f43e773-e292-4ece-817e-395d35ff9034
    type: condition
    task:
      id: 7f43e773-e292-4ece-817e-395d35ff9034
      version: -1
      name: Use Custom URL Category?
      description: ""
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "11"
      "yes":
      - "42"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: inputs.CustomURLCategory
            iscontext: true
    view: |-
      {
        "position": {
          "x": 210,
          "y": 640
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "14":
    id: "14"
    taskid: 344f8dd4-ced1-4f7e-842e-0869de203bbc
    type: title
    task:
      id: 344f8dd4-ced1-4f7e-842e-0869de203bbc
      version: -1
      name: PAN OS - Custom Block Rule
      description: ""
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -980,
          "y": 510
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "15":
    id: "15"
    taskid: 7943d985-f1d7-4618-8a86-16c7cbc156cf
    type: condition
    task:
      id: 7943d985-f1d7-4618-8a86-16c7cbc156cf
      version: -1
      name: Use Custom Block Rules?
      description: ""
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "11"
      "yes":
      - "41"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: inputs.CustomBlockRule
            iscontext: true
          right:
            value:
              simple: "True"
    view: |-
      {
        "position": {
          "x": -980,
          "y": 650
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "18":
    id: "18"
    taskid: 69d65ef0-a308-4ee7-8ef0-7bd43926fd94
    type: title
    task:
      id: 69d65ef0-a308-4ee7-8ef0-7bd43926fd94
      version: -1
      name: Block IP/URL IOCs - EDL
      description: ""
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1350,
          "y": 510
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "20":
    id: "20"
    taskid: afeedcc5-7f64-4d74-8aca-49c95acfce57
    type: condition
    task:
      id: afeedcc5-7f64-4d74-8aca-49c95acfce57
      version: -1
      name: Use External Dynamic List?
      description: ""
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "11"
      "yes":
      - "60"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: inputs.IPListName
            iscontext: true
        - operator: isNotEmpty
          left:
            value:
              simple: inputs.URLListName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: inputs.EDLServerIP
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1350,
          "y": 640
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "39":
    id: "39"
    taskid: 53e59b09-1bcb-4cc3-88c3-ad6da49f099e
    type: title
    task:
      id: 53e59b09-1bcb-4cc3-88c3-ad6da49f099e
      version: -1
      name: PAN OS Remediation
      description: ""
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "14"
      - "8"
      - "4"
      - "18"
      - "43"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 470,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "40":
    id: "40"
    taskid: 3587a2fa-ee06-4d62-8387-be4185325a8c
    type: title
    task:
      id: 3587a2fa-ee06-4d62-8387-be4185325a8c
      version: -1
      name: Update TI - MimeMeld
      description: ""
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "46"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2160,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "41":
    id: "41"
    taskid: 31ac6118-e689-4d93-8435-a22a80c2e725
    type: playbook
    task:
      id: 31ac6118-e689-4d93-8435-a22a80c2e725
      version: -1
      name: PAN-OS - Block IP - Custom Block Rule
      description: |-
        This playbook blocks IP addresses using Palo Alto Networks Panorama or Firewall using Custom Block Rules.
        The playbook receives malicious IP addresses as inputs, creates a custom bi-directional rule to block them, and commits
        the configuration.

        ***Note - The playbook does not check if the IP address is already blocked.
      playbookName: PAN-OS - Block IP - Custom Block Rule
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      AutoCommit:
        complex:
          root: inputs.AutoCommit
      IP:
        complex:
          root: inputs.IP
      LogForwarding:
        complex:
          root: inputs.LogForwarding
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": -980,
          "y": 1030
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
  "42":
    id: "42"
    taskid: 95ceeebc-0ed9-40f3-8a9e-2037926b33ba
    type: playbook
    task:
      id: 95ceeebc-0ed9-40f3-8a9e-2037926b33ba
      version: -1
      name: PAN-OS - Block URL - Custom URL Category
      description: "This playbook blocks URLs using Palo Alto Networks Panorama or Firewall using Custom URL Categories.\nThe playbook checks whether the input URL category already exists, and if the URLs are a part of this category. \nOtherwise, it creates the category, blocks the URLs, and commits the configuration."
      playbookName: PAN-OS - Block URL - Custom URL Category
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      AutoCommit:
        complex:
          root: inputs.AutoCommit
      CustomURLCategory:
        complex:
          root: inputs.CustomURLCategory
      LogForwarding:
        complex:
          root: inputs.LogForwarding
      URL:
        complex:
          root: inputs.URL
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 210,
          "y": 1030
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
  "43":
    id: "43"
    taskid: 8388d0c3-3e55-472c-8e13-4c5238243fbe
    type: title
    task:
      id: 8388d0c3-3e55-472c-8e13-4c5238243fbe
      version: -1
      name: PAN OS - Static Address Group
      description: ""
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "44"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -390,
          "y": 510
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "44":
    id: "44"
    taskid: 36e6a8b1-5011-4a10-8064-181b00ed2bf7
    type: condition
    task:
      id: 36e6a8b1-5011-4a10-8064-181b00ed2bf7
      version: -1
      name: Use Static Address Group?
      description: ""
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "11"
      "yes":
      - "45"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: inputs.StaticAddressGroup
            iscontext: true
    view: |-
      {
        "position": {
          "x": -390,
          "y": 640
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "45":
    id: "45"
    taskid: fa26b1f5-ee92-466c-80f6-02fc21ddebb2
    type: playbook
    task:
      id: fa26b1f5-ee92-466c-80f6-02fc21ddebb2
      version: -1
      name: PAN-OS - Block IP - Static Address Group
      description: |-
        This playbook blocks IP addresses using Palo Alto Networks Panorama or Firewall using Static Address Groups.
        The playbook receives malicious IP addresses and an address group name as inputs, checks if the addresses
        are not already a part of the address group, adds them and commits the configuration.

        ***Note - The playbook does not block the address group communication using a policy block rule. This step
        will be executed once outside of the playbook.
      playbookName: PAN-OS - Block IP - Static Address Group
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      AddressGroupName:
        complex:
          root: inputs.StaticAddressGroup
      AutoCommit:
        complex:
          root: inputs.AutoCommit
      IP:
        complex:
          root: inputs.IP
      LogForwarding:
        complex:
          root: inputs.LogForwarding
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": -390,
          "y": 1030
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
  "46":
    id: "46"
    taskid: 5023c38f-040f-4004-8634-5f44d75db1a6
    type: condition
    task:
      id: 5023c38f-040f-4004-8634-5f44d75db1a6
      version: -1
      name: Use Minemeld?
      description: ""
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "11"
      "yes":
      - "47"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: inputs.Miner
            iscontext: true
    view: |-
      {
        "position": {
          "x": 2160,
          "y": 640
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "47":
    id: "47"
    taskid: b89ac2fb-ae71-47d6-8e18-291695b8cd2a
    type: condition
    task:
      id: b89ac2fb-ae71-47d6-8e18-291695b8cd2a
      version: -1
      name: Are there indicators to update?
      description: ""
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "11"
      "yes":
      - "3"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: inputs.IP
            iscontext: true
        - operator: isNotEmpty
          left:
            value:
              complex:
                root: inputs.URL
            iscontext: true
    view: |-
      {
        "position": {
          "x": 2330,
          "y": 810
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "49":
    id: "49"
    taskid: 619fd6bc-b187-4e32-884f-04eb3cf1ab14
    type: playbook
    task:
      id: 619fd6bc-b187-4e32-884f-04eb3cf1ab14
      version: -1
      name: PAN-OS DAG Configuration
      description: "This playbook utilizes the Dynamic Address Group (DAG) capability of PAN-OS.\nDAG enables analysts to create a rule one time, where the group is the source/destination, and adds IP addresses dynamically without the need to commit the configuration every time.\n\nThe playbook checks if the given tag already exists. If the tag exists, the IP address is added to the tag.\n\nIf the tag does not exist, a new address group is created with the given tag and a matching rule, and the configuration is committed. \n"
      playbookName: PAN-OS DAG Configuration
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      address_group_name:
        simple: Demisto - Remediation IP Address Group
      auto_commit:
        complex:
          root: inputs.AutoCommit
      ip_list:
        complex:
          root: inputs.IP
      log-forwarding-object-name:
        complex:
          root: inputs.LogForwarding
          filters:
          - - operator: isNotEmpty
              left:
                value:
                  simple: inputs.LogForwarding
                iscontext: true
      rule_name:
        simple: Demisto Block Rule - ${incident.id}
      tag_name:
        complex:
          root: inputs.DAG
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 800,
          "y": 1030
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
  "51":
    id: "51"
    taskid: 3a69c5cc-362a-4a08-83cd-9e14af7ca765
    type: title
    task:
      id: 3a69c5cc-362a-4a08-83cd-9e14af7ca765
      version: -1
      name: Traps Remediation
      description: ""
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "55"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 3120,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "55":
    id: "55"
    taskid: 2f7627de-4db5-4065-8d2b-233639b56a5b
    type: condition
    task:
      id: 2f7627de-4db5-4065-8d2b-233639b56a5b
      version: -1
      name: Use Traps?
      description: ""
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "11"
      "yes":
      - "57"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: inputs.Traps
                transformers:
                - operator: toLowerCase
            iscontext: true
          right:
            value:
              simple: "yes"
    view: |-
      {
        "position": {
          "x": 3120,
          "y": 640
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "56":
    id: "56"
    taskid: 4c1120f7-f350-47fc-84b6-17413d33dfe1
    type: playbook
    task:
      id: 4c1120f7-f350-47fc-84b6-17413d33dfe1
      version: -1
      name: Traps Blacklist File
      playbookName: Traps Blacklist File
      description: ""
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      SHA256:
        complex:
          root: inputs.SHA256
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 3510,
          "y": 1030
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
  "57":
    id: "57"
    taskid: 317b1fd6-cb01-46ae-8819-ebfc5baff94e
    type: playbook
    task:
      id: 317b1fd6-cb01-46ae-8819-ebfc5baff94e
      version: -1
      name: Traps Isolate Endpoint
      playbookName: Traps Isolate Endpoint
      description: ""
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "56"
      - "58"
    scriptarguments:
      EndpointId:
        complex:
          root: inputs.EndpointId
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 3290,
          "y": 810
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
  "58":
    id: "58"
    taskid: 000ae004-8c72-42d0-89c6-d7c7cbdc6852
    type: playbook
    task:
      id: 000ae004-8c72-42d0-89c6-d7c7cbdc6852
      version: -1
      name: Traps Quarantine Event
      playbookName: Traps Quarantine Event
      description: ""
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      EventId:
        complex:
          root: inputs.EventId
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 3080,
          "y": 1030
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
  "59":
    id: "59"
    taskid: 446d029a-08ee-4fe5-8dde-25fbad28ee85
    type: playbook
    task:
      id: 446d029a-08ee-4fe5-8dde-25fbad28ee85
      version: -1
      name: PAN-OS - Block Domain - External Dynamic List
      playbookName: PAN-OS - Block Domain - External Dynamic List
      description: ""
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      AutoCommit:
        complex:
          root: inputs.AutoCommit
      Domain:
        complex:
          root: Domain
          filters:
          - - operator: isExists
              left:
                value:
                  simple: Domain.Malicious
                iscontext: true
          accessor: Name
          transformers:
          - operator: uniq
      DomainListName:
        complex:
          root: inputs.DomainListName
      EDLServerIP:
        complex:
          root: inputs.EDLServerIP
      LogForwarding:
        complex:
          root: inputs.LogForwarding
      pre-post-rulebase:
        simple: pre-rulebase
      rule-position: {}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 1540,
          "y": 1030
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
  "60":
    id: "60"
    taskid: c35ec371-f787-49c4-878a-e057f17a7a0e
    type: playbook
    task:
      id: c35ec371-f787-49c4-878a-e057f17a7a0e
      version: -1
      name: PAN-OS - Block IP and URL - External Dynamic List
      playbookName: PAN-OS - Block IP and URL - External Dynamic List
      description: ""
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "59"
    scriptarguments:
      AutoCommit:
        complex:
          root: inputs.AutoCommit
      EDLServerIP:
        complex:
          root: inputs.EDLServerIP
      IP:
        complex:
          root: inputs.IP
      IPListName:
        complex:
          root: inputs.IPListName
      LogForwarding:
        complex:
          root: inputs.LogForwarding
      URL:
        complex:
          root: inputs.URL
      URLListName:
        complex:
          root: inputs.URLListName
      ip-pre-post-rulebase:
        simple: pre-rulebase
      ip-rule-position: {}
      url-pre-post-rulebase:
        simple: pre-rulebase
      url-rule-position: {}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 1540,
          "y": 810
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
  "61":
    id: "61"
    taskid: 01f93078-7b5c-448b-8481-9de81fdbcbd6
    type: title
    task:
      id: 01f93078-7b5c-448b-8481-9de81fdbcbd6
      version: -1
      name: Cortex XDR Remediation
      description: ""
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "62"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 4100,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "62":
    id: "62"
    taskid: 75c59227-6384-4f2a-840b-9de721a0289e
    type: condition
    task:
      id: 75c59227-6384-4f2a-840b-9de721a0289e
      version: -1
      name: Use Cortex XDR?
      description: ""
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "11"
      "yes":
      - "63"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: inputs.UseXDR
                transformers:
                - operator: toLowerCase
            iscontext: true
          right:
            value:
              simple: "yes"
    view: |-
      {
        "position": {
          "x": 4100,
          "y": 640
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "63":
    id: "63"
    taskid: 39555270-4cd7-4a86-817b-3e9b8af1e35d
    type: playbook
    task:
      id: 39555270-4cd7-4a86-817b-3e9b8af1e35d
      version: -1
      name: Cortex XDR - Isolate Endpoint
      playbookName: Cortex XDR - Isolate Endpoint
      description: ""
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      endpoint_id:
        complex:
          root: inputs.xdr_endpoint_id
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 4100,
          "y": 1030
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
view: |-
  {
    "linkLabelsPosition": {
      "12_11_#default#": 0.45,
      "13_11_#default#": 0.21,
      "13_42_yes": 0.71,
      "15_11_#default#": 0.1,
      "15_41_yes": 0.73,
      "20_11_#default#": 0.51,
      "44_11_#default#": 0.14,
      "44_45_yes": 0.71,
      "46_11_#default#": 0.25,
      "46_47_yes": 0.51,
      "47_11_#default#": 0.1,
      "47_3_yes": 0.44,
      "55_11_#default#": 0.14,
      "62_11_#default#": 0.1
    },
    "paper": {
      "dimensions": {
        "height": 1115,
        "width": 5460,
        "x": -980,
        "y": 230
      }
    }
  }
inputs:
- key: DAG
  value: {}
  required: false
  description: |-
    This input establishes whether Palo Alto Networks Panorama or Firewall Dynamic Address Groups are used.
    Specify Dynamic Address Group tag name for IP handling.
- key: CustomURLCategory
  value: {}
  required: false
  description: |-
    This input establishes whether Palo Alto Networks Panorama or Firewall Custom URL Categories are used.
    Specify Category name for URL handling.
- key: CustomBlockRule
  value:
    simple: "False"
  required: false
  description: |
    This input establishes whether Palo Alto Networks Panorama or Firewall Custom block rules are used.
    Specify True to use Custom Block Rules.
- key: IPListName
  value: {}
  required: false
  description: |-
    This input establishes whether Palo Alto Networks Panorama or Firewall External Dynamic Lists, are used for IP Blockage.
    Specify the EDL name for IP handling.
- key: IP
  value:
    complex:
      root: IP
      filters:
      - - operator: isExists
          left:
            value:
              simple: IP.Malicious
            iscontext: true
      accessor: Address
      transformers:
      - operator: uniq
  required: false
  description: Malicious IP Addresses to block.
- key: URL
  value:
    complex:
      root: URL
      filters:
      - - operator: isExists
          left:
            value:
              simple: URL.Malicious
            iscontext: true
      accessor: Data
      transformers:
      - operator: uniq
  required: false
  description: Malicious URLs to block.
- key: LogForwarding
  value: {}
  required: false
  description: Panorama log forwarding object name.
- key: StaticAddressGroup
  value: {}
  required: false
  description: |-
    This input establishes whether Palo Alto Networks Panorama or Firewall Static address groups are used.
    Specify Static address group name for IP handling.
- key: Miner
  value: {}
  required: false
  description: |-
    This input establishes whether Palo Alto Networks Minemeld is used. Specify Miner name to
    update with the malicious indicators.
- key: AutoCommit
  value:
    simple: "No"
  required: false
  description: |-
    This input establishes whether to commit the configuration automatically.
    Yes - Commit automatically.
    No - Commit manually.
- key: URLListName
  value: {}
  required: false
  description: |-
    This input establishes whether Palo Alto Networks Panorama or Firewall External Dynamic Lists are used for URL Blockage.
    Specify the EDL name for URL handling.
- key: EDLServerIP
  value: {}
  required: false
  description: |-
    This input establishes whether Palo Alto Networks Panorama or Firewall External Dynamic Lists are used:
    * The IP address of the web server on which the files are stored.
    * The web server IP address is configured in the integration instance.
- key: Traps
  value: {}
  required: false
  description: This input establishes whether Palo Alto Networks Traps remediation will take place. Specify Yes/No
- key: EndpointId
  value: {}
  required: false
  description: Traps Endpoint ID to isolate.
- key: EventId
  value: {}
  required: false
  description: Traps event ID to perform file quarantine on.
- key: SHA256
  value:
    complex:
      root: File
      filters:
      - - operator: isExists
          left:
            value:
              simple: File.Malicious
            iscontext: true
      accessor: SHA256
      transformers:
      - operator: uniq
  required: false
  description: SHA256 to blacklist using Traps.
- key: DomainListName
  value: {}
  required: false
  description: |-
    This input establishes whether Palo Alto Networks Panorama or Firewall External Dynamic Lists, are used for domain blockage.
    Specify the EDL name for domain handling.
- key: UseXDR
  value: {}
  required: false
  description: This input establishes whether Palo Alto Networks Cortex XDR remediation will take place. Specify Yes/No
- key: xdr_endpoint_id
  value:
    complex:
      root: PaloAltoNetworksXDR
      accessor: Endpoint.endpoint_id
  required: false
  description: The endpoint ID (string) to isolate using Cortex XDR. You can retrieve the string from the xdr-get-endpoints command.
outputs: []
tests:
- Palo Alto Networks - Malware Remediation Test
