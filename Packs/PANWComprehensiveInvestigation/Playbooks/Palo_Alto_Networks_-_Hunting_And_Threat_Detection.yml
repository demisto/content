id: Palo Alto Networks - Hunting And Threat Detection
version: -1
fromversion: 5.0.0
name: Palo Alto Networks - Hunting And Threat Detection
description: "This is a multipurpose playbook used for hunting and threat detection. The playbook receives inputs based on hashes, IP addresses, or domain names provided manually or from outputs by other playbooks. \nThe playbook leverages data received by PANW products including, Strata Logging Service, Autofocus and Pan-OS to search for IP addresses, host names and users related to the provided indicators.\nThe output provided by the playbook enables you to find possibly affected IP addresses, users, and endpoints."
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: efd174b1-c3ae-48ce-8d14-52e397954612
    type: start
    task:
      id: efd174b1-c3ae-48ce-8d14-52e397954612
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "3"
      - "5"
      - "10"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 890,
          "y": 10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: c51b1fd5-2efa-43e5-87b6-c4985fcbcd4a
    type: playbook
    task:
      id: c51b1fd5-2efa-43e5-87b6-c4985fcbcd4a
      version: -1
      name: Convert file hash to corresponding hashes
      playbookName: Convert file hash to corresponding hashes
      type: playbook
      iscommand: false
      brand: ""
      description: |
        The playbook enables you to get all of the corresponding file hashes for a file even if there is only one hash type available.
        For example, if we have only the SHA256 hash, the playbook will get the SHA1 and MD5 hashes as long as the
        original searched hash is recognized by any our the threat intelligence integrations.
    nexttasks:
      '#none#':
      - "96"
      - "108"
      - "109"
      - "175"
    scriptarguments:
      MD5:
        complex:
          root: inputs.MD5
          transformers:
          - operator: uniq
      SHA1:
        complex:
          root: inputs.SHA1
          transformers:
          - operator: uniq
      SHA256:
        complex:
          root: inputs.SHA256
          transformers:
          - operator: uniq
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 670,
          "y": 640
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: e9e3c480-3070-4f6b-870c-840f29c66708
    type: condition
    task:
      id: e9e3c480-3070-4f6b-870c-840f29c66708
      version: -1
      name: Is there a hash?
      description: Header
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "4"
      "yes":
      - "2"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: inputs.SHA256
            iscontext: true
        - operator: isNotEmpty
          left:
            value:
              simple: inputs.MD5
            iscontext: true
        - operator: isNotEmpty
          left:
            value:
              simple: inputs.SHA1
            iscontext: true
    view: |-
      {
        "position": {
          "x": 890,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 731d19be-18c2-4a11-81c6-409d8e59a631
    type: title
    task:
      id: 731d19be-18c2-4a11-81c6-409d8e59a631
      version: -1
      name: Hash hunting done
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "153"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 890,
          "y": 2660
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 4b82d0f8-dd5f-43cc-8168-60d0f45add20
    type: condition
    task:
      id: 4b82d0f8-dd5f-43cc-8168-60d0f45add20
      version: -1
      name: Is there an ip?
      description: Hedaer
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "23"
      "yes":
      - "112"
      - "90"
      - "113"
      - "184"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: inputs.IPAddresses
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -940,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: 62cfbf13-0d5f-4aaa-8db7-43920fbb0127
    type: condition
    task:
      id: 62cfbf13-0d5f-4aaa-8db7-43920fbb0127
      version: -1
      name: Is there a domain/url?
      description: Is there an domain/url?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "55"
      "yes":
      - "111"
      - "93"
      - "110"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: inputs.URLDomain
            iscontext: true
    view: |-
      {
        "position": {
          "x": 2440,
          "y": 400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: 40a05796-6e85-4c73-8fd2-f893c6326afd
    type: condition
    task:
      id: 40a05796-6e85-4c73-8fd2-f893c6326afd
      version: -1
      name: Is Autofocus enabled?
      description: Is Autofocus enabled?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "23"
      "yes":
      - "100"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: modules
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: modules.brand
                      iscontext: true
                    right:
                      value:
                        simple: AutoFocus V2
                - - operator: isEqualString
                    left:
                      value:
                        simple: modules.state
                      iscontext: true
                    right:
                      value:
                        simple: active
            iscontext: true
    view: |-
      {
        "position": {
          "x": -1230,
          "y": 1100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: 0dcc38bf-5be7-4253-86c4-0ae975892c33
    type: condition
    task:
      id: 0dcc38bf-5be7-4253-86c4-0ae975892c33
      version: -1
      name: Are there related sessions in Autofocus?
      description: Are there related sessions in Autofocus?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "23"
      "yes":
      - "86"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: AutoFocus.SessionsResults.dst_ip
            iscontext: true
        - operator: isNotEmpty
          left:
            value:
              simple: AutoFocus.SessionsResults.src_ip
            iscontext: true
    view: |-
      {
        "position": {
          "x": -1230,
          "y": 1760
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: 5b6b48aa-f06b-4243-8142-28c3ed2be14d
    type: title
    task:
      id: 5b6b48aa-f06b-4243-8142-28c3ed2be14d
      version: -1
      name: IP hunting done
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "153"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -940,
          "y": 2780
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "25":
    id: "25"
    taskid: 65f14834-0f81-4756-8d67-74d7c7469e1c
    type: regular
    task:
      id: 65f14834-0f81-4756-8d67-74d7c7469e1c
      version: -1
      name: Search in Strata Logging Service threat logs
      description: Searches the Strata Logging Service Threat table, which is the threat logs table for PAN-OS/Panorama.
      script: '|||cdl-query-threat-logs'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "26"
    scriptarguments:
      fields:
        simple: all
      ip:
        complex:
          root: inputs.IPAddresses
          transformers:
          - operator: uniq
          - operator: join
            args:
              separator:
                value:
                  simple: ','
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -3120,
          "y": 1505
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    continueonerrortype: ""
    evidencedata:
      description:
        simple: Strata Logging Service threat logs search results
      customfields: {}
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: dfdcd4ea-d29d-4f46-874f-de63890673b1
    type: condition
    task:
      id: dfdcd4ea-d29d-4f46-874f-de63890673b1
      version: -1
      name: Is IP address detected in Strata Logging Service threat logs?
      description: Is the IP address detected in Strata Logging Service threat logs?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "23"
      "yes":
      - "27"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: inList
          left:
            value:
              complex:
                root: inputs.IPAddresses
                transformers:
                - operator: split
                  args:
                    delimiter:
                      value:
                        simple: ','
            iscontext: true
          right:
            value:
              simple: CDL.Logging.Threat.SourceIP
            iscontext: true
        - operator: inList
          left:
            value:
              complex:
                root: inputs.IPAddresses
                transformers:
                - operator: split
                  args:
                    delimiter:
                      value:
                        simple: ','
            iscontext: true
          right:
            value:
              simple: CDL.Logging.Threat.DestinationIP
            iscontext: true
    view: |-
      {
        "position": {
          "x": -3120,
          "y": 1765
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: 60d10a58-cb8c-4fa9-8f9c-b6caf57bbb24
    type: regular
    task:
      id: 60d10a58-cb8c-4fa9-8f9c-b6caf57bbb24
      version: -1
      name: Set detected IPs
      description: Set a value in context under the key you entered. If no value is entered, the script doesn't run.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "161"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: PANWHunting.DetectedIPs
      value:
        complex:
          root: CDL
          accessor: Logging.Threat.SourceIP
          transformers:
          - operator: append
            args:
              item:
                value:
                  simple: CDL.Logging.Threat.DestinationIP
                iscontext: true
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -3370,
          "y": 1950
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: ddbf993a-2930-4958-89bd-3fbeb535c1cc
    type: regular
    task:
      id: ddbf993a-2930-4958-89bd-3fbeb535c1cc
      version: -1
      name: Set detected users
      description: Set a value in context under the key you entered. If no value is entered, the script doesn't run.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      key:
        simple: PANWHunting.DetectedUsers
      value:
        complex:
          root: CDL
          filters:
          - - operator: match
              left:
                value:
                  simple: CDL.Logging.Threat.Users
                iscontext: true
              right:
                value:
                  simple: (?!\b(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(?:\[\.\]|\.)){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\b)
          accessor: Logging.Threat.Users
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -3370,
          "y": 2430
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: 7e4d2773-3226-4789-8463-0107cea679d4
    type: regular
    task:
      id: 7e4d2773-3226-4789-8463-0107cea679d4
      version: -1
      name: Search in Strata Logging Service Traffic logs
      description: Searches the Strata Logging Service traffic table. Traffic logs contain entries for the end of each network session.
      script: '|||cdl-query-traffic-logs'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      fields:
        simple: all
      ip:
        complex:
          root: inputs.IPAddresses
          transformers:
          - operator: uniq
          - operator: join
            args:
              separator:
                value:
                  simple: ','
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -2620,
          "y": 1505
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    continueonerrortype: ""
    evidencedata:
      description:
        simple: Strata Logging Service traffic logs search results
      customfields: {}
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: c99f4352-e1a8-4d7e-8c19-3c216fa0a81f
    type: condition
    task:
      id: c99f4352-e1a8-4d7e-8c19-3c216fa0a81f
      version: -1
      name: Is IP detected in Strata Logging Service traffic logs?
      description: Is the IP address detected in Strata Logging Service traffic logs?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "23"
      "yes":
      - "159"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: inList
          left:
            value:
              complex:
                root: inputs.IPAddresses
                transformers:
                - operator: split
                  args:
                    delimiter:
                      value:
                        simple: ','
            iscontext: true
          right:
            value:
              simple: CDL.Logging.Traffic.SourceIP
            iscontext: true
        - operator: inList
          left:
            value:
              complex:
                root: inputs.IPAddresses
                transformers:
                - operator: split
                  args:
                    delimiter:
                      value:
                        simple: ','
            iscontext: true
          right:
            value:
              simple: CDL.Logging.Traffic.DestinationIP
            iscontext: true
    view: |-
      {
        "position": {
          "x": -2620,
          "y": 1765
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: 480f1243-d2ba-4576-8848-403a6ff9d5de
    type: condition
    task:
      id: 480f1243-d2ba-4576-8848-403a6ff9d5de
      version: -1
      name: Is PAN-OS enabled?
      description: Is PAN-OS enabled?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "4"
      "yes":
      - "141"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: modules
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: modules.brand
                      iscontext: true
                    right:
                      value:
                        simple: Panorama
                - - operator: isEqualString
                    left:
                      value:
                        simple: modules.state
                      iscontext: true
                    right:
                      value:
                        simple: active
            iscontext: true
    view: |-
      {
        "position": {
          "x": -270,
          "y": 1350
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: 19e4e525-4811-453c-8b0e-abd9d7a133bf
    type: condition
    task:
      id: 19e4e525-4811-453c-8b0e-abd9d7a133bf
      version: -1
      name: Are there related sessions in Autofocus?
      description: Are there related sessions in Autofocus?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "4"
      "yes":
      - "72"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: AutoFocus.SessionsResults.dst_ip
            iscontext: true
        - operator: isNotEmpty
          left:
            value:
              simple: AutoFocus.SessionsResults.src_ip
            iscontext: true
    view: |-
      {
        "position": {
          "x": 590,
          "y": 1610
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: 7c2c68cf-3958-4f59-8a8d-8c1782cd838b
    type: regular
    task:
      id: 7c2c68cf-3958-4f59-8a8d-8c1782cd838b
      version: -1
      name: Search for the hash in Strata Logging Service Threat logs
      description: Searches the Strata Logging Service threat table, which is the threat logs table for PAN-OS/Panorama.
      script: '|||cdl-query-threat-logs'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "48"
    scriptarguments:
      file_sha_256:
        complex:
          root: inputs.SHA256
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1220,
          "y": 1350
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    continueonerrortype: ""
    evidencedata:
      description:
        simple: Strata Logging Service threat logs search results
      customfields: {}
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: 70857f98-123d-4ce5-839c-369b0ccb5457
    type: condition
    task:
      id: 70857f98-123d-4ce5-839c-369b0ccb5457
      version: -1
      name: Is hash detected by Strata Logging Service Threat logs?
      description: Is the hash detected by Strata Logging Service Threat logs?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "4"
      "yes":
      - "94"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: inList
          left:
            value:
              simple: inputs.SHA256
            iscontext: true
          right:
            value:
              simple: CDL.Logging.Threat.FileSHA256
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1220,
          "y": 1610
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "55":
    id: "55"
    taskid: 84c08f15-90e2-4c85-8d4e-4002ef2509bf
    type: title
    task:
      id: 84c08f15-90e2-4c85-8d4e-4002ef2509bf
      version: -1
      name: Domain/Url hunting done
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "153"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2440,
          "y": 2715
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    id: "61"
    taskid: 36f20578-0fb4-491e-8604-b42ea3277700
    type: regular
    task:
      id: 36f20578-0fb4-491e-8604-b42ea3277700
      version: -1
      name: Search domain in Strata Logging Service URL logs
      description: Searches the Strata Logging Service URL log table.
      script: '|||cdl-query-url-logs'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "85"
    scriptarguments:
      fields:
        simple: all
      url:
        complex:
          root: inputs.URLDomain
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 4210,
          "y": 1360
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    continueonerrortype: ""
    evidencedata:
      description:
        simple: Strata Logging Service URL logs search results
      customfields: {}
    isoversize: false
    isautoswitchedtoquietmode: false
  "64":
    id: "64"
    taskid: bbc9bcbd-fbd1-4c23-8fea-a582c9ea7a4b
    type: regular
    task:
      id: bbc9bcbd-fbd1-4c23-8fea-a582c9ea7a4b
      version: -1
      name: Set detected IPs
      description: Set a value in context under the key you entered. If no value is entered, the script doesn't run.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "164"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: PANWHunting.DetectedIPs
      value:
        complex:
          root: CDL
          accessor: Logging.URL.SourceIP
          transformers:
          - operator: append
            args:
              item:
                value:
                  simple: CDL.Logging.URL.DestinationIP
                iscontext: true
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 4050,
          "y": 1930
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "65":
    id: "65"
    taskid: 940cb3ab-a2ab-462f-8b23-e4d5d84bd262
    type: regular
    task:
      id: 940cb3ab-a2ab-462f-8b23-e4d5d84bd262
      version: -1
      name: Set detected users
      description: Set a value in context under the key you entered. If no value is entered, the script doesn't run.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "55"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: PANWHunting.DetectedUsers
      value:
        complex:
          root: CDL
          accessor: Logging.URL.SrcUser
          transformers:
          - operator: append
            args:
              item:
                value:
                  simple: CDL.Logging.URL.DstUser
                iscontext: true
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 4050,
          "y": 2300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "66":
    id: "66"
    taskid: 8f36d29e-53a8-40a4-819d-20d9c9dfff34
    type: condition
    task:
      id: 8f36d29e-53a8-40a4-819d-20d9c9dfff34
      version: -1
      name: Is Panorama enabled?
      description: Is Panorama enabled?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "23"
      "yes":
      - "140"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: modules
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: modules.brand
                      iscontext: true
                    right:
                      value:
                        simple: Panorama
                - - operator: isEqualString
                    left:
                      value:
                        simple: modules.state
                      iscontext: true
                    right:
                      value:
                        simple: active
            iscontext: true
    view: |-
      {
        "position": {
          "x": -3820,
          "y": 1095
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "67":
    id: "67"
    taskid: 5ca2f308-313c-4513-8290-bb4d50a3fa00
    type: condition
    task:
      id: 5ca2f308-313c-4513-8290-bb4d50a3fa00
      version: -1
      name: Is Panorama enabled?
      description: Is Panorama enabled?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "55"
      "yes":
      - "142"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: modules
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: modules.brand
                      iscontext: true
                    right:
                      value:
                        simple: Panorama
                - - operator: isEqualString
                    left:
                      value:
                        simple: modules.state
                      iscontext: true
                    right:
                      value:
                        simple: active
            iscontext: true
    view: |-
      {
        "position": {
          "x": 3310,
          "y": 1190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "68":
    id: "68"
    taskid: 5c3e164b-98bf-4b51-808b-7595db30a868
    type: condition
    task:
      id: 5c3e164b-98bf-4b51-808b-7595db30a868
      version: -1
      name: Is Autofocus enabled?
      description: Is Autofocus enabled?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "4"
      "yes":
      - "99"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: modules
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: modules.brand
                      iscontext: true
                    right:
                      value:
                        simple: AutoFocus V2
                - - operator: isEqualString
                    left:
                      value:
                        simple: modules.state
                      iscontext: true
                    right:
                      value:
                        simple: active
            iscontext: true
    view: |-
      {
        "position": {
          "x": 670,
          "y": 1090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "69":
    id: "69"
    taskid: 38c609ba-71d2-4578-8127-66d187c1d5a5
    type: condition
    task:
      id: 38c609ba-71d2-4578-8127-66d187c1d5a5
      version: -1
      name: Is Autofocus enabled?
      description: Is Autofocus enabled?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "55"
      "yes":
      - "101"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: modules
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: modules.brand
                      iscontext: true
                    right:
                      value:
                        simple: AutoFocus V2
                - - operator: isEqualString
                    left:
                      value:
                        simple: modules.state
                      iscontext: true
                    right:
                      value:
                        simple: active
            iscontext: true
    view: |-
      {
        "position": {
          "x": 4710,
          "y": 1170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "70":
    id: "70"
    taskid: fb2fc09c-71c0-4a5f-8c6f-bc1390d6ad43
    type: condition
    task:
      id: fb2fc09c-71c0-4a5f-8c6f-bc1390d6ad43
      version: -1
      name: Is Strata Logging Service enabled?
      description: Is Strata Logging Service enabled?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "23"
      "yes":
      - "30"
      - "25"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: modules
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: modules.brand
                      iscontext: true
                    right:
                      value:
                        simple: Cortex Data Lake
                - - operator: isEqualString
                    left:
                      value:
                        simple: modules.state
                      iscontext: true
                    right:
                      value:
                        simple: active
            iscontext: true
    view: |-
      {
        "position": {
          "x": -2620,
          "y": 1100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "71":
    id: "71"
    taskid: 3d0b0175-d39a-41f7-80c8-39ad83ce6402
    type: condition
    task:
      id: 3d0b0175-d39a-41f7-80c8-39ad83ce6402
      version: -1
      name: Is Strata Logging Service enabled?
      description: Is Strata Logging Service enabled?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "4"
      "yes":
      - "47"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: modules
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: modules.brand
                      iscontext: true
                    right:
                      value:
                        simple: Cortex Data Lake
                - - operator: isEqualString
                    left:
                      value:
                        simple: modules.state
                      iscontext: true
                    right:
                      value:
                        simple: active
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1110,
          "y": 1090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "72":
    id: "72"
    taskid: 38938eae-d197-4b34-8ad1-835b8ac3c77f
    type: regular
    task:
      id: 38938eae-d197-4b34-8ad1-835b8ac3c77f
      version: -1
      name: Set detected IPs
      description: Set a value in context under the key you entered. If no value is entered, the script doesn't run.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: PANWHunting.DetectedIPs
      value:
        complex:
          root: ${AutoFocus
          accessor: SessionsResults.src_ip}
          transformers:
          - operator: append
            args:
              item:
                value:
                  simple: ${AutoFocus.SessionsResults.dst_ip}
                iscontext: true
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 590,
          "y": 1950
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "80":
    id: "80"
    taskid: 02bdd4c9-a777-4aac-8309-87825430c2aa
    type: regular
    task:
      id: 02bdd4c9-a777-4aac-8309-87825430c2aa
      version: -1
      name: Set detected users
      description: Set a value in context under the key you entered. If no value is entered, the script doesn't run.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: PANWHunting.DetectedUsers
      value:
        complex:
          root: CDL
          filters:
          - - operator: match
              left:
                value:
                  simple: CDL.Logging.Threat.Users
                iscontext: true
              right:
                value:
                  simple: (?!\b(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(?:\[\.\]|\.)){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\b)
          accessor: Logging.Threat.Users
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1220,
          "y": 2480
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "81":
    id: "81"
    taskid: 8ca7216e-47f5-4f0a-8104-e8d3b486d356
    type: regular
    task:
      id: 8ca7216e-47f5-4f0a-8104-e8d3b486d356
      version: -1
      name: Set detected IPs
      description: Set a value in context under the key you entered. If no value is entered, the script doesn't run.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "97"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: PANWHunting.DetectedIPs
      value:
        complex:
          root: Panorama
          accessor: Monitor.Logs.SourceAddress
          transformers:
          - operator: append
            args:
              item:
                value:
                  simple: Panorama.Monitor.Logs.DestinationAddress
                iscontext: true
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -300,
          "y": 2220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "82":
    id: "82"
    taskid: 451306d0-c373-4707-80a9-c3be35f72671
    type: condition
    task:
      id: 451306d0-c373-4707-80a9-c3be35f72671
      version: -1
      name: Is hash detected by Panorama Wildfire?
      description: Is the hash detected by Panorama Wildfire?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "4"
      "yes":
      - "81"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Panorama
                filters:
                - - operator: isNotEmpty
                    left:
                      value:
                        simple: Panorama.Monitor.Logs.DestinationAddress
                      iscontext: true
                  - operator: isNotEmpty
                    left:
                      value:
                        simple: Panorama.Monitor.Logs.SourceAddress
                      iscontext: true
                accessor: Monitor.Logs.DestinationAddress
                transformers:
                - operator: append
                  args:
                    item:
                      value:
                        simple: Panorama.Monitor.Logs.DestinationAddress
                      iscontext: true
                - operator: uniq
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -270,
          "y": 1910
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "83":
    id: "83"
    taskid: f57f5c5b-d440-4847-85cf-996b9bbbaad7
    type: regular
    task:
      id: f57f5c5b-d440-4847-85cf-996b9bbbaad7
      version: -1
      name: Set detected IPs
      description: Set a value in context under the key you entered. If no value is entered, the script doesn't run.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "55"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: detecteddestinationsips
      value:
        complex:
          root: ${AutoFocus
          accessor: SessionsResults.dst_ip}
          transformers:
          - operator: append
            args:
              item:
                value:
                  simple: ${AutoFocus.SessionsResults.dst_ip}
                iscontext: true
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 5270,
          "y": 1825
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "84":
    id: "84"
    taskid: 9c33eecb-7e04-476f-8042-df44b73456f5
    type: condition
    task:
      id: 9c33eecb-7e04-476f-8042-df44b73456f5
      version: -1
      name: Are there related sessions in Autofocus?
      description: Are there related sessions in Autofocus?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "55"
      "yes":
      - "83"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: AutoFocus.SessionsResults.dst_ip
            iscontext: true
        - operator: isNotEmpty
          left:
            value:
              simple: AutoFocus.SessionsResults.src_ip
            iscontext: true
    view: |-
      {
        "position": {
          "x": 4990,
          "y": 1610
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "85":
    id: "85"
    taskid: 61c46324-3bf4-4bbe-810a-1b8619d74ba6
    type: condition
    task:
      id: 61c46324-3bf4-4bbe-810a-1b8619d74ba6
      version: -1
      name: Is domain detected by Strata Logging Service URL logs?
      description: Is the domain detected by Strata Logging Service URL logs?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "55"
      "yes":
      - "64"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: CDL.Logging.URL
            iscontext: true
    view: |-
      {
        "position": {
          "x": 4050,
          "y": 1610
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "86":
    id: "86"
    taskid: f3a9c2a6-45f0-421c-8cb4-71042f5f134a
    type: regular
    task:
      id: f3a9c2a6-45f0-421c-8cb4-71042f5f134a
      version: -1
      name: Set detected IPs
      description: Set a value in context under the key you entered. If no value is entered, the script doesn't run.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: PANWHunting.DetectedIPs
      value:
        complex:
          root: ${AutoFocus
          accessor: SessionsResults.src_ip}
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1230,
          "y": 2155
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "90":
    id: "90"
    taskid: 3a493326-906a-43e6-85dc-d8a0c428818c
    type: title
    task:
      id: 3a493326-906a-43e6-85dc-d8a0c428818c
      version: -1
      name: Strata Logging Service IP searches
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "70"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -2620,
          "y": 910
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "92":
    id: "92"
    taskid: 067f91b0-9593-4a0f-857e-cd712daec23e
    type: condition
    task:
      id: 067f91b0-9593-4a0f-857e-cd712daec23e
      version: -1
      name: Is Strata Logging Service enabled?
      description: Is Strata Logging Service enabled?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "55"
      "yes":
      - "61"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: modules
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: modules.brand
                      iscontext: true
                    right:
                      value:
                        simple: Cortex Data Lake
                - - operator: isEqualString
                    left:
                      value:
                        simple: modules.state
                      iscontext: true
                    right:
                      value:
                        simple: active
            iscontext: true
    view: |-
      {
        "position": {
          "x": 4050,
          "y": 1170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "93":
    id: "93"
    taskid: 99bd8837-39bf-484e-867d-d55a6dce53e0
    type: title
    task:
      id: 99bd8837-39bf-484e-867d-d55a6dce53e0
      version: -1
      name: Strata Logging Service domain search
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "92"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 4050,
          "y": 1025
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "94":
    id: "94"
    taskid: 059eba21-9993-490a-8c2a-8e1a08aaca2c
    type: regular
    task:
      id: 059eba21-9993-490a-8c2a-8e1a08aaca2c
      version: -1
      name: Set detected IPs
      description: Set a value in context under the key you entered. If no value is entered, the script doesn't run.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "163"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: PANWHunting.DetectedIPs
      value:
        complex:
          root: CDL
          accessor: Logging.Threat.SourceIP
          transformers:
          - operator: append
            args:
              item:
                value:
                  simple: CDL.Logging.Threat.DestinationIP
                iscontext: true
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1220,
          "y": 1960
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "96":
    id: "96"
    taskid: 8f850785-2523-4821-8a1c-0e8a9e66a266
    type: title
    task:
      id: 8f850785-2523-4821-8a1c-0e8a9e66a266
      version: -1
      name: PAN-OS hash search
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "35"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -270,
          "y": 920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "97":
    id: "97"
    taskid: 20ea7647-9e20-42ca-8452-1631b2c9d24e
    type: regular
    task:
      id: 20ea7647-9e20-42ca-8452-1631b2c9d24e
      version: -1
      name: Set detected users
      description: Set a value in context under the key you entered. If no value is entered, the script doesn't run.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: PANWHunting.DetectedUsers
      value:
        complex:
          root: Panorama
          accessor: Monitor.Logs.DestinationUser
          transformers:
          - operator: append
            args:
              item:
                value:
                  simple: Panorama.Monitor.Logs.SourceUser
                iscontext: true
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -300,
          "y": 2480
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "99":
    id: "99"
    taskid: c537fc45-5e32-4933-8e7a-bd8f11b78b77
    type: playbook
    task:
      id: c537fc45-5e32-4933-8e7a-bd8f11b78b77
      version: -1
      name: Autofocus Query Samples, Sessions and Tags
      description: |-
        This playbook is used for querying the PANW threat intelligence Autofocus system. The playbook accepts indicators such as IPs, hashes, and domains to run basic queries or advanced queries that can leverage several query parameters. To run advanced queries, we recommend first using the Autofocus UI https://autofocus.paloaltonetworks.com/#/dashboard/organization to create a query and than use the export search button. The result can be used as a playbook input.

        The playbook supports searching both the Samples API and the Sessions API.
      playbookName: Autofocus Query Samples, Sessions and Tags
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "43"
    scriptarguments:
      Hash:
        complex:
          root: File
          accessor: SHA256
          transformers:
          - operator: toUpperCase
          - operator: uniq
          - operator: join
            args:
              separator:
                value:
                  simple: ','
      Search Type:
        simple: session
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 590,
          "y": 1350
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "100":
    id: "100"
    taskid: ba675c58-ac65-4301-8335-c618d772b2d6
    type: playbook
    task:
      id: ba675c58-ac65-4301-8335-c618d772b2d6
      version: -1
      name: Autofocus Query Samples, Sessions and Tags
      playbookName: Autofocus Query Samples, Sessions and Tags
      type: playbook
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "21"
    scriptarguments:
      IP:
        complex:
          root: inputs.IPAddresses
          transformers:
          - operator: uniq
          - operator: join
            args:
              separator:
                value:
                  simple: ','
      Search Type:
        simple: session
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": -1230,
          "y": 1545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "101":
    id: "101"
    taskid: 2eb947e7-5df0-4696-8af5-c69e58297b02
    type: playbook
    task:
      id: 2eb947e7-5df0-4696-8af5-c69e58297b02
      version: -1
      name: Autofocus Query Samples, Sessions and Tags
      playbookName: Autofocus Query Samples, Sessions and Tags
      type: playbook
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "84"
    scriptarguments:
      Search Type:
        simple: session
      URL:
        complex:
          root: inputs.URLDomain
          transformers:
          - operator: uniq
          - operator: join
            args:
              separator:
                value:
                  simple: ','
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 4990,
          "y": 1360
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "104":
    id: "104"
    taskid: 0875678b-51fb-4d3c-8882-37861c5120dd
    type: condition
    task:
      id: 0875678b-51fb-4d3c-8882-37861c5120dd
      version: -1
      name: Are there Pan-OS search results?
      description: Are there relevant IPs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "55"
      "yes":
      - "105"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Panorama
                accessor: Monitor.Logs
            iscontext: true
    view: |-
      {
        "position": {
          "x": 3370,
          "y": 1735
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "105":
    id: "105"
    taskid: f6eaa5f8-c04a-4a24-8ed5-6c76ee2c8f39
    type: regular
    task:
      id: f6eaa5f8-c04a-4a24-8ed5-6c76ee2c8f39
      version: -1
      name: Set detected IPs
      description: Set a value in context under the key you entered. If no value is entered, the script doesn't run.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "107"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: PANWHunting.DetectedIPs
      value:
        complex:
          root: Panorama
          accessor: Monitor.Logs.SourceAddress
          transformers:
          - operator: append
            args:
              item:
                value:
                  simple: Panorama.Monitor.Logs.DestinationAddress
                iscontext: true
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 3370,
          "y": 2060
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "107":
    id: "107"
    taskid: ed78b99c-85e3-4659-87dc-9440b3d2dfbf
    type: regular
    task:
      id: ed78b99c-85e3-4659-87dc-9440b3d2dfbf
      version: -1
      name: Set detected users
      description: Set a value in context under the key you entered. If no value is entered, the script doesn't run.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "55"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: PANWHunting.DetectedUsers
      value:
        complex:
          root: Panorama
          accessor: Monitor.Logs.DestinationUser
          transformers:
          - operator: append
            args:
              item:
                value:
                  simple: Panorama.Monitor.Logs.SourceUser
                iscontext: true
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2280,
          "y": 2445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "108":
    id: "108"
    taskid: bf03de85-aaf8-41d4-81f7-7f5ca5814ee0
    type: title
    task:
      id: bf03de85-aaf8-41d4-81f7-7f5ca5814ee0
      version: -1
      name: Autofocus hash search
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "68"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 670,
          "y": 920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "109":
    id: "109"
    taskid: c35b5e37-813f-472e-8ec8-ee41b091b463
    type: title
    task:
      id: c35b5e37-813f-472e-8ec8-ee41b091b463
      version: -1
      name: Strata Logging Service hash search
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "71"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1110,
          "y": 920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "110":
    id: "110"
    taskid: 6d241144-3dc7-40c1-8b2d-f01d3bb9c9aa
    type: title
    task:
      id: 6d241144-3dc7-40c1-8b2d-f01d3bb9c9aa
      version: -1
      name: Autofocus domain search
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "69"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 4710,
          "y": 1025
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "111":
    id: "111"
    taskid: 3d88479c-bc21-4821-812a-d9d3027ea6d6
    type: title
    task:
      id: 3d88479c-bc21-4821-812a-d9d3027ea6d6
      version: -1
      name: PAN-OS domain/url search
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "67"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 3310,
          "y": 1025
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "112":
    id: "112"
    taskid: 346194fe-e8bb-4833-8388-75cc8d787238
    type: title
    task:
      id: 346194fe-e8bb-4833-8388-75cc8d787238
      version: -1
      name: Autofocus IP seach
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "18"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1230,
          "y": 910
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "113":
    id: "113"
    taskid: 80c54910-0a39-49c2-882a-0ffa04b79371
    type: title
    task:
      id: 80c54910-0a39-49c2-882a-0ffa04b79371
      version: -1
      name: PAN-OS IP search
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "66"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -3820,
          "y": 910
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "129":
    id: "129"
    taskid: 0e1d4ac9-fbf3-4d7c-86ea-c3a38d79b42f
    type: condition
    task:
      id: 0e1d4ac9-fbf3-4d7c-86ea-c3a38d79b42f
      version: -1
      name: Are there relevant IPs?
      description: Are there relevant IP's
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "23"
      "yes":
      - "136"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Panorama
                accessor: Monitor.Logs.DestinationAddress
            iscontext: true
          right:
            value: {}
        - operator: isNotEmpty
          left:
            value:
              complex:
                root: Panorama
                accessor: Monitor.Logs.SourceAddress
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -4060,
          "y": 1695
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "132":
    id: "132"
    taskid: aebbada3-8599-4fab-868d-d30c1792cdf9
    type: regular
    task:
      id: aebbada3-8599-4fab-868d-d30c1792cdf9
      version: -1
      name: Set detected users
      description: Set a value in context under the key you entered. If no value is entered, the script doesn't run.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: PANWHunting.DetectedUsers
      value:
        complex:
          root: Panorama
          accessor: Monitor.Logs.DestinationUser
          transformers:
          - operator: append
            args:
              item:
                value:
                  simple: Panorama.Monitor.Logs.SourceUser
                iscontext: true
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -4260,
          "y": 2360
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "136":
    id: "136"
    taskid: 13f7fc7e-1933-456d-8153-eedac64f8e2a
    type: regular
    task:
      id: 13f7fc7e-1933-456d-8153-eedac64f8e2a
      version: -1
      name: Set detected IPs
      description: Set a value in context under the key you entered. If no value is entered, the script doesn't run.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "132"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: PANWHunting.DetectedIPs
      value:
        complex:
          root: Panorama
          accessor: Monitor.Logs.SourceAddress
          transformers:
          - operator: append
            args:
              item:
                value:
                  simple: Panorama.Monitor.Logs.DestinationAddress
                iscontext: true
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -4260,
          "y": 2005
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "140":
    id: "140"
    taskid: 273e49e6-6789-4a94-8cb3-ae4fc8cd77ba
    type: playbook
    task:
      id: 273e49e6-6789-4a94-8cb3-ae4fc8cd77ba
      version: -1
      name: PAN-OS Query Logs For Indicators
      playbookName: PAN-OS Query Logs For Indicators
      type: playbook
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "129"
    scriptarguments:
      ip:
        complex:
          root: inputs.IPAddresses
          transformers:
          - operator: uniq
          - operator: join
            args:
              separator:
                value:
                  simple: ','
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": -4060,
          "y": 1350
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "141":
    id: "141"
    taskid: 338e1c6d-6211-4b2b-8451-a3866009d5f9
    type: playbook
    task:
      id: 338e1c6d-6211-4b2b-8451-a3866009d5f9
      version: -1
      name: PAN-OS Query Logs For Indicators
      playbookName: PAN-OS Query Logs For Indicators
      type: playbook
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "82"
    scriptarguments:
      filedigest:
        complex:
          root: File
          accessor: SHA256
          transformers:
          - operator: uniq
          - operator: join
            args:
              separator:
                value:
                  simple: ','
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": -270,
          "y": 1745
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "142":
    id: "142"
    taskid: 474cedfa-d0a3-4d70-860e-665c94e1e48b
    type: playbook
    task:
      id: 474cedfa-d0a3-4d70-860e-665c94e1e48b
      version: -1
      name: PAN-OS Query Logs For Indicators
      playbookName: PAN-OS Query Logs For Indicators
      type: playbook
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "104"
    scriptarguments:
      url:
        complex:
          root: inputs.URLDomain
          transformers:
          - operator: uniq
          - operator: join
            args:
              separator:
                value:
                  simple: ','
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 3370,
          "y": 1530
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "153":
    id: "153"
    taskid: 382d70fe-526c-496f-8d18-e2f5f338c5f2
    type: title
    task:
      id: 382d70fe-526c-496f-8d18-e2f5f338c5f2
      version: -1
      name: Sort results
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "166"
      - "167"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 900,
          "y": 3090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "154":
    id: "154"
    taskid: 6c2a64aa-076a-4007-8cb8-65cffd4a588a
    type: condition
    task:
      id: 6c2a64aa-076a-4007-8cb8-65cffd4a588a
      version: -1
      name: Are there detected IP addresses?
      description: Are there detected IP addresses?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "155"
      "yes":
      - "156"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PANWHunting.DetectedIPs
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1250,
          "y": 3370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "155":
    id: "155"
    taskid: be26c6c7-7a52-4aa5-8b33-bfdcaa92ac5c
    type: title
    task:
      id: be26c6c7-7a52-4aa5-8b33-bfdcaa92ac5c
      version: -1
      name: Done sorting IP addresses
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "169"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1250,
          "y": 4245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "156":
    id: "156"
    taskid: be19db5f-10f8-40f3-8eea-c7ddb40f3b0a
    type: regular
    task:
      id: be19db5f-10f8-40f3-8eea-c7ddb40f3b0a
      version: -1
      name: Determine whether the IP address is internal or external
      description: Returns yes if the IP is in one of the ranges provided, returns no otherwise.
      scriptName: IsIPInRanges
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "157"
    scriptarguments:
      ip:
        simple: ${PANWHunting.DetectedIPs}
      ipRanges:
        simple: ${inputs.InternalRange}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1490,
          "y": 3540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "157":
    id: "157"
    taskid: 81e6910a-e975-4c4e-8a56-e1e696fe617d
    type: regular
    task:
      id: 81e6910a-e975-4c4e-8a56-e1e696fe617d
      version: -1
      name: Set detected IP addresses as internal
      description: Set a value in context under the key you entered. If no value is entered, the script doesn't run.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "158"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: PANWHunting.DetectedInternalIPs
      value:
        complex:
          root: IP
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: IP.InRange
                iscontext: true
              right:
                value:
                  simple: "yes"
          accessor: Address
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1490,
          "y": 3790
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "158":
    id: "158"
    taskid: 5c171b1f-1edc-4404-831d-f029dcd9e57f
    type: regular
    task:
      id: 5c171b1f-1edc-4404-831d-f029dcd9e57f
      version: -1
      name: Set detected IP addresses as external
      description: Set a value in context under the key you entered. If no value is entered, the script doesn't run.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "155"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: PANWHunting.DetectedExternalIPs
      value:
        complex:
          root: IP
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: IP.InRange
                iscontext: true
              right:
                value:
                  simple: "no"
          accessor: Address
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1490,
          "y": 4010
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "159":
    id: "159"
    taskid: 8636b5c9-c31e-465b-87ab-d36980dc2b49
    type: regular
    task:
      id: 8636b5c9-c31e-465b-87ab-d36980dc2b49
      version: -1
      name: Set detected IPs
      description: Set a value in context under the key you entered. If no value is entered, the script doesn't run.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "162"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: PANWHunting.DetectedIPs
      value:
        complex:
          root: CDL
          accessor: Logging.Traffic.SourceIP
          transformers:
          - operator: append
            args:
              item:
                value:
                  simple: CDL.Logging.Threat.DestinationIP
                iscontext: true
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -2320,
          "y": 1940
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "160":
    id: "160"
    taskid: 5def5f66-3f4a-4f80-8fbe-d2897f117050
    type: regular
    task:
      id: 5def5f66-3f4a-4f80-8fbe-d2897f117050
      version: -1
      name: Set detected users
      description: Set a value in context under the key you entered. If no value is entered, the script doesn't run.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      key:
        simple: PANWHunting.DetectedUsers
      value:
        complex:
          root: CDL
          filters:
          - - operator: match
              left:
                value:
                  simple: CDL.Logging.Traffic.Users
                iscontext: true
              right:
                value:
                  simple: (?!\b(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(?:\[\.\]|\.)){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\b)
          accessor: Logging.Traffic.Users
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -2320,
          "y": 2410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "161":
    id: "161"
    taskid: 41a69d1b-1b4b-45fb-871f-089026fa2888
    type: regular
    task:
      id: 41a69d1b-1b4b-45fb-871f-089026fa2888
      version: -1
      name: Set detected hosts
      description: Set a value in context under the key you entered. If no value is entered, the script doesn't run.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: PANWHunting.DetectedHosts
      value:
        complex:
          root: CDL
          accessor: Logging.Threat.SourceDeviceHost
          transformers:
          - operator: append
            args:
              item:
                value:
                  simple: CDL.Logging.Threat.DestDeviceHost
                iscontext: true
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -3370,
          "y": 2170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "162":
    id: "162"
    taskid: 84a23cb9-81d6-439a-84ee-a260e82ad5a8
    type: regular
    task:
      id: 84a23cb9-81d6-439a-84ee-a260e82ad5a8
      version: -1
      name: Set detected hosts
      description: Set a value in context under the key you entered. If no value is entered, the script doesn't run.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "160"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: PANWHunting.DetectedHosts
      value:
        complex:
          root: CDL
          accessor: Logging.Traffic.SourceDeviceHost
          transformers:
          - operator: append
            args:
              item:
                value:
                  simple: CDL.Logging.Traffic.DestDeviceHost
                iscontext: true
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -2320,
          "y": 2170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "163":
    id: "163"
    taskid: 0a357f18-a20e-4707-8655-c6f1abf070bf
    type: regular
    task:
      id: 0a357f18-a20e-4707-8655-c6f1abf070bf
      version: -1
      name: Set detected hosts
      description: Set a value in context under the key you entered. If no value is entered, the script doesn't run.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "80"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: PANWHunting.DetectedHosts
      value:
        complex:
          root: CDL
          accessor: Logging.Threat.SourceDeviceHost
          transformers:
          - operator: append
            args:
              item:
                value:
                  simple: CDL.Logging.Threat.DestDeviceHost
                iscontext: true
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1220,
          "y": 2220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "164":
    id: "164"
    taskid: ed9a77e6-32a8-4ee4-89bc-2e66f6bd0698
    type: regular
    task:
      id: ed9a77e6-32a8-4ee4-89bc-2e66f6bd0698
      version: -1
      name: Set detected hosts
      description: Set a value in context under the key you entered. If no value is entered, the script doesn't run.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "65"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: PANWHunting.DetectedHosts
      value:
        complex:
          root: CDL
          accessor: Logging.URL.SourceDeviceHost
          transformers:
          - operator: append
            args:
              item:
                value:
                  simple: CDL.Logging.URL.DestDeviceHost
                iscontext: true
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 4050,
          "y": 2105
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "165":
    id: "165"
    taskid: 4c4def01-9539-45c9-8f4d-76367c796741
    type: condition
    task:
      id: 4c4def01-9539-45c9-8f4d-76367c796741
      version: -1
      name: Are there detected host names?
      type: condition
      description: Are there detected host names?
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "168"
      "yes":
      - "173"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PANWHunting.DetectedHosts
            iscontext: true
    view: |-
      {
        "position": {
          "x": 570,
          "y": 3370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "166":
    id: "166"
    taskid: 862f2b4a-cce5-4a30-8c75-4d1d3462e39e
    type: title
    task:
      id: 862f2b4a-cce5-4a30-8c75-4d1d3462e39e
      version: -1
      name: Sort internal and external IP addresses
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "154"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1250,
          "y": 3230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "167":
    id: "167"
    taskid: 453ba73b-e72a-4d4d-8e58-90fbb6b321d9
    type: title
    task:
      id: 453ba73b-e72a-4d4d-8e58-90fbb6b321d9
      version: -1
      name: Sort internal and external host names
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "165"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 570,
          "y": 3230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "168":
    id: "168"
    taskid: 4e6cdb41-535b-4c2b-8c73-460598245b11
    type: title
    task:
      id: 4e6cdb41-535b-4c2b-8c73-460598245b11
      version: -1
      name: Done sorting host names
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "169"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 570,
          "y": 4245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "169":
    id: "169"
    taskid: 7a083e57-9f8e-477b-8098-b4bdcee6d4f2
    type: title
    task:
      id: 7a083e57-9f8e-477b-8098-b4bdcee6d4f2
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 920,
          "y": 4400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "170":
    id: "170"
    taskid: 171610e5-c5b4-4f96-8bee-374e829810ca
    type: regular
    task:
      id: 171610e5-c5b4-4f96-8bee-374e829810ca
      version: -1
      name: Determine whether the host name is internal or external
      description: Checks if the supplied hostnames match either the organization's internal naming convention or the domain suffix.
      scriptName: IsInternalHostName
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "171"
    scriptarguments:
      domainName:
        simple: ${inputs.InternalDomainName}
      hostName:
        complex:
          root: PANWHunting
          accessor: DetectedHosts
          transformers:
          - operator: uniq
      internalRegex:
        simple: ${inputs.InternalHostRegex}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -100,
          "y": 3750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "171":
    id: "171"
    taskid: b36c2d2e-e655-42cd-882e-1b94360f88a8
    type: regular
    task:
      id: b36c2d2e-e655-42cd-882e-1b94360f88a8
      version: -1
      name: Set detected host names as internal
      description: Set a value in context under the key you entered. If no value is entered, the script doesn't run.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "172"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: PANWHunting.DetectedInternalHosts
      value:
        complex:
          root: Endpoint
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: Endpoint.IsInternal
                iscontext: true
              right:
                value:
                  simple: "true"
          accessor: Hostname
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -100,
          "y": 3895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "172":
    id: "172"
    taskid: 38f7b2e5-2e9f-4497-88b0-deb234b95eed
    type: regular
    task:
      id: 38f7b2e5-2e9f-4497-88b0-deb234b95eed
      version: -1
      name: Set detected host names as external
      description: Set a value in context under the key you entered. If no value is entered, the script doesn't run.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "168"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: PANWHunting.DetectedExternalHosts
      value:
        complex:
          root: Endpoint
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: Endpoint.IsInternal
                iscontext: true
              right:
                value:
                  simple: "false"
          accessor: Hostname
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -100,
          "y": 4070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "173":
    id: "173"
    taskid: ba6b97e9-3769-4e1d-8aa4-730142613533
    type: condition
    task:
      id: ba6b97e9-3769-4e1d-8aa4-730142613533
      version: -1
      name: Has the domain name been provided?
      description: Has the domain name been provided?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "174"
      "yes":
      - "170"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: inputs.InternalDomainName
            iscontext: true
    view: |-
      {
        "position": {
          "x": 330,
          "y": 3540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "174":
    id: "174"
    taskid: 9c90d795-19b6-42a6-8dc4-5792e7af2e0e
    type: regular
    task:
      id: 9c90d795-19b6-42a6-8dc4-5792e7af2e0e
      version: -1
      name: Set detected host names as internal
      description: Set a value in context under the key you entered. If no value is entered, the script doesn't run.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "168"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: PANWHunting.DetectedInternalHosts
      value:
        simple: ${PANWHunting.DetectedHosts}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 330,
          "y": 3750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "175":
    id: "175"
    taskid: 90434b05-2785-4f62-8592-969be678a1dc
    type: title
    task:
      id: 90434b05-2785-4f62-8592-969be678a1dc
      version: -1
      name: Cortex XDR hash search
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "182"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1680,
          "y": 920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "177":
    id: "177"
    taskid: 2661d1f8-17f1-4fcd-8729-13d47ba43311
    type: regular
    task:
      id: 2661d1f8-17f1-4fcd-8729-13d47ba43311
      version: -1
      name: Search for the hash in alerts
      description: "Returns a list of alerts and their metadata, which you can filter by built-in arguments or use the custom_filter to input a JSON filter object. \nMultiple filter arguments are concatenated using the AND operator, while arguments that support a comma-separated list of values use an OR operator between each value."
      script: '|||xdr-get-alerts'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "178"
    scriptarguments:
      actor_process_image_sha256:
        complex:
          root: inputs.SHA256
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1940,
          "y": 1285
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "178":
    id: "178"
    taskid: b7b37a2f-a6ac-4c05-8588-daee3fc696b5
    type: condition
    task:
      id: b7b37a2f-a6ac-4c05-8588-daee3fc696b5
      version: -1
      name: Is the hash detected by Cortex XDR?
      type: condition
      iscommand: false
      brand: ""
      description: ""
    nexttasks:
      '#default#':
      - "4"
      "yes":
      - "179"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.Alert
                accessor: internal_id
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1940,
          "y": 1505
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "179":
    id: "179"
    taskid: d352ae69-ed2f-40c7-87e8-b8b33e48bbb4
    type: regular
    task:
      id: d352ae69-ed2f-40c7-87e8-b8b33e48bbb4
      version: -1
      name: Set Cortex XDR agent detected IP's
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't run.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Administrator-Guide/Scripts
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: PANWHunting.DetectedIPs
      value:
        complex:
          root: PaloAltoNetworksXDR.Alert
          accessor: agent_ip_addresses
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2200,
          "y": 1695
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "182":
    id: "182"
    taskid: 5a14ea5b-907d-4925-8e96-b1a9430e15ab
    type: condition
    task:
      id: 5a14ea5b-907d-4925-8e96-b1a9430e15ab
      version: -1
      name: Is Cortex XDR is enabled?
      description: Returns 'yes' if integration brand is available. Otherwise returns 'no'.
      scriptName: IsIntegrationAvailable
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "4"
      "yes":
      - "177"
    scriptarguments:
      brandname:
        simple: Cortex XDR - IR
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1680,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "184":
    id: "184"
    taskid: b9ed484d-e2db-48bd-8e42-9b5d5aaf1180
    type: title
    task:
      id: b9ed484d-e2db-48bd-8e42-9b5d5aaf1180
      version: -1
      name: Prisma Cloud IP search
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "185"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -4690,
          "y": 910
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "185":
    id: "185"
    taskid: 1581d291-9a38-483e-842a-91aa3a4b7953
    type: condition
    task:
      id: 1581d291-9a38-483e-842a-91aa3a4b7953
      version: -1
      name: Is Prisma Cloud enabled?
      description: Returns 'yes' if integration brand is available. Otherwise returns 'no'.
      scriptName: IsIntegrationAvailable
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "23"
      "yes":
      - "186"
    scriptarguments:
      brandname:
        simple: PrismaCloud v2
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -4690,
          "y": 1075
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "186":
    id: "186"
    taskid: 468b88d6-259c-4857-8f97-aa65a5589357
    type: regular
    task:
      id: 468b88d6-259c-4857-8f97-aa65a5589357
      version: -1
      name: Prisma Cloud search IP
      description: 'Search networks inventory on the Prisma Cloud platform using RQL language. Use this command for all queries that start with "networks". When no absolute time nor relative time arguments are provided, the default time range is all times. To limit the results returned, use "limit search records to" at the end of the RQL query, followed by one of these values: 1, 10, 100, 1000, or 10,000.'
      script: '|||prisma-cloud-network-search'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "187"
    scriptarguments:
      query:
        complex:
          root: inputs.IPAddresses
          transformers:
          - operator: join
            args:
              separator:
                value:
                  simple: ','
          - operator: replace
            args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '['
          - operator: replace
            args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: ']'
          - operator: replace
            args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: '"'
          - operator: concat
            args:
              prefix:
                value:
                  simple: network from vpc.flow_record where source.ip in (
              suffix:
                value:
                  simple: )
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -4690,
          "y": 1350
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "187":
    id: "187"
    taskid: 14629675-a0f1-460b-8f0f-e9d91acead33
    type: condition
    task:
      id: 14629675-a0f1-460b-8f0f-e9d91acead33
      version: -1
      name: Are there any relevant IP's?
      type: condition
      iscommand: false
      brand: ""
      description: ""
    nexttasks:
      '#default#':
      - "23"
      "yes":
      - "188"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloud.Network.Node.ipAddr
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -4690,
          "y": 1585
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "188":
    id: "188"
    taskid: 5d9a51d2-a163-42c0-815c-cee12e656fcb
    type: regular
    task:
      id: 5d9a51d2-a163-42c0-815c-cee12e656fcb
      version: -1
      name: Set detected IPs
      description: Set a value in context under the key you entered. If no value is entered, the script doesn't run.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: PANWHunting.DetectedIPs
      value:
        complex:
          root: PrismaCloud.Network.Node
          accessor: ipAddr
          transformers:
          - operator: uniq
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -5050,
          "y": 2025
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "104_55_#default#": 0.19,
      "10_110_yes": 0.85,
      "10_55_#default#": 0.19,
      "129_23_#default#": 0.12,
      "178_4_#default#": 0.1,
      "182_4_#default#": 0.1,
      "185_23_#default#": 0.1,
      "187_188_yes": 0.46,
      "187_23_#default#": 0.1,
      "18_100_yes": 0.41,
      "18_23_#default#": 0.15,
      "21_23_#default#": 0.32,
      "21_86_yes": 0.41,
      "26_23_#default#": 0.11,
      "31_23_#default#": 0.12,
      "35_4_#default#": 0.42,
      "3_2_yes": 0.4,
      "3_4_#default#": 0.25,
      "43_4_#default#": 0.19,
      "48_4_#default#": 0.24,
      "5_112_yes": 0.49,
      "5_184_yes": 0.85,
      "5_23_#default#": 0.24,
      "66_23_#default#": 0.1,
      "67_55_#default#": 0.25,
      "68_4_#default#": 0.1,
      "69_55_#default#": 0.18,
      "70_23_#default#": 0.29,
      "82_4_#default#": 0.26,
      "84_55_#default#": 0.1,
      "85_55_#default#": 0.23,
      "92_55_#default#": 0.11
    },
    "paper": {
      "dimensions": {
        "height": 4455,
        "width": 10700,
        "x": -5050,
        "y": 10
      }
    }
  }
inputs:
- key: SHA256
  value: {}
  required: false
  description: SHA256 hash of the indicator to hunt.
  playbookInputQuery:
- key: MD5
  value: {}
  required: false
  description: MD5 hash of the indicator to hunt.
  playbookInputQuery:
- key: SHA1
  value: {}
  required: false
  description: SHA1 hash of the indicator to hunt.
  playbookInputQuery:
- key: IPAddresses
  value: {}
  required: false
  description: List of IP addresses.
  playbookInputQuery:
- key: URLDomain
  value: {}
  required: false
  description: List of domains or urls.
  playbookInputQuery:
- key: InternalRange
  value:
    complex:
      root: lists
      accessor: PrivateIPs
      transformers:
      - operator: RegexExtractAll
        args:
          error_if_no_match: {}
          ignore_case: {}
          multi_line: {}
          period_matches_newline: {}
          regex:
            value:
              simple: (\b(?:\d{1,3}\.){3}\d{1,3}\b/\d{1,2})
          unpack_matches: {}
      - operator: join
        args:
          separator:
            value:
              simple: ','
  required: false
  description: 'A list of internal IP ranges to check IP addresses against. The comma-separated list should be provided in CIDR notation. For example, a list of ranges would be: "172.16.0.0/12,10.0.0.0/8,192.168.0.0/16" (without quotes).'
  playbookInputQuery:
- key: InternalDomainName
  value: {}
  required: false
  description: The organizations internal domain name. This is provided for the script IsInternalHostName that checks if the detected host names are internal or external if the hosts contain the internal domains suffix. For example demisto.com. If there is more than one domain, use the | character to separate values such as (demisto.com|test.com)
  playbookInputQuery:
- key: InternalHostRegex
  value: {}
  required: false
  description: This is provided for the script IsInternalHostName that checks if the detected host names are internal or external. Checks if the hosts match the organization's naming convention. For example, the host testpc1 has the following regex \w{6}\d{1}
  playbookInputQuery:
outputs:
- contextPath: PANWHunting.DetectedUsers
  description: User or array of users that were detected during hunting.
  type: string
- contextPath: PANWHunting.DetectedInternalIPs
  description: Internal IP addresses detected based on fields and inputs in your search.
  type: string
- contextPath: PANWHunting.DetectedExternalIPs
  description: External IP addresses detected based on fields and inputs in your search.
  type: string
- contextPath: PANWHunting.DetectedInternalHosts
  description: Internal host names detected based on fields and inputs in your search.
  type: string
- contextPath: PANWHunting.DetectedExternalHosts
  description: External host names detected based on fields and inputs in your search.
  type: string
tests:
- No tests (auto formatted)
contentitemexportablefields:
  contentitemfields: {}
system: true
