category: Data Enrichment & Threat Intelligence
commonfields:
  id: Doppel
  version: -1
configuration:
- defaultvalue: https://<your-doppel-tenant>.com/
  display: Doppel tenant URL
  name: url
  required: true
  type: 0
- displaypassword: API Key
  additionalinfo: The API Key to use for connection with Doppel
  name: credentials
  required: true
  hiddenusername: true
  type: 9
description: 'Doppel is a Modern Digital Risk Protection Solution, that detects the phishing and brand cyber attacks on the emerging channels. Doppel scans millions of channels online which includes, social media, domains, paid ads, dark web, emerging channels, etc. Doppel can identify the malicious content and cyber threats, and enables their customers to take down the digital risks proactively. The XSOAR pack for Doppel provides mirrors the alerts created by Doppel as XSOAR incidents. The pack also contains the commands to perform different operations on Doppel alerts.'
display: Doppel
name: Doppel
script:
  commands:
  - name: get-alert
    description: 'Retrieves the alert details by ID or entity. Must include exactly one of either id or entity'
    arguments:
    - name: id
      description: 'The ID of the alert to retrieve details for'
      required: false
    - name: entity
      description: 'The alerted entity to retrieve details for'
      required: false
    outputs:
    - contextPath: Doppel.doppel_link
      description: 'Link to the alert in the Doppel portal'
      type: String

  - name: get-alerts
    description: Retrieves multiple alerts based on the query parameters provided.
        It includes metadata and details about each alert.
    arguments:
    - name: search_key
      description: Currently only supports search by url
      type: textArea
    - name: queue_state
      auto: PREDEFINED
      predefined:
      - actioned
      - needs_confirmation
      - doppel_review
      - monitoring
      - taken_down
      - archived
      description: New queue status to update alert with (id required)
    - name: product
      auto: PREDEFINED
      predefined:
      - domains
      - social_media
      - mobile_apps
      - ecommerce
      - crypto
      - emails
      - paid_adds
      description: Product category the report belongs to.
    - name: created_before
      description: Filter alerts created before this date. '2024-01-05T13:45:30' --
        Represents the 5th of January 2024, at 1:45:30 PM
      type: textArea
    - name: created_after
      description: Filter alerts created after this date. '2024-01-05T13:45:30' --
        Represents the 5th of January 2024, at 1:45:30 PM
      type: textArea
    - name: sort_type
      auto: PREDEFINED
      predefined:
      - date_sourced
      - date_last_actioned
      description: The field to sort the reports by. Defaults to date_sourced.
      type: textArea
    - name: sort_order
      auto: PREDEFINED
      predefined:
      - asc
      - desc
      description: The order to sort the reports by. Defaults to desc.
      type: textArea
    - name: page
      description: Page number for pagination; defaults to 0
      type: textArea
    - name: tags
      description: List of tags to filter alerts
      isArray: true
      type: textArea
    outputs:
    - contextPath: Doppel.GetAlerts
      

  - name: create-alert
    description: Creates an alert for a specified entity. This command requires the
      entity to be provided in the arguments.
    arguments:
    - name: entity
      required: true
      description: The entity for which the alert should be created.
    outputs:
    - contextPath: Doppel.CreatedAlert
      description: The details of the created alert, including its unique ID and other
        relevant metadata.
      type: string
    
  - name: create-abuse-alert
    description: Create an alert for the provided value to abuse box. Will fail if
      the alert value is invalid or is protected
    arguments:
    - name: entity
      required: true
      description: The entity for which the abuse alert should be created.
    outputs:
    - contextPath: Doppel.AbuseAlert
      description: The details of the created abuse alert, including its unique ID
        and other relevant metadata.
      type: string
  
    

  - name: update-alert
    description: Updates a alert in the system with certain parameters.
    arguments:
    - name: alert_id
      description: The id of the alert to update
    - name: entity
      description: The entity of the alert to update
      type: unknown
    - name: queue_state
      auto: PREDEFINED
      predefined:
      - doppel_review
      - actioned
      - needs_confirmation
      - monitoring
      - taken_down
      - archived
      description: Status of which queue the alert is in.
      type: textArea
    - name: entity_state
      auto: PREDEFINED
      predefined:
      - active
      - down
      - parked
      description: State of the alert.
      type: textArea
    outputs:
    - contextPath: Doppel.UpdatedAlert
      description: Provides details of the updated alert after modifying its queue_state
        and entity_state. The result confirms the success and updates made.
      type: unknown

  runonce: false
  script: '-'
  type: python
  subtype: python3
  dockerimage: demisto/python3:3.12.7.117934
fromversion: 5.5.0
tests:
- No tests (auto formatted)
