id: CrowdStrike Falcon - Block File
version: -1
name: CrowdStrike Falcon - Block File
description: "This playbook receives an MD5 or a SHA256 hash and adds it to the block list in CrowdStrike Falcon. \nThe playbook uses the integration \"CrowdStrike Falcon\"."
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 66384ed1-505c-46ae-85f0-fb9b5cf3f7b2
    type: start
    task:
      id: 66384ed1-505c-46ae-85f0-fb9b5cf3f7b2
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: bef2902b-79cf-4462-8e1b-b9bf6dca1640
    type: condition
    task:
      id: bef2902b-79cf-4462-8e1b-b9bf6dca1640
      version: -1
      name: 'Is CrowdStrike enabled? '
      description: Returns 'yes' if integration brand is available. Otherwise returns 'no'.
      scriptName: IsIntegrationAvailable
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "2"
      - "9"
    scriptarguments:
      brandname:
        simple: CrowdstrikeFalcon
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: 442ca757-69ea-4a11-80f2-37867008d80e
    type: condition
    task:
      id: 442ca757-69ea-4a11-80f2-37867008d80e
      version: -1
      name: Is there any MD5 to block?
      type: condition
      iscommand: false
      brand: ""
      description: ""
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "8"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: inputs.MD5
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 330,
          "y": 360
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: c81d3d82-1f67-43e6-8c9f-81c13d5b64c7
    type: title
    task:
      id: c81d3d82-1f67-43e6-8c9f-81c13d5b64c7
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: 6944bebc-3b04-444e-86bc-a1f94baebaf9
    type: regular
    task:
      id: 6944bebc-3b04-444e-86bc-a1f94baebaf9
      version: -1
      name: Block by SHA256
      description: Uploads an indicator for CrowdStrike to monitor.
      script: '|||cs-falcon-upload-custom-ioc'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      action:
        simple: prevent
      applied_globally:
        simple: "true"
      ioc_type:
        simple: sha256
      platforms:
        simple: mac,windows,linux
      severity:
        complex:
          root: 'inputs.Severity '
      value:
        complex:
          root: inputs.SHA256
          transformers:
          - operator: uniq
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 750,
          "y": 570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: d777bdf1-7755-4d41-8656-ff0661e2f04b
    type: regular
    task:
      id: d777bdf1-7755-4d41-8656-ff0661e2f04b
      version: -1
      name: Block by MD5
      description: Uploads an indicator for CrowdStrike to monitor.
      script: '|||cs-falcon-upload-custom-ioc'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      action:
        simple: prevent
      applied_globally:
        simple: "true"
      ioc_type:
        simple: md5
      platforms:
        simple: windows,mac,linux
      severity:
        complex:
          root: 'inputs.Severity '
      value:
        complex:
          root: inputs.MD5
          transformers:
          - operator: uniq
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 340,
          "y": 570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: d1c8e641-989c-4b1a-8f37-c655c2ee2e66
    type: condition
    task:
      id: d1c8e641-989c-4b1a-8f37-c655c2ee2e66
      version: -1
      name: Is there any SHA256 to block?
      type: condition
      iscommand: false
      brand: ""
      description: ""
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "7"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: inputs.SHA256
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 750,
          "y": 360
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 765,
        "width": 1080,
        "x": 50,
        "y": 50
      }
    }
  }
inputs:
- key: SHA256
  value: {}
  required: false
  description: The SHA256 of the file for block.
  playbookInputQuery:
- key: 'Severity '
  value:
    simple: medium
  required: true
  description: 'The severity of the indicator (informational, low, medium, high and critical) '
  playbookInputQuery:
- key: MD5
  value: {}
  required: false
  description: The MD5 of the file for block.
  playbookInputQuery:
outputs: []
tests:
- Test - CrowdStrike Falcon
fromversion: 6.10.0
