id: Test Playbook - CrowdStrike Falcon - Get Detections by Incident
version: -1
name: Test Playbook - CrowdStrike Falcon - Get Detections by Incident
description: "Develop a test playbook for the ‘CrowdStrike Falcon - Get Detections by Incident’ playbook, which is part of the malware investigation and response pack.\n\nThe playbook includes the following tests:\n1- Confirm that incident fields were populated correctly by the custom output mapping rules.\n2- Ensure that the context data was properly extracted. \n3- Validate the playbook outputs."
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: dd3bdee8-2037-4ba5-8de3-d14191ffef81
    type: start
    task:
      id: dd3bdee8-2037-4ba5-8de3-d14191ffef81
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "32"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -400,
          "y": -4195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: 5a6ed238-e15c-4ad4-8453-443074684da5
    type: regular
    task:
      id: 5a6ed238-e15c-4ad4-8453-443074684da5
      version: -1
      name: Delete Context
      description: The task deletes all of the context data. Having a clean beginning to a test playbook ensures that a test can be sterile and that unrelated issues can be eliminated.
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "363"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -400,
          "y": -4060
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "202":
    id: "202"
    taskid: c7ece85f-780c-4958-8e46-3e00ce96347f
    type: title
    task:
      id: c7ece85f-780c-4958-8e46-3e00ce96347f
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5240,
          "y": -880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "246":
    id: "246"
    taskid: 61a0d8fd-8d4a-4488-8508-046669e829b5
    type: condition
    task:
      id: 61a0d8fd-8d4a-4488-8508-046669e829b5
      version: -1
      name: Verify Process Start Time
      description: Verify that the 'CrowdStrike.Detection.ProcessStartTime' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "254"
      Verified:
      - "269"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Detection
                accessor: ProcessStartTime
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -190,
          "y": -1730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "248":
    id: "248"
    taskid: 6693ee31-0ab2-4698-857c-34bdac51e746
    type: playbook
    task:
      id: 6693ee31-0ab2-4698-857c-34bdac51e746
      version: -1
      name: CrowdStrike Falcon - Get Detections by Incident
      description: |-
        This playbook is part of the 'Malware Investigation And Response' pack. For more information, refer to https://xsoar.pan.dev/docs/reference/packs/malware-investigation-and-response.
        This playbook enables getting CrowdStrike Falcon detection details based on the CrowdStrike incident ID.
      playbookName: CrowdStrike Falcon - Get Detections by Incident
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "373"
    scriptarguments:
      IncidentID:
        complex:
          root: CrowdStrike.Incidents
          filters:
          - - operator: isNotEmpty
              left:
                value:
                  simple: CrowdStrike.Incidents
                iscontext: true
          accessor: incident_id
          transformers:
          - operator: LastArrayElement
    separatecontext: false
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": -400,
          "y": -3560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "251":
    id: "251"
    taskid: 6ba9fa36-a0c0-442d-8eed-191b36b84dcd
    type: title
    task:
      id: 6ba9fa36-a0c0-442d-8eed-191b36b84dcd
      version: -1
      name: 'No CrowdStrike Falcon Detections Were Found'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "202"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 0,
          "y": -3225
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "253":
    id: "253"
    taskid: af7ddcf1-a903-4847-8372-64b2e4a5dcf9
    type: title
    task:
      id: af7ddcf1-a903-4847-8372-64b2e4a5dcf9
      version: -1
      name: '''CrowdStrike.IncidentDetection'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "256"
      - "258"
      - "260"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -190,
          "y": -2390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "254":
    id: "254"
    taskid: 5725ad5c-b632-496d-83e3-3d9d48fb46ec
    type: regular
    task:
      id: 5725ad5c-b632-496d-83e3-3d9d48fb46ec
      version: -1
      name: Verify Context Data Error - Process Start Time
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.ProcessStartTime’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.ProcessStartTime' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -190,
          "y": -1520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "255":
    id: "255"
    taskid: 4d795234-4fe6-4f06-87ac-afcd646389b3
    type: title
    task:
      id: 4d795234-4fe6-4f06-87ac-afcd646389b3
      version: -1
      name: Check Context Data
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "253"
      - "262"
      - "292"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -400,
          "y": -2535
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "256":
    id: "256"
    taskid: 1a3e883d-8515-422a-8186-8dafccdff406
    type: condition
    task:
      id: 1a3e883d-8515-422a-8186-8dafccdff406
      version: -1
      name: Verify Incident ID
      description: Verify that the 'CrowdStrike.IncidentDetection.incident_id' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "257"
      Verified:
      - "263"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.IncidentDetection
                accessor: incident_id
            iscontext: true
          right:
            value: {}
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -190,
          "y": -2250
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "257":
    id: "257"
    taskid: 07fb16ba-7528-48be-8cde-da9edcff5d0a
    type: regular
    task:
      id: 07fb16ba-7528-48be-8cde-da9edcff5d0a
      version: -1
      name: Verify Context Data Error - Incident ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'CrowdStrike.IncidentDetection.incident_id’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:
          1- The 'Get detections for incident' task failed.
          2- The 'incident_id' input configuration was changed for the 'cs-falcon-get-detections-for-incident' automation used in the 'Get detections for incident' task.
          3- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.incident_id' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -190,
          "y": -2040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "258":
    id: "258"
    taskid: 2f5db7b0-2011-4bea-87de-6683ffcaec32
    type: condition
    task:
      id: 2f5db7b0-2011-4bea-87de-6683ffcaec32
      version: -1
      name: Verify Detection IDs
      description: Verify that the 'CrowdStrike.IncidentDetection.detection_ids' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "259"
      Verified:
      - "263"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.IncidentDetection
                accessor: detection_ids
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 200,
          "y": -2250
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "259":
    id: "259"
    taskid: 339c4613-dbc7-4ef8-8e52-1362c0ec290b
    type: regular
    task:
      id: 339c4613-dbc7-4ef8-8e52-1362c0ec290b
      version: -1
      name: Verify Context Data Error - Detection IDs
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'CrowdStrike.IncidentDetection.detection_ids’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:
          1- The 'Get detections for incident' task failed.
          2- The 'incident_id' input configuration was changed for the 'cs-falcon-get-detections-for-incident' automation used in the 'Get detections for incident' task.
          3- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 200,
          "y": -2040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "260":
    id: "260"
    taskid: 09471005-7bae-4466-8175-c09c02f1e5a6
    type: condition
    task:
      id: 09471005-7bae-4466-8175-c09c02f1e5a6
      version: -1
      name: Verify Behavior ID
      description: Verify that the 'CrowdStrike.IncidentDetection.behavior_id' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "261"
      Verified:
      - "263"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.IncidentDetection
                accessor: behavior_id
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": -2250
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "261":
    id: "261"
    taskid: cd917166-22cb-4743-8cfd-d600db17b789
    type: regular
    task:
      id: cd917166-22cb-4743-8cfd-d600db17b789
      version: -1
      name: Verify Context Data Error - Behavior ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'CrowdStrike.IncidentDetection.behavior_id’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:
          1- The 'Get detections for incident' task failed.
          2- The 'incident_id' input configuration was changed for the 'cs-falcon-get-detections-for-incident' automation used in the 'Get detections for incident' task.
          3- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.behavior_id' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": -2040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "262":
    id: "262"
    taskid: 129f8673-0990-40cb-86eb-62ee9adea0be
    type: title
    task:
      id: 129f8673-0990-40cb-86eb-62ee9adea0be
      version: -1
      name: '''CrowdStrike.Detection'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "246"
      - "267"
      - "278"
      - "282"
      - "284"
      - "286"
      - "288"
      - "290"
      - "334"
      - "370"
      - "371"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -190,
          "y": -1870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "263":
    id: "263"
    taskid: d7c90647-363a-43de-8146-620bd20b36c1
    type: title
    task:
      id: d7c90647-363a-43de-8146-620bd20b36c1
      version: -1
      name: Done verifying 'CrowdStrike.IncidentDetection' Context Data
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "202"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4950,
          "y": -2050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "267":
    id: "267"
    taskid: bd9f3fb2-b306-4d9b-8ad5-8eede5b914a8
    type: condition
    task:
      id: bd9f3fb2-b306-4d9b-8ad5-8eede5b914a8
      version: -1
      name: Verify Max Severity
      description: Verify that the 'CrowdStrike.Detection.MaxSeverity' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "268"
      Verified:
      - "269"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Detection
                accessor: MaxSeverity
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 210,
          "y": -1730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "268":
    id: "268"
    taskid: 795dee63-474a-42ef-8caf-06848fc5551b
    type: regular
    task:
      id: 795dee63-474a-42ef-8caf-06848fc5551b
      version: -1
      name: Verify Context Data Error - Max Severity
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.MaxSeverity’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.MaxSeverity' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 210,
          "y": -1520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "269":
    id: "269"
    taskid: bee4b41b-6d04-4414-8bbf-80bfbf965cfc
    type: title
    task:
      id: bee4b41b-6d04-4414-8bbf-80bfbf965cfc
      version: -1
      name: Done verifying 'CrowdStrike.Detection' Context Data
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "202"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4950,
          "y": -1510
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "271":
    id: "271"
    taskid: 0fc40366-63e6-47b9-839d-630c41e0148e
    type: regular
    task:
      id: 0fc40366-63e6-47b9-839d-630c41e0148e
      version: -1
      name: Verify Context Data Error - First Behavior
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.FirstBehavior’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.FirstBehavior' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 610,
          "y": -1520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "277":
    id: "277"
    taskid: 26c05445-eb91-4cee-80d1-9e8254e44f3b
    type: regular
    task:
      id: 26c05445-eb91-4cee-80d1-9e8254e44f3b
      version: -1
      name: Verify Context Data Error - Last Behavior
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.LastBehavior’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.LastBehavior' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1010,
          "y": -1520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "278":
    id: "278"
    taskid: 31d230ea-c57b-4943-868c-809912ea5cbd
    type: condition
    task:
      id: 31d230ea-c57b-4943-868c-809912ea5cbd
      version: -1
      name: Verify Machine Domain
      description: Verify that the 'CrowdStrike.Detection.MachineDomain' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "279"
      Verified:
      - "269"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: CrowdStrike.Detection
                accessor: MachineDomain
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1410,
          "y": -1730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "279":
    id: "279"
    taskid: 9550dac7-318a-46da-8330-8eabf197c382
    type: regular
    task:
      id: 9550dac7-318a-46da-8330-8eabf197c382
      version: -1
      name: Verify Context Data Error - Machine Domain
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.MachineDomain’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.MachineDomain' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1410,
          "y": -1520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "282":
    id: "282"
    taskid: fe844342-ae6f-4cbf-8e66-fe6879ff401a
    type: condition
    task:
      id: fe844342-ae6f-4cbf-8e66-fe6879ff401a
      version: -1
      name: Verify System
      description: Verify that the 'CrowdStrike.Detection.System' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "283"
      Verified:
      - "269"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Detection
                accessor: System
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1810,
          "y": -1730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "283":
    id: "283"
    taskid: c9932101-4c33-4430-8ffa-3727e5f22b75
    type: regular
    task:
      id: c9932101-4c33-4430-8ffa-3727e5f22b75
      version: -1
      name: Verify Context Data Error - System
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.System’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.System' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1810,
          "y": -1520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "284":
    id: "284"
    taskid: 304f9a5c-c11c-4de1-846b-4851a07fda9c
    type: condition
    task:
      id: 304f9a5c-c11c-4de1-846b-4851a07fda9c
      version: -1
      name: Verify Status
      description: Verify that the 'CrowdStrike.Detection.Status' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "285"
      Verified:
      - "269"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Detection
                accessor: Status
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2210,
          "y": -1730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "285":
    id: "285"
    taskid: d65f6e34-8261-4b83-8330-9742d2147d85
    type: regular
    task:
      id: d65f6e34-8261-4b83-8330-9742d2147d85
      version: -1
      name: Verify Context Data Error - Status
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.Status’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Status' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2210,
          "y": -1520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "286":
    id: "286"
    taskid: ffd9c133-b0ce-46d7-858f-9097305949f2
    type: condition
    task:
      id: ffd9c133-b0ce-46d7-858f-9097305949f2
      version: -1
      name: Verify Show In Ui
      description: Verify that the 'CrowdStrike.Detection.ShowInUi' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "287"
      Verified:
      - "269"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Detection
                accessor: ShowInUi
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2610,
          "y": -1730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "287":
    id: "287"
    taskid: 35ad3abc-1db8-43ee-8bbd-8581512b9888
    type: regular
    task:
      id: 35ad3abc-1db8-43ee-8bbd-8581512b9888
      version: -1
      name: Verify Context Data Error - ShowI n Ui
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.ShowInUi’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.ShowInUi' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2610,
          "y": -1520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "288":
    id: "288"
    taskid: 77554589-0677-4cc2-8b73-771fc9c3a168
    type: condition
    task:
      id: 77554589-0677-4cc2-8b73-771fc9c3a168
      version: -1
      name: Verify Customer ID
      description: Verify that the 'CrowdStrike.Detection.CustomerID' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "289"
      Verified:
      - "269"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Detection
                accessor: CustomerID
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3010,
          "y": -1730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "289":
    id: "289"
    taskid: a7ee0158-6257-4a16-8f36-1e75fbd22abd
    type: regular
    task:
      id: a7ee0158-6257-4a16-8f36-1e75fbd22abd
      version: -1
      name: Verify Context Data Error - Customer ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.CustomerID’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.CustomerID' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3010,
          "y": -1520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "290":
    id: "290"
    taskid: 91af43ed-a689-451e-805d-b068225557c1
    type: condition
    task:
      id: 91af43ed-a689-451e-805d-b068225557c1
      version: -1
      name: Verify ID
      description: Verify that the 'CrowdStrike.Detection.ID' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "291"
      Verified:
      - "269"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Detection
                accessor: ID
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3410,
          "y": -1730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "291":
    id: "291"
    taskid: 00550b24-87d5-4ede-8e96-0e9d3d084304
    type: regular
    task:
      id: 00550b24-87d5-4ede-8e96-0e9d3d084304
      version: -1
      name: Verify Context Data Error - ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.ID’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.ID' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3410,
          "y": -1520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "292":
    id: "292"
    taskid: d5649bb2-83d4-4ea0-8e8e-bd750c566e7b
    type: title
    task:
      id: d5649bb2-83d4-4ea0-8e8e-bd750c566e7b
      version: -1
      name: '''CrowdStrike.Detection.Behavior'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "293"
      - "295"
      - "297"
      - "303"
      - "305"
      - "309"
      - "311"
      - "313"
      - "317"
      - "323"
      - "325"
      - "327"
      - "315"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -190,
          "y": -1350
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "293":
    id: "293"
    taskid: 3a85ef62-96df-462f-8e63-9b0ec47bbdcd
    type: condition
    task:
      id: 3a85ef62-96df-462f-8e63-9b0ec47bbdcd
      version: -1
      name: Verify Parent Process ID
      description: Verify that the 'CrowdStrike.Detection.Behavior.ParentProcessID' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "294"
      Verified:
      - "331"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: ParentProcessID
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -190,
          "y": -1210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "294":
    id: "294"
    taskid: d71fb4e9-249e-4409-8bfd-c4688dd48617
    type: regular
    task:
      id: d71fb4e9-249e-4409-8bfd-c4688dd48617
      version: -1
      name: Verify Context Data Error - Parent Process ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.Behavior.ParentProcessID’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.ParentProcessID' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -190,
          "y": -1000
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "295":
    id: "295"
    taskid: 9b54e5ac-c1d5-4f9b-86b4-827d18260af1
    type: condition
    task:
      id: 9b54e5ac-c1d5-4f9b-86b4-827d18260af1
      version: -1
      name: Verify File Path
      description: Verify that the 'CrowdStrike.Detection.Behavior.Filepath' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "296"
      Verified:
      - "331"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: Filepath
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 200,
          "y": -1210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "296":
    id: "296"
    taskid: e5301d59-48d0-4efb-8b5d-621451501cd9
    type: regular
    task:
      id: e5301d59-48d0-4efb-8b5d-621451501cd9
      version: -1
      name: Verify Context Data Error - File Path
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.Behavior.Filepath’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.Filepath' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 200,
          "y": -1000
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "297":
    id: "297"
    taskid: 9313b790-e603-4061-8546-e4f6d1d562e1
    type: condition
    task:
      id: 9313b790-e603-4061-8546-e4f6d1d562e1
      version: -1
      name: Verify Pattern Disposition
      description: Verify that the 'CrowdStrike.Detection.Behavior.PatternDisposition' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "298"
      Verified:
      - "331"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: PatternDisposition
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": -1210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "298":
    id: "298"
    taskid: 12c78f47-a668-4a82-89fd-264efbb48c8c
    type: regular
    task:
      id: 12c78f47-a668-4a82-89fd-264efbb48c8c
      version: -1
      name: Verify Context Data Error - Pattern Disposition
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.Behavior.PatternDisposition’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.PatternDisposition' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": -1000
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "303":
    id: "303"
    taskid: 7fe15e69-b5cd-48e2-8222-d8019a141af2
    type: condition
    task:
      id: 7fe15e69-b5cd-48e2-8222-d8019a141af2
      version: -1
      name: Verify Confidence
      description: Verify that the 'CrowdStrike.Detection.Behavior.Confidence' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "304"
      Verified:
      - "331"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: Confidence
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 990,
          "y": -1210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "304":
    id: "304"
    taskid: c25c7f24-497a-43a2-8a4e-295ed110aeb4
    type: regular
    task:
      id: c25c7f24-497a-43a2-8a4e-295ed110aeb4
      version: -1
      name: Verify Context Data Error - Confidence
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.Behavior.Confidence’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.Confidence' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 990,
          "y": -1000
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "305":
    id: "305"
    taskid: 6cdce3fd-9ff7-40da-8a48-8c976587feac
    type: condition
    task:
      id: 6cdce3fd-9ff7-40da-8a48-8c976587feac
      version: -1
      name: Verify Process ID
      description: Verify that the 'CrowdStrike.Detection.Behavior.ProcessID' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "306"
      Verified:
      - "331"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: ProcessID
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1380,
          "y": -1210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "306":
    id: "306"
    taskid: 3f8cd798-1186-4d4f-8548-32c1e3197053
    type: regular
    task:
      id: 3f8cd798-1186-4d4f-8548-32c1e3197053
      version: -1
      name: Verify Context Data Error - Process ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.Behavior.ProcessID’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.ProcessID' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1380,
          "y": -1000
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "309":
    id: "309"
    taskid: b7f6ff47-3fe3-4f12-84dc-c038f54aa7ea
    type: condition
    task:
      id: b7f6ff47-3fe3-4f12-84dc-c038f54aa7ea
      version: -1
      name: Verify Display Name
      description: Verify that the 'CrowdStrike.Detection.Behavior.DisplayName' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "310"
      Verified:
      - "331"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: DisplayName
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": -1210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "310":
    id: "310"
    taskid: 253ebd0f-0eb8-4388-8ac7-09246be87ff6
    type: regular
    task:
      id: 253ebd0f-0eb8-4388-8ac7-09246be87ff6
      version: -1
      name: Verify Context Data Error - Display Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.Behavior.DisplayName’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.DisplayName' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": -1000
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "311":
    id: "311"
    taskid: 9eaae543-0a83-48e4-89d4-bef16682ed83
    type: condition
    task:
      id: 9eaae543-0a83-48e4-89d4-bef16682ed83
      version: -1
      name: Verify Technique
      description: Verify that the 'CrowdStrike.Detection.Behavior.Technique' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "312"
      Verified:
      - "331"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: Technique
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2170,
          "y": -1210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "312":
    id: "312"
    taskid: 7da92107-e66e-4c94-8212-9d5b275fc310
    type: regular
    task:
      id: 7da92107-e66e-4c94-8212-9d5b275fc310
      version: -1
      name: Verify Context Data Error - Technique
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.Behavior.Technique’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.Technique' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2170,
          "y": -1000
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "313":
    id: "313"
    taskid: 33dc20ab-7654-494b-8d26-72e855435436
    type: condition
    task:
      id: 33dc20ab-7654-494b-8d26-72e855435436
      version: -1
      name: Verify Scenario
      description: Verify that the 'CrowdStrike.Detection.Behavior.Scenario' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "314"
      Verified:
      - "331"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: Scenario
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2560,
          "y": -1210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "314":
    id: "314"
    taskid: fdf35a91-0237-4e16-8455-8d21411d7878
    type: regular
    task:
      id: fdf35a91-0237-4e16-8455-8d21411d7878
      version: -1
      name: Verify Context Data Error - Scenario
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.Behavior.Scenario’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.Scenario' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2560,
          "y": -1000
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "315":
    id: "315"
    taskid: 4a257f02-aa82-4ce1-819a-4f3395942b1f
    type: condition
    task:
      id: 4a257f02-aa82-4ce1-819a-4f3395942b1f
      version: -1
      name: Verify Tactic ID
      description: Verify that the 'CrowdStrike.Detection.Behavior.TacticID' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "316"
      Verified:
      - "331"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: TacticID
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2960,
          "y": -1210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "316":
    id: "316"
    taskid: dc2dd234-153a-4910-8353-b757686b9d11
    type: regular
    task:
      id: dc2dd234-153a-4910-8353-b757686b9d11
      version: -1
      name: Verify Context Data Error - Tactic ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.Behavior.TacticID’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.TacticID' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2960,
          "y": -1000
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "317":
    id: "317"
    taskid: b3926add-93a6-4024-8f86-8b590c8a8d5d
    type: condition
    task:
      id: b3926add-93a6-4024-8f86-8b590c8a8d5d
      version: -1
      name: Verify IOC Value
      description: Verify that the 'CrowdStrike.Detection.Behavior.IOCValue' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "318"
      Verified:
      - "331"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: IOCValue
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3350,
          "y": -1210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "318":
    id: "318"
    taskid: fe4c8ca3-1b9b-4b0e-8828-ac2b21273dcf
    type: regular
    task:
      id: fe4c8ca3-1b9b-4b0e-8828-ac2b21273dcf
      version: -1
      name: Verify Context Data Error - IOC Value
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.Behavior.IOCValue’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.IOCValue' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3350,
          "y": -1000
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "323":
    id: "323"
    taskid: 5524e914-4b59-4d0a-8b74-aabe720448a1
    type: condition
    task:
      id: 5524e914-4b59-4d0a-8b74-aabe720448a1
      version: -1
      name: Verify IOC Type
      description: Verify that the 'CrowdStrike.Detection.Behavior.IOCType' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "324"
      Verified:
      - "331"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: IOCType
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3750,
          "y": -1210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "324":
    id: "324"
    taskid: 238742b7-7be6-4f43-8546-9e8849062f3c
    type: regular
    task:
      id: 238742b7-7be6-4f43-8546-9e8849062f3c
      version: -1
      name: Verify Context Data Error - IOC Type
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.Behavior.IOCType’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.IOCType' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3750,
          "y": -1000
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "325":
    id: "325"
    taskid: 641dcd17-1c3d-4f5d-8d1f-39615ba37bdf
    type: condition
    task:
      id: 641dcd17-1c3d-4f5d-8d1f-39615ba37bdf
      version: -1
      name: Verify Tactic
      description: Verify that the 'CrowdStrike.Detection.Behavior.Tactic' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "326"
      Verified:
      - "331"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: Tactic
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4140,
          "y": -1210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "326":
    id: "326"
    taskid: c990ce8e-34f9-4c68-84e0-4c04e24d569b
    type: regular
    task:
      id: c990ce8e-34f9-4c68-84e0-4c04e24d569b
      version: -1
      name: Verify Context Data Error - Tactic
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.Behavior.Tactic’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.Tactic' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4140,
          "y": -1000
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "327":
    id: "327"
    taskid: d3a1405a-d73b-41fa-8c2f-88236dbfdade
    type: condition
    task:
      id: d3a1405a-d73b-41fa-8c2f-88236dbfdade
      version: -1
      name: Verify Alleged File Type
      description: Verify that the 'CrowdStrike.Detection.Behavior.AllegedFiletype' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "328"
      Verified:
      - "331"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: AllegedFiletype
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4530,
          "y": -1210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "328":
    id: "328"
    taskid: 8b8e2d46-db5b-4b11-8e3e-3df7c8bed3e5
    type: regular
    task:
      id: 8b8e2d46-db5b-4b11-8e3e-3df7c8bed3e5
      version: -1
      name: Verify Context Data Error - Alleged File Type
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.Behavior.AllegedFiletype’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.AllegedFiletype' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4530,
          "y": -1000
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "331":
    id: "331"
    taskid: d85c85e8-ad99-4145-8e2e-b0494be54adc
    type: title
    task:
      id: d85c85e8-ad99-4145-8e2e-b0494be54adc
      version: -1
      name: Done verifying 'CrowdStrike.Detection.Behavior' Context Data
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "202"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4930,
          "y": -1020
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "334":
    id: "334"
    taskid: d42d22e6-7a15-4185-8832-5d40ee9ccbb5
    type: condition
    task:
      id: d42d22e6-7a15-4185-8832-5d40ee9ccbb5
      version: -1
      name: Verify Device
      description: Verify that the 'CrowdStrike.Detection.Device' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "335"
      Verified:
      - "269"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Detection
                accessor: Device
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3820,
          "y": -1730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "335":
    id: "335"
    taskid: 4f815c15-0c51-4acc-8a3d-04302bd81943
    type: regular
    task:
      id: 4f815c15-0c51-4acc-8a3d-04302bd81943
      version: -1
      name: Verify Context Data Error - Device
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.Device’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'extended_data' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n4- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Device' context key. \n5- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n6- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n7 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3820,
          "y": -1520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "339":
    id: "339"
    taskid: a602ecb8-9432-4f96-8582-c1539a902491
    type: title
    task:
      id: a602ecb8-9432-4f96-8582-c1539a902491
      version: -1
      name: Check Incident Fields
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "340"
      - "342"
      - "344"
      - "346"
      - "348"
      - "350"
      - "352"
      - "356"
      - "358"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -180,
          "y": -3020
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "340":
    id: "340"
    taskid: 88e04320-a238-4dd9-84d8-55037885651a
    type: condition
    task:
      id: 88e04320-a238-4dd9-84d8-55037885651a
      version: -1
      name: Verify File Names
      description: |
        Verify that the ‘filenames’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "341"
      Verified:
      - "360"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: inList
          left:
            value:
              complex:
                root: incident
                accessor: filenames
            iscontext: true
          right:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: FileName
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -180,
          "y": -2880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "341":
    id: "341"
    taskid: 182f4fc6-d2a0-4291-859d-e1ae870dc988
    type: regular
    task:
      id: 182f4fc6-d2a0-4291-859d-e1ae870dc988
      version: -1
      name: Verify Incident Field Error - File Names
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'filenames' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.FileName' context key. \n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The custom output mapping rule for the 'filenames' incident field configured within the 'Get full detection details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -180,
          "y": -2670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "342":
    id: "342"
    taskid: b99f6c84-1979-4854-8912-09e1131b79a4
    type: condition
    task:
      id: b99f6c84-1979-4854-8912-09e1131b79a4
      version: -1
      name: Verify Scenario
      description: |
        Verify that the ‘Scenario’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "343"
      Verified:
      - "360"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: inList
          left:
            value:
              complex:
                root: incident
                accessor: scenario
            iscontext: true
          right:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: Scenario
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 210,
          "y": -2880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "343":
    id: "343"
    taskid: 8fc8980e-c12c-4d55-812f-98b4a9b18126
    type: regular
    task:
      id: 8fc8980e-c12c-4d55-812f-98b4a9b18126
      version: -1
      name: Verify Incident Field Error - Scenario
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Scenario' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.Scenario' context key. \n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The custom output mapping rule for the 'Scenario' incident field configured within the 'Get full detection details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 210,
          "y": -2670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "344":
    id: "344"
    taskid: 5ec86670-c2ba-4ae4-8fc4-da3115acff41
    type: condition
    task:
      id: 5ec86670-c2ba-4ae4-8fc4-da3115acff41
      version: -1
      name: Verify Process MD5
      description: |
        Verify that the ‘processmd5’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "345"
      Verified:
      - "360"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: inList
          left:
            value:
              complex:
                root: incident
                accessor: processmd5
            iscontext: true
          right:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: MD5
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 600,
          "y": -2880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "345":
    id: "345"
    taskid: f994d35b-be5f-494b-8ace-f0b1e316cef2
    type: regular
    task:
      id: f994d35b-be5f-494b-8ace-f0b1e316cef2
      version: -1
      name: Verify Incident Field Error - Process MD5
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'processmd5' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.MD5' context key. \n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The custom output mapping rule for the 'processmd5' incident field configured within the 'Get full detection details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 600,
          "y": -2670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "346":
    id: "346"
    taskid: 8de6d0f7-0a60-453f-890b-1f77a6302796
    type: condition
    task:
      id: 8de6d0f7-0a60-453f-890b-1f77a6302796
      version: -1
      name: Verify Process SHA256
      description: |
        Verify that the ‘parentprocesssha256’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "347"
      Verified:
      - "360"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: inList
          left:
            value:
              complex:
                root: incident
                accessor: processsha256
            iscontext: true
          right:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: SHA256
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 990,
          "y": -2880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "347":
    id: "347"
    taskid: 56c8e941-57b7-480e-814a-f3f4d0f59423
    type: regular
    task:
      id: 56c8e941-57b7-480e-814a-f3f4d0f59423
      version: -1
      name: Verify Incident Field Error - Process SHA256
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'parentprocesssha256' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.SHA256' context key. \n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The custom output mapping rule for the 'parentprocesssha256' incident field configured within the 'Get full detection details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 990,
          "y": -2670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "348":
    id: "348"
    taskid: ab08788a-1f13-495b-8149-7799d9fcb50d
    type: condition
    task:
      id: ab08788a-1f13-495b-8149-7799d9fcb50d
      version: -1
      name: Verify Process CMD
      description: |
        Verify that the ‘processcmd’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "349"
      Verified:
      - "360"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: inList
          left:
            value:
              complex:
                root: incident
                accessor: processcmd
            iscontext: true
          right:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: CommandLine
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1380,
          "y": -2880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "349":
    id: "349"
    taskid: b5fd5e57-432f-4faf-8c2f-54d788435ebb
    type: regular
    task:
      id: b5fd5e57-432f-4faf-8c2f-54d788435ebb
      version: -1
      name: Verify Incident Field Error - Process CMD
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'processcmd' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.CommandLine' context key. \n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The custom output mapping rule for the 'processcmd' incident field configured within the 'Get full detection details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1380,
          "y": -2670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "350":
    id: "350"
    taskid: 03f387b1-f800-44e6-8c71-d35659ba441c
    type: condition
    task:
      id: 03f387b1-f800-44e6-8c71-d35659ba441c
      version: -1
      name: Verify External Confidence
      description: |
        Verify that the ‘externalconfidence’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "351"
      Verified:
      - "360"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: inList
          left:
            value:
              complex:
                root: incident
                accessor: externalconfidence
            iscontext: true
          right:
            value:
              complex:
                root: CrowdStrike.Detection
                accessor: MaxConfidence
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": -2880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "351":
    id: "351"
    taskid: b2bf0033-b319-40b2-828f-0fdfc7aa9391
    type: regular
    task:
      id: b2bf0033-b319-40b2-828f-0fdfc7aa9391
      version: -1
      name: Verify Incident Field Error - External Confidence
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'externalconfidence' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.MaxConfidence' context key. \n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The custom output mapping rule for the 'externalconfidence' incident field configured within the 'Get full detection details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": -2670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "352":
    id: "352"
    taskid: ef0bd37a-0ca9-4c24-8ac9-b6a8195cc3e5
    type: condition
    task:
      id: ef0bd37a-0ca9-4c24-8ac9-b6a8195cc3e5
      version: -1
      name: Verify Users
      description: |
        Verify that the ‘users’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "353"
      Verified:
      - "360"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: inList
          left:
            value:
              complex:
                root: incident
                accessor: users
            iscontext: true
          right:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: UserName
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2160,
          "y": -2880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "353":
    id: "353"
    taskid: 7b00d364-9ad2-47f2-87ee-711e64ffd71c
    type: regular
    task:
      id: 7b00d364-9ad2-47f2-87ee-711e64ffd71c
      version: -1
      name: Verify Incident Field Error - Users
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'users' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.UserName' context key. \n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The custom output mapping rule for the 'users' incident field configured within the 'Get full detection details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2160,
          "y": -2670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "356":
    id: "356"
    taskid: 01e4eed2-3b51-497a-8e31-e54d818567c2
    type: condition
    task:
      id: 01e4eed2-3b51-497a-8e31-e54d818567c2
      version: -1
      name: Verify Technique ID
      description: |
        Verify that the ‘techniqueid’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "357"
      Verified:
      - "360"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: inList
          left:
            value:
              complex:
                root: incident
                accessor: techniqueid
            iscontext: true
          right:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: TechniqueId
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2550,
          "y": -2880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "357":
    id: "357"
    taskid: 3d3bb35d-0dfb-48ef-8dc5-39473a26e337
    type: regular
    task:
      id: 3d3bb35d-0dfb-48ef-8dc5-39473a26e337
      version: -1
      name: Verify Incident Field Error - Technique ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'techniqueid' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.TechniqueId' context key. \n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The custom output mapping rule for the 'techniqueid' incident field configured within the 'Get full detection details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2550,
          "y": -2670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "358":
    id: "358"
    taskid: 92c62925-2a6b-4450-814b-797461d9c90f
    type: condition
    task:
      id: 92c62925-2a6b-4450-814b-797461d9c90f
      version: -1
      name: Verify File SHA256
      description: |
        Verify that the ‘filesha256’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "359"
      Verified:
      - "360"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: inList
          left:
            value:
              complex:
                root: incident
                accessor: filesha256
            iscontext: true
          right:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: SHA256
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2940,
          "y": -2880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "359":
    id: "359"
    taskid: 96b3c1c4-4523-4704-88eb-79f3b70d86ae
    type: regular
    task:
      id: 96b3c1c4-4523-4704-88eb-79f3b70d86ae
      version: -1
      name: Verify Incident Field Error - File SHA256
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'filesha256' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.SHA256' context key. \n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The custom output mapping rule for the 'filesha256' incident field configured within the 'Get full detection details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2940,
          "y": -2670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "360":
    id: "360"
    taskid: f3b0ef99-158e-4310-85d8-a5f7f991b567
    type: title
    task:
      id: f3b0ef99-158e-4310-85d8-a5f7f991b567
      version: -1
      name: Done verifying Incident Fields
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "202"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4940,
          "y": -2690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "361":
    id: "361"
    taskid: f6c7a2d7-8c46-403c-8c67-bb47469ee209
    type: title
    task:
      id: f6c7a2d7-8c46-403c-8c67-bb47469ee209
      version: -1
      name: Start Testing
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "339"
      - "255"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -400,
          "y": -3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "363":
    id: "363"
    taskid: 8f385cb7-38e8-4081-853b-db44bc269306
    type: regular
    task:
      id: 8f385cb7-38e8-4081-853b-db44bc269306
      version: -1
      name: Get CrowdStrike Falcon Available Incidents
      description: Obtains a list of CrowdStrike Falcon incidents before performing the tests.
      script: '|||cs-falcon-list-incident-summaries'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "364"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -400,
          "y": -3900
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "364":
    id: "364"
    taskid: 3f0a37fd-781a-4794-899c-4eb60e309033
    type: condition
    task:
      id: 3f0a37fd-781a-4794-899c-4eb60e309033
      version: -1
      name: Check CrowdStrike Falcon Available Incidents
      description: Checks if there are available incidents for testing processes.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "374"
      "yes":
      - "248"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Incidents
                accessor: incident_id
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -400,
          "y": -3730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "370":
    id: "370"
    taskid: 5323a287-3be6-49ac-8e83-11823497bc44
    type: condition
    task:
      id: 5323a287-3be6-49ac-8e83-11823497bc44
      version: -1
      name: Verify First Behavior
      description: Verify that the 'CrowdStrike.Detection.FirstBehavior' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "271"
      Verified:
      - "269"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: CrowdStrike.Detection
                accessor: FirstBehavior
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 610,
          "y": -1730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "371":
    id: "371"
    taskid: d53eed8b-03bd-49b5-83e2-8a1a5f3bee9a
    type: condition
    task:
      id: d53eed8b-03bd-49b5-83e2-8a1a5f3bee9a
      version: -1
      name: Verify Last Behavior
      description: Verify that the 'CrowdStrike.Detection.LastBehavior' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "277"
      Verified:
      - "269"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: CrowdStrike.Detection
                accessor: LastBehavior
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1010,
          "y": -1730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "373":
    id: "373"
    taskid: 4329e130-e368-46c3-8ecd-66e1b176f9b1
    type: condition
    task:
      id: 4329e130-e368-46c3-8ecd-66e1b176f9b1
      version: -1
      name: Found CrowdStrike Detections?
      description: Before checking context data that relies on 'FoundDetections' results, verify the status of the context key 'FoundDetections'.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "251"
      "Yes":
      - "361"
    separatecontext: false
    conditions:
    - label: "Yes"
      condition:
      - - operator: isNotEqualString
          left:
            value:
              complex:
                root: CrowdStrike
                accessor: FoundDetections
            iscontext: true
          right:
            value:
              simple: "False"
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -400,
          "y": -3400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "374":
    id: "374"
    taskid: 80ad4624-209c-480a-8101-c55153179325
    type: title
    task:
      id: 80ad4624-209c-480a-8101-c55153179325
      version: -1
      name: No Available CrowdStrike Falcon Incidents
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "202"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 0,
          "y": -3545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "246_269_Verified": 0.1,
      "256_263_Verified": 0.11,
      "258_263_Verified": 0.14,
      "260_263_Verified": 0.1,
      "267_269_Verified": 0.11,
      "278_269_Verified": 0.1,
      "282_269_Verified": 0.1,
      "284_269_Verified": 0.11,
      "286_269_Verified": 0.1,
      "288_269_Verified": 0.12,
      "290_269_Verified": 0.1,
      "293_331_Verified": 0.1,
      "295_331_Verified": 0.1,
      "297_331_Verified": 0.1,
      "303_331_Verified": 0.1,
      "305_331_Verified": 0.1,
      "309_331_Verified": 0.1,
      "311_331_Verified": 0.11,
      "313_331_Verified": 0.1,
      "315_331_Verified": 0.1,
      "317_331_Verified": 0.12,
      "323_331_Verified": 0.1,
      "325_331_Verified": 0.12,
      "327_331_Verified": 0.15,
      "334_269_Verified": 0.24,
      "340_360_Verified": 0.11,
      "342_360_Verified": 0.1,
      "344_360_Verified": 0.1,
      "348_360_Verified": 0.1,
      "350_360_Verified": 0.1,
      "352_360_Verified": 0.1,
      "356_360_Verified": 0.16,
      "358_360_Verified": 0.2,
      "364_248_yes": 0.53
    },
    "paper": {
      "dimensions": {
        "height": 3380,
        "width": 6020,
        "x": -400,
        "y": -4195
      }
    }
  }
inputs: []
outputs: []
fromversion: 6.5.0

