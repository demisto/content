id: Test Playbook - CrowdStrike Falcon - Get Detections by Incident
version: -1
name: Test Playbook - CrowdStrike Falcon - Get Detections by Incident
description: "Develop a test playbook for the ‘CrowdStrike Falcon - Get Detections by Incident’ playbook, which is part of the malware investigation and response pack.\n\nThe playbook includes the following tests:\n1- Confirm that incident fields were populated correctly by the custom output mapping rules.\n2- Ensure that the context data was properly extracted. \n3- Validate the playbook outputs."
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 72154776-a063-4159-8ab8-4b5984ce1eb0
    type: start
    task:
      id: 72154776-a063-4159-8ab8-4b5984ce1eb0
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "32"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -400,
          "y": -3955
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: 67bbd18f-576c-4ce4-897c-ef24beb31dfa
    type: regular
    task:
      id: 67bbd18f-576c-4ce4-897c-ef24beb31dfa
      version: -1
      name: Delete Context
      description: The task deletes all of the context data. Having a clean beginning to a test playbook ensures that a test can be sterile and that unrelated issues can be eliminated.
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "363"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -400,
          "y": -3820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "202":
    id: "202"
    taskid: 5832b374-44c8-4505-8824-060233e99238
    type: title
    task:
      id: 5832b374-44c8-4505-8824-060233e99238
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5690,
          "y": 290
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "227":
    id: "227"
    taskid: 1390de01-3916-4746-8a23-2cba75761a12
    type: regular
    task:
      id: 1390de01-3916-4746-8a23-2cba75761a12
      version: -1
      name: Verify Context Data Error - CrowdStrike Found Detections
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'FoundDetections’ context key was not populated or its value was not set to 'false'. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:
          1- The 'Set no detections found' task failed.
          2- The 'key' input configuration was changed for the 'Set' automation used in the 'Set no detections found' task.
          3- The 'value' input configuration was changed for the 'Set' automation used in the 'Set no detections found' task.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -190,
          "y": -1530
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "243":
    id: "243"
    taskid: 27284c1b-b62f-4d1f-8633-4b2c19949eef
    type: condition
    task:
      id: 27284c1b-b62f-4d1f-8633-4b2c19949eef
      version: -1
      name: Verify CrowdStrike Found Detections
      description: Verify that the 'FoundDetections' context key was populated and its value was set to 'false'.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "227"
      Verified:
      - "264"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: CrowdStrike
                accessor: FoundDetections
            iscontext: true
          right:
            value:
              simple: "False"
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -190,
          "y": -1730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "246":
    id: "246"
    taskid: 41e574f3-efd0-4420-8524-c112ca5c9ff8
    type: condition
    task:
      id: 41e574f3-efd0-4420-8524-c112ca5c9ff8
      version: -1
      name: Verify Process Start Time
      description: Verify that the 'CrowdStrike.Detection.ProcessStartTime' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "254"
      Verified:
      - "269"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Detection
                accessor: ProcessStartTime
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -170,
          "y": -630
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "248":
    id: "248"
    taskid: c5ad27cd-cd4e-44db-84d7-757e857fd211
    type: playbook
    task:
      id: c5ad27cd-cd4e-44db-84d7-757e857fd211
      version: -1
      name: CrowdStrike Falcon - Get Detections by Incident
      description: |-
        This playbook is part of the 'Malware Investigation And Response' pack. For more information, refer to https://xsoar.pan.dev/docs/reference/packs/malware-investigation-and-response.
        This playbook enables getting CrowdStrike Falcon detection details based on the CrowdStrike incident ID.
      playbookName: CrowdStrike Falcon - Get Detections by Incident
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "361"
    scriptarguments:
      IncidentID:
        complex:
          root: CrowdStrike.Incidents
          filters:
          - - operator: isNotEmpty
              left:
                value:
                  simple: CrowdStrike.Incidents
                iscontext: true
          accessor: incident_id
          transformers:
          - operator: LastArrayElement
    separatecontext: false
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": -400,
          "y": -3320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "251":
    id: "251"
    taskid: 1d1bbb36-d850-40f6-8ae4-31e78931f014
    type: title
    task:
      id: 1d1bbb36-d850-40f6-8ae4-31e78931f014
      version: -1
      name: '''No Detections Found'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "366"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -190,
          "y": -2365
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "253":
    id: "253"
    taskid: 3583df3a-6088-41e2-85df-de2d9ba28a56
    type: title
    task:
      id: 3583df3a-6088-41e2-85df-de2d9ba28a56
      version: -1
      name: '''CrowdStrike.IncidentDetection'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "256"
      - "258"
      - "260"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -190,
          "y": -1360
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "254":
    id: "254"
    taskid: 39ae369d-5426-4777-8d3f-2f2648261718
    type: regular
    task:
      id: 39ae369d-5426-4777-8d3f-2f2648261718
      version: -1
      name: Verify Context Data Error - Process Start Time
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.ProcessStartTime’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.ProcessStartTime' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -170,
          "y": -420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "255":
    id: "255"
    taskid: 8ac4aa14-1466-457c-8739-16199c85184f
    type: title
    task:
      id: 8ac4aa14-1466-457c-8739-16199c85184f
      version: -1
      name: Check Context Data
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "368"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -650,
          "y": -2575
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "256":
    id: "256"
    taskid: 58c109a6-bf52-40c2-878a-f1912aa322a9
    type: condition
    task:
      id: 58c109a6-bf52-40c2-878a-f1912aa322a9
      version: -1
      name: Verify Incident ID
      description: Verify that the 'CrowdStrike.IncidentDetection.incident_id' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "257"
      Verified:
      - "263"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.IncidentDetection
                accessor: incident_id
            iscontext: true
          right:
            value: {}
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -190,
          "y": -1220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "257":
    id: "257"
    taskid: 7065c8da-27e1-47eb-8c00-b365a345c9f8
    type: regular
    task:
      id: 7065c8da-27e1-47eb-8c00-b365a345c9f8
      version: -1
      name: Verify Context Data Error - Incident ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'CrowdStrike.IncidentDetection.incident_id’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:
          1- The 'Get detections for incident' task failed.
          2- The 'incident_id' input configuration was changed for the 'cs-falcon-get-detections-for-incident' automation used in the 'Get detections for incident' task.
          3- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.incident_id' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -190,
          "y": -1010
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "258":
    id: "258"
    taskid: 97635d2f-e0df-47fd-80e6-198fd94fcbbf
    type: condition
    task:
      id: 97635d2f-e0df-47fd-80e6-198fd94fcbbf
      version: -1
      name: Verify Detection IDs
      description: Verify that the 'CrowdStrike.IncidentDetection.detection_ids' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "259"
      Verified:
      - "263"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.IncidentDetection
                accessor: detection_ids
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 200,
          "y": -1220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "259":
    id: "259"
    taskid: c56f9a2e-90c6-4daf-8fc7-454559087432
    type: regular
    task:
      id: c56f9a2e-90c6-4daf-8fc7-454559087432
      version: -1
      name: Verify Context Data Error - Detection IDs
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'CrowdStrike.IncidentDetection.detection_ids’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:
          1- The 'Get detections for incident' task failed.
          2- The 'incident_id' input configuration was changed for the 'cs-falcon-get-detections-for-incident' automation used in the 'Get detections for incident' task.
          3- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 200,
          "y": -1010
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "260":
    id: "260"
    taskid: 545e5472-3212-4695-8dc2-4013fab5fd60
    type: condition
    task:
      id: 545e5472-3212-4695-8dc2-4013fab5fd60
      version: -1
      name: Verify Behavior ID
      description: Verify that the 'CrowdStrike.IncidentDetection.behavior_id' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "261"
      Verified:
      - "263"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.IncidentDetection
                accessor: behavior_id
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": -1220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "261":
    id: "261"
    taskid: fb4143ec-cfe5-4ed4-8bd2-e467b95340d5
    type: regular
    task:
      id: fb4143ec-cfe5-4ed4-8bd2-e467b95340d5
      version: -1
      name: Verify Context Data Error - Behavior ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'CrowdStrike.IncidentDetection.behavior_id’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:
          1- The 'Get detections for incident' task failed.
          2- The 'incident_id' input configuration was changed for the 'cs-falcon-get-detections-for-incident' automation used in the 'Get detections for incident' task.
          3- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.behavior_id' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": -1010
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "262":
    id: "262"
    taskid: 8a8c9c6d-d0a6-49e7-849e-eb06b533981b
    type: title
    task:
      id: 8a8c9c6d-d0a6-49e7-849e-eb06b533981b
      version: -1
      name: '''CrowdStrike.Detection'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "246"
      - "267"
      - "278"
      - "282"
      - "284"
      - "286"
      - "288"
      - "290"
      - "334"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -170,
          "y": -770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "263":
    id: "263"
    taskid: 3ac9130e-7254-41f3-822c-849aeafee1b5
    type: title
    task:
      id: 3ac9130e-7254-41f3-822c-849aeafee1b5
      version: -1
      name: Done verifying 'CrowdStrike.IncidentDetection' Context Data
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "202"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5370,
          "y": -1030
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "264":
    id: "264"
    taskid: 72e208c3-c9da-46bf-8c1a-003cd0e53820
    type: title
    task:
      id: 72e208c3-c9da-46bf-8c1a-003cd0e53820
      version: -1
      name: Done verifying 'No Detections Found' Context Data
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "202"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5360,
          "y": -1550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "267":
    id: "267"
    taskid: 9a1fbdcb-1ce9-4157-8554-8c15d1fa42ba
    type: condition
    task:
      id: 9a1fbdcb-1ce9-4157-8554-8c15d1fa42ba
      version: -1
      name: Verify Max Severity
      description: Verify that the 'CrowdStrike.Detection.MaxSeverity' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "268"
      Verified:
      - "269"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Detection
                accessor: MaxSeverity
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 230,
          "y": -630
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "268":
    id: "268"
    taskid: 89e83460-a041-4297-8f06-9818942a27d9
    type: regular
    task:
      id: 89e83460-a041-4297-8f06-9818942a27d9
      version: -1
      name: Verify Context Data Error - Max Severity
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.MaxSeverity’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.MaxSeverity' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 230,
          "y": -420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "269":
    id: "269"
    taskid: 1f0cc5f0-2a2e-4a8e-80c5-8812002e6f0f
    type: title
    task:
      id: 1f0cc5f0-2a2e-4a8e-80c5-8812002e6f0f
      version: -1
      name: Done verifying 'CrowdStrike.Detection' Context Data
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "202"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5370,
          "y": -450
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "271":
    id: "271"
    taskid: ebe8369d-df9a-4de2-8957-d8953ebe77e6
    type: regular
    task:
      id: ebe8369d-df9a-4de2-8957-d8953ebe77e6
      version: -1
      name: Verify Context Data Error - First Behavior
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.FirstBehavior’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.FirstBehavior' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 630,
          "y": -420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "277":
    id: "277"
    taskid: 1a61d34d-ca70-4890-8f26-1a24abb50580
    type: regular
    task:
      id: 1a61d34d-ca70-4890-8f26-1a24abb50580
      version: -1
      name: Verify Context Data Error - Last Behavior
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.LastBehavior’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.LastBehavior' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1030,
          "y": -420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "278":
    id: "278"
    taskid: 4577ed06-2013-4e7b-8e5b-d3e214bf3c8b
    type: condition
    task:
      id: 4577ed06-2013-4e7b-8e5b-d3e214bf3c8b
      version: -1
      name: Verify Machine Domain
      description: Verify that the 'CrowdStrike.Detection.MachineDomain' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "279"
      Verified:
      - "269"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: CrowdStrike.Detection
                accessor: MachineDomain
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1430,
          "y": -630
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "279":
    id: "279"
    taskid: bca0b38b-8206-4666-8a7e-cf5d2dc9f6d0
    type: regular
    task:
      id: bca0b38b-8206-4666-8a7e-cf5d2dc9f6d0
      version: -1
      name: Verify Context Data Error - Machine Domain
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.MachineDomain’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.MachineDomain' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1430,
          "y": -420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "282":
    id: "282"
    taskid: 9f7460c8-4f6c-49d9-8632-9f4fa372a036
    type: condition
    task:
      id: 9f7460c8-4f6c-49d9-8632-9f4fa372a036
      version: -1
      name: Verify System
      description: Verify that the 'CrowdStrike.Detection.System' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "283"
      Verified:
      - "269"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Detection
                accessor: System
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1830,
          "y": -630
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "283":
    id: "283"
    taskid: ba336cbe-ba3d-443f-8cba-42a5cd1fccc8
    type: regular
    task:
      id: ba336cbe-ba3d-443f-8cba-42a5cd1fccc8
      version: -1
      name: Verify Context Data Error - System
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.System’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.System' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1830,
          "y": -420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "284":
    id: "284"
    taskid: 5155b2f8-6015-428a-8ff4-9075697132eb
    type: condition
    task:
      id: 5155b2f8-6015-428a-8ff4-9075697132eb
      version: -1
      name: Verify Status
      description: Verify that the 'CrowdStrike.Detection.Status' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "285"
      Verified:
      - "269"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Detection
                accessor: Status
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2230,
          "y": -630
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "285":
    id: "285"
    taskid: d53bf79d-0e59-4572-8f2a-6bf9ec72a859
    type: regular
    task:
      id: d53bf79d-0e59-4572-8f2a-6bf9ec72a859
      version: -1
      name: Verify Context Data Error - Status
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.Status’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Status' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2230,
          "y": -420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "286":
    id: "286"
    taskid: 621b3ab9-96fe-4fa9-8fdc-76b8fc8dbee0
    type: condition
    task:
      id: 621b3ab9-96fe-4fa9-8fdc-76b8fc8dbee0
      version: -1
      name: Verify Show In Ui
      description: Verify that the 'CrowdStrike.Detection.ShowInUi' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "287"
      Verified:
      - "269"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Detection
                accessor: ShowInUi
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2630,
          "y": -630
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "287":
    id: "287"
    taskid: b4f4581d-e907-4155-856a-85038ed8c405
    type: regular
    task:
      id: b4f4581d-e907-4155-856a-85038ed8c405
      version: -1
      name: Verify Context Data Error - ShowI n Ui
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.ShowInUi’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.ShowInUi' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2630,
          "y": -420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "288":
    id: "288"
    taskid: ea9c8fdf-d8f5-43dc-8ed3-c6f26f79f9d2
    type: condition
    task:
      id: ea9c8fdf-d8f5-43dc-8ed3-c6f26f79f9d2
      version: -1
      name: Verify Customer ID
      description: Verify that the 'CrowdStrike.Detection.CustomerID' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "289"
      Verified:
      - "269"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Detection
                accessor: CustomerID
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3030,
          "y": -630
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "289":
    id: "289"
    taskid: b0c1ec82-e848-4606-810d-03bfa9211e0e
    type: regular
    task:
      id: b0c1ec82-e848-4606-810d-03bfa9211e0e
      version: -1
      name: Verify Context Data Error - Customer ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.CustomerID’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.CustomerID' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3030,
          "y": -420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "290":
    id: "290"
    taskid: f100ec46-bef3-42d5-8db1-17b902136ed8
    type: condition
    task:
      id: f100ec46-bef3-42d5-8db1-17b902136ed8
      version: -1
      name: Verify ID
      description: Verify that the 'CrowdStrike.Detection.ID' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "291"
      Verified:
      - "269"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Detection
                accessor: ID
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3430,
          "y": -630
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "291":
    id: "291"
    taskid: 83b0248e-b162-44b3-837a-357f9c64f804
    type: regular
    task:
      id: 83b0248e-b162-44b3-837a-357f9c64f804
      version: -1
      name: Verify Context Data Error - ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.ID’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.ID' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3430,
          "y": -420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "292":
    id: "292"
    taskid: fd8ba064-d8de-4a50-8fdc-3e6217d1b726
    type: title
    task:
      id: fd8ba064-d8de-4a50-8fdc-3e6217d1b726
      version: -1
      name: '''CrowdStrike.Detection.Behavior'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "293"
      - "295"
      - "297"
      - "303"
      - "305"
      - "309"
      - "311"
      - "313"
      - "317"
      - "323"
      - "325"
      - "327"
      - "315"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -170,
          "y": -170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "293":
    id: "293"
    taskid: 16043db5-71ec-4a40-8bab-68066c5d2e2f
    type: condition
    task:
      id: 16043db5-71ec-4a40-8bab-68066c5d2e2f
      version: -1
      name: Verify Parent Process ID
      description: Verify that the 'CrowdStrike.Detection.Behavior.ParentProcessID' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "294"
      Verified:
      - "331"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: ParentProcessID
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -170,
          "y": -30
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "294":
    id: "294"
    taskid: 12fff737-06e1-4533-8139-149734876e29
    type: regular
    task:
      id: 12fff737-06e1-4533-8139-149734876e29
      version: -1
      name: Verify Context Data Error - Parent Process ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.Behavior.ParentProcessID’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.ParentProcessID' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -170,
          "y": 180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "295":
    id: "295"
    taskid: f05bb869-91fc-4564-84dd-17009eb3c2bd
    type: condition
    task:
      id: f05bb869-91fc-4564-84dd-17009eb3c2bd
      version: -1
      name: Verify File Path
      description: Verify that the 'CrowdStrike.Detection.Behavior.Filepath' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "296"
      Verified:
      - "331"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: Filepath
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 220,
          "y": -30
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "296":
    id: "296"
    taskid: 3628d4e8-e3f8-4f8d-8908-00a81e65ac05
    type: regular
    task:
      id: 3628d4e8-e3f8-4f8d-8908-00a81e65ac05
      version: -1
      name: Verify Context Data Error - File Path
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.Behavior.Filepath’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.Filepath' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 220,
          "y": 180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "297":
    id: "297"
    taskid: 2336647a-815b-4886-82fd-b9079961f151
    type: condition
    task:
      id: 2336647a-815b-4886-82fd-b9079961f151
      version: -1
      name: Verify Pattern Disposition
      description: Verify that the 'CrowdStrike.Detection.Behavior.PatternDisposition' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "298"
      Verified:
      - "331"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: PatternDisposition
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 610,
          "y": -30
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "298":
    id: "298"
    taskid: 999c0ba1-3045-40d1-8f93-8cde2195cf4e
    type: regular
    task:
      id: 999c0ba1-3045-40d1-8f93-8cde2195cf4e
      version: -1
      name: Verify Context Data Error - Pattern Disposition
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.Behavior.PatternDisposition’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.PatternDisposition' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 610,
          "y": 180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "303":
    id: "303"
    taskid: 76f0d039-117e-4dc6-8c48-4e31cc1e16ba
    type: condition
    task:
      id: 76f0d039-117e-4dc6-8c48-4e31cc1e16ba
      version: -1
      name: Verify Confidence
      description: Verify that the 'CrowdStrike.Detection.Behavior.Confidence' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "304"
      Verified:
      - "331"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: Confidence
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1010,
          "y": -30
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "304":
    id: "304"
    taskid: 33affa60-cfe6-4654-8cae-e00eb8a78d24
    type: regular
    task:
      id: 33affa60-cfe6-4654-8cae-e00eb8a78d24
      version: -1
      name: Verify Context Data Error - Confidence
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.Behavior.Confidence’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.Confidence' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1010,
          "y": 180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "305":
    id: "305"
    taskid: d723aadd-337c-4c92-83cf-821accf50028
    type: condition
    task:
      id: d723aadd-337c-4c92-83cf-821accf50028
      version: -1
      name: Verify Process ID
      description: Verify that the 'CrowdStrike.Detection.Behavior.ProcessID' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "306"
      Verified:
      - "331"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: ProcessID
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1400,
          "y": -30
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "306":
    id: "306"
    taskid: ec40eedf-9deb-4902-889d-e07f1aa37bfb
    type: regular
    task:
      id: ec40eedf-9deb-4902-889d-e07f1aa37bfb
      version: -1
      name: Verify Context Data Error - Process ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.Behavior.ProcessID’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.ProcessID' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1400,
          "y": 180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "309":
    id: "309"
    taskid: d5ee8c7d-7473-429f-821e-b629102a5fa9
    type: condition
    task:
      id: d5ee8c7d-7473-429f-821e-b629102a5fa9
      version: -1
      name: Verify Display Name
      description: Verify that the 'CrowdStrike.Detection.Behavior.DisplayName' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "310"
      Verified:
      - "331"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: DisplayName
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1790,
          "y": -30
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "310":
    id: "310"
    taskid: 7d6af9f0-038f-4796-8c1d-2200f31d283a
    type: regular
    task:
      id: 7d6af9f0-038f-4796-8c1d-2200f31d283a
      version: -1
      name: Verify Context Data Error - Display Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.Behavior.DisplayName’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.DisplayName' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1790,
          "y": 180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "311":
    id: "311"
    taskid: a70115f1-c3ab-4a5a-87d1-2c4e3e758388
    type: condition
    task:
      id: a70115f1-c3ab-4a5a-87d1-2c4e3e758388
      version: -1
      name: Verify Technique
      description: Verify that the 'CrowdStrike.Detection.Behavior.Technique' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "312"
      Verified:
      - "331"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: Technique
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2190,
          "y": -30
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "312":
    id: "312"
    taskid: 25c81561-ec50-4bfe-812b-ff6b3c260846
    type: regular
    task:
      id: 25c81561-ec50-4bfe-812b-ff6b3c260846
      version: -1
      name: Verify Context Data Error - Technique
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.Behavior.Technique’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.Technique' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2190,
          "y": 180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "313":
    id: "313"
    taskid: 6fde00e1-5650-4a3a-8411-8180361d4b45
    type: condition
    task:
      id: 6fde00e1-5650-4a3a-8411-8180361d4b45
      version: -1
      name: Verify Scenario
      description: Verify that the 'CrowdStrike.Detection.Behavior.Scenario' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "314"
      Verified:
      - "331"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: Scenario
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2580,
          "y": -30
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "314":
    id: "314"
    taskid: bfca0ee9-f725-404c-85ee-b049a5268f54
    type: regular
    task:
      id: bfca0ee9-f725-404c-85ee-b049a5268f54
      version: -1
      name: Verify Context Data Error - Scenario
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.Behavior.Scenario’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.Scenario' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2580,
          "y": 180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "315":
    id: "315"
    taskid: 63870a16-6625-4ac1-8f24-25cb97c3dd59
    type: condition
    task:
      id: 63870a16-6625-4ac1-8f24-25cb97c3dd59
      version: -1
      name: Verify Tactic ID
      description: Verify that the 'CrowdStrike.Detection.Behavior.TacticID' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "316"
      Verified:
      - "331"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: TacticID
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2980,
          "y": -30
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "316":
    id: "316"
    taskid: 6e6927ae-190e-46a1-8611-66397df0ea37
    type: regular
    task:
      id: 6e6927ae-190e-46a1-8611-66397df0ea37
      version: -1
      name: Verify Context Data Error - Tactic ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.Behavior.TacticID’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.TacticID' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2980,
          "y": 180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "317":
    id: "317"
    taskid: e4d5eb50-b53f-453b-80b4-690de73c3b27
    type: condition
    task:
      id: e4d5eb50-b53f-453b-80b4-690de73c3b27
      version: -1
      name: Verify IOC Value
      description: Verify that the 'CrowdStrike.Detection.Behavior.IOCValue' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "318"
      Verified:
      - "331"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: IOCValue
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3370,
          "y": -30
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "318":
    id: "318"
    taskid: 7a6c302e-c497-4c28-8909-9de0f5c42149
    type: regular
    task:
      id: 7a6c302e-c497-4c28-8909-9de0f5c42149
      version: -1
      name: Verify Context Data Error - IOC Value
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.Behavior.IOCValue’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.IOCValue' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3370,
          "y": 180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "323":
    id: "323"
    taskid: 01af61cc-7a4a-4da1-8e91-5e918daa9557
    type: condition
    task:
      id: 01af61cc-7a4a-4da1-8e91-5e918daa9557
      version: -1
      name: Verify IOC Type
      description: Verify that the 'CrowdStrike.Detection.Behavior.IOCType' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "324"
      Verified:
      - "331"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: IOCType
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3770,
          "y": -30
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "324":
    id: "324"
    taskid: db4e6235-b2e2-4734-82a7-fcc616b52e1f
    type: regular
    task:
      id: db4e6235-b2e2-4734-82a7-fcc616b52e1f
      version: -1
      name: Verify Context Data Error - IOC Type
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.Behavior.IOCType’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.IOCType' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3770,
          "y": 180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "325":
    id: "325"
    taskid: 23721cf6-1e38-46c7-85ac-6fa5950574d4
    type: condition
    task:
      id: 23721cf6-1e38-46c7-85ac-6fa5950574d4
      version: -1
      name: Verify Tactic
      description: Verify that the 'CrowdStrike.Detection.Behavior.Tactic' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "326"
      Verified:
      - "331"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: Tactic
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4160,
          "y": -30
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "326":
    id: "326"
    taskid: 0d55cf78-28a3-4847-876c-322de24d8470
    type: regular
    task:
      id: 0d55cf78-28a3-4847-876c-322de24d8470
      version: -1
      name: Verify Context Data Error - Tactic
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.Behavior.Tactic’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.Tactic' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4160,
          "y": 180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "327":
    id: "327"
    taskid: a39caa55-916c-420d-82a5-e3e6470b5af9
    type: condition
    task:
      id: a39caa55-916c-420d-82a5-e3e6470b5af9
      version: -1
      name: Verify Alleged File Type
      description: Verify that the 'CrowdStrike.Detection.Behavior.AllegedFiletype' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "328"
      Verified:
      - "331"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: AllegedFiletype
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4550,
          "y": -30
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "328":
    id: "328"
    taskid: 34e7430c-6f06-47bf-8927-886b007f9527
    type: regular
    task:
      id: 34e7430c-6f06-47bf-8927-886b007f9527
      version: -1
      name: Verify Context Data Error - Alleged File Type
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.Behavior.AllegedFiletype’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.AllegedFiletype' context key. \n4- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n5- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n6 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4550,
          "y": 180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "331":
    id: "331"
    taskid: f676334b-ff1c-48ea-8408-345ab7a3931e
    type: title
    task:
      id: f676334b-ff1c-48ea-8408-345ab7a3931e
      version: -1
      name: Done verifying 'CrowdStrike.Detection.Behavior' Context Data
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "202"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5370,
          "y": 150
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "334":
    id: "334"
    taskid: 840fc450-38ab-464d-822a-c98aea71c3d3
    type: condition
    task:
      id: 840fc450-38ab-464d-822a-c98aea71c3d3
      version: -1
      name: Verify Device
      description: Verify that the 'CrowdStrike.Detection.Device' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "335"
      Verified:
      - "269"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Detection
                accessor: Device
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4220,
          "y": -630
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "335":
    id: "335"
    taskid: 8e1daf61-71eb-4388-8c99-92fa0f54b83b
    type: regular
    task:
      id: 8e1daf61-71eb-4388-8c99-92fa0f54b83b
      version: -1
      name: Verify Context Data Error - Device
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'CrowdStrike.Detection.Device’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'Get full detection details' task failed.\n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The 'extended_data' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n4- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Device' context key. \n5- The 'cs-falcon-get-detections-for-incident' automation outputs have been modified and no longer contain the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input configuration of 'cs-falcon-search-detection' automation.\n6- The 'Get detections for incident' task that uses the 'cs-falcon-get-detections-for-incident' automation failed to execute. As a result, the 'CrowdStrike.IncidentDetection.detection_ids' context key which is used for the 'ids' input within the 'cs-falcon-search-detection' automation was empty.\n7 - The 'Get detections for incident' task utilizing the automation 'cs-falcon-get-detections-for-incident' produced no results. Therefore, instead of progressing to the \"Get full detection details\" task, the playbook flow proceeded to the \"Set no detections found\" task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4220,
          "y": -420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "339":
    id: "339"
    taskid: 46b8d364-e9bb-4dd7-8a57-0a4afd9d4413
    type: title
    task:
      id: 46b8d364-e9bb-4dd7-8a57-0a4afd9d4413
      version: -1
      name: Check Incident Fields
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "340"
      - "342"
      - "344"
      - "346"
      - "348"
      - "350"
      - "352"
      - "356"
      - "358"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -180,
          "y": -3020
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "340":
    id: "340"
    taskid: 3d274314-6c05-4e0b-8fa6-053adfd936dd
    type: condition
    task:
      id: 3d274314-6c05-4e0b-8fa6-053adfd936dd
      version: -1
      name: Verify File Names
      description: |
        Verify that the ‘filenames’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "341"
      Verified:
      - "360"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: inList
          left:
            value:
              complex:
                root: incident
                accessor: filenames
            iscontext: true
          right:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: FileName
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -180,
          "y": -2880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "341":
    id: "341"
    taskid: 9dc9ac35-7e59-4640-81cf-fdbd795cbe65
    type: regular
    task:
      id: 9dc9ac35-7e59-4640-81cf-fdbd795cbe65
      version: -1
      name: Verify Incident Field Error - File Names
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'filenames' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.FileName' context key. \n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The custom output mapping rule for the 'filenames' incident field configured within the 'Get full detection details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -180,
          "y": -2670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "342":
    id: "342"
    taskid: bdce916e-2ac3-4c4f-81df-efa18d98a17f
    type: condition
    task:
      id: bdce916e-2ac3-4c4f-81df-efa18d98a17f
      version: -1
      name: Verify Scenario
      description: |
        Verify that the ‘Scenario’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "343"
      Verified:
      - "360"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: inList
          left:
            value:
              complex:
                root: incident
                accessor: scenario
            iscontext: true
          right:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: Scenario
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 210,
          "y": -2880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "343":
    id: "343"
    taskid: ac47749c-a10a-41cc-804f-5a91c3da17aa
    type: regular
    task:
      id: ac47749c-a10a-41cc-804f-5a91c3da17aa
      version: -1
      name: Verify Incident Field Error - Scenario
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Scenario' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.Scenario' context key. \n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The custom output mapping rule for the 'Scenario' incident field configured within the 'Get full detection details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 210,
          "y": -2670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "344":
    id: "344"
    taskid: 0628a255-daf9-496b-89c4-1c61b7f630c2
    type: condition
    task:
      id: 0628a255-daf9-496b-89c4-1c61b7f630c2
      version: -1
      name: Verify Process MD5
      description: |
        Verify that the ‘processmd5’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "345"
      Verified:
      - "360"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: inList
          left:
            value:
              complex:
                root: incident
                accessor: processmd5
            iscontext: true
          right:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: MD5
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 600,
          "y": -2880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "345":
    id: "345"
    taskid: bec334a9-f01e-4518-8be7-8c3c76a2b782
    type: regular
    task:
      id: bec334a9-f01e-4518-8be7-8c3c76a2b782
      version: -1
      name: Verify Incident Field Error - Process MD5
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'processmd5' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.MD5' context key. \n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The custom output mapping rule for the 'processmd5' incident field configured within the 'Get full detection details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 600,
          "y": -2670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "346":
    id: "346"
    taskid: bef5ca50-5494-4ce0-8b77-b1944018a6b0
    type: condition
    task:
      id: bef5ca50-5494-4ce0-8b77-b1944018a6b0
      version: -1
      name: Verify Process SHA256
      description: |
        Verify that the ‘parentprocesssha256’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "347"
      Verified:
      - "360"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: inList
          left:
            value:
              complex:
                root: incident
                accessor: processsha256
            iscontext: true
          right:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: SHA256
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 990,
          "y": -2880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "347":
    id: "347"
    taskid: 7be1abc1-ade7-4ac0-8f25-15b9c3e5db6b
    type: regular
    task:
      id: 7be1abc1-ade7-4ac0-8f25-15b9c3e5db6b
      version: -1
      name: Verify Incident Field Error - Process SHA256
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'parentprocesssha256' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.SHA256' context key. \n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The custom output mapping rule for the 'parentprocesssha256' incident field configured within the 'Get full detection details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 990,
          "y": -2670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "348":
    id: "348"
    taskid: 91a8947c-121a-46cf-82f7-30b4ca50b6fe
    type: condition
    task:
      id: 91a8947c-121a-46cf-82f7-30b4ca50b6fe
      version: -1
      name: Verify Process CMD
      description: |
        Verify that the ‘processcmd’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "349"
      Verified:
      - "360"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: inList
          left:
            value:
              complex:
                root: incident
                accessor: processcmd
            iscontext: true
          right:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: CommandLine
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1380,
          "y": -2880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "349":
    id: "349"
    taskid: dd6bf8ef-f2ad-4da3-83fd-dddd3d594a3f
    type: regular
    task:
      id: dd6bf8ef-f2ad-4da3-83fd-dddd3d594a3f
      version: -1
      name: Verify Incident Field Error - Process CMD
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'processcmd' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.CommandLine' context key. \n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The custom output mapping rule for the 'processcmd' incident field configured within the 'Get full detection details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1380,
          "y": -2670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "350":
    id: "350"
    taskid: 40dff3fc-fcc1-414d-8757-762e92f58c3e
    type: condition
    task:
      id: 40dff3fc-fcc1-414d-8757-762e92f58c3e
      version: -1
      name: Verify External Confidence
      description: |
        Verify that the ‘externalconfidence’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "351"
      Verified:
      - "360"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: inList
          left:
            value:
              complex:
                root: incident
                accessor: externalconfidence
            iscontext: true
          right:
            value:
              complex:
                root: CrowdStrike.Detection
                accessor: MaxConfidence
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": -2880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "351":
    id: "351"
    taskid: 3426941a-b624-4e67-8599-178f36c89fec
    type: regular
    task:
      id: 3426941a-b624-4e67-8599-178f36c89fec
      version: -1
      name: Verify Incident Field Error - External Confidence
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'externalconfidence' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.MaxConfidence' context key. \n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The custom output mapping rule for the 'externalconfidence' incident field configured within the 'Get full detection details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": -2670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "352":
    id: "352"
    taskid: 479997ec-54ad-4c80-8266-f228f2dda3f1
    type: condition
    task:
      id: 479997ec-54ad-4c80-8266-f228f2dda3f1
      version: -1
      name: Verify Users
      description: |
        Verify that the ‘users’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "353"
      Verified:
      - "360"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: inList
          left:
            value:
              complex:
                root: incident
                accessor: users
            iscontext: true
          right:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: UserName
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2160,
          "y": -2880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "353":
    id: "353"
    taskid: 31fe5e9f-d02b-4e85-80ee-7f10af822ad2
    type: regular
    task:
      id: 31fe5e9f-d02b-4e85-80ee-7f10af822ad2
      version: -1
      name: Verify Incident Field Error - Users
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'users' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.UserName' context key. \n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The custom output mapping rule for the 'users' incident field configured within the 'Get full detection details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2160,
          "y": -2670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "356":
    id: "356"
    taskid: d91b1627-4d84-4f67-8306-1f7ff83dc1a4
    type: condition
    task:
      id: d91b1627-4d84-4f67-8306-1f7ff83dc1a4
      version: -1
      name: Verify Technique ID
      description: |
        Verify that the ‘techniqueid’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "357"
      Verified:
      - "360"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: inList
          left:
            value:
              complex:
                root: incident
                accessor: techniqueid
            iscontext: true
          right:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: TechniqueId
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2550,
          "y": -2880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "357":
    id: "357"
    taskid: 8fdae111-02f7-4a00-8896-bbaa36891624
    type: regular
    task:
      id: 8fdae111-02f7-4a00-8896-bbaa36891624
      version: -1
      name: Verify Incident Field Error - Technique ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'techniqueid' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.TechniqueId' context key. \n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The custom output mapping rule for the 'techniqueid' incident field configured within the 'Get full detection details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2550,
          "y": -2670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "358":
    id: "358"
    taskid: 9a1bea71-7276-4986-871d-239f6e150bc9
    type: condition
    task:
      id: 9a1bea71-7276-4986-871d-239f6e150bc9
      version: -1
      name: Verify File SHA256
      description: |
        Verify that the ‘filesha256’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "359"
      Verified:
      - "360"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: inList
          left:
            value:
              complex:
                root: incident
                accessor: filesha256
            iscontext: true
          right:
            value:
              complex:
                root: CrowdStrike.Detection.Behavior
                accessor: SHA256
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2940,
          "y": -2880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "359":
    id: "359"
    taskid: 80d75067-395d-4d11-8686-564bbb2f8428
    type: regular
    task:
      id: 80d75067-395d-4d11-8686-564bbb2f8428
      version: -1
      name: Verify Incident Field Error - File SHA256
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'filesha256' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon - Get Detections by Incident' playbook:\n1- The 'cs-falcon-search-detection' automation outputs have been modified and no longer contain the 'CrowdStrike.Detection.Behavior.SHA256' context key. \n2- The 'ids' input configuration was changed for the 'cs-falcon-search-detection' automation used in the 'Get full detection details' task.\n3- The custom output mapping rule for the 'filesha256' incident field configured within the 'Get full detection details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2940,
          "y": -2670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "360":
    id: "360"
    taskid: ffebd028-6e50-4bb0-8659-9b94acec27ea
    type: title
    task:
      id: ffebd028-6e50-4bb0-8659-9b94acec27ea
      version: -1
      name: Done verifying Incident Fields
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "202"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5360,
          "y": -2700
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "361":
    id: "361"
    taskid: 2d8a3578-6e9a-4665-8b79-8d67e6fbc94c
    type: title
    task:
      id: 2d8a3578-6e9a-4665-8b79-8d67e6fbc94c
      version: -1
      name: Start Testing
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "339"
      - "255"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -400,
          "y": -3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "362":
    id: "362"
    taskid: 802a7e4a-5e5a-4501-8d5e-acbe41a68f48
    type: playbook
    task:
      id: 802a7e4a-5e5a-4501-8d5e-acbe41a68f48
      version: -1
      name: CrowdStrike Falcon - Get Detections by Incident
      description: |-
        This playbook is part of the 'Malware Investigation And Response' pack. For more information, refer to https://xsoar.pan.dev/docs/reference/packs/malware-investigation-and-response.
        This playbook enables getting CrowdStrike Falcon detection details based on the CrowdStrike incident ID.
      playbookName: CrowdStrike Falcon - Get Detections by Incident
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "243"
    scriptarguments:
      IncidentID:
        complex:
          root: CrowdStrike.Detections
          accessor: detection_id
          transformers:
          - operator: FirstArrayElement
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": -190,
          "y": -1890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "363":
    id: "363"
    taskid: 9637be01-77cb-4b6c-800c-d16cf2c82807
    type: regular
    task:
      id: 9637be01-77cb-4b6c-800c-d16cf2c82807
      version: -1
      name: Get CrowdStrike Falcon Available Incidents
      description: Obtains a list of CrowdStrike Falcon incidents before performing the tests.
      script: '|||cs-falcon-list-incident-summaries'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "364"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -400,
          "y": -3660
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "364":
    id: "364"
    taskid: c54ecbfc-b9aa-47d2-887a-571f96372eca
    type: condition
    task:
      id: c54ecbfc-b9aa-47d2-887a-571f96372eca
      version: -1
      name: Check CrowdStrike Falcon Available Incidents
      description: Checks if there are available incidents for testing processes.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "202"
      "yes":
      - "248"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Incidents
                accessor: incident_id
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -400,
          "y": -3490
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "366":
    id: "366"
    taskid: b46e0f21-7502-42d8-8c75-4b6f89b2fe8a
    type: regular
    task:
      id: b46e0f21-7502-42d8-8c75-4b6f89b2fe8a
      version: -1
      name: Get CrowdStrike Falcon Available Detections
      description: Lists detection summaries.
      script: CrowdstrikeFalcon|||cs-falcon-list-detection-summaries
      type: regular
      iscommand: true
      brand: CrowdstrikeFalcon
    nexttasks:
      '#none#':
      - "367"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -190,
          "y": -2230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "367":
    id: "367"
    taskid: a22ab565-953c-4d44-8589-bd37f0f0e1bf
    type: condition
    task:
      id: a22ab565-953c-4d44-8589-bd37f0f0e1bf
      version: -1
      name: Check CrowdStrike Falcon Available Incidents
      description: Checks if there are available detections for testing processes.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "202"
      "yes":
      - "362"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CrowdStrike.Detections
                accessor: detection_id
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -190,
          "y": -2065
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "368":
    id: "368"
    taskid: ee681c42-894d-4866-834c-bbd7db012a6b
    type: condition
    task:
      id: ee681c42-894d-4866-834c-bbd7db012a6b
      version: -1
      name: CrowdStrike.FoundDetections is False
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "369"
      "yes":
      - "251"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: CrowdStrike
                accessor: FoundDetections
            iscontext: true
          right:
            value:
              simple: "False"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -1630,
          "y": -1410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "369":
    id: "369"
    taskid: e160d874-9803-4ef8-8e2f-2aaa0fdec877
    type: title
    task:
      id: e160d874-9803-4ef8-8e2f-2aaa0fdec877
      version: -1
      name: No Detections was found
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "253"
      - "262"
      - "292"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -1560,
          "y": -1180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "246_269_Verified": 0.1,
      "256_263_Verified": 0.11,
      "258_263_Verified": 0.14,
      "260_263_Verified": 0.1,
      "267_269_Verified": 0.11,
      "278_269_Verified": 0.1,
      "282_269_Verified": 0.1,
      "284_269_Verified": 0.11,
      "286_269_Verified": 0.1,
      "288_269_Verified": 0.12,
      "290_269_Verified": 0.1,
      "293_331_Verified": 0.1,
      "295_331_Verified": 0.1,
      "297_331_Verified": 0.1,
      "303_331_Verified": 0.1,
      "305_331_Verified": 0.1,
      "309_331_Verified": 0.1,
      "311_331_Verified": 0.11,
      "313_331_Verified": 0.1,
      "315_331_Verified": 0.1,
      "317_331_Verified": 0.12,
      "323_331_Verified": 0.1,
      "325_331_Verified": 0.12,
      "327_331_Verified": 0.15,
      "334_269_Verified": 0.24,
      "340_360_Verified": 0.11,
      "342_360_Verified": 0.1,
      "344_360_Verified": 0.1,
      "348_360_Verified": 0.1,
      "350_360_Verified": 0.1,
      "352_360_Verified": 0.1,
      "356_360_Verified": 0.16,
      "358_360_Verified": 0.2,
      "364_248_yes": 0.53
    },
    "paper": {
      "dimensions": {
        "height": 4310,
        "width": 7700,
        "x": -1630,
        "y": -3955
      }
    }
  }
inputs: []
outputs: []
fromversion: 6.5.0
