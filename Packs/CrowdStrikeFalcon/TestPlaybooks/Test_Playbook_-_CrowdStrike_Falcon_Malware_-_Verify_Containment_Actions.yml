id: Test Playbook - CrowdStrike Falcon Malware - Verify Containment Actions
version: -1
name: Test Playbook - CrowdStrike Falcon Malware - Verify Containment Actions
description: "This playbook tests the 'CrowdStrike Falcon Malware - Verify Containment Actions' playbook which is part of the 'Malware Investigation and Response' pack.\n\nFollowing are the tests conducted in the playbook:\n1 - Ensure context data is correctly populated by the 'set' automation used in the playbook tasks. \n2- Validate the outputs of the playbook."
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 04cc1ec2-c67c-4f81-8510-8d19a22bebd7
    type: start
    task:
      id: 04cc1ec2-c67c-4f81-8510-8d19a22bebd7
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "32"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -450,
          "y": -1305
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: ff924033-888c-4214-8937-e16a8de7912f
    type: regular
    task:
      id: ff924033-888c-4214-8937-e16a8de7912f
      version: -1
      name: Delete Context
      description: The task deletes all of the context data. Having a clean beginning to a test playbook ensures that a test can be sterile and that unrelated issues can be eliminated.
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "252"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -450,
          "y": -1175
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "252":
    id: "252"
    taskid: a302cb08-5908-4106-8b38-0f90eff3a274
    type: regular
    task:
      id: a302cb08-5908-4106-8b38-0f90eff3a274
      version: -1
      name: Set Incident Fields To Context
      description: Add incident fields required for testing to the mock incident.
      script: Builtin|||setIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "429"
      - "435"
      - "438"
      - "441"
      - "432"
    scriptarguments:
      type:
        simple: Malware Investigation and Response
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -450,
          "y": -1010
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "283":
    id: "283"
    taskid: 44a33288-0d06-4f62-87d5-a9bf57697918
    type: title
    task:
      id: 44a33288-0d06-4f62-87d5-a9bf57697918
      version: -1
      name: Check Playbook Outputs
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "380"
      - "399"
      - "401"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 570,
          "y": -375
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "380":
    id: "380"
    taskid: 8f8ecebe-d79f-40dd-8160-2f10e4ed674b
    type: condition
    task:
      id: 8f8ecebe-d79f-40dd-8160-2f10e4ed674b
      version: -1
      name: Verify Policy State - Active
      description: Verify that the 'Policy.State' context key was populated and set to 'Active'.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "381"
      Verified:
      - "449"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Policy
                accessor: State
            iscontext: true
          right:
            value:
              simple: Active
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 170,
          "y": -230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "381":
    id: "381"
    taskid: 2162ec15-ccd9-4633-85a0-1c1cd20bb520
    type: regular
    task:
      id: 2162ec15-ccd9-4633-85a0-1c1cd20bb520
      version: -1
      name: Verify Playbook Output Error - Policy State - Active
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'Policy.State’ context key was not populated or was not set to 'Active' This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon Malware - Verify Containment Actions' playbook:
          1- The conditions for the 'Is policy enabled?' task were changed.
          2- The 'key' input configuration was changed for the 'Set' automation used in the 'Set policy status active' task.
          3- The 'value' input configuration was changed for the 'Set' automation used in the 'Set policy status active' task.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 170,
          "y": -35
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "399":
    id: "399"
    taskid: 7272235f-6ef8-46cd-81cf-98b8f9a9f030
    type: condition
    task:
      id: 7272235f-6ef8-46cd-81cf-98b8f9a9f030
      version: -1
      name: Verify Host State - Not Isolated
      description: Verify that the 'Host.State' context key was populated and set to 'Not Isolated'.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "400"
      Verified:
      - "449"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Host
                accessor: State
            iscontext: true
          right:
            value:
              simple: Not Isolated
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 570,
          "y": -230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "400":
    id: "400"
    taskid: 2a25adae-85e2-4a4b-814e-b160e2e85491
    type: regular
    task:
      id: 2a25adae-85e2-4a4b-814e-b160e2e85491
      version: -1
      name: Verify Playbook Output Error - Host State - Not Isolated
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'Host.State’ context key was not populated or was not set to 'Not Isolated' This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon Malware - Verify Containment Actions' playbook:
          1- The conditions for the 'Was host isolated?' task were changed.
          2- The 'key' input configuration was changed for the 'Set' automation used in the 'Set host no isolated' task.
          3- The 'value' input configuration was changed for the 'Set' automation used in the 'Set host no isolated' task.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 570,
          "y": -35
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "401":
    id: "401"
    taskid: 939570af-1857-4ae9-8b7d-9ad85fe4ad05
    type: condition
    task:
      id: 939570af-1857-4ae9-8b7d-9ad85fe4ad05
      version: -1
      name: Verify Process State - Process Killed
      description: Verify that the 'Process.State' context key was populated and set to 'killed'.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "402"
      Verified:
      - "449"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Process
                accessor: State
            iscontext: true
          right:
            value:
              simple: Killed
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 970,
          "y": -230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "402":
    id: "402"
    taskid: a46026f7-28c1-4cab-806c-5225a469c58a
    type: regular
    task:
      id: a46026f7-28c1-4cab-806c-5225a469c58a
      version: -1
      name: Verify Playbook Output Error - Process State - Process Killed
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'Process.State’ context key was not populated or was not set to 'killed' This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon Malware - Verify Containment Actions' playbook:
          1- The conditions for the 'Was process handled?' task were changed.
          2- The 'key' input configuration was changed for the 'Set' automation used in the 'Set process killed' task.
          3- The 'value' input configuration was changed for the 'Set' automation used in the 'Set process killed' task.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 970,
          "y": -35
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "428":
    id: "428"
    taskid: 22a405ba-3c1e-48af-88aa-79ba841d9bb9
    type: regular
    task:
      id: 22a405ba-3c1e-48af-88aa-79ba841d9bb9
      version: -1
      name: Set Policy Behavior Details To Context
      description: Set multiple keys/values to the context.
      scriptName: SetMultipleValues
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "430"
    scriptarguments:
      keys:
        simple: policy_disabled
      parent:
        simple: FirstScenario
      values:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1780,
          "y": -700
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "429":
    id: "429"
    taskid: 7cc02985-1f08-4602-80ea-32b7f930d9df
    type: title
    task:
      id: 7cc02985-1f08-4602-80ea-32b7f930d9df
      version: -1
      name: Test Policy State not Active Scenario
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "428"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1780,
          "y": -835
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "430":
    id: "430"
    taskid: 68787b30-7e27-4474-8213-7799c95d80ba
    type: playbook
    task:
      id: 68787b30-7e27-4474-8213-7799c95d80ba
      version: -1
      name: CrowdStrike Falcon Malware - Verify Containment Actions
      description: |-
        This playbook is part of the 'Malware Investigation And Response' pack. For more information, refer to https://xsoar.pan.dev/docs/reference/packs/malware-investigation-and-response.
        This playbook verifies and sets the policy actions applied by CrowdStrike Falcon.
      playbookName: CrowdStrike Falcon Malware - Verify Containment Actions
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "443"
    scriptarguments:
      PolicyBehaviourDetails:
        complex:
          root: FirstScenario
    separatecontext: false
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 1780,
          "y": -540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "431":
    id: "431"
    taskid: 04439117-fef6-47e5-89b3-525e13dcfe1d
    type: regular
    task:
      id: 04439117-fef6-47e5-89b3-525e13dcfe1d
      version: -1
      name: Set Policy Behavior Details To Context
      description: Set multiple keys/values to the context.
      scriptName: SetMultipleValues
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "433"
    scriptarguments:
      keys:
        simple: policy_disabled,quarantine_machine,kill_process
      parent:
        simple: SecondScenario
      values:
        simple: false,false,true
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 570,
          "y": -700
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "432":
    id: "432"
    taskid: b9d5d9fc-ce40-497e-856b-af8bf45794fc
    type: title
    task:
      id: b9d5d9fc-ce40-497e-856b-af8bf45794fc
      version: -1
      name: Test Policy State Active & Not Isolated Host & Process Killed Scenario
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "431"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 570,
          "y": -835
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "433":
    id: "433"
    taskid: 0ebda233-ea29-4b4c-8c76-187872d6a4e3
    type: playbook
    task:
      id: 0ebda233-ea29-4b4c-8c76-187872d6a4e3
      version: -1
      name: CrowdStrike Falcon Malware - Verify Containment Actions
      description: |-
        This playbook is part of the 'Malware Investigation And Response' pack. For more information, refer to https://xsoar.pan.dev/docs/reference/packs/malware-investigation-and-response.
        This playbook verifies and sets the policy actions applied by CrowdStrike Falcon.
      playbookName: CrowdStrike Falcon Malware - Verify Containment Actions
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "283"
    scriptarguments:
      PolicyBehaviourDetails:
        complex:
          root: SecondScenario
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 570,
          "y": -540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "434":
    id: "434"
    taskid: 6a0890cb-09e1-4f30-8ee8-39541698231b
    type: regular
    task:
      id: 6a0890cb-09e1-4f30-8ee8-39541698231b
      version: -1
      name: Set Policy Behavior Details To Context
      description: Set multiple keys/values to the context.
      scriptName: SetMultipleValues
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "436"
    scriptarguments:
      keys:
        simple: policy_disabled,quarantine_machine,kill_process,suspend_process
      parent:
        simple: ThirdScenario
      values:
        simple: false,true,false,true
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -450,
          "y": -700
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "435":
    id: "435"
    taskid: 5b4705a1-7686-44eb-856a-ef32136500f8
    type: title
    task:
      id: 5b4705a1-7686-44eb-856a-ef32136500f8
      version: -1
      name: Test Isolated Host & Process Suspended Scenario
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "434"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -450,
          "y": -835
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "436":
    id: "436"
    taskid: cbdb345d-cb11-44ab-88b2-d86ee3d46aca
    type: playbook
    task:
      id: cbdb345d-cb11-44ab-88b2-d86ee3d46aca
      version: -1
      name: CrowdStrike Falcon Malware - Verify Containment Actions
      description: |-
        This playbook is part of the 'Malware Investigation And Response' pack. For more information, refer to https://xsoar.pan.dev/docs/reference/packs/malware-investigation-and-response.
        This playbook verifies and sets the policy actions applied by CrowdStrike Falcon.
      playbookName: CrowdStrike Falcon Malware - Verify Containment Actions
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "450"
    scriptarguments:
      PolicyBehaviourDetails:
        complex:
          root: ThirdScenario
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": -450,
          "y": -540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "437":
    id: "437"
    taskid: 97c215aa-3aed-4377-8bd1-684979f3af67
    type: regular
    task:
      id: 97c215aa-3aed-4377-8bd1-684979f3af67
      version: -1
      name: Set Policy Behavior Details To Context
      description: Set multiple keys/values to the context.
      scriptName: SetMultipleValues
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "439"
    scriptarguments:
      keys:
        simple: policy_disabled,quarantine_machine,kill_process,process suspended,process_blocked
      parent:
        simple: FourthScenario
      values:
        simple: false,true,false,false,true
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -1460,
          "y": -700
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "438":
    id: "438"
    taskid: 7a64fd97-d8ef-4fc2-8f22-3d1053cfa052
    type: title
    task:
      id: 7a64fd97-d8ef-4fc2-8f22-3d1053cfa052
      version: -1
      name: Test Process Blocked Scenario
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "437"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -1460,
          "y": -835
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "439":
    id: "439"
    taskid: cd72b12b-a0dc-43c7-847f-e8764f70898e
    type: playbook
    task:
      id: cd72b12b-a0dc-43c7-847f-e8764f70898e
      version: -1
      name: CrowdStrike Falcon Malware - Verify Containment Actions
      description: |-
        This playbook is part of the 'Malware Investigation And Response' pack. For more information, refer to https://xsoar.pan.dev/docs/reference/packs/malware-investigation-and-response.
        This playbook verifies and sets the policy actions applied by CrowdStrike Falcon.
      playbookName: CrowdStrike Falcon Malware - Verify Containment Actions
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "458"
    scriptarguments:
      PolicyBehaviourDetails:
        complex:
          root: FourthScenario
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": -1460,
          "y": -540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "440":
    id: "440"
    taskid: 98e997a9-6c09-454c-8a2e-41fbd980887b
    type: regular
    task:
      id: 98e997a9-6c09-454c-8a2e-41fbd980887b
      version: -1
      name: Set Policy Behavior Details To Context
      description: Set multiple keys/values to the context.
      scriptName: SetMultipleValues
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "442"
    scriptarguments:
      keys:
        simple: policy_disabled,quarantine_machine,kill_process,process suspended,process_blocked
      parent:
        simple: FifthScenario
      values:
        simple: false,true,false,false,false
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -2300,
          "y": -700
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "441":
    id: "441"
    taskid: 2a99438f-5c7f-4261-81de-098c103482c3
    type: title
    task:
      id: 2a99438f-5c7f-4261-81de-098c103482c3
      version: -1
      name: Test No Action Taken Scenario
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "440"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -2300,
          "y": -835
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "442":
    id: "442"
    taskid: 5046fe42-df73-4339-8e0f-d8a8a7fedbc7
    type: playbook
    task:
      id: 5046fe42-df73-4339-8e0f-d8a8a7fedbc7
      version: -1
      name: CrowdStrike Falcon Malware - Verify Containment Actions
      description: |-
        This playbook is part of the 'Malware Investigation And Response' pack. For more information, refer to https://xsoar.pan.dev/docs/reference/packs/malware-investigation-and-response.
        This playbook verifies and sets the policy actions applied by CrowdStrike Falcon.
      playbookName: CrowdStrike Falcon Malware - Verify Containment Actions
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "464"
    scriptarguments:
      PolicyBehaviourDetails:
        complex:
          root: FifthScenario
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": -2300,
          "y": -540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "443":
    id: "443"
    taskid: 0ed89137-ab1a-4010-85b0-c2ff3f13fac9
    type: title
    task:
      id: 0ed89137-ab1a-4010-85b0-c2ff3f13fac9
      version: -1
      name: Check Context Data
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "444"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1780,
          "y": -375
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "444":
    id: "444"
    taskid: 6fcb19af-acc4-441d-8be4-a199cfa63052
    type: condition
    task:
      id: 6fcb19af-acc4-441d-8be4-a199cfa63052
      version: -1
      name: Verify Policy State - Not Active
      description: Verify that the 'Policy.State' context key was populated and set to 'Not Active'.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "445"
      Verified:
      - "448"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Policy
                accessor: State
            iscontext: true
          right:
            value:
              simple: Not Active
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1780,
          "y": -230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "445":
    id: "445"
    taskid: 0aff645a-ed7e-4061-88eb-7800a110bbe7
    type: regular
    task:
      id: 0aff645a-ed7e-4061-88eb-7800a110bbe7
      version: -1
      name: Verify Playbook Output Error - Policy State - Not Active
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'Policy.State’ context key was not populated or was not set to 'Not Active'. This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon Malware - Verify Containment Actions' playbook:
          1- The conditions for the 'Is policy enabled?' task were changed.
          2- The 'key' input configuration was changed for the 'Set' automation used in the 'Set policy status not active' task.
          3- The 'value' input configuration was changed for the 'Set' automation used in the 'Set policy status not active' task.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1780,
          "y": -40
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "448":
    id: "448"
    taskid: c58fbf45-10a3-48f0-8792-a2fb88dc183d
    type: title
    task:
      id: c58fbf45-10a3-48f0-8792-a2fb88dc183d
      version: -1
      name: Done Testing Policy State not Active Scenario
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "468"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2170,
          "y": -60
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "449":
    id: "449"
    taskid: f31f0d70-9723-4d50-8ab7-1ff4b9b581e3
    type: title
    task:
      id: f31f0d70-9723-4d50-8ab7-1ff4b9b581e3
      version: -1
      name: Done Testing Policy State Active & Not Isolated Host & Process Killed Scenario
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "468"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1360,
          "y": -60
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "450":
    id: "450"
    taskid: 44d90e14-de3c-4c4e-88cf-fd9911b7b523
    type: title
    task:
      id: 44d90e14-de3c-4c4e-88cf-fd9911b7b523
      version: -1
      name: Check Playbook Outputs
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "453"
      - "455"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -450,
          "y": -375
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "453":
    id: "453"
    taskid: 8ec4427f-4453-4254-84cb-5d322ca5d28f
    type: condition
    task:
      id: 8ec4427f-4453-4254-84cb-5d322ca5d28f
      version: -1
      name: Verify Host State - Isolated
      description: Verify that the 'Host.State' context key was populated and set to 'Isolated'.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "454"
      Verified:
      - "457"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Host
                accessor: State
            iscontext: true
          right:
            value:
              simple: Isolated
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -650,
          "y": -230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "454":
    id: "454"
    taskid: 90e77aff-a5e3-45fe-8d3c-2d893793bfe1
    type: regular
    task:
      id: 90e77aff-a5e3-45fe-8d3c-2d893793bfe1
      version: -1
      name: Verify Playbook Output Error - Host State - Isolated
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'Host.State’ context key was not populated or was not set to 'Isolated' This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon Malware - Verify Containment Actions' playbook:
          1- The conditions for the 'Was host isolated?' task were changed.
          2- The 'key' input configuration was changed for the 'Set' automation used in the 'Set host no isolated' task.
          3- The 'value' input configuration was changed for the 'Set' automation used in the 'Set host no isolated' task.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -650,
          "y": -35
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "455":
    id: "455"
    taskid: bebd2bba-5a1c-4d4f-82c1-51707fef0ae0
    type: condition
    task:
      id: bebd2bba-5a1c-4d4f-82c1-51707fef0ae0
      version: -1
      name: Verify Process State - Process Suspended
      description: Verify that the 'Process.State' context key was populated and set to 'suspended'.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "456"
      Verified:
      - "457"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Process
                accessor: State
            iscontext: true
          right:
            value:
              simple: Suspended
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -250,
          "y": -230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "456":
    id: "456"
    taskid: a1765d00-9c53-4928-8513-3a8e89341410
    type: regular
    task:
      id: a1765d00-9c53-4928-8513-3a8e89341410
      version: -1
      name: Verify Playbook Output Error - Process State - Process Suspended
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'Process.State’ context key was not populated or was not set to 'suspended' This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon Malware - Verify Containment Actions' playbook:
          1- The conditions for the 'Was process handled?' task were changed.
          2- The 'key' input configuration was changed for the 'Set' automation used in the 'Set process killed' task.
          3- The 'value' input configuration was changed for the 'Set' automation used in the 'Set process killed' task.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -250,
          "y": -35
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "457":
    id: "457"
    taskid: dcb832d0-cf50-46cd-8096-959ba96c603a
    type: title
    task:
      id: dcb832d0-cf50-46cd-8096-959ba96c603a
      version: -1
      name: Done Testing Policy State Active & Not Isolated Host & Process Killed Scenario
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "468"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -1040,
          "y": -60
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "458":
    id: "458"
    taskid: 05bcab4c-ef2d-408f-8ab6-8b43a121978f
    type: title
    task:
      id: 05bcab4c-ef2d-408f-8ab6-8b43a121978f
      version: -1
      name: Check Playbook Outputs
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "461"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -1460,
          "y": -375
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "461":
    id: "461"
    taskid: 8a727f2f-d441-4c91-8cd7-b9397a0d3864
    type: condition
    task:
      id: 8a727f2f-d441-4c91-8cd7-b9397a0d3864
      version: -1
      name: Verify Process State - Process Blocked
      description: Verify that the 'Process.State' context key was populated and set to 'blocked'.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "462"
      Verified:
      - "463"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Process
                accessor: State
            iscontext: true
          right:
            value:
              simple: Blocked
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -1460,
          "y": -240
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "462":
    id: "462"
    taskid: f77ae10a-6c7b-4095-8eee-55f06468690a
    type: regular
    task:
      id: f77ae10a-6c7b-4095-8eee-55f06468690a
      version: -1
      name: Verify Playbook Output Error - Process State - Process Blocked
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'Process.State’ context key was not populated or was not set to 'blocked' This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon Malware - Verify Containment Actions' playbook:
          1- The conditions for the 'Was process handled?' task were changed.
          2- The 'key' input configuration was changed for the 'Set' automation used in the 'Set process killed' task.
          3- The 'value' input configuration was changed for the 'Set' automation used in the 'Set process killed' task.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -1460,
          "y": -35
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "463":
    id: "463"
    taskid: 4f20227d-b1d1-499e-83a1-dcf132f867e2
    type: title
    task:
      id: 4f20227d-b1d1-499e-83a1-dcf132f867e2
      version: -1
      name: Done Testing Process Blocked Scenario
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "468"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -1850,
          "y": -70
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "464":
    id: "464"
    taskid: 5e79a972-0193-42bf-85e4-b47f9d870957
    type: title
    task:
      id: 5e79a972-0193-42bf-85e4-b47f9d870957
      version: -1
      name: Check Playbook Outputs
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "465"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -2300,
          "y": -375
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "465":
    id: "465"
    taskid: d82e906f-1342-4aba-81b9-970716343c0f
    type: condition
    task:
      id: d82e906f-1342-4aba-81b9-970716343c0f
      version: -1
      name: Verify Process State - No Action Taken
      description: Verify that the 'Process.State' context key was populated and set to 'no action taken'.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "466"
      Verified:
      - "467"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Process
                accessor: State
            iscontext: true
          right:
            value:
              simple: no action taken
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -2300,
          "y": -240
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "466":
    id: "466"
    taskid: 6021a9cc-44b0-4064-8ea2-2a9706b704d2
    type: regular
    task:
      id: 6021a9cc-44b0-4064-8ea2-2a9706b704d2
      version: -1
      name: Verify Playbook Output Error - Process State - No Action Taken
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'Process.State’ context key was not populated or was not set to 'no action taken' This may indicate that one or more of the following changes have been made to the 'CrowdStrike Falcon Malware - Verify Containment Actions' playbook:
          1- The conditions for the 'Was process handled?' task were changed.
          2- The 'key' input configuration was changed for the 'Set' automation used in the 'Set process killed' task.
          3- The 'value' input configuration was changed for the 'Set' automation used in the 'Set process killed' task.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -2300,
          "y": -35
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "467":
    id: "467"
    taskid: f2c464b9-c380-4f82-868a-7c03f2ad3372
    type: title
    task:
      id: f2c464b9-c380-4f82-868a-7c03f2ad3372
      version: -1
      name: Done Testing No Action Taken Scenario
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "468"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -2690,
          "y": -70
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "468":
    id: "468"
    taskid: 4251172f-4cd9-48e4-8b24-538864e2e5d5
    type: title
    task:
      id: 4251172f-4cd9-48e4-8b24-538864e2e5d5
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -450,
          "y": 160
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "380_449_Verified": 0.11,
      "399_449_Verified": 0.16,
      "401_449_Verified": 0.35,
      "444_445_#default#": 0.61,
      "453_457_Verified": 0.35,
      "455_457_Verified": 0.18
    },
    "paper": {
      "dimensions": {
        "height": 1530,
        "width": 5240,
        "x": -2690,
        "y": -1305
      }
    }
  }
inputs: []
outputs: []
fromversion: 6.5.0
