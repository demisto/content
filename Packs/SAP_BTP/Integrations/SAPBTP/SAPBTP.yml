category: Cloud Services
commonfields:
  id: SAPBTP
  version: -1
sectionorder:
- Connect
- Collect
configuration:
- name: url
  display: API URL (Audit Log Service)
  required: true
  type: 0
  section: Connect
  additionalinfo: SAP Service Key field 'url' for Audit Log API (e.g., https://auditlog-management.cfapps.<region>.hana.ondemand.com).
- name: token_url
  display: Token URL (Authentication Service)
  required: true
  type: 0
  section: Connect
  additionalinfo: For Non-mTLS use 'uaa.url' (e.g., https://<subdomain>.authentication.<region>.hana.ondemand.com). For mTLS use 'uaa.certurl' (e.g., https://<subdomain>.authentication.cert.<region>.hana.ondemand.com).
- name: client_id
  display: Client ID
  required: true
  type: 0
  section: Connect
  additionalinfo: SAP Service Key field 'uaa.clientid'. Required for both mTLS and Non-mTLS authentication.
- name: auth_type
  display: Authentication Type
  required: true
  type: 15
  section: Connect
  defaultvalue: Non-mTLS
  options:
  - mTLS
  - Non-mTLS
  additionalinfo: Select authentication method. mTLS (recommended) requires Certificate + Private Key. Non-mTLS requires Client Secret.
- name: client_secret
  display: Client Secret
  displaypassword: Client Secret
  required: false
  type: 9
  section: Connect
  hiddenusername: true
  additionalinfo: For Non-mTLS authentication. SAP Service Key field 'uaa.clientsecret'.
- name: certificate
  display: Certificate
  required: false
  type: 12
  section: Connect
  additionalinfo: For mTLS authentication (recommended). Body of certificate.pem file in PEM format.
- name: private_key
  display: Private Key
  required: false
  type: 14
  section: Connect
  additionalinfo: For mTLS authentication (recommended). Body of key.pem file in PEM format.
- name: insecure
  display: Trust any certificate (not secure)
  required: false
  type: 8
  defaultvalue: "false"
  section: Connect
  advanced: true
- name: proxy
  display: Use system proxy settings
  required: false
  defaultvalue: "false"
  type: 8
  section: Connect
  advanced: true
- name: first_fetch
  display: First fetch time
  required: false
  type: 0
  section: Collect
  additionalinfo: >-
      The time range to fetch events from on the first run (e.g., "3 days", "1 hour").
      If not specified, defaults to 1 minute ago.
- name: incidentType
  display: Incident type
  required: false
  type: 13
  section: Collect
- name: max_fetch
  display: The maximum number of audit logs per fetch
  required: false
  type: 0
  section: Collect
  advanced: true
  defaultvalue: "5000"
  additionalinfo: Maximum number of events to fetch per cycle (default 5000).
description: Collect audit log events from SAP Business Technology Platform (BTP).
display: SAP BTP (Business Technology Platform)
name: SAPBTP
script:
  commands:
  - name: sap-btp-get-events
    description: Retrieve audit log events from SAP BTP.
    arguments:
    - name: from_time
      description: >-
        The start time to fetch events from.
        Supports relative time (e.g., "3 days ago", "2 hours", "now")
        or specific absolute dates (ISO 8601 format, e.g., "2024-12-01" or "2024-12-01T10:00:00Z").
    - name: end_time
      description: >-
        The end time to fetch events until.
        Supports relative time (e.g., "1 hour ago", "now")
        or specific absolute dates (ISO 8601 format, e.g., "2024-12-01" or "2024-12-01T10:00:00Z").
    - name: limit
      description: Maximum number of events to retrieve.
    - name: should_push_events
      description: Indicates whether or not to push the collected events into XSIAM.
      required: false
      defaultValue: 'false'
    outputs:
    - contextPath: SAPBTP.Event.uuid
      description: Unique identifier of the event.
      type: String
    - contextPath: SAPBTP.Event.user
      description: User associated with the event.
      type: String
    - contextPath: SAPBTP.Event.time
      description: Timestamp of the event.
      type: Date
    - contextPath: SAPBTP.Event.ip
      description: IP address associated with the event.
      type: String
    - contextPath: SAPBTP.Event.data
      description: Event data payload.
      type: Unknown
  isfetchevents: true
  runonce: false
  script: ''
  type: python
  subtype: python3
  dockerimage: demisto/python3:3.12.12.5490952
fromversion: 8.11.0
marketplaces:
- xsoar
- marketplacev2
tests:
- No tests (auto formatted)
