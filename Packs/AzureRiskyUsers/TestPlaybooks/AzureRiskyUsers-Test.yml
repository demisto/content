id: AzureRiskyUsers
version: -1
name: AzureRiskyUsers
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: c611126c-9ea4-49e5-8ee6-f0205b2ecf3b
    type: start
    task:
      id: c611126c-9ea4-49e5-8ee6-f0205b2ecf3b
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "1":
    id: "1"
    taskid: 69e60ef2-d3df-4787-89ca-2225d858da4b
    type: regular
    task:
      id: 69e60ef2-d3df-4787-89ca-2225d858da4b
      version: -1
      name: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "6":
    id: "6"
    taskid: ffd84113-7632-4c23-822f-120309476a90
    type: regular
    task:
      id: ffd84113-7632-4c23-822f-120309476a90
      version: -1
      name: azure-risky-users-list
      description: Returns a comma separated list of all risky users and their properties.
      script: AzureRiskyUsers|||azure-risky-users-list
      type: regular
      iscommand: true
      brand: AzureRiskyUsers
    nexttasks:
      '#none#':
      - "7"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 385
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "7":
    id: "7"
    taskid: 9f872562-4f17-4a2d-8dbd-dc69355004ad
    type: condition
    task:
      id: 9f872562-4f17-4a2d-8dbd-dc69355004ad
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "8"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskyUser.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskyUser.userDisplayName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskyUser.userPrincipalName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskyUser.riskLevel
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskyUser.riskState
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskyUser.riskLastUpdatedDateTime
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AzureRiskyUsers.RiskyUser.isDeleted
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AzureRiskyUsers.RiskyUser.isProcessing
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskyUser.riskDetail
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "8":
    id: "8"
    taskid: 34c8f2c0-52bb-4ead-8caf-ae33901aefe2
    type: regular
    task:
      id: 34c8f2c0-52bb-4ead-8caf-ae33901aefe2
      version: -1
      name: azure-risky-user-get
      description: Retrieves properties and relationships of a Risky User.
      script: AzureRiskyUsers|||azure-risky-user-get
      type: regular
      iscommand: true
      brand: AzureRiskyUsers
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      id:
        complex:
          root: AzureRiskyUsers.RiskyUser
          accessor: id
          transformers:
          - operator: FirstArrayElement
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: AzureRiskyUsers.RiskyUser.riskState
                iscontext: true
              right:
                value:
                  simple: confirmedSafe
      extend-context:
        simple: SafeID=id
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 735
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "9":
    id: "9"
    taskid: 0a975142-f75a-44ea-8421-5c38ecec585a
    type: condition
    task:
      id: 0a975142-f75a-44ea-8421-5c38ecec585a
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "10"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskyUser.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskyUser.userDisplayName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskyUser.userPrincipalName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskyUser.riskLevel
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskyUser.riskState
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskyUser.riskLastUpdatedDateTime
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AzureRiskyUsers.RiskyUser.isDeleted
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AzureRiskyUsers.RiskyUser.isProcessing
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskyUser.riskDetail
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 910
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "10":
    id: "10"
    taskid: 90125531-1077-4185-8288-7f112746cbac
    type: regular
    task:
      id: 90125531-1077-4185-8288-7f112746cbac
      version: -1
      name: azure-risky-users-risk-detections-list
      description: Returns a comma separated list of the Risk Detection objects and their properties.
      script: AzureRiskyUsers|||azure-risky-users-risk-detections-list
      type: regular
      iscommand: true
      brand: AzureRiskyUsers
    nexttasks:
      '#none#':
      - "11"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1085
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "11":
    id: "11"
    taskid: dbe2c6b1-8f39-42ef-89c0-9aa7dbced47f
    type: condition
    task:
      id: dbe2c6b1-8f39-42ef-89c0-9aa7dbced47f
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "12"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskDetection.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskDetection.userId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskDetection.userDisplayName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskDetection.userPrincipalName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskDetection.riskDetail
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskDetection.riskEventType
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskDetection.riskLevel
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskDetection.riskState
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskDetection.ipAddress
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskDetection.source
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskDetection.detectionTimingType
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskDetection.lastUpdatedDateTime
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskDetection.location
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskDetection.activity
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskDetection.activityDateTime
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskDetection.additionalInfo
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskDetection.correlationId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskDetection.detectedDateTime
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskDetection.requestId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskDetection.tokenIssuerType
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1260
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "12":
    id: "12"
    taskid: d3bfad17-a4f5-4c7c-89e8-067af5e4a444
    type: regular
    task:
      id: d3bfad17-a4f5-4c7c-89e8-067af5e4a444
      version: -1
      name: azure-risky-users-risk-detection-get
      description: Reads the properties and relationships of a riskDetection object.
      script: AzureRiskyUsers|||azure-risky-users-risk-detection-get
      type: regular
      iscommand: true
      brand: AzureRiskyUsers
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      id:
        complex:
          root: AzureRiskyUsers.RiskDetection
          accessor: id
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1435
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "13":
    id: "13"
    taskid: f15e618e-245a-43aa-8b86-6b7bf2a976d7
    type: condition
    task:
      id: f15e618e-245a-43aa-8b86-6b7bf2a976d7
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "15"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskDetection.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskDetection.userId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskDetection.userDisplayName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskDetection.userPrincipalName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskDetection.riskDetail
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskDetection.riskEventType
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskDetection.riskLevel
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskDetection.riskState
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskDetection.ipAddress
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskDetection.source
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskDetection.detectionTimingType
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskDetection.lastUpdatedDateTime
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskDetection.location
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskDetection.activity
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskDetection.activityDateTime
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskDetection.additionalInfo
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskDetection.correlationId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskDetection.detectedDateTime
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskDetection.requestId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: AzureRiskyUsers.RiskDetection.tokenIssuerType
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1610
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "14":
    id: "14"
    taskid: f3f61f58-ecde-441e-8340-317354b7c3c3
    type: title
    task:
      id: f3f61f58-ecde-441e-8340-317354b7c3c3
      version: -1
      name: Test Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2485
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "15":
    id: "15"
    taskid: d767efaf-f28c-4066-8fd9-f0e6bf0b24c7
    type: regular
    task:
      id: d767efaf-f28c-4066-8fd9-f0e6bf0b24c7
      version: -1
      name: Set user to compromised
      description: Confirms user(s) as compromised.
      script: '|||azure-risky-users-confirm-compromise'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      user:
        simple: ${SafeID}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1785
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: b3cffdfe-c10d-4d52-9adb-9f0351607269
    type: condition
    task:
      id: b3cffdfe-c10d-4d52-9adb-9f0351607269
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "18"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isTrue
          left:
            value:
              simple: AzureRiskyUsers.Remediation.Success
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1960
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: aa0cd679-7e02-4c38-8758-10701c55ed72
    type: regular
    task:
      id: aa0cd679-7e02-4c38-8758-10701c55ed72
      version: -1
      name: Set user to safe
      description: Confirms user(s) as safe (post-investigation).
      script: '|||azure-risky-users-confirm-safe'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "21"
    scriptarguments:
      user:
        simple: ${SafeID}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2135
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: c2c84f2e-8e47-4587-8461-1857b74e63c1
    type: condition
    task:
      id: c2c84f2e-8e47-4587-8461-1857b74e63c1
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "14"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isTrue
          left:
            value:
              simple: AzureRiskyUsers.Remediation.Success
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2310
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2495,
        "width": 380,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
fromversion: 6.0.0
description: ''
