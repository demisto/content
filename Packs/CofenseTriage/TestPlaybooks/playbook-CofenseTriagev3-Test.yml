id: Cofense Triage v3-Test
version: -1
name: Cofense Triage v3-Test
description: This playbook uses Cofense Triage v3 integration and tests all  commands
  of the integration.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 076eb455-1428-4ab9-85fc-35c75389db79
    type: start
    task:
      id: 076eb455-1428-4ab9-85fc-35c75389db79
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": -520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "1":
    id: "1"
    taskid: 96895a83-85d2-42f6-8926-25290e7f8520
    type: regular
    task:
      id: 96895a83-85d2-42f6-8926-25290e7f8520
      version: -1
      name: DeleteContext
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "2":
    id: "2"
    taskid: adde8a0e-29bb-4a39-884e-97ce34b11020
    type: regular
    task:
      id: adde8a0e-29bb-4a39-884e-97ce34b11020
      version: -1
      name: cofense-threat-indicator-list
      script: '|||cofense-threat-indicator-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      fields_to_retrieve: {}
      filter_by: {}
      id: {}
      page_number: {}
      page_size: {}
      sort_by: {}
      threat_level: {}
      threat_source: {}
      threat_type: {}
      threat_value: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": -210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "3":
    id: "3"
    taskid: 0f12988d-cc07-47b3-84fe-1b49cf75c071
    type: condition
    task:
      id: 0f12988d-cc07-47b3-84fe-1b49cf75c071
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "30"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.ThreatIndicator
                accessor: id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.ThreatIndicator
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.ThreatIndicator.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.ThreatIndicator.attributes
                accessor: threat_level
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.ThreatIndicator.attributes
                accessor: threat_type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.ThreatIndicator.attributes
                accessor: threat_value
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.ThreatIndicator.attributes
                accessor: threat_source
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.ThreatIndicator.attributes
                accessor: created_at
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.ThreatIndicator.attributes
                accessor: updated_at
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.ThreatIndicator.relationships.owner.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.ThreatIndicator.relationships.owner.links
                accessor: related
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.ThreatIndicator.relationships.owner.data
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.ThreatIndicator.relationships.owner.data
                accessor: id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.ThreatIndicator.relationships.reports.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.ThreatIndicator.relationships.reports.links
                accessor: related
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.ThreatIndicator.relationships.comments.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.ThreatIndicator.relationships.comments.links
                accessor: related
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": -30
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "4":
    id: "4"
    taskid: 4c0ed290-cd5f-485b-8708-ad52afe90c7a
    type: regular
    task:
      id: 4c0ed290-cd5f-485b-8708-ad52afe90c7a
      version: -1
      name: cofense-report-list
      script: '|||cofense-report-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "5":
    id: "5"
    taskid: 8e638c42-3764-4b68-8f88-e9c7fa274ac6
    type: condition
    task:
      id: 8e638c42-3764-4b68-8f88-e9c7fa274ac6
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "6"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report
                accessor: id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.attributes
                accessor: location
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.attributes
                accessor: risk_score
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.attributes
                accessor: subject
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.attributes
                accessor: received_at
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.attributes
                accessor: reported_at
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.attributes
                accessor: raw_headers
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.attributes
                accessor: text_body
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.attributes
                accessor: html_body
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.attributes
                accessor: md5
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.attributes
                accessor: sha256
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.attributes
                accessor: match_priority
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.attributes
                accessor: processed_at
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.attributes
                accessor: created_at
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.attributes
                accessor: updated_at
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.relationships.assignee.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.relationships.assignee.links
                accessor: related
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.relationships.category.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.relationships.category.links
                accessor: related
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.relationships.cluster.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.relationships.cluster.links
                accessor: related
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.relationships.reporter.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.relationships.reporter.links
                accessor: related
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.relationships.attachment_payloads.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.relationships.attachment_payloads.links
                accessor: related
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.relationships.attachments.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.relationships.attachments.links
                accessor: related
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.relationships.domains.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.relationships.domains.links
                accessor: related
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.relationships.headers.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.relationships.headers.links
                accessor: related
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.relationships.hostnames.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.relationships.hostnames.links
                accessor: related
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.relationships.urls.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.relationships.urls.links
                accessor: related
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.relationships.rules.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.relationships.urls.links
                accessor: related
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.relationships.threat_indicators.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.relationships.threat_indicators.links
                accessor: related
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.relationships.comments.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.relationships.comments.links
                accessor: related
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.meta.risk_score_summary
                accessor: integrations
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.meta.risk_score_summary
                accessor: vip
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.meta.risk_score_summary
                accessor: reporter
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Report.meta.risk_score_summary
                accessor: rules
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1030
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "6":
    id: "6"
    taskid: 37c73f9e-eb32-40ed-8256-8b5fb856750f
    type: regular
    task:
      id: 37c73f9e-eb32-40ed-8256-8b5fb856750f
      version: -1
      name: cofense-report-download
      script: '|||cofense-report-download'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      id:
        complex:
          root: Cofense.Report.[0]
          accessor: id
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1215
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "7":
    id: "7"
    taskid: 89a74bc4-b77b-4554-8ca9-2598a5bfd835
    type: condition
    task:
      id: 89a74bc4-b77b-4554-8ca9-2598a5bfd835
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "42"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: File
                accessor: Size
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: File
                accessor: SHA1
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: File
                accessor: SHA256
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: File
                accessor: SHA512
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: File
                accessor: Name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: File
                accessor: SSDeep
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: File
                accessor: EntryID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: File
                accessor: Info
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: File
                accessor: MD5
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: File
                accessor: Extension
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1360
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "9":
    id: "9"
    taskid: 6e887b5f-cd13-4dc5-8767-c5280c463a51
    type: regular
    task:
      id: 6e887b5f-cd13-4dc5-8767-c5280c463a51
      version: -1
      name: cofense-category-list
      script: '|||cofense-category-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      fields_to_retrieve: {}
      filter_by: {}
      id: {}
      is_malicious: {}
      name: {}
      page_number: {}
      page_size: {}
      score: {}
      sort_by: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 350
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "10":
    id: "10"
    taskid: 8e653314-b019-464a-8fa4-ce975ee25420
    type: condition
    task:
      id: 8e653314-b019-464a-8fa4-ce975ee25420
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "38"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Category
                accessor: id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Category
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Category.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Category.attributes
                accessor: name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Category.attributes
                accessor: score
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Category.attributes
                accessor: color
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Category.attributes
                accessor: created_at
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Category.attributes
                accessor: updated_at
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Category.relationships.one_clicks.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Category.relationships.one_clicks.links
                accessor: related
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Category.relationships.reports.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Category.relationships.reports.links
                accessor: related
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 530
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "11":
    id: "11"
    taskid: 9515f941-d565-4fd8-86e5-cccca413c524
    type: regular
    task:
      id: 9515f941-d565-4fd8-86e5-cccca413c524
      version: -1
      name: cofense-rule-list
      script: '|||cofense-rule-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "12"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "12":
    id: "12"
    taskid: 6b2c3b01-1346-45d9-87ac-3792c4fe0a86
    type: condition
    task:
      id: 6b2c3b01-1346-45d9-87ac-3792c4fe0a86
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "32"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Rule
                accessor: id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Rule
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Rule.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Rule.attributes
                accessor: name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Rule.attributes
                accessor: description
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Rule.attributes
                accessor: priority
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Rule.attributes
                accessor: scope
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Rule.attributes
                accessor: author_name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Rule.attributes
                accessor: rule_context
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Rule.attributes
                accessor: content
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Rule.attributes
                accessor: time_to_live
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Rule.attributes
                accessor: reports_count
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Rule.attributes
                accessor: created_at
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Rule.attributes
                accessor: updated_at
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Rule.relationships.cluster_context.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Rule.relationships.cluster_context.links
                accessor: related
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Rule.relationships.report_context.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Rule.relationships.report_context.links
                accessor: related
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Rule.relationships.owner.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Rule.relationships.owner.links
                accessor: related
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Rule.relationships.clusters.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Rule.relationships.clusters.links
                accessor: related
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Rule.relationships.reports.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Rule.relationships.reports.links
                accessor: related
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "13":
    id: "13"
    taskid: cc1b65b7-73ae-4a4e-8e2f-160976e72f76
    type: regular
    task:
      id: cc1b65b7-73ae-4a4e-8e2f-160976e72f76
      version: -1
      name: cofense-url-list
      script: '|||cofense-url-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2850
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "14":
    id: "14"
    taskid: f5b472d8-239e-4a62-88e4-37ed2c3c5fc0
    type: condition
    task:
      id: f5b472d8-239e-4a62-88e4-37ed2c3c5fc0
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "37"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Url
                accessor: id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Url
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Url.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Url.attributes
                accessor: url
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Url.attributes
                accessor: created_at
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Url.attributes
                accessor: updated_at
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Url.relationships.domain.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Url.relationships.domain.links
                accessor: related
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Url.relationships.hostname.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Url.relationships.hostname.links
                accessor: related
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Url.relationships.clusters.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Url.relationships.clusters.links
                accessor: related
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Url.relationships.integration_submissions.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Url.relationships.integration_submissions.links
                accessor: related
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Url.relationships.reports.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Url.relationships.reports.links
                accessor: related
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "17":
    id: "17"
    taskid: aacf6e0c-44be-4d47-802d-c777608a01c8
    type: regular
    task:
      id: aacf6e0c-44be-4d47-802d-c777608a01c8
      version: -1
      name: cofense-reporter-list
      script: '|||cofense-reporter-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      email: {}
      fields_to_retrieve: {}
      filter_by: {}
      id: {}
      page_number: {}
      page_size: {}
      reputation_score: {}
      sort_by: {}
      vip: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "18":
    id: "18"
    taskid: 43600397-eed7-4050-800f-9c972a5e5a68
    type: condition
    task:
      id: 43600397-eed7-4050-800f-9c972a5e5a68
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "34"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Reporter
                accessor: id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Reporter
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Reporter.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Reporter.attributes
                accessor: email
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Reporter.attributes
                accessor: reports_count
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Reporter.attributes
                accessor: last_reported_at
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Reporter.attributes
                accessor: reputation_score
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Reporter.attributes
                accessor: vip
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Reporter.attributes
                accessor: created_at
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Reporter.attributes
                accessor: updated_at
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Reporter.relationships.clusters.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Reporter.relationships.clusters.links
                accessor: related
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Reporter.relationships.reports.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Reporter.relationships.reports.links
                accessor: related
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "21":
    id: "21"
    taskid: 2c069bf2-3c3c-430c-8b09-a574584f4a06
    type: regular
    task:
      id: 2c069bf2-3c3c-430c-8b09-a574584f4a06
      version: -1
      name: cofense-response-list
      script: '|||cofense-response-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      fields_to_retrieve: {}
      filter_by: {}
      id: {}
      name: {}
      page_number: {}
      page_size: {}
      sort_by: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "22":
    id: "22"
    taskid: ff5b0491-8846-4fa5-8ed5-f4596739c252
    type: condition
    task:
      id: ff5b0491-8846-4fa5-8ed5-f4596739c252
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "35"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Response
                accessor: id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Response
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Response.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Response.attributes
                accessor: name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Response.attributes
                accessor: description
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Response.attributes
                accessor: to_reporter
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Response.attributes
                accessor: to_other
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Response.attributes
                accessor: to_other_address
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Response.attributes
                accessor: cc_address
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Response.attributes
                accessor: bcc_address
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Response.attributes
                accessor: subject
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Response.attributes
                accessor: attach_original
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Response.attributes
                accessor: body
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Response.attributes
                accessor: created_at
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Response.attributes
                accessor: updated_at
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Response.relationships.one_clicks.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Response.relationships.one_clicks.links
                accessor: related
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "25":
    id: "25"
    taskid: 0c0cfca1-cac6-476a-8e6e-f0e67adab607
    type: regular
    task:
      id: 0c0cfca1-cac6-476a-8e6e-f0e67adab607
      version: -1
      name: cofense-attachment-payload-list
      script: '|||cofense-attachment-payload-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "26"
    scriptarguments:
      fields_to_retrieve: {}
      filter_by: {}
      id: {}
      page_number: {}
      page_size: {}
      risk_score: {}
      sort_by: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3480
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "26":
    id: "26"
    taskid: f1e4307e-50d1-46c4-84ff-178820b33213
    type: condition
    task:
      id: f1e4307e-50d1-46c4-84ff-178820b33213
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "33"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.AttachmentPayload
                accessor: id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.AttachmentPayload
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.AttachmentPayload.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.AttachmentPayload.attributes
                accessor: mime_type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.AttachmentPayload.attributes
                accessor: md5
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.AttachmentPayload.attributes
                accessor: sha256
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.AttachmentPayload.attributes
                accessor: created_at
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.AttachmentPayload.attributes
                accessor: updated_at
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.AttachmentPayload.relationships.attachments.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.AttachmentPayload.relationships.attachments.links
                accessor: related
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.AttachmentPayload.relationships.clusters.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.AttachmentPayload.relationships.attachments.links
                accessor: related
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.AttachmentPayload.relationships.integration_submissions.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.AttachmentPayload.relationships.integration_submissions.links
                accessor: related
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.AttachmentPayload.relationships.reports.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.AttachmentPayload.relationships.reports.links
                accessor: related
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "27":
    id: "27"
    taskid: 6e05e6b4-e4cc-4684-8bed-6da1fe9faac2
    type: regular
    task:
      id: 6e05e6b4-e4cc-4684-8bed-6da1fe9faac2
      version: -1
      name: cofense-comment-list
      script: '|||cofense-comment-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "28"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "28":
    id: "28"
    taskid: d93830ac-d833-4662-8419-1e016cb044e0
    type: condition
    task:
      id: d93830ac-d833-4662-8419-1e016cb044e0
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "36"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment
                accessor: id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes
                accessor: body_format
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes
                accessor: body
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes
                accessor: tags
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes
                accessor: created_at
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes
                accessor: updated_at
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes.body
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes.body.properties.reported_time
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes.body.properties.srctag
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes.body.properties.received_time
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes.body.properties.from
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes.body.properties.reported_by
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes.body.properties.notes
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes.body.properties.summary
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes.body.properties.malware_families
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes.body.properties.phenotypes
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes.body.properties.message_id
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes.body.properties.reply_to
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes.body.properties.report_url
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes.body.properties.escalation_type
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes.body.properties.stage_1_iocs
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes.body.properties.stage_1_iocs.properties.files
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes.body.properties.stage_1_iocs.properties.infection_ips
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes.body.properties.stage_1_iocs.properties.infection_ips.items
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes.body.properties.stage_1_iocs.properties.infection_urls.items
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes.body.properties.stage_1_iocs.properties.infection_urls
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes.body.properties.brands
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes.body.properties.brands.items
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes.body.properties.vision_results
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes.body.properties.vision_results.properties
                accessor: results_id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes.body.properties.vision_results.properties.query_created
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes.body.properties.vision_results.properties
                accessor: messages_removed
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes.body.properties.vision_results.properties
                accessor: messages_found
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes.body.properties.subject
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes.body.properties.sent_to
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes.body.properties.stage_2_iocs
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes.body.properties.stage_2_iocs.properties.files
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes.body.properties.stage_2_iocs.properties.md5
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes.body.properties.stage_2_iocs.properties.size
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes.body.properties.stage_2_iocs.properties.payload_ips
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes.body.properties.stage_2_iocs.properties.payload_ips.items
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes.body.properties.stage_2_iocs.properties.payload_urls
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes.body.properties.stage_2_iocs.properties.payload_urls.items
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes.body.properties.stage_2_iocs.properties.c2_ips
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes.body.properties.stage_2_iocs.properties.c2_urls
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.attributes.body.properties.report_id
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.relationships.commentable.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.relationships.commentable.links
                accessor: related
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.relationships.commentable.data
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.relationships.commentable.data
                accessor: id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.relationships.owner.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.relationships.owner.links
                accessor: related
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.relationships.owner.data
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Comment.relationships.owner.data
                accessor: id
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5590
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "29":
    id: "29"
    taskid: 855d476a-7a3c-40f2-830d-55373869b3a2
    type: title
    task:
      id: 855d476a-7a3c-40f2-830d-55373869b3a2
      version: -1
      name: Test Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6580
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "30":
    id: "30"
    taskid: 77448aa3-a7ec-426d-8ae9-7940c1cfee89
    type: regular
    task:
      id: 77448aa3-a7ec-426d-8ae9-7940c1cfee89
      version: -1
      name: DeleteContext
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "31":
    id: "31"
    taskid: 725d5270-08a2-4823-81f8-524a1a7760bb
    type: regular
    task:
      id: 725d5270-08a2-4823-81f8-524a1a7760bb
      version: -1
      name: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1985
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "32":
    id: "32"
    taskid: 620ae112-8907-48fa-8e51-b612d32a57ba
    type: regular
    task:
      id: 620ae112-8907-48fa-8e51-b612d32a57ba
      version: -1
      name: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "33":
    id: "33"
    taskid: 876ee5cd-4cbe-4b43-8463-891f0826b73f
    type: regular
    task:
      id: 876ee5cd-4cbe-4b43-8463-891f0826b73f
      version: -1
      name: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "34":
    id: "34"
    taskid: 83b21cf7-b4de-414d-8f68-6285074931ae
    type: regular
    task:
      id: 83b21cf7-b4de-414d-8f68-6285074931ae
      version: -1
      name: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "21"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "35":
    id: "35"
    taskid: fc70fa06-0d4b-477d-8734-3411dcd742f1
    type: regular
    task:
      id: fc70fa06-0d4b-477d-8734-3411dcd742f1
      version: -1
      name: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "36":
    id: "36"
    taskid: 4b6e8f8b-7751-41d5-8eb7-80f5a05888cb
    type: regular
    task:
      id: 4b6e8f8b-7751-41d5-8eb7-80f5a05888cb
      version: -1
      name: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "39"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "37":
    id: "37"
    taskid: 4876d1ff-dc9c-468c-8c4d-f18d76983525
    type: regular
    task:
      id: 4876d1ff-dc9c-468c-8c4d-f18d76983525
      version: -1
      name: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "25"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "38":
    id: "38"
    taskid: 6d192aab-4c92-48ca-8d56-5054b065a5f2
    type: regular
    task:
      id: 6d192aab-4c92-48ca-8d56-5054b065a5f2
      version: -1
      name: DeleteContext
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 700
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "39":
    id: "39"
    taskid: d3ecff7e-e636-438f-8d74-e9577a47c827
    type: regular
    task:
      id: d3ecff7e-e636-438f-8d74-e9577a47c827
      version: -1
      name: cofense-cluster-list
      description: Retrieves clusters based on the filter values provided in the command
        arguments.
      script: '|||cofense-cluster-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "40"
    scriptarguments:
      created_at: {}
      fields_to_retrieve: {}
      filter_by: {}
      id: {}
      match_priority: {}
      page_number: {}
      page_size: {}
      sort_by: {}
      tags: {}
      total_reports_count: {}
      updated_at: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6010
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "40":
    id: "40"
    taskid: f56b2191-a278-4c1f-8dfb-053d98d6e8b3
    type: condition
    task:
      id: f56b2191-a278-4c1f-8dfb-053d98d6e8b3
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "41"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Cluster
                accessor: id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Cluster
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Cluster.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Cluster.attributes
                accessor: risk_score
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Cluster.attributes
                accessor: first_reported_at
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Cluster.attributes
                accessor: oldest_unprocessed_reported_at
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Cluster.attributes
                accessor: last_received_at
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Cluster.attributes
                accessor: oldest_unprocessed_reported_at
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Cluster.attributes
                accessor: last_reported_at
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Cluster.attributes
                accessor: last_subject
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Cluster.attributes
                accessor: average_reporter_reputation
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Cluster.attributes
                accessor: match_priority
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Cluster.attributes
                accessor: host_source
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Cluster.attributes
                accessor: unprocessed_reports_count
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Cluster.attributes
                accessor: processed_reports_count
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Cluster.attributes
                accessor: total_reports_count
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Cluster.attributes
                accessor: rules_count
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Cluster.attributes
                accessor: urls_count
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Cluster.attributes
                accessor: vip_reporters_count
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Cluster.attributes
                accessor: created_at
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Cluster.relationships.attachment_payloads.links
                accessor: related
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Cluster.relationships.attachment_payloads.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Cluster.relationships.attachment_payloads.links
                accessor: related
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Cluster.relationships.domains.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Cluster.relationships.domains.links
                accessor: related
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Cluster.relationships.hostnames.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Cluster.relationships.hostnames.links
                accessor: related
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Cluster.relationships.reports.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Cluster.relationships.reports.links
                accessor: related
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Cluster.relationships.reporters.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Cluster.relationships.reporters.links
                accessor: related
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Cluster.relationships.rules.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Cluster.relationships.rules.links
                accessor: related
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Cluster.relationships.urls.links
                accessor: self
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Cofense.Cluster.relationships.urls.links
                accessor: related
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "41":
    id: "41"
    taskid: a85f1529-3801-40fc-8b5d-ae8c44278a19
    type: regular
    task:
      id: a85f1529-3801-40fc-8b5d-ae8c44278a19
      version: -1
      name: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "42":
    id: "42"
    taskid: ee4ce247-0deb-4f7c-8bd4-82c2fd8d8b6b
    type: regular
    task:
      id: ee4ce247-0deb-4f7c-8bd4-82c2fd8d8b6b
      version: -1
      name: cofense-report-image-download
      description: Downloads the image of the report that matches the specified report
        ID.
      script: '|||cofense-report-image-download'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "43"
    scriptarguments:
      id:
        complex:
          root: Cofense.Report.[0]
          accessor: id
      type: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "43":
    id: "43"
    taskid: 0faf9bb7-61a6-4982-84d4-074d1ccc629e
    type: condition
    task:
      id: 0faf9bb7-61a6-4982-84d4-074d1ccc629e
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "31"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: InfoFile
                accessor: Name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: InfoFile
                accessor: EntryID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: InfoFile
                accessor: Size
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: InfoFile
                accessor: Type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: InfoFile
                accessor: Info
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: InfoFile
                accessor: Extension
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1780
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 7165,
        "width": 380,
        "x": 50,
        "y": -520
      }
    }
  }
inputs: []
outputs: []
fromversion: 6.0.0
