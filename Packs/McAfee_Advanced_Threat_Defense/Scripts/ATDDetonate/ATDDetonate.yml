args:
- default: true
  description: Analyzer profile ID. The profile ID number can be found in the UI Policy/Analyzer
    Profile page, OR using command atd-list-analyzer-profiles, under vmProfileid key
    result
  name: vmProfileList
- auto: PREDEFINED
  description: "This parameter accepts four values \u2014 '0', '1', '2' and '3'. \u2022\
    \ 0 \u2014 Regular file upload \u2022 1 \u2014 URL submission \u2014 URL link\
    \ is processed inside analyzer VM \u2022 2 \u2014 Submit file with URL \u2022\
    \ 3 \u2014 URL Download \u2014 File from URL is firstly downloaded and then analyzed"
  name: submitType
  predefined:
  - '0'
  - '1'
  - '2'
  - '3'
  required: true
- description: Any valid web URL.
  name: url
- description: Maximum 128-character string.
  name: messageId
- description: ' IPv4 address of the source system or gateway from where the file
    is downloaded.'
  name: srcIp
- description: ' IPv4 address of the target endpoint.'
  name: dstIp
- auto: PREDEFINED
  description: Value '0' indicates corresponding taskid in API response. Value '1'
    indicates -1 as taskid in API response.
  name: skipTaskId
  predefined:
  - '0'
  - '1'
- auto: PREDEFINED
  description: Value '0' indicates skip sample analysis if it is analyzed previously
    . Value '1' indicates do not skip sample analysis if it is not analyzed previously.
  name: analyzeAgain
  predefined:
  - '0'
  - '1'
- auto: PREDEFINED
  description: Value '0' indicates no user interaction is needed during sample analysis.
    Value '1' indicates user interaction is needed during sample analysis.
  name: xMode
  predefined:
  - '0'
  - '1'
- auto: PREDEFINED
  description: ' This parameter indicates priority of sample analysis. run_now assigns
    highest priority (i.e., sample is analyzed right away), add_to_q puts sample in
    waiting state if there is a waiting queue of samples, default is run_now'
  name: filePriorityQ
  predefined:
  - run_now
  - add_to_q
- description: entry ID
  name: entryID
- auto: PREDEFINED
  defaultValue: json
  description: "iType can be one of the following types: \u2022 html \u2014 HTML report\
    \ \u2022 txt \u2014 Text report \u2022 xml \u2014 XML report \u2022 zip \u2014\
    \ All files packaged in a single zip file \u2022 json \u2014 Same as xml but in\
    \ the JSON format \u2022 ioc - Indicators of Compromise format \u2022 stix - Structured\
    \ Threat Information expression. Stix generation is disabled, by default. Use\
    \ set stixreportstatus enable to enable it. \u2022 pdf - Portable Document Format\
    \ \u2022 sample - Download sample from McAfee Advanced Threat Defense"
  name: reportType
  predefined:
  - html
  - txt
  - xml
  - zip
  - json
  - ioc
  - stix
  - pdf
  - sample
  required: true
- description: Timeout in seconds. Default is 10 minutes.
  name: timeout
- description: Interval to poll for results. Default is 10 seconds.
  name: interval
comment: Detonate File or URL through McAfee ATD
commonfields:
  id: ATDDetonate
  version: -1
dependson:
  must:
  - atd-file-upload
  - atd-check-status
  - atd-get-report
dockerimage: demisto/python3:3.10.7.33922
fromversion: 5.0.0
name: ATDDetonate
outputs:
- contextPath: File.Name
  description: Filename (only in case of report type=json)
- contextPath: File.Type
  description: File type e.g. "PE" (only in case of report type=json)
- contextPath: File.Size
  description: File size (only in case of report type=json)
- contextPath: File.MD5
  description: MD5 hash of the file (only in case of report type=json)
- contextPath: File.SHA1
  description: SHA1 hash of the file (only in case of report type=json)
- contextPath: File.SHA256
  description: SHA256 hash of the file (only in case of report type=json)
- contextPath: File.Malicious.Vendor
  description: For malicious files, the vendor that made the decision
- contextPath: File.Malicious.Description
  description: For malicious files, the reason for the vendor to make the decision
- contextPath: DBotScore.Indicator
  description: The indicator we tested (only in case of report type=json)
- contextPath: DBotScore.Type
  description: The type of the indicator (only in case of report type=json)
- contextPath: DBotScore.Vendor
  description: Vendor used to calculate the score (only in case of report type=json)
- contextPath: DBotScore.Score
  description: The actual score (only in case of report type=json)
script:
- '8.1'
scripttarget: 0
subtype: python3
system: true
tags:
- file
- enhancement
- atd
tests:
- No tests (auto formatted)
timeout: 960ns
type: python
