category: Data Enrichment & Threat Intelligence
commonfields:
  id: SafeBreach v2
  version: -1
configuration:
- additionalinfo: For example, https://yourorg.safebreach.com
  display: SafeBreach Managment URL
  hidden: false
  name: url
  required: true
  type: 0
- additionalinfo: Obtained with "config accounts" SafeBreach command
  display: Account ID
  hidden: false
  name: accountId
  required: true
  type: 0
- additionalinfo: Generated with "config apikeys add" SafeBreach command
  display: API Key
  hidden: false
  name: apiKey
  required: true
  type: 0
- defaultvalue: Endpoint,Web
  display: Insight Category
  hidden: false
  name: insightCategory
  options:
  - Network Access
  - Network Inspection
  - Endpoint
  - Email
  - Web
  - Data Leak
  required: false
  type: 16
- defaultvalue: Hash,Domain
  display: Insight Data Type
  hidden: false
  name: insightDataType
  options:
  - Hash
  - Domain
  - URI
  - Command
  - Port
  - Protocol
  required: false
  type: 16
- additionalinfo: Amount of indicators to generate. Default = 1000
  defaultvalue: '1000'
  display: Indicators Limit
  hidden: false
  name: indicatorLimit
  required: false
  type: 0
- defaultvalue: 'true'
  display: Fetch indicators
  name: feed
  required: false
  type: 8
- additionalinfo: Indicators from this integration instance will be marked with this
    reputation
  defaultvalue: Bad
  display: Indicator Reputation
  name: feedReputation
  options:
  - None
  - Good
  - Suspicious
  - Bad
  required: false
  type: 18
- additionalinfo: Reliability of the source providing the intelligence data
  defaultvalue: A - Completely reliable
  display: Source Reliability
  name: feedReliability
  options:
  - A - Completely reliable
  - B - Usually reliable
  - C - Fairly reliable
  - D - Not usually reliable
  - E - Unreliable
  - F - Reliability cannot be judged
  required: true
  type: 15
- defaultvalue: never
  name: feedExpirationPolicy
  options:
  - never
  - interval
  - indicatorType
  - suddenDeath
  required: false
  type: 17
- defaultvalue: '1440'
  display: Feed Fetch Interval
  name: feedFetchInterval
  required: false
  type: 19
- additionalinfo: When selected, the exclusion list is ignored for indicators from
    this feed. This means that if an indicator from this feed is on the exclusion
    list, the indicator might still be added to the system.
  display: Bypass exclusion list
  name: feedBypassExclusionList
  required: false
  type: 8
- defaultvalue: '20160'
  name: feedExpirationInterval
  required: false
  type: 1
description: SafeBreach automatically executes thousands of breach methods from its
  extensive and growing Hacker’s Playbook™ to validate security control effectiveness.  Simulations
  are automatically correlated with network, endpoint, and SIEM solutions providing
  data-driven SafeBreach Insights for holistic remediation to harden enterprise defenses.
display: SafeBreach v2
name: SafeBreach v2
script:
  commands:
  - arguments:
    - default: false
      description: Array of insight ids to fetch
      isArray: true
      name: insightIds
      required: false
      secret: false
    deprecated: false
    description: Get SafeBreach Insights for all security control categories
    execution: false
    name: safebreach-get-insights
    outputs:
    - contextPath: SafeBreach.Insight.Name
      description: Insight name representing the action required to be taken
      type: String
    - contextPath: SafeBreach.Insight.Id
      description: Insight unique id number
      type: Number
    - contextPath: SafeBreach.Insight.DataType
      description: 'Insight data type. Options: Hash, Domain, URI, Command, Port,
        Protocol'
      type: String
    - contextPath: SafeBreach.Insight.Category
      description: Security control category name
      type: String
    - contextPath: SafeBreach.Insight.LatestSimulation
      description: Time of the latest simulation from the insight
      type: Date
    - contextPath: SafeBreach.Insight.SimulationsCount
      description: Number of the related simulations
      type: Number
    - contextPath: SafeBreach.Insight.RiskImpact
      description: Risk impact of the insight on the environment total risk score
      type: Number
    - contextPath: SafeBreach.Insight.AffectedTargetsCount
      description: Number of the affected targets
      type: Number
    - contextPath: SafeBreach.Insight.SeverityScore
      description: Insight severity numeric value
      type: Number
    - contextPath: SafeBreach.Insight.Severity
      description: Insight severity mapped to low/medium/high
      type: String
    - contextPath: SafeBreach.Insight.RemediationDataCount
      description: Number of the remediation data points
      type: Number
    - contextPath: SafeBreach.Insight.RemediationDataType
      description: Type of the remediation data
      type: String
    - contextPath: SafeBreach.Insight.ThreatGroups
      description: Array of APT names that are mapped to the insight
      type: Array
    - contextPath: SafeBreach.Insight.NetworkDirection
      description: Communication direction of Insight, relative to the target (inbound/outbound)
      type: String
    - contextPath: SafeBreach.Insight.AttacksCount
      description: List of all insight related SafeBreach attack ids
      type: Number
  - arguments:
    - default: false
      description: The id of the insight to fetch remediation data for
      isArray: false
      name: insightId
      required: true
      secret: false
    deprecated: false
    description: Get remediation data for a specific SafeBreach Insight
    execution: false
    name: safebreach-get-remediation-data
    outputs:
    - contextPath: SafeBreach.Insight.Id
      description: Insight unique id number
      type: Number
    - contextPath: SafeBreach.Insight.SHA256
      description: Malware SHA256
      type: String
    - contextPath: SafeBreach.Insight.Domain
      description: 'Malicious domains '
      type: String
    - contextPath: SafeBreach.Insight.IP
      description: Malicious IPs
      type: String
    - contextPath: SafeBreach.Insight.Port
      description: Ports used during the attack
      type: Number
    - contextPath: SafeBreach.Insight.Protocol
      description: Protocols used during the attack
      type: String
    - contextPath: SafeBreach.Insight.Proxy
      description: Proxies used during the attack
      type: String
    - contextPath: SafeBreach.Insight.URI
      description: Malicious URIs
      type: String
    - contextPath: SafeBreach.Insight.DropPath
      description: Malware drop paths
      type: String
    - contextPath: SafeBreach.Insight.User
      description: Impersonated users running the attacks
      type: String
    - contextPath: SafeBreach.Insight.Command
      description: Attack executed commands
      type: String
    - contextPath: SafeBreach.Insight.Registry
      description: Attack read/changed registry paths
      type: String
    - contextPath: SafeBreach.Insight.ClientHeader
      description: Client HTTP headers used in attacks
      type: String
    - contextPath: SafeBreach.Insight.ServerHeader
      description: Server HTTP headers used in attacks
      type: String
    - contextPath: URL.Data
      description: Malicious domains, URLs or IPs
      type: String
    - contextPath: File.SHA256
      description: Malicious SHA256 file hashes
      type: String
    - contextPath: Process.CommandLine
      description: Suspicious commands
      type: String
    - contextPath: DBotScore.Indicator
      description: 'Indicator value. Can be: IP, SHA1, MD5, SHA256, Email, or Url'
      type: String
    - contextPath: DBotScore.Type
      description: 'Indicator type. Can be: ip, file, email, or url'
      type: String
    - contextPath: DBotScore.Vendor
      description: SafeBreach. This is the vendor reporting the score of the indicator
      type: String
    - contextPath: DBotScore.Score
      description: 3 (Bad). The score of the indicator
      type: Number
  - arguments:
    - default: false
      description: The id of the insight to rerun
      isArray: false
      name: insightId
      required: true
      secret: false
    deprecated: false
    description: Rerun a specific SafeBreach Insight related simulations in your environment.
    execution: false
    name: safebreach-rerun-insight
    outputs:
    - contextPath: SafeBreach.Insight.Id
      description: Insight unique id
      type: Number
    - contextPath: SafeBreach.Insight.Rerun.Name
      description: Insight rerun test name
      type: String
    - contextPath: SafeBreach.Insight.Rerun.Id
      description: Id of the rerun insight test
      type: String
    - contextPath: SafeBreach.Insight.Rerun.AttacksCount
      description: Count of the attacks executed in the insight rerun test
      type: Number
    - contextPath: SafeBreach.Test.Id
      description: Id of the test
      type: String
    - contextPath: SafeBreach.Test.Name
      description: Name of the test
      type: String
    - contextPath: SafeBreach.Test.AttacksCount
      description: Count of the attacks executed in the insight rerun test
      type: Number
    - contextPath: SafeBreach.Test.Status
      description: Test run status. For insight rerun, starts from PENDING.
      type: String
    - contextPath: SafeBreach.Test.ScheduledTime
      description: Time at which the test was triggered
      type: Date
  - arguments:
    - default: false
      defaultValue: '1000'
      description: Limits the maximal number of generated indicators. Default - 1000.
      isArray: false
      name: limit
      required: false
      secret: false
    - default: false
      description: |-
        Multi-select option for category of the insights to get remediation data for:
        Network Access, Network Inspection, Endpoint, Email, Web, Data Leak
      isArray: false
      name: insightCategory
      predefined:
      - ''
      required: false
      secret: false
    - default: false
      description: |-
        Multi-select option for remediation data type to get:
        Hash, Domain, URI, Command, Port, Protocol, Registry
      isArray: true
      name: insightDataType
      predefined:
      - ''
      required: false
      secret: false
    deprecated: false
    description: Fetches SafeBreach Insights and extracts indicators out of them,
      creating new or updating existing indicators.
    execution: false
    name: safebreach-get-indicators
  - arguments:
    - default: false
      description: The id of the test to track
      isArray: false
      name: testId
      required: true
      secret: false
    deprecated: false
    description: Get status of a SafeBreach test for tracking progress of a run
    execution: false
    name: safebreach-get-test-status
    outputs:
    - contextPath: SafeBreach.Test.Id
      description: Id of the test
      type: String
    - contextPath: SafeBreach.Test.Name
      description: Name of the test
      type: String
    - contextPath: SafeBreach.Test.Status
      description: 'Test run status. Options: PENDING, RUNNING, CANCELED, COMPLETED'
      type: String
    - contextPath: SafeBreach.Test.StartTime
      description: Staring time of the test
      type: Date
    - contextPath: SafeBreach.Test.EndTime
      description: Ending time of the test
      type: Date
    - contextPath: SafeBreach.Test.TotalSimulationNumber
      description: Number of simulations for the test
      type: Number
  - arguments:
    - default: false
      description: The ID of the simulation. By default taken from the incident
      isArray: false
      name: simulationId
      required: true
      secret: false
    deprecated: false
    description: Get SafeBreach simulation
    execution: false
    name: safebreach-get-simulation
    outputs:
    - contextPath: SafeBreach.Simulation.Id
      description: Id of the simulation result
      type: String
    - contextPath: SafeBreach.Simulation.FinalStatus
      description: 'Simulation final status: Missed,Detected,Stopped,Prevented,Inconsistent'
      type: String
    - contextPath: SafeBreach.Simulation.Result
      description: Indicates whether the simulation was blocked or not
      type: String
    - contextPath: SafeBreach.Simulation.DetectedAction
      description: Indicates the overall detected action taken by security controls
      type: String
    - contextPath: SafeBreach.Simulation.SimulationRunId
      description: The unique simulation run id (changes between simulation runs)
      type: Number
    - contextPath: SafeBreach.Simulation.Time
      description: Latest simulation run time
      type: Datetime
    - contextPath: SafeBreach.Simulation.LastChangeTime
      description: Time when the simulation result was changed
      type: Datetime
    - contextPath: SafeBreach.Simulation.Labels
      description: Array of labels applied on the simulation
      type: Array
    - contextPath: SafeBreach.Simulation.Attack.Id
      description: Id of the simulated attack
      type: String
    - contextPath: SafeBreach.Simulation.Attack.Name
      description: Name of the simulated attack
      type: String
    - contextPath: SafeBreach.Simulation.Attack.Description
      description: Description of the attack flow
      type: String
    - contextPath: SafeBreach.Simulation.Attack.Phase
      description: 'The phase of the attack: Infiltration, Exfiltration ,Lateral Movement,Host
        Level'
      type: String
    - contextPath: SafeBreach.Simulation.Attack.Type
      description: The type of the attack. For example:,Real C2 Communication,Malware
        Transfer,Malware Write to Disk
      type: String
    - contextPath: SafeBreach.Simulation.Attack.SecurityControl
      description: Related security control category
      type: String
    - contextPath: SafeBreach.Simulation.Attack.IndicatorBased
      description: True if this attack is based on an indicator. False if this is
        behavioral non-indicator based.
      type: Bool
    - contextPath: SafeBreach.Simulation.Attacker.Name
      description: Name of the attacker simulator
      type: String
    - contextPath: SafeBreach.Simulation.Attacker.OS
      description: OS of the attacker simulator
      type: String
    - contextPath: SafeBreach.Simulation.Attacker.InternalIp
      description: Internal IP of the attacker simulator
      type: String
    - contextPath: SafeBreach.Simulation.Attacker.ExternalIp
      description: External IP of the attacker simulator
      type: String
    - contextPath: SafeBreach.Simulation.Attacker.SimulationDetails
      description: Simulation run detailed logs from the attacker simulator
      type: JSON
    - contextPath: SafeBreach.Simulation.Target.Name
      description: Name of the target simulator
      type: String
    - contextPath: SafeBreach.Simulation.Target.OS
      description: OS of the target simulator
      type: String
    - contextPath: SafeBreach.Simulation.Target.InternalIp
      description: Internal IP of the target simulator
      type: String
    - contextPath: SafeBreach.Simulation.Target.ExternalIp
      description: External IP of the target simulator
      type: String
    - contextPath: SafeBreach.Simulation.Target.SimulationDetails
      description: Simulation run detailed logs from the target simulator
      type: JSON
    - contextPath: SafeBreach.Simulation.Network.Direction
      description: 'Attack network direction relative to the target: inbound / outbound'
      type: String
    - contextPath: SafeBreach.Simulation.Network.SourceIp
      description: The IP initiated the network communication
      type: String
    - contextPath: SafeBreach.Simulation.Network.DestinationIp
      description: The IP received the network communication
      type: String
    - contextPath: SafeBreach.Simulation.Network.SourcePort
      description: The source port of the network communication
      type: String
    - contextPath: SafeBreach.Simulation.Network.DestinationPort
      description: The destination port of the network communication
      type: String
    - contextPath: SafeBreach.Simulation.Network.Protocol
      description: The top level protocol of the network communication
      type: String
    - contextPath: SafeBreach.Simulation.Network.Proxy
      description: The proxy name used in the network communication
      type: String
    - contextPath: SafeBreach.Simulation.Classifications.MITRETechniques
      description: List of attack related MITRE techniques
      type: Array
    - contextPath: SafeBreach.Simulation.Classifications.MITREGroups
      description: List of attack related MITRE threat groups
      type: Array
    - contextPath: SafeBreach.Simulation.Classifications.MITRESoftware
      description: List of attack related MITRE software and tools
      type: Array
    - contextPath: SafeBreach.Simulation.Parameters
      description: Parameters of the simulation
      type: JSON
  - arguments:
    - default: false
      description: The id of the simulation to rerun
      isArray: false
      name: simulationId
      required: true
      secret: false
    deprecated: false
    description: Rerun a specific SafeBreach simulation in your environment
    execution: false
    name: safebreach-rerun-simulation
    outputs:
    - contextPath: SafeBreach.Simulation.Id
      description: Simulation unique id
      type: Number
    - contextPath: SafeBreach.Simulation.Rerun.Name
      description: Simulation rerun test name
      type: String
    - contextPath: SafeBreach.Simulation.Rerun.Id
      description: Id of the rerun test
      type: String
    - contextPath: 'SafeBreach.Simulation.Rerun.ScheduledTime '
      description: Time at which the rerun was triggered
      type: Datetime
    - contextPath: SafeBreach.Test.Id
      description: Id of the test
      type: String
    - contextPath: SafeBreach.Test.Name
      description: Name of the test
      type: String
    - contextPath: SafeBreach.Test.AttacksCount
      description: Count of the attacks executed in the insight rerun test
      type: Number
    - contextPath: SafeBreach.Test.Status
      description: Test run status. For insight rerun - “PENDING”
      type: String
    - contextPath: SafeBreach.Test.ScheduledTime
      description: Time at which the test was triggered
      type: Datetime
  dockerimage: demisto/python3:3.8.2.6981
  feed: true
  isfetch: false
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  subtype: python3
  type: python
image: data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOYAAAAkCAYAAACdSkYEAAAJ+klEQVR42u3dA5DkQBiG4bk927Zt27Zt27Zt27Zt27Zts+/dqlxVriuDzCZze1v5q57DTnfXTDLfoNPJ2qyyyiqrrLLKKqusssoqq6yyyswKkDh7UZyBwGtMRAiNdomwAd8UG5BIo10IZYzXEMrYRW1+sRJnD4cu2IdXEPiOJ9iJXghls8qv7O+k6Iy5OI4TZoWyOISGPfCnahcdzzTaPUN0VTt/Sl+hobgf20mF8ALCgR8IabPKT5TyIixULpsVzLMQdhRVtRvhoN0I6d1X2HHWBxvEP3KiIyZiDmZjFFoiC7w8uIPS4TOEE2c8cF8CIS4yoQBKowyKIRcSI7DNqv8qmMKBbqp2OyG8BUSgv9vtULXr5mhMNzaEF5rjAYQTTzAOcT2wg45CSN5hO1ZgPz5goon3oTru4ieEE99xCgMR32aVrw/mSwg76tuUqpogw/hZcVOf3hgn5fMtcVL+9Ob9b352xvs21Xj1HYz3UudGCIrNEDr1NnnnpIeQbEAoqV1gRDP9SaLfdwxDAJtVvjaYIyE0vEYEm1IEsSCEHQVV40XAGwgNI3VuhAUQOv1EHJN3TkcIlc8I5wueJHotsVnla4MZBGsgVF4gn9yWALbHDwjFD7TXGDMfXkhjrkEQHRsgA4TkF1aiBvKhOOpjHK5DYIcHds4UCJV9vuRJ8hntUQ+1FG0wFfcgNJS3WeWrgimHKSOaogJC22tHEOOgniKOg/FCo4IyZkY3NsBICElrJ31ye/PAzlkMobLUlzxJXjv5rt4Ov6Q+G21WGRVMv1/KJIpQ+YSABs1gpkNVdEBv9EEbFEFwN4K5AmHsCORgHH/IjJboi+6oiTiGBVMugij1eeBCnyBIjwpoitbK36WQwIX+IVASndEXHVECoXTOyidHBbRDT2WsDiiN8G4+H7yQRXk8vRUtURhhXAom7VAQjdEaDZEPwf1iMI9AqHwwYMz+Lhzi+IDRCOFyMB2rYyeQjXAbQsMv7EI6E4LZX+rzyk67mOiO/fgK4cAWO2OExwR8gtDwCeMR2sl9boB3EA58wzxEcfG5EABtcc/JJNlyJ9v8m9JOaPiMKYjg7sfYiOiHjWUSZNzTPH76bnY+xgZEY6xSNIbmu5j3GN5jeY+pjB1RZ4i2QUhK+TCYQyBcdBqhDA8mr6LY4GLfL6hscDDnSH0uGDCxNNHOcd4HLva/hpgO7nNDCBfdR2wn2yCK9MLvyBoDJtxuI7beUMbHYwhvY+KlEYRN9IyXbrcUykDYBSHZhUDqtj3ipdvjfRtjqSd/HiO+znc3IXmNMj4IZn0IHSYbGUzlnXILhA5fkN6IYHJ7SnyQ+gwzIJjyi098vIDQ4TQC2rkvOXSOtd3BNgiFSzrGamXQTPhh+NMTzHXqhQObVKFrEj99WVUwW0LY0dKmlHefPz/fhIDK2Ip1OkIU28HHzp0oDi83jj/OQxPkRTLEVX7eFe80QhHShWBewhA70qn6tYCQHEIRREcK9MM3qc1+F8PzBpFVYihjVsA0jY+UDxDBxbHfKvetIgqjDDpgFZJIffdrHMKagLSIjlx2jk+3tHNfImIl2qAgkiMeUqM5HkFIktsZa7adhSn9UQw5URo9cQTJnGyXj5iK+iiKMspYryEkxfUE8yuEtwiJsv0VuC7x0q1TBXMThB2bbEp591HfxpjqYH7VGaTmLnxs6Y+YBn2vzQ8hKeJCMBe7OIHyTH5l13qXUCaAhCSFwccxryOZ0bOPygumkDSx8z17vdTuopv7LZHGi3grjXYpNFZJHUV4o2dl+XkajRfYmX4imMoDbObChM03LEA8A8J5Xj5EY1AwK2ksbo/voP1FqX0Hg1f+dEFQE4K5Sup3xEHbFBCSmG7ut9XSOOM12ozTmJyJbdrhEr6fSm3P+u6Psvo3ekLMwRcIBz6htg+DuVJe3mdQMKfLH2GdtB8vtV9gwsqfe8hsVDCVd8E3Ur82jrpofIoo6eZ+GyaNM1+jzXWtbWpiMDvIXwd8PPnjPYFj2uSP+6GJhHY4A2HHL1Rz8uW/PubjBO7gPi5gLa6YFMxDGh8lZztwWmq/x4UnySe0lnTGcGzGRwjJWyQwKJixNCdiHD9OOcjN7IwdGJUxA4dwAw9xGVtwwuE+YTZcY3FFfZODWRlCzZ3DJf1NPFzS39XDJTqX7C2WN7biDcJr9KmNVxCOmBTMmxA+cMqAWdkwmAohmW9QMDNC+FBnO+e93tM5jhzMhBptipoczJIOgunHixUWdqbmWzk8VOL5YD7wWDD1n7L2Hl4GBDOr0cFUJuS+QfgwmEk12uQ3OZhF/H4w9c8ELlHdHhpvNZ6Mo1AaWZANVXHOpGBelicCMEaHVgYGsxeEJLoBwUwFIVmh83HmlL6zXtOY6JuJSsiqKI89ToIZE0JS0bcH0/xF7OaH85XdMz7YARrfQ7M5XDxgfDDlhQWbbDrLwGB2hpAkMCCYYTS+WtTxweNLAyGp4eKqLjmY/jUmDwf42mAqp32t1jjtK6/Bp32tRhCPB1P7/MmbNsrDweynMVET4R8Fc63GC1VIgw6XXJVPIPfB4yunsVAhgFvB1J6Auwwv3xRM33+iNCFGXhfbFoaQzFPd3k667Tn8eTiYGex8zPPyaDB5B8MvrQP7BgVzOISksqMueiZPENbtYGofXmrj+WAaf2mRM1xO5IV0aZHTplxahI/Bqu9iHZESATUuHdnYzkxrXVW70hCSFp4MptJvH4RkF7LDv8bpaVnQF+F0LJuLiADSYYLEqI5NEBraGRjMOPiqdSkTzYP5BE0JYFuN25JBSEbDy81gRsB7jXfhoYiqcTpYWpQxMpimXowrkELVbqfhF+NSVnJIfuAZ7uCFk9X8QVRjhZQnfxQXMBNjMAlL8MTEYKZ0sIrpPS7jHG5LpxLlcmOh+S8XL9J1EoGMCqbStweEHY9xHhfxFELxyJWPxoo7mIcxmIgFuO3SPmESzcH2uoszuKpaV3zOQ8H0/ZevVN4Jv0K44R0ya6+79fzhEo2+ZfAFQofGJl3z5wAi2yiDg+kPcyB00T4xuSh++uxwifalYVz0BQE8EEzff8Fn5QTbKfig+9Qaxwuz2+CTx4OpfZbLcQgXDTE4mGdRD15mXkJDOYvnJYQLfiGdnXHK44VhwVROvtZx35IaFUyzf0XCV4W5vyKBcVAeE3AQj/FN9d3gqfLzUcihY1lfKyzEMVzFdZzHEazCWDRBdjunfZVGF5XSbk5u5MU4HMIDvMYzXMBq9EUeeDl4LBXQE1OwDJuwG3uVv7diMYaiFuK5eN+ySI+xoZuPMTjqYjHO4xle4wGOYC5aIL6TcUKiHmbhEK7gBi7iONZhElohH8K7+PxqoGy3y3iOF7iDPRiDEgjgznZRTilU2imsssoqq6yyyiqrrLLKKqusssrk+g3rPqPix+2WlgAAAA90RVh0Q29tbWVudABjaW1hZ2Vz5AUQeQAAAABJRU5ErkJggg==
fromversion: 5.5.0
