id: VxStream Test
version: -1
contentitemfields:
  propagationLabels: []
name: VxStream Test
starttaskid: '0'
tasks:
  "0":
    id: "0"
    taskid: d1a66ef0-0aee-451f-8594-bfc4f1409816
    type: start
    task:
      id: d1a66ef0-0aee-451f-8594-bfc4f1409816
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "1":
    id: "1"
    taskid: 6a054a13-1c96-4d6a-889b-fa13cd2a5f89
    type: regular
    task:
      id: 6a054a13-1c96-4d6a-889b-fa13cd2a5f89
      version: -1
      name: Get Environments
      description: Get a list of all available environments
      script: '|||crowdstrike-get-environments'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "13"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "3":
    id: "3"
    taskid: 39dc2b9e-8a70-455f-837f-48c66c3c1376
    type: regular
    task:
      id: 39dc2b9e-8a70-455f-837f-48c66c3c1376
      version: -1
      name: Search
      description: Search the database using the Falcon Sandbox search syntax
      script: '|||crowdstrike-search'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "12"
      - "14"
    scriptarguments:
      authentihash: {}
      av_detect: {}
      context: {}
      country: {}
      domain: {}
      env_id: {}
      filename: {}
      filetype: {}
      filetype_desc: {}
      host: {}
      imp_hash: {}
      port: {}
      query: {}
      similar_to:
        simple: b2ac43820cdf8634e1a437b9723ec110513d3dd7a2f8d4fa3192babe3eaa4b8e
      ssdeep: {}
      tag: {}
      url: {}
      verdict: {}
      vx_family: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "5":
    id: "5"
    taskid: 580277db-83fb-486a-8e81-9fd2efa67382
    type: regular
    task:
      id: 580277db-83fb-486a-8e81-9fd2efa67382
      version: -1
      name: Scan
      description: Get summary information for a given MD5, SHA1 or SHA256 and all
        the reports generated for any environment ID
      script: '|||crowdstrike-scan'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      file:
        simple: 30d68d5f036e3edda345a0be211a14145fa763372620648d3dc2f8f7dbdf43c4
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "6":
    id: "6"
    taskid: 55e1d245-a687-4767-895a-e4fd010d8dc5
    type: condition
    task:
      id: 55e1d245-a687-4767-895a-e4fd010d8dc5
      version: -1
      name: Exists scan
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: Exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "20"
    scriptarguments:
      value:
        complex:
          root: File
          accessor: environmentId
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "11":
    id: "11"
    taskid: 8becc14a-a88b-49df-8272-ab5b145ac4a7
    type: regular
    task:
      id: 8becc14a-a88b-49df-8272-ab5b145ac4a7
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "12":
    id: "12"
    taskid: cf8ba936-300b-40f0-84fd-1d94748e10c8
    type: regular
    task:
      id: cf8ba936-300b-40f0-84fd-1d94748e10c8
      version: -1
      name: crowdstrike-submit-url
      description: Submit a URL for analysis (Supported only in v2)
      script: '|||crowdstrike-submit-url'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      dontThrowErrorOnFileDetonation: {}
      environmentID:
        simple: "100"
      extend-context:
        simple: URL1_HASH=sha256
      url:
        simple: https://onedrive.live.com/?blahkey=%21AG6pRt%5FDkLiDBm5&blegh=8c90d345gGvf8asLdkfj&whocares=0CDfasdfajiog3%21105&darPd
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "13":
    id: "13"
    taskid: 752ade64-b8a0-4a37-822c-f945610859d3
    type: condition
    task:
      id: 752ade64-b8a0-4a37-822c-f945610859d3
      version: -1
      name: Verify Context get-environments
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      scriptName: Exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "3"
    scriptarguments:
      value:
        complex:
          root: CrowdStrike
          filters:
          - - operator: isExists
              left:
                value:
                  simple: CrowdStrike.Environment.ID
                iscontext: true
          - - operator: isExists
              left:
                value:
                  simple: CrowdStrike.Environment.description
                iscontext: true
          - - operator: isExists
              left:
                value:
                  simple: CrowdStrike.Environment.architecture
                iscontext: true
          - - operator: isExists
              left:
                value:
                  simple: CrowdStrike.Environment.VMs_busy
                iscontext: true
          - - operator: isExists
              left:
                value:
                  simple: CrowdStrike.Environment.analysisMode
                iscontext: true
          - - operator: isExists
              left:
                value:
                  simple: CrowdStrike.Environment.groupicon
                iscontext: true
          accessor: Environment
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "14":
    id: "14"
    taskid: f8ceac19-a506-4839-8745-d2859c2063e2
    type: regular
    task:
      id: f8ceac19-a506-4839-8745-d2859c2063e2
      version: -1
      name: crowdstrike-submit-url
      description: Submit a URL for analysis (Supported only in v2)
      script: '|||crowdstrike-submit-url'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      dontThrowErrorOnFileDetonation: {}
      environmentID:
        simple: "100"
      extend-context:
        simple: URL2_HASH=sha256
      url:
        simple: https://onedrive.live.com/?blahkey=%21AG6pRt%5FDkLiDBm5&blegh=8c90d345gGvf8asLdkfj&whocares=0CDfasdfajiog3%21105&darP5
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "15":
    id: "15"
    taskid: eba8bd7a-e62e-4e03-8cd3-97449ad9ce58
    type: condition
    task:
      id: eba8bd7a-e62e-4e03-8cd3-97449ad9ce58
      version: -1
      name: Verify different hashes for different submitted URLs
      description: Ensure that the URL is being submitted correctly to crowdstrike
        and not only the contents up until the first ampersand are being processed
        by crowdstrike. If the two URLs (whose contents only differ after the ampersand)
        get the same hash returned by crowdstrike it means that we are incorrectly
        submitting the URLs and that their contents are getting cut off at the first
        ampersand (this is bad, the desired behavior is that the hashes should differ).
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "5"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEqualString
          left:
            value:
              complex:
                root: URL1_HASH
            iscontext: true
          right:
            value:
              complex:
                root: URL2_HASH
            iscontext: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "16":
    id: "16"
    taskid: dff3972d-f6f7-4818-8e53-27c657d76adc
    type: title
    task:
      id: dff3972d-f6f7-4818-8e53-27c657d76adc
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "17":
    id: "17"
    taskid: ba5c5042-abeb-4b43-8bac-34ef7f5d082a
    type: regular
    task:
      id: ba5c5042-abeb-4b43-8bac-34ef7f5d082a
      version: -1
      name: Upload file
      description: Sends http request. Returns the response as json.
      scriptName: http
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      body: {}
      filename: {}
      headers: {}
      insecure: {}
      method:
        simple: GET
      password: {}
      proxy: {}
      saveAsFile:
        simple: "yes"
      unsecure: {}
      url:
        simple: https://github.com/demisto/content/raw/master/TestData/pdfworking.pdf
      username: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "18":
    id: "18"
    taskid: fcb26094-2dbc-4302-891b-7bee822db3be
    type: regular
    task:
      id: fcb26094-2dbc-4302-891b-7bee822db3be
      version: -1
      name: Submit file
      description: Submit a file from investigation to analysis server
      script: '|||crowdstrike-submit-sample'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      entryId:
        simple: ${File.EntryID}
      environmentID: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "19":
    id: "19"
    taskid: 8db96a11-e91b-4f45-8a26-c765d8122a84
    type: condition
    task:
      id: 8db96a11-e91b-4f45-8a26-c765d8122a84
      version: -1
      name: Verify there's a new job
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "21"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: CrowdStrike.JobID
            iscontext: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "20":
    id: "20"
    taskid: 7542e447-b59a-4c11-847a-0c844be78af5
    type: regular
    task:
      id: 7542e447-b59a-4c11-847a-0c844be78af5
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "21":
    id: "21"
    taskid: 60bdff05-b473-43dd-835b-cf1dbdc40a8f
    type: regular
    task:
      id: 60bdff05-b473-43dd-835b-cf1dbdc40a8f
      version: -1
      name: 'test result '
      description: Retrieve result data upon a file. NOTE - This command returns a
        file
      script: '|||crowdstrike-result'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      JobID:
        complex:
          root: CrowdStrike
          accessor: JobID
      environmentId: {}
      file: {}
      file-type: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2485,
        "width": 810,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
fromversion: 5.0.0
description: ''
