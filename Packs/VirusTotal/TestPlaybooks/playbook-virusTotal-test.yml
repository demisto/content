id: virusTotal-test-playbook
version: -1
name: virusTotal-test-playbook
description: |
  Test playbook for vt.

  vt has a quota of requests per minute that we exceed in the test playbook.

  Sleep for 60 seconds.

  https://support.virustotal.com/hc/en-us/articles/115002118525-The-4-requests-minute-limitation-of-the-Public-API-is-too-low-for-me-how-can-I-have-access-to-a-higher-quota-
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: fe179079-6b2b-460b-875f-5306376a165f
    type: start
    task:
      id: fe179079-6b2b-460b-875f-5306376a165f
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: a9e924e9-1d58-4ffd-88f2-69b39b16e4e8
    type: regular
    task:
      id: a9e924e9-1d58-4ffd-88f2-69b39b16e4e8
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "51"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: 41b11630-e3fd-48c1-86bb-64239f58e2dc
    type: regular
    task:
      id: 41b11630-e3fd-48c1-86bb-64239f58e2dc
      version: -1
      name: ip
      description: Checks the reputation of an IP address.
      script: VirusTotal|||ip
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "60"
    scriptarguments:
      ip:
        simple: 8.8.8.8
    continueonerror: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 7f78395a-836d-4bb1-8f0c-350c0a799a75
    type: condition
    task:
      id: 7f78395a-836d-4bb1-8f0c-350c0a799a75
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "83"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
          right:
            value:
              simple: 8.8.8.8
      - - operator: isEqualString
          left:
            value:
              simple: IP.Geo.Country
            iscontext: true
          right:
            value:
              simple: US
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 3031a30a-fa6e-4785-8217-5af45eeab2ca
    type: regular
    task:
      id: 3031a30a-fa6e-4785-8217-5af45eeab2ca
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: ddf0a5e6-3f9b-413e-820c-387a1f370056
    type: regular
    task:
      id: ddf0a5e6-3f9b-413e-820c-387a1f370056
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      script: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      expectedValue:
        simple: demisto.com
      path:
        simple: DBotScore.Indicator
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: dbaa10b4-9351-4670-8fd1-62f8464ecdc6
    type: regular
    task:
      id: dbaa10b4-9351-4670-8fd1-62f8464ecdc6
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: 5424d878-9508-42c8-8325-c736cddffad0
    type: regular
    task:
      id: 5424d878-9508-42c8-8325-c736cddffad0
      version: -1
      name: domain
      description: Checks the reputation of a domain.
      script: VirusTotal|||domain
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "62"
    scriptarguments:
      domain:
        simple: demisto.com
    continueonerror: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 3a41b0f2-76e6-40fe-89f8-d46e4d0a2642
    type: regular
    task:
      id: 3a41b0f2-76e6-40fe-89f8-d46e4d0a2642
      version: -1
      name: file
      description: Checks the file reputation of the specified hash.
      script: VirusTotal|||file
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "65"
    scriptarguments:
      file:
        simple: 7657fcb7d772448a6d8504e4b20168b8,d8c1df8a83ae7e3b33f8b766a72b75c2
    continueonerror: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3695
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: 8bc25f18-1ad0-44e9-881e-b22e626d57ad
    type: condition
    task:
      id: 8bc25f18-1ad0-44e9-881e-b22e626d57ad
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "10"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: File.MD5
            iscontext: true
          right:
            value:
              simple: 7657fcb7d772448a6d8504e4b20168b8
      - - operator: isEqualString
          left:
            value:
              simple: File.MD5
            iscontext: true
          right:
            value:
              simple: d8c1df8a83ae7e3b33f8b766a72b75c2
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4045
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: f0db5f57-e612-4109-827c-a0307ccb3c08
    type: regular
    task:
      id: f0db5f57-e612-4109-827c-a0307ccb3c08
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 8f86602d-c0cb-45e0-8f1c-5d0b1de99abc
    type: regular
    task:
      id: 8f86602d-c0cb-45e0-8f1c-5d0b1de99abc
      version: -1
      name: url long demisto.com
      description: Checks the reputation of a URL.
      script: VirusTotal|||url
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "79"
    scriptarguments:
      long:
        simple: "true"
      url:
        simple: www.demisto.com
    continueonerror: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 8595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 8ec45471-846a-433c-8cd0-80e6992d1dad
    type: regular
    task:
      id: 8ec45471-846a-433c-8cd0-80e6992d1dad
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      script: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      expectedValue:
        simple: www.demisto.com
      path:
        simple: DBotScore.Indicator
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: 5eecfead-eed0-4a29-82e9-7368d9a3b3ae
    type: regular
    task:
      id: 5eecfead-eed0-4a29-82e9-7368d9a3b3ae
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "42"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 9120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: ba1335a4-c85b-424d-84f0-372bf356bea1
    type: regular
    task:
      id: ba1335a4-c85b-424d-84f0-372bf356bea1
      version: -1
      name: file (second hash)
      description: Checks the file reputation of the specified hash.
      script: VirusTotal|||file
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "68"
    scriptarguments:
      file:
        simple: d41d8cd98f00b204e9800998ecf8427e
    continueonerror: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5095
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: a53f2e92-c4a1-4423-8009-058e5affd261
    type: condition
    task:
      id: a53f2e92-c4a1-4423-8009-058e5affd261
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "22"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: File
                accessor: MD5
            iscontext: true
          right:
            value:
              simple: d41d8cd98f00b204e9800998ecf8427e
      - - operator: isExists
          left:
            value:
              simple: File.VirusTotal.vtLink
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: fdff5834-775b-48e9-8148-139adf12a77a
    type: regular
    task:
      id: fdff5834-775b-48e9-8148-139adf12a77a
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: d500ec4b-dd0b-49ca-802f-474556d6114d
    type: regular
    task:
      id: d500ec4b-dd0b-49ca-802f-474556d6114d
      version: -1
      name: file long (second hash)
      description: Checks the file reputation of the specified hash.
      script: VirusTotal|||file
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "72"
    scriptarguments:
      file:
        simple: d41d8cd98f00b204e9800998ecf8427e
      long:
        simple: "true"
    continueonerror: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5795
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: 094625b2-e92b-43a1-80fb-c7f95f65dbd5
    type: regular
    task:
      id: 094625b2-e92b-43a1-80fb-c7f95f65dbd5
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 6320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "25":
    id: "25"
    taskid: 5388f66b-bfda-47d7-89bb-87e90b72f718
    type: condition
    task:
      id: 5388f66b-bfda-47d7-89bb-87e90b72f718
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "24"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: File
                accessor: MD5
            iscontext: true
          right:
            value:
              simple: d41d8cd98f00b204e9800998ecf8427e
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6145
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: 845b7f04-9b41-4b7e-8271-ddd77701f4a7
    type: regular
    task:
      id: 845b7f04-9b41-4b7e-8271-ddd77701f4a7
      version: -1
      name: file long
      description: Checks the file reputation of the specified hash.
      script: VirusTotal|||file
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "66"
    scriptarguments:
      file:
        simple: 7657fcb7d772448a6d8504e4b20168b8
      long:
        simple: "true"
    continueonerror: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4395
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: 20b39ace-8d03-4a45-8db5-c04611dab852
    type: condition
    task:
      id: 20b39ace-8d03-4a45-8db5-c04611dab852
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "29"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: File
                accessor: MD5
            iscontext: true
          right:
            value:
              simple: 7657fcb7d772448a6d8504e4b20168b8
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4745
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: fb15503b-1e09-4495-8ee7-d7b093bf15ab
    type: regular
    task:
      id: fb15503b-1e09-4495-8ee7-d7b093bf15ab
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: b6fd465e-9d64-444b-8b48-1c231a54bba2
    type: regular
    task:
      id: b6fd465e-9d64-444b-8b48-1c231a54bba2
      version: -1
      name: url coffedoesgood.com
      description: Checks the reputation of a URL.
      script: VirusTotal|||url
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "73"
    scriptarguments:
      threshold:
        simple: "0"
      url:
        simple: http://coffeedoesgood.com
    continueonerror: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 6495
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: 38d3900c-f463-49a8-8f3a-3a76aa365a87
    type: regular
    task:
      id: 38d3900c-f463-49a8-8f3a-3a76aa365a87
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      script: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      expectedValue:
        simple: http://coffeedoesgood.com
      path:
        simple: DBotScore.Indicator
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6845
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: 1429c464-86b5-4f78-89b3-fdedb5fbe8f0
    type: regular
    task:
      id: 1429c464-86b5-4f78-89b3-fdedb5fbe8f0
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "33"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 7020
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: 35f51254-9453-4432-8c98-77c56e8b0f5d
    type: regular
    task:
      id: 35f51254-9453-4432-8c98-77c56e8b0f5d
      version: -1
      name: url long coffedoesgood.com
      description: Checks the reputation of a URL.
      script: VirusTotal|||url
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "75"
    scriptarguments:
      long:
        simple: "true"
      threshold:
        simple: "0"
      url:
        simple: http://coffeedoesgood.com
    continueonerror: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 7195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: 1218461a-898a-4f18-8d91-5bfb98e44099
    type: condition
    task:
      id: 1218461a-898a-4f18-8d91-5bfb98e44099
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "35"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
          right:
            value:
              simple: http://coffeedoesgood.com
      - - operator: isEqualNumber
          left:
            value:
              simple: URL.DetectionEngines
            iscontext: true
          right:
            value:
              simple: "70"
      - - operator: isEqualNumber
          left:
            value:
              simple: URL.PositiveDetections
            iscontext: true
          right:
            value:
              simple: "4"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: b82cb928-a2e9-41be-8604-abcb8b72ab25
    type: regular
    task:
      id: b82cb928-a2e9-41be-8604-abcb8b72ab25
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 7720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: b42fa8c2-7e9a-4972-896d-edb1985630d3
    type: regular
    task:
      id: b42fa8c2-7e9a-4972-896d-edb1985630d3
      version: -1
      name: url demisto.com
      description: Checks the reputation of a URL.
      script: VirusTotal|||url
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "77"
    scriptarguments:
      url:
        simple: www.demisto.com
    continueonerror: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 7895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: 00a78c12-e41f-495f-8f15-0ed1da4b5641
    type: regular
    task:
      id: 00a78c12-e41f-495f-8f15-0ed1da4b5641
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      script: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "38"
    scriptarguments:
      expectedValue:
        simple: www.demisto.com
      path:
        simple: DBotScore.Indicator
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: 90d7b8af-a034-42e1-834a-6fc2aca6ea46
    type: regular
    task:
      id: 90d7b8af-a034-42e1-834a-6fc2aca6ea46
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 8420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: ef536582-1e56-4c8a-8610-d1644d8e6ade
    type: regular
    task:
      id: ef536582-1e56-4c8a-8610-d1644d8e6ade
      version: -1
      name: domain
      description: Checks the reputation of a domain.
      script: VirusTotal|||domain
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "81"
    scriptarguments:
      domain:
        simple: demisto.com
      threshold:
        simple: "0"
    continueonerror: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 9295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: 274b691d-949f-4b1b-8d7d-c89a4f70000c
    type: regular
    task:
      id: 274b691d-949f-4b1b-8d7d-c89a4f70000c
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      script: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "44"
    scriptarguments:
      expectedValue:
        simple: demisto.com
      path:
        simple: DBotScore.Indicator
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "44":
    id: "44"
    taskid: 519dd7d5-4fc7-4c0d-8053-a61c6208ab8f
    type: regular
    task:
      id: 519dd7d5-4fc7-4c0d-8053-a61c6208ab8f
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "93"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 9820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: 09f773b2-5e83-46a4-8f16-87005adfb72f
    type: regular
    task:
      id: 09f773b2-5e83-46a4-8f16-87005adfb72f
      version: -1
      name: Set
      description: Sets a value into the context with the given context key
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "52"
    scriptarguments:
      key:
        simple: File.SHA1
      value:
        simple: 3395856ce81f2b7382dee72602f798b642f14140
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "52":
    id: "52"
    taskid: f00a1c94-ab5c-4a66-8a30-fcfd8337e271
    type: regular
    task:
      id: f00a1c94-ab5c-4a66-8a30-fcfd8337e271
      version: -1
      name: Set2
      description: Sets a value into the context with the given context key
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "53"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: File.SHA1
      value:
        simple: cf8bd9dfddff007f75adf4c2be48005cea317c62
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: 9da7c092-65f1-49b3-8f32-a075beac3e90
    type: regular
    task:
      id: 9da7c092-65f1-49b3-8f32-a075beac3e90
      version: -1
      name: File (1 call)
      description: Checks the file reputation of the specified hash.
      script: VirusTotal|||file
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "58"
    scriptarguments:
      file:
        complex:
          root: File
          accessor: SHA1
          transformers:
          - operator: atIndex
            args:
              index:
                value:
                  simple: "0"
      threshold:
        simple: "1"
    continueonerror: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "54":
    id: "54"
    taskid: 42fec6f9-b866-48e1-8d9c-32399537e60c
    type: regular
    task:
      id: 42fec6f9-b866-48e1-8d9c-32399537e60c
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "85"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "56":
    id: "56"
    taskid: a6e14649-a38e-4f37-8f29-c0bce4a2cf7f
    type: condition
    task:
      id: a6e14649-a38e-4f37-8f29-c0bce4a2cf7f
      version: -1
      name: Exists
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      scriptName: Exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "57"
    scriptarguments:
      value:
        complex:
          root: File
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: File.MD5
                iscontext: true
              right:
                value:
                  simple: 44d88612fea8a8f36de82e1278abb02f
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "57":
    id: "57"
    taskid: e0fb97af-0825-432c-8885-d3c2e4ac5912
    type: condition
    task:
      id: e0fb97af-0825-432c-8885-d3c2e4ac5912
      version: -1
      name: Exists2
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      scriptName: Exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "95"
    scriptarguments:
      value:
        complex:
          root: File
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: File.MD5
                iscontext: true
              right:
                value:
                  simple: 44d88612fea8a8f36de82e1278abb02f
          accessor: MD5
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "58":
    id: "58"
    taskid: 1330510c-cafa-4e04-8d3a-43dc462e2754
    type: condition
    task:
      id: 1330510c-cafa-4e04-8d3a-43dc462e2754
      version: -1
      name: Check for error
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "56"
      "yes":
      - "59"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: ${Error}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "59":
    id: "59"
    taskid: 9e3d4092-1c64-4a5f-8844-4b2acf1e5cfc
    type: condition
    task:
      id: 9e3d4092-1c64-4a5f-8844-4b2acf1e5cfc
      version: -1
      name: Check if error is API-RATE
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "54"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: ${Error}
            iscontext: true
          right:
            value:
              simple: No content received. Possible API rate limit reached.
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: ad6b96fc-4b03-4657-87ad-4b5dfd16369c
    type: condition
    task:
      id: ad6b96fc-4b03-4657-87ad-4b5dfd16369c
      version: -1
      name: Check for error
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "61"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: ${Error}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    id: "61"
    taskid: 3049aa0c-3031-43f2-820b-1c42644d5d41
    type: condition
    task:
      id: 3049aa0c-3031-43f2-820b-1c42644d5d41
      version: -1
      name: Check if error is API-RATE
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "83"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: ${Error}
            iscontext: true
          right:
            value:
              simple: No content received. Possible API rate limit reached.
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "62":
    id: "62"
    taskid: 3db9d2ea-0e49-48fa-8172-c2a145b4985b
    type: condition
    task:
      id: 3db9d2ea-0e49-48fa-8172-c2a145b4985b
      version: -1
      name: Check for error
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "63"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: ${Error}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: 06f8f547-be20-406e-84ce-db9f84ed25c9
    type: condition
    task:
      id: 06f8f547-be20-406e-84ce-db9f84ed25c9
      version: -1
      name: Check if error is API-RATE
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "6"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: ${Error}
            iscontext: true
          right:
            value:
              simple: No content received. Possible API rate limit reached.
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "64":
    id: "64"
    taskid: 1d89981c-514d-4567-863f-5d87bacc988d
    type: condition
    task:
      id: 1d89981c-514d-4567-863f-5d87bacc988d
      version: -1
      name: Check if error is API-RATE
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "10"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: ${Error}
            iscontext: true
          right:
            value:
              simple: No content received. Possible API rate limit reached.
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4045
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "65":
    id: "65"
    taskid: 79e9a1e7-16c1-4fbb-87e7-2eb131e825ff
    type: condition
    task:
      id: 79e9a1e7-16c1-4fbb-87e7-2eb131e825ff
      version: -1
      name: Check for error
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "9"
      "yes":
      - "64"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: ${Error}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "66":
    id: "66"
    taskid: e63b18ff-73c4-4ef5-843c-5b539c455504
    type: condition
    task:
      id: e63b18ff-73c4-4ef5-843c-5b539c455504
      version: -1
      name: Check for error
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "28"
      "yes":
      - "67"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: ${Error}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "67":
    id: "67"
    taskid: 2a39e194-d23c-470f-8224-e0af60190c31
    type: condition
    task:
      id: 2a39e194-d23c-470f-8224-e0af60190c31
      version: -1
      name: Check if error is API-RATE
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "29"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: ${Error}
            iscontext: true
          right:
            value:
              simple: No content received. Possible API rate limit reached.
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4745
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "68":
    id: "68"
    taskid: d95b11e9-96b2-4037-8a2c-bc8b96912350
    type: condition
    task:
      id: d95b11e9-96b2-4037-8a2c-bc8b96912350
      version: -1
      name: Check for error
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "21"
      "yes":
      - "69"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: ${Error}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "69":
    id: "69"
    taskid: ea41d985-fb5a-409c-8772-2520c7c3268b
    type: condition
    task:
      id: ea41d985-fb5a-409c-8772-2520c7c3268b
      version: -1
      name: Check if error is API-RATE
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "22"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: ${Error}
            iscontext: true
          right:
            value:
              simple: No content received. Possible API rate limit reached.
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "71":
    id: "71"
    taskid: 8a7f5a57-3a09-4acf-8d4a-e32853c4e14f
    type: condition
    task:
      id: 8a7f5a57-3a09-4acf-8d4a-e32853c4e14f
      version: -1
      name: Check if error is API-RATE
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "24"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: ${Error}
            iscontext: true
          right:
            value:
              simple: No content received. Possible API rate limit reached.
    view: |-
      {
        "position": {
          "x": 480,
          "y": 6145
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "72":
    id: "72"
    taskid: b0a3d06c-9b8f-4ab6-81ab-e49e349f66cb
    type: condition
    task:
      id: b0a3d06c-9b8f-4ab6-81ab-e49e349f66cb
      version: -1
      name: Check for error
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "25"
      "yes":
      - "71"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: ${Error}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "73":
    id: "73"
    taskid: b7cb1bc7-e2a6-45fa-82d3-3804a524b70e
    type: condition
    task:
      id: b7cb1bc7-e2a6-45fa-82d3-3804a524b70e
      version: -1
      name: Check for error
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "31"
      "yes":
      - "74"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: ${Error}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": 6670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "74":
    id: "74"
    taskid: 70de72de-1e7d-4079-8696-c2a07601dae3
    type: condition
    task:
      id: 70de72de-1e7d-4079-8696-c2a07601dae3
      version: -1
      name: Check if error is API-RATE
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "32"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: ${Error}
            iscontext: true
          right:
            value:
              simple: No content received. Possible API rate limit reached.
    view: |-
      {
        "position": {
          "x": 480,
          "y": 6845
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "75":
    id: "75"
    taskid: 55932705-af3d-4276-8571-7ab48acb7a15
    type: condition
    task:
      id: 55932705-af3d-4276-8571-7ab48acb7a15
      version: -1
      name: Check for error
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "34"
      "yes":
      - "76"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: ${Error}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": 7370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "76":
    id: "76"
    taskid: 9fde7d12-eeb2-4e60-86d1-2306e814d8ad
    type: condition
    task:
      id: 9fde7d12-eeb2-4e60-86d1-2306e814d8ad
      version: -1
      name: Check if error is API-RATE
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "35"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: ${Error}
            iscontext: true
          right:
            value:
              simple: No content received. Possible API rate limit reached.
    view: |-
      {
        "position": {
          "x": 480,
          "y": 7545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "77":
    id: "77"
    taskid: f527209a-dc59-41b6-84e5-d7ee748d434a
    type: condition
    task:
      id: f527209a-dc59-41b6-84e5-d7ee748d434a
      version: -1
      name: Check for error
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "37"
      "yes":
      - "78"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: ${Error}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": 8070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "78":
    id: "78"
    taskid: 0e2680af-342e-4bc2-877b-827021a088ff
    type: condition
    task:
      id: 0e2680af-342e-4bc2-877b-827021a088ff
      version: -1
      name: Check if error is API-RATE
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "38"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: ${Error}
            iscontext: true
          right:
            value:
              simple: No content received. Possible API rate limit reached.
    view: |-
      {
        "position": {
          "x": 480,
          "y": 8245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "79":
    id: "79"
    taskid: 12d59872-d531-4774-8015-4fe7cffd09f8
    type: condition
    task:
      id: 12d59872-d531-4774-8015-4fe7cffd09f8
      version: -1
      name: Check for error
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "15"
      "yes":
      - "80"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: ${Error}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": 8770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "80":
    id: "80"
    taskid: 0f262f79-7f68-4f0b-87d4-0129edd5acff
    type: condition
    task:
      id: 0f262f79-7f68-4f0b-87d4-0129edd5acff
      version: -1
      name: Check if error is API-RATE
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "16"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: ${Error}
            iscontext: true
          right:
            value:
              simple: No content received. Possible API rate limit reached.
    view: |-
      {
        "position": {
          "x": 480,
          "y": 8945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "81":
    id: "81"
    taskid: 58f2fc35-1a89-47c8-83a2-2bbbbfbc392d
    type: condition
    task:
      id: 58f2fc35-1a89-47c8-83a2-2bbbbfbc392d
      version: -1
      name: Check for error
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "43"
      "yes":
      - "82"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: ${Error}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": 9470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "82":
    id: "82"
    taskid: 0cf0ae7e-ea27-46ca-8cbd-34ab26baf003
    type: condition
    task:
      id: 0cf0ae7e-ea27-46ca-8cbd-34ab26baf003
      version: -1
      name: Check if error is API-RATE
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "44"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: ${Error}
            iscontext: true
          right:
            value:
              simple: No content received. Possible API rate limit reached.
    view: |-
      {
        "position": {
          "x": 480,
          "y": 9645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "83":
    id: "83"
    taskid: 7afa9518-ce91-48f3-8f6e-0849642a565d
    type: regular
    task:
      id: 7afa9518-ce91-48f3-8f6e-0849642a565d
      version: -1
      name: ip
      description: Checks the reputation of an IP address.
      script: VirusTotal|||ip
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "84"
    scriptarguments:
      ip:
        simple: 8.8.8.8
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "84":
    id: "84"
    taskid: 6b0a8d55-1740-4fe5-829c-a2d54f987ca8
    type: condition
    task:
      id: 6b0a8d55-1740-4fe5-829c-a2d54f987ca8
      version: -1
      name: Verify no duplicates
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "4"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: IP
                filters:
                - - operator: hasLength
                    left:
                      value:
                        simple: IP.Address
                      iscontext: true
                    right:
                      value:
                        simple: "1"
                accessor: Address
            iscontext: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "85":
    id: "85"
    taskid: d478b0fe-ce84-4313-8fcc-4b20d742ef56
    type: regular
    task:
      id: d478b0fe-ce84-4313-8fcc-4b20d742ef56
      version: -1
      name: Sleep
      description: Sleep for X seconds
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      seconds:
        simple: "61"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "86":
    id: "86"
    taskid: a0712c5b-bbe6-4d6c-86d5-79ff626fb8ee
    type: regular
    task:
      id: a0712c5b-bbe6-4d6c-86d5-79ff626fb8ee
      version: -1
      name: ip_with_CSV
      description: Checks the reputation of an IP address.
      script: VirusTotal|||ip
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "87"
    scriptarguments:
      ip:
        simple: 103.225.52.112,8.8.8.8
    continueonerror: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 10170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "87":
    id: "87"
    taskid: b271e925-e897-451f-8e0f-a4a96951f2aa
    type: condition
    task:
      id: b271e925-e897-451f-8e0f-a4a96951f2aa
      version: -1
      name: verify_ip_csv
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "88"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: IP.Address
            iscontext: true
          right:
            value:
              simple: 8.8.8.8
      - - operator: containsGeneral
          left:
            value:
              simple: IP.Address
            iscontext: true
          right:
            value:
              simple: 103.225.52.112
    view: |-
      {
        "position": {
          "x": 265,
          "y": 10345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "88":
    id: "88"
    taskid: fc261153-a3c7-4ae9-86dd-ca41a291ba5e
    type: regular
    task:
      id: fc261153-a3c7-4ae9-86dd-ca41a291ba5e
      version: -1
      name: url_with_csv
      description: Checks the reputation of a URL.
      script: VirusTotal|||url
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "89"
    scriptarguments:
      url:
        simple: https://demisto.com,https://mail.google.com/mail/u/0/?pli=1#inbox
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 10520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "89":
    id: "89"
    taskid: 73dad18f-31f3-42c4-899e-b5c442b54c65
    type: condition
    task:
      id: 73dad18f-31f3-42c4-899e-b5c442b54c65
      version: -1
      name: verify_url_csv
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "94"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: URL.Data
            iscontext: true
          right:
            value:
              simple: https://demisto.com
      - - operator: containsGeneral
          left:
            value:
              simple: URL.Data
            iscontext: true
          right:
            value:
              simple: https://mail.google.com/mail/u/0/?pli=1#inbox
    view: |-
      {
        "position": {
          "x": 265,
          "y": 10695
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "90":
    id: "90"
    taskid: 75163d93-22a1-4b8e-8b62-8d8f2d432f8c
    type: regular
    task:
      id: 75163d93-22a1-4b8e-8b62-8d8f2d432f8c
      version: -1
      name: domain_with_csv
      description: Checks the reputation of a domain.
      script: VirusTotal|||domain
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "91"
    scriptarguments:
      domain:
        simple: demisto.com,google.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 11045
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "91":
    id: "91"
    taskid: fa7d0175-2d89-45d1-80e0-dffd0bc5688c
    type: condition
    task:
      id: fa7d0175-2d89-45d1-80e0-dffd0bc5688c
      version: -1
      name: verify_domain_csv
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "92"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: Domain.Name
            iscontext: true
          right:
            value:
              simple: demisto.com
      - - operator: containsGeneral
          left:
            value:
              simple: Domain.Name
            iscontext: true
          right:
            value:
              simple: google.com
    view: |-
      {
        "position": {
          "x": 265,
          "y": 11220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "92":
    id: "92"
    taskid: 030644d7-854c-4fe9-8460-4cf8969ffa3b
    type: regular
    task:
      id: 030644d7-854c-4fe9-8460-4cf8969ffa3b
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 11395
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "93":
    id: "93"
    taskid: 6fc84dd0-d838-4d85-88a3-7f30aa4de4e0
    type: regular
    task:
      id: 6fc84dd0-d838-4d85-88a3-7f30aa4de4e0
      version: -1
      name: Sleep
      description: Sleep for X seconds
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "86"
    scriptarguments:
      seconds:
        simple: "61"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 9995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "94":
    id: "94"
    taskid: 85978429-7db6-4b45-8674-af46651a9d90
    type: regular
    task:
      id: 85978429-7db6-4b45-8674-af46651a9d90
      version: -1
      name: Sleep
      description: Sleep for X seconds
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "90"
    scriptarguments:
      seconds:
        simple: "61"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 10870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "95":
    id: "95"
    taskid: 9d4268b6-cfb7-45dc-8b5a-829223b771a1
    type: condition
    task:
      id: 9d4268b6-cfb7-45dc-8b5a-829223b771a1
      version: -1
      name: Reliability Exists?
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      scriptName: Exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "54"
    scriptarguments:
      value:
        simple: DBotScore.[0].Reliability
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 11440,
        "width": 810,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
fromversion: 5.0.0
