commonfields:
  id: SilentPush
  version: -1
  name: SilentPush
  type: python
  subType: python3
  description: Integration with the SilentPush API to fetch domain information and other related data.
  enabled: true
  tags:
    - "SilentPush"
    - "Domain Info"
    - "API"
  comment: "Integration to fetch domain information from SilentPush API"
  
script: 
  type: python
  id: SilentPush
  file: SilentPush.py
  args: []
  isArray: false

commands:
  - name: silentpush-list-domain-information
    description: Fetches domain information including WHOIS data, domain age, and risk scores.
    enabled: true
    hidden: false
    args:
      - isArray: false
        name: domain
        description: The domain to fetch information for (default is silentpush.com).
        isOptional: false
        type: string
    implements:
      - get
    comment: "Fetch domain info, including age, registrar, WHOIS data, and risk scores."
    outputs:
      - contextPath: SilentPush.Domain
        description: "Domain information fetched from SilentPush API."
        type: dict
      - contextPath: SilentPush.Domain.domain
        description: "The domain name."
        type: string
    tags:
      - domain
      - info
      - silentpush
    type: python3
    command: list_domain_information_command
    rawResponse: true

  - name: test-module
    description: Test the connection to the SilentPush API and check API Key validity.
    enabled: true
    hidden: false
    args: []
    implements:
      - test
    outputs:
      - contextPath: SilentPush.Test
        description: "Returns 'ok' if the API connection is successful."
        type: string
    command: test_module
    rawResponse: false

arguments:
  - id: domain
    name: domain
    description: The domain to fetch information for.
    type: string
    isArray: false
    isOptional: false
    default: silentpush.com

integrationContext:
  outputs:
    SilentPush.Domain:
      domain: string
      age: number
      age_score: number
      first_seen: number
      is_new: bool
      is_new_score: number
      last_seen: number
      registrar: string
      whois_age: number
      whois_created_date: string
      zone: string
    SilentPush.Test:
      status: string
