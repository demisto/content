id: Malware Triage - ReversingLabs TitaniumCloud
version: -1
name: Malware Triage - ReversingLabs TitaniumCloud
description: Provides the TitaniumCloud classification of a file hash, and takes remediation
  actions based on that classification.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 01bb6b67-07d0-457f-84c9-4ffeabc2c6c4
    type: start
    task:
      id: 01bb6b67-07d0-457f-84c9-4ffeabc2c6c4
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 440,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 07c255c5-0665-4cfd-8428-72df1211000a
    type: condition
    task:
      id: 07c255c5-0665-4cfd-8428-72df1211000a
      version: -1
      name: Is ReversingLabs TitaniumCloud v2 enabled?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "4"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: modules
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: modules.brand
                      iscontext: true
                    right:
                      value:
                        simple: ReversingLabs TitaniumCloud v2
                - - operator: isEqualString
                    left:
                      value:
                        simple: modules.state
                      iscontext: true
                    right:
                      value:
                        simple: active
                accessor: brand
            iscontext: true
          ignorecase: true
    view: |-
      {
        "position": {
          "x": 440,
          "y": 310
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: bca91921-a4f3-4b2a-8b90-a519ec676464
    type: title
    task:
      id: bca91921-a4f3-4b2a-8b90-a519ec676464
      version: -1
      name: done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -400,
          "y": 3490
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 67ceb5a2-f6c3-4c4b-8139-05366ec448f3
    type: condition
    task:
      id: 67ceb5a2-f6c3-4c4b-8139-05366ec448f3
      version: -1
      name: Is there a file hash to analyze?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "5"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: SHA1
            iscontext: true
    view: |-
      {
        "position": {
          "x": 440,
          "y": 660
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 62328d94-bf1f-4492-8308-4a7eeaaa220f
    type: regular
    task:
      id: 62328d94-bf1f-4492-8308-4a7eeaaa220f
      version: -1
      name: reversinglabs-titaniumcloud-file-reputation
      description: Retrieve File Reputation data from TitaniumCloud
      script: ReversingLabs TitaniumCloud v2|||reversinglabs-titaniumcloud-file-reputation
      type: regular
      iscommand: true
      brand: ReversingLabs TitaniumCloud v2
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      hash:
        simple: ${inputs.hash}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 440,
          "y": 890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: d3e038b5-21ae-4bce-841f-4493cc29cab0
    type: condition
    task:
      id: d3e038b5-21ae-4bce-841f-4493cc29cab0
      version: -1
      name: What is the sample's reputation?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      KNOWN:
      - "20"
      MALICIOUS:
      - "19"
      SUSPICIOUS:
      - "18"
      UNKNOWN:
      - "21"
    separatecontext: false
    conditions:
    - label: MALICIOUS
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "3"
    - label: SUSPICIOUS
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "2"
    - label: KNOWN
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "1"
    - label: UNKNOWN
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "0"
    view: |-
      {
        "position": {
          "x": 440,
          "y": 1050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: bb1e39a2-2a55-4307-85e4-605604886328
    type: regular
    task:
      id: bb1e39a2-2a55-4307-85e4-605604886328
      version: -1
      name: Label for manual inspection
      description: This indicator needs to be manually inspected by a SOC engineer.
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    separatecontext: false
    sla:
      hours: 0
      days: 0
      weeks: 0
    defaultassigneecomplex:
      simple: Analyst
    restrictedcompletion: true
    view: |-
      {
        "position": {
          "x": 440,
          "y": 1480
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: c70b2340-df6b-4abd-8536-f233c69fedbc
    type: regular
    task:
      id: c70b2340-df6b-4abd-8536-f233c69fedbc
      version: -1
      name: 'IncreaseIncidentSeverity: CRITICAL'
      description: Optionally increases the incident severity to the new value if
        it is greater than the existing severity.
      scriptName: IncreaseIncidentSeverity
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      severity:
        simple: Critical
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 440,
          "y": 1295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: d11e1257-835b-49f7-835c-cdc630645fa7
    type: playbook
    task:
      id: d11e1257-835b-49f7-835c-cdc630645fa7
      version: -1
      name: Isolate Endpoint - Generic V2
      description: |-
        This playbook isolates a given endpoint via various endpoint product integrations.
        Make sure to provide the valid playbook input for the integration you are using.
      playbookName: Isolate Endpoint - Generic V2
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      Endpoint_ip:
        simple: ${inputs.Endpoint IP}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 970,
          "y": 1295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 871eacaa-0d5b-4308-8614-3839a44f9562
    type: regular
    task:
      id: 871eacaa-0d5b-4308-8614-3839a44f9562
      version: -1
      name: GetIndicatorDBotScore
      description: Add into the incident's context the system internal DBot score
        for the input indicator.
      scriptName: GetIndicatorDBotScore
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      indicator:
        simple: ${DBotScore.Indicator}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -30,
          "y": 1480
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: 9bd6f9b3-9159-4fc6-8e9a-a3438db4e11a
    type: regular
    task:
      id: 9bd6f9b3-9159-4fc6-8e9a-a3438db4e11a
      version: -1
      name: reversinglabs-titaniumcloud-file-upload
      description: Upload a file using a byte stream with a SHA1 hash of the file
        provided in the request.
      script: ReversingLabs TitaniumCloud v2|||reversinglabs-titaniumcloud-file-upload
      type: regular
      iscommand: true
      brand: ReversingLabs TitaniumCloud v2
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      entryId:
        simple: ${inputs.file}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1510,
          "y": 1240
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 978419a3-0859-49e8-80dd-47490e86b066
    type: regular
    task:
      id: 978419a3-0859-49e8-80dd-47490e86b066
      version: -1
      name: reversinglabs-titaniumcloud-submit-for-dynamic-analysis
      description: Submit an existing sample for dynamic analysis.
      script: ReversingLabs TitaniumCloud v2|||reversinglabs-titaniumcloud-submit-for-dynamic-analysis
      type: regular
      iscommand: true
      brand: ReversingLabs TitaniumCloud v2
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      platform:
        simple: windows10
      sha1:
        simple: ${File.SHA1}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1510,
          "y": 1530
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: 4496f26b-4f0d-45ce-8e48-0a009870b79d
    type: regular
    task:
      id: 4496f26b-4f0d-45ce-8e48-0a009870b79d
      version: -1
      name: reversinglabs-titaniumcloud-get-dynamic-analysis-results
      description: Retrieve dynamic analysis results.
      script: ReversingLabs TitaniumCloud v2|||reversinglabs-titaniumcloud-get-dynamic-analysis-results
      type: regular
      iscommand: true
      brand: ReversingLabs TitaniumCloud v2
    nexttasks:
      '#none#':
      - "24"
    scriptarguments:
      sha1:
        simple: ${File.SHA1}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1510,
          "y": 1810
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: 8079e63d-933f-4a7f-8ef0-68a4e709b5b7
    type: regular
    task:
      id: 8079e63d-933f-4a7f-8ef0-68a4e709b5b7
      version: -1
      name: DynamicAnalysisParseClassification
      description: Parses out and returns the sample classification from the dynamic
        analysis report.
      scriptName: DynamicAnalysisParseClassification
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      dynamic_analysis_results:
        simple: ${ReversingLabs.dynamic_analysis_results}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1510,
          "y": 2030
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "1_3_#default#": 0.15,
      "4_3_#default#": 0.11,
      "4_5_yes": 0.53,
      "6_18_SUSPICIOUS": 0.49,
      "6_19_MALICIOUS": 0.61,
      "6_20_KNOWN": 0.63
    },
    "paper": {
      "dimensions": {
        "height": 3505,
        "width": 2290,
        "x": -400,
        "y": 50
      }
    }
  }
inputs:
- key: hash
  value:
    simple: ${File.SHA1}
  required: false
  description: File hash (sha1, md5 or sha256).
  playbookInputQuery: null
- key: file
  value:
    simple: ${File.EntryID}
  required: false
  description: The file itself.
  playbookInputQuery: null
- key: Endpoint IP
  value:
    simple: ${incident.sourceip}
  required: false
  description: IP address of the endpoint from which the indicator came.
  playbookInputQuery: null
outputs:
- contextPath: File.MD5
  description: Bad hash found
- contextPath: File.SHA1
  description: Bad hash SHA1
- contextPath: File.SHA256
  description: Bad hash SHA256
- contextPath: DBotScore.Score
  description: The actual score.
- contextPath: DBotScore.Type
  description: The indicator type.
- contextPath: DBotScore.Indicator
  description: The indicator that was tested.
- contextPath: DBotScore.Vendor
  description: The vendor used to calculate the score.
- contextPath: ReversingLabs.file_reputation
  description: Report in JSON.
fromversion: 6.0.0