id: Suspicious Domain Hunting Incident Handling
version: -1
contentitemexportablefields:
  contentitemfields: {}
name: Suspicious Domain Hunting Incident Handling
description: This playbook process "Suspicious Domain Hunting" incidents generated by the CertStream integration.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: c9f8948a-9548-4916-8ebf-6af09b4cac0f
    type: start
    task:
      id: c9f8948a-9548-4916-8ebf-6af09b4cac0f
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "1"
      - "16"
      - "29"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 817.5,
          "y": -890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 41b5ecc9-6aec-42f6-890e-865765846969
    type: regular
    task:
      id: 41b5ecc9-6aec-42f6-890e-865765846969
      version: -1
      name: Check Reputation on the Domain
      description: Checks the reputation of a domain in AutoFocus.
      script: '|||domain'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      domain:
        complex:
          root: incident
          accessor: domain
          transformers:
          - operator: uniq
      extended_data:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1260,
          "y": -750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: 2930c60f-9769-489f-853d-0173805209ce
    type: regular
    task:
      id: 2930c60f-9769-489f-853d-0173805209ce
      version: -1
      name: Rasterize Suspicious Webpage
      description: Converts the contents of a URL to an image file or a PDF file.
      tags:
      - Domain_rasterize
      script: '|||rasterize'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#error#':
      - "24"
      '#none#':
      - "26"
    scriptarguments:
      file_name:
        simple: suspicious
      url:
        complex:
          root: incident
          accessor: domain
          transformers:
          - operator: uniq
    separatecontext: false
    continueonerror: true
    continueonerrortype: errorPath
    view: |-
      {
        "position": {
          "x": 647.5,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 90a5150b-8d5a-4765-81b3-895f7b0d37e8
    type: condition
    task:
      id: 90a5150b-8d5a-4765-81b3-895f7b0d37e8
      version: -1
      name: Check if a malicious Domain was identified
      description: ""
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "24"
      "yes":
      - "33"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain(val.Malicious).Name
            iscontext: true
          right:
            value: {}
        - operator: greaterThanOrEqual
          left:
            value:
              simple: HTMLSimilarity.SimilarityPercentage
            iscontext: true
          right:
            value:
              complex:
                root: inputs.similarityThreshold
            iscontext: true
        - operator: greaterThanOrEqual
          left:
            value:
              simple: ImageSimilarity.SSIM
            iscontext: true
          right:
            value:
              complex:
                root: inputs.similarityThreshold
            iscontext: true
        - operator: lessThanOrEqual
          left:
            value:
              simple: ImageSimilarity.MSE
            iscontext: true
          right:
            value:
              complex:
                root: inputs.similarityThreshold
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 817.5,
          "y": 595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 7a94759c-7a6e-4e4f-8380-58884676f8d1
    type: title
    task:
      id: 7a94759c-7a6e-4e4f-8380-58884676f8d1
      version: -1
      name: Handle True Positive
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "5"
      - "7"
      - "18"
      - "19"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 817.5,
          "y": 1300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 86422c26-0d86-4c60-8658-8267719314de
    type: playbook
    task:
      id: 86422c26-0d86-4c60-8658-8267719314de
      version: -1
      name: Block Domain - Generic v2
      playbookName: Block Domain - Generic v2
      type: playbook
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      Domain:
        simple: ${Domain(val.Malicious).Name}
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 1260,
          "y": 1445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: 2d320a3e-3b50-43cf-8282-d7a197f6e902
    type: playbook
    task:
      id: 2d320a3e-3b50-43cf-8282-d7a197f6e902
      version: -1
      name: Threat Hunting - Generic
      playbookName: Threat Hunting - Generic
      type: playbook
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      QRadarTimeFrame:
        simple: LAST 7 DAYS
      SplunkEarliestTime:
        simple: -7d@d
      SplunkLatestTime:
        simple: now
      URLDomain:
        complex:
          root: Domain(val.Malicious)
          accessor: Name
          transformers:
          - operator: uniq
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 817.5,
          "y": 1445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: e838a52f-5fc3-42e1-8101-910c81b6858f
    type: title
    task:
      id: e838a52f-5fc3-42e1-8101-910c81b6858f
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 817.5,
          "y": 1615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 549b11a6-9255-467e-87dc-35f6e425f76c
    type: regular
    task:
      id: 549b11a6-9255-467e-87dc-35f6e425f76c
      version: -1
      name: Get the suspicious HTMLcontent
      description: Sends a HTTP request with advanced capabilities
      scriptName: HttpV2
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#error#':
      - "24"
      '#none#':
      - "35"
    scriptarguments:
      headers:
        keyvalue:
        - key: User-Agent
          value:
            simple: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_3) AppleWebKit/537.36
              (KHTML, like Gecko) Chrome/35.0.1916.47 Safari/537.36
      method:
        simple: GET
      url:
        complex:
          root: incident
          accessor: domain
          transformers:
          - operator: uniq
          - operator: concat
            args:
              prefix:
                value:
                  simple: https://
              suffix: {}
    separatecontext: false
    continueonerror: true
    continueonerrortype: errorPath
    view: |-
      {
        "position": {
          "x": 1060,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: 277a5834-296c-4406-83b4-1008edc1705a
    type: regular
    task:
      id: 277a5834-296c-4406-83b4-1008edc1705a
      version: -1
      name: Check the Reputation of the URL
      description: Submits a URL to scan.
      script: '|||url'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      extended_data:
        simple: "true"
      url:
        complex:
          root: incident
          accessor: domain
          transformers:
          - operator: uniq
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 382.5,
          "y": -750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: 1924f002-483e-4fed-8e3d-7ef3d4886b00
    type: regular
    task:
      id: 1924f002-483e-4fed-8e3d-7ef3d4886b00
      version: -1
      name: Set the certificate's verdict to malicious
      description: commands.local.cmd.set.indicators
      script: Builtin|||setIndicators
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      indicatorsValues:
        complex:
          root: incident
          accessor: certificateindex
      verdict:
        simple: Malicious
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 407.5,
          "y": 1445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: 1627aa77-029a-4b16-8dd0-6de7f8a6b016
    type: regular
    task:
      id: 1627aa77-029a-4b16-8dd0-6de7f8a6b016
      version: -1
      name: Set the Domain's verdict to malicious
      description: commands.local.cmd.set.indicators
      script: Builtin|||setIndicators
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      indicatorsValues:
        complex:
          root: Domain.Name
          filters:
          - - operator: in
              left:
                value:
                  simple: Domain.Name
                iscontext: true
              right:
                value:
                  simple: incident.domain
                iscontext: true
              ignorecase: true
          transformers:
          - operator: uniq
      verdict:
        simple: Malicious
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2.5,
          "y": 1445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 7d7af0d3-0ef4-4be8-8644-a7a6a891803f
    type: regular
    task:
      id: 7d7af0d3-0ef4-4be8-8644-a7a6a891803f
      version: -1
      name: Get original HTML content
      description: Sends a HTTP request with advanced capabilities
      scriptName: HttpV2
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "35"
    scriptarguments:
      method:
        simple: GET
      url:
        complex:
          root: incident
          accessor: certstreamuserasset
          transformers:
          - operator: uniq
          - operator: concat
            args:
              prefix:
                value:
                  simple: https://
              suffix: {}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1507.5,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: a3c2bf41-8324-4ded-8a65-68c85b58f266
    type: regular
    task:
      id: a3c2bf41-8324-4ded-8a65-68c85b58f266
      version: -1
      name: Calculate Diff of Website Content
      description: Diff of original and suspicious website html content, result value is a percentage of similarity.
      scriptName: HtmlDifflibCheck
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "38"
    scriptarguments:
      html1:
        complex:
          root: HttpRequest.Response.[0]
          accessor: Body
      html2:
        complex:
          root: HttpRequest.Response.[1]
          accessor: Body
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1280,
          "y": 275
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 1e921e00-8c71-455c-8a25-6b18d3371eb9
    type: regular
    task:
      id: 1e921e00-8c71-455c-8a25-6b18d3371eb9
      version: -1
      name: Whois - Domain
      description: Provides data enrichment for domains using free resources. Availability of those services may be limited.
      script: '|||whois'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      ignore-outputs:
        simple: "false"
      query:
        complex:
          root: incident
          accessor: domain
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 817.5,
          "y": -570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    fieldMapping:
    - incidentfield: Domain Creation Date
      output:
        complex:
          root: Domain.Whois
          accessor: CreationDate
    - incidentfield: Domain Updated Date
      output:
        complex:
          root: Domain.Whois
          accessor: UpdatedDate
    - incidentfield: Domain Expiration Date
      output:
        complex:
          root: Domain.Whois
          accessor: ExpirationDate
    - incidentfield: Registration Email
      output:
        complex:
          root: Domain.Whois.Registrant.email
          filters:
          - - operator: containsGeneral
              left:
                value:
                  simple: Domain.Whois.Registrant.email
                iscontext: true
              right:
                value:
                  simple: '@'
    - incidentfield: Domain Registrar
      output:
        complex:
          root: Domain.Whois.Registrar
          accessor: Name
    - incidentfield: Domain Name
      output:
        complex:
          root: incident
          accessor: domain
    - incidentfield: Domain Registrar Abuse Email
      output:
        complex:
          root: Domain.Whois.Registrar.AbuseEmail
          filters:
          - - operator: containsGeneral
              left:
                value:
                  simple: Domain.Whois.Registrar.AbuseEmail
                iscontext: true
              right:
                value:
                  simple: '@'
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: d6c18512-2c6e-4024-8b31-cfe6a4e246cc
    type: condition
    task:
      id: d6c18512-2c6e-4024-8b31-cfe6a4e246cc
      version: -1
      name: Analyst desicion
      description: ""
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      Benign:
      - "30"
      'Malicious ':
      - "33"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1260,
          "y": 815
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to:
        simple: Analyst
      subject:
        simple: Malicious Domain was identified during the additional checks?
      body:
        simple: Malicious Domain was identified during the additional checks?
      methods: []
      format: ""
      bcc:
      cc:
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
        completeafterv2: true
        completeaftersla: false
      replyOptions:
      - 'Malicious '
      - Benign
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "25":
    id: "25"
    taskid: 3ba6b1df-7f30-4587-86fb-1cc29d51888a
    type: regular
    task:
      id: 3ba6b1df-7f30-4587-86fb-1cc29d51888a
      version: -1
      name: Close this Investigation as Benign
      description: commands.local.cmd.close.inv
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      closeNotes:
        simple: This alert was handled as a false positive
      closeReason:
        simple: Benign
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1700,
          "y": 1445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: 81c8ccdf-a192-4d6b-8aa3-10db1a6a1d3e
    type: regular
    task:
      id: 81c8ccdf-a192-4d6b-8aa3-10db1a6a1d3e
      version: -1
      name: Compare Images
      description: |-
        Comparing original and suspicious website image similarity using MSE and SSIM.
        MSE - positive value, value of 0 for MSE indicates perfect similarity.
        SSIM - SSIM index is a decimal value between -1 and 1, where 1 indicates perfect similarity, 0 indicates no similarity, and -1 indicates perfect anti-correlation
      scriptName: imagecompare
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "38"
    scriptarguments:
      org_image:
        complex:
          root: InfoFile
          filters:
          - - operator: containsGeneral
              left:
                value:
                  simple: InfoFile.Name
                iscontext: true
              right:
                value:
                  simple: original
              ignorecase: true
          accessor: EntryID
      sec_image:
        complex:
          root: InfoFile
          filters:
          - - operator: containsGeneral
              left:
                value:
                  simple: InfoFile.Name
                iscontext: true
              right:
                value:
                  simple: suspicious
              ignorecase: true
          accessor: EntryID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 420,
          "y": 75
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: 3407b952-8d1e-420d-848b-41ec29fa29f1
    type: title
    task:
      id: 3407b952-8d1e-420d-848b-41ec29fa29f1
      version: -1
      name: Analysis
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "36"
      - "37"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 817.5,
          "y": -390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: 03987393-00ff-422c-820e-bd371bea37e1
    type: regular
    task:
      id: 03987393-00ff-422c-820e-bd371bea37e1
      version: -1
      name: Rasterize Original Webpage
      description: Converts the contents of a URL to an image file or a PDF file.
      tags:
      - Domain_rasterize
      script: '|||rasterize'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "26"
    scriptarguments:
      file_name:
        simple: original
      url:
        complex:
          root: incident
          accessor: certstreamuserasset
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 202.5,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: 27d16b99-15ce-4f93-84e9-f77f6afc1b84
    type: condition
    task:
      id: 27d16b99-15ce-4f93-84e9-f77f6afc1b84
      version: -1
      name: Is whois Integration Available?
      description: Returns 'yes' if integration brand is available. Otherwise returns 'no'
      scriptName: IsIntegrationAvailable
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "27"
      "yes":
      - "22"
    scriptarguments:
      brandname:
        simple: Whois
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 817.5,
          "y": -750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: fbe4aed7-5138-496a-83eb-6ecca2b96dd5
    type: title
    task:
      id: fbe4aed7-5138-496a-83eb-6ecca2b96dd5
      version: -1
      name: Benign
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "31"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1700,
          "y": 985
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: f1ab5ead-ecb2-4b5a-8ecc-13a25e550ddd
    type: regular
    task:
      id: f1ab5ead-ecb2-4b5a-8ecc-13a25e550ddd
      version: -1
      name: Set closing reason as Benign
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      key:
        simple: Verdict
      value:
        simple: Benign
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1700,
          "y": 1130
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: d742cb0e-8c78-4f77-8531-d83817f3b394
    type: regular
    task:
      id: d742cb0e-8c78-4f77-8531-d83817f3b394
      version: -1
      name: Set Verdict to Context
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      key:
        simple: Verdict
      value:
        simple: Malicious
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 817.5,
          "y": 1130
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: e87bc2bc-bd19-491b-8a00-6f5ee92ffee4
    type: title
    task:
      id: e87bc2bc-bd19-491b-8a00-6f5ee92ffee4
      version: -1
      name: Malicious
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "32"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 817.5,
          "y": 985
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: cb46f2b3-51bb-472e-8bb1-f2491c169d74
    type: regular
    task:
      id: cb46f2b3-51bb-472e-8bb1-f2491c169d74
      version: -1
      name: Expire certificate indicator
      description: commands.server.cmd.expireIndicators
      script: Builtin|||expireIndicators
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "25"
    scriptarguments:
      indicatorsValues:
        complex:
          root: incident
          accessor: certstreamfingerprint
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1700,
          "y": 1285
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: 04159b02-a1f5-4e27-8bc0-75ff2746aa48
    type: condition
    task:
      id: 04159b02-a1f5-4e27-8bc0-75ff2746aa48
      version: -1
      name: Does the http request body exist?
      description: ""
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "38"
      "yes":
      - "21"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: HttpRequest.Response.[0]
                accessor: Body
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: HttpRequest.Response.[1]
                accessor: Body
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1280,
          "y": 75
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: d52d8f6d-04f1-4f81-8fc1-8f79c5f949be
    type: title
    task:
      id: d52d8f6d-04f1-4f81-8fc1-8f79c5f949be
      version: -1
      name: Rasterize & Compare Webpage Image
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "2"
      - "28"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 420,
          "y": -240
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: 55ede868-39e3-453a-82f8-55ea2fe9c2bc
    type: title
    task:
      id: 55ede868-39e3-453a-82f8-55ea2fe9c2bc
      version: -1
      name: Compare HTML Content using Diff
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "14"
      - "20"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1280,
          "y": -240
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: 84dd5b76-badb-4d8c-8354-f446abbf9089
    type: title
    task:
      id: 84dd5b76-badb-4d8c-8354-f446abbf9089
      version: -1
      name: Verdict
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "3"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 817.5,
          "y": 450
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
system: true
view: |-
  {
    "linkLabelsPosition": {
      "14_24_#error#": 0.12,
      "24_30_Benign": 0.49,
      "29_22_yes": 0.44,
      "2_24_#error#": 0.24,
      "35_21_yes": 0.55
    },
    "paper": {
      "dimensions": {
        "height": 2570,
        "width": 2077.5,
        "x": 2.5,
        "y": -890
      }
    }
  }
inputs:
- key: similarityThreshold
  value:
    simple: "0.5"
  required: false
  description: The minimum threshold value for similarity comparison
  playbookInputQuery:
outputs: []
tests:
- No tests (auto formatted)
fromversion: 6.10.0
