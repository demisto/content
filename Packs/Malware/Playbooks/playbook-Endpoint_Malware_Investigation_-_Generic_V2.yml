id: Endpoint Malware Investigation - Generic V2
version: -1
contentitemexportablefields:
  contentitemfields: {}
name: Endpoint Malware Investigation - Generic V2
description: "This playbook provides a framework for handling malware investigation\
  \ through all essential steps. The playbook consists of 7 stages. Each stage\
  \ contains the relevant playbook or tasks. \nThis playbook auto extracts indicators\
  \ from incidents using indicator extraction rules of the malware incident type.\nTo\
  \ use Illusive integration in the `Forensics - Generic` playbook, \
  \ note that you will be able to set the forensic timeline by editing the `Forensics - Generic`\
  \ playbook inputs.  \n    "
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 485b00ff-6655-4a20-8fd6-f40ce5b43d80
    type: start
    task:
      id: 485b00ff-6655-4a20-8fd6-f40ce5b43d80
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "113"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 540,
          "y": -3500
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "5":
    id: "5"
    taskid: f8f052e5-1335-4cf0-8ad1-24fb809b3d63
    type: title
    task:
      id: f8f052e5-1335-4cf0-8ad1-24fb809b3d63
      version: -1
      name: Detonation
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "67"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 820,
          "y": -1100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "6":
    id: "6"
    taskid: a92117d3-1ccf-4dc8-833a-01ac2d172cad
    type: title
    task:
      id: a92117d3-1ccf-4dc8-833a-01ac2d172cad
      version: -1
      name: File enrichment
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "27"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 250,
          "y": -1100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "12":
    id: "12"
    taskid: 89dabb98-4cdf-4ea6-87e4-cf5e4c935911
    type: title
    task:
      id: 89dabb98-4cdf-4ea6-87e4-cf5e4c935911
      version: -1
      name: Hunting
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "68"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 130,
          "y": 2755
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "15":
    id: "15"
    taskid: 8bc813e6-4731-4348-8a93-9ab9de5b28f1
    type: title
    task:
      id: 8bc813e6-4731-4348-8a93-9ab9de5b28f1
      version: -1
      name: Remediation
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "19"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 150,
          "y": 5890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "19":
    id: "19"
    taskid: e85c9761-257f-4461-88f7-c094e476abd7
    type: condition
    task:
      id: e85c9761-257f-4461-88f7-c094e476abd7
      version: -1
      name: Manual - Get analyst approval for auto-remediation
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      "No":
      - "41"
      "Yes":
      - "115"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 150,
          "y": 6060
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "20":
    id: "20"
    taskid: 7d6c7837-c713-4066-839c-4766a2c9f299
    type: regular
    task:
      id: 7d6c7837-c713-4066-839c-4766a2c9f299
      version: -1
      name: Analyst review of the investigation
      type: regular
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "31"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 170,
          "y": 6400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "21":
    id: "21"
    taskid: 72f2ca46-f3c7-48d2-87f2-f9c9989806bb
    type: regular
    task:
      id: 72f2ca46-f3c7-48d2-87f2-f9c9989806bb
      version: -1
      name: Manual - Unisolate endpoints
      description: Unisolate endpoints that were isolated during the investigation
        after remediation.
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "59"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -70,
          "y": 7030
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "27":
    id: "27"
    taskid: 3b6fd717-6d50-4b4a-8edf-99b5e1645a4e
    type: playbook
    task:
      id: 3b6fd717-6d50-4b4a-8edf-99b5e1645a4e
      version: -1
      name: File Enrichment - Generic v2
      description: |-
        Enrich a file with threat information using one or more integrations.
      playbookName: File Enrichment - Generic v2
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "100"
    scriptarguments:
      MD5:
        complex:
          root: inputs.MD5
          transformers:
          - operator: uniq
      SHA1:
        complex:
          root: inputs.SHA1
          transformers:
          - operator: uniq
      SHA256:
        complex:
          root: inputs.SHA256
          transformers:
          - operator: uniq
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 250,
          "y": -975
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "28":
    id: "28"
    taskid: c4023b53-3e72-476e-8b5a-6ea3ad6347a3
    type: playbook
    task:
      id: c4023b53-3e72-476e-8b5a-6ea3ad6347a3
      version: -1
      name: Detonate File - Generic
      description: Detonate file through active integrations that support file detonation.
      playbookName: Detonate File - Generic
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "100"
    scriptarguments:
      EntryID:
        complex:
          root: File
          accessor: EntryID
      File:
        complex:
          root: File
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 820,
          "y": -110
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "31":
    id: "31"
    taskid: 1835892b-d79b-4b3e-83a2-bfc5484db8c6
    type: regular
    task:
      id: 1835892b-d79b-4b3e-83a2-bfc5484db8c6
      version: -1
      name: Generate Investigation Summary Report
      description: |-
        A script to generate an automated investigation summary report.
        Can be used in the post-processing flow as well.
      tags:
      - Investigation-Report
      scriptName: GenerateInvestigationSummaryReport
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "99"
    scriptarguments:
      incidentId:
        complex:
          root: incident
          accessor: id
      name: {}
      type: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 170,
          "y": 6560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "36":
    id: "36"
    taskid: b7217208-e1a2-408d-8aee-9513ced4fe4b
    type: condition
    task:
      id: b7217208-e1a2-408d-8aee-9513ced4fe4b
      version: -1
      name: Was a file retrieved?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "37"
      "yes":
      - "123"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: File
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: EntryID
            iscontext: true
    view: |-
      {
        "position": {
          "x": 820,
          "y": -800
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "37":
    id: "37"
    taskid: 0e2a9053-3524-4d1c-84ae-9740ce6253ca
    type: regular
    task:
      id: 0e2a9053-3524-4d1c-84ae-9740ce6253ca
      version: -1
      name: Retrieve file manually
      type: regular
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "123"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1080,
          "y": -620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "38":
    id: "38"
    taskid: 563f2a69-ede9-4377-8c1b-670ab7606f67
    type: regular
    task:
      id: 563f2a69-ede9-4377-8c1b-670ab7606f67
      version: -1
      name: Manual - Hunt for other infected endpoints
      description: Manually hunt for other infected endpoints.
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "39"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 0,
          "y": 4030
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "39":
    id: "39"
    taskid: 3b260fd6-e710-46fd-8c0d-d1bb43f42034
    type: condition
    task:
      id: 3b260fd6-e710-46fd-8c0d-d1bb43f42034
      version: -1
      name: Were there any more infected endpoints found?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      "No":
      - "103"
      "Yes":
      - "77"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 0,
          "y": 4190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "41":
    id: "41"
    taskid: 288d8749-0469-4dfc-8716-9f2525c77704
    type: regular
    task:
      id: 288d8749-0469-4dfc-8716-9f2525c77704
      version: -1
      name: Analyst manual remediation
      type: regular
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "20"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 430,
          "y": 6230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "44":
    id: "44"
    taskid: c3ffcd70-6430-4587-83c4-829071816ab0
    type: regular
    task:
      id: c3ffcd70-6430-4587-83c4-829071816ab0
      version: -1
      name: Perform manual malware analysis and forensics
      type: regular
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "71"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 130,
          "y": 2250
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "45":
    id: "45"
    taskid: 21220e7b-dcd9-453c-8760-ec6ad2609160
    type: title
    task:
      id: 21220e7b-dcd9-453c-8760-ec6ad2609160
      version: -1
      name: False Positive
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "74"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -920,
          "y": 1620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "46":
    id: "46"
    taskid: d542dd80-062d-4e32-8d87-221cc6793aba
    type: condition
    task:
      id: d542dd80-062d-4e32-8d87-221cc6793aba
      version: -1
      name: Get analyst approval for local containment
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      "No":
      - "98"
      "Yes":
      - "95"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 130,
          "y": 1590
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "50":
    id: "50"
    taskid: 8cef4a7e-9abd-4e7a-8747-950ff1363fdd
    type: condition
    task:
      id: 8cef4a7e-9abd-4e7a-8747-950ff1363fdd
      version: -1
      name: Auto-Isolation?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "46"
      "yes":
      - "95"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: inputs.AutoIsolation
                filters:
                - - operator: lessThanOrEqual
                    left:
                      value:
                        simple: inputs.AutoIsolation
                      iscontext: true
                    right:
                      value:
                        simple: incident.severity
                      iscontext: true
            iscontext: true
    view: |-
      {
        "position": {
          "x": 460,
          "y": 1375
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "51":
    id: "51"
    taskid: 1c9be3c2-d4ee-49d0-8d34-97407fb0fbdd
    type: condition
    task:
      id: 1c9be3c2-d4ee-49d0-8d34-97407fb0fbdd
      version: -1
      name: Continue with the investigation or close as false positive?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      'Continue Investigation':
      - "50"
      False positive:
      - "45"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 460,
          "y": 1080
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "52":
    id: "52"
    taskid: b30ca805-ba77-423c-83e5-fde1a463ab57
    type: playbook
    task:
      id: b30ca805-ba77-423c-83e5-fde1a463ab57
      version: -1
      name: Calculate Severity - Generic v2
      description: |-
        Calculate and assign the incident severity based on the highest returned severity level from the following calculations:

        - DBotScores of indicators
        - Critical assets
        - Email authenticity
        - Current incident severity
      playbookName: Calculate Severity - Generic v2
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "73"
    scriptarguments:
      Account:
        complex:
          root: Account
          transformers:
          - operator: uniq
      CriticalEndpoints:
        complex:
          root: inputs.CriticalEndpoints
          transformers:
          - operator: uniq
      CriticalGroups:
        complex:
          root: inputs.CriticalGroups
          transformers:
          - operator: uniq
      CriticalUsers:
        complex:
          root: inputs.CriticalUsers
          transformers:
          - operator: uniq
      DBotScore:
        complex:
          root: DBotScore
      EmailAuthenticityCheck:
        complex:
          root: Email
          accessor: AuthenticityCheck
          transformers:
          - operator: uniq
      Endpoint:
        complex:
          root: incident
          accessor: Hostname
          transformers:
          - operator: uniq
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 460,
          "y": 540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "55":
    id: "55"
    taskid: fd751354-1d35-44ad-81dd-2ec7ac0b4cdf
    type: regular
    task:
      id: fd751354-1d35-44ad-81dd-2ec7ac0b4cdf
      version: -1
      name: Notify that more infected endpoints were found
      description: Send an email
      script: '|||send-mail'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "66"
    scriptarguments:
      additionalHeader: {}
      attachCIDs: {}
      attachIDs: {}
      attachNames: {}
      bcc: {}
      body:
        simple: |-
          During an endpoint malware investigation in Cortex XSOAR, other infected endpoints were found, which can possibly indicate the malware is spreading in your organization and requires your attention.
          To get more information, go to this incident in Cortex XSOAR: ${incident.id}
      cc: {}
      htmlBody: {}
      replyTo: {}
      subject:
        simple: Potential malware spreading in your organization
      templateParams: {}
      to:
        complex:
          root: inputs.Email
      transientFile: {}
      transientFileCID: {}
      transientFileContent: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 790,
          "y": 4890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "56":
    id: "56"
    taskid: fb27ac98-1e3e-4ce6-8c4d-d6d7cb9a5b12
    type: condition
    task:
      id: fb27ac98-1e3e-4ce6-8c4d-d6d7cb9a5b12
      version: -1
      name: Send notification regarding infected endpoints?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "66"
      "yes":
      - "55"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: inputs.Email
            iscontext: true
    view: |-
      {
        "position": {
          "x": 460,
          "y": 4710
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "57":
    id: "57"
    taskid: af45ad3a-c7df-46a6-8b71-eb7c691a9a94
    type: title
    task:
      id: af45ad3a-c7df-46a6-8b71-eb7c691a9a94
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -920,
          "y": 7830
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "58":
    id: "58"
    taskid: d9744de4-ba1e-4e5c-8aca-41b154eaffee
    type: regular
    task:
      id: d9744de4-ba1e-4e5c-8aca-41b154eaffee
      version: -1
      name: Close Investigation
      description: commands.local.cmd.close.inv
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "57"
    scriptarguments:
      assetid: {}
      closeNotes: {}
      closeReason:
        simple: ${Closing reason.Answers.0}
      emailclassification: {}
      id:
        complex:
          root: incident
          accessor: id
      mndadone: {}
      phishingconfirmationstatus: {}
      phishingsubtype: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -490,
          "y": 7610
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "59":
    id: "59"
    taskid: a82031e5-2b56-4734-815a-4ec30ac09b52
    type: regular
    task:
      id: a82031e5-2b56-4734-815a-4ec30ac09b52
      version: -1
      name: Manual - Close incident in the source product
      description: Close the incident in the source product that triggered it.
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "121"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -490,
          "y": 7280
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "61":
    id: "61"
    taskid: 4e2224f0-7a53-40b6-8d37-85a36e2929a5
    type: regular
    task:
      id: 4e2224f0-7a53-40b6-8d37-85a36e2929a5
      version: -1
      name: Set incident - Isolated field
      description: Change the properties of an incident
      script: Builtin|||setIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "98"
    scriptarguments:
      isolated:
        simple: Endpoint was isolated successfully.
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 460,
          "y": 1940
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "66":
    id: "66"
    taskid: 5ced3ed5-4b18-4424-8392-48fa126a1fea
    type: title
    task:
      id: 5ced3ed5-4b18-4424-8392-48fa126a1fea
      version: -1
      name: Isolate infected endpoints
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "124"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 460,
          "y": 5060
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "67":
    id: "67"
    taskid: 2e3c829f-93e0-4c9e-8fb3-747380c0a661
    type: playbook
    task:
      id: 2e3c829f-93e0-4c9e-8fb3-747380c0a661
      version: -1
      name: Retrieve File from Endpoint - Generic V2
      description: |-
        'This playbook retrieves a file sample from an endpoint using the following playbooks:'
        - Get File Sample From Path - Generic v2.
        - Get File Sample By Hash - Generic v3.
      playbookName: Retrieve File from Endpoint - Generic V2
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      Agent_ID:
        simple: ${Endpoint.ID}
      Hostname:
        simple: ${Endpoint.Hostname}
      MD5:
        simple: ${inputs.MD5}
      Path:
        simple: ${inputs.FilePath}
      SHA256:
        simple: ${inputs.SHA256}
      UseD2:
        simple: ${inputs.UseD2}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 820,
          "y": -975
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "68":
    id: "68"
    taskid: 83760aac-4630-466f-811f-c4b02eca45c3
    type: condition
    task:
      id: 83760aac-4630-466f-811f-c4b02eca45c3
      version: -1
      name: Activate automatic hunting
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "38"
      "yes":
      - "69"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: inputs.ActivateAutomaticHunting
            iscontext: true
          right:
            value:
              simple: "Yes"
    view: |-
      {
        "position": {
          "x": 130,
          "y": 2890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "69":
    id: "69"
    taskid: f1fdcc0f-ee49-45ea-8a4e-e82b4a62b7b4
    type: playbook
    task:
      id: f1fdcc0f-ee49-45ea-8a4e-e82b4a62b7b4
      version: -1
      name: 'Threat Hunting - Generic'
      description: "This playbook enables threat hunting for IOCs in\
        \ your enterprise.\nThis playbook currently supports the following integrations:\n\
        - Splunk\n- Qradar\n- Pan-os\n- Cortex data lake \n- Autofocus"
      playbookName: 'Threat Hunting - Generic'
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "101"
    scriptarguments:
      Hostname:
        simple: ${Endpoint.Hostname}
      IPAddress: {}
      InternalDomainName:
        simple: ${inputs.InternalDomainName}
      InternalHostRegex:
        simple: ${inputs.InternalHostRegex}
      InternalRange:
        simple: ${inputs.InternalRange}
      MD5:
        simple: ${inputs.MD5}
      SHA1:
        simple: ${inputs.SHA1}
      SHA256:
        simple: ${inputs.SHA256}
      URLDomain:
        simple: ${inputs.URLDomain}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 460,
          "y": 3070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "70":
    id: "70"
    taskid: d07fef12-0b92-4959-87d3-43648ac57c8e
    type: condition
    task:
      id: d07fef12-0b92-4959-87d3-43648ac57c8e
      version: -1
      name: Continue to manual threat hunting?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "56"
      "yes":
      - "38"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: inputs.ManualThreatHunting
            iscontext: true
          right:
            value:
              simple: "Yes"
    view: |-
      {
        "position": {
          "x": 460,
          "y": 3845
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "71":
    id: "71"
    taskid: 549abbea-da01-4862-827e-685e1fdac35a
    type: condition
    task:
      id: 549abbea-da01-4862-827e-685e1fdac35a
      version: -1
      name: Need more forensics?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "12"
      "yes":
      - "76"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: inputs.NeedMoreForensics
            iscontext: true
          right:
            value:
              simple: "Yes"
    view: |-
      {
        "position": {
          "x": 130,
          "y": 2410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "73":
    id: "73"
    taskid: 07fc2eec-1d8c-4e2f-8f35-3ad5e146e450
    type: regular
    task:
      id: 07fc2eec-1d8c-4e2f-8f35-3ad5e146e450
      version: -1
      name: Assign incident to analyst
      description: |-
        Assign analyst to incident.
        By default, the analyst is picked randomly from the available users, according to the provided roles. (If no roles are provided, will fetch all users).
        Otherwise, the analyst will be picked according to the 'assignBy' arguments.
        machine-learning: DBot will calculate and decide who is the best analyst for the job.
        top-user: The user who most commonly owns this type of incident.
        less-busy-user: The less busy analyst will be picked to be the incident owner.
        online: The analyst is picked randomly from all online analysts, according to the provided roles. (If no roles provided, will fetch all users).
        current: The user who executed the command.
      scriptName: AssignAnalystToIncident
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "97"
    scriptarguments:
      assignBy: {}
      email: {}
      onCall:
        simple: "true"
      roles: {}
      username: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 460,
          "y": 730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "74":
    id: "74"
    taskid: 6b1ed7a5-6962-48b4-8321-fab175608efd
    type: regular
    task:
      id: 6b1ed7a5-6962-48b4-8321-fab175608efd
      version: -1
      name: Whitelist the file that caused the FP in the source product
      type: regular
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "120"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -920,
          "y": 2250
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "76":
    id: "76"
    taskid: 6704e686-910d-4005-8fcd-fc3e2929231b
    type: playbook
    task:
      id: 6704e686-910d-4005-8fcd-fc3e2929231b
      version: -1
      name: 'Get host forensics - Generic'
      description: "This playbook retrieves forensics from hosts.\nThe\
        \ available integration is Illusive networks. "
      playbookName: 'Get host forensics - Generic'
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      end_date: {}
      fqdn_or_ip: {}
      start_date: {}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2580
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "77":
    id: "77"
    taskid: 06fe346a-d3b6-449f-82b5-9ef4f6ca4239
    type: regular
    task:
      id: 06fe346a-d3b6-449f-82b5-9ef4f6ca4239
      version: -1
      name: Manually list detected hostnames
      type: regular
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "78"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 0,
          "y": 4380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "78":
    id: "78"
    taskid: ea42e90d-fec2-4b69-8a13-0077468fb4b3
    type: regular
    task:
      id: ea42e90d-fec2-4b69-8a13-0077468fb4b3
      version: -1
      name: Set manual host names
      description: "Takes the comments of a given entry ID and stores them in the\
        \ incident context, under a provided context key. \nFor accessing the last\
        \ executed task's comments, provide ${lastCompletedTaskEntries.[0]} as the\
        \ value for the entryId input parameter."
      scriptName: commentsToContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "56"
    scriptarguments:
      contextKey:
        simple: Threat.Hunting.Detected.Hostsname
      entryId:
        simple: ${lastCompletedTaskEntries.[0]}
      listSeperator: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 0,
          "y": 4535
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "79":
    id: "79"
    taskid: a7746804-981e-4c05-8774-0c5f875d1c6c
    type: condition
    task:
      id: a7746804-981e-4c05-8774-0c5f875d1c6c
      version: -1
      name: Activated auto unisolation
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "21"
      "yes":
      - "80"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: inputs.AutoUnIsolation
            iscontext: true
          right:
            value:
              simple: "Yes"
    view: |-
      {
        "position": {
          "x": 170,
          "y": 6840
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "80":
    id: "80"
    taskid: b1d58da6-a889-4062-80fc-8e998860df0c
    type: playbook
    task:
      id: b1d58da6-a889-4062-80fc-8e998860df0c
      version: -1
      name: Unisolate Endpoint - Generic
      description: "This playbook unisolates endpoints according to the endpoint ID\
        \ or hostname that is provided in the playbook.\nCurrently supports the following\
        \ integrations:\n- Carbon Black Response\n- Cortex XDR\n- Crowdstrike Falcon\n\
        - FireEye HX \n- Cybereason\n"
      playbookName: Unisolate Endpoint - Generic
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "59"
    scriptarguments:
      Endpoint_ID:
        simple: ${Endpoint.ID}
      Hostname:
        complex:
          root: Endpoint
          accessor: Hostname
          transformers:
          - operator: append
            args:
              item:
                value:
                  simple: Threat.Hunting.Detected.Hostsname
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 410,
          "y": 7020
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "81":
    id: "81"
    taskid: 122048b5-cb07-421b-8b93-0c75fd6a86d4
    type: playbook
    task:
      id: 122048b5-cb07-421b-8b93-0c75fd6a86d4
      version: -1
      name: Get endpoint details - Generic
      description: "This playbook uses the generic command !endpoint to retrieve details\
        \ on specific endpoint.\nThis command currently supports the following integrations:\n\
        - Palo Alto Networks Cortex XDR - Investigation and Response.\n- CrowdStrike\
        \ Falcon. "
      playbookName: Get endpoint details - Generic
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "110"
    scriptarguments:
      Endpoint_hostname:
        simple: ${inputs.Hostname}
      Endpoint_id:
        simple: ${inputs.Agent_ID}
      Endpoint_ip:
        simple: ${inputs.Endpoint_ip}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 540,
          "y": -2050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "94":
    id: "94"
    taskid: 5b366968-6c3f-41da-8f2b-0f36661f6d90
    type: playbook
    task:
      id: 5b366968-6c3f-41da-8f2b-0f36661f6d90
      version: -1
      name: Isolate Endpoint - Generic V2
      description: |-
        This playbook isolates a given endpoint via various endpoint product integrations.
        Make sure to provide the valid playbook input for the integration that you are using.
      playbookName: Isolate Endpoint - Generic V2
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      Endpoint_hostname:
        simple: ${Threat.Hunting.Detected.Hostsname}
      Endpoint_id:
        simple: ${Endpoint.ID}
      Endpoint_ip:
        simple: ${Threat.Hunting.Detected.IP}
      ManualHunting.DetectedHosts:
        simple: ${ManualHunting.DetectedHosts}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 460,
          "y": 5700
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "95":
    id: "95"
    taskid: 2bfa3d6a-ffab-47d5-8cd0-c371ecee2891
    type: playbook
    task:
      id: 2bfa3d6a-ffab-47d5-8cd0-c371ecee2891
      version: -1
      name: Isolate Endpoint - Generic V2
      description: |-
        This playbook isolates a given endpoint via various endpoint product integrations.
        Make sure to provide the valid playbook input for the integration that you are using.
      playbookName: Isolate Endpoint - Generic V2
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "61"
    scriptarguments:
      Endpoint_hostname:
        simple: ${Endpoint.Hostname}
      Endpoint_id:
        simple: ${Endpoint.ID}
      Endpoint_ip:
        simple: ${Endpoint.IPAddress}
      ManualHunting.DetectedHosts: {}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 460,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "97":
    id: "97"
    taskid: 65195858-cda7-49a5-8a03-adce259b700c
    type: title
    task:
      id: 65195858-cda7-49a5-8a03-adce259b700c
      version: -1
      name: Isolation
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "51"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 460,
          "y": 920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "98":
    id: "98"
    taskid: 9f4826e1-bb1e-4281-8f05-bc4cf3c0b544
    type: title
    task:
      id: 9f4826e1-bb1e-4281-8f05-bc4cf3c0b544
      version: -1
      name: Forensics
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "44"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 130,
          "y": 2130
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "99":
    id: "99"
    taskid: a9632b1b-ba2d-4160-85a3-635c6dc030f9
    type: title
    task:
      id: a9632b1b-ba2d-4160-85a3-635c6dc030f9
      version: -1
      name: Unisolation
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "79"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 170,
          "y": 6720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "100":
    id: "100"
    taskid: f6049943-64f7-4ed7-8ecc-1482f2665271
    type: regular
    task:
      id: f6049943-64f7-4ed7-8ecc-1482f2665271
      version: -1
      name: Set user as account
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "52"
    scriptarguments:
      append: {}
      key:
        simple: Account.Username
      stringify: {}
      value:
        complex:
          root: incident
          accessor: user
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 460,
          "y": 350
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "101":
    id: "101"
    taskid: 63bffacd-4fad-4dff-8707-60fb67124a22
    type: regular
    task:
      id: 63bffacd-4fad-4dff-8707-60fb67124a22
      version: -1
      name: Set detected hostnames to context
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "102"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Threat.Hunting.Detected.Hostsname
      stringify: {}
      value:
        complex:
          root: QRadar
          accessor: DetectedInternalHosts
          transformers:
          - operator: append
            args:
              item:
                value:
                  simple: PANWHunting.DetectedInternalHosts
                iscontext: true
          - operator: append
            args:
              item:
                value:
                  simple: Splunk.DetectedInternalHosts
                iscontext: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 460,
          "y": 3250
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    fieldMapping:
    - incidentfield: Hostnames
      output:
        simple: ${Threat.Hunting.Detected.Hostsname}
    skipunavailable: false
    quietmode: 0
  "102":
    id: "102"
    taskid: 19d297a9-8ff3-4252-8a43-2756cf9f44c1
    type: regular
    task:
      id: 19d297a9-8ff3-4252-8a43-2756cf9f44c1
      version: -1
      name: Set detected IP's to context
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "122"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Threat.Hunting.Detected.IP
      stringify: {}
      value:
        complex:
          root: Splunk
          accessor: DetectedInternalIPs
          transformers:
          - operator: append
            args:
              item:
                value:
                  simple: PANWHunting.DetectedInternalIPs
                iscontext: true
          - operator: append
            args:
              item:
                value:
                  simple: QRadar.DetectedInternalIPs
                iscontext: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 460,
          "y": 3430
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    fieldMapping:
    - incidentfield: Detected IPs
      output:
        simple: ${Threat.Hunting.Detected.IP}
    skipunavailable: false
    quietmode: 0
  "103":
    id: "103"
    taskid: c6f1bd08-d81a-4222-860e-cb714022a44b
    type: title
    task:
      id: c6f1bd08-d81a-4222-860e-cb714022a44b
      version: -1
      name: No results for manual TH
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "15"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -210,
          "y": 5050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "104":
    id: "104"
    taskid: 478fa066-5a55-486d-87a7-2d31961b60e2
    type: playbook
    task:
      id: 478fa066-5a55-486d-87a7-2d31961b60e2
      version: -1
      name: Get endpoint details - Generic
      description: "This playbook uses the generic command !endpoint to retrieve details\
        \ on specific endpoint.\nThis command currently supports the following integrations:\n\
        - Palo Alto Networks Cortex XDR - Investigation and Response.\n- CrowdStrike\
        \ Falcon. "
      playbookName: Get endpoint details - Generic
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "94"
    scriptarguments:
      Endpoint_hostname:
        simple: ${Threat.Hunting.Detected.Hostsname}
      Endpoint_id:
        simple: ${EndpointDetails.ID}
      Endpoint_ip:
        simple: ${Threat.Hunting.Detected.IP}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 460,
          "y": 5520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "107":
    id: "107"
    taskid: 09e75f8e-430e-40ab-8de8-cf5ed3645672
    type: regular
    task:
      id: 09e75f8e-430e-40ab-8de8-cf5ed3645672
      version: -1
      name: 'Set endpoint details to layout'
      description: Creates a grid table from items or key-value pairs.
      scriptName: SetGridField
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "5"
      - "6"
    scriptarguments:
      columns:
        simple: Endpoint Hostname,Endpoint ID,Endpoint IP Address,Endpoint Is Isolated,Endpoint
          MAC Address,Endpoint OS,Endpoint Vendor
      context_path:
        simple: Endpoint
      grid_id:
        simple: endpoint
      keys:
        simple: Hostname,ID,IPAddress,IsIsolated,MACAddress,OS,Vendor
      overwrite: {}
      sort_by: {}
      unpack_nested_elements: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 540,
          "y": -1490
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "110":
    id: "110"
    taskid: 3f059079-d592-4c3a-8b4c-98e426a69af4
    type: title
    task:
      id: 3f059079-d592-4c3a-8b4c-98e426a69af4
      version: -1
      name: Set to layout
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "107"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 540,
          "y": -1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "111":
    id: "111"
    taskid: 9d2e3543-d680-4d63-8197-19cfbe21b96f
    type: regular
    task:
      id: 9d2e3543-d680-4d63-8197-19cfbe21b96f
      version: -1
      name: 'Find similar incidents'
      description: Find past similar incidents based on incident fields' similarity.
        Includes an option to also display indicators' similarity.
      scriptName: DBotFindSimilarIncidents
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "116"
    scriptarguments:
      aggreagateIncidentsDifferentDate: {}
      fieldExactMatch:
        simple: incident.type
      fieldsToDisplay: {}
      fromDate: {}
      incidentId: {}
      includeIndicatorsSimilarity: {}
      indicatorsTypes: {}
      limit: {}
      maxIncidentsInIndicatorsForWhiteList: {}
      maxIncidentsToDisplay: {}
      minNumberOfIndicators: {}
      minimunIncidentSimilarity: {}
      query: {}
      showCurrentIncident: {}
      showIncidentSimilarityForAllFields: {}
      similarCategoricalField: {}
      similarJsonField: {}
      similarTextField:
        simple: incident.parentcmdline,incident.filepaths,incident.cmd
      toDate: {}
      useAllFields: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 540,
          "y": -3215
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "112":
    id: "112"
    taskid: 8a1995dc-d825-4883-8165-2761d5ea6e06
    type: regular
    task:
      id: 8a1995dc-d825-4883-8165-2761d5ea6e06
      version: -1
      name: 'Set similar incidents to layout'
      description: Creates a grid table from items or key-value pairs.
      scriptName: SetGridField
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "118"
    scriptarguments:
      columns:
        simple: Incident Id,Created,Name,Similarity Incident,Parent CMD line,File
          path,Command line
      context_path:
        simple: DBotFindSimilarIncidents.similarIncident(val.id='#/Details/'+val.id,val.parentcmdline=val.parentcmdline.join(','),val.filepaths=val.filepaths.join(','),val.cmd=val.cmd.join(','))
      grid_id:
        simple: similarincidentsdbot
      keys:
        simple: id,created,name,similarity incident,parentcmdline,filepaths,cmd
      overwrite: {}
      sort_by: {}
      unpack_nested_elements: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1030,
          "y": -2870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "113":
    id: "113"
    taskid: c4cd9f90-4c84-4dc5-8ea5-721f7e89809d
    type: title
    task:
      id: c4cd9f90-4c84-4dc5-8ea5-721f7e89809d
      version: -1
      name: Find similar incidents
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "111"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 540,
          "y": -3355
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "114":
    id: "114"
    taskid: 0324ff91-6553-42ec-8f3d-e0b790194083
    type: title
    task:
      id: 0324ff91-6553-42ec-8f3d-e0b790194083
      version: -1
      name: Get endpoint details
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "81"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 540,
          "y": -2240
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "115":
    id: "115"
    taskid: 62332f81-4ae9-49b8-8818-eba4057c9ce4
    type: playbook
    task:
      id: 62332f81-4ae9-49b8-8818-eba4057c9ce4
      version: -1
      name: Block Indicators - Generic v2
      description: |+
        This playbook blocks malicious indicators using all integrations that are enabled, using the following sub-playbooks:

        - Block URL - Generic
        - Block Account - Generic
        - Block IP - Generic v2
        - Block File - Generic v2

      playbookName: Block Indicators - Generic v2
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      AutoCommit:
        simple: "No"
      CustomBlockRule:
        simple: "True"
      CustomURLCategory:
        simple: Demisto Remediation - Malicious URLs
      DAG: {}
      EDLServerIP: {}
      EmailToBlock: {}
      IP:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Type
                iscontext: true
              right:
                value:
                  simple: ip
              ignorecase: true
          - - operator: greaterThanOrEqual
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "3"
          accessor: Indicator
          transformers:
          - operator: uniq
      IPBlacklistMiner: {}
      IPListName: {}
      LogForwarding: {}
      MD5:
        complex:
          root: File
          accessor: MD5
      SHA256:
        complex:
          root: File
          accessor: SHA256
      StaticAddressGroup: {}
      URL:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Type
                iscontext: true
              right:
                value:
                  simple: url
              ignorecase: true
          - - operator: greaterThanOrEqual
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "3"
          accessor: Indicator
          transformers:
          - operator: uniq
      URLBlacklistMiner: {}
      URLListName:
        simple: Demisto Remediation - URL EDL
      Username:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Type
                iscontext: true
              right:
                value:
                  simple: username
              ignorecase: true
          - - operator: greaterThanOrEqual
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "3"
          accessor: Indicator
      categories: {}
      device-group: {}
      type: {}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": -90,
          "y": 6230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "116":
    id: "116"
    taskid: 5a85becb-da36-49e7-842b-6abb8d61c9de
    type: condition
    task:
      id: 5a85becb-da36-49e7-842b-6abb8d61c9de
      version: -1
      name: Are there similar incidents?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "114"
      "yes":
      - "112"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotFindSimilarIncidents.similarIncident
            iscontext: true
    view: |-
      {
        "position": {
          "x": 540,
          "y": -3040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "117":
    id: "117"
    taskid: 11e02f7d-a353-40ca-849c-ef049e9a30cc
    type: regular
    task:
      id: 11e02f7d-a353-40ca-849c-ef049e9a30cc
      version: -1
      name: Link similar incidents
      description: commands.local.cmd.linkIncidents
      script: Builtin|||linkIncidents
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "114"
    scriptarguments:
      action: {}
      incidentId:
        complex:
          root: incident
          accessor: id
      linkedIncidentIDs:
        simple: ${DBotFindSimilarIncidents.similarIncident.id}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1030,
          "y": -2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "118":
    id: "118"
    taskid: 4763309c-9837-47ea-81d8-ac173f56340d
    type: condition
    task:
      id: 4763309c-9837-47ea-81d8-ac173f56340d
      version: -1
      name: Link the similar events?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "114"
      "yes":
      - "117"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: inputs.LinkSimilarIncidents
            iscontext: true
          right:
            value:
              simple: "Yes"
    view: |-
      {
        "position": {
          "x": 1030,
          "y": -2700
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "119":
    id: "119"
    taskid: f84ac8ad-8740-452a-81c4-22ea4a65016d
    type: regular
    task:
      id: f84ac8ad-8740-452a-81c4-22ea4a65016d
      version: -1
      name: Close investigation as false positive
      description: commands.local.cmd.close.inv
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "57"
    scriptarguments:
      assetid: {}
      closeNotes: {}
      closeReason:
        simple: False Positive
      emailclassification: {}
      id: {}
      phishingsubtype: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -920,
          "y": 7610
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "120":
    id: "120"
    taskid: ea085a30-12b8-4192-835a-1071bc264e12
    type: regular
    task:
      id: ea085a30-12b8-4192-835a-1071bc264e12
      version: -1
      name: Manual - Close incident in the source product
      description: Close the incident in the source product that triggered it.
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "119"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -920,
          "y": 2410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "121":
    id: "121"
    taskid: 7f0b9ed0-3633-45e3-89cd-9ee6e34492f5
    type: collection
    task:
      id: 7f0b9ed0-3633-45e3-89cd-9ee6e34492f5
      version: -1
      name: Closing reason
      type: collection
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "58"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -490,
          "y": 7450
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to:
      subject:
      body: {}
      methods: []
      format: ""
      bcc:
      cc:
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
    form:
      questions:
      - id: "0"
        label: ""
        labelarg:
          simple: Specify the closing reason
        required: false
        gridcolumns: []
        defaultrows: []
        type: shortText
        options: []
        optionsarg: []
        fieldassociated: ""
        placeholder: ""
        tooltip: ""
        readonly: false
      title: Closing reason
      description: ""
      sender: ""
      expired: false
      totalanswers: 0
    skipunavailable: false
    quietmode: 0
  "122":
    id: "122"
    taskid: 950c2191-c2b2-4331-800c-eb52102b8e07
    type: regular
    task:
      id: 950c2191-c2b2-4331-800c-eb52102b8e07
      version: -1
      name: Set detected users to to context
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "70"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Threat.Hunting.Detected.Users
      stringify: {}
      value:
        complex:
          root: Splunk
          accessor: DetectedUsers
          transformers:
          - operator: append
            args:
              item:
                value:
                  simple: PANWHunting.DetectedUsers
                iscontext: true
          - operator: append
            args:
              item:
                value:
                  simple: QRadar.DetectedUsers
                iscontext: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 460,
          "y": 3630
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    fieldMapping:
    - incidentfield: Detected User
      output:
        simple: ${Threat.Hunting.Detected.Users}
    skipunavailable: false
    quietmode: 0
  "123":
    id: "123"
    taskid: a325a9e7-7492-4dff-8d83-5f03e066010e
    type: condition
    task:
      id: a325a9e7-7492-4dff-8d83-5f03e066010e
      version: -1
      name: 'Activate auto detonation?'
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "100"
      "yes":
      - "28"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: inputs.DetonateFile
            iscontext: true
          right:
            value:
              simple: "Yes"
    view: |-
      {
        "position": {
          "x": 820,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "124":
    id: "124"
    taskid: bab744c7-9f34-4af7-8812-cbbb05405840
    type: condition
    task:
      id: bab744c7-9f34-4af7-8812-cbbb05405840
      version: -1
      name: 'Activate auto isolation after threat hunting?'
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "15"
      "yes":
      - "104"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: inputs.IsolationAfterHunting
            iscontext: true
          right:
            value:
              simple: "Yes"
    view: |-
      {
        "position": {
          "x": 460,
          "y": 5200
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
system: true
view: |-
  {
    "linkLabelsPosition": {
      "116_112_yes": 0.53,
      "116_114_#default#": 0.32,
      "118_114_#default#": 0.83,
      "118_117_yes": 0.68,
      "123_100_#default#": 0.64,
      "123_28_yes": 0.56,
      "124_104_yes": 0.63,
      "19_115_Yes": 0.53,
      "19_41_No": 0.58,
      "36_123_yes": 0.53,
      "36_37_#default#": 0.64,
      "39_77_Yes": 0.49,
      "46_98_No": 0.51,
      "50_46_#default#": 0.66,
      "50_95_yes": 0.49,
      "51_45_False positive": 0.67,
      "51_50_Continue Investigation ": 0.58,
      "56_55_yes": 0.6,
      "56_66_#default#": 0.51,
      "71_12_#default#": 0.51,
      "79_21_#default#": 0.64
    },
    "paper": {
      "dimensions": {
        "height": 11395,
        "width": 2380,
        "x": -920,
        "y": -3500
      }
    }
  }
inputs:
- key: AutoIsolation
  value:
    simple: "3"
  required: false
  description: |-
    This input determines the threshold severity from which to perform auto-isolation for the infected endpoint.
    Specify the severity number (Default is 3 - High):
    Specify the severity number:
    0 - Unknown
    0.5 - Informational
    1 - Low
    2 - Medium
    3 - High
    4 - Critical
  playbookInputQuery:
- key: Email
  value: {}
  required: false
  description: The email address to send a notification if there is a possibility of the malware
    spreading and infecting other endpoints.
  playbookInputQuery:
- key: MD5
  value:
    complex:
      root: incident
      accessor: md5
  required: false
  description: The MD5 hash value for the suspicious file.
  playbookInputQuery:
- key: SHA256
  value:
    complex:
      root: incident
      accessor: sha256
  required: false
  description: The SHA256 hash value for the suspicious file.
  playbookInputQuery:
- key: Hostname
  value:
    complex:
      root: incident
      accessor: hostname
  required: false
  description: Hostname of the machine on which the file is located.
  playbookInputQuery:
- key: FilePath
  value:
    complex:
      root: File
      accessor: Path
  required: false
  description: |-
    The path of the file to retrieve.
    For example:
    C:\users\folder\file.txt
  playbookInputQuery:
- key: UseD2
  value:
    simple: "no"
  required: false
  description: Specifies whether to use a D2 agent to retrieve the file.
  playbookInputQuery:
- key: SHA1
  value:
    complex:
      root: incident
      accessor: sha1
  required: false
  description: The SHA1 hash value for the suspicious file.
  playbookInputQuery:
- key: ActivateAutomaticHunting
  value:
    simple: "no"
  required: false
  description: |
    Activate Threat Hunting - Generic playbook for automatic hunting.
    Yes- to activate.
  playbookInputQuery:
- key: ManualThreatHunting
  value:
    simple: "No"
  required: false
  description: |
    Perform manual threat hunting.
    Yes- to activate.
  playbookInputQuery:
- key: NeedMoreForensics
  value:
    simple: "no"
  required: false
  description: "The value `Yes` will activate the playbook `Forensics\
    \ - Generic` that retrieves additional forensics on the investigating host. \n\
    Yes- to activate,"
  playbookInputQuery:
- key: IPAddress
  value: {}
  required: false
  description: "This input is relevant if the Threat Hunting - Generic playbook\
    \ is activated. \nIf you activated the Threat Hunting - Generic playbook and you are\
    \ hunting IP addresses, provide the IP addresses here.\n"
  playbookInputQuery:
- key: URLDomain
  value: {}
  required: false
  description: "This input is relevant if the Threat Hunting - Generic playbook\
    \ is activated. \nIf you activated Threat Hunting - Generic playbook and you are\
    \ hunting for URLs or domains, provide the URLs or domains here."
  playbookInputQuery:
- key: InternalRange
  value: {}
  required: false
  description: "This input is relevant if the Threat Hunting - Generic playbook\
    \ is activated. \nThe input is a list of internal IP ranges to check IP addresses against.\
    \ The list should be provided in CIDR notation, separated by commas. An example\
    \ of a list of ranges would be: \"172.16.0.0/12,10.0.0.0/8,192.168.0.0/16\" (without\
    \ quotes). If a list is not provided, the playbook will use the default list provided in the IsIPInRanges\
    \ script (the known IPv4 private address ranges)."
  playbookInputQuery:
- key: InternalDomainName
  value: {}
  required: false
  description: "This input is relevant if the Threat Hunting - Generic playbook\
    \ is activated. \nThe input is the organization's internal domain name. This is provided for\
    \ the IsInternalHostName script that checks if the detected host names are internal\
    \ or external if the hosts contain the internal domains suffix. For example, demisto.com.\
    \ If there is more than one domain, use the | character to separate values such\
    \ as (demisto.com|test.com)"
  playbookInputQuery:
- key: InternalHostRegex
  value: {}
  required: false
  description: |-
    This input is relevant if the Threat Hunting - Generic playbook is activated.
    This is provided for the IsInternalHostName script that checks if the detected host names are internal or external if the hosts match the organizations naming convention. For example, the host testpc1 will have the following regex \w{6}\d{1}
  playbookInputQuery:
- key: Agent_ID
  value:
    complex:
      root: incident
      accessor: agentsid
  required: false
  description: 'This input is relevant if retrieving the file by EDR. If so, provide
    the relevant Agent_ID\Endpoint id.'
  playbookInputQuery:
- key: CriticalUsers
  value: {}
  required: false
  description: |-
    This input will be used for the `Calculate Severity - Generic v2` playbook.
    Provide your critical users (CSV is optional).
  playbookInputQuery:
- key: CriticalEndpoints
  value: {}
  required: false
  description: |-
    This input will be uses for the `Calculate Severity - Generic v2` playbook.
    Provide your critical endpoint hostnames (CSV is optional).
  playbookInputQuery:
- key: CriticalGroups
  value: {}
  required: false
  description: |-
    This input will be uses for the `Calculate Severity - Generic v2` playbook.
    Provide the DN names of your critical AD groups (CSV is optional).
  playbookInputQuery:
- key: AutoUnIsolation
  value:
    simple: "no"
  required: false
  description: Providing "Yes" in this playbook input will activated the "Unisolate
    Endpoint - Generic" playbook.
  playbookInputQuery:
- key: Endpoint_ip
  value: {}
  required: false
  description: The IP of the endpoint which is involved in the investigation.
  playbookInputQuery:
- key: LinkSimilarIncidents
  value:
    simple: "no"
  required: false
  description: 'Providing "Yes" in this playbook input will link the incidents
    that were found similar by DBotFindSimilarIncidents.'
  playbookInputQuery:
- key: DetonateFile
  value:
    simple: "no"
  required: false
  description: 'Providing "Yes" to this input will activate the "Detonate File
    - Generic".'
  playbookInputQuery:
- key: IsolationAfterHunting
  value:
    simple: "no"
  required: false
  description: 'Providing "Yes" to this input will activate the "Isolate Endpoint
    Generic V2" after the execution of threat hunting procedures.'
  playbookInputQuery:
outputs: []
tests:
- no tests
fromversion: 6.0.0
