id: Logzio - Test
description: Logz.io Test Playbook
version: -1
name: Logzio - Test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: c12ad47e-9397-483a-8422-2c3e39760f7b
    type: start
    task:
      id: c12ad47e-9397-483a-8422-2c3e39760f7b
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "5"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "3":
    id: "3"
    taskid: 996d8dac-c565-4f05-8d8f-a0f6480fe5fc
    type: regular
    task:
      id: 996d8dac-c565-4f05-8d8f-a0f6480fe5fc
      version: -1
      name: logzio-search-logs
      description: Runs an Apache Lucene query on your Logz.io Operations account
      script: '|||logzio-search-logs'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      from_time: {}
      query:
        simple: '"sentinel_one" OR "sentinel"'
      size: {}
      timeout: {}
      to_time: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 685
        }
      }
    note: false
    evidencedata:
      description:
        simple: 'Query result:'
      customfields: {}
    timertriggers: []
    ignoreworker: false
  "4":
    id: "4"
    taskid: 36f6593e-0004-47d7-85cb-32b141e5376c
    type: regular
    task:
      id: 36f6593e-0004-47d7-85cb-32b141e5376c
      version: -1
      name: logzio-get-logs-by-rule-id
      description: Fetches the logs that triggered a security event in Logz.io Cloud
        SIEM
      script: '|||logzio-get-logs-by-event-id'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      id:
        complex:
          root: LogzioFetchedIn
          accessor: Contents.rawJSON
          transformers:
          - operator: ParseJSON
          - operator: getField
            args:
              field:
                value:
                  simple: alertEventId
      size: {}
      timeout:
        simple: "3"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1035
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "5":
    id: "5"
    taskid: 651b6b24-ebca-42d2-8af0-cdfcb537db1f
    type: regular
    task:
      id: 651b6b24-ebca-42d2-8af0-cdfcb537db1f
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "6":
    id: "6"
    taskid: 62dc591a-5e6a-4c33-8d67-5be4ea0f63b3
    type: condition
    task:
      description: ""
      id: 62dc591a-5e6a-4c33-8d67-5be4ea0f63b3
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "4"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Logzio.Result
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 860
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "7":
    id: "7"
    taskid: cd219d89-5973-47d4-89eb-99f450499913
    type: condition
    task:
      description: ""
      id: cd219d89-5973-47d4-89eb-99f450499913
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "8"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Logzio.Result
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "8":
    id: "8"
    taskid: 75004855-7ea8-4246-889f-6512933ffad2
    type: title
    task:
      id: 75004855-7ea8-4246-889f-6512933ffad2
      version: -1
      name: Test Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1385
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "10":
    id: "10"
    taskid: 76d46f56-e3e4-4582-8c84-9de88363f91b
    type: regular
    task:
      id: 76d46f56-e3e4-4582-8c84-9de88363f91b
      version: -1
      name: FetchFromInstance
      description: Execute FetchIncident for a given instance
      scriptName: FetchFromInstance
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      add_to_context: {}
      brand_name:
        simple: Logz.io
      error_msg_in_incident: {}
      expect_data: {}
      extend-context:
        simple: LogzioFetchedIn=
      instance_name: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 360
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "12":
    id: "12"
    taskid: f0657cc4-74ed-4090-8ffc-c159b26aa5ff
    type: condition
    task:
      id: f0657cc4-74ed-4090-8ffc-c159b26aa5ff
      version: -1
      name: Verify Outputs
      description: Prints text to war room (Markdown supported)
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "3"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: LogzioFetchedIn
                accessor: Contents.rawJSON
                transformers:
                - operator: ParseJSON
                - operator: getField
                  args:
                    field:
                      value:
                        simple: alertEventId
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1400,
        "width": 380,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
fromversion: 5.0.0
