commonfields:
  id: ResolveShortenedURL
  version: -1
name: ResolveShortenedURL
script: ''
type: python
subtype: python3
tags:
- Utility
comment: Resolve the original URL from the given shortened URL and place it in both as output and in the context of a playbook.
enabled: true
args:
- name: service
  required: false
  description: Service to use for resolving the URL. If not set, a default service will be used.
  auto: PREDEFINED
  predefined:
  - "longurl.in"
  - "unshorten.me"
  - "Built-in"
- name: url
  required: true
  description: URL to resolve
  default: true
- name: redirect_limit
  required: false
  defaultValue: "5"
  description: A maximum number of recursions to run in case of nested shortened-URLs. Use 0 for unlimited (not recommended).
- name: insecure
  required: false
  type: Boolean
  predefined:
  - "False"
  - "True"
  description: Trust any certificate (not secure)
outputs:
- contextPath: URL.Data
  description: Resolved URL
  type: string
- contextPath: ResolveShortenedURL.OriginalURL
  description: The original shortened URL.
  type: string
- contextPath: ResolveShortenedURL.ResolvedURL
  description: The resolved URL.
  type: string
- contextPath: ResolveShortenedURL.ServiceName
  description: The name of the service that was used to resolve the URL.
  type: string
- contextPath: ResolveShortenedURL.UsageCount
  description: The usage count for the current IP. If the count exceeds 10 in an hour, an error will be returned. Relevant only if unshorten.me service is used.
  type: int
- contextPath: ResolveShortenedURL.RedirectCount
  description: The number of redirects that were followed to resolve the URL.
  type: int
- contextPath: ResolveShortenedURL.RedirectHistory
  description: The history of redirects that were followed to resolve the URL.
  type: list
scripttarget: 0
tests:
- "No test"
fromversion: 6.5.0
dockerimage: demisto/python3:3.10.9.42476
