args:
- defaultValue: 1GB
  description: The amount of memory to check. Can specify in bytes or append MB/GB
    for Mega/Giga bytes. Default is 1 GB.
  name: memory
- auto: PREDEFINED
  defaultValue: cgroup
  description: 'The memory check type to perform: cgroup - check memory cgroup configuration,
    allocate - try allocating actual memory and verify that the allocation fails.
    Note the allocate test  on some configurations may cause the container to be killed
    by the linux memory manager and the whole test will then time out.'
  name: memory_check
  predefined:
  - cgroup
  - allocate
- defaultValue: '256'
  description: The maximum number of PIDs to check.
  name: pids
- defaultValue: '1024'
  description: The soft file descriptor limit to check.
  name: fds_soft
- defaultValue: '8192'
  description: The hard file descriptor limit to check.
  name: fds_hard
- defaultValue: '1'
  description: The number of CPUs limit to check.
  name: cpus
- auto: PREDEFINED
  defaultValue: cgroup
  description: The network check to perform. cloud_metadata - check that access is
    blocked to cloud metadata server, host_machine - check that access is blocked
    to the host machine on the default gateway IP, all - perform all network tests.
  name: network_check
  predefined:
  - cloud_metadata
  - host_machine
  - all
comment: 'Checks if the Docker container running this script has been hardened according
  to the recommended settings at: https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-9/cortex-xsoar-admin/docker/docker-hardening-guide.html'
commonfields:
  id: DockerHardeningCheck
  version: -1
dockerimage: demisto/python3:3.10.9.40422
enabled: true
fromversion: 5.0.0
name: DockerHardeningCheck
runas: DBotWeakRole
runonce: false
script:
- '8.1'
scripttarget: 0
subtype: python3
tags:
- Utility
tests:
- No tests (auto formatted)
type: python
