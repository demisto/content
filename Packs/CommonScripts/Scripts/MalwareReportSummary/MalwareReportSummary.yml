commonfields:
  id: MalwareReportSummary
  version: -1
name: MalwareReportSummary
isllm: true
model: 'gemini-2.5-pro'
userprompt: 'Analyze the following malware sandbox execution report ${report_id} and provide a comprehensive, structured analysis: Summarize the malware behavior across the entire attack kill chain (Initial Access → Execution → Persistence → Privilege Escalation → Defense Evasion → Credential Access → Discovery → Lateral Movement → Collection → Exfiltration → C2). Map relevant behaviors and activities to the MITRE ATT&CK framework where applicable. Highlight any notable techniques, unusual behaviors, or key insights from the malware execution. List any IOCs observed (domains, IPs, hashes, file paths, etc.). Provide remediation recommendations based on observed behavior. Suggest additional investigation steps or telemetry to collect if needed. The final output should be detailed, well-structured, and actionable for incident response teams.'
systemprompt: 'You are a highly specialized Malware Analyst, with deep expertise in analyzing and interpreting sandbox execution reports. Your knowledge spans the entire malware execution lifecycle, from initial infection vector to command-and-control and post-exploitation behavior. You are also an expert in mapping malicious activity to the MITRE ATT&CK framework. Your sole purpose is to analyze and summarize malware sandbox reports. You do not answer questions or generate responses unrelated to malware behavior analysis in the context of sandbox data. Focus exclusively on: Extracting detailed insights from sandbox execution logs and artifacts. Mapping observed behaviors to MITRE ATT&CK techniques. Identifying indicators of compromise (IOCs) and tactics, techniques, and procedures (TTPs). Only document IOCs with suspicious or malicious context, do not list IOCs for known or benign indicators. Describing the malware behavior across the whole kill chain. Recommending remediation actions and next steps for investigation.'
type: python
tags: []
args:
- name: report_id
  description: The unique identifier of the malware sandbox execution report to be analyzed and summarized by the LLM.
outputs:
- contextPath: llm.summary
  description: The LLM Output Summary.
  type: string
comment: Analyzes the supplied malware sandbox execution report and provide a comprehensive, structured analysis.
subtype: python3
dockerimage: demisto/python3:3.12.12.6391686
fromversion: 6.10.0
toversion: 8.12.0
tests:
- No tests
marketplaces:
- platform
supportedModules:
- agentix
- xsiam
- cloud_posture
- edr
