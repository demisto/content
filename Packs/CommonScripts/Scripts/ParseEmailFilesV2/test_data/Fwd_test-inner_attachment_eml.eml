From: Koko Demisto <koko@demisto.com>
Content-Type: multipart/mixed;
	boundary="Apple-Mail=_BDE60A45-737F-4DD9-B4BB-08441E472087"
Mime-Version: 1.0 (Mac OS X Mail 12.2 \(3445.102.3\))
Subject: Fwd: test - inner attachment eml
X-Universally-Unique-Identifier: 6B4B16BE-DC6F-42A2-A4F9-8C4366D1CA30
Message-Id: <77069121-C854-4CA3-ABC0-C98D010A8209@demisto.com>
Date: Mon, 25 Feb 2019 10:41:41 +0200
To: Wowo Demisto <wowo@demisto.com>


--Apple-Mail=_BDE60A45-737F-4DD9-B4BB-08441E472087
Content-Transfer-Encoding: 7bit
Content-Type: text/plain;
	charset=us-ascii

DONT REPLY - TEST EMAIL


--Apple-Mail=_BDE60A45-737F-4DD9-B4BB-08441E472087
Content-Disposition: attachment;
	filename="test - inner attachment eml.eml"
Content-Type: message/rfc822;
	name="test - inner attachment eml.eml"
Content-Transfer-Encoding: 7bit

From: Koko Demisto <koko@demisto.com>
Content-Type: multipart/mixed;
	boundary="Apple-Mail=_6A13F53F-6BD2-485C-81A5-E92F6426EDEC"
Mime-Version: 1.0 (Mac OS X Mail 12.2 \(3445.102.3\))
Subject: test - inner attachment eml
X-Universally-Unique-Identifier: 6B4B16BE-DC6F-42A2-A4F9-8C4366D1CA30
Message-Id: <2FC50179-3666-4770-A365-744882CDA54C@demisto.com>
Date: Mon, 25 Feb 2019 10:39:50 +0200
Cc: Momo Demisto <momo@demisto.com>
To: Soso Demisto <soso@demisto.com>


--Apple-Mail=_6A13F53F-6BD2-485C-81A5-E92F6426EDEC
Content-Transfer-Encoding: 7bit
Content-Type: text/plain;
	charset=us-ascii

DONT REPLY


--Apple-Mail=_6A13F53F-6BD2-485C-81A5-E92F6426EDEC
Content-Disposition: attachment;
	filename="CS Training 2019 - EWS.pptx"
Content-Type: application/vnd.openxmlformats-officedocument.presentationml.presentation;
	x-unix-mode=0644;
	name="CS Training 2019 - EWS.pptx"
Content-Transfer-Encoding: base64

--Apple-Mail=_6A13F53F-6BD2-485C-81A5-E92F6426EDEC--

--Apple-Mail=_BDE60A45-737F-4DD9-B4BB-08441E472087
Content-Disposition: attachment;
	filename=ArcSight_ESM_fixes.yml
Content-Type: application/octet-stream;
	x-unix-mode=0644;
	name="ArcSight_ESM_fixes.yml"
Content-Transfer-Encoding: quoted-printable

commonfields:=0A=20=20id:=20ArcSight=20ESM_fixes=0A=20=20version:=20-1=0A=
name:=20ArcSight=20ESM_fixes=0Adisplay:=20ArcSight=20ESM_fixes=0A=
category:=20Analytics=20&=20SIEM=0Aimage:=20=
data:image/png;base64,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
qA+T9tH1Zn5G5NKwAAAABJRU5ErkJggg=3D=3D=0Adescription:=20ArcSight=20ESM=20=
SIEM=20by=20Micro=20Focus=20(Formerly=20HPE=20Software).=0A=
configuration:=0A-=20display:=20Server=20URL=20(e.g.=20=
https://192.168.0.1)=0A=20=20name:=20server=0A=20=20defaultvalue:=20""=0A=
=20=20type:=200=0A=20=20required:=20true=0A-=20display:=20Port=0A=20=20=
name:=20port=0A=20=20defaultvalue:=20"8443"=0A=20=20type:=200=0A=20=20=
required:=20true=0A-=20display:=20Credentials=0A=20=20name:=20=
credentials=0A=20=20defaultvalue:=20""=0A=20=20type:=209=0A=20=20=
required:=20true=0A-=20display:=20Fetch=20Events=20as=20incidents=20via=20=
Query=20Viewer=20ID.=20Mandatory=20fields=20for=20query=0A=20=20=20=20=
are=20Start=20Time=20and=20Event=20ID.=0A=20=20name:=20viewerId=0A=20=20=
defaultvalue:=20""=0A=20=20type:=200=0A=20=20required:=20false=0A-=20=
display:=20Fetch=20Cases=20as=20incidents=20via=20Query=20Viewer=20ID.=20=
Mandatory=20fields=20for=20query=0A=20=20=20=20are=20Create=20Time=20and=20=
ID.=0A=20=20name:=20casesQueryViewerId=0A=20=20defaultvalue:=20""=0A=20=20=
type:=200=0A=20=20required:=20false=0A-=20display:=20Fetch=20incidents=0A=
=20=20name:=20isFetch=0A=20=20defaultvalue:=20""=0A=20=20type:=208=0A=20=20=
required:=20false=0A-=20display:=20Incident=20type=0A=20=20name:=20=
incidentType=0A=20=20defaultvalue:=20""=0A=20=20type:=2013=0A=20=20=
required:=20false=0A-=20display:=20Do=20not=20validate=20server=20=
certificate=20(insecure)=0A=20=20name:=20insecure=0A=20=20defaultvalue:=20=
"true"=0A=20=20type:=208=0A=20=20required:=20false=0A-=20display:=20Use=20=
system=20proxy=20settings=0A=20=20name:=20proxy=0A=20=20defaultvalue:=20=
"false"=0A=20=20type:=208=0A=20=20required:=20false=0Ascript:=0A=20=20=
script:=20|-=0A=20=20=20=20//=20table=20from=20JSON=20to=20human=20=
readable=20table=0A=20=20=20=20var=20eventTranslateMap=20=3D=20{=0A=20=20=
=20=20=20=20=20=20'endTime'=20:=20'endTime=3Dnew=20=
Date(Number(val)).toLocaleString()',=0A=20=20=20=20=20=20=20=20//=20=
'Source=20Address':=20'source.address=3DintToIP(val)'=20+=20intToIpDT,=0A=
=20=20=20=20=20=20=20=20//=20'Destination=20Address':=20=
'destination.address=3DintToIP(val)'=20+=20intToIpDT,=0A=20=20=20=20=20=20=
=20=20'Source=20Address':=20'source.address',=0A=20=20=20=20=20=20=20=20=
'Destination=20Address':=20'destination.address',=0A=20=20=20=20=20=20=20=
=20'Name':=20'name',=0A=20=20=20=20=20=20=20=20'source=20Port':=20=
'source.port',=0A=20=20=20=20=20=20=20=20'Vendor':=20'device.vendor',=0A=20=
=20=20=20=20=20=20=20'AgentReceiptTime':=20'agentReceiptTime=3Dnew=20=
Date(Number(val)).toLocaleString()',=0A=20=20=20=20=20=20=20=20=
'DeviceAction':=20'deviceAction',=0A=20=20=20=20=20=20=20=20=
'DeviceCustom':=20'deviceCustom',=0A=20=20=20=20=20=20=20=20=
'UserDisplayName':=20'deviceCustomString2'=0A=20=20=20=20};=0A=0A=20=20=20=
=20function=20humanTime(t)=20{=0A=20=20=20=20=20=20=20=20return=20new=20=
Date(Number(t)).toLocaleString();=0A=20=20=20=20}=0A=20=20=20=20var=20=
caseTimeFields=20=3D=20=20['Event-Manager=20Receipt=20Time',=20=
'Modification=20Time',=20'Create=20Time',=20'Event-End=20Time',=20=
'Event-Start=20Time',=20'Start=20Time'];=0A=0A=0A=20=20=20=20var=20=
server=20=3D=20params.server.replace(/[\/]+$/,=20'')=20+=20':'=20+=20=
params.port=20+=20'/';=0A=0A=20=20=20=20//=20Arcsight=20field=20names=0A=20=
=20=20=20var=20eventIdField=20=3D=20'Event=20ID';=0A=20=20=20=20var=20=
caseIdField=20=3D=20'ID';=0A=20=20=20=20var=20eventsTimeField=20=3D=20=
'Start=20Time';=0A=20=20=20=20var=20casesTimeField=20=3D=20'Create=20=
Time';=0A=0A=20=20=20=20var=20pathDictionary=20=3D=20{=0A=20=20=20=20=20=20=
=20=20login:=20'www/core-service/rest/LoginService/login',=0A=20=20=20=20=
=20=20=20=20logout:=20'www/core-service/rest/LoginService/logout',=0A=20=20=
=20=20=20=20=20=20'as-get-matrix-data':=20=
'www/manager-service/rest/QueryViewerService/getMatrixData',=0A=20=20=20=20=
=20=20=20=20'as-get-all-cases':=20=
'www/manager-service/rest/CaseService/findAllIds',=0A=20=20=20=20=20=20=20=
=20'as-get-case':=20=
'www/manager-service/rest/CaseService/getResourceById',=0A=20=20=20=20=20=
=20=20=20'as-get-all-query-viewers':=20=
'www/manager-service/rest/QueryViewerService/findAllIds',=0A=20=20=20=20=20=
=20=20=20'as-get-case-event-ids':=20=
'www/manager-service/rest/CaseService/getCaseEventIDs',=0A=20=20=20=20=20=
=20=20=20ActiveListService:=20=
'www/manager-service/services/ActiveListService/'=0A=20=20=20=20};=0A=0A=20=
=20=20=20function=20getToken()=20{=0A=20=20=20=20=20=20=20=20var=20res=20=
=3D=20JSON.parse(sendRequest(=0A=20=20=20=20=20=20=20=20=20=20=20=20=
pathDictionary.login,=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20login:=20params.credentials.identifier,=0A=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20password:=20params.credentials.password=0A=20=20=20=20=20=
=20=20=20=20=20=20=20},=0A=20=20=20=20=20=20=20=20=20=20=20=20true));=0A=0A=
=20=20=20=20=20=20=20=20if=20(res=20&&=20res['log.loginResponse']=20&&=20=
res['log.loginResponse']['log.return'])=20{=0A=20=20=20=20=20=20=20=20=20=
=20=20=20return=20res['log.loginResponse']['log.return'];=0A=20=20=20=20=20=
=20=20=20}=0A=0A=20=20=20=20=20=20=20=20throw=20'Failed=20to=20login.=20=
Check=20username/password.=20Original=20login=20response:=20'=20+=20res;=0A=
=20=20=20=20}=0A=0A=20=20=20=20function=20logout()=20{=0A=20=20=20=20=20=20=
=20=20sendRequest(pathDictionary.logout,=20{=0A=20=20=20=20=20=20=20=20=20=
=20=20=20authToken:=20args.authToken=0A=20=20=20=20=20=20=20=20});=0A=20=20=
=20=20}=0A=0A=20=20=20=20function=20sendRequest(url,=20args,=20login)=20=
{=0A=20=20=20=20=20=20=20=20var=20newArgs=20=3D=20args=20||=20{};=0A=20=20=
=20=20=20=20=20=20newArgs.alt=20=3D=20'json';=0A=20=20=20=20=20=20=20=20=
var=20fullUrl=20=3D=20server=20+=20url=20+=20encodeToURLQuery(newArgs);=0A=
=20=20=20=20=20=20=20=20//=20logDebug('ArcSight=20sendRequest:=20sending=20=
request=20to=20'=20+=20fullUrl);=0A=20=20=20=20=20=20=20=20var=20res=20=3D=
=20http(=0A=20=20=20=20=20=20=20=20=20=20=20=20fullUrl,=20{=0A=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20Method:=20'GET',=0A=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20Headers:=20{=0A=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20'Content-Type':=20=
['application/x-www-form-urlencoded'],=0A=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20'Accept':=20['application/json']=0A=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20}=0A=20=20=20=20=20=20=20=20=20=20=20=
=20},=0A=20=20=20=20=20=20=20=20=20=20=20=20params.insecure,=0A=20=20=20=20=
=20=20=20=20=20=20=20=20params.proxy=0A=20=20=20=20=20=20=20=20);=0A=20=20=
=20=20=20=20=20=20//=20logDebug('ArcSight=20sendRequest:=20got=20reply=20=
from=20'=20+=20fullUrl);=0A=0A=20=20=20=20=20=20=20=20if=20=
(res.StatusCode=20<=20200=20||=20res.StatusCode=20>=3D=20300)=20{=0A=20=20=
=20=20=20=20=20=20=20=20=20=20if=20(!login)=20{=0A=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20sendRequest(pathDictionary.logout,=20{=0A=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20authToken:=20=
args.authToken=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20});=0A=20=
=20=20=20=20=20=20=20=20=20=20=20}=0A=20=20=20=20=20=20=20=20=20=20=20=20=
throw=20'Request=20to=20ArcSight=20'=20+=20fullUrl=20+=20'=20failed,=20=
request=20status=20code:=20'=20+=20res.StatusCode=20+=20'=20and=20Body:=20=
'=20+=20res.Body=20+=20'.';=0A=20=20=20=20=20=20=20=20}=0A=0A=20=20=20=20=
=20=20=20=20return=20res.Body;=0A=20=20=20=20}=0A=0A=20=20=20=20function=20=
sendAndParse(command,=20url,=20args)=20{=0A=20=20=20=20=20=20=20=20var=20=
json=20=3D=20parseSOAPResponse(sendRequest(url,=20args));=0A=20=20=20=20=20=
=20=20=20if=20(!json)=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20return=20=
null;=0A=20=20=20=20=20=20=20=20}=0A=0A=20=20=20=20=20=20=20=20var=20=
result=20=3D=20json;=0A=20=20=20=20=20=20=20=20return=20result;=0A=20=20=20=
=20}=0A=0A=20=20=20=20function=20postRestRequest(queryPath,=20param,=20=
body)=20{=0A=20=20=20=20=20=20=20=20var=20stringBody=20=3D=20body;=0A=20=20=
=20=20=20=20=20=20if=20(body=20&&=20typeof=20body=20!=3D=3D=20'string')=20=
{=0A=20=20=20=20=20=20=20=20=20=20=20=20stringBody=20=3D=20=
JSON.stringify(body)=0A=20=20=20=20=20=20=20=20}=0A=0A=20=20=20=20=20=20=20=
=20var=20newArgs=20=3D=20param=20||=20{};=0A=20=20=20=20=20=20=20=20=
newArgs.alt=20=3D=20'json';=0A=0A=20=20=20=20=20=20=20=20//=20prepare=20=
the=20request=20url=20(make=20sure=20to=20encode=20the=20query=20=
parameter=20value)=0A=20=20=20=20=20=20=20=20var=20requestUrl=20=3D=20=
server=20+=20queryPath;=0A=20=20=20=20=20=20=20=20if=20(newArgs)=20{=0A=20=
=20=20=20=20=20=20=20=20=20=20=20requestUrl=20+=3D=20=
encodeToURLQuery(newArgs);=0A=20=20=20=20=20=20=20=20}=0A=20=20=20=20=
logDebug('postRestRequest:=20sending=20request=20to=20'=20+=20=
requestUrl);=0A=20=20=20=20logDebug('postRestRequest:=20body=20is=20'=20=
+=20stringBody);=0A=20=20=20=20var=20res=20=3D=20http(=0A=20=20=20=20=20=20=
=20=20=20=20=20=20requestUrl,=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20Method:=20'POST',=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20Headers:=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20'Content-Type':=20['application/json'],=0A=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20'Accept':=20['application/json']=0A=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20},=0A=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20Body:=20stringBody=0A=20=20=20=20=20=20=20=20=20=20=20=20=
},=0A=20=20=20=20=20=20=20=20=20=20=20=20params.insecure,=0A=20=20=20=20=20=
=20=20=20=20=20=20=20params.useproxy=0A=20=20=20=20=20=20=20=20);=0A=0A=20=
=20=20=20=20=20=20=20if=20(res.StatusCode=20<=20200=20||=20=
res.StatusCode=20>=3D=20300)=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20=
throw=20'Request=20Body:=20'=20+=20stringBody=20+=20'\n'=20+=20'Request=20=
Failed=20to=20'=20+=20requestUrl=20+=20'.\nStatus=20code:=20'=20+=20=
res.StatusCode=20+=20'.\nBody:=20'=20+=20JSON.stringify(res)=20+=20'.';=0A=
=20=20=20=20=20=20=20=20}=0A=20=20=20=20=20=20=20=20return=20res;=0A=20=20=
=20=20}=0A=0A=20=20=20=20function=20sendSOAPRequest(queryPath,=20param,=20=
body)=20{=0A=20=20=20=20=20=20=20=20//=20prepare=20the=20request=20url=20=
(make=20sure=20to=20encode=20the=20query=20parameter=20value)=0A=20=20=20=
=20=20=20=20=20var=20requestUrl=20=3D=20server=20+=20queryPath;=0A=20=20=20=
=20=20=20=20=20if=20(param)=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20=
requestUrl=20+=3D=20encodeToURLQuery(param);=0A=20=20=20=20=20=20=20=20}=0A=
=0A=20=20=20=20=20=20=20=20var=20res=20=3D=20http(=0A=20=20=20=20=20=20=20=
=20=20=20=20=20requestUrl,=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20Method:=20'POST',=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
Body:=20body=0A=20=20=20=20=20=20=20=20=20=20=20=20},=0A=20=20=20=20=20=20=
=20=20=20=20=20=20params.insecure,=0A=20=20=20=20=20=20=20=20=20=20=20=20=
params.proxy=0A=20=20=20=20=20=20=20=20);=0A=0A=20=20=20=20=20=20=20=20=
if=20(res.StatusCode=20<=20200=20||=20res.StatusCode=20>=3D=20300)=20{=0A=
=20=20=20=20=20=20=20=20=20=20=20=20throw=20'Request=20Failed=20to=20'=20=
+=20requestUrl=20+=20'.\nStatus=20code:=20'=20+=20res.StatusCode=20+=20=
'.\nBody:=20'=20+=20JSON.stringify(res)=20+=20'.';=0A=20=20=20=20=20=20=20=
=20}=0A=0A=20=20=20=20=20=20=20=20return=20res;=0A=20=20=20=20}=0A=0A=20=20=
=20=20function=20parseSOAPResponse(resBody)=20{=0A=20=20=20=20=20=20=20=20=
var=20matches=20=3D=20=
resBody.match(/<ns\d{1,3}:return>(.|[\r\n])*<\/ns\d{1,3}:return>/);=0A=20=
=20=20=20=20=20=20=20if=20(!matches=20||=20!matches[0])=20{=0A=20=20=20=20=
=20=20=20=20=20=20=20=20return=20null;=0A=20=20=20=20=20=20=20=20}=0A=0A=20=
=20=20=20=20=20=20=20var=20match=20=3D=20=
matches[0].replace(/:return><ns/gi,=20=
':return>##=3D=3D##=3D=3D#<ns').split('##=3D=3D##=3D=3D#');=0A=20=20=20=20=
=20=20=20=20if=20(match.length=20=3D=3D=3D=201)=20{=0A=20=20=20=20=20=20=20=
=20=20=20=20=20match=20=3D=20match[0];=0A=20=20=20=20=20=20=20=20=20=20=20=
=20var=20json=20=3D=20JSON.parse(x2j(match));=0A=20=20=20=20=20=20=20=20=20=
=20=20=20return=20json;=0A=20=20=20=20=20=20=20=20}=20else=20{=0A=20=20=20=
=20=20=20=20=20=20=20=20=20var=20arr=20=3D=20[];=0A=20=20=20=20=20=20=20=20=
=20=20=20=20for=20(var=20i=20=3D=200;=20i=20<=20match.length;=20i++)=20{=0A=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
arr.push(JSON.parse(x2j(match[i])).return);=0A=20=20=20=20=20=20=20=20=20=
=20=20=20}=0A=0A=20=20=20=20=20=20=20=20=20=20=20=20return=20arr;=0A=20=20=
=20=20=20=20=20=20}=0A=20=20=20=20}=0A=0A=20=20=20=20function=20=
convertByMap(arrSrc,=20translationMap)=20{=0A=20=20=20=20=20=20=20=20var=20=
arrDest=20=3D=20[];=0A=0A=20=20=20=20=20=20=20=20if=20(!arrSrc)=20{=0A=20=
=20=20=20=20=20=20=20=20=20=20=20throw=20'arrSrc=20can\'t=20be=20=
undefined=20or=20null';=0A=20=20=20=20=20=20=20=20}=0A=0A=20=20=20=20=20=20=
=20=20if=20(!Array.isArray(arrSrc))=20{=0A=20=20=20=20=20=20=20=20=20=20=20=
=20arrSrc=20=3D=20[arrSrc];=0A=20=20=20=20=20=20=20=20}=0A=0A=20=20=20=20=
=20=20=20=20if=20(!translationMap)=20{=0A=20=20=20=20=20=20=20=20=20=20=20=
=20throw=20'translationMap=20must=20contain=20map';=0A=20=20=20=20=20=20=20=
=20}=0A=0A=20=20=20=20=20=20=20=20/*=0A=20=20=20=20=20=20=20=20[=0A=20=20=
=20=20=20=20=20=20=20=20=20=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20"name":=20"Anar",=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20"age":=2019=0A=20=20=20=20=20=20=20=20=20=20=20=20}=0A=20=20=20=20=20=20=
=20=20]=0A=0A=20=20=20=20=20=20=20=20=3D=3D>=20{=20"NAME":=20"name"=20}=0A=
=20=20=20=20=20=20=20=20[=0A=20=20=20=20=20=20=20=20=20=20=20=20{=0A=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20"NAME":=20"Anar"=0A=20=20=20=20=
=20=20=20=20=20=20=20=20}=0A=20=20=20=20=20=20=20=20]=0A=0A=20=20=20=20=20=
=20=20=20*/=0A=20=20=20=20=20=20=20=20arrSrc.forEach(function(objSrc)=20=
{=0A=20=20=20=20=20=20=20=20=20=20=20=20var=20objDest=20=3D=20{};=0A=20=20=
=20=20=20=20=20=20=20=20=20=20=
Object.keys(translationMap).forEach(function(destKey)=20{=0A=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20var=20srcKey=20=3D=20=
translationMap[destKey];=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
objDest[destKey]=20=3D=20dq(objSrc,=20srcKey);=0A=20=20=20=20=20=20=20=20=
=20=20=20=20});=0A=20=20=20=20=20=20=20=20=20=20=20=20=
arrDest.push(objDest);=0A=20=20=20=20=20=20=20=20});=0A=0A=20=20=20=20=20=
=20=20=20return=20arrDest;=0A=20=20=20=20}=0A=0A=0A=20=20=20=20function=20=
getAllQueryViewerCases()=20{=0A=20=20=20=20=20=20=20=20var=20response;=0A=
=20=20=20=20=20=20=20=20try=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20=
response=20=3D=20getQueryViewerResultsRequest(args.authToken,=20=
args.QueryViewerId,=20false);=0A=20=20=20=20=20=20=20=20}=20catch=20(ex)=20=
{=0A=20=20=20=20=20=20=20=20=20=20=20=20throw=20'Cases=20response=20to=20=
query=20is=20not=20in=20the=20correct=20format.=20Error:=20'=20+=20ex;=0A=
=20=20=20=20=20=20=20=20}=0A=20=20=20=20=20=20=20=20if=20(!response)=20{=0A=
=20=20=20=20=20=20=20=20=20=20=20=20throw=20'Cases=20response=20to=20=
query=20is=20empty';=0A=20=20=20=20=20=20=20=20}=0A=20=20=20=20=20=20=20=20=
var=20fieldNames=20=3D=20response.columnHeaders;=0A=0A=20=20=20=20=20=20=20=
=20var=20data=20=3D=20response.data;=0A=0A=20=20=20=20=20=20=20=20return=20=
{"res":=20data};=0A=20=20=20=20}=0A=0A=20=20=20=20function=20=
getCasesIncidents(lastRun)=20{=0A=20=20=20=20=20=20=20=20var=20timeField=20=
=3D=20'Create=20Time';=20//=20Query=20must=20contain=20Start=20Time=20=
field=0A=20=20=20=20=20=20=20=20var=20newIncidents=20=3D=20[];=0A=0A=20=20=
=20=20=20=20=20=20var=20response;=0A=20=20=20=20=20=20=20=20try=20{=0A=20=
=20=20=20=20=20=20=20=20=20=20=20response=20=3D=20=
getQueryViewerResultsRequest(args.authToken,=20=
params.casesQueryViewerId,=20false);=0A=20=20=20=20=20=20=20=20}=20catch=20=
(ex)=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20throw=20'Cases=20response=20=
to=20query=20is=20not=20in=20the=20correct=20format.=20Error:=20'=20+=20=
ex;=0A=20=20=20=20=20=20=20=20}=0A=20=20=20=20=20=20=20=20if=20=
(!response)=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20throw=20'Cases=20=
response=20to=20query=20is=20empty';=0A=20=20=20=20=20=20=20=20}=0A=20=20=
=20=20=20=20=20=20var=20fieldNames=20=3D=20response.columnHeaders;=0A=20=20=
=20=20=20=20=20=20if=20(fieldNames.indexOf(timeField)=20=3D=3D=3D=20-1)=20=
{=0A=20=20=20=20=20=20=20=20=20=20=20=20throw=20'Cases=20Query=20must=20=
contain=20'=20+=20timeField=20+=20'=20fields';=0A=20=20=20=20=20=20=20=20=
}=0A=20=20=20=20=20=20=20=20var=20data=20=3D=20response.data;=0A=0A=20=20=
=20=20=20=20=20=20var=20lastEventTime=20=3D=20(lastRun=20&&=20=
lastRun.caseLastEventTime)=20?=20lastRun.caseLastEventTime=20:=200;=0A=20=
=20=20=20=20=20=20=20var=20maxEventTime=20=3D=20lastEventTime;=0A=20=20=20=
=20=20=20=20=20for=20(var=20i=20=3D=200;=20i=20<=20data.length;=20i++)=20=
{=0A=20=20=20=20=20=20=20=20=20=20=20=20var=20eventTimeInMillis=20=3D=20=
Number(data[i][timeField]);=0A=20=20=20=20=20=20=20=20=20=20=20=20if=20=
(lastEventTime=20<=20eventTimeInMillis)=20{=0A=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20if=20(maxEventTime=20<=20eventTimeInMillis)=20{=0A=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20maxEventTime=20=
=3D=20eventTimeInMillis;=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
}=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20var=20keys=20=3D=20=
Object.keys(data[i]);=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
var=20labels=20=3D=20[];=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
var=20timeOccurred=20=3D=20null;=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20for=20(var=20j=20=3D=200;=20j=20<=20keys.length;=20j++)=20{=0A=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20if=20(keys[j]=20=
!=3D=3D=20'Name')=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20if=20(data[i][keys[j]])=20{=0A=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20if=20=
(keys[j]=20=3D=3D=3D=20'Event-Manager=20Receipt=20Time')=20{=0A=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20timeOccurred=20=3D=20new=20=
Date(Number(data[i][keys[j]])).toISOString();=0A=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20}=0A=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
val=20=3D=20data[i][keys[j]];=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
if(caseTimeFields.indexOf(keys[j])=20>=20-1)=20{=0A=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
val=20=3D=20humanTime(val);=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20}=0A=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20//=0A=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
logInfo('ArcsightDebug'=20+=20val);=0A=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20labels.push({=0A=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20type:=20keys[j],=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20value:=20=
String(val)=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20});=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20}=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20}=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20}=0A=
=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20var=20newIncident=20=3D=
=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20name:=20=
data[i].Name=20||=20('New=20case=20from=20arcsight=20at=20'=20+=20=
Date.now()),=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
labels:=20labels,=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20rawJSON:=20JSON.stringify(data[i])=0A=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20};=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
if=20(timeOccurred)=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20newIncident['occurred']=20=3D=20timeOccurred;=0A=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20}=0A=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20newIncidents.push(newIncident);=0A=20=20=20=20=20=20=20=20=20=
=20=20=20}=0A=20=20=20=20=20=20=20=20}=0A=0A=20=20=20=20=20=20=20=20=
lastRun.caseLastEventTime=20=3D=20maxEventTime;=0A=20=20=20=20=20=20=20=20=
return=20newIncidents;=0A=20=20=20=20}=0A=0A=20=20=20=20function=20=
getEventsIncidents(lastRun)=20{=0A=20=20=20=20=20=20=20=20var=20=
timeField=20=3D=20'Start=20Time';=20//=20Query=20must=20contain=20Start=20=
Time=20field=0A=20=20=20=20=20=20=20=20var=20newIncidents=20=3D=20[];=0A=0A=
=20=20=20=20=20=20=20=20var=20response;=0A=20=20=20=20=20=20=20=20try=20=
{=0A=20=20=20=20=20=20=20=20=20=20=20=20response=20=3D=20=
getQueryViewerResultsRequest(args.authToken,=20params.viewerId,=20=
false);=0A=20=20=20=20=20=20=20=20}=20catch=20(ex)=20{=0A=20=20=20=20=20=20=
=20=20=20=20=20=20throw=20'Events=20response=20to=20query=20is=20not=20=
in=20the=20correct=20format.=20Error:=20'=20+=20ex;=0A=20=20=20=20=20=20=20=
=20}=0A=20=20=20=20=20=20=20=20if=20(!response)=20{=0A=20=20=20=20=20=20=20=
=20=20=20=20=20throw=20'Events=20response=20to=20query=20is=20empty';=0A=20=
=20=20=20=20=20=20=20}=0A=20=20=20=20=20=20=20=20var=20fieldNames=20=3D=20=
response.columnHeaders;=0A=20=20=20=20=20=20=20=20if=20=
(fieldNames.indexOf(timeField)=20=3D=3D=3D=20-1)=20{=0A=20=20=20=20=20=20=
=20=20=20=20=20=20throw=20'Events=20Query=20must=20contain=20'=20+=20=
timeField=20+=20'=20fields';=0A=20=20=20=20=20=20=20=20}=0A=20=20=20=20=20=
=20=20=20var=20data=20=3D=20response.data;=0A=20=20=20=20=20=20=20=20var=20=
lastEventTime=20=3D=20lastRun=20&&=20lastRun.lastEventTime=20?=20=
lastRun.lastEventTime=20:=200;=0A=20=20=20=20=20=20=20=20var=20=
maxEventTime=20=3D=20lastEventTime;=0A=20=20=20=20=20=20=20=20for=20(var=20=
i=20=3D=200;=20i=20<=20data.length;=20i++)=20{=0A=20=20=20=20=20=20=20=20=
=20=20=20=20var=20eventTimeInMillis=20=3D=20Number(data[i][timeField]);=0A=
=20=20=20=20=20=20=20=20=20=20=20=20if=20(lastEventTime=20<=20=
eventTimeInMillis)=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
if=20(maxEventTime=20<=20eventTimeInMillis)=20{=0A=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20maxEventTime=20=3D=20=
eventTimeInMillis;=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20}=0A=
=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20var=20keys=20=3D=20=
Object.keys(data[i]);=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
var=20labels=20=3D=20[];=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
for=20(var=20j=20=3D=200;=20j=20<=20keys.length;=20j++)=20{=0A=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20if=20(keys[j]=20!=3D=3D=20=
'Name')=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20labels.push({=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20type:=20keys[j],=0A=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
value:=20String(data[i][keys[j]])=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20});=0A=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20}=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20}=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
newIncidents.push({=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20name:=20data[i].Name=20||=20('New=20event=20from=20arcsight=20=
at=20'=20+=20Date.now()),=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20labels:=20labels,=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20rawJSON:=20JSON.stringify(data[i])=0A=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20});=0A=20=20=20=20=20=20=20=20=20=20=20=20=
}=0A=20=20=20=20=20=20=20=20}=0A=0A=20=20=20=20=20=20=20=20=
lastRun.lastEventTime=20=3D=20maxEventTime;=0A=20=20=20=20=20=20=20=20=
return=20newIncidents;=0A=20=20=20=20}=0A=0A=20=20=20=20function=20=
convertRowsToStruct(fields,=20rows)=20{=0A=20=20=20=20=20=20=20=20var=20=
data=20=3D=20[];=0A=20=20=20=20=20=20=20=20for=20(var=20i=20=3D=200;=20i=20=
<=20rows.length;=20i++)=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20var=20=
newData=20=3D=20{};=0A=20=20=20=20=20=20=20=20=20=20=20=20for=20(var=20j=20=
=3D=200;=20j=20<=20fields.length;=20j++)=20{=0A=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20if=20(rows[i].value[j]['#text'])=20{=0A=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20newData[fields[j]]=20=3D=20=
rows[i].value[j]['#text'];=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20}=0A=20=20=20=20=20=20=20=20=20=20=20=20}=0A=20=20=20=20=20=20=20=20=20=
=20=20=20data.push(newData);=0A=20=20=20=20=20=20=20=20}=0A=20=20=20=20=20=
=20=20=20return=20data;=0A=20=20=20=20}=0A=0A=20=20=20=20function=20=
getCase()=20{=0A=20=20=20=20=20=20=20=20var=20ccase=20=3D=20=
getCaseRequest(args.authToken,=20args.resourceId);=0A=0A=20=20=20=20=20=20=
=20=20return=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20Type:=20=
entryTypes.note,=0A=20=20=20=20=20=20=20=20=20=20=20=20ContentsFormat:=20=
formats.json,=0A=20=20=20=20=20=20=20=20=20=20=20=20Contents:=20ccase,=0A=
=20=20=20=20=20=20=20=20=20=20=20=20ReadableContensFormat:=20=
formats.markdown,=0A=20=20=20=20=20=20=20=20=20=20=20=20HumanReadable:=20=
tableToMarkdown('Case=20'=20+=20args.resourceId,=20convertByMap(ccase,=20=
{=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20'Name':=20'name',=0A=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20'EventIDs':=20'eventIDs',=0A=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20'Action':=20'action',=0A=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20'Stage':=20'stage',=0A=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20'CaseID':=20'resourceid',=0A=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20'CreatedTime':=20=
'createdTimestamp=3DDate(val)'=0A=20=20=20=20=20=20=20=20=20=20=20=20=
})),=0A=20=20=20=20=20=20=20=20=20=20=20=20EntryContext:=20{=0A=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=
'ArcSightESM.Cases(val.resourceid=3D=3D=3Dobj.resourceid)':=20ccase=0A=20=
=20=20=20=20=20=20=20=20=20=20=20}=0A=20=20=20=20=20=20=20=20};=0A=20=20=20=
=20}=0A=0A=20=20=20=20function=20getCaseRequest(authToken,=20resourceId)=20=
{=0A=20=20=20=20=20=20=20=20var=20reqArgs=20=3D=20{=0A=20=20=20=20=20=20=20=
=20=20=20=20=20authToken:=20authToken,=0A=20=20=20=20=20=20=20=20=20=20=20=
=20resourceId:=20resourceId=0A=20=20=20=20=20=20=20=20};=0A=0A=20=20=20=20=
=20=20=20=20var=20res=20=3D=20sendRequest(pathDictionary['as-get-case'],=20=
reqArgs);=0A=20=20=20=20=20=20=20=20var=20json=20=3D=20JSON.parse(res);=0A=
=20=20=20=20=20=20=20=20if=20(json=20&&=20=
json['cas.getResourceByIdResponse']=20&&=20=
json['cas.getResourceByIdResponse']['cas.return'])=20{=0A=20=20=20=20=20=20=
=20=20=20=20=20=20return=20=
json['cas.getResourceByIdResponse']['cas.return'];=0A=20=20=20=20=20=20=20=
=20}=0A=0A=20=20=20=20=20=20=20=20return=20null;=0A=20=20=20=20}=0A=0A=20=
=20=20=20function=20dlog(obj)=20{=0A=20=20=20=20=20=20=20=20try=20{=0A=20=
=20=20=20=20=20=20=20=20=20=20=20log(JSON.stringify(obj,=20null,=202));=0A=
=20=20=20=20=20=20=20=20}=20catch=20(err)=20{=0A=20=20=20=20=20=20=20=20=20=
=20=20=20log(obj);=0A=20=20=20=20=20=20=20=20}=0A=0A=20=20=20=20}=0A=0A=20=
=20=20=20function=20getMatrixData()=20{=0A=20=20=20=20=20=20=20=20=
args.onlyColumns=20=3D=20args.onlyColumns=20=3D=3D=3D=20'true'=20?=20=
true=20:=20false;=0A=20=20=20=20=20=20=20=20var=20results=20=3D=20=
getQueryViewerResultsRequest(args.authToken,=20args.id,=20=
args.onlyColumns);=0A=0A=20=20=20=20=20=20=20=20var=20entries=20=3D=20[{=0A=
=20=20=20=20=20=20=20=20=20=20=20=20Type:=20entryTypes.note,=0A=20=20=20=20=
=20=20=20=20=20=20=20=20ContentsFormat:=20formats.json,=0A=20=20=20=20=20=
=20=20=20=20=20=20=20Contents:=20results.columnHeaders,=0A=20=20=20=20=20=
=20=20=20=20=20=20=20ReadableContensFormat:=20formats.markdown,=0A=20=20=20=
=20=20=20=20=20=20=20=20=20HumanReadable:=20=
arrayToMarkdownTable(results.columnHeaders,=20'Column=20Headers')=20//=20=
will=20print=20only=20query=20viewer=20column=20headers=0A=20=20=20=20=20=
=20=20=20}];=0A=0A=20=20=20=20=20=20=20=20if=20(!args.onlyColumns)=20{=0A=
=20=20=20=20=20=20=20=20=20=20=20=20entries.push({=0A=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20Type:=20entryTypes.note,=0A=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20ContentsFormat:=20formats.json,=0A=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20Contents:=20results.data,=0A=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20ReadableContensFormat:=20=
formats.markdown,=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
HumanReadable:=20tableToMarkdown('Query=20Viewer=20Results:=20'=20+=20=
args.id,=20results.data)=20//=20will=20print=20all=20the=20results=20=
table=0A=20=20=20=20=20=20=20=20=20=20=20=20});=0A=20=20=20=20=20=20=20=20=
}=0A=0A=20=20=20=20=20=20=20=20return=20entries;=0A=20=20=20=20}=0A=0A=20=
=20=20=20function=20getQueryViewerResultsRequest(authToken,=20=
queryViewerId,=20includeOnlyHeaders)=20{=0A=20=20=20=20=20=20=20=20var=20=
reqArgs=20=3D=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20authToken:=20=
authToken,=0A=20=20=20=20=20=20=20=20=20=20=20=20id:=20queryViewerId=0A=20=
=20=20=20=20=20=20=20};=0A=20=20=20=20=20=20=20=20var=20json=20=3D=20=
JSON.parse(sendRequest(pathDictionary['as-get-matrix-data'],=20=
reqArgs));=0A=0A=20=20=20=20=20=20=20=20if=20(json=20&&=20=
json['qvs.getMatrixDataResponse']=20&&=20=
json['qvs.getMatrixDataResponse']['qvs.return'])=20{=0A=20=20=20=20=20=20=
=20=20=20=20=20=20var=20returnObject=20=3D=20=
json['qvs.getMatrixDataResponse']['qvs.return'];=0A=20=20=20=20=20=20=20=20=
=20=20=20=20var=20columnHeaders=20=3D=20dq(returnObject,=20=
'columnHeaders');=0A=20=20=20=20=20=20=20=20=20=20=20=20if=20=
(columnHeaders=20&&=20!Array.isArray(columnHeaders))=20{=0A=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20columnHeaders=20=3D=20[columnHeaders];=0A=
=20=20=20=20=20=20=20=20=20=20=20=20}=0A=20=20=20=20=20=20=20=20=20=20=20=
=20if=20(includeOnlyHeaders)=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20return=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20columnHeaders:=20columnHeaders=0A=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20};=0A=20=20=20=20=20=20=20=20=20=20=20=20}=0A=0A=20=20=20=20=
=20=20=20=20=20=20=20=20if=20(!returnObject.rows=20||=20=
!Array.isArray(returnObject.rows)=20||=20returnObject.rows.length=20=3D=3D=
=3D=200)=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20//=20=
there=20are=20no=20results=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20return=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20columnHeaders:=20columnHeaders,=0A=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20data:=20[]=0A=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20};=0A=20=20=20=20=20=20=20=20=20=20=20=20}=0A=0A=20=20=20=20=20=
=20=20=20=20=20=20=20if=20(!columnHeaders=20||=20!columnHeaders.length=20=
||=20columnHeaders.length=20=3D=3D=3D=200)=20{=0A=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20//=20no=20columns=20exists=0A=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20return=20{=0A=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20columnHeaders:=20[],=0A=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20data:=20[]=0A=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20};=0A=20=20=20=20=20=20=20=20=20=20=20=20}=0A=0A=20=
=20=20=20=20=20=20=20=20=20=20=20//=20we=20should=20parse=20the=20raws=20=
by=20column=20headers=20and=20create=20result=20objects=20from=20them=0A=20=
=20=20=20=20=20=20=20=20=20=20=20var=20queryResults=20=3D=20[];=0A=20=20=20=
=20=20=20=20=20=20=20=20=20for=20(var=20i=20=3D=200;=20i=20<=20=
returnObject.rows.length;=20i++)=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20var=20row=20=3D=20returnObject.rows[i].value;=0A=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20var=20qResult=20=3D=20{};=0A=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20for=20(var=20columnIdx=20=3D=200;=20=
columnIdx=20<=20columnHeaders.length;=20columnIdx++)=20{=0A=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20column=20=3D=20=
columnHeaders[columnIdx];=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20qResult[column]=20=3D=20row[columnIdx]['$'];=0A=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20}=0A=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20queryResults.push(qResult);=0A=20=20=20=20=20=20=20=20=20=20=
=20=20}=0A=0A=20=20=20=20=20=20=20=20=20=20=20=20return=20{=0A=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20columnHeaders:=20columnHeaders,=0A=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20data:=20queryResults=0A=20=20=
=20=20=20=20=20=20=20=20=20=20};=0A=20=20=20=20=20=20=20=20}=0A=0A=20=20=20=
=20=20=20=20=20return=20null;=0A=20=20=20=20}=0A=0A=20=20=20=20function=20=
getAllCases()=20{=0A=20=20=20=20=20=20=20=20var=20allCases=20=3D=20=
getAllCasesRequest(args.authToken);=0A=0A=20=20=20=20=20=20=20=20return=20=
{=0A=20=20=20=20=20=20=20=20=20=20=20=20Type:=20entryTypes.note,=0A=20=20=
=20=20=20=20=20=20=20=20=20=20ContentsFormat:=20formats.json,=0A=20=20=20=
=20=20=20=20=20=20=20=20=20Contents:=20allCases,=0A=20=20=20=20=20=20=20=20=
=20=20=20=20ReadableContensFormat:=20formats.markdown,=0A=20=20=20=20=20=20=
=20=20=20=20=20=20HumanReadable:=20arrayToMarkdownTable(allCases,=20=
'Case=20ID'),=0A=20=20=20=20=20=20=20=20=20=20=20=20EntryContext:=20{=0A=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20'ArcSightESM.AllCaseIDs':=20=
allCases=0A=20=20=20=20=20=20=20=20=20=20=20=20}=0A=20=20=20=20=20=20=20=20=
};=0A=20=20=20=20}=0A=0A=20=20=20=20function=20=
getAllCasesRequest(authToken)=20{=0A=20=20=20=20=20=20=20=20var=20=
reqArgs=20=3D=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20authToken:=20=
authToken=0A=20=20=20=20=20=20=20=20};=0A=0A=20=20=20=20=20=20=20=20var=20=
json=20=3D=20JSON.parse(sendRequest(pathDictionary['as-get-all-cases'],=20=
reqArgs));=0A=20=20=20=20=20=20=20=20if=20(json=20&&=20=
json['cas.findAllIdsResponse']=20&&=20=
json['cas.findAllIdsResponse']['cas.return'])=20{=0A=20=20=20=20=20=20=20=
=20=20=20=20=20return=20json['cas.findAllIdsResponse']['cas.return'];=0A=20=
=20=20=20=20=20=20=20}=0A=0A=20=20=20=20=20=20=20=20return=20null;=0A=20=20=
=20=20}=0A=0A=20=20=20=20function=20getAllQueryViewers()=20{=0A=20=20=20=20=
=20=20=20=20var=20json=20=3D=20=
JSON.parse(sendRequest(pathDictionary['as-get-all-query-viewers'],=20=
args));=0A=20=20=20=20=20=20=20=20if=20(!json=20||=20=
!json['qvs.findAllIdsResponse']=20||=20=
!json['qvs.findAllIdsResponse']['qvs.return'])=20{=0A=20=20=20=20=20=20=20=
=20=20=20=20=20return=20null;=0A=20=20=20=20=20=20=20=20}=0A=0A=20=20=20=20=
=20=20=20=20var=20queryList=20=3D=20=
json['qvs.findAllIdsResponse']['qvs.return'];=0A=20=20=20=20=20=20=20=20=
return=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20Type:=20=
entryTypes.note,=0A=20=20=20=20=20=20=20=20=20=20=20=20ContentsFormat:=20=
formats.json,=0A=20=20=20=20=20=20=20=20=20=20=20=20Contents:=20=
queryList,=0A=20=20=20=20=20=20=20=20=20=20=20=20ReadableContensFormat:=20=
formats.markdown,=0A=20=20=20=20=20=20=20=20=20=20=20=20HumanReadable:=20=
arrayToMarkdownTable(queryList,=20'Query=20Viewers'),=0A=20=20=20=20=20=20=
=20=20=20=20=20=20EntryContext:=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20'ArcSightESM.AllQueryViewers':=20queryList=0A=20=20=20=20=20=20=
=20=20=20=20=20=20}=0A=20=20=20=20=20=20=20=20};=0A=20=20=20=20}=0A=0A=20=
=20=20=20//=20convertCsvToEntryListObject=20converts=20entries=20which=20=
is=20array=20of=20entry=20objects=20into=20entryList=20object=20=
according=20to=20the=20SOAP=20request=0A=20=20=20=20//=20entryList=20=
object=20contains=20separately=20the=20columns=20and=20the=20entries=0A=20=
=20=20=20function=20convertCsvToEntryListObject(entries)=20{=0A=20=20=20=20=
=20=20=20=20var=20entryList=20=3D=20[];=0A=20=20=20=20=20=20=20=20var=20=
columns=20=3D=20[];=0A=20=20=20=20=20=20=20=20var=20column;=0A=0A=20=20=20=
=20=20=20=20=20if=20(!entries=20||=20!Array.isArray(entries)=20||=20=
entries.length=20=3D=3D=3D=200)=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20=
return=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20columns:=20=
[],=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20entryList:=20[]=0A=20=
=20=20=20=20=20=20=20=20=20=20=20};=0A=20=20=20=20=20=20=20=20}=0A=0A=20=20=
=20=20=20=20=20=20//=20extract=20the=20columns=0A=20=20=20=20=20=20=20=20=
for=20(column=20in=20entries[0])=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20=
if=20(entries[0].hasOwnProperty(column))=20{=0A=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20columns.push(column);=0A=20=20=20=20=20=20=20=20=20=20=
=20=20}=0A=20=20=20=20=20=20=20=20}=0A=0A=20=20=20=20=20=20=20=20//=20=
get=20the=20entries=0A=20=20=20=20=20=20=20=20for=20(var=20i=20=3D=200;=20=
i=20<=20entries.length;=20i++)=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20=
entryRow=20=3D=20[];=0A=20=20=20=20=20=20=20=20=20=20=20=20for=20(var=20=
j=20=3D=200;=20j=20<=20columns.length;=20j++)=20{=0A=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20column=20=3D=20columns[j];=0A=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20var=20innerEntryValue=20=3D=20=
entries[i][column];=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
entryRow.push(innerEntryValue);=0A=20=20=20=20=20=20=20=20=20=20=20=20}=0A=
=20=20=20=20=20=20=20=20=20=20=20=20entryList.push(entryRow);=0A=20=20=20=
=20=20=20=20=20}=0A=0A=0A=20=20=20=20=20=20=20=20return=20{=0A=20=20=20=20=
=20=20=20=20=20=20=20=20columns:=20columns,=0A=20=20=20=20=20=20=20=20=20=
=20=20=20entryList:=20entryList=0A=20=20=20=20=20=20=20=20};=0A=20=20=20=20=
}=0A=0A=20=20=20=20function=20convertFromEntryListToJSON(entryList)=20{=0A=
=20=20=20=20=20=20=20=20var=20columns=20=3D=20entryList.return.columns;=0A=
=20=20=20=20=20=20=20=20var=20entries=20=3D=20=
entryList.return.entryList;=0A=0A=20=20=20=20=20=20=20=20if=20(!entries)=20=
{=0A=20=20=20=20=20=20=20=20=20=20=20=20return=20[];=0A=20=20=20=20=20=20=
=20=20}=0A=0A=20=20=20=20=20=20=20=20//=20if=20there=20is=20only=20=
single=20column=20in=20columns=20then=20columns=20will=20be=20parsed=20=
as=20string=20instead=20of=20array=0A=20=20=20=20=20=20=20=20//=20the=20=
algorithm=20requires=20columns=20to=20be=20array=0A=20=20=20=20=20=20=20=20=
if=20(columns=20&&=20!Array.isArray(columns))=20{=0A=20=20=20=20=20=20=20=
=20=20=20=20=20columns=20=3D=20[columns];=0A=20=20=20=20=20=20=20=20=20=20=
=20=20for=20(var=20k=20=3D=200;=20k=20<=20entries.length;=20k++)=20{=0A=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20entries[k].entry=20=3D=20=
[entries[k].entry];=0A=20=20=20=20=20=20=20=20=20=20=20=20}=0A=20=20=20=20=
=20=20=20=20}=0A=0A=20=20=20=20=20=20=20=20var=20entriesArray=20=3D=20=
[];=0A=20=20=20=20=20=20=20=20for=20(var=20i=20=3D=200;=20i=20<=20=
entries.length;=20i++)=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20var=20=
newEntry=20=3D=20{};=0A=20=20=20=20=20=20=20=20=20=20=20=20for=20(var=20=
columnIdx=20=3D=200;=20columnIdx=20<=20columns.length;=20columnIdx++)=20=
{=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20var=20column=20=3D=20=
columns[columnIdx];=0A=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
var=20innerEntry=20=3D=20entries[i].entry[columnIdx];=0A=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20newEntry[column]=20=3D=20innerEntry;=0A=20=20=
=20=20=20=20=20=20=20=20=20=20}=0A=0A=20=20=20=20=20=20=20=20=20=20=20=20=
entriesArray.push(newEntry);=0A=20=20=20=20=20=20=20=20}=0A=0A=20=20=20=20=
=20=20=20=20return=20entriesArray;=0A=20=20=20=20}=0A=0A=0A=20=20=20=20=
var=20addEntriesTemplate=20=3D=20'<?xml=20version=3D"1.0"=20=
encoding=3D"UTF-8"?><soapenv:Envelope=20=
xmlns:soapenv=3D"http://schemas.xmlsoap.org/soap/envelope/"=20=
xmlns:act=3D"http://ws.v1.service.resource.manager.product.arcsight.com/ac=
tiveListService/"=20=
xmlns:xsd=3D"http://activelist.model.v1.service.resource.manager.product.a=
rcsight.com/xsd"><soapenv:Header=20=
/><soapenv:Body><act:addEntries><act:authToken>%authToken%</act:authToken>=
<act:resourceId>%resourceId%</act:resourceId><act:entryList>%entryList%</a=
ct:entryList></act:addEntries></soapenv:Body></soapenv:Envelope>';=0A=0A=20=
=20=20=20function=20addEntries()=20{=0A=20=20=20=20=20=20=20=20var=20=
entries;=0A=20=20=20=20=20=20=20=20if=20(typeof=20args.entries=20=3D=3D=3D=
=20'string')=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20try=20{=0A=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20entries=20=3D=20=
JSON.parse(args.entries);=0A=20=20=20=20=20=20=20=20=20=20=20=20}=20=
catch=20(err)=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
throw=20'entries=20must=20be=20in=20JSON=20format.=20Must=20be=20array=20=
of=20objects.'=0A=20=20=20=20=20=20=20=20=20=20=20=20}=0A=20=20=20=20=20=20=
=20=20}=0A=20=20=20=20=20=20=20=20var=20entryList=20=3D=20=
convertCsvToEntryListObject(entries)=0A=20=20=20=20=20=20=20=20var=20=
stringBuilder=20=3D=20[];=0A=20=20=20=20=20=20=20=20=
entryList.columns.forEach(function(column)=20{=0A=20=20=20=20=20=20=20=20=
=20=20=20=20=
stringBuilder.push(replaceInTemplates('<columns>%column%</columns>',=20{=0A=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20column:=20column=0A=20=20=
=20=20=20=20=20=20=20=20=20=20}));=0A=20=20=20=20=20=20=20=20});=0A=0A=20=
=20=20=20=20=20=20=20entryList.entryList.forEach(function(entryRow)=20{=0A=
=20=20=20=20=20=20=20=20=20=20=20=20stringBuilder.push('<entryList>');=0A=
=20=20=20=20=20=20=20=20=20=20=20=20entryRow.forEach(function(entry)=20{=0A=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
stringBuilder.push(replaceInTemplates('<entry>%entry%</entry>',=20{=0A=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20entry:=20entry=0A=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20}));=0A=20=20=20=20=20=20=
=20=20=20=20=20=20})=0A=20=20=20=20=20=20=20=20=20=20=20=20=
stringBuilder.push('</entryList>');=0A=20=20=20=20=20=20=20=20});=0A=0A=20=
=20=20=20=20=20=20=20var=20entryListXml=20=3D=20stringBuilder.join('');=0A=
=20=20=20=20=20=20=20=20var=20soapReq=20=3D=20=
replaceInTemplates(addEntriesTemplate,=20{=0A=20=20=20=20=20=20=20=20=20=20=
=20=20authToken:=20args.authToken,=0A=20=20=20=20=20=20=20=20=20=20=20=20=
resourceId:=20args.resourceId,=0A=20=20=20=20=20=20=20=20=20=20=20=20=
entryList:=20entryListXml=0A=20=20=20=20=20=20=20=20});=0A=20=20=20=20=20=
=20=20=20=
sendSOAPRequest('www/manager-service/services/ActiveListService/',=20=
null,=20soapReq);=0A=20=20=20=20=20=20=20=20return=20'Success';=0A=20=20=20=
=20}=0A=0A=20=20=20=20var=20clearEntriesTemplate=20=3D=20=
'<soapenv:Envelope=20=
xmlns:soapenv=3D"http://schemas.xmlsoap.org/soap/envelope/"=20=
xmlns:act=3D"http://ws.v1.service.resource.manager.product.arcsight.com/ac=
tiveListService/"><soapenv:Header/><soapenv:Body><act:clearEntries><act:au=
thToken>%authToken%</act:authToken><act:resourceId>%resourceId%</act:resou=
rceId></act:clearEntries></soapenv:Body></soapenv:Envelope>';=0A=0A=20=20=
=20=20function=20clearEntries()=20{=0A=20=20=20=20=20=20=20=20var=20=
soapReq=20=3D=20replaceInTemplates(clearEntriesTemplate,=20{=0A=20=20=20=20=
=20=20=20=20=20=20=20=20authToken:=20args.authToken,=0A=20=20=20=20=20=20=
=20=20=20=20=20=20resourceId:=20args.resourceId=0A=20=20=20=20=20=20=20=20=
});=0A=20=20=20=20=20=20=20=20var=20res=20=3D=20=
sendSOAPRequest('www/manager-service/services/ActiveListService/',=20=
null,=20soapReq);=0A=20=20=20=20=20=20=20=20return=20'Success';=0A=20=20=20=
=20}=0A=0A=20=20=20=20var=20getEntriesTemplate=20=3D=20=
'<soapenv:Envelope=20=
xmlns:soapenv=3D"http://schemas.xmlsoap.org/soap/envelope/"=20=
xmlns:act=3D"http://ws.v1.service.resource.manager.product.arcsight.com/ac=
tiveListService/">\=0A=20=20=20=20<soapenv:Header/>\=0A=20=20=20=20=
<soapenv:Body>\=0A=20=20=20=20<act:getEntries>\=0A=20=20=20=20=
<act:authToken>%authToken%</act:authToken>\=0A=20=20=20=20=
<act:resourceId>%resourceId%</act:resourceId>\=0A=20=20=20=20=
</act:getEntries>\=0A=20=20=20=20</soapenv:Body>\=0A=20=20=20=20=
</soapenv:Envelope>';=0A=0A=20=20=20=20function=20getEntries()=20{=0A=20=20=
=20=20=20=20=20=20var=20soapReq=20=3D=20=
replaceInTemplates(getEntriesTemplate,=20{=0A=20=20=20=20=20=20=20=20=20=20=
=20=20authToken:=20args.authToken,=0A=20=20=20=20=20=20=20=20=20=20=20=20=
resourceId:=20args.resourceId=0A=20=20=20=20=20=20=20=20});=0A=20=20=20=20=
=20=20=20=20var=20res=20=3D=20=
sendSOAPRequest('www/manager-service/services/ActiveListService/',=20=
null,=20soapReq);=0A=0A=20=20=20=20=20=20=20=20var=20parsedResponse=20=3D=20=
parseSOAPResponse(res.Body);=0A=20=20=20=20=20=20=20=20var=20entryArray=20=
=3D=20convertFromEntryListToJSON(parsedResponse);=0A=0A=20=20=20=20=20=20=
=20=20//=20get=20the=20column=20headers=20which=20exists=20in=20Active=20=
List=0A=20=20=20=20=20=20=20=20var=20columns=20=3D=20dq(parsedResponse,=20=
'return.columns');=0A=20=20=20=20=20=20=20=20if=20(columns=20&&=20=
!Array.isArray(columns))=20{=0A=20=20=20=20=20=20=20=20=20=20columns=20=3D=
=20[columns];=0A=20=20=20=20=20=20=20=20}=0A=0A=20=20=20=20=20=20=20=20=
if=20(args.entryFilter)=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20var=20=
filteredEntries=20=3D=20[];=0A=20=20=20=20=20=20=20=20=20=20=20=20var=20=
conditions=20=3D=20args.entryFilter.split(':');=0A=20=20=20=20=20=20=20=20=
=20=20=20=20var=20conditionKey=20=3D=20conditions[0];=20//=20moo=0A=20=20=
=20=20=20=20=20=20=20=20=20=20var=20conditionValue=20=3D=20=
conditions[1];=20//=20moo1=0A=0A=20=20=20=20=20=20=20=20=20=20=20=20for=20=
(var=20i=20=3D=200;=20i=20<=20entryArray.length;=20i++)=20{=0A=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20var=20entry=20=3D=20entryArray[i];=0A=
=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20if=20=
(entry[conditionKey]=20=3D=3D=3D=20conditionValue)=20{=0A=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20filteredEntries.push(entry);=0A=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20}=0A=20=20=20=20=20=20=20=
=20=20=20=20=20}=0A=20=20=20=20=20=20=20=20=20=20=20=20entryArray=20=3D=20=
filteredEntries;=0A=20=20=20=20=20=20=20=20}=0A=0A=20=20=20=20=20=20=20=20=
var=20entryContext=20=3D=20{};=0A=20=20=20=20=20=20=20=20=
entryContext['ArcSightESM.ActiveList.'=20+=20args.resourceId]=20=3D=20=
entryArray;=0A=20=20=20=20=20=20=20=20return=20[=0A=20=20=20=20=20=20=20=20=
=20=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20Type:=20=
entryTypes.note,=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
ContentsFormat:=20formats.json,=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20Contents:=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
columns:=20columns=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20},=0A=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20ReadableContentsFormat:=20=
formats.markdown,=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
HumanReadable:=20columns=20?=20arrayToMarkdownTable(columns,=20=
'Columns')=20:=20'Active=20list=20has=20no=20columns'=0A=20=20=20=20=20=20=
=20=20=20=20},=0A=20=20=20=20=20=20=20=20=20=20{=0A=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20Type:=20entryTypes.note,=0A=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20ContentsFormat:=20formats.json,=0A=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20Contents:=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20result:=20entryArray=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20},=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
ReadableContentsFormat:=20formats.markdown,=0A=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20HumanReadable:=20(!entryArray=20||=20entryArray.length)=20=
?=20tableToMarkdown('Active=20List=20Entries:=20'=20+=20args.resourceId,=20=
entryArray)=20:=20'Active=20List=20has=20no=20entries',=0A=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20EntryContext:=20entryContext=0A=20=20=20=20=20=
=20=20=20=20=20}=0A=20=20=20=20=20=20=20=20];=0A=20=20=20=20}=0A=0A=0A=20=
=20=20=20function=20getCaseEventIDs()=20{=0A=20=20=20=20=20=20=20=20var=20=
json=20=3D=20=
JSON.parse(sendRequest(pathDictionary['as-get-case-event-ids'],=20=
args));=0A=20=20=20=20=20=20=20=20if=20(!json=20||=20=
!json['cas.getCaseEventIDsResponse']=20||=20=
!json['cas.getCaseEventIDsResponse']['cas.return'])=20{=0A=20=20=20=20=20=
=20=20=20=20=20=20=20return=20null;=0A=20=20=20=20=20=20=20=20}=0A=0A=20=20=
=20=20=20=20=20=20var=20eventIds=20=3D=20=
json['cas.getCaseEventIDsResponse']['cas.return'];=0A=20=20=20=20=20=20=20=
=20if=20(!eventIds)=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20//=20case=20=
has=20no=20events=0A=20=20=20=20=20=20=20=20=20=20=20=20return=20null;=0A=
=20=20=20=20=20=20=20=20}=0A=0A=20=20=20=20=20=20=20=20if=20=
(!Array.isArray(eventIds))=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20=
eventIds=20=3D=20[eventIds];=0A=20=20=20=20=20=20=20=20}=0A=20=20=20=20=20=
=20=20=20var=20entryContext=20=3D=20{};=0A=20=20=20=20=20=20=20=20=
entryContext['ArcSightESM.CaseEvents']=20=3D=20eventIds;=0A=20=20=20=20=20=
=20=20=20return=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20Type:=20=
entryTypes.note,=0A=20=20=20=20=20=20=20=20=20=20=20=20ContentsFormat:=20=
formats.json,=0A=20=20=20=20=20=20=20=20=20=20=20=20Contents:=20json,=0A=20=
=20=20=20=20=20=20=20=20=20=20=20ReadableContentsFormat:=20=
formats.markdown,=0A=20=20=20=20=20=20=20=20=20=20=20=20HumanReadable:=20=
arrayToMarkdownTable(eventIds,=20'Case=20'=20+=20args.caseId=20+=20'=20=
Event=20IDs'),=0A=20=20=20=20=20=20=20=20=20=20=20=20EntryContext:=20=
entryContext=0A=20=20=20=20=20=20=20=20};=0A=20=20=20=20}=0A=0A=20=20=20=20=
function=20updateCase()=20{=0A=20=20=20=20=20=20=20=20var=20currentCase=20=
=3D=20getCaseRequest(args.authToken,=20args.caseId);=0A=20=20=20=20=20=20=
=20=20if=20(!currentCase)=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20=
throw=20'There=20is=20no=20such=20case:=20'=20+=20args.caseId;=0A=20=20=20=
=20=20=20=20=20}=0A=0A=20=20=20=20=20=20=20=20var=20updatedCase=20=3D=20=
currentCase;=0A=20=20=20=20=20=20=20=20updatedCase.stage=20=3D=20=
args.stage;=0A=20=20=20=20=20=20=20=20var=20soapReq=20=3D=20{=0A=20=20=20=
=20=20=20=20=20=20=20=20=20'cas.update':=20{=0A=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20'cas.authToken':=20args.authToken,=0A=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20'cas.resource':=20updatedCase=0A=20=20=20=
=20=20=20=20=20=20=20=20=20}=0A=20=20=20=20=20=20=20=20};=0A=0A=20=20=20=20=
=20=20=20=20logDebug('ArcSight:=20updateCase:=20sending=20POST=20=
request.=20soapReq=3D'=20+=20JSON.stringify(updatedCase));=0A=20=20=20=20=
=20=20=20=20try=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20var=20res=20=3D=20=
postRestRequest('www/manager-service/rest/CaseService/update',=20null,=20=
soapReq);=0A=20=20=20=20=20=20=20=20}=20catch=20(err)=20{=0A=20=20=20=20=20=
=20=20=20=20=20=20=20throw=20'soapReq:=20'=20+=20soapReq=20+=20'\n'=20+=20=
err;=0A=20=20=20=20=20=20=20=20}=0A=20=20=20=20=20=20=20=20=
logDebug('ArcSight:=20updateCase:=20got=20POST=20request=20');=0A=20=20=20=
=20=20=20=20=20//=20creating=20human=20readable=20table=0A=20=20=20=20=20=
=20=20=20var=20response=20=3D=20JSON.parse(res.Body);=0A=0A=20=20=20=20=20=
=20=20=20if=20(!response=20||=20!response['cas.updateResponse']=20||=20=
!response['cas.updateResponse']['cas.return'])=20{=0A=20=20=20=20=20=20=20=
=20=20=20=20=20return=20null;=0A=20=20=20=20=20=20=20=20}=0A=0A=20=20=20=20=
=20=20=20=20var=20responseUpdatedCase=20=3D=20=
response['cas.updateResponse']['cas.return'];=0A=20=20=20=20=20=20=20=20=
var=20entryContext=20=3D=20{};=0A=20=20=20=20=20=20=20=20=
entryContext['ArcSightESM.Cases(val.resourceid=3D=3D=3Dobj.resourceid)']=20=
=3D=20responseUpdatedCase;=0A=20=20=20=20=20=20=20=20return=20{=0A=20=20=20=
=20=20=20=20=20=20=20=20=20Type:=20entryTypes.note,=0A=20=20=20=20=20=20=20=
=20=20=20=20=20ContentsFormat:=20formats.json,=0A=20=20=20=20=20=20=20=20=
=20=20=20=20Contents:=20responseUpdatedCase,=0A=20=20=20=20=20=20=20=20=20=
=20=20=20ReadableContensFormat:=20formats.markdown,=0A=20=20=20=20=20=20=20=
=20=20=20=20=20HumanReadable:=20tableToMarkdown('Case=20'=20+=20=
args.caseId,=20convertByMap(responseUpdatedCase,=20{=0A=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20'Name':=20'name',=0A=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20'EventIDs':=20'eventIDs',=0A=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20'Action':=20'action',=0A=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20'Stage':=20'stage',=0A=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20'CaseID':=20'resourceid',=0A=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20'CreatedTime':=20'createdTimestamp=3DDate(val)'=0A=
=20=20=20=20=20=20=20=20=20=20=20=20})),=0A=20=20=20=20=20=20=20=20=20=20=
=20=20EntryContext:=20entryContext=0A=20=20=20=20=20=20=20=20};=0A=20=20=20=
=20}=0A=0A=20=20=20=20function=20deleteCase()=20{=0A=20=20=20=20=20=20=20=
=20var=20reqBody=20=3D=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20=
'cas.deleteByUUID':=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
'cas.authToken':=20args.authToken,=0A=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20'cas.id':=20args.caseId=0A=20=20=20=20=20=20=20=20=20=20=20=20=
}=0A=20=20=20=20=20=20=20=20};=0A=0A=20=20=20=20=20=20=20=20try=20{=0A=20=
=20=20=20=20=20=20=20=20=20=20=20var=20res=20=3D=20=
postRestRequest('www/manager-service/rest/CaseService/deleteByUUID',=20=
null,=20reqBody);=0A=20=20=20=20=20=20=20=20}=20catch=20(err)=20{=0A=20=20=
=20=20=20=20=20=20=20=20=20=20throw=20'soapReq:=20'=20+=20reqBody=20+=20=
'\n'=20+=20err;=0A=20=20=20=20=20=20=20=20}=0A=0A=20=20=20=20=20=20=20=20=
throw=20res;=0A=20=20=20=20}=0A=0A=20=20=20=20var=20intToIpDT=20=3D=20=
';function=20intToIP(int){=20var=20part1=20=3D=20int=20&=20255;=20var=20=
part2=20=3D=20((int=20>>=208)=20&=20255);=20var=20part3=20=3D=20((int=20=
>>=2016)=20&=20255);=20var=20part4=20=3D=20((int=20>>=2024)=20&=20255);=20=
return=20part4=20+=20"."=20+=20part3=20+=20"."=20+=20part2=20+=20"."=20+=20=
part1;=20};';=0A=0A=0A=20=20=20=20function=20getSecurityEvents()=20{=0A=20=
=20=20=20=20=20=20=20var=20events=20=3D=20=
getSecurityEventsRequest(args.authToken,=20args.ids,=20args.startDate,=20=
args.endDate);=0A=20=20=20=20=20=20=20=20var=20hr=20=3D=20'No=20events=20=
found';=0A=20=20=20=20=20=20=20=20if=20(events)=20{=0A=20=20=20=20=20=20=20=
=20=20=20=20=20hr=20=3D=20tableToMarkdown('Security=20Event:=20'=20+=20=
args.ids,=20convertByMap(events,=20eventTranslateMap))=0A=20=20=20=20=20=20=
=20=20}=0A=0A=20=20=20=20=20=20=20=20var=20entryContext=20=3D=20{};=0A=20=
=20=20=20=20=20=20=20=
entryContext['ArcSightESM.SecurityEvents(val.eventId=3D=3D=3Dobj.eventId)'=
]=20=3D=20events;=0A=20=20=20=20=20=20=20=20return=20{=0A=20=20=20=20=20=20=
=20=20=20=20=20=20Type:=20entryTypes.note,=0A=20=20=20=20=20=20=20=20=20=20=
=20=20ContentsFormat:=20formats.json,=0A=20=20=20=20=20=20=20=20=20=20=20=
=20Contents:=20{=20events:=20events=20},=0A=20=20=20=20=20=20=20=20=20=20=
=20=20ReadableContentsFormat:=20formats.markdown,=0A=20=20=20=20=20=20=20=
=20=20=20=20=20HumanReadable:=20hr,=0A=20=20=20=20=20=20=20=20=20=20=20=20=
EntryContext:=20entryContext=0A=20=20=20=20=20=20=20=20};=0A=20=20=20=20=
}=0A=0A=20=20=20=20function=20getSecurityEventsRequest(authToken,=20ids,=20=
startDate,=20endDate)=20{=0A=20=20=20=20=20=20=20=20var=20startMillis=20=
=3D=20-1;=0A=20=20=20=20=20=20=20=20if=20(startDate)=20{=0A=20=20=20=20=20=
=20=20=20=20=20=20=20if=20(isNaN(Date.parse(startDate)))=20{=0A=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20throw=20'startDate=20must=20be=20of=20=
format=20yyyy-mm-ddTHH:MM:SS.=20Example:=202015-09-22T10:00:00';=0A=20=20=
=20=20=20=20=20=20=20=20=20=20}=0A=20=20=20=20=20=20=20=20=20=20=20=20=
startMillis=20=3D=20new=20Date(startDate).getTime();=0A=20=20=20=20=20=20=
=20=20}=0A=20=20=20=20=20=20=20=20var=20endMillis=20=3D=20-1;=0A=20=20=20=
=20=20=20=20=20if=20(endDate)=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20=
if=20(isNaN(Date.parse(endDate)))=20{=0A=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20throw=20'endDate=20must=20be=20of=20format=20=
yyyy-mm-ddTHH:MM:SS.=20Example:=202015-09-22T10:00:00';=0A=20=20=20=20=20=
=20=20=20=20=20=20=20}=0A=20=20=20=20=20=20=20=20=20=20=20=20endMillis=20=
=3D=20new=20Date(endDate).getTime();=0A=20=20=20=20=20=20=20=20}=0A=0A=20=
=20=20=20=20=20=20=20var=20arrIDs=20=3D=20[];=0A=20=20=20=20=20=20=20=20=
if=20(typeof=20ids=20=3D=3D=3D=20'string')=20{=0A=20=20=20=20=20=20=20=20=
=20=20var=20split=20=3D=20ids.split(',');=0A=20=20=20=20=20=20=20=20=20=20=
for=20(var=20i=20=3D=200;=20i=20<=20split.length;=20i++)=20{=0A=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20var=20id=20=3D=20split[i];=0A=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20if=20(isNaN(id))=20{=0A=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20throw=20'id=20'=20+=20id=20+=20'=20must=20=
be=20numeric';=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20}=0A=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20arrIDs.push(parseInt(id));=0A=20=20=20=20=20=
=20=20=20=20=20}=0A=20=20=20=20=20=20=20=20}=20else=20if=20(typeof=20ids=20=
=3D=3D=3D=20'number')=20{=0A=20=20=20=20=20=20=20=20=20=20//=20ids=20=
passed=20as=20number=0A=20=20=20=20=20=20=20=20=20=20//=20so=20there=20=
only=20single=20id=0A=20=20=20=20=20=20=20=20=20=20arrIDs.push(ids);=0A=20=
=20=20=20=20=20=20=20}=0A=0A=20=20=20=20=20=20=20=20var=20soapReq=20=3D=20=
{=0A=20=20=20=20=20=20=20=20=20=20=20=20'sev.getSecurityEvents':=20{=0A=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20'sev.authToken':=20=
authToken,=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20'sev.ids':=20=
arrIDs,=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
'sev.startMillis':=20startMillis,=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20'sev.endMillis':=20endMillis=0A=20=20=20=20=20=20=20=20=20=20=20=
=20}=0A=20=20=20=20=20=20=20=20};=0A=20=20=20=20=20=20=20=20var=20res=20=
=3D=20=
postRestRequest('www/manager-service/rest/SecurityEventService/getSecurity=
Events',=20null,=20soapReq);=0A=0A=20=20=20=20=20=20=20=20//=20creating=20=
human=20readable=20table=0A=20=20=20=20=20=20=20=20var=20json=20=3D=20=
JSON.parse(res.Body);=0A=20=20=20=20=20=20=20=20if=20(!json=20||=20=
!json['sev.getSecurityEventsResponse']=20||=20=
!json['sev.getSecurityEventsResponse']['sev.return'])=20{=0A=20=20=20=20=20=
=20=20=20=20=20=20=20return=20null;=0A=20=20=20=20=20=20=20=20}=0A=0A=20=20=
=20=20=20=20=20=20var=20events=20=3D=20=
json['sev.getSecurityEventsResponse']['sev.return'];=0A=0A=20=20=20=20=20=
=20=20=20if=20(!Array.isArray(events))=20{=0A=20=20=20=20=20=20=20=20=20=20=
=20=20events=20=3D=20[events];=0A=20=20=20=20=20=20=20=20}=0A=0A=20=20=20=
=20=20=20=20=20return=20events;=0A=20=20=20=20}=0A=0A=0A=20=20=20=20var=20=
dashboardDataTemplateWithEnv=20=3D=20'<soapenv:Envelope=20=
xmlns:soapenv=3D\'http://schemas.xmlsoap.org/soap/envelope/\'=20=20=
xmlns:ns2=3D\'http://ws.v1.service.resource.manager.product.arcsight.com/d=
ashboardService/\'=20=20=
xmlns:ns5=3D\'http://model.v1.service.resource.manager.product.arcsight.co=
m/xsd\'>\=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
<soapenv:Header/>\=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
<soapenv:Body>\=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
<ns2:getDashboardIfNewer>\=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20<ns2:authToken>%authToken%</ns2:authToken>\=0A=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20<ns2:id>%monitorID%</ns2:id>\=0A=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
<ns2:currentSignature>\=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20<ns5:id>%monitorID%</ns5:id>\=0A=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
<ns5:modificationCount>%modificationCount%</ns5:modificationCount>\=0A=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
</ns2:currentSignature>\=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20</ns2:getDashboardIfNewer>\=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20</soapenv:Body>\=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
</soapenv:Envelope>';=0A=0A=20=20=20=20//=20currently=20this=20function=20=
is=20not=20works=0A=20=20=20=20function=20getDashboardData(authToken,=20=
modCount,=20monitorID)=20{=0A=20=20=20=20=20=20=20=20var=20soapReq=20=3D=20=
replaceInTemplates(dashboardDataTemplateWithEnv,=20{=0A=20=20=20=20=20=20=
=20=20=20=20=20=20authToken:=20authToken,=0A=20=20=20=20=20=20=20=20=20=20=
=20=20modificationCount:=20modCount,=0A=20=20=20=20=20=20=20=20=20=20=20=20=
monitorID:=20monitorID=0A=20=20=20=20=20=20=20=20});=0A=20=20=20=20=20=20=
=20=20//return=20soapReq;=0A=20=20=20=20=20=20=20=20var=20res=20=3D=20=
postRestRequest('www/manager-service/services/DashboardService/',=20=
null,=20soapReq);=0A=20=20=20=20=20=20=20=20return=20res.Body;=0A=20=20=20=
=20}=0A=0A=0A=20=20=20=20var=20monitorDataTemplateWithEnv=20=3D=20=
'<soapenv:Envelope=20=
xmlns:soapenv=3D\'http://schemas.xmlsoap.org/soap/envelope/\'=20=20=
xmlns:ns2=3D\'http://ws.v1.service.resource.manager.product.arcsight.com/d=
ataMonitorService/\'=20=20=
xmlns:ns5=3D\'http://model.v1.service.resource.manager.product.arcsight.co=
m/xsd\'>\=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20<soapenv:Header/>\=0A=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20<soapenv:Body>\=0A=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20<ns2:getDataMonitorIfNewer>\=0A=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=
<ns2:authToken>%authToken%</ns2:authToken>\=0A=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20<ns2:id>%monitorID%</ns2:id>\=0A=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20<ns2:currentSignature>\=0A=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20<ns5:id>%monitorID%</ns5:id>\=0A=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
<ns5:modificationCount>%modificationCount%</ns5:modificationCount>\=0A=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20</ns2:currentSignature>\=0A=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
</ns2:getDataMonitorIfNewer>\=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
</soapenv:Body>\=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
</soapenv:Envelope>';=0A=0A=20=20=20=20function=20=
getDataMonitor(authToken,=20modCount,=20monitorID)=20{=0A=20=20=20=20=20=20=
=20=20var=20soapReq=20=3D=20=
replaceInTemplates(monitorDataTemplateWithEnv,=20{=0A=20=20=20=20=20=20=20=
=20=20=20=20=20authToken:=20authToken,=0A=20=20=20=20=20=20=20=20=20=20=20=
=20modificationCount:=20modCount,=0A=20=20=20=20=20=20=20=20=20=20=20=20=
monitorID:=20monitorID=0A=20=20=20=20=20=20=20=20});=0A=20=20=20=20=20=20=
=20=20var=20res=20=3D=20=
postRestRequest('www/manager-service/services/DataMonitorService/',=20=
null,=20soapReq);=0A=20=20=20=20=20=20=20=20return=20res.Body;=0A=20=20=20=
=20}=0A=0A=20=20=20=20function=20test()=20{=0A=20=20=20=20=20=20=20=20=
var=20isFetch=20=3D=20params.isFetch;=0A=20=20=20=20=20=20=20=20if=20=
(isFetch=20&&=20!params.viewerId=20&&=20!params.casesQueryViewerId)=20{=0A=
=20=20=20=20=20=20=20=20=20=20=20=20throw=20'If=20Fetch=20incidents=20is=20=
on,=20then=20Events=20Query=20Viewer=20ID=20or=20Case=20Query=20Viewer=20=
ID=20must=20be=20passed';=0A=20=20=20=20=20=20=20=20}=0A=0A=20=20=20=20=20=
=20=20=20var=20results;=0A=20=20=20=20=20=20=20=20var=20columnHeaders=0A=20=
=20=20=20=20=20=20=20if=20(isFetch=20&&=20params.viewerId)=20{=0A=20=20=20=
=20=20=20=20=20=20=20=20=20try=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20=
=20=20=20=20results=20=3D=20getQueryViewerResultsRequest(args.authToken,=20=
params.viewerId,=20true);=0A=20=20=20=20=20=20=20=20=20=20=20=20}=20=
catch(ex)=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20throw=20=
'Make=20sure=20Events=20query=20viewer=20id=20is=20valid.\nOriginal=20=
Error:=20'=20+=20ex;=0A=20=20=20=20=20=20=20=20=20=20=20=20}=0A=20=20=20=20=
=20=20=20=20=20=20=20=20columnHeaders=20=3D=20results.columnHeaders;=0A=20=
=20=20=20=20=20=20=20=20=20=20=20if=20=
(columnHeaders.indexOf(eventsTimeField)=20=3D=3D=3D=20-1)=20{=0A=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20throw=20'Event=20Query=20in=20=
ArcSight=20must=20select=20"'=20+=20eventsTimeField=20+=20'"=20field';=0A=
=20=20=20=20=20=20=20=20=20=20=20=20}=0A=20=20=20=20=20=20=20=20=20=20=20=
=20if=20(columnHeaders.indexOf(eventIdField)=20=3D=3D=3D=20-1)=20{=0A=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20throw=20'Event=20Query=20in=20=
ArcSight=20=20must=20select=20"'=20+=20eventIdField=20+=20'"=20field';=0A=
=20=20=20=20=20=20=20=20=20=20=20=20}=0A=20=20=20=20=20=20=20=20}=0A=0A=20=
=20=20=20=20=20=20=20if=20(isFetch=20&&=20params.casesQueryViewerId)=20{=0A=
=20=20=20=20=20=20=20=20=20=20=20=20try=20{=0A=20=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20results=20=3D=20=
getQueryViewerResultsRequest(args.authToken,=20=
params.casesQueryViewerId,=20true);=0A=20=20=20=20=20=20=20=20=20=20=20=20=
}=20catch(ex)=20{=0A=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=
throw=20'Make=20sure=20Cases=20query=20viewer=20id=20is=20=
valid.\nOriginal=20Error:=20'=20+=20ex;=0A=20=20=20=20=20=20=20=20=20=20=20=
=20}=0A=20=20=20=20=20=20=20=20=20=20=20=20columnHeaders=20=3D=20=
results.columnHeaders;=0A=20=20=20=20=20=20=20=20=20=20=20=20if=20=
(columnHeaders.indexOf(casesTimeField)=20=3D=3D=3D=20-1)=20{=0A=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20throw=20'Case=20Query=20in=20=
ArcSight=20must=20select=20"'=20+=20casesTimeField=20+=20'"=20field';=0A=20=
=20=20=20=20=20=20=20=20=20=20=20}=0A=20=20=20=20=20=20=20=20=20=20=20=20=
if=20(columnHeaders.indexOf(caseIdField)=20=3D=3D=3D=20-1)=20{=0A=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20throw=20'Case=20Query=20in=20=
ArcSight=20must=20select=20"'=20+=20caseIdField=20+=20'"=20field';=0A=20=20=
=20=20=20=20=20=20=20=20=20=20}=0A=20=20=20=20=20=20=20=20}=0A=20=20=20=20=
}=0A=0A=20=20=20=20var=20result;=0A=20=20=20=20args.authToken=20=3D=20=
getToken();=0A=20=20=20=20switch=20(command)=20{=0A=20=20=20=20=20=20=20=20=
case=20'test-module':=0A=20=20=20=20=20=20=20=20=20=20=20=20test();=0A=20=
=20=20=20=20=20=20=20=20=20=20=20result=20=3D=20'ok';=0A=20=20=20=20=20=20=
=20=20=20=20=20=20break;=0A=20=20=20=20=20=20=20=20case=20=
'fetch-incidents':=0A=20=20=20=20=20=20=20=20=20=20=20=20var=20lastRun=20=
=3D=20getLastRun();=0A=20=20=20=20=20=20=20=20=20=20=20=20lastRun=20=3D=20=
lastRun=20&&=20lastRun.value=20?=20JSON.parse(lastRun.value)=20:=20{};=0A=
=20=20=20=20=20=20=20=20=20=20=20=20var=20casesIncidents=20=3D=20[];=0A=20=
=20=20=20=20=20=20=20=20=20=20=20var=20eventsIncidents=20=3D=20[];=0A=20=20=
=20=20=20=20=20=20=20=20=20=20if=20(params.casesQueryViewerId)=20{=0A=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20=20=20casesIncidents=20=3D=20=
getCasesIncidents(lastRun);=0A=20=20=20=20=20=20=20=20=20=20=20=20}=0A=20=
=20=20=20=20=20=20=20=20=20=20=20if=20(params.viewerId)=20{=0A=20=20=20=20=
=20=20=20=20=20=20=20=20=20=20=20=20eventsIncidents=20=3D=20=
getEventsIncidents(lastRun);=0A=20=20=20=20=20=20=20=20=20=20=20=20}=0A=0A=
=20=20=20=20=20=20=20=20=20=20=20=20setLastRun({=0A=20=20=20=20=20=20=20=20=
=20=20=20=20=20=20=20=20value:=20JSON.stringify(lastRun)=0A=20=20=20=20=20=
=20=20=20=20=20=20=20});=0A=20=20=20=20=20=20=20=20=20=20=20=20result=20=
=3D=20JSON.stringify(casesIncidents.concat(eventsIncidents));=0A=20=20=20=
=20=20=20=20=20=20=20=20=20break;=0A=20=20=20=20=20=20=20=20case=20=
'as-get-matrix-data':=0A=20=20=20=20=20=20=20=20=20=20=20=20result=20=3D=20=
getMatrixData();=0A=20=20=20=20=20=20=20=20=20=20=20=20break;=0A=20=20=20=
=20=20=20=20=20case=20'as-get-all-cases':=0A=20=20=20=20=20=20=20=20=20=20=
=20=20result=20=3D=20getAllCases();=0A=20=20=20=20=20=20=20=20=20=20=20=20=
break;=0A=20=20=20=20=20=20=20=20case=20'as-get-all-query-viewers':=0A=20=
=20=20=20=20=20=20=20=20=20=20=20result=20=3D=20getAllQueryViewers();=0A=20=
=20=20=20=20=20=20=20=20=20=20=20break;=0A=20=20=20=20=20=20=20=20case=20=
'as-get-case':=0A=20=20=20=20=20=20=20=20=20=20=20=20result=20=3D=20=
getCase();=0A=20=20=20=20=20=20=20=20=20=20=20=20break;=0A=20=20=20=20=20=
=20=20=20case=20'as-add-entries':=0A=20=20=20=20=20=20=20=20=20=20=20=20=
result=20=3D=20addEntries();=0A=20=20=20=20=20=20=20=20=20=20=20=20=
break;=0A=20=20=20=20=20=20=20=20case=20'as-clear-entries':=0A=20=20=20=20=
=20=20=20=20=20=20=20=20result=20=3D=20clearEntries();=0A=20=20=20=20=20=20=
=20=20=20=20=20=20break;=0A=20=20=20=20=20=20=20=20case=20=
'as-get-entries':=0A=20=20=20=20=20=20=20=20=20=20=20=20result=20=3D=20=
getEntries();=0A=20=20=20=20=20=20=20=20=20=20=20=20break;=0A=20=20=20=20=
=20=20=20=20case=20'as-get-security-events':=0A=20=20=20=20=20=20=20=20=20=
=20=20=20result=20=3D=20getSecurityEvents();=0A=20=20=20=20=20=20=20=20=20=
=20=20=20break;=0A=20=20=20=20=20=20=20=20case=20=
'as-get-case-event-ids':=0A=20=20=20=20=20=20=20=20=20=20=20=20result=20=
=3D=20getCaseEventIDs();=0A=20=20=20=20=20=20=20=20=20=20=20=20break;=0A=20=
=20=20=20=20=20=20=20case=20'as-update-case':=0A=20=20=20=20=20=20=20=20=20=
=20=20=20result=20=3D=20updateCase();=0A=20=20=20=20=20=20=20=20=20=20=20=
=20break;=0A=20=20=20=20=20=20=20=20case=20=
'as-get-all-queryviewer-cases':=0A=20=20=20=20=20=20=20=20=20=20=20=20=
result=20=3D=20getAllQueryViewerCases();=0A=20=20=20=20=20=20=20=20=20=20=
=20=20break;=0A=20=20=20=20=20=20=20=20case=20'as-case-delete':=0A=20=20=20=
=20=20=20=20=20=20=20=20=20result=20=3D=20deleteCase();=0A=20=20=20=20=20=
=20=20=20=20=20=20=20break;=0A=20=20=20=20=20=20=20=20default:=0A=20=20=20=
=20=20=20=20=20=20=20=20=20result=20=3D=20sendAndParse(command,=20=
pathDictionary[command],=20args);=0A=20=20=20=20}=0A=20=20=20=20=
logout();=0A=20=20=20=20return=20result;=0A=20=20type:=20javascript=0A=20=
=20commands:=0A=20=20-=20name:=20as-get-all-cases=0A=20=20=20=20=
arguments:=20[]=0A=20=20=20=20outputs:=0A=20=20=20=20-=20contextPath:=20=
ArcSightESM.AllCaseIDs=0A=20=20=20=20=20=20description:=20All=20cases=20=
ids=0A=20=20=20=20description:=20=
commands.server.arcsight.getallcases.description=0A=20=20-=20name:=20=
as-get-case=0A=20=20=20=20arguments:=0A=20=20=20=20-=20name:=20=
resourceId=0A=20=20=20=20=20=20required:=20true=0A=20=20=20=20=20=20=
default:=20true=0A=20=20=20=20=20=20description:=20=
commands.server.arcsight.arguments.caseid.description=0A=20=20=20=20=
outputs:=0A=20=20=20=20-=20contextPath:=20ArcSightESM.Cases.resourceid=0A=
=20=20=20=20=20=20description:=20The=20id=20of=20the=20case=0A=20=20=20=20=
-=20contextPath:=20ArcSightESM.Cases.name=0A=20=20=20=20=20=20=
description:=20Name=20of=20the=20case=0A=20=20=20=20-=20contextPath:=20=
ArcSightESM.Cases.eventIDs=0A=20=20=20=20=20=20description:=20Related=20=
base=20event=20ids=0A=20=20=20=20-=20contextPath:=20=
ArcSightESM.Cases.createdTimestamp=0A=20=20=20=20=20=20description:=20=
The=20time=20case=20created=0A=20=20=20=20description:=20=
commands.server.arcsight.getspecificcase.description=0A=20=20-=20name:=20=
as-get-matrix-data=0A=20=20=20=20arguments:=0A=20=20=20=20-=20name:=20id=0A=
=20=20=20=20=20=20required:=20true=0A=20=20=20=20=20=20default:=20true=0A=
=20=20=20=20=20=20description:=20=
commands.server.arcsight.arguments.queryid.description=0A=20=20=20=20-=20=
name:=20onlyColumns=0A=20=20=20=20=20=20auto:=20PREDEFINED=0A=20=20=20=20=
=20=20predefined:=0A=20=20=20=20=20=20-=20"true"=0A=20=20=20=20=20=20-=20=
"false"=0A=20=20=20=20=20=20defaultValue:=20"true"=0A=20=20=20=20=
description:=20commands.server.arcsight.query.description=0A=20=20-=20=
name:=20as-add-entries=0A=20=20=20=20arguments:=0A=20=20=20=20-=20name:=20=
resourceId=0A=20=20=20=20=20=20required:=20true=0A=20=20=20=20=20=20=
description:=20resource=20id=20of=20the=20Active=20list=0A=20=20=20=20-=20=
name:=20entries=0A=20=20=20=20=20=20required:=20true=0A=20=20=20=20=20=20=
description:=20'Entries=20in=20JSON=20format.=20JSON=20must=20be=20array=20=
of=20entries.=20Each=20entry=0A=20=20=20=20=20=20=20=20must=20contain=20=
the=20same=20columns=20like=20in=20the=20Active=20list.=20Example:=20[{=20=
"UserName":=0A=20=20=20=20=20=20=20=20"john",=20"IP":"19.12.13.11"},{=20=
"UserName":=20"bob",=20"IP":"22.22.22.22"}]'=0A=20=20=20=20=20=20=
isArray:=20true=0A=20=20=20=20description:=20Add=20new=20entries=20to=20=
Active=20List=0A=20=20=20=20execution:=20true=0A=20=20-=20name:=20=
as-clear-entries=0A=20=20=20=20arguments:=0A=20=20=20=20-=20name:=20=
resourceId=0A=20=20=20=20=20=20required:=20true=0A=20=20=20=20=20=20=
description:=20resource=20id=20of=20Active=20list=0A=20=20=20=20=
description:=20Clean=20all=20entries=20in=20the=20Active=20List=0A=20=20=20=
=20execution:=20true=0A=20=20-=20name:=20as-get-entries=0A=20=20=20=20=
arguments:=0A=20=20=20=20-=20name:=20resourceId=0A=20=20=20=20=20=20=
required:=20true=0A=20=20=20=20=20=20description:=20resource=20id=20of=20=
Active=20list=0A=20=20=20=20-=20name:=20entryFilter=0A=20=20=20=20=20=20=
description:=20'Filters=20the=20entries.=20Example:=20=
entryFilter=3D"moo:moo1"'=0A=20=20=20=20outputs:=0A=20=20=20=20-=20=
contextPath:=20ArcSightESM.ActiveList=0A=20=20=20=20=20=20description:=20=
Active=20List=20is=20a=20map=20of=20active=20list=20resource=20id=20=3D>=20=
active=20list=0A=20=20=20=20=20=20=20=20entries=0A=20=20=20=20=
description:=20Get=20all=20entries=20from=20Active=20List=0A=20=20-=20=
name:=20as-get-security-events=0A=20=20=20=20arguments:=0A=20=20=20=20-=20=
name:=20startDate=0A=20=20=20=20=20=20description:=20'Start=20time=20=
filter.=20Example:=202017-05-22T10:00:00'=0A=20=20=20=20-=20name:=20=
endDate=0A=20=20=20=20=20=20description:=20'End=20time=20filter.=20=
Example:=202017-05-22T10:00:00'=0A=20=20=20=20-=20name:=20ids=0A=20=20=20=
=20=20=20required:=20true=0A=20=20=20=20outputs:=0A=20=20=20=20-=20=
contextPath:=20ArcSightESM.SecurityEvents=0A=20=20=20=20=20=20=
description:=20List=20of=20security=20events=0A=20=20=20=20-=20=
contextPath:=20ArcSightESM.SecurityEvents.name=0A=20=20=20=20=20=20=
description:=20The=20name=20of=20the=20event=0A=20=20=20=20-=20=
contextPath:=20ArcSightESM.SecurityEvents.eventId=0A=20=20=20=20=20=20=
description:=20Event=20id=0A=20=20=20=20-=20contextPath:=20=
ArcSightESM.SecurityEvents.type=0A=20=20=20=20=20=20description:=20Type=20=
of=20the=20event=0A=20=20=20=20-=20contextPath:=20=
ArcSightESM.SecurityEvents.baseEventIds=0A=20=20=20=20=20=20description:=20=
Base=20event=20ids=0A=20=20=20=20-=20contextPath:=20=
ArcSightESM.SecurityEvents.startTime=0A=20=20=20=20=20=20description:=20=
Start=20time=20in=20milliseconds=0A=20=20=20=20description:=20Returns=20=
the=20security=20event=20details=0A=20=20-=20name:=20=
as-get-case-event-ids=0A=20=20=20=20arguments:=0A=20=20=20=20-=20name:=20=
caseId=0A=20=20=20=20=20=20required:=20true=0A=20=20=20=20outputs:=0A=20=20=
=20=20-=20contextPath:=20ArcSightESM.CaseEvents=0A=20=20=20=20=20=20=
description:=20Map=20of=20caseId=20=3D>=20related=20event=20ids=0A=20=20=20=
=20-=20contextPath:=20ArcSightESM.CaseEvents.LatestResult=0A=20=20=20=20=20=
=20description:=20Event=20ids=20of=20the=20last=20execution=20of=20this=20=
command=0A=20=20=20=20description:=20Returns=20all=20case=20event=20IDs=0A=
=20=20-=20name:=20as-update-case=0A=20=20=20=20arguments:=0A=20=20=20=20=
-=20name:=20caseId=0A=20=20=20=20=20=20required:=20true=0A=20=20=20=20=20=
=20description:=20The=20ID=20of=20the=20case=0A=20=20=20=20-=20name:=20=
stage=0A=20=20=20=20=20=20auto:=20PREDEFINED=0A=20=20=20=20=20=20=
predefined:=0A=20=20=20=20=20=20-=20CLOSED=0A=20=20=20=20=20=20-=20=
QUEUED=0A=20=20=20=20=20=20-=20FINAL=0A=20=20=20=20=20=20-=20FOLLOW_UP=0A=
=20=20=20=20=20=20-=20INITIAL=0A=20=20=20=20=20=20description:=20The=20=
stage=20of=20case=0A=20=20=20=20outputs:=0A=20=20=20=20-=20contextPath:=20=
ArcSightESM.Cases=0A=20=20=20=20=20=20description:=20List=20of=20cases=0A=
=20=20=20=20description:=20Updates=20a=20case=0A=20=20-=20name:=20=
as-get-all-query-viewers=0A=20=20=20=20arguments:=20[]=0A=20=20=20=20=
outputs:=0A=20=20=20=20-=20contextPath:=20ArcSightESM.AllQueryViewers=0A=20=
=20=20=20=20=20description:=20List=20of=20all=20query=20viewer=20ids=0A=20=
=20=20=20description:=20Returns=20all=20the=20query=20viewer=20ids=0A=20=20=
-=20name:=20as-case-delete=0A=20=20=20=20arguments:=0A=20=20=20=20-=20=
name:=20caseId=0A=20=20=20=20=20=20required:=20true=0A=20=20=20=20=20=20=
description:=20The=20resource=20id=20of=20the=20case=0A=20=20=20=20=
description:=20Deletes=20a=20case=0A=20=20=20=20execution:=20true=0A=20=20=
-=20name:=20as-get-all-queryviewer-cases=0A=20=20=20=20arguments:=0A=20=20=
=20=20-=20name:=20QueryViewerId=0A=20=20=20=20=20=20description:=20=
QueryViewerID=0A=20=20=20=20description:=20'Get=20all=20QueryViewer=20=
cases=20'=0A=20=20isfetch:=20true=0A=20=20runonce:=20false=0A=

--Apple-Mail=_BDE60A45-737F-4DD9-B4BB-08441E472087--