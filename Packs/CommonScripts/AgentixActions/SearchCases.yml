commonfields:
  id: SearchCases
  version: -1
display: Cortex - List Cases
name: CortexListCases
category: Data Enrichment & Threat Intelligence
description: |-
  Searches for cases based on provided filters and retrieves case data.
  Allows retrieval of detailed enriched case data when the number of cases is 10 or fewer. If the number of cases exceeds 10, do not execute the action and notify the user.
  Note: Due to a value constraint on the result size, the data returned may be partial and not reflect the complete set of matching results.
args:
  - name: case_id_list
    type: string
    description: A comma-separated list of case IDs to filter by.
    underlyingargname: case_id_list
  - name: status
    type: string
    description: |
      A comma-separated list of case statuses to filter cases by. Options: new, in_progress, resolved.
    underlyingargname: status
  - name: gte_creation_time
    description: "The start time for filtering according to case creation time. Supports free-text relative and absolute times. For example: 7 days ago, 2023-06-15T10:30:00Z, 13/8/2025."
    type: date
    underlyingargname: gte_creation_time
  - name: lte_creation_time
    description: "The end time for filtering according to case creation time. Supports free-text relative and absolute times. For example: 7 days ago, 2023-06-15T10:30:00Z, 13/8/2025."
    type: date
    underlyingargname: lte_creation_time
  - name: sort_by_creation_time
    type: string
    description: |
      Sorts returned cases by the date/time that the case was created. Options: ASC, DESC.
    underlyingargname: sort_by_creation_time
  - name: starred
    type: boolean
    description: |
      Filter cases by starred status. Options: true, false.
    underlyingargname: starred
    defaultvalue: "false"
  - name: page
    type: number
    defaultvalue: "0"
    description: Page number (for pagination). The default is 0 (the first page).
    underlyingargname: page
  - name: limit
    type: number
    defaultvalue: "100"
    description: Maximum number of cases to return per page. The default and maximum value is 100.
    underlyingargname: limit
  - name: get_enriched_case_data
    description: |
      Whether to include enriched case data (issue IDs, network artifacts, file artifacts, notes, detection time, xdr url) in the response.
      Note: Use only when the number of provided cases is 10 or fewer, otherwise do not execute the action and notify the user.
    type: boolean
    defaultvalue: false
    underlyingargname: get_enriched_case_data
  - name: case_domain
    description: |
      A comma-separated list of domains to filter by, For example: DOMAIN_SECURITY, DOMAIN_POSTURE, DOMAIN_IT, DOMAIN_HEALTH, DOMAIN_HUNTING.
    type: string
    underlyingargname: case_domain
  - name: severity
    description: |
      A comma-separated list of severity levels to filter by. Options: low, medium, high, critical.
    type: string
    underlyingargname: severity
  - name: asset_ids
    description: A comma-separated list of Asset IDs related to the case to filter by.
    type: string
    underlyingargname: asset_ids
  - name: asset_groups
    description: A comma-separated list of Asset Group IDs related to the case to filter by.
    type: string
    underlyingargname: asset_groups
  - name: hosts
    description: A comma-separated list of hosts to filter by.
    type: string
    underlyingargname: hosts
  - name: assignee
    description: |
      A comma-separated list of assignee names or emails to filter by. Note: all values must be either names or emails - mixing both in the same request is not supported. Use the special values: "assigned" - to get all cases with assignees, "unassigned" - to get cases with no assignees.
    type: string
    underlyingargname: assignee
  - name: case_name
    description: A comma-separated list of names to filter by.
    type: string
    underlyingargname: case_name
  - name: case_description
    description: A comma-separated list of descriptions to filter by.
    type: string
    underlyingargname: case_description
  - name: tag
    description: |
      A comma-separated list of tags to filter by, For example: "DOM:Security", "DOM:Posture", "DS:PANW/AI Security Posture", "DS:PANW/CAS Secret Scanner", ""DS:PANW/IoT Security", "DS:PANW/Secrets Scanner".
    type: string
    underlyingargname: tag
outputs:
  - name: Core.Case.case_id
    description: Unique ID assigned to each returned case.
    type: String
    underlyingoutputcontextpath: Core.Case.case_id
  - name: Core.Case.case_name
    description: Name of the case.
    type: String
    underlyingoutputcontextpath: Core.Case.case_name
  - name: Core.Case.creation_time
    description: Timestamp when the case was created.
    type: Number
    underlyingoutputcontextpath: Core.Case.creation_time
  - name: Core.Case.modification_time
    description: Timestamp when the case was last modified.
    type: Number
    underlyingoutputcontextpath: Core.Case.modification_time
  - name: Core.Case.status
    description: Current status of the case.
    type: String
    underlyingoutputcontextpath: Core.Case.status
  - name: Core.Case.severity
    description: Severity level of the case.
    type: String
    underlyingoutputcontextpath: Core.Case.severity
  - name: Core.Case.description
    description: Description of the case.
    type: String
    underlyingoutputcontextpath: Core.Case.description
  - name: Core.Case.assigned_user_mail
    description: Email address of the assigned user.
    type: String
    underlyingoutputcontextpath: Core.Case.assigned_user_mail
  - name: Core.Case.assigned_user_pretty_name
    description: Full name of the assigned user.
    type: String
    underlyingoutputcontextpath: Core.Case.assigned_user_pretty_name
  - name: Core.Case.issue_count
    description: Total number of issues in the case.
    type: Number
    underlyingoutputcontextpath: Core.Case.issue_count
  - name: Core.Case.host_count
    description: Number of hosts involved in the case.
    type: Number
    underlyingoutputcontextpath: Core.Case.host_count
  - name: Core.Case.resolved_timestamp
    description: Timestamp when the case was resolved.
    type: Number
    underlyingoutputcontextpath: Core.Case.resolved_timestamp
  - name: Core.Case.hosts
    description: List of hosts involved in the case.
    type: String
    underlyingoutputcontextpath: Core.Case.hosts
  - name: Core.Case.case_domain
    description: Domain associated with the case.
    type: String
    underlyingoutputcontextpath: Core.Case.case_domain
  - name: Core.Case.resolve_comment
    description: Comments added when resolving the case.
    type: String
    underlyingoutputcontextpath: Core.Case.resolve_comment
  - name: Core.Case.starred
    description: Indicates whether the case is starred.
    type: Boolean
    underlyingoutputcontextpath: Core.Case.starred
  - name: Core.Case.rule_based_score
    underlyingoutputcontextpath: Core.Case.rule_based_score
    description: The score based on rules.
    type: Number
  - name: Core.Case.manual_score
    underlyingoutputcontextpath: Core.Case.manual_score
    description: Manually assigned score.
    type: Number
  - name: Core.Case.CaseExtraData.issue_ids
    underlyingoutputcontextpath: Core.Case.CaseExtraData.issue_ids
    description: The issue IDs associated with the case.
    type: json
  - name: Core.Case.CaseExtraData.file_artifacts
    underlyingoutputcontextpath: Core.Case.CaseExtraData.file_artifacts
    description: The file artifacts associated with the case.
    type: json
  - name: Core.Case.CaseExtraData.network_artifacts
    underlyingoutputcontextpath: Core.Case.CaseExtraData.network_artifacts
    description: The network artifacts associated with the case.
    type: json
  - name: Core.Case.CaseExtraData.notes
    underlyingoutputcontextpath: Core.Case.CaseExtraData.notes
    description: The notes related to the case.
    type: String
  - name: Core.Case.CaseExtraData.detection_time
    underlyingoutputcontextpath: Core.Case.CaseExtraData.detection_time
    description: The timestamp when the first issue was detected in the case.
    type: Number
  - name: Core.Case.CaseExtraData.xdr_url
    underlyingoutputcontextpath: Core.Case.CaseExtraData.xdr_url
    description: The URL to view the case in Cortex XDR.
    type: String
  - name: Core.Case.CaseExtraData.starred_manually
    underlyingoutputcontextpath: Core.Case.CaseExtraData.starred_manually
    description: The indication of whether the case was starred manually.
    type: Boolean
  - name: Core.Case.CaseExtraData.manual_description
    underlyingoutputcontextpath: Core.Case.CaseExtraData.manual_description
    description: The description manually provided by the user.
    type: String
  - name: Core.CasesMetadata.returned_count
    description: The actual number of cases that match all filter criteria and returned in this specific response.
    type: String
    underlyingoutputcontextpath: Core.CasesMetadata.returned_count
  - name: Core.CasesMetadata.filtered_count
    description: The total number of cases in the system that match all filter criteria.
    type: String
    underlyingoutputcontextpath: Core.CasesMetadata.filtered_count

underlyingcontentitem:
  id: Cortex Core - Platform
  name: Cortex Core - Platform
  type: command
  version: -1
  command: core-get-cases
requiresuserapproval: false
marketplaces:
- platform
supportedModules:
- agentix
- xsiam
- cloud_posture
