id: EWS search-mailbox test
version: -1
name: EWS search-mailbox test
description: Deprecated. Playbook is broken.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: f37f2377-0308-4b9c-81f0-0a1b2b471c4c
    type: start
    task:
      id: f37f2377-0308-4b9c-81f0-0a1b2b471c4c
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "14"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: e01275fd-036b-4e0f-8185-039d334bced3
    type: title
    task:
      id: e01275fd-036b-4e0f-8185-039d334bced3
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    continueonerrortype: ""
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: c984a1c5-4ac3-40d2-852f-af366fbb8a1f
    type: regular
    task:
      id: c984a1c5-4ac3-40d2-852f-af366fbb8a1f
      version: -1
      name: Send Email
      script: 'EWS v2|||send-mail'
      type: regular
      iscommand: true
      brand: EWS v2
      description: Sends an email using EWS.
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      body:
        simple: 384868fafe3ef9190a8a5e59c5c195c
      from:
        simple: demistoadmin@demisto.int
      subject:
        simple: EWS search-mailbox test
      to:
        simple: demistoadmin@demisto.int
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 978964c1-17d8-43a2-8ca5-c64ce6bbdfd7
    type: regular
    task:
      id: 978964c1-17d8-43a2-8ca5-c64ce6bbdfd7
      version: -1
      name: Wait For Email
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      seconds:
        simple: "60"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 322aa042-ae0e-4a44-8bd5-0a2443b4e27f
    type: regular
    task:
      id: 322aa042-ae0e-4a44-8bd5-0a2443b4e27f
      version: -1
      name: Delete email from inbox
      script: EWS v2|||ews-delete-items
      type: regular
      iscommand: true
      brand: "EWS v2"
      description: Delete items from mailbox.
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      delete-type:
        simple: hard
      item-ids:
        simple: ${EWS.Items.itemId}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    continueonerrortype: ""
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: ed1d328d-f071-4c88-8d2c-dc08c02b6d9d
    type: regular
    task:
      id: ed1d328d-f071-4c88-8d2c-dc08c02b6d9d
      version: -1
      name: Search Item In Inbox/test
      script: '|||ews-search-mailbox'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      limit:
        simple: "1"
      query:
        simple: body:384868fafe3ef9190a8a5e59c5c195c
      folder-path:
        simple: Inbox/TEST
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: 6bae0381-b6f6-4578-87bf-9a14f0b3d06b
    type: regular
    task:
      id: 6bae0381-b6f6-4578-87bf-9a14f0b3d06b
      version: -1
      name: Wait
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      seconds:
        simple: "120"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: ccd1f742-b3db-4a8f-8d7c-c5f752d98f6a
    type: regular
    task:
      id: ccd1f742-b3db-4a8f-8d7c-c5f752d98f6a
      version: -1
      name: DeleteContext
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: 64cbb1ce-f706-4d4e-83fc-dcd165926d03
    type: regular
    task:
      id: 64cbb1ce-f706-4d4e-83fc-dcd165926d03
      version: -1
      name: Search Item In Mailbox (ews v2)
      description: Searches for items in the specified mailbox. Specific permissions are needed for this operation to search in a target mailbox other than the default.
      script: EWS v2|||ews-search-mailbox
      type: regular
      iscommand: true
      brand: EWS v2
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      limit:
        simple: "1"
      query:
        simple: body:384868fafe3ef9190a8a5e59c5c195c
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: 641af685-0ccb-42de-81d8-e42f1a1aa93a
    type: regular
    task:
      id: 641af685-0ccb-42de-81d8-e42f1a1aa93a
      version: -1
      name: Move (ews v2)
      description: Move an item to different folder in the mailbox.
      script: EWS v2|||ews-move-item
      type: regular
      iscommand: true
      brand: EWS v2
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      item-id:
        simple: ${EWS.Items.itemId}
      target-folder-path:
        simple: Inbox/Test
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: b2114585-1ef6-4e2f-81d5-a733ecc1f8bf
    type: regular
    task:
      id: b2114585-1ef6-4e2f-81d5-a733ecc1f8bf
      version: -1
      name: Delete Context
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: e8c1d094-07e6-4882-88e8-23454a6cb658
    type: regular
    task:
      id: e8c1d094-07e6-4882-88e8-23454a6cb658
      version: -1
      name: Delete Context
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "21"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: df00f64b-c3a3-4ba6-8b0e-7e160a2dae84
    type: regular
    task:
      id: df00f64b-c3a3-4ba6-8b0e-7e160a2dae84
      version: -1
      name: Search Item In sent-items
      script: '|||ews-search-mailbox'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      folder-path:
        simple: Sent Items
      limit:
        simple: "1"
      query:
        simple: body:384868fafe3ef9190a8a5e59c5c195c
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 097eb61d-086e-4cb2-8706-fb787c58360c
    type: regular
    task:
      id: 097eb61d-086e-4cb2-8706-fb787c58360c
      version: -1
      name: Delete email from sent items
      description: Delete items from mailbox.
      script: EWS v2|||ews-delete-items
      type: regular
      iscommand: true
      brand: EWS v2
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      delete-type:
        simple: hard
      item-ids:
        simple: ${EWS.Items.itemId}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2310,
        "width": 380,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
fromversion: 5.0.0
