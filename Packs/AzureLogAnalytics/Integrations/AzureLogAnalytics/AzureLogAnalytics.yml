category: Analytics & SIEM
commonfields:
  id: Azure Log Analytics
  version: -1
configuration:
- additionalinfo: Received from the authorization process or from the self-deployed configuration process (find the tenant ID in your app overview page in the Azure portal)
  display: Token / Tenant ID
  name: refresh_token
  hidden: true
  type: 4
  required: false
- displaypassword: Token / Tenant ID
  name: credentials_refresh_token
  hiddenusername: true
  type: 9
  required: false
  section: Connect
- additionalinfo: Received from the authorization process or from the self-deployed configuration process.
  display: ID / (Client ID :For client credentials flow)
  name: credentials
  type: 9
  required: false
  section: Connect
- additionalinfo: Used for certificate authentication. As appears in the "Certificates & secrets" page of the app.
  display: Certificate Thumbprint
  name: certificate_thumbprint
  hidden: true
  type: 4
  required: false
- displaypassword: Certificate Thumbprint
  name: credentials_certificate_thumbprint
  hiddenusername: true
  type: 9
  additionalinfo: Used for certificate authentication. As appears in the "Certificates & secrets" page of the app.
  required: false
  section: Connect
- additionalinfo: Used for certificate authentication. The private key of the registered certificate.
  display: Private Key
  name: private_key
  type: 14
  required: false
  section: Connect
- additionalinfo: Select this checkbox if you are using a self-deployed Azure application.
  display: Use a self-deployed Azure application
  name: self_deployed
  type: 8
  required: false
  section: Connect
- additionalinfo: Check when authenticating using the Client Credentials flow.
  display: Use Client Credentials Authorization Flow
  name: client_credentials
  type: 8
  required: false
  section: Connect
- display: Application redirect URI (for self-deployed mode)
  name: redirect_uri
  type: 0
  required: false
  section: Connect
- additionalinfo: Get the Authorization code from steps 3-5 in the self deployed authorization process.
  display: Authorization code
  name: auth_code
  type: 4
  hidden: true
  required: false
- displaypassword: Authorization code
  name: credentials_auth_code
  hiddenusername: true
  type: 9
  additionalinfo: Get the Authorization code from steps 3-5 in the self deployed authorization process.
  required: false
  section: Connect
- additionalinfo: Relevant only if the integration is running on Azure VM. If selected, authenticates based on the value provided for the Azure Managed Identities Client ID field. If no value is provided for the Azure Managed Identities Client ID field, authenticates based on the System Assigned Managed Identity. For additional information, see the Help tab.
  display: Use Azure Managed Identities
  name: use_managed_identities
  type: 8
  required: false
  section: Connect
  advanced: true
- additionalinfo: The Managed Identities client id for authentication - relevant only if the integration is running on Azure VM.
  displaypassword: Azure Managed Identities Client ID
  name: managed_identities_client_id
  hiddenusername: true
  type: 9
  required: false
  section: Connect
  advanced: true
- display: Default Subscription ID
  name: subscriptionID
  required: true
  additionalinfo: The parameter can be saved as 000-000 and added as an argument to each command, but Test button will fail.
  type: 0
  section: Connect
- display: Default Resource Group Name
  name: resourceGroupName
  required: true
  additionalinfo: The parameter can be saved as 000-000 and added as an argument to each command, but Test button will fail.
  type: 0
  section: Connect
- display: Default Workspace Name
  name: workspaceName
  required: true
  additionalinfo: The parameter can be saved as 000-000 and added as an argument to each command.
  type: 0
  section: Connect
- display: Default Workspace ID (the UUID of the workspace, e.g. 123e4567-e89b-12d3-a456-426614174000)
  name: workspaceID
  required: true
  additionalinfo: The parameter can be saved as 000-000 and added as an argument to each command, but Test button will fail.
  type: 0
  section: Connect
- display: Trust any certificate (not secure)
  name: insecure
  type: 8
  required: false
  section: Connect
  advanced: true
- display: Use system proxy settings
  name: proxy
  type: 8
  required: false
  section: Connect
  advanced: true
description: Log Analytics is a service that helps you collect and analyze data generated by resources in your cloud and on-premises environments.
display: Azure Log Analytics
name: Azure Log Analytics
script:
  commands:
  - arguments:
    - description: The query to execute.
      name: query
      required: true
    - description: The timespan over which to query data. This is an ISO8601 time period value. This timespan is applied in addition to any timespans specified in the query expression.
      name: timespan
    - defaultValue: '10'
      description: The amount of time (in seconds) that a request will wait for the query response before a timeout occurs.
      name: timeout
    - description: "The Workspace ID. Note: This argument will override the instance parameter ‘Default Workspace ID'."
      name: workspace_id
    description: Executes an Analytics query for data.
    name: azure-log-analytics-execute-query
    outputs:
    - contextPath: AzureLogAnalytics.Query.Query
      description: The executed query.
      type: String
    - contextPath: AzureLogAnalytics.Query.TableName
      description: The name of the query table.
      type: String
  - description: Tests connectivity to Azure Log Analytics.
    name: azure-log-analytics-test
  - arguments:
    - defaultValue: '50'
      description: The maximum number of saved searches to return. Default is 50.
      name: limit
    - defaultValue: '0'
      description: The page number from which to start a search.
      name: page
    - description: "The subscription ID to use. Note: This argument will override the instance parameter ‘Default Subscription ID'."
      name: subscription_id
    - description: "The name of the resource group within the user's subscription. Note: This argument will override the instance parameter ‘Default Resource Group Name'."
      name: resource_group_name
    - description: "The name of the resource group. Note: This argument will override the instance parameter ‘Default Workspace Name'."
      name: workspace_name
    description: Gets the saved searches of the Log Analytics workspace.
    name: azure-log-analytics-list-saved-searches
    outputs:
    - contextPath: AzureLogAnalytics.SavedSearch.id
      description: The ID of the saved search.
      type: String
    - contextPath: AzureLogAnalytics.SavedSearch.etag
      description: The ETag of the saved search.
      type: String
    - contextPath: AzureLogAnalytics.SavedSearch.category
      description: The category of the saved search. This helps users quickly find a saved search.
      type: String
    - contextPath: AzureLogAnalytics.SavedSearch.displayName
      description: Display name of the saved search.
      type: String
    - contextPath: AzureLogAnalytics.SavedSearch.functionAlias
      description: The function alias if the query serves as a function.
      type: String
    - contextPath: AzureLogAnalytics.SavedSearch.functionParameters
      description: 'The optional function parameters if the query serves as a function. Value should be in the following format: ''param-name1:type1 = default_value1, param-name2:type2 = default_value2''. For more examples and proper syntax please refer to https://docs.microsoft.com/en-us/azure/kusto/query/functions/user-defined-functions'
      type: String
    - contextPath: AzureLogAnalytics.SavedSearch.query
      description: The query expression for the saved search.
      type: String
    - contextPath: AzureLogAnalytics.SavedSearch.tags
      description: The tags attached to the saved search.
      type: String
    - contextPath: AzureLogAnalytics.SavedSearch.version
      description: The version number of the query language. The current version and default is 2.
      type: Number
    - contextPath: AzureLogAnalytics.SavedSearch.type
      description: The resource type, e.g., Microsoft.Compute/virtualMachines or Microsoft.Storage/storageAccounts.
      type: String
  - arguments:
    - description: The ID of the saved search.
      name: saved_search_id
      required: true
    - description: "The subscription ID to use. Note: This argument will override the instance parameter ‘Default Subscription ID'."
      name: subscription_id
    - description: "The name of the resource group within the user's subscription. Note: This argument will override the instance parameter ‘Default Resource Group Name'."
      name: resource_group_name
    - description: "The name of the resource group. Note: This argument will override the instance parameter ‘Default Workspace Name'."
      name: workspace_name
    description: Gets a specified saved search from the Log Analytics workspace.
    name: azure-log-analytics-get-saved-search-by-id
    outputs:
    - contextPath: AzureLogAnalytics.SavedSearch.id
      description: The ID of the saved search.
      type: String
    - contextPath: AzureLogAnalytics.SavedSearch.etag
      description: The ETag of the saved search.
      type: String
    - contextPath: AzureLogAnalytics.SavedSearch.category
      description: The category of the saved search. This helps users quickly find a saved search.
      type: String
    - contextPath: AzureLogAnalytics.SavedSearch.displayName
      description: The display name of the saved search.
      type: String
    - contextPath: AzureLogAnalytics.SavedSearch.functionAlias
      description: The function alias if the query serves as a function.
      type: String
    - contextPath: AzureLogAnalytics.SavedSearch.functionParameters
      description: 'The optional function parameters if the query serves as a function. Value should be in the following format: ''param-name1:type1 = default_value1, param-name2:type2 = default_value2''. For more examples and proper syntax see the Microsoft documention, https://docs.microsoft.com/en-us/azure/kusto/query/functions/user-defined-functions'
      type: String
    - contextPath: AzureLogAnalytics.SavedSearch.query
      description: The query expression for the saved search.
      type: String
    - contextPath: AzureLogAnalytics.SavedSearch.tags
      description: The tags attached to the saved search.
      type: String
    - contextPath: AzureLogAnalytics.SavedSearch.version
      description: The version number of the query language. The current version and default is 2.
      type: Number
    - contextPath: AzureLogAnalytics.SavedSearch.type
      description: The resource type, e.g., Microsoft.Compute/virtualMachines or Microsoft.Storage/storageAccounts.
      type: String
  - arguments:
    - description: The ID of the saved search.
      name: saved_search_id
      required: true
    - description: The ETag of the saved search. This argument is required for updating an existing saved search.
      name: etag
    - description: The category of the saved search. This helps users quickly find a saved search.
      name: category
      required: true
    - description: The display name of the saved search.
      name: display_name
      required: true
    - description: The function alias if the query serves as a function.
      name: function_alias
    - description: 'The optional function parameters if the query serves as a function. Value should be in the following format: ''param-name1:type1 = default_value1, param-name2:type2 = default_value2''. For more examples and proper syntax please refer to https://docs.microsoft.com/en-us/azure/kusto/query/functions/user-defined-functions.'
      name: function_parameters
    - description: The query expression for the saved search.
      name: query
      required: true
    - description: 'The tags attached to the saved search. Value should be in the following format: ''name=value;name=value'''
      name: tags
    - description: "The subscription ID to use. Note: This argument will override the instance parameter ‘Default Subscription ID'."
      name: subscription_id
    - description: "The name of the resource group within the user's subscription. Note: This argument will override the instance parameter ‘Default Resource Group Name'."
      name: resource_group_name
    - description: "The name of the resource group. Note: This argument will override the instance parameter ‘Default Workspace Name'."
      name: workspace_name
    description: Creates or updates a saved search from the Log Analytics workspace.
    name: azure-log-analytics-create-or-update-saved-search
    outputs:
    - contextPath: AzureLogAnalytics.SavedSearch.id
      description: The ID of the saved search.
      type: String
    - contextPath: AzureLogAnalytics.SavedSearch.etag
      description: The ETag of the saved search.
      type: String
    - contextPath: AzureLogAnalytics.SavedSearch.category
      description: The category of the saved search. This helps users quickly find a saved search.
      type: String
    - contextPath: AzureLogAnalytics.SavedSearch.displayName
      description: The display name of the saved search.
      type: String
    - contextPath: AzureLogAnalytics.SavedSearch.functionAlias
      description: The function alias if the query serves as a function.
      type: String
    - contextPath: AzureLogAnalytics.SavedSearch.functionParameters
      description: 'The optional function parameters if the query serves as a function. Value should be in the following format: ''param-name1:type1 = default_value1, param-name2:type2 = default_value2''. For more examples and proper syntax please refer to https://docs.microsoft.com/en-us/azure/kusto/query/functions/user-defined-functions'
      type: String
    - contextPath: AzureLogAnalytics.SavedSearch.query
      description: The query expression for the saved search.
      type: String
    - contextPath: AzureLogAnalytics.SavedSearch.tags
      description: The tags attached to the saved search.
      type: String
    - contextPath: AzureLogAnalytics.SavedSearch.version
      description: The version number of the query language. The current version and default is 2.
      type: Number
    - contextPath: AzureLogAnalytics.SavedSearch.type
      description: The resource type, e.g., Microsoft.Compute/virtualMachines or Microsoft.Storage/storageAccounts.
      type: String
  - arguments:
    - description: The ID of the saved search.
      name: saved_search_id
      required: true
    - description: "The subscription ID to use. Note: This argument will override the instance parameter ‘Default Subscription ID'."
      name: subscription_id
    - description: "The name of the resource group within the user's subscription. Note: This argument will override the instance parameter ‘Default Resource Group Name'."
      name: resource_group_name
    - description: "The name of the resource group. Note: This argument will override the instance parameter ‘Default Workspace Name'."
      name: workspace_name
    description: Deletes a specified saved search in the Log Analytics workspace.
    name: azure-log-analytics-delete-saved-search
  - description: Generate the login url used for Authorization code flow.
    name: azure-log-analytics-generate-login-url
    arguments: []
  - name: azure-log-analytics-subscriptions-list
    description: List all subscriptions for a tenant.
    outputs:
    - contextPath: AzureLogAnalytics.Subscription.authorizationSource
      description: The authorization source of the request.
      type: String
    - contextPath: AzureLogAnalytics.Subscription.displayName
      description: The subscription display name.
      type: String
    - contextPath: AzureLogAnalytics.Subscription.id
      description: The fully qualified ID for the subscription. For example, /subscriptions/8d65815f-a5b6-402f-9298-045155da7d74.
      type: String
    - contextPath: AzureLogAnalytics.Subscription.managedByTenants
      description: An array containing the tenants managing the subscription.
      type: Unknown
    - contextPath: AzureLogAnalytics.Subscription.state
      description: The subscription state. Possible values are Enabled, Warned, PastDue, Disabled, and Deleted.
      type: Unknown
    - contextPath: AzureLogAnalytics.Subscription.subscriptionId
      description: The subscription ID.
      type: String
    - contextPath: AzureLogAnalytics.Subscription.subscriptionPolicies
      description: The subscription policies.
      type: Unknown
    - contextPath: AzureLogAnalytics.Subscription.tags
      description: The tags attached to the subscription.
      type: Object
    - contextPath: AzureLogAnalytics.Subscription.tenantId
      description: The subscription tenant ID.
      type: String 
  - name: azure-log-analytics-workspace-list
    description: Gets workspaces in a resource group.
    arguments:
    - description: "The subscription ID. Note: This argument will override the instance parameter ‘Default Subscription ID'."
      name: subscription_id
    - description: "The name of the resource group within the user's subscription. Note: This argument will override the instance parameter ‘Default Resource Group Name'."
      name: resource_group_name
    outputs:
    - contextPath: AzureLogAnalytics.workspace.etag
      description: The etag of the workspace.
      type: String
    - contextPath: AzureLogAnalytics.workspace.id
      description: Fully qualified resource ID for the resource.
      type: String
    - contextPath: AzureLogAnalytics.workspace.identity.principalId
      description: The principal ID of resource identity.
      type: String
    - contextPath: AzureLogAnalytics.workspace.identity.tenantId
      description: The tenant ID of resource.
      type: String
    - contextPath: AzureLogAnalytics.workspace.identity.type
      description: Type of managed service identity.
      type: String
    - contextPath: AzureLogAnalytics.workspace.identity.userAssignedIdentities.clientId
      description: The client id of user assigned identity.
      type: String
    - contextPath: AzureLogAnalytics.workspace.identity.userAssignedIdentities.principalId
      description: The principal id of user assigned identity.
      type: String
    - contextPath: AzureLogAnalytics.workspace.location
      description: The geo-location where the resource lives.
      type: String
    - contextPath: AzureLogAnalytics.workspace.name
      description: The name of the resource.
      type: String
    - contextPath: AzureLogAnalytics.workspace.properties.createdDate
      description: Workspace creation date.
      type: String
    - contextPath: AzureLogAnalytics.workspace.properties.customerId
      description: This is a read-only property. Represents the ID associated with the workspace.
      type: String
    - contextPath: AzureLogAnalytics.workspace.properties.defaultDataCollectionRuleResourceId
      description: The resource ID of the default Data Collection Rule to use for this workspace.
      type: String
    - contextPath: AzureLogAnalytics.workspace.properties.features.clusterResourceId
      description: Dedicated LA cluster resourceId that is linked to the workspaces.
      type: String
    - contextPath: AzureLogAnalytics.workspace.properties.features.disableLocalAuth
      description: Disable Non-AAD based Auth.
      type: Boolean
    - contextPath: AzureLogAnalytics.workspace.properties.features.enableDataExport
      description: Flag that indicate if data should be exported.
      type: Boolean
    - contextPath: AzureLogAnalytics.workspace.properties.features.enableLogAccessUsingOnlyResourcePermissions
      description: Flag that indicate which permission to use - resource or workspace or both.
      type: Boolean
    - contextPath: AzureLogAnalytics.workspace.properties.features.immediatePurgeDataOn30Days
      description: Flag that describes if we want to remove the data after 30 days.
      type: Boolean
    - contextPath: AzureLogAnalytics.workspace.properties.forceCmkForQuery
      description: Indicates whether customer managed storage is mandatory for query management.
      type: Boolean
    - contextPath: AzureLogAnalytics.workspace.properties.modifiedDate
      description: Workspace modification date.
      type: String
    - contextPath: AzureLogAnalytics.workspace.properties.privateLinkScopedResources.resourceId
      description: The full resource Id of the private link scope resource.
      type: String
    - contextPath: AzureLogAnalytics.workspace.properties.privateLinkScopedResources.scopeId
      description: The private link scope unique Identifier.
      type: String
    - contextPath: AzureLogAnalytics.workspace.properties.provisioningState
      description: The provisioning state of the workspace.
      type: String
    - contextPath: AzureLogAnalytics.workspace.properties.publicNetworkAccessForIngestion
      description: The network access type for accessing Log Analytics ingestion.
      type: String
    - contextPath: AzureLogAnalytics.workspace.properties.publicNetworkAccessForQuery
      description: The network access type for accessing Log Analytics query.
      type: String
    - contextPath: AzureLogAnalytics.workspace.properties.retentionInDays
      description: The workspace data retention in days. Allowed values are per pricing plan. See pricing tiers documentation for details.
      type: Number
    - contextPath: AzureLogAnalytics.workspace.properties.sku.capacityReservationLevel
      description: The capacity reservation level in GB for this workspace, when CapacityReservation sku is selected.
      type: Number
    - contextPath: AzureLogAnalytics.workspace.properties.sku.lastSkuUpdate
      description: lastSkuUpdate
      type: String
    - contextPath: AzureLogAnalytics.workspace.properties.sku.name
      description: The name of the SKU.
      type: String
    - contextPath: AzureLogAnalytics.workspace.properties.workspaceCapping.dailyQuotaGb
      description: The workspace daily quota for ingestion.
      type: Number
    - contextPath: AzureLogAnalytics.workspace.properties.workspaceCapping.dataIngestionStatus
      description: The status of data ingestion for this workspace.
      type: String
    - contextPath: AzureLogAnalytics.workspace.properties.workspaceCapping.quotaNextResetTime
      description: The time when the quota will be rest.
      type: String
    - contextPath: AzureLogAnalytics.workspace.systemData.createdAt
      description: The timestamp of resource creation (UTC).
      type: String
    - contextPath: AzureLogAnalytics.workspace.systemData.createdBy
      description: The identity that created the resource.
      type: String
    - contextPath: AzureLogAnalytics.workspace.systemData.createdByType
      description: The type of identity that created the resource.
      type: String
    - contextPath: AzureLogAnalytics.workspace.systemData.lastModifiedAt
      description: The timestamp of resource last modification (UTC).
      type: String
    - contextPath: AzureLogAnalytics.workspace.systemData.lastModifiedBy
      description: The identity that last modified the resource.
      type: String
    - contextPath: AzureLogAnalytics.workspace.systemData.lastModifiedByType
      description: lastModifiedByType
      type: String
    - contextPath: AzureLogAnalytics.workspace.tags
      description: Resource tags.
      type: Object
    - contextPath: AzureLogAnalytics.workspace.type
      description: The type of the resource.
      type: String
  - name: azure-log-analytics-resource-group-list
    description: List all resource groups for a subscription.
    arguments:
    - name: subscription_id
      description: "The subscription ID. Note: This argument will override the instance parameter ‘Default Subscription ID'."
    - name: limit
      description: Limit on the number of resource groups to return.
      defaultValue: 50
    - name: tag
      description: A single tag in the form of '{"Tag Name":"Tag Value"}' to filter the list by.
    outputs:
    - contextPath: AzureLogAnalytics.ResourceGroup.id
      description: The ID of the resource group.
      type: String
    - contextPath: AzureLogAnalytics.ResourceGroup.location
      description: The location of the resource group.
      type: String
    - contextPath: AzureLogAnalytics.ResourceGroup.managedBy
      description: The ID of the resource that manages this resource group.
      type: String
    - contextPath: AzureLogAnalytics.ResourceGroup.name
      description: The name of the resource group.
      type: String
    - contextPath: AzureLogAnalytics.ResourceGroup.properties.provisioningState
      description: The provisioning state.
      type: String
    - contextPath: AzureLogAnalytics.ResourceGroup.tags
      description: The tags attached to the resource group.
      type: Object
    - contextPath: AzureLogAnalytics.ResourceGroup.type
      description: The type of the resource group.
      type: String
  - description: Run this command if for some reason you need to rerun the authentication process.
    execution: false
    name: azure-log-analytics-auth-reset
    arguments: []
  dockerimage: demisto/crypto:1.0.0.66562
  runonce: false
  script: '-'
  subtype: python3
  type: python
tests:
- No test
fromversion: 5.0.0
sectionOrder:
- Connect
- Collect
