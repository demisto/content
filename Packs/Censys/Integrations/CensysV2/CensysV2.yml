category: Data Enrichment & Threat Intelligence
commonfields:
  id: CensysV2
  version: -1
configuration:
- display: App ID
  name: credentials
  required: true
  type: 9
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: Censys is a search engine that allows computer scientists to ask questions
  about the devices and networks that compose the Internet. Driven by Internet-wide
  scanning, Censys lets researchers find specific hosts and create aggregate reports
  on how devices, websites, and certificates are configured and deployed.
display: CensysV2
name: CensysV2
script:
  commands:
  - arguments:
    - auto: PREDEFINED
      default: false
      description: The index from which to retrieve data.
      isArray: false
      name: index
      predefined:
      - Ipv4
      - certificates
      required: true
      secret: false
    - default: false
      description: The IP Address of the requested host or the SHA-256 fingerprint
        of the requested certificate.
      isArray: false
      name: query
      required: true
      secret: false
    deprecated: false
    description: Returns host information for the specified IP address or structured
      certificate data for the specified SHA-256
    execution: false
    name: censys-view
    outputs:
    - contextPath: BaseIntegration.Output
      description: '[Enter a description of the data returned in this output.]'
      type: String
  - arguments:
    - default: false
      description: Query used to search for hosts with matching attributes. Uses the
        Censys Search Language.
      isArray: false
      name: query
      required: true
      secret: false
    - default: false
      defaultValue: '50'
      description: The maximum number of hits to return in each response (minimum
        of 0, maximum of 100). Default is 50.
      isArray: false
      name: page_size
      required: false
      secret: false
    - default: false
      defaultValue: '50'
      description: The number of results to return. Default is 50.
      isArray: false
      name: limit
      required: false
      secret: false
    deprecated: false
    description: Returns previews of hosts matching a specified search query.
    execution: false
    name: censys-hosts-search
    outputs:
    - contextPath: Censys.HostSearch.autonomous_system.asn
      description: The autonomous system number (ASN) that the host is in.
      type: Number
    - contextPath: Censys.HostSearch.autonomous_system.bgp_prefix
      description: The autonomous system's CIDR.
      type: String
    - contextPath: Censys.HostSearch.autonomous_system.country_code
      description: The autonomous system's two-letter, ISO 3166-1 alpha-2 country
        code (e.g., US, CN, GB, RU).
      type: String
    - contextPath: Censys.HostSearch.autonomous_system.description
      description: A brief description of the autonomous system.
      type: String
    - contextPath: Censys.HostSearch.autonomous_system.name
      description: The friendly name of the autonomous system.
      type: String
    - contextPath: Censys.HostSearch.ip
      description: The host’s IP address.
      type: String
    - contextPath: Censys.HostSearch.location.continent
      description: The continent of the host's detected location (e.g., North America,
        Europe, Asia, South America, Africa, Oceania)
      type: String
    - contextPath: Censys.HostSearch.location.coordinates
      description: The estimated coordinates of the host's detected location.
      type: Unknown
    - contextPath: Censys.HostSearch.location.country
      description: The country of the host's detected location.
      type: String
    - contextPath: Censys.HostSearch.location.country_code
      description: The two-letter ISO 3166-1 alpha-2 country code of the host's detected
        location (e.g., US, CN, GB, RU).
      type: String
    - contextPath: Censys.HostSearch.location.registered_country
      description: The host's registered country.
      type: String
    - contextPath: Censys.HostSearch.location.registered_country_code
      description: The registered country's two-letter, ISO 3166-1 alpha-2 country
        code (e.g., US, CN, GB, RU).
      type: String
    - contextPath: Censys.HostSearch.location.timezone
      description: The IANA time zone database name of the host's detected location.
      type: String
    - contextPath: Censys.HostSearch.services.port
      description: The port the service was reached at.
      type: Number
    - contextPath: Censys.HostSearch.services.service_name
      description: The name of the service on the port. This is typically the L7 protocol
        (e.g., “HTTP”); however, in the case that a more specific HTTP-based protocol
        is found (e.g., Kubernetes or Prometheus), the field will show that. This
        field indicates where protocol-specific data will be located.
      type: String
    - contextPath: Censys.HostSearch.services.transport_protocol
      description: The transport protocol (known in OSI model as L4) used to contact
        this service (i.e., UDP or TCP).
      type: String
  - arguments:
    - default: false
      description: Query used to search for certificates with matching attributes.
        Uses the Censys Search Language.
      isArray: false
      name: query
      required: true
      secret: false
    - default: false
      defaultValue: '1'
      description: The page tp return, Default is 1
      isArray: false
      name: page
      required: false
      secret: false
    - default: false
      description: The fields to return.
      isArray: true
      name: Fields
      required: false
      secret: false
    - default: false
      defaultValue: '50'
      description: The number of results to return. Default is 50.
      isArray: false
      name: limit
      required: false
      secret: false
    deprecated: false
    description: Retruns a list of certificates that match the given query.
    execution: false
    name: censys-certificates-search
    outputs:
    - contextPath: Censys.CertificateSearch.parsed.fingerprint_sha256
      description: SHA 256 fingerprint.
      type: String
    - contextPath: Censys.CertificateSearch.parsed.issuer.organization
      type: Unknown
    - contextPath: Censys.CertificateSearch.parsed.issuer_dn
      description: Distinguished name of the entity that has signed and issued the
        certificate.
      type: String
    - contextPath: Censys.CertificateSearch.parsed.names
      description: Common names for the entity.
      type: Unknown
    - contextPath: Censys.CertificateSearch.parsed.subject_dn
      description: Distinguished name of the entity that the certificate belongs to.
      type: String
    - contextPath: Censys.CertificateSearch.parsed.validity.end
      description: Validity end date.
      type: String
    - contextPath: Censys.CertificateSearch.parsed.validity.start
      description: Validity start date.
      type: String
  dockerimage: demisto/python3:3.9.7.24076
  feed: false
  isfetch: false
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  subtype: python3
  type: python
tests:
- No tests (auto formatted)
fromversion: 6.0.0
