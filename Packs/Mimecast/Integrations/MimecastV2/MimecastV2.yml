category: Email
commonfields:
  id: MimecastV2
  version: -1
configuration:
- defaultvalue: https://api.mimecast.com
  display: BaseUrl - API url including region, For example https://eu-api.mimecast.com
  name: baseUrl
  required: true
  type: 0
- display: App ID
  name: appId
  required: true
  type: 0
- display: User Email Address (Use for auto token refresh)
  name: credentials
  type: 9
  displaypassword: Password
  required: false
- display: User Email Address (Use for auto token refresh)
  name: email
  type: 0
  hidden: true
  required: false
- display: Password
  name: password
  type: 4
  hidden: true
  required: false
- display: App Key
  name: appKey_creds
  type: 9
  displaypassword: App Key
  hiddenusername: true
  required: false
- display: App key
  name: appKey
  type: 4
  hidden: true
  required: false
- display: AccessKey
  name: accessKey
  type: 0
  required: false
- display: Secret Key
  name: secretKey_creds
  type: 9
  displaypassword: Secret Key
  hiddenusername: true
  required: false
- display: SecretKey
  name: secretKey
  type: 4
  hidden: true
  required: false
- display: Fetch incidents
  name: isFetch
  type: 8
  required: false
- display: Fetch URL incidents
  name: fetchURL
  type: 8
  hidden: true
  required: false
- display: Fetch attachment incidents
  name: fetchAttachments
  type: 8
  hidden: true
  required: false
- display: Fetch impersonation incidents
  name: fetchImpersonations
  type: 8
  hidden: true
  required: false
- additionalinfo: Fetch specific incident types. Default value is "All".
  defaultvalue: All
  display: Fetch incident types
  name: incidentsToFetch
  options:
  - All
  - Impersonation
  - Attachments
  - Url
  - Held Messages
  type: 16
  required: false
- display: Incident type
  name: incidentType
  type: 13
  required: false
- defaultvalue: '24'
  display: Hours before first fetch to retrieve incidents
  name: fetchDelta
  type: 0
  required: false
- display: Trust any certificate (not secure)
  name: new_insecure
  type: 8
  required: false
- display: Use system proxy settings
  name: proxy
  type: 8
  required: false
description: Mimecast unified email management offers cloud email services for email security, continuity and archiving emails. Please read detailed instructions in order to understand how to set the integration's parameters.
display: Mimecast v2
name: MimecastV2
script:
  commands:
  - arguments:
    - default: true
      description: The query string xml for the search using Mimecast Unified Search Experience (MUSE) - read more on https://community.mimecast.com/docs/DOC-2262, using this will override other query arguments
      name: queryXml
    - description: Search for this text in messages
      name: text
    - auto: PREDEFINED
      defaultValue: 'false'
      description: Will not execute the query, but just return the query string built
      name: dryRun
      predefined:
      - 'true'
      - 'false'
    - auto: PREDEFINED
      description: Search in specific dates only.
      name: date
      predefined:
      - today
      - yesterday
      - last_week
      - last_month
      - last_year
    - description: Search emails from date, format YYYY-MM-DDTHH:MM:SZ (e.g. 2015-09-21T23:00:00Z)
      name: dateFrom
    - description: Search emails to date, format YYYY-MM-DDTHH:MM:SZ (e.g. 2015-09-21T23:00:00Z)
      name: dateTo
    - description: Filter on messages to a specific address
      name: sentTo
    - description: Filter on messages from a specific address
      name: sentFrom
    - description: Search email by subject, will override the text argument
      name: subject
    - auto: PREDEFINED
      description: 'These are the attachment types available: optional - messages with and without attachments any - messages with any attachment documents - messages with doc, dot, docx, docm, dotx, dotm, pdf, rtf, html attachments spreadsheets - messages with xls, xlt, xlsx, xlsm, xltx, xltm, xlsb, xlam, csv attachments presentations - messages with ppt, pptx, pptm, potx, potm, ppam, ppsx, ppsm, sldx, sldm, thms, pps attachments text - messages with txt, text, html, log attachments images - messages with jpg, jpeg, png, bmp, gif, psd, tif, tiff attachments media - messages with mp3, mp4, m4a, mpg, mpeg, avi, wav, aac, wma, mov attachments zips - messages with zip, rar, cab, gz, gzip, 7z attachments none - No attachments are to be present in the results'
      name: attachmentType
      predefined:
      - optional
      - any
      - documents
      - spreadsheets
      - presentations
      - text
      - images
      - media
      - zips
      - none
    - description: Search for text in attachments
      name: attachmentText
    - description: Search email by text in body, will override the text and subject arguments
      name: body
    - description: Number of results per page to display.
      name: pageSize
    - description: Sets the result to start returning results (default 0)
      name: startRow
    - auto: PREDEFINED
      defaultValue: 'false'
      description: Defines if the search should query recently received messages that are not fully processed yet (default false). You can search by mailbox and date time across active messages
      name: active
      predefined:
      - 'true'
      - 'false'
    - name: limit
      description: The maximum number of results to return.
      defaultValue: "20"
      predefined:
      - ""
    - name: page
      description: Page number you would like to view. Each page contains page_size values. Must be used along with page_size.
      defaultValue: ""
      predefined:
      - ""
    description: Query Mimecast emails. This is an archive search command.
    name: mimecast-query
    outputs:
    - contextPath: Mimecast.Message.ID
      description: Message ID
      type: string
    - contextPath: Mimecast.Message.Subject
      description: Message subject
      type: string
    - contextPath: Mimecast.Message.Sender
      description: Message sender address
      type: string
    - contextPath: Mimecast.Message.Recipient
      description: Message recipient address
      type: string
    - contextPath: Mimecast.Message.RecievedDate
      description: Message received date
      type: date
    - contextPath: Mimecast.Message.Size
      description: The size of the message in bytes
      type: number
    - contextPath: Mimecast.Message.AttachmentCount
      description: Message attachments count
      type: number
    - contextPath: Mimecast.Message.Status
      description: Message status
      type: string
  - description: List all existing Mimecast blocked sender policies
    name: mimecast-list-blocked-sender-policies
    outputs:
    - contextPath: Mimecast.Policy.ID
      description: Policy ID
      type: string
    - contextPath: Mimecast.Policy.Sender.Address
      description: Block Sender by email address
      type: string
    - contextPath: Mimecast.Policy.Sender.Domain
      description: Block Sender by domain
      type: string
    - contextPath: Mimecast.Policy.Sender.Group
      description: Block Sender by group
      type: string
    - contextPath: Mimecast.Policy.Bidirectional
      description: Blocked policy is bidirectional or not
      type: boolean
    - contextPath: Mimecast.Policy.Receiver.Address
      description: Block emails to receiver type address
      type: string
    - contextPath: Mimecast.Policy.Receiver.Domain
      description: Block emails to receiver type domain
      type: string
    - contextPath: Mimecast.Policy.Receiver.Group
      description: Block emails to receiver type group
      type: string
    - contextPath: Mimecast.Policy.FromDate
      description: Policy validation start date
      type: date
    - contextPath: Mimecast.Policy.ToDate
      description: Policy expiration date
      type: date
    - contextPath: Mimecast.Policy.Sender.Type
      description: Block emails to sender type
      type: string
    - contextPath: Mimecast.Policy.Receiver.Type
      description: Block emails to receiver type
      type: string
  - arguments:
    - description: Filter by policy ID
      name: policyID
      required: true
    description: Get a blocked sender policy by ID
    name: mimecast-get-policy
    outputs:
    - contextPath: Mimecast.Policy.ID
      description: Policy ID
      type: string
    - contextPath: Mimecast.Policy.Sender.Address
      description: Block Sender by email address
      type: string
    - contextPath: Mimecast.Policy.Sender.Domain
      description: Block Sender by domain
      type: string
    - contextPath: Mimecast.Policy.Sender.Group
      description: Block Sender by group
      type: string
    - contextPath: Mimecast.Policy.Bidirectional
      description: Blocked policy is bidirectional or not
      type: boolean
    - contextPath: Mimecast.Policy.Receiver.Address
      description: Block emails to receiver type address
      type: string
    - contextPath: Mimecast.Policy.Receiver.Domain
      description: Block emails to receiver type domain
      type: string
    - contextPath: Mimecast.Policy.Receiver.Group
      description: Block emails to receiver type group
      type: string
    - contextPath: Mimecast.Policy.Fromdate
      description: Policy validation start date
      type: date
    - contextPath: Mimecast.Policy.Todate
      description: Policy expiration date
      type: date
  - arguments:
    - description: Policy description
      name: description
      required: true
    - auto: PREDEFINED
      defaultValue: envelope_from
      description: Addresses based on
      name: fromPart
      predefined:
      - envelope_from
      - header_from
      - both
    - auto: PREDEFINED
      description: Blocked Sender type
      name: fromType
      predefined:
      - everyone
      - internal_addresses
      - external_addresses
      - email_domain
      - profile_group
      - individual_email_address
      required: true
    - description: 'Required if fromType is one of email domain, profile group, individual email address. Expected values: If fromType is email_domain, a domain name without the @ symbol. If fromType is profile_group, the ID of the profile group. If fromType is individual_email_address, an email address.'
      name: fromValue
    - auto: PREDEFINED
      description: Receiver type
      name: toType
      predefined:
      - everyone
      - internal_addresses
      - external_addresses
      - email_domain
      - profile_group
      - address_attribute_value
      - individual_email_address
      - free_mail_domains
      - header_display_name
      required: true
    - description: 'Required if fromType is one of email domain, profile group, individual email address. Expected values: If toType is email_domain, a domain name without the @ symbol. If toType is profile_group, the ID of the profile group. If toType is individual_email_address, an email address.'
      name: toValue
    - auto: PREDEFINED
      description: 'The block option, must be one of: no_action, block_sender.'
      name: option
      predefined:
      - no_action
      - block_sender
      required: true
    description: Create a Blocked Sender Policy
    name: mimecast-create-policy
    outputs:
    - contextPath: Mimecast.Policy.ID
      description: Policy ID
      type: string
    - contextPath: Mimecast.Policy.Sender.Address
      description: Block Sender by email address
      type: string
    - contextPath: Mimecast.Policy.Sender.Domain
      description: Block Sender by domain
      type: string
    - contextPath: Mimecast.Policy.Sender.Group
      description: Block Sender by group
      type: string
    - contextPath: Mimecast.Policy.Bidirectional
      description: Blocked policy is bidirectional or not
      type: boolean
    - contextPath: Mimecast.Policy.Receiver.Address
      description: Block emails to receiver type address
      type: string
    - contextPath: Mimecast.Policy.Receiver.Domain
      description: Block emails to receiver type domain
      type: string
    - contextPath: Mimecast.Policy.Receiver.Group
      description: Block emails to receiver type group
      type: string
    - contextPath: Mimecast.Policy.Fromdate
      description: Policy validation start date
      type: date
    - contextPath: Mimecast.Policy.Todate
      description: Policy expiration date
      type: date
    - contextPath: Mimecast.Policy.Sender.Type
      description: The sender type
      type: String
    - contextPath: Mimecast.Policy.Receiver.Type
      description: The receiver type
      type: String
  - arguments:
    - description: Policy ID
      name: policyID
      required: true
    description: Delete a Blocked Sender Policy
    name: mimecast-delete-policy
    outputs:
    - contextPath: Mimecast.Policy.ID
      description: Policy ID
      type: string
  - arguments:
    - description: The email address of sender to permit or block
      name: sender
      required: true
    - description: The email address of recipient to permit or block
      name: recipient
      required: true
    - auto: PREDEFINED
      description: Choose to either "permit" (to bypass spam checks) or "block" (to reject the email)
      name: action
      predefined:
      - permit
      - block
      required: true
    - name: limit
      description: The maximum number of results to return.
      defaultValue: "20"
      predefined:
      - ""
    - name: page
      description: Page number you would like to view. Each page contains page_size values. Must be used along with page_size.
      defaultValue: ""
      predefined:
      - ""
    - name: page_size
      description: Number of results per page to display.
      defaultValue: ""
      predefined:
      - ""
    description: Permit or block a specific sender
    name: mimecast-manage-sender
    outputs:
    - contextPath: Mimecast.Managed.Sender
      description: The email address of the sender
      type: string
    - contextPath: Mimecast.Managed.Recipient
      description: The email address of the recipient
      type: string
    - contextPath: Mimecast.Managed.Action
      description: Chosen action
      type: string
    - contextPath: Mimecast.Managed.ID
      description: The Mimecast secure ID of the managed sender object.
      type: string
  - arguments:
    - description: Filter results by specific URL
      name: url
    description: Get a list of all managed URLs
    name: mimecast-list-managed-url
    outputs:
    - contextPath: Mimecast.URL.Domain
      description: The managed domain
      type: string
    - contextPath: Mimecast.URL.Disablelogclick
      description: If logging of user clicks on the URL is disabled
      type: boolean
    - contextPath: Mimecast.URL.Action
      description: Either block of permit
      type: string
    - contextPath: Mimecast.URL.Path
      description: The path of the managed URL
      type: string
    - contextPath: Mimecast.URL.matchType
      description: Either explicit - applies to the full URL or domain - applies to all URL values in the domain
      type: string
    - contextPath: Mimecast.URL.ID
      description: The Mimecast secure ID of the managed URL
      type: string
    - contextPath: Mimecast.URL.disableRewrite
      description: If rewriting of this URL in emails is disabled
      type: boolean
  - arguments:
    - description: The URL to block or permit. Do not include a fragment (#).
      name: url
      required: true
    - auto: PREDEFINED
      description: Set to "block" to block list the URL, "permit" to add to allow list.
      name: action
      predefined:
      - block
      - permit
      required: true
    - auto: PREDEFINED
      defaultValue: explicit
      description: Set to "explicit" to block or permit only instances of the full URL. Set to "domain" to block or permit any URL with the same domain
      name: matchType
      predefined:
      - explicit
      - domain
    - auto: PREDEFINED
      defaultValue: 'false'
      description: Disable rewriting of this URL in emails. Applies only if action = "permit". Default false
      name: disableRewrite
      predefined:
      - 'true'
      - 'false'
    - description: Add a comment about the managed URL
      name: comment
    - auto: PREDEFINED
      defaultValue: 'false'
      description: Disable User Awareness challenges for this URL. Applies only if action = "permit". Default false
      name: disableUserAwareness
      predefined:
      - 'true'
      - 'false'
    - auto: PREDEFINED
      defaultValue: 'false'
      description: Disable logging of user clicks on the URL. Default is false
      name: disableLogClick
      predefined:
      - 'true'
      - 'false'
    description: Create a managed URL on Mimecast
    name: mimecast-create-managed-url
    outputs:
    - contextPath: Mimecast.URL.Domain
      description: The managed domain
      type: string
    - contextPath: Mimecast.URL.Action
      description: Either block of permit
      type: string
    - contextPath: Mimecast.URL.disableLogClick
      description: If logging of user clicks on the URL is disabled
      type: string
    - contextPath: Mimecast.URL.matchType
      description: Either explicit - applies to the full URL or domain - applies to all URL values in the domain
      type: string
    - contextPath: Mimecast.URL.ID
      description: The Mimecast secure ID of the managed URL
      type: string
    - contextPath: Mimecast.URL.disableRewrite
      description: If rewriting of this URL in emails is disabled
      type: boolean
  - arguments:
    - description: The email address to return the message list for
      name: mailbox
    - description: The start date of messages to return, in the following format, 2015-11-16T14:49:18+0000. Default is the last calendar month
      name: startTime
    - description: The end date of messages to return, in the following format, 2015-11-16T14:49:18+0000. Default is the end of the current day
      name: endTime
    - auto: PREDEFINED
      defaultValue: INBOX
      description: 'The message list type, must be one of: inbox or sent, default is inbox'
      name: view
      predefined:
      - INBOX
      - SENT
    - description: Filter by message subject
      name: subject
    - defaultValue: '100'
      description: The maximum number of results to return.
      name: limit
    - name: page
      description: Page number you would like to view. Each page contains page_size values. Must be used along with page_size.
      defaultValue: ""
      predefined:
      - ""
    - name: page_size
      description: Number of results per page to display.
      defaultValue: ""
      predefined:
      - ""
    description: Get a list of messages for a given user. This is an archive search command.
    name: mimecast-list-messages
    outputs:
    - contextPath: Mimecast.Message.Subject
      description: Message Subject
      type: string
    - contextPath: Mimecast.Message.ID
      description: Message ID
      type: string
    - contextPath: Mimecast.Message.Size
      description: The size of the message in bytes
      type: number
    - contextPath: Mimecast.Message.RecievedDate
      description: The date the message was received
      type: date
    - contextPath: Mimecast.Message.From
      description: The mail Sender
      type: string
    - contextPath: Mimecast.Message.AttachmentCount
      description: The number of attachments on the message
      type: string
  - arguments:
    - description: The number of results to request. Default is all
      name: resultsNumber
    - description: Start date of logs to return in the following format 2015-11-16T14:49:18+0000. Default is the start of the current day
      name: fromDate
    - description: End date of logs to return in the following format 2015-11-16T14:49:18+0000. Default is time of request
      name: toDate
    - auto: PREDEFINED
      defaultValue: malicious
      description: Filters logs by scan result, default is malicious
      name: resultType
      predefined:
      - safe
      - malicious
      - timeout
      - error
      - unsafe
      - all
    - defaultValue: '100'
      description: The maximum number of results to return.
      name: limit
    - name: page
      description: Page number you would like to view. Each page contains page_size values. Must be used along with page_size.
      defaultValue: ""
      predefined:
      - ""
    - name: page_size
      description: Number of results per page to display.
      defaultValue: ""
      predefined:
      - ""
    description: Returns Attachment Protect logs for a Mimecast customer account
    name: mimecast-get-attachment-logs
    outputs:
    - contextPath: Mimecast.AttachmentLog.Result
      description: 'The result of the attachment analysis: clean, malicious, unknown, or timeout'
      type: string
    - contextPath: Mimecast.AttachmentLog.Date
      description: The time at which the attachment was released from the sandbox
      type: date
    - contextPath: Mimecast.AttachmentLog.Sender
      description: The sender of the attachment
      type: string
    - contextPath: Mimecast.AttachmentLog.FileName
      description: The file name of the original attachment
      type: string
    - contextPath: Mimecast.AttachmentLog.Action
      description: The action triggered for the attachment
      type: string
    - contextPath: Mimecast.AttachmentLog.Recipient
      description: The address of the user that received the attachment
      type: string
    - contextPath: Mimecast.AttachmentLog.FileType
      description: The file type of the attachment
      type: string
    - contextPath: Mimecast.AttachmentLog.Route
      description: 'The route of the original email containing the attachment, either: inbound, outbound, internal, or external'
      type: string
  - arguments:
    - description: This parameter is ignored, use the 'limit' parameter instead.
      name: resultsNumber
    - description: Start date of logs to return in the following format 2015-11-16T14:49:18+0000. Default is the start of the current day
      name: fromDate
    - description: End date of logs to return in the following format 2015-11-16T14:49:18+0000. Default is time of request
      name: toDate
    - auto: PREDEFINED
      defaultValue: malicious
      description: Filters logs by scan result
      name: resultType
      predefined:
      - clean
      - malicious
      - all
    - defaultValue: '100'
      description: The maximum number of results to return.
      name: limit
    - name: page
      description: Page number you would like to view. Each page contains page_size values. Must be used along with page_size.
      defaultValue: ""
      predefined:
      - ""
    - name: page_size
      description: Number of results per page to display.
      defaultValue: ""
      predefined:
      - ""
    description: Returns URL protect logs for a Mimecast customer account. Default value of scanResult as malicious
    name: mimecast-get-url-logs
    outputs:
    - contextPath: Mimecast.UrlLog.Category
      description: The category of the URL clicked
      type: string
    - contextPath: Mimecast.UrlLog.UserAddress
      description: The email address of the user who clicked the link
      type: string
    - contextPath: Mimecast.UrlLog.URL
      description: The url clicked
      type: string
    - contextPath: Mimecast.UrlLog.Awareness
      description: The action taken by the user if user awareness was applied
      type: string
    - contextPath: Mimecast.UrlLog.AdminOverride
      description: The action defined by the administrator for the URL
      type: string
    - contextPath: Mimecast.UrlLog.Date
      description: The date that the URL was clicked
      type: date
    - contextPath: Mimecast.UrlLog.Result
      description: The result of the URL scan
      type: string
    - contextPath: Mimecast.UrlLog.Action
      description: The action that was taken for the click
      type: string
    - contextPath: Mimecast.UrlLog.Route
      description: 'The route of the original email containing the attachment, either: inbound, outbound, internal, or external'
      type: string
    - contextPath: Mimecast.UrlLog. userOverride
      description: The action requested by the user.
      type: string
  - arguments:
    - description: The number of results to request. Default is all
      name: resultsNumber
    - auto: PREDEFINED
      defaultValue: 'true'
      description: ' Filters for messages tagged malicious (true) or not tagged malicious (false). Omit for no tag filtering. Default is true'
      name: taggedMalicious
      predefined:
      - 'true'
      - 'false'
    - auto: PREDEFINED
      description: The field to search. Default is all (meaning all of the preceding fields)
      name: searchField
      predefined:
      - senderAddress
      - recipientAddress
      - subject
      - policy
      - all
    - description: Required if searchField exists. A character string to search for in the logs.
      name: query
    - auto: PREDEFINED
      description: Filters logs by identifiers, can include any of newly_observed_domain, internal_user_name, repy_address_mismatch, and targeted_threat_dictionary. you can choose more then one identifier separated by comma.
      isArray: true
      name: identifiers
      predefined:
      - newly_observed_domain
      - internal_user_name
      - repy_address_mismatch
      - targeted_threat_dictionary
    - description: Start date of logs to return in the following format 2015-11-16T14:49:18+0000. Default is the start of the current day
      name: fromDate
    - description: End date of logs to return in the following format 2015-11-16T14:49:18+0000. Default is time of request
      name: toDate
    - auto: PREDEFINED
      description: Filters logs by action, you can choose more then one action separated by comma.
      isArray: true
      name: actions
      predefined:
      - delete
      - hold
      - bounce
      - smart_folder
      - disable_smart_folder
      - content_expire
      - meta_expire
      - stationery
      - gcc
      - secure_delivery
      - delivery_route
      - document_policy
      - disable_document_policy
      - attach_set_policy
      - remove_email
    - defaultValue: '100'
      description: The maximum number of results to return.
      name: limit
    - name: page
      description: Page number you would like to view. Each page contains page_size values. Must be used along with page_size.
      defaultValue: ""
      predefined:
      - ""
    - name: page_size
      description: Number of results per page to display.
      defaultValue: ""
      predefined:
      - ""
    description: Returns Impersonation Protect logs for a Mimecast customer account
    name: mimecast-get-impersonation-logs
    outputs:
    - contextPath: Mimecast.Impersonation.ResultCount
      description: The total number of IMPERSONATION log lines found for the request
      type: number
    - contextPath: Mimecast.Impersonation.Hits
      description: The number of identifiers that the message triggered
      type: number
    - contextPath: Mimecast.Impersonation.Malicious
      description: Whether the message was tagged as malicious
      type: boolean
    - contextPath: Mimecast.Impersonation.SenderIP
      description: The source IP address of the message
      type: string
    - contextPath: Mimecast.Impersonation.SenderAddress
      description: The email address of the sender of the message
      type: string
    - contextPath: Mimecast.Impersonation.Subject
      description: The subject of the email
      type: string
    - contextPath: Mimecast.Impersonation.Identifiers
      description: 'The properties of the message that triggered the action: similar_internal_domain, newly_observed_domain, internal_user_name, reply_address_mismatch, and/or targeted_threat_dictionary'
      type: string
    - contextPath: Mimecast.Impersonation.Date
      description: The time at which the log was recorded
      type: date
    - contextPath: Mimecast.Impersonation.Action
      description: 'The action triggered by the email'
      type: string
    - contextPath: Mimecast.Impersonation.Policy
      description: The name of the policy definition that triggered the log
      type: string
    - contextPath: Mimecast.Impersonation.ID
      description: Impersonation Log ID
      type: string
    - contextPath: Mimecast.Impersonation.RecipientAddress
      description: The email address of the recipient of the email
      type: string
    - contextPath: Mimecast.Impersonation.External
      description: Whether the message was tagged as coming from an external address
      type: boolean
  - arguments:
    - description: URL to decode
      name: url
      required: true
    description: Decodes a given url from mimecast
    name: mimecast-url-decode
    outputs:
    - contextPath: URL.Data
      description: The encoded url to parse
      type: string
    - contextPath: URL.Mimecast.DecodedURL
      description: Parsed url
      type: string
  - description: discover authentication types that are supported for your account and which base URL to use for the requesting user.
    name: mimecast-discover
    outputs:
    - contextPath: Mimecast.Authentication.AuthenticationTypes
      description: List of authentication types available to the user
      type: string
    - contextPath: Mimecast.Authentication.EmailAddress
      description: Email address of the request sender
      type: string
    - contextPath: Mimecast.Authentication.EmailToken
      description: Email token of the request sender
      type: string
  - description: Refresh access key validity
    name: mimecast-refresh-token
  - description: Login to generate Access Key and  Secret Key
    name: mimecast-login
  - arguments:
    - description: Message ID
      name: messageID
      required: true
    - auto: PREDEFINED
      description: 'Defines which copy of the message part to return, must be one of: "delivered" the copy that has been processed by the Mimecast MTA with policies such as URL rewriting applied, OR "received" - the copy of the message that Mimecast originally received. (Only relevant for part argument = message or all)'
      name: context
      predefined:
      - DELIVERED
      - RECEIVED
      required: true
    - auto: PREDEFINED
      defaultValue: PLAIN
      description: The message type to return. (Only relevant for part argument = message or all)
      name: type
      predefined:
      - HTML
      - PLAIN
      - RFC822
      - TRANSMISSION_MESSAGE_BODY
    - auto: PREDEFINED
      defaultValue: all
      description: Define what message part to return - download message, get metadata or both.
      name: part
      predefined:
      - message
      - metadata
      - all
    description: Get the contents or metadata of a given message. This is an archive search command.
    name: mimecast-get-message
    outputs:
    - contextPath: Mimecast.Message.ID
      description: Message ID
      type: string
    - contextPath: Mimecast.Message.Subject
      description: The message subject.
      type: string
    - contextPath: Mimecast.Message.HeaderDate
      description: The date of the message as defined in the message headers.
      type: date
    - contextPath: Mimecast.Message.Size
      description: The message size.
      type: number
    - contextPath: Mimecast.Message.From
      description: Sender of the message as defined in the message header.
      type: string
    - contextPath: Mimecast.Message.To.EmailAddress
      description: Recipient of the message.
      type: string
    - contextPath: Mimecast.Message.ReplyTo
      description: The value of the Reply-To header.
      type: string
    - contextPath: Mimecast.Message.CC.EmailAddress
      description: Each CC recipient of the message.
      type: string
    - contextPath: Mimecast.Message.EnvelopeFrom
      description: Sender of the message as defined in the message envelope.
      type: string
    - contextPath: Mimecast.Message.Headers.Name
      description: Header's name.
      type: string
    - contextPath: Mimecast.Message.Headers.Values
      description: Header's value.
      type: string
    - contextPath: Mimecast.Message.Attachments.FileName
      description: Message attachment's file name.
      type: string
    - contextPath: Mimecast.Message.Attachments.SHA256
      description: Message attachment's SHA256.
      type: string
    - contextPath: Mimecast.Message.Attachments.ID
      description: Message attachment's ID.
      type: string
    - contextPath: Mimecast.Message.Attachments.Size
      description: Message attachment's file size.
      type: number
    - contextPath: Mimecast.Message.Processed
      description: The date the message was processed by Mimecast in ISO 8601 format.
      type: date
    - contextPath: Mimecast.Message.HasHtmlBody
      description: If the message has an HTML body part.
      type: boolean
    - contextPath: File.Size
      description: File Size
      type: number
    - contextPath: File.SHA1
      description: SHA1 hash of the file
      type: string
    - contextPath: File.SHA256
      description: SHA256 hash of the file
      type: string
    - contextPath: File.Name
      description: The sample name
      type: string
    - contextPath: File.SSDeep
      description: SSDeep hash of the file
      type: string
    - contextPath: File.EntryID
      description: War-Room Entry ID of the file
      type: string
    - contextPath: File.Info
      description: Basic information of the file
      type: string
    - contextPath: File.Type
      description: File type e.g., "PE"
      type: string
    - contextPath: File.MD5
      description: MD5 hash of the file
      type: string
  - arguments:
    - description: The Mimecast ID of the message attachment to return. (Can be retrieved from mimecast-get-message)
      name: attachmentID
      required: true
    description: Download attachments from a specified message. This is an archive search command.
    name: mimecast-download-attachments
    outputs:
    - contextPath: File.Size
      description: File size
      type: number
    - contextPath: File.SHA1
      description: SHA1 hash of the file
      type: string
    - contextPath: File.SHA256
      description: SHA256 hash of the file
      type: string
    - contextPath: File.Name
      description: The sample name
      type: string
    - contextPath: File.SSDeep
      description: SSDeep hash of the file
      type: string
    - contextPath: File.EntryID
      description: War-Room Entry ID of the file
      type: string
    - contextPath: File.Info
      description: Basic information of the file
      type: string
    - contextPath: File.Type
      description: File type e.g., "PE"
      type: string
    - contextPath: File.MD5
      description: MD5 hash of the file
      type: string
  - arguments:
    - description: The string to query.
      name: query_string
    - auto: PREDEFINED
      description: The group source by which to filter.
      name: query_source
      predefined:
      - cloud
      - ldap
    - description: The maximum number of results to return.
      name: limit
    description: Returns the list of groups according to the specified query.
    name: mimecast-find-groups
    outputs:
    - contextPath: Mimecast.Group.Name
      description: The name of the group.
      type: String
    - contextPath: Mimecast.Group.Source
      description: The source of the group.
      type: String
    - contextPath: Mimecast.Group.ID
      description: The Mimecast ID of the group.
      type: String
    - contextPath: Mimecast.Group.NumberOfUsers
      description: The number of members in the group.
      type: Number
    - contextPath: Mimecast.Group.ParentID
      description: The Mimecast ID of the group's parent.
      type: String
    - contextPath: Mimecast.Group.NumberOfChildGroups
      description: The number of child groups.
      type: Number
  - arguments:
    - description: The Mimecast ID of the group to return.
      name: group_id
      required: true
    - description: The maximum number of results to return.
      name: limit
    description: Returns the members list for the specified group.
    name: mimecast-get-group-members
    outputs:
    - contextPath: Mimecast.Group.Users.Name
      description: The user's display name.
      type: String
    - contextPath: Mimecast.Group.Users.EmailAddress
      description: The user's email address.
      type: String
    - contextPath: Mimecast.Group.Users.Domain
      description: The domain name of the user's email address.
      type: String
    - contextPath: Mimecast.Group.Users.Type
      description: The user type.
      type: String
    - contextPath: Mimecast.Group.Users.InternalUser
      description: Whether the user is internal.
      type: Boolean
    - contextPath: Mimecast.Group.Users.IsRemoved
      description: Whether the user is part of the group.
      type: Boolean
  - arguments:
    - description: The Mimecast ID of the group to add the user to.
      name: group_id
      required: true
    - description: The email address of the user to add to a group.
      name: email_address
    - description: A domain to add to a group.
      name: domain_address
    description: Adds a user to a group. The email_address and domain_address arguments are optional, but one of them must be supplied.
    name: mimecast-add-group-member
    outputs:
    - contextPath: Mimecast.Group.Users.EmailAddress
      description: The user's email address.
      type: String
    - contextPath: Mimecast.Group.Users.IsRemoved
      description: Whether the user is part of the group.
      type: Boolean
  - arguments:
    - description: The Mimecast ID of the group from which to remove the user.
      name: group_id
      required: true
    - description: The email address of the user to remove from the group.
      name: email_address
    - description: A domain of the user to remove from a group.
      name: domain_address
    description: Removes a user from a group. The email_address and domain_address arguments are optional, but one of them must be supplied.
    name: mimecast-remove-group-member
    outputs:
    - contextPath: Mimecast.Group.Users.EmailAddress
      description: The user's email address.
      type: String
    - contextPath: Mimecast.Group.Users.IsRemoved
      description: Whether the user part of the group.
      type: Boolean
  - arguments:
    - description: The name of the new group.
      name: group_name
      required: true
    - description: The Mimecast ID of the new group's parent. Default will be root level.
      name: parent_id
    description: Creates a new Mimecast group.
    name: mimecast-create-group
    outputs:
    - contextPath: Mimecast.Group.Name
      description: The name of the group.
      type: String
    - contextPath: Mimecast.Group.Source
      description: The source of the group.
      type: String
    - contextPath: Mimecast.Group.ID
      description: The Mimecast ID of the group.
      type: String
    - contextPath: Mimecast.Group.NumberOfUsers
      description: The number of members in the group.
      type: Number
    - contextPath: Mimecast.Group.ParentID
      description: The Mimecast ID of the group's parent.
      type: String
    - contextPath: Mimecast.Group.NumberOfChildGroups
      description: The number of child groups.
      type: Number
  - arguments:
    - description: The new name for the group.
      name: group_name
    - description: The Mimecast ID of the group to update.
      name: group_id
      required: true
    - description: The new parent group.
      name: parent_id
    description: Updates an existing Mimecast group.
    name: mimecast-update-group
    outputs:
    - contextPath: Mimecast.Group.Name
      description: The name of the group.
      type: String
    - contextPath: Mimecast.Group.ID
      description: The Mimecast ID of the group.
      type: String
    - contextPath: Mimecast.Group.ParentID
      description: The Mimecast ID of the group's parent.
      type: String
  - arguments:
    - description: The file hash or messageId value.
      name: hash_message_id
      required: true
    - description: The reason for creating the remediation incident.
      name: reason
      required: true
    - auto: PREDEFINED
      description: The message component by which to search. Default is "hash".
      name: search_by
      predefined:
      - hash
      - messageId
    - description: 'The start date of messages to remediate. Default value is the previous month. (Format: yyyy-mm-ddThh:mm:ss+0000)'
      name: start_date
    - description: 'The end date of messages to remediate. Default value is the end of the current day. (Format: yyyy-mm-ddThh:mm:ss+0000)'
      name: end_date
    description: Creates a new Mimecast remediation incident.
    name: mimecast-create-remediation-incident
    outputs:
    - contextPath: Mimecast.Incident.ID
      description: The secure Mimecast remediation ID.
      type: String
    - contextPath: Mimecast.Incident.Code
      description: The incident code generated at creation.
      type: String
    - contextPath: Mimecast.Incident.Type
      description: The incident type.
      type: String
    - contextPath: Mimecast.Incident.Reason
      description: The reason provided at the creation of the remediation incident.
      type: String
    - contextPath: Mimecast.Incident.IdentifiedMessages
      description: The number of messages identified based on the search criteria.
      type: Number
    - contextPath: Mimecast.Incident.SuccessfullyRemediatedMessages
      description: The number successfully remediated messages.
      type: Number
    - contextPath: Mimecast.Incident.FailedRemediatedMessages
      description: The number of messages that failed to remediate.
      type: Number
    - contextPath: Mimecast.Incident.MessagesRestored
      description: The number of messages that were restored from the incident.
      type: Number
    - contextPath: Mimecast.Incident.LastModified
      description: The date and time that the incident was last modified.
      type: String
    - contextPath: Mimecast.Incident.SearchCriteria.From
      description: The sender email address or domain.
      type: String
    - contextPath: Mimecast.Incident.SearchCriteria.To
      description: The recipient email address or domain.
      type: String
    - contextPath: Mimecast.Incident.SearchCriteria.MessageID
      description: The message ID used when creating the remediation incident.
      type: String
    - contextPath: Mimecast.Incident.SearchCriteria.FileHash
      description: The file hash used when creating the remediation incident.
      type: String
    - contextPath: Mimecast.Incident.SearchCriteria.StartDate
      description: The start date of included messages.
      type: String
    - contextPath: Mimecast.Incident.SearchCriteria.EndDate
      description: The end date of included messages.
      type: String
  - arguments:
    - description: The Mimecast ID for a remediation incident.
      name: incident_id
      required: true
    description: Returns a Mimecast remediation incident.
    name: mimecast-get-remediation-incident
    outputs:
    - contextPath: Mimecast.Incident.ID
      description: The secure Mimecast remediation ID.
      type: String
    - contextPath: Mimecast.Incident.Code
      description: The incident code generated at creation.
      type: String
    - contextPath: Mimecast.Incident.Type
      description: The incident type.
      type: String
    - contextPath: Mimecast.Incident.Reason
      description: The reason provided when the remediation incident was created.
      type: String
    - contextPath: Mimecast.Incident.IdentifiedMessages
      description: The number of messages identified based on the search criteria.
      type: Number
    - contextPath: Mimecast.Incident.SuccessfullyRemediatedMessages
      description: The number of successfully remediated messages.
      type: Number
    - contextPath: Mimecast.Incident.FailedRemediatedMessages
      description: The number of messages that failed to remediate.
      type: Number
    - contextPath: Mimecast.Incident.MessagesRestored
      description: The number of messages that were restored from the incident.
      type: Number
    - contextPath: Mimecast.Incident.LastModified
      description: The date and time that the incident was last modified.
      type: String
    - contextPath: Mimecast.Incident.SearchCriteria.From
      description: The sender email address or domain.
      type: String
    - contextPath: Mimecast.Incident.SearchCriteria.To
      description: The recipient email address or domain.
      type: String
    - contextPath: Mimecast.Incident.SearchCriteria.MessageID
      description: The message ID used when creating the remediation incident.
      type: String
    - contextPath: Mimecast.Incident.SearchCriteria.FileHash
      description: The file hash used when creating the remediation incident.
      type: String
    - contextPath: Mimecast.Incident.SearchCriteria.StartDate
      description: The start date of included messages.
      type: String
    - contextPath: Mimecast.Incident.SearchCriteria.EndDate
      description: The end date of included messages.
      type: String
  - arguments:
    - description: List of file hashes to check if they were seen in an account.
      isArray: true
      name: hashes_to_search
      required: true
    description: Searches for one or more file hashes in the account. Maximum is 100.
    name: mimecast-search-file-hash
    outputs:
    - contextPath: Mimecast.Hash.HashValue
      description: The file hash value.
      type: String
    - contextPath: Mimecast.Hash.Detected
      description: Whether the hash was found in the account.
      type: Boolean
  - arguments:
    - description: The ID of the policy to update.
      name: policy_id
      required: true
    - description: A new description for the policy.
      name: description
    - auto: PREDEFINED
      description: The sender type by which to block senders in the policy. This argument must match the fromValue argument. For example, if you specify email_domain, the fromValue must be an email domain.
      name: fromType
      predefined:
      - everyone
      - internal_addresses
      - external_addresses
      - email_domain
      - profile_group
      - address_attribute_value
      - individual_email_address
      - free_mail_domains
      - header_display_name
    - auto: PREDEFINED
      description: The blocked receiver type by which to block receivers in the policy. This argument must match the toValue argument. For example, if you specify email_domain, the fromType must be an email domain.
      name: toType
      predefined:
      - everyone
      - internal_addresses
      - external_addresses
      - email_domain
      - profile_group
      - individual_email_address
    - auto: PREDEFINED
      description: The block action.
      name: option
      predefined:
      - no_action
      - block_sender
    - description: The value of the fromType argument. For example, if you specify email_domain for fromType, the fromValue must be an email domain.
      name: fromValue
    - description: The value of the toType argument. For example, if you specify email_domain for toType, the toValue must be an email domain.
      name: toValue
    - auto: PREDEFINED
      description: The part from where addresses are pulled.
      name: fromPart
      predefined:
      - envelope_from
      - header_from
      - both
    description: Updates the specified policy.
    name: mimecast-update-policy
    outputs:
    - contextPath: Mimecast.Policy.ID
      description: Policy ID.
      type: string
    - contextPath: Mimecast.Policy.Sender.Address
      description: Block sender by email address value.
      type: string
    - contextPath: Mimecast.Policy.Sender.Domain
      description: Block sender by domain value.
      type: string
    - contextPath: Mimecast.Policy.Sender.Group
      description: Block sender by group value.
      type: string
    - contextPath: Mimecast.Policy.Bidirectional
      description: Whether the blocked policy is bidirectional.
      type: boolean
    - contextPath: Mimecast.Policy.Receiver.Address
      description: Block emails to receiver type address.
      type: string
    - contextPath: Mimecast.Policy.Receiver.Domain
      description: Block emails to receiver type domain.
      type: string
    - contextPath: Mimecast.Policy.Receiver.Group
      description: Block emails to receiver type group.
      type: string
    - contextPath: Mimecast.Policy.Fromdate
      description: The policy validation start date.
      type: date
    - contextPath: Mimecast.Policy.Todate
      description: The policy expiration date.
      type: date
    - contextPath: Mimecast.Policy.Sender.Type
      description: The sender type.
      type: String
    - contextPath: Mimecast.Policy.Receiver.Type
      description: The receiver type.
      type: String
  - name: mimecast-search-message
    description: Searches a message.
    arguments:
    - name: search_reason
      description: Reason for tracking the email
      defaultValue: ""
      predefined:
      - ""
    - name: from_date
      description: API start parameter. Datetime format is ISO 8601. e.g., 2022-07-11T14:49:18+0000.
      defaultValue: ""
      predefined:
      - ""
    - name: to_date
      description: API end parameter  Datetime format ISO 8601. e.g., 2022-07-11T14:49:18+0000.
      defaultValue: ""
      predefined:
      - ""
    - name: message_id
      description: The internet message ID of the message to track.
      defaultValue: ""
      predefined:
      - ""
    - name: from
      description: "Part of advancedTrackAndTraceOptions object: The sending email address or domain of the messages to track."
      defaultValue: ""
      predefined:
      - ""
    - name: to
      description: "Part of advancedTrackAndTraceOptions object: The recipient email address or domain of the messages to track."
      defaultValue: ""
      predefined:
      - ""
    - name: subject
      description: "Part of advancedTrackAndTraceOptions object: The subject of the messages to track."
      defaultValue: ""
      predefined:
      - ""
    - name: sender_ip
      description: "Part of advancedTrackAndTraceOptions object: The source IP address of the messages to track."
      defaultValue: ""
      predefined:
      - ""
    - auto: PREDEFINED
      name: route
      description: A comma-separated list of routes to filter by.
      isArray: true
      defaultValue: ""
      predefined:
      - internal
      - outbound
      - inbound
    outputs:
    - contextPath: Mimecast.SearchMessage.info
      description: Info regarding the message.
      type: String
    - contextPath: Mimecast.SearchMessage.id
      description: The Mimecast ID of the message. Used to load more information about the message.
      type: String
    - contextPath: Mimecast.SearchMessage.status
      description: The status of the message.
      type: String
    - contextPath: Mimecast.SearchMessage.fromEnv.emailAddress
      description: The email address of the sender.
      type: String
    - contextPath: Mimecast.SearchMessage.fromHdr.displayableName
      description: The display name of the recipient.
      type: String
    - contextPath: Mimecast.SearchMessage.fromHdr.emailAddress
      description: The email address of the recipient.
      type: String
    - contextPath: Mimecast.SearchMessage.to.displayableName
      description: The display name of the recipient.
      type: String
    - contextPath: Mimecast.SearchMessage.to.emailAddress
      description: The email address of the recipient.
      type: String
    - contextPath: Mimecast.SearchMessage.received
      description: The date and time the message was received by Mimecast.
      type: Date
    - contextPath: Mimecast.SearchMessage.subject
      description: The subject of the message.
      type: String
    - contextPath: Mimecast.SearchMessage.senderIP
      description: The source IP address of the message.
      type: String
    - contextPath: Mimecast.SearchMessage.attachments
      description: If the message has attachments.
      type: Boolean
    - contextPath: Mimecast.SearchMessage.route
      description: The route of the message.
      type: String
    - contextPath: Mimecast.SearchMessage.sent
      description: The date and time that the message was sent / processed by Mimecast.
      type: Date
    - contextPath: Mimecast.SearchMessage.spamScore
      description: Spam score of the email.
      type: Number
    - contextPath: Mimecast.SearchMessage.detectionLevel
      description: Detection level of the email.
      type: String
  - name: mimecast-get-message-info
    description: Retrieves detailed information about a specific message.
    arguments:
    - name: ids
      description: A comma-separated list of the Mimecast IDs of the messages to load. This is returned by the /api/message-finder/search endpoint. (mimecast-search-message command)
      required: true
      isArray: true
      defaultValue: ""
      predefined:
      - ""
    - auto: PREDEFINED
      name: show_recipient_info
      description: When argument is true all data from recipientInfo object is presented at command response.
      defaultValue: "true"
      predefined:
      - "true"
      - "false"
    - auto: PREDEFINED
      name: show_delivered_message
      description: When argument is true all data from deliveredMessage object is presented at command response.
      defaultValue: "false"
      predefined:
      - "true"
      - "false"
    - auto: PREDEFINED
      name: show_retention_info
      description: When argument is true all data from retentionInfo object is presented at command response.
      defaultValue: "true"
      predefined:
      - "true"
      - "false"
    - auto: PREDEFINED
      name: show_spam_info
      description: When argument is true all spamInfo block is presented at command response.
      defaultValue: "true"
      predefined:
      - "true"
      - "false"
    outputs:
    - contextPath: Mimecast.MessageInfo.deliveredMessage.deliveryMetaInfo.components.extension
      description: Component extension type.
      type: String
    - contextPath: Mimecast.MessageInfo.deliveredMessage.deliveryMetaInfo.components.hash
      description: Component hash.
      type: String
    - contextPath: Mimecast.MessageInfo.deliveredMessage.deliveryMetaInfo.components.mimeType
      description: Component MIME type.
      type: String
    - contextPath: Mimecast.MessageInfo.deliveredMessage.deliveryMetaInfo.components.name
      description: Component name.
      type: String
    - contextPath: Mimecast.MessageInfo.deliveredMessage.deliveryMetaInfo.components.size
      description: Component size.
      type: Number
    - contextPath: Mimecast.MessageInfo.deliveredMessage.deliveryMetaInfo.components.type
      description: Component type.
      type: String
    - contextPath: Mimecast.MessageInfo.deliveredMessage.deliveryMetaInfo.deliveryEvent
      description: Description of delivery event.
      type: String
    - contextPath: Mimecast.MessageInfo.deliveredMessage.deliveryMetaInfo.emailAddress
      description: Email address of recipient.
      type: String
    - contextPath: Mimecast.MessageInfo.deliveredMessage.deliveryMetaInfo.encryptionInfo
      description: Encryption type.
      type: String
    - contextPath: Mimecast.MessageInfo.deliveredMessage.deliveryMetaInfo.messageExpiresIn
      description: Expiration time of message.
      type: Number
    - contextPath: Mimecast.MessageInfo.deliveredMessage.deliveryMetaInfo.processingServer
      description: Processing server address.
      type: String
    - contextPath: Mimecast.MessageInfo.deliveredMessage.deliveryMetaInfo.receiptAcknowledgement
      description: Recipient acknowledgement.
      type: String
    - contextPath: Mimecast.MessageInfo.deliveredMessage.deliveryMetaInfo.remoteHost
      description: Remote host address.
      type: String
    - contextPath: Mimecast.MessageInfo.deliveredMessage.deliveryMetaInfo.remoteIp
      description: Remote IP address.
      type: String
    - contextPath: Mimecast.MessageInfo.deliveredMessage.deliveryMetaInfo.remoteServerGreeting
      description: Remote server greeting.
      type: String
    - contextPath: Mimecast.MessageInfo.deliveredMessage.deliveryMetaInfo.transmissionEnd
      description: Transmission end date.
      type: Date
    - contextPath: Mimecast.MessageInfo.deliveredMessage.deliveryMetaInfo.transmissionSize
      description: Transmission size.
      type: Number
    - contextPath: Mimecast.MessageInfo.deliveredMessage.deliveryMetaInfo.transmissionStart
      description: Transmission start date.
      type: Date
    - contextPath: Mimecast.MessageInfo.deliveredMessage.messageInfo.fromEnvelope
      description: Sender mail. (From envelope)
      type: String
    - contextPath: Mimecast.MessageInfo.deliveredMessage.messageInfo.fromHeader
      description: Sender mail. (From header)
      type: String
    - contextPath: Mimecast.MessageInfo.deliveredMessage.messageInfo.processed
      description: Processed time and date.
      type: Date
    - contextPath: Mimecast.MessageInfo.deliveredMessage.messageInfo.route
      description: Message route.
      type: String
    - contextPath: Mimecast.MessageInfo.deliveredMessage.messageInfo.sent
      description: Message sent time and date.
      type: Date
    - contextPath: Mimecast.MessageInfo.deliveredMessage.messageInfo.subject
      description: Message subject.
      type: String
    - contextPath: Mimecast.MessageInfo.deliveredMessage.messageInfo.to
      description: Recipients info.
      type: String
    - contextPath: Mimecast.MessageInfo.deliveredMessage.messageInfo.transmissionInfo
      description: Transmission info.
      type: String
    - contextPath: Mimecast.MessageInfo.deliveredMessage.policyInfo.inherited
      description: Whether policy is inherited.
      type: Boolean
    - contextPath: Mimecast.MessageInfo.deliveredMessage.policyInfo.policyName
      description: Policy name.
      type: String
    - contextPath: Mimecast.MessageInfo.deliveredMessage.policyInfo.policyType
      description: Policy type.
      type: String
    - contextPath: Mimecast.MessageInfo.id
      description: Message ID.
      type: String
    - contextPath: Mimecast.MessageInfo.recipientInfo.messageInfo.binaryEmailSize
      description: Email size.
      type: Number
    - contextPath: Mimecast.MessageInfo.recipientInfo.messageInfo.components.extension
      description: Component extension type.
      type: String
    - contextPath: Mimecast.MessageInfo.recipientInfo.messageInfo.components.hash
      description: Component hash.
      type: String
    - contextPath: Mimecast.MessageInfo.recipientInfo.messageInfo.components.mimeType
      description: Component MIME type.
      type: String
    - contextPath: Mimecast.MessageInfo.recipientInfo.messageInfo.components.name
      description: Component name.
      type: String
    - contextPath: Mimecast.MessageInfo.recipientInfo.messageInfo.components.size
      description: Component size.
      type: Number
    - contextPath: Mimecast.MessageInfo.recipientInfo.messageInfo.components.type
      description: Component type.
      type: String
    - contextPath: Mimecast.MessageInfo.recipientInfo.messageInfo.encryptionInfo
      description: Encryption information.
      type: String
    - contextPath: Mimecast.MessageInfo.recipientInfo.messageInfo.fromEnvelope
      description: The routable email address (From envelope).
      type: String
    - contextPath: Mimecast.MessageInfo.recipientInfo.messageInfo.fromHeader
      description: The routable email address (From header).
      type: String
    - contextPath: Mimecast.MessageInfo.recipientInfo.messageInfo.messageExpiresIn
      description: Expiry time of message.
      type: Number
    - contextPath: Mimecast.MessageInfo.recipientInfo.messageInfo.processed
      description: Message processed time.
      type: Date
    - contextPath: Mimecast.MessageInfo.recipientInfo.messageInfo.processingServer
      description: Message processing server.
      type: String
    - contextPath: Mimecast.MessageInfo.recipientInfo.messageInfo.receiptAcknowledgement
      description: Recipient acknowledgement.
      type: String
    - contextPath: Mimecast.MessageInfo.recipientInfo.messageInfo.receiptEvent
      description: Receipt event name.
      type: String
    - contextPath: Mimecast.MessageInfo.recipientInfo.messageInfo.remoteHost
      description: Remote host address.
      type: String
    - contextPath: Mimecast.MessageInfo.recipientInfo.messageInfo.remoteIp
      description: Remote IP address.
      type: String
    - contextPath: Mimecast.MessageInfo.recipientInfo.messageInfo.remoteServerGreeting
      description: Remote server greeting.
      type: String
    - contextPath: Mimecast.MessageInfo.recipientInfo.messageInfo.sent
      description: Message send time and date.
      type: Date
    - contextPath: Mimecast.MessageInfo.recipientInfo.messageInfo.spamEvent
      description: Spam event name.
      type: String
    - contextPath: Mimecast.MessageInfo.recipientInfo.messageInfo.subject
      description: Message subject.
      type: String
    - contextPath: Mimecast.MessageInfo.recipientInfo.messageInfo.to
      description: Recipient info.
      type: String
    - contextPath: Mimecast.MessageInfo.recipientInfo.messageInfo.transmissionEnd
      description: Transmission end date.
      type: Date
    - contextPath: Mimecast.MessageInfo.recipientInfo.messageInfo.transmissionInfo
      description: Transmission info.
      type: String
    - contextPath: Mimecast.MessageInfo.recipientInfo.messageInfo.transmissionSize
      description: Transmission size.
      type: Number
    - contextPath: Mimecast.MessageInfo.recipientInfo.messageInfo.transmissionStart
      description: Transmission start date.
      type: Date
    - contextPath: Mimecast.MessageInfo.recipientInfo.recipientMetaInfo.binaryEmailSize
      description: Email size.
      type: Number
    - contextPath: Mimecast.MessageInfo.recipientInfo.recipientMetaInfo.components.extension
      description: Component extension type.
      type: String
    - contextPath: Mimecast.MessageInfo.recipientInfo.recipientMetaInfo.components.hash
      description: Component hash type.
      type: String
    - contextPath: Mimecast.MessageInfo.recipientInfo.recipientMetaInfo.components.mimeType
      description: Component MIME type.
      type: String
    - contextPath: Mimecast.MessageInfo.recipientInfo.recipientMetaInfo.components.name
      description: Component name.
      type: String
    - contextPath: Mimecast.MessageInfo.recipientInfo.recipientMetaInfo.components.size
      description: Component size.
      type: Number
    - contextPath: Mimecast.MessageInfo.recipientInfo.recipientMetaInfo.components.type
      description: Component type.
      type: String
    - contextPath: Mimecast.MessageInfo.recipientInfo.recipientMetaInfo.encryptionInfo
      description: Encryption information.
      type: String
    - contextPath: Mimecast.MessageInfo.recipientInfo.recipientMetaInfo.messageExpiresIn
      description: Expiration time of message.
      type: Number
    - contextPath: Mimecast.MessageInfo.recipientInfo.recipientMetaInfo.processingServer
      description: Processing server address.
      type: String
    - contextPath: Mimecast.MessageInfo.recipientInfo.recipientMetaInfo.receiptAcknowledgement
      description: Recipient acknowledgement.
      type: String
    - contextPath: Mimecast.MessageInfo.recipientInfo.recipientMetaInfo.receiptEvent
      description: Receipt event name.
      type: String
    - contextPath: Mimecast.MessageInfo.recipientInfo.recipientMetaInfo.remoteHost
      description: Remote host address.
      type: String
    - contextPath: Mimecast.MessageInfo.recipientInfo.recipientMetaInfo.remoteIp
      description: Remote IP address.
      type: String
    - contextPath: Mimecast.MessageInfo.recipientInfo.recipientMetaInfo.remoteServerGreeting
      description: Remote server greeting.
      type: String
    - contextPath: Mimecast.MessageInfo.recipientInfo.recipientMetaInfo.spamEvent
      description: Spam event name.
      type: String
    - contextPath: Mimecast.MessageInfo.recipientInfo.recipientMetaInfo.transmissionEnd
      description: Transmission end date.
      type: Date
    - contextPath: Mimecast.MessageInfo.recipientInfo.recipientMetaInfo.transmissionSize
      description: Transmission size.
      type: Number
    - contextPath: Mimecast.MessageInfo.recipientInfo.recipientMetaInfo.transmissionStart
      description: Transmission start date.
      type: Date
    - contextPath: Mimecast.MessageInfo.retentionInfo.currentPurgeDate
      description: Current purge date and time.
      type: Date
    - contextPath: Mimecast.MessageInfo.retentionInfo.originalPurgeDate
      description: Original purge date and time.
      type: Date
    - contextPath: Mimecast.MessageInfo.retentionInfo.purgeBasedOn
      description: Value that purge is based on.
      type: String
    - contextPath: Mimecast.MessageInfo.retentionInfo.retentionAdjustmentDays
      description: Retention adjustment days.
      type: Number
    - contextPath: Mimecast.MessageInfo.spamInfo.detectionLevel
      description: Spam detection level.
      type: String
    - contextPath: Mimecast.MessageInfo.spamInfo.dkim.allow
      description: Is DomainKeys Identified Mail (DKIM) allowed.
      type: Boolean
    - contextPath: Mimecast.MessageInfo.spamInfo.dkim.info
      description: DKIM info.
      type: String
    - contextPath: Mimecast.MessageInfo.spamInfo.dmarc.allow
      description: Is Domain-based Message Authentication, Reporting & Conformance (DMARC) allowed.
      type: Boolean
    - contextPath: Mimecast.MessageInfo.spamInfo.dmarc.info
      description: DMARC info.
      type: String
    - contextPath: Mimecast.MessageInfo.spamInfo.greyEmail
      description: Is grey email allowed.
      type: Boolean
    - contextPath: Mimecast.MessageInfo.spamInfo.managedSender.allow
      description: Is Managed Sender allowed.
      type: Boolean
    - contextPath: Mimecast.MessageInfo.spamInfo.managedSender.info
      description: Managed Sender info.
      type: String
    - contextPath: Mimecast.MessageInfo.spamInfo.permittedSender.allow
      description: Is Permitted Sender allowed.
      type: Boolean
    - contextPath: Mimecast.MessageInfo.spamInfo.permittedSender.info
      description: Permitted Sender info.
      type: String
    - contextPath: Mimecast.MessageInfo.spamInfo.rbl.allow
      description: Is Real-time blackhole list (RBL) allowed.
      type: Boolean
    - contextPath: Mimecast.MessageInfo.spamInfo.rbl.info
      description: RBL info.
      type: String
    - contextPath: Mimecast.MessageInfo.spamInfo.spamScore
      description: Spam score.
      type: Number
    - contextPath: Mimecast.MessageInfo.spamInfo.spf.allow
      description: Is Sender Policy Framework (SPF) allowed.
      type: Boolean
    - contextPath: Mimecast.MessageInfo.spamInfo.spf.info
      description: SPF info.
      type: String
    - contextPath: Mimecast.MessageInfo.status
      description: Message status.
      type: String
  - name: mimecast-list-held-message
    description: Get information about held messages, including the reason, hold level, sender and recipients
    arguments:
    - auto: PREDEFINED
      name: admin
      description: Whether only results for the currently authenticated user will be returned.
      defaultValue: "false"
      predefined:
      - "true"
      - "false"
    - name: from_date
      description: Datetime format ISO 8601. e.g., 2022-07-11T14:49:18+0000.
      defaultValue: ""
      predefined:
      - ""
    - name: to_date
      description: Datetime format ISO 8601. e.g., 2022-07-11T14:49:18+0000.
      defaultValue: ""
      predefined:
      - ""
    - name: value
      description: Free text to filter results by.
      defaultValue: ""
      predefined:
      - ""
    - auto: PREDEFINED
      name: field_name
      description: Message fields to filter based on.
      defaultValue: ""
      predefined:
      - all
      - subject
      - sender
      - recipient
      - reason_code
    - name: page_size
      description: Number of results per page to display.
      defaultValue: ""
      predefined:
      - ""
    - name: page
      description: Page number you would like to view. Each page contains page_size values. Must be used along with page_size.
      defaultValue: ""
      predefined:
      - ""
    - name: limit
      description: The maximum number of results to return.
      defaultValue: ""
      predefined:
      - ""
    outputs:
    - contextPath: Mimecast.HeldMessage.dateReceived
      description: The timestamp of the message transmission.
      type: Date
    - contextPath: Mimecast.HeldMessage.from.displayableName
      description: The sender name.
      type: String
    - contextPath: Mimecast.HeldMessage.from.emailAddress
      description: The sender email.
      type: String
    - contextPath: Mimecast.HeldMessage.fromHeader.displayableName
      description: The display name of the sender (From header).
      type: String
    - contextPath: Mimecast.HeldMessage.fromHeader.emailAddress
      description: The email address of the sender (From header).
      type: String
    - contextPath: Mimecast.HeldMessage.hasAttachments
      description: Returns true if the message contains attachments. False indicates no attachments.
      type: Boolean
    - contextPath: Mimecast.HeldMessage.id
      description: The Mimecast secure ID for a message.
      type: String
    - contextPath: Mimecast.HeldMessage.policyInfo
      description: Information or definition name triggering the message hold action.
      type: String
    - contextPath: Mimecast.HeldMessage.reason
      description: The summary reason for holding the message.
      type: String
    - contextPath: Mimecast.HeldMessage.reasonCode
      description: Reason code for holding the message.
      type: String
    - contextPath: Mimecast.HeldMessage.reasonId
      description: Mirrors the reason field, formatted without spaces. However, reasonCode should be used instead.
      type: String
    - contextPath: Mimecast.HeldMessage.route
      description: "Direction of message being held. Possible values are: INBOUND, OUTBOUND, INTERNAL, EXTERNAL."
      type: String
    - contextPath: Mimecast.HeldMessage.size
      description: The size of the message in bytes.
      type: Number
    - contextPath: Mimecast.HeldMessage.subject
      description: The message subject.
      type: String
    - contextPath: Mimecast.HeldMessage.to.displayableName
      description: The display name of the recipient.
      type: String
    - contextPath: Mimecast.HeldMessage.to.emailAddress
      description: The email address of the recipient.
      type: String
  - name: mimecast-held-message-summary
    description: Get counts of currently held messages for each hold reason.
    arguments: []
    outputs:
    - contextPath: Mimecast.HeldMessageSummary.numberOfItems
      description: The number of messages currently held for this reason.
      type: Number
    - contextPath: Mimecast.HeldMessageSummary.policyInfo
      description: The name of the policy or definition that held a message.
      type: String
  - name: mimecast-reject-held-message
    description: Reject a currently held message.
    arguments:
    - name: ids
      description: A comma-separated list of Mimecast secure IDs IDs are extracted from the mimecast-list-held-message command.
      required: true
      isArray: true
      defaultValue: ""
      predefined:
      - ""
    - name: message
      description: Rejection message to be returned to the sender.
      defaultValue: ""
      predefined:
      - ""
    - auto: PREDEFINED
      name: reason_type
      description: User can choose reason.
      defaultValue: ""
      predefined:
      - MESSAGE CONTAINS UNDESIRABLE CONTENT,MESSAGE CONTAINS CONFIDENTIAL INFORMATION,REVIEWER DISAPPROVES OF CONTENT.
      - INAPPROPRIATE COMMUNICATIONMESSAGE GOES AGAINST EMAIL POLICIES
      - ""
    - auto: PREDEFINED
      name: notify
      description: Whether to deliver rejection notificationd.
      defaultValue: ""
      predefined:
      - "true"
      - "false"
    outputs: []
  - name: mimecast-release-held-message
    description: Release a currently held message.
    arguments:
    - name: id
      description: Mimecast secure ID. ID can be extracted from the mimecast-list-held-message command.
      required: true
      defaultValue: ""
      predefined:
      - ""
    outputs: []
  - name: mimecast-search-processing-message
    description: Return messages currently being processed by Mimecast. Note that most of the time, no results are returned.
    arguments:
    - auto: PREDEFINED
      name: sort_order
      description: The method used to sort the messages.
      defaultValue: ""
      predefined:
      - asc
      - desc
    - name: from_date
      description: Datetime format ISO 8601. e.g., 2022-07-11T14:49:18+0000.
      defaultValue: ""
      predefined:
      - ""
    - name: to_date
      description: Datetime format ISO 8601. e.g., 2022-07-11T14:49:18+0000.
      defaultValue: ""
      predefined:
      - ""
    - name: value
      description: The search value to be used.
      defaultValue: ""
      predefined:
      - ""
    - auto: PREDEFINED
      name: field_name
      description: The field to be searched.
      defaultValue: ""
      predefined:
      - ALL
      - fromAddress
      - toAddress
      - subject
      - info
      - remoteIp
    - name: attachments
      description: The presence of an attachment in the message.
      defaultValue: ""
      predefined:
      - ""
    - auto: PREDEFINED
      name: route
      description: The message route.
      defaultValue: ""
      predefined:
      - all
      - internal
      - outbound
      - inbound
      - external
    - name: page_size
      description: Number of results per page to display.
      defaultValue: ""
      predefined:
      - ""
    - name: page
      description: Page number you would like to view. Each page contains page_size values. Must be used along with page_size.
      defaultValue: ""
      predefined:
      - ""
    - name: limit
      description: The maximum number of results to return.
      defaultValue: ""
      predefined:
      - ""
    outputs:
    - contextPath: Mimecast.ProcessingMessage.messages.id
      description: The Mimecast secure ID of the message.
      type: String
    - contextPath: Mimecast.ProcessingMessage.messages.fromEnv.emailAddress
      description: The routable email address (From evelope).
      type: String
    - contextPath: Mimecast.ProcessingMessage.messages.fromHeader.emailAddress
      description: The routable email address (From header).
      type: String
    - contextPath: Mimecast.ProcessingMessage.messages.to.emailAddress
      description: The routable email address.
      type: String
    - contextPath: Mimecast.ProcessingMessage.messages.subject
      description: The message subject.
      type: String
    - contextPath: Mimecast.ProcessingMessage.messages.attachment
      description: Whether there is an attachment in the message.
      type: Boolean
    - contextPath: Mimecast.ProcessingMessage.messages.routing
      description: The directional route of the message. Possible values are internal, outbound, inbound or external.
      type: String
    - contextPath: Mimecast.ProcessingMessage.messages.size
      description: The size of the message in bytes.
      type: Number
    - contextPath: Mimecast.ProcessingMessage.messages.remoteIp
      description: The connecting IP address.
      type: String
    - contextPath: Mimecast.ProcessingMessage.messages.attempts
      description: The number of processing attempts of the message.
      type: Number
    - contextPath: Mimecast.ProcessingMessage.messages.nextAttempt
      description: The date of the next process attempt for the message.
      type: Date
    - contextPath: Mimecast.ProcessingMessage.messages.created
      description: The date of the processing request creation.
      type: Date
    - contextPath: Mimecast.ProcessingMessage.messages.info
      description: Current processing status of the message.
      type: String
    - contextPath: Mimecast.ProcessingMessage.messages.priority
      description: Message priority.
      type: String
  - name: mimecast-list-email-queues
    description: Get the count of the inbound and outbound email queues at specified times.
    arguments:
    - name: from_date
      description: Datetime format ISO 8601. e.g., 2022-07-11T14:49:18+0000.
      required: true
      defaultValue: ""
      predefined:
      - ""
    - name: to_date
      description: Datetime format ISO 8601. e.g., 2022-07-11T14:49:18+0000.
      required: true
      defaultValue: ""
      predefined:
      - ""
    outputs:
    - contextPath: Mimecast.EmailQueue.inboundEmailQueue.count
      description: The number of inbound messages currently queued.
      type: Number
    - contextPath: Mimecast.EmailQueue.inboundEmailQueue.date
      description: The date for the displayed number of messages.
      type: Date
    - contextPath: Mimecast.EmailQueue.outboundEmailQueue.count
      description: The number of outbound messages currently queued.
      type: Number
    - contextPath: Mimecast.EmailQueue.outboundEmailQueue.date
      description: The date for the displayed number of messages.
      type: Date
  isfetch: true
  runonce: false
  script: '-'
  subtype: python3
  type: python
  dockerimage: demisto/python3:3.10.13.72123
tests:
- Mimecast test
fromversion: 5.0.0
