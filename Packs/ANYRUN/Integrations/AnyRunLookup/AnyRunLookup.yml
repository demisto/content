category: Data Enrichment & Threat Intelligence
sectionorder:
- Connect
- Collect
commonfields:
  id: ANY.RUN TI Lookup
  version: -1
configuration:
- display: Username
  name: credentials
  required: true
  type: 9
  section: Connect
- display: Trust any certificate (not secure)
  name: insecure
  type: 8
  required: false
  section: Connect
- display: Use system proxy settings
  name: proxy
  type: 8
  section: Connect
  required: false
- name: integrationReliability
  additionalinfo: Reliability of the source providing the intelligence data.
  defaultvalue: C - Fairly reliable
  display: Source Reliability
  options:
  - A+ - 3rd party enrichment
  - A - Completely reliable
  - B - Usually reliable
  - C - Fairly reliable
  - D - Not usually reliable
  - E - Unreliable
  - F - Reliability cannot be judged
  required: true
  type: 15
  section: Collect
description: TI Lookup is a searchable database of IOCs, IOAs, IOBs, and events for threat hunting and a service for browsing malicious files by their content.
display: ANY.RUN TI Lookup
name: ANY.RUN TI Lookup
script:
  commands:
  - arguments:
    - description: 'Specify the number of days from the current date for which you want to lookup.'
      name: lookup_depth
      required: false
      type: Number
    - description: 'Raw query with necessary filters. Supports condition concatenation with AND, OR, NOT and Parentheses ().'
      name: query
      required: false
      type: String
    - description: 'The name of a particular threat: malware family, threat type, etc., as identified by the sandbox. Example: "Phishing".'
      name: threat_name
      required: false
      type: String
    - auto: PREDEFINED
      description: 'A verdict on the threat level of the sample.'
      name: threat_level
      required: false
      type: String
      predefined:
      - 'suspicious'
      - 'malicious'
      - 'info'
    - auto: PREDEFINED
      description: 'The type of the sample submitted to the sandbox.'
      name: task_type
      required: false
      type: String
      predefined:
      - 'File'
      - 'URL'
    - description: 'The country from which the threat sample was submitted. Example: "es".'
      name: submission_country
      required: false
      type: String
    - auto: PREDEFINED
      description: 'The specific version of Windows used in the environment.'
      name: os
      required: false
      type: String
      predefined:
      - 'Windows 7'
      - 'Windows 8'
      - 'Windows 11'
    - auto: PREDEFINED
      description: 'The software package of applications installed on the OS.'
      name: os_software_set
      required: false
      type: String
      predefined:
      - 'clean'
      - 'office'
      - 'complete'
    - auto: PREDEFINED
      description: 'The bitness of the operating system.'
      name: os_bit_version
      required: false
      type: String
      predefined:
      - '32'
      - '64'
    - description: 'The specific key within the registry hive where the modification occurred. Please note: when entering registry keys, use a double backslash (\) to escape the single backslash. Example: "Windows\\CurrentVersion\\RunOnce.'
      name: registry_key
      required: false
      type: String
    - description: 'The name of the Windows Registry key field. Example: "browseinplace".'
      name: registry_name
      required: false
      type: String
    - description: 'The value of the Windows Registry key. Example: "Internet Explorer\iexplore.exe.'
      name: registry_value
      required: false
      type: String
    - description: 'The full path to the module’s image file, the location on the disk where the module’s executable is stored. Example: "SysWOW64\\cryptbase.dll.'
      name: module_image_path
      required: false
      type: String
    - auto: PREDEFINED
      description: 'The threat level assigned to a particular event.'
      name: rule_threat_level
      required: false
      type: String
      predefined:
      - 'suspicious'
      - 'malicious'
      - 'info'
    - description: 'The name of the detection rule. Example: "Executable content was dropped or overwritten".'
      name: rule_name
      required: false
      type: String
    - description: 'Techniques used by the malware according to the MITRE ATT&CK classification. Example: "T1071".'
      name: mitre
      required: false
      type: String
    - description: 'Full path to process image. Example: "System32\\conhost.exe".'
      name: image_path
      required: false
      type: String
    - description: 'Full command line that initiated the process. Example: "PDQConnectAgent\\pdq-connect-agent.exe –service".'
      name: command_line
      required: false
      type: String
    - auto: PREDEFINED
      description: 'Indication of whether a process has been injected.'
      name: injected_flag
      required: false
      type: String
      predefined:
      - 'true'
      - 'false'
    - description: 'The IP address of the network connection that was established or attempted. Example: "147.185.221.22".'
      name: destination_ip
      required: false
      type: String
    - description: 'The network port through which the connection was established. Example: "49760".'
      name: destination_port
      required: false
      type: String
    - description: 'Detected ASN. Example: "akamai-as".'
      name: destination_ip_asn
      required: false
      type: String
    - description: 'Two-letter country or region code of the detected IP geolocation. Example: "ae".'
      name: destination_ip_geo
      required: false
      type: String
    - description: 'The domain name that was recorded during the threat execution in a sandbox. Example: "tventyvd20sb.top".'
      name: domain_name
      required: false
      type: String
    - description: 'Types of TLS fingerprints that can indicate certain threats.'
      name: ja3
      required: false
      type: String
    - description: 'Types of TLS fingerprints that can indicate certain threats.'
      name: ja3s
      required: false
      type: String
    - description: 'Types of TLS fingerprints that can indicate certain threats.'
      name: jarm
      required: false
      type: String
    - description: 'The full path to the file on the system.'
      name: file_path
      required: false
      type: String
    - description: 'The path of a file associated with a file event.'
      name: file_event_path
      required: false
      type: String
    - description: 'The extension that indicates the file type.'
      name: file_extension
      required: false
      type: String
    - description: 'Hash values relating to a file.'
      name: sha256
      required: false
      type: String
    - description: 'Hash values relating to a file.'
      name: sha1
      required: false
      type: String
    - description: 'Hash values relating to a file.'
      name: md5
      required: false
      type: String
    - description: 'The category assigned to the threat by Suricata based on its characteristics. Example: "a network trojan was detected".'
      name: suricata_class
      required: false
      type: String
    - description: 'The description of the threat according to Suricata. Example: "ET INFO 404/Snake/Matiex Keylogger Style External IP Check".'
      name: suricata_message
      required: false
      type: String
    - auto: PREDEFINED
      description: 'The verdict on the threat according to Suricata based on its potential impact.'
      name: suricata_threat_level
      required: false
      type: String
      predefined:
      - 'suspicious'
      - 'malicious'
      - 'info'
    - description: 'The unique identifier of the Suricata rule: Example: "2044767".'
      name: suricata_id
      required: false
      type: String
    - description: 'The name or identifier of the synchronization object used. Example: "rmc".'
      name: sync_object_name
      required: false
      type: String
    - description: 'The type of synchronization object used. Example: "mutex".'
      name: sync_object_type
      required: false
      type: String
    - description: 'The operation performed on the synchronization object. Example: "create".'
      name: sync_object_operation
      required: false
      type: String
    - description: 'The URL called by the process. Example: "http://192.168.37.128:8880/zv8u".'
      name: url
      required: false
      type: String
    - description: 'The content type of the HTTP request sent to the server. Example: "application/json".'
      name: http_request_content_type
      required: false
      type: String
    - description: 'The content type of the HTTP response received from the server. Example: "text/html".'
      name: http_response_content_type
      required: false
      type: String
    - description: 'The file type of the file being uploaded in the HTTP request. Example: "binary".'
      name: http_request_file_type
      required: false
      type: String
    - description: 'The file type of the file being downloaded in the HTTP response. Example: "binary".'
      name: http_response_file_type
      required: false
      type: String
    description: 'Perform threat intelligence using specified IOC. Attaches a JSON summary to WarRoom.'
    name: anyrun-get-intelligence
  - arguments:
      - default: true
        description: IP address to query.
        isArray: true
        name: ip
        required: true
    description: Check IP reputation (when information is available, returns a JSON with details).
    name: ip
    outputs:
      - contextPath: IP.Address
        description: The IP address.
        type: String
      - contextPath: IP.Port
        description: Ports that are associated with the IP.
        type: String
      - contextPath: IP.Tags
        description: Tags related the IP use (hosting, proxy, tor, vpn).
        type: String
      - contextPath: IP.FeedRelatedIndicators.value
        description: Names of indicators associated with the IP.
        type: String
      - contextPath: IP.FeedRelatedIndicators.type
        description: Types of indicators associated with the IP.
        type: String
      - contextPath: IP.Country
        description: The IP country.
        type: String
      - contextPath: IP.ASOwner
        description: The autonomous system owner of the IP.
        type: String
      - contextPath: IP.LastModified
        description: The date that the IP was last updated.
        type: Date
      - contextPath: DBotScore.Indicator
        description: The indicator that was tested.
        type: String
      - contextPath: DBotScore.Score
        description: The actual score.
        type: Number
      - contextPath: DBotScore.Reliability
        description: How reliable the score is (for example, "C - fairly reliable").
        type: String
      - contextPath: DBotScore.Type
        description: The indicator type.
        type: String
      - contextPath: DBotScore.Vendor
        description: The vendor used to calculate the score.
        type: String
  - arguments:
      - default: true
        description: Domain name to query.
        isArray: true
        name: domain
        required: true
    description: Check Domain reputation (when information is available, returns a JSON with details).
    name: domain
    outputs:
      - contextPath: Domain.Name
        description: The Domain name.
        type: String
      - contextPath: Domain.Port
        description: Ports that are associated with the Domain.
        type: String
      - contextPath: Domain.Tags
        description: Tags related the Domain use (hosting, proxy, tor, vpn).
        type: String
      - contextPath: Domain.FeedRelatedIndicators.value
        description: Names of indicators associated with the Domain.
        type: String
      - contextPath: Domain.FeedRelatedIndicators.type
        description: Types of indicators associated with the Domain.
        type: String
      - contextPath: Domain.Country
        description: The Domain country.
        type: String
      - contextPath: Domain.ASOwner
        description: The autonomous system owner of the Domain.
        type: String
      - contextPath: Domain.LastModified
        description: The date that the Domain was last updated.
        type: Date
      - contextPath: DBotScore.Indicator
        description: The indicator that was tested.
        type: String
      - contextPath: DBotScore.Score
        description: The actual score.
        type: Number
      - contextPath: DBotScore.Reliability
        description: How reliable the score is (for example, "C - fairly reliable").
        type: String
      - contextPath: DBotScore.Type
        description: The indicator type.
        type: String
      - contextPath: DBotScore.Vendor
        description: The vendor used to calculate the score.
        type: String
  - arguments:
      - default: true
        description: URL to query.
        isArray: true
        name: url
        required: true
    description: Check URL reputation (when information is available, returns a JSON with details).
    name: url
    outputs:
      - contextPath: URL.Data
        description: The URL name.
        type: String
      - contextPath: URL.Port
        description: Ports that are associated with the URL.
        type: String
      - contextPath: URL.Tags
        description: Tags related the URL use (hosting, proxy, tor, vpn).
        type: String
      - contextPath: URL.ASOwner
        description: The autonomous system owner of the IP.
        type: String
      - contextPath: URL.LastModified
        description: The date that the IP was last updated.
        type: Date
      - contextPath: URL.FeedRelatedIndicators.value
        description: Names of indicators associated with the URL.
        type: String
      - contextPath: URL.FeedRelatedIndicators.type
        description: Types of indicators associated with the URL.
        type: String
      - contextPath: URL.Country
        description: The URL country.
        type: String
      - contextPath: DBotScore.Indicator
        description: The indicator that was tested.
        type: String
      - contextPath: DBotScore.Score
        description: The actual score.
        type: Number
      - contextPath: DBotScore.Reliability
        description: How reliable the score is (for example, "C - fairly reliable").
        type: String
      - contextPath: DBotScore.Type
        description: The indicator type.
        type: String
      - contextPath: DBotScore.Vendor
        description: The vendor used to calculate the score.
        type: String
  - arguments:
      - default: true
        description: File to query.
        isArray: true
        name: file
        required: true
    description: Check File reputation (when information is available, returns a JSON with details).
    name: file
    outputs:
      - contextPath: File.Name
        description: The File name.
        type: String
      - contextPath: File.Extension
        description: The File name.
        type: String
      - contextPath: File.Path
        description: The File path.
        type: String
      - contextPath: File.SHA256
        description: The SHA256 hash of the file.
      - contextPath: File.SHA1
        description: The SHA1 hash of the file.
      - contextPath: File.MD5
        description: The MD5 hash of the file.
        type: String
      - contextPath: File.SSDeep
        description: The ssdeep hash of the file (same as displayed in file entries).
        type: String
      - contextPath: File.Tags
        description: Tags related the File use (hosting, proxy, tor, vpn).
        type: String
      - contextPath: File.FeedRelatedIndicators.value
        description: Names of indicators associated with the File.
        type: String
      - contextPath: File.FeedRelatedIndicators.type
        description: Types of indicators associated with the File.
        type: String
      - contextPath: DBotScore.Indicator
        description: The indicator that was tested.
        type: String
      - contextPath: DBotScore.Score
        description: The actual score.
        type: Number
      - contextPath: DBotScore.Reliability
        description: How reliable the score is (for example, "C - fairly reliable").
        type: String
      - contextPath: DBotScore.Type
        description: The indicator type.
        type: String
      - contextPath: DBotScore.Vendor
        description: The vendor used to calculate the score.
        type: String
  dockerimage: demisto/anyrun-sdk:1.0.0.5185978
  subtype: python3
  runonce: false
  script: '-'
  type: python
tests:
- No tests
fromversion: 6.0.0
