id: Detonate File From URL - ANYRUN
version: -1
name: Detonate File From URL - ANYRUN
description: |-
  Detonates one or more remote files using the ANYRUN sandbox integration.
  Returns relevant reports to the War Room and file reputations to the context data.
  This type of analysis works only for direct download links.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: b04c121d-294e-4dd0-8148-d9fe0f44be04
    type: start
    task:
      id: b04c121d-294e-4dd0-8148-d9fe0f44be04
      version: -1
      name: ""
      description: Start
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: f7bcffdc-ba6d-4549-814c-1c2b3bda9eda
    type: regular
    task:
      id: f7bcffdc-ba6d-4549-814c-1c2b3bda9eda
      version: -1
      name: ANYRUN Submit File from URL for Analysis
      description: Submit a file or url for analysis.
      script: ANYRUN|||anyrun-run-analysis
      type: regular
      iscommand: true
      brand: ANYRUN
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      interval_in_seconds:
        complex:
          root: inputs.Interval
      obj_type:
        simple: download
      obj_url:
        complex:
          root: inputs.URL
          accessor: Data
      polling:
        simple: "true"
      timeout:
        complex:
          root: inputs.Timeout
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 275,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 7e59cb60-98d6-49a0-8c7f-522c1247ee73
    type: title
    task:
      id: 7e59cb60-98d6-49a0-8c7f-522c1247ee73
      version: -1
      name: Done
      description: Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: a1d00028-5388-4ea3-8877-cb5b7fb2a5d0
    type: condition
    task:
      id: a1d00028-5388-4ea3-8877-cb5b7fb2a5d0
      version: -1
      name: Is there a download URL to detonate?
      description: Look for file URLs to detonate
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "1"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: inputs.URL
            iscontext: true
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: c8fd4c2c-6279-4eb4-8b8a-36b69bb4d578
    type: condition
    task:
      id: c8fd4c2c-6279-4eb4-8b8a-36b69bb4d578
      version: -1
      name: Is ANYRUN sandbox enabled?
      description: Returns 'yes' if integration brand is available. Otherwise returns 'no'
      scriptName: IsIntegrationAvailable
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "no":
      - "5"
      "yes":
      - "6"
    scriptarguments:
      brandname:
        simple: ANY.RUN
    results:
    - brandInstances
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
system: true
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 735,
        "width": 605,
        "x": 50,
        "y": 50
      }
    }
  }
inputs:
- key: URL
  value:
    complex:
      root: URL
  required: false
  description: URL of the web file to detonate.
  playbookInputQuery:
- key: Interval
  value:
    simple: "20"
  required: false
  description: Duration for executing the polling (in seconds)
  playbookInputQuery:
- key: Timeout
  value:
    simple: "1300"
  required: false
  description: The duration after which to stop polling and to resume the playbook (in seconds)
  playbookInputQuery:
outputs:
- contextPath: ANYRUN.Task.AnalysisDate
  description: Date and time the analysis was executed.
  type: String
- contextPath: ANYRUN.Task.Behavior.Category
  description: Category of a process behavior.
  type: String
- contextPath: ANYRUN.Task.Behavior.Action
  description: Actions performed by a process.
  type: String
- contextPath: ANYRUN.Task.Behavior.ThreatLevel
  description: Threat score associated with a process behavior.
  type: Number
- contextPath: ANYRUN.Task.Behavior.ProcessUUID
  description: Unique ID of the process whose behaviors are being profiled.
  type: String
- contextPath: ANYRUN.Task.Connection.Reputation
  description: Connection reputation.
  type: String
- contextPath: ANYRUN.Task.Connection.ProcessUUID
  description: ID of the process that created the connection.
  type: String
- contextPath: ANYRUN.Task.Connection.ASN
  description: Connection autonomous system network.
  type: String
- contextPath: ANYRUN.Task.Connection.Country
  description: Connection country.
  type: String
- contextPath: ANYRUN.Task.Connection.Protocol
  description: Connection protocol.
  type: String
- contextPath: ANYRUN.Task.Connection.Port
  description: Connection port number.
  type: Number
- contextPath: ANYRUN.Task.Connection.IP
  description: Connection IP number.
  type: String
- contextPath: ANYRUN.Task.DnsRequest.Reputation
  description: Reputation of the DNS request.
  type: String
- contextPath: ANYRUN.Task.DnsRequest.IP
  description: IP addresses associated with a DNS request.
  type: Unknown
- contextPath: ANYRUN.Task.DnsRequest.Domain
  description: Domain resolution of a DNS request.
  type: String
- contextPath: ANYRUN.Task.Threat.ProcessUUID
  description: Unique process ID from where the threat originated.
  type: String
- contextPath: ANYRUN.Task.Threat.Msg
  description: Threat message.
  type: String
- contextPath: ANYRUN.Task.Threat.Class
  description: Class of the threat.
  type: String
- contextPath: ANYRUN.Task.Threat.SrcPort
  description: Port on which the threat originated.
  type: Number
- contextPath: ANYRUN.Task.Threat.DstPort
  description: Destination port of the threat.
  type: Number
- contextPath: ANYRUN.Task.Threat.SrcIP
  description: Source IP address where the threat originated.
  type: String
- contextPath: ANYRUN.Task.Threat.DstIP
  description: Destination IP address of the threat.
  type: String
- contextPath: ANYRUN.Task.HttpRequest.Reputation
  description: Reputation of the HTTP request.
  type: String
- contextPath: ANYRUN.Task.HttpRequest.Country
  description: HTTP request country.
  type: String
- contextPath: ANYRUN.Task.HttpRequest.ProcessUUID
  description: ID of the process making the HTTP request.
  type: String
- contextPath: ANYRUN.Task.HttpRequest.Body
  description: HTTP request body parameters and details.
  type: Unknown
- contextPath: ANYRUN.Task.HttpRequest.HttpCode
  description: HTTP request response code.
  type: Number
- contextPath: ANYRUN.Task.HttpRequest.Status
  description: Status of the HTTP request.
  type: String
- contextPath: ANYRUN.Task.HttpRequest.ProxyDetected
  description: Whether the HTTP request was made through a proxy.
  type: Boolean
- contextPath: ANYRUN.Task.HttpRequest.Port
  description: HTTP request port.
  type: Number
- contextPath: ANYRUN.Task.HttpRequest.IP
  description: HTTP request IP address.
  type: String
- contextPath: ANYRUN.Task.HttpRequest.URL
  description: HTTP request URL.
  type: String
- contextPath: ANYRUN.Task.HttpRequest.Host
  description: HTTP request host.
  type: String
- contextPath: ANYRUN.Task.HttpRequest.Method
  description: HTTP request method type.
  type: String
- contextPath: ANYRUN.Task.FileInfo
  description: Details of the submitted file.
  type: String
- contextPath: ANYRUN.Task.OS
  description: OS of the sandbox in which the file was analyzed.
  type: String
- contextPath: ANYRUN.Task.ID
  description: The unique ID of the task.
  type: String
- contextPath: ANYRUN.Task.MIME
  description: The MIME of the file submitted for analysis.
  type: String
- contextPath: ANYRUN.Task.MD5
  description: The MD5 hash of the file submitted for analysis.
  type: String
- contextPath: ANYRUN.Task.SHA1
  description: The SHA1 hash of the file submitted for analysis.
  type: String
- contextPath: ANYRUN.Task.SHA256
  description: The SHA256 hash of the file submitted for analysis.
  type: String
- contextPath: ANYRUN.Task.SSDeep
  description: SSDeep hash of the file submitted for analysis.
  type: String
- contextPath: ANYRUN.Task.Verdict
  description: ANY.RUN verdict for the maliciousness of the submitted file or URL.
  type: String
- contextPath: ANYRUN.Task.Process.FileName
  description: File name of the process.
  type: String
- contextPath: ANYRUN.Task.Process.PID
  description: Process identification number.
  type: Number
- contextPath: ANYRUN.Task.Process.PPID
  description: Parent process identification number.
  type: Number
- contextPath: ANYRUN.Task.Process.ProcessUUID
  description: Unique process ID (used by ANY.RUN).
  type: String
- contextPath: ANYRUN.Task.Process.CMD
  description: Process command.
  type: String
- contextPath: ANYRUN.Task.Process.Path
  description: Path of the executed command.
  type: String
- contextPath: ANYRUN.Task.Process.User
  description: User who executed the command.
  type: String
- contextPath: ANYRUN.Task.Process.IntegrityLevel
  description: The process integrity level.
  type: String
- contextPath: ANYRUN.Task.Process.ExitCode
  description: Process exit code.
  type: Number
- contextPath: ANYRUN.Task.Process.MainProcess
  description: Whether the process is the main process.
  type: Boolean
- contextPath: ANYRUN.Task.Process.Version.Company
  description: Company responsible for the program executed.
  type: String
- contextPath: ANYRUN.Task.Process.Version.Description
  description: Description of the type of program.
  type: String
- contextPath: ANYRUN.Task.Process.Version.Version
  description: Version of the program executed.
  type: String
- contextPath: DBotScore.Indicator
  description: The indicator that was tested.
  type: String
- contextPath: DBotScore.Score
  description: The actual score.
  type: Number
- contextPath: DBotScore.Type
  description: Type of indicator.
  type: String
- contextPath: DBotScore.Vendor
  description: Vendor used to calculate the score.
  type: String
- contextPath: File.Extension
  description: Extension of the file submitted for analysis.
  type: String
- contextPath: File.Name
  description: The name of the file submitted for analysis.
  type: String
- contextPath: File.MD5
  description: MD5 hash of the file submitted for analysis.
  type: String
- contextPath: File.SHA1
  description: SHA1 hash of the file submitted for analysis.
  type: String
- contextPath: File.SHA256
  description: SHA256 hash of the file submitted for analysis.
  type: String
- contextPath: File.SSDeep
  description: SSDeep hash of the file submitted for analysis.
  type: String
- contextPath: File.Malicious.Vendor
  description: For malicious files, the vendor that made the decision.
  type: String
- contextPath: File.Malicious.Description
  description: For malicious files, the reason that the vendor made the decision.
  type: String
- contextPath: ANYRUN.Task.Status
  description: Task analysis status.
  type: String
tests:
- Detonate File From URL - ANYRUN - Test
fromversion: 6.2.0
