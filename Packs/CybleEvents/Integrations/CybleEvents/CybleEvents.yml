commonfields:
  id: CybleEvents
  version: -1
name: CybleEvents
display: Cyble Events
category: Data Enrichment & Threat Intelligence
description: Cyble Events for Vision Users. Must have Vision API access to use the
  threat intelligence.
configuration:
- display: Server URL (e.g. https://example.net)
  name: url
  defaultvalue: https://example.net
  type: 0
  required: true
- display: Access Token
  name: token
  type: 4
  required: true
- display: Trust any certificate (not secure)
  name: insecure
  type: 8
  required: false
- display: Use system proxy settings
  name: proxy
  type: 8
  required: false
- display: Fetch incidents
  name: isFetch
  type: 8
  required: false
- display: Incidents Fetch Interval
  name: incidentFetchInterval
  defaultvalue: "1"
  type: 19
  required: false
- display: Incident Fetch Limit
  name: max_fetch
  defaultvalue: "1"
  type: 0
  required: true
  additionalinfo: Maximum incidents to be fetched every time. Upper limit is 50 incidents.
- display: Incident type
  name: incidentType
  type: 13
  required: false
script:
  script: ""
  type: python
  commands:
  - name: cyble-vision-fetch-iocs
    arguments:
    - name: from
      description: Returns records started with given value
      defaultValue: "0"
    - name: limit
      description: Number of records to return (max 1000). Using a smaller limit will
        get faster responses.
      defaultValue: "1"
    - name: start_date
      description: Timeline start date in the format "YYYY-MM-DD". Need to used with
        end_date as timeline range.
    - name: end_date
      description: Timeline end date in the format "YYYY-MM-DD". Need to used with
        start_date as timeline range.
    - name: type
      description: Returns record by type like (CIDR, CVE, domain, email, FileHash-IMPHASH,
        FileHash-MD5, FileHash-PEHASH, FileHash-SHA1, FileHash-SHA256, FilePath, hostname,
        IPv4, IPv6, Mutex, NIDS, URI, URL, YARA, osquery, Ja3, Bitcoinaddress, Sslcertfingerprint).
    - name: keyword
      description: Returns records for the specified keyword
    outputs:
    - contextPath: CybleEvents.IoCs.data
      description: Returns indicator inital creation date
      type: String
    description: Fetch the indicators for the given timeline
  - name: cyble-vision-fetch-events
    arguments:
    - name: from
      required: true
      description: Returns records for the timeline starting from given indice
      defaultValue: "0"
    - name: limit
      required: true
      description: Number of records to return (max 50). Using a smaller limit will
        get faster responses.
      defaultValue: "5"
    - name: start_date
      required: true
      description: Timeline start date in the format "YYYY/MM/DD"
    - name: end_date
      required: true
      description: Timeline end date in the format "YYYY/MM/DD"
    - name: order_by
      required: true
      auto: PREDEFINED
      predefined:
      - Ascending
      - Descending
      description: Sorting order for alert fetch either Ascending or Descending
      defaultValue: Ascending
    outputs:
    - contextPath: CybleEvents.Events.cybleeventsid
      description: Returns the event ID
      type: String
    - contextPath: CybleEvents.Events.cybleeventstype
      description: Returns the event type
      type: String
    - contextPath: CybleEvents.Events.severity
      description: Returns the event severity
      type: Number
    - contextPath: CybleEvents.Events.occurred
      description: Returns the event occurred timeline
      type: Date
    - contextPath: CybleEvents.Events.name
      description: Returns the alert title
      type: String
    - contextPath: CybleEvents.Events.cybleeventsname
      description: Returns the event name
      type: String
    - contextPath: CybleEvents.Events.cybleeventsbucket
      description: Returns the event bucket name
      type: String
    - contextPath: CybleEvents.Events.cybleeventskeyword
      description: Returns the event keyword
      type: String
    - contextPath: CybleEvents.Events.cybleeventsalias
      description: Returns the event type alias name
      type: String
    description: Fetch Incident event alerts based on the given parameters
  - name: cyble-vision-fetch-event-detail
    arguments:
    - name: event_type
      required: true
      description: Event Type of the Incident
    - name: event_id
      required: true
      description: Event ID of the incident
    outputs:
    - contextPath: CybleEvents.Events.Details
      description: Returns details for given event of specific type
      type: String
    description: Fetch Incident detail based on event type and event ID
  dockerimage: demisto/python3:3.10.4.27798
  isfetch: true
  runonce: false
  subtype: python3
fromversion: 6.0.0
tests:
- No tests (auto formatted)
