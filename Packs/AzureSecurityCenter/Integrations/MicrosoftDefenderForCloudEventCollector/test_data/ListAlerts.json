[
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396773188188817_5c67ef0a-f746-44f5-8922-dfd4e92ac6cb",
    "name": "2517396773188188817_5c67ef0a-f746-44f5-8922-dfd4e92ac6cb",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:23.53895Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.1811182Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "alertType": "SIMULATED_APPS_WpThemeInjection",
      "startTimeUtc": "2022-09-08T07:51:21.1811182Z",
      "endTimeUtc": "2022-09-08T07:51:21.1811182Z",
      "severity": "High",
      "isIncident": false,
      "systemAlertId": "2517396773188188817_5c67ef0a-f746-44f5-8922-dfd4e92ac6cb",
      "intent": "Unknown",
      "resourceIdentifiers": [
        {
          "$id": "centralus_1",
          "azureResourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Web/sites/Sample-App",
          "type": "AzureResource",
          "azureResourceTenantId": "ebac1a16-81bf-449b-8d43-5732c3c1d999"
        }
      ],
      "compromisedEntity": "Sample-App",
      "alertDisplayName": "[SAMPLE ALERT] Suspicious WordPress theme invocation detected",
      "description": "THIS IS A SAMPLE ALERT: The Azure App Service activity log indicates a possible code injection activity on your App Service resource.\r\nThe suspicious activity detected resembles that of a manipulation of WordPress theme to support server side execution of code, followed by a direct web request to invoke the manipulated theme file.\r\nThis type of activity was seen in the past as part of an attack campaign over WordPress.",
      "remediationSteps": [
        "1. If WordPress is installed, make sure that the application is up to date and automatic updates are enabled.",
        "2. If only specific IP addresses should be allowed to access the web app, set IP restrictions (https://docs.microsoft.com/azure/app-service/app-service-ip-restrictions) for it."
      ],
      "extendedProperties": {
        "sample Source IP Addresses": "0.0.0.0",
        "sample User Agents": "Mozilla/5.0+(Windows+NT+10.0;+Win64;+x64;+rv:48.0)+Gecko/20100101+Firefox/48.0, Mozilla/5.0+(Windows+NT+10.0;+Win64;+x64)+AppleWebKit/537.36+(KHTML,+like+Gecko)+Chrome/63.0.3239.132+Safari/537.36",
        "last Event Time": "12/11/2019 12:34:27 AM",
        "sample Referer": "-",
        "sample URIs": "/login.php",
        "resourceType": "App Service"
      },
      "entities": [
        {
          "$id": "centralus_2",
          "hostName": "Sample-App",
          "azureID": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Web/sites/Sample-App",
          "type": "host"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396773188188817_5c67ef0a-f746-44f5-8922-dfd4e92ac6cb/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396773208188817_4492529b-fc4e-4a77-816e-0512ad8761f0",
    "name": "2517396773208188817_4492529b-fc4e-4a77-816e-0512ad8761f0",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:23.7323577Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.1811182Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "alertType": "SIMULATED_MaliciousContent-AzureWebApps",
      "startTimeUtc": "2022-09-08T07:51:19.1811182Z",
      "endTimeUtc": "2022-09-08T07:51:19.1811182Z",
      "severity": "High",
      "isIncident": false,
      "systemAlertId": "2517396773208188817_4492529b-fc4e-4a77-816e-0512ad8761f0",
      "intent": "Collection",
      "resourceIdentifiers": [
        {
          "$id": "centralus_3",
          "azureResourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Web/sites/Sample-App",
          "type": "AzureResource",
          "azureResourceTenantId": "ebac1a16-81bf-449b-8d43-5732c3c1d999"
        }
      ],
      "compromisedEntity": "Sample-App",
      "alertDisplayName": "[SAMPLE ALERT] Phishing content hosted on Azure Webapps",
      "description": "THIS IS A SAMPLE ALERT: URL used for phishing attack found on the Azure AppServices website. This URL was part of a phishing attack sent to O365 customers. The content typically lure visitors into entering their corporate credentials or financial information into a legitimate looking website.",
      "remediationSteps": [
        "1. Use Azure Web Sites Process Explorer and try to identify unknown running processes (see https://blogs.msdn.microsoft.com/waws/2014/11/14/viewing-process-information-for-microsoft-azure-web-sites/)",
        "2. Escalate the alert to the information security team."
      ],
      "extendedProperties": {
        "url": "https://sample.azurewebsites.net",
        "resourceType": "App Service",
        "killChainIntent": "Collection"
      },
      "entities": [
        {
          "$id": "centralus_4",
          "url": "https://sample.azurewebsites.net",
          "type": "url"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396773208188817_4492529b-fc4e-4a77-816e-0512ad8761f0/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396773228188817_67a23793-595b-4efb-ae23-679568966575",
    "name": "2517396773228188817_67a23793-595b-4efb-ae23-679568966575",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:23.9852762Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.1811182Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "alertType": "SIMULATED_KV_OperationVolumeAnomaly",
      "startTimeUtc": "2022-09-08T07:51:17.1811182Z",
      "endTimeUtc": "2022-09-08T07:51:17.1811182Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396773228188817_67a23793-595b-4efb-ae23-679568966575",
      "intent": "Unknown",
      "resourceIdentifiers": [
        {
          "$id": "centralus_5",
          "azureResourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/microsoft.keyvault/vaults/Sample-KV",
          "type": "AzureResource",
          "azureResourceTenantId": "ebac1a16-81bf-449b-8d43-5732c3c1d999"
        }
      ],
      "compromisedEntity": "Sample-KV",
      "alertDisplayName": "[SAMPLE ALERT] User accessed high volume of Key Vaults",
      "description": "THIS IS A SAMPLE ALERT: While may be benign it could also indicate that a larger volume of Key Vault operations has been performed compared to past historical data. Key Vaults typical exhibit the same behavior over time. This may be a legitimate change in activity but may also indicate that your Key Vault infrastructure has been compromised warranting further investigation.",
      "remediationSteps": [
        "Please review your activity logs to determine if the access attempts that triggered this alert were legitimate. If you are concerned that these access attempts may not have been legitimate, please contact your security administrator and disable access policies to the user or application and rotate the secrets, keys, and passwords stored in this key vault."
      ],
      "extendedProperties": {
        "resourceType": "Key Vault",
        "end Time UTC": "09/08/2022 07:51:17",
        "all vault operations in last 24 hours": "[SecretSet:1, SecretGet:5, Authentication:2, VaultGet:3]",
        "suspicious Operations": "[SecretGet:2, VaultGet:2]",
        "attacker IP Address": "0.0.0.0",
        "attacker Object ID": "00000000-0000-0000-0000-000000000000",
        "application ID": "00000000-0000-0000-0000-000000000000",
        "result Signature": "OK",
        "start Time UTC": "09/08/2022 07:51:17",
        "client Information": "Microsoft.Azure.Management.Resources.ResourceManagementClient/2.0.0.0, ",
        "alert Reasons": "[The application(appid) does not usually come from this IP, The application(appid) performed more operations than usual, The user(objid) does not usually come from this IP, The user(objid) performed more operations than usual, This vault is not usually accessed from this IP] Note: related application(appid), user(objid), IP and operations are included in appid, objid, callerIpAddress and suspiciousOperations entries, respectively",
        "target": "https://sample.vault.azure.net/secrets/sample"
      },
      "entities": [
        {
          "$id": "centralus_6",
          "resourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/microsoft.keyvault/vaults/Sample-KV",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_7",
          "aadUserId": "00000000-0000-0000-0000-000000000000",
          "isValid": false,
          "type": "account"
        },
        {
          "$id": "centralus_8",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington"
          },
          "type": "ip"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396773228188817_67a23793-595b-4efb-ae23-679568966575/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396773248188817_c41add99-51f1-466d-9c86-b9727c8496c3",
    "name": "2517396773248188817_c41add99-51f1-466d-9c86-b9727c8496c3",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:23.7120684Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.1811182Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "alertType": "SIMULATED_KV_AccountVolumeAnomaly",
      "startTimeUtc": "2022-09-08T07:51:15.1811182Z",
      "endTimeUtc": "2022-09-08T07:51:15.1811182Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396773248188817_c41add99-51f1-466d-9c86-b9727c8496c3",
      "intent": "Unknown",
      "resourceIdentifiers": [
        {
          "$id": "centralus_9",
          "azureResourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/microsoft.keyvault/vaults/Sample-KV",
          "type": "AzureResource",
          "azureResourceTenantId": "ebac1a16-81bf-449b-8d43-5732c3c1d999"
        }
      ],
      "compromisedEntity": "Sample-KV",
      "alertDisplayName": "[SAMPLE ALERT] High volume of operations in a Key Vault",
      "description": "THIS IS A SAMPLE ALERT: While may be benign it could also indicate that the number of vaults that a user or application accesses has changed compared to past historical data. Key Vault activity typically exhibits the same behavior over time. This may be a legitimate change in activity but may also indicate that your Key Vault infrastructure has been compromised warranting further investigation.",
      "remediationSteps": [
        "Please review your activity logs to determine if the access attempts that triggered this alert were legitimate. If you are concerned that these access attempts may not have been legitimate, please contact your security administrator and disable access policies to the user or application and rotate the secrets, keys, and passwords stored in this key vault."
      ],
      "extendedProperties": {
        "resourceType": "Key Vault",
        "end Time UTC": "09/08/2022 07:51:15",
        "all vault operations in last 24 hours": "[AfterAuthentication:1, SecretGet:345545, EventGridGetAllSubscriptions:19, Authentication:169, VaultGet:3]",
        "suspicious Operations": "[SecretGet:64]",
        "attacker IP Address": "0.0.0.0",
        "attacker Object ID": "00000000-0000-0000-0000-000000000000",
        "application ID": "00000000-0000-0000-0000-000000000000",
        "result Signature": "OK",
        "start Time UTC": "09/08/2022 07:51:15",
        "alert Reasons": "[The application(appid) accessed more vaults than usual, The application(appid) does not usually come from this IP, The user(objid) accessed more vaults than usual, The user(objid) does not usually come from this IP, This vault is not usually accessed from this IP] Note: related application(appid), user(objid), IP and operations are included in appid, objid, callerIpAddress and suspiciousOperations entries, respectively",
        "target": "https://sample.vault.azure.net/secrets/sample"
      },
      "entities": [
        {
          "$id": "centralus_10",
          "resourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/microsoft.keyvault/vaults/Sample-KV",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_11",
          "aadUserId": "00000000-0000-0000-0000-000000000000",
          "isValid": false,
          "type": "account"
        },
        {
          "$id": "centralus_12",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington"
          },
          "type": "ip"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396773248188817_c41add99-51f1-466d-9c86-b9727c8496c3/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396773268188817_901ed6b6-681a-4eee-9ba3-7dc400234ec0",
    "name": "2517396773268188817_901ed6b6-681a-4eee-9ba3-7dc400234ec0",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:24.0967782Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.1811182Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "alertType": "SIMULATED_KV_ListGetAnomaly",
      "startTimeUtc": "2022-09-08T07:51:13.1811182Z",
      "endTimeUtc": "2022-09-08T07:51:13.1811182Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396773268188817_901ed6b6-681a-4eee-9ba3-7dc400234ec0",
      "intent": "Unknown",
      "resourceIdentifiers": [
        {
          "$id": "centralus_13",
          "azureResourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/microsoft.keyvault/vaults/Sample-KV",
          "type": "AzureResource",
          "azureResourceTenantId": "ebac1a16-81bf-449b-8d43-5732c3c1d999"
        }
      ],
      "compromisedEntity": "Sample-KV",
      "alertDisplayName": "[SAMPLE ALERT] Suspicious secret listing and query in a Key Vault",
      "description": "THIS IS A SAMPLE ALERT: While may be benign it could also indicate that a Secret List operation was followed by numerous Secret Get operations. In addition, this operation pattern is not normally performed by the user on this vault. This is likely indicative that someone is dumping the This is sample alert: secrets stored in the Key Vault for potentially malicious purposes.",
      "remediationSteps": [
        "Please review your activity logs to determine if the access attempts that triggered this alert were legitimate. If you are concerned that these access attempts may not have been legitimate, please contact your security administrator and disable access policies to the user or application and rotate the secrets, keys, and passwords stored in this key vault."
      ],
      "extendedProperties": {
        "resourceType": "Key Vault",
        "end Time UTC": "09/08/2022 07:51:13",
        "all vault operations in last 24 hours": "[Authentication:1, SecretGet:3, VaultGet:1, SecretList:5]",
        "suspicious Operations": "[SecretGet:3, SecretList:5]",
        "attacker IP Address": "0.0.0.0",
        "attacker Object ID": "00000000-0000-0000-0000-000000000000",
        "application ID": "00000000-0000-0000-0000-000000000000",
        "result Signature": "OK",
        "start Time UTC": "09/08/2022 07:51:13",
        "client Information": "FxVersion/4.8.4075.0 OSName/Windows10Enterprise OSVersion/6.3.18363 Microsoft.Azure.KeyVault.KeyVaultClient/0.0.0.0",
        "alert Reasons": "[The application(appid) does not usually access this vault, The application(appid) does not usually come from this IP, The application(appid) does not usually perform a credential list operation followed by a get operation, The application(appid) does not usually perform this operation, The number of applications which accessed this vault is more than usual, The number of users(objid) who accessed this vault is more than usual, The user(objid) does not usually access this vault, The user(objid) does not usually come from this IP, The user(objid) does not usually perform a credential list operation followed by a get operation, The user(objid) does not usually perform this operation, This vault does not usually have a credential list operation followed by a get operation, This vault does not usually have this operation, This vault had more operations than usual, This vault had more types of operations than usual, This vault is not usually accessed from this IP] Note: related application(appid), user(objid), IP and operations are included in appid, objid, callerIpAddress and suspiciousOperations entries, respectively",
        "target": "https://sample.vault.azure.net/secrets/sample"
      },
      "entities": [
        {
          "$id": "centralus_14",
          "resourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/microsoft.keyvault/vaults/Sample-KV",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_15",
          "aadUserId": "00000000-0000-0000-0000-000000000000",
          "isValid": false,
          "type": "account"
        },
        {
          "$id": "centralus_16",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington"
          },
          "type": "ip"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396773268188817_901ed6b6-681a-4eee-9ba3-7dc400234ec0/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396773288188817_2b40c27b-54e1-4348-8018-e91744f4b628",
    "name": "2517396773288188817_2b40c27b-54e1-4348-8018-e91744f4b628",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:24.0790268Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.1811182Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "alertType": "SIMULATED_KV_PutGetAnomaly",
      "startTimeUtc": "2022-09-08T07:51:11.1811182Z",
      "endTimeUtc": "2022-09-08T07:51:11.1811182Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396773288188817_2b40c27b-54e1-4348-8018-e91744f4b628",
      "intent": "Unknown",
      "resourceIdentifiers": [
        {
          "$id": "centralus_17",
          "azureResourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/microsoft.keyvault/vaults/Sample-KV",
          "type": "AzureResource",
          "azureResourceTenantId": "ebac1a16-81bf-449b-8d43-5732c3c1d999"
        }
      ],
      "compromisedEntity": "Sample-KV",
      "alertDisplayName": "[SAMPLE ALERT] Suspicious policy change and secret query in a Key Vault",
      "description": "THIS IS A SAMPLE ALERT: While may be benign it could also indicate that a Key Vault policy change has been made and operations to list and/or get secrets occurred shortly thereafter. In addition, this operation pattern is not normally performed by the user on this vault. This is highly indicative that the Key Vault has been compromised and the secrets within have been stolen by a malicious actor.",
      "remediationSteps": [
        "Please review your activity logs to determine if the access attempts that triggered this alert were legitimate. If you are concerned that these access attempts may not have been legitimate, please contact your security administrator and disable access policies to the user or application and rotate the secrets, keys, and passwords stored in this key vault."
      ],
      "extendedProperties": {
        "resourceType": "Key Vault",
        "end Time UTC": "09/08/2022 07:51:11",
        "all vault operations in last 24 hours": "[VaultGet:14, CertificateImport:1, CertificateGet:479, VaultPut:4, SecretGet:760, Authentication:3]",
        "suspicious Operations": "[SecretGet:2, VaultPut:4, VaultGet:5, CertificateGet:24]",
        "attacker IP Address": "0.0.0.0",
        "attacker Object ID": "00000000-0000-0000-0000-000000000000",
        "client Information": "FxVersion/4.8.4121.0, FxVersion/4.8.4121.0 OSName/Windows10Enterprise OSVersion/6.3.17763 Microsoft.Azure.KeyVault.KeyVaultClient/0.0.0.0",
        "result Signature": "OK",
        "application ID": "00000000-0000-0000-0000-000000000000",
        "start Time UTC": "09/08/2022 07:51:11",
        "alert Reasons": "[The application(appid) does not usually come from this IP, The application(appid) does not usually perform a policy change operation followed by a credential get operation, The application(appid) does not usually perform this operation, The user(objid) does not usually come from this IP, The user(objid) does not usually perform a policy change operation followed by a credential get operation, The user(objid) does not usually perform this operation, This vault does not usually have a policy change operation followed by a credential get operation, This vault does not usually have this operation, This vault is not usually accessed from this IP] Note: related application(appid), user(objid), IP and operations are included in appid, objid, callerIpAddress and suspiciousOperations entries, respectively",
        "target": "https://sample.vault.azure.net/secrets/sample"
      },
      "entities": [
        {
          "$id": "centralus_18",
          "resourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/microsoft.keyvault/vaults/Sample-KV",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_19",
          "aadUserId": "00000000-0000-0000-0000-000000000000",
          "isValid": false,
          "type": "account"
        },
        {
          "$id": "centralus_20",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington"
          },
          "type": "ip"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396773288188817_2b40c27b-54e1-4348-8018-e91744f4b628/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396773308188817_4e08b729-4745-4a94-9242-ea35b802bf8d",
    "name": "2517396773308188817_4e08b729-4745-4a94-9242-ea35b802bf8d",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:24.0029362Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.1811182Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "alertType": "SIMULATED_KV_TORAccess",
      "startTimeUtc": "2022-09-08T07:51:09.1811182Z",
      "endTimeUtc": "2022-09-08T07:51:09.1811182Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396773308188817_4e08b729-4745-4a94-9242-ea35b802bf8d",
      "intent": "Unknown",
      "resourceIdentifiers": [
        {
          "$id": "centralus_21",
          "azureResourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/microsoft.keyvault/vaults/Sample-KV",
          "type": "AzureResource",
          "azureResourceTenantId": "ebac1a16-81bf-449b-8d43-5732c3c1d999"
        }
      ],
      "compromisedEntity": "Sample-KV",
      "alertDisplayName": "[SAMPLE ALERT] Access from a TOR exit node to a Key Vault",
      "description": "THIS IS A SAMPLE ALERT: While may be benign it could also indicate that the Key Vault has been accessed by someone using the TOR IP anonymization system to hide their true source location. This is suspicious because malicious actors will often try to mask their source location when attempting to gain unauthorized access to internet-connected resources.",
      "remediationSteps": [
        "Please review your activity logs to determine if the access attempts that triggered this alert were legitimate. If you are concerned that these access attempts may not have been legitimate, please contact your security administrator and disable access policies to the user or application and rotate the secrets, keys, and passwords stored in this key vault."
      ],
      "extendedProperties": {
        "resourceType": "Key Vault",
        "end Time UTC": "09/08/2022 07:51:09",
        "all vault operations in last 24 hours": "[Authentication:777440, SecretSet:1, SecretGet:777399]",
        "suspicious Operations": "[Authentication:1, SecretGet:1]",
        "attacker IP Address": "0.0.0.0",
        "attacker Object ID": "00000000-0000-0000-0000-000000000000",
        "result Signature": "Not Found, Unauthorized",
        "start Time UTC": "09/08/2022 07:51:09",
        "application ID": "00000000-0000-0000-0000-000000000000",
        "client Information": "python/3.8.0 (Windows-10-10.0.17763-SP0) msrest/0.6.11 msrest_azure/0.6.2 azure-keyvault/7.0 Azure-SDK-For-Python",
        "alert Reasons": "[The Key Vault has been accessed by someone using the TOR IP anonymization system to hide their true source location.]",
        "target": "https://sample.vault.azure.net/secrets/sample"
      },
      "entities": [
        {
          "$id": "centralus_22",
          "resourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/microsoft.keyvault/vaults/Sample-KV",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_23",
          "aadUserId": "00000000-0000-0000-0000-000000000000",
          "isValid": false,
          "type": "account"
        },
        {
          "$id": "centralus_24",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington"
          },
          "type": "ip"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396773308188817_4e08b729-4745-4a94-9242-ea35b802bf8d/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396773328188817_98fea651-bb1a-4e4c-8bf8-83134d2aee32",
    "name": "2517396773328188817_98fea651-bb1a-4e4c-8bf8-83134d2aee32",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:23.7705058Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.1811182Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "alertType": "SIMULATED_AKS_SensitiveMount",
      "startTimeUtc": "2022-09-08T07:51:07.1811182Z",
      "endTimeUtc": "2022-09-08T07:51:07.1811182Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396773328188817_98fea651-bb1a-4e4c-8bf8-83134d2aee32",
      "intent": "PrivilegeEscalation",
      "resourceIdentifiers": [
        {
          "$id": "centralus_25",
          "azureResourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/PROVIDERS/MICROSOFT.CONTAINERSERVICE/MANAGEDCLUSTERS/Sample-KubernetesService",
          "type": "AzureResource",
          "azureResourceTenantId": "ebac1a16-81bf-449b-8d43-5732c3c1d999"
        }
      ],
      "compromisedEntity": "Sample-KubernetesService",
      "alertDisplayName": "[SAMPLE ALERT] Container with a sensitive volume mount detected",
      "description": "THIS IS A SAMPLE ALERT: Kubernetes audit log analysis detected a new container with a sensitive volume mount. The volume that was detected is a hostPath type which mounts a sensitive file or folder from the node to the container. If the container gets compromised, the attacker can use this mount for gaining access to the node.",
      "remediationSteps": [
        "Review the container and the path in the alert details.",
        "If possible, consider mounting only specific folders or files that are necessary to the container operation.",
        "If the container is not legitimate, escalate the alert to the information security team."
      ],
      "extendedProperties": {
        "resourceType": "Kubernetes Service",
        "namespace": "Sample",
        "container image": "sample-image",
        "container name": "sample-container",
        "pod name": "sample-pod",
        "sensitive mount name": "sample-mount",
        "sensitive mount path": "/Sample",
        "killChainIntent": "PrivilegeEscalation"
      },
      "entities": [
        {
          "$id": "centralus_26",
          "resourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/PROVIDERS/MICROSOFT.CONTAINERSERVICE/MANAGEDCLUSTERS/Sample-KubernetesService",
          "type": "azure-resource"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396773328188817_98fea651-bb1a-4e4c-8bf8-83134d2aee32/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396773348188817_6315f461-6bac-4001-80ad-23fbc65eb891",
    "name": "2517396773348188817_6315f461-6bac-4001-80ad-23fbc65eb891",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:23.9183914Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.1811182Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "",
      "alertType": "SIMULATED_AKS_ExposedService",
      "startTimeUtc": "2022-09-08T07:51:05.1811182Z",
      "endTimeUtc": "2022-09-08T07:51:05.1811182Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396773348188817_6315f461-6bac-4001-80ad-23fbc65eb891",
      "intent": "InitialAccess",
      "resourceIdentifiers": [
        {
          "$id": "centralus_27",
          "azureResourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/PROVIDERS/MICROSOFT.CONTAINERSERVICE/MANAGEDCLUSTERS/Sample-KubernetesService",
          "type": "AzureResource",
          "azureResourceTenantId": "ebac1a16-81bf-449b-8d43-5732c3c1d999"
        }
      ],
      "compromisedEntity": "Sample-KubernetesService",
      "alertDisplayName": "[SAMPLE ALERT] Exposed Kubernetes service detected",
      "description": "THIS IS A SAMPLE ALERT: The Kubernetes audit log analysis detected exposure of a service by a load balancer. This service is related to a sensitive application that allows high impact operations in the cluster such as running processes on the node or creating new containers.\nIn some cases, this service doesn't require authentication. If the service doesn't require authentication, exposing it to the internet poses a security risk.",
      "remediationSteps": [
        "1. Find the external IP address of the service with the command: kubectl get service [service name] -n [namespace]. The service name and namespace are in the alert details.\\n2. Check whether the service is exposed to the internet by trying to access to its IP address with the port listed in the alert details.\\n3. If the service is exposed to the internet and is not protected by an authentication mechanism, escalate the alert to your security information team."
      ],
      "extendedProperties": {
        "resourceType": "Kubernetes Service",
        "namespace": "sample-namespace",
        "username": "sample-user",
        "service name": "sample-service",
        "target port": "8080",
        "port": "8080",
        "killChainIntent": "InitialAccess"
      },
      "entities": [
        {
          "$id": "centralus_28",
          "resourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/PROVIDERS/MICROSOFT.CONTAINERSERVICE/MANAGEDCLUSTERS/Sample-KubernetesService",
          "type": "azure-resource"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396773348188817_6315f461-6bac-4001-80ad-23fbc65eb891/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396773388188817_a4571fe0-2158-4d45-9d95-6bc016c838dd",
    "name": "2517396773388188817_a4571fe0-2158-4d45-9d95-6bc016c838dd",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:24.1184044Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.1811182Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "alertType": "SIMULATED_SQL.DB_BruteForce",
      "startTimeUtc": "2022-09-08T07:51:01.1811182Z",
      "endTimeUtc": "2022-09-08T07:51:01.1811182Z",
      "severity": "High",
      "isIncident": false,
      "systemAlertId": "2517396773388188817_a4571fe0-2158-4d45-9d95-6bc016c838dd",
      "intent": "Probing",
      "resourceIdentifiers": [
        {
          "$id": "centralus_29",
          "azureResourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Sql/servers/Sample-SQL/databases/Sample-DB",
          "type": "AzureResource",
          "azureResourceTenantId": "ebac1a16-81bf-449b-8d43-5732c3c1d999"
        }
      ],
      "compromisedEntity": "Sample-SQL",
      "alertDisplayName": "[SAMPLE ALERT] Potential SQL Brute Force attempt",
      "description": "THIS IS A SAMPLE ALERT: Someone is attempting to brute force credentials to your SQL server 'Sample-SQL'.",
      "remediationSteps": [
        "Go to the firewall settings in order to lock down the firewall as tightly as possible."
      ],
      "extendedProperties": {
        "resourceType": "SQL Database",
        "potential causes": "Brute force attack, penetration testing.",
        "client IP Address": "0.0.0.0",
        "client Principal Name": "Sample-account",
        "client Application": "Sample-app",
        "client IP Location": "Boydton, United States",
        "recommendations": "{\"displayValue\":\"Ensure the use of strong passwords, and avoid reusing them across multiple databases.\",\"kind\":\"Link\",\"value\":\"https:\\/\\/go.microsoft.com\\/fwlink\\/?linkid=2099068\"}",
        "data Center": "East US 2",
        "failed Logins": "0",
        "enrichment_tas_threat__reports": "{\"Kind\":\"MultiLink\",\"DisplayValueToUrlDictionary\":{\"Report: Brute Force\":\"https://interflowwebportalext.trafficmanager.net/reports/DisplayReport?callerIdentity=ddd5443d-e6f4-441c-b52b-5278d2f21dfa&reportCreateDateTime=2022-09-08T06%3a56%3a37&reportName=MSTI-TS-Brute-Force.pdf&tenantId=8b153744-38d4-428f-9975-5261847e55ae&urlCreateDateTime=2022-09-08T06%3a56%3a37&token=vo8ayXsNj8uoLa5pUcnliB8G5zaswVGtTjHmwPF%20M7c=\"}}",
        "killChainIntent": "Probing"
      },
      "extendedLinks": [
        {
          "href": "https://interflowwebportalext.trafficmanager.net/reports/DisplayReport?callerIdentity=ddd5443d-e6f4-441c-b52b-5278d2f21dfa&reportCreateDateTime=2022-09-08T06%3a56%3a37&reportName=MSTI-TS-Brute-Force.pdf&tenantId=8b153744-38d4-428f-9975-5261847e55ae&urlCreateDateTime=2022-09-08T06%3a56%3a37&token=vo8ayXsNj8uoLa5pUcnliB8G5zaswVGtTjHmwPF%20M7c=",
          "category": "enrichment_tas_threat__reports",
          "label": "Report: Brute Force",
          "type": "webLink"
        },
        {
          "href": "https://interflowwebportalext.trafficmanager.net/reports/DisplayReport?callerIdentity=ddd5443d-e6f4-441c-b52b-5278d2f21dfa&reportCreateDateTime=2022-09-08T06%3a56%3a37&reportName=MSTI-TS-Brute-Force.pdf&tenantId=8b153744-38d4-428f-9975-5261847e55ae&urlCreateDateTime=2022-09-08T06%3a56%3a37&token=vo8ayXsNj8uoLa5pUcnliB8G5zaswVGtTjHmwPF%20M7c=",
          "category": "enrichment_tas_threat__reports",
          "label": "Report: Brute Force",
          "type": "webLink"
        }
      ],
      "entities": [
        {
          "$id": "centralus_30",
          "address": "0.0.0.0",
          "location": {
            "countryName": "United States",
            "city": "Boydton"
          },
          "type": "ip"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396773388188817_a4571fe0-2158-4d45-9d95-6bc016c838dd/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396773408188817_1ee161ad-ecef-4d7c-9431-20ac2e6f0f63",
    "name": "2517396773408188817_1ee161ad-ecef-4d7c-9431-20ac2e6f0f63",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:24.2783355Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.1811182Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "alertType": "SIMULATED_SQL.DB_HarmfulApplication",
      "startTimeUtc": "2022-09-08T07:50:59.1811182Z",
      "endTimeUtc": "2022-09-08T07:50:59.1811182Z",
      "severity": "High",
      "isIncident": false,
      "systemAlertId": "2517396773408188817_1ee161ad-ecef-4d7c-9431-20ac2e6f0f63",
      "intent": "Probing",
      "resourceIdentifiers": [
        {
          "$id": "centralus_31",
          "azureResourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Sql/servers/Sample-SQL/databases/Sample-DB",
          "type": "AzureResource",
          "azureResourceTenantId": "ebac1a16-81bf-449b-8d43-5732c3c1d999"
        }
      ],
      "compromisedEntity": "Sample-SQL",
      "alertDisplayName": "[SAMPLE ALERT] Attempted logon by a potentially harmful application",
      "description": "THIS IS A SAMPLE ALERT: A potentially harmful application attempted to access  SQL server 'Sample-SQL'.",
      "remediationSteps": [
        "Go to the firewall settings in order to lock down the firewall as tightly as possible."
      ],
      "extendedProperties": {
        "resourceType": "SQL Database",
        "potential causes": "Penetration testing, malicious activity",
        "client IP Address": "0.0.0.0",
        "client Principal Name": "Sample-account",
        "client Application": "Sample-app",
        "client IP Location": "Boydton, United States",
        "recommendations": "{\"displayValue\":\"Ensure the use of strong passwords, and avoid reusing them across multiple databases.\",\"kind\":\"Link\",\"value\":\"https:\\/\\/go.microsoft.com\\/fwlink\\/?linkid=2099068\"}",
        "successful Logins from potentially harmful application": "1",
        "data Center": "East US 2",
        "killChainIntent": "Probing"
      },
      "entities": [
        {
          "$id": "centralus_32",
          "address": "0.0.0.0",
          "location": {
            "countryName": "United States",
            "city": "Boydton"
          },
          "type": "ip"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396773408188817_1ee161ad-ecef-4d7c-9431-20ac2e6f0f63/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396773428188817_1d80a6d8-e982-4cc7-a9c7-0a5faac82b0a",
    "name": "2517396773428188817_1d80a6d8-e982-4cc7-a9c7-0a5faac82b0a",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:24.1652713Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.1811182Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "alertType": "SIMULATED_SQL.DB_PotentialSqlInjection",
      "startTimeUtc": "2022-09-08T07:50:57.1811182Z",
      "endTimeUtc": "2022-09-08T07:50:57.1811182Z",
      "severity": "High",
      "isIncident": false,
      "systemAlertId": "2517396773428188817_1d80a6d8-e982-4cc7-a9c7-0a5faac82b0a",
      "intent": "Unknown",
      "resourceIdentifiers": [
        {
          "$id": "centralus_33",
          "azureResourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Sql/servers/Sample-SQL/databases/Sample-DB",
          "type": "AzureResource",
          "azureResourceTenantId": "ebac1a16-81bf-449b-8d43-5732c3c1d999"
        }
      ],
      "compromisedEntity": "Sample-SQL",
      "alertDisplayName": "[SAMPLE ALERT] Potential SQL Injection",
      "description": "THIS IS A SAMPLE ALERT: Potential SQL Injection was detected on your database elitronix-com on server Sample-SQL",
      "remediationSteps": [
        "{\"displayValue\":\"Read more about SQL Injection threats and best practices for safe application code.\",\"kind\":\"Link\",\"value\":\"https:\\/\\/www.microsoft.com\\/en-us\\/download\\/details.aspx?id=13759\"}"
      ],
      "extendedProperties": {
        "resourceType": "SQL Database",
        "potential causes": "Defect in application code constructing faulty SQL statements; application code doesn't sanitize user input and was exploited to inject malicious SQL statements.",
        "threat ID": "30",
        "ip address": "0.0.0.0",
        "principal name": "Sample-account",
        "application": "Internet Information Services",
        "database": "Sample-DB",
        "server": "Sample-SQL"
      },
      "entities": [
        {
          "$id": "centralus_34",
          "resourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Sql/servers/Sample-SQL/databases/Sample-DB",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_35",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Iowa",
            "city": "Des Moines"
          },
          "type": "ip"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396773428188817_1d80a6d8-e982-4cc7-a9c7-0a5faac82b0a/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396773448188817_15c7f647-13d1-4a4d-b926-f58eed01f7a2",
    "name": "2517396773448188817_15c7f647-13d1-4a4d-b926-f58eed01f7a2",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:24.452672Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.1811182Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "alertType": "SIMULATED_SQL.DB_GeoAnomaly",
      "startTimeUtc": "2022-09-08T07:50:55.1811182Z",
      "endTimeUtc": "2022-09-08T07:50:55.1811182Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396773448188817_15c7f647-13d1-4a4d-b926-f58eed01f7a2",
      "intent": "Exploitation",
      "resourceIdentifiers": [
        {
          "$id": "centralus_36",
          "azureResourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Sql/servers/Sample-SQL/databases/Sample-DB",
          "type": "AzureResource",
          "azureResourceTenantId": "ebac1a16-81bf-449b-8d43-5732c3c1d999"
        }
      ],
      "compromisedEntity": "Sample-SQL",
      "alertDisplayName": "[SAMPLE ALERT] Logon from an unusual location",
      "description": "THIS IS A SAMPLE ALERT: Someone logged on to your SQL server Sample-SQL from an unusual location.",
      "remediationSteps": [
        "Go to the firewall settings in order to lock down the firewall as tightly as possible."
      ],
      "extendedProperties": {
        "resourceType": "SQL Database",
        "potential causes": "Unauthorized access that exploits an opening in the firewall; legitimate access from a new location.",
        "client IP Address": "0.0.0.0",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "client Principal Name": "Sample-account",
        "client Application": "Microsoft SQL Server Management Studio",
        "client IP Location": "US",
        "recommendations": "{\"displayValue\":\"Ensure the use of strong passwords, and avoid reusing them across multiple databases.\",\"kind\":\"Link\",\"value\":\"https:\\/\\/go.microsoft.com\\/fwlink\\/?linkid=2099068\"}",
        "client Hostname": "Sample-VM",
        "killChainIntent": "Exploitation"
      },
      "entities": [
        {
          "$id": "centralus_37",
          "address": "0.0.0.0",
          "location": {
            "countryName": "US",
            "city": "New York"
          },
          "type": "ip"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396773448188817_15c7f647-13d1-4a4d-b926-f58eed01f7a2/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396773468188817_bf92c97a-3759-4802-a369-29ff2fc14036",
    "name": "2517396773468188817_bf92c97a-3759-4802-a369-29ff2fc14036",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:24.2783355Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.1811182Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "alertType": "SIMULATED_SQL.DB_DataExfiltration.ImportExportLocationAnomaly",
      "startTimeUtc": "2022-09-08T07:50:53.1811182Z",
      "endTimeUtc": "2022-09-08T07:50:53.1811182Z",
      "severity": "High",
      "isIncident": false,
      "systemAlertId": "2517396773468188817_bf92c97a-3759-4802-a369-29ff2fc14036",
      "intent": "Exfiltration",
      "resourceIdentifiers": [
        {
          "$id": "centralus_38",
          "azureResourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Sql/servers/Sample-SQL/databases/Sample-DB",
          "type": "AzureResource",
          "azureResourceTenantId": "ebac1a16-81bf-449b-8d43-5732c3c1d999"
        }
      ],
      "compromisedEntity": "Sample-SQL",
      "alertDisplayName": "[SAMPLE ALERT] Unusual export location",
      "description": "THIS IS A SAMPLE ALERT: Someone has extracted a massive amount of data from your SQL Server 'Sample-SQL' to an unusual location.",
      "remediationSteps": [
        "{\"displayValue\":\"Be sure to secure the new copy of your SQL server in the unusual storage account and follow the principle of \\\"least privilege\\\" for your SQL server\",\"kind\":\"Link\",\"value\":\"https:\\/\\/docs.microsoft.com\\/en-us\\/dotnet\\/framework\\/data\\/adonet\\/sql\\/authorization-and-permissions-in-sql-server\"}"
      ],
      "extendedProperties": {
        "resourceType": "SQL Database",
        "client IP Address": "0.0.0.0",
        "client Principal Name": "Sample-account",
        "client Application": "Sample-app",
        "storage Name": "Sample-storage",
        "killChainIntent": "Exfiltration"
      },
      "entities": [
        {
          "$id": "centralus_39",
          "location": {
            "countryName": "US",
            "city": "New York"
          },
          "isValid": false,
          "type": "ip"
        },
        {
          "$id": "centralus_40",
          "resourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Sql/servers/Sample-SQL/databases/Sample-DB",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_41",
          "sourceAddress": {
            "$ref": "centralus_39"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396773468188817_bf92c97a-3759-4802-a369-29ff2fc14036/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396773567877093_2e841069-2215-4fd3-813c-f146589da2bc",
    "name": "2517396773567877093_2e841069-2215-4fd3-813c-f146589da2bc",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:25.392451Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.2122906Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "alertType": "SIMULATED_VM_SuspectExecutablePath",
      "startTimeUtc": "2022-09-08T07:50:43.2122906Z",
      "endTimeUtc": "2022-09-08T07:50:43.2122906Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396773567877093_2e841069-2215-4fd3-813c-f146589da2bc",
      "intent": "Execution",
      "resourceIdentifiers": [
        {
          "$id": "centralus_42",
          "azureResourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM",
          "type": "AzureResource",
          "azureResourceTenantId": "ebac1a16-81bf-449b-8d43-5732c3c1d999"
        },
        {
          "$id": "centralus_43",
          "workspaceId": "00000000-0000-0000-0000-000000000001",
          "workspaceSubscriptionId": "00000000-0000-0000-0000-000000000001",
          "workspaceResourceGroup": "defaultresourcegroup-wus",
          "agentId": "00000000-0000-0000-0000-000000000001",
          "type": "LogAnalytics",
          "workspaceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-VM",
      "alertDisplayName": "[SAMPLE ALERT] Executable found running from a suspicious location",
      "description": "THIS IS A SAMPLE ALERT: Analysis of host data detected an executable file on Sample-VM that is running from a location in common with known suspicious files. This executable could either be legitimate activity, or an indication of a compromised host.",
      "remediationSteps": [
        "Review with %{User Name} the suspicious process in this alert to see if you recognise this as legitimate administrative activity. If not, Escalate the alert to the information security team."
      ],
      "extendedProperties": {
        "resourceType": "Virtual Machine",
        "suspicious Process Id": "0x1eec",
        "compromised Host": "Sample-VM",
        "account Session Id": "0x3e7",
        "suspicious Process": "c:\\windows\\inf\\sample.exe",
        "suspicious Command Line": "c:\\windows\\inf\\sample.exe",
        "user Name": "WORKGROUP\\Sample-account",
        "killChainIntent": "Execution"
      },
      "entities": [
        {
          "$id": "centralus_44",
          "dnsDomain": "",
          "ntDomain": "",
          "hostName": "Sample-VM",
          "netBiosName": "Sample-VM",
          "azureID": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM",
          "omsAgentID": "00000000-0000-0000-0000-000000000000",
          "osFamily": "Windows",
          "osVersion": "Windows",
          "isDomainJoined": false,
          "type": "host"
        },
        {
          "$id": "centralus_45",
          "directory": "c:\\windows\\inf",
          "name": "sample.exe",
          "type": "file"
        },
        {
          "$id": "centralus_46",
          "name": "SAMPLE-account",
          "ntDomain": "SAMPLE",
          "host": {
            "$ref": "centralus_44"
          },
          "sid": "S-0-0-00",
          "isDomainJoined": true,
          "type": "account",
          "logonId": "0x3e7"
        },
        {
          "$id": "centralus_47",
          "processId": "0x1038",
          "commandLine": "",
          "host": {
            "$ref": "centralus_44"
          },
          "type": "process"
        },
        {
          "$id": "centralus_48",
          "processId": "0x1eec",
          "commandLine": "",
          "elevationToken": "Default",
          "creationTimeUtc": "2022-09-08T07:50:43.2122906Z",
          "imageFile": {
            "$ref": "centralus_45"
          },
          "account": {
            "$ref": "centralus_46"
          },
          "parentProcess": {
            "$ref": "centralus_47"
          },
          "host": {
            "$ref": "centralus_44"
          },
          "type": "process"
        },
        {
          "$id": "centralus_49",
          "sessionId": "0x3e7",
          "startTimeUtc": "2022-09-08T07:50:43.2122906Z",
          "endTimeUtc": "2022-09-08T07:50:43.2122906Z",
          "type": "host-logon-session",
          "host": {
            "$ref": "centralus_44"
          },
          "account": {
            "$ref": "centralus_46"
          }
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396773567877093_2e841069-2215-4fd3-813c-f146589da2bc/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396773587877093_08b9a631-f1a0-4ea9-9c9a-8da7a725899e",
    "name": "2517396773587877093_08b9a631-f1a0-4ea9-9c9a-8da7a725899e",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:25.4861788Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.2122906Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "alertType": "SIMULATED_VM_DigitalCurrencyMining",
      "startTimeUtc": "2022-09-08T07:50:41.2122906Z",
      "endTimeUtc": "2022-09-08T07:50:41.2122906Z",
      "severity": "High",
      "isIncident": false,
      "systemAlertId": "2517396773587877093_08b9a631-f1a0-4ea9-9c9a-8da7a725899e",
      "intent": "Execution",
      "resourceIdentifiers": [
        {
          "$id": "centralus_50",
          "azureResourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM",
          "type": "AzureResource",
          "azureResourceTenantId": "ebac1a16-81bf-449b-8d43-5732c3c1d999"
        },
        {
          "$id": "centralus_51",
          "workspaceId": "00000000-0000-0000-0000-000000000001",
          "workspaceSubscriptionId": "00000000-0000-0000-0000-000000000001",
          "workspaceResourceGroup": "defaultresourcegroup-wus",
          "agentId": "00000000-0000-0000-0000-000000000001",
          "type": "LogAnalytics",
          "workspaceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-VM",
      "alertDisplayName": "[SAMPLE ALERT] Digital currency mining related behavior detected",
      "description": "THIS IS A SAMPLE ALERT: Analysis of host data on Sample-VM detected the execution of a process or command normally associated with digital currency mining.",
      "remediationSteps": [
        "Review with Sample-account the suspicious command process and command line to confirm that this is legitimate activity that you expect to see on Sample-VM. If not, escalate the alert to the information security team."
      ],
      "extendedProperties": {
        "resourceType": "Virtual Machine",
        "user Name": "Sample-account",
        "compromised Host": "Sample-VM",
        "suspicious Command Line": "\\sample.exe -t 4",
        "suspicious Process Id": "0x1640",
        "suspicious Process": "sample.exe",
        "account Session Id": "0x427d8dd9",
        "killChainIntent": "Execution"
      },
      "entities": [
        {
          "$id": "centralus_52",
          "dnsDomain": "",
          "ntDomain": "",
          "hostName": "Sample-VM",
          "netBiosName": "Sample-VM",
          "azureID": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM",
          "omsAgentID": "00000000-0000-0000-0000-000000000000",
          "osFamily": "Windows",
          "osVersion": "Windows",
          "isDomainJoined": false,
          "type": "host"
        },
        {
          "$id": "centralus_53",
          "directory": "c:\\temp",
          "name": "sample.exe",
          "type": "file"
        },
        {
          "$id": "centralus_54",
          "processId": "0x1020",
          "commandLine": "",
          "host": {
            "$ref": "centralus_52"
          },
          "type": "process"
        },
        {
          "$id": "centralus_55",
          "name": "Sample-account",
          "ntDomain": "Sample-VM",
          "host": {
            "$ref": "centralus_52"
          },
          "sid": "S-1-5-21-3061399664-1673012318-3185014992-20022",
          "isDomainJoined": false,
          "type": "account",
          "logonId": "0x427d8dd9"
        },
        {
          "$id": "centralus_56",
          "processId": "0x1640",
          "commandLine": ".\\sample.exe -t 4",
          "elevationToken": "Default",
          "creationTimeUtc": "2022-09-08T07:50:41.2122906Z",
          "imageFile": {
            "$ref": "centralus_53"
          },
          "account": {
            "$ref": "centralus_55"
          },
          "parentProcess": {
            "$ref": "centralus_54"
          },
          "host": {
            "$ref": "centralus_52"
          },
          "type": "process"
        },
        {
          "$id": "centralus_57",
          "sessionId": "0x427d8dd9",
          "startTimeUtc": "2022-09-08T07:50:41.2122906Z",
          "endTimeUtc": "2022-09-08T07:50:41.2122906Z",
          "type": "host-logon-session",
          "host": {
            "$ref": "centralus_52"
          },
          "account": {
            "$ref": "centralus_55"
          }
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396773587877093_08b9a631-f1a0-4ea9-9c9a-8da7a725899e/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396773607877093_1947c575-9d9f-4c67-a2a3-65b1f6696f11",
    "name": "2517396773607877093_1947c575-9d9f-4c67-a2a3-65b1f6696f11",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:25.4879405Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.2122906Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "alertType": "SIMULATED_VM_SuspectPhp",
      "startTimeUtc": "2022-09-08T07:50:39.2122906Z",
      "endTimeUtc": "2022-09-08T07:50:39.2122906Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396773607877093_1947c575-9d9f-4c67-a2a3-65b1f6696f11",
      "intent": "Execution",
      "resourceIdentifiers": [
        {
          "$id": "centralus_58",
          "azureResourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM",
          "type": "AzureResource",
          "azureResourceTenantId": "ebac1a16-81bf-449b-8d43-5732c3c1d999"
        },
        {
          "$id": "centralus_59",
          "workspaceId": "00000000-0000-0000-0000-000000000001",
          "workspaceSubscriptionId": "00000000-0000-0000-0000-000000000001",
          "workspaceResourceGroup": "defaultresourcegroup-wus",
          "agentId": "00000000-0000-0000-0000-000000000001",
          "type": "LogAnalytics",
          "workspaceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-VM",
      "alertDisplayName": "[SAMPLE ALERT]  Suspicious PHP execution detected",
      "description": "THIS IS A SAMPLE ALERT: Machine logs indicate a that a suspicious PHP process is running. The action included an attempt to run OS commands or PHP code from the command line using the PHP process.\r\nWhile this behavior can be legitimate, in web applications this behavior is also observed in malicious activities such as attempts to infect websites with web shells.",
      "remediationSteps": [
        "1. Review the command line in the alert details. If legitimate, you can ignore the alert. If not, escalate the alert to your information security team.",
        "2. Make sure that the web application is up-to-date.",
        "3. If possible, disable the sensitive PHP commands (see: http://php.net/manual/ini.core.php#ini.disable-functions)."
      ],
      "extendedProperties": {
        "resourceType": "Virtual Machine",
        "suspicious Command Line": "php",
        "suspicious Process Id": "0x1e99b",
        "account Session Id": "0xbd6e",
        "suspicious Process": "php",
        "compromised Host": "Sample-VM",
        "user Name": "Sample-account",
        "killChainIntent": "Execution"
      },
      "entities": [
        {
          "$id": "centralus_60",
          "dnsDomain": "",
          "ntDomain": "",
          "hostName": "Sample-VM",
          "netBiosName": "Sample-VM",
          "azureID": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM",
          "omsAgentID": "00000000-0000-0000-0000-000000000000",
          "osFamily": "Linux",
          "osVersion": "Linux",
          "type": "host"
        },
        {
          "$id": "centralus_61",
          "directory": "/usr/bin",
          "name": "php",
          "type": "file"
        },
        {
          "$id": "centralus_62",
          "processId": "0x1e49a",
          "commandLine": "",
          "host": {
            "$ref": "centralus_60"
          },
          "type": "process"
        },
        {
          "$id": "centralus_63",
          "name": "Sample-account",
          "host": {
            "$ref": "centralus_60"
          },
          "sid": "",
          "type": "account",
          "logonId": "0xbd6e"
        },
        {
          "$id": "centralus_64",
          "processId": "0x1e99b",
          "commandLine": "php",
          "creationTimeUtc": "2022-09-08T07:50:39.2122906Z",
          "imageFile": {
            "$ref": "centralus_61"
          },
          "account": {
            "$ref": "centralus_63"
          },
          "parentProcess": {
            "$ref": "centralus_62"
          },
          "host": {
            "$ref": "centralus_60"
          },
          "type": "process"
        },
        {
          "$id": "centralus_65",
          "sessionId": "0xbd6e",
          "startTimeUtc": "2022-09-08T07:50:39.2122906Z",
          "endTimeUtc": "2022-09-08T07:50:39.2122906Z",
          "type": "host-logon-session",
          "host": {
            "$ref": "centralus_60"
          },
          "account": {
            "$ref": "centralus_63"
          }
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396773607877093_1947c575-9d9f-4c67-a2a3-65b1f6696f11/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396773627877093_b72fa207-3cca-4bc9-a0d9-d193ea0dda4c",
    "name": "2517396773627877093_b72fa207-3cca-4bc9-a0d9-d193ea0dda4c",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:25.5018037Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.2122906Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "alertType": "SIMULATED_VM.Windows_GoldFileCleanup",
      "startTimeUtc": "2022-09-08T07:50:37.2122906Z",
      "endTimeUtc": "2022-09-08T07:50:37.2122906Z",
      "severity": "High",
      "isIncident": false,
      "systemAlertId": "2517396773627877093_b72fa207-3cca-4bc9-a0d9-d193ea0dda4c",
      "intent": "DefenseEvasion",
      "resourceIdentifiers": [
        {
          "$id": "centralus_66",
          "azureResourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM",
          "type": "AzureResource",
          "azureResourceTenantId": "ebac1a16-81bf-449b-8d43-5732c3c1d999"
        },
        {
          "$id": "centralus_67",
          "workspaceId": "00000000-0000-0000-0000-000000000001",
          "workspaceSubscriptionId": "00000000-0000-0000-0000-000000000001",
          "workspaceResourceGroup": "defaultresourcegroup-wus",
          "agentId": "00000000-0000-0000-0000-000000000001",
          "type": "LogAnalytics",
          "workspaceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-VM",
      "alertDisplayName": "[SAMPLE ALERT]  Detected suspicious file cleanup commands",
      "description": "THIS IS A SAMPLE ALERT: Analysis of host data on Sample-VM detected a combination of systeminfo commands that has previously been associated with one of activity group GOLD's methods of performing post-compromise self-cleanup activity.  While 'systeminfo.exe' is a legitimate Windows tool, executing it twice in succession, followed by a delete command in the way that has occurred here is rare.",
      "remediationSteps": [
        "Review with user Sample-account the 'sample.exe executions and delete commands flagged in this alert to confirm that they are legitimate and expected on Sample-VM. If not, escalate the alert to the information security team."
      ],
      "extendedProperties": {
        "resourceType": "Virtual Machine",
        "compromised Host": "OMS-AGENT-2",
        "suspicious Process Id": "0x4a8",
        "suspicious Command Line": "cmd  /c echo \" systeminfo && systeminfo && del \"",
        "suspicious Process": "c:\\windows\\system32\\cmd.exe",
        "account Session Id": "0x12ed4a93",
        "user Name": "OMS-AGENT-2\\DnzmNhMdW96g7j3",
        "enrichment_tas_threat__reports": "{\"Kind\":\"MultiLink\",\"DisplayValueToUrlDictionary\":{\"Report: GOLD\":\"https://interflowwebportalext.trafficmanager.net/reports/DisplayReport?callerIdentity=ddd5443d-e6f4-441c-b52b-5278d2f21dfa&reportCreateDateTime=2020-06-05T06%3a24%3a18&reportName=MSTI-AGP-GOLD.pdf&tenantId=7bf32e19-dc11-416d-85e8-2cff75271e2a&urlCreateDateTime=2020-06-05T06%3a24%3a18&token=%2083e9In2MDZfBKT5aMOejPcfhpNovCKiidxcnKaBGnQ=\"}}",
        "killChainIntent": "DefenseEvasion"
      },
      "entities": [
        {
          "$id": "centralus_68",
          "dnsDomain": "",
          "ntDomain": "",
          "hostName": "Sample-VM",
          "netBiosName": "Sample-VM",
          "azureID": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM",
          "omsAgentID": "00000000-0000-0000-0000-000000000000",
          "osFamily": "Windows",
          "osVersion": "Windows",
          "isDomainJoined": false,
          "type": "host"
        },
        {
          "$id": "centralus_69",
          "directory": "c:\\windows\\system32",
          "name": "cmd.exe",
          "type": "file"
        },
        {
          "$id": "centralus_70",
          "processId": "0x12ac",
          "commandLine": "",
          "host": {
            "$ref": "centralus_68"
          },
          "type": "process"
        },
        {
          "$id": "centralus_71",
          "name": "Sample-VM",
          "ntDomain": "Sample-VM",
          "host": {
            "$ref": "centralus_68"
          },
          "sid": "",
          "isDomainJoined": false,
          "type": "account",
          "logonId": "0x12ed4a93"
        },
        {
          "$id": "centralus_72",
          "processId": "0x4a8",
          "commandLine": "cmd  /c echo Hi",
          "elevationToken": "Default",
          "creationTimeUtc": "2022-09-08T07:50:37.2122906Z",
          "imageFile": {
            "$ref": "centralus_69"
          },
          "account": {
            "$ref": "centralus_71"
          },
          "parentProcess": {
            "$ref": "centralus_70"
          },
          "host": {
            "$ref": "centralus_68"
          },
          "type": "process"
        },
        {
          "$id": "centralus_73",
          "sessionId": "0x12ed4a93",
          "startTimeUtc": "2022-09-08T07:50:37.2122906Z",
          "endTimeUtc": "2022-09-08T07:50:37.2122906Z",
          "type": "host-logon-session",
          "host": {
            "$ref": "centralus_68"
          },
          "account": {
            "$ref": "centralus_71"
          }
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396773627877093_b72fa207-3cca-4bc9-a0d9-d193ea0dda4c/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396773647877093_d254755c-39f2-411c-ace6-2ea463340533",
    "name": "2517396773647877093_d254755c-39f2-411c-ace6-2ea463340533",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:25.5695718Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.2122906Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "alertType": "SIMULATED_VM.Windows_PetyaRansomware",
      "startTimeUtc": "2022-09-08T07:50:35.2122906Z",
      "endTimeUtc": "2022-09-08T07:50:35.2122906Z",
      "severity": "High",
      "isIncident": false,
      "systemAlertId": "2517396773647877093_d254755c-39f2-411c-ace6-2ea463340533",
      "intent": "Execution",
      "resourceIdentifiers": [
        {
          "$id": "centralus_74",
          "azureResourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM",
          "type": "AzureResource",
          "azureResourceTenantId": "ebac1a16-81bf-449b-8d43-5732c3c1d999"
        },
        {
          "$id": "centralus_75",
          "workspaceId": "00000000-0000-0000-0000-000000000001",
          "workspaceSubscriptionId": "00000000-0000-0000-0000-000000000001",
          "workspaceResourceGroup": "defaultresourcegroup-wus",
          "agentId": "00000000-0000-0000-0000-000000000001",
          "type": "LogAnalytics",
          "workspaceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-VM",
      "alertDisplayName": "[SAMPLE ALERT]  Detected Petya ransomware indicators",
      "description": "THIS IS A SAMPLE ALERT: Analysis of host data on OMS-AGENT-2 detected indicators associated with Petya ransomware. See https://blogs.technet.microsoft.com/mmpc/2017/06/27/new-ransomware-old-techniques-petya-adds-worm-capabilities/ for more information. Review the command line associated in this alert and escalate this alert to your security team.",
      "remediationSteps": [
        "1. Run a full anti-malware scan and verify that the threat was removed",
        "2. Install and run Microsoft’s Malicious Software Removal Tool (see http://www.microsoft.com/security/pc-security/malware-removal.aspx)",
        "3. Perform these actions pre-emptively on other hosts in your network."
      ],
      "extendedProperties": {
        "resourceType": "Virtual Machine",
        "compromised Host": "Sample-VM",
        "suspicious Process Id": "0x1574",
        "suspicious Command Line": "sample",
        "suspicious Process": "c:\\windows\\system32\\sample.exe",
        "account Session Id": "0x12ed4a93",
        "user Name": "Sample-account",
        "enrichment_tas_threat__reports": "{\"Kind\":\"MultiLink\",\"DisplayValueToUrlDictionary\":{\"Report: Petya\":\"\"}}",
        "killChainIntent": "Execution"
      },
      "entities": [
        {
          "$id": "centralus_76",
          "dnsDomain": "",
          "ntDomain": "",
          "hostName": "Sample-VM",
          "netBiosName": "Sample-VM",
          "azureID": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM",
          "omsAgentID": "00000000-0000-0000-0000-000000000000",
          "osFamily": "Windows",
          "osVersion": "Windows",
          "isDomainJoined": false,
          "type": "host"
        },
        {
          "$id": "centralus_77",
          "directory": "c:\\windows\\system32",
          "name": "sample.exe",
          "type": "file"
        },
        {
          "$id": "centralus_78",
          "processId": "0x12ac",
          "commandLine": "",
          "host": {
            "$ref": "centralus_76"
          },
          "type": "process"
        },
        {
          "$id": "centralus_79",
          "name": "Sample-VM",
          "ntDomain": "Sample-VM",
          "host": {
            "$ref": "centralus_76"
          },
          "sid": "",
          "isDomainJoined": false,
          "type": "account",
          "logonId": "0x12ed4a93"
        },
        {
          "$id": "centralus_80",
          "processId": "0x1574",
          "commandLine": "sample",
          "elevationToken": "Default",
          "creationTimeUtc": "2022-09-08T07:50:35.2122906Z",
          "imageFile": {
            "$ref": "centralus_77"
          },
          "account": {
            "$ref": "centralus_79"
          },
          "parentProcess": {
            "$ref": "centralus_78"
          },
          "host": {
            "$ref": "centralus_76"
          },
          "type": "process"
        },
        {
          "$id": "centralus_81",
          "sessionId": "0x12ed4a93",
          "startTimeUtc": "2022-09-08T07:50:35.2122906Z",
          "endTimeUtc": "2022-09-08T07:50:35.2122906Z",
          "type": "host-logon-session",
          "host": {
            "$ref": "centralus_76"
          },
          "account": {
            "$ref": "centralus_79"
          }
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396773647877093_d254755c-39f2-411c-ace6-2ea463340533/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/providers/Microsoft.Security/locations/centralus/alerts/2517396773687877093_a3fc5c97-dc20-4a36-bbdb-0070b73c74ed",
    "name": "2517396773687877093_a3fc5c97-dc20-4a36-bbdb-0070b73c74ed",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:25.7855045Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.2122906Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "ARM",
      "alertType": "SIMULATED_ARM_MicroBurst.AZStorageKeysREST",
      "startTimeUtc": "2022-09-08T07:50:31.2122906Z",
      "endTimeUtc": "2022-09-08T07:50:31.2122906Z",
      "severity": "High",
      "isIncident": false,
      "systemAlertId": "2517396773687877093_a3fc5c97-dc20-4a36-bbdb-0070b73c74ed",
      "intent": "Collection",
      "resourceIdentifiers": [
        {
          "$id": "centralus_82",
          "azureResourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb",
          "type": "AzureResource",
          "azureResourceTenantId": "ebac1a16-81bf-449b-8d43-5732c3c1d999"
        }
      ],
      "compromisedEntity": "0f907ea4-bc8b-4c11-9d7e-805c2fd144fb",
      "alertDisplayName": "[SAMPLE ALERT] MicroBurst exploitation toolkit used to extract keys to your storage accounts (Preview)",
      "description": "THIS IS A SAMPLE ALERT: MicroBurst's exploitation toolkit was used to extract keys to your storage accounts. This was detected by analyzing Azure Activity logs and resource management operations in your subscription.",
      "remediationSteps": [
        "1. Determine whether the activity was intentional – by contacting the account owner.\n2. If the activity was intentional, dismiss the alert. Otherwise, treat the user account and subscription as compromised and continue with the next remediation steps.\n3. Remediate the compromised user account: delete the user account if it's an unfamiliar account (the attacker may have created it), otherwise change its authentication credentials, use Azure Activity Logs to locate suspicious activities and review all activities performed by the user.\n4. Remediate the compromised subscription: remove any unfamiliar Runbook from the compromised automation account, review IAM permissions for the subscription and remove permissions for any unfamiliar user account, review all Azure resources and delete any unfamiliar Azure Resource, review all alerts in Azure Security Center related to the subscription and investigate them, use Azure Activity Logs to locate suspicious activities and review all activities performed in this subscription."
      ],
      "extendedProperties": {
        "microBurst modules": "Get-AZStorageKeysREST",
        "principalOid": "00000000-0000-0000-0000-000000000000",
        "ip address": "0.0.0.0",
        "username": "Sample user",
        "resourceType": "ARM",
        "killChainIntent": "Collection"
      },
      "extendedLinks": [
        {
          "href": "https://blog.netspi.com/gathering-bearer-tokens-azure/",
          "label": "NetSPI blogpost",
          "type": "webLink"
        },
        {
          "href": "https://github.com/NetSPI/MicroBurst/blob/master/REST/Get-AZStorageKeysREST.ps1",
          "label": "MicroBurst source code",
          "type": "webLink"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396773687877093_a3fc5c97-dc20-4a36-bbdb-0070b73c74ed/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396773707877093_32a1c39e-d665-4aa5-92e8-e58d3c17223c",
    "name": "2517396773707877093_32a1c39e-d665-4aa5-92e8-e58d3c17223c",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:25.8455644Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.2122906Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "ARM",
      "alertType": "SIMULATED_ARM_AmRealtimeProtectionDisabled",
      "startTimeUtc": "2022-09-08T07:50:29.2122906Z",
      "endTimeUtc": "2022-09-08T07:50:29.2122906Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396773707877093_32a1c39e-d665-4aa5-92e8-e58d3c17223c",
      "intent": "DefenseEvasion",
      "resourceIdentifiers": [
        {
          "$id": "centralus_83",
          "azureResourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/PROVIDERS/Microsoft.Compute/virtualMachines/Sample-VM",
          "type": "AzureResource",
          "azureResourceTenantId": "ebac1a16-81bf-449b-8d43-5732c3c1d999"
        }
      ],
      "compromisedEntity": "Sample-VM",
      "alertDisplayName": "[SAMPLE ALERT] Antimalware real-time protection was disabled in your virtual machine (Preview)",
      "description": "THIS IS A SAMPLE ALERT: Real-time protection disablement of the antimalware extension was detected in your virtual machine by analyzing the Azure Resource Manager operations in your subscription.\nAttackers might disable real-time protection from the antimalware scan on your virtual machine to avoid detection while running arbitrary code or infecting the machine with malware.",
      "remediationSteps": [
        "1. Determine if the activity was intentional – by contacting the account owner.\n2. If the activity was intentional - dismiss the alert. Otherwise, enable the antimalware real-time threat protection and treat the user account, subscription and virtual machine as compromised and continue with the next steps.\n3. Remediate the compromised user account – change the password, review all activities performed by the user via Azure Activity Logs and locate suspicious activities\n4. Remediate the compromised subscription - Review IAM permissions for the subscription and remove permissions for any unfamiliar user account, review all Azure resources and delete any unfamiliar Azure Resource, review all alerts in Azure Security Center related to the subscription and investigate them, review all activities performed in this subscription via Azure Activity Logs and locate suspicious activities.\n5. Remediate the compromised virtual machine – change the password of all users, run full antimalware scan on your virtual machine."
      ],
      "extendedProperties": {
        "principal object ID": "00000000-0000-0000-0000-000000000000",
        "principal name": "Sample Principal",
        "antimalware enabled": "true",
        "real time antimalware protection enabled": "false",
        "scheduled antimalware scan enabled": "",
        "extension Name": "IaasAntimalware",
        "resourceType": "ARM",
        "killChainIntent": "DefenseEvasion"
      },
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396773707877093_32a1c39e-d665-4aa5-92e8-e58d3c17223c/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396773727877093_4d3aec8b-274b-45fa-a157-437c6e255698",
    "name": "2517396773727877093_4d3aec8b-274b-45fa-a157-437c6e255698",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:25.9350395Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.2122906Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "ARM",
      "alertType": "SIMULATED_ARM_CustomScriptExtensionSuspiciousCmd",
      "startTimeUtc": "2022-09-08T07:50:27.2122906Z",
      "endTimeUtc": "2022-09-08T07:50:27.2122906Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396773727877093_4d3aec8b-274b-45fa-a157-437c6e255698",
      "intent": "Execution",
      "resourceIdentifiers": [
        {
          "$id": "centralus_84",
          "azureResourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/PROVIDERS/Microsoft.Compute/virtualMachines/Sample-VM",
          "type": "AzureResource",
          "azureResourceTenantId": "ebac1a16-81bf-449b-8d43-5732c3c1d999"
        }
      ],
      "compromisedEntity": "Sample-VM",
      "alertDisplayName": "[SAMPLE ALERT] Custom script extension with suspicious command in your virtual machine (Preview)",
      "description": "THIS IS A SAMPLE ALERT: Custom script extension with suspicious command was detected in your virtual machine by analyzing the Azure Resource Manager operations in your subscription.\nAttackers may use custom script extension to execute a malicious code on your virtual machine via the Azure Resource Manager.",
      "remediationSteps": [
        "1. Contact the account owner to determine whether the activity was intentional. If the activity was intentional, dismiss the alert.\n2. If the activity was unexpected, treat the user account, subscription, and virtual machine as compromised.\n3. To remediate compromised user accounts, delete them if they’re unfamiliar (as they may have been created by a threat actor), otherwise change their authentication credentials. Use Azure Activity Logs to review all activities performed by the user and identify any that are suspicious.\n4. To remediate compromised subscriptions, remove any unfamiliar Runbooks from the compromised automation account, review IAM permissions for the subscription and remove permissions for any unfamiliar user account, review all Azure resources in the subscription (delete any that are unfamiliar), review and investigate any security alerts for the subscription in Azure Security Center, and use Azure Activity Logs to review all activities performed in the subscription and identify any that are suspicious.\n5. To remediate the compromised virtual machine, change the passwords for all users, run a full antimalware scan on the machine, and reimage the virtual machine from a malware-free source."
      ],
      "extendedProperties": {
        "principal object ID": "00000000-0000-0000-0000-000000000000",
        "principal name": "Sample user",
        "ip address": "0.0.0.0",
        "identity address": "",
        "suspicious command": "powershell.exe -ExecutionPolicy Unrestricted -File sample.ps1",
        "resourceType": "ARM",
        "killChainIntent": "Execution"
      },
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396773727877093_4d3aec8b-274b-45fa-a157-437c6e255698/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396773747877093_8611dc93-8f2b-472f-96de-3a0ebb30b9e3",
    "name": "2517396773747877093_8611dc93-8f2b-472f-96de-3a0ebb30b9e3",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:25.7828346Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.2122906Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "DNS",
      "alertType": "SIMULATED_AzureDNS_DarkWeb",
      "startTimeUtc": "2022-09-08T07:50:25.2122906Z",
      "endTimeUtc": "2022-09-08T07:50:25.2122906Z",
      "severity": "Low",
      "isIncident": false,
      "systemAlertId": "2517396773747877093_8611dc93-8f2b-472f-96de-3a0ebb30b9e3",
      "intent": "Exfiltration",
      "resourceIdentifiers": [
        {
          "$id": "centralus_85",
          "azureResourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/PROVIDERS/MICROSOFT.COMPUTE/VIRTUALMACHINES/Sample-VM",
          "type": "AzureResource",
          "azureResourceTenantId": "ebac1a16-81bf-449b-8d43-5732c3c1d999"
        }
      ],
      "compromisedEntity": "Sample-VM",
      "alertDisplayName": "[SAMPLE ALERT] Anonymity network activity (Preview)",
      "description": "THIS IS A SAMPLE ALERT: Analysis of DNS transactions detected anonymity network activity. Such activity, while possibly legitimate user behaviour, is frequently employed by attackers to evade tracking and fingerprinting of network communications. Typical related attacker activity is likely to include the download and execution of malicious software or remote administration tools.",
      "remediationSteps": [
        "Ask the machine owner if this is intended behavior.",
        "If the activity is unexpected, treat the machine as potentially compromised and remediate as follows.",
        "Isolate the machine from the network to prevent lateral movement.",
        "Run a full antimalware scan on the machine, following any resulting remediation advice.",
        "Review installed and running software on the machine, removing any unknown or unwanted packages.",
        "Revert the machine to a known good state, reinstalling operating system if required and restoring software from a verified malware-free source.",
        "Resolve Azure Security Center recommendations for the machine, remediating highlighted security issues to prevent future breaches."
      ],
      "extendedProperties": {
        "domainName": "sample.domain",
        "answers": "0.0.0.0",
        "resourceType": "AzureDNS",
        "killChainIntent": "Exfiltration"
      },
      "entities": [
        {
          "$id": "centralus_86",
          "hostName": "Sample-VM",
          "azureID": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/PROVIDERS/MICROSOFT.COMPUTE/VIRTUALMACHINES/Sample-VM",
          "type": "host",
          "containerId": null
        },
        {
          "$id": "centralus_87",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "California",
            "city": "San Francisco",
            "longitude": 0,
            "latitude": 0,
            "asn": 0
          },
          "type": "ip"
        },
        {
          "$id": "centralus_88",
          "dnsDomain": "",
          "ntDomain": "",
          "hostName": "sampleHost",
          "netBiosName": "sampleHost",
          "type": "host",
          "containerId": null
        },
        {
          "$id": "centralus_89",
          "domainName": "sample.domain",
          "ipAdresses": [
            {
              "$ref": "centralus_87"
            }
          ],
          "hostIpAddress": {
            "$ref": "centralus_87"
          },
          "type": "dns"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396773747877093_8611dc93-8f2b-472f-96de-3a0ebb30b9e3/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396773767877093_ae78857d-ade9-4b6d-bef3-e63d99c22ce2",
    "name": "2517396773767877093_ae78857d-ade9-4b6d-bef3-e63d99c22ce2",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:25.8140472Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.2122906Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "DNS",
      "alertType": "SIMULATED_AzureDNS_DataExfiltration",
      "startTimeUtc": "2022-09-08T07:50:23.2122906Z",
      "endTimeUtc": "2022-09-08T07:50:23.2122906Z",
      "severity": "Low",
      "isIncident": false,
      "systemAlertId": "2517396773767877093_ae78857d-ade9-4b6d-bef3-e63d99c22ce2",
      "intent": "Exfiltration",
      "resourceIdentifiers": [
        {
          "$id": "centralus_90",
          "azureResourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/PROVIDERS/MICROSOFT.COMPUTE/VIRTUALMACHINES/Sample-VM",
          "type": "AzureResource",
          "azureResourceTenantId": "ebac1a16-81bf-449b-8d43-5732c3c1d999"
        }
      ],
      "compromisedEntity": "Sample-VM",
      "alertDisplayName": "[SAMPLE ALERT] Possible data exfiltration via DNS tunnel (Preview)",
      "description": "THIS IS A SAMPLE ALERT: Analysis of DNS transactions detected a possible DNS tunnel. Such activity, while possibly legitimate user behaviour, is frequently performed by attackers to evade network monitoring and filtering. Typical related attacker activity is likely to include the download and execution of malicious software or remote administration tools.",
      "remediationSteps": [
        "Ask the machine owner if this is intended behavior.",
        "If the activity is unexpected, treat the machine as potentially compromised and remediate as follows.",
        "Isolate the machine from the network to prevent lateral movement.",
        "Run a full antimalware scan on the machine, following any resulting remediation advice.",
        "Review installed and running software on the machine, removing any unknown or unwanted packages.",
        "Revert the machine to a known good state, reinstalling operating system if required and restoring software from a verified malware-free source.",
        "Resolve Azure Security Center recommendations for the machine, remediating highlighted security issues to prevent future breaches."
      ],
      "extendedProperties": {
        "domainName": "sample.domain",
        "answers": "0.0.0.0",
        "resourceType": "AzureDNS",
        "killChainIntent": "Exfiltration"
      },
      "entities": [
        {
          "$id": "centralus_91",
          "hostName": "Sample-VM",
          "azureID": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/PROVIDERS/MICROSOFT.COMPUTE/VIRTUALMACHINES/Sample-VM",
          "type": "host",
          "containerId": null
        },
        {
          "$id": "centralus_92",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "California",
            "city": "San Francisco",
            "longitude": 0,
            "latitude": 0,
            "asn": 0
          },
          "type": "ip"
        },
        {
          "$id": "centralus_93",
          "dnsDomain": "",
          "ntDomain": "",
          "hostName": "sampleHost",
          "netBiosName": "sampleHost",
          "type": "host",
          "containerId": null
        },
        {
          "$id": "centralus_94",
          "domainName": "sample.domain",
          "ipAdresses": [
            {
              "$ref": "centralus_92"
            }
          ],
          "hostIpAddress": {
            "$ref": "centralus_92"
          },
          "type": "dns"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396773767877093_ae78857d-ade9-4b6d-bef3-e63d99c22ce2/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396773787877093_08903481-ef03-4730-9b41-de8585a4f4d0",
    "name": "2517396773787877093_08903481-ef03-4730-9b41-de8585a4f4d0",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:25.7830881Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.2122906Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "DNS",
      "alertType": "SIMULATED_AzureDNS_PhishingDomain",
      "startTimeUtc": "2022-09-08T07:50:21.2122906Z",
      "endTimeUtc": "2022-09-08T07:50:21.2122906Z",
      "severity": "Low",
      "isIncident": false,
      "systemAlertId": "2517396773787877093_08903481-ef03-4730-9b41-de8585a4f4d0",
      "intent": "Exfiltration",
      "resourceIdentifiers": [
        {
          "$id": "centralus_95",
          "azureResourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/PROVIDERS/MICROSOFT.COMPUTE/VIRTUALMACHINES/Sample-VM",
          "type": "AzureResource",
          "azureResourceTenantId": "ebac1a16-81bf-449b-8d43-5732c3c1d999"
        }
      ],
      "compromisedEntity": "Sample-VM",
      "alertDisplayName": "[SAMPLE ALERT] Communication with possible phishing domain (Preview)",
      "description": "THIS IS A SAMPLE ALERT: Analysis of DNS transactions detected a request for a possible phishing domain. Such activity, while possibly benign, is frequently performed by attackers to harvest credentials to remote services. Typical related attacker activity is likely to include the exploitation of any credentials on the legitimate service.",
      "remediationSteps": [
        "Investigate the domain (using whois), validating that the registration belongs to the expected owner.",
        "If ownership is suspect, contact the machine owner to highlight the discrepancy and verify the degree of interaction, suggesting user log into any account(s) potentially exposed during suspicious session, validate recent activity and change compromised password(s)."
      ],
      "extendedProperties": {
        "domainName": "sample.domain",
        "answers": "0.0.0.0",
        "resourceType": "AzureDNS",
        "killChainIntent": "Exfiltration"
      },
      "entities": [
        {
          "$id": "centralus_96",
          "hostName": "Sample-VM",
          "azureID": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/PROVIDERS/MICROSOFT.COMPUTE/VIRTUALMACHINES/Sample-VM",
          "type": "host",
          "containerId": null
        },
        {
          "$id": "centralus_97",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "California",
            "city": "San Francisco",
            "longitude": 0,
            "latitude": 0,
            "asn": 0
          },
          "type": "ip"
        },
        {
          "$id": "centralus_98",
          "domainName": "sample.domain",
          "ipAdresses": [
            {
              "$ref": "centralus_97"
            }
          ],
          "hostIpAddress": {
            "$ref": "centralus_97"
          },
          "type": "dns"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396773787877093_08903481-ef03-4730-9b41-de8585a4f4d0/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396773807877093_0a3207df-9e8c-4448-a80e-b7054290ef5b",
    "name": "2517396773807877093_0a3207df-9e8c-4448-a80e-b7054290ef5b",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:25.7727132Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.2122906Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "DNS",
      "alertType": "SIMULATED_AzureDNS_SinkholedDomain",
      "startTimeUtc": "2022-09-08T07:50:19.2122906Z",
      "endTimeUtc": "2022-09-08T07:50:19.2122906Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396773807877093_0a3207df-9e8c-4448-a80e-b7054290ef5b",
      "intent": "Exfiltration",
      "resourceIdentifiers": [
        {
          "$id": "centralus_99",
          "azureResourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/PROVIDERS/MICROSOFT.COMPUTE/VIRTUALMACHINES/Sample-VM",
          "type": "AzureResource",
          "azureResourceTenantId": "ebac1a16-81bf-449b-8d43-5732c3c1d999"
        }
      ],
      "compromisedEntity": "Sample-VM",
      "alertDisplayName": "[SAMPLE ALERT] Attempted communication with suspicious sinkholed domain (Preview)",
      "description": "THIS IS A SAMPLE ALERT: Analysis of DNS transactions detected request for sinkholed domain. Such activity, while possibly legitimate user behaviour, is frequently an indication of the download or execution of malicious software. Typical related attacker activity is likely to include the download and execution of further malicious software or remote administration tools.",
      "remediationSteps": [
        "Ask the machine owner if this is intended behavior.",
        "If the activity is unexpected, treat the machine as potentially compromised and remediate as follows.",
        "Isolate the machine from the network to prevent lateral movement.",
        "Run a full antimalware scan on the machine, following any resulting remediation advice.",
        "Review installed and running software on the machine, removing any unknown or unwanted packages.",
        "Revert the machine to a known good state, reinstalling operating system if required and restoring software from a verified malware-free source.",
        "Resolve Azure Security Center recommendations for the machine, remediating highlighted security issues to prevent future breaches."
      ],
      "extendedProperties": {
        "domainName": "sample.domain",
        "answers": "0.0.0.0",
        "resourceType": "AzureDNS",
        "killChainIntent": "Exfiltration"
      },
      "entities": [
        {
          "$id": "centralus_100",
          "hostName": "Sample-VM",
          "azureID": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/PROVIDERS/MICROSOFT.COMPUTE/VIRTUALMACHINES/Sample-VM",
          "type": "host",
          "containerId": null
        },
        {
          "$id": "centralus_101",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "California",
            "city": "San Francisco",
            "longitude": 0,
            "latitude": 0,
            "asn": 0
          },
          "type": "ip"
        },
        {
          "$id": "centralus_102",
          "domainName": "sample.domain",
          "ipAdresses": [
            {
              "$ref": "centralus_101"
            }
          ],
          "hostIpAddress": {
            "$ref": "centralus_101"
          },
          "type": "dns"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396773807877093_0a3207df-9e8c-4448-a80e-b7054290ef5b/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396773828188817_d3bcce13-af27-4b8a-96c9-90a9b4b634db",
    "name": "2517396773828188817_d3bcce13-af27-4b8a-96c9-90a9b4b634db",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:23.6142303Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.1811182Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "App Services",
      "alertType": "SIMULATED_AppServices_HighPrivilegeCommand",
      "startTimeUtc": "2022-09-08T07:50:17.1811182Z",
      "endTimeUtc": "2022-09-08T07:50:17.1811182Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396773828188817_d3bcce13-af27-4b8a-96c9-90a9b4b634db",
      "intent": "Unknown",
      "resourceIdentifiers": [
        {
          "$id": "centralus_103",
          "azureResourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Web/sites/Sample-app",
          "type": "AzureResource",
          "azureResourceTenantId": "ebac1a16-81bf-449b-8d43-5732c3c1d999"
        }
      ],
      "compromisedEntity": "Sample-VM",
      "alertDisplayName": "[SAMPLE ALERT] Attempt to run high privilege command detected",
      "description": "THIS IS A SAMPLE ALERT: Analysis of App Service processes detected an attempt to run a command that requires high privileges.",
      "remediationSteps": [
        "1. Review the command line in the alert details. If legitimate, you can ignore the alert. If not, escalate the alert to your information security team."
      ],
      "extendedProperties": {
        "resourceType": "App Service",
        "compromised Host": "Sample-VM",
        "suspicious Process Id": "0x4680",
        "suspicious Command Line": "sample.exe",
        "suspicious Process": "sample.exe",
        "parent Process": "sample.exe",
        "account Session Id": "0x15c0644",
        "user Name": "Sample-account"
      },
      "entities": [
        {
          "$id": "centralus_104",
          "directory": "sample",
          "name": "sample.exe",
          "type": "file"
        },
        {
          "$id": "centralus_105",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Web/sites/Sample-App",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_106",
          "processId": "0x39a8",
          "commandLine": "",
          "imageFile": {
            "$ref": "centralus_104"
          },
          "type": "process"
        },
        {
          "$id": "centralus_107",
          "processId": "0x4680",
          "commandLine": "sample.exe",
          "elevationToken": "Default",
          "creationTimeUtc": "2022-09-08T07:50:17.1811182Z",
          "imageFile": {
            "$ref": "centralus_104"
          },
          "parentProcess": {
            "$ref": "centralus_106"
          },
          "type": "process"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396773828188817_d3bcce13-af27-4b8a-96c9-90a9b4b634db/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396773848188817_65b7e516-52fa-4ddb-a42e-edf43c0eb2a6",
    "name": "2517396773848188817_65b7e516-52fa-4ddb-a42e-edf43c0eb2a6",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:23.6683568Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.1811182Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "App Services",
      "alertType": "SIMULATED_AppServices_DanglingDomain",
      "startTimeUtc": "2022-09-08T07:50:15.1811182Z",
      "endTimeUtc": "2022-09-08T07:50:15.1811182Z",
      "severity": "High",
      "isIncident": false,
      "systemAlertId": "2517396773848188817_65b7e516-52fa-4ddb-a42e-edf43c0eb2a6",
      "intent": "Unknown",
      "resourceIdentifiers": [
        {
          "$id": "centralus_108",
          "azureResourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Web/sites/Sample-app",
          "type": "AzureResource",
          "azureResourceTenantId": "ebac1a16-81bf-449b-8d43-5732c3c1d999"
        }
      ],
      "compromisedEntity": "Sample-App",
      "alertDisplayName": "[SAMPLE ALERT] Dangling DNS record for an App Service resource detected",
      "description": "THIS IS A SAMPLE ALERT: A DNS record that points to a recently deleted App Service resource (also known as \"dangling DNS\" entry) has been detected. This leaves you susceptible to a subdomain takeover. Subdomain takeovers enable malicious actors to redirect traffic intended for an organization’s domain to a site performing malicious activity.",
      "remediationSteps": [
        "From your DNS zone, remove all CNAME records that point to the deleted App Service resource."
      ],
      "extendedProperties": {
        "resourceType": "App Service",
        "domain": "sample-domain.com"
      },
      "entities": [
        {
          "$id": "centralus_109",
          "resourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Web/sites/Sample-app",
          "type": "azure-resource"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396773848188817_65b7e516-52fa-4ddb-a42e-edf43c0eb2a6/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396773868188817_bc4e5f7f-7f49-4f66-963d-5fe3f8e72745",
    "name": "2517396773868188817_bc4e5f7f-7f49-4f66-963d-5fe3f8e72745",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:23.9539199Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.1811182Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "",
      "alertType": "SIMULATED_AKS_TI_Proxy",
      "startTimeUtc": "2022-09-08T07:50:13.1811182Z",
      "endTimeUtc": "2022-09-08T07:50:13.1811182Z",
      "severity": "Low",
      "isIncident": false,
      "systemAlertId": "2517396773868188817_bc4e5f7f-7f49-4f66-963d-5fe3f8e72745",
      "intent": "Execution",
      "resourceIdentifiers": [
        {
          "$id": "centralus_110",
          "azureResourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Kubernetes/ConnectedClusters/Sample-ConnectedCluster",
          "type": "AzureResource",
          "azureResourceTenantId": "ebac1a16-81bf-449b-8d43-5732c3c1d999"
        }
      ],
      "compromisedEntity": "Sample-ConnectedCluster",
      "alertDisplayName": "[SAMPLE ALERT] AKS API requests from proxy IP address detected (Preview)",
      "description": "THIS IS A SAMPLE ALERT: Kubernetes audit log analysis detected API requests to your cluster from an IP address that is associated with proxy services, such as TOR.\r\nWhile this behavior can be legitimate, it's often seen in malicious activities, when attackers try to hide their source IP.",
      "remediationSteps": [
        "1. Review the IP address in the alert details. If your organization uses proxy services such as TOR for managing the AKS cluster and the IP is recognized, you can ignore the alert.",
        "2. Consider securing the API server by using authorized IP address ranges (https://docs.microsoft.com/en-us/azure/aks/api-server-authorized-ip-ranges)."
      ],
      "extendedProperties": {
        "resourceType": "Connected Cluster",
        "username": "sample-user",
        "ip Address": "0.0.0.0",
        "threat Type": "Proxy",
        "threat Description": "Tor exit node",
        "sample URI": "sample-URI",
        "killChainIntent": "Execution"
      },
      "entities": [
        {
          "$id": "centralus_111",
          "resourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Kubernetes/ConnectedClusters/Sample-ConnectedCluster",
          "type": "azure-resource"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396773868188817_bc4e5f7f-7f49-4f66-963d-5fe3f8e72745/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396773888188817_1189f1bd-e937-484d-b7e3-387a1a401ce2",
    "name": "2517396773888188817_1189f1bd-e937-484d-b7e3-387a1a401ce2",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:23.9970656Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.1811182Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "",
      "alertType": "SIMULATED_AKS_DeleteEvents",
      "startTimeUtc": "2022-09-08T07:50:11.1811182Z",
      "endTimeUtc": "2022-09-08T07:50:11.1811182Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396773888188817_1189f1bd-e937-484d-b7e3-387a1a401ce2",
      "intent": "DefenseEvasion",
      "resourceIdentifiers": [
        {
          "$id": "centralus_112",
          "azureResourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Kubernetes/ConnectedClusters/Sample-ConnectedCluster",
          "type": "AzureResource",
          "azureResourceTenantId": "ebac1a16-81bf-449b-8d43-5732c3c1d999"
        }
      ],
      "compromisedEntity": "Sample-ConnectedCluster",
      "alertDisplayName": "[SAMPLE ALERT] Kubernetes events deleted (Preview)",
      "description": "THIS IS A SAMPLE ALERT: Security Center detected that some Kubernetes events have been deleted. Kubernetes events are objects in Kubernetes which contain information about changes in the cluster. Attackers might delete those events for hiding their operations in the cluster.",
      "remediationSteps": [
        "Verify the legitimacy of the objects that the deleted events are related to.\\nIn case the object is suspicious, escalate the alert to your information security team."
      ],
      "extendedProperties": {
        "resourceType": "Connected Cluster",
        "namespace": "sample-namespace",
        "username": "sample-user",
        "ip Address": "0.0.0.0",
        "status": "200",
        "deleted events": "sample-event1, sample-event2, sample-event3",
        "killChainIntent": "DefenseEvasion"
      },
      "entities": [
        {
          "$id": "centralus_113",
          "resourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Kubernetes/ConnectedClusters/Sample-ConnectedCluster",
          "type": "azure-resource"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396773888188817_1189f1bd-e937-484d-b7e3-387a1a401ce2/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396773908188817_c4c17d2a-dbdb-400f-a3e4-81db71558502",
    "name": "2517396773908188817_c4c17d2a-dbdb-400f-a3e4-81db71558502",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:24.0320482Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.1811182Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "",
      "alertType": "SIMULATED_AKS_MaliciousContainerImage",
      "startTimeUtc": "2022-09-08T07:50:09.1811182Z",
      "endTimeUtc": "2022-09-08T07:50:09.1811182Z",
      "severity": "High",
      "isIncident": false,
      "systemAlertId": "2517396773908188817_c4c17d2a-dbdb-400f-a3e4-81db71558502",
      "intent": "Execution",
      "resourceIdentifiers": [
        {
          "$id": "centralus_114",
          "azureResourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Kubernetes/ConnectedClusters/Sample-ConnectedCluster",
          "type": "AzureResource",
          "azureResourceTenantId": "ebac1a16-81bf-449b-8d43-5732c3c1d999"
        }
      ],
      "compromisedEntity": "Sample-ConnectedCluster",
      "alertDisplayName": "[SAMPLE ALERT] Digital currency mining container detected (Preview)",
      "description": "THIS IS A SAMPLE ALERT: Kubernetes audit log analysis detected a container that has an image associated with a digital currency mining tool.",
      "remediationSteps": [
        "Review the container in the alert details.",
        "If malicious, remove the container and escalate the alert to the information security team.",
        "Be sure to also remove the correlating Deployments \\\\ ReplicaSets \\\\ DaemonSets."
      ],
      "extendedProperties": {
        "resourceType": "Connected Cluster",
        "namespace": "sample-namespace",
        "container name": "sample-container",
        "container image": "sample-image",
        "pod name": "sample-pod",
        "killChainIntent": "Execution"
      },
      "entities": [
        {
          "$id": "centralus_115",
          "resourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Kubernetes/ConnectedClusters/Sample-ConnectedCluster",
          "type": "azure-resource"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396773908188817_c4c17d2a-dbdb-400f-a3e4-81db71558502/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396773928188817_283ffdd1-9250-44ad-9f91-fe4ddbc9e55c",
    "name": "2517396773928188817_283ffdd1-9250-44ad-9f91-fe4ddbc9e55c",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:23.7861303Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.1811182Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "",
      "alertType": "SIMULATED_AKS_CoreDnsModification",
      "startTimeUtc": "2022-09-08T07:50:07.1811182Z",
      "endTimeUtc": "2022-09-08T07:50:07.1811182Z",
      "severity": "Low",
      "isIncident": false,
      "systemAlertId": "2517396773928188817_283ffdd1-9250-44ad-9f91-fe4ddbc9e55c",
      "intent": "LateralMovement",
      "resourceIdentifiers": [
        {
          "$id": "centralus_116",
          "azureResourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/PROVIDERS/MICROSOFT.CONTAINERSERVICE/MANAGEDCLUSTERS/Sample-KubernetesService",
          "type": "AzureResource",
          "azureResourceTenantId": "ebac1a16-81bf-449b-8d43-5732c3c1d999"
        }
      ],
      "compromisedEntity": "Sample-KubernetesService",
      "alertDisplayName": "[SAMPLE ALERT] CoreDNS modification in Kubernetes detected",
      "description": "THIS IS A SAMPLE ALERT: Kubernetes audit log analysis detected a modification of the CoreDNS configuration. The configuration of CoreDNS can be modified by overriding its configmap. While this activity can be legitimate, if attackers have permissions to modify the configmap, they can change the behavior of the cluster's DNS server and poison it.",
      "remediationSteps": [
        "Review the configmap in the alert details. Specifically, search for Forward or Hosts configurations that can change the desired DNS behavior. The details of the configuration can be retrieved by the command:\\nkubectl get cm coredns-custom -n kube-system -o json\\nIf the configuration is intended, you can ignore the alert."
      ],
      "extendedProperties": {
        "resourceType": "Kubernetes Service",
        "namespace": "sample-namespace",
        "ip address": "0.0.0.0",
        "username": "sample-user",
        "configmap name": "coredns-custom",
        "killChainIntent": "LateralMovement"
      },
      "entities": [
        {
          "$id": "centralus_117",
          "resourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/PROVIDERS/MICROSOFT.CONTAINERSERVICE/MANAGEDCLUSTERS/Sample-KubernetesService",
          "type": "azure-resource"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396773928188817_283ffdd1-9250-44ad-9f91-fe4ddbc9e55c/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396773947877093_13968b11-eed6-4b91-85f5-1f01284e6535",
    "name": "2517396773947877093_13968b11-eed6-4b91-85f5-1f01284e6535",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:26.0484181Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.2122906Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "SQL Server on Azure Virtual Machine",
      "alertType": "SIMULATED_SQL.VM_BruteForce",
      "startTimeUtc": "2022-09-08T07:50:05.2122906Z",
      "endTimeUtc": "2022-09-08T07:50:05.2122906Z",
      "severity": "High",
      "isIncident": false,
      "systemAlertId": "2517396773947877093_13968b11-eed6-4b91-85f5-1f01284e6535",
      "intent": "PreAttack",
      "resourceIdentifiers": [
        {
          "$id": "centralus_118",
          "azureResourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM",
          "type": "AzureResource",
          "azureResourceTenantId": "ebac1a16-81bf-449b-8d43-5732c3c1d999"
        },
        {
          "$id": "centralus_119",
          "workspaceId": "00000000-0000-0000-0000-000000000001",
          "workspaceSubscriptionId": "00000000-0000-0000-0000-000000000000",
          "workspaceResourceGroup": "Sample-RG",
          "agentId": "00000000-0000-0000-0000-000000000000",
          "type": "LogAnalytics"
        }
      ],
      "compromisedEntity": "Sample-VM",
      "alertDisplayName": "[SAMPLE ALERT] Suspected successful brute force attack",
      "description": "THIS IS A SAMPLE ALERT: A successful login occurred after an apparent brute force attack on your resource",
      "remediationSteps": [
        "Go to the firewall settings in order to lock down the firewall as tightly as possible."
      ],
      "extendedProperties": {
        "resourceType": "SQL Server 2019",
        "potential causes": "Brute force attack; penetration testing.",
        "client principal name": "Sample-account",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "client IP address": "0.0.0.0",
        "client IP location": "san antonio, united states",
        "client application": "Sample-app",
        "successful logins": "1",
        "oms workspace ID": "00000000-0000-0000-0000-000000000000",
        "failed logins": "0",
        "oms agent ID": "00000000-0000-0000-0000-000000000000",
        "enrichment_tas_threat__reports": "{\"Kind\":\"MultiLink\",\"DisplayValueToUrlDictionary\":{\"Report: Brute Force\":\"https://interflowwebportalext.trafficmanager.net/reports/DisplayReport?callerIdentity=ddd5443d-e6f4-441c-b52b-5278d2f21dfa&reportCreateDateTime=2022-09-08T06%3a11%3a14&reportName=MSTI-TS-Brute-Force.pdf&tenantId=02c956c7-c7c7-474f-bf3d-2525b9b13b22&urlCreateDateTime=2022-09-08T06%3a11%3a14&token=lU79dHQDMtZN39Sfx3RLt3eRMdnbFP4lDcfdioPY6Gw=\"}}",
        "killChainIntent": "PreAttack"
      },
      "extendedLinks": [
        {
          "href": "https://interflowwebportalext.trafficmanager.net/reports/DisplayReport?callerIdentity=ddd5443d-e6f4-441c-b52b-5278d2f21dfa&reportCreateDateTime=2022-09-08T06%3a11%3a14&reportName=MSTI-TS-Brute-Force.pdf&tenantId=02c956c7-c7c7-474f-bf3d-2525b9b13b22&urlCreateDateTime=2022-09-08T06%3a11%3a14&token=lU79dHQDMtZN39Sfx3RLt3eRMdnbFP4lDcfdioPY6Gw=",
          "category": "enrichment_tas_threat__reports",
          "label": "Report: Brute Force",
          "type": "webLink"
        },
        {
          "href": "https://interflowwebportalext.trafficmanager.net/reports/DisplayReport?callerIdentity=ddd5443d-e6f4-441c-b52b-5278d2f21dfa&reportCreateDateTime=2022-09-08T06%3a11%3a14&reportName=MSTI-TS-Brute-Force.pdf&tenantId=02c956c7-c7c7-474f-bf3d-2525b9b13b22&urlCreateDateTime=2022-09-08T06%3a11%3a14&token=lU79dHQDMtZN39Sfx3RLt3eRMdnbFP4lDcfdioPY6Gw=",
          "category": "enrichment_tas_threat__reports",
          "label": "Report: Brute Force",
          "type": "webLink"
        }
      ],
      "entities": [
        {
          "$id": "centralus_120",
          "hostName": "Sample-VM",
          "azureID": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM",
          "omsAgentID": "00000000-0000-0000-0000-000000000000",
          "type": "host"
        },
        {
          "$id": "centralus_121",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "sample",
            "countryName": "united states",
            "state": "texas",
            "city": "san antonio",
            "longitude": 0,
            "latitude": 0,
            "asn": 0,
            "carrier": "sample",
            "organization": "sample-organization",
            "organizationType": "sample-organization",
            "cloudProvider": "Azure",
            "systemService": "sample"
          },
          "type": "ip"
        },
        {
          "$id": "centralus_122",
          "sourceAddress": {
            "$ref": "centralus_121"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        },
        {
          "$id": "centralus_123",
          "name": "Sample-SA",
          "host": {
            "$ref": "centralus_120"
          },
          "type": "account"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396773947877093_13968b11-eed6-4b91-85f5-1f01284e6535/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396773967877093_68be0218-2e3f-4988-b5ba-f809ad3a3cc0",
    "name": "2517396773967877093_68be0218-2e3f-4988-b5ba-f809ad3a3cc0",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:26.059919Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.2122906Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "SQL Server on Azure Virtual Machine",
      "alertType": "SIMULATED_SQL.VM_PotentialSqlInjection",
      "startTimeUtc": "2022-09-08T07:50:03.2122906Z",
      "endTimeUtc": "2022-09-08T07:50:03.2122906Z",
      "severity": "High",
      "isIncident": false,
      "systemAlertId": "2517396773967877093_68be0218-2e3f-4988-b5ba-f809ad3a3cc0",
      "intent": "PreAttack",
      "resourceIdentifiers": [
        {
          "$id": "centralus_124",
          "azureResourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM",
          "type": "AzureResource",
          "azureResourceTenantId": "ebac1a16-81bf-449b-8d43-5732c3c1d999"
        },
        {
          "$id": "centralus_125",
          "workspaceId": "00000000-0000-0000-0000-000000000001",
          "workspaceSubscriptionId": "00000000-0000-0000-0000-000000000000",
          "workspaceResourceGroup": "Sample-RG",
          "agentId": "00000000-0000-0000-0000-000000000000",
          "type": "LogAnalytics"
        }
      ],
      "compromisedEntity": "Sample-VM",
      "alertDisplayName": "[SAMPLE ALERT] Potential SQL Injection",
      "description": "THIS IS A SAMPLE ALERT: Potential SQL Injection was detected on your database Sample-DB on server Sample-VM",
      "remediationSteps": [
        "{\"displayValue\":\"Read more about SQL Injection threats and best practices for safe application code.\",\"kind\":\"Link\",\"value\":\"https:\\/\\/go.microsoft.com\\/fwlink\\/?linkid=2106894\"}"
      ],
      "extendedProperties": {
        "resourceType": "SQL Server 2019",
        "potential causes": "Defect in application code constructing faulty SQL statements; application code doesn't sanitize user input and was exploited to inject malicious SQL statements",
        "client IP address": "0.0.0.0",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "threat ID": "1",
        "client principal name": "Sample-user",
        "client IP location": "Sample",
        "client application": "Sample-app",
        "oms workspace ID": "00000000-0000-0000-0000-000000000000",
        "oms agent ID": "00000000-0000-0000-0000-000000000000",
        "vulnerable statement": "*** Anonymized ***",
        "killChainIntent": "PreAttack"
      },
      "entities": [
        {
          "$id": "centralus_126",
          "hostName": "Sample-VM",
          "azureID": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM",
          "omsAgentID": "00000000-0000-0000-0000-000000000000",
          "type": "host"
        },
        {
          "$id": "centralus_127",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "sample",
            "countryName": "united states",
            "state": "texas",
            "city": "san antonio",
            "longitude": 0,
            "latitude": 0,
            "asn": 0,
            "carrier": "sample",
            "organization": "sample-organization",
            "organizationType": "sample-organization",
            "cloudProvider": "Azure",
            "systemService": "sample"
          },
          "type": "ip"
        },
        {
          "$id": "centralus_128",
          "name": "Sample-SA",
          "type": "account"
        },
        {
          "$id": "centralus_129",
          "sourceAddress": {
            "$ref": "centralus_127"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396773967877093_68be0218-2e3f-4988-b5ba-f809ad3a3cc0/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396773987877093_73ab757e-aabd-4cd7-b70e-c2d950cfeab2",
    "name": "2517396773987877093_73ab757e-aabd-4cd7-b70e-c2d950cfeab2",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:26.1890858Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.2122906Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "SQL Server on Azure Virtual Machine",
      "alertType": "SIMULATED_SQL.VM_HarmfulApplication",
      "startTimeUtc": "2022-09-08T07:50:01.2122906Z",
      "endTimeUtc": "2022-09-08T07:50:01.2122906Z",
      "severity": "High",
      "isIncident": false,
      "systemAlertId": "2517396773987877093_73ab757e-aabd-4cd7-b70e-c2d950cfeab2",
      "intent": "PreAttack",
      "resourceIdentifiers": [
        {
          "$id": "centralus_130",
          "azureResourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM",
          "type": "AzureResource",
          "azureResourceTenantId": "ebac1a16-81bf-449b-8d43-5732c3c1d999"
        },
        {
          "$id": "centralus_131",
          "workspaceId": "00000000-0000-0000-0000-000000000001",
          "workspaceSubscriptionId": "00000000-0000-0000-0000-000000000000",
          "workspaceResourceGroup": "Sample-RG",
          "agentId": "00000000-0000-0000-0000-000000000000",
          "type": "LogAnalytics"
        }
      ],
      "compromisedEntity": "Sample-VM",
      "alertDisplayName": "[SAMPLE ALERT] Attempted logon by a potentially harmful application",
      "description": "THIS IS A SAMPLE ALERT: A potentially harmful application attempted to access your resource.",
      "remediationSteps": [
        "Go to the firewall settings in order to lock down the firewall as tightly as possible."
      ],
      "extendedProperties": {
        "resourceType": "SQL Server 2019",
        "investigation steps": "{\"displayValue\":\"How to investigate this alert using logs at your Log Analytics workspace.\",\"kind\":\"Link\",\"value\":\"https:\\/\\/go.microsoft.com\\/fwlink\\/?linkid=2091064\"}",
        "potential causes": "Penetration testing; malicious activity",
        "client principal name": "Sample-user",
        "client IP address": "0.0.0.0",
        "client application": "Sample-app",
        "client IP location": "Sample",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "successful Logins from potentially harmful application": "1",
        "oms workspace ID": "00000000-0000-0000-0000-000000000000",
        "oms agent ID": "00000000-0000-0000-0000-000000000000",
        "killChainIntent": "PreAttack"
      },
      "entities": [
        {
          "$id": "centralus_132",
          "hostName": "Sample-VM",
          "azureID": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM",
          "omsAgentID": "00000000-0000-0000-0000-000000000000",
          "type": "host"
        },
        {
          "$id": "centralus_133",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "sample",
            "countryName": "united states",
            "state": "texas",
            "city": "san antonio",
            "longitude": 0,
            "latitude": 0,
            "asn": 0,
            "carrier": "sample",
            "organization": "sample-organization",
            "organizationType": "sample-organization",
            "cloudProvider": "Azure",
            "systemService": "sample"
          },
          "type": "ip"
        },
        {
          "$id": "centralus_134",
          "sourceAddress": {
            "$ref": "centralus_133"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        },
        {
          "$id": "centralus_135",
          "name": "Sample-SA",
          "host": {
            "$ref": "centralus_132"
          },
          "type": "account"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396773987877093_73ab757e-aabd-4cd7-b70e-c2d950cfeab2/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774007877093_faac2219-4e31-4748-afa5-7aa6c0a2b0ea",
    "name": "2517396774007877093_faac2219-4e31-4748-afa5-7aa6c0a2b0ea",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:26.1743156Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.2122906Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "SQL Server on Azure Virtual Machine",
      "alertType": "SIMULATED_SQL.VM_SuspiciousIpAnomaly",
      "startTimeUtc": "2022-09-08T07:49:59.2122906Z",
      "endTimeUtc": "2022-09-08T07:49:59.2122906Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396774007877093_faac2219-4e31-4748-afa5-7aa6c0a2b0ea",
      "intent": "PreAttack",
      "resourceIdentifiers": [
        {
          "$id": "centralus_136",
          "azureResourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/RESOURCEGROUPS/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM",
          "type": "AzureResource",
          "azureResourceTenantId": "ebac1a16-81bf-449b-8d43-5732c3c1d999"
        },
        {
          "$id": "centralus_137",
          "workspaceId": "00000000-0000-0000-0000-000000000001",
          "workspaceSubscriptionId": "00000000-0000-0000-0000-000000000000",
          "workspaceResourceGroup": "Sample-RG",
          "agentId": "00000000-0000-0000-0000-000000000000",
          "type": "LogAnalytics"
        }
      ],
      "compromisedEntity": "Sample-VM",
      "alertDisplayName": "[SAMPLE ALERT] Login from a suspicious IP",
      "description": "THIS IS A SAMPLE ALERT: Your resource has been accessed successfully from an IP address that Microsoft Threat Intelligence has associated with suspicious activity.",
      "remediationSteps": [
        "Go to the firewall settings in order to lock down the firewall as tightly as possible."
      ],
      "extendedProperties": {
        "resourceType": "SQL Server 2019",
        "investigation steps": "{\"displayValue\":\"How to investigate this alert using logs at your Log Analytics workspace.\",\"kind\":\"Link\",\"value\":\"https:\\/\\/go.microsoft.com\\/fwlink\\/?linkid=2091064\"}",
        "potential causes": "An attacker has accessed your database from a potentially suspicious IP; a legitimate user has accessed your database from a potentially suspicious IP.",
        "client principal name": "Sample-user",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "client IP address": "0.0.0.0",
        "client IP location": "Sample",
        "client application": "Sample-app",
        "oms workspace ID": "00000000-0000-0000-0000-000000000000",
        "oms agent ID": "00000000-0000-0000-0000-000000000000",
        "killChainIntent": "PreAttack"
      },
      "entities": [
        {
          "$id": "centralus_138",
          "hostName": "Sample-VM",
          "azureID": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/Microsoft.Compute/virtualMachines/Sample-VM",
          "omsAgentID": "00000000-0000-0000-0000-000000000000",
          "type": "host"
        },
        {
          "$id": "centralus_139",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "sample",
            "countryName": "united states",
            "state": "texas",
            "city": "san antonio",
            "longitude": 0,
            "latitude": 0,
            "asn": 0,
            "carrier": "sample",
            "organization": "sample-organization",
            "organizationType": "sample-organization",
            "cloudProvider": "Azure",
            "systemService": "sample"
          },
          "threatIntelligence": [
            {
              "providerName": "Sample-Provider",
              "threatType": "Sample-Threat",
              "threatName": "Sample-Threat",
              "confidence": 0.8,
              "threatDescription": "Sample-Threat"
            }
          ],
          "type": "ip"
        },
        {
          "$id": "centralus_140",
          "sourceAddress": {
            "$ref": "centralus_139"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        },
        {
          "$id": "centralus_141",
          "name": "Sample-SA",
          "host": {
            "$ref": "centralus_138"
          },
          "type": "account"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774007877093_faac2219-4e31-4748-afa5-7aa6c0a2b0ea/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/providers/Microsoft.Security/locations/centralus/alerts/2517396774027877093_d5667837-8ca4-48ad-8750-490ed8e46515",
    "name": "2517396774027877093_d5667837-8ca4-48ad-8750-490ed8e46515",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:25.9158647Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.2122906Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "ARM",
      "alertType": "SIMULATED_ARM_AnomalousRBACRoleAssignment",
      "startTimeUtc": "2022-09-08T07:49:57.2122906Z",
      "endTimeUtc": "2022-09-08T07:49:57.2122906Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396774027877093_d5667837-8ca4-48ad-8750-490ed8e46515",
      "intent": "DefenseEvasion, LateralMovement",
      "resourceIdentifiers": [
        {
          "$id": "centralus_142",
          "azureResourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb",
          "type": "AzureResource",
          "azureResourceTenantId": "ebac1a16-81bf-449b-8d43-5732c3c1d999"
        }
      ],
      "compromisedEntity": "0f907ea4-bc8b-4c11-9d7e-805c2fd144fb",
      "alertDisplayName": "[SAMPLE ALERT] Permissions granted for an RBAC role in an unusual way for your Azure environment (Preview)",
      "description": "THIS IS A SAMPLE ALERT: Azure Defender for Resource Manager detected an RBAC role assignment that's unusual when compared with other assignments, performed by the same assigner.\n The following components were anomalous:\n -Assigner Authentication Method \n This operation might have been performed by a legitimate user in your organization. Alternatively, it might indicate that an account in your organization was breached, and that the threat actor is trying to grant permissions to an additional user account they own.",
      "remediationSteps": [
        "1. To determine whether this was a legitimate operation performed by the actual account owner, contact the account owner of the assigner.\n2. If the activity is legitimate, dismiss this alert. Otherwise, treat the user accounts of the assigner and assignee as compromised and continue with the steps below.\n3. Change the passwords of the accounts of the assigner and assignee, or block the user accounts entirely.\n4. Using Azure Activity Logs and Azure AD audit logs, review all activities performed by the user. \n5. Change the credentials for all resources that the user had permissions to access.\n6. Treat the resource as compromised and perform remediation actions: review IAM permissions for the resource and remove permissions for any unfamiliar user account, review all Azure Security Center alerts related to the resource and investigate them, review all activities performed in this resource via Azure Activity Logs and investigate suspicious activities."
      ],
      "extendedProperties": {
        "scope of assignment": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb",
        "assigned role definition ID": "00000000-0000-0000-0000-000000000000",
        "assignee principal ID": "00000000-0000-0000-0000-000000000000",
        "assigner principal ID": "Sample user",
        "resourceType": "Azure Resource",
        "killChainIntent": "DefenseEvasion, LateralMovement"
      },
      "entities": [
        {
          "$id": "centralus_143",
          "name": "Sample user",
          "upnSuffix": "sample",
          "aadTenantId": "00000000-0000-0000-0000-000000000000",
          "aadUserId": "00000000-0000-0000-0000-000000000000",
          "type": "account"
        },
        {
          "$id": "centralus_144",
          "resourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_145",
          "address": "0.0.0.0",
          "type": "ip"
        },
        {
          "$id": "centralus_146",
          "sourceAddress": {
            "$ref": "centralus_145"
          },
          "type": "network-connection"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774027877093_d5667837-8ca4-48ad-8750-490ed8e46515/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/providers/Microsoft.Security/locations/centralus/alerts/2517396774047877093_9db95c16-6942-41aa-a694-af3e6fc5a810",
    "name": "2517396774047877093_9db95c16-6942-41aa-a694-af3e6fc5a810",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:25.9669319Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.2122906Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "ARM",
      "alertType": "SIMULATED_ARM_PrivilegedRoleDefinitionCreation",
      "startTimeUtc": "2022-09-08T07:49:55.2122906Z",
      "endTimeUtc": "2022-09-08T07:49:55.2122906Z",
      "severity": "Low",
      "isIncident": false,
      "systemAlertId": "2517396774047877093_9db95c16-6942-41aa-a694-af3e6fc5a810",
      "intent": "PrivilegeEscalation, DefenseEvasion",
      "resourceIdentifiers": [
        {
          "$id": "centralus_147",
          "azureResourceId": "/SUBSCRIPTIONS/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb",
          "type": "AzureResource",
          "azureResourceTenantId": "ebac1a16-81bf-449b-8d43-5732c3c1d999"
        }
      ],
      "compromisedEntity": "0f907ea4-bc8b-4c11-9d7e-805c2fd144fb",
      "alertDisplayName": "[SAMPLE ALERT] Privileged custom role created for your subscription in a suspicious way (Preview)",
      "description": "THIS IS A SAMPLE ALERT: Azure Defender for Resource Manager detected a suspicious creation of privileged custom role definition in your subscription. This operation might have been performed by a legitimate user in your organization. Alternatively, it might indicate that an account in your organization was breached, and that the threat actor is trying to create a privileged role to use in the future to evade detection.",
      "remediationSteps": [
        "1. To determine whether this was a legitimate operation performed by the actual account owner, contact the account owner of the principal user that created the role.\n2. If the activity is legitimate, dismiss this alert. Otherwise, treat the user account as compromised and continue with the steps below.\n3. Change the passwords of the user account or block the account entirely.\n4. Delete the privileged role.\n5. Using Azure Activity Logs and Azure AD audit logs, review all activities performed by the user.\n6. Change the credentials for all resources that the user had permissions to access."
      ],
      "extendedProperties": {
        "role definition creator principal ID": "00000000-0000-0000-0000-000000000000",
        "role definition creator IP address": "0.0.0.0",
        "role definition creator principal name": "Sample user",
        "role definition name": "sample",
        "role definition ID": "00000000-0000-0000-0000-000000000000",
        "resourceType": "Azure Resource",
        "killChainIntent": "PrivilegeEscalation, DefenseEvasion"
      },
      "entities": [
        {
          "$id": "centralus_148",
          "name": "Sample user",
          "upnSuffix": "sample",
          "aadTenantId": "00000000-0000-0000-0000-000000000000",
          "aadUserId": "00000000-0000-0000-0000-000000000000",
          "type": "account"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774047877093_9db95c16-6942-41aa-a694-af3e6fc5a810/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/providers/Microsoft.Security/locations/centralus/alerts/2517396774107877093_4db8f472-8885-4fc9-9833-b80d5e94172a",
    "name": "2517396774107877093_4db8f472-8885-4fc9-9833-b80d5e94172a",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:26.094171Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.2122906Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Azure Security Center",
      "productComponentName": "ARM",
      "alertType": "SIMULATED_ARM_AnomalousClassicRoleAssignment",
      "startTimeUtc": "2022-09-08T07:49:49.2122906Z",
      "endTimeUtc": "2022-09-08T07:49:49.2122906Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396774107877093_4db8f472-8885-4fc9-9833-b80d5e94172a",
      "intent": "DefenseEvasion, LateralMovement",
      "resourceIdentifiers": [
        {
          "$id": "centralus_149",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb",
          "type": "AzureResource",
          "azureResourceTenantId": "ebac1a16-81bf-449b-8d43-5732c3c1d999"
        }
      ],
      "compromisedEntity": "0f907ea4-bc8b-4c11-9d7e-805c2fd144fb",
      "alertDisplayName": "[SAMPLE ALERT] Permissions granted for a classic role in an unusual way for your Azure environment (Preview)",
      "description": "THIS IS A SAMPLE ALERT: Microsoft Defender for Resource Manager detected a role assignment that's unusual when compared with other assignments performed by the same assigner / performed for the same assignee / in the tenant due to the following anomalies: \nassignment time, assigner location, assigner, authentication method, assigned entities, client software used, assignment extent. \nThis operation might have been performed by a legitimate user in your organization. Alternatively, it might indicate that an account in your organization was breached, and that the threat actor is trying to escalate privileges to a different user account.",
      "remediationSteps": [
        "1.To determine whether this was a legitimate operation performed by the actual account owner, contact the account owner of the assigner.\n2. If the activity is legitimate, dismiss this alert. Otherwise, treat the user accounts of the assigner and assignee as compromised and continue with the steps below. \n3. Change the passwords of the accounts of the assigner and assignee, or block the user accounts entirely.\n4. Using Azure Activity Logs and Azure AD audit logs, review all activities performed by the user.\n5. Change the credentials for all resources that the user had permissions to access. \n6. Treat the resource as compromised and perform remediation actions: review IAM permissions for the resource and remove permissions for any unfamiliar user account, review all Azure Security Center alerts related to the resource and investigate them, review Azure Activity Logs for activities performed in this resource."
      ],
      "extendedProperties": {
        "assigner principal ID": "sample",
        "assignee principal ID": "00000000-0000-0000-0000-000000000000",
        "scope of assignment": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb",
        "role": "CoAdmin",
        "resourceType": "Azure Resource",
        "killChainIntent": "DefenseEvasion, LateralMovement"
      },
      "entities": [
        {
          "$id": "centralus_150",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_151",
          "name": "sample",
          "upnSuffix": "contoso.com",
          "aadTenantId": "00000000-0000-0000-0000-000000000000",
          "aadUserId": "00000000-0000-0000-0000-000000000000",
          "type": "account"
        },
        {
          "$id": "centralus_152",
          "address": "0.0.0.0",
          "type": "ip"
        },
        {
          "$id": "centralus_153",
          "name": "azureadmin",
          "upnSuffix": "contoso.com",
          "aadTenantId": "00000000-0000-0000-0000-000000000000",
          "type": "account"
        },
        {
          "$id": "centralus_154",
          "sourceAddress": {
            "$ref": "centralus_152"
          },
          "type": "network-connection"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774107877093_4db8f472-8885-4fc9-9833-b80d5e94172a/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774148188817_1b15a8c3-a765-4f3a-a3b0-d61c6b7edcb8",
    "name": "2517396774148188817_1b15a8c3-a765-4f3a-a3b0-d61c6b7edcb8",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:25.4297788Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.196663Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "Storage Accounts",
      "alertType": "SIMULATED_Storage.Files_TorAnomaly",
      "startTimeUtc": "2022-09-08T07:49:45.1811182Z",
      "endTimeUtc": "2022-09-08T07:49:45.1811182Z",
      "severity": "High",
      "isIncident": false,
      "systemAlertId": "2517396774148188817_1b15a8c3-a765-4f3a-a3b0-d61c6b7edcb8",
      "intent": "InitialAccess",
      "resourceIdentifiers": [
        {
          "$id": "centralus_155",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-Storage",
      "alertDisplayName": "[SAMPLE ALERT] Access from a Tor exit node to a storage file share",
      "description": "THIS IS A SAMPLE ALERT: An IP that is a known Tor exit node accessed Storage file share 'Sample-fileShare' in storage account 'Sample-Storage'. ",
      "remediationSteps": [
        "• Revoke all credentials that may be compromised and ensure that they're only shared with authorized users.",
        "• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email."
      ],
      "extendedProperties": {
        "resourceType": "Storage",
        "potential causes": "This alert indicates that this account has been accessed successfully from an IP address that is known as an active exit node of Tor (an anonymizing proxy). The severity of this alert takes into account the authentication type used (if any), and whether this is the first case of such access.\r\nPotential causes:\r\n• An attacker has accessed the storage account using Tor and is trying to hide their identity (true positive).\r\n• A legitimate user has accessed the storage account using Tor, perhaps for penetration testing (benign positive).",
        "investigation steps": "• Check if this actor is legitimate. Examine the authentication method and credentials used, as well as the actor's history of actions on this storage account and other resources in this subscription.\r\n• Limit access to your storage account, following the 'least privilege' principle: https://go.microsoft.com/fwlink/?linkid=2075737.",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "client location": "Sample-Location",
        "authentication type": "Shared access signature (SAS)",
        "user agent": "Sample-Agent",
        "service type": "Azure Files",
        "azure AD user": "N/A (Azure AD user authentication was not used)",
        "operations types": "GetFile",
        "api type": "Files REST",
        "size of extracted data": "0 Bytes",
        "file share": "Sample-fileShare",
        "killChainIntent": "InitialAccess"
      },
      "entities": [
        {
          "$id": "centralus_156",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_157",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington",
            "longitude": -78.17197,
            "latitude": 38.73078,
            "asn": 8075
          },
          "type": "ip"
        },
        {
          "$id": "centralus_158",
          "sourceAddress": {
            "$ref": "centralus_157"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774148188817_1b15a8c3-a765-4f3a-a3b0-d61c6b7edcb8/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774168188817_b07bb574-4320-49a8-b85a-3e9080c7512b",
    "name": "2517396774168188817_b07bb574-4320-49a8-b85a-3e9080c7512b",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:25.3351999Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.196663Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "Storage Accounts",
      "alertType": "SIMULATED_Storage.Files_SuspiciousIp",
      "startTimeUtc": "2022-09-08T07:49:43.1811182Z",
      "endTimeUtc": "2022-09-08T07:49:43.1811182Z",
      "severity": "High",
      "isIncident": false,
      "systemAlertId": "2517396774168188817_b07bb574-4320-49a8-b85a-3e9080c7512b",
      "intent": "PreAttack",
      "resourceIdentifiers": [
        {
          "$id": "centralus_159",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-Storage",
      "alertDisplayName": "[SAMPLE ALERT] Access from a suspicious IP to a storage file share",
      "description": "THIS IS A SAMPLE ALERT: Someone has accessed your Azure storage account 'Sample-Storage' from a suspicious IP address.",
      "remediationSteps": [
        "• Limit access to your storage account, following the 'least privilege' principle: https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-privileged-access#pa-7-follow-just-enough-administration-least-privilege-principle.",
        "• Consider using identity-based authentication: https://docs.microsoft.com/en-us/azure/storage/files/storage-files-identity-auth-active-directory-domain-service-enable.",
        "• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.",
        "• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email."
      ],
      "extendedProperties": {
        "resourceType": "Storage",
        "potential causes": "This alert indicates that this account has been accessed successfully from an IP address that is considered suspicious.\r\nPotential causes:\r\n• An attacker has accessed your storage account from a potentially suspicious IP.\r\n• A legitimate user has accessed your storage account from a potentially suspicious IP.",
        "investigation steps": "{\"displayValue\":\"View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information\",\"kind\":\"Link\",\"value\":\"https:\\/\\/go.microsoft.com\\/fwlink\\/?linkid=2075734\"}",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "client location": "Sample-Location",
        "authentication type": "Shared access signature (SAS)",
        "user agent": "Sample-Agent",
        "service type": "Azure Files",
        "azure AD user": "N/A (Azure AD user authentication was not used)",
        "operations types": "GetFile",
        "api type": "Files REST",
        "size of extracted data": "0 Bytes",
        "file share": "Sample-fileShare",
        "killChainIntent": "PreAttack"
      },
      "entities": [
        {
          "$id": "centralus_160",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_161",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington",
            "longitude": -78.17197,
            "latitude": 38.73078,
            "asn": 8075
          },
          "threatIntelligence": [
            {
              "providerName": "AlertSimulator",
              "threatType": "Sample-Type",
              "threatName": "Sample-Threat",
              "confidence": 1,
              "threatDescription": ""
            }
          ],
          "type": "ip"
        },
        {
          "$id": "centralus_162",
          "sourceAddress": {
            "$ref": "centralus_161"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774168188817_b07bb574-4320-49a8-b85a-3e9080c7512b/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774188188817_4ac3c2b9-57f4-426d-b9dd-a9fd0aeecc78",
    "name": "2517396774188188817_4ac3c2b9-57f4-426d-b9dd-a9fd0aeecc78",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:25.2908794Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.196663Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "Storage Accounts",
      "alertType": "SIMULATED_Storage.Files_SMBExeOverwriteAnomaly",
      "startTimeUtc": "2022-09-08T07:49:41.1811182Z",
      "endTimeUtc": "2022-09-08T07:49:41.1811182Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396774188188817_4ac3c2b9-57f4-426d-b9dd-a9fd0aeecc78",
      "intent": "LateralMovement, Execution",
      "resourceIdentifiers": [
        {
          "$id": "centralus_163",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-Storage",
      "alertDisplayName": "[SAMPLE ALERT] Unusual overwrite of .exe in a storage file share",
      "description": "THIS IS A SAMPLE ALERT: Someone has performed an unusual overwrite of an executable file in your Azure storage account 'Sample-Storage'.",
      "remediationSteps": [
        "• Delete the .exe from your storage account.",
        "• Limit access to your storage account, following the 'least privilege' principle. Consider using identity-based authentication: https://docs.microsoft.com/en-us/azure/storage/files/storage-files-active-directory-overview.",
        "• Rotate all storage account keys that may be compromised and ensure that your storage account keys are only shared with authorized users.",
        "• Ensure that storage account keys are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage account keys in source code, documentation, and email."
      ],
      "extendedProperties": {
        "resourceType": "Storage",
        "potential causes": "This alert indicates that an unexpected overwrite of an executable (.exe file) has occurred in a storage account, compared to recent activity on this account.\r\nPotential causes:\r\n• An attacker has overwritten an executable file with a potentially malicious one in your storage account.\r\n• A legitimate user has overwritten an executable file.",
        "investigation steps": "• Determine who overwrote the latest version of the executable file.\r\n• View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information: https://go.microsoft.com/fwlink/?linkid=2075734",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "client location": "Sample-Location",
        "authentication type": "Kerberos",
        "user agent": "Sample-Agent",
        "service type": "Azure Files",
        "azure AD user": "N/A (Azure AD user authentication was not used)",
        "api type": "Files SMB",
        "additional Information": "Sample-Additional-Information",
        "request status": "",
        "activity type": "OverwriteFile",
        "file share": "Sample-fileShare",
        "storage file path(s) overwritten": "Sample-File",
        "killChainIntent": "LateralMovement, Execution"
      },
      "entities": [
        {
          "$id": "centralus_164",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_165",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington",
            "longitude": -78.17197,
            "latitude": 38.73078,
            "asn": 8075
          },
          "type": "ip"
        },
        {
          "$id": "centralus_166",
          "sourceAddress": {
            "$ref": "centralus_165"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774188188817_4ac3c2b9-57f4-426d-b9dd-a9fd0aeecc78/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774208188817_a8ffb11a-3785-4277-999e-6973fe52dca5",
    "name": "2517396774208188817_a8ffb11a-3785-4277-999e-6973fe52dca5",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:25.397688Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.196663Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "Storage Accounts",
      "alertType": "SIMULATED_Storage.Files_PermissionsChangeAnomaly",
      "startTimeUtc": "2022-09-08T07:49:39.1811182Z",
      "endTimeUtc": "2022-09-08T07:49:39.1811182Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396774208188817_a8ffb11a-3785-4277-999e-6973fe52dca5",
      "intent": "Persistence",
      "resourceIdentifiers": [
        {
          "$id": "centralus_167",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-Storage",
      "alertDisplayName": "[SAMPLE ALERT] Unusual change of access permissions in a storage file share",
      "description": "THIS IS A SAMPLE ALERT: Someone has performed an unusual change of access permissions of a directory or a file in your Azure storage account 'Sample-Storage'.",
      "remediationSteps": [
        "• Limit access to your storage account, following the 'least privilege' principle. Consider using identity-based authentication: https://docs.microsoft.com/en-us/azure/storage/files/storage-files-active-directory-overview.",
        "• Rotate all storage account keys that may be compromised and ensure that your storage account keys are only shared with authorized users.",
        "• Ensure that storage directory or file permissions are configured correctly.",
        "• Ensure that storage account keys are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage account keys in source code, documentation, and email."
      ],
      "extendedProperties": {
        "resourceType": "Storage",
        "potential causes": "This alert indicates that the access permissions of this directory or file have been changed in an unusual way.\r\nPotential causes:\r\n• An attacker has changed directory or file permissions to weaken its security.\r\n• A legitimate user has changed directory or file permissions.",
        "investigation steps": "• Confirm whether the directory or file permissions change was performed for a legitimate purpose.\r\n• Review the directory's or file's access permissions to make sure they are expected. NTFS permissions can be assigned at the directory or file level: https://docs.microsoft.com/en-us/azure/storage/files/storage-files-identity-auth-active-directory-enable#3-configure-ntfs-permissions-over-smb .\r\n• View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information: https://go.microsoft.com/fwlink/?linkid=2075734",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "authentication type": "Kerberos",
        "client location": "Sample-Location",
        "user agent": "Sample-Agent",
        "service type": "Azure Files",
        "azure AD user": "N/A (Azure AD user authentication was not used)",
        "additional Information": "Sample-Additional-Information",
        "api type": "Files SMB",
        "request status": "",
        "activity type": "SetSecurityInformation",
        "file share": "Sample-fileShare",
        "storage file path(s) accessed": "",
        "killChainIntent": "Persistence"
      },
      "entities": [
        {
          "$id": "centralus_168",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_169",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington",
            "longitude": -78.17197,
            "latitude": 38.73078,
            "asn": 8075
          },
          "type": "ip"
        },
        {
          "$id": "centralus_170",
          "sourceAddress": {
            "$ref": "centralus_169"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774208188817_a8ffb11a-3785-4277-999e-6973fe52dca5/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774228188817_d4001b3c-d0e9-4689-9784-5c26deb69356",
    "name": "2517396774228188817_d4001b3c-d0e9-4689-9784-5c26deb69356",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:25.2478781Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.196663Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "Storage Accounts",
      "alertType": "SIMULATED_Storage.Files_MalwareHashReputation",
      "startTimeUtc": "2022-09-08T07:49:37.1811182Z",
      "endTimeUtc": "2022-09-08T07:49:37.1811182Z",
      "severity": "High",
      "isIncident": false,
      "systemAlertId": "2517396774228188817_d4001b3c-d0e9-4689-9784-5c26deb69356",
      "intent": "LateralMovement",
      "resourceIdentifiers": [
        {
          "$id": "centralus_171",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-Storage",
      "alertDisplayName": "[SAMPLE ALERT] Potential malware uploaded to a storage file share",
      "description": "THIS IS A SAMPLE ALERT: Someone has uploaded potential malware to your Azure storage account 'Sample-Storage'.",
      "remediationSteps": [
        "• Remove the malicious file from your storage account.",
        "• Limit access to your storage account, following the 'least privilege' principle: https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-privileged-access#pa-7-follow-just-enough-administration-least-privilege-principle.",
        "• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.",
        "• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email."
      ],
      "extendedProperties": {
        "resourceType": "Storage",
        "potential causes": "This alert indicates that a blob containing potential malware has been uploaded to your storage account.\r\nPotential causes:\r\n• An attacker has gained access to the storage account and has intentionally uploaded a malicious blob.\r\n• A legitimate user has unintentionally uploaded a malicious blob.\r\n• A legitimate user is performing tests on the system (e.g. penetration testing).",
        "investigation steps": "{\"displayValue\":\"View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information\",\"kind\":\"Link\",\"value\":\"https:\\/\\/go.microsoft.com\\/fwlink\\/?linkid=2075734\"}",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "client location": "Sample-Location",
        "authentication type": "Shared access signature (SAS)",
        "user agent": "Sample-Agent",
        "service type": "Azure Files",
        "azure AD user": "N/A (Azure AD user authentication was not used)",
        "operations types": "PutRange",
        "file": "dummy/path/to/maliciousFile.exe",
        "api type": "Files REST",
        "file share": "Sample-fileShare",
        "malware description": "File was identified as malicious, MalwareFamily = Virus:DOS/EICAR_Test_File",
        "threat report summary": "The European Institute for Computer Antivirus Research (EICAR)  and the Computer Antivirus Research Organization (CARO)  jointly developed a standard test file protocol called the “EICAR test file” which allows users to test their antivirus solution. The EICAR file is completely benign; however, when scanned, compliant antivirus solutions report the file in the same way as an actual malicious file. This does not mean that the computer is infected with malware, but rather it shows that the computer’s antivirus is functioning as expected.",
        "detection source": "Team Cymru",
        "threat report": "Sample-Report",
        "killChainIntent": "LateralMovement"
      },
      "entities": [
        {
          "$id": "centralus_172",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_173",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington",
            "longitude": -78.17197,
            "latitude": 38.73078,
            "asn": 8075
          },
          "type": "ip"
        },
        {
          "$id": "centralus_174",
          "algorithm": "MD5",
          "value": "Sample-SHA",
          "type": "filehash"
        },
        {
          "$id": "centralus_175",
          "sourceAddress": {
            "$ref": "centralus_173"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        },
        {
          "$id": "centralus_176",
          "directory": "Sample-fileShare/dummy/path/to",
          "name": "Sample-Name",
          "fileHashes": [
            {
              "$ref": "centralus_174"
            }
          ],
          "type": "file"
        },
        {
          "$id": "centralus_177",
          "name": "Sample-Name",
          "category": "Virus",
          "files": [
            {
              "$ref": "centralus_176"
            }
          ],
          "type": "malware"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774228188817_d4001b3c-d0e9-4689-9784-5c26deb69356/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774248188817_53704b0e-c7dd-4618-a4e8-9895f24e2ad3",
    "name": "2517396774248188817_53704b0e-c7dd-4618-a4e8-9895f24e2ad3",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:25.178965Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.196663Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "Storage Accounts",
      "alertType": "SIMULATED_Storage.Files_GeoAnomaly",
      "startTimeUtc": "2022-09-08T07:49:35.1811182Z",
      "endTimeUtc": "2022-09-08T07:49:35.1811182Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396774248188817_53704b0e-c7dd-4618-a4e8-9895f24e2ad3",
      "intent": "InitialAccess",
      "resourceIdentifiers": [
        {
          "$id": "centralus_178",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-Storage",
      "alertDisplayName": "[SAMPLE ALERT] Access from an unusual location to a storage file share",
      "description": "THIS IS A SAMPLE ALERT: Someone has accessed your Azure storage account 'Sample-Storage' from an unusual location.",
      "remediationSteps": [
        "• Limit access to your storage account, following the 'least privilege' principle: https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-privileged-access#pa-7-follow-just-enough-administration-least-privilege-principle.",
        "• Consider using identity-based authentication: https://docs.microsoft.com/en-us/azure/storage/files/storage-files-identity-auth-active-directory-domain-service-enable.",
        "• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.",
        "• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email."
      ],
      "extendedProperties": {
        "resourceType": "Storage",
        "potential causes": "This alert indicates that this account has been accessed successfully from an IP address that is unfamiliar and unexpected compared to recent access pattern on this account.\r\nPotential causes:\r\n• An attacker has accessed your storage account.\r\n• A legitimate user has accessed your storage account from a new location.",
        "investigation steps": "{\"displayValue\":\"View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information\",\"kind\":\"Link\",\"value\":\"https:\\/\\/go.microsoft.com\\/fwlink\\/?linkid=2075734\"}",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "client location": "Sample-Location",
        "authentication type": "Shared access signature (SAS)",
        "user agent": "Sample-Agent",
        "service type": "Azure Files",
        "azure AD user": "N/A (Azure AD user authentication was not used)",
        "operations types": "GetShareProperties",
        "api type": "Files REST",
        "file share": "Sample-fileShare",
        "killChainIntent": "InitialAccess"
      },
      "entities": [
        {
          "$id": "centralus_179",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_180",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington",
            "longitude": -78.17197,
            "latitude": 38.73078,
            "asn": 8075
          },
          "type": "ip"
        },
        {
          "$id": "centralus_181",
          "sourceAddress": {
            "$ref": "centralus_180"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774248188817_53704b0e-c7dd-4618-a4e8-9895f24e2ad3/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774268188817_6b549566-d42f-4429-9aad-77516cc8ba60",
    "name": "2517396774268188817_6b549566-d42f-4429-9aad-77516cc8ba60",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:25.1372273Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.196663Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "Storage Accounts",
      "alertType": "SIMULATED_Storage.Files_ExeUploadAnomaly",
      "startTimeUtc": "2022-09-08T07:49:33.1811182Z",
      "endTimeUtc": "2022-09-08T07:49:33.1811182Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396774268188817_6b549566-d42f-4429-9aad-77516cc8ba60",
      "intent": "LateralMovement, Execution",
      "resourceIdentifiers": [
        {
          "$id": "centralus_182",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-Storage",
      "alertDisplayName": "[SAMPLE ALERT] Unusual upload of .exe to a storage file share",
      "description": "THIS IS A SAMPLE ALERT: Someone has performed an unusual upload of an executable file to your Azure storage account 'Sample-Storage'.",
      "remediationSteps": [
        "• Delete the .exe from your storage account.",
        "• Limit access to your storage account, following the 'least privilege' principle. Consider using identity-based authentication: https://docs.microsoft.com/en-us/azure/storage/files/storage-files-active-directory-overview.",
        "• Rotate all storage account keys that may be compromised and ensure that your storage account keys are only shared with authorized users.",
        "• Ensure that storage account keys are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage account keys in source code, documentation, and email."
      ],
      "extendedProperties": {
        "resourceType": "Storage",
        "potential causes": "This alert indicates that an executable (.exe file) has been uploaded to a storage account in an unusual way, compared to recent activity on this account.\r\nPotential causes:\r\n• An attacker has uploaded a malicious executable file to your storage account.\r\n• A legitimate user has uploaded an executable file.",
        "investigation steps": "• Determine who uploaded the latest version of the executable file.\r\n• View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information: https://go.microsoft.com/fwlink/?linkid=2075734",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "authentication type": "Kerberos",
        "client location": "Sample-Location",
        "user agent": "Sample-Agent",
        "service type": "Azure Files",
        "azure AD user": "N/A (Azure AD user authentication was not used)",
        "additional Information": "Sample-Additional-Information",
        "api type": "Files SMB",
        "request status": "",
        "activity type": "CreateFile",
        "file share": "Sample-fileShare",
        "storage file path(s) uploaded": "Sample-Path1, Sample-Path2",
        "killChainIntent": "LateralMovement, Execution"
      },
      "entities": [
        {
          "$id": "centralus_183",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_184",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington",
            "longitude": -78.17197,
            "latitude": 38.73078,
            "asn": 8075
          },
          "type": "ip"
        },
        {
          "$id": "centralus_185",
          "sourceAddress": {
            "$ref": "centralus_184"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774268188817_6b549566-d42f-4429-9aad-77516cc8ba60/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774288188817_6d057100-7891-4ddd-9327-94c9f1c8f851",
    "name": "2517396774288188817_6d057100-7891-4ddd-9327-94c9f1c8f851",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:25.1164488Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.196663Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "Storage Accounts",
      "alertType": "SIMULATED_Storage.Files_DeletionAnomaly",
      "startTimeUtc": "2022-09-08T07:49:31.1811182Z",
      "endTimeUtc": "2022-09-08T07:49:31.1811182Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396774288188817_6d057100-7891-4ddd-9327-94c9f1c8f851",
      "intent": "Exfiltration",
      "resourceIdentifiers": [
        {
          "$id": "centralus_186",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-Storage",
      "alertDisplayName": "[SAMPLE ALERT] Unusual deletion in a storage file share",
      "description": "THIS IS A SAMPLE ALERT: Someone has performed an unusual deletion in your Azure storage account 'Sample-Storage'.",
      "remediationSteps": [
        "• Limit access to your storage account, following the 'least privilege' principle:  https://docs.microsoft.com/en-us/azure/storage/common/storage-sas-overview?toc=/azure/storage/files/toc.json.",
        "• Consider using identity-based authentication: https://docs.microsoft.com/en-us/azure/storage/files/storage-files-identity-auth-active-directory-domain-service-enable.",
        "• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.",
        "• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email."
      ],
      "extendedProperties": {
        "resourceType": "Storage",
        "potential causes": "This alert indicates that one or more unexpected delete operations has occurred in a storage account, compared to recent activity on this account.\r\nPotential causes:\r\n• An attacker has deleted data from your storage account.\r\n• A legitimate user has performed an unusual deletion.",
        "investigation steps": "• Confirm whether the data deletion was intended based on information provided above such as IP address, location and user agent used.\r\n• View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information: https://go.microsoft.com/fwlink/?linkid=2075734",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "client location": "Sample-Location",
        "authentication type": "Shared access signature (SAS)",
        "user agent": "Sample-Agent",
        "service type": "Azure Files",
        "azure AD user": "N/A (Azure AD user authentication was not used)",
        "api type": "Files REST",
        "additional Information": "Sample-Additional-Information",
        "access key used to generate SAS token": "key1",
        "request status": "Success",
        "activity type": "DeleteFile",
        "file share": "Sample-fileShare",
        "storage file path(s) deleted": "Sample-File1, Sample-File2",
        "killChainIntent": "Exfiltration"
      },
      "entities": [
        {
          "$id": "centralus_187",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_188",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington",
            "longitude": -78.17197,
            "latitude": 38.73078,
            "asn": 8075
          },
          "type": "ip"
        },
        {
          "$id": "centralus_189",
          "sourceAddress": {
            "$ref": "centralus_188"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774288188817_6d057100-7891-4ddd-9327-94c9f1c8f851/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774308188817_0b30cc11-b413-4d07-b447-8219ee61426a",
    "name": "2517396774308188817_0b30cc11-b413-4d07-b447-8219ee61426a",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:25.0695556Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.196663Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "Storage Accounts",
      "alertType": "SIMULATED_Storage.Files_DataExplorationAnomaly",
      "startTimeUtc": "2022-09-08T07:49:29.1811182Z",
      "endTimeUtc": "2022-09-08T07:49:29.1811182Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396774308188817_0b30cc11-b413-4d07-b447-8219ee61426a",
      "intent": "Collection",
      "resourceIdentifiers": [
        {
          "$id": "centralus_190",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-Storage",
      "alertDisplayName": "[SAMPLE ALERT] Unusual data exploration in a storage file share",
      "description": "THIS IS A SAMPLE ALERT: Someone has performed an unusual data exploration operation in your Azure storage account 'Sample-Storage'.",
      "remediationSteps": [
        "• Limit access to your storage account, following the 'least privilege' principle:  https://docs.microsoft.com/en-us/azure/storage/common/storage-sas-overview?toc=/azure/storage/files/toc.json.",
        "• Consider using identity-based authentication: https://docs.microsoft.com/en-us/azure/storage/files/storage-files-identity-auth-active-directory-domain-service-enable.",
        "• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.",
        "• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email."
      ],
      "extendedProperties": {
        "resourceType": "Storage",
        "potential causes": "This alert indicates that files in a file share of a storage account have been enumerated in an unusual way, compared to recent activity on this account.\r\nPotential causes:\r\n• An attacker has performed reconnaissance for a future attack.\r\n• A legitimate user or application logic has explored data within the storage account.",
        "investigation steps": "• Confirm whether the storage account access was expected, based on information provided above such as IP address, location and user agent used.\r\n• View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information: https://go.microsoft.com/fwlink/?linkid=2075734",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "client location": "Sample-Location",
        "authentication type": "Account key",
        "user agent": "Sample-Agent",
        "service type": "Azure Files",
        "azure AD user": "N/A (Azure AD user authentication was not used)",
        "api type": "Files REST",
        "additional Information": "Sample-Additional-Information",
        "request status": "Success",
        "activity type": "ListFiles",
        "file share": "Sample-fileShare",
        "access key used": "key2",
        "killChainIntent": "Collection"
      },
      "entities": [
        {
          "$id": "centralus_191",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_192",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington",
            "longitude": -78.17197,
            "latitude": 38.73078,
            "asn": 8075
          },
          "type": "ip"
        },
        {
          "$id": "centralus_193",
          "sourceAddress": {
            "$ref": "centralus_192"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774308188817_0b30cc11-b413-4d07-b447-8219ee61426a/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774328188817_0416f431-c3a9-4560-b127-06156a84c5ab",
    "name": "2517396774328188817_0416f431-c3a9-4560-b127-06156a84c5ab",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:25.0298241Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.196663Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "Storage Accounts",
      "alertType": "SIMULATED_Storage.Files_DataExfiltration.NumberOfFilesAnomaly",
      "startTimeUtc": "2022-09-08T07:49:27.1811182Z",
      "endTimeUtc": "2022-09-08T07:49:27.1811182Z",
      "severity": "High",
      "isIncident": false,
      "systemAlertId": "2517396774328188817_0416f431-c3a9-4560-b127-06156a84c5ab",
      "intent": "Exfiltration",
      "resourceIdentifiers": [
        {
          "$id": "centralus_194",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-Storage",
      "alertDisplayName": "[SAMPLE ALERT] Unusual number of files extracted from a storage file share",
      "description": "THIS IS A SAMPLE ALERT: Someone has extracted an unusual number of files from your Azure storage account 'Sample-Storage'.",
      "remediationSteps": [
        "• Limit access to your storage account, following the 'least privilege' principle: https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-privileged-access#pa-7-follow-just-enough-administration-least-privilege-principle.",
        "• Consider using identity-based authentication: https://docs.microsoft.com/en-us/azure/storage/files/storage-files-identity-auth-active-directory-domain-service-enable.",
        "• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.",
        "• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email."
      ],
      "extendedProperties": {
        "resourceType": "Storage",
        "potential causes": "This alert indicates that an unusually large number of files has been extracted compared to recent activity on this Storage file share.\r\nPotential causes:\r\n• An attacker has extracted a large number of files from a Storage file share (for example: data exfiltration/breach, unauthorized transfer of data).\r\n• A legitimate user or application has extracted an unusual number of files from a Storage file share (for example: maintenance activity).",
        "investigation steps": "{\"displayValue\":\"View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information\",\"kind\":\"Link\",\"value\":\"https:\\/\\/go.microsoft.com\\/fwlink\\/?linkid=2075734\"}",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "client location": "Sample-Location",
        "authentication type": "Shared access signature (SAS)",
        "user agent": "Sample-Agent",
        "service type": "Azure Files",
        "azure AD user": "N/A (Azure AD user authentication was not used)",
        "operations types": "GetFile",
        "api type": "Files REST",
        "size of extracted data": "5 MB",
        "file share": "Sample-fileShare",
        "extracted files": "150",
        "killChainIntent": "Exfiltration"
      },
      "entities": [
        {
          "$id": "centralus_195",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_196",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington",
            "longitude": -78.17197,
            "latitude": 38.73078,
            "asn": 8075
          },
          "type": "ip"
        },
        {
          "$id": "centralus_197",
          "sourceAddress": {
            "$ref": "centralus_196"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774328188817_0416f431-c3a9-4560-b127-06156a84c5ab/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774348188817_67ff3c94-385c-4f9e-a6ce-6afffb1a900f",
    "name": "2517396774348188817_67ff3c94-385c-4f9e-a6ce-6afffb1a900f",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:25.1410065Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.196663Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "Storage Accounts",
      "alertType": "SIMULATED_Storage.Files_DataExfiltration.AmountOfDataAnomaly",
      "startTimeUtc": "2022-09-08T07:49:25.1811182Z",
      "endTimeUtc": "2022-09-08T07:49:25.1811182Z",
      "severity": "High",
      "isIncident": false,
      "systemAlertId": "2517396774348188817_67ff3c94-385c-4f9e-a6ce-6afffb1a900f",
      "intent": "Exfiltration",
      "resourceIdentifiers": [
        {
          "$id": "centralus_198",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-Storage",
      "alertDisplayName": "[SAMPLE ALERT] Unusual amount of data extracted from a storage file share",
      "description": "THIS IS A SAMPLE ALERT: Someone has extracted an unusual amount of data from your Azure storage account 'Sample-Storage'.",
      "remediationSteps": [
        "• Limit access to your storage account, following the 'least privilege' principle: https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-privileged-access#pa-7-follow-just-enough-administration-least-privilege-principle.",
        "• Consider using identity-based authentication: https://docs.microsoft.com/en-us/azure/storage/files/storage-files-identity-auth-active-directory-domain-service-enable.",
        "• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.",
        "• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email."
      ],
      "extendedProperties": {
        "resourceType": "Storage",
        "potential causes": "This alert indicates that an unusually large amount of data has been extracted compared to recent activity on this Storage file share.\r\nPotential causes:\r\n• An attacker has extracted a large amount of data from a Storage file share (for example: data exfiltration/breach, unauthorized transfer of data).\r\n• A legitimate user or application has extracted an unusual amount of data from a Storage file share (for example: maintenance activity).",
        "investigation steps": "{\"displayValue\":\"View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information\",\"kind\":\"Link\",\"value\":\"https:\\/\\/go.microsoft.com\\/fwlink\\/?linkid=2075734\"}",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "client location": "Sample-Location",
        "authentication type": "Shared access signature (SAS)",
        "user agent": "Sample-Agent",
        "service type": "Azure Files",
        "azure AD user": "N/A (Azure AD user authentication was not used)",
        "operations types": "GetFile",
        "api type": "Files REST",
        "size of extracted data": "150 MB",
        "file share": "Sample-fileShare",
        "extracted files": "5",
        "killChainIntent": "Exfiltration"
      },
      "entities": [
        {
          "$id": "centralus_199",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_200",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington",
            "longitude": -78.17197,
            "latitude": 38.73078,
            "asn": 8075
          },
          "type": "ip"
        },
        {
          "$id": "centralus_201",
          "sourceAddress": {
            "$ref": "centralus_200"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774348188817_67ff3c94-385c-4f9e-a6ce-6afffb1a900f/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774368188817_ba1e60c8-a4b9-4885-b570-4af4d1b0905e",
    "name": "2517396774368188817_ba1e60c8-a4b9-4885-b570-4af4d1b0905e",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:24.9567127Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.196663Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "Storage Accounts",
      "alertType": "SIMULATED_Storage.Files_ApplicationAnomaly",
      "startTimeUtc": "2022-09-08T07:49:23.1811182Z",
      "endTimeUtc": "2022-09-08T07:49:23.1811182Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396774368188817_ba1e60c8-a4b9-4885-b570-4af4d1b0905e",
      "intent": "InitialAccess",
      "resourceIdentifiers": [
        {
          "$id": "centralus_202",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-Storage",
      "alertDisplayName": "[SAMPLE ALERT] Unusual application accessed a storage file share",
      "description": "THIS IS A SAMPLE ALERT: Someone has accessed your Azure storage account 'Sample-Storage' using an unexpected application.",
      "remediationSteps": [
        "• Limit access to your storage account, following the 'least privilege' principle:  https://docs.microsoft.com/en-us/azure/storage/common/storage-sas-overview?toc=/azure/storage/files/toc.json.",
        "• Consider using identity-based authentication: https://docs.microsoft.com/en-us/azure/storage/files/storage-files-identity-auth-active-directory-domain-service-enable.",
        "• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.",
        "• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email."
      ],
      "extendedProperties": {
        "resourceType": "Storage",
        "potential causes": "This alert indicates that an unusual application has accessed this storage account.\r\nPotential causes:\r\n• An attacker has accessed your storage account using a new application.\r\n• A legitimate user has used a new application/browser to access your storage account.",
        "investigation steps": "• Confirm whether the storage account access was expected, based on information provided above such as IP address, location and user agent used.\r\n• View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information: https://go.microsoft.com/fwlink/?linkid=2075734",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "client location": "Sample-Location",
        "authentication type": "Account key",
        "user agent": "Sample-Agent",
        "service type": "Azure Files",
        "azure AD user": "N/A (Azure AD user authentication was not used)",
        "api type": "Files REST",
        "additional Information": "Sample-Additional-Information",
        "request status": "Success",
        "activity type": "CreateFile",
        "file share": "Sample-fileShare",
        "access key used": "key2",
        "killChainIntent": "InitialAccess"
      },
      "entities": [
        {
          "$id": "centralus_203",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_204",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington",
            "longitude": -78.17197,
            "latitude": 38.73078,
            "asn": 8075
          },
          "type": "ip"
        },
        {
          "$id": "centralus_205",
          "sourceAddress": {
            "$ref": "centralus_204"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774368188817_ba1e60c8-a4b9-4885-b570-4af4d1b0905e/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774388188817_0e11a998-500e-4610-8d94-ee7dd326fa24",
    "name": "2517396774388188817_0e11a998-500e-4610-8d94-ee7dd326fa24",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:24.929092Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.196663Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "Storage Accounts",
      "alertType": "SIMULATED_Storage.Files_AccessInspectionAnomaly",
      "startTimeUtc": "2022-09-08T07:49:21.1811182Z",
      "endTimeUtc": "2022-09-08T07:49:21.1811182Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396774388188817_0e11a998-500e-4610-8d94-ee7dd326fa24",
      "intent": "Collection",
      "resourceIdentifiers": [
        {
          "$id": "centralus_206",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-Storage",
      "alertDisplayName": "[SAMPLE ALERT] Unusual access inspection in a storage file share",
      "description": "THIS IS A SAMPLE ALERT: Someone has performed an unusual access inspection in your Azure storage account 'Sample-Storage'.",
      "remediationSteps": [
        "• Limit access to your storage account, following the 'least privilege' principle:  https://docs.microsoft.com/en-us/azure/storage/common/storage-sas-overview?toc=/azure/storage/files/toc.json.",
        "• Consider using identity-based authentication: https://docs.microsoft.com/en-us/azure/storage/files/storage-files-identity-auth-active-directory-domain-service-enable.",
        "• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.",
        "• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email."
      ],
      "extendedProperties": {
        "resourceType": "Storage",
        "potential causes": "This alert indicates that the access permissions of a storage account have been inspected in an unusual way, compared to recent activity on this account.\r\nPotential causes:\r\n• An attacker has performed reconnaissance for a future attack.\r\n• A legitimate user has performed maintenance on the storage account.",
        "investigation steps": "• Confirm whether the access policy inspection was performed for a legitimate purpose: https://docs.microsoft.com/en-us/rest/api/storageservices/define-stored-access-policy.\r\n• Review the file share's access permissions to make sure they are expected. The permissions can be viewed and updated through the Azure Portal or Azure Storage Explorer.\r\n• View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information: https://go.microsoft.com/fwlink/?linkid=2075734",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "client location": "Sample-Location",
        "authentication type": "Shared access signature (SAS)",
        "user agent": "Sample-Agent",
        "service type": "Azure Files",
        "azure AD user": "N/A (Azure AD user authentication was not used)",
        "api type": "Files REST",
        "additional Information": "Sample-Additional-Information",
        "access key used to generate SAS token": "key1",
        "request status": "Success",
        "activity type": "GetShareAcl",
        "file share": "Sample-fileShare",
        "killChainIntent": "Collection"
      },
      "entities": [
        {
          "$id": "centralus_207",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_208",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington",
            "longitude": -78.17197,
            "latitude": 38.73078,
            "asn": 8075
          },
          "type": "ip"
        },
        {
          "$id": "centralus_209",
          "sourceAddress": {
            "$ref": "centralus_208"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774388188817_0e11a998-500e-4610-8d94-ee7dd326fa24/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774408188817_670bc8f8-e273-492f-a5a9-626bb59fa359",
    "name": "2517396774408188817_670bc8f8-e273-492f-a5a9-626bb59fa359",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:24.8884461Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.196663Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "Storage Accounts",
      "alertType": "SIMULATED_Storage.Blob_TorAnomaly",
      "startTimeUtc": "2022-09-08T07:49:19.1811182Z",
      "endTimeUtc": "2022-09-08T07:49:19.1811182Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396774408188817_670bc8f8-e273-492f-a5a9-626bb59fa359",
      "intent": "PreAttack",
      "resourceIdentifiers": [
        {
          "$id": "centralus_210",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-Storage",
      "alertDisplayName": "[SAMPLE ALERT] Access from a Tor exit node to a storage blob container",
      "description": "THIS IS A SAMPLE ALERT: An IP that is a known Tor exit node accessed Storage container 'Sample-Container' in storage account 'Sample-Storage'.  This alert was triggered by an ADLS Gen2 transaction.",
      "remediationSteps": [
        "• Revoke all credentials that may be compromised and ensure that they're only shared with authorized users.",
        "• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email."
      ],
      "extendedProperties": {
        "resourceType": "Storage",
        "potential causes": "This alert indicates that this account has been accessed successfully from an IP address that is known as an active exit node of Tor (an anonymizing proxy). The severity of this alert takes into account the authentication type used (if any), and whether this is the first case of such access.\r\nPotential causes:\r\n• An attacker has accessed the storage account using Tor and is trying to hide their identity (true positive).\r\n• A legitimate user has accessed the storage account using Tor, perhaps for penetration testing (benign positive).",
        "investigation steps": "• Check if this actor is legitimate. Examine the authentication method and credentials used, as well as the actor's history of actions on this storage account and other resources in this subscription.\r\n• Limit access to your storage account, following the 'least privilege' principle: https://go.microsoft.com/fwlink/?linkid=2075737.",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "client location": "Sample-Location",
        "authentication type": "Shared access signature (SAS)",
        "user agent": "Sample-Agent",
        "service type": "Azure Blobs",
        "azure AD user": "N/A (Azure AD user authentication was not used)",
        "operations types": "CreatePathDir",
        "api type": "ADLS Gen2",
        "size of extracted data": "0 Bytes",
        "container": "Sample-Container",
        "killChainIntent": "PreAttack"
      },
      "entities": [
        {
          "$id": "centralus_211",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_212",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington",
            "longitude": -78.17197,
            "latitude": 38.73078,
            "asn": 8075
          },
          "type": "ip"
        },
        {
          "$id": "centralus_213",
          "sourceAddress": {
            "$ref": "centralus_212"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        },
        {
          "$id": "centralus_214",
          "name": "Sample-Name",
          "storageResource": {
            "$ref": "centralus_211"
          },
          "type": "blob-container"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774408188817_670bc8f8-e273-492f-a5a9-626bb59fa359/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774428188817_107a8d72-8db2-40cc-96e8-100adc065482",
    "name": "2517396774428188817_107a8d72-8db2-40cc-96e8-100adc065482",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:24.8220963Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.196663Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "Storage Accounts",
      "alertType": "SIMULATED_Storage.Blob_SuspiciousIp",
      "startTimeUtc": "2022-09-08T07:49:17.1811182Z",
      "endTimeUtc": "2022-09-08T07:49:17.1811182Z",
      "severity": "Low",
      "isIncident": false,
      "systemAlertId": "2517396774428188817_107a8d72-8db2-40cc-96e8-100adc065482",
      "intent": "PreAttack",
      "resourceIdentifiers": [
        {
          "$id": "centralus_215",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-Storage",
      "alertDisplayName": "[SAMPLE ALERT] Access from a suspicious IP to a storage blob container",
      "description": "THIS IS A SAMPLE ALERT: Someone has accessed your Azure storage account 'Sample-Storage' from a suspicious IP address.",
      "remediationSteps": [
        "• Limit access to your storage account, following the 'least privilege' principle: https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-privileged-access#pa-7-follow-just-enough-administration-least-privilege-principle.",
        "• Consider using identity-based authentication: https://docs.microsoft.com/en-us/azure/storage/blobs/authorize-access-azure-active-directory.",
        "• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.",
        "• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email."
      ],
      "extendedProperties": {
        "resourceType": "Storage",
        "potential causes": "This alert indicates that this account has been accessed successfully from an IP address that is considered suspicious.\r\nPotential causes:\r\n• An attacker has accessed your storage account from a potentially suspicious IP.\r\n• A legitimate user has accessed your storage account from a potentially suspicious IP.",
        "investigation steps": "{\"displayValue\":\"View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information\",\"kind\":\"Link\",\"value\":\"https:\\/\\/go.microsoft.com\\/fwlink\\/?linkid=2075734\"}",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "client location": "Sample-Location",
        "authentication type": "Shared access signature (SAS)",
        "user agent": "Sample-Agent",
        "service type": "Azure Blobs",
        "azure AD user": "N/A (Azure AD user authentication was not used)",
        "operations types": "GetBlob",
        "api type": "Blob",
        "size of extracted data": "335.88 KB",
        "container": "Sample-Container",
        "killChainIntent": "PreAttack"
      },
      "entities": [
        {
          "$id": "centralus_216",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_217",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington",
            "longitude": -78.17197,
            "latitude": 38.73078,
            "asn": 8075
          },
          "threatIntelligence": [
            {
              "providerName": "AlertSimulator",
              "threatType": "Sample-Type",
              "threatName": "Sample-Threat",
              "confidence": 1,
              "threatDescription": ""
            }
          ],
          "type": "ip"
        },
        {
          "$id": "centralus_218",
          "sourceAddress": {
            "$ref": "centralus_217"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774428188817_107a8d72-8db2-40cc-96e8-100adc065482/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774448188817_d323f4a4-2224-4faf-99b0-d82467b66b09",
    "name": "2517396774448188817_d323f4a4-2224-4faf-99b0-d82467b66b09",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:24.8665859Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.196663Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "Storage Accounts",
      "alertType": "SIMULATED_Storage.Blob_SuspiciousApplication",
      "startTimeUtc": "2022-09-08T07:49:15.1811182Z",
      "endTimeUtc": "2022-09-08T07:49:15.1811182Z",
      "severity": "High",
      "isIncident": false,
      "systemAlertId": "2517396774448188817_d323f4a4-2224-4faf-99b0-d82467b66b09",
      "intent": "InitialAccess",
      "resourceIdentifiers": [
        {
          "$id": "centralus_219",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-Storage",
      "alertDisplayName": "[SAMPLE ALERT] PREVIEW - Access from a suspicious application ",
      "description": "THIS IS A SAMPLE ALERT: There was a failed attempt to anonymously access the blob container `Sample-Container` in your storage account `Sample-Storage`. This might indicate that an attacker is trying to exploit a vulnerability or access data in your storage account, or it could be the result of a penetration test carried out in your organization. The suspicious application detected was `eicarDummyApp`. For more details, please see the user-agent string in the alert fields. In many cases, attackers might successfully access data after a series of failed attempts. It’s therefore important to act on this alert.",
      "remediationSteps": [
        "• Limit access to your storage account, following the 'least privilege' principle: https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-privileged-access#pa-7-follow-just-enough-administration-least-privilege-principle.",
        "• Consider using identity-based authentication: https://docs.microsoft.com/en-us/azure/storage/blobs/authorize-access-azure-active-directory.",
        "• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.",
        "• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email."
      ],
      "extendedProperties": {
        "resourceType": "Storage",
        "potential causes": "",
        "investigation steps": "{\"displayValue\":\"View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information\",\"kind\":\"Link\",\"value\":\"https:\\/\\/go.microsoft.com\\/fwlink\\/?linkid=2075734\"}",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "client location": "Sample-Location",
        "authentication type": "Anonymous",
        "user agent": "Sample-Agent",
        "service type": "Azure Blobs",
        "azure AD user": "N/A (Azure AD user authentication was not used)",
        "operations types": "GetBlob",
        "api type": "Blob",
        "size of extracted data": "140 MB",
        "container": "Sample-Container",
        "application name ": "eicarDummyApp",
        "killChainIntent": "InitialAccess"
      },
      "entities": [
        {
          "$id": "centralus_220",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_221",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington",
            "longitude": -78.17197,
            "latitude": 38.73078,
            "asn": 8075
          },
          "type": "ip"
        },
        {
          "$id": "centralus_222",
          "sourceAddress": {
            "$ref": "centralus_221"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        },
        {
          "$id": "centralus_223",
          "name": "Sample-Name",
          "storageResource": {
            "$ref": "centralus_220"
          },
          "type": "blob-container"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774448188817_d323f4a4-2224-4faf-99b0-d82467b66b09/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774468188817_51c38ccd-b6b4-4658-b2b8-672876544f0f",
    "name": "2517396774468188817_51c38ccd-b6b4-4658-b2b8-672876544f0f",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:24.7572068Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.196663Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "Storage Accounts",
      "alertType": "SIMULATED_Storage.Blob_PhishingContent",
      "startTimeUtc": "2022-09-08T07:49:13.1811182Z",
      "endTimeUtc": "2022-09-08T07:49:13.1811182Z",
      "severity": "High",
      "isIncident": false,
      "systemAlertId": "2517396774468188817_51c38ccd-b6b4-4658-b2b8-672876544f0f",
      "intent": "Collection",
      "resourceIdentifiers": [
        {
          "$id": "centralus_224",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-Storage",
      "alertDisplayName": "[SAMPLE ALERT] PREVIEW - Phishing content hosted on a storage account",
      "description": "THIS IS A SAMPLE ALERT: A URL used in a phishing attack points to your Azure Storage account. This URL was part of a phishing attack affecting users of Microsoft 365. Typically, content hosted on such pages is designed to trick visitors into entering their corporate credentials or financial information into a web form that looks legitimate.",
      "remediationSteps": [
        "• Review the content of the Azure Storage account to identify and remove phishing content. The URL in the alert may indicate a starting point for your investigation.",
        "• If you suspect that your Storage credentials have been compromised, revoke all storage access tokens that may have been compromised and implement the following security best practices:",
        " 2.1.\\tEnsure that your access tokens are only shared with authorized users.",
        "2.2. Limit access to your Storage account, following the 'least privilege' principle. (https://aka.ms/StorageAccountSecureAccess)",
        "2.3. Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email.",
        "• Disallow anonymous public access to blobs in your Storage account, unless required for your scenario. (https://aka.ms/StorageAccountPublicAccess)"
      ],
      "extendedProperties": {
        "resourceType": "Storage",
        "url": "fake/Sample/Sample.txt",
        "killChainIntent": "Collection"
      },
      "entities": [
        {
          "$id": "centralus_225",
          "url": "fake/Sample/Sample.txt",
          "type": "url"
        },
        {
          "$id": "centralus_226",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "azure-resource"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774468188817_51c38ccd-b6b4-4658-b2b8-672876544f0f/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774488188817_bb79e889-bce1-451a-80e4-9b84788386fc",
    "name": "2517396774488188817_bb79e889-bce1-451a-80e4-9b84788386fc",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:24.7934507Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.196663Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "Storage Accounts",
      "alertType": "SIMULATED_Storage.Blob_PermissionsChangeAnomaly",
      "startTimeUtc": "2022-09-08T07:49:11.1811182Z",
      "endTimeUtc": "2022-09-08T07:49:11.1811182Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396774488188817_bb79e889-bce1-451a-80e4-9b84788386fc",
      "intent": "Persistence",
      "resourceIdentifiers": [
        {
          "$id": "centralus_227",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-Storage",
      "alertDisplayName": "[SAMPLE ALERT] Unusual change of access permissions in a storage blob container",
      "description": "THIS IS A SAMPLE ALERT: Someone has performed an unusual change of access permissions of a directory or a file in your Azure storage account 'Sample-Storage'. This alert was triggered by an ADLS Gen2 transaction.",
      "remediationSteps": [
        "• Limit access to your storage account, following the 'least privilege' principle: https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-privileged-access#pa-7-follow-just-enough-administration-least-privilege-principle.",
        "• Use Azure AD security groups: https://docs.microsoft.com/en-us/azure/storage/blobs/data-lake-storage-access-control#what-is-the-best-way-to-apply-acls.",
        "• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.",
        "• Ensure that storage directory or file permissions are configured correctly.",
        "• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email."
      ],
      "extendedProperties": {
        "resourceType": "Storage",
        "potential causes": "This alert indicates that the access permissions of this directory or file have been changed in an unusual way.\r\nPotential causes:\r\n• An attacker has changed directory or file permissions to weaken its security.\r\n• A legitimate user has changed directory or file permissions.",
        "investigation steps": "• Confirm whether the directory or file permissions change was performed for a legitimate purpose: https://docs.microsoft.com/en-us/azure/storage/blobs/data-lake-storage-access-control#access-control-lists-on-files-and-directories.\r\n• Review the directory's or file's access permissions to make sure they are expected.\r\n• View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information: https://go.microsoft.com/fwlink/?linkid=2075734",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "client location": "Sample-Location",
        "authentication type": "Shared access signature (SAS)",
        "user agent": "Sample-Agent",
        "service type": "Azure Blobs",
        "azure AD user": "N/A (Azure AD user authentication was not used)",
        "api type": "ADLS Gen2",
        "additional Information": "Sample-Additional-Information",
        "access key used to generate SAS token": "key1",
        "container": "Sample-Container",
        "request status": "Success",
        "activity type": "SetPathAccessControl",
        "storage file path(s) accessed": "",
        "killChainIntent": "Persistence"
      },
      "entities": [
        {
          "$id": "centralus_228",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_229",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington",
            "longitude": -78.17197,
            "latitude": 38.73078,
            "asn": 8075
          },
          "type": "ip"
        },
        {
          "$id": "centralus_230",
          "sourceAddress": {
            "$ref": "centralus_229"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774488188817_bb79e889-bce1-451a-80e4-9b84788386fc/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774508188817_1c266ebf-3f0f-4829-ba78-40150ddf237b",
    "name": "2517396774508188817_1c266ebf-3f0f-4829-ba78-40150ddf237b",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:24.7785154Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.196663Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "Storage Accounts",
      "alertType": "SIMULATED_Storage.Blob_OpenContainersScanning.SuccessfulDiscovery",
      "startTimeUtc": "2022-09-08T07:49:09.1811182Z",
      "endTimeUtc": "2022-09-08T07:49:09.1811182Z",
      "severity": "High",
      "isIncident": false,
      "systemAlertId": "2517396774508188817_1c266ebf-3f0f-4829-ba78-40150ddf237b",
      "intent": "Collection",
      "resourceIdentifiers": [
        {
          "$id": "centralus_231",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-Storage",
      "alertDisplayName": "[SAMPLE ALERT] Publicly accessible storage containers successfully discovered",
      "description": "THIS IS A SAMPLE ALERT: A successful discovery of 3 publicly open storage containers in storage account 'Sample-Storage' was performed in the last hour by a scanning script or tool.\r\n\r\nScanned containers include: static, images, backups.\r\n\r\nThis usually indicates a reconnaissance attack, where the threat actor tries to list blobs by guessing container names, in the hope of finding misconfigured open storagecontainers with sensitive data in them.\r\nThe threat actor may use their own script or use known scanning tools like Microburst to scan for publicly open containers.\r\n\r\nAfter a threat actor successfully discovers a container, they usually continue by reading and exfiltrating the data.",
      "remediationSteps": [
        "• Where applicable, we recommend to configure authenticated access to blob containers using Azure AD roles or shared access signature tokens.",
        "• If you have a legitimate reason for these containers to remain publicly accessible, verify that they do not contain sensitive data. Additionally, ensure that users with write permissions are aware that the uploaded data will be publicly accessible.",
        "• When allowing anonymous access to containers, consider adding a random suffix to its name (or use a randomly generated name) to limit these types of scans in the future. For example, use 'salesshare-4536-7836-8967'.",
        "• If this is a recurring alert from the same IP, consider blocking the source IP address (see how to block an IP address: https://go.microsoft.com/fwlink/?linkid=2179709).",
        "This can be done at the storage account level using the 'networking' configuration or at the subscription level using the networking 'access restrictions' configuration."
      ],
      "extendedProperties": {
        "resourceType": "Storage",
        "potential causes": "• Reconnaisance attack (True Positive)\r\n• Penetration testing\r\n• A bug in an application is causing it to perform serial attempts to read different blobs (False Positive).",
        "investigation steps": "• Check this account for publicly open containers with sensitive data. If such containers exist, immediately change their access policy to private (see how to change your access policy: https://go.microsoft.com/fwlink/?linkid=2179708).\r\n\r\nLook at diagnostic logs to see all sensitive data that may have leaked, and escalate the alert and information.\r\n• To list all containers that are publicly accessible in a storage account, use the PowerShell script in this link: https://go.microsoft.com/fwlink/?linkid=2180103.\r\n\r\n• Check whether the user that performed this scan is legitimate. Look at IP, location, user agent, and their history.\r\n• This alert may be triggered by a coding issue in the application accessing the storage container. If you've validated that the actor is legitimate, identified the coding issue, and ruled out a possible leak of sensitive content, this alert can be considered benign.",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "client location": "Sample-Location",
        "authentication type": "Anonymous",
        "user agent": "Sample-Agent",
        "service type": "Azure Blobs",
        "azure AD user": "N/A (Azure AD user authentication was not used)",
        "operations types": "GetBlob",
        "api type": "Blob",
        "size of extracted data": "140 MB",
        "among the enumeration terms used": "erp, exe, export, exports, file, files, firmware, git, img, iso, jenkins, logs, media, mobile, photos, pics, private, prod, production, products, projects, public, release, repo, reports, resources, script, scripts, services, snapshots, source, src, staging, stats, storage, tenant, tmp, upload, uploads, user, userdata, users, usr, vhd, vhdx, video, videos, web, www, xslx",
        "number of failed access attempts": "1232",
        "number of containers successfully accessed": "3",
        "list of containers successfully accessed": "Sample-1, Sample-2, Sample-3",
        "killChainIntent": "Collection"
      },
      "entities": [
        {
          "$id": "centralus_232",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_233",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington",
            "longitude": -78.17197,
            "latitude": 38.73078,
            "asn": 8075
          },
          "type": "ip"
        },
        {
          "$id": "centralus_234",
          "sourceAddress": {
            "$ref": "centralus_233"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        },
        {
          "$id": "centralus_235",
          "name": "Sample-Name",
          "storageResource": {
            "$ref": "centralus_232"
          },
          "type": "blob-container"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774508188817_1c266ebf-3f0f-4829-ba78-40150ddf237b/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774528188817_c66f7b04-0cd2-4db2-bb8d-bb44b9e1ed0f",
    "name": "2517396774528188817_c66f7b04-0cd2-4db2-bb8d-bb44b9e1ed0f",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:24.7258766Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.196663Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "Storage Accounts",
      "alertType": "SIMULATED_Storage.Blob_OpenContainersScanning.FailedAttempt",
      "startTimeUtc": "2022-09-08T07:49:07.1811182Z",
      "endTimeUtc": "2022-09-08T07:49:07.1811182Z",
      "severity": "High",
      "isIncident": false,
      "systemAlertId": "2517396774528188817_c66f7b04-0cd2-4db2-bb8d-bb44b9e1ed0f",
      "intent": "Collection",
      "resourceIdentifiers": [
        {
          "$id": "centralus_236",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-Storage",
      "alertDisplayName": "[SAMPLE ALERT] Publicly accessible storage containers unsuccessfully scanned",
      "description": "THIS IS A SAMPLE ALERT: 1232 failed attempts to scan for publicly open storage containers in storage account 'Sample-Storage' were performed in the last hour.\r\n\r\nScanned containers include: erp, exe, export, exports, file.\r\n\r\nThis usually indicates a reconnaissance attack, where the threat actor tries to list blobs by guessing container names, in the hope of finding misconfigured open storage containers with sensitive data in them.\r\nThe threat actor may use their own script or use known scanning tools like Microburst to scan for publicly open containers.",
      "remediationSteps": [
        "• Where applicable, we recommend to configure authenticated access to blob containers using Azure AD roles or shared access signature tokens.",
        "• If you have a legitimate reason for these containers to remain publicly accessible, verify that they do not contain sensitive data. Additionally, ensure that users with write permissions are aware that the uploaded data will be publicly accessible.",
        "• When allowing anonymous access to containers, consider adding a random suffix to its name (or use a randomly generated name) to limit these types of scans in the future. For example, use 'salesshare-4536-7836-8967'.",
        "• If this is a recurring alert from the same IP, consider blocking the source IP address (see how to block an IP address: https://go.microsoft.com/fwlink/?linkid=2179709).",
        "This can be done at the storage account level using the 'networking' configuration or at the subscription level using the networking 'access restrictions' configuration."
      ],
      "extendedProperties": {
        "resourceType": "Storage",
        "potential causes": "• Reconnaisance attack (True Positive)\r\n• Penetration testing\r\n• A bug in an application is causing it to perform serial attempts to read different blobs (False Positive).",
        "investigation steps": "• Check this account for publicly open containers with sensitive data. If such containers exist, immediately change their access policy to private (see how to change your access policy: https://go.microsoft.com/fwlink/?linkid=2179708).\r\n\r\nThis is necessary despite the fact that the observed attempts failed, because reconnaissance has taken place and there might have been some successful activity.\r\n• To list all containers that are publicly accessible in a storage account, use the PowerShell script in this link: https://go.microsoft.com/fwlink/?linkid=2180103.\r\n\r\n• Check whether the user that performed the scanning is legitimate. Look at IP, location, user agent, and their history. Scanning operations read blob URIs and/or use \"list blobs\".\r\n• Check whether data was exfiltrated from containers in this storage account and/or by this actor.\r\n• This alert may be triggered by a coding issue in the application accessing the storage container. If you've validated that the actor is legitimate, identified the coding issue, and ruled out a possible leak of sensitive content, this alert can be considered benign.",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "client location": "Sample-Location",
        "authentication type": "Anonymous",
        "user agent": "Sample-Agent",
        "service type": "Azure Blobs",
        "azure AD user": "N/A (Azure AD user authentication was not used)",
        "operations types": "GetBlob",
        "api type": "Blob",
        "among the enumeration terms used": "erp, exe, export, exports, file, files, firmware, git, img, iso, jenkins, logs, media, mobile, photos, pics, private, prod, production, products, projects, public, release, repo, reports, resources, script, scripts, services, snapshots, source, src, staging, stats, storage, tenant, tmp, upload, uploads, user, userdata, users, usr, vhd, vhdx, video, videos, web, www, xslx",
        "number of failed access attempts": "1232",
        "killChainIntent": "Collection"
      },
      "entities": [
        {
          "$id": "centralus_237",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_238",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington",
            "longitude": -78.17197,
            "latitude": 38.73078,
            "asn": 8075
          },
          "type": "ip"
        },
        {
          "$id": "centralus_239",
          "sourceAddress": {
            "$ref": "centralus_238"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774528188817_c66f7b04-0cd2-4db2-bb8d-bb44b9e1ed0f/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774548188817_c62353b4-030f-448e-b7ac-9c27ccc4e475",
    "name": "2517396774548188817_c62353b4-030f-448e-b7ac-9c27ccc4e475",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:24.6313559Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.196663Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "",
      "alertType": "SIMULATED_Storage.Blob_OpenACL",
      "startTimeUtc": "2022-09-08T07:49:05.1811182Z",
      "endTimeUtc": "2022-09-08T07:49:05.1811182Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396774548188817_c62353b4-030f-448e-b7ac-9c27ccc4e475",
      "intent": "Collection",
      "resourceIdentifiers": [
        {
          "$id": "centralus_240",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-Storage",
      "alertDisplayName": "[SAMPLE ALERT] Storage account with potentially sensitive data has been detected with a publicly exposed container",
      "description": "THIS IS A SAMPLE ALERT: The access policy of a container in your storage account was modified to allow anonymous access. This might lead to a data breach if the container holds any sensitive data. This alert is based on analysis of Azure activity log.",
      "remediationSteps": [
        "• Check the access level of the container listed in the alert details. If the access level is set to 'anonymous' and this behavior is not intended, change the access level to 'private' and escalate the alert to your information security team.",
        "• Where possible, we recommend using shared access signature tokens instead of granting public access to storage containers and blobs."
      ],
      "extendedProperties": {
        "resourceType": "Storage",
        "container name": "Sample-Container",
        "sensitive name": "Sample-Container",
        "killChainIntent": "Collection"
      },
      "entities": [
        {
          "$id": "centralus_241",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "azure-resource"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774548188817_c62353b4-030f-448e-b7ac-9c27ccc4e475/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774568188817_79179064-3950-438a-beba-d2031ded9751",
    "name": "2517396774568188817_79179064-3950-438a-beba-d2031ded9751",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:24.6228105Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.196663Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "Storage Accounts",
      "alertType": "SIMULATED_Storage.Blob_MalwareHashReputation",
      "startTimeUtc": "2022-09-08T07:49:03.1811182Z",
      "endTimeUtc": "2022-09-08T07:49:03.1811182Z",
      "severity": "High",
      "isIncident": false,
      "systemAlertId": "2517396774568188817_79179064-3950-438a-beba-d2031ded9751",
      "intent": "LateralMovement",
      "resourceIdentifiers": [
        {
          "$id": "centralus_242",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-Storage",
      "alertDisplayName": "[SAMPLE ALERT] Potential malware uploaded to a storage blob container",
      "description": "THIS IS A SAMPLE ALERT: Someone has uploaded potential malware to your Azure storage account 'Sample-Storage'.",
      "remediationSteps": [
        "• Remove the malicious blob from your storage account.",
        "• Limit access to your storage account, following the 'least privilege' principle: https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-privileged-access#pa-7-follow-just-enough-administration-least-privilege-principle.",
        "• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.",
        "• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email."
      ],
      "extendedProperties": {
        "resourceType": "Storage",
        "potential causes": "This alert indicates that a blob containing potential malware has been uploaded to your storage account.\r\nPotential causes:\r\n• An attacker has gained access to the storage account and has intentionally uploaded a malicious blob.\r\n• A legitimate user has unintentionally uploaded a malicious blob.\r\n• A legitimate user is performing tests on the system (e.g. penetration testing).",
        "investigation steps": "{\"displayValue\":\"View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information\",\"kind\":\"Link\",\"value\":\"https:\\/\\/go.microsoft.com\\/fwlink\\/?linkid=2075734\"}",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "client location": "Sample-Location",
        "authentication type": "Account key",
        "user agent": "Sample-Agent",
        "service type": "Azure Blobs",
        "azure AD user": "N/A (Azure AD user authentication was not used)",
        "operations types": "PutBlob",
        "api type": "Blob",
        "container": "Sample-Container",
        "malware description": "Indicator related to a known malware campaign",
        "detection source": "A Microsoft Partner",
        "blob": "Sample-Blob",
        "killChainIntent": "LateralMovement"
      },
      "entities": [
        {
          "$id": "centralus_243",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_244",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington",
            "longitude": -78.17197,
            "latitude": 38.73078,
            "asn": 8075
          },
          "type": "ip"
        },
        {
          "$id": "centralus_245",
          "algorithm": "MD5",
          "value": "Sample-SHA",
          "type": "filehash"
        },
        {
          "$id": "centralus_246",
          "sourceAddress": {
            "$ref": "centralus_244"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        },
        {
          "$id": "centralus_247",
          "directory": "Sample-fileShare/dummy/path/to",
          "name": "Sample-Name",
          "fileHashes": [
            {
              "$ref": "centralus_245"
            }
          ],
          "type": "file"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774568188817_79179064-3950-438a-beba-d2031ded9751/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774588188817_cbd4f6a9-8279-49f4-b6b5-36d7205a6a19",
    "name": "2517396774588188817_cbd4f6a9-8279-49f4-b6b5-36d7205a6a19",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:24.618486Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.196663Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "Storage Accounts",
      "alertType": "SIMULATED_Storage.Blob_GeoAnomaly",
      "startTimeUtc": "2022-09-08T07:49:01.1811182Z",
      "endTimeUtc": "2022-09-08T07:49:01.1811182Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396774588188817_cbd4f6a9-8279-49f4-b6b5-36d7205a6a19",
      "intent": "InitialAccess",
      "resourceIdentifiers": [
        {
          "$id": "centralus_248",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-Storage",
      "alertDisplayName": "[SAMPLE ALERT] Access from an unusual location to a storage blob container",
      "description": "THIS IS A SAMPLE ALERT: Someone has accessed your Azure storage account 'Sample-Storage' from an unusual location.",
      "remediationSteps": [
        "• Limit access to your storage account, following the 'least privilege' principle: https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-privileged-access#pa-7-follow-just-enough-administration-least-privilege-principle.",
        "• Consider using identity-based authentication: https://docs.microsoft.com/en-us/azure/storage/blobs/authorize-access-azure-active-directory.",
        "• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.",
        "• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email."
      ],
      "extendedProperties": {
        "resourceType": "Storage",
        "potential causes": "This alert indicates that this account has been accessed successfully from an IP address that is unfamiliar and unexpected compared to recent access pattern on this account.\r\nPotential causes:\r\n• An attacker has accessed your storage account.\r\n• A legitimate user has accessed your storage account from a new location.",
        "investigation steps": "{\"displayValue\":\"View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information\",\"kind\":\"Link\",\"value\":\"https:\\/\\/go.microsoft.com\\/fwlink\\/?linkid=2075734\"}",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "client location": "Sample-Location",
        "authentication type": "Azure AD",
        "user agent": "Sample-Agent",
        "service type": "Azure Blobs",
        "operations types": "GetContainerProperties",
        "api type": "Blob",
        "container": "Sample-Container",
        "azure AD application ID": "00000000-0000-0000-0000-000000000000",
        "killChainIntent": "InitialAccess"
      },
      "entities": [
        {
          "$id": "centralus_249",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_250",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington",
            "longitude": -78.17197,
            "latitude": 38.73078,
            "asn": 8075
          },
          "type": "ip"
        },
        {
          "$id": "centralus_251",
          "aadTenantId": "00000000-0000-0000-0000-000000000000",
          "objectGuid": "00000000-0000-0000-0000-000000000000",
          "isValid": false,
          "type": "account"
        },
        {
          "$id": "centralus_252",
          "sourceAddress": {
            "$ref": "centralus_250"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        },
        {
          "$id": "centralus_253",
          "name": "Sample-Name",
          "storageResource": {
            "$ref": "centralus_249"
          },
          "type": "blob-container"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774588188817_cbd4f6a9-8279-49f4-b6b5-36d7205a6a19/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774608188817_1e405b12-2570-4c32-9faf-3e2c20e81fe3",
    "name": "2517396774608188817_1e405b12-2570-4c32-9faf-3e2c20e81fe3",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:24.5245811Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.196663Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "Storage Accounts",
      "alertType": "SIMULATED_Storage.Blob_ExeUploadAnomaly",
      "startTimeUtc": "2022-09-08T07:48:59.1811182Z",
      "endTimeUtc": "2022-09-08T07:48:59.1811182Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396774608188817_1e405b12-2570-4c32-9faf-3e2c20e81fe3",
      "intent": "LateralMovement, Execution",
      "resourceIdentifiers": [
        {
          "$id": "centralus_254",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-Storage",
      "alertDisplayName": "[SAMPLE ALERT] Unusual upload of .exe to a storage blob container",
      "description": "THIS IS A SAMPLE ALERT: Someone has performed an unusual upload of an executable file to your Azure storage account 'Sample-Storage'. This alert was triggered by an ADLS Gen2 transaction.",
      "remediationSteps": [
        "• Delete the .exe from your storage account.",
        "• Limit access to your storage account, following the 'least privilege' principle: https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-privileged-access#pa-7-follow-just-enough-administration-least-privilege-principle.",
        "• Consider using identity-based authentication: https://docs.microsoft.com/en-us/azure/storage/blobs/authorize-access-azure-active-directory.",
        "• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.",
        "• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email."
      ],
      "extendedProperties": {
        "resourceType": "Storage",
        "potential causes": "This alert indicates that an executable (.exe file) has been uploaded to a storage account in an unusual way, compared to recent activity on this account.\r\nPotential causes:\r\n• An attacker has uploaded a malicious executable file to your storage account.\r\n• A legitimate user has uploaded an executable file.",
        "investigation steps": "• Determine who uploaded the latest version of the executable file.\r\n• View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information: https://go.microsoft.com/fwlink/?linkid=2075734",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "authentication type": "Azure AD",
        "client location": "Sample-Location",
        "user agent": "Sample-Agent",
        "service type": "Azure Blobs",
        "azure AD user": "eicar@microsoft.com",
        "additional Information": "Sample-Additional-Information",
        "api type": "ADLS Gen2",
        "request status": "Success",
        "activity type": "FlushFile",
        "azure AD application ID": "12345",
        "storage file path(s) uploaded": "Sample-Path1, Sample-Path2",
        "containers": "Sample-Container1, Sample-Container2",
        "killChainIntent": "LateralMovement, Execution"
      },
      "entities": [
        {
          "$id": "centralus_255",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_256",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington",
            "longitude": -78.17197,
            "latitude": 38.73078,
            "asn": 8075
          },
          "type": "ip"
        },
        {
          "$id": "centralus_257",
          "sourceAddress": {
            "$ref": "centralus_256"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774608188817_1e405b12-2570-4c32-9faf-3e2c20e81fe3/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774628188817_1e3f2318-9119-4b4d-8a90-9f3c0ec1148f",
    "name": "2517396774628188817_1e3f2318-9119-4b4d-8a90-9f3c0ec1148f",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:24.500905Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.196663Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "Storage Accounts",
      "alertType": "SIMULATED_Storage.Blob_DeletionAnomaly",
      "startTimeUtc": "2022-09-08T07:48:57.1811182Z",
      "endTimeUtc": "2022-09-08T07:48:57.1811182Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396774628188817_1e3f2318-9119-4b4d-8a90-9f3c0ec1148f",
      "intent": "Exfiltration",
      "resourceIdentifiers": [
        {
          "$id": "centralus_258",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-Storage",
      "alertDisplayName": "[SAMPLE ALERT] Unusual deletion in a storage blob container",
      "description": "THIS IS A SAMPLE ALERT: Someone has performed an unusual deletion in your Azure storage account 'Sample-Storage'. This alert was triggered by an ADLS Gen2 transaction.",
      "remediationSteps": [
        "• Limit access to your storage account, following the 'least privilege' principle: https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-privileged-access#pa-7-follow-just-enough-administration-least-privilege-principle.",
        "• Consider using identity-based authentication: https://docs.microsoft.com/en-us/azure/storage/blobs/authorize-access-azure-active-directory.",
        "• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.",
        "• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email.",
        "• Perform an undelete if the delete operation was a soft delete. See how to configure soft deletion and more information: https://go.microsoft.com/fwlink/?linkid=2078042"
      ],
      "extendedProperties": {
        "resourceType": "Storage",
        "potential causes": "This alert indicates that one or more unexpected delete operations has occurred in a storage account, compared to recent activity on this account.\r\nPotential causes:\r\n• An attacker has deleted data from your storage account.\r\n• A legitimate user has performed an unusual deletion.",
        "investigation steps": "• Confirm whether the data deletion was intended based on information provided above such as IP address, location and user agent used.\r\n• View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information: https://go.microsoft.com/fwlink/?linkid=2075734",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "authentication type": "Account key",
        "client location": "Sample-Location",
        "user agent": "Sample-Agent",
        "service type": "Azure Blobs",
        "azure AD user": "N/A (Azure AD user authentication was not used)",
        "additional Information": "Sample-Additional-Information",
        "api type": "ADLS Gen2",
        "request status": "Success",
        "activity type": "DeleteDirectory",
        "access key used": "key2",
        "storage file path(s) deleted": "Sample-File1, Sample-File2",
        "containers": "Sample-Container1, Sample-Container2",
        "killChainIntent": "Exfiltration"
      },
      "entities": [
        {
          "$id": "centralus_259",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_260",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington",
            "longitude": -78.17197,
            "latitude": 38.73078,
            "asn": 8075
          },
          "type": "ip"
        },
        {
          "$id": "centralus_261",
          "sourceAddress": {
            "$ref": "centralus_260"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774628188817_1e3f2318-9119-4b4d-8a90-9f3c0ec1148f/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774648188817_8f8bbeb1-dcbd-4774-90ca-84cd22433ec5",
    "name": "2517396774648188817_8f8bbeb1-dcbd-4774-90ca-84cd22433ec5",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:24.4603139Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.196663Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "Storage Accounts",
      "alertType": "SIMULATED_Storage.Blob_DataExplorationAnomaly",
      "startTimeUtc": "2022-09-08T07:48:55.1811182Z",
      "endTimeUtc": "2022-09-08T07:48:55.1811182Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396774648188817_8f8bbeb1-dcbd-4774-90ca-84cd22433ec5",
      "intent": "Collection",
      "resourceIdentifiers": [
        {
          "$id": "centralus_262",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-Storage",
      "alertDisplayName": "[SAMPLE ALERT] Unusual data exploration in a storage blob container",
      "description": "THIS IS A SAMPLE ALERT: Someone has performed an unusual data exploration operation in your Azure storage account 'Sample-Storage'.",
      "remediationSteps": [
        "• Limit access to your storage account, following the 'least privilege' principle: https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-privileged-access#pa-7-follow-just-enough-administration-least-privilege-principle.",
        " Consider using identity-based authentication: https://docs.microsoft.com/en-us/azure/storage/blobs/authorize-access-azure-active-directory.",
        "• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.",
        "• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email."
      ],
      "extendedProperties": {
        "resourceType": "Storage",
        "potential causes": "This alert indicates that blobs or containers in a storage account have been enumerated in an unusual way, compared to recent activity on this account.\r\nPotential causes:\r\n• An attacker has performed reconnaissance for a future attack.\r\n• A legitimate user or application logic has explored data within the storage account.",
        "investigation steps": "• Confirm whether the storage account access was expected, based on information provided above such as IP address, location and user agent used.\r\n• View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information: https://go.microsoft.com/fwlink/?linkid=2075734",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "client location": "Sample-Location",
        "authentication type": "Account key",
        "user agent": "Sample-Agent",
        "service type": "Azure Blobs",
        "azure AD user": "N/A (Azure AD user authentication was not used)",
        "api type": "Blob",
        "additional Information": "Sample-Additional-Information",
        "container": "Sample-Container",
        "request status": "Success",
        "activity type": "ListBlobs",
        "access key used": "key2",
        "killChainIntent": "Collection"
      },
      "entities": [
        {
          "$id": "centralus_263",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_264",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington",
            "longitude": -78.17197,
            "latitude": 38.73078,
            "asn": 8075
          },
          "type": "ip"
        },
        {
          "$id": "centralus_265",
          "sourceAddress": {
            "$ref": "centralus_264"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774648188817_8f8bbeb1-dcbd-4774-90ca-84cd22433ec5/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774668188817_10fc4326-040f-4196-9baa-1ddd473c1e2b",
    "name": "2517396774668188817_10fc4326-040f-4196-9baa-1ddd473c1e2b",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:24.5896745Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.196663Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "Storage Accounts",
      "alertType": "SIMULATED_Storage.Blob_DataExfiltration.NumberOfBlobsAnomaly",
      "startTimeUtc": "2022-09-08T07:48:53.1811182Z",
      "endTimeUtc": "2022-09-08T07:48:53.1811182Z",
      "severity": "Low",
      "isIncident": false,
      "systemAlertId": "2517396774668188817_10fc4326-040f-4196-9baa-1ddd473c1e2b",
      "intent": "Exfiltration",
      "resourceIdentifiers": [
        {
          "$id": "centralus_266",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-Storage",
      "alertDisplayName": "[SAMPLE ALERT] Unusual number of blobs extracted from a storage blob container",
      "description": "THIS IS A SAMPLE ALERT: Someone has extracted an unusual number of blobs from your Azure storage account 'Sample-Storage'.",
      "remediationSteps": [
        "• Limit access to your storage account, following the 'least privilege' principle: https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-privileged-access#pa-7-follow-just-enough-administration-least-privilege-principle.",
        "• Consider using identity-based authentication: https://docs.microsoft.com/en-us/azure/storage/blobs/authorize-access-azure-active-directory.",
        "• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.",
        "• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email."
      ],
      "extendedProperties": {
        "resourceType": "Storage",
        "potential causes": "This alert indicates that an unusually large number of blobs has been extracted compared to recent activity on this Storage container.\r\nPotential causes:\r\n• An attacker has extracted a large number of blobs from a Storage container (for example: data exfiltration/breach, unauthorized transfer of data).\r\n• A legitimate user or application has extracted an unusual number of blobs from a Storage container (for example: maintenance activity).",
        "investigation steps": "{\"displayValue\":\"View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information\",\"kind\":\"Link\",\"value\":\"https:\\/\\/go.microsoft.com\\/fwlink\\/?linkid=2075734\"}",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "client location": "Sample-Location",
        "authentication type": "Account key",
        "user agent": "Sample-Agent",
        "service type": "Azure Blobs",
        "azure AD user": "N/A (Azure AD user authentication was not used)",
        "operations types": "GetBlob",
        "api type": "Blob",
        "size of extracted data": "66.58 MB",
        "container": "Sample-Container",
        "extracted blobs": "41084",
        "killChainIntent": "Exfiltration"
      },
      "entities": [
        {
          "$id": "centralus_267",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_268",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington",
            "longitude": -78.17197,
            "latitude": 38.73078,
            "asn": 8075
          },
          "type": "ip"
        },
        {
          "$id": "centralus_269",
          "sourceAddress": {
            "$ref": "centralus_268"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        },
        {
          "$id": "centralus_270",
          "name": "Sample-Name",
          "storageResource": {
            "$ref": "centralus_267"
          },
          "type": "blob-container"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774668188817_10fc4326-040f-4196-9baa-1ddd473c1e2b/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774688188817_9d3ec65f-2bdf-49bf-bfb9-212c9f5dd7d0",
    "name": "2517396774688188817_9d3ec65f-2bdf-49bf-bfb9-212c9f5dd7d0",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:24.4907288Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.196663Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "Storage Accounts",
      "alertType": "SIMULATED_Storage.Blob_DataExfiltration.AmountOfDataAnomaly",
      "startTimeUtc": "2022-09-08T07:48:51.1811182Z",
      "endTimeUtc": "2022-09-08T07:48:51.1811182Z",
      "severity": "Low",
      "isIncident": false,
      "systemAlertId": "2517396774688188817_9d3ec65f-2bdf-49bf-bfb9-212c9f5dd7d0",
      "intent": "Exfiltration",
      "resourceIdentifiers": [
        {
          "$id": "centralus_271",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-Storage",
      "alertDisplayName": "[SAMPLE ALERT] Unusual amount of data extracted from a storage blob container",
      "description": "THIS IS A SAMPLE ALERT: Someone has extracted an unusual amount of data from your Azure storage account 'Sample-Storage'.",
      "remediationSteps": [
        "• Limit access to your storage account, following the 'least privilege' principle: https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-privileged-access#pa-7-follow-just-enough-administration-least-privilege-principle.",
        "• Consider using identity-based authentication: https://docs.microsoft.com/en-us/azure/storage/blobs/authorize-access-azure-active-directory.",
        "• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.",
        "• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email."
      ],
      "extendedProperties": {
        "resourceType": "Storage",
        "potential causes": "This alert indicates that an unusually large amount of data has been extracted compared to recent activity on this Storage container.\r\nPotential causes:\r\n• An attacker has extracted a large amount of data from a Storage container (for example: data exfiltration/breach, unauthorized transfer of data).\r\n• A legitimate user or application has extracted an unusual amount of data from a Storage container (for example: maintenance activity).",
        "investigation steps": "{\"displayValue\":\"View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information\",\"kind\":\"Link\",\"value\":\"https:\\/\\/go.microsoft.com\\/fwlink\\/?linkid=2075734\"}",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "client location": "Sample-Location",
        "authentication type": "Shared access signature (SAS)",
        "user agent": "Sample-Agent",
        "service type": "Azure Blobs",
        "azure AD user": "N/A (Azure AD user authentication was not used)",
        "operations types": "GetBlob",
        "api type": "Blob",
        "size of extracted data": "254.47 MB",
        "container": "Sample-Container",
        "extracted blobs": "2",
        "killChainIntent": "Exfiltration"
      },
      "entities": [
        {
          "$id": "centralus_272",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_273",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington",
            "longitude": -78.17197,
            "latitude": 38.73078,
            "asn": 8075
          },
          "type": "ip"
        },
        {
          "$id": "centralus_274",
          "sourceAddress": {
            "$ref": "centralus_273"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        },
        {
          "$id": "centralus_275",
          "name": "Sample-Name",
          "storageResource": {
            "$ref": "centralus_272"
          },
          "type": "blob-container"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774688188817_9d3ec65f-2bdf-49bf-bfb9-212c9f5dd7d0/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774708188817_8f37881b-320e-4053-801b-19cdf758accc",
    "name": "2517396774708188817_8f37881b-320e-4053-801b-19cdf758accc",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:24.617717Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.196663Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "Storage Accounts",
      "alertType": "SIMULATED_Storage.Blob_CspkgUploadAnomaly",
      "startTimeUtc": "2022-09-08T07:48:49.1811182Z",
      "endTimeUtc": "2022-09-08T07:48:49.1811182Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396774708188817_8f37881b-320e-4053-801b-19cdf758accc",
      "intent": "LateralMovement, Execution",
      "resourceIdentifiers": [
        {
          "$id": "centralus_276",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-Storage",
      "alertDisplayName": "[SAMPLE ALERT] Unusual upload of .cspkg to a storage blob container",
      "description": "THIS IS A SAMPLE ALERT: Someone has performed an unusual upload of a Cloud Service deployment package to your Azure storage account 'Sample-Storage'.",
      "remediationSteps": [
        "• Determine if the cloud service package has been deployed to your subscription, and if so, delete the corresponding service.",
        "• Delete the .cspkg from your storage account.",
        "• Limit access to your storage account, following the 'least privilege' principle: https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-privileged-access#pa-7-follow-just-enough-administration-least-privilege-principle.",
        "• Consider using identity-based authentication: https://docs.microsoft.com/en-us/azure/storage/blobs/authorize-access-azure-active-directory.",
        "• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.",
        "• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email."
      ],
      "extendedProperties": {
        "resourceType": "Storage",
        "potential causes": "This alert indicates that an Azure Cloud Service package (.cspkg file) has been uploaded to a storage account in an unusual way, compared to recent activity on this account.\r\nPotential causes:\r\n• An attacker has been preparing to deploy malicious code from your storage account to an Azure cloud service.\r\n• A legitimate user has been preparing for a legitimate service deployment.",
        "investigation steps": "• Determine who uploaded the cloud service package, and whether it is for a legitimate service.\r\n• View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information: https://go.microsoft.com/fwlink/?linkid=2075734",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "client location": "Sample-Location",
        "authentication type": "Shared access signature (SAS)",
        "user agent": "Sample-Agent",
        "service type": "Azure Blobs",
        "azure AD user": "N/A (Azure AD user authentication was not used)",
        "api type": "Blob",
        "additional Information": "Sample-Additional-Information",
        "access key used to generate SAS token": "key1",
        "container": "Sample-Container",
        "request status": "Success",
        "activity type": "PutBlockList",
        "storage file path(s) uploaded": "Sample-Path1, Sample-Path2",
        "killChainIntent": "LateralMovement, Execution"
      },
      "entities": [
        {
          "$id": "centralus_277",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_278",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington",
            "longitude": -78.17197,
            "latitude": 38.73078,
            "asn": 8075
          },
          "type": "ip"
        },
        {
          "$id": "centralus_279",
          "sourceAddress": {
            "$ref": "centralus_278"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774708188817_8f37881b-320e-4053-801b-19cdf758accc/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774728188817_492bb509-0625-413b-b5b2-6fcd6c31d13e",
    "name": "2517396774728188817_492bb509-0625-413b-b5b2-6fcd6c31d13e",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:24.6238721Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.1811182Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "Storage Accounts",
      "alertType": "SIMULATED_Storage.Blob_ApplicationAnomaly",
      "startTimeUtc": "2022-09-08T07:48:47.1811182Z",
      "endTimeUtc": "2022-09-08T07:48:47.1811182Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396774728188817_492bb509-0625-413b-b5b2-6fcd6c31d13e",
      "intent": "InitialAccess",
      "resourceIdentifiers": [
        {
          "$id": "centralus_280",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-Storage",
      "alertDisplayName": "[SAMPLE ALERT] Unusual application accessed a storage blob container",
      "description": "THIS IS A SAMPLE ALERT: Someone has accessed your Azure storage account 'Sample-Storage' using an unexpected application.",
      "remediationSteps": [
        "• Limit access to your storage account, following the 'least privilege' principle: https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-privileged-access#pa-7-follow-just-enough-administration-least-privilege-principle.",
        "• Consider using identity-based authentication: https://docs.microsoft.com/en-us/azure/storage/blobs/authorize-access-azure-active-directory.",
        "• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.",
        "• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email."
      ],
      "extendedProperties": {
        "resourceType": "Storage",
        "potential causes": "This alert indicates that an unusual application has accessed this storage account.\r\nPotential causes:\r\n• An attacker has accessed your storage account using a new application.\r\n• A legitimate user has used a new application/browser to access your storage account.",
        "investigation steps": "• Confirm whether the storage account access was expected, based on information provided above such as IP address, location and user agent used.\r\n• View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information: https://go.microsoft.com/fwlink/?linkid=2075734",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "client location": "Sample-Location",
        "authentication type": "Account key",
        "user agent": "Sample-Agent",
        "service type": "Azure Blobs",
        "azure AD user": "N/A (Azure AD user authentication was not used)",
        "api type": "Blob",
        "additional Information": "Sample-Additional-Information",
        "container": "Sample-Container",
        "request status": "Success",
        "activity type": "PutBlob",
        "access key used": "key2",
        "killChainIntent": "InitialAccess"
      },
      "entities": [
        {
          "$id": "centralus_281",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_282",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington",
            "longitude": -78.17197,
            "latitude": 38.73078,
            "asn": 8075
          },
          "type": "ip"
        },
        {
          "$id": "centralus_283",
          "sourceAddress": {
            "$ref": "centralus_282"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774728188817_492bb509-0625-413b-b5b2-6fcd6c31d13e/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774748188817_77e3193f-d56d-4c36-9e5f-5036b309a549",
    "name": "2517396774748188817_77e3193f-d56d-4c36-9e5f-5036b309a549",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:24.2719576Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.1811182Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "Storage Accounts",
      "alertType": "SIMULATED_Storage.Blob_AnonymousAccessAnomaly",
      "startTimeUtc": "2022-09-08T07:48:45.1811182Z",
      "endTimeUtc": "2022-09-08T07:48:45.1811182Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396774748188817_77e3193f-d56d-4c36-9e5f-5036b309a549",
      "intent": "InitialAccess",
      "resourceIdentifiers": [
        {
          "$id": "centralus_284",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-Storage",
      "alertDisplayName": "[SAMPLE ALERT] Unauthenticated access to a storage blob container",
      "description": "THIS IS A SAMPLE ALERT: Container 'Sample-Container' in storage account 'Sample-Storage' from an IP address located in Azure Data Center: Central Us.\r\n\r\nThere may have been additional unauthenticated access to this storage account.",
      "remediationSteps": [
        "• Where applicable, we recommend to configure authenticated access to blob containers using Azure AD roles or shared access signature tokens.",
        "• If you have a legitimate reason for these containers to remain publicly accessible, verify that they do not contain sensitive data. Additionally, ensure that users with write permissions are aware that the uploaded data will be publicly accessible."
      ],
      "extendedProperties": {
        "resourceType": "Storage",
        "potential causes": "This alert indicates that this account has been accessed anonymously (i.e. without any authentication), which is unexpected compared to recent access pattern on this account.\r\nPotential causes:\r\n• An attacker has exploited public read access to a container.\r\n• A legitimate user or application has used public read access to a container.",
        "investigation steps": "• Check if you have sensitive data on this publicly open container. If you do, immediately change the access policy to private, review diagnostic logs for sensitive data that may have leaked, and escalate the alert and information. (see how to change your access policy: https://go.microsoft.com/fwlink/?linkid=2179708)).\r\n\r\nThis is necessary despite the fact that the observed attempts failed, because reconnaissance has taken place and there might have been some successful activity.\r\n• Check if this actor is legitimate. Review IP, location, user agent, and their history.",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "client location": "Sample-Location",
        "authentication type": "Anonymous",
        "user agent": "Sample-Agent",
        "service type": "Azure Blobs",
        "azure AD user": "N/A (Azure AD user authentication was not used)",
        "operations types": "GetBlobProperties, GetBlob",
        "api type": "Blob",
        "size of extracted data": "22.96 MB",
        "container": "Sample-Container",
        "killChainIntent": "InitialAccess"
      },
      "entities": [
        {
          "$id": "centralus_285",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_286",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington",
            "longitude": -78.17197,
            "latitude": 38.73078,
            "asn": 8075
          },
          "type": "ip"
        },
        {
          "$id": "centralus_287",
          "sourceAddress": {
            "$ref": "centralus_286"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        },
        {
          "$id": "centralus_288",
          "name": "Sample-Name",
          "storageResource": {
            "$ref": "centralus_285"
          },
          "type": "blob-container"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774748188817_77e3193f-d56d-4c36-9e5f-5036b309a549/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774768188817_2569bf89-c1ad-454f-9763-fb866efd753b",
    "name": "2517396774768188817_2569bf89-c1ad-454f-9763-fb866efd753b",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:24.25831Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.1811182Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "Storage Accounts",
      "alertType": "SIMULATED_Storage.Blob_AccessInspectionAnomaly",
      "startTimeUtc": "2022-09-08T07:48:43.1811182Z",
      "endTimeUtc": "2022-09-08T07:48:43.1811182Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396774768188817_2569bf89-c1ad-454f-9763-fb866efd753b",
      "intent": "Collection",
      "resourceIdentifiers": [
        {
          "$id": "centralus_289",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-Storage",
      "alertDisplayName": "[SAMPLE ALERT] Unusual access inspection in a storage blob container",
      "description": "THIS IS A SAMPLE ALERT: Someone has performed an unusual access inspection in your Azure storage account 'Sample-Storage'.",
      "remediationSteps": [
        "• Limit access to your storage account, following the 'least privilege' principle: https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-privileged-access#pa-7-follow-just-enough-administration-least-privilege-principle.",
        "• Consider using identity-based authentication: https://docs.microsoft.com/en-us/azure/storage/blobs/authorize-access-azure-active-directory.",
        "• Revoke all storage access tokens that may be compromised and ensure that your access tokens are only shared with authorized users.",
        "• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email."
      ],
      "extendedProperties": {
        "resourceType": "Storage",
        "potential causes": "This alert indicates that the access permissions of a storage account have been inspected in an unusual way, compared to recent activity on this account.\r\nPotential causes:\r\n• An attacker has performed reconnaissance for a future attack.\r\n• A legitimate user has performed maintenance on the storage account.",
        "investigation steps": "• Confirm whether the access policy inspection was performed for a legitimate purpose: https://docs.microsoft.com/en-us/rest/api/storageservices/define-stored-access-policy.\r\n• Review the storage container's access permissions to make sure they are expected. The permissions can be viewed and updated through the Azure Portal or Azure Storage Explorer.\r\n• View related storage activity using Storage Analytics Logging. See how to configure Storage Analytics logging and more information: https://go.microsoft.com/fwlink/?linkid=2075734",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "client location": "Sample-Location",
        "authentication type": "Azure AD",
        "user agent": "Sample-Agent",
        "service type": "Azure Blobs",
        "api type": "Blob",
        "additional Information": "Sample-Additional-Information",
        "container": "Sample-Container",
        "request status": "Success",
        "activity type": "GetContainerACL",
        "azure AD application ID": "00000000-0000-0000-0000-000000000000",
        "killChainIntent": "Collection"
      },
      "entities": [
        {
          "$id": "centralus_290",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_291",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington",
            "longitude": -78.17197,
            "latitude": 38.73078,
            "asn": 8075
          },
          "type": "ip"
        },
        {
          "$id": "centralus_292",
          "aadTenantId": "00000000-0000-0000-0000-000000000000",
          "objectGuid": "00000000-0000-0000-0000-000000000000",
          "isValid": false,
          "type": "account"
        },
        {
          "$id": "centralus_293",
          "sourceAddress": {
            "$ref": "centralus_291"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774768188817_2569bf89-c1ad-454f-9763-fb866efd753b/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774788188817_c6f09707-c74a-49e3-8263-58330102586e",
    "name": "2517396774788188817_c6f09707-c74a-49e3-8263-58330102586e",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:24.4392655Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.1811182Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "Storage Accounts",
      "alertType": "SIMULATED_Storage.Blob_AM.MalwareFound",
      "startTimeUtc": "2022-09-08T07:48:41.1811182Z",
      "endTimeUtc": "2022-09-08T07:48:41.1811182Z",
      "severity": "High",
      "isIncident": false,
      "systemAlertId": "2517396774788188817_c6f09707-c74a-49e3-8263-58330102586e",
      "intent": "LateralMovement",
      "resourceIdentifiers": [
        {
          "$id": "centralus_294",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-Storage",
      "alertDisplayName": "[SAMPLE ALERT] Malicious file uploaded to storage account",
      "description": "THIS IS A SAMPLE ALERT: A malicious file was uploaded to your storage account 'Sample-Storage'.\r\nThe malware detection is based on Microsoft antimalware scanning.\r\nPotential causes may include an intentional upload of malware by a threat actor, or an unintentional upload of a malicious file by a legitimate user.",
      "remediationSteps": [
        "Remove the malicious blob from your storage account. You may move it to a designated storage container for quarantine, or delete it.",
        "It is advisable to enable \\\"soft delete\\\" before deleting malware, to support the ability to undo the deletion. Learn more about enabling soft delete on Azure storage: https://docs.microsoft.com/azure/storage/blobs/soft-delete-blob-overview.\",\"If you have diagnostic logs enabled, query them to see if any other applications or users accessed this file. Trace their actions and contain the blast radius."
      ],
      "extendedProperties": {
        "resourceType": "Storage",
        "potential Causes": "1. Intentional upload of malware by a malicious actor (true positive)\r\n\r\n2. Unintentional upload of malware by a legitimate user (true positive)\r\n\r\n3. A false positive detection by Microsoft antimalware scanning. You can submit a file for analysis if you suspect it may be a false positive: \r\n(https://docs.microsoft.com/en-us/windows/security/threat-protection/intelligence/submission-guide)",
        "shA-256": "Sample-SHA",
        "investigation Steps": "• Learn more about the malware type by reading the report on the identified malware in Microsoft Security Intelligence:\r\n(https ://www.microsoft.com/wdsi/threats/threat-search?query=DOS/EICAR_Test_File)\r\n\r\n• If you have diagnostic logs enabled, go to them and query to see if any other applications or users accessed this file. Trace their actions and contain the blast radius.\r\n\r\n• Review the credentials used to perform the upload, to track back and find the user who uploaded the file.\r\n\r\n• If you performed an investigation and suspect the this might be a false positive, you can submit a file for analysis\r\n(https://docs.microsoft.com/windows/security/threat-protection/intelligence/submission-guide).\r\nEnsure you enter the provider name \"Defender for Storage\".\r\n\r\n• Ensure that storage access tokens are stored in a secured location such as Azure Key Vault. Avoid storing or sharing storage access tokens in source code, documentation, and email.",
        "malware types detected": "DOS/EICAR_Test_File",
        "killChainIntent": "LateralMovement"
      },
      "entities": [
        {
          "$id": "centralus_295",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/microsoft.storage/storageaccounts/Sample-Storage",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_296",
          "algorithm": "SHA256",
          "value": "Sample-SHA",
          "type": "filehash"
        },
        {
          "$id": "centralus_297",
          "name": "Sample-Name",
          "storageResource": {
            "$ref": "centralus_295"
          },
          "type": "blob-container"
        },
        {
          "$id": "centralus_298",
          "directory": "fake/Sample",
          "name": "Sample-Name",
          "fileHashes": [
            {
              "$ref": "centralus_296"
            }
          ],
          "type": "file"
        },
        {
          "$id": "centralus_299",
          "name": "Sample-Name",
          "blobContainer": {
            "$ref": "centralus_297"
          },
          "url": "fake/Sample/Sample.txt",
          "etag": "Sample-Tag",
          "type": "blob"
        },
        {
          "$id": "centralus_300",
          "name": "Sample-Name",
          "category": "Virus",
          "files": [
            {
              "$ref": "centralus_298"
            }
          ],
          "type": "malware"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774788188817_c6f09707-c74a-49e3-8263-58330102586e/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774827877093_d68f7a19-8a49-4c80-b41b-beb016088e11",
    "name": "2517396774827877093_d68f7a19-8a49-4c80-b41b-beb016088e11",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:26.4159198Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.2122906Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "Azure Cosmos DB Accounts",
      "alertType": "SIMULATED_AzureCosmosDB_TorAnomaly",
      "startTimeUtc": "2022-09-08T07:48:37.2122906Z",
      "endTimeUtc": "2022-09-08T07:48:37.2122906Z",
      "severity": "High",
      "isIncident": false,
      "systemAlertId": "2517396774827877093_d68f7a19-8a49-4c80-b41b-beb016088e11",
      "intent": "InitialAccess",
      "resourceIdentifiers": [
        {
          "$id": "centralus_301",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/Microsoft.DocumentDb/databaseAccounts/Sample-AzureCosmosDBAccount",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-AzureCosmosDb",
      "alertDisplayName": "[SAMPLE ALERT] Access from a Tor exit node",
      "description": "THIS IS A SAMPLE ALERT: Azure Cosmos DB account 'Sample-AzureCosmosDBAccount' was successfully accessed from an IP address known to be an active exit node of Tor, an anonymizing proxy.\r\nThe threat actor's access was authenticated using Aad.\r\nAuthenticated access from a Tor exit node is a likely indication that a threat actor is trying to hide their identity.",
      "remediationSteps": [
        "• If it’s determined that the user isn’t legitimate, revoke any credentials that may be compromised and ensure that they are shared with authorized users only.",
        "• Limit access to the Azure Cosmos DB account, following the principle of least privilege. We recommend: https://go.microsoft.com/fwlink/?linkid=2177213.",
        "• Ensure that Azure Cosmos DB access tokens are stored in a secure location such as Azure Key Vault. Avoid storing or sharing Azure Cosmos DB access tokens in source code, documentation, or email."
      ],
      "extendedProperties": {
        "resourceType": "Azure Cosmos DB",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "investigation steps": "• Verify whether this user is legitimate. Review the credentials used and user's history of actions on this resource and others.\r\n• Check for credential theft by reviewing the authentication method.",
        "potential causes": "• A legitimate user has accessed your Azure Cosmos DB account using Tor.",
        "user agent": "dummyAgent",
        "connection mode": "Gateway",
        "container name": "Sample-Container",
        "database name": "Sample-Database",
        "key type": "Aad",
        "killChainIntent": "InitialAccess"
      },
      "entities": [
        {
          "$id": "centralus_302",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/Microsoft.DocumentDb/databaseAccounts/Sample-AzureCosmosDBAccount",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_303",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington",
            "longitude": -78.17197,
            "latitude": 38.73078,
            "asn": 8075
          },
          "type": "ip"
        },
        {
          "$id": "centralus_304",
          "sourceAddress": {
            "$ref": "centralus_303"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774827877093_d68f7a19-8a49-4c80-b41b-beb016088e11/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774847877093_362dc782-bdac-4729-b987-be12b3d37d57",
    "name": "2517396774847877093_362dc782-bdac-4729-b987-be12b3d37d57",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:26.3827984Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.2122906Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "Azure Cosmos DB Accounts",
      "alertType": "SIMULATED_AzureCosmosDB_SuspiciousIp",
      "startTimeUtc": "2022-09-08T07:48:35.2122906Z",
      "endTimeUtc": "2022-09-08T07:48:35.2122906Z",
      "severity": "High",
      "isIncident": false,
      "systemAlertId": "2517396774847877093_362dc782-bdac-4729-b987-be12b3d37d57",
      "intent": "InitialAccess",
      "resourceIdentifiers": [
        {
          "$id": "centralus_305",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/Microsoft.DocumentDb/databaseAccounts/Sample-AzureCosmosDBAccount",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-AzureCosmosDb",
      "alertDisplayName": "[SAMPLE ALERT] Access from a suspicious IP",
      "description": "THIS IS A SAMPLE ALERT: Azure Cosmos DB account 'Sample-AzureCosmosDBAccount' was successfully accessed from an IP address that was identified as a threat by Microsoft Threat Intelligence.\r\nThe threat actor's access was authenticated using Aad.",
      "remediationSteps": [
        "• If it’s determined that the user isn’t legitimate, revoke any credentials that may be compromised and ensure that they are shared with authorized users only.",
        "• Limit access to the Azure Cosmos DB account, following the principle of least privilege. We recommend: https://go.microsoft.com/fwlink/?linkid=2177213.",
        "• Ensure that Azure Cosmos DB access tokens are stored in a secure location such as Azure Key Vault. Avoid storing or sharing Azure Cosmos DB access tokens in source code, documentation, or email."
      ],
      "extendedProperties": {
        "resourceType": "Azure Cosmos DB",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "investigation steps": "• Verify whether this user is legitimate. Review the credentials used and user's history of actions on this resource and others.\r\n• Check for credential theft by reviewing the authentication method.",
        "potential causes": "• An attacker has accessed your Azure Cosmos DB account from a potentially suspicious IP.\r\n• A legitimate user has accessed your Azure Cosmos DB account from a potentially suspicious IP.",
        "user agent": "dummyAgent",
        "connection mode": "Gateway",
        "container name": "Sample-Container",
        "database name": "Sample-Database",
        "key type": "Aad",
        "killChainIntent": "InitialAccess"
      },
      "entities": [
        {
          "$id": "centralus_306",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/Microsoft.DocumentDb/databaseAccounts/Sample-AzureCosmosDBAccount",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_307",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington",
            "longitude": -78.17197,
            "latitude": 38.73078,
            "asn": 8075
          },
          "threatIntelligence": [
            {
              "providerName": "A Microsoft Partner",
              "threatType": "Eicar threat type",
              "threatName": "Eicar malware family",
              "confidence": 1,
              "reportLink": "",
              "threatDescription": "Eicar description"
            }
          ],
          "type": "ip"
        },
        {
          "$id": "centralus_308",
          "sourceAddress": {
            "$ref": "centralus_307"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774847877093_362dc782-bdac-4729-b987-be12b3d37d57/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774867877093_2dec9036-65d3-43d8-8bfa-704c1638a41a",
    "name": "2517396774867877093_2dec9036-65d3-43d8-8bfa-704c1638a41a",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:26.7041977Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.2122906Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "Azure Cosmos DB Accounts",
      "alertType": "SIMULATED_AzureCosmosDB_SqlInjection.Fuzzing",
      "startTimeUtc": "2022-09-08T07:48:33.2122906Z",
      "endTimeUtc": "2022-09-08T07:48:33.2122906Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396774867877093_2dec9036-65d3-43d8-8bfa-704c1638a41a",
      "intent": "Discovery",
      "resourceIdentifiers": [
        {
          "$id": "centralus_309",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/Microsoft.DocumentDb/databaseAccounts/Sample-AzureCosmosDBAccount",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-AzureCosmosDb",
      "alertDisplayName": "[SAMPLE ALERT] SQL injection: failed fuzzing attempt",
      "description": "THIS IS A SAMPLE ALERT: A suspicious SQL statement was used to query container 'Sample-Container' in Azure Cosmos DB account 'Sample-AzureCosmosDBAccount'.\r\nLike other well-known SQL injection attacks, this statement won’t succeed in Azure Cosmos DB. Nevertheless, it’s an indication that a threat actor is trying to attack the resources in this account.\r\nSome SQL injection attacks can succeed and be used to exfiltrate data. This means that if the attacker continues performing SQL injection attempts, they may be able to compromise your Azure Cosmos DB account and exfiltrate data.\r\nYou can prevent this threat by using parameterized queries (for more information, see the remediation steps).",
      "remediationSteps": [
        "• This alert may indicate this subscription is being targeted. To harden your environment, resolve any outstanding Defender for Cloud security recommendations for this resource and any others on this Azure subscription.",
        "• To prevent similar attacks in the future, use Azure Cosmos DB parameterized queries in all your apps.",
        "How to use parameterized queries: https://go.microsoft.com/fwlink/?linkid=2177214."
      ],
      "extendedProperties": {
        "resourceType": "Azure Cosmos DB",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "investigation steps": "• Verify whether this user is legitimate. Review the credentials used and user's history of actions on this resource and others.\r\n• Search for other alerts on this subscription that might indicate that this is part of a larger attack.\r\n• Inspect the application that is connected to this Azure Cosmos DB account. It may be vulnerable to this fuzzing attack.",
        "potential causes": "• Failed attack attempt, part of an enumeration, reconnaissance or command injection attempt.\r\n• Pen testing.",
        "user agent": "dummyAgent",
        "client IP address": "0.0.0.0",
        "collection name": "Sample-Collection",
        "database name": "Sample-DataBase",
        "top suspicious queries": "• [1 rows returned] SELECT VALUE [{\"item\": COUNT(1)}]\nFROM root\nWHERE ((root[\"creation_datetime\"] = \"2022-07-06T00:00:00+00:00\") AND (root[\"camera_id\"] IN (\"javascript:alert(_SCAN-@126032-951533-1926@-);\")))\nORDER BY root[\"order\"] ASC, root[\"_ts\"] ASC\r\n• [0 rows returned] SELECT root._rid, [{\"item\": root[\"order\"]}, {\"item\": root[\"_ts\"]}] AS orderByItems, root AS payload\nFROM root\nWHERE ((((root[\"creation_datetime\"] = \"2022-07-06T00:00:00+00:00\") AND (root[\"camera_id\"] IN (\"javascript:alert(_SCAN-@126032-951533-1926@-);\"))) AND (true)) AND IS_DEFINED(root))\nORDER BY root[\"order\"] ASC, root[\"_ts\"] ASC\nOFFSET 0 LIMIT 100",
        "total suspicious queries": "2",
        "killChainIntent": "Discovery"
      },
      "entities": [
        {
          "$id": "centralus_310",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/Microsoft.DocumentDb/databaseAccounts/Sample-AzureCosmosDBAccount",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_311",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington",
            "longitude": -78.17197,
            "latitude": 38.73078,
            "asn": 8075
          },
          "type": "ip"
        },
        {
          "$id": "centralus_312",
          "sourceAddress": {
            "$ref": "centralus_311"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774867877093_2dec9036-65d3-43d8-8bfa-704c1638a41a/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774887877093_b4262c5f-355f-4361-b490-c3843c492843",
    "name": "2517396774887877093_b4262c5f-355f-4361-b490-c3843c492843",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:26.2660801Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.2122906Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "Azure Cosmos DB Accounts",
      "alertType": "SIMULATED_AzureCosmosDB_SqlInjection.DataExfiltration",
      "startTimeUtc": "2022-09-08T07:48:31.2122906Z",
      "endTimeUtc": "2022-09-08T07:48:31.2122906Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396774887877093_b4262c5f-355f-4361-b490-c3843c492843",
      "intent": "Exfiltration",
      "resourceIdentifiers": [
        {
          "$id": "centralus_313",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/Microsoft.DocumentDb/databaseAccounts/Sample-AzureCosmosDBAccount",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-AzureCosmosDb",
      "alertDisplayName": "[SAMPLE ALERT] SQL injection: potential data exfiltration",
      "description": "THIS IS A SAMPLE ALERT: A suspicious SQL statement was used to query container 'Sample-Container' in Azure Cosmos DB account 'Sample-AzureCosmosDBAccount'.\r\nThe injected statement might have succeeded in exfiltrating data the user wasn’t authorized to access.\r\nDue to the structure and capabilities of Azure Cosmos DB queries, many known SQL injection attacks on Azure Cosmos DB accounts cannot work. However, the variation used in this attack may work and threat actors can exfiltrate data.",
      "remediationSteps": [
        "• To prevent similar attacks in the future, use Azure Cosmos DB parameterized queries in all your apps.",
        "How to use parameterized queries: https://go.microsoft.com/fwlink/?linkid=2177214.",
        "• If, for some reason, you can’t use parameterized queries, perform another form of input validation to protect against SQL injection attacks."
      ],
      "extendedProperties": {
        "resourceType": "Azure Cosmos DB",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "investigation steps": "• Investigate the query and the user. For details of the user, review the audit logs of your application. Check which user ran the query.\r\n• If the action appears malicious, continue investigating the blast radius. You may run the query (shown in the field \"Top suspicious queries\") to see what data was exfiltrated.",
        "potential causes": "• Successful data exfiltration (True Positive).\r\n• Pen testing.\r\n• A legitimate actor is trying to see all of the data, bypassing the application's access control methods. In this case, this can be considered a False Positive, however this is unsafe and should be blocked (see remediation steps on blocking).",
        "user agent": "dummySqlAgent",
        "connection mode": "",
        "container name": "Sample-Container",
        "database name": "Sample-Database",
        "key type": "",
        "total anomalous queries": "1",
        "top anomalous queries": "• SELECT * FROM root WHERE (root[\\\"userId\\\"] = \\\"123' OR '1'='1'\\\")",
        "killChainIntent": "Exfiltration"
      },
      "entities": [
        {
          "$id": "centralus_314",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/Microsoft.DocumentDb/databaseAccounts/Sample-AzureCosmosDBAccount",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_315",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington",
            "longitude": -78.17197,
            "latitude": 38.73078,
            "asn": 8075
          },
          "type": "ip"
        },
        {
          "$id": "centralus_316",
          "sourceAddress": {
            "$ref": "centralus_315"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774887877093_b4262c5f-355f-4361-b490-c3843c492843/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774907877093_c2ed177a-2220-4987-874e-f30159c4c6d2",
    "name": "2517396774907877093_c2ed177a-2220-4987-874e-f30159c4c6d2",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:26.2174194Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.2122906Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "Azure Cosmos DB Accounts",
      "alertType": "SIMULATED_AzureCosmosDB_GeoAnomaly",
      "startTimeUtc": "2022-09-08T07:48:29.2122906Z",
      "endTimeUtc": "2022-09-08T07:48:29.2122906Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396774907877093_c2ed177a-2220-4987-874e-f30159c4c6d2",
      "intent": "InitialAccess",
      "resourceIdentifiers": [
        {
          "$id": "centralus_317",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/Microsoft.DocumentDb/databaseAccounts/Sample-AzureCosmosDBAccount",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-AzureCosmosDb",
      "alertDisplayName": "[SAMPLE ALERT] Access from an unusual location",
      "description": "THIS IS A SAMPLE ALERT: One or more containers in Azure Cosmos DB account 'Sample-AzureCosmosDBAccount' were accessed from a location considered unfamiliar, based on the usual access pattern.\r\nEither a threat actor has gained access to the account, or a legitimate user has connected from a new or unusual geographic location.",
      "remediationSteps": [
        "• If it’s determined that the user isn’t legitimate, revoke any credentials that may be compromised and ensure that they are shared with authorized users only.",
        "• Limit access to the Azure Cosmos DB account, following the principle of least privilege. We recommend: https://go.microsoft.com/fwlink/?linkid=2177213.",
        "• Ensure that Azure Cosmos DB access tokens are stored in a secure location such as Azure Key Vault. Avoid storing or sharing Azure Cosmos DB access tokens in source code, documentation, or email."
      ],
      "extendedProperties": {
        "resourceType": "Azure Cosmos DB",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "investigation steps": "• Contact the user to validate whether this is known and expected activity.",
        "potential causes": "• An attacker has accessed your Azure Cosmos DB account.\r\n• A legitimate user has accessed your Azure Cosmos DB account from a new location.",
        "user agent": "dummyAgent",
        "connection mode": "Gateway",
        "container name": "Sample-Container",
        "database name": "Sample-Database",
        "key type": "Aad",
        "killChainIntent": "InitialAccess"
      },
      "entities": [
        {
          "$id": "centralus_318",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/Microsoft.DocumentDb/databaseAccounts/Sample-AzureCosmosDBAccount",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_319",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington",
            "longitude": -78.17197,
            "latitude": 38.73078,
            "asn": 8075
          },
          "type": "ip"
        },
        {
          "$id": "centralus_320",
          "sourceAddress": {
            "$ref": "centralus_319"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774907877093_c2ed177a-2220-4987-874e-f30159c4c6d2/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774927877093_11ef883f-1d81-42d7-9765-90c1df6210bb",
    "name": "2517396774927877093_11ef883f-1d81-42d7-9765-90c1df6210bb",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:26.2047118Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.2122906Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "Azure Cosmos DB Accounts",
      "alertType": "SIMULATED_AzureCosmosDB_DataExfiltrationAnomaly",
      "startTimeUtc": "2022-09-08T07:48:27.2122906Z",
      "endTimeUtc": "2022-09-08T07:48:27.2122906Z",
      "severity": "High",
      "isIncident": false,
      "systemAlertId": "2517396774927877093_11ef883f-1d81-42d7-9765-90c1df6210bb",
      "intent": "Exfiltration",
      "resourceIdentifiers": [
        {
          "$id": "centralus_321",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/Microsoft.DocumentDb/databaseAccounts/Sample-AzureCosmosDBAccount",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-AzureCosmosDb",
      "alertDisplayName": "[SAMPLE ALERT] Unusual volume of data extracted",
      "description": "THIS IS A SAMPLE ALERT: An unusually large amount of data has been extracted from container 'Sample-Container' in Azure Cosmos DB account 'Sample-AzureCosmosDBAccount'. This might indicate that a threat actor exfiltrated data.",
      "remediationSteps": [
        "• If it’s determined that the user isn’t legitimate, revoke any credentials that may be compromised and ensure that they are shared with authorized users only.",
        "• Limit access to the Azure Cosmos DB account, following the principle of least privilege. We recommend: https://go.microsoft.com/fwlink/?linkid=2177213.",
        "• Ensure that Azure Cosmos DB access tokens are stored in a secure location such as Azure Key Vault. Avoid storing or sharing Azure Cosmos DB access tokens in source code, documentation, or email."
      ],
      "extendedProperties": {
        "resourceType": "Azure Cosmos DB",
        "alert Id": "00000000-0000-0000-0000-000000000000",
        "investigation steps": "• Check whether this Azure Cosmos DB account holds sensitive data. Look at diagnostic logs for any sensitive data that may have leaked and escalate the alert and information. If it appears sensitive data may have leaked, immediately review access permissions to the account and consider rotating keys.",
        "potential causes": "• An attacker has extracted a large amount of data from an account.\r\n• A legitimate user or application has extracted an unusual amount of data from an account.",
        "collection name": "Sample-Collection",
        "database name": "Sample-DataBase",
        "key type": "Aad",
        "connection mode": "Gateway",
        "impacted region": "EUS",
        "extracted data": "5.37 GB",
        "killChainIntent": "Exfiltration"
      },
      "entities": [
        {
          "$id": "centralus_322",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/Microsoft.DocumentDb/databaseAccounts/Sample-AzureCosmosDBAccount",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_323",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington",
            "longitude": -78.17197,
            "latitude": 38.73078,
            "asn": 8075
          },
          "type": "ip"
        },
        {
          "$id": "centralus_324",
          "sourceAddress": {
            "$ref": "centralus_323"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774927877093_11ef883f-1d81-42d7-9765-90c1df6210bb/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/Sample-RG/providers/Microsoft.Security/locations/centralus/alerts/2517396774947877093_ebaad22f-a148-44b4-b87f-43343897e987",
    "name": "2517396774947877093_ebaad22f-a148-44b4-b87f-43343897e987",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:26.3765499Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.2122906Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "Azure Cosmos DB Accounts",
      "alertType": "SIMULATED_AzureCosmosDB_SuspiciousListKeys.SuspiciousPrincipal",
      "startTimeUtc": "2022-09-08T07:48:25.2122906Z",
      "endTimeUtc": "2022-09-08T07:48:25.2122906Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517396774947877093_ebaad22f-a148-44b4-b87f-43343897e987",
      "intent": "CredentialAccess",
      "resourceIdentifiers": [
        {
          "$id": "centralus_325",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-AzureCosmosDb",
      "alertDisplayName": "[SAMPLE ALERT] Preview - Suspicious extraction of Azure Cosmos DB account keys was detected",
      "description": "THIS IS A SAMPLE ALERT: A suspicious source extracted Azure Cosmos DB account access keys from your subscription. If this source is not a legitimate source, this may be a high impact issue. The access key that was extracted provides full control over the associated databases and the data stored within.\r\nThe key extraction is suspicious for the following reasons:\r\n- Key listing operations are rarely invoked by this principal on Azure Cosmos DB accounts in this subscription.\r\n\r\nThis can indicate that the identity performed this operation is compromised and is being used with malicious intent.",
      "remediationSteps": [
        "• Determine whether the activity was intentional by contacting the account owner. If the activity was intentional and legitimate, dismiss the alert. Otherwise, treat the user account, involved Azure Cosmos DB accounts and Azure subscription as compromised and continue with the next remediation steps.",
        "• Remediate the compromised principal account : delete the account if it’s an unfamiliar account (the attacker may have created it). Otherwise, change its authentication credentials, use Azure Activity Logs to locate suspicious activities and review all activities performed by the user.",
        "• Remediate the compromised Azure Cosmos DB account: rotate Azure Cosmos DB account keys that were previously listed by the threat actor.",
        "• Remediate the compromised subscription: review IAM permissions for the subscription and remove permissions for any unfamiliar user account, review all Azure resources and delete any unfamiliar Azure Resource, review all alerts in the Microsoft Defender for Cloud portal to the subscription and investigate them, use Azure Activity Logs to locate any suspicious activities and review all activities that were performed in this subscription."
      ],
      "extendedProperties": {
        "resourceType": "Azure Resource",
        "principal object ID": "00000000-0000-0000-0000-000000000000",
        "source IP address": "0.0.0.0",
        "killChainIntent": "CredentialAccess"
      },
      "entities": [
        {
          "$id": "centralus_326",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/Microsoft.DocumentDb/databaseAccounts/Sample-AzureCosmosDBAccount",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_327",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington",
            "longitude": -78.17197,
            "latitude": 38.73078,
            "asn": 8075
          },
          "threatIntelligence": [
            {
              "providerName": "A Microsoft Partner",
              "threatType": "Eicar threat type",
              "threatName": "Eicar malware family",
              "confidence": 1,
              "reportLink": "",
              "threatDescription": "Eicar description"
            }
          ],
          "type": "ip"
        },
        {
          "$id": "centralus_328",
          "sourceAddress": {
            "$ref": "centralus_327"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774947877093_ebaad22f-a148-44b4-b87f-43343897e987/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/Sample-RG/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/providers/Microsoft.Security/locations/centralus/alerts/2517396774967877093_92d150ac-2fce-4479-ab3f-b322b87489ef",
    "name": "2517396774967877093_92d150ac-2fce-4479-ab3f-b322b87489ef",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-09-08T07:51:26.329674Z",
      "processingEndTimeUtc": "2022-09-08T07:51:23.2122906Z",
      "version": "2022-01-01.0",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "productComponentName": "Azure Cosmos DB Accounts",
      "alertType": "SIMULATED_AzureCosmosDB_SuspiciousListKeys.MaliciousScript",
      "startTimeUtc": "2022-09-08T07:48:23.2122906Z",
      "endTimeUtc": "2022-09-08T07:48:23.2122906Z",
      "severity": "High",
      "isIncident": false,
      "systemAlertId": "2517396774967877093_92d150ac-2fce-4479-ab3f-b322b87489ef",
      "intent": "CredentialAccess",
      "resourceIdentifiers": [
        {
          "$id": "centralus_329",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb",
          "type": "AzureResource",
          "azureResourceTenantId": "00000000-0000-0000-0000-000000000000"
        }
      ],
      "compromisedEntity": "Sample-AzureCosmosDb",
      "alertDisplayName": "[SAMPLE ALERT] Extraction of Azure Cosmos DB accounts keys via a potentially malicious script",
      "description": "THIS IS A SAMPLE ALERT: A Powershell script was run in your subscription and performed a suspicious pattern of key-listing operations to get the keys of Azure Cosmos DB accounts in your subscription.\r\nThreat actors use automated scripts, like Microburst, to list keys and find Azure Cosmos DB accounts they can access.\r\n\r\nThis operation might indicate that an identity in your organization was breached, and that the threat actor is trying to compromise Azure Cosmos DB accounts in your environment for malicious intentions.\r\nAlternatively, a malicious insider could be trying to access sensitive data and perform lateral movement.",
      "remediationSteps": [
        "• Remediate the compromised user identity: If it’s an unfamiliar, new identity (the threat actor may have created it), then delete the user identity.",
        "Otherwise, change the user’s authentication credentials, use Azure Activity Logs to locate suspicious activities and review all activities performed by the user.",
        "• Remediate the compromised Azure Cosmos DB account: rotate Azure Cosmos DB accounts keys that were previously listed by the threat actor.",
        "• Remediate the compromised subscription: review IAM permissions for the subscription and remove permissions for any unfamiliar user identity.",
        "Review all Azure resources and delete any unfamiliar Azure resources.",
        "Review all alerts in Microsoft Defender for Cloud related to the subscription and investigate them.",
        "Use Azure Activity Logs to find suspicious activities and review all activities performed in this subscription."
      ],
      "extendedProperties": {
        "resourceType": "ARM",
        "investigation steps": "Investigate whether the identity that performed the list-key operations is compromised:\r\n• Contact the Azure Cosmos DB account owner to understand their intentions and actions.\r\n• Look at the authentication method of this user and the actions they performed across the Azure subscription.\r\nUse Azure Activity Logs to locate suspicious activities and review all activities performed by the user.\r\n• If you have diagnostic logs enabled, inspect the actions this identity performed in the Azure Cosmos DB account/s.",
        "ip address": "0.0.0.0",
        "username": "Sample-Username",
        "aad user ID": "00000000-0000-0000-0000-000000000000",
        "killChainIntent": "CredentialAccess"
      },
      "entities": [
        {
          "$id": "centralus_330",
          "resourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourcegroups/Sample-RG/providers/Microsoft.DocumentDb/databaseAccounts/Sample-AzureCosmosDBAccount",
          "type": "azure-resource"
        },
        {
          "$id": "centralus_331",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Virginia",
            "city": "Washington",
            "longitude": -78.17197,
            "latitude": 38.73078,
            "asn": 8075
          },
          "threatIntelligence": [
            {
              "providerName": "A Microsoft Partner",
              "threatType": "Eicar threat type",
              "threatName": "Eicar malware family",
              "confidence": 1,
              "reportLink": "",
              "threatDescription": "Eicar description"
            }
          ],
          "type": "ip"
        },
        {
          "$id": "centralus_332",
          "sourceAddress": {
            "$ref": "centralus_331"
          },
          "protocol": "Tcp",
          "type": "network-connection"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517396774967877093_92d150ac-2fce-4479-ab3f-b322b87489ef/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/referencedFrom/alertDeepLink/location/centralus"
    }
  },
  {
    "id": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/mc_aks-integration_aks-integration_westus/providers/Microsoft.Security/locations/centralus/alerts/2517429779999999999_e20c661d-6394-4da9-b1af-d6ce3df36676",
    "name": "2517429779999999999_e20c661d-6394-4da9-b1af-d6ce3df36676",
    "type": "Microsoft.Security/Locations/alerts",
    "properties": {
      "status": "Active",
      "timeGeneratedUtc": "2022-08-01T05:52:41.6260057Z",
      "processingEndTimeUtc": "2022-08-01T05:50:01.668Z",
      "version": "2022-01-01",
      "vendorName": "Microsoft",
      "productName": "Microsoft Defender for Cloud",
      "alertType": "Network_CommunicationWithC2",
      "startTimeUtc": "2022-08-01T03:00:00Z",
      "endTimeUtc": "2022-08-01T03:00:00Z",
      "severity": "Medium",
      "isIncident": false,
      "systemAlertId": "2517429779999999999_e20c661d-6394-4da9-b1af-d6ce3df36676",
      "intent": "CommandAndControl",
      "resourceIdentifiers": [
        {
          "$id": "centralus_333",
          "azureResourceId": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/mc_aks-integration_aks-integration_westus/providers/Microsoft.Network/loadBalancers/kubernetes",
          "type": "AzureResource",
          "azureResourceTenantId": "ebac1a16-81bf-449b-8d43-5732c3c1d999"
        }
      ],
      "compromisedEntity": "kubernetes",
      "alertDisplayName": "Network communication with a malicious machine detected",
      "description": "Network traffic analysis indicates that your machine (IP 0.0.0.0) has communicated with what is possibly a Command and Control center. When the compromised resource is a load balancer or an application gateway, the suspected activity might indicate that one or more of the resources in the backend pool (of the load balancer or application gateway) has communicated with what is possibly a Command and Control center.",
      "remediationSteps": [
        "When the compromised resource is a load balancer or an application gateway, you may want to trace which resources behind it generated the suspicious traffic:",
        "1. Find the suspicious machines, by reviewing the load balancer / application gateway backend pools.",
        "https://docs.microsoft.com/en-us/azure/load-balancer/",
        "https://docs.microsoft.com/en-us/azure/application-gateway/",
        "2. To filter the relevant machines you can:",
        "a. Check the active status of the machine during the suspicious activity using machine logs / current status.",
        "b. Check for additional alerts on the resources during the suspicious activity which may indicate the machines that were compromised.",
        "c. Check for unfamiliar processes running on the machine.",
        "d. Check for traces in other log sources (if they exist) such as: firewall logs, activity logs, WAF and more...",
        "3. Run the following remediation steps for each machine which might have been compromised by the suspicious activity:",
        "a. Escalate the alert to the information security team.",
        "b. Add 0.0.0.0 to NSG block list for 24 hours (See https://azure.microsoft.com/en-us/documentation/articles/virtual-networks-nsg/)",
        "c. Make sure the machine is completely updated and has an updated anti-malware installed.",
        "d. Run a full Anti-Virus scan and verify that the threat was removed.",
        "e. Install and run Microsoft’s Malicious Software Removal Tool. (See https://www.microsoft.com/en-us/download/malicious-software-removal-tool-details.aspx)",
        "f. Run Microsoft’s Autoruns utility and try to identify unknown applications that are configured to run at login. (See https://technet.microsoft.com/en-us/sysinternals/bb963902.aspx)",
        "g. Run Process Explorer and try to identify unknown running processes. (See https://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)"
      ],
      "extendedProperties": {
        "attacker IP": "0.0.0.0",
        "victim IP": "0.0.0.0",
        "victim Port": "80",
        "attacker Port": "50997",
        "resourceType": "Networking",
        "killChainIntent": "CommandAndControl"
      },
      "entities": [
        {
          "$id": "centralus_334",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "Nevada",
            "city": "Las Vegas",
            "longitude": -115.22485,
            "latitude": 36.1424,
            "asn": 16509,
            "carrier": "Amazon.Com Inc",
            "organization": "Amazon.Com  Inc."
          },
          "threatIntelligence": [
            {
              "providerName": "Team Cymru",
              "threatType": "C2",
              "threatName": "godzilla",
              "confidence": 0.75
            }
          ],
          "type": "ip"
        },
        {
          "$id": "centralus_335",
          "address": "0.0.0.0",
          "location": {
            "countryCode": "US",
            "countryName": "United States",
            "state": "California",
            "city": "San Jose",
            "longitude": -121.83823,
            "latitude": 37.33053,
            "asn": 8075,
            "carrier": "Microsoft Corporation",
            "organization": "Microsoft Corp"
          },
          "type": "ip"
        },
        {
          "$id": "centralus_336",
          "hostName": "kubernetes",
          "azureID": "/subscriptions/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroups/mc_aks-integration_aks-integration_westus/providers/Microsoft.Network/loadBalancers/kubernetes",
          "type": "host"
        }
      ],
      "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517429779999999999_e20c661d-6394-4da9-b1af-d6ce3df36676/subscriptionId/0f907ea4-bc8b-4c11-9d7e-805c2fd144fb/resourceGroup/mc_aks-integration_aks-integration_westus/referencedFrom/alertDeepLink/location/centralus"
    }
  }
]
