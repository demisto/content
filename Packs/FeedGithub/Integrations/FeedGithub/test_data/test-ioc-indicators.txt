
2023-07-12 (WEDNESDAY): GOZI/ISFB INFECTION WITH COBALT STRIKE

REFERENCE:

- https://twitter.com/Unit42_Intel/status/1679500766858432512

ASSOCIATED MALWARE:

- SHA256 hash: 620bc1e016887d7761907a85d49870a832b70e0340f599b472bec0a11b7b663a
- File size: 613,888 bytes
- File type: PE32 executable (DLL) (GUI) Intel 80386 (stripped to external PDB), for MS Windows
- File description: 32-bit Windows DLL for Gozi/ISFB, Botnet 2100, build 250259
- Run method: regsvr32.exe [filename]

- SHA256 hash: 540dfbef1bc65462cac88ad24a6d5cea867d9b392e9f8ae66c20ee49f4002793
- File size: 1,578,496 bytes
- File type: PE32+ executable (DLL) (GUI) x86-64 (stripped to external PDB), for MS Windows
- File location: hxxps://softwaredw[.]com/64HTTPS.dll
- Saved location: C:\Windows\Tasks\x11ogwin.dll
- File description: 64-bit Windows DLL for Cobalt Strike stager
- Run method: start-process rundll32.exe -ArgumentList '/s c:\windows\tasks\x11ogwin.dll,recurring'

TRAFFIC FROM AN INFECTED WINDOWS HOST:

GOZI/ISFB C2 TRAFFIC:

- 151.248.117[.]244 port 80 - diwdjndsfnj[.]ru - GET /uploaded/[long base64 string with backslashes and underscores].pct
- 151.248.117[.]244 port 80 - diwdjndsfnj[.]ru - POST /uploaded/[long base64 string with backslashes and underscores].dib
- 151.248.117[.]244 port 80 - diwdjndsfnj[.]ru - GET /uploaded/[long base64 string with backslashes and underscores].pmg
- 151.248.117[.]244 port 80 - iwqdndomdn[.]su - GET /uploaded/[long base64 string with backslashes and underscores].pmg
- 151.248.117[.]244 port 80 - iwqdndomdn[.]su - POST /uploaded/[long base64 string with backslashes and underscores].dib

GOZI/ISFB MODULES (ENCRYPTED DATA BINARIES):

- 91.199.147[.]95 port 80 - 91.199.147[.]95 - GET /vnc32.rar
- 91.199.147[.]95 port 80 - 91.199.147[.]95 - GET /vnc64.rar
- 91.199.147[.]95 port 80 - 91.199.147[.]95 - GET /stilak32.rar
- 91.199.147[.]95 port 80 - 91.199.147[.]95 - GET /stilak64.rar
- 91.199.147[.]95 port 80 - 91.199.147[.]95 - GET /cook32.rar
- 91.199.147[.]95 port 80 - 91.199.147[.]95 - GET /cook64.rar

TRAFFIC CAUSED BY VNC MODULE:

- 188.127.224[.]25 port 9955 - TCP traffic

ENCRYPTED DATA BINARY FOR COBALT STRIKE STAGER:

- 194.58.102[.]187 port 80 - 194.58.102[.]187 - GET /01/64HTTPS.zip

DLL FOR COBALT STRIKE STAGER:

- 193.149.176[.]60 port 443 - softwaredw[.]com - GET /softwaredw.com/64HTTPS.dll

COBALT STRIKE C2:

- 170.130.55[.]162 port 443 - iamupdate[.]com - HTTPS traffic, TLSv1.2, Let's Encrypt certificate, not valid before 2023-07-03

2020-09-21 - INFECTION FROM DRIDEX MALSPAM

REFERENCE:

- https://twitter.com/Unit42_Intel/status/1308153302513745920

EMAIL HEADER DATA:

- Received: from [91.81.229.185] (unknown [91.81.229.185]) by [removed]; Mon, 21 Sep 2020 14:25:24 +0200 (CEST)
- Received: from [1.124.14.21] (helo=FAWADUM.esa4.dhl-out.iphmx.com) by [removed] (envelope-from
watercourse71@gateway2d.dhl.com) [removed]; Mon, 21 Sep 2020 13:25:24 +0100
- Date: Mon, 21 Sep 2020 13:25:24 +0100
- From: BillingOnline <donotreply@fedex.com>
- Subject: FedEx Billing Online - Invoice Ready for Payment

ONE OF AT LEAST 10 URLS GENERATED BY EXCEL MACRO:

- hxxps://cdn.applimmo[.]com/wxmn5b.pdf
- hxxps://mazimimarlik[.]com/ow1oorywn.pdf
- hxxps://lamesuspendue.swayb[.]com/pxxnmie14.zip
- hxxps://laptopsservicecenter[.]in/s3k9ebe2.pdf
- hxxps://mail.168vitheyrealestate[.]com/k5hkyj0.zip
- hxxps://retrodays[.]pt/lhtzu8p.zip
- hxxps://skybeetravels.cheapflightso[.]co[.]uk/py198k.pdf
- hxxps://starsignsdates[.]com/hurxlu8.pdf
- hxxps://stepco[.]ro/wij87mvg.txt
- hxxps://update.cabinetulieru[.]ro/thhqpn.txt

DRIDEX POST-INFECTION HTTPS TRAFFIC

- 51.75.24[.]85 port 443
- 109.169.24[.]37 port 453

ASSOCIATED MALWARE:

- SHA256 hash: 3259221b5378b9c9a983ae265527662c0c7856f6664a9a734754f549ee4d7a33
- File size: 28,618 bytes
- File name: 5-107-26477.xlsm
- File description: Excel spreadsheet with macro for Dridex

- SHA256 hash: 5b4337f9ae1d91113c91abd0da39794d8aa216b149562440de541ca99618840d
- File size: 331,776 bytes
- File location: xxps://cdn.applimmo[.]com/wxmn5b.pdf
- File location: C:\XMjrcrYY\WZzAVF\XkZVNh
- Run method: regsvr32.exe /s [file name]
- File description: DLL installer retrieved by Excel macro for Dridex
- Note: Random characters for directory path and file name each infection

- SHA256 hash: 55067d633bef8350b5de24e3e9f153fc4a6765af0af168fb444a6329c701b10a
- File size: 1,017,344 bytes
- File location: C:\Users\[username]\AppData\Roaming\Microsoft\Templates\LiveContent\bGGj9sX\MFC42u.DLL
- File description: Dridex malware DLL
- Note: Run by copy of legitimate system file DevicePairingWizard.exe in the same directory

- SHA256 hash: 8a7cc23e3b7af9ebd2d1dd3791bb62bd1da1efd3d2c480fa51483552520abd0a
- File size: 1,012,224 bytes
- File location: C:\Users\[username]\AppData\Roaming\Sun\0umgO\WTSAPI32.dll
- File description: Dridex malware DLL
- Note: Run by copy of legitimate system file rdpclip.exe in the same directory

- SHA256 hash: eb3c152be59903d29cf02100ed2f9edea183a37882a68ae5655bcbc9004775d8
- File size: 1,009,664 bytes
- File location: C:\Users\[username]\AppData\Roaming\Thunderbird\Profiles\1ovarfyl.default-release\ImapMail\.outlook.com\yFYLx\XmlLite.dll
- File description: Dridex malware DLL
- Note: Run by copy of legitimate system file sppsvc.exe in the same directory




2020-11-16 (MONDAY) - XLSX SPREADSHEET PUSHES COBALT STRIKE

REFERENCE:

- https://twitter.com/Unit42_Intel/status/1328425382140387328

NOTES:

- We've seen this spreadsheet template normally push Qakbot until mid-November 2020, when it started pushing other families of malware instead of Qakbot.
- Since mid-November 2020, we've occasionally seen this spreadsheet template push SmokeLoader or Cobalt Strike malware.

ASSOCIATED MALWARE:

- SHA256 hash: 4af251feed5a80976f897a0749147b74ec92ad90695eea87eeb21f83a41cff7f
- File size: 366,296 bytes
- File name: Document11355.xlsb
- File description: XLSX file with macros for Cobalt Strike

- SHA256 hash: c81cbf497e7427936c0f15290fe4a1648c8fc10c249d3b97e67897bd1e2808b6
- File size: 237,568 bytes
- File location: hxxp://99promo[.]com/ds/161120.gif
- File location: C:\1b3SX\iD93\tor.exe
- File description: Windows executable file (EXE) for Cobalt Strike

INFECTION TRAFFIC:

- 35.209.123[.]121 port 80 - 99promo[.]com - GET /ds/161120.gif
- 185.99.133[.]180 port 80 - 185.99.133[.]180 - GET /IE9CompatViewList.xml
- 185.99.133[.]180 port 80 - 185.99.133[.]180 - POST /submit.php?id=12345678
- NOTE: 1245678 in the above line replaces an 8-digit identification number for the infected Windows host


2021-03-15 (MONDAY) ICEDID (BOKBOT) FROM EXCEL SPREADSHEET MACROS

REFERENCE:

- https://twitter.com/Unit42_Intel/status/1371592816510578689

INFECTION CHAIN:

- malicious spam --> ZIP attachment --> extract Excel file --> enable macros --> Installer DLL --> gziploader process --> IcedID

REFERENCE:

- https://www.binarydefense.com/icedid-gziploader-analysis/

ASSOCIATED MALWARE:

- SHA256 hash: 0b31911de524410fef3725f6fe5b565c6cb3e3b2ea5b7267bebc097f9fb57eb3
- File size: 156,675 bytes
- File name: CompensationClaim_605614143_03152021.zip
- File description: ZIP archive attached to malicious spam pushing IcedID

- SHA256 hash: 1852801558498c3bbc67b028b592ba9444a4e687a7f67737a393ce3f756d8c87
- File size: 239,104 bytes
- File name: CompensationClaim_605614143_03152021.xls
- File description: Extracted from the above ZIP archive, an Excel file with macro for IcedID

- SHA256 hash: f175d5883a0958f8ce10c387fef6c6750d26089e7413bf7b9a3767b655e61417
- File size: 44,544 bytes
- File location: hxxp://188.127.254[.]114/44270.7145450231.dat
- File location: hxxp://185.82.219[.]160/44270.7145450231.dat
- File location: hxxp://45.140.146[.]34/44270.7145450231.dat
- File location: C:\Users\[username]\SOT.GOT
- File location: C:\Users\[username]\SOT.GOT1
- File location: C:\Users\[username]\SOT.GOT2
- File description: Installer DLL for IcedID
- Run method: rundll32.exe [filename],DllRegisterServer

- SHA256 hash: 54d7277a2637bd8b410419f06a189b902243e91eb683435b931ae013d5a576f0
- File size: 36,352 bytes
- File location: C:\Users\[username]\AppData\Local\Temp\raise_x64.tmp
- File description: Initial IcedID DLL
- Run method: rundll32.exe [filename],update /i:[filepath]\license.dat

- SHA256 hash: 7b329e340343bcdf1a70d1b487093bb3a4579f603a97214ecdcf78b339a6a1fc
- File size: 36,352 bytes
- File location: C:\Users\[username]\AppData\Roaming\{00F0279B-1BB6-6935-485C-566FF0BA28FC}\[username]\ruoyan.dll
- File description: Persistent IcedID DLL
- Run method: rundll32.exe [filename],update /i:[filepath]\license.dat

- SHA256 hash: 45b6349ee9d53278f350b59d4a2a28890bbe9f9de6565453db4c085bb5875865
- File size: 341,002 bytes
- File location: C:\Users\[username]\AppData\Roaming\SpringGoat\license.dat
- File description: Data file used by the above two IcedID DLL files

TRAFFIC TO RETRIEVE INSTALLER DLL FOR ICEDID:

- 188.127.254[.]114 port 80 - 188.127.254[.]114 - GET /44270.7145450231.dat
- 185.82.219[.]160 port 80 - 185.82.219[.]160 - GET /44270.7145450231.dat
- 45.140.146[.]34 port 80 - 45.140.146[.]34 - GET /44270.7145450231.dat

TRAFFIC GENERATED BY INSTALLER DLL:

- port 443 - aws.amazon.com - HTTPS traffic
- 178.128.243[.]14 port 80 - apoxiolazio55[.]space GET /

ICEDID C2 TRAFFIC:

- 165.227.28[.]47 port 443 - twotoiletsr[.]space - HTTPS traffic
- 165.227.28[.]47 port 443 - iporumuski[.]fun - HTTPS traffic