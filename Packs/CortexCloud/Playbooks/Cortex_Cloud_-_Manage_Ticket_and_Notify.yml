id: c8a87555-15fd-45d2-800c-feb2dc507210
version: 54
vcShouldKeepItemLegacyProdMachine: false
name: Cortex Cloud - Manage Ticket and Notify
description: 'This playbook automates the dispatching of issues through ServiceNow
  or Jira and notifies stakeholders via Slack, MS Teams, and/or email. With this playbook
  you can choose to create or update a ticket using Jira or ServiceNOW, notify other
  teams using Slack or MS Teams, and/or by sending an Email. It gives you the flexibility
  to create a ticket only and skip the notification step, skip the creation of a ticket
  and notify only, or choose to create a ticket and notify stakeholders. The playbook
  checks for and requires existing Jira, ServiceNOW, Slack, or MS Teams integrations
  to perform the ticketing and notification actions. If none of these integrations
  are found in your account, then the playbook sends an email with the issue details
  to the selected issue owner. '
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 86c1b2d4-85af-4d2b-8ea0-48f2d9cb9fa8
    type: start
    task:
      id: 86c1b2d4-85af-4d2b-8ea0-48f2d9cb9fa8
      version: -1
      name: ""
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "30"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 150,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: 7bba8281-3413-464f-8aaa-20e90cda13d3
    type: condition
    task:
      id: 7bba8281-3413-464f-8aaa-20e90cda13d3
      version: -1
      name: Use ServiceNow for Issue ticket
      type: condition
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
    nexttasks:
      Create:
      - "21"
      None:
      - "32"
      Update:
      - "35"
    separatecontext: false
    conditions:
    - label: Create
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: inputs.Preferred ticketing platform
            iscontext: true
          right:
            value:
              simple: ServiceNow
        - operator: isEqualString
          left:
            value:
              simple: inputs.Preferred ticketing platform
            iscontext: true
          right:
            value:
              simple: Both
      - - operator: isEqualString
          left:
            value:
              simple: inputs.Issue State
            iscontext: true
          right:
            value:
              simple: Create
    - label: Update
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: issue.servicenowticketid
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: inputs.Preferred ticketing platform
            iscontext: true
          right:
            value:
              simple: ServiceNow
        - operator: isEqualString
          left:
            value:
              simple: inputs.Preferred ticketing platform
            iscontext: true
          right:
            value:
              simple: Both
      - - operator: isEqualString
          left:
            value:
              simple: inputs.Issue State
            iscontext: true
          right:
            value:
              simple: Update
    - label: None
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: inputs.Preferred ticketing platform
            iscontext: true
          right:
            value:
              simple: None
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 150,
          "y": 260
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 04e990d1-40a5-49f8-8ef3-392fac0f5bea
    type: title
    task:
      id: 04e990d1-40a5-49f8-8ef3-392fac0f5bea
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 150,
          "y": 1810
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: a025ac90-878b-4166-ac0c-af165e863055
    type: condition
    task:
      id: a025ac90-878b-4166-ac0c-af165e863055
      version: -1
      name: Notify using Microsoft Teams or Slack?
      type: condition
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
    nexttasks:
      MS Teams:
      - "28"
      None:
      - "34"
      Slack:
      - "29"
    separatecontext: false
    conditions:
    - label: Slack
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: 'inputs.Preferred notification platform '
            iscontext: true
          right:
            value:
              simple: Slack
            iscontext: true
    - label: MS Teams
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: 'inputs.Preferred notification platform '
            iscontext: true
          right:
            value:
              simple: MS Teams
    - label: None
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: 'inputs.Preferred notification platform '
            iscontext: true
          right:
            value:
              simple: None
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 150,
          "y": 1000
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: d05f796e-c470-413d-8378-2db95877b28a
    type: regular
    task:
      id: d05f796e-c470-413d-8378-2db95877b28a
      version: -1
      name: Create Issue ServiceNow ticket
      description: Creates new ServiceNow ticket.
      script: ServiceNow v2|||servicenow-create-ticket-quick-action
      type: regular
      iscommand: true
      brand: ServiceNow v2
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "32"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -230,
          "y": 410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: a2c93d41-7f06-4f89-8a2f-9b3bb8575326
    type: regular
    task:
      id: a2c93d41-7f06-4f89-8a2f-9b3bb8575326
      version: -1
      name: Create Issue Jira ticket
      description: Creates a new issue in Jira.
      script: Jira V3|||jira-create-issue-quick-action
      type: regular
      iscommand: true
      brand: Jira V3
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      description:
        simple: ${issue.details}
      summary:
        simple: ${issue.riskname}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -230,
          "y": 710
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "25":
    id: "25"
    taskid: fedcab6d-050e-4223-919e-d3e09bccdb92
    type: condition
    task:
      id: fedcab6d-050e-4223-919e-d3e09bccdb92
      version: -1
      name: Send email to recipients
      description: commands.server.mail.sendmail
      type: condition
      iscommand: false
      brand: Builtin
      playbooktaskmissingcomponent: null
    nexttasks:
      Email:
      - "33"
      None:
      - "15"
    scriptarguments:
      to:
        simple: ${issue.fw_email_recipient}
    separatecontext: false
    conditions:
    - label: Email
      condition:
      - - operator: isNotEqualString
          left:
            value:
              simple: 'inputs.Notification email recipients '
            iscontext: true
          right:
            value:
              simple: None
    - label: None
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: 'inputs.Notification email recipients '
            iscontext: true
          right:
            value:
              simple: None
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 150,
          "y": 1510
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: 91742821-e4d2-43bb-92af-3f692c9d924b
    type: regular
    task:
      id: 91742821-e4d2-43bb-92af-3f692c9d924b
      version: -1
      name: Update Issue Jira ticket
      description: Modifies an issue in Jira. If the status or transition fields are
        given, then the other supplied fields should appear on the transition screen.
      script: Jira V3|||jira-edit-issue
      type: regular
      iscommand: true
      brand: Jira V3
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "31"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 530,
          "y": 710
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: 9d479ece-3422-4028-8621-885e13273c79
    type: regular
    task:
      id: 9d479ece-3422-4028-8621-885e13273c79
      version: -1
      name: Microsoft Teams Notification
      description: |-
        Sends a message to the specified teams.
        To mention a user in the message, add a semicolon ";" at the end of the user mention. For example: @Bruce Willis;.

        If sending a reply to a message, the message ID must be provided and the reply will be sent via the Graph API which means
        the message will appear from the account used to authorize the integration instance and not the bot. Setting the account's name
        and picture to match the bot will make it appear to be from the same source.
      script: Microsoft Teams|||send-notification
      type: regular
      iscommand: true
      brand: Microsoft Teams
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "34"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -230,
          "y": 1170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: 36ddd26e-c462-4b04-82e1-3667e14c5847
    type: regular
    task:
      id: 36ddd26e-c462-4b04-82e1-3667e14c5847
      version: -1
      name: Slack Notification
      description: Sends a message to a user, group, or channel.
      script: SlackV3|||send-notification
      type: regular
      iscommand: true
      brand: SlackV3
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "34"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 530,
          "y": 1170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: 0bf86715-f293-4cd9-b02e-2688afb8dcf3
    type: title
    task:
      id: 0bf86715-f293-4cd9-b02e-2688afb8dcf3
      version: -1
      name: Create or Update Issue ticket
      type: title
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "12"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 150,
          "y": 130
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: 59856950-c984-464d-9b61-7362ba044643
    type: title
    task:
      id: 59856950-c984-464d-9b61-7362ba044643
      version: -1
      name: Issue Notification
      type: title
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "16"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 150,
          "y": 870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: 40221bf2-7284-44f6-98ee-33a3d15848f0
    type: condition
    task:
      id: 40221bf2-7284-44f6-98ee-33a3d15848f0
      version: -1
      name: Use Jira for Issue ticket
      type: condition
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
    nexttasks:
      Create:
      - "24"
      None:
      - "31"
      Update:
      - "26"
    separatecontext: false
    conditions:
    - label: Create
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: inputs.Preferred ticketing platform
            iscontext: true
          right:
            value:
              simple: Jira
        - operator: isEqualString
          left:
            value:
              simple: inputs.Preferred ticketing platform
            iscontext: true
          right:
            value:
              simple: Both
      - - operator: isEqualString
          left:
            value:
              simple: inputs.Issue State
            iscontext: true
          right:
            value:
              simple: Create
    - label: Update
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: issue.jiraid
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: inputs.Preferred ticketing platform
            iscontext: true
          right:
            value:
              simple: Jira
        - operator: isEqualString
          left:
            value:
              simple: inputs.Preferred ticketing platform
            iscontext: true
          right:
            value:
              simple: Both
      - - operator: isEqualString
          left:
            value:
              simple: inputs.Issue State
            iscontext: true
          right:
            value:
              simple: Update
    - label: None
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: inputs.Preferred ticketing platform
            iscontext: true
          right:
            value:
              simple: None
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 150,
          "y": 560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: 44811ea8-dc09-4c72-810c-3afd17fe7fb7
    type: regular
    task:
      id: 44811ea8-dc09-4c72-810c-3afd17fe7fb7
      version: -1
      name: Send email
      description: commands.server.mail.sendmail
      script: mail-sender|||send-mail
      type: regular
      iscommand: true
      brand: mail-sender
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      to:
        simple: ${inputs.EmailRecipients}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -220,
          "y": 1660
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: 7175486d-7801-41fc-953b-fab59e44b1d8
    type: title
    task:
      id: 7175486d-7801-41fc-953b-fab59e44b1d8
      version: -1
      name: Email Notification
      type: title
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "25"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 150,
          "y": 1320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: 1f817fb8-05ef-401f-8656-139d8caf003d
    type: regular
    task:
      id: 1f817fb8-05ef-401f-8656-139d8caf003d
      version: -1
      name: Update Issue ServiceNow ticket
      description: Updates the specified ticket.
      script: ServiceNow v2|||servicenow-update-ticket
      type: regular
      iscommand: true
      brand: ServiceNow v2
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      id:
        simple: issue.servicenowticketid
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 530,
          "y": 410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1880,
        "width": 1140,
        "x": -230,
        "y": -10
      }
    }
  }
inputs:
- key: Preferred ticketing platform
  value: {}
  required: false
  description: "Accepted values \n- Jira\n- ServiceNow\n- Both\n- None"
  playbookInputQuery: null
- key: 'Preferred notification platform '
  value: {}
  required: false
  description: "Accepted values \n- Teams\n- Slack\n- Both\n- None"
  playbookInputQuery: null
- key: 'Notification email recipients '
  value: {}
  required: false
  description: Enter the email addresses to notify, or type 'None' if no notification
    is needed.
  playbookInputQuery: null
- key: Asset details
  value: {}
  required: false
  description: Issue Asset details
  playbookInputQuery: null
- key: Issue State
  value: {}
  required: false
  description: "Controls Issue creation and updation flow\nAccepted values \n- Create\n-
    Update"
  playbookInputQuery: null
inputSections:
- inputs:
  - Preferred ticketing platform
  - 'Preferred notification platform '
  - 'Notification email recipients '
  - Asset details
  - Issue State
  name: General (Inputs group)
  description: Generic group for inputs
outputSections:
- outputs: []
  name: General (Outputs group)
  description: Generic group for outputs
outputs: []
sourceplaybookid: 29fa1351-7e54-4d92-8304-383588632740
dirtyInputs: true
adopted: true
