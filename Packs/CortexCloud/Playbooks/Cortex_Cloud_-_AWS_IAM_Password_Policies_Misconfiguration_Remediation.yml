id: c9647eeb-4e4f-4601-8cd5-128b43f67d72
version: 32
vcShouldKeepItemLegacyProdMachine: false
name: Cortex Cloud - AWS IAM Password Policies Misconfiguration Remediation
description: |-
  This playbook remediates cloud security misconfigurations related an AWS IAM Password Policy. You can choose to fully automate the remediation or have an analyst-in-the-loop review and approval step before remediating the issue. The following misconfigurations can be remediated through this playbook

  - AWS IAM password policy allows password reuse
  - AWS IAM password policy does not expire in 90 days
  - AWS IAM password policy does not have a lowercase character
  - AWS IAM password policy does not have a minimum of 14 characters
  - AWS IAM password policy does not have a number
  - AWS IAM password policy does not have a symbol
  - AWS IAM password policy does not have a uppercase character
  - AWS IAM password policy does not have password expiration period
  - AWS IAM Password policy is insecure
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 06954010-cb37-43ff-855e-d2a94b8d2e12
    type: start
    task:
      id: 06954010-cb37-43ff-855e-d2a94b8d2e12
      version: -1
      name: ""
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "5"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2855,
          "y": -140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 81111c37-6606-4877-9e27-be1615d8b842
    type: condition
    task:
      id: 81111c37-6606-4877-9e27-be1615d8b842
      version: -1
      name: Execute remediation
      type: condition
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
    nexttasks:
      expiration period:
      - "24"
      expire in 90 days:
      - "18"
      minimum length:
      - "30"
      password reuse:
      - "16"
      policy insecure:
      - "17"
      require lowercase:
      - "28"
      require numbers:
      - "21"
      require symbol:
      - "22"
      require uppercase:
      - "29"
    separatecontext: false
    conditions:
    - label: password reuse
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: a2107824-6ed5-4c67-9450-8b154bb1fd2b
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: a2107824-6ed5-4c67-9450-8b154bb1fd2b
    - label: policy insecure
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: 1e0076af-0ccd-4f1c-bba5-ac92964a5e6b
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: 1e0076af-0ccd-4f1c-bba5-ac92964a5e6b
    - label: expire in 90 days
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: f53107a2-00b2-46fb-98a9-1f12262c7d44
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: f53107a2-00b2-46fb-98a9-1f12262c7d44
    - label: require lowercase
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: ef7c537b-72eb-42a7-bab7-cb2d22c76a0d
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: ef7c537b-72eb-42a7-bab7-cb2d22c76a0d
    - label: minimum length
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: 168bfaa0-8c1d-427e-bfa8-4d96d82e3d83
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: 168bfaa0-8c1d-427e-bfa8-4d96d82e3d83
    - label: require numbers
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: 9a5813af-17a3-4058-be13-588ea00b4bfa
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: 9a5813af-17a3-4058-be13-588ea00b4bfa
    - label: require symbol
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: fd4dae57-509e-4374-96d3-e136821fc3f3
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: fd4dae57-509e-4374-96d3-e136821fc3f3
    - label: require uppercase
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: 31626ca9-f659-4d25-9d88-fa32262bbba7
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: 31626ca9-f659-4d25-9d88-fa32262bbba7
    - label: expiration period
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: a8dcc272-0b02-4534-8627-cf70ddd264c5
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: a8dcc272-0b02-4534-8627-cf70ddd264c5
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 1120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 985d5ea7-77fe-4b35-84da-79737779eab3
    type: collection
    task:
      id: 985d5ea7-77fe-4b35-84da-79737779eab3
      version: -1
      name: Execute remediation or Assign for review ?
      type: collection
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "35"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2855,
          "y": 630
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to: null
      subject: null
      body: null
      methods: []
      format: ""
      bcc: null
      cc: null
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
        completeafterv2: true
        completeaftersla: false
      replyOptions:
      - ""
    form:
      questions:
      - id: d0a0ab36-1de3-4e68-b080-fce73ed024ac
        label: ""
        labelarg:
          simple: Remediation action ?
        required: false
        gridcolumns: []
        defaultrows: []
        type: singleSelect
        options: []
        optionsarg:
        - simple: Execute
        - simple: Review
        - simple: Exit
        fieldassociated: ""
        placeholder: ""
        tooltip: ""
        readonly: false
      - id: b25d5506-c3f1-4a57-add3-a96b624aa683
        label: ""
        labelarg:
          simple: If review required ?
        required: false
        gridcolumns: []
        defaultrows: []
        type: shortText
        options: []
        optionsarg: []
        fieldassociated: ""
        placeholder: john@example.com
        tooltip: Provide reviewer email address
        readonly: false
      title: Execute remediation or Assign for a review ?
      description: |-
        Select an action to proceed with the detected issue,

        1. Execute: Run the remediation automatically
        2. Review : Assign a reviewer for manual approval
        3 Exit:  Stop further remediation steps
      sender: ""
      expired: false
      totalanswers: 0
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 9808e314-f717-4f81-8512-3a1ed8012da8
    type: regular
    task:
      id: 9808e314-f717-4f81-8512-3a1ed8012da8
      version: -1
      name: Get Asset details
      description: Get asset information.
      script: Cortex Core - IR|||core-get-asset-details
      type: regular
      iscommand: true
      brand: Cortex Core - IR
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      asset_id:
        simple: ${issue.asset_ids}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2855,
          "y": 10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: e87dbdf2-0eaf-4a2c-8163-ba7969a00a2d
    type: title
    task:
      id: e87dbdf2-0eaf-4a2c-8163-ba7969a00a2d
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2742.5,
          "y": 2060
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 530f6a5d-f441-42c8-9794-74ab5b87eda5
    type: condition
    task:
      id: 530f6a5d-f441-42c8-9794-74ab5b87eda5
      version: -1
      name: Send review request email
      type: condition
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
    nexttasks:
      "No":
      - "31"
      "Yes":
      - "3"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3870,
          "y": 960
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to:
        simple: ${Execute remediation or Assign for a review ?.Answers.name}
      subject:
        simple: Detected Issue - ${issue.details}
      body:
        simple: |-
          A cloud misconfiguration has been detected and requires your review.<br><br>
          <b>Issue ID</b>: ${issue.id}<br>
          <b>Issue Details</b>: ${issue.details}<br>
          <b>Resource</b>: ${Core.CoreAsset.xdm__asset__name}<br>
          <b>Cloud Provider</b>: ${Core.CoreAsset.xdm__asset__provider}<br>
          <b>Misconfiguration Type</b>: CSPM<br>
          <b>Severity Level</b>: ${issue.severity}<br>
          <b>Region</b>: ${Core.CoreAsset.xdm__asset__cloud__region}<br>
          <b>Issue URL</b>: ${demistoUrls.workPlan}<br><br>
          Please select <b>Yes</b> to approve the recommended remediation in the issue work plan, or <b>No</b> to reject and handle it manually.<br><br>
      methods:
      - email
      format: html
      bcc: null
      cc: null
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
        completeafterv2: true
        completeaftersla: false
      replyOptions:
      - "Yes"
      - "No"
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 9e43acd1-afeb-4032-8d52-b9f550b0d6c9
    type: regular
    task:
      id: 9e43acd1-afeb-4032-8d52-b9f550b0d6c9
      version: -1
      name: Update Issue details to War Room
      description: Prints text to war room (Markdown supported)
      scriptName: Print
      type: regular
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      value:
        simple: |-
          Issue - ${issue.details}
          Asset Name - ${Core.CoreAsset.xdm__asset__name}
          Remediation - Success
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 1480
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: de49949c-5db3-4d42-8a7d-22eec4307648
    type: regular
    task:
      id: de49949c-5db3-4d42-8a7d-22eec4307648
      version: -1
      name: Remediate IAM password policy allows password reuse
      description: Create/update password policy.
      script: AWS Cloud Automations|||aws-iam-account-password-policy-update
      type: regular
      iscommand: true
      brand: AWS Cloud Automations
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      account_id:
        simple: ${Core.CoreAsset.xdm__asset__realm}${Core.CoreAsset}
      password_reuse_prevention:
        simple: "5"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: c9786e8b-493c-4701-8fa6-a7b1a93e25c4
    type: regular
    task:
      id: c9786e8b-493c-4701-8fa6-a7b1a93e25c4
      version: -1
      name: Remediate AWS IAM Password policy is insecure
      description: Create/update password policy.
      script: AWS Cloud Automations|||aws-iam-account-password-policy-update
      type: regular
      iscommand: true
      brand: AWS Cloud Automations
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      account_id:
        simple: ${Core.CoreAsset.xdm__asset__realm}
      allow_users_to_change_password:
        simple: "true"
      hard_expiry:
        simple: "true"
      max_password_age:
        simple: "90"
      minimum_password_length:
        simple: "14"
      password_reuse_prevention:
        simple: "5"
      require_lowercase_characters:
        simple: "true"
      require_numbers:
        simple: "true"
      require_symbols:
        simple: "true"
      require_uppercase_characters:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: a287897c-c52b-4931-84b7-f6f6d0783218
    type: regular
    task:
      id: a287897c-c52b-4931-84b7-f6f6d0783218
      version: -1
      name: ' Remediate IAM password policy does not expire in 90 days'
      description: Create/update password policy.
      script: AWS Cloud Automations|||aws-iam-account-password-policy-update
      type: regular
      iscommand: true
      brand: AWS Cloud Automations
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      account_id:
        simple: ${Core.CoreAsset.xdm__asset__realm}
      max_password_age:
        simple: "90"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 1300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: 1e850ad9-85a2-4f12-890c-096f28acaf09
    type: regular
    task:
      id: 1e850ad9-85a2-4f12-890c-096f28acaf09
      version: -1
      name: Remediate AWS IAM password policy does not have a number
      description: Create/update password policy.
      script: AWS Cloud Automations|||aws-iam-account-password-policy-update
      type: regular
      iscommand: true
      brand: AWS Cloud Automations
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      account_id:
        simple: ${Core.CoreAsset.xdm__asset__realm}
      require_numbers:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 8fd6cb06-e1a9-4901-81f3-40682307e617
    type: regular
    task:
      id: 8fd6cb06-e1a9-4901-81f3-40682307e617
      version: -1
      name: Remediate AWS IAM password policy does not have a symbol
      description: Create/update password policy.
      script: AWS Cloud Automations|||aws-iam-account-password-policy-update
      type: regular
      iscommand: true
      brand: AWS Cloud Automations
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      account_id:
        simple: ${Core.CoreAsset.xdm__asset__realm}
      require_symbols:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2200,
          "y": 1300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: 0e1089f5-f0d8-4235-8aa3-a24c6f216c43
    type: regular
    task:
      id: 0e1089f5-f0d8-4235-8aa3-a24c6f216c43
      version: -1
      name: Remediate AWS IAM password policy does not have password expiration period
      description: Create/update password policy.
      script: AWS Cloud Automations|||aws-iam-account-password-policy-update
      type: regular
      iscommand: true
      brand: AWS Cloud Automations
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      account_id:
        simple: ${Core.CoreAsset.xdm__asset__realm}
      hard_expiry:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: 980f3a18-0d12-465a-b1c6-74b3ecd8c197
    type: condition
    task:
      id: 980f3a18-0d12-465a-b1c6-74b3ecd8c197
      version: -1
      name: Is remediation available ?
      type: condition
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
    nexttasks:
      '#default#':
      - "31"
      "Yes":
      - "36"
    separatecontext: false
    conditions:
    - label: "Yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: a2107824-6ed5-4c67-9450-8b154bb1fd2b
        - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: 1e0076af-0ccd-4f1c-bba5-ac92964a5e6b
        - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: f53107a2-00b2-46fb-98a9-1f12262c7d44
        - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: ef7c537b-72eb-42a7-bab7-cb2d22c76a0d
        - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: 168bfaa0-8c1d-427e-bfa8-4d96d82e3d83
        - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: 9a5813af-17a3-4058-be13-588ea00b4bfa
        - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: fd4dae57-509e-4374-96d3-e136821fc3f3
        - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: 31626ca9-f659-4d25-9d88-fa32262bbba7
        - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: a8dcc272-0b02-4534-8627-cf70ddd264c5
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: a2107824-6ed5-4c67-9450-8b154bb1fd2b
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: 1e0076af-0ccd-4f1c-bba5-ac92964a5e6b
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: f53107a2-00b2-46fb-98a9-1f12262c7d44
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: ef7c537b-72eb-42a7-bab7-cb2d22c76a0d
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: 168bfaa0-8c1d-427e-bfa8-4d96d82e3d83
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: 9a5813af-17a3-4058-be13-588ea00b4bfa
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: fd4dae57-509e-4374-96d3-e136821fc3f3
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: 31626ca9-f659-4d25-9d88-fa32262bbba7
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: a8dcc272-0b02-4534-8627-cf70ddd264c5
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2855,
          "y": 290
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: 31246a7c-35f7-4ed5-829b-209e8bf9e691
    type: regular
    task:
      id: 31246a7c-35f7-4ed5-829b-209e8bf9e691
      version: -1
      name: Remediate AWS IAM password policy does not have a lowercase character
      description: Create/update password policy.
      script: AWS Cloud Automations|||aws-iam-account-password-policy-update
      type: regular
      iscommand: true
      brand: AWS Cloud Automations
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      account_id:
        simple: ${Core.CoreAsset.xdm__asset__realm}
      require_lowercase_characters:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2630,
          "y": 1300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: cefa6bdd-f7ba-40ec-a4b1-6a93a07b3b46
    type: regular
    task:
      id: cefa6bdd-f7ba-40ec-a4b1-6a93a07b3b46
      version: -1
      name: Remediate AWS IAM password policy does not have a uppercase character
      description: Create/update password policy.
      script: AWS Cloud Automations|||aws-iam-account-password-policy-update
      type: regular
      iscommand: true
      brand: AWS Cloud Automations
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      account_id:
        simple: ${Core.CoreAsset.xdm__asset__realm}
      require_uppercase_characters:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3060,
          "y": 1300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: f0a83d2e-f50a-44a9-9b47-3251dfca15db
    type: regular
    task:
      id: f0a83d2e-f50a-44a9-9b47-3251dfca15db
      version: -1
      name: Remediate AWS IAM password policy does not have a minimum of 14 characters
      description: Create/update password policy.
      script: AWS Cloud Automations|||aws-iam-account-password-policy-update
      type: regular
      iscommand: true
      brand: AWS Cloud Automations
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      account_id:
        simple: ${Core.CoreAsset.xdm__asset__realm}
      minimum_password_length:
        simple: "14"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3490,
          "y": 1300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: f5d7ce91-f2c6-49d9-96f0-7694dcae2602
    type: playbook
    task:
      id: f5d7ce91-f2c6-49d9-96f0-7694dcae2602
      version: -1
      name: Update Issue ticket and notify
      description: 'This playbook automates the dispatching of issues through ServiceNow
        or Jira and notifies stakeholders via Slack, MS Teams, and/or email. With
        this playbook you can choose to create or update a ticket using Jira or ServiceNOW,
        notify other teams using Slack or MS Teams, and/or by sending an Email. It
        gives you the flexibility to create a ticket only and skip the notification
        step, skip the creation of a ticket and notify only, or choose to create a
        ticket and notify stakeholders. The playbook checks for and requires existing
        Jira, ServiceNOW, Slack, or MS Teams integrations to perform the ticketing
        and notification actions. If none of these integrations are found in your
        account, then the playbook sends an email with the issue details to the selected
        issue owner. '
      playbookName: Cortex Cloud - Manage Ticket and Notify
      type: playbook
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      Asset details:
        simple: ${Core.CoreAsset}
      Issue State:
        simple: Update
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 3870,
          "y": 1460
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: 8567b026-9e25-450f-9647-6495058c4d93
    type: playbook
    task:
      id: 8567b026-9e25-450f-9647-6495058c4d93
      version: -1
      name: Update Issue ticket and notify
      description: 'This playbook automates the dispatching of issues through ServiceNow
        or Jira and notifies stakeholders via Slack, MS Teams, and/or email. With
        this playbook you can choose to create or update a ticket using Jira or ServiceNOW,
        notify other teams using Slack or MS Teams, and/or by sending an Email. It
        gives you the flexibility to create a ticket only and skip the notification
        step, skip the creation of a ticket and notify only, or choose to create a
        ticket and notify stakeholders. The playbook checks for and requires existing
        Jira, ServiceNOW, Slack, or MS Teams integrations to perform the ticketing
        and notification actions. If none of these integrations are found in your
        account, then the playbook sends an email with the issue details to the selected
        issue owner. '
      playbookName: Cortex Cloud - Manage Ticket and Notify
      type: playbook
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "33"
    scriptarguments:
      Asset details:
        simple: ${Core.CoreAsset}
      Issue State:
        simple: Update
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 1650
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: e88278a2-2bac-48b8-b666-f14cbc2417d3
    type: regular
    task:
      id: e88278a2-2bac-48b8-b666-f14cbc2417d3
      version: -1
      name: Update Issue status to Resolved - Fixed
      description: commands.local.cmd.set.alert.status
      script: Builtin|||setIssueStatus
      type: regular
      iscommand: true
      brand: Builtin
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      status:
        simple: Resolved - Fixed
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 1820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: baaaa3dd-6e23-47c7-86dd-55dbaa8d593c
    type: playbook
    task:
      id: baaaa3dd-6e23-47c7-86dd-55dbaa8d593c
      version: -1
      name: Create Issue ticket
      description: 'This playbook automates the dispatching of issues through ServiceNow
        or Jira and notifies stakeholders via Slack, MS Teams, and/or email. With
        this playbook you can choose to create or update a ticket using Jira or ServiceNOW,
        notify other teams using Slack or MS Teams, and/or by sending an Email. It
        gives you the flexibility to create a ticket only and skip the notification
        step, skip the creation of a ticket and notify only, or choose to create a
        ticket and notify stakeholders. The playbook checks for and requires existing
        Jira, ServiceNOW, Slack, or MS Teams integrations to perform the ticketing
        and notification actions. If none of these integrations are found in your
        account, then the playbook sends an email with the issue details to the selected
        issue owner. '
      playbookName: Cortex Cloud - Manage Ticket and Notify
      type: playbook
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      Asset details:
        simple: ${Core.CoreAsset}
      Issue State:
        simple: Create
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 2855,
          "y": 140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: 8ac1a34d-8121-4c20-905f-241a385dec8d
    type: condition
    task:
      id: 8ac1a34d-8121-4c20-905f-241a385dec8d
      version: -1
      name: Check selected remediation action
      type: condition
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
    nexttasks:
      ' Execute':
      - "3"
      Exit:
      - "31"
      Review:
      - "11"
    separatecontext: false
    conditions:
    - label: ' Execute'
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Execute remediation or Assign for a review ?.Answers.0
            iscontext: true
          right:
            value:
              simple: Execute
    - label: Review
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Execute remediation or Assign for a review ?.Answers.0
            iscontext: true
          right:
            value:
              simple: Review
      - - operator: isNotEmpty
          left:
            value:
              simple: Execute remediation or Assign for a review ?.Answers.name
            iscontext: true
    - label: Exit
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Execute remediation or Assign for a review ?.Answers.0
            iscontext: true
          right:
            value:
              simple: Exit
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2855,
          "y": 790
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: 09ec1a6a-07ea-49d3-807c-057848719cab
    type: condition
    task:
      id: 09ec1a6a-07ea-49d3-807c-057848719cab
      version: -1
      name: Is integration available ?
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'.
      scriptName: IsIntegrationAvailable
      type: condition
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
    nexttasks:
      "no":
      - "31"
      "yes":
      - "4"
    scriptarguments:
      brandname:
        simple: AWS Cloud Automations
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2855,
          "y": 470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2260,
        "width": 4200,
        "x": 50,
        "y": -140
      }
    }
  }
inputs: []
inputSections:
- inputs: []
  name: General (Inputs group)
  description: Generic group for inputs
outputSections:
- outputs: []
  name: General (Outputs group)
  description: Generic group for outputs
outputs: []
sourceplaybookid: 62374b53-6e1b-4c9c-8ba8-0ec3889d64a1
quiet: true
dirtyInputs: true
adopted: true
