id: c9647eeb-4e4f-4601-8cd5-128b43f67d72
version: 9
vcShouldKeepItemLegacyProdMachine: false
name: Cortex Cloud - AWS IAM Password Policies Misconfiguration Remediation
description: |-
  This playbook remediates cloud security misconfigurations related an AWS IAM Password Policy. You can choose to fully automate the remediation or have an analyst-in-the-loop review and approval step before remediating the issue. The following misconfigurations can be remediated through this playbook

  - AWS IAM password policy allows password reuse
  - AWS IAM password policy does not expire in 90 days
  - AWS IAM password policy does not have a lowercase character
  - AWS IAM password policy does not have a minimum of 14 characters
  - AWS IAM password policy does not have a number
  - AWS IAM password policy does not have a symbol
  - AWS IAM password policy does not have a uppercase character
  - AWS IAM password policy does not have password expiration period
  - AWS IAM Password policy is insecure
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 0424c6dd-d6f9-465c-87b0-a37a21f66717
    type: start
    task:
      id: 0424c6dd-d6f9-465c-87b0-a37a21f66717
      version: -1
      name: ""
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "5"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2855,
          "y": -140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 741cd88d-77ea-4c77-812b-1f4801077918
    type: condition
    task:
      id: 741cd88d-77ea-4c77-812b-1f4801077918
      version: -1
      name: Execute remediation
      type: condition
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
    nexttasks:
      expiration period:
      - "24"
      expire in 90 days:
      - "18"
      minimum length:
      - "30"
      password reuse:
      - "16"
      policy insecure:
      - "17"
      require lowercase:
      - "28"
      require numbers:
      - "21"
      require symbol:
      - "22"
      require uppercase:
      - "29"
    separatecontext: false
    conditions:
    - label: password reuse
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: a2107824-6ed5-4c67-9450-8b154bb1fd2b
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: a2107824-6ed5-4c67-9450-8b154bb1fd2b
    - label: policy insecure
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: 1e0076af-0ccd-4f1c-bba5-ac92964a5e6b
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: 1e0076af-0ccd-4f1c-bba5-ac92964a5e6b
    - label: expire in 90 days
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: f53107a2-00b2-46fb-98a9-1f12262c7d44
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: f53107a2-00b2-46fb-98a9-1f12262c7d44
    - label: require lowercase
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: ef7c537b-72eb-42a7-bab7-cb2d22c76a0d
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: ef7c537b-72eb-42a7-bab7-cb2d22c76a0d
    - label: minimum length
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: 168bfaa0-8c1d-427e-bfa8-4d96d82e3d83
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: 168bfaa0-8c1d-427e-bfa8-4d96d82e3d83
    - label: require numbers
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: 9a5813af-17a3-4058-be13-588ea00b4bfa
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: 9a5813af-17a3-4058-be13-588ea00b4bfa
    - label: require symbol
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: fd4dae57-509e-4374-96d3-e136821fc3f3
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: fd4dae57-509e-4374-96d3-e136821fc3f3
    - label: require uppercase
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: 31626ca9-f659-4d25-9d88-fa32262bbba7
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: 31626ca9-f659-4d25-9d88-fa32262bbba7
    - label: expiration period
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: a8dcc272-0b02-4534-8627-cf70ddd264c5
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: a8dcc272-0b02-4534-8627-cf70ddd264c5
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 1120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: d84bca04-921c-40b0-8cd0-9b92cc33661d
    type: collection
    task:
      id: d84bca04-921c-40b0-8cd0-9b92cc33661d
      version: -1
      name: Execute remediation or Assign for review ?
      type: collection
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "35"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2855,
          "y": 630
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to: null
      subject: null
      body: null
      methods: []
      format: ""
      bcc: null
      cc: null
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
        completeafterv2: true
        completeaftersla: false
      replyOptions:
      - ""
    form:
      questions:
      - id: "0"
        label: ""
        labelarg:
          simple: Remediation action ?
        required: false
        gridcolumns: []
        defaultrows: []
        type: singleSelect
        options: []
        optionsarg:
        - simple: Execute
        - simple: Review
        - simple: Exit
        fieldassociated: ""
        placeholder: ""
        tooltip: ""
        readonly: false
      - id: "1"
        label: ""
        labelarg:
          simple: If review required ?
        required: false
        gridcolumns: []
        defaultrows: []
        type: shortText
        options: []
        optionsarg: []
        fieldassociated: ""
        placeholder: john@example.com
        tooltip: Provide reviewer email address
        readonly: false
      title: Execute remediation or Assign for a review ?
      description: |-
        Select an action to proceed with the detected issue,

        1. Execute: Run the remediation automatically
        2. Review : Assign a reviewer for manual approval
        3 Exit:  Stop further remediation steps
      sender: ""
      expired: false
      totalanswers: 0
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: b50f2a27-eff2-4696-8532-afbb573155f5
    type: regular
    task:
      id: b50f2a27-eff2-4696-8532-afbb573155f5
      version: -1
      name: Get Asset details
      description: Get asset information.
      script: Cortex Core - IR|||core-get-asset-details
      type: regular
      iscommand: true
      brand: Cortex Core - IR
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      asset_id:
        simple: ${issue.asset_ids}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2855,
          "y": 10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: c9de4bc0-e41e-4d07-8e31-fabaa44f071f
    type: title
    task:
      id: c9de4bc0-e41e-4d07-8e31-fabaa44f071f
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2742.5,
          "y": 2060
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: a2cd579b-e915-47f6-8f56-c5e3c6345a42
    type: condition
    task:
      id: a2cd579b-e915-47f6-8f56-c5e3c6345a42
      version: -1
      name: Send review request email
      type: condition
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
    nexttasks:
      "No":
      - "31"
      "Yes":
      - "3"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3870,
          "y": 960
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to:
        simple: ${Execute remediation or Assign for a review ?.Answers.name}
      subject:
        simple: Detected Issue - ${issue.details}
      body:
        simple: |-
          A cloud misconfiguration has been detected and requires your review.<br><br>
          <b>Issue ID</b>: ${issue.id}<br>
          <b>Issue Details</b>: ${issue.details}<br>
          <b>Resource</b>: ${Core.CoreAsset.xdm__asset__name}<br>
          <b>Cloud Provider</b>: ${Core.CoreAsset.xdm__asset__provider}<br>
          <b>Misconfiguration Type</b>: CSPM<br>
          <b>Severity Level</b>: ${issue.severity}<br>
          <b>Region</b>: ${Core.CoreAsset.xdm__asset__cloud__region}<br>
          <b>Issue URL</b>: ${demistoUrls.workPlan}<br><br>
          Please select <b>Yes</b> to approve the recommended remediation in the issue work plan, or <b>No</b> to reject and handle it manually.<br><br>
      methods:
      - email
      format: html
      bcc: null
      cc: null
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
        completeafterv2: true
        completeaftersla: false
      replyOptions:
      - "Yes"
      - "No"
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: bc38c177-eba2-49c1-8d80-67c143bc4657
    type: regular
    task:
      id: bc38c177-eba2-49c1-8d80-67c143bc4657
      version: -1
      name: Update Issue details to War Room
      description: Prints text to war room (Markdown supported)
      scriptName: Print
      type: regular
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      value:
        simple: |-
          Issue - ${issue.details}
          Asset Name - ${Core.CoreAsset.xdm__asset__name}
          Remediation - Success
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 1480
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: b341e958-d482-458d-a206-c5392afe644d
    type: regular
    task:
      id: b341e958-d482-458d-a206-c5392afe644d
      version: -1
      name: Remediate IAM password policy allows password reuse
      description: Create or Update AWS account password policy.
      script: AWS|||aws-iam-account-password-policy-update
      type: regular
      iscommand: true
      brand: AWS
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      account_id:
        simple: ${Core.CoreAsset.xdm__asset__realm}${Core.CoreAsset}
      password_reuse_prevention:
        simple: "5"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: dfdd4599-e3e8-4660-a829-0447d6d06485
    type: regular
    task:
      id: dfdd4599-e3e8-4660-a829-0447d6d06485
      version: -1
      name: Remediate AWS IAM Password policy is insecure
      description: Create or Update AWS account password policy.
      script: AWS|||aws-iam-account-password-policy-update
      type: regular
      iscommand: true
      brand: AWS
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      account_id:
        simple: ${Core.CoreAsset.xdm__asset__realm}
      allow_users_to_change_password:
        simple: "true"
      hard_expiry:
        simple: "true"
      max_password_age:
        simple: "90"
      minimum_password_length:
        simple: "14"
      password_reuse_prevention:
        simple: "5"
      require_lowercase_characters:
        simple: "true"
      require_numbers:
        simple: "true"
      require_symbols:
        simple: "true"
      require_uppercase_characters:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: 907325ea-e106-4dd9-b377-152fc342beb9
    type: regular
    task:
      id: 907325ea-e106-4dd9-b377-152fc342beb9
      version: -1
      name: ' Remediate IAM password policy does not expire in 90 days'
      description: Create or Update AWS account password policy.
      script: AWS|||aws-iam-account-password-policy-update
      type: regular
      iscommand: true
      brand: AWS
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      account_id:
        simple: ${Core.CoreAsset.xdm__asset__realm}
      max_password_age:
        simple: "90"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 1300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: fd61c316-4283-4ce8-b671-c2bfb3ca22a2
    type: regular
    task:
      id: fd61c316-4283-4ce8-b671-c2bfb3ca22a2
      version: -1
      name: Remediate AWS IAM password policy does not have a number
      description: Create or Update AWS account password policy.
      script: AWS|||aws-iam-account-password-policy-update
      type: regular
      iscommand: true
      brand: AWS
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      account_id:
        simple: ${Core.CoreAsset.xdm__asset__realm}
      require_numbers:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 3f87addb-a74a-45eb-b142-00b6c08f3a5d
    type: regular
    task:
      id: 3f87addb-a74a-45eb-b142-00b6c08f3a5d
      version: -1
      name: Remediate AWS IAM password policy does not have a symbol
      description: Create or Update AWS account password policy.
      script: AWS|||aws-iam-account-password-policy-update
      type: regular
      iscommand: true
      brand: AWS
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      account_id:
        simple: ${Core.CoreAsset.xdm__asset__realm}
      require_symbols:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2200,
          "y": 1300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: cfa99702-e3bc-478f-b5fd-d34d4628535e
    type: regular
    task:
      id: cfa99702-e3bc-478f-b5fd-d34d4628535e
      version: -1
      name: Remediate AWS IAM password policy does not have password expiration period
      description: Create or Update AWS account password policy.
      script: AWS|||aws-iam-account-password-policy-update
      type: regular
      iscommand: true
      brand: AWS
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      account_id:
        simple: ${Core.CoreAsset.xdm__asset__realm}
      hard_expiry:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: fe0e8c61-6452-4a47-86e3-9933679a38ee
    type: condition
    task:
      id: fe0e8c61-6452-4a47-86e3-9933679a38ee
      version: -1
      name: Is remediation available ?
      type: condition
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
    nexttasks:
      '#default#':
      - "31"
      "Yes":
      - "36"
    separatecontext: false
    conditions:
    - label: "Yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: a2107824-6ed5-4c67-9450-8b154bb1fd2b
        - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: 1e0076af-0ccd-4f1c-bba5-ac92964a5e6b
        - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: f53107a2-00b2-46fb-98a9-1f12262c7d44
        - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: ef7c537b-72eb-42a7-bab7-cb2d22c76a0d
        - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: 168bfaa0-8c1d-427e-bfa8-4d96d82e3d83
        - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: 9a5813af-17a3-4058-be13-588ea00b4bfa
        - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: fd4dae57-509e-4374-96d3-e136821fc3f3
        - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: 31626ca9-f659-4d25-9d88-fa32262bbba7
        - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: a8dcc272-0b02-4534-8627-cf70ddd264c5
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: a2107824-6ed5-4c67-9450-8b154bb1fd2b
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: 1e0076af-0ccd-4f1c-bba5-ac92964a5e6b
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: f53107a2-00b2-46fb-98a9-1f12262c7d44
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: ef7c537b-72eb-42a7-bab7-cb2d22c76a0d
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: 168bfaa0-8c1d-427e-bfa8-4d96d82e3d83
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: 9a5813af-17a3-4058-be13-588ea00b4bfa
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: fd4dae57-509e-4374-96d3-e136821fc3f3
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: 31626ca9-f659-4d25-9d88-fa32262bbba7
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: a8dcc272-0b02-4534-8627-cf70ddd264c5
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2855,
          "y": 290
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: 4a962733-6c72-48f1-964a-677a9848aa54
    type: regular
    task:
      id: 4a962733-6c72-48f1-964a-677a9848aa54
      version: -1
      name: Remediate AWS IAM password policy does not have a lowercase character
      description: Create or Update AWS account password policy.
      script: AWS|||aws-iam-account-password-policy-update
      type: regular
      iscommand: true
      brand: AWS
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      account_id:
        simple: ${Core.CoreAsset.xdm__asset__realm}
      require_lowercase_characters:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2630,
          "y": 1300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: 9273f1af-1f25-43f1-b8a7-69ae96f27479
    type: regular
    task:
      id: 9273f1af-1f25-43f1-b8a7-69ae96f27479
      version: -1
      name: Remediate AWS IAM password policy does not have a uppercase character
      description: Create or Update AWS account password policy.
      script: AWS|||aws-iam-account-password-policy-update
      type: regular
      iscommand: true
      brand: AWS
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      account_id:
        simple: ${Core.CoreAsset.xdm__asset__realm}
      require_uppercase_characters:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3060,
          "y": 1300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: d496a6a0-5fe4-4527-9cea-bf6ff4faecc3
    type: regular
    task:
      id: d496a6a0-5fe4-4527-9cea-bf6ff4faecc3
      version: -1
      name: Remediate AWS IAM password policy does not have a minimum of 14 characters
      description: Create or Update AWS account password policy.
      script: AWS|||aws-iam-account-password-policy-update
      type: regular
      iscommand: true
      brand: AWS
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      account_id:
        simple: ${Core.CoreAsset.xdm__asset__realm}
      minimum_password_length:
        simple: "14"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3490,
          "y": 1300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: 229a661f-a19d-455e-8001-b2eca251fd34
    type: playbook
    task:
      id: 229a661f-a19d-455e-8001-b2eca251fd34
      version: -1
      name: Update Issue ticket and notify
      description: 'This playbook automates the dispatching of issues through ServiceNow
        or Jira and notifies stakeholders via Slack, MS Teams, and/or email. With
        this playbook you can choose to create or update a ticket using Jira or ServiceNOW,
        notify other teams using Slack or MS Teams, and/or by sending an Email. It
        gives you the flexibility to create a ticket only and skip the notification
        step, skip the creation of a ticket and notify only, or choose to create a
        ticket and notify stakeholders. The playbook checks for and requires existing
        Jira, ServiceNOW, Slack, or MS Teams integrations to perform the ticketing
        and notification actions. If none of these integrations are found in your
        account, then the playbook sends an email with the issue details to the selected
        issue owner. '
      playbookName: Cortex Cloud - Create Ticket and Notify
      type: playbook
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      Asset details:
        simple: ${Core.CoreAsset}
      Issue State:
        simple: Update
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 3870,
          "y": 1460
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: bf91f98d-5ec1-4588-8c2f-e31296bb1411
    type: playbook
    task:
      id: bf91f98d-5ec1-4588-8c2f-e31296bb1411
      version: -1
      name: Update Issue ticket and notify
      description: 'This playbook automates the dispatching of issues through ServiceNow
        or Jira and notifies stakeholders via Slack, MS Teams, and/or email. With
        this playbook you can choose to create or update a ticket using Jira or ServiceNOW,
        notify other teams using Slack or MS Teams, and/or by sending an Email. It
        gives you the flexibility to create a ticket only and skip the notification
        step, skip the creation of a ticket and notify only, or choose to create a
        ticket and notify stakeholders. The playbook checks for and requires existing
        Jira, ServiceNOW, Slack, or MS Teams integrations to perform the ticketing
        and notification actions. If none of these integrations are found in your
        account, then the playbook sends an email with the issue details to the selected
        issue owner. '
      playbookName: Cortex Cloud - Create Ticket and Notify
      type: playbook
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "33"
    scriptarguments:
      Asset details:
        simple: ${Core.CoreAsset}
      Issue State:
        simple: Update
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 1650
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: 7abd183c-1d4e-4eae-8217-cac83ba3b0a6
    type: regular
    task:
      id: 7abd183c-1d4e-4eae-8217-cac83ba3b0a6
      version: -1
      name: Update Issue status to Resolved - Fixed
      description: commands.local.cmd.set.alert.status
      script: Builtin|||setIssueStatus
      type: regular
      iscommand: true
      brand: Builtin
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      status:
        simple: Resolved - Fixed
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 1820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: 327c6237-f2d3-4af7-81cc-e6bef83c6f00
    type: playbook
    task:
      id: 327c6237-f2d3-4af7-81cc-e6bef83c6f00
      version: -1
      name: Create Issue ticket
      description: 'This playbook automates the dispatching of issues through ServiceNow
        or Jira and notifies stakeholders via Slack, MS Teams, and/or email. With
        this playbook you can choose to create or update a ticket using Jira or ServiceNOW,
        notify other teams using Slack or MS Teams, and/or by sending an Email. It
        gives you the flexibility to create a ticket only and skip the notification
        step, skip the creation of a ticket and notify only, or choose to create a
        ticket and notify stakeholders. The playbook checks for and requires existing
        Jira, ServiceNOW, Slack, or MS Teams integrations to perform the ticketing
        and notification actions. If none of these integrations are found in your
        account, then the playbook sends an email with the issue details to the selected
        issue owner. '
      playbookName: Cortex Cloud - Create Ticket and Notify
      type: playbook
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      Asset details:
        simple: ${Core.CoreAsset}
      Issue State:
        simple: Create
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 2855,
          "y": 140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: d381b286-229d-43a8-844f-9cbecd6153f9
    type: condition
    task:
      id: d381b286-229d-43a8-844f-9cbecd6153f9
      version: -1
      name: Check selected remediation action
      type: condition
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
    nexttasks:
      ' Execute':
      - "3"
      Exit:
      - "31"
      Review:
      - "11"
    separatecontext: false
    conditions:
    - label: ' Execute'
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Execute remediation or Assign for a review ?.Answers.0
            iscontext: true
          right:
            value:
              simple: Execute
    - label: Review
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Execute remediation or Assign for a review ?.Answers.0
            iscontext: true
          right:
            value:
              simple: Review
      - - operator: isNotEmpty
          left:
            value:
              simple: Execute remediation or Assign for a review ?.Answers.name
            iscontext: true
    - label: Exit
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Execute remediation or Assign for a review ?.Answers.0
            iscontext: true
          right:
            value:
              simple: Exit
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2855,
          "y": 790
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: 441b78de-c7b8-4e78-94c5-c1df427ecbd1
    type: condition
    task:
      id: 441b78de-c7b8-4e78-94c5-c1df427ecbd1
      version: -1
      name: Is integration available ?
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'.
      scriptName: IsIntegrationAvailable
      type: condition
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
    nexttasks:
      "no":
      - "31"
      "yes":
      - "4"
    scriptarguments:
      brandname:
        simple: AWS
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2855,
          "y": 470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2260,
        "width": 4200,
        "x": 50,
        "y": -140
      }
    }
  }
inputs: []
inputSections:
- inputs: []
  name: General (Inputs group)
  description: Generic group for inputs
outputSections:
- outputs: []
  name: General (Outputs group)
  description: Generic group for outputs
outputs: []
sourceplaybookid: 62374b53-6e1b-4c9c-8ba8-0ec3889d64a1
quiet: true
dirtyInputs: true
adopted: true
