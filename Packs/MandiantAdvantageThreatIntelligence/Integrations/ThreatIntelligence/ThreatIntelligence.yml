category: Data Enrichment & Threat Intelligence
commonfields:
  id: Mandiant Advantage Threat Intelligence
  version: -1
configuration:
- additionalinfo: Leave as 'api.intelligence.mandiant.com' if unsure
  defaultvalue: https://api.intelligence.mandiant.com
  display: API Base URL
  name: api_base_url
  required: false
  type: 0
- additionalinfo: Your API Key from Mandiant Advantage Threat Intelligence
  display: API Key
  name: api_key
  required: true
  type: 0
- additionalinfo: Your Secret Key from Mandiant Advantage Threat Intelligence
  display: Secret Key
  name: secret_key
  required: true
  type: 4
- defaultvalue: 'true'
  display: Fetch indicators
  name: feed
  required: false
  type: 8
  additionalInfo: Whether to automatically fetch new indicators as part of a feed
- additionalinfo: Indicators from this integration instance will be marked with this
    reputation.
  display: Indicator Reputation
  name: feedReputation
  options:
  - None
  - Good
  - Suspicious
  - Bad
  required: false
  type: 18
- additionalinfo: Reliability of the source providing the intelligence data.
  defaultvalue: A - Completely reliable
  display: Source Reliability
  name: feedReliability
  options:
  - A - Completely reliable
  - B - Usually reliable
  - C - Fairly reliable
  - D - Not usually reliable
  - E - Unreliable
  - F - Reliability cannot be judged
  required: true
  type: 15
- additionalinfo: The Traffic Light Protocol (TLP) designation to apply to indicators
    fetched from the feed.
  display: Traffic Light Protocol Color
  name: tlp_color
  options:
  - RED
  - AMBER
  - GREEN
  - WHITE
  required: false
  type: 15
  defaultvalue: AMBER
- name: feedExpirationPolicy
  display: Feed Expiration Policy
  options:
  - never
  - interval
  - indicatorType
  - suddenDeath
  required: false
  type: 17
  additionalInfo: The Feed Expiration Policy
- name: feedExpirationInterval
  display: Feed Expiration Interval
  required: false
  type: 1
  additionalInfo: The Feed Expiration Interval
- defaultvalue: '240'
  display: Feed Fetch Interval
  name: feedFetchInterval
  required: false
  type: 19
  additionalInfo: The number of minutes between Feed Fetches
- name: feedMinimumConfidence
  type: 0
  display: Feed Minimum Confidence Score
  required: true
  defaultvalue: 80
  additionalinfo: 'The minimum MScore value to import as part of the feed'
- name: feedExcludeOSIntel
  display: Feed Exclude Open Source Intelligence
  type: 8
  required: true
  defaultvalue: true
  additionalinfo: 'Whether to exclude Open Source Intelligence as part of the feed'
- additionalinfo: 'The type of indicators to fetch. Indicator type might include the
    following: Domains, IPs, Files and URLs.'
  defaultvalue: Malware,Actors,Indicators
  display: Mandiant indicator type
  name: type
  options:
  - Malware
  - Actors
  - Indicators
  required: false
  type: 16
- additionalinfo: The maximum value allowed is 90 days.
  defaultvalue: 30 days
  display: First fetch time
  name: first_fetch
  required: false
  type: 0
- defaultvalue: '50'
  display: Maximum number of indicators per fetch
  name: max_fetch
  required: false
  type: 0
  additionalinfo: Maximum value of 1000.  Any values higher will be capped to 1000
- additionalinfo: Supports CSV values.
  display: Tags
  name: feedTags
  required: false
  type: 0
- additionalinfo: API calls timeout.
  defaultvalue: '60'
  display: Timeout
  name: timeout
  required: false
  type: 0
- additionalinfo: When selected, the exclusion list is ignored for indicators from
    this feed. This means that if an indicator from this feed is on the exclusion
    list, the indicator might still be added to the system.
  display: Bypass exclusion list
  name: feedBypassExclusionList
  required: false
  type: 8
- additionalinfo: Retrieve additional information for each indicator. Note that this
    requires additional API calls.
  defaultvalue: 'false'
  display: Retrieve indicator metadata
  name: indicatorMetadata
  required: false
  type: 8
- additionalinfo: Note that this requires additional API calls.
  defaultvalue: 'false'
  display: Create relationships
  name: indicatorRelationships
  required: false
  type: 8
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: 'Integrate with Mandiant Advantage'
display: Mandiant Advantage Threat Intelligence
name: Mandiant Advantage Threat Intelligence
script:
  commands:
  - name: threat-intelligence-get-indicators
    arguments:
    - default: true
      description: Update context.
      isArray: false
      name: update_context
      required: false
      secret: false
    - default: false
      description: The maximum number of indicators to fetch.
      isArray: false
      name: limit
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: 'false'
      description: Whether to retrieve additional data for each indicator.
      isArray: false
      name: indicatorMetadata
      predefined:
      - 'true'
      - 'false'
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: 'false'
      description: Whether to create indicator relationships.
      isArray: false
      name: indicatorRelationships
      predefined:
      - 'true'
      - 'false'
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: Malware,Indicators,Actors
      description: The type of indicators to fetch.
      isArray: true
      name: type
      predefined:
      - Malware
      - Indicators
      - Actors
      required: true
      secret: false
    deprecated: false
    description: Get Mandiant indicators
    execution: false
  - name: get-indicator
    arguments:
    - default: true
      description: Value of the indicator to look up.  Can be URL, domain name, IP
        address, or file hash
      isArray: false
      name: indicator_value
      required: true
      secret: false
    deprecated: false
    description: Get information about a single Indicator of Compromise from Mandiant
    execution: false
  - name: get-actor
    arguments:
    - default: true
      description: Name of the actor to look up
      isArray: false
      name: actor_name
      required: true
      secret: false
    deprecated: false
    description: Get information about a Threat Actor from Mandiant
    execution: false
  - name: get-malware
    arguments:
    - default: true
      description: Name of the malware family to look up
      isArray: false
      name: malware_name
      required: true
      secret: false
    deprecated: false
    description: Get information about a Malware Family from Mandiant
    execution: false
  - name: file
    arguments:
    - default: true
      description: List of files.
      isArray: true
      name: file
      required: false
      secret: false
    deprecated: false
    description: Retrieve information about a File Hash from Mandiant
    execution: false
  - name: ip
    arguments:
    - default: true
      description: List of IPs.
      isArray: true
      name: ip
      required: false
      secret: false
    deprecated: false
    description: Retrieve information about an IP Address from Mandiant
    execution: false
  - name: url
    arguments:
    - default: true
      description: List of URLs.
      isArray: true
      name: url
      required: false
      secret: false
    deprecated: false
    description: Retrieve information about a URL from Mandiant
    execution: false
  - name: domain
    arguments:
    - default: true
      description: List of domains.
      isArray: true
      name: domain
      required: false
      secret: false
    deprecated: false
    description: Retrieve information about an FQDN from Mandiant
    execution: false
  - name: cve
    arguments:
    - default: true
      description: List of CVEs.
      isArray: true
      name: cve
      required: false
      secret: false
    deprecated: false
    description: Retrieve information about a Vulnerability (by CVE) from Mandiant
    execution: false
  - name: get-campaign
    arguments:
    - default: true
      description: ID of the campaign to lookup
      isArray: false
      name: campaign_id
      required: true
      secret: false
    deprecated: false
    description: Retrieve information about a Campaign from Mandiant
    execution: false
  dockerimage: demisto/python3:3.10.5.31797
  feed: true
  isfetch: false
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  subtype: python3
  type: python
tests:
- No tests (auto formatted)
fromversion: 5.5.0
