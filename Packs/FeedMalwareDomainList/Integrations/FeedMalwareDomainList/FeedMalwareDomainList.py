from CommonServerPython import *


def main():
    params = {k: v for k, v in demisto.params().items() if v is not None}

    params['indicator_type'] = FeedIndicatorType.IP

    params['url'] = 'http://www.malwaredomainlist.com/hostslist/ip.txt'
    params['indicator'] = json.dumps({
        "regex": r"^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}",
    })

    # Call the main execution of the HTTP API module.
    feed_main('Malware Domain List Active IPs Feed', params, 'malwaredomainlist')


from HTTPFeedApiModule import *  # noqa: E402


if __name__ == '__builtin__' or __name__ == 'builtins':
    main()
