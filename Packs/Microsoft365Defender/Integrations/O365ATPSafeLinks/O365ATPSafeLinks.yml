category: Utilities
commonfields:
  id: O365 ATP SafeLinks
  version: -1
configuration:
  - name: url
    display: Exchange Online URL
    required: true
    defaultvalue: https://outlook.office365.com
    type: 0
    additionalinfo: null
  - name: certificate
    display: ""
    required: true
    defaultvalue: null
    type: 9
    additionalinfo: A pfx certificate encoded in Base64.
    displaypassword: "Certificate"
    hiddenusername: true
  - name: organization
    display: The organization used in app-only authentication.
    required: true
    defaultvalue: null
    type: 0
    additionalinfo: null
  - name: app_id
    display: The application ID from the Azure portal
    required: true
    defaultvalue: null
    type: 0
    additionalinfo: null
description: Use the EWS Extension Online Powershell v2 integration to get
  information about mailboxes and users in your organization.
display: O365 ATP SafeLinks
name: O365 ATP SafeLinks
script:
  commands:
    - arguments:
        - default: false
          isArray: false
          name: identity
          description: The Identity parameter specifies the Safe Links policy that you
            want to view.
          required: false
          secret: false
      deprecated: false
      outputs: []
      description: Displays mailbox objects and attributes, populate property pages,
        or supplies mailbox information to other tasks.
      execution: false
      name: o365-atp-safe-links-policy-list
    - arguments:
        - name: name
          description: "The Name parameter specifies a unique name for the Safe Links
            policy. "
          required: true
          isArray: false
        - default: false
          isArray: false
          name: admin_display_name
          description: The AdminDisplayName parameter specifies a description for the
            policy.
          required: false
          secret: false
        - name: custom_notification_text
          description: The custom notification text specifies the customized notification
            text to show to users.
          required: false
          isArray: false
        - name: deliver_message_after_scan
          description: Whether to deliver email messages only after Safe Links scanning is
            complete.
          required: false
          isArray: false
          predefined:
            - true,false
        - name: do_not_allow_click_through
          description: Whether to allow users to click through to the original URL on
            warning pages.
          required: false
          isArray: false
          predefined:
            - true,false
        - name: do_not_rewrite_urls
          description: The URLs that are not rewritten by Safe Links scanning
          required: false
          isArray: false
        - name: do_not_track_user_clicks
          description: Whether to track user clicks related to Safe Links protection of
            links in email messages.
          required: false
          isArray: false
          predefined:
            - true,false
        - name: enable_for_internal_senders
          description: Whether the Safe Links policy is applied to messages sent between
            internal senders and internal recipients within the same Exchange
            Online organization.
          required: false
          isArray: false
          predefined:
            - true,false
        - name: enable_organization_branding
          description: Whether your organization's logo is displayed on Safe Links warning
            and notification pages.
          required: false
          isArray: false
          predefined:
            - true,false
        - name: enable_safe_links_for_teams
          description: Whether Safe Links is enabled for Microsoft Teams.
          required: false
          isArray: false
          predefined:
            - true,false
        - name: is_enabled
          description: Whether to enable Safe Links protection for email messages.
          required: false
          isArray: false
          predefined:
            - true,false
        - name: scan_urls
          description: Whether to enable or disable real-time scanning of clicked links in
            email messages.
          required: false
          isArray: false
          predefined:
            - true,false
        - name: use_translated_notification_text
          description: Whether to use Microsoft Translator to automatically localize the
            custom notification text that you specified with the
            CustomNotificationText parameter.
          required: false
          isArray: false
          predefined:
            - true,false
      outputs: []
      deprecated: false
      description: Displays Client Access settings that are configured on mailboxes.
      execution: false
      name: o365-atp-safe-links-policy-create
    - arguments:
        - name: name
          description: "The Name parameter specifies a unique name for the Safe Links
            policy. "
          required: true
          isArray: false
        - default: false
          isArray: false
          name: admin_display_name
          description: The AdminDisplayName parameter specifies a description for the
            policy.
          required: false
          secret: false
        - name: custom_notification_text
          description: The custom notification text specifies the customized notification
            text to show to users.
          required: false
          isArray: false
        - name: deliver_message_after_scan
          description: Whether to deliver email messages only after Safe Links scanning is
            complete.
          required: false
          isArray: false
          predefined:
            - true,false
        - name: do_not_allow_click_through
          description: Whether to allow users to click through to the original URL on
            warning pages.
          required: false
          isArray: false
          predefined:
            - true,false
        - name: do_not_rewrite_urls
          description: The URLs that are not rewritten by Safe Links scanning
          required: false
          isArray: false
        - name: do_not_track_user_clicks
          description: Whether to track user clicks related to Safe Links protection of
            links in email messages.
          required: false
          isArray: false
          predefined:
            - true,false
        - name: enable_for_internal_senders
          description: Whether the Safe Links policy is applied to messages sent between
            internal senders and internal recipients within the same Exchange
            Online organization.
          required: false
          isArray: false
          predefined:
            - true,false
        - name: enable_organization_branding
          description: Whether your organization's logo is displayed on Safe Links warning
            and notification pages.
          required: false
          isArray: false
          predefined:
            - true,false
        - name: enable_safe_links_for_teams
          description: Whether Safe Links is enabled for Microsoft Teams.
          required: false
          isArray: false
          predefined:
            - true,false
        - name: is_enabled
          description: Whether to enable Safe Links protection for email messages.
          required: false
          isArray: false
          predefined:
            - true,false
        - name: scan_urls
          description: Whether to enable or disable real-time scanning of clicked links in
            email messages.
          required: false
          isArray: false
          predefined:
            - true,false
        - name: use_translated_notification_text
          description: Whether to use Microsoft Translator to automatically localize the
            custom notification text that you specified with the
            CustomNotificationText parameter.
          required: false
          isArray: false
          predefined:
            - true,false
      outputs: []
      deprecated: false
      description: Displays Client Access settings that are configured on mailboxes.
      execution: false
      name: o365-atp-safe-links-policy-update
    - arguments:
        - default: false
          isArray: false
          name: identity
          description: The Identity parameter specifies the Safe Links policy that you
            want to remove.
          required: true
          secret: false
      deprecated: false
      outputs: []
      description: Displays mailbox objects and attributes, populate property pages,
        or supplies mailbox information to other tasks.
      execution: false
      name: o365-atp-safe-links-policy-remove
    - arguments:
        - default: false
          isArray: false
          name: identity
          description: The Identity parameter specifies the Safe Links rule that you want
            to view.
          required: false
          secret: false
      deprecated: false
      outputs: []
      description: Displays mailbox objects and attributes, populate property pages,
        or supplies mailbox information to other tasks.
      execution: false
      name: o365-atp-safe-links-rule-list
    - name: o365-atp-safe-links-rule-create
      description: description
      deprecated: false
      arguments:
        - name: name
          description: The Name parameter specifies a unique name for the Safe Links rule.
          required: true
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: safe_links_policy
          description: The SafeLinksPolicy parameter specifies the Safe Links policy
            that's associated with this Safe Links rule.
          required: true
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: comments
          description: The Comments parameter specifies informative comments for the rule,
            such as what the rule is used for or how it has changed over time.
            The length of the comment can't exceed 1024 characters.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: enabled
          description: Whether the rule is enabled.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - true,false
        - name: except_if_recipient_domain_is
          description: The ExceptIfRecipientDomainIs parameter specifies an exception that
            looks for recipients with email address in the specified domains.
          required: false
          isArray: true
          defaultValue: ""
          predefined:
            - ""
        - name: except_if_sent_to
          description: The ExceptIfSentTo parameter specifies an exception that looks for
            recipients in messages.
          required: false
          isArray: true
          defaultValue: ""
          predefined:
            - ""
        - name: except_if_sent_to_member_of
          description: The ExceptIfSentToMemberOf parameter specifies an exception that
            looks for messages sent to members of groups.
          required: false
          isArray: true
          defaultValue: ""
          predefined:
            - ""
        - name: priority
          description: The Priority parameter specifies a priority value for the rule that
            determines the order of rule processing. A lower integer value
            indicates a higher priority, the value 0 is the highest priority,
            and rules can't have the same priority value.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: recipient_domain_is
          description: The RecipientDomainIs parameter specifies a condition that looks
            for recipients with email address in the specified domains.
          required: false
          isArray: true
          defaultValue: ""
          predefined:
            - ""
        - name: sent_to
          description: The SentTo parameter specifies a condition that looks for
            recipients in messages. You can use any value that uniquely
            identifies the recipient.
          required: false
          isArray: true
          defaultValue: ""
          predefined:
            - ""
        - name: sent_to_member_of
          description: The SentToMemberOf parameter specifies a condition that looks for
            messages sent to members of distribution groups, dynamic
            distribution groups, or mail-enabled security groups. You can use
            any value that uniquely identifies the group.
          required: false
          isArray: true
          defaultValue: ""
          predefined:
            - ""
      outputs: []
    - name: o365-atp-safe-links-rule-update
      description: description
      deprecated: false
      arguments:
        - name: name
          description: The Name parameter specifies a unique name for the Safe Links rule.
          required: true
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: safe_links_policy
          description: The SafeLinksPolicy parameter specifies the Safe Links policy
            that's associated with this Safe Links rule.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: comments
          description: The Comments parameter specifies informative comments for the rule,
            such as what the rule is used for or how it has changed over time.
            The length of the comment can't exceed 1024 characters.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: enabled
          description: Whether the rule is enabled.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - true,false
        - name: except_if_recipient_domain_is
          description: The ExceptIfRecipientDomainIs parameter specifies an exception that
            looks for recipients with email address in the specified domains.
          required: false
          isArray: true
          defaultValue: ""
          predefined:
            - ""
        - name: except_if_sent_to
          description: The ExceptIfSentTo parameter specifies an exception that looks for
            recipients in messages.
          required: false
          isArray: true
          defaultValue: ""
          predefined:
            - ""
        - name: except_if_sent_to_member_of
          description: The ExceptIfSentToMemberOf parameter specifies an exception that
            looks for messages sent to members of groups.
          required: false
          isArray: true
          defaultValue: ""
          predefined:
            - ""
        - name: priority
          description: The Priority parameter specifies a priority value for the rule that
            determines the order of rule processing. A lower integer value
            indicates a higher priority, the value 0 is the highest priority,
            and rules can't have the same priority value.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: recipient_domain_is
          description: The RecipientDomainIs parameter specifies a condition that looks
            for recipients with email address in the specified domains.
          required: false
          isArray: true
          defaultValue: ""
          predefined:
            - ""
        - name: sent_to
          description: The SentTo parameter specifies a condition that looks for
            recipients in messages. You can use any value that uniquely
            identifies the recipient.
          required: false
          isArray: true
          defaultValue: ""
          predefined:
            - ""
        - name: sent_to_member_of
          description: The SentToMemberOf parameter specifies a condition that looks for
            messages sent to members of distribution groups, dynamic
            distribution groups, or mail-enabled security groups. You can use
            any value that uniquely identifies the group.
          required: false
          isArray: true
          defaultValue: ""
          predefined:
            - ""
      outputs: []
  isfetch: false
  runonce: false
  script: "-"
  type: powershell
  dockerimage: demisto/pwsh-exchange:1.0.0.22307
fromversion: 5.5.0
tests: null
