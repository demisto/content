category: Network Security
commonfields:
  id: Microsoft 365 Defender
  version: -1
configuration:
  - name: _app_id
    display: Application ID
    required: false
    defaultvalue: 9093c354-630a-47f1-b087-6768eb9427e6
    type: 0
    additionalinfo: The API key to use to connect.
  - name: base_url
    display: Endpoint URI
    required: true
    defaultvalue: https://api.security.microsoft.com
    type: 0
    additionalinfo: |-
      The United States: api-us.security.microsoft.com
      Europe: api-eu.security.microsoft.com
      The United Kingdom: api-uk.security.microsoft.co
  - name: client_credentials
    display: Use Client Credentials Authorization Flow
    required: false
    defaultvalue: "true"
    type: 8
    additionalinfo: Use a self-deployed Azure application and authenticate using the
      Client Credentials flow.
  - name: _tenant_id
    display: Tenant ID (for Client Credentials mode)
    required: false
    defaultvalue: null
    type: 0
    additionalinfo: null
  - name: credentials
    display: Client Secret (for Client Credentials mode)
    required: false
    defaultvalue: null
    type: 9
    additionalinfo: null
    displaypassword: ""
    hiddenusername: true
  - name: authentication_type
    display: Authentication Type
    required: false
    defaultvalue: Device
    type: 15
    additionalinfo: ""
    options: []
  - name: private_key
    display: Private Key
    required: false
    defaultvalue: null
    type: 14
    additionalinfo: Used for certificate authentication. The private key of the
      registered certificate.
  - name: first_fetch
    display: First fetch timestamp (<number> <time unit>, e.g., 12 hours, 7 days)
    required: false
    defaultvalue: 12 hours
    type: 0
    additionalinfo: null
  - name: fetch_timeout
    display: Fetch incidents timeout
    required: false
    defaultvalue: "30"
    type: 0
    additionalinfo: The time limit in seconds for fetch incidents to run. Leave this
      empty to cancel the timeout limit.
  - name: max_fetch
    display: Number of incidents for each fetch.
    required: false
    defaultvalue: "10"
    type: 0
    additionalinfo: Due to API limitations, the maximum is 100.
  - name: incidentType
    display: Incident type
    required: false
    defaultvalue: Microsoft 365 Defender Incident
    type: 13
    additionalinfo: null
  - name: isFetch
    display: Fetch incidents
    required: false
    defaultvalue: "true"
    type: 8
    additionalinfo: null
  - name: insecure
    display: Trust any certificate (not secure)
    required: false
    defaultvalue: "true"
    type: 8
    additionalinfo: null
  - name: proxy
    display: Use system proxy settings
    required: false
    defaultvalue: "true"
    type: 8
    additionalinfo: null
  - name: app_id
    display: Application ID (Deprecated)
    required: false
    defaultvalue: null
    type: 4
    additionalinfo: null
  - name: tenant_id
    display: Tenant ID (for Client Credentials mode) (Deprecated)
    required: false
    defaultvalue: null
    type: 4
    additionalinfo: null
  - name: enc_key
    display: Client Secret (for Client Credentials mode) (Deprecated)
    required: false
    defaultvalue: null
    type: 4
    additionalinfo: null
  - name: incidentFetchInterval
    display: Incidents Fetch Interval
    required: false
    defaultvalue: "1"
    type: 19
    additionalinfo: null
description: Microsoft 365 Defender is a unified pre- and post-breach enterprise
  defense suite that natively coordinates detection, prevention, investigation,
  and response across endpoints, identities, email, and applications to provide
  integrated protection against sophisticated attacks.
display: Microsoft 365 Defender
name: Microsoft 365 Defender
script:
  commands:
    - arguments: []
      description: Run this command to start the authorization process and follow the
        instructions in the command results. (for device-code mode)
      name: microsoft-365-defender-auth-start
      outputs: []
    - arguments: []
      description: Run this command to complete the authorization process. Should be
        used after running the microsoft-365-defender-auth-start command. (for
        device-code mode)
      name: microsoft-365-defender-auth-complete
      outputs: []
    - arguments: []
      description: Run this command if you need to rerun the authentication process.
        (for device-code mode)
      name: microsoft-365-defender-auth-reset
      outputs: []
    - arguments: []
      description: Tests the connectivity to the Microsoft 365 Defender.
      name: microsoft-365-defender-auth-test
      outputs: []
    - arguments:
        - auto: PREDEFINED
          description: Categorize incidents (as Active, Resolved, or Redirected).
          name: status
          predefined:
            - Active
            - Resolved
            - Redirected
        - description: Owner of the incident.
          name: assigned_to
        - defaultValue: "100"
          description: Number of incidents in the list. Maximum is 100.
          name: limit
        - description: Number of entries to skip.
          name: offset
        - defaultValue: "30"
          description: The time limit in seconds for the http request to run.
          name: timeout
      description: Get the most recent incidents.
      name: microsoft-365-defender-incidents-list
      outputs:
        - contextPath: Microsoft365Defender.Incident.incidentId
          description: Incident's ID.
          type: Number
        - contextPath: Microsoft365Defender.Incident.redirectIncidentId
          description: Only populated in case an incident is grouped together with another
            incident, as part of the incident processing logic.
          type: Unknown
        - contextPath: Microsoft365Defender.Incident.incidentName
          description: The name of the incident.
          type: String
        - contextPath: Microsoft365Defender.Incident.createdTime
          description: The date and time (in UTC) the incident was created.
          type: Date
        - contextPath: Microsoft365Defender.Incident.lastUpdateTime
          description: The date and time (in UTC) the incident was last updated.
          type: Date
        - contextPath: Microsoft365Defender.Incident.assignedTo
          description: Owner of the incident.
          type: String
        - contextPath: Microsoft365Defender.Incident.classification
          description: "Specification of the incident. Possible values are: Unknown,
            FalsePositive, and TruePositive."
          type: String
        - contextPath: Microsoft365Defender.Incident.determination
          description: "The determination of the incident. Possible values are:
            NotAvailable, Apt, Malware, SecurityPersonnel, SecurityTesting,
            UnwantedSoftware, and Other."
          type: String
        - contextPath: Microsoft365Defender.Incident.status
          description: "The current status of the incident. Possible values are: Active,
            Resolved, and Redirected."
          type: String
        - contextPath: Microsoft365Defender.Incident.severity
          description: "Severity of the incident. Possible values are: UnSpecified,
            Informational, Low, Medium, and High."
          type: String
        - contextPath: Microsoft365Defender.Incident.alerts
          description: List of alerts relevant for the incidents.
          type: Unknown
    - arguments:
        - auto: PREDEFINED
          description: Categorize incidents (as Active, Resolved, or Redirected).
          name: status
          predefined:
            - Active
            - Resolved
            - Redirected
        - description: Owner of the incident.
          name: assigned_to
        - description: Incident's ID.
          name: id
          required: true
        - auto: PREDEFINED
          description: The specification for the incident.
          name: classification
          predefined:
            - Unknown
            - FalsePositive
            - TruePositive
        - description: Comment to be added to the incident.
          name: comment
        - auto: PREDEFINED
          description: Determination of the incident.
          name: determination
          predefined:
            - NotAvailable
            - Apt
            - Malware
            - SecurityPersonnel
            - SecurityTesting
            - UnwantedSoftware
            - Other.
        - description: "A comma-separated list of custom tags associated with an incident.
            For example: tag1,tag2,tag3."
          isArray: true
          name: tags
        - defaultValue: "30"
          description: The time limit in seconds for the http request to run.
          name: timeout
      description: Update the incident with the given ID.
      name: microsoft-365-defender-incident-update
      outputs:
        - contextPath: Microsoft365Defender.Incident.incidentId
          description: Incident's ID.
          type: Number
        - contextPath: Microsoft365Defender.Incident.redirectIncidentId
          description: Only populated in case an incident is grouped together with another
            incident, as part of the incident processing logic.
          type: Unknown
        - contextPath: Microsoft365Defender.Incident.incidentName
          description: The name of the incident.
          type: String
        - contextPath: Microsoft365Defender.Incident.createdTime
          description: The date and time (in UTC) the incident was created.
          type: Date
        - contextPath: Microsoft365Defender.Incident.lastUpdateTime
          description: The date and time (in UTC) the incident was last updated.
          type: Date
        - contextPath: Microsoft365Defender.Incident.assignedTo
          description: Owner of the incident.
          type: String
        - contextPath: Microsoft365Defender.Incident.classification
          description: "Specification of the incident. Possible values are: Unknown,
            FalsePositive, and TruePositive."
          type: String
        - contextPath: Microsoft365Defender.Incident.determination
          description: "The determination of the incident. Possible values are:
            NotAvailable, Apt, Malware, SecurityPersonnel, SecurityTesting,
            UnwantedSoftware, and Other."
          type: String
        - contextPath: Microsoft365Defender.Incident.severity
          description: "Severity of the incident. Possible values are: UnSpecified,
            Informational, Low, Medium, and High."
          type: String
        - contextPath: Microsoft365Defender.Incident.status
          description: "The current status of the incident. Possible values are: Active,
            Resolved, and Redirected."
          type: String
        - contextPath: Microsoft365Defender.Incident.alerts
          description: List of alerts relevant for the incidents.
          type: Unknown
    - arguments:
        - description: Advanced hunting query.
          name: query
          required: true
        - defaultValue: "30"
          description: The time limit in seconds for the http request to run.
          name: timeout
        - defaultValue: "50"
          description: Number of entries.  Enter -1 for unlimited query.
          name: limit
          required: true
      description: "Advanced hunting is a threat-hunting tool that uses specially
        constructed queries to examine the past 30 days of event data in
        Microsoft 365 Defender. Details on how to write queries:
        https://docs.microsoft.com/en-us/microsoft-365/security/defender/advanc\
        ed-hunting-query-language?view=o365-worldwide."
      name: microsoft-365-defender-advanced-hunting
      outputs:
        - contextPath: Microsoft365Defender.Hunt.query
          description: The query used, also acted as a key.
          type: String
        - contextPath: Microsoft365Defender.Hunt.results.
          description: The results of the query.
          type: Unknown
    - arguments:
        - description: Incident's ID.
          name: id
          required: true
        - defaultValue: "30"
          description: The time limit in seconds for the http request to run.
          name: timeout
      description: Gets the incident with the given ID.
      name: microsoft-365-defender-incident-get
      outputs:
        - contextPath: Microsoft365Defender.Incident.incidentId
          description: Incident's ID.
          type: number
        - contextPath: Microsoft365Defender.Incident.redirectIncidentId
          description: Only populated in case an incident is grouped together with another
            incident, as part of the incident processing logic.
        - contextPath: Microsoft365Defender.Incident.incidentName
          description: The name of the incident.
          type: string
        - contextPath: Microsoft365Defender.Incident.createdTime
          description: The date and time (in UTC) the incident was created.
          type: date
        - contextPath: Microsoft365Defender.Incident.lastUpdateTime
          description: The date and time (in UTC) the incident was last updated.
          type: date
        - contextPath: Microsoft365Defender.Incident.assignedTo
          description: Owner of the incident.
          type: string
        - contextPath: Microsoft365Defender.Incident.classification
          description: "Specification of the incident. Possible values are: Unknown,
            FalsePositive, and TruePositive."
          type: string
        - contextPath: Microsoft365Defender.Incident.determination
          description: "The determination of the incident. Possible values are:
            NotAvailable, Apt, Malware, SecurityPersonnel, SecurityTesting,
            UnwantedSoftware, and Other."
          type: string
        - contextPath: Microsoft365Defender.Incident.severity
          description: "Severity of the incident. Possible values are: UnSpecified,
            Informational, Low, Medium, and High."
          type: string
        - contextPath: Microsoft365Defender.Incident.status
          description: "The current status of the incident. Possible values are: Active,
            Resolved, and Redirected."
          type: string
        - contextPath: Microsoft365Defender.Incident.alerts
          description: List of alerts relevant for the incidents.
  dockerimage: demisto/crypto:1.0.0.31715
  isfetch: true
  runonce: false
  script: ""
  subtype: python3
  type: python
fromversion: 5.5.0
tests:
  - No tests
defaultmapperin: Microsoft 365 Defender - Incoming Mapper
