 alert_category: EXECUTION
  alert_description: null
  alert_fields:
    actor_image: null
    actor_path: xdm.target.file.path
    cmd: null
    domain: xdm.source.user.domain
    hash: xdm.target.file.sha256
    hostname: xdm.target.host.fqdn
    local_ip: xdm.target.ipv4
    remote_ip: null
    remote_port: null
    username: xdm.source.user.username
  alert_name: Malware detected by Microsoft Defender for Endpoints
  crontab: null
  dataset: alerts
  description: This alert will trigger in an event where Malware detected by Microsoft
    Defender for Endpoints
  drilldown_query_timeframe: ALERT
  execution_mode: REAL_TIME
  global_rule_id: f218be3f-4f94-4fd1-8cc1-bddd8f1c3e50
  investigation_query_link: null
  mapping_strategy: CUSTOM
  mitre_defs: {}
  name: Microsoft Defender for Endpoint - Malware Detected
  search_window: null
  severity: SEV_040_HIGH
  suppression_duration: null
  suppression_enabled: false
  suppression_fields: null
  user_defined_category: null
  user_defined_severity: null
  xql_query: "datamodel dataset in (microsoft_365_defender_raw) \r\n| filter (xdm.alert.category\
    \ = \"\"\"Malware\"\"\") and xdm.target.file.sha256 != null\r\n|fields \r\n  \
    \  xdm.event.id,\r\n    xdm.alert.original_alert_id,\r\n    xdm.alert.severity,\r\
    \n    xdm.observer.product,\r\n    xdm.alert.category,\r\n    xdm.alert.subcategory,\r\
    \n    xdm.alert.name,\r\n    xdm.alert.description,\r\n    xdm.target.host.device_id,\r\
    \n    xdm.target.host.fqdn,\r\n    xdm.alert.mitre_techniques,\r\n    xdm.target.file.sha256,\r\
    \n    xdm.target.file.filename,\r\n    xdm.target.file.path,\r\n    xdm.target.process.pid,\r\
    \n    xdm.target.process.command_line,\r\n    xdm.target.process.parent_id,\r\n\
    \    xdm.target.host.ipv4_addresses,\r\n    xdm.target.registry.key,\r\n    xdm.target.registry.value_type,\r\
    \n    xdm.target.registry.value,\r\n    xdm.source.user.username,\r\n    xdm.source.user.domain,\r\
    \n    xdm.source.user.identifier,\r\n    xdm.target.ipv4,\r\n    xdm.event.outcome"
