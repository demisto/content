commonfields:
  id: F5 firewall
  version: -1
name: F5 firewall
display: F5 firewall
category: Network Security
description: Manages F5 firewall rules
configuration:
- display: URL
  name: url
  defaultvalue: ""
  type: 0
  required: true
- display: Port
  name: port
  defaultvalue: "34993"
  type: 0
  required: false
- display: Credentials
  name: credentials
  defaultvalue: ""
  type: 9
  required: true
- display: Advanced login - set to true to authenticate via LDAP, AD etc
  name: advancedLogin
  defaultvalue: "false"
  type: 8
  required: false
- display: Trust any certificate (not secure)
  name: insecure
  defaultvalue: ""
  type: 8
  required: false
- display: Use system proxy settings
  name: proxy
  defaultvalue: ""
  type: 8
  required: false
script:
  script: ''
  type: javascript
  commands:
  - name: f5-create-policy
    arguments:
    - name: name
      required: true
      description: The name of the policy to create
    - name: description
      required: true
      description: The description of the policy
    - name: copyFrom
      description: The policy to copy rules from to use as template for new policy
    - name: partition
      description: 'The partition (Default: Common)'
    description: Creates an F5 firewall policy.
  - name: f5-create-rule
    arguments:
    - name: policy-name
      required: true
      default: true
      description: The policy name the rule will be associated with.
    - name: ruleList
      description: Specifies a list of rules to evaluate. See security firewall rule-list.
        If a rule-list is specified then only the schedule and status properties effect
        the rule.
    - name: name
      description: The rule name
    - name: status
      description: enabled, disabled or scheduled
    - name: ipProtocol
      description: lowercase version of protocol listed in the UI
    - name: action
      description: accept, drop, reject
    - name: placeBefore
      description: first
    - name: source
      description: the ip sources in csv format
    - name: destination
      description: the ip destinations in csv format
    description: Creates a rule in a specific policy
  - name: f5-list-rules
    arguments:
    - name: policy-name
      required: true
      default: true
      description: The policy name that the rules displayed are associated with
    description: Lists all the rules of a specific policy.
  - name: f5-modify-rule
    arguments:
    - name: policy-name
      required: true
      default: true
      description: The policy name the rule is associated with.
    - name: rule-name
      required: true
      description: The rule name to modify.
    - name: action
      description: accept, drop, reject
    - name: ipProtocol
      description: one of any described in the UI, but in all lowercase
    - name: placeBefore
      description: first or...
    - name: source
      description: csv list of sources
    - name: destination
      description: csv list of destinations
    description: Modifies an F5 rule in a specific policy
  - name: f5-del-rule
    arguments:
    - name: policy-name
      required: true
      default: true
      description: The policy name the rule is associated with.
    - name: rule-name
      required: true
      description: The name of the rule to delete.
    description: Delete an F5 firewall rule.
  - name: f5-modify-global-policy
    arguments:
    - name: enforcedPolicy
      required: true
      default: true
      description: The new enforced policy to add to the global policy.
    description: Adds the specific policy to a global policy.
  - name: f5-show-global-policy
    arguments: []
    description: Display global policy.
  - name: f5-del-policy
    arguments:
    - name: policy-name
      required: true
      default: true
      description: The name of the policy to delete.
    description: Delete a policy.
  - name: f5-list-all-user-sessions
    arguments:
    - name: resource-ip
      required: true
      description: Client IP address.
    description: Lists all the sessions with client IP for the given username.
  runonce: false
tests:
- No tests
fromversion: 5.0.0
