id: PICUS - Attack Validation Automation
version: -1
name: PICUS - Attack Validation Automation
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: e453877e-3988-451d-802f-d3667b99b708
    type: start
    task:
      id: e453877e-3988-451d-802f-d3667b99b708
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "8"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 65
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "1":
    id: "1"
    taskid: bc27f5a0-5dc8-4a2f-8a60-e21b1d991756
    type: regular
    task:
      id: bc27f5a0-5dc8-4a2f-8a60-e21b1d991756
      version: -1
      name: Get Vector List
      description: Get Vector List
      script: '|||Picus_getVectorList'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 430,
          "y": 410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "2":
    id: "2"
    taskid: 7eb453df-7eab-4dea-8705-7e9befb1182b
    type: regular
    task:
      id: 7eb453df-7eab-4dea-8705-7e9befb1182b
      version: -1
      name: Set Parameter
      description: Set Parameter for running playbook
      script: PicusIntegration|||Picus_setParamPB
      type: regular
      iscommand: true
      brand: PicusIntegration
    nexttasks:
      '#none#':
      - "10"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "3":
    id: "3"
    taskid: 658d3512-038c-42c6-8363-a58bf000cf3a
    type: regular
    task:
      id: 658d3512-038c-42c6-8363-a58bf000cf3a
      version: -1
      name: Get Secure Attacks
      description: Get secure attack results
      script: '|||Picus_getAttackResults'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      attacker_peer:
        simple: ${Picus.param.attacker_peer}
      days:
        simple: ${Picus.param.days}
      result:
        simple: secure
      victim_peer:
        simple: ${Picus.param.victim_peer}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -330,
          "y": 1620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "4":
    id: "4"
    taskid: 5d8e53e5-2bc7-4a27-84ec-0e3cfe19c174
    type: regular
    task:
      id: 5d8e53e5-2bc7-4a27-84ec-0e3cfe19c174
      version: -1
      name: Run Attacks
      description: Run attacks on Picus based on previous task results
      script: '|||Picus_runAttacks'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      attacker_peer:
        simple: ${Picus.param.attacker_peer}
      threat_ids:
        simple: ${Picus.attackresults}
      variant:
        simple: ${Picus.param.variant}
      victim_peer:
        simple: ${Picus.param.victim_peer}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2260
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "5":
    id: "5"
    taskid: 3e2f0634-56ad-497b-80d8-8e0e68e1a765
    type: regular
    task:
      id: 3e2f0634-56ad-497b-80d8-8e0e68e1a765
      version: -1
      name: Get Threat Results
      description: Get threat results of played attacks
      script: '|||Picus_getThreatResults'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      attacker_peer:
        simple: ${Picus.param.attacker_peer}
      threat_ids:
        simple: ${Picus.runattacks}
      variant:
        simple: ${Picus.param.variant}
      victim_peer:
        simple: ${Picus.param.victim_peer}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3000
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "6":
    id: "6"
    taskid: 8b61e6ac-1bd9-484c-886a-6eb52339511b
    type: regular
    task:
      id: 8b61e6ac-1bd9-484c-886a-6eb52339511b
      version: -1
      name: Filter Insecure Attacks
      description: Filter insecure attacks
      script: '|||filter-insecure-attacks'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      threatinfo:
        simple: ${Picus.threatresults}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "7":
    id: "7"
    taskid: 4b4fae17-ae6e-4051-84ce-aeee67dd7def
    type: regular
    task:
      id: 4b4fae17-ae6e-4051-84ce-aeee67dd7def
      version: -1
      name: Get Mitigations
      description: Get mitigation list for insecure results
      script: '|||Picus_getMitigationList'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "24"
    scriptarguments:
      product:
        simple: ${Picus.param.mitigation_product}
      threat_ids:
        simple: ${Picus.filterinsecure}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "8":
    id: "8"
    taskid: bd7a593e-5f80-4c08-8295-be6e18d6af41
    type: title
    task:
      id: bd7a593e-5f80-4c08-8295-be6e18d6af41
      version: -1
      name: Preparation
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "9"
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "9":
    id: "9"
    taskid: e07724d6-8a26-400c-86a0-0a8ecaaf810f
    type: regular
    task:
      id: e07724d6-8a26-400c-86a0-0a8ecaaf810f
      version: -1
      name: Get Peer List
      description: Get Peer List
      script: '|||Picus_getPeerList'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -330,
          "y": 410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "10":
    id: "10"
    taskid: 0fb64ee5-01ae-43b0-823c-66a5dc89d804
    type: title
    task:
      id: 0fb64ee5-01ae-43b0-823c-66a5dc89d804
      version: -1
      name: Preparation Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "12"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "11":
    id: "11"
    taskid: 7452a611-1a0d-4f5b-8d49-980bcd0a9fcd
    type: regular
    task:
      id: 7452a611-1a0d-4f5b-8d49-980bcd0a9fcd
      version: -1
      name: Paremeter Config
      description: Parameter Config
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 700
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "12":
    id: "12"
    taskid: bb8e7ac7-ff5c-4138-844f-05e724f3c76f
    type: title
    task:
      id: bb8e7ac7-ff5c-4138-844f-05e724f3c76f
      version: -1
      name: Attack Detail
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "13"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1215
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "13":
    id: "13"
    taskid: 7e090f9d-8663-4cab-8858-4598ace126db
    type: condition
    task:
      id: 7e090f9d-8663-4cab-8858-4598ace126db
      version: -1
      name: Get Secure or Insecure Attacks ?
      description: Decide attack result type for fetching result
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      Insecure:
      - "14"
      Secure:
      - "3"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1395
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "14":
    id: "14"
    taskid: 4eb93738-e900-455a-8799-4d86a9228d40
    type: regular
    task:
      id: 4eb93738-e900-455a-8799-4d86a9228d40
      version: -1
      name: Get Insecure Attacks
      description: Get insecure attack results
      script: '|||Picus_getAttackResults'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      attacker_peer:
        simple: ${Picus.param.attacker_peer}
      days:
        simple: ${Picus.param.days}
      result:
        simple: insecure
      victim_peer:
        simple: ${Picus.param.victim_peer}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 430,
          "y": 1620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "15":
    id: "15"
    taskid: 998fcc8c-d31a-46b5-84fe-866d12b3aae3
    type: title
    task:
      id: 998fcc8c-d31a-46b5-84fe-866d12b3aae3
      version: -1
      name: Attack Detail Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "16"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1910
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "16":
    id: "16"
    taskid: 27f9542d-da15-4e55-894f-e5194ca45194
    type: title
    task:
      id: 27f9542d-da15-4e55-894f-e5194ca45194
      version: -1
      name: Run Attack
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "4"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "17":
    id: "17"
    taskid: e51cfbbf-9d98-46ca-8b1a-51e271baee5d
    type: regular
    task:
      id: e51cfbbf-9d98-46ca-8b1a-51e271baee5d
      version: -1
      name: Wait 15 Minutes
      description: wait for the assessment to finish
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "18"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "18":
    id: "18"
    taskid: 849fbe1a-6a99-41b8-8335-59ee5c385784
    type: title
    task:
      id: 849fbe1a-6a99-41b8-8335-59ee5c385784
      version: -1
      name: Run Attack Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "19"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2660
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "19":
    id: "19"
    taskid: 3828a16f-487e-4075-8cd6-ace15a82f22f
    type: title
    task:
      id: 3828a16f-487e-4075-8cd6-ace15a82f22f
      version: -1
      name: Threat Detail
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "5"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2830
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "20":
    id: "20"
    taskid: 2213a9f1-f9fc-4369-8063-bab7369ac2c7
    type: title
    task:
      id: 2213a9f1-f9fc-4369-8063-bab7369ac2c7
      version: -1
      name: Threat Detail Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "21"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "21":
    id: "21"
    taskid: 37b11d18-9de2-44f0-8012-09430d2c348a
    type: title
    task:
      id: 37b11d18-9de2-44f0-8012-09430d2c348a
      version: -1
      name: Mitigation and Vector Results
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "7"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "22":
    id: "22"
    taskid: bb3cba59-7945-460c-8bbe-e7871e17613b
    type: title
    task:
      id: bb3cba59-7945-460c-8bbe-e7871e17613b
      version: -1
      name: Mitigation and Vector Results Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "25"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4375
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "23":
    id: "23"
    taskid: d4eb87b4-016c-419a-8f04-3723ebd7b032
    type: regular
    task:
      id: d4eb87b4-016c-419a-8f04-3723ebd7b032
      version: -1
      name: Get Vector Results
      description: Get vector results
      script: '|||Picus_getVectorCompare'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      attacker_peer:
        simple: ${Picus.param.attacker_peer}
      days:
        simple: ${Picus.param.days}
      victim_peer:
        simple: ${Picus.param.victim_peer}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -330,
          "y": 4170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "24":
    id: "24"
    taskid: ff38e487-2e6d-4c4d-81ab-dc376ff75e50
    type: condition
    task:
      id: ff38e487-2e6d-4c4d-81ab-dc376ff75e50
      version: -1
      name: Get Vector Results ?
      description: decide if you want vector results
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "No":
      - "22"
      "Yes":
      - "23"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3940
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "25":
    id: "25"
    taskid: f6811c94-4040-44b0-828f-c16deac1dc16
    type: title
    task:
      id: f6811c94-4040-44b0-828f-c16deac1dc16
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 4550,
        "width": 1140,
        "x": -330,
        "y": 65
      }
    }
  }
inputs: []
outputs: []
fromversion: 6.0.0
description: Picus Attack Validation Automation
