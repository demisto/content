category: Data Enrichment & Threat Intelligence
sectionOrder:
- Connect
- Collect
commonfields:
  id: MicrosoftDefenderThreatIntelligence
  version: -1

configuration:
- section: Connect
  defaultvalue: 7f55ea8c-2e5c-4a52-aafa-d0bfc632b242
  display: Application ID (Client ID for Client credentials mode)
  name: app_id
  type: 0
  required: false
- section: Connect
  display: Tenant ID (required for Client Credentials mode)
  name: tenant_id
  type: 0
  required: false
- section: Connect
  displaypassword: Client Secret (required for Client Credentials mode)
  name: credentials
  type: 9
  additionalinfo: Client Secret. Required for Client Credentials mode)
  hiddenusername: true
  required: false
- section: Connect
  additionalinfo: Used for certificate authentication. As appears in the "Certificates & secrets" page of the app.
  display: Certificate Thumbprint
  name: creds_certificate
  type: 9
  displaypassword: Private Key
  advanced: true
  required: false
- section: Connect
  additionalinfo: Relevant only if the integration is running on Azure VM. If selected, authenticates based on the value provided for the Azure Managed Identities Client ID field. If no value is provided for the Azure Managed Identities Client ID field, authenticates based on the System Assigned Managed Identity. For additional information, see the Help tab.
  display: Use Azure Managed Identities
  name: use_managed_identities
  type: 8
  required: false
- section: Connect
  additionalinfo: The Managed Identities client ID for authentication - relevant only if the integration is running on Azure VM.
  displaypassword: Azure Managed Identities Client ID
  name: managed_identities_client_id
  hiddenusername: true
  type: 9
  required: false
- section: Connect
  defaultvalue: https://login.microsoftonline.com
  display: Azure AD endpoint
  name: azure_ad_endpoint
  options:
  - https://login.microsoftonline.com
  - https://login.microsoftonline.us
  - https://login.microsoftonline.de
  - https://login.chinacloudapi.cn
  type: 15
  additionalinfo: Azure AD endpoint associated with a national cloud.
  advanced: true
  required: false
- section: Connect
  display: Incident type
  name: incidentType
  type: 13
  required: false
- section: Connect
  additionalinfo: Use a self-deployed Azure application and authenticate using the Client Credentials flow.
  display: Use Client Credentials Authorization Flow
  name: client_credentials
  type: 8
  required: false
- section: Connect
  display: Trust any certificate (not secure)
  name: insecure
  type: 8
  advanced: true
  required: false
- section: Connect
  display: Use system proxy settings
  name: proxy
  type: 8
  advanced: true
  required: false

description: '[Enter a comprehensive, yet concise, description of what the integration does, what use cases it is designed for, etc.]'
display: MicrosoftDefenderThreatIntelligence
name: MicrosoftDefenderThreatIntelligence
script:
  commands:
  - description: Run this command to start the authorization process and follow the instructions in the command results.
    name: msg-defender-threat-intel-auth-start
  - description: "Run this command to complete the authorization process.\nShould be used after running the msgraph-identity-auth-start command."
    name: msg-defender-threat-intel-auth-complete
  - arguments:
    - default: false
      description: '[Enter a description of the argument, including any important information users need to know, for example, default values.]'
      name: article_id
    - defaultvalue: '50'
      description: 'Number of incidents in the list.'
      name: limit
    - default: false
      description: 'Filter incidents using "odata" query.'
      name: odata
    deprecated: false
    description: 'Get articles including their properties and relationships.'
    execution: false
    name: msg-defender-threat-intel-article-list

  - arguments:
    - default: false
      description: '[Enter a description of the argument, including any important information users need to know, for example, default values.]'
      name: article_id
    - default: false
      description: '[Enter a description of the argument, including any important information users need to know, for example, default values.]'
      name: article_indicator_id
    - defaultvalue: '50'
      description: 'Number of incidents in the list.'
      name: limit
    - default: false
      description: 'Filter incidents using "odata" query.'
      name: odata
    deprecated: false
    description: 'Get indicators of threat or compromise related to the contents of an article.'
    execution: false
    name: msg-defender-threat-intel-article-indicators-list

  - arguments:
    - default: false
      description: '[Enter a description of the argument, including any important information users need to know, for example, default values.]'
      name: intel_profile_id
    - default: false
      description: '[Enter a description of the argument, including any important information users need to know, for example, default values.]'
      name: article_indicator_id
    - defaultvalue: '50'
      description: 'Number of incidents in the list.'
      name: limit
    - default: false
      description: 'Filter incidents using "odata" query.'
      name: odata
    deprecated: false
    description: 'Get Intelligence Profiles including their properties and relationships.'
    execution: false
    name: msg-defender-threat-intel-profile-list

  - arguments:
    - default: false
      description: '[Enter a description of the argument, including any important information users need to know, for example, default values.]'
      name: intel_profile_id
    - default: false
      description: '[Enter a description of the argument, including any important information users need to know, for example, default values.]'
      name: intel_profile_indicator_id
    - defaultvalue: '50'
      description: 'Number of incidents in the list.'
      name: limit
    - default: false
      description: 'Filter incidents using "odata" query.'
      name: odata
    deprecated: false
    description: 'Get Intelligence Profiles Indicators and their properties.'
    execution: false
    name: msg-defender-threat-intel-profile-indicators-list

  - arguments:
    - default: false
      description: '[Enter a description of the argument, including any important information users need to know, for example, default values.]'
      name: host_id
      required: true
    - default: false
      description: 'Filter incidents using "odata" query.'
      name: odata
    deprecated: false
    description: 'Read the properties and relationships of a host object.'
    execution: false
    name: msg-defender-threat-intel-host


  - arguments:
    - default: false
      description: 'hostname or IP address.'
      name: host_id
    - default: false
      description: '[Enter a description of the argument, including any important information users need to know, for example, default values.]'
      name: whois_record_id
    - default: false
      description: 'Use "odata" query to customize the response. Supports the $count, $select, $skip, and $top.'
      name: odata
    - default: false
      description: 'Number of records in the list.'
      name: limit
    deprecated: false
    description: 'Get the specified whoisRecord resource.'
    execution: false
    name: msg-defender-threat-intel-host-whois

  - arguments:
    - default: false
      description: 'hostname or IP address.'
      name: host_id
    - default: false
      description: '[Enter a description of the argument, including any important information users need to know, for example, default values.]'
      name: whois_record_id
    - default: false
      description: '[Enter a description of the argument, including any important information users need to know, for example, default values.]'
      name: whois_history_record_id
    - default: false
      description: 'Use "odata" query to customize the response. Supports the $count, $select, $skip, and $top.'
      name: odata
    - default: false
      description: 'Number of records in the list.'
      name: limit
    deprecated: false
    description: 'Get the history for a whoisRecord, as represented by a collection of whoisHistoryRecord resources.'
    execution: false
    name: msg-defender-threat-intel-host-whois-history

    outputs:
    - contextPath: BaseIntegration.Output
      description: '[Enter a description of the data returned in this output.]'
      type: String
  isfetch: false
  runonce: false
  script: '-'
  type: python
  subtype: python3
  dockerimage: demisto/crypto:1.0.0.3539024
fromversion: 6.1.0
marketplaces:
- xsoar
- marketplacev2
tests:
- No tests (auto formatted)
