category: Utilities
commonfields:
  id: Sysdig
  version: -1
configuration:
- defaultvalue: https://us2.app.sysdig.com/
  display: Server URL (e.g., https://us2.app.sysdig.com)
  name: url
  required: true
  type: 0
- display: Sysdig Monitor API Key
  name: monitorkey
  required: true
  type: 4
- display: Sysdig Secure API Key
  name: securekey
  required: true
  type: 4
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
description: Security for containers, Kubernetes, and cloud.
display: Sysdig
name: Sysdig
script:
  commands:
  - arguments: []
    description: Returns existing alerts
    name: sysdig-get-alerts
  - arguments: []
    description: Returns current metrics
    name: sysdig-get-metrics
  - arguments: []
    description: Lists sysdig users
    name: sysdig-get-users
    outputs:
    - contextPath: Sysdig.UserInfo.TeamRoles.admin
      description: Admin (true/false)
      type: boolean
    - contextPath: Sysdig.UserInfo.TeamRoles.role
      description: User role
      type: string
    - contextPath: Sysdig.UserInfo.TeamRoles.teamId
      description: Team Id
      type: string
    - contextPath: Sysdig.UserInfo.TeamRoles.teamName
      description: Team name
      type: string
    - contextPath: Sysdig.UserInfo.TeamRoles.teamTheme
      description: Team theme
      type: string
    - contextPath: Sysdig.UserInfo.TeamRoles.userId
      description: User id
      type: string
    - contextPath: Sysdig.UserInfo.TeamRoles.userName
      description: User name
      type: string
  - arguments:
    - defaultValue: "86400"
      description: Duration in seconds
      name: duration
    - defaultValue: "100"
      description: Number of hosts to return
      name: count
    - auto: PREDEFINED
      defaultValue: "no"
      description: Set to 'yes' to return raw json results
      name: print_json
      predefined:
      - "yes"
      - "no"
    description: Lists container hosts
    name: sysdig-list-hosts
    outputs:
    - contextPath: Sysdig.HostCount.Count
      description: Count of hosts
      type: number
    - contextPath: Sysdig.HostCount.DateAdded
      description: Date added
      type: date
    - contextPath: Sysdig.HostCount.Host
      description: Hostname
      type: string
  - arguments:
    - auto: PREDEFINED
      defaultValue: All
      description: Name of container event
      name: eventName
      predefined:
      - All
      - Container out of memory
      - Container died
      - Container Killed
      - Back Off Container Start or Image Pull
      - Container Unhealthy
      - Free Disk Space Failed
      - FailedScheduling
      - Killing Container
      - Pod Deleted
      - Scaling Replica Set
      - Pod Created
      - Container Image Pull
      - Create or Start Failed
      - Pod Create Failed
      - Updated load balancer with new hosts
      - Error updating load balancer with new hosts
      - Node Ready
      - Node Registered
      - Starting Kubelet
      - Removing Node
      - Deleting Node
      - Node not Ready
      - Node Rebooted
    - defaultValue: "100"
      description: Max number of results to return
      name: limit
    description: List container events
    name: sysdig-get-events
    outputs:
    - contextPath: Sysdig.Events.EventDescription
      description: Event description
      type: string
    - contextPath: Sysdig.Events.EventName
      description: Event name
      type: string
    - contextPath: Sysdig.Events.CreatedOn
      description: Date created
      type: date
    - contextPath: Sysdig.Events.EventType
      description: Event type
      type: string
    - contextPath: Sysdig.Events.EventId
      description: Event Id
      type: string
    - contextPath: Sysdig.Events.EventSource
      description: Event source
      type: string
    - contextPath: Sysdig.Events.Timestamp
      description: Timestamp
      type: date
    - contextPath: Sysdig.Events.EventSeverity
      description: Event severity
      type: string
    - contextPath: Sysdig.Events.EventScope
      description: Event scope
      type: string
    - contextPath: Sysdig.Events.EventVersion
      description: Event version
      type: string
  - arguments: []
    description: List sysdig policies
    name: sysdig-list-policies
    outputs:
    - contextPath: Sysdig.Policies.Description
      description: Description
      type: string
    - contextPath: Sysdig.Policies.Name
      description: Name of policy
      type: string
  - arguments:
    - defaultValue: "100"
      description: Max number of vulnerabilities to return.
      name: limit
    - auto: PREDEFINED
      defaultValue: all
      description: Type of workload to query for vulnerabilities
      name: workloadType
      predefined:
      - all
      - daemonset
      - deployment
      - statefulset
      - pod
      - replicaset
    - auto: PREDEFINED
      defaultValue: "no"
      description: Return csv output
      name: csv
      predefined:
      - "yes"
      - "no"
    description: List container vulnerabilities
    name: sysdig-list-vulnerabilities
    outputs:
    - contextPath: Sysdig.ContainerVulns.policyEvaluationsResult
      description: Policy Evaluations Result
    - contextPath: Sysdig.ContainerVulns.exploitCount
      description: Count of exploits
      type: unknown
    - contextPath: Sysdig.ContainerVulns.storedAt
      description: Time stored
      type: string
    - contextPath: Sysdig.ContainerVulns.imageId
      description: Image Id
      type: string
    - contextPath: Sysdig.ContainerVulns.resultId
      description: Result Id
      type: string
    - contextPath: Sysdig.ContainerVulns.runningVulnsBySev
      description: Running vulnerabilities by severity
    - contextPath: Sysdig.ContainerVulns.vulnsBySev
      description: Vulnerabilities by severity
  - arguments:
    - description: ID of container image to query (results from sysdig-list-policies)
      name: resultId
      required: true
    - defaultValue: "20"
      description: Number of results to return
      name: limit
    description: List individual vulnerabilities by container or pod
    name: sysdig-list-vulns-by-container
    outputs:
    - contextPath: Sysdig.ContainerVulns.vuln_cvssScore
      description: CVSS score
      type: string
    - contextPath: Sysdig.ContainerVulns.package_name
      description: Name of vulnerable package
      type: string
    - contextPath: Sysdig.ContainerVulns.vuln_cvssVersion
      description: CVSS version
      type: string
    - contextPath: Sysdig.ContainerVulns.vuln_exploitable
      description: Is the vulnerability exploitable?
      type: boolean
    - contextPath: Sysdig.ContainerVulns.vuln_name
      description: Name of vulnerability
      type: string
    - contextPath: Sysdig.ContainerVulns.package_type
      description: Package type
      type: string
    - contextPath: Sysdig.ContainerVulns.package_id
      description: Package Id
      type: string
    - contextPath: Sysdig.ContainerVulns.vuln_disclosureDate
      description: Vulnerability disclosure date
      type: date
    - contextPath: Sysdig.ContainerVulns.id
      description: Id
      type: string
    - contextPath: Sysdig.ContainerVulns.package_version
      description: Package version
      type: string
    - contextPath: Sysdig.ContainerVulns.fixedInVersion
      description: Fixed version
      type: string
  dockerimage: demisto/sysdig:1.0
  runonce: false
  script: ''
  subtype: python3
  type: python
fromversion: 6.0.0
tests:
- No tests (auto formatted)
