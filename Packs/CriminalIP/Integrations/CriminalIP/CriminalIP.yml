category: Data Enrichment & Threat Intelligence
sectionOrder:
- Connect
commonfields:
  id: CriminalIP
  version: -1
configuration:
- displaypassword: API Key
  additionalinfo: The API Key to use for connection.
  name: credentials
  required: false
  hiddenusername: true
  section: Connect
  type: 9
- display: Trust any certificate (not secure)
  name: insecure
  type: 8
  required: false
  additionalinfo: When set to true, SSL certificates will not be validated.
- display: Use system proxy settings
  name: proxy
  type: 8
  required: false
  additionalinfo: Use the system proxy settings to communicate with the API.
- display: Request timeout (seconds)
  name: request_timeout
  type: 0
  required: false
  additionalinfo: Timeout for HTTP requests in seconds. Default is 30.
  defaultvalue: "30"
description: |
  Criminal IP is a comprehensive cyber threat intelligence solution that provides actionable insights into IP addresses, domains, and connected assets across the internet.
  It enables organizations to detect malicious indicators, assess asset reputation, and enhance threat detection by integrating enriched threat data directly into security operations via the XSOAR interface.
name: CriminalIP
display: Criminal IP
script:
  script: '-'
  type: python
  subtype: python3
  dockerimage: demisto/python3:3.12.11.4417419
  runonce: false
  isfetch: false
  commands:
  - name: criminal-ip-ip-report
    description: Provides detailed information about IP addresses through Criminal IP's API.
    arguments:
    - name: ip
      description: The IP address to search.
      required: true
      default: true
      type: String
    outputs:
    - contextPath: CriminalIP.IP
      description: Returns search results. For detailed information, see /v1/asset/ip/report.
      type: String

  - name: criminal-ip-check-malicious-ip
    description: Determines whether an IP is malicious or safe through Criminal IP Asset Search.
    arguments:
    - name: ip
      description: IP address to check.
      required: true
      default: true
      type: String
    - name: enable_vpn
      description: Include VPN usage in evaluation (default true).
      required: false
      type: Boolean
    - name: enable_cloud
      description: Include cloud usage in evaluation (default true).
      required: false
      type: Boolean
    - name: enable_tor
      description: Include TOR usage in evaluation (default true).
      required: false
      type: Boolean
    - name: enable_proxy
      description: Include proxy usage in evaluation (default true).
      required: false
      type: Boolean
    - name: enable_hosting
      description: Include hosting usage in evaluation (default true).
      required: false
      type: Boolean
    - name: enable_mobile
      description: Include mobile usage in evaluation (default true).
      required: false
      type: Boolean
    - name: enable_darkweb
      description: Include dark web in evaluation (default true).
      required: false
      type: Boolean
    - name: enable_scanner
      description: Include scanner usage in evaluation (default true).
      required: false
      type: Boolean
    - name: enable_snort
      description: Include Snort usage in evaluation (default true).
      required: false
      type: Boolean
    - name: enable_anonymous_vpn
      description: Include anonymous VPN usage in evaluation (default true).
      required: false
      type: Boolean
    outputs:
    - contextPath: CriminalIP.Mal_IP
      description: Returns the judgment result and, if present, the Real IP list.
      type: String

  - name: criminal-ip-domain-quick-scan
    description: Performs a Domain Quick Scan using Criminal IP's API.
    arguments:
    - name: domain
      description: The domain to perform a Quick Scan.
      required: true
      default: true
      type: String
    outputs:
    - contextPath: CriminalIP.Domain_Quick
      description: Provides Domain Quick Scan results. See /v1/domain/quick/hash/view.
      type: String

  - name: criminal-ip-domain-lite-scan
    description: Initiates a Domain Lite Scan and returns a scan_id.
    arguments:
    - name: domain
      description: The domain to perform a Lite Scan.
      required: true
      default: true
      type: String
    outputs:
    - contextPath: CriminalIP.Domain_Lite
      description: Returns the result of /v1/domain/lite/scan.
      type: String

  - name: criminal-ip-domain-lite-scan-status
    description: Checks the progress of the Lite Scan.
    arguments:
    - name: scan_id
      description: The scan_id whose Lite Scan progress to check.
      required: true
      default: true
      type: String
    outputs:
    - contextPath: CriminalIP.Domain_Lite_Status
      description: Returns the result of /v1/domain/lite/progress.
      type: String

  - name: criminal-ip-domain-lite-scan-result
    description: Returns the Lite Scan results for the given scan_id.
    arguments:
    - name: scan_id
      description: The scan_id whose Lite Scan result to fetch.
      required: true
      default: true
      type: String
    outputs:
    - contextPath: CriminalIP.Domain_Lite_Result
      description: Returns the result of /v1/domain/lite/report/{id}.
      type: String

  - name: criminal-ip-check-last-scan-date
    description: Checks whether a Full Scan for the domain exists within the last 7 days and returns the latest scan_id if it exists.
    arguments:
    - name: domain
      description: The domain to check scan history.
      required: true
      default: true
      type: String
    outputs:
    - contextPath: CriminalIP.Scan_Date
      description: Indicates whether a scan exists within the last 7 days and returns the latest scan_id.
      type: String

  - name: criminal-ip-domain-full-scan
    description: Initiates a Domain Full Scan and returns a scan_id.
    arguments:
    - name: domain
      description: The domain to perform a Full Scan.
      required: true
      default: true
      type: String
    outputs:
    - contextPath: CriminalIP.Full_Scan
      description: Returns the result of /v1/domain/scan.
      type: String

  - name: criminal-ip-domain-full-scan-status
    description: Checks the progress of the Full Scan.
    arguments:
    - name: scan_id
      description: The scan_id whose Full Scan status to check.
      required: true
      default: true
      type: String
    outputs:
    - contextPath: CriminalIP.Full_Scan_Status
      description: Returns the result of /v1/domain/status/{id}.
      type: String

  - name: criminal-ip-domain-full-scan-result
    description: Returns the Full Scan results for the given scan_id.
    arguments:
    - name: scan_id
      description: The scan_id whose Full Scan result to fetch.
      required: true
      default: true
      type: String
    outputs:
    - contextPath: CriminalIP.Full_Scan_Result
      description: Returns the result of /v2/domain/report/{id}.
      type: String

  - name: criminal-ip-domain-full-scan-make-email-body
    description: Builds an email body summarizing notable findings from a completed Full Scan.
    arguments:
    - name: scan_id
      description: The scan_id of the completed Full Scan.
      required: true
      default: true
      type: String
    - name: domain
      description: The domain of the completed Full Scan.
      required: true
      type: String
    outputs:
    - contextPath: CriminalIP.Email_Body
      description: The generated email body string. Empty if there are no notable findings.
      type: String

  - name: criminal-ip-micro-asm
    description: Performs a micro ASM-style summary for a domain with a completed Full Scan.
    arguments:
    - name: scan_id
      description: The scan_id of the completed Full Scan.
      required: true
      default: true
      type: String
    - name: domain
      description: The domain of the completed Full Scan.
      required: true
      type: String
    outputs:
    - contextPath: CriminalIP.Micro_ASM
      description: A concise summary string of notable findings. Empty if nothing notable is detected.
      type: String
tests:
- Test-CriminalIP
fromversion: 6.0.0
