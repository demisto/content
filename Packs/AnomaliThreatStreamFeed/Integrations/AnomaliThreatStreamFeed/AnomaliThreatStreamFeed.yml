category: Data Enrichment & Threat Intelligence
sectionOrder:
- Connect
- Collect
commonfields:
  id: Anomali ThreatStream Feed
  version: -1
configuration:
- display: Fetch indicators
  defaultvalue: true
  name: feed
  type: 8
  required: false
  section: Collect
- display: Fetch by
  name: fetchBy
  type: 15
  defaultvalue: modified
  required: true
  options:
  - "created"
  - "modified"
  section: Collect
- display: Server URL (e.g., https://www.test.com)
  defaultvalue: https://api.threatstream.com
  name: url
  required: true
  type: 0
  section: Connect
- display: Username
  name: credentials
  required: true
  type: 9
  displaypassword: API Key
  section: Connect
- display: Feed Fetch Interval
  defaultvalue: '240'
  name: feedFetchInterval
  type: 19
  required: false
  section: Collect
- display: Confidence Threshold
  name: confidenceThreshold
  required: false
  advanced: true
  defaultvalue: '65'
  section: Collect
  type: 0
  additionalinfo: Will only return indicators above the confidence threshold.
- display: Source Reliability
  defaultvalue: C - Fairly reliable
  name: feedReliability
  options:
  - A - Completely reliable
  - B - Usually reliable
  - C - Fairly reliable
  - D - Not usually reliable
  - E - Unreliable
  - F - Reliability cannot be judged
  required: false
  advanced: true
  type: 15
  section: Collect
- display: Traffic Light Protocol Color 
  defaultvalue: WHITE
  additionalinfo: Indicator's TLP will override default value.
  name: tlp_color
  options:
  - RED
  - AMBER
  - GREEN
  - WHITE
  type: 15
  advanced: true
  required: false
  section: Collect
- display: Indicator Reputation
  defaultvalue: None
  name: feedReputation
  options:
  - None
  - Good
  - Suspicious
  - Bad
  type: 18
  advanced: true
  required: false
  section: Collect
- defaultvalue: indicatorType
  display: ""
  name: feedExpirationPolicy 
  options:
  - never
  - interval
  - indicatorType
  - suddenDeath
  type: 17
  advanced: true
  required: false
  section: Collect
- display: Create relationships 
  defaultvalue: true
  name: createRelationships
  type: 8
  section: Collect
  advanced: true
  required: false
- display: Trust any certificate (not secure)
  defaultvalue: false
  name: insecure
  type: 8
  section: Connect
  advanced: true
  required: false
description: Anomali ThreatStream Feed Integration.
display: Anomali ThreatStream Feed
name: Anomali ThreatStream Feed
script:
  commands:
  - arguments:
    - name: indicator_type 
      auto: PREDEFINED
      description: The indictor type to analyze.
      isArray: false
      required: false
      predefined:
      - 'domain'
      - 'ip'
      - 'md5'
      - 'url'
      - 'email'
    - name: limit
      default: false
      description: Maximum number of objects to return (default is 10)
      isArray: false
      required: false
      type: Number
    description: Gets indicators from the feed. (Test function)
    name: threatstream-feed-get-indicators
  dockerimage: demisto/py3-tools:1.0.0.114656
  runonce: false
  feed: true
  script: '-'
  subtype: python3
  type: python
tests:
- ThreatStream-Test # TODO fix
fromversion: 5.5.0