commonfields:
  id: SetRDPOverallScore
  version: -1
name: SetRDPOverallScore
script: |-
  register_module_line('RapidBreachResponse-CompletedTasksCount-Widget', 'start', __line__())


  GREEN_HTML_STYLE = "'color:#1DB846;font-size:32px;padding: 60px; text-align:center;padding-left: 70px'>"
  YELLOW_HTML_STYLE = "'color:#e3dc0e;font-size:72px;padding: 60px; text-align:center;padding-left: 70px'>"
  ORANGE_HTML_STYLE = "'color:#EF9700;font-size:72px;padding: 60px; text-align:center;padding-left: 70px'>"
  RED_HTML_STYLE = "'color:#b81d1d;font-size:72px;padding: 60px; text-align:center;padding-left: 70px'>"

  def main():
      query = demisto.context().get('OverallScore')

      if not query:
          html = f"<div style={GREEN_HTML_STYLE}0/100<br><br>No suspicious strings found</div>"
      elif int(query) == 0:
          html = f"<div style={GREEN_HTML_STYLE}{int(query)}/100<br><br>No suspicious strings found</div>"
      elif int(query) > 0 and int(query) < 30:
          html = f"<div style={YELLOW_HTML_STYLE}{int(query)}/100</div>"
      elif int(query) > 29 and int(query) < 70:
          html = f"<div style={ORANGE_HTML_STYLE}{int(query)}/100</div>"
      elif int(query) > 69 and int(query) < 100:
          html = f"<div style={RED_HTML_STYLE}{int(query)}/100</div>"
      else:
          query = "100"
          html = f"<div style={RED_HTML_STYLE}{int(query)}/100</div>"

      demisto.results({
          'ContentsFormat': formats['html'],
          'Type': entryTypes['note'],
          'Contents': html
      })


  if __name__ in ["__main__", "builtin", "builtins"]:
      main()

  register_module_line('RapidBreachResponse-CompletedTasksCount-Widget', 'end', __line__())
type: python
tags:
- dynamic-section
enabled: true
scripttarget: 0
subtype: python3
runonce: false
dockerimage: demisto/python3:3.10.5.31928
runas: DBotWeakRole
fromversion: 6.8.0
tests:
- No tests (auto formatted)
