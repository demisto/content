id: AWS - IAM Test Playbook
version: -1
name: AWS - IAM Test Playbook
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 7e975573-5751-417b-8975-68abf9a1b18f
    type: start
    task:
      id: 7e975573-5751-417b-8975-68abf9a1b18f
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "77"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 9a430660-b7f1-4415-8774-894c697f9472
    type: regular
    task:
      id: 9a430660-b7f1-4415-8774-894c697f9472
      version: -1
      name: aws-iam-list-users
      description: Lists the IAM users, returns all users in the AWS account.
      script: AWS - IAM|||aws-iam-list-users
      type: regular
      iscommand: true
      brand: AWS - IAM
    nexttasks:
      '#none#':
      - "64"
      - "65"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5095
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "7":
    id: "7"
    taskid: 854d9d58-df97-4e36-8c22-efcd36d4bdd8
    type: regular
    task:
      id: 854d9d58-df97-4e36-8c22-efcd36d4bdd8
      version: -1
      name: aws-iam-create-group
      description: Creates a new iam group.
      script: AWS - IAM|||aws-iam-create-group
      type: regular
      iscommand: true
      brand: AWS - IAM
    nexttasks:
      '#none#':
      - "68"
      - "69"
    scriptarguments:
      groupName:
        simple: playbookgrp
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 5b3afa0d-cf9a-4936-8ae3-38db47534bd0
    type: regular
    task:
      id: 5b3afa0d-cf9a-4936-8ae3-38db47534bd0
      version: -1
      name: aws-iam-list-groups
      description: Lists all the IAM groups in the AWS account
      script: AWS - IAM|||aws-iam-list-groups
      type: regular
      iscommand: true
      brand: AWS - IAM
    nexttasks:
      '#none#':
      - "70"
      - "71"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5795
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 6af62556-586f-4ced-8ef0-a6d73c5b5bf3
    type: regular
    task:
      id: 6af62556-586f-4ced-8ef0-a6d73c5b5bf3
      version: -1
      name: aws-iam-list-policies
      description: Lists all the managed policies that are available in your AWS account,
        including your own customer-defined managed policies and all AWS managed policies.
      script: AWS - IAM|||aws-iam-list-policies
      type: regular
      iscommand: true
      brand: AWS - IAM
    nexttasks:
      '#none#':
      - "35"
      - "36"
      - "37"
    scriptarguments:
      scope:
        simple: AWS
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "15":
    id: "15"
    taskid: d31c12ed-c48b-4b86-827b-76a322757834
    type: regular
    task:
      id: d31c12ed-c48b-4b86-827b-76a322757834
      version: -1
      name: aws-iam-list-roles
      description: Lists all IAM roles
      script: AWS - IAM|||aws-iam-list-roles
      type: regular
      iscommand: true
      brand: AWS - IAM
    nexttasks:
      '#none#':
      - "55"
      - "56"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4045
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "19":
    id: "19"
    taskid: 80ad180e-d53a-49d4-86d0-96c6e347663f
    type: regular
    task:
      id: 80ad180e-d53a-49d4-86d0-96c6e347663f
      version: -1
      name: aws-iam-delete-group
      description: Deletes the specified IAM group. The group must not contain any
        users or have any attached policies.
      script: AWS - IAM|||aws-iam-delete-group
      type: regular
      iscommand: true
      brand: AWS - IAM
    scriptarguments:
      groupName:
        simple: playbookgrp
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 6145
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "23":
    id: "23"
    taskid: 243868a3-1f3e-400e-8f14-a3b4202a2866
    type: regular
    task:
      id: 243868a3-1f3e-400e-8f14-a3b4202a2866
      version: -1
      name: aws-iam-create-instance-profile
      description: Creates a new instance profile.
      script: AWS - IAM|||aws-iam-create-instance-profile
      type: regular
      iscommand: true
      brand: AWS - IAM
    nexttasks:
      '#none#':
      - "42"
      - "41"
    scriptarguments:
      instanceProfileName:
        simple: ${TestPBProfileName}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "24":
    id: "24"
    taskid: 82d6783e-53d3-4dcc-8e03-4c6ad706a105
    type: regular
    task:
      id: 82d6783e-53d3-4dcc-8e03-4c6ad706a105
      version: -1
      name: aws-iam-delete-instance-profile
      description: Deletes the specified instance profile. The instance profile must
        not have an associated role.
      script: AWS - IAM|||aws-iam-delete-instance-profile
      type: regular
      iscommand: true
      brand: AWS - IAM
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      instanceProfileName:
        simple: ${TestPBProfileName}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "25":
    id: "25"
    taskid: b2745a60-e90f-4193-8b28-472b008cc616
    type: regular
    task:
      id: b2745a60-e90f-4193-8b28-472b008cc616
      version: -1
      name: aws-iam-list-instance-profiles
      description: Lists all the instance profiles tin your AWS account.
      script: AWS - IAM|||aws-iam-list-instance-profiles
      type: regular
      iscommand: true
      brand: AWS - IAM
    nexttasks:
      '#none#':
      - "49"
      - "50"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "26":
    id: "26"
    taskid: 9e7afefa-d9ae-40d1-87bf-4c966cb4f762
    type: regular
    task:
      id: 9e7afefa-d9ae-40d1-87bf-4c966cb4f762
      version: -1
      name: aws-iam-add-role-to-instance-profile
      description: Adds the specified IAM role to the specified instance profile.
        An instance profile can contain only one role, and this limit cannot be increased.
        You can remove the existing role and then add a different role to an instance
        profile.
      script: AWS - IAM|||aws-iam-add-role-to-instance-profile
      type: regular
      iscommand: true
      brand: AWS - IAM
    nexttasks:
      '#none#':
      - "45"
      - "47"
    scriptarguments:
      instanceProfileName:
        simple: ${TestPBProfileName}
      roleName:
        simple: ${TestPBRoleName}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "27":
    id: "27"
    taskid: c1787a3e-ff1b-49c6-8e47-6eb3805d8215
    type: regular
    task:
      id: c1787a3e-ff1b-49c6-8e47-6eb3805d8215
      version: -1
      name: aws-iam-remove-role-from-instance-profile
      description: Removes the specified IAM role from the specified EC2 instance
        profile.
      script: AWS - IAM|||aws-iam-remove-role-from-instance-profile
      type: regular
      iscommand: true
      brand: AWS - IAM
    nexttasks:
      '#none#':
      - "24"
    scriptarguments:
      instanceProfileName:
        simple: ${TestPBProfileName}
      roleName:
        simple: ${TestPBRoleName}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "28":
    id: "28"
    taskid: 10d8b7bb-336e-4f00-8fb6-43fc8455765f
    type: regular
    task:
      id: 10d8b7bb-336e-4f00-8fb6-43fc8455765f
      version: -1
      name: aws-iam-list-instance-profiles-for-role
      description: Lists the instance profiles that have the specified associated
        IAM role.
      script: AWS - IAM|||aws-iam-list-instance-profiles-for-role
      type: regular
      iscommand: true
      brand: AWS - IAM
    nexttasks:
      '#none#':
      - "51"
      - "52"
    scriptarguments:
      roleName:
        simple: ${TestPBRoleName}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "29":
    id: "29"
    taskid: a5bf160d-76e3-4b24-89c4-229ad22de598
    type: regular
    task:
      id: a5bf160d-76e3-4b24-89c4-229ad22de598
      version: -1
      name: aws-iam-get-instance-profile
      description: Retrieves information about the specified instance profile.
      script: AWS - IAM|||aws-iam-get-instance-profile
      type: regular
      iscommand: true
      brand: AWS - IAM
    nexttasks:
      '#none#':
      - "43"
      - "44"
    scriptarguments:
      instanceProfileName:
        simple: ${TestPBProfileName}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "30":
    id: "30"
    taskid: 821268b6-5619-4e81-85cb-252c4a4c4bcd
    type: regular
    task:
      id: 821268b6-5619-4e81-85cb-252c4a4c4bcd
      version: -1
      name: aws-iam-get-role
      description: Retrieves information about the specified role.
      script: AWS - IAM|||aws-iam-get-role
      type: regular
      iscommand: true
      brand: AWS - IAM
    nexttasks:
      '#none#':
      - "53"
      - "54"
    scriptarguments:
      roleName:
        simple: ${TestPBRoleName}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3695
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "31":
    id: "31"
    taskid: 0c609751-5e70-4644-867f-e9ce081e30de
    type: regular
    task:
      id: 0c609751-5e70-4644-867f-e9ce081e30de
      version: -1
      name: aws-iam-delete-role
      description: 'Deletes the specified role. The role must not have any policies
        attached. '
      script: AWS - IAM|||aws-iam-delete-role
      type: regular
      iscommand: true
      brand: AWS - IAM
    nexttasks:
      '#none#':
      - "79"
    scriptarguments:
      roleName:
        simple: ${TestPBRoleName}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "32":
    id: "32"
    taskid: 0832b4a2-549c-4e63-89a1-3a7bf66e71c2
    type: regular
    task:
      id: 0832b4a2-549c-4e63-89a1-3a7bf66e71c2
      version: -1
      name: aws-iam-create-role
      description: Creates a new role for your AWS account.
      script: AWS - IAM|||aws-iam-create-role
      type: regular
      iscommand: true
      brand: AWS - IAM
    nexttasks:
      '#none#':
      - "40"
      - "39"
    scriptarguments:
      assumeRolePolicyDocument:
        simple: |-
          {
            "Version": "2012-10-17",
            "Statement": [
              {
                "Effect": "Allow",
                "Principal": {
                  "Service": "ec2.amazonaws.com"
                },
                "Action": "sts:AssumeRole"
              }
            ]
          }
      roleName:
        simple: ${TestPBRoleName}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "35":
    id: "35"
    taskid: 8b15a0d4-0997-4310-8e21-05f0c31097d8
    type: regular
    task:
      id: 8b15a0d4-0997-4310-8e21-05f0c31097d8
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      path:
        simple: AWS.IAM.Policies.PolicyId
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "36":
    id: "36"
    taskid: 82549a61-bbe7-4d02-8181-6266efa238fb
    type: regular
    task:
      id: 82549a61-bbe7-4d02-8181-6266efa238fb
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      path:
        simple: AWS.IAM.Policies.PolicyName
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "37":
    id: "37"
    taskid: ccd4d446-efde-46e3-8418-e3424c3fd48b
    type: regular
    task:
      id: ccd4d446-efde-46e3-8418-e3424c3fd48b
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      path:
        simple: AWS.IAM.Policies.Arn
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "39":
    id: "39"
    taskid: 16a53899-0115-4a5f-8bd5-74b7a1484923
    type: regular
    task:
      id: 16a53899-0115-4a5f-8bd5-74b7a1484923
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      path:
        simple: AWS.IAM.Roles.Arn
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "40":
    id: "40"
    taskid: 3b082594-5dfd-4a69-8220-7ab8fad39177
    type: regular
    task:
      id: 3b082594-5dfd-4a69-8220-7ab8fad39177
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      path:
        simple: AWS.IAM.Roles.RoleName
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 695,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "41":
    id: "41"
    taskid: 32215f42-b682-4eb2-8af6-df65cf3bb11b
    type: regular
    task:
      id: 32215f42-b682-4eb2-8af6-df65cf3bb11b
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      path:
        simple: AWS.IAM.InstanceProfiles.Arn
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "42":
    id: "42"
    taskid: 9c42d436-832d-468a-8948-fdf6f5a5374c
    type: regular
    task:
      id: 9c42d436-832d-468a-8948-fdf6f5a5374c
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      path:
        simple: AWS.IAM.InstanceProfiles.InstanceProfileName
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 695,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "43":
    id: "43"
    taskid: 17c7e74f-c0e7-4c65-8f2f-f3feaaa65cfb
    type: regular
    task:
      id: 17c7e74f-c0e7-4c65-8f2f-f3feaaa65cfb
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "26"
    scriptarguments:
      path:
        simple: AWS.IAM.InstanceProfiles.InstanceProfileName
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "44":
    id: "44"
    taskid: 94ffc721-a110-496a-89d9-9a38517203bf
    type: regular
    task:
      id: 94ffc721-a110-496a-89d9-9a38517203bf
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "26"
    scriptarguments:
      path:
        simple: AWS.IAM.InstanceProfiles.InstanceProfileName
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 695,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "45":
    id: "45"
    taskid: 6fa26a32-e8ed-4644-86d7-e360dbe242c6
    type: regular
    task:
      id: 6fa26a32-e8ed-4644-86d7-e360dbe242c6
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "25"
    scriptarguments:
      path:
        simple: AWS.IAM.InstanceProfiles.Arn
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "47":
    id: "47"
    taskid: a33847a1-4efd-40cb-8ca8-824470f02efd
    type: regular
    task:
      id: a33847a1-4efd-40cb-8ca8-824470f02efd
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "25"
    scriptarguments:
      path:
        simple: AWS.IAM.InstanceProfiles.InstanceProfileName
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 695,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "49":
    id: "49"
    taskid: 2c021a6b-a565-4de9-8059-3935e3653aa7
    type: regular
    task:
      id: 2c021a6b-a565-4de9-8059-3935e3653aa7
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "28"
    scriptarguments:
      path:
        simple: AWS.IAM.InstanceProfiles.Arn
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "50":
    id: "50"
    taskid: 254c1731-9b3e-4a64-8cc9-4fd1db5d070b
    type: regular
    task:
      id: 254c1731-9b3e-4a64-8cc9-4fd1db5d070b
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "28"
    scriptarguments:
      path:
        simple: AWS.IAM.InstanceProfiles.Roles.CreateDate
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 695,
          "y": 2820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "51":
    id: "51"
    taskid: cd3739d3-bf1a-41e7-82aa-9518a8897a19
    type: regular
    task:
      id: cd3739d3-bf1a-41e7-82aa-9518a8897a19
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      path:
        simple: AWS.IAM.InstanceProfiles.Arn
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "52":
    id: "52"
    taskid: deb763b5-ece5-487b-844c-f7597436b65e
    type: regular
    task:
      id: deb763b5-ece5-487b-844c-f7597436b65e
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      path:
        simple: AWS.IAM.InstanceProfiles.Roles.CreateDate
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 695,
          "y": 3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "53":
    id: "53"
    taskid: 5369bee3-d332-438e-8c4f-6499d850fcc8
    type: regular
    task:
      id: 5369bee3-d332-438e-8c4f-6499d850fcc8
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      path:
        simple: AWS.IAM.Roles.Arn
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "54":
    id: "54"
    taskid: f1bc309c-cce2-43ce-8689-529f8bc672aa
    type: regular
    task:
      id: f1bc309c-cce2-43ce-8689-529f8bc672aa
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      path:
        simple: AWS.IAM.Roles.RoleName
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 695,
          "y": 3870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "55":
    id: "55"
    taskid: bb44556d-34b9-413c-89fe-00f4cb750777
    type: regular
    task:
      id: bb44556d-34b9-413c-89fe-00f4cb750777
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "76"
    scriptarguments:
      path:
        simple: AWS.IAM.Roles.Arn
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "56":
    id: "56"
    taskid: 4b6a45fe-8410-4ba7-8985-5b6af9f3a8d1
    type: regular
    task:
      id: 4b6a45fe-8410-4ba7-8985-5b6af9f3a8d1
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "76"
    scriptarguments:
      path:
        simple: AWS.IAM.Roles.Arn
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 695,
          "y": 4220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "64":
    id: "64"
    taskid: f2757138-cb46-4b1f-8003-eef33e560d1a
    type: regular
    task:
      id: f2757138-cb46-4b1f-8003-eef33e560d1a
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      path:
        simple: AWS.IAM.Users.UserName
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "65":
    id: "65"
    taskid: 490b0b7c-68d0-4654-81a5-11cb136a9664
    type: regular
    task:
      id: 490b0b7c-68d0-4654-81a5-11cb136a9664
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      path:
        simple: AWS.IAM.Users.UserId
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 695,
          "y": 5270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "68":
    id: "68"
    taskid: d37d5f29-6dbd-41fe-83b6-b9d23533fc46
    type: regular
    task:
      id: d37d5f29-6dbd-41fe-83b6-b9d23533fc46
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      path:
        simple: AWS.IAM.Groups.GroupId
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "69":
    id: "69"
    taskid: d476aaaf-a4f6-4ee0-834d-c6360cd7e798
    type: regular
    task:
      id: d476aaaf-a4f6-4ee0-834d-c6360cd7e798
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      path:
        simple: AWS.IAM.Groups.Arn
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 695,
          "y": 5620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "70":
    id: "70"
    taskid: 77b36aff-951c-48a9-8bce-97b2478f30cc
    type: regular
    task:
      id: 77b36aff-951c-48a9-8bce-97b2478f30cc
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      path:
        simple: AWS.IAM.Groups.Arn
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "71":
    id: "71"
    taskid: 0cd8bc6e-81c7-4b61-8a2e-97edd44ba848
    type: regular
    task:
      id: 0cd8bc6e-81c7-4b61-8a2e-97edd44ba848
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      path:
        simple: AWS.IAM.Groups.GroupId
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 695,
          "y": 5970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "74":
    id: "74"
    taskid: b146f008-0ce0-46fc-83ff-cb0636f7b144
    type: regular
    task:
      id: b146f008-0ce0-46fc-83ff-cb0636f7b144
      version: -1
      name: Generate TestPlaybook Profile Name
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "78"
    scriptarguments:
      key:
        simple: TestPBProfileName
      value:
        simple: ${TimeNowUnix}-TestProfile
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "75":
    id: "75"
    taskid: b076799f-ce73-490b-813b-5e20d7433916
    type: regular
    task:
      id: b076799f-ce73-490b-813b-5e20d7433916
      version: -1
      name: Generate TestPlaybook Role Name
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      key:
        simple: TestPBRoleName
      value:
        simple: ${TimeNowUnix}-TestRole
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "76":
    id: "76"
    taskid: b7f70617-7c86-4413-8cd6-2d80f5256640
    type: regular
    task:
      id: b7f70617-7c86-4413-8cd6-2d80f5256640
      version: -1
      name: List Role Policies
      description: Lists the names of the inline policies that are embedded in the
        specified IAM role.
      script: AWS - IAM|||aws-iam-list-role-policies
      type: regular
      iscommand: true
      brand: AWS - IAM
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      roleName:
        simple: ${TestPBRoleName}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4395
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "77":
    id: "77"
    taskid: 728c80a3-97f4-4278-856a-ec1d4f9555df
    type: regular
    task:
      id: 728c80a3-97f4-4278-856a-ec1d4f9555df
      version: -1
      name: GetTime
      description: |
        Retrieves the current date and time.
      scriptName: GetTime
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "74"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "78":
    id: "78"
    taskid: b3d3833a-2b47-48fc-88b6-d3b9d5d33178
    type: regular
    task:
      id: b3d3833a-2b47-48fc-88b6-d3b9d5d33178
      version: -1
      name: Generate TestPlaybook Profile Name
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "75"
    scriptarguments:
      key:
        simple: TestPBUserName
      value:
        simple: ${TimeNowUnix}-TestUser
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "79":
    id: "79"
    taskid: be60036f-1e9d-44fb-85b2-f64684979724
    type: regular
    task:
      id: be60036f-1e9d-44fb-85b2-f64684979724
      version: -1
      name: aws-iam-get-role-policy
      description: Retrieves the specified inline policy document that is embedded
        with the specified IAM role.
      script: AWS - IAM|||aws-iam-get-role-policy
      type: regular
      iscommand: true
      brand: AWS - IAM
    nexttasks:
      '#none#':
      - "80"
    scriptarguments:
      policyName:
        simple: c7n-IAM-Access
      roleName:
        simple: c7nSecurityAuditRole
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4745
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "80":
    id: "80"
    taskid: 68162b7d-6125-4f1b-899e-6531b8c5be24
    type: regular
    task:
      id: 68162b7d-6125-4f1b-899e-6531b8c5be24
      version: -1
      name: aws-iam-list-role-policies
      description: Lists the names of the inline policies that are embedded in the
        specified IAM role.
      script: AWS - IAM|||aws-iam-list-role-policies
      type: regular
      iscommand: true
      brand: AWS - IAM
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      roleName:
        simple: c7nSecurityAuditRole
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
system: true
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 6190,
        "width": 1240,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
fromversion: 5.0.0
