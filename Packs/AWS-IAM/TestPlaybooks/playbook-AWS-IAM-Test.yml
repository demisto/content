id: AWS - IAM Test Playbook
version: -1
name: AWS - IAM Test Playbook
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: d8456ea7-71c7-404d-8581-fe3f66374222
    type: start
    task:
      id: d8456ea7-71c7-404d-8581-fe3f66374222
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "77"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 03522c81-14b6-4859-80c6-85e3465c8247
    type: regular
    task:
      id: 03522c81-14b6-4859-80c6-85e3465c8247
      version: -1
      name: aws-iam-list-users
      description: Lists the IAM users, returns all users in the AWS account.
      script: AWS - IAM|||aws-iam-list-users
      type: regular
      iscommand: true
      brand: AWS - IAM
    nexttasks:
      '#none#':
      - "64"
      - "65"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5095
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: bdde76d6-9d7d-4515-8691-9cc600852527
    type: regular
    task:
      id: bdde76d6-9d7d-4515-8691-9cc600852527
      version: -1
      name: aws-iam-create-group
      description: Creates a new iam group.
      script: AWS - IAM|||aws-iam-create-group
      type: regular
      iscommand: true
      brand: AWS - IAM
    nexttasks:
      '#none#':
      - "68"
      - "69"
    scriptarguments:
      groupName:
        simple: playbookgrp
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 5a05baf5-2ec3-4c45-81fc-bcc99f36fa7e
    type: regular
    task:
      id: 5a05baf5-2ec3-4c45-81fc-bcc99f36fa7e
      version: -1
      name: aws-iam-list-groups
      description: Lists all the IAM groups in the AWS account
      script: AWS - IAM|||aws-iam-list-groups
      type: regular
      iscommand: true
      brand: AWS - IAM
    nexttasks:
      '#none#':
      - "70"
      - "71"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5795
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 74069ec2-d47b-445e-8bc7-6a9fcead118f
    type: regular
    task:
      id: 74069ec2-d47b-445e-8bc7-6a9fcead118f
      version: -1
      name: aws-iam-list-policies
      description: Lists all the managed policies that are available in your AWS account,
        including your own customer-defined managed policies and all AWS managed policies.
      script: AWS - IAM|||aws-iam-list-policies
      type: regular
      iscommand: true
      brand: AWS - IAM
    nexttasks:
      '#none#':
      - "35"
      - "36"
      - "37"
    scriptarguments:
      scope:
        simple: AWS
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 71fb5a5f-24e3-4687-8ee2-4d8be00e1c37
    type: regular
    task:
      id: 71fb5a5f-24e3-4687-8ee2-4d8be00e1c37
      version: -1
      name: aws-iam-list-roles
      description: Lists all IAM roles
      script: AWS - IAM|||aws-iam-list-roles
      type: regular
      iscommand: true
      brand: AWS - IAM
    nexttasks:
      '#none#':
      - "55"
      - "56"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4045
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: 8169bfa5-e6a7-4830-8c89-009e128af44e
    type: regular
    task:
      id: 8169bfa5-e6a7-4830-8c89-009e128af44e
      version: -1
      name: aws-iam-delete-group
      description: Deletes the specified IAM group. The group must not contain any
        users or have any attached policies.
      script: AWS - IAM|||aws-iam-delete-group
      type: regular
      iscommand: true
      brand: AWS - IAM
    nexttasks:
      '#none#':
      - "90"
    scriptarguments:
      groupName:
        simple: playbookgrp
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 6345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: 14a36bc2-4e16-4ecc-8266-8a932d8f4043
    type: regular
    task:
      id: 14a36bc2-4e16-4ecc-8266-8a932d8f4043
      version: -1
      name: aws-iam-create-instance-profile
      description: Creates a new instance profile.
      script: AWS - IAM|||aws-iam-create-instance-profile
      type: regular
      iscommand: true
      brand: AWS - IAM
    nexttasks:
      '#none#':
      - "42"
      - "41"
    scriptarguments:
      instanceProfileName:
        simple: ${TestPBProfileName}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: 4ce92f8b-7ca6-4e97-8dc0-8e6cf08f5b89
    type: regular
    task:
      id: 4ce92f8b-7ca6-4e97-8dc0-8e6cf08f5b89
      version: -1
      name: aws-iam-delete-instance-profile
      description: Deletes the specified instance profile. The instance profile must
        not have an associated role.
      script: AWS - IAM|||aws-iam-delete-instance-profile
      type: regular
      iscommand: true
      brand: AWS - IAM
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      instanceProfileName:
        simple: ${TestPBProfileName}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "25":
    id: "25"
    taskid: e0789a21-47eb-4720-805e-c77d9b4a45e0
    type: regular
    task:
      id: e0789a21-47eb-4720-805e-c77d9b4a45e0
      version: -1
      name: aws-iam-list-instance-profiles
      description: Lists all the instance profiles tin your AWS account.
      script: AWS - IAM|||aws-iam-list-instance-profiles
      type: regular
      iscommand: true
      brand: AWS - IAM
    nexttasks:
      '#none#':
      - "49"
      - "50"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: aaf62380-0702-40e8-8bff-d909b9e34c99
    type: regular
    task:
      id: aaf62380-0702-40e8-8bff-d909b9e34c99
      version: -1
      name: aws-iam-add-role-to-instance-profile
      description: Adds the specified IAM role to the specified instance profile.
        An instance profile can contain only one role, and this limit cannot be increased.
        You can remove the existing role and then add a different role to an instance
        profile.
      script: AWS - IAM|||aws-iam-add-role-to-instance-profile
      type: regular
      iscommand: true
      brand: AWS - IAM
    nexttasks:
      '#none#':
      - "45"
      - "47"
    scriptarguments:
      instanceProfileName:
        simple: ${TestPBProfileName}
      roleName:
        simple: ${TestPBRoleName}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: ca9a0277-e95a-4456-82fd-ed5793785f75
    type: regular
    task:
      id: ca9a0277-e95a-4456-82fd-ed5793785f75
      version: -1
      name: aws-iam-remove-role-from-instance-profile
      description: Removes the specified IAM role from the specified EC2 instance
        profile.
      script: AWS - IAM|||aws-iam-remove-role-from-instance-profile
      type: regular
      iscommand: true
      brand: AWS - IAM
    nexttasks:
      '#none#':
      - "24"
    scriptarguments:
      instanceProfileName:
        simple: ${TestPBProfileName}
      roleName:
        simple: ${TestPBRoleName}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: 7aaa7f47-f476-4b0e-809d-8bef3c96a060
    type: regular
    task:
      id: 7aaa7f47-f476-4b0e-809d-8bef3c96a060
      version: -1
      name: aws-iam-list-instance-profiles-for-role
      description: Lists the instance profiles that have the specified associated
        IAM role.
      script: AWS - IAM|||aws-iam-list-instance-profiles-for-role
      type: regular
      iscommand: true
      brand: AWS - IAM
    nexttasks:
      '#none#':
      - "51"
      - "52"
    scriptarguments:
      roleName:
        simple: ${TestPBRoleName}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: 14e32014-ff82-4f03-860a-08f121a0bb69
    type: regular
    task:
      id: 14e32014-ff82-4f03-860a-08f121a0bb69
      version: -1
      name: aws-iam-get-instance-profile
      description: Retrieves information about the specified instance profile.
      script: AWS - IAM|||aws-iam-get-instance-profile
      type: regular
      iscommand: true
      brand: AWS - IAM
    nexttasks:
      '#none#':
      - "43"
      - "44"
    scriptarguments:
      instanceProfileName:
        simple: ${TestPBProfileName}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: 0df842df-7d3f-40f5-8d6e-19aff24e2e66
    type: regular
    task:
      id: 0df842df-7d3f-40f5-8d6e-19aff24e2e66
      version: -1
      name: aws-iam-get-role
      description: Retrieves information about the specified role.
      script: AWS - IAM|||aws-iam-get-role
      type: regular
      iscommand: true
      brand: AWS - IAM
    nexttasks:
      '#none#':
      - "53"
      - "54"
    scriptarguments:
      roleName:
        simple: ${TestPBRoleName}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3695
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: d5b5169e-46e6-4a3c-8856-d54f09ad4b58
    type: regular
    task:
      id: d5b5169e-46e6-4a3c-8856-d54f09ad4b58
      version: -1
      name: aws-iam-delete-role
      description: 'Deletes the specified role. The role must not have any policies
        attached. '
      script: AWS - IAM|||aws-iam-delete-role
      type: regular
      iscommand: true
      brand: AWS - IAM
    nexttasks:
      '#none#':
      - "79"
    scriptarguments:
      roleName:
        simple: ${TestPBRoleName}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: fda5efb6-db6f-4cd3-85c1-b0dd95cf201b
    type: regular
    task:
      id: fda5efb6-db6f-4cd3-85c1-b0dd95cf201b
      version: -1
      name: aws-iam-create-role
      description: Creates a new role for your AWS account.
      script: AWS - IAM|||aws-iam-create-role
      type: regular
      iscommand: true
      brand: AWS - IAM
    nexttasks:
      '#none#':
      - "40"
      - "39"
    scriptarguments:
      assumeRolePolicyDocument:
        simple: |-
          {
            "Version": "2012-10-17",
            "Statement": [
              {
                "Effect": "Allow",
                "Principal": {
                  "Service": "ec2.amazonaws.com"
                },
                "Action": "sts:AssumeRole"
              }
            ]
          }
      roleName:
        simple: ${TestPBRoleName}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: 53978282-ce29-4499-830a-ec26b4d34f49
    type: regular
    task:
      id: 53978282-ce29-4499-830a-ec26b4d34f49
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      script: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      path:
        simple: AWS.IAM.Policies.PolicyId
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: 7bb1fcb2-9b99-4b32-87f0-d9da1a849289
    type: regular
    task:
      id: 7bb1fcb2-9b99-4b32-87f0-d9da1a849289
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      script: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      path:
        simple: AWS.IAM.Policies.PolicyName
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: 4a157437-7eed-4f31-8463-4dcf1d535e2c
    type: regular
    task:
      id: 4a157437-7eed-4f31-8463-4dcf1d535e2c
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      script: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      path:
        simple: AWS.IAM.Policies.Arn
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: f7010901-1b30-48e4-8bbc-a5657a618796
    type: regular
    task:
      id: f7010901-1b30-48e4-8bbc-a5657a618796
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      script: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      path:
        simple: AWS.IAM.Roles.Arn
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: acb415c4-1838-41e2-8ec8-c20f93b8db36
    type: regular
    task:
      id: acb415c4-1838-41e2-8ec8-c20f93b8db36
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      script: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      path:
        simple: AWS.IAM.Roles.RoleName
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 695,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: 71906eec-cad0-44dc-81c2-d7382a0a0350
    type: regular
    task:
      id: 71906eec-cad0-44dc-81c2-d7382a0a0350
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      script: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      path:
        simple: AWS.IAM.InstanceProfiles.Arn
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: 46b8cfa8-99dc-4311-8045-a1d4e9a414cb
    type: regular
    task:
      id: 46b8cfa8-99dc-4311-8045-a1d4e9a414cb
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      script: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      path:
        simple: AWS.IAM.InstanceProfiles.InstanceProfileName
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 695,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: 9f1e0edf-bb0e-4e6c-8dc6-ef6c241176dd
    type: regular
    task:
      id: 9f1e0edf-bb0e-4e6c-8dc6-ef6c241176dd
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      script: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "26"
    scriptarguments:
      path:
        simple: AWS.IAM.InstanceProfiles.InstanceProfileName
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "44":
    id: "44"
    taskid: 5b636149-9a07-460c-8d86-b068bbf3eb56
    type: regular
    task:
      id: 5b636149-9a07-460c-8d86-b068bbf3eb56
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      script: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "26"
    scriptarguments:
      path:
        simple: AWS.IAM.InstanceProfiles.InstanceProfileName
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 695,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: 4f17c6ef-c74a-4fae-816f-da030bf172c0
    type: regular
    task:
      id: 4f17c6ef-c74a-4fae-816f-da030bf172c0
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      script: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "25"
    scriptarguments:
      path:
        simple: AWS.IAM.InstanceProfiles.Arn
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: a219d0f6-2718-4d95-8a66-5963fce82ce6
    type: regular
    task:
      id: a219d0f6-2718-4d95-8a66-5963fce82ce6
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      script: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "25"
    scriptarguments:
      path:
        simple: AWS.IAM.InstanceProfiles.InstanceProfileName
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 695,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: f3a0370b-fcc0-4c33-806b-4805b43b5563
    type: regular
    task:
      id: f3a0370b-fcc0-4c33-806b-4805b43b5563
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      script: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "28"
    scriptarguments:
      path:
        simple: AWS.IAM.InstanceProfiles.Arn
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: 8e3822e8-096a-4722-8f27-570aeb84f49e
    type: regular
    task:
      id: 8e3822e8-096a-4722-8f27-570aeb84f49e
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      script: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "28"
    scriptarguments:
      path:
        simple: AWS.IAM.InstanceProfiles.Roles.CreateDate
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 695,
          "y": 2820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: d6134eb2-0baf-4577-8e60-405eb8a3e094
    type: regular
    task:
      id: d6134eb2-0baf-4577-8e60-405eb8a3e094
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      script: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      path:
        simple: AWS.IAM.InstanceProfiles.Arn
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "52":
    id: "52"
    taskid: 623f2648-83fd-4bc4-889a-8dda975ad951
    type: regular
    task:
      id: 623f2648-83fd-4bc4-889a-8dda975ad951
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      script: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      path:
        simple: AWS.IAM.InstanceProfiles.Roles.CreateDate
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 695,
          "y": 3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: eff20963-e464-4bd8-85e7-d6050932614a
    type: regular
    task:
      id: eff20963-e464-4bd8-85e7-d6050932614a
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      script: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      path:
        simple: AWS.IAM.Roles.Arn
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "54":
    id: "54"
    taskid: 79d15b36-9d1c-42fc-8ad5-8f5c112f4cbc
    type: regular
    task:
      id: 79d15b36-9d1c-42fc-8ad5-8f5c112f4cbc
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      script: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      path:
        simple: AWS.IAM.Roles.RoleName
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 695,
          "y": 3870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "55":
    id: "55"
    taskid: 1fe54edf-9467-4142-84b0-7c1b24b145df
    type: regular
    task:
      id: 1fe54edf-9467-4142-84b0-7c1b24b145df
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      script: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "76"
    scriptarguments:
      path:
        simple: AWS.IAM.Roles.Arn
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "56":
    id: "56"
    taskid: 76c70a04-1666-4c45-8317-d1e81d84d7ef
    type: regular
    task:
      id: 76c70a04-1666-4c45-8317-d1e81d84d7ef
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      script: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "76"
    scriptarguments:
      path:
        simple: AWS.IAM.Roles.Arn
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 695,
          "y": 4220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "64":
    id: "64"
    taskid: c60bdf16-f319-4c01-80d3-75695c1750f6
    type: regular
    task:
      id: c60bdf16-f319-4c01-80d3-75695c1750f6
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      script: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      path:
        simple: AWS.IAM.Users.UserName
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "65":
    id: "65"
    taskid: 2859cdca-1d9c-445b-8964-6f7e3efff5bb
    type: regular
    task:
      id: 2859cdca-1d9c-445b-8964-6f7e3efff5bb
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      script: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      path:
        simple: AWS.IAM.Users.UserId
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 695,
          "y": 5270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "68":
    id: "68"
    taskid: 5c1a928f-993a-4406-87d6-f9e2c0e823ec
    type: regular
    task:
      id: 5c1a928f-993a-4406-87d6-f9e2c0e823ec
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      script: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      path:
        simple: AWS.IAM.Groups.GroupId
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "69":
    id: "69"
    taskid: 12be86f0-e368-4323-833e-87ef92c9d574
    type: regular
    task:
      id: 12be86f0-e368-4323-833e-87ef92c9d574
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      script: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      path:
        simple: AWS.IAM.Groups.Arn
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 695,
          "y": 5620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "70":
    id: "70"
    taskid: b842caf9-706c-4d8e-898a-203418eea21f
    type: regular
    task:
      id: b842caf9-706c-4d8e-898a-203418eea21f
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      script: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "94"
    scriptarguments:
      path:
        simple: AWS.IAM.Groups.Arn
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "71":
    id: "71"
    taskid: 178d3cfc-30ec-4c48-88d3-75809502fa16
    type: regular
    task:
      id: 178d3cfc-30ec-4c48-88d3-75809502fa16
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      script: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "94"
    scriptarguments:
      path:
        simple: AWS.IAM.Groups.GroupId
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 695,
          "y": 5970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "74":
    id: "74"
    taskid: 78c40c1c-e530-4616-863d-389b011a4c90
    type: regular
    task:
      id: 78c40c1c-e530-4616-863d-389b011a4c90
      version: -1
      name: Generate TestPlaybook Profile Name
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "78"
    scriptarguments:
      key:
        simple: TestPBProfileName
      value:
        simple: ${TimeNowUnix}-TestProfile
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "75":
    id: "75"
    taskid: de0e57c2-05c7-468a-8970-4ac44c62ff76
    type: regular
    task:
      id: de0e57c2-05c7-468a-8970-4ac44c62ff76
      version: -1
      name: Generate TestPlaybook Role Name
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      key:
        simple: TestPBRoleName
      value:
        simple: ${TimeNowUnix}-TestRole
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "76":
    id: "76"
    taskid: e0b3876d-18c1-4c59-8c7e-6436594b0f61
    type: regular
    task:
      id: e0b3876d-18c1-4c59-8c7e-6436594b0f61
      version: -1
      name: List Role Policies
      description: Lists the names of the inline policies that are embedded in the
        specified IAM role.
      script: AWS - IAM|||aws-iam-list-role-policies
      type: regular
      iscommand: true
      brand: AWS - IAM
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      roleName:
        simple: ${TestPBRoleName}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4395
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "77":
    id: "77"
    taskid: df33282a-49f5-4809-8ae5-3344f90f0644
    type: regular
    task:
      id: df33282a-49f5-4809-8ae5-3344f90f0644
      version: -1
      name: GetTime
      description: |
        Retrieves the current date and time.
      scriptName: GetTime
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "74"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "78":
    id: "78"
    taskid: 53d8be18-8d59-4e7b-82c4-aab924bf4b0e
    type: regular
    task:
      id: 53d8be18-8d59-4e7b-82c4-aab924bf4b0e
      version: -1
      name: Generate TestPlaybook Profile Name
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "75"
    scriptarguments:
      key:
        simple: TestPBUserName
      value:
        simple: ${TimeNowUnix}-TestUser
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "79":
    id: "79"
    taskid: efdbf9e2-b1b4-4e07-854e-e2e14fdab4a2
    type: regular
    task:
      id: efdbf9e2-b1b4-4e07-854e-e2e14fdab4a2
      version: -1
      name: aws-iam-get-role-policy
      description: Retrieves the specified inline policy document that is embedded
        with the specified IAM role.
      script: AWS - IAM|||aws-iam-get-role-policy
      type: regular
      iscommand: true
      brand: AWS - IAM
    nexttasks:
      '#none#':
      - "80"
    scriptarguments:
      policyName:
        simple: c7n-IAM-Access
      roleName:
        simple: c7nSecurityAuditRole
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4745
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "80":
    id: "80"
    taskid: 45f9b381-a22d-4bc9-8303-833c51e61c39
    type: regular
    task:
      id: 45f9b381-a22d-4bc9-8303-833c51e61c39
      version: -1
      name: aws-iam-list-role-policies
      description: Lists the names of the inline policies that are embedded in the
        specified IAM role.
      script: AWS - IAM|||aws-iam-list-role-policies
      type: regular
      iscommand: true
      brand: AWS - IAM
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      roleName:
        simple: c7nSecurityAuditRole
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "89":
    id: "89"
    taskid: 5b3b9e29-f314-4757-81fa-7bb14220ba6d
    type: title
    task:
      id: 5b3b9e29-f314-4757-81fa-7bb14220ba6d
      version: -1
      name: Test Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 7220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "90":
    id: "90"
    taskid: da1f0529-5641-4511-811d-8534b254a767
    type: regular
    task:
      id: da1f0529-5641-4511-811d-8534b254a767
      version: -1
      name: aws-iam-list-user-policies
      script: AWS - IAM|||aws-iam-list-user-policies
      type: regular
      iscommand: true
      brand: AWS - IAM
    nexttasks:
      '#none#':
      - "92"
    scriptarguments:
      userName:
        complex:
          root: AWS.IAM.Users
          accessor: UserName
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 6550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "92":
    id: "92"
    taskid: c27a413f-d099-48c8-8eac-5ec8116fced9
    type: regular
    task:
      id: c27a413f-d099-48c8-8eac-5ec8116fced9
      version: -1
      name: aws-iam-list-attached-user-policies
      script: AWS - IAM|||aws-iam-list-attached-user-policies
      type: regular
      iscommand: true
      brand: AWS - IAM
    nexttasks:
      '#none#':
      - "89"
    scriptarguments:
      userName:
        complex:
          root: AWS.IAM.Users
          accessor: UserName
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 6790
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "94":
    id: "94"
    taskid: c4886c9d-364e-4032-8095-c1a99b1258d9
    type: regular
    task:
      id: c4886c9d-364e-4032-8095-c1a99b1258d9
      version: -1
      name: aws-iam-list-attached-group-policies
      script: AWS - IAM|||aws-iam-list-attached-group-policies
      type: regular
      iscommand: true
      brand: AWS - IAM
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      groupName:
        complex:
          root: AWS.IAM.Groups
          accessor: GroupName
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 6170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 7235,
        "width": 1240,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
fromversion: 5.0.0
description: ''
