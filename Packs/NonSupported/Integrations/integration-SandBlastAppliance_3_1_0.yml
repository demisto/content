commonfields:
  id: Check Point Sandblast Appliance
  version: -1
name: Check Point Sandblast Appliance
display: Check Point Sandblast Appliance
category: Forensics & Malware Analysis
image: data:image/png;base64,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
description: Query, upload and download data using Check Point Sandblast on local gateway.
configuration:
- display: Server URL (e.g. https://192.168.0.1)
  name: server
  defaultvalue: ""
  type: 0
  required: true
- display: Version
  name: version
  defaultvalue: v1
  type: 0
  required: true
- display: Trust any certificate (not secure)
  name: insecure
  defaultvalue: ""
  type: 8
  required: false
- display: Use system proxy settings
  name: proxy
  defaultvalue: ""
  type: 8
  required: false
script:
  script: |-
    var server = params.server;
    var insecure = params.insecure;
    var proxy = params.proxy;
    var version = params.version;
    var requestTemplate = JSON.stringify({request:[{features:['te']}]});
    var base = server.replace(/[\/]+$/, '') +':18194/tecloud/gw/' + version + '/file/';

    var urlDict = {
        'sb-query': 'query',
        'sb-upload': 'upload',
        'sb-download': 'download',
        'sandblast-query': 'query',
        'sandblast-upload': 'upload',
        'sandblast-download': 'download'
    };

    var sendRequest = function(url, body, queryName) {
        var res = http(
                base + url,
                {
                    Method: 'POST',
                    Body: body
                },
                insecure,
                proxy
            );
        if (res.StatusCode < 200 || res.StatusCode >= 300) {
            throw 'Failed to ' + queryName + ' , request status code: ' + res.StatusCode + ' and Body: ' + res.Body + '.';
        }
        return JSON.parse(res.Body);
    };

    var teArgs = {'images': 0, 'reports': 0, 'benign_reports': 1};

    var createRequest = function(args) {
        if (!args.features) {
            args.features = 'all';
        }
        if (args.features !== 'extraction' && args.features !== 'av') {
            var feature = {};
                var keys = Object.keys(teArgs);
                for (var i = 0; i < keys.length; i++) {
                    if (args[keys[i]]) {
                        if (teArgs[keys[i]] === 0) {
                            feature[keys[i]] = JSON.parse(args[keys[i]]);
                        } else if (teArgs[keys[i]] === 1) {
                            feature[keys[i]] = args[keys[i]] === 'true';
                        }
                        delete args[keys[i]];
                    }
                }
                if (Object.keys(feature).length) {
                    args['te'] = feature;
                }
        }
        if (args.features === 'all') {
            args.features = ['te', 'av', 'extraction'];
        } else {
            args.features = [args.features];
        }
        var request = {request: args};
        return JSON.stringify(request);
    };

    var raw;
    switch (command) {
        case 'test-module':
            if (sendRequest(urlDict['sb-query'], createRequest({md5:'31335bc6357f0eb6e3370803b9a6a318'}), 'test')) {
                return 'ok';
            }
            return 'not-cool';
        case 'sandblast-download':
        case 'sb-download':
            var res = http(
                base + urlDict[command] + encodeToURLQuery(args),
                {
                    Method: 'GET'
                },
                insecure,
                proxy
            );
            if (res.StatusCode < 200 || res.StatusCode >= 300) {
                throw 'Failed to ' + urlDict[command] + ' , request status code: ' + res.StatusCode + ' and Body: ' + res.Body + '.';
            }
            // Extract file name from response
            var currentTime = new Date();
            var fileName = command + '_at_' + currentTime.getTime();
            if (res.Headers && res.Headers['Content-Disposition']) {
                var match = /filename=\"(.*)\"/.exec(res.Headers['Content-Disposition']);
                if (match && match[1]) {
                    fileName = match[1];
                }
            }
            raw = {Type: 3, FileID: saveFile(res.Body), File: fileName, Contents: fileName};
            break;
        case 'sandblast-upload':
        case 'sb-upload':
            var file_id = args['file_id'];
            delete args['file_id'];
            var res = httpMultipart(
                base + urlDict[command],
                file_id,
                {
                    Method: 'POST'
                },
                {
                    'request': createRequest(args)
                },
                insecure,
                proxy
                );
            if (res.StatusCode < 200 || res.StatusCode >= 300) {
                throw 'Failed to sb-upload , request status code: ' + res.StatusCode + ' and Body: ' + res.Body + '.';
            }
            raw = {Type: entryTypes.note, ContentsFormat: formats.json, Contents: JSON.parse(res.Body)};
            break;
        default:
            var contents = sendRequest(
                urlDict[command],
                command === 'sb-query' || command === 'sandblast-query'? createRequest(args) : requestTemplate, command);
            raw = {Type: entryTypes.note, ContentsFormat: formats.json, Contents: contents};
    }

    if (command === 'sandblast-upload' || command === 'sandblast-query' || command === 'sb-upload' || command === 'sb-query') {
        var uniqueKeys = ['md5', 'sha1', 'sha256'];
        var ec = {};
        if (raw.Contents.response &&
            raw.Contents.response.av &&
            raw.Contents.response.av.malware_info &&
            raw.Contents.response.av.malware_info.malware_type) {
            var maliciousData = {
                Malicious: {
                    Vendor: 'Sandblast',
                    Description: 'Sandblast found this file malicious',
                    Confidence: raw.Contents.response.av.malware_info.confidence,
                    MalwareFamily: raw.Contents.response.av.malware_info.malware_family,
                    MalwareType: raw.Contents.response.av.malware_info.malware_type,
                    Severity: raw.Contents.response.av.malware_info.severity,
                    SignatureName: raw.Contents.response.av.malware_info.signature_name,
                }
            };
            for (var key in uniqueKeys) {
                if (raw.Contents.response[uniqueKeys[key]]) {
                    maliciousData[uniqueKeys[key].toUpperCase()] = raw.Contents.response[uniqueKeys[key]];
                }
            }
            addMalicious(ec, outputPaths.file, maliciousData);
        } else {
            for (var key in uniqueKeys) {
                if (raw.Contents.response[uniqueKeys[key]]) {
                    var val = {};
                    val[uniqueKeys[key].toUpperCase()] = raw.Contents.response[uniqueKeys[key]];
                    ec['File(val.' + uniqueKeys[key].toUpperCase() + ' == obj.' + uniqueKeys[key].toUpperCase() + ')'] = val;
                }
            }
        }
        raw.EntryContext = ec;
        var prefix = command === 'sandblast-upload' ? 'Upload' : 'Query';
        raw.HumanReadable = tableToMarkdown(
            prefix + ' status for file ' +
            raw.Contents.response.file_name + (raw.Contents.response.file_type ? (' file type ' + raw.Contents.response.file_type) : '') +
            ', md5 ' + raw.Contents.response.md5,
            raw.Contents.response.status
        ) + '\n' +
        tableToMarkdown(
            prefix + ' av for file ' +
            raw.Contents.response.file_name + (raw.Contents.response.file_type ? (' file type ' + raw.Contents.response.file_type) : '') +
            ', md5 ' + raw.Contents.response.md5,
            raw.Contents.response.av)+ '\n' +
        tableToMarkdown(
            prefix + ' extraction for file ' +
            raw.Contents.response.file_name + (raw.Contents.response.file_type ? (' file type ' + raw.Contents.response.file_type) : '') +
            ', md5 ' + raw.Contents.response.md5,
            raw.Contents.response.extraction)+ '\n' +
        tableToMarkdown(prefix + ' TE for file ' +
            raw.Contents.response.file_name + (raw.Contents.response.file_type ? (' file type ' + raw.Contents.response.file_type) : '') +
            ', md5 ' + raw.Contents.response.md5,
            raw.Contents.response.te);
    }
    return raw;
  type: javascript
  commands:
  - name: sb-query
    deprecated: true
    arguments:
    - name: md5
      description: The md5 to query
    - name: sha1
      description: The sha1 to query
    - name: sha256
      description: The sha256 to query
    - name: file_type
      description: File extension (although the service identifies the type)
    - name: features
      auto: PREDEFINED
      predefined:
      - te
      - av
      - extraction
      - all
      description: Available features - default is te and av
    - name: images
      description: Array of objects with id and revision of available OS images
    - name: reports
      description: Array of supported report formats of - pdf | xml | tar
    - name: benign_reports
      auto: PREDEFINED
      predefined:
      - "true"
      - "false"
      description: By default, reports are returned only for malicious files - you
        can mark this as true and get benign reports
    - name: quota
      auto: PREDEFINED
      predefined:
      - "true"
      - "false"
      description: If true, response delivers the quota data (for cloud services only)
    - name: file_name
      description: File name - service calculates the file name from the part name
    description: Use the Query API to have a client application look for either the
      analysis report of a specific file on the Check Point Threat Prevention service
      databases or the status of a file, uploaded for analysis
  - name: sandblast-query
    arguments:
    - name: md5
      description: The md5 to query
    - name: sha1
      description: The sha1 to query
    - name: sha256
      description: The sha256 to query
    - name: file_type
      description: File extension (although the service identifies the type)
    - name: features
      auto: PREDEFINED
      predefined:
      - te
      - av
      - extraction
      - all
      description: Available features - default is te and av
    - name: images
      description: Array of objects with id and revision of available OS images
    - name: reports
      description: Array of supported report formats of - pdf | xml | tar
    - name: benign_reports
      auto: PREDEFINED
      predefined:
      - "true"
      - "false"
      description: By default, reports are returned only for malicious files - you
        can mark this as true and get benign reports
    - name: quota
      auto: PREDEFINED
      predefined:
      - "true"
      - "false"
      description: If true, response delivers the quota data (for cloud services only)
    - name: file_name
      description: File name - service calculates the file name from the part name
    outputs:
    - contextPath: File.Malicious.Vendor
      description: The vendor which found the file as malicious
    - contextPath: File.Malicious.Description
      description: A description of the file as malicious
    - contextPath: File.Malicious.Confidence
      description: Level of confidence that the file is malicious
    - contextPath: File.Malicious.MalwareFamily
      description: The family of malware this file belong to
    - contextPath: File.Malicious.MalwareType
      description: The type of this malware
    - contextPath: File.Malicious.Severity
      description: The severity of this malware
    - contextPath: File.Malicious.SignatureName
      description: The file signature name
    - contextPath: File.MD5
      description: The file md5
    - contextPath: File.SHA1
      description: The file sha1
    - contextPath: File.SHA256
      description: The file sha256
    description: Use the Query API to have a client application look for either the
      analysis report of a specific file on the Check Point Threat Prevention service
      databases or the status of a file, uploaded for analysis
  - name: sb-upload
    deprecated: true
    arguments:
    - name: file_name
      required: true
      default: true
      description: File name - service calculates the file name from the part name
    - name: md5
      description: The md5 to upload
    - name: sha1
      description: The sha1 to upload
    - name: sha256
      description: The sha256 to upload
    - name: file_type
      description: File extension (although the service identifies the type)
    - name: features
      auto: PREDEFINED
      predefined:
      - te
      - av
      - extraction
      - all
      description: Available features - default is te and av
    - name: images
      description: Array of objects with id and revision of available OS images
    - name: reports
      description: Array of supported report formats of - pdf | xml | tar
    - name: benign_reports
      auto: PREDEFINED
      predefined:
      - "true"
      - "false"
      description: By default, reports are returned only for malicious files - you
        can mark this as true and get benign reports
    - name: file_id
      required: true
      description: The file id
    description: Use the Upload API to have a client application request that Check
      Point Threat Prevention modules scan and analyze a file. When you upload a file
      to the service, the file is encrypted. It is un-encrypted during analysis, and
      then deleted
  - name: sandblast-upload
    arguments:
    - name: file_name
      required: true
      default: true
      description: File name - service calculates the file name from the part name
    - name: md5
      description: The md5 to upload
    - name: sha1
      description: The sha1 to upload
    - name: sha256
      description: The sha256 to upload
    - name: file_type
      description: File extension (although the service identifies the type)
    - name: features
      auto: PREDEFINED
      predefined:
      - te
      - av
      - extraction
      - all
      description: Available features - default is te and av
    - name: images
      description: Array of objects with id and revision of available OS images
    - name: reports
      description: Array of supported report formats of - pdf | xml | tar
    - name: benign_reports
      auto: PREDEFINED
      predefined:
      - "true"
      - "false"
      description: By default, reports are returned only for malicious files - you
        can mark this as true and get benign reports
    - name: file_id
      required: true
      description: The file id
    outputs:
    - contextPath: File.Malicious.Vendor
      description: The vendor which found the file as malicious
    - contextPath: File.Malicious.Description
      description: A description of the file as malicious
    - contextPath: File.Malicious.Confidence
      description: Level of confidence that the file is malicious
    - contextPath: File.Malicious.MalwareFamily
      description: The family of malware this file belong to
    - contextPath: File.Malicious.MalwareType
      description: The type of this malware
    - contextPath: File.Malicious.Severity
      description: The severity of this malware
    - contextPath: File.Malicious.SignatureName
      description: The file signature name
    - contextPath: File.MD5
      description: The file md5
    - contextPath: File.SHA1
      description: The file sha1
    - contextPath: File.SHA256
      description: The file sha256
    description: Use the Upload API to have a client application request that Check
      Point Threat Prevention modules scan and analyze a file. When you upload a file
      to the service, the file is encrypted. It is un-encrypted during analysis, and
      then deleted
  - name: sb-download
    deprecated: true
    arguments:
    - name: id
      required: true
      default: true
      description: File id to download
    description: 'Use the Download API to have a client application download files
      generated by the Check Point Threat Prevention service: analysis reports, Threat
      Emulation sandbox outputs, and more. The request must have the ID of the file
      to download'
  - name: sandblast-download
    arguments:
    - name: id
      required: true
      default: true
      description: File id to download
    outputs:
    - contextPath: File.MD5
      description: The file md5
    - contextPath: File.SHA1
      description: The file sha1
    - contextPath: File.SHA256
      description: The file sha256
    - contextPath: File.Name
      description: The file name
    description: 'Use the Download API to have a client application download files
      generated by the Check Point Threat Prevention service: analysis reports, Threat
      Emulation sandbox outputs, and more. The request must have the ID of the file
      to download'
toversion: 3.1.0
tests:
 -  No tests