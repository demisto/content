commonfields:
  id: 40bf81ea-b0da-4ba4-809b-42b7fcee160b
  version: 14
name: PopulateExfiltratedFilesList
script: |
  import json
  res = []

  filelist = demisto.args()["exfiltratedfiles"]
  # If filelist is passed as string, load into dict
  if isinstance(filelist, str):
      try:
          filelist = json.loads(filelist)
      except Exception as ex:
          res.append({"Type": entryTypes["error"], "ContentsFormat": formats["text"],
                  "Contents": "Error occurred while parsing output from command. Exception info:\n" + str(ex) + "\n\nInvalid output:\n" })
          demisto.results(res)
  # Iterate through items and convert keys to lowercase
  newevents = []
  for event in filelist:
      newevents.append(dict((k.lower(), v) for k,v in event.items()))
  demisto.executeCommand('setIncident', {'exfiltratedfilelist': newevents})
type: python
tags: []
enabled: true
args:
- name: exfiltratedfiles
  required: true
  default: true
  description: List of exfiltrated files with which to populated the Exfiltrated Files
    List
  isArray: true
outputs:
- {}
scripttarget: 0
subtype: python3
runonce: false
dockerimage: demisto/python3:3.8.1.6120
runas: DBotWeakRole
