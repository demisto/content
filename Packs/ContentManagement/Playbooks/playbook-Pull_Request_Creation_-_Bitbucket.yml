id: 6d0f513e-b88a-4ef1-8ba1-e497461abe33
version: 5
vcShouldKeepItemLegacyProdMachine: false
name: Pull Request Creation - Bitbucket
description: This playbook creates a pull request using Github integration.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 805d3134-3a6a-4009-803e-1b2c62ed9451
    type: start
    task:
      id: 805d3134-3a6a-4009-803e-1b2c62ed9451
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "37"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 340
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: fbf55723-da9c-4866-89d2-8ba299850dc9
    type: regular
    task:
      id: fbf55723-da9c-4866-89d2-8ba299850dc9
      version: -1
      name: Get main branch
      description: Returns the information of the requested branch.
      script: Bitbucket|||bitbucket-branch-get
      type: regular
      iscommand: true
      brand: Bitbucket
    nexttasks:
      '#none#':
      - "38"
    scriptarguments:
      branch_name:
        complex:
          root: inputs.MainBranch
      partial_response:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1740
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: ce59f4bc-cab0-4c04-87dd-7c903064455c
    type: regular
    task:
      id: ce59f4bc-cab0-4c04-87dd-7c903064455c
      version: -1
      name: Create new branch
      description: Creates a new branch in Bitbucket.
      script: Bitbucket|||bitbucket-branch-create
      type: regular
      iscommand: true
      brand: Bitbucket
    nexttasks:
      '#none#':
      - "53"
    scriptarguments:
      name:
        simple: ${BranchName}
      partial_response:
        simple: "false"
      target_branch:
        simple: ${inputs.MainBranch}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -2.5,
          "y": 2330
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 32565e48-413b-468d-8a6d-b0c5237ecb79
    type: regular
    task:
      id: 32565e48-413b-468d-8a6d-b0c5237ecb79
      version: -1
      name: Commit files - local
      description: This script gets content files as input from the context, commits
        the files in the correct folder and creates the pull request text.
      scriptName: CommitFilesBitbucket
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "48"
    scriptarguments:
      branch:
        complex:
          root: BranchName
      comment:
        complex:
          root: incident
          accessor: cicdpullrequestcomment
      email:
        simple: ${inputs.Email}
      files:
        simple: ${File}
      pack:
        simple: ${inputs.PackName}
      template:
        complex:
          root: inputs.PullRequestTemplate
      user:
        complex:
          root: inputs.UserName
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1000,
          "y": 2710
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: 091c187c-90c3-41de-8417-3384ed361592
    type: regular
    task:
      id: 091c187c-90c3-41de-8417-3384ed361592
      version: -1
      name: Create pull request
      description: Creates a pull request in Bitbucket.
      script: Bitbucket|||bitbucket-pull-request-create
      type: regular
      iscommand: true
      brand: Bitbucket
    nexttasks:
      '#none#':
      - "61"
    scriptarguments:
      description:
        simple: ${PR_text}
      destination_branch:
        simple: ${inputs.MainBranch}
      partial_response:
        simple: "false"
      source_branch:
        simple: ${BranchName}
      title:
        complex:
          root: incident
          accessor: cicdpullrequesttitle
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 363ab199-a99c-4129-89d7-e1e6b3d851ce
    type: regular
    task:
      id: 363ab199-a99c-4129-89d7-e1e6b3d851ce
      version: -1
      name: Update pr and add a reviewer
      description: Updates a pull request in Bitbucket.
      script: Bitbucket|||bitbucket-pull-request-update
      type: regular
      iscommand: true
      brand: Bitbucket
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      partial_response:
        simple: "false"
      pull_request_id:
        simple: ${pr_id}
      reviewer_id:
        simple: ${incident.cicdreviewer}
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 370,
          "y": 3940
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: 82467c95-4e0b-464d-85c1-bc3b9e253c18
    type: condition
    task:
      id: 82467c95-4e0b-464d-85c1-bc3b9e253c18
      version: -1
      name: Add reviewer?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "36"
      "yes":
      - "8"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: incident.cicdreviewer
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3765
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: 181a390a-62d1-4445-8902-43425a51c6f5
    type: regular
    task:
      id: 181a390a-62d1-4445-8902-43425a51c6f5
      version: -1
      name: Get branch
      description: Returns the information of the requested branch.
      script: Bitbucket|||bitbucket-branch-get
      type: regular
      iscommand: true
      brand: Bitbucket
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      branch_name:
        simple: ${BranchName}
      partial_response:
        simple: "false"
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2060
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: bb099866-ff1a-430f-8c42-3218131c38cd
    type: condition
    task:
      id: bb099866-ff1a-430f-8c42-3218131c38cd
      version: -1
      name: Does branch exist?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "54"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Bitbucket.Branch.name
            iscontext: true
          right:
            value:
              simple: ${BranchName}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2235
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "25":
    id: "25"
    taskid: df312ad3-a873-431a-82bb-5171c5fade01
    type: regular
    task:
      id: df312ad3-a873-431a-82bb-5171c5fade01
      version: -1
      name: Set branch name from CI/CD Branch field
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      key:
        simple: BranchName
      value:
        complex:
          root: incident
          accessor: cicdbranch
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1565
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: 0d6e542b-a95d-4f17-8b6d-71bcd60bd668
    type: condition
    task:
      id: 0d6e542b-a95d-4f17-8b6d-71bcd60bd668
      version: -1
      name: Is CI/CD Branch field given
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "27"
      "yes":
      - "25"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: incident.cicdbranch
            iscontext: true
          right:
            value: {}
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1215
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: 03127c8f-a574-4db8-8f1b-9cd1f61bb02f
    type: regular
    task:
      id: 03127c8f-a574-4db8-8f1b-9cd1f61bb02f
      version: -1
      name: Suggest branch name
      description: |
        The script gets the pack name as input and suggests an available branch name, for example:
        pack name is "MyPack" the branch name will be "MyPack".
        If a branch with the name "MyPack" exists, the script return "MyPack_1".
      scriptName: NewBranchName
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "28"
    scriptarguments:
      command_get_branch:
        simple: bitbucket-branch-get
      pack:
        simple: ${inputs.PackName}
    separatecontext: false
    continueonerror: true
    continueonerrortype: errorPath
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: 951b3e2c-e297-4bd0-8ab5-b24c100ba7d7
    type: regular
    task:
      id: 951b3e2c-e297-4bd0-8ab5-b24c100ba7d7
      version: -1
      name: Set branch name from SuggestBranchName output
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      key:
        simple: BranchName
      value:
        complex:
          root: AvailableBranch
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1565
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: 8911aba8-13c4-4ab8-8e3a-3f9ed1e16020
    type: condition
    task:
      id: 8911aba8-13c4-4ab8-8e3a-3f9ed1e16020
      version: -1
      name: Is CI/CD Pull Request Branch field given
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "26"
      "yes":
      - "30"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: incident.cicdpullrequestbranch
            iscontext: true
          right:
            value: {}
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: e2b4b781-e471-44b7-8fb1-9623d1c40445
    type: regular
    task:
      id: e2b4b781-e471-44b7-8fb1-9623d1c40445
      version: -1
      name: Set branch name from CI/CD Pull Request Branch field
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      key:
        simple: BranchName
      value:
        complex:
          root: incident
          accessor: cicdpullrequestbranch
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1565
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: 11250902-ea8b-48e7-8645-a442fff43a64
    type: regular
    task:
      id: 11250902-ea8b-48e7-8645-a442fff43a64
      version: -1
      name: Get pull request list
      description: Returns a list of the pull requests. If a state is provided than
        the list will contain only PRs with the wanted status. If a state is not provided,
        by default a list of the open pull requests will return.
      script: Bitbucket|||bitbucket-pull-request-list
      type: regular
      iscommand: true
      brand: Bitbucket
    nexttasks:
      '#none#':
      - "51"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 3750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: d17a422d-619b-4220-8769-3806b67f228a
    type: regular
    task:
      id: d17a422d-619b-4220-8769-3806b67f228a
      version: -1
      name: Set MessageText value for update action
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      key:
        simple: MessageText
      value:
        simple: |-
          This pull request for the pack ${PackName} was updated by ${DemistoUsers.[0].username}:
          ${Bitbucket.PullRequest.links.html.href}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 4265
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: 03f98db5-a23a-47d9-8456-e8a004f6669a
    type: regular
    task:
      id: 03f98db5-a23a-47d9-8456-e8a004f6669a
      version: -1
      name: Set MessageText for new pull request - update the workspace in the link
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      key:
        simple: MessageText
      value:
        simple: |-
          New pull request was created by ${DemistoUsers.[0].username} for the pack ${PackName}:
          https://github.com/${GitHub.PR.Head.Repo.FullName}/pull/${GitHub.PR.Number}
          https://bitbucket.org//${Bitbucket.PullRequest.destination.repository.full_name}/pull-requests/6
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4105
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: 0f11b6f1-06a4-46a7-859d-d0ce206e71a2
    type: title
    task:
      id: 0f11b6f1-06a4-46a7-859d-d0ce206e71a2
      version: -1
      name: Set the branch name
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 925
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: 88997be5-a435-4d58-8001-9076ea88ed09
    type: title
    task:
      id: 88997be5-a435-4d58-8001-9076ea88ed09
      version: -1
      name: Check if branch exists and create it if not
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "18"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: d01e2e20-4b9f-4333-88bb-1f33efca81be
    type: title
    task:
      id: d01e2e20-4b9f-4333-88bb-1f33efca81be
      version: -1
      name: Commit the files
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "59"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2585
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: d20a6f93-2190-4cb4-8ed1-a5fbba269f35
    type: title
    task:
      id: d20a6f93-2190-4cb4-8ed1-a5fbba269f35
      version: -1
      name: Create new pull request
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "46"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3080
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: 036a9277-6a29-4f91-8f21-515fb13c2d19
    type: title
    task:
      id: 036a9277-6a29-4f91-8f21-515fb13c2d19
      version: -1
      name: Update existing pull request
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "31"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 3590
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: e4086456-d2af-4558-8175-d84b89649d3b
    type: regular
    task:
      id: e4086456-d2af-4558-8175-d84b89649d3b
      version: -1
      name: Create pull request with pack name as title
      description: Creates a pull request in Bitbucket.
      script: Bitbucket|||bitbucket-pull-request-create
      type: regular
      iscommand: true
      brand: Bitbucket
    nexttasks:
      '#none#':
      - "60"
    scriptarguments:
      close_source_branch:
        simple: "yes"
      description:
        simple: ${PR_text}
      destination_branch:
        simple: ${inputs.MainBranch}
      partial_response:
        simple: "false"
      source_branch:
        simple: ${BranchName}
      title:
        simple: ${inputs.PackName}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: 26e5c51f-0b65-4aeb-895e-6cea1813683f
    type: condition
    task:
      id: 26e5c51f-0b65-4aeb-895e-6cea1813683f
      version: -1
      name: Is Pull Request title empty?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "7"
      "yes":
      - "45"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEmpty
          left:
            value:
              complex:
                root: incident
                accessor: cicdpullrequesttitle
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3225
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: 12389e04-c522-49e6-8e51-2b355d16e8e2
    type: condition
    task:
      id: 12389e04-c522-49e6-8e51-2b355d16e8e2
      version: -1
      name: Does branch exist?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "40"
      "yes":
      - "41"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: IsExistingBranch
            iscontext: true
          right:
            value:
              simple: "True"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2900
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: 5b6506d1-bacb-4cae-898d-a6eb5dada612
    type: regular
    task:
      id: 5b6506d1-bacb-4cae-898d-a6eb5dada612
      version: -1
      name: set branch name
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      key:
        simple: BranchName
      value:
        simple: h1
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1260,
          "y": 1390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: 93f483bc-40c9-4c2a-819b-bbf61ab4ce72
    type: regular
    task:
      id: 93f483bc-40c9-4c2a-819b-bbf61ab4ce72
      version: -1
      name: Find Relevant pr_id
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "52"
    scriptarguments:
      key:
        simple: pr_id
      value:
        complex:
          root: Bitbucket.PullRequest
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: Bitbucket.PullRequest.source.branch.name
                iscontext: true
              right:
                value:
                  simple: ${BranchName}
          accessor: id
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 3925
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "52":
    id: "52"
    taskid: 0a6506ce-ba96-4ce4-819b-114ad01b577a
    type: regular
    task:
      id: 0a6506ce-ba96-4ce4-819b-114ad01b577a
      version: -1
      name: Update relevant Pull Request
      description: Updates a pull request in Bitbucket.
      script: Bitbucket|||bitbucket-pull-request-update
      type: regular
      iscommand: true
      brand: Bitbucket
    nexttasks:
      '#none#':
      - "35"
    scriptarguments:
      description:
        simple: ${PR_text}
      partial_response:
        simple: "false"
      pull_request_id:
        simple: ${pr_id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 4090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: d433693e-c36f-4fd8-819b-f0edbc7c0f4a
    type: regular
    task:
      id: d433693e-c36f-4fd8-819b-f0edbc7c0f4a
      version: -1
      name: Set New Branch
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "39"
    scriptarguments:
      key:
        simple: IsExistingBranch
      value:
        simple: "False"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -2.5,
          "y": 2490
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "54":
    id: "54"
    taskid: 261b57d1-e37b-44b4-846f-3cf380652bbb
    type: regular
    task:
      id: 261b57d1-e37b-44b4-846f-3cf380652bbb
      version: -1
      name: Set Existing Branch
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "39"
    scriptarguments:
      key:
        simple: IsExistingBranch
      value:
        simple: "True"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 890,
          "y": 2410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "56":
    id: "56"
    taskid: 36d98a23-d019-4f31-865b-d6cf9e61a5b0
    type: regular
    task:
      id: 36d98a23-d019-4f31-865b-d6cf9e61a5b0
      version: -1
      name: Unzip pack
      description: Unzip a file using fileName or entryID to specify a file. Unzipped
        files will be loaded to the War Room and names will be put into the context.
      scriptName: UnzipFile
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "58"
    scriptarguments:
      entryID:
        simple: ${File.EntryID}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -2.5,
          "y": 440
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "57":
    id: "57"
    taskid: beac01de-3f12-4e41-8207-4f4f91637278
    type: regular
    task:
      id: beac01de-3f12-4e41-8207-4f4f91637278
      version: -1
      name: read metadata - temp
      description: Load the contents of a file into context.
      scriptName: ReadFile
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      entryID:
        simple: ${File.EntryID}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -2.5,
          "y": 620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "58":
    id: "58"
    taskid: 3d3d9041-3f8d-46a7-8a10-9873df3c0162
    type: regular
    task:
      id: 3d3d9041-3f8d-46a7-8a10-9873df3c0162
      version: -1
      name: set pack name - temp
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "37"
    scriptarguments:
      key:
        simple: PackName
      value:
        simple: hi
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -2.5,
          "y": 780
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "59":
    id: "59"
    taskid: 15f89354-1890-478a-8407-e043d5a14e9e
    type: regular
    task:
      id: 15f89354-1890-478a-8407-e043d5a14e9e
      version: -1
      name: Commit files - generic
      description: This script gets content files as input from the context, commits
        the files in the correct folder and creates the pull request text.
      scriptName: CommitFilesBitbucket
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "48"
    scriptarguments:
      branch:
        complex:
          root: BranchName
      comment:
        complex:
          root: incident
          accessor: cicdpullrequestcomment
      email:
        simple: ${inputs.Email}
      files:
        simple: ${inputs.File}
      pack:
        simple: ${inputs.PackName}
      template:
        complex:
          root: inputs.PullRequestTemplate
      user:
        complex:
          root: inputs.UserName
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: b23bf303-ff0c-4464-883a-3b2087f94741
    type: regular
    task:
      id: b23bf303-ff0c-4464-883a-3b2087f94741
      version: -1
      name: set pr_id
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      key:
        simple: pr_id
      value:
        simple: ${Bitbucket.PullRequest.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    id: "61"
    taskid: 7665873c-7a3f-4cbe-859e-da7cbbc9e727
    type: regular
    task:
      id: 7665873c-7a3f-4cbe-859e-da7cbbc9e727
      version: -1
      name: set pr_id
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      key:
        simple: pr_id
      value:
        simple: ${Bitbucket.PullRequest.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 3575
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 4020,
        "width": 1642.5,
        "x": -2.5,
        "y": 340
      }
    }
  }
inputs:
- key: PullRequestTemplate
  value: {}
  required: true
  description: Pull request description template.
  playbookInputQuery: null
- key: MainBranch
  value: {}
  required: true
  description: The name of the branch you want the changes pulled into, which must
    be an existing branch on the current repository.
  playbookInputQuery: null
- key: UserName
  value: {}
  required: false
  description: The user name in Bitbucket
  playbookInputQuery: null
- key: Email
  value: {}
  required: false
  description: The email in Bitbucket
  playbookInputQuery: null
- key: PackName
  value: {}
  required: true
  description: The name of the pack
  playbookInputQuery: null
- key: File
  value: {}
  required: true
  description: The File or Files to commit to the new or updated branch or pr
  playbookInputQuery: null
outputs: []
sourceplaybookid: Pull Request Creation - Github
