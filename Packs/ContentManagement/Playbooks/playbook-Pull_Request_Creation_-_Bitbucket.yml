id: 6d0f513e-b88a-4ef1-8ba1-e497461abe33
version: 62
vcShouldKeepItemLegacyProdMachine: false
name: Pull Request Creation - Bitbucket
description: This playbook creates a pull request using Github integration.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 133f0838-1191-4454-8b16-d12ca0a39887
    type: start
    task:
      id: 133f0838-1191-4454-8b16-d12ca0a39887
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "56"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 340
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: 00eee788-0cda-47c8-8d40-5a812bdaded9
    type: regular
    task:
      id: 00eee788-0cda-47c8-8d40-5a812bdaded9
      version: -1
      name: Get main branch
      description: Returns the information of the requested branch.
      script: Bitbucket|||bitbucket-branch-get
      type: regular
      iscommand: true
      brand: Bitbucket
    nexttasks:
      '#none#':
      - "38"
    scriptarguments:
      branch_name:
        complex:
          root: inputs.MainBranch
      partial_response:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1740
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 31ace05d-4fda-4820-8dd8-342baa86d207
    type: regular
    task:
      id: 31ace05d-4fda-4820-8dd8-342baa86d207
      version: -1
      name: Create new branch
      description: Creates a new branch in Bitbucket.
      script: Bitbucket|||bitbucket-branch-create
      type: regular
      iscommand: true
      brand: Bitbucket
    nexttasks:
      '#none#':
      - "53"
    scriptarguments:
      name:
        simple: ${BranchName}
      partial_response:
        simple: "false"
      target_branch:
        simple: ${inputs.MainBranch}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -2.5,
          "y": 2330
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 5e8e2c9f-9f9c-44ce-85c1-053004d0fd51
    type: regular
    task:
      id: 5e8e2c9f-9f9c-44ce-85c1-053004d0fd51
      version: -1
      name: Commit files - local
      description: This script gets content files as input from the context, commits
        the files in the correct folder and creates the pull request text.
      scriptName: CommitFilesBitbucket
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "48"
    scriptarguments:
      branch:
        complex:
          root: BranchName
      comment:
        complex:
          root: incident
          accessor: cicdpullrequestcomment
      email:
        simple: ${inputs.Email}
      files:
        simple: ${File}
      pack:
        simple: ${inputs.PackName}
      template:
        complex:
          root: inputs.PullRequestTemplate
      user:
        complex:
          root: inputs.UserName
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: d0ee036f-0e8d-4747-8505-af1831ed7959
    type: regular
    task:
      id: d0ee036f-0e8d-4747-8505-af1831ed7959
      version: -1
      name: Create pull request
      description: Creates a pull request in Bitbucket.
      script: Bitbucket|||bitbucket-pull-request-create
      type: regular
      iscommand: true
      brand: Bitbucket
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      description:
        simple: PR_text
      destination_branch:
        simple: ${inputs.MainBranch}
      partial_response:
        simple: "false"
      source_branch:
        simple: ${BranchName}
      title:
        complex:
          root: incident
          accessor: cicdpullrequesttitle
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: eca9bf26-5267-45dc-86ab-5698bd8d8d5c
    type: regular
    task:
      id: eca9bf26-5267-45dc-86ab-5698bd8d8d5c
      version: -1
      name: Update pr and add a reviewer
      description: Updates a pull request in Bitbucket.
      script: Bitbucket|||bitbucket-pull-request-update
      type: regular
      iscommand: true
      brand: Bitbucket
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      partial_response:
        simple: "false"
      pull_request_id:
        simple: ${Bitbucket.PullRequest.id}
      reviewer_id:
        simple: incident.cicdreviewer
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 3750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: 51082ab0-addd-4fd3-8815-0178dd4aaeac
    type: condition
    task:
      id: 51082ab0-addd-4fd3-8815-0178dd4aaeac
      version: -1
      name: Add reviewer?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "36"
      "yes":
      - "8"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: incident.cicdreviewer
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3575
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: 74e57ad1-7c00-432e-8d76-08001a7d5448
    type: regular
    task:
      id: 74e57ad1-7c00-432e-8d76-08001a7d5448
      version: -1
      name: Get branch
      description: Returns the information of the requested branch.
      script: Bitbucket|||bitbucket-branch-get
      type: regular
      iscommand: true
      brand: Bitbucket
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      branch_name:
        simple: ${BranchName}
      partial_response:
        simple: "false"
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2060
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: 09d39a01-a771-4865-8ef3-adf029ca6ef5
    type: condition
    task:
      id: 09d39a01-a771-4865-8ef3-adf029ca6ef5
      version: -1
      name: Does branch exist?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "54"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Bitbucket.Branch.name
            iscontext: true
          right:
            value:
              simple: ${BranchName}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2235
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "25":
    id: "25"
    taskid: e86abb61-412a-4a33-8637-7fe06d404157
    type: regular
    task:
      id: e86abb61-412a-4a33-8637-7fe06d404157
      version: -1
      name: Set branch name from CI/CD Branch field
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      key:
        simple: BranchName
      value:
        complex:
          root: incident
          accessor: cicdbranch
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1565
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: 2781bab1-7fde-4ae1-8c16-d6a1ae9460d5
    type: condition
    task:
      id: 2781bab1-7fde-4ae1-8c16-d6a1ae9460d5
      version: -1
      name: Is CI/CD Branch field given
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "27"
      "yes":
      - "25"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: incident.cicdbranch
            iscontext: true
          right:
            value: {}
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1215
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: 9a430442-5e3b-4df2-8e0d-73d598a24118
    type: regular
    task:
      id: 9a430442-5e3b-4df2-8e0d-73d598a24118
      version: -1
      name: Suggest branch name
      description: |
        The script gets the pack name as input and suggests an available branch name, for example:
        pack name is "MyPack" the branch name will be "MyPack".
        If a branch with the name "MyPack" exists, the script return "MyPack_1".
      scriptName: NewBranchName
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "28"
    scriptarguments:
      command_get_branch:
        simple: bitbucket-branch-get
      pack:
        simple: ${inputs.PackName}
    separatecontext: false
    continueonerror: true
    continueonerrortype: errorPath
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: 8bb8cba9-3d4a-4bc6-80ef-4120ba627b22
    type: regular
    task:
      id: 8bb8cba9-3d4a-4bc6-80ef-4120ba627b22
      version: -1
      name: Set branch name from SuggestBranchName output
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      key:
        simple: BranchName
      value:
        complex:
          root: AvailableBranch
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1565
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: 7523ff4e-3632-49f4-84c4-eaf5d337dc03
    type: condition
    task:
      id: 7523ff4e-3632-49f4-84c4-eaf5d337dc03
      version: -1
      name: Is CI/CD Pull Request Branch field given
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "26"
      "yes":
      - "30"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: incident.cicdpullrequestbranch
            iscontext: true
          right:
            value: {}
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: 3f80cecc-11f7-4481-8e88-bbb8a7e1801f
    type: regular
    task:
      id: 3f80cecc-11f7-4481-8e88-bbb8a7e1801f
      version: -1
      name: Set branch name from CI/CD Pull Request Branch field
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      key:
        simple: BranchName
      value:
        complex:
          root: incident
          accessor: cicdpullrequestbranch
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1565
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: f0c6ed7d-fd36-48da-816d-85091ba1d2c1
    type: regular
    task:
      id: f0c6ed7d-fd36-48da-816d-85091ba1d2c1
      version: -1
      name: Get pull request list
      description: Returns a list of the pull requests. If a state is provided than
        the list will contain only PRs with the wanted status. If a state is not provided,
        by default a list of the open pull requests will return.
      script: Bitbucket|||bitbucket-pull-request-list
      type: regular
      iscommand: true
      brand: Bitbucket
    nexttasks:
      '#none#':
      - "51"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 3750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: ba4b2b82-2ec3-4f2e-893c-343029a18580
    type: regular
    task:
      id: ba4b2b82-2ec3-4f2e-893c-343029a18580
      version: -1
      name: Set MessageText value for update action
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      key:
        simple: MessageText
      value:
        simple: |-
          This pull request for the pack ${PackName} was updated by ${DemistoUsers.[0].username}:
          ${Bitbucket.PullRequest.links.html.href}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 4265
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: ec3bbbc2-456d-48dd-81e0-ebbf15167da5
    type: regular
    task:
      id: ec3bbbc2-456d-48dd-81e0-ebbf15167da5
      version: -1
      name: Set MessageText for new pull request - update the workspace in the link
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      key:
        simple: MessageText
      value:
        simple: |-
          New pull request was created by ${DemistoUsers.[0].username} for the pack ${PackName}:
          https://github.com/${GitHub.PR.Head.Repo.FullName}/pull/${GitHub.PR.Number}
          https://bitbucket.org//${Bitbucket.PullRequest.destination.repository.full_name}/pull-requests/6
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3925
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: c1b14aae-1409-46b7-8733-8e48565b3474
    type: title
    task:
      id: c1b14aae-1409-46b7-8733-8e48565b3474
      version: -1
      name: Set the branch name
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 925
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: d908d2b2-5136-42b3-81a0-a7383028ef7b
    type: title
    task:
      id: d908d2b2-5136-42b3-81a0-a7383028ef7b
      version: -1
      name: Check if branch exists and create it if not
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "18"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: 7eccd3a4-1338-430a-8fda-b2cf3d6ab18b
    type: title
    task:
      id: 7eccd3a4-1338-430a-8fda-b2cf3d6ab18b
      version: -1
      name: Commit the files
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2585
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: 9c92024b-733d-4883-870e-3765db40e948
    type: title
    task:
      id: 9c92024b-733d-4883-870e-3765db40e948
      version: -1
      name: Create new pull request
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "46"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3080
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: c40593c4-512a-4a93-8098-5557ac8b6a01
    type: title
    task:
      id: c40593c4-512a-4a93-8098-5557ac8b6a01
      version: -1
      name: Update existing pull request
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "31"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 3590
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: d2bf8e45-578f-4555-8667-9fb0d1ecfcc7
    type: regular
    task:
      id: d2bf8e45-578f-4555-8667-9fb0d1ecfcc7
      version: -1
      name: Create pull request with pack name as title
      description: Creates a pull request in Bitbucket.
      script: Bitbucket|||bitbucket-pull-request-create
      type: regular
      iscommand: true
      brand: Bitbucket
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      close_source_branch:
        simple: "yes"
      description:
        simple: PR_text
      destination_branch:
        simple: ${inputs.MainBranch}
      partial_response:
        simple: "false"
      source_branch:
        simple: ${BranchName}
      title:
        simple: ${inputs.PackName}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: 1e9d0db9-9672-4396-8576-3220ccb6ef74
    type: condition
    task:
      id: 1e9d0db9-9672-4396-8576-3220ccb6ef74
      version: -1
      name: Is Pull Request title empty?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "7"
      "yes":
      - "45"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEmpty
          left:
            value:
              complex:
                root: incident
                accessor: cicdpullrequesttitle
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3225
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: 88d4808e-9ff3-477c-8331-40d8646520ae
    type: condition
    task:
      id: 88d4808e-9ff3-477c-8331-40d8646520ae
      version: -1
      name: Does branch exist?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "40"
      "yes":
      - "41"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: IsExistingBranch
            iscontext: true
          right:
            value:
              simple: "True"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2900
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: 221aed05-b97b-4f8a-824b-57659c8ab1b5
    type: regular
    task:
      id: 221aed05-b97b-4f8a-824b-57659c8ab1b5
      version: -1
      name: set branch name
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      key:
        simple: BranchName
      value:
        simple: h1
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1260,
          "y": 1390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: dc3b34d7-476b-487f-8769-df55fa61faab
    type: regular
    task:
      id: dc3b34d7-476b-487f-8769-df55fa61faab
      version: -1
      name: Find Relevant pr_id
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "52"
    scriptarguments:
      key:
        simple: pr_id
      value:
        complex:
          root: Bitbucket.PullRequest
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: Bitbucket.PullRequest.source.branch.name
                iscontext: true
              right:
                value:
                  simple: ${BranchName}
          accessor: id
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 3925
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "52":
    id: "52"
    taskid: e4af1201-9bf5-4078-8e15-39343381dba6
    type: regular
    task:
      id: e4af1201-9bf5-4078-8e15-39343381dba6
      version: -1
      name: Update relevant Pull Request
      description: Updates a pull request in Bitbucket.
      script: Bitbucket|||bitbucket-pull-request-update
      type: regular
      iscommand: true
      brand: Bitbucket
    nexttasks:
      '#none#':
      - "35"
    scriptarguments:
      description:
        simple: ${PR_text}
      partial_response:
        simple: "false"
      pull_request_id:
        simple: ${pr_id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 4090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: d5eb43e2-c5a2-4b45-83bd-d802c7eea82b
    type: regular
    task:
      id: d5eb43e2-c5a2-4b45-83bd-d802c7eea82b
      version: -1
      name: Set New Branch
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "39"
    scriptarguments:
      key:
        simple: IsExistingBranch
      value:
        simple: "False"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -2.5,
          "y": 2490
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "54":
    id: "54"
    taskid: 0b1d246a-6076-4ab6-8668-7aef224ac567
    type: regular
    task:
      id: 0b1d246a-6076-4ab6-8668-7aef224ac567
      version: -1
      name: Set Existing Branch
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "39"
    scriptarguments:
      key:
        simple: IsExistingBranch
      value:
        simple: "True"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 890,
          "y": 2410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "56":
    id: "56"
    taskid: c13751f8-7102-49c0-89c5-93788804fb51
    type: regular
    task:
      id: c13751f8-7102-49c0-89c5-93788804fb51
      version: -1
      name: Unzip pack
      description: Unzip a file using fileName or entryID to specify a file. Unzipped
        files will be loaded to the War Room and names will be put into the context.
      scriptName: UnzipFile
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "58"
    scriptarguments:
      entryID:
        simple: ${File.EntryID}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -2.5,
          "y": 440
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "57":
    id: "57"
    taskid: 94314fa3-ae98-4859-87bf-770b43926522
    type: regular
    task:
      id: 94314fa3-ae98-4859-87bf-770b43926522
      version: -1
      name: read metadata - temp
      description: Load the contents of a file into context.
      scriptName: ReadFile
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      entryID:
        simple: ${File.EntryID}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -2.5,
          "y": 620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "58":
    id: "58"
    taskid: f83a3014-0d73-4709-8821-60b1ac1720ac
    type: regular
    task:
      id: f83a3014-0d73-4709-8821-60b1ac1720ac
      version: -1
      name: set pack name - temp
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "37"
    scriptarguments:
      key:
        simple: PackName
      value:
        simple: hi
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -2.5,
          "y": 780
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "59":
    id: "59"
    taskid: b9b80fee-48f7-4f99-8cd6-b32c43388e2c
    type: regular
    task:
      id: b9b80fee-48f7-4f99-8cd6-b32c43388e2c
      version: -1
      name: Commit files - generic
      description: This script gets content files as input from the context, commits
        the files in the correct folder and creates the pull request text.
      scriptName: CommitFilesBitbucket
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      branch:
        complex:
          root: BranchName
      comment:
        complex:
          root: incident
          accessor: cicdpullrequestcomment
      email:
        simple: ${inputs.Email}
      files:
        simple: ${inputs.File}
      pack:
        simple: ${inputs.PackName}
      template:
        complex:
          root: inputs.PullRequestTemplate
      user:
        complex:
          root: inputs.UserName
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -2.5,
          "y": 2730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 4020,
        "width": 1642.5,
        "x": -2.5,
        "y": 340
      }
    }
  }
inputs:
- key: PullRequestTemplate
  value: {}
  required: true
  description: Pull request description template.
  playbookInputQuery: null
- key: MainBranch
  value:
    simple: master
  required: true
  description: The name of the branch you want the changes pulled into, which must
    be an existing branch on the current repository.
  playbookInputQuery: null
- key: UserName
  value: {}
  required: false
  description: The user name in Bitbucket
  playbookInputQuery: null
- key: Email
  value: {}
  required: false
  description: The email in Bitbucket
  playbookInputQuery: null
- key: PackName
  value:
    simple: hello
  required: true
  description: The name of the pack
  playbookInputQuery: null
- key: File
  value: {}
  required: true
  description: The File or Files to commit to the new or updated branch or pr
  playbookInputQuery: null
outputs: []
sourceplaybookid: Pull Request Creation - Github
