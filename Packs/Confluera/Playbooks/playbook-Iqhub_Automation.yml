id: IQ-HUB Automation
version: -1
fromversion: 6.0.0
name: IQ-HUB Automation
description: This playbook is used to retrieve real-time detections and progressions
  data generated by events on different systems present in the network.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 66290841-bda4-482f-8fae-ce5b55d0e5f0
    type: start
    task:
      id: 66290841-bda4-482f-8fae-ce5b55d0e5f0
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "3"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 290,
          "y": -810
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "2":
    id: "2"
    taskid: 019b3acd-682d-42c5-8e39-07954f3aef03
    type: regular
    task:
      id: 019b3acd-682d-42c5-8e39-07954f3aef03
      version: -1
      name: confluera-fetch-detections
      description: This command fetches detections from confluera Iq-Hub portal,
      script: Confluera|||confluera-fetch-detections
      type: regular
      iscommand: true
      brand: Confluera
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      hours: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 290,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "3":
    id: "3"
    taskid: 822134a8-a79d-4eb3-8293-5f41551d219d
    type: regular
    task:
      id: 822134a8-a79d-4eb3-8293-5f41551d219d
      version: -1
      name: confluera-fetch-progressions
      description: This command fetches progressions from confluera Iq-Hub portal,
      script: Confluera|||confluera-fetch-progressions
      type: regular
      iscommand: true
      brand: Confluera
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      hours: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 290,
          "y": -620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "4":
    id: "4"
    taskid: 66269b95-845c-4b94-8461-aca507c1749f
    type: title
    task:
      id: 66269b95-845c-4b94-8461-aca507c1749f
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 290,
          "y": 970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "5":
    id: "5"
    taskid: 3ded1d39-8018-4c12-85e5-c46b76e8dc34
    type: condition
    task:
      id: 3ded1d39-8018-4c12-85e5-c46b76e8dc34
      version: -1
      name: Are Detections Available
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "4"
      "yes":
      - "12"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Confluera.Detections
            iscontext: true
    view: |-
      {
        "position": {
          "x": 290,
          "y": -150
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "6":
    id: "6"
    taskid: 2bca18e7-7d63-4243-89b6-ed3032147173
    type: regular
    task:
      id: 2bca18e7-7d63-4243-89b6-ed3032147173
      version: -1
      name: confluera-fetch-trail-details
      description: This command fetched progression details of which provided detection
        is a part of.
      script: Confluera|||confluera-fetch-trail-details
      type: regular
      iscommand: true
      brand: Confluera
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      trail_id:
        simple: ${Enter Trail Id.Answers.0}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -10,
          "y": 610
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "12":
    id: "12"
    taskid: 49a91ae7-8fc6-49e8-897d-4b819ce4df0a
    type: condition
    task:
      id: 49a91ae7-8fc6-49e8-897d-4b819ce4df0a
      version: -1
      name: Want to fetch trail details ?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      "No":
      - "4"
      "Yes":
      - "13"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -10,
          "y": 70
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to:
      subject:
      body:
        simple: Do you want to fetch progression details ?
      methods: []
      format: ""
      bcc:
      cc:
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
      replyOptions:
      - "Yes"
      - "No"
    skipunavailable: false
    quietmode: 0
  "13":
    id: "13"
    taskid: fe04da42-916d-4697-8695-83779af523e0
    type: collection
    task:
      id: fe04da42-916d-4697-8695-83779af523e0
      version: -1
      name: Enter Trail Id
      type: collection
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "6"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -10,
          "y": 380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to:
      subject:
      body:
      methods: []
      format: ""
      bcc:
      cc:
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
    form:
      questions:
      - id: "0"
        label: ""
        labelarg:
          simple: Which Trail id's details you want to fetch ?
        required: true
        gridcolumns: []
        defaultrows: []
        type: shortText
        options: []
        optionsarg: []
        fieldassociated: ""
        placeholder: ""
        tooltip: ""
        readonly: false
      title: Enter Trail Id
      description: ""
      sender: ""
      expired: false
      totalanswers: 0
    skipunavailable: false
    quietmode: 0
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1845,
        "width": 680,
        "x": -10,
        "y": -810
      }
    }
  }
inputs: []
outputs: []
tests:
- No tests (auto formatted)
