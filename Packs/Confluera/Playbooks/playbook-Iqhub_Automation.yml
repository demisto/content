id: IQ-HUB Automation
version: -1
name: IQ-HUB Automation
description: This playbook is used to retrieve real-time detections and progressions
  data generated by events on different systems present in the network.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 66290841-bda4-482f-8fae-ce5b55d0e5f0
    type: start
    task:
      id: 66290841-bda4-482f-8fae-ce5b55d0e5f0
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 275,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "1":
    id: "1"
    taskid: cf27c8ec-d8d3-4c93-80ab-0a471f27c5f5
    type: regular
    task:
      id: cf27c8ec-d8d3-4c93-80ab-0a471f27c5f5
      version: -1
      name: confluera-login
      description: Logs in user into confluera iq-hub portal
      script: Confluera|||confluera-login
      type: regular
      iscommand: true
      brand: Confluera
    nexttasks:
      '#none#':
      - "2"
      - "3"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 275,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "2":
    id: "2"
    taskid: 193bb283-df82-41a2-8f03-22badb872184
    type: regular
    task:
      id: 193bb283-df82-41a2-8f03-22badb872184
      version: -1
      name: confluera-fetch-detections
      description: This command fetches detections from confluera Iq-Hub portal,
      script: Confluera|||confluera-fetch-detections
      type: regular
      iscommand: true
      brand: Confluera
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      access-token:
        simple: ${Confluera.LoginData.access_token}
      hours: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "3":
    id: "3"
    taskid: 00d220e2-622b-4059-82af-a679b7070ecf
    type: regular
    task:
      id: 00d220e2-622b-4059-82af-a679b7070ecf
      version: -1
      name: confluera-fetch-progressions
      description: This command fetches progressions from confluera Iq-Hub portal,
      script: Confluera|||confluera-fetch-progressions
      type: regular
      iscommand: true
      brand: Confluera
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      access-token:
        simple: ${Confluera.LoginData.access_token}
      hours: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -105,
          "y": 390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "4":
    id: "4"
    taskid: 66269b95-845c-4b94-8461-aca507c1749f
    type: title
    task:
      id: 66269b95-845c-4b94-8461-aca507c1749f
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -70,
          "y": 1450
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "5":
    id: "5"
    taskid: 3ded1d39-8018-4c12-85e5-c46b76e8dc34
    type: condition
    task:
      id: 3ded1d39-8018-4c12-85e5-c46b76e8dc34
      version: -1
      name: Are Detections Available
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "4"
      "yes":
      - "8"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Confluera.Detections
            iscontext: true
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "6":
    id: "6"
    taskid: 9b911519-6ee1-4c2c-81da-0e4645342a90
    type: regular
    task:
      id: 9b911519-6ee1-4c2c-81da-0e4645342a90
      version: -1
      name: confluera-fetch-trail-details
      description: This command fetched progression details of which provided detection
        is a part of.
      script: Confluera|||confluera-fetch-trail-details
      type: regular
      iscommand: true
      brand: Confluera
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      access-token:
        simple: ${Confluera.LoginData.access_token}
      trail-id: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 490,
          "y": 1210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "7":
    id: "7"
    taskid: d377653e-8f70-4960-89c2-bda3939ea48a
    type: regular
    task:
      id: d377653e-8f70-4960-89c2-bda3939ea48a
      version: -1
      name: DetectionsDataWarroom
      scriptName: DetectionsDataWarroom
      type: regular
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "6"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 490,
          "y": 1000
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "8":
    id: "8"
    taskid: f905482a-2077-404b-88d6-7c62fa90e501
    type: regular
    task:
      id: f905482a-2077-404b-88d6-7c62fa90e501
      version: -1
      name: DetectionsSummaryWarroom
      scriptName: DetectionsSummaryWarroom
      type: regular
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "7"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 490,
          "y": 800
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "9":
    id: "9"
    taskid: ac75754b-6976-4133-8fc4-f74d458959da
    type: condition
    task:
      id: ac75754b-6976-4133-8fc4-f74d458959da
      version: -1
      name: 'Are progression Available '
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "4"
      "yes":
      - "10"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Confluera.Progressions
            iscontext: true
    view: |-
      {
        "position": {
          "x": -105,
          "y": 600
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "10":
    id: "10"
    taskid: 995a915a-350a-4ce8-8039-562c49a95e38
    type: regular
    task:
      id: 995a915a-350a-4ce8-8039-562c49a95e38
      version: -1
      name: ProgressionsDataWarroom
      scriptName: ProgressionsDataWarroom
      type: regular
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "4"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -440,
          "y": 840
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1465,
        "width": 1310,
        "x": -440,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
fromversion: 5.0.0

tests:
- No tests (auto formatted)
