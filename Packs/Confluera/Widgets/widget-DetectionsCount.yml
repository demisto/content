commonfields:
  id: DetectionsCount
  version: -1
name: DetectionsCount
script: |
  import json

  # Executes confluera-login command/script
  login_data = demisto.executeCommand('confluera-login', {})
  token = login_data[0]['Contents']['access_token']

  # Executes confluera-fetch-detections command/script
  detections_data = demisto.executeCommand('confluera-fetch-detections', { 'access_token': token, 'hours': '24'})
  det_count = len(detections_data[1]['Contents'])

  demisto.results(det_count);
type: python
tags: []
comment: |-
  Logs detections count
enabled: true
scripttarget: 0
subtype: python3
dependson:
  must:
  - Confluera|||confluera-login
  - Confluera|||confluera-fetch-detections
  should:
  - Confluera|||confluera-login
  - Confluera|||confluera-fetch-detections
runonce: false
dockerimage: demisto/python3:3.9.4.18682
runas: DBotWeakRole
fromversion: 5.0.0
tests:
- No tests (auto formatted)
