[
  "######### templates_type: raw",
  {
    "args": {
      "templates_type": "raw",
      "template_name": "test",
      "templates": {
        "test": {
          "query": {
            "xql": "Dummy XQL"
          },
          "entry": {
            "type": "duration",
            "duration": {
              "field": "_duration"
            }
          }
        }
      }
    },
    "xql": {
      "response": "./test_data/qr_duration.json"
    },
    "results": {
      "Entry": {
        "Type": 17,
        "ContentsFormat": "duration",
        "Contents": {
          "stats": 1234
        }
      }
    }
  },
  "######### cache_type: dataset - hit",
  {
    "args": {
      "templates_type": "raw",
      "template_name": "test",
      "templates": {
        "test": {
          "query": {
            "xql": "dataset = panw_ngfw_traffic_raw| limit 1| alter _duration = 1234| fields _duration"
          },
          "entry": {
            "type": "duration",
            "duration": {
              "field": "_duration"
            }
          }
        }
      },
      "earliest_time": "2024-12-14T15:33:34+00:00",
      "latest_time": "2024-12-15T15:33:34+00:00",
      "cache_type": "dataset"
    },
    "context": {
      "XQLDSHelperCache": {
        "test": {
          "CacheDataset": {
            "data": "ABzY8#`t?@0{@GyR*Fw4ElMoO%+FJ@QZO_!HmQvT0KfN@nH2y400",
            "type": "gz+b85"
          },
          "QueryHash": "663b242503dc8fe5a3e4b76f5b35d669a236c0346d60d878d8e357e6ad04a44d"
        }
      }
    },
    "results": {
      "Entry": {
        "Type": 17,
        "ContentsFormat": "duration",
        "Contents": {
          "stats": 1234
        }
      }
    }
  },
  "######### cache_type: entry - hit",
  {
    "args": {
      "templates_type": "raw",
      "template_name": "test",
      "templates": {
        "test": {
          "query": {
            "xql": "dataset = panw_ngfw_traffic_raw| limit 1| alter _duration = 1234| fields _duration"
          },
          "entry": {
            "type": "duration",
            "duration": {
              "field": "_duration"
            }
          }
        }
      },
      "earliest_time": "2024-12-14T15:33:34+00:00",
      "latest_time": "2024-12-15T15:33:34+00:00",
      "cache_type": "entry"
    },
    "context": {
      "XQLDSHelperCache": {
        "test": {
          "CacheEntry": {
            "data": "ABzY8K>2%T0{^R43aKneRkBhrG}lp3a?Z~yNzE%McFQlyO)LS5Dy5VbC6;97=P4n{0>!J9ic1o~EJGt>liFGUUY5T3M*si-",
            "type": "gz+b85"
          },
          "QueryHash": "663b242503dc8fe5a3e4b76f5b35d669a236c0346d60d878d8e357e6ad04a44d"
        }
      }
    },
    "results": {
      "Entry": {
        "Type": 17,
        "ContentsFormat": "duration",
        "Contents": {
          "stats": 1234
        }
      }
    }
  },
  "######### earliest_time/latest_time - default",
  {
    "args": {
      "templates_type": "raw",
      "template_name": "test",
      "templates": {
        "test": {
          "query": {
            "xql": "Dummy XQL"
          },
          "entry": {
            "type": "duration",
            "duration": {
              "field": "_duration"
            }
          }
        }
      },
      "base_time": "2025-01-01T01:23:45Z",
      "round_time": "0"
    },
    "xql": {
      "response": "./test_data/qr_duration.json"
    },
    "results": {
      "QueryParams": {
        "query_name": "test",
        "query_string": "Dummy XQL",
        "earliest_time": "2024-12-31T01:23:45.000+00:00",
        "latest_time": "2025-01-01T01:23:45.000+00:00"
      }
    }
  },
  "######### earliest_time/latest_time - specific time",
  {
    "args": {
      "templates_type": "raw",
      "template_name": "test",
      "templates": {
        "test": {
          "query": {
            "xql": "Dummy XQL"
          },
          "entry": {
            "type": "duration",
            "duration": {
              "field": "_duration"
            }
          }
        }
      },
      "base_time": "2025-01-01T01:23:45Z",
      "round_time": "0",
      "earliest_time": "2025-01-23T12:34:56+09:00",
      "latest_time": "2025-01-23T12:34:56+09:00"
    },
    "xql": {
      "response": "./test_data/qr_duration.json"
    },
    "results": {
      "QueryParams": {
        "query_name": "test",
        "query_string": "Dummy XQL",
        "earliest_time": "2025-01-23T12:34:56.000+09:00",
        "latest_time": "2025-01-23T12:34:56.000+09:00"
      }
    }
  },
  "######### earliest_time/latest_time - unix time",
  {
    "args": {
      "templates_type": "raw",
      "template_name": "test",
      "templates": {
        "test": {
          "query": {
            "xql": "Dummy XQL"
          },
          "entry": {
            "type": "duration",
            "duration": {
              "field": "_duration"
            }
          }
        }
      },
      "base_time": "2025-01-01T01:23:45Z",
      "round_time": "0",
      "earliest_time": "1735689600",
      "latest_time": "1767225600"
    },
    "xql": {
      "response": "./test_data/qr_duration.json"
    },
    "results": {
      "QueryParams": {
        "query_name": "test",
        "query_string": "Dummy XQL",
        "earliest_time": "2025-01-01T00:00:00.000+00:00",
        "latest_time": "2026-01-01T00:00:00.000+00:00"
      }
    }
  },
  "######### round_time: 0 (milliseconds without rounding)",
  {
    "args": {
      "templates_type": "raw",
      "template_name": "test",
      "templates": {
        "test": {
          "query": {
            "xql": "Dummy XQL"
          },
          "entry": {
            "type": "duration",
            "duration": {
              "field": "_duration"
            }
          }
        }
      },
      "base_time": "2025-01-01T01:23:45.123Z",
      "round_time": "0",
      "earliest_time": "24 hours ago",
      "latest_time": "0 seconds ago"
    },
    "xql": {
      "response": "./test_data/qr_duration.json"
    },
    "results": {
      "QueryParams": {
        "query_name": "test",
        "query_string": "Dummy XQL",
        "earliest_time": "2024-12-31T01:23:45.123+00:00",
        "latest_time": "2025-01-01T01:23:45.123+00:00"
      }
    }
  },
  "######### round_time: 1 (rounded to seconds)",
  {
    "args": {
      "templates_type": "raw",
      "template_name": "test",
      "templates": {
        "test": {
          "query": {
            "xql": "Dummy XQL"
          },
          "entry": {
            "type": "duration",
            "duration": {
              "field": "_duration"
            }
          }
        }
      },
      "base_time": "2025-01-01T01:23:45.1234Z",
      "round_time": "1",
      "earliest_time": "24 hours ago",
      "latest_time": "0 seconds ago"
    },
    "xql": {
      "response": "./test_data/qr_duration.json"
    },
    "results": {
      "QueryParams": {
        "query_name": "test",
        "query_string": "Dummy XQL",
        "earliest_time": "2024-12-31T01:23:45.000+00:00",
        "latest_time": "2025-01-01T01:23:45.000+00:00"
      }
    }
  },
  "######### round_time: 3600 (rounded to hours)",
  {
    "args": {
      "templates_type": "raw",
      "template_name": "test",
      "templates": {
        "test": {
          "query": {
            "xql": "Dummy XQL"
          },
          "entry": {
            "type": "duration",
            "duration": {
              "field": "_duration"
            }
          }
        }
      },
      "base_time": "2025-01-01T01:23:45.1234Z",
      "round_time": "3600",
      "earliest_time": "24 hours ago",
      "latest_time": "0 seconds ago"
    },
    "xql": {
      "response": "./test_data/qr_duration.json"
    },
    "results": {
      "QueryParams": {
        "query_name": "test",
        "query_string": "Dummy XQL",
        "earliest_time": "2024-12-31T01:00:00.000+00:00",
        "latest_time": "2025-01-01T01:00:00.000+00:00"
      }
    }
  },
  "######### empty response & minimum entry settings: markdown",
  {
    "args": {
      "templates_type": "raw",
      "template_name": "test",
      "templates": {
        "test": {
          "query": {
            "xql": "Dummy XQL"
          },
          "entry": {
            "type": "markdown"
          }
        }
      }
    },
    "xql": {
      "response": "./test_data/qr_empty_list.json"
    },
    "results": {
      "Entry": {
        "Type": 1,
        "ContentsFormat": "markdown",
        "HumanReadable": "",
        "Contents": null
      }
    }
  },
  "######### empty response: markdown - default text",
  {
    "args": {
      "templates_type": "raw",
      "template_name": "test",
      "templates": {
        "test": {
          "query": {
            "xql": "Dummy XQL"
          },
          "entry": {
            "type": "markdown",
            "markdown": {
              "default": "## No data"
            }
          }
        }
      }
    },
    "xql": {
      "response": "./test_data/qr_empty_list.json"
    },
    "results": {
      "Entry": {
        "Type": 1,
        "ContentsFormat": "markdown",
        "HumanReadable": "## No data",
        "Contents": null
      }
    }
  },
  "######### empty response: markdown - default entry",
  {
    "args": {
      "templates_type": "raw",
      "template_name": "test",
      "templates": {
        "test": {
          "query": {
            "xql": "Dummy XQL"
          },
          "entry": {
            "type": "markdown",
            "markdown": {
              "default": {
                "Type": 1,
                "ContentsFormat": "markdown",
                "HumanReadable": "**No entries.**",
                "Contents": null
              }
            }
          }
        }
      }
    },
    "xql": {
      "response": "./test_data/qr_empty_list.json"
    },
    "results": {
      "Entry": {
        "Type": 1,
        "ContentsFormat": "markdown",
        "HumanReadable": "**No entries.**",
        "Contents": null
      }
    }
  },
  "######### empty response & minimum entry settings: markdown-table",
  {
    "args": {
      "templates_type": "raw",
      "template_name": "test",
      "templates": {
        "test": {
          "query": {
            "xql": "Dummy XQL"
          },
          "entry": {
            "type": "markdown-table"
          }
        }
      }
    },
    "xql": {
      "response": "./test_data/qr_empty_list.json"
    },
    "results": {
      "Entry": {
        "Type": 1,
        "ContentsFormat": "markdown",
        "HumanReadable": "",
        "Contents": null
      }
    }
  },
  "######### empty response: markdown-table - default text",
  {
    "args": {
      "templates_type": "raw",
      "template_name": "test",
      "templates": {
        "test": {
          "query": {
            "xql": "Dummy XQL"
          },
          "entry": {
            "type": "markdown-table",
            "markdown-table": {
              "default": "## No data"
            }
          }
        }
      }
    },
    "xql": {
      "response": "./test_data/qr_empty_list.json"
    },
    "results": {
      "Entry": {
        "Type": 1,
        "ContentsFormat": "markdown",
        "HumanReadable": "## No data",
        "Contents": null
      }
    }
  },
  "######### empty response: markdown-table - default entry",
  {
    "args": {
      "templates_type": "raw",
      "template_name": "test",
      "templates": {
        "test": {
          "query": {
            "xql": "Dummy XQL"
          },
          "entry": {
            "type": "markdown-table",
            "markdown-table": {
              "default": {
                "Type": 1,
                "ContentsFormat": "markdown",
                "HumanReadable": "**No entries.**",
                "Contents": null
              }
            }
          }
        }
      }
    },
    "xql": {
      "response": "./test_data/qr_empty_list.json"
    },
    "results": {
      "Entry": {
        "Type": 1,
        "ContentsFormat": "markdown",
        "HumanReadable": "**No entries.**",
        "Contents": null
      }
    }
  },
  "######### empty response  & minimum entry settings: number",
  {
    "args": {
      "templates_type": "raw",
      "template_name": "test",
      "templates": {
        "test": {
          "query": {
            "xql": "Dummy XQL"
          },
          "entry": {
            "type": "number",
            "number": {
              "field": "n"
            }
          }
        }
      }
    },
    "xql": {
      "response": "./test_data/qr_empty_list.json"
    },
    "results": {
      "Entry": {
        "Type": 17,
        "ContentsFormat": "number",
        "Contents": {
          "stats": 0
        }
      }
    }
  },
  "######### empty response  & minimum entry settings: number-trend",
  {
    "args": {
      "templates_type": "raw",
      "template_name": "test",
      "templates": {
        "test": {
          "query": {
            "xql": "Dummy XQL"
          },
          "entry": {
            "type": "number-trend",
            "number-trend": {
              "prev-field": "last_n",
              "curr-field": "curr_n"
            }
          }
        }
      }
    },
    "xql": {
      "response": "./test_data/qr_empty_list.json"
    },
    "results": {
      "Entry": {
        "Type": 17,
        "ContentsFormat": "number",
        "Contents": {
          "stats": {
            "prevSum": 0,
            "currSum": 0
          }
        }
      }
    }
  },
  "######### empty response  & minimum entry settings: pie - records",
  {
    "args": {
      "templates_type": "raw",
      "template_name": "test",
      "templates": {
        "test": {
          "query": {
            "xql": "Dummy XQL"
          },
          "entry": {
            "type": "pie",
            "pie": {
              "group": "records",
              "records": {
                "name-field": "app",
                "data-field": "count"
              }
            }
          }
        }
      }
    },
    "xql": {
      "response": "./test_data/qr_empty_list.json"
    },
    "results": {
      "Entry": {
        "Type": 17,
        "ContentsFormat": "pie",
        "Contents": {
          "stats": []
        }
      }
    }
  },
  "######### empty response  & minimum entry settings: pie - fields",
  {
    "args": {
      "templates_type": "raw",
      "template_name": "test",
      "templates": {
        "test": {
          "query": {
            "xql": "Dummy XQL"
          },
          "entry": {
            "type": "pie",
            "pie": {
              "group": "fields",
              "fields": {}
            }
          }
        }
      }
    },
    "xql": {
      "response": "./test_data/qr_empty_list.json"
    },
    "results": {
      "Entry": {
        "Type": 17,
        "ContentsFormat": "pie",
        "Contents": {
          "stats": []
        }
      }
    }
  },
  "######### empty response  & minimum entry settings: line - records",
  {
    "args": {
      "templates_type": "raw",
      "template_name": "test",
      "templates": {
        "test": {
          "query": {
            "xql": "Dummy XQL"
          },
          "entry": {
            "type": "line",
            "line": {
              "x": {
                "by": "time_ymd"
              },
              "y": {
                "group": "records",
                "records": {
                  "name-field": "app",
                  "data-field": "count"
                }
              }
            }
          }
        }
      }
    },
    "xql": {
      "response": "./test_data/qr_empty_list.json"
    },
    "results": {
      "Entry": {
        "Type": 17,
        "ContentsFormat": "line",
        "Contents": {
          "stats": []
        }
      }
    }
  },
  "######### empty response  & minimum entry settings: line - fields",
  {
    "args": {
      "templates_type": "raw",
      "template_name": "test",
      "templates": {
        "test": {
          "query": {
            "xql": "Dummy XQL"
          },
          "entry": {
            "type": "line",
            "line": {
              "x": {
                "by": "time_ymd"
              },
              "y": {
                "group": "fields",
                "fields": {}
              }
            }
          }
        }
      }
    },
    "xql": {
      "response": "./test_data/qr_empty_list.json"
    },
    "results": {
      "Entry": {
        "Type": 17,
        "ContentsFormat": "line",
        "Contents": {
          "stats": []
        }
      }
    }
  },
  "######### empty response  & minimum entry settings: single-bar - records",
  {
    "args": {
      "templates_type": "raw",
      "template_name": "test",
      "templates": {
        "test": {
          "query": {
            "xql": "Dummy XQL"
          },
          "entry": {
            "type": "single-bar",
            "single-bar": {
              "group": "records",
              "records": {
                "name-field": "app",
                "data-field": "count"
              }
            }
          }
        }
      }
    },
    "xql": {
      "response": "./test_data/qr_empty_list.json"
    },
    "results": {
      "Entry": {
        "Type": 17,
        "ContentsFormat": "bar",
        "Contents": {
          "stats": []
        }
      }
    }
  },
  "######### empty response  & minimum entry settings: single-bar - fields",
  {
    "args": {
      "templates_type": "raw",
      "template_name": "test",
      "templates": {
        "test": {
          "query": {
            "xql": "Dummy XQL"
          },
          "entry": {
            "type": "single-bar",
            "single-bar": {
              "group": "fields",
              "fields": {}
            }
          }
        }
      }
    },
    "xql": {
      "response": "./test_data/qr_empty_list.json"
    },
    "results": {
      "Entry": {
        "Type": 17,
        "ContentsFormat": "bar",
        "Contents": {
          "stats": []
        }
      }
    }
  },
  "######### empty response  & minimum entry settings: stacked-bar - records",
  {
    "args": {
      "templates_type": "raw",
      "template_name": "test",
      "templates": {
        "test": {
          "query": {
            "xql": "Dummy XQL"
          },
          "entry": {
            "type": "stacked-bar",
            "stacked-bar": {
              "x": {
                "by": "time_ymd"
              },
              "y": {
                "group": "records",
                "records": {
                  "name-field": "app",
                  "data-field": "count"
                }
              }
            }
          }
        }
      }
    },
    "xql": {
      "response": "./test_data/qr_empty_list.json"
    },
    "results": {
      "Entry": {
        "Type": 17,
        "ContentsFormat": "bar",
        "Contents": {
          "stats": []
        }
      }
    }
  },
  "######### empty response  & minimum entry settings: stacked-bar - fields",
  {
    "args": {
      "templates_type": "raw",
      "template_name": "test",
      "templates": {
        "test": {
          "query": {
            "xql": "Dummy XQL"
          },
          "entry": {
            "type": "stacked-bar",
            "stacked-bar": {
              "x": {
                "by": "time_ymd"
              },
              "y": {
                "group": "fields",
                "fields": {}
              }
            }
          }
        }
      }
    },
    "xql": {
      "response": "./test_data/qr_empty_list.json"
    },
    "results": {
      "Entry": {
        "Type": 17,
        "ContentsFormat": "bar",
        "Contents": {
          "stats": []
        }
      }
    }
  },
  "######### empty response  & minimum entry settings: duration",
  {
    "args": {
      "templates_type": "raw",
      "template_name": "test",
      "templates": {
        "test": {
          "query": {
            "xql": "Dummy XQL"
          },
          "entry": {
            "type": "duration",
            "duration": {
              "field": "_duration"
            }
          }
        }
      }
    },
    "xql": {
      "response": "./test_data/qr_empty_list.json"
    },
    "results": {
      "Entry": {
        "Type": 17,
        "ContentsFormat": "duration",
        "Contents": {
          "stats": 0
        }
      }
    }
  },
  "######### sort - different data types",
  {
    "args": {
      "templates_type": "raw",
      "template_name": "test",
      "templates": {
        "test": {
          "query": {
            "xql": "Dummy XQL"
          },
          "entry": {
            "type": "markdown-table",
            "markdown-table": {
              "title": "title",
              "sort": {
                "by": "count",
                "order": "asc"
              }
            }
          }
        }
      }
    },
    "xql": {
      "response": "./test_data/qr_different_data_types.json"
    },
    "results": {
      "Entry": {
        "Type": 1,
        "ContentsFormat": "markdown",
        "HumanReadable": "### title\n|Type|App|Count|\n|---|---|---|\n| null | dns-base |  |\n| null | dns-base |  |\n| bool | dns-base | false |\n| bool | dns-base | true |\n| float | dns-base | 1.234 |\n| float | dns-base | 3.456 |\n| int | dns-base | 123 |\n| int | dns-base | 456 |\n| str | dns-base | value1 |\n| str | dns-base | value2 |\n| list | dns-base | 1,<br>2,<br>3 |\n| list | dns-base | 4,<br>5,<br>6 |\n| dict | dns-base | a: x |\n| dict | dns-base | b: y |\n",
        "Contents": null
      }
    }
  },
  "######### base_time - alert.occurred",
  {
    "args": {
      "templates_type": "raw",
      "template_name": "test",
      "templates": {
        "test": {
          "query": {
            "xql": "Dummy XQL"
          },
          "entry": {
            "type": "duration",
            "duration": {
              "field": "_duration"
            }
          }
        }
      },
      "earliest_time": "24 hours ago",
      "latest_time": "0 seconds ago"
    },
    "xql": {
      "response": "./test_data/qr_duration.json"
    },
    "config": {
      "is_xsiam": true
    },
    "alert": {
      "occurred": "2025-01-01T01:23:45.1234Z",
      "created": "0001-01-01T00:00:00Z"
    },
    "results": {
      "QueryParams": {
        "query_name": "test",
        "query_string": "Dummy XQL",
        "earliest_time": "2024-12-31T01:23:45.123+00:00",
        "latest_time": "2025-01-01T01:23:45.123+00:00"
      }
    }
  },
  "######### base_time - alert.created",
  {
    "args": {
      "templates_type": "raw",
      "template_name": "test",
      "templates": {
        "test": {
          "query": {
            "xql": "Dummy XQL"
          },
          "entry": {
            "type": "duration",
            "duration": {
              "field": "_duration"
            }
          }
        }
      },
      "earliest_time": "24 hours ago",
      "latest_time": "0 seconds ago"
    },
    "xql": {
      "response": "./test_data/qr_duration.json"
    },
    "config": {
      "is_xsiam": true
    },
    "alert": {
      "occurred": "0001-01-01T00:00:00Z",
      "created": "2025-01-01T01:23:45.1234Z"
    },
    "results": {
      "QueryParams": {
        "query_name": "test",
        "query_string": "Dummy XQL",
        "earliest_time": "2024-12-31T01:23:45.123+00:00",
        "latest_time": "2025-01-01T01:23:45.123+00:00"
      }
    }
  },
  "######### base_time - incident.occurred",
  {
    "args": {
      "templates_type": "raw",
      "template_name": "test",
      "templates": {
        "test": {
          "query": {
            "xql": "Dummy XQL"
          },
          "entry": {
            "type": "duration",
            "duration": {
              "field": "_duration"
            }
          }
        }
      },
      "earliest_time": "24 hours ago",
      "latest_time": "0 seconds ago"
    },
    "xql": {
      "response": "./test_data/qr_duration.json"
    },
    "config": {
      "is_xsiam": false
    },
    "incident": {
      "occurred": "2025-01-01T01:23:45.1234Z",
      "created": "0001-01-01T00:00:00Z"
    },
    "results": {
      "QueryParams": {
        "query_name": "test",
        "query_string": "Dummy XQL",
        "earliest_time": "2024-12-31T01:23:45.123+00:00",
        "latest_time": "2025-01-01T01:23:45.123+00:00"
      }
    }
  },
  "######### base_time - incident.created",
  {
    "args": {
      "templates_type": "raw",
      "template_name": "test",
      "templates": {
        "test": {
          "query": {
            "xql": "Dummy XQL"
          },
          "entry": {
            "type": "duration",
            "duration": {
              "field": "_duration"
            }
          }
        }
      },
      "earliest_time": "24 hours ago",
      "latest_time": "0 seconds ago"
    },
    "xql": {
      "response": "./test_data/qr_duration.json"
    },
    "config": {
      "is_xsiam": false
    },
    "incident": {
      "occurred": "0001-01-01T00:00:00Z",
      "created": "2025-01-01T01:23:45.1234Z"
    },
    "results": {
      "QueryParams": {
        "query_name": "test",
        "query_string": "Dummy XQL",
        "earliest_time": "2024-12-31T01:23:45.123+00:00",
        "latest_time": "2025-01-01T01:23:45.123+00:00"
      }
    }
  },
  "######### base_time - default: now",
  {
    "args": {
      "templates_type": "raw",
      "template_name": "test",
      "templates": {
        "test": {
          "query": {
            "xql": "Dummy XQL"
          },
          "entry": {
            "type": "duration",
            "duration": {
              "field": "_duration"
            }
          }
        }
      },
      "earliest_time": "24 hours ago",
      "latest_time": "0 seconds ago"
    },
    "xql": {
      "response": "./test_data/qr_duration.json"
    },
    "config": {
      "now": "2025-01-01T01:23:45.123+00:00"
    },
    "results": {
      "QueryParams": {
        "query_name": "test",
        "query_string": "Dummy XQL",
        "earliest_time": "2024-12-31T01:23:45.123+00:00",
        "latest_time": "2025-01-01T01:23:45.123+00:00"
      }
    }
  }
]