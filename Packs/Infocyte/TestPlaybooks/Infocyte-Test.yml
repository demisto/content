id: Infocyte-Test
version: 4
name: Infocyte-Test
description: Test Playbook for Infocyte commands
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 59aa5ed1-6e7e-4b4e-8cc2-4bc6cf0edeb0
    type: start
    task:
      id: 59aa5ed1-6e7e-4b4e-8cc2-4bc6cf0edeb0
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "1":
    id: "1"
    taskid: be2d6ce8-7600-477b-877c-27eea59affae
    type: regular
    task:
      id: be2d6ce8-7600-477b-877c-27eea59affae
      version: -1
      name: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 200
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "2":
    id: "2"
    taskid: 2e6b27aa-3dab-4bce-8408-f4931deb6c31
    type: regular
    task:
      id: 2e6b27aa-3dab-4bce-8408-f4931deb6c31
      version: -1
      name: infocyte-scan-host
      description: Kicks off a Scan (forensic collection) against an endpoint
      script: '|||infocyte-scan-host'
      type: regular
      iscommand: true
      brand: Infocyte
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      target:
        simple: ${incident.sourcehostname}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "3":
    id: "3"
    taskid: d5f9251f-7f99-407a-8efa-a95864e84f0f
    type: condition
    task:
      id: d5f9251f-7f99-407a-8efa-a95864e84f0f
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "15"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Infocyte.Task.userTaskId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Infocyte.Task.type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Infocyte.Task.target
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 580
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "6":
    id: "6"
    taskid: e98f9a44-5499-4f34-841a-3a9833630dea
    type: condition
    task:
      id: e98f9a44-5499-4f34-841a-3a9833630dea
      version: -1
      name: infocyte-get-hostscanresult
      description: Retrieve results for a scan on a target host
      type: condition
      iscommand: false
      brand: Infocyte
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Infocyte.Task.status
            iscontext: true
          right:
            value:
              simple: completed
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1105
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "7":
    id: "7"
    taskid: b7ae3936-3be8-4302-81c8-db4649f2b131
    type: condition
    task:
      id: b7ae3936-3be8-4302-81c8-db4649f2b131
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "12"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Infocyte.Scan.scanId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Infocyte.Scan.hostId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Infocyte.Scan.os
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Infocyte.Scan.compromised
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Infocyte.Scan.alerts
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Infocyte.Scan.alertCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Infocyte.Scan.hostname
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Infocyte.Scan.ip
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Infocyte.Scan.compromisedObjects
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Infocyte.Scan.objectCount
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1265
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "12":
    id: "12"
    taskid: 8232b464-4462-40f5-8a65-8c223cad2484
    type: regular
    task:
      id: 8232b464-4462-40f5-8a65-8c223cad2484
      version: -1
      name: infocyte-get-alerts
      script: '|||infocyte-get-alerts'
      type: regular
      iscommand: true
      brand: Infocyte
    nexttasks:
      '#none#':
      - "13"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "13":
    id: "13"
    taskid: 471eee8a-e438-47d9-85d5-636339b3c34b
    type: condition
    task:
      id: 471eee8a-e438-47d9-85d5-636339b3c34b
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "14"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Infocyte.Alert.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Infocyte.Alert.scanId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Infocyte.Alert.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Infocyte.Alert.type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Infocyte.Alert.threatName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Infocyte.Alert.hasAvScan
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Infocyte.Alert.threatScore
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Infocyte.Alert.avPositive
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Infocyte.Alert.avTotal
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Infocyte.Alert.synapse
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Infocyte.Alert.size
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Infocyte.Alert.flagname
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Infocyte.Alert.flagWeight
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Infocyte.Alert.createdOn
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Infocyte.Alert.hostname
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Infocyte.Alert.sha1
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Infocyte.Alert.signed
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Infocyte.Alert.managed
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1580
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "14":
    id: "14"
    taskid: 2530687f-728b-4014-8b44-992f2a7b0d6f
    type: title
    task:
      id: 2530687f-728b-4014-8b44-992f2a7b0d6f
      version: -1
      name: Test Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1740
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "15":
    id: "15"
    taskid: 8bcc00d9-ea35-4e0b-8638-bd97249c99d6
    type: regular
    task:
      id: 8bcc00d9-ea35-4e0b-8638-bd97249c99d6
      version: -1
      name: infocyte-get-taskstatus Polling
      description: Called by the GenericPolling playbook, schedules the polling task.
      scriptName: ScheduleGenericPolling
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      additionalPollingCommandArgNames: {}
      additionalPollingCommandArgValues: {}
      dt:
        simple: Infocyte.Task(val.status == ‘active’).id
      ids:
        simple: ${Infocyte.Task.userTaskId}
      interval:
        simple: "2"
      playbookId: {}
      pollingCommand:
        simple: infocyte-get-taskstatus
      pollingCommandArgName:
        simple: userTaskId
      tag: {}
      timeout: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 795
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "16":
    id: "16"
    taskid: 81cf8ea7-3c8a-45c2-8a3f-bae0957e1b8c
    type: regular
    task:
      id: 81cf8ea7-3c8a-45c2-8a3f-bae0957e1b8c
      version: -1
      name: infocyte-get-taskstatus
      description: Gets status of an Infocyte task (scan, response action, etc.)
      script: Infocyte|||infocyte-get-taskstatus
      type: regular
      iscommand: true
      brand: Infocyte
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      userTaskId:
        simple: ${Infocyte.Task.userTaskId}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 960
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1755,
        "width": 380,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
fromversion: 5.5.0
