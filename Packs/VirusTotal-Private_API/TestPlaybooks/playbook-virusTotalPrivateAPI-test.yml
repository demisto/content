id: virusTotalPrivateAPI-test-playbook
version: -1
name: playbook-virusTotalPrivateAPI-test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: f0d8436c-3c2e-4042-8e7a-49c04234eeb3
    type: start
    task:
      id: f0d8436c-3c2e-4042-8e7a-49c04234eeb3
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "1":
    id: "1"
    taskid: dadae763-3c66-4bd2-8b6c-95fc58065492
    type: regular
    task:
      id: dadae763-3c66-4bd2-8b6c-95fc58065492
      version: -1
      name: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "2":
    id: "2"
    taskid: ff0ac861-9e8e-43ad-804e-0e01d1ff827c
    type: regular
    task:
      id: ff0ac861-9e8e-43ad-804e-0e01d1ff827c
      version: -1
      name: vt-private-check-file-behaviour
      script: '|||vt-private-check-file-behaviour'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      fullResponse: {}
      resource:
        simple: 10676cf66244cfa91567fbc1a937f4cb19438338b35b69d4bcc2cf0d3a44af5e
      threshold: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "4":
    id: "4"
    taskid: 97d09381-e8ee-4702-8bbe-79b5371db3bf
    type: regular
    task:
      id: 97d09381-e8ee-4702-8bbe-79b5371db3bf
      version: -1
      name: vt-private-get-domain-report
      script: '|||vt-private-get-domain-report'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      domain:
        simple: google.com
      fullResponse: {}
      threshold: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "5":
    id: "5"
    taskid: 48fa34d1-e518-42f7-834b-9390c9583dd3
    type: condition
    task:
      id: 48fa34d1-e518-42f7-834b-9390c9583dd3
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "6"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.Name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.VirusTotal.CommunicatingHashes
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.VirusTotal.Whois
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.VirusTotal.Subdomains
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.VirusTotal.Resolutions
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.VirusTotal.Categories
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "6":
    id: "6"
    taskid: e57a8a25-398e-4bbc-8126-10a65f9c1b49
    type: regular
    task:
      id: e57a8a25-398e-4bbc-8126-10a65f9c1b49
      version: -1
      name: vt-private-get-file-report
      script: '|||vt-private-get-file-report'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      allInfo: {}
      resource:
        simple: 10676cf66244cfa91567fbc1a937f4cb19438338b35b69d4bcc2cf0d3a44af5e
      shortFormat: {}
      threshold: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "7":
    id: "7"
    taskid: 003fb0c7-9013-47dc-8386-9525ff2fa621
    type: condition
    task:
      id: 003fb0c7-9013-47dc-8386-9525ff2fa621
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "8"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: File.MD5
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: File.SHA1
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: File.SHA256
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotScore.Type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotScore.Vendor
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: File.VirusTotal.Scans
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: VirusTotal.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: VirusTotal.Status
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "8":
    id: "8"
    taskid: d8e7e998-1277-4fe1-8a55-69e4964042db
    type: regular
    task:
      id: d8e7e998-1277-4fe1-8a55-69e4964042db
      version: -1
      name: vt-private-get-url-report
      script: '|||vt-private-get-url-report'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      allInfo: {}
      fullResponse: {}
      resource:
        simple: www.demisto.com
      retries: {}
      retry_time: {}
      shortFormat: {}
      threshold: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "9":
    id: "9"
    taskid: 0c2e91a8-436d-4b31-8764-0322fbfc7338
    type: condition
    task:
      id: 0c2e91a8-436d-4b31-8764-0322fbfc7338
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "10"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: URL.Data
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotScore.Type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotScore.Vendor
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: URL.VirusTotal.Scans
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "10":
    id: "10"
    taskid: d009908b-0a11-460e-87ff-add8fcc1d5ca
    type: regular
    task:
      id: d009908b-0a11-460e-87ff-add8fcc1d5ca
      version: -1
      name: vt-private-get-ip-report
      script: '|||vt-private-get-ip-report'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      fullResponse: {}
      ip:
        simple: 8.8.8.8
      threshold: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "11":
    id: "11"
    taskid: 3c5a79dc-7945-4137-8f51-fb5d8cddb053
    type: condition
    task:
      id: 3c5a79dc-7945-4137-8f51-fb5d8cddb053
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "12"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: IP.Address
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: IP.ASN
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: IP.Geo.Country
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: IP.Malicious.Vendor
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: IP.Malicious.Description
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotScore.Type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotScore.Vendor
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: IP.VirusTotal.DownloadedHashes
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: IP.VirusTotal.UnAVDetectedDownloadedHashes
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: IP.VirusTotal.DetectedURLs
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: IP.VirusTotal.CommunicatingHashes
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: IP.VirusTotal.UnAVDetectedCommunicatingHashes
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: IP.VirusTotal.Resolutions.hostname
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: IP.VirusTotal.ReferrerHashes
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: IP.VirusTotal.UnAVDetectedReferrerHashes
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: IP.VirusTotal.Resolutions.last_resolved
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "12":
    id: "12"
    taskid: 3d22eeb1-fc38-4e11-8a52-c1983ba20f27
    type: regular
    task:
      id: 3d22eeb1-fc38-4e11-8a52-c1983ba20f27
      version: -1
      name: vt-private-search-file
      script: '|||vt-private-search-file'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      fullResponse: {}
      query:
        simple: type:peexe size:90kb+ positives:5+ behaviour:'taskkill'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "13":
    id: "13"
    taskid: 293021d2-2387-4b93-8b58-86d06a48161a
    type: condition
    task:
      id: 293021d2-2387-4b93-8b58-86d06a48161a
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "14"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: VirusTotal.SearchFile.SearchResult
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: VirusTotal.SearchFile.Query
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "14":
    id: "14"
    taskid: 3a3e340a-b25f-41b0-8f73-c359dee4a75c
    type: regular
    task:
      id: 3a3e340a-b25f-41b0-8f73-c359dee4a75c
      version: -1
      name: vt-private-hash-communication
      script: '|||vt-private-hash-communication'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      fullResponse: {}
      hash:
        simple: 10676cf66244cfa91567fbc1a937f4cb19438338b35b69d4bcc2cf0d3a44af5e
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "16":
    id: "16"
    taskid: f15ee0d0-f7bd-407a-80a7-2378d72f5ff3
    type: regular
    task:
      id: f15ee0d0-f7bd-407a-80a7-2378d72f5ff3
      version: -1
      name: vt-private-download-file
      script: '|||vt-private-download-file'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      hash:
        simple: ba5d0f897e89ff70cffb3e95e4d54ea152d6a273a95bdff2224a224c90c0d16e
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "17":
    id: "17"
    taskid: c0511158-5425-4d10-8ace-669375f9cad1
    type: title
    task:
      id: c0511158-5425-4d10-8ace-669375f9cad1
      version: -1
      name: Test Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2660,
        "width": 380,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
