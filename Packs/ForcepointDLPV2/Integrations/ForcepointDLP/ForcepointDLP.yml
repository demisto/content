category: Utilities
commonfields:
  id: ForcepointDLP
  version: -1
configuration:
- display: Server URL (e.g., https://<DLP_Manager_IP>:<port>)
  name: url
  required: true
  section: Connect
  type: 0
- display: User Name
  displaypassword: Password
  name: credentials
  required: true
  section: Connect
  type: 9
- advanced: true
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  section: Connect
  type: 8
- advanced: true
  display: Use system proxy settings
  name: proxy
  required: false
  section: Connect
  type: 8
- defaultvalue: 'true'
  display: Enable incident fetching
  name: isFetch
  required: false
  type: 8
- defaultvalue: 24h
  display: First fetch window (e.g., 24h, 7d, 60m)
  name: incidentFetchInterval
  required: false
  type: 0
- defaultvalue: IN_PROGRESS
  display: Fetch status filter (default IN_PROGRESS)
  name: fetch_status
  required: false
  type: 0
- display: Fetch from_date (DD/MM/YYYY HH:MM:SS)
  name: fetch_from_date
  required: false
  type: 0
- display: Fetch to_date (DD/MM/YYYY HH:MM:SS)
  name: fetch_to_date
  required: false
  type: 0
- defaultvalue: '50'
  display: Maximum incidents per fetch
  name: max_fetch
  required: false
  type: 0
- defaultvalue: 'true'
  display: Ignore static from/to dates; use incremental watermark (recommended)
  name: ignore_static_dates
  required: false
  type: 8
- defaultvalue: INSERT_DATE
  display: Watermark field name (default INSERT_DATE)
  name: watermark_field
  required: false
  type: 0
- defaultvalue: eventId
  display: Dedup key field name (default eventId)
  name: dedup_key_field
  required: false
  type: 0
- defaultvalue: '1000'
  display: Dedup cache size
  name: dedup_cache_size
  required: false
  type: 0
- display: Incident type
  name: incidentType
  required: false
  type: 13
- display: Fetch incidents
  name: isFetch
  type: 8
description: "Forcepoint DLP REST integration (auth + incidents) aligned to Forcepoint REST API.\nFeatures:\n  • Auto token refresh (15m access TTL)\n  • Incremental fetch with client-side dedup (watermark + seen event_ids)\n  • Update incidents using Forcepoint-compliant payloads (type/action_type/value + event_ids or incident_id+partition_index)\n  • Admin helpers to view/reset fetch state."
display: Forcepoint DLP
name: ForcepointDLP
script:
  commands:
  - arguments:
    - description: Type of incidents to retrieve (default INCIDENTS).
      name: type
    - description: From date (DD/MM/YYYY HH:MM:SS).
      name: from_date
    - description: To date (DD/MM/YYYY HH:MM:SS).
      name: to_date
    - description: Status filter (e.g., NEW, IN_PROGRESS, CLOSED).
      name: status
    - description: Severity filter (LOW, MEDIUM, HIGH).
      name: severity
    - description: Action filter.
      name: action
    - description: Policy names filter.
      name: policies
    - description: Sort by field (e.g., INSERT_DATE).
      name: sort_by
    name: forcepoint-dlp-get-incidents
  - arguments:
    - description: Comma-separated list or array of event IDs (preferred).
      name: event_ids
    - description: Incident ID (use with partition_index if event_ids not provided).
      name: incident_id
    - description: Partition index paired with incident_id.
      name: partition_index
    - description: Set status (NEW, IN_PROGRESS, CLOSED).
      name: status
    - description: Set severity (LOW, MEDIUM, HIGH).
      name: severity
    - description: Add a tag (string).
      name: tag
    - description: Explicit action type (STATUS|SEVERITY|TAG).
      name: action_type
    - description: Explicit value for action_type.
      name: value
    - description: Optional comment/remark (omit if server rejects).
      name: comments
    name: forcepoint-dlp-update-incident
  - arguments: []
    description: Reset fetch watermark and seen IDs (use with caution).
    name: forcepoint-dlp-reset-state
  - arguments: []
    description: Show current fetch watermark and seen IDs.
    name: forcepoint-dlp-show-state
  dockerimage: demisto/python3:3.12.12.6204436
  isfetch: true
  runonce: false
  script: ''
  subtype: python3
  type: python
fromversion: 6.0.0
tests:
- No tests (auto formatted)
