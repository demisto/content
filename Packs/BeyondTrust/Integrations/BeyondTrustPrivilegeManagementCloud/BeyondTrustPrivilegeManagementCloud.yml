commonfields:
  id: BeyondTrust Privilege Management Cloud
  version: -1
name: BeyondTrust Privilege Management Cloud
display: BeyondTrust Privilege Management Cloud
category: Endpoint
description: BeyondTrust Privilege Management Cloud (PM Cloud) integration for retrieving audit events and activity logs.
configuration:
- display: Server URL
  name: url
  defaultvalue: ""
  type: 0
  required: true
  section: Connect
  help: "The server URL, e.g. https://[yourProductionSub-domainName]-services.pm.beyondtrustcloud.com"
- display: Client ID
  displaypassword: Client Secret
  name: credentials
  required: true
  type: 9
  section: Connect
- display: Events types to fetch
  name: events_types_to_fetch
  defaultvalue: Activity Audits,Events
  type: 16
  required: false
  section: Connect
  options:
  - Activity Audits
  - Events
  - Activity Audits,Events
- display: Trust any certificate (not secure)
  name: insecure
  defaultvalue: "false"
  type: 8
  required: false
  section: Connect
- display: Use system proxy settings
  name: proxy
  defaultvalue: "false"
  type: 8
  required: false
  section: Connect
- display: Fetch events
  name: isFetch
  defaultvalue: "false"
  type: 8
  required: false
  section: Collect
- display: Maximum number of events (per type)
  name: max_fetch
  defaultvalue: "5000"
  type: 0
  required: false
  section: Collect
  help: Maximum number of events to fetch per fetch cycle.
- display: First fetch timestamp
  name: first_fetch
  defaultvalue: "1 minute"
  type: 0
  required: false
  section: Collect
  additionalinfo: "The time from which to start fetching events on first run. Defaults to 1 minute ago to fetch only new events. Use values like '3 days', '1 week' for historical data if needed."
script:
  script: '-'
  type: python
  subtype: python3
  dockerimage: demisto/python3:3.11.10.115186
  isfetchevents: true
  runonce: false
  commands:
  - name: beyondtrust-pm-cloud-get-events
    arguments:
    - name: start_date
      required: false
      description: "Start Date(UTC) to search events from (Elastic Ingestion Timestamp in UTC). Example: 2022-08-12T17:34:28.694Z. If not provided, defaults to 1 hour ago."
    - name: limit
      required: false
      description: "Maximum records that can be returned. Min size: 1, Max size: 1000."
      defaultValue: "50"
    - name: should_push_events
      required: false
      description: "Set to true to push events to XSIAM. Used for debugging."
      defaultValue: "false"
      auto: PREDEFINED
      predefined:
      - "true"
      - "false"
    description: "This command is used for developing/debugging and is to be used with caution, as it can create events, leading to events duplication and API request limitation exceeding. Retrieves the list of events by start date."
    outputs:
    - contextPath: BeyondTrust.Event.id
      description: The ID of the event.
      type: String
    - contextPath: BeyondTrust.Event.created
      description: The creation time of the event.
      type: Date
  - name: beyondtrust-pm-cloud-get-audit-activity
    arguments:
    - name: page_size
      required: false
      description: "The number of records per page. Shouldn't exceed 200."
      defaultValue: "50"
    - name: page_number
      required: false
      description: The page number to retrieve from results.
      defaultValue: "1"
    - name: filter_created_dates
      required: false
      description: "Valid date formats for filter - 2020-12-24, 2020-12-24 19:09:47, 2020-12-24 19:09:47.6816562, 2020-12-24 19:09:47.6816562 +00:00"
    - name: filter_created_selection_mode
      required: false
      description: The selection mode of date criteria e.g. single, multiple, range.
      options:
      - Single
      - Multiple
      - Range
    description: Retrieves list of Details of Activity Audits.
    outputs:
    - contextPath: BeyondTrust.Audit.id
      description: The ID of the audit.
      type: String
    - contextPath: BeyondTrust.Audit.created
      description: The creation time of the audit.
      type: Date
fromversion: 6.10.0
tests:
- No tests (auto formatted)