id: PaloAltoNetworks_PrismaCloudCompute-Test
version: -1
name: PaloAltoNetworks_PrismaCloudCompute-Test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: d890a0df-42cb-4887-8cd8-4322e76c9e69
    type: start
    task:
      id: d890a0df-42cb-4887-8cd8-4322e76c9e69
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": -270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 6a1d10b8-9c9c-41ac-8e26-e8680c3bb5ec
    type: regular
    task:
      id: 6a1d10b8-9c9c-41ac-8e26-e8680c3bb5ec
      version: -1
      name: DeleteContext
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": -65
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: c7f6e8a6-e044-4ae8-8d0a-5dd62c6fd301
    type: regular
    task:
      id: c7f6e8a6-e044-4ae8-8d0a-5dd62c6fd301
      version: -1
      name: Get alert data using PrismaCloudComputeParseAuditAlert script
      scriptName: PrismaCloudComputeParseAuditAlert
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      alert_raw_json:
        simple: ${FetchedIncidents.[0].rawJSONAlert}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    fieldMapping:
    - incidentfield: Affected data
      output:
        simple: ${PrismaCloudCompute.AuditAlert}
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 49f9c63c-728c-4f4a-8481-2b8878d4808d
    type: condition
    task:
      id: 49f9c63c-728c-4f4a-8481-2b8878d4808d
      version: -1
      name: Verify received audit data
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "6"
      "yes":
      - "8"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloudCompute.AuditAlert.category
            iscontext: true
          right:
            value:
              simple: None
      - - operator: containsGeneral
          left:
            value:
              simple: PrismaCloudCompute.AuditAlert.message
            iscontext: true
          right:
            value:
              simple: files modified
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloudCompute.AuditAlert.rule
            iscontext: true
          right:
            value:
              simple: Default - alert on suspicious runtime behavior
    view: |-
      {
        "position": {
          "x": 265,
          "y": 600
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 9ddba0d3-ed9b-4903-88b1-ac96e2f34309
    type: regular
    task:
      id: 9ddba0d3-ed9b-4903-88b1-ac96e2f34309
      version: -1
      name: Test Failed
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: Test failed, could not verify the expected data
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 645,
          "y": 1115
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 631d0cd4-1942-4a2c-8711-53a564c0a6cf
    type: title
    task:
      id: 631d0cd4-1942-4a2c-8711-53a564c0a6cf
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 7650
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 5cb19a62-a816-4dcd-8474-aea42159b13d
    type: regular
    task:
      id: 5cb19a62-a816-4dcd-8474-aea42159b13d
      version: -1
      name: Print the context
      scriptName: PrintContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      outputformat:
        simple: ${PrismaCloudCompute.AuditAlert}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 645,
          "y": 880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: 1b5ed26e-9ecf-40ad-8b55-aee501f882c1
    type: regular
    task:
      id: 1b5ed26e-9ecf-40ad-8b55-aee501f882c1
      version: -1
      name: FetchFromInstance
      scriptName: FetchFromInstance
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      add_to_context:
        simple: "true"
      brand_name:
        simple: PaloAltoNetworks_PrismaCloudCompute
      retry-count:
        simple: "5"
      retry-interval:
        simple: "15"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 160
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: ab7d3081-cd93-4bb0-8645-35a36c88cac5
    type: regular
    task:
      id: ab7d3081-cd93-4bb0-8645-35a36c88cac5
      version: -1
      name: prisma-cloud-compute-profile-host-list
      description: Get information about the hosts and their profile events, this command supports asterisks which allows you to get host profiles that contain a specific substring
      script: PaloAltoNetworks_PrismaCloudCompute|||prisma-cloud-compute-profile-host-list
      type: regular
      iscommand: true
      brand: PaloAltoNetworks_PrismaCloudCompute
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      hostname:
        simple: '*163*'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 840
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: 762ec5c4-601a-44b0-8e4a-f64b518e17f9
    type: regular
    task:
      id: 762ec5c4-601a-44b0-8e4a-f64b518e17f9
      version: -1
      name: prisma-cloud-compute-profile-container-list
      description: Get information about the containers and their profile events, this command supports asterisks which allows you to get container profiles that contain a specific substring
      script: PaloAltoNetworks_PrismaCloudCompute|||prisma-cloud-compute-profile-container-list
      type: regular
      iscommand: true
      brand: PaloAltoNetworks_PrismaCloudCompute
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      id:
        simple: '*5f2561fab84*'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 1630
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: 0fa721f5-1c62-425a-83c2-113152c11706
    type: condition
    task:
      id: 0fa721f5-1c62-425a-83c2-113152c11706
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "16"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: PrismaCloudCompute.ProfileHost._id
            iscontext: true
          right:
            value:
              simple: 5-163
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.ProfileHost.accountID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.ProfileHost.apps
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.ProfileHost.collections
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.ProfileHost.created
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloudCompute.ProfileHost.hash
            iscontext: true
          right:
            value:
              simple: "1"
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.ProfileHost.labels
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.ProfileHost.sshEvents
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.ProfileHost.time
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.ProfileHost.geoip
            iscontext: true
    view: |-
      {
        "position": {
          "x": 40,
          "y": 1030
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: ace022b8-9074-4a00-8e18-f97d6e58add4
    type: regular
    task:
      id: ace022b8-9074-4a00-8e18-f97d6e58add4
      version: -1
      name: prisma-cloud-compute-profile-container-hosts-list
      description: Get the hosts where a specific container is running.
      script: PaloAltoNetworks_PrismaCloudCompute|||prisma-cloud-compute-profile-container-hosts-list
      type: regular
      iscommand: true
      brand: PaloAltoNetworks_PrismaCloudCompute
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      id:
        simple: ${PrismaCloudCompute.ProfileContainer._id}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 1990
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: f998da11-a14c-44c6-86b2-8b7e4056916d
    type: condition
    task:
      id: f998da11-a14c-44c6-86b2-8b7e4056916d
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "14"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: PrismaCloudCompute.ProfileContainerHost
                accessor: hostsIDs
                transformers:
                - operator: FirstArrayElement
            iscontext: true
          right:
            value:
              simple: 5-163
    view: |-
      {
        "position": {
          "x": 40,
          "y": 2180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 5a91122a-6cbb-4a49-8701-fa2e66803748
    type: regular
    task:
      id: 5a91122a-6cbb-4a49-8701-fa2e66803748
      version: -1
      name: prisma-cloud-compute-profile-container-forensic-list
      description: Get runtime forensics data for a specific container on a specific host
      script: PaloAltoNetworks_PrismaCloudCompute|||prisma-cloud-compute-profile-container-forensic-list
      type: regular
      iscommand: true
      brand: PaloAltoNetworks_PrismaCloudCompute
    nexttasks:
      '#none#':
      - "25"
    scriptarguments:
      hostname:
        complex:
          root: PrismaCloudCompute.ProfileContainerHost.hostsIDs
          filters:
          - - operator: containsGeneral
              left:
                value:
                  simple: PrismaCloudCompute.ProfileContainerHost.hostsIDs
                iscontext: true
              right:
                value:
                  simple: 5-163
      id:
        simple: ${PrismaCloudCompute.ProfileContainer._id}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 2415
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: 6368d2be-911b-4512-82b0-d6cd56bbf4da
    type: regular
    task:
      id: 6368d2be-911b-4512-82b0-d6cd56bbf4da
      version: -1
      name: prisma-cloud-compute-host-forensic-list
      description: Get forensics on a specific host
      script: PaloAltoNetworks_PrismaCloudCompute|||prisma-cloud-compute-host-forensic-list
      type: regular
      iscommand: true
      brand: PaloAltoNetworks_PrismaCloudCompute
    nexttasks:
      '#none#':
      - "24"
    scriptarguments:
      id:
        simple: ${PrismaCloudCompute.ProfileHost._id}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 1220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: acc934f8-6fbc-448d-89bf-f4d30b5c4239
    type: regular
    task:
      id: acc934f8-6fbc-448d-89bf-f4d30b5c4239
      version: -1
      name: prisma-cloud-compute-console-version-info
      description: Get the console version
      script: PaloAltoNetworks_PrismaCloudCompute|||prisma-cloud-compute-console-version-info
      type: regular
      iscommand: true
      brand: PaloAltoNetworks_PrismaCloudCompute
    nexttasks:
      '#none#':
      - "19"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 3490
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: b7401248-ca1f-42fa-870c-37b8af7ccdbd
    type: condition
    task:
      id: b7401248-ca1f-42fa-870c-37b8af7ccdbd
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "26"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloudCompute.Console.Version
            iscontext: true
          right:
            value:
              simple: 21.04.439
    view: |-
      {
        "position": {
          "x": 40,
          "y": 3690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 35d916b2-5a84-4f46-870e-c09ccf3e9574
    type: regular
    task:
      id: 35d916b2-5a84-4f46-870e-c09ccf3e9574
      version: -1
      name: prisma-cloud-compute-custom-feeds-ip-list
      description: Get all the BlackListed IP addresses in the system
      script: PaloAltoNetworks_PrismaCloudCompute|||prisma-cloud-compute-custom-feeds-ip-list
      type: regular
      iscommand: true
      brand: PaloAltoNetworks_PrismaCloudCompute
    nexttasks:
      '#none#':
      - "21"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 2860
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: 1c61b610-733d-48c6-834e-d776b70fdf94
    type: condition
    task:
      id: 1c61b610-733d-48c6-834e-d776b70fdf94
      version: -1
      name: Verify outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "22"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.CustomFeedIP.feed
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.CustomFeedIP.feed
            iscontext: true
    view: |-
      {
        "position": {
          "x": 40,
          "y": 3070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 25367076-c844-40dd-8330-9de6f2214791
    type: regular
    task:
      id: 25367076-c844-40dd-8330-9de6f2214791
      version: -1
      name: prisma-cloud-compute-custom-feeds-ip-add
      description: Add a list of banned IPs to be blocked by the system
      script: PaloAltoNetworks_PrismaCloudCompute|||prisma-cloud-compute-custom-feeds-ip-add
      type: regular
      iscommand: true
      brand: PaloAltoNetworks_PrismaCloudCompute
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      ip:
        simple: 1.1.1.1
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 3280
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: ce0ad225-a4db-41e8-80d4-30261b8b6527
    type: condition
    task:
      id: ce0ad225-a4db-41e8-80d4-30261b8b6527
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "12"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.ProfileContainer._id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.ProfileContainer.image
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.ProfileContainer.imageID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.ProfileContainer.processes
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.ProfileContainer.state
            iscontext: true
    view: |-
      {
        "position": {
          "x": 40,
          "y": 1810
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: cd308843-d45b-4f97-8c70-e425f9fe5d82
    type: condition
    task:
      id: cd308843-d45b-4f97-8c70-e425f9fe5d82
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "9"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.HostForensic.Forensics.path
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.HostForensic.Forensics.type
            iscontext: true
    view: |-
      {
        "position": {
          "x": 40,
          "y": 1430
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "25":
    id: "25"
    taskid: 372770d5-6995-4a65-85d4-911cc58a02fc
    type: condition
    task:
      id: 372770d5-6995-4a65-85d4-911cc58a02fc
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "20"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.ContainerForensic.Forensics.path
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.ContainerForensic.Forensics.type
            iscontext: true
    view: |-
      {
        "position": {
          "x": 40,
          "y": 2625
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: 111fc899-8f06-4fde-82e8-85030b920979
    type: regular
    task:
      id: 111fc899-8f06-4fde-82e8-85030b920979
      version: -1
      name: prisma-cloud-compute-custom-feeds-malware-list
      description: List all custom uploaded md5 malwares.
      script: PaloAltoNetworks_PrismaCloudCompute|||prisma-cloud-compute-custom-feeds-malware-list
      type: regular
      iscommand: true
      brand: PaloAltoNetworks_PrismaCloudCompute
    nexttasks:
      '#none#':
      - "27"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 3905
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: e2a12175-2c5f-43f9-8116-9cfa9b58a937
    type: condition
    task:
      id: e2a12175-2c5f-43f9-8116-9cfa9b58a937
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "42"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.CustomFeedMalware.digest
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.CustomFeedMalware.modified
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.CustomFeedMalware.feed
            iscontext: true
    view: |-
      {
        "position": {
          "x": 40,
          "y": 4060
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: 0f99e2dd-d511-48ac-8758-2ae171edb7de
    type: regular
    task:
      id: 0f99e2dd-d511-48ac-8758-2ae171edb7de
      version: -1
      name: cve
      description: Get infomration about the cves in the system, will return maximum of 50 records, it is possible to query for partial cve description such as cve-2020 or cve-2014 or by severity/distro/package
      script: PaloAltoNetworks_PrismaCloudCompute|||cve
      type: regular
      iscommand: true
      brand: PaloAltoNetworks_PrismaCloudCompute
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      cve:
        simple: CVE-2021-43332
      cve_id:
        simple: CVE-2021-43332
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 4380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: 91f31361-815e-4e72-809c-61841979cbd6
    type: condition
    task:
      id: 91f31361-815e-4e72-809c-61841979cbd6
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "30"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: CVE
                accessor: ID
                transformers:
                - operator: FirstArrayElement
            iscontext: true
          right:
            value:
              simple: CVE-2021-43332
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CVE
                accessor: CVSS
                transformers:
                - operator: FirstArrayElement
            iscontext: true
    view: |-
      {
        "position": {
          "x": 40,
          "y": 4550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: ea39c9c6-c991-4dff-8af7-3ba687669e64
    type: regular
    task:
      id: ea39c9c6-c991-4dff-8af7-3ba687669e64
      version: -1
      name: prisma-cloud-compute-vulnerabilities-impacted-resources-list
      description: prisma-cloud-compute-vulnerabilities-impacted-resources-list
      script: PaloAltoNetworks_PrismaCloudCompute|||prisma-cloud-compute-vulnerabilities-impacted-resources-list
      type: regular
      iscommand: true
      brand: PaloAltoNetworks_PrismaCloudCompute
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      cve:
        simple: CVE-2018-14600
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 4740
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: f3b98fa5-4689-47ba-892c-e916896036a4
    type: condition
    task:
      id: f3b98fa5-4689-47ba-892c-e916896036a4
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "32"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PrismaCloudCompute.VulnerabilitiesImpactedResource._id
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: PrismaCloudCompute.VulnerabilitiesImpactedResource._id
                      iscontext: true
                    right:
                      value:
                        simple: CVE-2018-14600
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.VulnerabilitiesImpactedResource.riskTree
            iscontext: true
    view: |-
      {
        "position": {
          "x": 40,
          "y": 4920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: 5ada1f1f-eec2-4a45-8532-d0c4e95b5462
    type: regular
    task:
      id: 5ada1f1f-eec2-4a45-8532-d0c4e95b5462
      version: -1
      name: prisma-cloud-compute-defenders-list
      description: Retrieve a list of defenders and their information
      script: PaloAltoNetworks_PrismaCloudCompute|||prisma-cloud-compute-defenders-list
      type: regular
      iscommand: true
      brand: PaloAltoNetworks_PrismaCloudCompute
    nexttasks:
      '#none#':
      - "33"
    scriptarguments:
      connected:
        simple: "true"
      limit:
        simple: "2"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 5110
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: 2def76cc-bac8-4b7c-8c00-25f4b41753db
    type: condition
    task:
      id: 2def76cc-bac8-4b7c-8c00-25f4b41753db
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "34"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PrismaCloudCompute.DefenderDetails.hostname
                filters:
                - - operator: containsGeneral
                    left:
                      value:
                        simple: PrismaCloudCompute.DefenderDetails.hostname
                      iscontext: true
                    right:
                      value:
                        simple: "163"
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.DefenderDetails.connected
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PrismaCloudCompute.DefenderDetails.version
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: PrismaCloudCompute.DefenderDetails.version
                      iscontext: true
                    right:
                      value:
                        simple: 21.04.439
            iscontext: true
    view: |-
      {
        "position": {
          "x": 40,
          "y": 5310
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: 7eaf5e02-58ac-48ef-8309-ff121c84f9e0
    type: regular
    task:
      id: 7eaf5e02-58ac-48ef-8309-ff121c84f9e0
      version: -1
      name: prisma-cloud-compute-collections-list
      description: Retrieves a list of all collections
      script: PaloAltoNetworks_PrismaCloudCompute|||prisma-cloud-compute-collections-list
      type: regular
      iscommand: true
      brand: PaloAltoNetworks_PrismaCloudCompute
    nexttasks:
      '#none#':
      - "35"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 5510
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: f470dc78-bbcd-4c9a-8e96-cb16a77ed9db
    type: condition
    task:
      id: f470dc78-bbcd-4c9a-8e96-cb16a77ed9db
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "36"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PrismaCloudCompute.Collection.name
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: PrismaCloudCompute.Collection.name
                      iscontext: true
                    right:
                      value:
                        simple: All
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PrismaCloudCompute.Collection.description
                filters:
                - - operator: containsGeneral
                    left:
                      value:
                        simple: PrismaCloudCompute.Collection.description
                      iscontext: true
                    right:
                      value:
                        simple: System
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PrismaCloudCompute.Collection.owner
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: PrismaCloudCompute.Collection.owner
                      iscontext: true
                    right:
                      value:
                        simple: system
            iscontext: true
    view: |-
      {
        "position": {
          "x": 40,
          "y": 5690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: 66a9211b-0c4c-46db-8b04-3767d6c3451b
    type: regular
    task:
      id: 66a9211b-0c4c-46db-8b04-3767d6c3451b
      version: -1
      name: prisma-cloud-compute-container-namespace-list
      description: Get the containers namespaces names
      script: PaloAltoNetworks_PrismaCloudCompute|||prisma-cloud-compute-container-namespace-list
      type: regular
      iscommand: true
      brand: PaloAltoNetworks_PrismaCloudCompute
    nexttasks:
      '#none#':
      - "37"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 5900
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: c06e8d6c-0012-4596-86d2-f720f8a9f6b6
    type: condition
    task:
      id: c06e8d6c-0012-4596-86d2-f720f8a9f6b6
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "38"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEmpty
          left:
            value:
              simple: PrismaCloudCompute.RadarContainerNamespace
            iscontext: true
    view: |-
      {
        "position": {
          "x": 40,
          "y": 6110
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: f7533b75-6060-4bf1-8ac7-4968dda145b7
    type: regular
    task:
      id: f7533b75-6060-4bf1-8ac7-4968dda145b7
      version: -1
      name: prisma-cloud-compute-images-scan-list
      description: Get images scan report, the report includes vulnerabilities, compliance issues, binaries, etc.
      script: PaloAltoNetworks_PrismaCloudCompute|||prisma-cloud-compute-images-scan-list
      type: regular
      iscommand: true
      brand: PaloAltoNetworks_PrismaCloudCompute
    nexttasks:
      '#none#':
      - "39"
    scriptarguments:
      compact:
        simple: "false"
      id:
        simple: '*699*'
      limit_stats:
        simple: "2"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 6310
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: 188298c5-13bc-491b-86a1-3037b76a98cd
    type: condition
    task:
      id: 188298c5-13bc-491b-86a1-3037b76a98cd
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "40"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.ReportsImagesScan._id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.ReportsImagesScan.distro
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.ReportsImagesScan.instances.image
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.ReportsImagesScan.complianceIssuesCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.ReportsImagesScan.vulnerabilitiesCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.ReportsImagesScan.vulnerabilities
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.ReportsImagesScan.complianceIssues
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.ReportsImagesScan.vulnerabilities
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.ReportsImagesScan.complianceIssues
            iscontext: true
    view: |-
      {
        "position": {
          "x": 40,
          "y": 6490
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: ecc61859-d57a-471a-807d-ffdc50d22b62
    type: regular
    task:
      id: ecc61859-d57a-471a-807d-ffdc50d22b62
      version: -1
      name: prisma-cloud-compute-hosts-scan-list
      description: Get images scan report, the report includes vulnerabilities, compliance issues, binaries, etc.
      script: PaloAltoNetworks_PrismaCloudCompute|||prisma-cloud-compute-hosts-scan-list
      type: regular
      iscommand: true
      brand: PaloAltoNetworks_PrismaCloudCompute
    nexttasks:
      '#none#':
      - "41"
    scriptarguments:
      compact:
        simple: "false"
      hostname:
        simple: '*163*'
      limit_stats:
        simple: "2"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 6660
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: 928eb9da-580c-4e84-8a30-c782470dfe39
    type: condition
    task:
      id: 928eb9da-580c-4e84-8a30-c782470dfe39
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "43"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.ReportHostScan._id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.ReportHostScan.hostname
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.ReportHostScan.distro
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.ReportHostScan.vulnerabilitiesCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.ReportHostScan.complianceIssuesCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.ReportHostScan.vulnerabilities
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.ReportHostScan.complianceIssues
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.ReportHostScan.vulnerabilities
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.ReportHostScan.complianceIssues
            iscontext: true
    view: |-
      {
        "position": {
          "x": 40,
          "y": 6880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: 5ccd5317-9e43-4878-852e-68b5c3d843e9
    type: regular
    task:
      id: 5ccd5317-9e43-4878-852e-68b5c3d843e9
      version: -1
      name: prisma-cloud-compute-custom-feeds-malware-add
      description: Add custom md5 malware hashes
      script: PaloAltoNetworks_PrismaCloudCompute|||prisma-cloud-compute-custom-feeds-malware-add
      type: regular
      iscommand: true
      brand: PaloAltoNetworks_PrismaCloudCompute
    nexttasks:
      '#none#':
      - "28"
    scriptarguments:
      md5:
        simple: 1d7b4f1b079c17cc17c5e2a627000c17
      name:
        simple: test
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 4220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: f7259ce9-3f71-4682-8f59-2d63ac74d3ea
    type: regular
    task:
      id: f7259ce9-3f71-4682-8f59-2d63ac74d3ea
      version: -1
      name: TagIndicatorButton
      description: This is a wrapper around the setIndicators script.
      scriptName: TagIndicatorButton
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "44"
    scriptarguments:
      Indicators:
        simple: 1.1.1.1
      Tags:
        simple: allow
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 7090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "44":
    id: "44"
    taskid: 1cfc38b5-b485-4228-83be-e039f9f4568a
    type: regular
    task:
      id: 1cfc38b5-b485-4228-83be-e039f9f4568a
      version: -1
      name: CreatePrismaCloudComputeLink
      description: This script creates a link back to the Prisma Cloud Compute instance.
      scriptName: CreatePrismaCloudComputeLink
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "45"
    scriptarguments:
      baseUrl:
        simple: https://prismcloudcomputeurl
      imageName:
        simple: dvwa
      type:
        simple: sqli
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 7270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: 9a9f3e58-5bad-426d-85af-ee1537be6916
    type: condition
    task:
      id: 9a9f3e58-5bad-426d-85af-ee1537be6916
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "5"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: link
            iscontext: true
          right:
            value:
              simple: https://prismcloudcomputeurl/#!/monitor/events/firewall/app/container?filters=imageName%3Ddvwa%26type%3Dsqli
    view: |-
      {
        "position": {
          "x": 40,
          "y": 7460
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 7985,
        "width": 985,
        "x": 40,
        "y": -270
      }
    }
  }
inputs: []
outputs: []
fromversion: 5.0.0
description: ''
