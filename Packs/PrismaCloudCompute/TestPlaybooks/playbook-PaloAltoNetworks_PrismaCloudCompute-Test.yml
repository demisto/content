id: PaloAltoNetworks_PrismaCloudCompute-Test
inputs: []
name: PaloAltoNetworks_PrismaCloudCompute-Test
outputs: []
starttaskid: "0"
tasks:
  "0":
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 50d76490-7da2-4749-87ee-eb78e229d641
      iscommand: false
      name: ""
      version: -1
    taskid: 50d76490-7da2-4749-87ee-eb78e229d641
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 265,
          "y": -270
        }
      }
  "1":
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bdfeb85f-56d2-4b54-8e8b-3edf33808294
      iscommand: false
      name: DeleteContext
      script: DeleteContext
      type: regular
      version: -1
    taskid: bdfeb85f-56d2-4b54-8e8b-3edf33808294
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": -65
        }
      }
  "2":
    fieldMapping:
    - incidentfield: Affected data
      output:
        simple: ${PrismaCloudCompute.AuditAlert}
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      alert_raw_json:
        simple: ${FetchedIncidents.[0].rawJSONAlert}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8e9393aa-19bf-437c-8b43-784bbcee5e36
      iscommand: false
      name: Get alert data using PrismaCloudComputeParseAuditAlert script
      script: PrismaCloudComputeParseAuditAlert
      type: regular
      version: -1
    taskid: 8e9393aa-19bf-437c-8b43-784bbcee5e36
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 390
        }
      }
  "3":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.AuditAlert.category
          operator: isEqualString
          right:
            value:
              simple: None
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.AuditAlert.message
          operator: containsGeneral
          right:
            value:
              simple: files modified
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.AuditAlert.rule
          operator: isEqualString
          right:
            value:
              simple: Default - alert on suspicious runtime behavior
      label: "yes"
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "6"
      "yes":
      - "8"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2d42dc52-5755-4047-899a-3aafe7cbbacc
      iscommand: false
      name: Verify received audit data
      type: condition
      version: -1
    taskid: 2d42dc52-5755-4047-899a-3aafe7cbbacc
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 265,
          "y": 600
        }
      }
  "4":
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      message:
        simple: Test failed, could not verify the expected data
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fa2ba736-768c-4e0b-87bc-5d4c1bf8ee29
      iscommand: false
      name: Test Failed
      script: PrintErrorEntry
      type: regular
      version: -1
    taskid: fa2ba736-768c-4e0b-87bc-5d4c1bf8ee29
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 645,
          "y": 1115
        }
      }
  "5":
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 09f06bd8-0fe7-41b3-881e-a1f1869dd062
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 09f06bd8-0fe7-41b3-881e-a1f1869dd062
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 40,
          "y": 7635
        }
      }
  "6":
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      outputformat:
        simple: ${PrismaCloudCompute.AuditAlert}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 96fb41fe-e237-40a3-8082-6442761c1362
      iscommand: false
      name: Print the context
      script: PrintContext
      type: regular
      version: -1
    taskid: 96fb41fe-e237-40a3-8082-6442761c1362
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 645,
          "y": 880
        }
      }
  "7":
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      add_to_context:
        simple: "true"
      brand_name:
        simple: PaloAltoNetworks_PrismaCloudCompute
      retry-count:
        simple: "5"
      retry-interval:
        simple: "15"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 92a845d7-9e3b-40ae-8f71-df61a30634a4
      iscommand: false
      name: FetchFromInstance
      script: FetchFromInstance
      type: regular
      version: -1
    taskid: 92a845d7-9e3b-40ae-8f71-df61a30634a4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 160
        }
      }
  "8":
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      hostname:
        simple: '*163*'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Get information about the hosts and their profile events. This command supports asterisks which allows you to get host profiles by filtering its fields according to a specific substring.
      id: 937fdb22-5d82-4cc0-8c89-9145a80864c9
      iscommand: true
      name: prisma-cloud-compute-profile-host-list
      script: '|||prisma-cloud-compute-profile-host-list'
      type: regular
      version: -1
    taskid: 937fdb22-5d82-4cc0-8c89-9145a80864c9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 40,
          "y": 840
        }
      }
  "9":
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      id:
        simple: '*5f2561fab84*'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Get information about the containers and their profile events. This command supports asterisks which allows you to get container profiles by filtering its fields according to a specific substring.
      id: ae722b84-5b22-4590-84fc-13689fc72b0d
      iscommand: true
      name: prisma-cloud-compute-profile-container-list
      script: '|||prisma-cloud-compute-profile-container-list'
      type: regular
      version: -1
    taskid: ae722b84-5b22-4590-84fc-13689fc72b0d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 40,
          "y": 1630
        }
      }
  "10":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.ProfileHost._id
          operator: containsGeneral
          right:
            value:
              simple: 5-163
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.ProfileHost.accountID
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.ProfileHost.apps
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.ProfileHost.collections
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.ProfileHost.created
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.ProfileHost.hash
          operator: isEqualString
          right:
            value:
              simple: "1"
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.ProfileHost.labels
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.ProfileHost.sshEvents
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.ProfileHost.time
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.ProfileHost.geoip
          operator: isNotEmpty
      label: "yes"
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "16"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3b9b7963-4a13-4d8e-88ea-83ab74ea2369
      iscommand: false
      name: Verify Outputs
      type: condition
      version: -1
    taskid: 3b9b7963-4a13-4d8e-88ea-83ab74ea2369
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 40,
          "y": 1030
        }
      }
  "12":
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      id:
        simple: ${PrismaCloudCompute.ProfileContainer._id}
    separatecontext: false
    skipunavailable: false
    task:
      brand: PaloAltoNetworks_PrismaCloudCompute
      description: Get the hosts where a specific container is running.
      id: 8dca611a-9faf-44a0-8b24-763c02dab444
      iscommand: true
      name: prisma-cloud-compute-profile-container-hosts-list
      script: PaloAltoNetworks_PrismaCloudCompute|||prisma-cloud-compute-profile-container-hosts-list
      type: regular
      version: -1
    taskid: 8dca611a-9faf-44a0-8b24-763c02dab444
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 40,
          "y": 1990
        }
      }
  "13":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: hostsIDs
                root: PrismaCloudCompute.ProfileContainerHost
                transformers:
                - operator: FirstArrayElement
          operator: containsGeneral
          right:
            value:
              simple: 5-163
      label: "yes"
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "14"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2922b190-8f8e-4ad4-87dd-0b6775a415e4
      iscommand: false
      name: Verify Outputs
      type: condition
      version: -1
    taskid: 2922b190-8f8e-4ad4-87dd-0b6775a415e4
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 40,
          "y": 2180
        }
      }
  "14":
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    scriptarguments:
      hostname:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: PrismaCloudCompute.ProfileContainerHost.hostsIDs
              operator: containsGeneral
              right:
                value:
                  simple: 5-163
          root: PrismaCloudCompute.ProfileContainerHost.hostsIDs
      id:
        simple: ${PrismaCloudCompute.ProfileContainer._id}
    separatecontext: false
    skipunavailable: false
    task:
      brand: PaloAltoNetworks_PrismaCloudCompute
      description: Get runtime forensics data for a specific container on a specific host
      id: a12904dd-de63-411c-8867-ec4e98524ed5
      iscommand: true
      name: prisma-cloud-compute-profile-container-forensic-list
      script: PaloAltoNetworks_PrismaCloudCompute|||prisma-cloud-compute-profile-container-forensic-list
      type: regular
      version: -1
    taskid: a12904dd-de63-411c-8867-ec4e98524ed5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 40,
          "y": 2415
        }
      }
  "16":
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    scriptarguments:
      id:
        simple: ${PrismaCloudCompute.ProfileHost._id}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Get forensics on a specific host.
      id: ec8ee32a-a9ce-4354-840d-62af301f5fd5
      iscommand: true
      name: prisma-cloud-compute-host-forensic-list
      script: '|||prisma-cloud-compute-host-forensic-list'
      type: regular
      version: -1
    taskid: ec8ee32a-a9ce-4354-840d-62af301f5fd5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 40,
          "y": 1220
        }
      }
  "18":
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: PaloAltoNetworks_PrismaCloudCompute
      description: Get the console version
      id: d0641c94-cd60-4c2b-82e1-e813c97fa428
      iscommand: true
      name: prisma-cloud-compute-console-version-info
      script: PaloAltoNetworks_PrismaCloudCompute|||prisma-cloud-compute-console-version-info
      type: regular
      version: -1
    taskid: d0641c94-cd60-4c2b-82e1-e813c97fa428
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 40,
          "y": 3490
        }
      }
  "19":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.Console.Version
          operator: isEqualString
          right:
            value:
              simple: 21.04.439
      label: "yes"
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d56c093e-be9d-4f49-8f45-4beff8f1de68
      iscommand: false
      name: Verify Outputs
      type: condition
      version: -1
    taskid: d56c093e-be9d-4f49-8f45-4beff8f1de68
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 40,
          "y": 3690
        }
      }
  "20":
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "21"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: PaloAltoNetworks_PrismaCloudCompute
      description: Get all the BlackListed IP addresses in the system
      id: f9480093-81e8-4c1c-8141-e9d755224296
      iscommand: true
      name: prisma-cloud-compute-custom-feeds-ip-list
      script: PaloAltoNetworks_PrismaCloudCompute|||prisma-cloud-compute-custom-feeds-ip-list
      type: regular
      version: -1
    taskid: f9480093-81e8-4c1c-8141-e9d755224296
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 40,
          "y": 2860
        }
      }
  "21":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.CustomFeedIP.feed
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.CustomFeedIP.feed
          operator: isNotEmpty
      label: "yes"
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "22"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d5f9117b-bc99-4d3a-8513-c1cadd4b69fc
      iscommand: false
      name: Verify outputs
      type: condition
      version: -1
    taskid: d5f9117b-bc99-4d3a-8513-c1cadd4b69fc
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 40,
          "y": 3070
        }
      }
  "22":
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        simple: 1.1.1.1
    separatecontext: false
    skipunavailable: false
    task:
      brand: PaloAltoNetworks_PrismaCloudCompute
      description: Add a list of banned IPs to be blocked by the system
      id: 22ccce7d-a87f-4d1d-8120-d628dbb8c1e0
      iscommand: true
      name: prisma-cloud-compute-custom-feeds-ip-add
      script: PaloAltoNetworks_PrismaCloudCompute|||prisma-cloud-compute-custom-feeds-ip-add
      type: regular
      version: -1
    taskid: 22ccce7d-a87f-4d1d-8120-d628dbb8c1e0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 40,
          "y": 3280
        }
      }
  "23":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.ProfileContainer._id
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.ProfileContainer.image
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.ProfileContainer.imageID
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.ProfileContainer.processes
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.ProfileContainer.state
          operator: isNotEmpty
      label: "yes"
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "12"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: dd10ced3-ded6-4b6b-8b70-217607b7101a
      iscommand: false
      name: Verify Outputs
      type: condition
      version: -1
    taskid: dd10ced3-ded6-4b6b-8b70-217607b7101a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 40,
          "y": 1810
        }
      }
  "24":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.HostForensic.Forensics.path
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.HostForensic.Forensics.type
          operator: isNotEmpty
      label: "yes"
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d15bbfa1-ec34-4a50-8941-f33f41d0efbc
      iscommand: false
      name: Verify Outputs
      type: condition
      version: -1
    taskid: d15bbfa1-ec34-4a50-8941-f33f41d0efbc
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 40,
          "y": 1430
        }
      }
  "25":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.ContainerForensic.Forensics.path
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.ContainerForensic.Forensics.type
          operator: isNotEmpty
      label: "yes"
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "20"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: db015953-3c13-4041-878f-6e75863d2935
      iscommand: false
      name: Verify Outputs
      type: condition
      version: -1
    taskid: db015953-3c13-4041-878f-6e75863d2935
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 40,
          "y": 2625
        }
      }
  "26":
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: PaloAltoNetworks_PrismaCloudCompute
      description: List all custom uploaded md5 malwares.
      id: 5f1d2f4e-2e11-40c0-83cc-d58cabd4b257
      iscommand: true
      name: prisma-cloud-compute-custom-feeds-malware-list
      script: PaloAltoNetworks_PrismaCloudCompute|||prisma-cloud-compute-custom-feeds-malware-list
      type: regular
      version: -1
    taskid: 5f1d2f4e-2e11-40c0-83cc-d58cabd4b257
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 40,
          "y": 3905
        }
      }
  "27":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.CustomFeedMalware.digest
          operator: isNotEmpty
          right:
            value: {}
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.CustomFeedMalware.modified
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.CustomFeedMalware.feed
          operator: isNotEmpty
      label: "yes"
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "42"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 06ef4cd6-5391-434f-8d6b-b60986483d74
      iscommand: false
      name: Verify Outputs
      type: condition
      version: -1
    taskid: 06ef4cd6-5391-434f-8d6b-b60986483d74
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 40,
          "y": 4060
        }
      }
  "28":
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    scriptarguments:
      cve:
        simple: CVE-2021-43332
      cve_id:
        simple: CVE-2021-43332
    separatecontext: false
    skipunavailable: false
    task:
      brand: PaloAltoNetworks_PrismaCloudCompute
      description: Get infomration about the cves in the system, will return maximum of 50 records, it is possible to query for partial cve description such as cve-2020 or cve-2014 or by severity/distro/package
      id: 0b33e26f-c359-49d1-83b3-0ee969f21871
      iscommand: true
      name: cve
      script: PaloAltoNetworks_PrismaCloudCompute|||cve
      type: regular
      version: -1
    taskid: 0b33e26f-c359-49d1-83b3-0ee969f21871
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 40,
          "y": 4380
        }
      }
  "29":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: ID
                root: CVE
                transformers:
                - operator: FirstArrayElement
          operator: isEqualString
          right:
            value:
              simple: CVE-2021-43332
      - - left:
            iscontext: true
            value:
              complex:
                accessor: CVSS
                root: CVE
                transformers:
                - operator: FirstArrayElement
          operator: isNotEmpty
      label: "yes"
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "30"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e081c23d-7690-40f0-8fb2-c78bbb4388fd
      iscommand: false
      name: Verify Outputs
      type: condition
      version: -1
    taskid: e081c23d-7690-40f0-8fb2-c78bbb4388fd
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 40,
          "y": 4550
        }
      }
  "30":
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "31"
    note: false
    quietmode: 0
    scriptarguments:
      cve:
        simple: CVE-2018-14600
    separatecontext: false
    skipunavailable: false
    task:
      brand: PaloAltoNetworks_PrismaCloudCompute
      description: prisma-cloud-compute-vulnerabilities-impacted-resources-list
      id: 9e89606d-301e-4d45-813f-322697b41977
      iscommand: true
      name: prisma-cloud-compute-vulnerabilities-impacted-resources-list
      script: PaloAltoNetworks_PrismaCloudCompute|||prisma-cloud-compute-vulnerabilities-impacted-resources-list
      type: regular
      version: -1
    taskid: 9e89606d-301e-4d45-813f-322697b41977
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 40,
          "y": 4740
        }
      }
  "31":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: PrismaCloudCompute.VulnerabilitiesImpactedResource._id
                    operator: isEqualString
                    right:
                      value:
                        simple: CVE-2018-14600
                root: PrismaCloudCompute.VulnerabilitiesImpactedResource._id
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.VulnerabilitiesImpactedResource.riskTree
          operator: isNotEmpty
      label: "yes"
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "32"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 22d82d5a-7dd1-4f94-8c6e-8bfd94f91f24
      iscommand: false
      name: Verify Outputs
      type: condition
      version: -1
    taskid: 22d82d5a-7dd1-4f94-8c6e-8bfd94f91f24
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 40,
          "y": 4920
        }
      }
  "32":
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    scriptarguments:
      connected:
        simple: "true"
      limit:
        simple: "2"
    separatecontext: false
    skipunavailable: false
    task:
      brand: PaloAltoNetworks_PrismaCloudCompute
      description: Retrieve a list of defenders and their information
      id: ae94c0a0-63a1-41a8-8ac6-0ddcc8bac948
      iscommand: true
      name: prisma-cloud-compute-defenders-list
      script: PaloAltoNetworks_PrismaCloudCompute|||prisma-cloud-compute-defenders-list
      type: regular
      version: -1
    taskid: ae94c0a0-63a1-41a8-8ac6-0ddcc8bac948
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 40,
          "y": 5110
        }
      }
  "33":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: PrismaCloudCompute.DefenderDetails.hostname
                    operator: containsGeneral
                    right:
                      value:
                        simple: "163"
                root: PrismaCloudCompute.DefenderDetails.hostname
          operator: isNotEmpty
          right:
            value: {}
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.DefenderDetails.connected
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: PrismaCloudCompute.DefenderDetails.version
                    operator: isEqualString
                    right:
                      value:
                        simple: 21.04.439
                root: PrismaCloudCompute.DefenderDetails.version
          operator: isNotEmpty
      label: "yes"
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "34"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 161b2974-4a1a-4192-8c27-f066a6081ba8
      iscommand: false
      name: Verify Outputs
      type: condition
      version: -1
    taskid: 161b2974-4a1a-4192-8c27-f066a6081ba8
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 40,
          "y": 5310
        }
      }
  "34":
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "35"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: PaloAltoNetworks_PrismaCloudCompute
      description: Retrieves a list of all collections
      id: 2d150f53-5073-4b38-8f42-13d9c681f0e2
      iscommand: true
      name: prisma-cloud-compute-collections-list
      script: PaloAltoNetworks_PrismaCloudCompute|||prisma-cloud-compute-collections-list
      type: regular
      version: -1
    taskid: 2d150f53-5073-4b38-8f42-13d9c681f0e2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 40,
          "y": 5510
        }
      }
  "35":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: PrismaCloudCompute.Collection.name
                    operator: isEqualString
                    right:
                      value:
                        simple: All
                root: PrismaCloudCompute.Collection.name
          operator: isNotEmpty
          right:
            value: {}
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: PrismaCloudCompute.Collection.description
                    operator: containsGeneral
                    right:
                      value:
                        simple: System
                root: PrismaCloudCompute.Collection.description
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: PrismaCloudCompute.Collection.owner
                    operator: isEqualString
                    right:
                      value:
                        simple: system
                root: PrismaCloudCompute.Collection.owner
          operator: isNotEmpty
      label: "yes"
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "36"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 14a496c5-198a-4d35-814f-83970e226e3a
      iscommand: false
      name: Verify Outputs
      type: condition
      version: -1
    taskid: 14a496c5-198a-4d35-814f-83970e226e3a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 40,
          "y": 5690
        }
      }
  "36":
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: PaloAltoNetworks_PrismaCloudCompute
      description: Get the containers namespaces names
      id: f6d396c0-8065-44dd-8e92-40f202e3277b
      iscommand: true
      name: prisma-cloud-compute-container-namespace-list
      script: PaloAltoNetworks_PrismaCloudCompute|||prisma-cloud-compute-container-namespace-list
      type: regular
      version: -1
    taskid: f6d396c0-8065-44dd-8e92-40f202e3277b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 40,
          "y": 5900
        }
      }
  "37":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.RadarContainerNamespace
          operator: isEmpty
      label: "yes"
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "38"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5fba4010-e891-49ca-8ebe-a7521af1cbad
      iscommand: false
      name: Verify Outputs
      type: condition
      version: -1
    taskid: 5fba4010-e891-49ca-8ebe-a7521af1cbad
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 40,
          "y": 6110
        }
      }
  "38":
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "39"
    note: false
    quietmode: 0
    scriptarguments:
      compact:
        simple: "false"
      id:
        simple: '*699*'
      limit_stats:
        simple: "2"
    separatecontext: false
    skipunavailable: false
    task:
      brand: PaloAltoNetworks_PrismaCloudCompute
      description: Get images scan report, the report includes vulnerabilities, compliance issues, binaries, etc.
      id: 2c49c7d7-2f92-4370-8ff5-b58b51dc0970
      iscommand: true
      name: prisma-cloud-compute-images-scan-list
      script: PaloAltoNetworks_PrismaCloudCompute|||prisma-cloud-compute-images-scan-list
      type: regular
      version: -1
    taskid: 2c49c7d7-2f92-4370-8ff5-b58b51dc0970
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 40,
          "y": 6310
        }
      }
  "39":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.ReportsImagesScan._id
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.ReportsImagesScan.distro
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.ReportsImagesScan.instances.image
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.ReportsImagesScan.complianceIssuesCount
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.ReportsImagesScan.vulnerabilitiesCount
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.ReportsImagesScan.vulnerabilities
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.ReportsImagesScan.complianceIssues
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.ReportsImagesScan.vulnerabilities
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.ReportsImagesScan.complianceIssues
          operator: isNotEmpty
      label: "yes"
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "40"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b17a0dd4-10f1-4787-87ec-851fb06b63bc
      iscommand: false
      name: Verify Outputs
      type: condition
      version: -1
    taskid: b17a0dd4-10f1-4787-87ec-851fb06b63bc
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 40,
          "y": 6490
        }
      }
  "40":
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "41"
    note: false
    quietmode: 0
    scriptarguments:
      compact:
        simple: "false"
      hostname:
        simple: '*163*'
      limit_stats:
        simple: "2"
    separatecontext: false
    skipunavailable: false
    task:
      brand: PaloAltoNetworks_PrismaCloudCompute
      description: Get images scan report, the report includes vulnerabilities, compliance issues, binaries, etc.
      id: 8de3c80e-e3d6-44c8-8e9a-d447b1ec4392
      iscommand: true
      name: prisma-cloud-compute-hosts-scan-list
      script: PaloAltoNetworks_PrismaCloudCompute|||prisma-cloud-compute-hosts-scan-list
      type: regular
      version: -1
    taskid: 8de3c80e-e3d6-44c8-8e9a-d447b1ec4392
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 40,
          "y": 6660
        }
      }
  "41":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.ReportHostScan._id
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.ReportHostScan.hostname
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.ReportHostScan.distro
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.ReportHostScan.vulnerabilitiesCount
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.ReportHostScan.complianceIssuesCount
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.ReportHostScan.vulnerabilities
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.ReportHostScan.complianceIssues
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.ReportHostScan.vulnerabilities
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: PrismaCloudCompute.ReportHostScan.complianceIssues
          operator: isNotEmpty
      label: "yes"
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "yes":
      - "43"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 736f1ead-7bc9-42d8-8732-c0038b8b69da
      iscommand: false
      name: Verify Outputs
      type: condition
      version: -1
    taskid: 736f1ead-7bc9-42d8-8732-c0038b8b69da
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 40,
          "y": 6880
        }
      }
  "42":
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      md5:
        simple: 1d7b4f1b079c17cc17c5e2a627000c17
      name:
        simple: test
    separatecontext: false
    skipunavailable: false
    task:
      brand: PaloAltoNetworks_PrismaCloudCompute
      description: Add custom md5 malware hashes
      id: b3bd5fee-797e-4308-8ba8-7e7992a84267
      iscommand: true
      name: prisma-cloud-compute-custom-feeds-malware-add
      script: PaloAltoNetworks_PrismaCloudCompute|||prisma-cloud-compute-custom-feeds-malware-add
      type: regular
      version: -1
    taskid: b3bd5fee-797e-4308-8ba8-7e7992a84267
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 40,
          "y": 4220
        }
      }
  "43":
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "44"
    note: false
    quietmode: 0
    scriptarguments:
      extend-context:
        simple: PCC=.
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Get the Waas Container Policies from Defend >> WAAS >> Containers
      id: 2f3b3574-c994-408f-8979-0b04319617f9
      iscommand: true
      name: prisma-cloud-compute-get-waas-policies
      script: '|||prisma-cloud-compute-get-waas-policies'
      type: regular
      version: -1
    taskid: 2f3b3574-c994-408f-8979-0b04319617f9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 40,
          "y": 7090
        }
      }
  "44":
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "45"
    note: false
    quietmode: 0
    scriptarguments:
      action:
        simple: alert
      attack_type:
        simple: xss
      policy:
        simple: ${PCC}
      rule_name:
        simple: ${PCC.rules.[0].name}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Update the Waas Policy for containers
      id: f339d40e-1e72-4347-8872-cca248856e6b
      iscommand: true
      name: prisma-cloud-compute-update-waas-policies
      script: '|||prisma-cloud-compute-update-waas-policies'
      type: regular
      version: -1
    taskid: f339d40e-1e72-4347-8872-cca248856e6b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 40,
          "y": 7280
        }
      }
  "45":
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      ImageName:
        simple: ${PCC.rules.[0].collections.[0].images.[0]}
      audit_type:
        simple: cmdi
      limit:
        simple: "1"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Get the audits for the firewall container policies
      id: 6090cde9-187b-43d4-8d7b-cff7149dca02
      iscommand: true
      name: prisma-cloud-compute-get-audit-firewall-container-alerts
      script: '|||prisma-cloud-compute-get-audit-firewall-container-alerts'
      type: regular
      version: -1
    taskid: 6090cde9-187b-43d4-8d7b-cff7149dca02
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 40,
          "y": 7460
        }
      }
  "46":
    id: "46"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      panosruleaction:
        simple: ${PANOSSecurityRulesRisk.Action}
      panosruleapplication:
        complex:
          accessor: Application}
          root: ${PANOSSecurityRulesRisk
          transformers:
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      panosrulecustomurlcategory:
        simple: ${PANOSSecurityRulesRisk.CustomUrlCategory}
      panosruledestination:
        simple: ${PANOSSecurityRulesRisk.Destination}
      panosrulefrom:
        simple: ${PANOSSecurityRulesRisk.From}
      panosrulename:
        simple: ${PANOSSecurityRulesRisk.RuleName}
      panosruleriskscore:
        simple: ${PANOSSecurityRulesRisk.Score}
      panosrulescore:
        complex:
          accessor: Details}
          root: ${PANOSSecurityRulesRisk
          transformers:
          - args:
              separator:
                value:
                  simple: |2+

            operator: join
      panosruleservice:
        simple: ${PANOSSecurityRulesRisk.Service}
      panosrulesource:
        simple: ${PANOSExceptions.Source}
      panosruleto:
        simple: ${PANOSSecurityRulesRisk.To}
      value:
        simple: PA-VM-${PANOSSecurityRulesRisk.RuleName}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 867372ea-b164-464d-8597-23df4cb48adb
      iscommand: true
      name: Create Rule Indicator
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 867372ea-b164-464d-8597-23df4cb48adb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 610,
          "y": 1360
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 7970,
        "width": 985,
        "x": 40,
        "y": -270
      }
    }
  }
fromversion: 5.0.0
