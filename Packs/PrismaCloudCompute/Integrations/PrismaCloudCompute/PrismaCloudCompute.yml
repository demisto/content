category: Network Security
commonfields:
  id: PaloAltoNetworks_PrismaCloudCompute
  version: -1
configuration:
- display: Fetch incidents
  name: isFetch
  required: false
  type: 8
- defaultvalue: https://example.net:1234
  display: |-
    Prisma Cloud Compute Console URL and Port
    (e.g., https://example.net:1234)
  name: address
  required: true
  type: 0
- display: Prisma Cloud Compute Project Name (if applicable)
  hidden: false
  name: project
  required: false
  type: 0
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
- display: Credentials
  name: credentials
  required: true
  type: 9
- display: Prisma Cloud Compute CA Certificate
  name: certificate
  required: false
  type: 12
- display: Incident type
  name: incidentType
  required: false
  type: 13
description: Use the Prisma Cloud Compute integration to fetch incidents from your Prisma Cloud Compute environment.
display: Palo Alto Networks - Prisma Cloud Compute
name: PaloAltoNetworks_PrismaCloudCompute
script:
  dockerimage: demisto/python3:3.9.5.20070
  isfetch: true
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  subtype: python3
  type: python
  commands:
  - name: prismacloudcompute-logs-defender-download
    arguments:
    - name: hostname
      description: 'Hostname is the target defender hostname '
    - name: lines
      description: 'Lines is the number of lines to fetch '
    description: 'DownloadDefenderLogs downloads all defender logs and metadata '
  - name: prismacloudcompute-list-hosts
    arguments:
    - name: offset
      description: 'Offset from query start '
    - name: limit
      description: 'Limit limits the number of documents '
    - name: search
      description: 'Search is the search term '
    - name: sort
      description: 'Sort is the sort key '
    - name: reverse
      description: 'Reverse is the sorting order '
    - name: collections
      description: 'Collections are collections scoping the query '
    - name: accountIDs
      description: 'AccountIDs are the account IDs scoping the query '
    - name: fields
      description: 'Select is a list of fields to select from the query (others will
        be empty) '
    - name: hostname
      description: 'Hostanme is the hostname filter'
    - name: distro
      description: 'Distro is the OS distro filter'
    - name: provider
      description: 'Provider is the cloud provider filter'
    - name: compact
      description: 'Compact indicates that only minimum image data should be sent
        (vulnerabilities, compliance and extended image metadata should be skipped) '
    - name: clusters
      description: 'Clusters is the cluster filter'
    description: 'Hosts returns the hosts list'
  - name: prismacloudcompute-containers-scan
    arguments: []
    description: 'Sends a container scan request to all containers'
  - name: prismacloudcompute-images-names
    arguments:
    - name: offset
      description: 'Offset from query start '
    - name: limit
      description: 'Limit limits the number of documents '
    - name: search
      description: 'Search is the search term '
    - name: sort
      description: 'Sort is the sort key '
    - name: reverse
      description: 'Reverse is the sorting order '
    - name: collections
      description: 'Collections are collections scoping the query '
    - name: accountIDs
      description: 'AccountIDs are the account IDs scoping the query '
    - name: fields
      description: 'Select is a list of fields to select from the query (others will
        be empty) '
    - name: id
      description: 'IDs is the image id filter '
    - name: hostname
      description: 'Hosts is the host filter '
    - name: repository
      description: 'Repositories is the image repositories filter '
    - name: registry
      description: 'Registries is the image registries filter '
    - name: name
      description: 'Names is a list of full image names to query by '
    - name: layers
      description: 'IncludeImageLayers adds image CVEs to image layers '
    - name: filterBaseImage
      description: 'FilterBaseImageVulns indicates to filter the base image vulnerabilities.Requires
        predefining base images with an existing scan '
    - name: compact
      description: 'Compact indicates that only minimum image data should be sent
        vulnerabilities, compliance and extended image metadata should be skipped '
    - name: trustStatuses
      description: 'TrustStatuses is the trust statuses filter '
    - name: clusters
      description: 'Clusters is a list of cluster names to query by '
    description: 'ImageNames returns image names according to the query specification '
  - name: prismacloudcompute-images
    arguments:
    - name: offset
      description: 'Offset from query start '
    - name: limit
      description: 'Limit limits the number of documents '
    - name: search
      description: 'Search is the search term '
    - name: sort
      description: 'Sort is the sort key '
    - name: reverse
      description: 'Reverse is the sorting order '
    - name: collections
      description: 'Collections are collections scoping the query '
    - name: accountIDs
      description: 'AccountIDs are the account IDs scoping the query '
    - name: fields
      description: 'Select is a list of fields to select from the query (others will
        be empty) '
    - name: id
      description: 'IDs is the image id filter '
    - name: hostname
      description: 'Hosts is the host filter '
    - name: repository
      description: 'Repositories is the image repositories filter '
    - name: registry
      description: 'Registries is the image registries filter '
    - name: name
      description: 'Names is a list of full image names to query by '
    - name: layers
      description: 'IncludeImageLayers adds image CVEs to image layers '
    - name: filterBaseImage
      description: 'FilterBaseImageVulns indicates to filter the base image vulnerabilities.
        Requires predefining base images with an existing scan '
    - name: compact
      description: 'Compact indicates that only minimum image data should be sent
        (vulnerabilities, compliance and extended image metadata should be skipped) '
    - name: trustStatuses
      description: 'TrustStatuses is the trust statuses filter '
    - name: clusters
      description: 'Clusters is a list of cluster names to query by '
    description: 'Images returns images by the query specification '
  - name: prismacloudcompute-images-download
    arguments:
    - name: offset
      description: 'Offset from query start '
    - name: limit
      description: 'Limit limits the number of documents '
    - name: search
      description: 'Search is the search term '
    - name: sort
      description: 'Sort is the sort key '
    - name: reverse
      description: 'Reverse is the sorting order '
    - name: collections
      description: 'Collections are collections scoping the query '
    - name: accountIDs
      description: 'AccountIDs are the account IDs scoping the query '
    - name: fields
      description: 'Select is a list of fields to select from the query (others will
        be empty) '
    - name: id
      description: 'IDs is the image id filter '
    - name: hostname
      description: 'Hosts is the host filter '
    - name: repository
      description: 'Repositories is the image repositories filter '
    - name: registry
      description: 'Registries is the image registries filter '
    - name: name
      description: 'Names is a list of full image names to query by '
    - name: layers
      description: 'IncludeImageLayers adds image CVEs to image layers '
    - name: filterBaseImage
      description: 'FilterBaseImageVulns indicates to filter the base image vulnerabilities.
        Requires predefining base images with an existing scan '
    - name: compact
      description: 'Compact indicates that only minimum image data should be sent
        (vulnerabilities, compliance and extended image metadata should be skipped) '
    - name: trustStatuses
      description: 'TrustStatuses is the trust statuses filter '
    - name: clusters
      description: 'Clusters is a list of cluster names to query by '
    description: 'DownloadImages downloads the image data '
  - name: prismacloudcompute-alert-profiles-names
    arguments: []
    description: 'AlertProfileNames returns the all alert profile names '
  - name: prismacloudcompute-current-collections
    arguments: []
    description: 'UserCollections returns collections in the current project that
      the user has permission to access '
  - name: prismacloudcompute-defenders-image-name
    arguments: []
    description: 'DefenderImage returns the path to the official defender image '
  - name: prismacloudcompute-defenders-install-bundle
    arguments:
    - name: consoleaddr
      description: 'consoleaddr is the remote console address '
    - name: defenderType
      description: 'DefenderType is the type of the defender to create the install
        bundle for '
    - name: interpreter
      description: 'Interpreter is a custom interpreter set by the user to run the
        fargate defender entrypoint script '
    outputs:
    - contextPath: PrismaCloudCompute.sharedDefenderInstallBundle.installBundle
      description: 'InstallBundle is the base64 bundle of certificates used to communicate
        with the console '
      type: String
    - contextPath: PrismaCloudCompute.sharedDefenderInstallBundle.wsAddress
      description: 'WSAddress is the websocket address (console ) the TAS defender
        connects to '
      type: String
    description: 'DefenderInstallBundle returns the install bundle according to the
      provided configuration '
  - name: prismacloudcompute-defenders-restart
    arguments:
    - name: id
      description: The defender id
      required: true
    description: 'RestartDefender restarts a specific defender '
  - name: prismacloudcompute-defenders-names
    arguments:
    - name: hostname
      description: 'Hostname indicates the query should fetch a specific defender '
    - name: role
      description: 'Roles are the defender api.Roles to filter '
    - name: cluster
      description: 'Clusters are the defender clusters to filter '
    - name: tasClusterIDs
      description: 'TASClusterIDs is used to fetch defenders that belong to the TAS
        cluster IDs '
    description: 'DefenderNames returns the defenders names by the query specification '
  - name: prismacloudcompute-defenders-summary
    arguments: []
    description: 'DefendersSummary returns the number of defenders in each defender
      category '
  - name: prismacloudcompute-deployment-host-scan
    arguments: []
    description: 'StartHostAutoDeploy starts a host auto-deploy '
  - name: prismacloudcompute-deployment-host-stop
    arguments: []
    description: 'StopHostAutoDeploy stops the host auto-deploy auto-deploy scan '
  - name: prismacloudcompute-deployment-serverless-scan
    arguments: []
    description: 'StartServerlessAutoDeploy starts a serverless auto-deploy scan '
  - name: prismacloudcompute-deployment-serverless-stop
    arguments: []
    description: 'StopServerlessAutoDeploy stops a serverless auto-deploy scan '
  - name: prismacloudcompute-groups-names
    arguments: []
    description: 'GroupNames returns all group names '
  - name: prismacloudcompute-get-users
    arguments: []
    description: 'Users returns all users, if request was sent from secondary project
      - only project''s users are returned '
  - name: prismacloudcompute-get-groups
    arguments: []
    description: 'Groups returns all user groups, if request was sent from secondary
      project - only project''s groups are returned '
  - name: prismacloudcompute-get-projects
    arguments: []
    description: 'Projects returns the project list that are viewable by the given
      user '
  - name: prismacloudcompute-get-collections
    arguments: []
    description: 'Collections returns a list of references to the used collections '
  - name: prismacloudcompute-get-backups
    arguments: []
    description: 'List returns the available backups '
  - name: prismacloudcompute-get-backups-by-id
    arguments:
    - name: id
      required: true
      description: The backup id
    description: 'DownloadBackup downloads the given backup file '
  - name: prismacloudcompute-get-alert-profiles
    arguments: []
    description: 'AlertProfiles returns the all alert profiles '
  - name: prismacloudcompute-version
    arguments: []
    description: 'Version returns the Console version '
  - name: prismacloudcompute-get-settings-alerts
    arguments: []
    description: 'AlertsSettings returns the alert settings '
  - name: prismacloudcompute-get-settings-defender
    arguments: []
    description: 'DefenderSettings returns the defenders settings '
  - name: prismacloudcompute-get-settings-logging
    arguments: []
    description: 'LoggingSettings returns the event logger settings '
  - name: prismacloudcompute-logs-console
    arguments:
    - name: lines
      required: true
      description: 'Lines is the number of lines to fetch '
    description: 'ConsoleLogs returns the last console logs '
  - name: prismacloudcompute-logs-defender
    arguments:
    - name: hostname
      description: 'Hostname is the target defender hostname '
      required: true
    - name: lines
      required: true
      description: 'Lines is the number of lines to fetch'
    description: 'DefenderLogs returns the last defender logs'
  - name: prismacloudcompute-delete-users-by-id
    arguments:
    - name: id
      required: true
      description: The user ID to delete
    description: 'DeleteUser deletes the given user '
  - name: prismacloudcompute-delete-groups-by-id
    arguments:
    - name: id
      required: true
      description: The id of the group to delete
    description: 'DeleteGroup deletes the given group name '
  - name: prismacloudcompute-delete-collections-by-id
    arguments:
    - name: id
      required: true
      description: The id of the collection to delete
    description: 'DeleteCollection deletes a collection '
  - name: prismacloudcompute-delete-alert-profiles-by-id
    arguments:
    - name: id
      required: true
      description: The id of the alert profile to delete
    description: 'DeleteAlertProfile deletes an alert profile '
  - name: prismacloudcompute-delete-backups-by-id
    arguments:
    - name: id
      required: true
      description: The id of the backup to delete
    description: 'DeleteBackup deletes the given backup '
  - name: prismacloudcompute-backups-restore
    arguments:
    - name: id
      required: true
      description: The ID of the backup to restore
    description: 'Restore invokes a mongo restore process '
  - name: prismacloudcompute-post-backups
    arguments:
    - name: name
      required: true
      description: the name of the backup to create
    - name: project
      required: true
      description: the project name
    description: 'Backup invokes a mongo backup (dump) process '
  - name: prismacloudcompute-patch-backups-by-id
    arguments:
    - name: id
      description: The id of the backup to modify
      required: true
    - name: name
      required: true
      description: the name to update the backup to
    description: 'RenameBackup renames the given backup '
  - name: prismacloudcompute-post-settings-alerts
    arguments:
    - name: aggregationPeriodMs
      description: AggregationPeriodMs is the alert aggregation period in milliseconds
    - name: consoleAddress
      required: true
      description: The console to apply the settings to
    - name: securityAdvisorWebhook
      description: SecurityAdvisorWebhook is a webhook for IBM security advisor alert
        wizard, used to authenticate the wizard with the console and to pull data
    description: 'SetAlertSettings sets the alert settings '
  - name: prismacloudcompute-post-settings-defender
    arguments:
    - name: admissionControlEnabled
      description: AdmissionControlEnabled specifies if the admission controller is
        enabled
    - name: admissionControlWebhookSuffix
      description: AdmissionControlWebhookSuffix is the relative path to the admission
        control webhook http endpoint
    - name: automaticUpgrade
      description: AutomaticUpgrade indicates defenders should be automatically upgraded
        to the latest version
    - name: disconnectPeriodDays
      description: DisconnectPeriodDays is the amount of consecutive days a defender
        must stays disconnected for it to be considered decommissioned
    - name: hostCustomComplianceEnabled
      description: HostCustomComplianceEnabled indicates the defenders support host
        custom compliance checks
    - name: listeningPort
      description: ListeningPort is the defender listening port
    description: 'SetDefenderSettings sets the settings of the defenders '
  - name: prismacloudcompute-post-collections
    arguments:
    - name: settings
      description: 'The JSON string for the desired collection configuration.  Reference:
        https://cdn.twistlock.com/docs/api/20.12/twistlock_api.html#collections_post'
    description: 'AddCollection adds the given collection '
  - name: prismacloudcompute-post-users
    arguments:
    - name: config
      required: true
      description: The JSON string of the  new user config
      defaultValue: '{  "username":"TestUser",  "password":"Password123",  "role":"auditor",  "authType":"basic"    }'
    description: 'CreateUser creates a new user '
  - name: prismacloudcompute-post-groups
    arguments:
    - name: settings
      required: true
      description: 'The JSON string. ofthe settings object for the collection. Reference:
        https://cdn.twistlock.com/docs/api/20.12/twistlock_api.html#groups_post'
    description: 'Update a group'
  - name: prismacloudcompute-put-collections-by-id
    arguments:
    - name: hosts
      description: The comma separated list of hosts
    - name: images
      description: The comma separated list of images
    - name: labels
      description: The comma separated list of labels
    - name: containers
      description: The comma separated list. of containers
    - name: functions
      description: The comma separated list of functions
    - name: namespaces
      description: The comma separated list of namespaces
    - name: appIDs
      description: The comma separated list of appIDs
    - name: accountIDs
      description: The comma separated list of accountIDs
    - name: codeRepos
      description: The comma separated list of code repos
    - name: clusters
      description: The comma separated list of clusters
    - name: name
      required: true
      description: The name of the collection
    - name: owner
      description: The owner to set on. thecollection
    - name: color
      description: The color. to assign to the collection
    description: 'UpdateCollection updates a collection '
  - name: prismacloudcompute-put-users
    arguments:
    - name: settings
      required: true
      description: 'The JSON string of the users settings object. Reference: https://cdn.twistlock.com/docs/api/20.12/twistlock_api.html#users_put '
    description: 'UpdateUser updates an existing user '
tests:
- No test
fromversion: 5.0.0
