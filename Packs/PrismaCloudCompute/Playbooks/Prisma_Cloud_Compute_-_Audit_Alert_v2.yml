id: Prisma Cloud Compute - Audit Alert v2
fromversion: 6.0.0
contentitemexportablefields:
  contentitemfields: {}
name: Prisma Cloud Compute - Audit Alert v2
description: Default playbook for parsing and enrichment of Prisma Cloud Compute audit alerts.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: db3ae054-8893-4760-871f-9e39c7439d6c
    type: start
    task:
      id: db3ae054-8893-4760-871f-9e39c7439d6c
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "5"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 152.5,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "1":
    id: "1"
    taskid: 84a32223-8565-4fa8-8829-b4f59794cd40
    type: regular
    task:
      id: 84a32223-8565-4fa8-8829-b4f59794cd40
      version: -1
      name: Parse Audit Alert
      description: Parse raw vulnerabilities JSON data
      scriptName: PrismaCloudComputeParseAuditAlert
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
      - "40"
    scriptarguments:
      alert_raw_json:
        complex:
          root: incident
          accessor: prismacloudcomputerawalertjson
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 152.5,
          "y": 250
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "2":
    id: "2"
    taskid: 4b4f6d7c-e750-40d6-8fac-62fe9ef5c71d
    type: regular
    task:
      id: 4b4f6d7c-e750-40d6-8fac-62fe9ef5c71d
      version: -1
      name: Pull Images Details
      description: Returns images by the query specification.
      script: '|||prisma-cloud-compute-images-scan-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "41"
    scriptarguments:
      name:
        complex:
          root: PrismaCloudCompute.AuditAlert
          accessor: image
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 360,
          "y": 420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "3":
    id: "3"
    taskid: b5db2a64-9264-4d81-8d75-6e57740006cb
    type: regular
    task:
      id: b5db2a64-9264-4d81-8d75-6e57740006cb
      version: -1
      name: Create Indicators from Image Vulnerabilities
      description: commands.local.cmd.new.indicator
      script: Builtin|||createNewIndicator
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      cvedescription:
        complex:
          root: PrismaCloudCompute.Images.Vulnerabilities
          accessor: Description
      cvss:
        complex:
          root: PrismaCloudCompute.Images.Vulnerabilities
          accessor: Cvss
      description:
        complex:
          root: PrismaCloudCompute.Images.Vulnerabilities
          accessor: Description
      source:
        simple: Prisma Cloud Compute
      tags:
        complex:
          root: PrismaCloudCompute.Images.Vulnerabilities
          accessor: PackageName
      type:
        simple: CVE
      value:
        complex:
          root: PrismaCloudCompute.Images.Vulnerabilities
          accessor: Cve
      verdict:
        simple: Suspicious
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -60,
          "y": 1610
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "4":
    id: "4"
    taskid: 51992a22-894a-42ef-8dd0-fc653559a679
    type: regular
    task:
      id: 51992a22-894a-42ef-8dd0-fc653559a679
      version: -1
      name: Gather Image Compliance Issues
      description: Grab the compliance issues under the image details from PCC.
      tags:
      - compliance
      scriptName: ToTable
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      columns:
        simple: Severity,Title,Description
      data:
        complex:
          root: PrismaCloudCompute.ReportsImagesScan
          filters:
          - - operator: isNotEmpty
              left:
                value:
                  simple: PrismaCloudCompute.ReportsImagesScan
                iscontext: true
          accessor: complianceIssues
      extend-context:
        simple: ComplianceTable=.
      title:
        simple: Prisma Cloud Compute  Image Compliance
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 562.5,
          "y": 2130
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    fieldMapping:
    - incidentfield: Prisma Cloud Compute Markdown
      output:
        simple: ${ComplianceTable}
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "5":
    id: "5"
    taskid: 7dc085aa-78a5-4cda-85a4-34a52e8996a3
    type: title
    task:
      id: 7dc085aa-78a5-4cda-85a4-34a52e8996a3
      version: -1
      name: Case Details
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "50"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 152.5,
          "y": -85
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "6":
    id: "6"
    taskid: 8d9783d2-8e97-43e3-8c4b-898be3c924fe
    type: title
    task:
      id: 8d9783d2-8e97-43e3-8c4b-898be3c924fe
      version: -1
      name: Vulnerability
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "46"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "7":
    id: "7"
    taskid: 322282a6-f431-42cb-8870-815cb2a23ca0
    type: title
    task:
      id: 322282a6-f431-42cb-8870-815cb2a23ca0
      version: -1
      name: Compliance
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "48"
      - "36"
      - "8"
      - "9"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1790
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "8":
    id: "8"
    taskid: ff89e4a9-aba3-43e8-8bb1-2cf9c07295dc
    type: regular
    task:
      id: ff89e4a9-aba3-43e8-8bb1-2cf9c07295dc
      version: -1
      name: Get Defender Policy
      description: DefenderSettings returns the settings in the Defender policy.
      tags:
      - policy
      script: '|||prisma-cloud-compute-get-settings-defender'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -237.5,
          "y": 1930
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    scriptarguments:
      hostname:
        complex:
          root: inputs.Hostname
    continueonerrortype: ""
  "9":
    id: "9"
    taskid: 4215ebf3-1e3b-4622-8d79-f9cfc8517cc5
    type: regular
    task:
      id: 4215ebf3-1e3b-4622-8d79-f9cfc8517cc5
      version: -1
      name: Get Alert Profiles
      description: AlertProfiles returns all the alert profiles.
      tags:
      - policy
      script: '|||prisma-cloud-compute-get-alert-profiles'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -637.5,
          "y": 1930
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    scriptarguments:
      project:
        complex:
          root: inputs.Project
    continueonerrortype: ""
  "11":
    id: "11"
    taskid: 254a6d61-f787-42f2-8a45-fc0c215e1907
    type: title
    task:
      id: 254a6d61-f787-42f2-8a45-fc0c215e1907
      version: -1
      name: Remediation
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "42"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 3340
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "26":
    id: "26"
    taskid: bcbcedc0-522c-4be7-8bd4-6fea19b90d59
    type: regular
    task:
      id: bcbcedc0-522c-4be7-8bd4-6fea19b90d59
      version: -1
      name: Close Investigation
      description: commands.local.cmd.close.inv
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "27"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 3650
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "27":
    id: "27"
    taskid: aaac1ae4-577c-478d-8bb5-1a9266353c6f
    type: title
    task:
      id: aaac1ae4-577c-478d-8bb5-1a9266353c6f
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -860,
          "y": 3820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "29":
    id: "29"
    taskid: bd59a2a5-6944-4e4d-87e2-f86c3e3a364d
    type: title
    task:
      id: bd59a2a5-6944-4e4d-87e2-f86c3e3a364d
      version: -1
      name: Forensics
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "39"
      - "37"
      - "30"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 2305
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "30":
    id: "30"
    taskid: 5d1c22c5-ce15-4099-8775-da0166eef5fe
    type: regular
    task:
      id: 5d1c22c5-ce15-4099-8775-da0166eef5fe
      version: -1
      name: Get Defender Logs
      description: DefenderLogs returns the last Defender logs.
      script: '|||prisma-cloud-compute-logs-defender'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      hostname:
        complex:
          root: incident
          accessor: prismacloudcomputehost
      lines:
        simple: "20"
      execution-timeout:
        simple: "120"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 2450
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "31":
    id: "31"
    taskid: f207d4d1-0310-44df-89d3-6ca37a21bf6d
    type: regular
    task:
      id: f207d4d1-0310-44df-89d3-6ca37a21bf6d
      version: -1
      name: List Defender Backups
      description: List returns the available backups.
      tags:
      - backups
      script: '|||prisma-cloud-compute-get-backups'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "43"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 160,
          "y": 2940
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    scriptarguments:
      project:
        complex:
          root: inputs.Project
    continueonerrortype: ""
  "32":
    id: "32"
    taskid: a55e5283-f032-4b84-887e-cfa917ddd83a
    type: regular
    task:
      id: a55e5283-f032-4b84-887e-cfa917ddd83a
      version: -1
      name: Download Defender Logs
      description: DownloadDefenderLogs downloads all defender logs and metadata.
      script: '|||prisma-cloud-compute-logs-defender-download'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      hostname:
        complex:
          root: incident
          accessor: prismacloudcomputehost
      ignore-outputs:
        simple: "true"
      lines:
        simple: "50"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 160,
          "y": 2775
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "34":
    id: "34"
    taskid: 4547f477-6d5a-4e84-8263-78c0dd9b0337
    type: regular
    task:
      id: 4547f477-6d5a-4e84-8263-78c0dd9b0337
      version: -1
      name: Set Logs to Layout
      description: Convert an array to a nice table display (usually from the context).
      scriptName: ToTable
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      data:
        complex:
          root: PrismaCloudCompute.Defenders
          accessor: Logs
      extend-context:
        simple: LogsTable=.
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 160,
          "y": 2610
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    fieldMapping:
    - incidentfield: Prisma Cloud Compute Defender Logs
      output:
        simple: ${LogsTable}
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "36":
    id: "36"
    taskid: 5cbd5d69-2c0d-42f1-8cff-f4b546c4d9e5
    type: regular
    task:
      id: 5cbd5d69-2c0d-42f1-8cff-f4b546c4d9e5
      version: -1
      name: Get Container WaaS Policies
      description: Get the Waas container policies from Defend >> WAAS >> Containers.
      tags:
      - policy
      script: '|||prisma-cloud-compute-get-waas-policies'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      extend-context:
        simple: PCC=.
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1930
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "37":
    id: "37"
    taskid: 79b89358-7e2a-46c2-8030-51745b3ea251
    type: regular
    task:
      id: 79b89358-7e2a-46c2-8030-51745b3ea251
      version: -1
      name: Get container profile
      description: Get information about the containers and their profile events. This command supports asterisks which allows you to get container profiles by filtering its fields according to a specific substring.
      tags:
      - forensics
      script: '|||prisma-cloud-compute-profile-container-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "38"
    scriptarguments:
      image:
        complex:
          root: incident
          accessor: prismacloudcomputeimage
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -237.5,
          "y": 2450
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "38":
    id: "38"
    taskid: 7f20b0cb-4b69-4f00-8b8b-414f04b6284d
    type: regular
    task:
      id: 7f20b0cb-4b69-4f00-8b8b-414f04b6284d
      version: -1
      name: Get container forensics
      description: Get runtime forensics data for a specific container on a specific host
      script: '|||prisma-cloud-compute-profile-container-forensic-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      hostname:
        complex:
          root: incident
          accessor: prismacloudcomputefqdn
      id:
        complex:
          root: PrismaCloudCompute.ProfileContainer
          accessor: _id
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -237.5,
          "y": 2610
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "39":
    id: "39"
    taskid: e13fe5b4-f24e-43b6-841c-d9bd7bb38417
    type: regular
    task:
      id: e13fe5b4-f24e-43b6-841c-d9bd7bb38417
      version: -1
      name: Get Host Profile
      description: Get information about the hosts and their profile events. This command supports asterisks which allows you to get host profiles by filtering its fields according to a specific substring.
      script: '|||prisma-cloud-compute-profile-host-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      hostname:
        complex:
          root: incident
          accessor: prismacloudcomputehost
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 562.5,
          "y": 2450
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "40":
    id: "40"
    taskid: 8ee4a197-c75a-4086-8afc-8c1fe553ec67
    type: regular
    task:
      id: 8ee4a197-c75a-4086-8afc-8c1fe553ec67
      version: -1
      name: Get Image Audits
      description: Get the audits for the firewall container policies.
      script: '|||prisma-cloud-compute-get-audit-firewall-container-alerts'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "41"
    scriptarguments:
      FromDays:
        simple: "5"
      ImageName:
        complex:
          root: PrismaCloudCompute.AuditAlert
          accessor: image
      audit_type:
        complex:
          root: PrismaCloudCompute.AuditAlert
          accessor: category
          transformers:
          - operator: toLowerCase
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -40,
          "y": 420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "41":
    id: "41"
    taskid: 25cbf286-7964-4a9d-87e9-7536f9b15330
    type: regular
    task:
      id: 25cbf286-7964-4a9d-87e9-7536f9b15330
      version: -1
      name: Set Audits to Table
      description: Convert an array to a nice table display (usually, from the context).
      scriptName: ToTable
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "47"
    scriptarguments:
      data:
        complex:
          root: PrismaCloudCompute
          accessor: AuditAlert
      extend-context:
        simple: AuditTable=.
      ignore-outputs:
        simple: "true"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    fieldMapping:
    - incidentfield: Prisma Cloud Compute Audit Table
      output:
        simple: ${AuditTable}
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "42":
    id: "42"
    taskid: 11732986-9502-4f54-89f1-764d6aa7fae2
    type: regular
    task:
      id: 11732986-9502-4f54-89f1-764d6aa7fae2
      version: -1
      name: Manually Remediate
      type: regular
      iscommand: false
      brand: ""
      description: 'Perform manual remediation to ensure full incident resolution'
    nexttasks:
      '#none#':
      - "26"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 3475
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "43":
    id: "43"
    taskid: 026f0016-5169-4008-8c5b-d9d278f4bdfc
    type: regular
    task:
      id: 026f0016-5169-4008-8c5b-d9d278f4bdfc
      version: -1
      name: Create Indicator Table
      description: commands.local.cmd.find.indicators
      script: Builtin|||findIndicators
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      extend-context:
        simple: 'Indicators=.={"Value": val.value, "Description": val.CustomFields.description,
          "CVSS": val.CustomFields.cvss}'
      ignore-outputs:
        simple: "true"
      query:
        simple: incident.id:${incident.id} and type:CVE
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 160,
          "y": 3105
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "44":
    id: "44"
    taskid: cd7da102-4f9f-474b-8711-b84f62bd73bb
    type: regular
    task:
      id: cd7da102-4f9f-474b-8711-b84f62bd73bb
      version: -1
      name: Create Link Back
      description: Create a URL link back to the alert in Prisma Cloud Compute
      scriptName: CreatePrismaCloudComputeLink
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "45"
    scriptarguments:
      imageName:
        complex:
          root: PrismaCloudCompute.AuditAlert
          accessor: image
      type:
        complex:
          root: PrismaCloudCompute.AuditAlert
          accessor: category
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -50,
          "y": 945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "45":
    id: "45"
    taskid: b34ca96a-a37e-4db9-851b-e454e3affcd0
    type: regular
    task:
      id: b34ca96a-a37e-4db9-851b-e454e3affcd0
      version: -1
      name: Set Incident Link
      description: commands.local.cmd.set.incident
      script: Builtin|||setIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      externallink:
        complex:
          root: link
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -50,
          "y": 1120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "46":
    id: "46"
    taskid: 53edaafd-d9af-4a6c-8a32-a353ee2ab101
    type: condition
    task:
      id: 53edaafd-d9af-4a6c-8a32-a353ee2ab101
      version: -1
      name: Check if Alert has Vulnerabilities
      description: ''
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "7"
      "yes":
      - "3"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PrismaCloudCompute.Images
                accessor: Vulnerabilities
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PrismaCloudCompute.Images.Vulnerabilities
                accessor: Cve
            iscontext: true
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1440
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "47":
    id: "47"
    taskid: 83a74569-772e-474f-898b-b61d1fa914d3
    type: condition
    task:
      id: 83a74569-772e-474f-898b-b61d1fa914d3
      version: -1
      name: Does baseUrl exist in inputs?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "6"
      "yes":
      - "44"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: inputs.baseUrl
            iscontext: true
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "48":
    id: "48"
    taskid: 5ab189a5-939a-47b1-8e24-c443e7e0c226
    type: condition
    task:
      id: 5ab189a5-939a-47b1-8e24-c443e7e0c226
      version: -1
      name: Check if Image Compliance Issues Exist
      description: ''
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "29"
      "yes":
      - "4"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.ReportsImagesScan.complianceIssues
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 562.5,
          "y": 1930
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: 4d4965da-d2aa-449e-8c6e-5a6a0a7ecf2b
    type: condition
    task:
      id: 4d4965da-d2aa-449e-8c6e-5a6a0a7ecf2b
      version: -1
      name: Check if Raw Alert JSON exist
      description: ''
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "27"
      "yes":
      - "1"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: incident
                accessor: prismacloudcomputerawalertjson
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 152.5,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 4105,
        "width": 1802.5,
        "x": -860,
        "y": -220
      }
    }
  }
inputs:
- key: baseUrl
  value: {}
  required: false
  description: The base URL of the Prisma Cloud Compute Instance used to create a link back to the alerts for an image.
  playbookInputQuery:
- key: Project
  value:
    complex:
      root: PrismaCloudCompute.AlertProfiles.ServiceNow
      accessor: Project
  required: false
  description: A specific project name to get alert profiles for
  playbookInputQuery:
- key: Hostname
  value:
    complex:
      root: PrismaCloudCompute.AuditAlert
      accessor: host
  required: false
  description: The Defender hostname
  playbookInputQuery:
outputs: []
tests:
- No tests (auto formatted)
version: -1
