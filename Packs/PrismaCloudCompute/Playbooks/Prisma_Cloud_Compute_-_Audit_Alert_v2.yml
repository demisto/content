id: Prisma Cloud Compute - Audit Alert v2
fromversion: 6.0.0
name: Prisma Cloud Compute - Audit Alert v2
description: Default playbook for parsing and enrichment of Prisma Cloud Compute audit alerts.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 3a920af3-5cf7-470b-81db-259a87806442
    type: start
    task:
      id: 3a920af3-5cf7-470b-81db-259a87806442
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "5"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": -450
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "1":
    id: "1"
    taskid: 8b4dd4ce-2565-4bc4-86d7-4fd53bdaf9e4
    type: regular
    task:
      id: 8b4dd4ce-2565-4bc4-86d7-4fd53bdaf9e4
      version: -1
      name: Parse Audit Alert
      description: Parse raw vulnerabilities JSON data
      scriptName: PrismaCloudComputeParseAuditAlert
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      alert_raw_json:
        complex:
          root: incident
          accessor: prismacloudcomputerawalertjson
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 20
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "2":
    id: "2"
    taskid: f9094a64-5007-49be-82f2-fa56c37877a6
    type: regular
    task:
      id: f9094a64-5007-49be-82f2-fa56c37877a6
      version: -1
      name: Pull Images Details
      description: Returns images by the query specification.
      script: '|||prisma-cloud-compute-images-scan-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "40"
    scriptarguments:
      name:
        complex:
          root: PrismaCloudCompute.AuditAlert
          accessor: image
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "3":
    id: "3"
    taskid: c56e8983-80b1-470a-8a20-319a48dfb100
    type: regular
    task:
      id: c56e8983-80b1-470a-8a20-319a48dfb100
      version: -1
      name: Create Indicators from Image Vulnerabilities
      description: commands.local.cmd.new.indicator
      script: Builtin|||createNewIndicator
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      cvedescription:
        complex:
          root: PrismaCloudCompute.Images.Vulnerabilities
          accessor: Description
      cvss:
        complex:
          root: PrismaCloudCompute.Images.Vulnerabilities
          accessor: Cvss
      description:
        complex:
          root: PrismaCloudCompute.Images.Vulnerabilities
          accessor: Description
      source:
        simple: Prisma Cloud Compute
      tags:
        complex:
          root: PrismaCloudCompute.Images.Vulnerabilities
          accessor: PackageName
      type:
        simple: CVE
      value:
        complex:
          root: PrismaCloudCompute.Images.Vulnerabilities
          accessor: Cve
      verdict:
        simple: Suspicious
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -60,
          "y": 1610
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "4":
    id: "4"
    taskid: 1d6a6572-f067-4e36-8566-a456d05672ae
    type: regular
    task:
      id: 1d6a6572-f067-4e36-8566-a456d05672ae
      version: -1
      name: Gather Image Compliance Issues
      description: Grab the compliance issues under the image details from PCC.
      tags:
      - compliance
      scriptName: ToTable
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      columns:
        simple: Severity,Title,Description
      data:
        complex:
          root: PrismaCloudCompute.ReportsImagesScan
          filters:
          - - operator: isNotEmpty
              left:
                value:
                  simple: PrismaCloudCompute.ReportsImagesScan
                iscontext: true
          accessor: complianceIssues
      extend-context:
        simple: ComplianceTable=.
      title:
        simple: Prisma Cloud Compute  Image Compliance
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 562.5,
          "y": 2130
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    fieldMapping:
    - incidentfield: Prisma Cloud Compute Markdown
      output:
        simple: ${ComplianceTable}
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "5":
    id: "5"
    taskid: 97664d98-4394-49c1-81c4-a3dcdbe68f1c
    type: title
    task:
      id: 97664d98-4394-49c1-81c4-a3dcdbe68f1c
      version: -1
      name: Case Details
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "51"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": -315
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "6":
    id: "6"
    taskid: 786c1d28-d6b0-49e4-8771-14b70638366e
    type: title
    task:
      id: 786c1d28-d6b0-49e4-8771-14b70638366e
      version: -1
      name: Vulnerability
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "46"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "7":
    id: "7"
    taskid: 68ec1e71-cab5-4191-8daf-b5e4ce6a1d75
    type: title
    task:
      id: 68ec1e71-cab5-4191-8daf-b5e4ce6a1d75
      version: -1
      name: Compliance
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "48"
      - "36"
      - "8"
      - "9"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1790
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "8":
    id: "8"
    taskid: 6494faa2-770b-41ce-8f92-b189a29d3f95
    type: regular
    task:
      id: 6494faa2-770b-41ce-8f92-b189a29d3f95
      version: -1
      name: Get Defender Policy
      description: DefenderSettings returns the settings in the Defender policy.
      tags:
      - policy
      script: '|||prisma-cloud-compute-get-settings-defender'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -237.5,
          "y": 1930
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    scriptarguments:
      hostname:
        complex:
          root: inputs.Hostname
    continueonerrortype: ""
  "9":
    id: "9"
    taskid: ca97d2ac-8833-49c6-85d9-ba8a08b82efa
    type: regular
    task:
      id: ca97d2ac-8833-49c6-85d9-ba8a08b82efa
      version: -1
      name: Get Alert Profiles
      description: AlertProfiles returns all the alert profiles.
      tags:
      - policy
      script: '|||prisma-cloud-compute-get-alert-profiles'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -637.5,
          "y": 1930
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    scriptarguments:
      project:
        complex:
          root: inputs.Project
    continueonerrortype: ""
  "11":
    id: "11"
    taskid: f24196f6-bd99-4aea-8eee-6b8dab13a6f4
    type: title
    task:
      id: f24196f6-bd99-4aea-8eee-6b8dab13a6f4
      version: -1
      name: Remediation
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "42"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 3340
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "26":
    id: "26"
    taskid: 2c94801f-fbad-45ed-8bd1-805dca9518c0
    type: regular
    task:
      id: 2c94801f-fbad-45ed-8bd1-805dca9518c0
      version: -1
      name: Close Investigation
      description: commands.local.cmd.close.inv
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "27"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 3650
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "27":
    id: "27"
    taskid: 75d4200a-a7f6-468b-8387-fbd26ca570ca
    type: title
    task:
      id: 75d4200a-a7f6-468b-8387-fbd26ca570ca
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -860,
          "y": 3820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "29":
    id: "29"
    taskid: b486fe4f-d426-488f-81cf-a2b03c986925
    type: title
    task:
      id: b486fe4f-d426-488f-81cf-a2b03c986925
      version: -1
      name: Forensics
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "39"
      - "37"
      - "30"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 2305
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "30":
    id: "30"
    taskid: de7f872b-8277-4d5d-8eb4-b06d41118a3a
    type: regular
    task:
      id: de7f872b-8277-4d5d-8eb4-b06d41118a3a
      version: -1
      name: Get Defender Logs
      description: DefenderLogs returns the last Defender logs.
      script: '|||prisma-cloud-compute-logs-defender'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      hostname:
        complex:
          root: incident
          accessor: prismacloudcomputehost
      lines:
        simple: "20"
      execution-timeout:
        simple: "120"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 2450
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "31":
    id: "31"
    taskid: 35a39c12-c43c-4876-8159-390cedd65f7d
    type: regular
    task:
      id: 35a39c12-c43c-4876-8159-390cedd65f7d
      version: -1
      name: List Defender Backups
      description: List returns the available backups.
      tags:
      - backups
      script: '|||prisma-cloud-compute-get-backups'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "43"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 160,
          "y": 2940
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    scriptarguments:
      project:
        complex:
          root: inputs.Project
    continueonerrortype: ""
  "32":
    id: "32"
    taskid: ebeb642a-58b5-411e-8655-115861159624
    type: regular
    task:
      id: ebeb642a-58b5-411e-8655-115861159624
      version: -1
      name: Download Defender Logs
      description: DownloadDefenderLogs downloads all defender logs and metadata.
      script: '|||prisma-cloud-compute-logs-defender-download'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      hostname:
        complex:
          root: incident
          accessor: prismacloudcomputehost
      ignore-outputs:
        simple: "true"
      lines:
        simple: "50"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 160,
          "y": 2775
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "34":
    id: "34"
    taskid: 20e9adbd-981c-4306-89fe-4f3a1c642a22
    type: regular
    task:
      id: 20e9adbd-981c-4306-89fe-4f3a1c642a22
      version: -1
      name: Set Logs to Layout
      description: Convert an array to a nice table display (usually from the context).
      scriptName: ToTable
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      data:
        complex:
          root: PrismaCloudCompute.Defenders
          accessor: Logs
      extend-context:
        simple: LogsTable=.
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 160,
          "y": 2610
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    fieldMapping:
    - incidentfield: Prisma Cloud Compute Defender Logs
      output:
        simple: ${LogsTable}
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "36":
    id: "36"
    taskid: 01cc50d3-aa34-4eeb-8ba4-57396179fe36
    type: regular
    task:
      id: 01cc50d3-aa34-4eeb-8ba4-57396179fe36
      version: -1
      name: Get Container WaaS Policies
      description: Get the Waas container policies from Defend >> WAAS >> Containers.
      tags:
      - policy
      script: '|||prisma-cloud-compute-get-waas-policies'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      extend-context:
        simple: PCC=.
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1930
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "37":
    id: "37"
    taskid: 826d9b8d-6672-42ab-8139-9687f8835c51
    type: regular
    task:
      id: 826d9b8d-6672-42ab-8139-9687f8835c51
      version: -1
      name: Get container profile
      description: Get information about the containers and their profile events. This command supports asterisks which allows you to get container profiles by filtering its fields according to a specific substring.
      tags:
      - forensics
      script: '|||prisma-cloud-compute-profile-container-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "38"
    scriptarguments:
      image:
        complex:
          root: PrismaCloudCompute.ReportsImagesScan.cloudMetadata
          accessor: image
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -237.5,
          "y": 2450
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "38":
    id: "38"
    taskid: 232f6c5e-8e7a-48a9-838a-1375d387c6ef
    type: regular
    task:
      id: 232f6c5e-8e7a-48a9-838a-1375d387c6ef
      version: -1
      name: Get container forensics
      description: Get runtime forensics data for a specific container on a specific host
      script: '|||prisma-cloud-compute-profile-container-forensic-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      hostname:
        complex:
          root: incident
          accessor: prismacloudcomputefqdn
      id:
        complex:
          root: PrismaCloudCompute.ProfileContainer
          accessor: _id
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -237.5,
          "y": 2610
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "39":
    id: "39"
    taskid: 2979962e-e69f-4a9f-8947-68eee1843701
    type: regular
    task:
      id: 2979962e-e69f-4a9f-8947-68eee1843701
      version: -1
      name: Get Host Profile
      description: Get information about the hosts and their profile events. This command supports asterisks which allows you to get host profiles by filtering its fields according to a specific substring.
      script: '|||prisma-cloud-compute-profile-host-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      hostname:
        complex:
          root: incident
          accessor: prismacloudcomputehost
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 562.5,
          "y": 2450
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "40":
    id: "40"
    taskid: c9c61a3b-c447-402b-8403-0cd565e3a773
    type: regular
    task:
      id: c9c61a3b-c447-402b-8403-0cd565e3a773
      version: -1
      name: Get Image Audits
      description: Get the audits for the firewall container policies.
      script: '|||prisma-cloud-compute-get-audit-firewall-container-alerts'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "41"
    scriptarguments:
      FromDays:
        simple: "5"
      ImageName:
        complex:
          root: PrismaCloudCompute.ReportsImagesScan.cloudMetadata
          accessor: image
          transformers:
          - operator: uniq
      audit_type:
        complex:
          root: PrismaCloudCompute.AuditAlert
          accessor: category
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 430
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "41":
    id: "41"
    taskid: ad726709-20d4-4f8a-802a-cf0ded0a95ca
    type: regular
    task:
      id: ad726709-20d4-4f8a-802a-cf0ded0a95ca
      version: -1
      name: Set Audits to Table
      description: Convert an array to a nice table display (usually, from the context).
      scriptName: ToTable
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "47"
    scriptarguments:
      data:
        complex:
          root: PrismaCloudCompute
          accessor: AuditAlert
      extend-context:
        simple: AuditTable=.
      ignore-outputs:
        simple: "true"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    fieldMapping:
    - incidentfield: Prisma Cloud Compute Audit Table
      output:
        simple: ${AuditTable}
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "42":
    id: "42"
    taskid: 8a4d0176-17d0-4553-8032-68e6d09857bd
    type: regular
    task:
      id: 8a4d0176-17d0-4553-8032-68e6d09857bd
      version: -1
      name: Manually Remediate
      type: regular
      iscommand: false
      brand: ""
      description: 'Perform manual remediation to ensure full incident resolution'
    nexttasks:
      '#none#':
      - "26"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 3475
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "43":
    id: "43"
    taskid: 32be49b0-cd69-4385-8ee2-b72d52c19107
    type: regular
    task:
      id: 32be49b0-cd69-4385-8ee2-b72d52c19107
      version: -1
      name: Create Indicator Table
      description: commands.local.cmd.find.indicators
      script: Builtin|||findIndicators
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      extend-context:
        simple: 'Indicators=.={"Value": val.value, "Description": val.CustomFields.description, "CVSS": val.CustomFields.cvss}'
      ignore-outputs:
        simple: "true"
      query:
        simple: incident.id:${incident.id} and type:CVE
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 152.5,
          "y": 3105
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "44":
    id: "44"
    taskid: 5bfb0e59-6d56-47f3-8888-b62d31c294c7
    type: regular
    task:
      id: 5bfb0e59-6d56-47f3-8888-b62d31c294c7
      version: -1
      name: Create Link Back
      scriptName: CreatePrismaCloudComputeLink
      type: regular
      iscommand: false
      brand: ""
      description: 'Create a URL link back to the alert in Prisma Cloud Compute'
    nexttasks:
      '#none#':
      - "45"
    scriptarguments:
      imageName:
        complex:
          root: PrismaCloudCompute.AuditAlert
          accessor: image
      type:
        complex:
          root: PrismaCloudCompute.AuditAlert
          accessor: category
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -50,
          "y": 945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "45":
    id: "45"
    taskid: 0f567bd7-0c8b-4ee1-8391-8d3210d71bd5
    type: regular
    task:
      id: 0f567bd7-0c8b-4ee1-8391-8d3210d71bd5
      version: -1
      name: Set Incident Link
      description: commands.local.cmd.set.incident
      script: Builtin|||setIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      externallink:
        complex:
          root: link
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -50,
          "y": 1120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "46":
    id: "46"
    taskid: 7a23ee9f-5ebb-48fb-808c-5c979645262d
    type: condition
    task:
      id: 7a23ee9f-5ebb-48fb-808c-5c979645262d
      version: -1
      name: Check if Alert has Vulnerabilities
      description: ''
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "7"
      "yes":
      - "3"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PrismaCloudCompute.Images
                accessor: Vulnerabilities
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PrismaCloudCompute.Images.Vulnerabilities
                accessor: Cve
            iscontext: true
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1440
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "47":
    id: "47"
    taskid: d159b923-cf0e-410a-805b-4b0aaff9bf9c
    type: condition
    task:
      id: d159b923-cf0e-410a-805b-4b0aaff9bf9c
      version: -1
      name: Does baseUrl exist in inputs?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "6"
      "yes":
      - "44"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: inputs.baseUrl
            iscontext: true
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "48":
    id: "48"
    taskid: c1904967-2efc-4a64-836f-3f559fed4912
    type: condition
    task:
      id: c1904967-2efc-4a64-836f-3f559fed4912
      version: -1
      name: Check if Image Compliance Issues Exist
      description: ''
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "29"
      "yes":
      - "4"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.ReportsImagesScan.complianceIssues
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 562.5,
          "y": 1930
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: 3ed0b2ee-1f8c-4bae-8c89-636a17a0213b
    type: condition
    task:
      id: 3ed0b2ee-1f8c-4bae-8c89-636a17a0213b
      version: -1
      name: Check if Raw Alert JSON exist
      description: ''
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "27"
      "yes":
      - "1"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: incident
                accessor: prismacloudcomputerawalertjson
            iscontext: true
          right:
            value: {}
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: prismacloudcomputerawalertjson
            iscontext: true
          right:
            value:
              simple: '"kind": "audit"'
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": -180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 4335,
        "width": 1802.5,
        "x": -860,
        "y": -450
      }
    }
  }
inputs:
- key: baseUrl
  value: {}
  required: false
  description: The base URL of the Prisma Cloud Compute Instance used to create a link back to the alerts for an image.
  playbookInputQuery:
- key: Project
  value:
    complex:
      root: PrismaCloudCompute.AlertProfiles.ServiceNow
      accessor: Project
  required: false
  description: A specific project name to get alert profiles for
  playbookInputQuery:
- key: Hostname
  value:
    complex:
      root: PrismaCloudCompute.AuditAlert
      accessor: host
  required: false
  description: The Defender hostname
  playbookInputQuery:
outputs: []
tests:
- No tests (auto formatted)
version: -1
