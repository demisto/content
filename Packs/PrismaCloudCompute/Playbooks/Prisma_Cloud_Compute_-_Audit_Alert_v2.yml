id: Prisma Cloud Compute - Audit Alert v2
fromversion: 6.0.0
name: Prisma Cloud Compute - Audit Alert v2
description: Default playbook for parsing and enrichment of Prisma Cloud Compute audit alerts.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: c4f04383-aae8-453b-83d8-0aec37f12a07
    type: start
    task:
      id: c4f04383-aae8-453b-83d8-0aec37f12a07
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "5"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": -790
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "1":
    id: "1"
    taskid: 9406d496-c199-447b-879b-004d2b3b49d4
    type: regular
    task:
      id: 9406d496-c199-447b-879b-004d2b3b49d4
      version: -1
      name: Parse Audit Alert
      description: Parse raw vulnerabilities JSON data
      scriptName: PrismaCloudComputeParseAuditAlert
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "53"
    scriptarguments:
      alert_raw_json:
        complex:
          root: incident
          accessor: prismacloudcomputerawalertjson
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": -330
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "2":
    id: "2"
    taskid: d0004c46-d840-4074-89fa-c9d48b66ed76
    type: regular
    task:
      id: d0004c46-d840-4074-89fa-c9d48b66ed76
      version: -1
      name: Pull Images Details
      description: Returns images by the query specification.
      script: '|||prisma-cloud-compute-images-scan-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "58"
    scriptarguments:
      name:
        complex:
          root: PrismaCloudCompute.AuditAlert
          accessor: image
      hostname:
        complex:
          root: PrismaCloudCompute.AuditAlert
          accessor: host
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "3":
    id: "3"
    taskid: 66b5ecfb-bb17-4357-82d0-75f3ef0b0ade
    type: regular
    task:
      id: 66b5ecfb-bb17-4357-82d0-75f3ef0b0ade
      version: -1
      name: Create Indicators from Image Vulnerabilities
      description: commands.local.cmd.new.indicator
      script: Builtin|||createNewIndicator
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      cvedescription:
        complex:
          root: PrismaCloudCompute.Images.Vulnerabilities
          accessor: Description
      cvss:
        complex:
          root: PrismaCloudCompute.Images.Vulnerabilities
          accessor: Cvss
      description:
        complex:
          root: PrismaCloudCompute.Images.Vulnerabilities
          accessor: Description
      source:
        simple: Prisma Cloud Compute
      tags:
        complex:
          root: PrismaCloudCompute.Images.Vulnerabilities
          accessor: PackageName
      type:
        simple: CVE
      value:
        complex:
          root: PrismaCloudCompute.Images.Vulnerabilities
          accessor: Cve
      verdict:
        simple: Suspicious
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1280
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "4":
    id: "4"
    taskid: d7608152-9d50-4c25-8a8c-ce9ba068c748
    type: regular
    task:
      id: d7608152-9d50-4c25-8a8c-ce9ba068c748
      version: -1
      name: Gather Image Compliance Issues
      description: Grab the compliance issues under the image details from PCC.
      tags:
      - compliance
      scriptName: ToTable
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      columns:
        simple: Severity,Title,Description
      data:
        complex:
          root: PrismaCloudCompute.ReportsImagesScan
          accessor: complianceIssues
      extend-context:
        simple: ComplianceTable=.
      title:
        simple: Prisma Cloud Compute  Image Compliance
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 562.5,
          "y": 1800
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    fieldMapping:
    - incidentfield: Prisma Cloud Compute Markdown
      output:
        simple: ${ComplianceTable}
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "5":
    id: "5"
    taskid: d87d7bfd-d210-430f-8bf1-96565af0ae81
    type: title
    task:
      id: d87d7bfd-d210-430f-8bf1-96565af0ae81
      version: -1
      name: Case Details
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "50"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": -655
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "6":
    id: "6"
    taskid: 51d53db3-9245-4d9d-8eaf-153c19a9583a
    type: title
    task:
      id: 51d53db3-9245-4d9d-8eaf-153c19a9583a
      version: -1
      name: Vulnerability
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "46"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 925
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "7":
    id: "7"
    taskid: 1abbb280-d4bf-4355-8d0e-1a9f2aa375f8
    type: title
    task:
      id: 1abbb280-d4bf-4355-8d0e-1a9f2aa375f8
      version: -1
      name: Compliance
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "48"
      - "36"
      - "8"
      - "55"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1460
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "8":
    id: "8"
    taskid: 333b4ff1-514c-4672-866c-ae63a9e8b6d0
    type: regular
    task:
      id: 333b4ff1-514c-4672-866c-ae63a9e8b6d0
      version: -1
      name: Get Defender Policy
      description: DefenderSettings returns the settings in the Defender policy.
      tags:
      - policy
      script: '|||prisma-cloud-compute-get-settings-defender'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -237.5,
          "y": 1600
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    scriptarguments:
      hostname:
        complex:
          root: PrismaCloudCompute.AuditAlert
          accessor: host
    continueonerrortype: ""
  "9":
    id: "9"
    taskid: 956c7df8-947f-4b80-89e8-2d606180ee17
    type: regular
    task:
      id: 956c7df8-947f-4b80-89e8-2d606180ee17
      version: -1
      name: Get Alert Profiles
      description: AlertProfiles returns all the alert profiles.
      tags:
      - policy
      script: '|||prisma-cloud-compute-get-alert-profiles'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -640,
          "y": 1780
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    scriptarguments:
      project:
        complex:
          root: inputs.Project
    continueonerrortype: ""
  "11":
    id: "11"
    taskid: d1225274-1d20-4f40-8fa8-0966ff69acd1
    type: title
    task:
      id: d1225274-1d20-4f40-8fa8-0966ff69acd1
      version: -1
      name: Remediation
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "42"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 160,
          "y": 2940
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "26":
    id: "26"
    taskid: b69aedcf-bdd8-4fdd-8c37-d3b0d1b25452
    type: regular
    task:
      id: b69aedcf-bdd8-4fdd-8c37-d3b0d1b25452
      version: -1
      name: Close Investigation
      description: commands.local.cmd.close.inv
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "27"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 160,
          "y": 3290
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "27":
    id: "27"
    taskid: 13107dad-970c-48b2-8336-6924420d3178
    type: title
    task:
      id: 13107dad-970c-48b2-8336-6924420d3178
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -850,
          "y": 3460
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "29":
    id: "29"
    taskid: 493af945-6056-40ba-872f-c4b3da228e82
    type: title
    task:
      id: 493af945-6056-40ba-872f-c4b3da228e82
      version: -1
      name: Forensics
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "39"
      - "30"
      - "56"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1975
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "30":
    id: "30"
    taskid: b604d22b-fe66-46b5-88a5-10cf9c855ec1
    type: regular
    task:
      id: b604d22b-fe66-46b5-88a5-10cf9c855ec1
      version: -1
      name: Get Defender Logs
      description: DefenderLogs returns the last Defender logs.
      script: '|||prisma-cloud-compute-logs-defender'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      hostname:
        complex:
          root: incident
          accessor: prismacloudcomputehost
      lines:
        simple: "20"
      execution-timeout:
        simple: "120"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "31":
    id: "31"
    taskid: 8d590347-7386-49b2-8af0-04245ad471d7
    type: regular
    task:
      id: 8d590347-7386-49b2-8af0-04245ad471d7
      version: -1
      name: List Defender Backups
      description: List returns the available backups.
      tags:
      - backups
      script: '|||prisma-cloud-compute-get-backups'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "43"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 160,
          "y": 2610
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    scriptarguments:
      project:
        complex:
          root: inputs.Project
    continueonerrortype: ""
  "32":
    id: "32"
    taskid: 5841378b-a708-4951-85ee-114b3060765c
    type: regular
    task:
      id: 5841378b-a708-4951-85ee-114b3060765c
      version: -1
      name: Download Defender Logs
      description: DownloadDefenderLogs downloads all defender logs and metadata.
      script: '|||prisma-cloud-compute-logs-defender-download'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      hostname:
        complex:
          root: incident
          accessor: prismacloudcomputehost
      ignore-outputs:
        simple: "true"
      lines:
        simple: "50"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 160,
          "y": 2445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "34":
    id: "34"
    taskid: af5097a1-b684-4600-8b57-ea3aa859ef93
    type: regular
    task:
      id: af5097a1-b684-4600-8b57-ea3aa859ef93
      version: -1
      name: Set Logs to Layout
      description: Convert an array to a nice table display (usually from the context).
      scriptName: ToTable
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      data:
        complex:
          root: PrismaCloudCompute.Defenders
          accessor: Logs
      extend-context:
        simple: LogsTable=.
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 160,
          "y": 2280
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    fieldMapping:
    - incidentfield: Prisma Cloud Compute Defender Logs
      output:
        simple: ${LogsTable}
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "36":
    id: "36"
    taskid: 900c3626-a9d7-475c-8a47-1afaebea33b3
    type: regular
    task:
      id: 900c3626-a9d7-475c-8a47-1afaebea33b3
      version: -1
      name: Get Container WaaS Policies
      description: Get the Waas container policies from Defend >> WAAS >> Containers.
      tags:
      - policy
      script: '|||prisma-cloud-compute-get-waas-policies'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      extend-context:
        simple: PCC=.
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1600
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "37":
    id: "37"
    taskid: 0845147d-22c9-4e59-8bfa-3fab23234826
    type: regular
    task:
      id: 0845147d-22c9-4e59-8bfa-3fab23234826
      version: -1
      name: Get container profile
      description: Get information about the containers and their profile events. This command supports asterisks which allows you to get container profiles by filtering its fields according to a specific substring.
      tags:
      - forensics
      script: '|||prisma-cloud-compute-profile-container-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "38"
    scriptarguments:
      image:
        complex:
          root: incident
          accessor: prismacloudcomputeimage
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -337.5,
          "y": 2280
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "38":
    id: "38"
    taskid: 41ca4c1c-ca35-453c-803a-d18f15628f20
    type: regular
    task:
      id: 41ca4c1c-ca35-453c-803a-d18f15628f20
      version: -1
      name: Get container forensics
      description: Get runtime forensics data for a specific container on a specific host
      script: '|||prisma-cloud-compute-profile-container-forensic-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      hostname:
        complex:
          root: PrismaCloudCompute.AuditAlert
          accessor: host
      id:
        complex:
          root: PrismaCloudCompute.ProfileContainer
          accessor: _id
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -337.5,
          "y": 2445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "39":
    id: "39"
    taskid: fab534fc-bf2a-434e-84fd-3f38617b618b
    type: regular
    task:
      id: fab534fc-bf2a-434e-84fd-3f38617b618b
      version: -1
      name: Get Host Profile
      description: Get information about the hosts and their profile events. This command supports asterisks which allows you to get host profiles by filtering its fields according to a specific substring.
      script: '|||prisma-cloud-compute-profile-host-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      hostname:
        complex:
          root: incident
          accessor: prismacloudcomputehost
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 562.5,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "40":
    id: "40"
    taskid: ca957966-443c-402b-8cec-34af34a66070
    type: regular
    task:
      id: ca957966-443c-402b-8cec-34af34a66070
      version: -1
      name: 'Get container audits '
      description: Get the audits for the firewall container policies.
      script: '|||prisma-cloud-compute-get-audit-firewall-container-alerts'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "41"
    scriptarguments:
      FromDays:
        simple: "5"
      ImageName:
        complex:
          root: PrismaCloudCompute.ReportsImagesScan.cloudMetadata
          accessor: image
          transformers:
          - operator: uniq
      audit_type:
        complex:
          root: PrismaCloudCompute.AuditAlert
          accessor: category
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "41":
    id: "41"
    taskid: 5189c3ab-079b-44fc-82da-d22503554b2f
    type: regular
    task:
      id: 5189c3ab-079b-44fc-82da-d22503554b2f
      version: -1
      name: Set Audits to Table
      description: Convert an array to a nice table display (usually, from the context).
      scriptName: ToTable
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      data:
        complex:
          root: PrismaCloudCompute
          accessor: AuditAlert
      extend-context:
        simple: AuditTable=.
      ignore-outputs:
        simple: "true"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 760
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    fieldMapping:
    - incidentfield: Prisma Cloud Compute Audit Table
      output:
        simple: ${AuditTable}
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "42":
    id: "42"
    taskid: f95d24a8-697e-4235-86d6-3d082ee15cf0
    type: regular
    task:
      id: f95d24a8-697e-4235-86d6-3d082ee15cf0
      version: -1
      name: Manually Remediate
      type: regular
      iscommand: false
      brand: ""
      description: 'Perform manual remediation to ensure full incident resolution'
    nexttasks:
      '#none#':
      - "26"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 160,
          "y": 3105
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "43":
    id: "43"
    taskid: 6ef8b605-1d49-4898-8453-4f92a18ffe69
    type: regular
    task:
      id: 6ef8b605-1d49-4898-8453-4f92a18ffe69
      version: -1
      name: Create Indicator Table
      description: commands.local.cmd.find.indicators
      script: Builtin|||findIndicators
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      extend-context:
        simple: 'Indicators=.={"Value": val.value, "Description": val.CustomFields.description, "CVSS": val.CustomFields.cvss}'
      ignore-outputs:
        simple: "true"
      query:
        simple: id:${incident.id} and type:CVE
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 160,
          "y": 2785
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "45":
    id: "45"
    taskid: 30163389-b2d5-4823-8feb-283fd3218eee
    type: regular
    task:
      id: 30163389-b2d5-4823-8feb-283fd3218eee
      version: -1
      name: Set Incident Link
      description: commands.local.cmd.set.incident
      script: Builtin|||setIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      externallink:
        complex:
          root: PrismaCloudCompute.AuditAlert
          accessor: consoleLink
          transformers:
          - operator: Stringify
          - operator: concat
            args:
              prefix:
                value:
                  simple: /compute?computeState=
              suffix: {}
          - operator: concat
            args:
              prefix:
                value:
                  simple: inputs.baseUrl
                iscontext: true
              suffix: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 732.5,
          "y": 180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "46":
    id: "46"
    taskid: c11e7b71-15b2-40d8-8bcc-5fa2e3e3e75d
    type: condition
    task:
      id: c11e7b71-15b2-40d8-8bcc-5fa2e3e3e75d
      version: -1
      name: Check if alert has image vulnerabilities
      description: ''
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "7"
      "yes":
      - "3"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PrismaCloudCompute.Images
                accessor: Vulnerabilities
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PrismaCloudCompute.Images.Vulnerabilities
                accessor: Cve
            iscontext: true
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "47":
    id: "47"
    taskid: daab9038-adfb-4457-8ca8-5bd43e3b6810
    type: condition
    task:
      id: daab9038-adfb-4457-8ca8-5bd43e3b6810
      version: -1
      name: Does baseUrl exist in inputs?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "7"
      "yes":
      - "45"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: inputs.baseUrl
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PrismaCloudCompute.AuditAlert
                accessor: consoleLink
            iscontext: true
    view: |-
      {
        "position": {
          "x": 732.5,
          "y": -30
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "48":
    id: "48"
    taskid: d928642c-9c7b-47fe-8de2-6ef0be57778b
    type: condition
    task:
      id: d928642c-9c7b-47fe-8de2-6ef0be57778b
      version: -1
      name: Check if Image Compliance Issues Exist
      description: ''
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "29"
      "yes":
      - "4"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloudCompute.ReportsImagesScan.complianceIssues
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 562.5,
          "y": 1600
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: 9250d30f-8950-4875-8113-91f9e2661689
    type: condition
    task:
      id: 9250d30f-8950-4875-8113-91f9e2661689
      version: -1
      name: Check if Raw Alert JSON exist
      description: ''
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "27"
      "yes":
      - "1"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: incident
                accessor: prismacloudcomputerawalertjson
            iscontext: true
          right:
            value: {}
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: prismacloudcomputerawalertjson
            iscontext: true
          right:
            value:
              simple: '"kind": "audit"'
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": -520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: 658ebd9e-3289-4e1d-8843-7e71bb7b0221
    type: title
    task:
      id: 658ebd9e-3289-4e1d-8843-7e71bb7b0221
      version: -1
      name: Gather Additional Details
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "57"
      - "47"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": -170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "55":
    id: "55"
    taskid: b72ffc8b-99a7-4ae8-8576-efcaa6e516ec
    type: condition
    task:
      id: b72ffc8b-99a7-4ae8-8576-efcaa6e516ec
      version: -1
      name: Check if project name exist
      description: ''
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "29"
      "yes":
      - "9"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: inputs.Project
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -640,
          "y": 1600
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "56":
    id: "56"
    taskid: e083a0be-b96d-48bf-8203-6c3f57fedd72
    type: condition
    task:
      id: e083a0be-b96d-48bf-8203-6c3f57fedd72
      version: -1
      name: Is Container alert type
      description: ''
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "11"
      "yes":
      - "37"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: PrismaCloudCompute.AuditAlert
                accessor: type
            iscontext: true
          right:
            value:
              simple: container
          ignorecase: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: incident
                accessor: prismacloudcomputeimage
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -337.5,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "57":
    id: "57"
    taskid: 358db035-2569-4031-86b8-1a98b8c05f01
    type: condition
    task:
      id: 358db035-2569-4031-86b8-1a98b8c05f01
      version: -1
      name: Is there an image name
      description: ''
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "6"
      "yes":
      - "2"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PrismaCloudCompute.AuditAlert
                accessor: image
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": -20
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "58":
    id: "58"
    taskid: 896ee77a-73e2-4a9f-82d0-c9339d159830
    type: condition
    task:
      id: 896ee77a-73e2-4a9f-82d0-c9339d159830
      version: -1
      name: Check if image scan report was found
      description: ''
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "6"
      "yes":
      - "40"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PrismaCloudCompute.ReportsImagesScan.cloudMetadata
                accessor: image
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "46_3_yes": 0.6,
      "55_9_yes": 0.54,
      "56_11_#default#": 0.13,
      "57_2_yes": 0.43,
      "58_40_yes": 0.51
    },
    "paper": {
      "dimensions": {
        "height": 4315,
        "width": 1962.5,
        "x": -850,
        "y": -790
      }
    }
  }
inputs:
- key: baseUrl
  value:
    simple: https://app.prismacloud.io
  required: false
  description: The base URL of the Prisma Cloud Compute Instance used to create a link back to the alerts for an image.
  playbookInputQuery:
- key: Project
  value:
    complex:
      root: PrismaCloudCompute.AlertProfiles.ServiceNow
      accessor: Project
  required: false
  description: A specific project name to get alert profiles for
  playbookInputQuery:
outputs: []
tests:
- PaloAltoNetworks_PrismaCloudCompute-Test
version: -1
