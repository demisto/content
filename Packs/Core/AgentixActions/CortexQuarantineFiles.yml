commonfields:
  id: CortexQuarantineFiles
  version: -1
name: CortexQuarantineFile
display: Cortex - Quarantine File
tags:
 - Endpoint
category: Endpoint
description: >
  Quarantines a specified file through Cortex by moving it from its original location to a secure, local quarantine folder.
  Requires the file path and SHA256 hash.
  Logs detailed error information if the operation fails.
  Supports quarantining on up to 1000 Windows endpoints.

  Workflow:
  1. Execute the "GetEndpointData" action with the "Cortex Core - IR" integration brand as input to get the endpoint IDs (unless provided or returned from a previous action).
  2. Use this action to quarantine the files.
args:
  - name: incident_id
    required: false
    type: string
    description: Links the response action to the triggered case (formerly known as incident).
    underlyingargname: incident_id
  - name: endpoint_id_list
    required: true
    type: string
    description: A comma-separated list of endpoint IDs where the file will be quarantined.
    underlyingargname: endpoint_id_list
  - name: file_path
    required: true
    type: string
    description: The file path of the file you want to quarantine on the selected endpoints.
    underlyingargname: file_path
  - name: file_hash
    required: true
    type: string
    description: The SHA256 hash of the file to quarantine. Must be a valid SHA256 hash.
    underlyingargname: file_hash
outputs:
- underlyingoutputcontextpath: Core.GetActionStatus.action_id
  type: string
  description: The quarantine action ID.
  name: Core.GetActionStatus.action_id
- underlyingoutputcontextpath: Core.GetActionStatus.endpoint_id
  type: string
  description: The endpoint ID on which the quarantine action was taken.
  name: Core.GetActionStatus.endpoint_id
- underlyingoutputcontextpath: Core.GetActionStatus.status
  type: string
  description: The status of the action.
  name: Core.GetActionStatus.status
- underlyingoutputcontextpath: Core.GetActionStatus.ErrorReasons
  type: unknown
  description: The error reasons (if occurred).
  name: Core.GetActionStatus.ErrorReasons
underlyingcontentitem:
  id: CoreQuarantineFiles
  name: CoreQuarantineFiles
  type: script
  version: -1
  command: ''
requiresuserapproval: true
marketplaces:
- platform
supportedModules:
- xsiam
- cloud_runtime_security
- edr
