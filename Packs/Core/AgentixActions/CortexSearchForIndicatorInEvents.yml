commonfields:
  id: CortexSearchForIndicatorInEvents
  version: -1
name: CortexListEventsByIndicator
display: Cortex - List Events By Indicator
tags:
 - indicator enrichment
 - log search
 - threat hunting
 - detection
category: Data Enrichment & Threat Intelligence
description: |-
  Searches for a specific indicator in Cortex's events and logs and extracts the logs in which the indicator appears.
  By default, the search is performed in the xdr_data dataset, but a different dataset can be specified.
args:
- name: indicator
  required: true
  description: The indicator value (e.g., IP address, domain, hash) to search for in the selected dataset logs.
  type: string
  underlyingargname: indicator
- name: time_frame
  defaultvalue: '7 days'
  description: The time range to search within, specified in days (e.g., "7 days" means searching the past 7 days of data).
  type: string
  underlyingargname: time_frame
- name: data_set
  defaultvalue: 'xdr_data'
  description: The name of the dataset to search in. If not specified, the search defaults to the "xdr_data" dataset.
  type: string
  underlyingargname: data_set
- name: query_name
  required: true
  description: A user-defined name. The query results will appear under this name in the JSON output data.
  isgeneratable: true
  type: string
  underlyingargname: query_name
outputs:
- underlyingoutputcontextpath: PaloAltoNetworksXQL
  description: A list of event records where the specified indicator was found.
  type: Unknown
  name: PaloAltoNetworksXQL
underlyingcontentitem:
  id: SearchIndicatorInEventsAgentix
  name: SearchIndicatorInEventsAgentix
  type: script
  version: -1
  command: ''
requiresuserapproval: false
marketplaces:
- platform
supportedModules:
- xsiam
- agentix
- cloud_posture
