id: Suspicious msiexec execution
version: -1
name: Suspicious msiexec execution
description: "This playbook addresses the following alerts:\n \n- Msiexec execution of an executable from an uncommon remote location with a specific port\n- Msiexec execution of an executable from an uncommon remote location without properties\n \nPlaybook Stages:\n  \nAnalysis: \n \n- Check extracted domain's reputation\n- Check extracted domain's prevalence\n \n \nInvestigation:\n \n- Check for suspicious related alerts: \n    - Local Analysis Malware\n    - Mitre Techniques:\n        - T1140 - Deobfuscate/Decode Files or Information\n        - T1059 - Command and Scripting Interpreter \n\nContainment:\n \n- Kill causality process\n- Block maliciou URL\n \nRequirements: \n \nFor any response action, you need one of the following integrations:\n \n- PAN-OS."
tags:
- TA0005 - Defense Evasion
- T1218 - System Binary Proxy Execution
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 9009c9a5-c3ae-47f9-88ac-88c180548762
    type: start
    task:
      id: 9009c9a5-c3ae-47f9-88ac-88c180548762
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "4"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 510,
          "y": -760
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 3c69ed8d-e958-46f7-829f-6096e63aef35
    type: condition
    task:
      id: 3c69ed8d-e958-46f7-829f-6096e63aef35
      version: -1
      name: Check extracted remote URL's reputation
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "43"
      Malicious:
      - "32"
    separatecontext: false
    conditions:
    - label: Malicious
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: DBotScore
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DBotScore.Type
                      iscontext: true
                    right:
                      value:
                        simple: url
                    ignorecase: true
                - - operator: isEqualString
                    left:
                      value:
                        simple: DBotScore.Score
                      iscontext: true
                    right:
                      value:
                        simple: "3"
                    ignorecase: true
                accessor: Score
            iscontext: true
          right:
            value:
              simple: "3"
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 510,
          "y": -300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: e3f4502b-9364-4200-898f-098e2cdb68ae
    type: title
    task:
      id: e3f4502b-9364-4200-898f-098e2cdb68ae
      version: -1
      name: Investigation
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "21"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 61af7765-dbf7-49e2-8acf-ae083ebdd45d
    type: title
    task:
      id: 61af7765-dbf7-49e2-8acf-ae083ebdd45d
      version: -1
      name: Analysis
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "25"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 510,
          "y": -615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: b8ef7bea-662b-45bc-82a0-12c830ba74d5
    type: condition
    task:
      id: b8ef7bea-662b-45bc-82a0-12c830ba74d5
      version: -1
      name: 'Check if related alerts OR defense evasion techniques exist '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "22"
      Malicious:
      - "42"
    separatecontext: false
    conditions:
    - label: Malicious
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: foundIncidents
            iscontext: true
          right:
            value: {}
          ignorecase: true
        - operator: containsString
          left:
            value:
              simple: CommandLineAnalysis.risk
            iscontext: true
          right:
            value:
              simple: High Risk
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1240
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 6c0661ef-760a-4b74-8102-a6af83343494
    type: regular
    task:
      id: 6c0661ef-760a-4b74-8102-a6af83343494
      version: -1
      name: Check domain prevalence
      description: Get the prevalence of a domain, identified by domain_name.
      script: '|||core-get-domain-analytics-prevalence'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      domain_name:
        simple: ${Domain.Name}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 290,
          "y": 70
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: 41202903-35e5-4ef1-8d85-b52c47321139
    type: title
    task:
      id: 41202903-35e5-4ef1-8d85-b52c47321139
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 680,
          "y": 2650
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: 683bc4df-64aa-4633-8218-92e54b6a0f58
    type: regular
    task:
      id: 683bc4df-64aa-4633-8218-92e54b6a0f58
      version: -1
      name: Search for suspicious-related alerts by MITRE Technique
      description: |-
        This task searches for Cortex XSIAM suspicious alerts related to the current alert by Mitre Technique, indicating that the alert is part of an attack pattern.

        Focus on identifying alerts associated with the following MITRE techniques:
        - Any Agent Alerts within this alert.
        - T1059 - Command and Scripting Interpreter.
      scriptName: SearchIncidentsV2
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "28"
    scriptarguments:
      query:
        complex:
          root: alert
          accessor: parentXDRIncident
          transformers:
          - operator: Cut
            args:
              delimiter:
                value:
                  simple: '-'
              fields:
                value:
                  simple: "2"
          - operator: concat
            args:
              prefix:
                value:
                  simple: '((mitreattcktechnique:*T1059* or mitreattcktechnique:*1140* or name:*Local Analysis Malware*) and caseid:'
              suffix:
                value:
                  simple: )
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 660
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 6845e4a8-b5e1-4276-8d56-01b313c40321
    type: regular
    task:
      id: 6845e4a8-b5e1-4276-8d56-01b313c40321
      version: -1
      name: Close Alert - True Positive
      description: Close the current alert.
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      closeNotes:
        simple: Malicious attempt to install .msi package from remote URL
      closeReason:
        simple: Resolved - Handled by the playbook "Suspicious msiexec execution"
      id:
        simple: ${alert.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -120,
          "y": 2480
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: 648e4b76-4282-4370-800d-2d5963a0d98c
    type: condition
    task:
      id: 648e4b76-4282-4370-800d-2d5963a0d98c
      version: -1
      name: Check if domain is prevalent AND CGO process is signed
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "13"
      Malicious:
      - "42"
    separatecontext: false
    conditions:
    - label: Malicious
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Core.AnalyticsPrevalence.Domain
                accessor: value
                transformers:
                - operator: uniq
            iscontext: true
          right:
            value:
              simple: "False"
          ignorecase: true
        - operator: isEqualString
          left:
            value:
              simple: Core.AnalyticsPrevalence.Ip.value
            iscontext: true
          right:
            value:
              simple: "False"
      - - operator: isNotEqualString
          left:
            value:
              simple: alert.cgosignature
            iscontext: true
          right:
            value:
              simple: SIGNATURE_SIGNED
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 430
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 53bab082-3038-4ffb-8be7-98b2b9c498ac
    type: title
    task:
      id: 53bab082-3038-4ffb-8be7-98b2b9c498ac
      version: -1
      name: Inconclusive
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "12"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 680,
          "y": 1410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "25":
    id: "25"
    taskid: 8dfbda72-145e-421b-813e-7cf4df40bc7b
    type: regular
    task:
      id: 8dfbda72-145e-421b-813e-7cf4df40bc7b
      version: -1
      name: Get Wildfire Verdict for URL
      description: Returns a verdict for a hash.
      script: '|||wildfire-get-verdict'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    scriptarguments:
      url:
        simple: ${URL.Data}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 510,
          "y": -460
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: eb36c41d-a9ab-402c-85e7-e25ab68547a2
    type: title
    task:
      id: eb36c41d-a9ab-402c-85e7-e25ab68547a2
      version: -1
      name: Analyze CGO Commandline
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "31"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 860
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: faeaef2d-eea2-408a-8bd9-5fa0400c1ca5
    type: regular
    task:
      id: faeaef2d-eea2-408a-8bd9-5fa0400c1ca5
      version: -1
      name: Isolate endpoint
      description: Isolates the specified endpoint.
      script: '|||core-isolate-endpoint'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      endpoint_id:
        simple: ${alert.agentid}
      incident_id:
        complex:
          root: alert
          accessor: parentXDRIncident
          transformers:
          - operator: Cut
            args:
              delimiter:
                value:
                  simple: '-'
              fields:
                value:
                  simple: "2"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -350,
          "y": 2310
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: 57a3e1ea-320a-41c5-8f1e-04c5bd066cb1
    type: regular
    task:
      id: 57a3e1ea-320a-41c5-8f1e-04c5bd066cb1
      version: -1
      name: Check CGO command for defense evasion techniques
      description: |-
        This script evaluates command-line threats by analyzing both original and decoded inputs. It assigns weighted scores to detected patterns, such as AMSI bypass or credential dumping, and applies risk combination bonuses for multiple detections. The total score is normalized to a 0-100 scale, with risk levels categorized as follows:

        * 0-25: Low Risk
        * 26-50: Medium Risk
        * 51-90: High Risk
        * 91-100: Critical Risk

        The scoring mechanism provides a comprehensive risk assessment, considering both the severity and frequency of malicious behaviors.
      scriptName: CommandLineAnalysis
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      command_line:
        complex:
          root: alert
          accessor: cgocmd
          transformers:
          - operator: splitAndTrim
            args:
              delimiter:
                value:
                  simple: |2+

          - operator: RemoveEmpty
            args:
              empty_values: {}
              remove_keys:
                value:
                  simple: "true"
          - operator: join
            args:
              separator: {}
      custom_patterns:
        simple: ((cmd|type)<?\s*\w+\.\w{1,3}(\|cmd)?(\:\w+)?)
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1030
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: 71a15926-a403-4129-832e-0131d2b882d0
    type: title
    task:
      id: 71a15926-a403-4129-832e-0131d2b882d0
      version: -1
      name: Early Containment
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "33"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -120,
          "y": 45
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: 3c77b44e-af3b-4e24-8a53-d278ce7ddd33
    type: regular
    task:
      id: 3c77b44e-af3b-4e24-8a53-d278ce7ddd33
      version: -1
      name: Terminate Causality (CGO)
      description: Terminate a process tree by its causality ID. Available only for Cortex XSIAM 2.4.
      script: '|||core-terminate-causality'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "35"
    scriptarguments:
      agent_id:
        simple: ${alert.agentid}
      causality_id:
        simple: ${alert.cid}
      timeout_in_seconds:
        simple: "180"
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -120,
          "y": 1555
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: 0aa923bd-a78d-43fd-8ceb-49d71ce61d76
    type: collection
    task:
      id: 0aa923bd-a78d-43fd-8ceb-49d71ce61d76
      version: -1
      name: Approve the endpoint isolation & Block URL
      description: |-
        Endpoint Isolation is recommended since the following verdicts have been confirmed:

         - MSI package was installed from a malicious remote URL
      type: collection
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "36"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -120,
          "y": 1750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to:
      subject:
      body:
      methods: []
      format: ""
      bcc:
      cc:
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
        completeafterv2: true
        completeaftersla: false
      replyOptions:
      - "Yes"
      - "No"
    form:
      questions:
      - id: "0"
        label: ""
        labelarg:
          simple: Should Isolate the endpoint?
        required: false
        gridcolumns: []
        defaultrows: []
        type: singleSelect
        options: []
        optionsarg:
        - simple: "No"
        - simple: "Yes"
        fieldassociated: ""
        placeholder: ""
        tooltip: ""
        readonly: false
      - id: "1"
        label: ""
        labelarg:
          simple: "Should Block the following malicious URL using PAN-OS? \n- ${URL.Data}   "
        required: false
        gridcolumns: []
        defaultrows: []
        type: singleSelect
        options: []
        optionsarg:
        - simple: "No"
        - simple: "Yes"
        fieldassociated: ""
        placeholder: ""
        tooltip: This will block URLs using Palo Alto Networks Panorama or Firewall through Custom URL Categories. The playbook checks whether the input URL category already exists, and if the URLs are a part of this category. Otherwise, it will create the category, block the URLs, and commit the configuration.
        readonly: false
      title: EarlyContainmentApproval
      description: |-
        Endpoint Isolation is recommended since the following verdicts have been confirmed:

         - MSI package was installed from a malicious remote URL
      sender: Your SOC team
      expired: false
      totalanswers: 0
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: 01b81980-d2ea-4b32-89f1-5a94457e82be
    type: condition
    task:
      id: 01b81980-d2ea-4b32-89f1-5a94457e82be
      version: -1
      name: Check analyst answers
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "14"
      Block URL Only:
      - "40"
      Isolate & Block:
      - "38"
      Isolate Only:
      - "39"
    separatecontext: false
    conditions:
    - label: Isolate & Block
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: EarlyContainmentApproval.Answers.0
            iscontext: true
          right:
            value:
              simple: "Yes"
          ignorecase: true
      - - operator: isEqualString
          left:
            value:
              simple: EarlyContainmentApproval.Answers.1
            iscontext: true
          right:
            value:
              simple: "Yes"
          ignorecase: true
    - label: Isolate Only
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: EarlyContainmentApproval.Answers.0
            iscontext: true
          right:
            value:
              simple: "Yes"
          ignorecase: true
    - label: Block URL Only
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: EarlyContainmentApproval.Answers.1
            iscontext: true
          right:
            value:
              simple: "Yes"
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -120,
          "y": 1990
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: e0f7ea03-1571-4b63-8799-132579f84ed9
    type: title
    task:
      id: e0f7ea03-1571-4b63-8799-132579f84ed9
      version: -1
      name: Isolate & Block
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "30"
      - "41"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -120,
          "y": 2165
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: 9b3e8d5d-e4a4-429f-813a-9947797dcc1c
    type: title
    task:
      id: 9b3e8d5d-e4a4-429f-813a-9947797dcc1c
      version: -1
      name: Isolate Only
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "30"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -550,
          "y": 2165
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: 0e874e68-10c6-4f46-83dd-dc2c0b70cc63
    type: title
    task:
      id: 0e874e68-10c6-4f46-83dd-dc2c0b70cc63
      version: -1
      name: Block URL Only
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "41"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 310,
          "y": 2165
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: bf7a09ad-8ed9-474c-8147-633a164b4c0c
    type: playbook
    task:
      id: bf7a09ad-8ed9-474c-8147-633a164b4c0c
      version: -1
      name: PAN-OS - Block URL - Custom URL Category
      description: |-
        This playbook blocks URLs using Palo Alto Networks Panorama or Firewall through Custom URL Categories.
        The playbook checks whether the input URL category already exists, and if the URLs are a part of this category. Otherwise, it will create the category, block the URLs, and commit the configuration.
      playbookName: PAN-OS - Block URL - Custom URL Category
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      AutoCommit:
        simple: "Yes"
      CustomURLCategory:
        simple: XSIAM - Malicious URLs
      URL:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Type
                iscontext: true
              right:
                value:
                  simple: url
              ignorecase: true
          - - operator: isEqualNumber
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "3"
          accessor: Indicator
          transformers:
          - operator: uniq
      pre-post:
        simple: pre-rulebase
      type:
        simple: URL List
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 90,
          "y": 2310
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: 49cae269-9bbf-4f0b-8a0c-add76b6fbb0e
    type: title
    task:
      id: 49cae269-9bbf-4f0b-8a0c-add76b6fbb0e
      version: -1
      name: Remediation
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "33"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 230,
          "y": 1410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: 602e9b69-5f02-4728-8d9d-ca7e394d78f0
    type: condition
    task:
      id: 602e9b69-5f02-4728-8d9d-ca7e394d78f0
      version: -1
      name: Check If prevalence can be run on
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      Domain:
      - "11"
      IP:
      - "44"
    separatecontext: false
    conditions:
    - label: Domain
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.Name
            iscontext: true
    - label: IP
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: IP.Address
                filters:
                - - operator: notIn
                    left:
                      value:
                        simple: IP.Address
                      iscontext: true
                    right:
                      value:
                        simple: alert.hostip
                      iscontext: true
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 510,
          "y": -105
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "44":
    id: "44"
    taskid: a2fecd08-a416-4a40-8c81-b968ef614ae5
    type: regular
    task:
      id: a2fecd08-a416-4a40-8c81-b968ef614ae5
      version: -1
      name: Check IP prevalence
      description: Get the prevalence of an ip, identified by ip_address.
      script: '|||core-get-IP-analytics-prevalence'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      ip_address:
        complex:
          root: IP.Address
          filters:
          - - operator: notIn
              left:
                value:
                  simple: IP.Address
                iscontext: true
              right:
                value:
                  simple: alert.hostip
                iscontext: true
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 700,
          "y": 70
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "1_43_#default#": 0.64,
      "21_13_#default#": 0.54,
      "8_22_#default#": 0.51,
      "8_42_Malicious": 0.48
    },
    "paper": {
      "dimensions": {
        "height": 3475,
        "width": 1630,
        "x": -550,
        "y": -760
      }
    }
  }
inputs: []
outputs: []
tests:
- No tests (auto formatted)
fromversion: 8.8.0
