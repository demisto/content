This playbook handles WildFire Malware alerts.
It performs enrichment on the different alert entities and establishes a verdict.
For a possible true positive alert, the playbook performs further investigation for related IOCs and executes a containment plan.

## Malware Investigation and Response Flow

An attacker may use malware to gain control, gather sensitive information, and disrupt a system's normal operations.

**Investigative Actions:**

Cortex XDR investigates the file hashes, IP addresses, and identities involved in the detected activity using the **Enrichment for Verdict** and **Endpoint Investigation Plan** playbooks.

**Response Actions**   
Phase 1:   
The WildFire Malware playbook's first response actions are based on the data available within the alert.  
In this phase, the playbook  executes the **Containment Plan** playbook with the file hash as an input.
Containment actions are based on the playbook inputs. The following actions are set to run automatically by default in this phase:
1. FileContainment - Set to quarantine the original file.
 
Phase 2:  
When the playbook continues, if other suspicious IOCs are found in the investigation, the next phase of response is executed, which includes the **Containment Plan** playbook with the found IOCs as inputs.
Containment actions are based on the playbook inputs. The following actions are set to run automatically by default in this phase:
1. File Containment - Set to quarantine the files found in the investigation.
2. Host Containment - Set to automatic isolation if there are investigation findings.


## How to Use This Playbook

### Create a new playbook trigger
1. Click the **Incident Response** icon on the left menu.
2. Under **Automation** click **Incident Configuration**.
3. Select **Playbook Triggers** on the left panel.
4. Click **New Trigger**.
5. Choose a trigger name, for example **WildFire Malware Response**.
6. Under **Playbook To Run**, select **WildFire Malware**.
7. Add a trigger description (optional).
8. Create a filter for the playbook trigger.
    1. Click **select field**.
    2. Choose **Alert name**.
    3. Fill the value with 'WildFire Malware' and keep the 'contains' condition.
    4. Click **Create**.

   **Note**: The playbook triggers are executed according to their order. Make sure the trigger position is in the appropriate execution. If not, other triggers may override the new trigger.

9. Click **Save**.

## Dependencies
This playbook uses the following sub-playbooks, integrations, and scripts.

### Sub-playbooks
* Enrichment for Verdict
* Recovery Plan
* Endpoint Investigation Plan
* Handle False Positive Alerts
* Containment Plan

### Integrations
CortexCoreIR

### Scripts
GetTime

### Commands
* core-report-incorrect-wildfire
* closeInvestigation
* core-allowlist-files
* core-blocklist-files

## Playbook Inputs
---

| **Name** | **Description** | **Default Value** | **Required** |
| --- | --- | --- | --- |
| sha256 | The SHA256 hash of the suspected file. | alert.initiatorsha256 | Optional |
| GraywarePhishingAsMalware | Whether to treat grayware and phishing alerts as malware. | true | Optional |
| AutoContainment | Whether to execute the containment plan \(except isolation\) automatically.<br/>The specific containment playbook inputs should also be set to 'True'. |  | Optional |
| HostAutoContainment | Whether to automatically execute endpoint isolation. |  | Optional |
| BlockIndicators | Set to True to block the indicators. |  | Optional |
| FileContainment | Set to True to quarantine the identified file. |  | Optional |
| FileRemediation | Choose 'Quarantine' or 'Delete'  to avoid file remediation conflicts. <br/>For example, choosing 'Quarantine' ignores the 'Delete file' task under the eradication playbook and executes only file quarantine. | Quarantine | Optional |
| AutoMarkFP | Whether to automatically mark alerts that were found as benign by the 'Enrichment for Verdict' playbook and report false positive alerts to WildFire. True/False. |  | Optional |
| EmailAddress | User's email address to use when reporting false positive alerts to WildFire. |  | Optional |
| ShouldCloseAutomatically | Whether to automatically close the alert after investigation and remediation are finished. True/False. |  | Optional |
| AutoRecovery | Whether to execute the Recovery playbook after the investigation and remediation are finished. True/False. |  | Optional |

## Playbook Outputs
---
There are no outputs for this playbook.

## Playbook Image
---
![WildFire Malware](https://github.com/demisto/content/raw/83139fce8bb3f76917669e780df144115da69c90/Packs/Core/doc_files/WildFire_Malware.png)
