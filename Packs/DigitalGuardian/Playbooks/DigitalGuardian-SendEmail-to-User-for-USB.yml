id: DigitalGuardian-SendEmail-to-User-for-USB
inputs: []
name: DigitalGuardian-SendEmail-to-User-for-USB
outputs: []
sourceplaybookid: 20bb2629-4467-456f-8d20-c89e17842fa7
starttaskid: '0'
tasks:
  '0':
    id: '0'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '9'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: dc51de78-6807-4b2e-81ac-f9b53236c577
      iscommand: false
      name: ''
      version: -1
      description: ''
    taskid: dc51de78-6807-4b2e-81ac-f9b53236c577
    timertriggers: []
    type: start
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 65\n  }\n}"
  '2':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: incident.name
          operator: startWith
          right:
            value:
              simple: DLP1008
      label: yes
    id: '2'
    ignoreworker: false
    nexttasks:
      yes:
      - '10'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 92561d13-8a92-43ed-813f-e83b0549cfd2
      iscommand: false
      name: Check if Alarm is Write to Removable (non classified)
      type: condition
      version: -1
      description: ''
    taskid: 92561d13-8a92-43ed-813f-e83b0549cfd2
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 400\n  }\n}"
  '5':
    id: '5'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '7'
    note: false
    scriptarguments:
      additionalHeader: {}
      attachCIDs: {}
      attachIDs: {}
      attachNames: {}
      bcc: {}
      body:
        simple: ${Account.DisplayName} has written ${File} to removable media
      cc: {}
      htmlBody: {}
      raw_message: {}
      replyTo: {}
      subject:
        simple: Removable Media Policy Violation
      templateParams: {}
      to:
        complex:
          accessor: Email
          root: Account
      transientFile: {}
      transientFileCID: {}
      transientFileContent: {}
    separatecontext: false
    task:
      brand: ''
      description: Send an email
      id: bc8cd4b3-e6f4-42ad-86e6-8ce9372f1d01
      iscommand: true
      name: Send the user and email about the violation
      script: '|||send-mail'
      type: regular
      version: -1
    taskid: bc8cd4b3-e6f4-42ad-86e6-8ce9372f1d01
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 1060\n  }\n}"
  '7':
    id: '7'
    ignoreworker: false
    note: false
    scriptarguments:
      assetid: {}
      closeNotes: {}
      closeReason: {}
      emailclassification: {}
      id:
        simple: ${incident.id}
      phishingsubtype: {}
    separatecontext: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 0fea6efd-84ac-4437-82e0-7a4ebade272d
      iscommand: true
      name: Close incident
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 0fea6efd-84ac-4437-82e0-7a4ebade272d
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 520,\n    \"y\": 1270\n  }\n}"
  '9':
    id: '9'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '2'
    note: false
    scriptarguments:
      all:
        simple: yes
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    task:
      brand: ''
      description: Delete field from context
      id: 8555ee98-e68f-4b29-8c4d-ac0cf00a8eb9
      iscommand: false
      name: Delete Incident Context
      script: DeleteContext
      type: regular
      version: -1
    taskid: 8555ee98-e68f-4b29-8c4d-ac0cf00a8eb9
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 225\n  }\n}"
  '10':
    id: '10'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '11'
    note: false
    scriptarguments:
      attributes: {}
      custom-field-data: {}
      custom-field-type: {}
      dn: {}
      email: {}
      limit: {}
      name: {}
      user-account-control-out: {}
      username:
        simple: ${incident.labels.Username}
    separatecontext: false
    task:
      brand: Active Directory Query v2
      description: Retrieves detailed information about a user account. The user can
        be specified by name, email address, or as an Active Directory Distinguished
        Name (DN). If no filter is specified, all users are returned.
      id: 57221984-b1e7-422b-8523-32590d6707dc
      iscommand: true
      name: ad-get-user
      script: Active Directory Query v2|||ad-get-user
      type: regular
      version: -1
    taskid: 57221984-b1e7-422b-8523-32590d6707dc
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 575\n  }\n}"
  '11':
    conditions:
    - condition:
      - - left:
            value:
              simple: ad-get-user
          operator: isNotEmpty
      label: yes
    id: '11'
    ignoreworker: false
    nexttasks:
      '#default#':
      - '7'
      yes:
      - '5'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 29f0b76d-8960-4b9c-8cb9-5e596a973bcc
      iscommand: false
      name: Found user in AD
      type: condition
      version: -1
      description: ''
    taskid: 29f0b76d-8960-4b9c-8cb9-5e596a973bcc
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 770\n  }\n}"
version: -1
view: "{\n  \"linkLabelsPosition\": {},\n  \"paper\": {\n    \"dimensions\": {\n \
  \     \"height\": 1300,\n      \"width\": 850,\n      \"x\": 50,\n      \"y\": 65\n\
  \    }\n  }\n}"
fromversion: 5.0.0
description: 'Notify a user by email if a write to removable action is detected.'
tests:
- No tests
