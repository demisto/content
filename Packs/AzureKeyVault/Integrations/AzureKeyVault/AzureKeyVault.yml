category: Authentication & Identity Management
commonfields:
  id: AzureKeyVault
  version: -1
configuration:
- display: Azure Cloud
  name: azure_cloud
  type: 15
  defaultvalue: Worldwide
  options:
  - Worldwide
  - US GCC
  - US GCC-High
  - DoD
  - Germany
  - China
  section: Connect
  advanced: true
  additionalinfo: More information about National clouds can be found here - https://xsoar.pan.dev/docs/reference/articles/microsoft-integrations---authentication#using-national-cloud
  required: false
- display: Client ID
  name: client_id
  type: 0
  section: Connect
  required: false
- name: credentials
  type: 9
  displaypassword: Client Secret
  hiddenusername: true
  section: Connect
  required: false
- display: Tenant ID
  name: tenant_id
  required: true
  type: 0
  section: Connect
- additionalinfo: Used for certificate authentication. As appears in the "Certificates & secrets" page of the app.
  display: Certificate Thumbprint
  name: certificate_thumbprint
  type: 4
  section: Connect
  hidden: true
  required: false
- additionalinfo: Used for certificate authentication. As appears in the "Certificates & secrets" page of the app.
  displaypassword: Certificate Thumbprint
  name: credentials_certificate_thumbprint
  required: false
  hiddenusername: true
  type: 9
- additionalinfo: Used for certificate authentication. The private key of the registered certificate.
  display: Private Key
  name: private_key
  type: 14
  section: Connect
  required: false
- additionalinfo: Relevant only if the integration is running on Azure VM. If selected, authenticates based on the value provided for the Azure Managed Identities Client ID field. If no value is provided for the Azure Managed Identities Client ID field, authenticates based on the System Assigned Managed Identity. For additional information, see the Help tab.
  name: use_managed_identities
  type: 8
  display: Use Azure Managed Identities
  section: Connect
  advanced: true
  required: false
- name: managed_identities_client_id
  type: 9
  additionalinfo: The managed identities client ID for authentication. Relevant only if the integration is running on Azure VM.
  displaypassword: Azure Managed Identities Client ID
  hiddenusername: true
  section: Connect
  advanced: true
  required: false
- display: Default Subscription ID
  name: subscription_id
  required: true
  type: 0
  section: Connect
- display: Default Resource Group Name
  name: resource_group_name
  required: true
  type: 0
  section: Connect
- display: Fetches credentials
  name: isFetchCredentials
  type: 8
  section: Collect
  required: false
- display: Key Vault names - comma seperated list of Key Vaults to fetch secrets from.
  name: key_vaults
  type: 0
  section: Collect
  required: false
- display: Secret names - comma seperated list of secrets to fetch.
  name: secrets
  type: 0
  section: Collect
  required: false
- display: Trust any certificate (not secure)
  name: insecure
  type: 8
  section: Connect
  advanced: true
  required: false
- display: Use system proxy settings
  name: proxy
  type: 8
  section: Connect
  advanced: true
  required: false
description: Use the Azure Key Vault integration to safeguard and manage cryptographic keys and secrets used by cloud applications and services.
display: Azure Key Vault
name: AzureKeyVault
script:
  commands:
  - arguments:
    - description: Key Vault name.
      name: vault_name
      required: true
    - auto: PREDEFINED
      description: Key Vault supported Azure location. The location cannot be changed after the Key Vault is created. Default value is 'westus'.
      name: location
      predefined:
      - northcentralus
      - eastus
      - northeurope
      - westeurope
      - eastasia
      - southeastasia
      - eastus2
      - centralus
      - southcentralus
      - westus
      - japaneast
      - japanwest
      - australiaeast
      - australiasoutheast
      - brazilsouth
      - centralindia
      - southindia
      - westindia
      - canadacentral
      - canadaeast
      - uksouth
      - ukwest
      - westcentralus
      - westus2
      - koreacentral
      - francecentral
      - australiacentral
      - uaenorth
      - southafricanorth
      - switzerlandnorth
      - germanywestcentral
      - norwayeast
      - westus3
      - jioindiawest
    - auto: PREDEFINED
      description: Specify whether the key vault is a standard vault or a premium vault. Default value is 'standard'.
      name: sku_name
      predefined:
      - standard
      - premium
    - description: 'The object ID of a user, service principal or security group in the Azure Active Directory tenant for the vault. The object ID must be unique for the list of access policies: Any change in the access policy regards that object ID, will override the exists one. To retrieve it navigate in the Azure Portal to App registrations > your registered application > click on manage application in local directory > copy Object ID property.'
      name: object_id
      required: true
    - auto: PREDEFINED
      description: 'Permissions to keys. If the Key Vault exists, you must supply the previous keys'' permissions in order to keep them unchanged. Access policy property. Default value is [get,list,create,update,import,delete,backup,restore,recover]. '
      isArray: true
      name: keys
      predefined:
      - get
      - list
      - create
      - update
      - import
      - delete
      - backup
      - restore
      - recover
      - decrypt
      - encrypt
      - unwrapKey
      - wrapKey
      - verify
      - sign
      - purge
    - auto: PREDEFINED
      description: Permissions to secrets. If the Key Vault exists, you must supply the previous secrets' permissions in order to keep them unchanged. Access policy property. Default value is [get,list,set,delete,backup,restore,recover].
      isArray: true
      name: secrets
      predefined:
      - get
      - list
      - set
      - delete
      - recover
      - backup
      - restore
      - purge
    - auto: PREDEFINED
      description: Permissions to certificates. If the Key Vault exists, you must supply the previous certificate's permissions in order to keep them unchanged. Access policy property. Default value is [get,list,update,create,import,delete,recover,backup,restore,managecontacts,manageissuers,getissuers,listissuers,setissuers,deleteissuers].
      isArray: true
      name: certificates
      predefined:
      - get
      - list
      - update
      - create
      - import
      - delete
      - recover
      - backup
      - restore
      - managecontacts
      - manageissuers
      - getissuers
      - listissuers
      - setissuers
      - deleteissuers
      - purge
    - auto: PREDEFINED
      description: Permissions to storage accounts. If the Key Vault exists, you must supply the previous storage's permissions in order to keep them unchanged. Access policy property. Default value is [get,list,set,delete,backup,restore,recover].
      isArray: true
      name: storage
      predefined:
      - get
      - list
      - delete
      - set
      - update
      - regeneratekey
      - getsas
      - listsas
      - deletesas
      - setsas
      - recover
      - backup
      - restore
      - purge
    - auto: PREDEFINED
      description: Specifies whether Azure Virtual Machines are permitted to retrieve certificates stored as secrets from the key vault. If the Key Vault exists, you must supply the previous value in order to keep it the same. Default value is True.
      name: enabled_for_deployment
      predefined:
      - 'true'
      - 'false'
    - auto: PREDEFINED
      description: Specifies whether Azure Disk Encryption is permitted to retrieve secrets from the vault and unwrap keys.If the Key Vault exists, you must supply the previous value in order to keep it the same. Default value is True.
      name: enabled_for_disk_encryption
      predefined:
      - 'true'
      - 'false'
    - auto: PREDEFINED
      description: Specifies whether Azure Resource Manager is permitted to retrieve secrets from the key vault. If the Key Vault exists, you must supply the previous value in order to keep it the same. Default value is True.
      name: enabled_for_template_deployment
      predefined:
      - 'true'
      - 'false'
    - auto: PREDEFINED
      description: The default action when no rule from ip_rules and from vnet_subnet_id match. For example, If no ip_rules and vnet_subnet_id arguments are supplied, the access to the key vault from any IP address or virtual network will be according to the default_action value. If you wish to allow access only from specific virtual network or IP address, use the ip_rules or the  vnet_subnet_id arguments. This is only used after the bypass property has been evaluated. Network ACL property.
      name: default_action
      predefined:
      - Allow
      - Deny
    - auto: PREDEFINED
      description: Tells what traffic can bypass network rules. This can be 'AzureServices' or 'None'. For example, use 'AzureServices' if you wish to give azure services access to key vault, although the default action is 'Deny' or the access for a specific IP address. Network acl property. Default value is 'AzureServices'.
      name: bypass
      predefined:
      - AzureServices
      - None
    - description: Allow accessibility of a vault from a specific virtual network. This argument must be the full resource ID of a virtual network subnet. For example, for the subnet ID "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/virtualNetworks/test-vnet/subnets/subnet1", you allow access to the Key Vault from subnet1. Network acl property.
      name: vnet_subnet_id
    - defaultValue: 'True'
      description: Specifies whether the Network Resource Provider will ignore the check if parent subnet has serviceEndpoints configured.  This allows the configuration for the Key Vault to complete without error before the configuration to the virtual network's subnet is complete. Once the subnet configuration is complete, the Cosmos account will then be accessible through the configured subnet. Network Acl property.
      name: ignore_missing_vnet_service_endpoint
      predefined:
      - ''
    - description: 'The list of IP address rules. Each rule governing the accessibility of a vault from a specific IP address or IP range. It can be a simple IP address "124.56.78.91" or "124.56.78.0/24" -  all addresses that start with 124.56.78. For example, for the IP addresses list: "124.56.78.91,124.56.78.92", you can access the Key Vault from "124.56.78.91" or "124.56.78.92" IP addresses. Network acl property.'
      isArray: true
      name: ip_rules
    - name: subscription_id
      description: "The subscription ID. Note: This argument will override the instance parameter ‘Default Subscription ID'."
      type: String
    - name: resource_group_name
      description: "The name of the resource group. Note: This argument will override the instance parameter ‘Default Resource Group Name'."
      type: String
    description: Create or update a key vault in the specified subscription. If the Key Vault exists, the updated properties will overwrite the existing ones. Please use azure-key-vault-access-policy-update command if you wish to update the access policy of an existing Key Vault.
    name: azure-key-vault-create-update
    outputs:
    - contextPath: AzureKeyVault.KeyVault.id
      description: Resource ID.
      type: String
    - contextPath: AzureKeyVault.KeyVault.name
      description: Key Vault name.
      type: String
    - contextPath: AzureKeyVault.KeyVault.type
      description: Resource type in Azure.
      type: String
    - contextPath: AzureKeyVault.KeyVault.location
      description: Key Vault location.
      type: String
    - contextPath: AzureKeyVault.KeyVault.properties.sku.family
      description: SKU family name.
      type: String
    - contextPath: AzureKeyVault.KeyVault.properties.sku.name
      description: SKU name to specify whether the key vault is a standard vault or a premium vault.
      type: String
    - contextPath: AzureKeyVault.KeyVault.properties.tenantId
      description: The Azure Active Directory tenant ID that should be used for authenticating requests to the key vault.
      type: String
    - contextPath: AzureKeyVault.KeyVault.properties.accessPolicies.tenantId
      description: The Azure Active Directory tenant ID that should be used for authenticating requests to the key vault.
      type: String
    - contextPath: AzureKeyVault.KeyVault.properties.accessPolicies.objectId
      description: The object ID of a user, service principal or security group in the Azure Active Directory tenant for the vault. The object ID must be unique for the list of access policies.
      type: String
    - contextPath: AzureKeyVault.KeyVault.properties.accessPolicies.permissions.keys
      description: Permissions to keys.
      type: Unknown
    - contextPath: AzureKeyVault.KeyVault.properties.accessPolicies.permissions.secrets
      description: Permissions to secrets.
      type: Unknown
    - contextPath: AzureKeyVault.KeyVault.properties.accessPolicies.permissions.certificates
      description: Permissions to certificates.
      type: Unknown
    - contextPath: AzureKeyVault.KeyVault.properties.enabledForDeployment
      description: Property to specify whether Azure Virtual Machines are permitted to retrieve certificates stored as secrets from the key vault.
      type: Boolean
    - contextPath: AzureKeyVault.KeyVault.properties.enabledForDiskEncryption
      description: Property to specify whether Azure Disk Encryption is permitted to retrieve secrets from the vault and unwrap keys.
      type: Boolean
    - contextPath: AzureKeyVault.KeyVault.properties.enabledForTemplateDeployment
      description: Property to specify whether Azure Resource Manager is permitted to retrieve secrets from the key vault.
      type: Boolean
    - contextPath: AzureKeyVault.KeyVault.properties.vaultUri
      description: The URI of the vault for performing operations on keys and secrets.
      type: String
    - contextPath: AzureKeyVault.KeyVault.properties.provisioningState
      description: The current provisioning state.
      type: String
  - arguments:
    - description: Key Vault name to delete.
      name: vault_name
      required: true
    - name: subscription_id
      description: "The subscription ID. Note: This argument will override the instance parameter ‘Default Subscription ID'."
      type: String
    - name: resource_group_name
      description: "The name of the resource group. Note: This argument will override the instance parameter ‘Default Resource Group Name'."
      type: String
    description: Delete the specified key vault.
    execution: true
    name: azure-key-vault-delete
  - arguments:
    - description: Key Vault name.
      name: vault_name
      required: true
    - name: subscription_id
      description: "The subscription ID. Note: This argument will override the instance parameter ‘Default Subscription ID'."
      type: String
    - name: resource_group_name
      description: "The resource group name. Note: This argument will override the instance parameter ‘Default Resource Group Name'."
      type: String
    description: Get the specified key vault.
    name: azure-key-vault-get
    outputs:
    - contextPath: AzureKeyVault.KeyVault.id
      description: Resource ID.
      type: String
    - contextPath: AzureKeyVault.KeyVault.name
      description: Key Vault name.
      type: String
    - contextPath: AzureKeyVault.KeyVault.type
      description: Resource type in Azure.
      type: String
    - contextPath: AzureKeyVault.KeyVault.location
      description: Key Vault location.
      type: String
    - contextPath: AzureKeyVault.KeyVault.properties.sku.family
      description: SKU family name.
      type: String
    - contextPath: AzureKeyVault.KeyVault.properties.sku.name
      description: SKU name to specify whether the key vault is a standard vault or a premium vault.
      type: String
    - contextPath: AzureKeyVault.KeyVault.properties.tenantId
      description: The Azure Active Directory tenant ID that should be used for authenticating requests to the key vault.
      type: String
    - contextPath: AzureKeyVault.KeyVault.properties.accessPolicies.tenantId
      description: The Azure Active Directory tenant ID that should be used for authenticating requests to the key vault.
      type: String
    - contextPath: AzureKeyVault.KeyVault.properties.accessPolicies.objectId
      description: The object ID of a user, service principal or security group in the Azure Active Directory tenant for the vault. The object ID must be unique for the list of access policies.
      type: String
    - contextPath: AzureKeyVault.KeyVault.properties.accessPolicies.permissions.keys
      description: Permissions to keys.
      type: Unknown
    - contextPath: AzureKeyVault.KeyVault.properties.accessPolicies.permissions.secrets
      description: Permissions to secrets.
      type: Unknown
    - contextPath: AzureKeyVault.KeyVault.properties.accessPolicies.permissions.certificates
      description: Permissions to certificates.
      type: Unknown
    - contextPath: AzureKeyVault.KeyVault.properties.enabledForDeployment
      description: Property to specify whether Azure Virtual Machines are permitted to retrieve certificates stored as secrets from the key vault.
      type: Boolean
    - contextPath: AzureKeyVault.KeyVault.properties.enabledForDiskEncryption
      description: Property to specify whether Azure Disk Encryption is permitted to retrieve secrets from the vault and unwrap keys.
      type: Boolean
    - contextPath: AzureKeyVault.KeyVault.properties.enabledForTemplateDeployment
      description: Property to specify whether Azure Resource Manager is permitted to retrieve secrets from the key vault.
      type: Boolean
    - contextPath: AzureKeyVault.KeyVault.properties.enableSoftDelete
      description: Property to specify whether the 'soft delete' functionality is enabled for this key vault. If it's not set to any value(true or false) when creating new key vault, it will be set to true by default. Once set to true, it cannot be reverted to false.
      type: Boolean
    - contextPath: AzureKeyVault.KeyVault.properties.vaultUri
      description: The URI of the vault for performing operations on keys and secrets. This property is readonly.
      type: String
  - arguments:
    - description: Limit on the number of keys vaults to return. Default value is 50.
      name: limit
    - description: First index to retrieve from. Default value is 0.
      name: offset
    - name: subscription_id
      description: "The subscription ID. Note: This argument will override the instance parameter ‘Default Subscription ID'."
      type: String
    description: The List operation gets information about the vaults associated with the subscription. For a limit greater than 25, more than one API call will be required and the command might take longer time.
    name: azure-key-vault-list
    outputs:
    - contextPath: AzureKeyVault.KeyVault.id
      description: Resource ID.
      type: String
    - contextPath: AzureKeyVault.KeyVault.name
      description: Key Vault name.
      type: String
    - contextPath: AzureKeyVault.KeyVault.type
      description: Resource type in Azure.
      type: String
    - contextPath: AzureKeyVault.KeyVault.location
      description: Key Vault location.
      type: String
    - contextPath: AzureKeyVault.KeyVault.properties.sku.family
      description: SKU family name.
      type: String
    - contextPath: AzureKeyVault.KeyVault.properties.sku.name
      description: SKU name to specify whether the key vault is a standard vault or a premium vault.
      type: String
    - contextPath: AzureKeyVault.KeyVault.properties.tenantId
      description: The Azure Active Directory tenant ID that should be used for authenticating requests to the key vault.
      type: String
    - contextPath: AzureKeyVault.KeyVault.properties.accessPolicies.tenantId
      description: The Azure Active Directory tenant ID that should be used for authenticating requests to the key vault.
      type: String
    - contextPath: AzureKeyVault.KeyVault.properties.accessPolicies.objectId
      description: The object ID of a user, service principal or security group in the Azure Active Directory tenant for the vault. The object ID must be unique for the list of access policies.
      type: String
    - contextPath: AzureKeyVault.KeyVault.properties.accessPolicies.permissions.keys
      description: Permissions to keys.
      type: Unknown
    - contextPath: AzureKeyVault.KeyVault.properties.accessPolicies.permissions.secrets
      description: Permissions to secrets.
      type: Unknown
    - contextPath: AzureKeyVault.KeyVault.properties.accessPolicies.permissions.certificates
      description: Permissions to certificates.
      type: Unknown
    - contextPath: AzureKeyVault.KeyVault.properties.enabledForDeployment
      description: Property to specify whether Azure Virtual Machines are permitted to retrieve certificates stored as secrets from the key vault.
      type: Boolean
    - contextPath: AzureKeyVault.KeyVault.properties.enabledForDiskEncryption
      description: Property to specify whether Azure Disk Encryption is permitted to retrieve secrets from the vault and unwrap keys.
      type: Boolean
    - contextPath: AzureKeyVault.KeyVault.properties.enabledForTemplateDeployment
      description: Property to specify whether Azure Resource Manager is permitted to retrieve secrets from the key vault.
      type: Boolean
    - contextPath: AzureKeyVault.KeyVault.properties.enableSoftDelete
      description: Property to specify whether the 'soft delete' functionality is enabled for this key vault. If it's not set to any value(true or false) when creating new key vault, it will be set to true by default. Once set to true, it cannot be reverted to false.
      type: Boolean
    - contextPath: AzureKeyVault.KeyVault.properties.vaultUri
      description: 'The URI of the vault for performing operations on keys and secrets. '
      type: String
  - arguments:
    - description: The name of the Key Vault to update it's access policy.
      name: vault_name
      required: true
    - auto: PREDEFINED
      description: 'The name of the operation to do on the vault''s access policy. Supports three operations: add,remove,replace. For example, to add get, list permissions to the current secret permissions, use operation_kind=add and secrets=get,list.'
      name: operation_kind
      predefined:
      - add
      - remove
      - replace
      required: true
    - description: The object ID of a user, service principal or security group in the Azure Active Directory tenant for the vault. The update regards only the access policy for the specified object ID.
      name: object_id
      required: true
    - auto: PREDEFINED
      description: Permissions to keys.
      isArray: true
      name: keys
      predefined:
      - encrypt
      - decrypt
      - wrapKey
      - unwrapKey
      - sign
      - verify
      - get
      - list
      - create
      - update
      - import
      - delete
      - backup
      - restore
      - recover
      - purge
    - auto: PREDEFINED
      description: Permissions to secrets.
      isArray: true
      name: secrets
      predefined:
      - get
      - list
      - set
      - delete
      - backup
      - restore
      - recover
      - purge
    - auto: PREDEFINED
      description: Permissions to certificates.
      isArray: true
      name: certificates
      predefined:
      - get
      - list
      - delete
      - create
      - import
      - update
      - managecontacts
      - getissuers
      - listissuers
      - setissuers
      - deleteissuers
      - manageissuers
      - recover
      - purge
    - auto: PREDEFINED
      description: Permissions to storage accounts.
      isArray: true
      name: storage
      predefined:
      - get
      - list
      - delete
      - set
      - update
      - regeneratekey
      - getsas
      - listsas
      - deletesas
      - setsas
      - recover
      - backup
      - restore
      - purge
    - name: subscription_id
      description: "The subscription ID. Note: This argument will override the instance parameter ‘Default Subscription ID'."
      type: String
    - name: resource_group_name
      description: "The name of the resource group. Note: This argument will override the instance parameter ‘Default Resource Group Name'."
      type: String
    description: Update access policies in a key vault in the specified subscription. The update regards only the access policy for the specified object ID.
    execution: true
    name: azure-key-vault-access-policy-update
    outputs:
    - contextPath: AzureKeyVault.VaultAccessPolicy.id
      description: Resource ID.
      type: String
    - contextPath: AzureKeyVault.VaultAccessPolicy.type
      description: Resource type in Azure.
      type: String
    - contextPath: AzureKeyVault.VaultAccessPolicy.properties.accessPolicies.tenantId
      description: The Azure Active Directory tenant ID that should be used for authenticating requests to the key vault.
      type: String
    - contextPath: AzureKeyVault.VaultAccessPolicy.properties.accessPolicies.objectId
      description: The object ID of a user, service principal or security group in the Azure Active Directory tenant for the vault. The object ID must be unique for the list of access policies.
      type: String
    - contextPath: AzureKeyVault.VaultAccessPolicy.properties.accessPolicies.permissions.keys
      description: Permissions to keys.
      type: Unknown
    - contextPath: AzureKeyVault.VaultAccessPolicy.properties.accessPolicies.permissions.secrets
      description: Permissions to secrets.
      type: Unknown
    - contextPath: AzureKeyVault.VaultAccessPolicy.properties.accessPolicies.permissions.certificates
      description: Permissions to certificates.
      type: Unknown
  - arguments:
    - description: The name of the Key Vault where the key resides in.
      name: vault_name
      required: true
    - description: Key name.
      name: key_name
      required: true
    - description: Adding the version parameter retrieves a specific version of a key. This URI fragment is optional. If not specified, the latest version of the key is returned.
      name: key_version
    description: Get the public part of a stored key. This operation requires the keys/get permission.
    name: azure-key-vault-key-get
    outputs:
    - contextPath: AzureKeyVault.Key.key.kid
      description: Key identifier.
      type: String
    - contextPath: AzureKeyVault.Key.key.kty
      description: JsonWebKey Key Type.
      type: String
    - contextPath: AzureKeyVault.Key.key.key_ops
      description: Supported key operations.
      type: Unknown
    - contextPath: AzureKeyVault.Key.key.n
      description: RSA modulus.
      type: String
    - contextPath: AzureKeyVault.Key.key.e
      description: RSA public exponent.
      type: String
    - contextPath: AzureKeyVault.Key.attributes.enabled
      description: Determines whether the object is enabled.
      type: Boolean
    - contextPath: AzureKeyVault.Key.attributes.created
      description: Creation time in UTC.
      type: Date
    - contextPath: AzureKeyVault.Key.attributes.updated
      description: Last updated time in UTC.
      type: Date
    - contextPath: AzureKeyVault.Key.attributes.recoveryLevel
      description: Reflects the deletion recovery level currently in effect for keys in the current vault. If it contains 'Purgeable' the key can be permanently deleted by a privileged user; otherwise, only the system can purge the key, at the end of the retention interval.
      type: Unknown
  - arguments:
    - description: The name of the Key Vault where the keys reside in.
      name: vault_name
      required: true
    - defaultValue: '50'
      description: Limit on the number of keys to return. Default value is 50.
      name: limit
    - defaultValue: '0'
      description: First index to retrieve from. Default value is 0.
      name: offset
    description: List keys in the specified vault. For a limit greater than 25, more than one API call will be required and the command might take longer time. This operation requires the keys/list permission.
    name: azure-key-vault-key-list
    outputs:
    - contextPath: AzureKeyVault.Key.kid
      description: Key identifier.
      type: String
    - contextPath: AzureKeyVault.Key.attributes.enabled
      description: Determines whether the object is enabled.
      type: Boolean
    - contextPath: AzureKeyVault.Key.attributes.created
      description: Creation time in UTC.
      type: Date
    - contextPath: AzureKeyVault.Key.attributes.updated
      description: Last updated time in UTC.
      type: Date
    - contextPath: AzureKeyVault.Key.attributes.recoveryLevel
      description: Reflects the deletion recovery level currently in effect for keys in the current vault. If it contains 'Purgeable' the key can be permanently deleted by a privileged user; otherwise, only the system can purge the key, at the end of the retention interval.
      type: String
    - contextPath: AzureKeyVault.Key.attributes.recoverableDays
      description: Soft Delete data retention days. Value should be >=7 and <=90 when softDelete enabled, otherwise 0.
      type: Number
  - arguments:
    - description: The name of the Key Vault where the key resides in.
      name: vault_name
      required: true
    - description: Key name to delete.
      name: key_name
      required: true
    description: Delete a key of any type from storage in Azure Key vault. This operation requires the keys/delete permission.
    execution: true
    name: azure-key-vault-key-delete
    outputs:
    - contextPath: AzureKeyVault.Key.recoveryId
      description: The url of the recovery object, used to identify and recover the deleted key.
      type: String
    - contextPath: AzureKeyVault.Key.deletedDate
      description: The time when the key was deleted, in UTC.
      type: Date
    - contextPath: AzureKeyVault.Key.key.kid
      description: Key identifier.
      type: String
    - contextPath: AzureKeyVault.Key.key.kty
      description: JsonWebKey Key Type.
      type: String
    - contextPath: AzureKeyVault.Key.key.key_ops
      description: Supported key operations.
      type: Unknown
    - contextPath: AzureKeyVault.Key.key.n
      description: RSA modulus.
      type: String
    - contextPath: AzureKeyVault.Key.key.e
      description: RSA public exponent.
      type: String
    - contextPath: AzureKeyVault.Key.attributes.enabled
      description: Determines whether the object is enabled.
      type: Boolean
    - contextPath: AzureKeyVault.Key.attributes.created
      description: Creation time in UTC.
      type: Number
    - contextPath: AzureKeyVault.Key.attributes.updated
      description: Last updated time in UTC.
      type: Number
    - contextPath: AzureKeyVault.Key.attributes.recoveryLevel
      description: Reflects the deletion recovery level currently in effect for keys in the current vault. If it contains 'Purgeable' the key can be permanently deleted by a privileged user; otherwise, only the system can purge the key, at the end of the retention interval.
      type: String
  - arguments:
    - description: The name of the Key Vault where the secret resides in.
      name: vault_name
      required: true
    - description: Secret name.
      name: secret_name
      required: true
    - description: Secret version.If not specified, the latest version of the secret is returned.
      name: secret_version
    description: Get a specified secret from a given key vault. The GET operation is applicable to any secret stored in Azure Key Vault. This operation requires the secrets/get permission.
    name: azure-key-vault-secret-get
    outputs:
    - contextPath: AzureKeyVault.Secret.value
      description: Secret value.
      type: String
    - contextPath: AzureKeyVault.Secret.id
      description: Secret ID.
      type: String
    - contextPath: AzureKeyVault.Secret.attributes.enabled
      description: Determines whether the object is enabled.
      type: Bolean
    - contextPath: AzureKeyVault.Secret.attributes.created
      description: Creation time in UTC.
      type: Date
    - contextPath: AzureKeyVault.Secret.attributes.updated
      description: Last updated time in UTC.
      type: Date
    - contextPath: AzureKeyVault.Secret.attributes.recoveryLevel
      description: Reflects the deletion recovery level currently in effect for secrets in the current vault. If it contains 'Purgeable', the secret can be permanently deleted by a privileged user; otherwise, only the system can purge the secret, at the end of the retention interval.
      type: String
  - arguments:
    - description: The name of the Key Vault where the secrets reside in.
      name: vault_name
      required: true
    - description: Limit on the number of secrets to return. Default value is 50.
      name: limit
    - description: First index to retrieve from. Default value is 0.
      name: offset
    description: List secrets in a specified key vault. For a limit greater than 25, more than one API call will be required and the command might take longer time. This operation requires the secrets/list permission.
    name: azure-key-vault-secret-list
    outputs:
    - contextPath: AzureKeyVault.Secret.id
      description: Secret ID.
      type: String
    - contextPath: AzureKeyVault.Secret.attributes.enabled
      description: Determines whether the object is enabled.
      type: Bolean
    - contextPath: AzureKeyVault.Secret.attributes.nbf
      description: Not before date in UTC.
      type: Date
    - contextPath: AzureKeyVault.Secret.attributes.exp
      description: Expiry date in UTC.
      type: Date
    - contextPath: AzureKeyVault.Secret.attributes.created
      description: Creation time in UTC.
      type: Date
    - contextPath: AzureKeyVault.Secret.attributes.updated
      description: Last updated time in UTC.
      type: Date
    - contextPath: AzureKeyVault.Secret.attributes.recoveryLevel
      description: Reflects the deletion recovery level currently in effect for secrets in the current vault. If it contains 'Purgeable', the secret can be permanently deleted by a privileged user; otherwise, only the system can purge the secret, at the end of the retention interval.
      type: String
    - contextPath: AzureKeyVault.Secret.attributes.recoverableDays
      description: Soft Delete data retention days. Value should be >=7 and <=90 when softDelete enabled, otherwise 0.
      type: Number
  - arguments:
    - description: The name of the Key Vault where the secret resides in.
      name: vault_name
      required: true
    - description: Secret name to delete.
      name: secret_name
      required: true
    description: Delete a secret from a specified key vault. This operation requires the secrets/delete permission.
    execution: true
    name: azure-key-vault-secret-delete
    outputs:
    - contextPath: AzureKeyVault.Secret.recoveryId
      description: The URL of the recovery object, used to identify and recover the deleted secret.
      type: String
    - contextPath: AzureKeyVault.Secret.deletedDate
      description: The time when the secret was deleted, in UTC.
      type: Date
    - contextPath: AzureKeyVault.Secret.scheduledPurgeDate
      description: The time when the secret is scheduled to be purged, in UTC.
      type: Date
    - contextPath: AzureKeyVault.Secret.id
      description: Deleted secret ID.
      type: String
    - contextPath: AzureKeyVault.Secret.attributes.enabled
      description: Determines whether the object is enabled.
      type: Boolean
    - contextPath: AzureKeyVault.Secret.attributes.created
      description: Creation time in UTC.
      type: Date
    - contextPath: AzureKeyVault.Secret.attributes.updated
      description: Last updated time in UTC.
      type: Date
    - contextPath: AzureKeyVault.Secret.attributes.recoveryLevel
      description: Reflects the deletion recovery level currently in effect for secrets in the current vault.
      type: String
  - arguments:
    - description: The name of the Key Vault where the certificate resides in.
      name: vault_name
      required: true
    - description: Certificate name.
      name: certificate_name
      required: true
    - description: The version of the certificate. If not specified, the latest version of the certificate is returned.
      name: certificate_version
    description: Gets information about a specific certificate. This operation requires the certificates/get permission.
    name: azure-key-vault-certificate-get
    outputs:
    - contextPath: AzureKeyVault.Certificate.id
      description: Certificate ID.
      type: String
    - contextPath: AzureKeyVault.Certificate.kid
      description: Key ID.
      type: String
    - contextPath: AzureKeyVault.Certificate.sid
      description: Secret ID.
      type: String
    - contextPath: AzureKeyVault.Certificate.x5t
      description: Thumbprint of the certificate.
      type: String
    - contextPath: AzureKeyVault.Certificate.cer
      description: CER contents of x509 certificate.
      type: String
    - contextPath: AzureKeyVault.Certificate.attributes.enabled
      description: Determines whether the object is enabled.
      type: Boolean
    - contextPath: AzureKeyVault.Certificate.attributes.exp
      description: Expiry date in UTC.
      type: Date
    - contextPath: AzureKeyVault.Certificate.attributes.created
      description: Creation time in UTC.
      type: Date
    - contextPath: AzureKeyVault.Certificate.attributes.updated
      description: Last updated time in UTC.
      type: Date
    - contextPath: AzureKeyVault.Certificate.attributes.recoveryLevel
      description: Reflects the deletion recovery level currently in effect for certificates in the current vault. If it contains 'Purgeable', the certificate can be permanently deleted by a privileged user; otherwise, only the system can purge the certificate, at the end of the retention interval.
      type: String
    - contextPath: AzureKeyVault.Certificate.policy
      description: The management policy.
      type: Unknown
  - arguments:
    - description: The name of the Key Vault where the certificate reside in.
      name: vault_name
      required: true
    - description: Limit on the number of certificates to return. Default value is 50.
      name: limit
    - description: First index to retrieve from. Default value is 0.
      name: offset
    description: List certificates in a specified key vault. For a limit greater than 25, more than one API call will be required and the command might take longer time. This operation requires the certificates/list permission.
    name: azure-key-vault-certificate-list
    outputs:
    - contextPath: AzureKeyVault.Certificate.id
      description: Certificate ID.
      type: String
    - contextPath: AzureKeyVault.Certificate.x5t
      description: Thumbprint of the certificate.
      type: String
    - contextPath: AzureKeyVault.Certificate.attributes.enabled
      description: Determines whether the object is enabled.
      type: Boolean
    - contextPath: AzureKeyVault.Certificate.attributes.created
      description: Creation time in UTC.
      type: Date
    - contextPath: AzureKeyVault.Certificate.attributes.updated
      description: Last updated time in UTC.
      type: Date
  - arguments:
    - description: The name of the Key Vault where the secret resides in.
      name: vault_name
      required: true
    - description: The name of the certificate to retrieve the policy from.
      name: certificate_name
      required: true
    description: Get the policy of the specified certificate.This operation requires the certificates/get permission.
    name: azure-key-vault-certificate-policy-get
    outputs:
    - contextPath: AzureKeyVault.CertificatePolicy.id
      description: Policy ID.
      type: String
    - contextPath: AzureKeyVault.CertificatePolicy.key_props
      description: Properties of the key backing a certificate.
      type: Unknown
    - contextPath: AzureKeyVault.CertificatePolicy.x509_props
      description: Properties of the X509 component of a certificate.
      type: Unknown
    - contextPath: AzureKeyVault.CertificatePolicy.lifetime_actions
      description: Actions that will be performed by Key Vault over the lifetime of a certificate.
      type: Unknown
    - contextPath: AzureKeyVault.CertificatePolicy.issuer
      description: Parameters for the issuer of the X509 component of a certificate.
      type: Unknown
    - contextPath: AzureKeyVault.CertificatePolicy.attributes.enabled
      description: Determines whether the object is enabled.
      type: Boolean
    - contextPath: AzureKeyVault.CertificatePolicy.attributes.created
      description: Creation time in UTC.
      type: Date
    - contextPath: AzureKeyVault.CertificatePolicy.attributes.updated
      description: Last updated time in UTC.
      type: Date
  - name: azure-key-vault-subscriptions-list
    description: List all subscriptions for a tenant.
    outputs:
    - contextPath: AzureKeyVault.Subscription.id
      description: Subscription ID.
      type: String
    - contextPath: AzureKeyVault.Subscription.displayName
      description: Subscription display name.
      type: String
    - contextPath: AzureKeyVault.Subscription.state
      description: Subscription state.
      type: String
    - contextPath: AzureKeyVault.Subscription.subscriptionPolicies
      description: Subscription policies.
      type: Unknown
    - contextPath: AzureKeyVault.Subscription.authorizationSource
      description: Authorization source.
      type: String
    - contextPath: AzureKeyVault.Subscription.managedByTenants
      description: Managed by tenants.
      type: Unknown
    - contextPath: AzureKeyVault.Subscription.tenantId
      description: Tenant ID.
      type: String
  - name: azure-key-vault-resource-group-list
    description: List all resource groups for a subscription.
    arguments:
    - name: subscription_id
      description: "The subscription ID. Note: This argument will override the instance parameter ‘Default Subscription ID'."
    - name: limit
      description: Limit on the number of resource groups to return.
      defaultValue: 50
    - name: tag
      description: A single tag in the form of '{"Tag Name":"Tag Value"}' to filter the list by.
    outputs:
    - contextPath: AzureKeyVault.ResourceGroup.id
      description: Resource group ID.
      type: String
    - contextPath: AzureKeyVault.ResourceGroup.name
      description: Resource group name.
      type: String
    - contextPath: AzureKeyVault.ResourceGroup.location
      description: Resource group location.
      type: String
    - contextPath: AzureKeyVault.ResourceGroup.tags
      description: Resource group tags.
      type: Unknown
    - contextPath: AzureKeyVault.ResourceGroup.properties.provisioningState
      description: Resource group provisioning state.
  - deprecated: false
    description: Run this command if for some reason you need to rerun the authentication process.
    execution: false
    name: azure-key-vault-auth-reset
  dockerimage: demisto/crypto:1.0.0.67955
  runonce: false
  script: '-'
  subtype: python3
  type: python
tests:
- No tests (auto formatted)
fromversion: 5.5.0
sectionorder:
- Connect
- Collect
