commonfields:
  id: EWS Extension Online Powershell
  version: -1
vcShouldKeepItemLegacyProdMachine: false
name: EWS Extension Online Powershell
display: EWS Extension Online Powershell
category: Utilities
description: Use the EWS Extension Online Powershell v2 integration to get information about mailboxes and users in your organization.  This integration can also retrieve and modify Tenant Allow/Block Lists.
configuration:
- display: Exchange Online URL
  name: url
  defaultvalue: https://outlook.office365.com
  type: 0
  required: true
- display: Certificate
  name: certificate
  type: 9
  required: true
  additionalinfo: A pfx certificate encoded in Base64.
- display: The organization used in app-only authentication.
  name: organization
  type: 0
  required: true
- display: The application ID from the Azure portal
  name: app_id
  type: 0
  required: true
script:
  script: ''
  type: powershell
  commands:
  - name: ews-mailbox-list
    arguments:
    - name: identity
      description: The identity of the mailbox you want to view.
    - name: property_sets
      description: 'A comma-separated list of property sets to fetch. These property sets will supplement the outputs of this integration.  Available properties are: "All", "Minimum", "AddressList", "Archive", "Audit", "Delivery", "Hold", "Moderation", "Move", "Policy", "PublicFolder", "Quota", "Resource", "Retention", "SCL", "SoftDelete", "StatisticsSeed".'
      isArray: true
      defaultValue: Minimum
    - name: organizational_unit
      description: The object's location in Active Directory by which to filter the results.
    - name: primary_smtp_address
      description: The primary SMTP email address of the mailbox you want to view. Cannot be used with the user_principal_name argument. Can be retrieved using the ews-user-list command.
    - name: user_principal_name
      description: The UPN of the mailbox you want to view. Cannot be used with the primary_smtp_address argument. Can be retrieved using the ews-user-list command.
    - name: limit
      description: The maximum number of results to retrieve. Default is 10.
      defaultValue: '10'
    outputs:
    - contextPath: EWS.Mailbox.EmailAddresses
      description: Email addresses of the mailbox.
      type: String
    - contextPath: EWS.Mailbox.AuditBypassEnabled
      description: Whether audit bypass is enabled.
      type: Boolean
    - contextPath: EWS.Mailbox.DistinguishedName
      description: Distinguished name of the mailbox.
      type: String
    - contextPath: EWS.Mailbox.ExchangeObjectId
      description: Exchange object ID of the mailbox.
      type: String
    - contextPath: EWS.Mailbox.ExchangeVersion
      description: Exchange version of the mailbox.
      type: String
    - contextPath: EWS.Mailbox.Guid
      description: GUID of the mailbox.
      type: String
    - contextPath: EWS.Mailbox.Id
      description: ID of the mailbox.
      type: String
    - contextPath: EWS.Mailbox.Identity
      description: Identity of the mailbox.
      type: String
    - contextPath: EWS.Mailbox.IsValid
      description: Whether the mailbox is valid.
      type: Boolean
    - contextPath: EWS.Mailbox.Name
      description: Name of the mailbox.
      type: String
    - contextPath: EWS.Mailbox.ObjectCategory
      description: Object category of the mailbox.
      type: String
    - contextPath: EWS.Mailbox.ObjectClass
      description: Object class of the mailbox.
      type: String
    - contextPath: EWS.Mailbox.ObjectId
      description: Object ID of the of the mailbox.
      type: String
    - contextPath: EWS.Mailbox.ObjectState
      description: Object state of the mailbox.
      type: String
    - contextPath: EWS.Mailbox.OrganizationId
      description: Organization ID of the mailbox.
      type: String
    - contextPath: EWS.Mailbox.OriginatingServer
      description: Originating server of the mailbox.
      type: String
    - contextPath: EWS.Mailbox.PSComputerName
      description: PowerShell computer name of the mailbox.
      type: String
    - contextPath: EWS.Mailbox.PSShowComputerName
      description: PowerShell show computer name of the mailbox.
      type: Boolean
    - contextPath: EWS.Mailbox.RunspaceId
      description: Run space ID of the mailbox.
      type: String
    - contextPath: EWS.Mailbox.WhenChanged
      description: Local time of when the mailbox was last changed.
      type: Date
    - contextPath: EWS.Mailbox.WhenChangedUTC
      description: UTC time of when the mailbox was last changed.
      type: Date
    - contextPath: EWS.Mailbox.WhenCreated
      description: Local time of when the mailbox was created.
      type: Date
    - contextPath: EWS.Mailbox.WhenCreatedUTC
      description: UTC time of when the mailbox was created.
      type: Date
    description: Displays mailbox objects and attributes, populate property pages, or supplies mailbox information to other tasks.
  - name: ews-cas-mailbox-list
    arguments:
    - name: identity
      description: The identity of the mailbox you want to view.
    - name: organizational_unit
      description: The object's location in Active Directory by which to filter the results.
    - name: primary_smtp_address
      description: The primary SMTP email address of the mailbox you want to view. Cannot be used with the user_principal_name argument. Can be retrieved using the ews-user-list command.
    - name: user_principal_name
      description: The UPN of the mailbox you want to view. Cannot be used with the primary_smtp_address argument. Can be retrieved using the ews-user-list command.
    - name: limit
      description: The maximum number of results to retrieve. Default is 10.
      defaultValue: '10'
    outputs:
    - contextPath: EWS.CASMailbox.ActiveSyncEnabled
      description: Whether active sync is enabled.
      type: Boolean
    - contextPath: EWS.CASMailbox.DisplayName
      description: The display name of the mailbox.
      type: String
    - contextPath: EWS.CASMailbox.ECPEnabled
      description: Whether the Exchange Control Panel (ECP) is enabled.
      type: Boolean
    - contextPath: EWS.CASMailbox.EmailAddresses
      description: The email addresses retrieved.
      type: String
    - contextPath: EWS.CASMailbox.EwsEnabled
      description: Whether the Exchange Web Services (EWS) is enabled.
      type: Boolean
    - contextPath: EWS.CASMailbox.ExchangeVersion
      description: Exchange version of the client access server mailbox.
      type: String
    - contextPath: EWS.CASMailbox.ExternalDirectoryObjectId
      description: External directory object ID of the client access server mailbox.
      type: String
    - contextPath: EWS.CASMailbox.Guid
      description: The GUID of the client access server mailbox.
      type: String
    - contextPath: EWS.CASMailbox.Identity
      description: Identity of the client access server mailbox.
      type: String
    - contextPath: EWS.CASMailbox.ImapEnabled
      description: Whether the Internet Message Access Protocol (IMAP) is enabled.
      type: Boolean
    - contextPath: EWS.CASMailbox.MAPIEnabled
      description: Whether the Messaging Application Programming Interface is enabled.
      type: Boolean
    - contextPath: EWS.CASMailbox.Name
      description: Name of the client access server mailbox.
      type: String
    - contextPath: EWS.CASMailbox.OWAEnabled
      description: Whether Outlook on the web (OWA) is enabled.
      type: Boolean
    - contextPath: EWS.CASMailbox.OrganizationId
      description: Organization ID
      type: String
    - contextPath: EWS.CASMailbox.PopEnabled
      description: Whether Post Office Protocol (POP) is enabled.
      type: Boolean
    - contextPath: EWS.CASMailbox.PrimarySmtpAddress
      description: Primary SMTP address.
      type: String
    - contextPath: EWS.CASMailbox.ServerLegacyDN
      description: Server legacy distinguished name (DN).
      type: String
    description: Displays Client Access settings that are configured on mailboxes.
  - name: ews-mailbox-permission-list
    arguments:
    - name: identity
      required: true
      description: The identity of the mailbox you want to view.
    outputs:
    - contextPath: EWS.MailboxPermission.Identity
      description: The specified identity of the mailbox.
      type: String
    - contextPath: EWS.MailboxPermission.Permission.AccessRights
      description: Access rights of the mailbox.
      type: String
    - contextPath: EWS.MailboxPermission.Permission.Deny.IsPresent
      description: Whether permission is denied.
      type: Boolean
    - contextPath: EWS.MailboxPermission.Permission.Identity
      description: The permission identity.
      type: String
    - contextPath: EWS.MailboxPermission.Permission.InheritanceType
      description: Permission inheritance type.
      type: String
    - contextPath: EWS.MailboxPermission.Permission.IsInherited
      description: Whether permission is inherited.
      type: Boolean
    - contextPath: EWS.MailboxPermission.Permission.User
      description: The permission of the user.
      type: String
    description: Retrieves permissions on a mailbox.
  - name: ews-recipient-permission-list
    arguments:
    - name: identity
      description: The identity of the mailbox you want to view.
    - name: limit
      description: The maximum number of results to retrieve. Default is 10.
      defaultValue: '10'
    outputs:
    - contextPath: EWS.RecipientPermission.AccessControlType
      description: Access control type of the recipient permission.
      type: String
    - contextPath: EWS.RecipientPermission.AccessRights
      description: Access rights of the recipient permission.
      type: Number
    - contextPath: EWS.RecipientPermission.Identity
      description: Identity of the recipient permission.
      type: String
    - contextPath: EWS.RecipientPermission.InheritanceType
      description: Inheritance type of the recipient permission.
      type: String
    - contextPath: EWS.RecipientPermission.IsInherited
      description: Whether the recipient permission is inherited.
      type: Boolean
    - contextPath: EWS.RecipientPermission.Trustee
      description: Trustee of the recipient permission.
      type: String
    description: Displays information about SendAs permissions that are configured for users.
  - name: ews-recipient-list
    arguments:
    - name: identity
      description: The identity of the mailbox you want to view.
    - name: limit
      description: The maximum number of results to retrieve. Default is 10.
      defaultValue: '10'
    outputs:
    - contextPath: EWS.Recipient.Alias
      description: Recipient alias.
      type: String
    - contextPath: EWS.Recipient.DisplayName
      description: Recipient display name.
      type: String
    - contextPath: EWS.Recipient.DistinguishedName
      description: Recipient distinguished name.
      type: String
    - contextPath: EWS.Recipient.EmailAddresses
      description: Recipient email addresses.
      type: String
    - contextPath: EWS.Recipient.ExchangeVersion
      description: Recipient exchange version.
      type: String
    - contextPath: EWS.Recipient.ExternalDirectoryObjectId
      description: Recipient external directory object ID.
      type: String
    - contextPath: EWS.Recipient.Identity
      description: Recipient identity.
      type: String
    - contextPath: EWS.Recipient.Name
      description: Recipient name.
      type: String
    - contextPath: EWS.Recipient.OrganizationId
      description: Recipient organization ID.
      type: String
    - contextPath: EWS.Recipient.PrimarySmtpAddress
      description: Recipient primary SMTP address.
      type: String
    - contextPath: EWS.Recipient.RecipientType
      description: Recipient type.
      type: String
    - contextPath: EWS.Recipient.RecipientTypeDetails
      description: Recipient type details.
      type: String
    description: Displays existing recipient objects in your organization. This command returns all mail-enabled objects (for example, mailboxes, mail users, mail contacts, and distribution groups).
  - name: ews-new-tenant-allow-block-list-items
    arguments:
    - name: entries
      required: true
      description: Entries to add to the list.  Separate multiple entries with a comma (e.g. "Item1,Item2").
      isArray: true
    - name: list_type
      required: true
      auto: PREDEFINED
      predefined:
      - sender
      - filehash
      - url
      description: List type to add items to.
    - name: list_subtype
      auto: PREDEFINED
      predefined:
      - Tenant
      - AdvancedDelivery
      description: 'List subtype to add items to. '
      defaultValue: Tenant
    - name: action
      required: true
      auto: PREDEFINED
      predefined:
      - Block
      - Allow
      description: Action to set for new entries
    - name: notes
      description: Notes to include on new list entries
    - name: expiration_date
      description: Enter a specific date and time for the new entries to expire using format "YYYY-MM-DD HH:MM:SSz" for UTC time.  Alternately, a PowerShell **GetDate** statement can be used.
    - name: no_expiration
      auto: PREDEFINED
      predefined:
      - 'false'
      - 'true'
      description: Specify whether to create list entries with no expiration date.  Cannot be used with "expiration_date".  If left false and no expiration date is set, default of 30 days will be used.
      defaultValue: 'false'
    - name: set_context
      auto: PREDEFINED
      predefined:
      - yes
      - no
      description: Specify whether or not to output results to context.
      defaultValue: no
    description: Add new items to the Tenant Allow/Block Lists.  Uses PowerShell New-TenantAllowBlockListItems cmdlet.
    execution: true
  - name: ews-get-tenant-allow-block-list-items
    arguments:
    - name: list_type
      required: true
      auto: PREDEFINED
      predefined:
      - sender
      - filehash
      - url
      description: List type to retrieve items from.
    - name: list_subtype
      auto: PREDEFINED
      predefined:
      - Tenant
      - AdvancedDelivery
      description: List subtype to retrieve items from.
      defaultValue: Tenant
    - name: action
      required: true
      auto: PREDEFINED
      predefined:
      - Block
      - Allow
      description: Action to filter entries by.
    - name: expiration_date
      description: Enter a specific date and time to filter entries by using format "YYYY-MM-DD HH:MM:SSz" for UTC time.  Alternately, a PowerShell **GetDate** statement can be used.
    - name: no_expiration
      auto: PREDEFINED
      predefined:
      - 'false'
      - 'true'
      description: Filter list items that are set to never expire.
      defaultValue: 'false'
    - name: entry
      description: Specific entry to retrieve.
    - name: set_context
      auto: PREDEFINED
      predefined:
      - yes
      - no
      description: Specify whether or not to output results to context.
      defaultValue: no
    description: Retrieve current Tenant Allow/Block List items.  Uses Get-TenantAllowBlockListItems cmdlet.
  - name: ews-get-tenant-allow-block-list-count
    arguments:
    - name: list_type
      auto: PREDEFINED
      predefined:
      - sender
      - filehash
      - url
      description: List type to retrieve items from.
    - name: list_subtype
      auto: PREDEFINED
      predefined:
      - Tenant
      - AdvancedDelivery
      description: List subtype to retrieve items from.
      defaultValue: Tenant
    - name: set_context
      auto: PREDEFINED
      predefined:
      - yes
      - no
      description: Specify whether or not to output results to context.
      defaultValue: no
    description: Retrieve current count of defined Tenant Allow/Block List items.  Uses Get-TenantAllowBlockListItems cmdlet.
  - name: ews-remove-tenant-allow-block-list-items
    arguments:
    - name: entries
      description: Entries to remove from the list.  Either use this OR 'ids' to specify items to remove.  Separate multiple entries with a comma (e.g. "Item1,Item2").
      isArray: true
    - name: ids
      description: Entry IDs to remove from the list.  Either use this OR 'entries' to specify items to remove.  Separate multiple entries with a comma (e.g. "Item1,Item2").
    - name: list_type
      required: true
      auto: PREDEFINED
      predefined:
      - sender
      - filehash
      - url
      description: List type to remove items from.
    - name: list_subtype
      auto: PREDEFINED
      predefined:
      - Tenant
      - AdvancedDelivery
      description: List subtype to remove items from.
      defaultValue: Tenant
    - name: set_context
      auto: PREDEFINED
      predefined:
      - yes
      - no
      description: Specify whether or not to output results to context.
      defaultValue: no
    description: Remove items from the Tenant Allow/Block Lists.   You can delete items by their value or by unique ID.  Uses PowerShell cmdlet Remove-TenantAllowBlockListItems cmdlet.
  dockerimage: demisto/pwsh-exchange:1.0.0.22307
  runonce: false
sourcemoduleid: EWS Extension Online Powershell v2
fromversion: 5.5.0
