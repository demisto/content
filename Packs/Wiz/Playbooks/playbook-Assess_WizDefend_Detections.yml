id: Assess WizDefend Detections
name: Assess WizDefend Detections
description: Playbook to assess Wiz Detections from the WizDefend integration
starttaskid: "0"
tasks:
  "0":
    id: "0"
    type: start
    task:
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
      id: 5f7d6811-ad26-42ca-b47e-ee8a12f9bb7f
    nexttasks:
      '#none#':
      - "1"
      - "3"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    taskid: 5f7d6811-ad26-42ca-b47e-ee8a12f9bb7f
  "1":
    id: "1"
    type: regular
    task:
      version: -1
      name: Get Resource Information
      description: Get details of the affected resource
      script: WizDefend|||wiz-get-detection
      type: regular
      iscommand: true
      brand: WizDefend
      id: 7f90d8e3-df5a-4cbc-b8a5-fb63a59d7c48
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      detection_id:
        simple: ${incident.wizdetectionid}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 60,
          "y": 230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    taskid: 7f90d8e3-df5a-4cbc-b8a5-fb63a59d7c48
  "2":
    id: "2"
    type: regular
    task:
      version: -1
      name: Gather Additional Detections
      description: Get all related detections
      script: WizDefend|||wiz-get-detections
      type: regular
      iscommand: true
      brand: WizDefend
      id: d9841dc5-3ab8-412c-a6f5-83cb55c1ec47
    scriptarguments:
      resource_id:
        simple: ${incident.wizresourceid}
      severity:
        simple: ${incident.severity}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 60,
          "y": 410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    taskid: d9841dc5-3ab8-412c-a6f5-83cb55c1ec47
  "3":
    id: "3"
    type: regular
    task:
      version: -1
      name: Update Detection URL
      description: Update the detection URL if not already set
      script: SetIncident
      type: regular
      iscommand: true
      brand: ""
      id: 28bec1b2-3b5e-41b1-bf35-16bfb9fa36d7
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      wizdefenddetectionurl:
        simple: https://app.wiz.io/detections/${incident.wizdetectionid}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -380,
          "y": 230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    taskid: 28bec1b2-3b5e-41b1-bf35-16bfb9fa36d7
  "4":
    id: "4"
    type: regular
    task:
      version: -1
      name: Assess Impact
      description: Assess the impact of the detection
      script: ""
      type: regular
      iscommand: false
      brand: ""
      id: fabde172-2e4d-4548-a4e3-f67ecb646c90
    nexttasks:
      '#none#':
      - "5"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -380,
          "y": 410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    taskid: fabde172-2e4d-4548-a4e3-f67ecb646c90
  "5":
    id: "5"
    taskid: 15b5e184-a9e7-444c-8958-7e274fb41a46
    type: regular
    task:
      id: 15b5e184-a9e7-444c-8958-7e274fb41a46
      version: -1
      name: Assign Owner
      description: Assign the incident to the appropriate team member
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -380,
          "y": 590
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 58d4591d-2a04-4d39-832b-48de3b0dd300
    type: regular
    task:
      id: 58d4591d-2a04-4d39-832b-48de3b0dd300
      version: -1
      name: Document Investigation
      description: Document findings from the investigation
      type: regular
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -380,
          "y": 770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 815,
        "width": 820,
        "x": -380,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
fromversion: 6.0.0
version: -1
tests:
- No tests