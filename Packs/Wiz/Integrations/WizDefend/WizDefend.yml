category: Utilities
commonfields:
  id: WizDefend
  version: -1
defaultmapperin: WizDefend Mapper
configuration:
- name: incidentType
  display: Incident type
  defaultvalue: WizDefend Detection
  type: 13
  required: false
- name: credentials
  display: Service Account ID
  type: 9
  required: true
- name: auth_endpoint
  display: Authentication Endpoint
  type: 0
  required: true
- name: api_endpoint
  display: API Endpoint
  required: true
  type: 0
  defaultvalue: https://api.us1.app.wiz.io/graphql
- name: first_fetch
  display: First fetch timestamp (max 5 days)
  additionalinfo: 'How many detections to pull the first time. The format is <number> <time unit>, e.g., 12 hours, 1 day. The maximum is 5 days.'
  type: 0
  required: false
  defaultvalue: 12 hours
- name: severity
  additionalinfo: 'The chosen severity and above will be fetched.'
  display: Detection severities to fetch
  options:
  - None
  - Critical
  - High
  - Medium
  - Low
  defaultvalue: High
  type: 15
  required: false
- name: type
  display: Detection type to fetch
  options:
  - None
  - GENERATED THREAT
  - DID NOT GENERATE THREAT
  defaultvalue: GENERATED THREAT
  type: 15
  required: false
- name: subscription
  display: Detection subscription to fetch
  type: 0
  required: false
- name: platform
  display: Detection platforms to fetch.
  options:
  - AWS
  - GCP
  - Azure
  - OCI
  - Alibaba
  - vSphere
  - OpenStack
  - AKS
  - EKS
  - GKE
  - Kubernetes
  - OpenShift
  - OKE
  - Linode
  - AzureDevOps
  - GitHub
  - GitLab
  - Bitbucket
  - Terraform
  - OpenAI
  - Snowflake
  - MongoDBAtlas
  - Databricks
  - Okta
  - Cloudflare
  - Microsoft365
  - Wiz
  - ACK
  - SelfHosted
  - LKE
  type: 16
- name: origin
  display: Cloud event origin to fetch.
  options:
    - WIZ_SENSOR
    - WIZ_ADMISSION_CONTROLLER
    - WIZ_FILE_INTEGRITY_MONITORING
    - AWS_GUARD_DUTY
    - AWS_CLOUDTRAIL
    - AZURE_DEFENDER_FOR_CLOUD
    - AZURE_ACTIVITY_LOGS
    - GCP_SECURITY_COMMAND_CENTER
    - GCP_AUDIT_LOGS
    - WIZ_AGENTLESS_FILE_INTEGRITY_MONITORING
    - AZURE_ACTIVE_DIRECTORY
    - GOOGLE_WORKSPACE_AUDIT_LOGS
    - WIN_SENTINEL_ONE
    - WIZ_CODE_ANALYZER
    - WIN_SALT
    - WIN_NONAME
    - WIN_CROWD_STRIKE
    - WIN_TRACEABLE
    - WIZ_CLI
    - WIZ_IDE_EXTENSION
    - WIZ_THREAT_DETECTION
    - WIZ_KUBERNETES_AUDIT_LOGS_COLLECTOR
    - WIZ_CUSTOM_INTEGRATION
    - WIN_AKAMAI_GUARDICORE
    - OKTA_SYSTEM_LOGS
    - WIN_SNOWFLAKE
    - WIN_FALCO
    - OCI_AUDIT_LOGS
    - WIZ_VCS_FETCHER
    - AWS_VPC_FLOW_LOGS
    - GITHUB_AUDIT_LOGS
    - WIN_FIRE_TAIL
    - AZURE_STORAGE_ACCOUNT
    - AZURE_KEY_VAULT
    - AWS_RESOLVER_QUERY_LOGS
    - AWS_S3_DATA_EVENTS
    - GCP_STORAGE_DATA_ACCESS_LOGS
    - AWS_CLOUDTRAIL_NETWORK_ACTIVITY
    - WIZ_BROWSER_EXTENSION
    - WIN_SALT_SECURITY
  type: 16
  required: false
- display: Use system proxy settings
  name: proxy
  type: 8
  required: false
- display: Fetch incidents
  name: isFetch
  type: 8
  required: false
description: Agentless cloud security.
display: WizDefend
name: WizDefend
script:
  commands:
  - name: wiz-get-detections
    description: Get Wiz Detections for a specific type.
    arguments:
    - name: creation_minutes_back
      description: Number of minutes back to retrieve Detections (10-600).
      defaultValue: 10
      required: false
    - name: type
      description: Detections type.
      predefined:
      - GENERATED THREAT
      - DID NOT GENERATE THREAT
      defaultValue: GENERATED THREAT
      auto: PREDEFINED
    - name: issue_id
      description: The internal Wiz Issue ID of the Detections.
      required: false
    - name: subscription
      description: The cloud subscription of the Detections.
      required: false
    - name: origin
      description: Cloud event origin. You can insert multiple cloud event origins in this format ORIGIN1,ORIGIN2 etc...
      predefined:
        - WIZ_SENSOR
        - WIZ_ADMISSION_CONTROLLER
        - WIZ_FILE_INTEGRITY_MONITORING
        - AWS_GUARD_DUTY
        - AWS_CLOUDTRAIL
        - AZURE_DEFENDER_FOR_CLOUD
        - AZURE_ACTIVITY_LOGS
        - GCP_SECURITY_COMMAND_CENTER
        - GCP_AUDIT_LOGS
        - WIZ_AGENTLESS_FILE_INTEGRITY_MONITORING
        - AZURE_ACTIVE_DIRECTORY
        - GOOGLE_WORKSPACE_AUDIT_LOGS
        - WIN_SENTINEL_ONE
        - WIZ_CODE_ANALYZER
        - WIN_SALT
        - WIN_NONAME
        - WIN_CROWD_STRIKE
        - WIN_TRACEABLE
        - WIZ_CLI
        - WIZ_IDE_EXTENSION
        - WIZ_THREAT_DETECTION
        - WIZ_KUBERNETES_AUDIT_LOGS_COLLECTOR
        - WIZ_CUSTOM_INTEGRATION
        - WIN_AKAMAI_GUARDICORE
        - OKTA_SYSTEM_LOGS
        - WIN_SNOWFLAKE
        - WIN_FALCO
        - OCI_AUDIT_LOGS
        - WIZ_VCS_FETCHER
        - AWS_VPC_FLOW_LOGS
        - GITHUB_AUDIT_LOGS
        - WIN_FIRE_TAIL
        - AZURE_STORAGE_ACCOUNT
        - AZURE_KEY_VAULT
        - AWS_RESOLVER_QUERY_LOGS
        - AWS_S3_DATA_EVENTS
        - GCP_STORAGE_DATA_ACCESS_LOGS
        - AWS_CLOUDTRAIL_NETWORK_ACTIVITY
        - WIZ_BROWSER_EXTENSION
        - WIN_SALT_SECURITY
      auto: PREDEFINED
    - name: platform
      description: Get Detections for cloud platform. You can insert multiple platforms in this format PLATFORM1,PLATFORM2 etc...
      predefined:
        - AWS
        - GCP
        - Azure
        - OCI
        - Alibaba
        - vSphere
        - OpenStack
        - AKS
        - EKS
        - GKE
        - Kubernetes
        - OpenShift
        - OKE
        - Linode
        - AzureDevOps
        - GitHub
        - GitLab
        - Bitbucket
        - Terraform
        - OpenAI
        - Snowflake
        - MongoDBAtlas
        - Databricks
        - Okta
        - Cloudflare
        - Microsoft365
        - Wiz
        - ACK
        - SelfHosted
        - LKE
      auto: PREDEFINED
      isArray: true
    - name: resource_id
      description: Get Detections of a specific resource.
    - name: severity
      auto: PREDEFINED
      predefined:
      - CRITICAL
      - HIGH
      - MEDIUM
      - LOW
      - INFORMATIONAL
      description: Get Detections of a specific severity and above.
    - name: rule_match_id
      description: Filter Detections by rule match ID (must be a valid UUID).
      required: false
    - name: rule_match_name
      description: Filter Detections by rule match name.
      required: false
    - name: project
      description: Filter Detections by project.
      required: false
    outputs:
    - contextPath: Wiz.Manager.Detections.entitySnapshot
      description: All resource details.
      type: String
    - contextPath: Wiz.Manager.Detections.createdAt
      description: Detection created at.
      type: String
    - contextPath: Wiz.Manager.Detections.id
      description: Wiz Detection ID.
      type: String
    - contextPath: Wiz.Manager.Detections.url
      description: Wiz Detection URL.
      type: String
    - contextPath: Wiz.Manager.Detections.severity
      description: Wiz Detection severity.
      type: String
    - contextPath: Wiz.Manager.Detections.status
      description: Wiz Detection status.
      type: String
  - name: wiz-get-detection
    description: Get the details of a Wiz Detection.
    arguments:
    - description: Wiz internal detection ID to retrieve.
      name: detection_id
      isArray: true
      required: false
    outputs:
    - contextPath: Wiz.Manager.Detection.id
      description: Detection ID in Wiz.
      type: String
    - contextPath: Wiz.Manager.Detection.severity
      description: Detection severity.
      type: String
    - contextPath: Wiz.Manager.Detection.description
      description: Detection description.
      type: String
    - contextPath: Wiz.Manager.Detection.createdAt
      description: Detection creation time.
      type: Date
    - contextPath: Wiz.Manager.Detection.resources
      description: Related resources.
      type: String
    - contextPath: Wiz.Manager.Detection.url
      description: URL to the Wiz Detection in the Wiz console.
      type: String
  - name: wiz-get-threat
    description: Get the details of a Wiz Threat.
    arguments:
      - description: Wiz internal issue ID to retrieve.
        name: issue_id
        isArray: true
        required: false
  - name: wiz-get-threats
    description: Get Wiz Threats for a specific type.
    arguments:
      - name: creation_days_back
        description: Number of days back to retrieve threats (1-30).
        defaultValue: 5
        required: false
      - name: subscription
        description: The cloud subscription of the Threats.
        required: false
      - name: platform
        description: Get Threats for cloud platform. You can insert multiple platforms in this format PLATFORM1,PLATFORM2 etc...
        predefined:
          - AWS
          - GCP
          - Azure
          - OCI
          - Alibaba
          - vSphere
          - OpenStack
          - AKS
          - EKS
          - GKE
          - Kubernetes
          - OpenShift
          - OKE
          - Linode
          - AzureDevOps
          - GitHub
          - GitLab
          - Bitbucket
          - Terraform
          - OpenAI
          - Snowflake
          - MongoDBAtlas
          - Databricks
          - Okta
          - Cloudflare
          - Microsoft365
          - Wiz
          - ACK
          - SelfHosted
          - LKE
        auto: PREDEFINED
        isArray: true
      - name: resource_id
        description: Get Threats for a specific resource.
      - name: severity
        auto: PREDEFINED
        predefined:
          - CRITICAL
          - HIGH
          - MEDIUM
          - LOW
          - INFORMATIONAL
        description: Get Threats of a specific severity and above.
      - name: status
        auto: PREDEFINED
        predefined:
          - Open
          - In Progress
          - Resolved
          - Ignored
        isArray: true
        defaultValue: Open, In Progress
        description: Get Threats of a specific status.
      - name: project
        description: Filter Threats by project.
        required: false
    outputs:
      - contextPath: Wiz.Manager.Detections.entitySnapshot
        description: All resource details.
        type: String
      - contextPath: Wiz.Manager.Detections.createdAt
        description: Detection created at.
        type: String
      - contextPath: Wiz.Manager.Detections.id
        description: Wiz Detection ID.
        type: String
      - contextPath: Wiz.Manager.Detections.url
        description: Wiz Detection URL.
        type: String
      - contextPath: Wiz.Manager.Detections.severity
        description: Wiz Detection severity.
        type: String
      - contextPath: Wiz.Manager.Detections.status
        description: Wiz Detection status.
        type: String
  dockerimage: demisto/python3:3.11.10.115186
  isfetch: true
  runonce: false
  script: '-'
  subtype: python3
  type: python
tests:
- No tests
fromversion: 6.0.0