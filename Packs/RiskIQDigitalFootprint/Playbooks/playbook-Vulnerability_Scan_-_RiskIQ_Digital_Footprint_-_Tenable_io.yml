id: Vulnerability Scan - RiskIQ Digital Footprint - Tenable.io
version: -1
name: Vulnerability Scan - RiskIQ Digital Footprint - Tenable.io
description: |-
  Performs a vulnerability scan for an asset of type "Host" and "IP Address" using Tenable.io integration.
  Supported integration:
  - Tenable.io
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: fbd56233-737f-4564-8e4d-4b847bde744b
    type: start
    task:
      id: fbd56233-737f-4564-8e4d-4b847bde744b
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "1":
    id: "1"
    taskid: 9b04197b-fe86-4695-82fb-b274867046b4
    type: condition
    task:
      id: 9b04197b-fe86-4695-82fb-b274867046b4
      version: -1
      name: Is Tenable.io integration enabled?
      description: Checks whether there is an active instance of the Tenable.io integration
        enabled.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "4"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: modules
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: modules.brand
                      iscontext: true
                    right:
                      value:
                        simple: Tenable.io
                - - operator: isEqualString
                    left:
                      value:
                        simple: modules.state
                      iscontext: true
                    right:
                      value:
                        simple: active
                accessor: brand
            iscontext: true
    view: |-
      {
        "position": {
          "x": 450,
          "y": 20
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "2":
    id: "2"
    taskid: ab875e6b-76d2-4f78-8fe2-337485b15734
    type: regular
    task:
      id: ab875e6b-76d2-4f78-8fe2-337485b15734
      version: -1
      name: Scan for vulnerabilities recorded for the given Host
      description: Get a list of up to 5000 of the vulnerabilities recorded for a
        given Host asset.
      script: '|||tenable-io-get-vulnerabilities-by-asset'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      dateRange: {}
      hostname:
        complex:
          root: inputs.asset_name
      ip: {}
    reputationcalc: 3
    continueonerror: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -390,
          "y": 390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
  "3":
    id: "3"
    taskid: 54f361dc-c5c0-4b22-84e8-55fec259c00f
    type: title
    task:
      id: 54f361dc-c5c0-4b22-84e8-55fec259c00f
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 580
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "4":
    id: "4"
    taskid: 581f6946-60d0-48c8-857d-3bcca7d22892
    type: condition
    task:
      id: 581f6946-60d0-48c8-857d-3bcca7d22892
      version: -1
      name: Is the asset a Host or IP Address?
      description: Checks if the current asset is of type Host or IP Address.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "3"
      Host:
      - "2"
      IP Address:
      - "5"
    separatecontext: false
    conditions:
    - label: Host
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: inputs.asset_type
            iscontext: true
          right:
            value:
              simple: Host
          ignorecase: true
    - label: IP Address
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: inputs.asset_type
            iscontext: true
          right:
            value:
              simple: IP Address
          ignorecase: true
    view: |-
      {
        "position": {
          "x": 200,
          "y": 210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "5":
    id: "5"
    taskid: 99d3be14-4570-4d77-8a02-90b7a0e6d23a
    type: regular
    task:
      id: 99d3be14-4570-4d77-8a02-90b7a0e6d23a
      version: -1
      name: Scan for vulnerabilities recorded for the given IP Address
      description: Get a list of up to 5000 of the vulnerabilities recorded for a
        given IP Address asset.
      script: '|||tenable-io-get-vulnerabilities-by-asset'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      dateRange: {}
      hostname: {}
      ip:
        complex:
          root: inputs.asset_name
    reputationcalc: 3
    continueonerror: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 20,
          "y": 390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
view: |-
  {
    "linkLabelsPosition": {
      "1_3_#default#": 0.36,
      "4_3_#default#": 0.52
    },
    "paper": {
      "dimensions": {
        "height": 745,
        "width": 1220,
        "x": -390,
        "y": -100
      }
    }
  }
inputs:
- key: asset_name
  value: {}
  required: true
  description: Name of the asset.
  playbookInputQuery:
- key: asset_type
  value: {}
  required: true
  description: 'Type of the asset. Possible values: Domain, Host, IP Address, IP Block,
    ASN, Page, SSL Cert, Contact.'
  playbookInputQuery:
outputs: []
fromversion: 6.0.0
tests:
- No tests (auto formatted)
