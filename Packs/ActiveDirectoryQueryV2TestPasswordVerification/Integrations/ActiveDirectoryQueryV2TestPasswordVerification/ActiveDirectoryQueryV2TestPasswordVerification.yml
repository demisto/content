category: Data Enrichment & Threat Intelligence
commonfields:
  id: Active Directory Query v2 Test Password Verification
  version: -1
configuration:
- display: Server IP address (e.g., 192.168.0.1)
  name: server_ip
  required: true
  type: 0
- display: Port. If not specified, default the port is 389, or 636 for LDAPS.
  name: port
  required: false
  type: 0
- display: Credentials
  name: credentials
  required: true
  type: 9
- display: NTLM authentication
  name: ntlm
  required: false
  type: 8
- display: Base DN (for example "dc=company,dc=com")
  name: base_dn
  required: true
  type: 0
- defaultvalue: "500"
  display: Page size
  name: page_size
  required: true
  type: 0
- defaultvalue: SSL
  display: Secure Connection
  name: secure_connection
  options:
  - None
  - SSL
  - TLS
  required: true
  type: 15
- display: Trust any certificate (not secure)
  name: unsecure
  required: false
  type: 8
- additionalinfo: Used in the IAM commands.
  defaultvalue: User Profile - Active Directory (Incoming)
  display: Incoming Mapper
  name: mapper-in
  required: true
  type: 0
- additionalinfo: Used in the IAM commands.
  defaultvalue: User Profile - Active Directory (Outgoing)
  display: Ougoing Mapper
  name: mapper-out
  required: true
  type: 0
- display: Group CN for terminated employees
  name: group-cn
  required: false
  type: 0
- additionalinfo: If true the user will be created when the passed User Profile doesn't
    exist in AD. Used in IAM commands only.
  defaultvalue: "true"
  display: Create if does not exists
  name: create-if-not-exists
  required: false
  type: 8
contentitemexportablefields:
  contentitemfields:
    fromServerVersion: ""
    itemVersion: ""
    packID: 77df1929-455b-459a-8893-1d93da1341f2
    propagationLabels:
    - all
    toServerVersion: ""
description: Active Directory Query integration enables you to access and manage Active
  Directory objects (users, contacts, and computers).
display: Active Directory Query v2 Test Password Verification
name: Active Directory Query v2 Test Password Verification
script:
  commands:
  - arguments:
    - description: The username (samAccountName) of the user to modify.
      name: username
      required: true
    - description: Root (e.g., DC=domain,DC=com)
      name: base-dn
    description: Expires the password of an Active Directory user.
    name: ad-expire-password
  - arguments:
    - description: The username (samAccountName) of the user to modify.
      name: username
      required: true
    - description: The initial password to set for the user. The user is requested
        to change the password after login.
      name: password
      required: true
    - description: The user's DN.
      name: user-dn
      required: true
    - description: The display name of the user.
      name: display-name
    - description: A short description of the user.
      name: description
    - description: User email.
      name: email
    - description: The telephone number of the user.
      name: telephone-number
    - description: The job title of the user.
      name: title
    - description: Sets basic or custom attributes of the user object. For example,
        custom-attributes="{\"notes\":\"a note about the contact\",\"company\":\"company
        name\"}"
      name: custom-attributes
    description: Creates an Active Directory user. This command requires a secure
      connection (SSL,TLS).
    name: ad-create-user
  - arguments:
    - description: 'Enables you to define search criteria in the Query Active Directory
        using Active Directory syntax. For example, the following query searches for
        all user objects, except Andy: "(&(objectCategory=person)(objectClass=user)(!(cn=andy)))".
        NOTE if you have special characters such as "*","(",or "\" the character must
        be preceded by two backslashes "\\". For example, to use "*", type "\\*".
        For more information about search filters, see syntax: https://docs.microsoft.com/en-us/windows/win32/adsi/search-filter-syntax'
      name: filter
      required: true
    - description: Root. For example, DC=domain,DC=com). By default, the Base DN configured
        for the instance is used.
      name: base-dn
    - description: CSV list of the object attributes to return. For example, "dn,memberOf".
        To return all object attributes, specify 'ALL'.
      name: attributes
    - defaultValue: "50"
      description: The maximum number of records to return.
      name: size-limit
    - description: The maximum time to pull records (in seconds).
      name: time-limit
    - auto: PREDEFINED
      defaultValue: "yes"
      description: Whether to output the search results to the context. Default is
        yes.
      name: context-output
      predefined:
      - "yes"
      - "no"
    description: Runs Active Directory queries.
    name: ad-search
    outputs:
    - contextPath: ActiveDirectory.Search.dn
      description: The distinguished names that match the query.
      type: string
    - contextPath: ActiveDirectory.Search
      description: The result of the search.
      type: unknown
  - arguments:
    - description: The username of the user to add to the group. If this argument
        is not specified, the computer name argument must be specified.
      name: username
    - description: The name of the computer to add to the group. If this argument
        is not specified, the username argument must be specified.
      name: computer-name
    - description: The name of the group for which to add the user.
      name: group-cn
      required: true
    - description: Root. For example, DC=domain,DC=com. By default, the Base DN configured
        for the instance is used.
      name: base-dn
    description: Adds an Active Directory user or computer to a group.
    name: ad-add-to-group
  - arguments:
    - description: The name of the user to remove from the group. If this argument
        is not specified, the computer name argument must be specified.
      name: username
    - description: The name of the computer to remove from the group. If this argument
        is not specified, the username argument must be specified.
      name: computer-name
    - description: The name of the group for which to remove the user.
      name: group-cn
      required: true
    - description: Root. For example, DC=domain,DC=com). By default, the Base DN configured
        for the instance is used.
      name: base-dn
    description: Removes an Active Directory user or computer from a group.
    name: ad-remove-from-group
  - arguments:
    - description: The username of the account to update (sAMAccountName).
      name: username
      required: true
    - description: The name of the attribute to modify. For example, sn, displayName,
        mail, and so on.
      name: attribute-name
      required: true
    - description: The value of the attribute for which to change.
      name: attribute-value
      required: true
    - description: Root. For example, DC=domain,DC=com. By default, the Base DN configured
        for the instance is used.
      name: base-dn
    description: Updates attributes of an existing Active Directory user.
    name: ad-update-user
  - arguments:
    - description: The DN of the user to delete.
      name: user-dn
      required: true
    description: Deletes an Active Directory user.
    name: ad-delete-user
  - arguments:
    - description: The contact's DN.
      name: contact-dn
      required: true
    - description: The contact's display name.
      name: display-name
    - description: The short description of the contact.
      name: description
    - description: The email address of the contact.
      name: email
    - description: The contact's telephone number.
      name: telephone-number
    - description: Sets basic or custom attributes of the contact object. For example,
        custom-attributes="{\"notes\":\"some note about the contact\",\"company\":\"some
        company\"}."
      name: custom-attributes
    - description: The job title of the contact.
      name: title
    description: Creates an Active Directory contact.
    name: ad-create-contact
  - arguments:
    - description: The contact's DN.
      name: contact-dn
      required: true
    - description: The attribute name to update.
      name: attribute-name
      required: true
    - description: The attribute value to be updated.
      name: attribute-value
      required: true
    description: Updates attributes of an existing Active Directory contact.
    name: ad-update-contact
  - arguments:
    - description: The username of the account to disable (sAMAccountName).
      name: username
      required: true
    - description: Root (e.g., DC=domain,DC=com). By default, the Base DN configured
        for the instance is used.
      name: base-dn
    description: Disables an Active Directory user account.
    name: ad-disable-account
  - arguments:
    - description: The username of the account to enable (sAMAccountName).
      name: username
      required: true
    - description: Root. For example, DC=domain,DC=com). By default, the Base DN configured
        for the instance is used.
      name: base-dn
    description: Enables a previously disabled Active Directory account.
    name: ad-enable-account
  - arguments:
    - description: The username of the account to unlock (sAMAccountName).
      name: username
      required: true
    - description: Root. For example, DC=domain,DC=com. By default, the Base DN configured
        for the instance is used.
      name: base-dn
    description: Unlocks a previously locked Active Directory user account.
    name: ad-unlock-account
  - arguments:
    - description: The username of the account to disable (sAMAccountName).
      name: username
      required: true
    - description: The password to set for the user.
      name: password
      required: true
    - description: Root. For example, DC=domain,DC=com. Base DN configured for the
        instance is used as default.
      name: base-dn
    description: Sets a new password for an Active Directory user. This command requires
      a secure connection (SSL,TLS).
    name: ad-set-new-password
  - arguments:
    - description: The name of the computer to modify.
      name: computer-name
      required: true
    - description: Superior DN. For example, OU=computers,DC=domain,DC=com (the specified
        domain must be the same as the current computer domain).
      name: full-superior-dn
    description: Modifies the computer organizational unit within a domain.
    name: ad-modify-computer-ou
  - arguments:
    - default: true
      description: The Distinguished Name of the user in which to return information.
      name: dn
    - description: The name of the user to return information.
      name: name
    - description: Adds AD attributes of the resulting objects to the default attributes.
      name: attributes
    - description: Queries users by custom field type.
      name: custom-field-type
    - description: Queries users by custom field data (relevant only if the `custom-field-type`
        argument is provided).
      name: custom-field-data
    - description: Queries users by the samAccountName attribute.
      name: username
    - description: Queries users by the samAccountName attribute.
      name: sAMAccountName
    - defaultValue: "20"
      description: The maximum number of objects to return. Default is 20.
      name: limit
    - description: Queries by the user's email address.
      name: email
    - auto: PREDEFINED
      defaultValue: "false"
      description: Whether to include verbose translation for UserAccountControl flags.
        Default is false.
      name: user-account-control-out
      predefined:
      - "true"
      - "false"
    description: Retrieves detailed information about a user account. The user can
      be specified by name, email address, or as an Active Directory Distinguished
      Name (DN). If no filter is specified, all users are returned.
    name: ad-get-user
    outputs:
    - contextPath: ActiveDirectory.Users.dn
      description: The distinguished name of the user.
      type: string
    - contextPath: ActiveDirectory.Users.displayName
      description: The display name of the user.
      type: string
    - contextPath: ActiveDirectory.Users.name
      description: The common name of the user.
      type: string
    - contextPath: ActiveDirectory.Users.sAMAccountName
      description: The sAMAccountName of the user.
      type: string
    - contextPath: ActiveDirectory.Users.userAccountControl
      description: The account control flag of the user.
      type: number
    - contextPath: ActiveDirectory.Users.mail
      description: The email address of the user.
      type: string
    - contextPath: ActiveDirectory.Users.manager
      description: The manager of the user.
      type: string
    - contextPath: ActiveDirectory.Users.memberOf
      description: Groups for which the user is a member.
      type: string
    - contextPath: Account.DisplayName
      description: The display name of the user.
      type: string
    - contextPath: Account.Groups
      description: Groups for which the user is a member.
      type: string
    - contextPath: Account.Manager
      description: The manager of the user.
      type: string
    - contextPath: Account.ID
      description: The distinguished name of the user.
      type: string
    - contextPath: Account.Username
      description: The samAccountName of the user.
      type: string
    - contextPath: Account.Email
      description: The email address of the user.
      type: string
  - arguments:
    - description: The computer's DN.
      name: dn
    - description: The name of the computer for which to return information.
      name: name
    - description: Adds AD attributes of the resulting objects to the default attributes.
      name: attributes
    - description: Search computers by custom field data (relevant only if the `customFieldType`
        argument is provided).
      name: custom-field-data
    - description: Search the computer by custom field type.
      name: custom-field-type
    description: Retrieves detailed information about a computer account. The computer
      can be specified by name, email address, or as an Active Directory Distinguished
      Name (DN). If no filters are provided, all computers are returned.
    name: ad-get-computer
    outputs:
    - contextPath: ActiveDirectory.Computers.dn
      description: The distinguished name of the computer.
    - contextPath: ActiveDirectory.Computers.memberOf
      description: Groups for which the computer is listed.
    - contextPath: ActiveDirectory.Computers.name
      description: The name of the computer.
    - contextPath: Endpoint.ID
      description: The DN of the computer.
    - contextPath: Endpoint.Hostname
      description: The name of the computer.
    - contextPath: Endpoint.Groups
      description: Groups for which the computer is listed as a member.
  - arguments:
    - description: The Distinguished Name of the Group's Active Directory.
      name: group-dn
      required: true
    - auto: PREDEFINED
      defaultValue: person
      description: 'The type of members to search. Can be: "Person", or "computer".
        Default is person.'
      name: member-type
      predefined:
      - person
      - computer
      - group
      required: true
    - description: CSV list of attributes to include in the results, in addition to
        the default attributes.
      name: attributes
    - defaultValue: "180"
      description: Time limit (in seconds) for the search to run.
      name: time_limit
    - auto: PREDEFINED
      defaultValue: "false"
      description: Disable recursive retrieval of group memberships of a user.
      name: disable-nested-search
      predefined:
      - "false"
      - "true"
    - defaultValue: '*'
      description: Queries results by the samAccountName attribute.
      name: sAMAccountName
    description: Retrieves the list of users or computers that are members of the
      specified group.
    name: ad-get-group-members
    outputs:
    - contextPath: ActiveDirectory.Groups.dn
      description: The DN of the group.
      type: string
    - contextPath: ActiveDirectory.Groups.members.dn
      description: The DN of the group member.
      type: string
    - contextPath: ActiveDirectory.Groups.members.category
      description: The category of the group members.
      type: string
  - arguments:
    - description: The Active Directory name of the group.
      name: name
      required: true
    - auto: PREDEFINED
      description: 'The type of group. Can be: "security", or "distribution".'
      name: group-type
      predefined:
      - security
      - distribution
      required: true
    - description: The Full Distinguished Name (DN) of the group. Use double quotes
        ("") rather than single quotes ('') when initializing this command.
      name: dn
      required: true
    - description: The Full DN Of users or groups that will be members of the newly
        created group.
      isArray: true
      name: members
    description: Creates a new security or distribution Active Directory group.
    execution: true
    name: ad-create-group
  - arguments:
    - description: The Active Directory Distinguished Name (DN) of the group.
      name: dn
      required: true
    description: Deletes an existing Active Directory security or distribution group.
    execution: true
    name: ad-delete-group
  - arguments:
    - description: A User Profile indicator that contains user information, such as
        name, email address, etc.
      name: user-profile
      required: true
    - auto: PREDEFINED
      defaultValue: "true"
      description: When set to true, after the command execution the status of the
        user in the 3rd-party integration will be active.
      name: allow-enable
      predefined:
      - "true"
      - "false"
    description: Creates an Active Directory user. This command requires a secure
      connection (SSL,TLS).
    name: iam-create-user
    outputs:
    - contextPath: IAM.UserProfile
      description: The user's profile.
      type: Unknown
    - contextPath: IAM.Vendor.active
      description: If true the employee's status is active, otherwise false.
      type: Boolean
    - contextPath: IAM.Vendor.brand
      description: Name of the integration.
      type: String
    - contextPath: IAM.Vendor.details
      description: Gives the user information if the API was successful, otherwise
        error information.
      type: Unknown
    - contextPath: IAM.Vendor.email
      description: The employee's email address.
      type: String
    - contextPath: IAM.Vendor.errorCode
      description: HTTP error response code.
      type: Number
    - contextPath: IAM.Vendor.errorMessage
      description: Reason why the API failed.
      type: String
    - contextPath: IAM.Vendor.id
      description: The employee's user ID in the app.
      type: String
    - contextPath: IAM.Vendor.instanceName
      description: Name of the integration instance.
      type: Unknown
    - contextPath: IAM.Vendor.success
      description: If true, the command was executed successfully, otherwise false.
      type: Boolean
    - contextPath: IAM.Vendor.username
      description: The employee's username in the app.
      type: String
    - contextPath: IAM.Vendor.action
      description: The command name.
      type: String
  - arguments:
    - description: A User Profile indicator that contains user information, such as
        name, email address, etc.
      name: user-profile
      required: true
    description: Retrieves a single user resource.
    name: iam-get-user
    outputs:
    - contextPath: IAM.UserProfile
      description: The user's profile.
      type: Unknown
    - contextPath: IAM.Vendor.active
      description: If true the employee's status is active, otherwise false.
      type: Boolean
    - contextPath: IAM.Vendor.brand
      description: Name of the integration.
      type: String
    - contextPath: IAM.Vendor.details
      description: Gives the user information if the API was successful, otherwise
        error information.
      type: Unknown
    - contextPath: IAM.Vendor.email
      description: The employee's email address.
      type: String
    - contextPath: IAM.Vendor.errorCode
      description: HTTP error response code.
      type: Number
    - contextPath: IAM.Vendor.errorMessage
      description: Reason why the API failed.
      type: String
    - contextPath: IAM.Vendor.id
      description: The employee's user ID in the app.
      type: String
    - contextPath: IAM.Vendor.instanceName
      description: Name of the integration instance.
      type: Unknown
    - contextPath: IAM.Vendor.success
      description: If true the command was executed successfully, otherwise false.
      type: Boolean
    - contextPath: IAM.Vendor.username
      description: The employee's username in the app.
      type: String
    - contextPath: IAM.Vendor.action
      description: The command name.
      type: String
  - arguments:
    - description: A User Profile indicator that contains user information, such as
        name, email address, etc.
      name: user-profile
      required: true
    - auto: PREDEFINED
      defaultValue: "true"
      description: When set to true, after the command execution the status of the
        user in the 3rd-party integration will be active.
      name: allow-enable
      predefined:
      - "true"
      - "false"
    description: Updates an existing user with the data in the User Profile indicator
      that is passed in the user-profile argument.
    name: iam-update-user
    outputs:
    - contextPath: IAM.UserProfile
      description: The user's profile
      type: Unknown
    - contextPath: IAM.Vendor.active
      description: Gives the active status of user. Can be true of false
      type: Boolean
    - contextPath: IAM.Vendor.brand
      description: Name of the Integration
      type: String
    - contextPath: IAM.Vendor.details
      description: Gives the user information if the API was successful, otherwise
        error information.
      type: Unknown
    - contextPath: IAM.Vendor.email
      description: The employee's email address.
      type: String
    - contextPath: IAM.Vendor.errorCode
      description: HTTP error response code.
      type: Number
    - contextPath: IAM.Vendor.errorMessage
      description: Reason why the API failed.
      type: String
    - contextPath: IAM.Vendor.id
      description: The employee's user ID in the app.
      type: String
    - contextPath: IAM.Vendor.instanceName
      description: Name of the integration instance.
      type: Unknown
    - contextPath: IAM.Vendor.success
      description: If true, the command was executed successfully, otherwise false.
      type: Boolean
    - contextPath: IAM.Vendor.username
      description: The employee's username in the app.
      type: String
    - contextPath: IAM.Vendor.action
      description: The command name.
      type: String
  - arguments:
    - description: A User Profile indicator that contains user information, such as
        name, email address, etc.
      name: user-profile
      required: true
    description: Disables a user.
    execution: true
    name: iam-disable-user
    outputs:
    - contextPath: IAM.UserProfile
      description: The user's profile
      type: Unknown
    - contextPath: IAM.Vendor.active
      description: Gives the active status of user. Can be true of false
      type: Boolean
    - contextPath: IAM.Vendor.brand
      description: Name of the Integration
      type: String
    - contextPath: IAM.Vendor.details
      description: Gives the user information if the API was successful, otherwise
        error information.
      type: Unknown
    - contextPath: IAM.Vendor.email
      description: The employee's email address.
      type: String
    - contextPath: IAM.Vendor.errorCode
      description: HTTP error response code.
      type: Number
    - contextPath: IAM.Vendor.errorMessage
      description: Reason why the API failed.
      type: String
    - contextPath: IAM.Vendor.id
      description: The employee's user ID in the app.
      type: String
    - contextPath: IAM.Vendor.instanceName
      description: Name of the integration instance.
      type: Unknown
    - contextPath: IAM.Vendor.success
      description: If true, the command was executed successfully, otherwise false.
      type: Boolean
    - contextPath: IAM.Vendor.username
      description: The employee's username in the app.
      type: String
    - contextPath: IAM.Vendor.action
      description: The command name.
      type: String
  - arguments: []
    description: Retrieves a User Profile schema which holds all of the user fields
      within the application. Used for outgoing-mapping through the Get Schema option.
    name: get-mapping-fields
  - arguments:
    - name: username
      required: true
    - name: password
    description: Runs a command to test an array of credentials
    name: test-credentials
    outputs:
    - contextPath: Credentials.username
      description: ""
      type: string
  dockerimage: demisto/ldap:1.0.0.23980
  ismappable: true
  isremotesyncout: true
  runonce: false
  script: ''
  subtype: python3
  type: python
sourcemoduleid: Active Directory Query v2
