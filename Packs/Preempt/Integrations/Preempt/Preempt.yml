commonfields:
  id: Preempt
  version: -1
name: Preempt
display: Preempt
category: Network Security
description: Preempt Behavioral Firewall - Detection and enforcement based on user
  identity
configuration:
- display: Address of Preempt server (e.g. https://192.168.0.1)
  name: server
  defaultvalue: https://
  type: 0
  required: true
- display: API Key
  name: apiKey
  defaultvalue: ""
  type: 4
  required: true
- display: Fetch incidents
  name: isFetch
  type: 8
  required: false
- display: Incident type
  name: incidentType
  type: 13
  required: false
- display: Days to look back
  name: lookback
  defaultvalue: "1"
  type: 0
  required: true
- display: Trust any certificate (not secure)
  name: insecure
  defaultvalue: ""
  type: 8
  required: false
- display: Use system proxy settings
  name: proxy
  defaultvalue: ""
  type: 8
  required: false
script:
  script: ''
  type: python
  subtype: python2
  commands:
  - name: preempt-add-to-watch-list
    arguments:
    - name: accountObjectGuid
      description: Object GUID of the AD account
    description: Adds requested user to Preempt's watch list
  - name: preempt-remove-from-watch-list
    arguments:
    - name: accountObjectGuid
      description: Object GUID of the AD account
    description: Removes requested user from Preempt's watch list
  - name: preempt-get-activities
    arguments:
    - name: sourceUserId
      required: true
      description: ID of a user whose activities to retrieve
    - name: types
      description: List of specific incident types (comma delimited)
      defaultValue: LOGIN
    - name: endTime
      description: End of the timeframe to search in
    - name: numOfHours
      default: true
      description: Number of hours to look back from end time
      defaultValue: "48"
    outputs:
    - contextPath: Preempt.Activities.EndpointHostName
      description: Hostname of the activity's endpoint
      type: string
    - contextPath: Preempt.Activities.EventType
      description: Type of the activity
      type: string
    - contextPath: Preempt.Activities.AuthenticationType
      description: For authentication, specific type
      type: string
    - contextPath: Preempt.Activities.Timestamp
      description: Date/time of the activity
      type: date
    - contextPath: Preempt.Activities.Cursor
      description: Cursor of last retrieved activity for pagination
      type: string
    description: Get activities from a time frame
  - name: preempt-get-user-endpoints
    arguments:
    - name: sourceUserId
      required: true
      description: ID of the user
    outputs:
    - contextPath: Endpoint.Hostname
      description: Hostname of the endpoint
      type: string
    - contextPath: Endpoint.ID
      description: Object GUID of the computer account
      type: string
    - contextPath: Endpoint.PrimaryDisplayName
      description: The computer's display name in AD
      type: string
    - contextPath: Endpoint.IsOwnedByUser
      description: True if the user owns this endpoint
      type: boolean
    - contextPath: Endpoint.IPAddress
      description: The last IP address associated with this endpoint seen by the system
      type: string
    - contextPath: Endpoint.StaticIpAddresses
      description: Static IP addresses which have been associated with the endpoint
      type: string
    description: Gets the endpoints regularly used by the user account
  - name: preempt-get-alerts
    arguments:
    - name: sourceUserId
      description: ID of the user associated with the alerts
    - name: numOfHours
      description: Number of hours to look back from end time
      defaultValue: "48"
    - name: endTime
      description: End of time frame to look in
    outputs:
    - contextPath: Preempt.Alerts.AlertType
      description: Type of the Alert
      type: string
    - contextPath: Preempt.Alerts.timestamp
      description: Date/time of the activity
      type: date
    - contextPath: Preempt.Alerts.startTime
      description: Date/time of beginning of the alert
      type: date
    - contextPath: Preempt.Alerts.EndTime
      description: Date/time when the alert was ended
      type: date
    - contextPath: Preempt.Alerts.eventLabel
      description: The label of the alert
      type: string
    - contextPath: Preempt.Alerts.Cursor
      description: Cursor of last retrieved activity for pagination
    description: Get the alerts generated according to given arguments
  isfetch: true
  dockerimage: demisto/python:2.7.18.19851
fromversion: 5.0.0
tests:
- No tests (auto formatted)
