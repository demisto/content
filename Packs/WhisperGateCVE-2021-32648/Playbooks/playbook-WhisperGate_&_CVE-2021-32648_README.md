On January 14th, 2022, reports began on a malware operation dubbed "WhisperGate" targeting multiple organizations in Ukraine.
CVE-2021-32648 vulnerability has a CVSS score of 9.1 and was found in octobercms, which is a CMS platform based on the Laravel PHP Framework. 
In affected versions of the october/system package an attacker can request an account password reset and then gain access to the account using a specially crafted request. 
The issue has been patched in Build 472 and v1.1.5.

**The playbook includes the following tasks:**
- Collect related known indicators from Malware News blog.
- Indicators hunting using PAN-OS and SIEM products.
- Block indicators automatically or manually.

**Mitigations:**
* October CMS security recommendation.
* Deploy YARA detection Rules.

More information:
[Microsoft Blog](https://www.microsoft.com/security/blog/2022/01/15/destructive-malware-targeting-ukrainian-organizations/)
[CVE-2021-32648 NVD](https://nvd.nist.gov/vuln/detail/CVE-2021-32648#vulnCurrentDescriptionTitle)
[October security recommendation](https://github.com/octobercms/october/security/advisories/GHSA-mxr5-mc97-63rc)

Note: This is a beta playbook, which lets you implement and test pre-release software. Since the playbook is beta, it might contain bugs. Updates to the pack during the beta phase might include non-backward compatible features. We appreciate your feedback on the quality and usability of the pack to help us identify issues, fix them, and continually improve.

## Dependencies
This playbook uses the following sub-playbooks, integrations, and scripts.

### Sub-playbooks
* Threat Hunting - Generic
* Block Indicators - Generic v2
* Panorama Query Logs
* Rapid Breach Response - Set Incident Info

### Scripts
* ParseHTMLIndicators
* http

### Commands
* closeInvestigation
* extractIndicators
* createNewIndicator

## Playbook Inputs
---

| **Name** | **Description** | **Default Value** | **Required** |
| --- | --- | --- | --- |
| PlaybookDescription | The playbook description for Rapid Breach Response layout. | WhisperGate &amp; CVE-2021-32648<br/><br/>Beginning on January 14th, 2022, reports began emerging about a series of attacks targeting numerous Ukrainian government websites. As a result of these attacks, numerous government websites were found to be either defaced or inaccessible. Subsequently, a day later, public reporting outlined a new malware family, called ‘WhisperGate,’ that originally was observed on January 13th, 2022. This malware family is destructive in nature and was discovered to target multiple organizations in Ukraine.<br/><br/>The CVE-2021-32648 vulnerability lies within the OctoberCMS platform prior to version 1.0.472 and results in an attacker gaining access to any account via a specially crafted account password reset request. This vulnerability is believed to have allowed threat actors to gain access to the underlying websites leveraged by the Ukraine government.<br/><br/>**Affected Version**<br/><br/>OctoberCMS prior to Build 472 and v1.1.5 and the web server must be running PHP below 7.4<br/><br/>**The playbook includes the following tasks:**<br/><br/>* Collect related known indicators from Malware News blog.<br/>* Indicators hunting using PAN-OS and SIEM products.<br/>* Search for possible vulnerable servers using Xpanse.<br/>* Block indicators automatically or manually.<br/><br/>**Mitigations:**<br/>* Apache official CVE-2021-44228 patch.<br/>* Deploy YARA detection Rules.<br/><br/>More information:<br/>[Microsoft Blog](https://www.microsoft.com/security/blog/2022/01/15/destructive-malware-targeting-ukrainian-organizations/)<br/>[CVE-2021-32648 NVD](https://nvd.nist.gov/vuln/detail/CVE-2021-32648#vulnCurrentDescriptionTitle)<br/><br/>Note: This is a beta playbook, which lets you implement and test pre-release software. Since the playbook is beta, it might contain bugs. Updates to the pack during the beta phase might include non-backward compatible features. We appreciate your feedback on the quality and usability of the pack to help us identify issues, fix them, and continually improve. | Optional |
| BlockIndicatorsAutomatically | Whether to block the indicators automatically or not. | False | Optional |
| CollectedIndicatorsSeverity | The verdict of the collected indicators. Default is "Malicious". <br/>Other options can be "Suspicious" and "Unknown". | Malicious | Optional |
| RelatedCVE | The WhisperGate malware related CVE. | CVE-2021-32648 | Optional |

## Playbook Outputs
---
There are no outputs for this playbook.

## Playbook Image
---
![WhisperGate & CVE-2021-32648](https://raw.githubusercontent.com/demisto/content/6c39eb13f8dc8933178ce4361ce3db3e7bfc6d90/Packs/WhisperGateCVE-2021-32648/doc_files/WhisperGate_%26_CVE-2021-32648.png)