description: Request file download from Tanium Threat Response v2.
id: Tanium Threat Response - Request File Download v2
inputs:
- description: Path of file.
  key: path
  playbookInputQuery: null
  required: true
  value: {}
- description: If true, the file will be downloaded, otherwise, only a file download
    object will be created.
  key: download-file
  playbookInputQuery: null
  required: false
  value: {}
- description: If true, the connection will be deleted in the end of the playbook,
    otherwise, it will remain open.
  key: delete-connection
  playbookInputQuery: null
  required: false
  value: {}
- description: |
    Client id. Use `tanium-tr-get-system-status` to get all possible client_ids.
  key: client-id
  playbookInputQuery: null
  required: true
  value: {}
- description: Hostname of the computer to connect. Use `tanium-tr-get-system-status`
    to get all possible hostnames.
  key: hostname
  playbookInputQuery: null
  required: true
  value: {}
- description: IP address to connect. Use `tanium-tr-get-system-status` to get all
    possible ips.
  key: ip
  playbookInputQuery: null
  required: true
  value: {}
- description: Computers platform - "Windows", "Linux", etc.
  key: platform
  playbookInputQuery: null
  required: true
  value: {}
name: Tanium Threat Response - Request File Download v2
outputs:
- contextPath: File
  description: Downloaded file information
  type: unknown
starttaskid: "0"
tasks:
  "0":
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8cc20976-5d60-4397-895a-21b1c37ccbb6
      iscommand: false
      name: ""
      version: -1
    taskid: 8cc20976-5d60-4397-895a-21b1c37ccbb6
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 50
        }
      }
  "1":
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      connection_id:
        simple: ${Tanium.Connection.id}
      path:
        simple: ${inputs.path}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Tanium Threat Response v2
      description: Requests a new file download.
      id: 2ce9453b-a7c3-4c3a-8d19-82201b644806
      iscommand: true
      name: tanium-tr-request-file-download
      script: Tanium Threat Response v2|||tanium-tr-request-file-download
      type: regular
      version: -1
    taskid: 2ce9453b-a7c3-4c3a-8d19-82201b644806
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 370
        }
      }
  "3":
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ba215b96-187d-4d1b-8b69-6e9e70f133c6
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: ba215b96-187d-4d1b-8b69-6e9e70f133c6
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1595
        }
      }
  "5":
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      connection_id:
        simple: ${Tanium.Connection.id}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Tanium Threat Response v2
      description: Deletes a connection by connection id.
      id: 79834fd7-c1df-402a-8350-f85e037531a4
      iscommand: true
      name: tanium-tr-delete-connection
      script: Tanium Threat Response v2|||tanium-tr-delete-connection
      type: regular
      version: -1
    taskid: 79834fd7-c1df-402a-8350-f85e037531a4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1420
        }
      }
  "8":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.delete-connection
          operator: isEqualString
          right:
            value:
              simple: "true"
      label: "yes"
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "5"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: If true, the connection will be deleted in the end of the playbook,
        otherwise, it will remain open.
      id: c5c89b06-f970-42e1-87a4-bb37d09cdd4c
      iscommand: false
      name: Delete connection?
      type: condition
      version: -1
    taskid: c5c89b06-f970-42e1-87a4-bb37d09cdd4c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1245
        }
      }
  "9":
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      file_id:
        complex:
          accessor: uuid
          filters:
          - - left:
                iscontext: true
                value:
                  simple: Tanium.FileDownload.path
              operator: isEqualString
              right:
                value:
                  simple: C:\Windows\System32\AtBroker.exe
          root: Tanium.FileDownload
    separatecontext: false
    skipunavailable: false
    task:
      brand: Tanium Threat Response v2
      description: 'Gets the actual content of a downloaded file by file ID. Downloaded
        file password: `infected`.'
      id: 25a78f99-4dd4-4e33-82be-8f017651aabe
      iscommand: true
      name: Get downloaded file
      script: Tanium Threat Response v2|||tanium-tr-get-downloaded-file
      type: regular
      version: -1
    taskid: 25a78f99-4dd4-4e33-82be-8f017651aabe
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1070
        }
      }
  "10":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.download-file
          operator: isEqualString
          right:
            value:
              simple: "true"
      label: "yes"
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "8"
      "yes":
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: If true, the file will be downloaded, otherwise, only a file download
        object will be created.
      id: a15fedb0-d502-4493-81e4-59bc33851168
      iscommand: false
      name: Should the file be downloaded?
      type: condition
      version: -1
    taskid: a15fedb0-d502-4493-81e4-59bc33851168
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 825
        }
      }
  "15":
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    scriptarguments:
      client-id:
        simple: ${inputs.client-id}
      hostname:
        simple: ${inputs.hostname}
      ip:
        simple: ${inputs.ip}
      platform:
        simple: ${inputs.platform}
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: Creates a connection to a remote destination from Tanium Threat
        Response v2
      id: c818398a-e4e1-4cd5-8170-a93ccd138ebb
      iscommand: false
      name: Tanium Threat Response - Create Connection v2
      playbookId: Tanium Threat Response - Create Connection v2
      type: playbook
      version: -1
    taskid: c818398a-e4e1-4cd5-8170-a93ccd138ebb
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 190
        }
      }
  "17":
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns all downloaded files in the system.
      id: 47f9c483-024a-4f7e-8bed-57b7dd29814d
      iscommand: true
      name: tanium-tr-list-file-downloads
      script: '|||tanium-tr-list-file-downloads'
      type: regular
      version: -1
    taskid: 47f9c483-024a-4f7e-8bed-57b7dd29814d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 600
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1610,
        "width": 492.5,
        "x": 50,
        "y": 50
      }
    }
  }
fromversion: "6.0.0"
tests:
- Tanium Threat Response - Request File Download v2 - Test