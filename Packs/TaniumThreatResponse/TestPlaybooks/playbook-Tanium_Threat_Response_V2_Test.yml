id: Tanium Threat Response V2 Test
version: 10
vcShouldKeepItemLegacyProdMachine: false
name: Tanium Threat Response V2 Test
description: Test playbook
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 927f8fc7-2a7f-4763-8d1d-7ee4cfa15df6
    type: start
    task:
      id: 927f8fc7-2a7f-4763-8d1d-7ee4cfa15df6
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2312.5,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 5b60cb48-5545-4775-883b-53b85dce164c
    type: regular
    task:
      id: 5b60cb48-5545-4775-883b-53b85dce164c
      version: -1
      name: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "6"
      - "77"
      - "23"
      - "4"
      - "85"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2312.5,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: 44b9fbac-6658-43c0-8145-c04bc549f78e
    type: regular
    task:
      id: 44b9fbac-6658-43c0-8145-c04bc549f78e
      version: -1
      name: tanium-tr-get-intel-doc-by-id
      script: Tanium Threat Response v2|||tanium-tr-get-intel-doc-by-id
      type: regular
      iscommand: true
      brand: Tanium Threat Response v2
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      intel_doc_id:
        simple: ${Tanium.IntelDoc.ID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 3172.5,
          "y": 2640
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 1fb8058d-7c7a-4118-89c3-d5b383907d4a
    type: condition
    task:
      id: 1fb8058d-7c7a-4118-89c3-d5b383907d4a
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "63"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.IntelDoc.AlertCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.IntelDoc.CreatedAt
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.IntelDoc.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.IntelDoc.Name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.IntelDoc.UnresolvedAlertCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.IntelDoc.UpdatedAt
            iscontext: true
    view: |-
      {
        "position": {
          "x": 3172.5,
          "y": 2820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 35a2bd79-54ee-4ab5-8f94-b6e367ae6868
    type: regular
    task:
      id: 35a2bd79-54ee-4ab5-8f94-b6e367ae6868
      version: -1
      name: tanium-tr-list-intel-docs
      script: Tanium Threat Response v2|||tanium-tr-list-intel-docs
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 3172.5,
          "y": 1095
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: fa5563e2-81e0-4b6c-8835-4a056b65b836
    type: condition
    task:
      id: fa5563e2-81e0-4b6c-8835-4a056b65b836
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "92"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.IntelDoc.AlertCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.IntelDoc.CreatedAt
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.IntelDoc.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.IntelDoc.Name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.IntelDoc.UnresolvedAlertCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.IntelDoc.UpdatedAt
            iscontext: true
    view: |-
      {
        "position": {
          "x": 3172.5,
          "y": 1260
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 3911baf6-6015-44c8-8125-d888fc87c0a5
    type: regular
    task:
      id: 3911baf6-6015-44c8-8125-d888fc87c0a5
      version: -1
      name: tanium-tr-list-alerts
      script: Tanium Threat Response v2|||tanium-tr-list-alerts
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2312.5,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: 02b41429-7339-4cb0-84b7-c670e2e29066
    type: condition
    task:
      id: 02b41429-7339-4cb0-84b7-c670e2e29066
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "8"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Alert.Priority
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Alert.ComputerName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Alert.GUID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Alert.AlertedAt
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Alert.UpdatedAt
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Alert.State
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Alert.ComputerIpAddress
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Alert.Type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Alert.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Alert.CreatedAt
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Alert.IntelDocId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Alert.Severity
            iscontext: true
    view: |-
      {
        "position": {
          "x": 2312.5,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 74fb8acd-bdb2-42ff-8969-9eb037339c52
    type: regular
    task:
      id: 74fb8acd-bdb2-42ff-8969-9eb037339c52
      version: -1
      name: tanium-tr-get-alert-by-id
      script: Tanium Threat Response v2|||tanium-tr-get-alert-by-id
      type: regular
      iscommand: true
      brand: Tanium Threat Response v2
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      alert_id:
        simple: ${Tanium.Alert.ID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2312.5,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: bc562c7b-d847-44be-881c-111241bdeece
    type: condition
    task:
      id: bc562c7b-d847-44be-881c-111241bdeece
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "10"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Alert.Priority
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Alert.ComputerName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Alert.GUID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Alert.AlertedAt
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Alert.UpdatedAt
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Alert.State
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Alert.ComputerIpAddress
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Alert.Type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Alert.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Alert.CreatedAt
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Alert.IntelDocId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Alert.Severity
            iscontext: true
    view: |-
      {
        "position": {
          "x": 2312.5,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: b6b1d6d8-fb66-473c-8904-a49a603f6b46
    type: regular
    task:
      id: b6b1d6d8-fb66-473c-8904-a49a603f6b46
      version: -1
      name: tanium-tr-alert-update-state
      script: Tanium Threat Response v2|||tanium-tr-alert-update-state
      type: regular
      iscommand: true
      brand: Tanium Threat Response v2
    nexttasks:
      '#none#':
      - "47"
    scriptarguments:
      alert_ids:
        simple: ${Tanium.Alert.ID}
      state:
        simple: unresolved
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2312.5,
          "y": 2820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: a871b056-d769-46a3-85a0-454ceebc1ca5
    type: regular
    task:
      id: a871b056-d769-46a3-85a0-454ceebc1ca5
      version: -1
      name: tanium-tr-create-snapshot
      script: Tanium Threat Response v2|||tanium-tr-create-snapshot
      type: regular
      iscommand: true
      brand: Tanium Threat Response v2
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      connection_id:
        complex:
          root: Tanium.Connection
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: Tanium.Connection.status
                iscontext: true
              right:
                value:
                  simple: connected
          accessor: id
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: 6ec8f53e-eb7e-4901-808c-69c21e798b28
    type: condition
    task:
      id: 6ec8f53e-eb7e-4901-808c-69c21e798b28
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "22"
      "yes":
      - "75"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.SnapshotTask.connection
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.SnapshotTask.taskId
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 7977db68-8bd9-4607-8a18-8ed14e769a4f
    type: regular
    task:
      id: 7977db68-8bd9-4607-8a18-8ed14e769a4f
      version: -1
      name: tanium-tr-list-snapshots
      script: Tanium Threat Response v2|||tanium-tr-list-snapshots
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: ba32354f-6009-4895-8082-6074e6224b27
    type: condition
    task:
      id: ba32354f-6009-4895-8082-6074e6224b27
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "11"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Snapshot.size
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Snapshot.created
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Snapshot.completed
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Snapshot.name
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: Tanium.Snapshot.isUpload
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Snapshot.evidenceType
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Snapshot.hostname
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Snapshot.connectionId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Snapshot.recorderVersion
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Snapshot.uuid
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: 125647d9-e4e5-4b6f-85ab-7cb9742e7edd
    type: regular
    task:
      id: 125647d9-e4e5-4b6f-85ab-7cb9742e7edd
      version: -1
      name: tanium-tr-list-connections
      script: Tanium Threat Response v2|||tanium-tr-list-connections
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "18"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1882.5,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: 45b70532-dc2c-4b48-8347-d531f1878fcf
    type: condition
    task:
      id: 45b70532-dc2c-4b48-8347-d531f1878fcf
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "27"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Connection.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Connection.initiatedAt
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Connection.hostname
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Connection.status
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Connection.platform
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Connection.ip
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Connection.connectedAt
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Connection.message
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Connection.personaId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Connection.clientId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Connection.userId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Connection.hasTools
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1882.5,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: bf5e6411-5c3c-4fa1-81bb-1ba1f63647bd
    type: condition
    task:
      id: bf5e6411-5c3c-4fa1-81bb-1ba1f63647bd
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "84"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Connection.id
            iscontext: true
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: 4ebdc894-1d83-4b0e-8b3d-2d450b3d16c0
    type: regular
    task:
      id: 4ebdc894-1d83-4b0e-8b3d-2d450b3d16c0
      version: -1
      name: tanium-tr-delete-connection
      script: Tanium Threat Response v2|||tanium-tr-delete-connection
      type: regular
      iscommand: true
      brand: Tanium Threat Response v2
    nexttasks:
      '#none#':
      - "79"
    scriptarguments:
      connection_id:
        complex:
          root: Tanium.Connection
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: Tanium.Connection.status
                iscontext: true
              right:
                value:
                  simple: connected
          accessor: id
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 3870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: b9fe75f8-3981-48b8-8648-a8eb3f87ab09
    type: regular
    task:
      id: b9fe75f8-3981-48b8-8648-a8eb3f87ab09
      version: -1
      name: tanium-tr-close-connection
      script: Tanium Threat Response v2|||tanium-tr-close-connection
      type: regular
      iscommand: true
      brand: Tanium Threat Response v2
    nexttasks:
      '#none#':
      - "21"
    scriptarguments:
      connection_id:
        complex:
          root: Tanium.Connection
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: Tanium.Connection.status
                iscontext: true
              right:
                value:
                  simple: connected
          accessor: id
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 3695
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: 740999d0-60d1-47fd-8f32-a1f8f7d595b5
    type: regular
    task:
      id: 740999d0-60d1-47fd-8f32-a1f8f7d595b5
      version: -1
      name: tanium-tr-list-labels
      script: Tanium Threat Response v2|||tanium-tr-list-labels
      type: regular
      iscommand: true
      brand: Tanium Threat Response v2
    nexttasks:
      '#none#':
      - "24"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1882.5,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: 7093019b-6b0a-4107-87cb-aaa9e87e7296
    type: condition
    task:
      id: 7093019b-6b0a-4107-87cb-aaa9e87e7296
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "25"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Label.createdAt
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Label.description
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Label.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Label.indicatorCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Label.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Label.signalCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Label.updatedAt
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1882.5,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "25":
    id: "25"
    taskid: fa27358a-f1e9-463d-8b97-ec156e2e34f9
    type: regular
    task:
      id: fa27358a-f1e9-463d-8b97-ec156e2e34f9
      version: -1
      name: tanium-tr-get-label-by-id
      script: Tanium Threat Response v2|||tanium-tr-get-label-by-id
      type: regular
      iscommand: true
      brand: Tanium Threat Response v2
    nexttasks:
      '#none#':
      - "26"
    scriptarguments:
      label_id:
        simple: ${Tanium.Label.id}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1882.5,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: 78a3c4e7-f814-4b6c-8e49-b0570dbde53a
    type: condition
    task:
      id: 78a3c4e7-f814-4b6c-8e49-b0570dbde53a
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "17"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Label.createdAt
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Label.description
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Label.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Label.indicatorCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Label.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Label.signalCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Label.updatedAt
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1882.5,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: 3ab1983e-4003-4cd2-8aac-d6c5c1fcb51f
    type: regular
    task:
      id: 3ab1983e-4003-4cd2-8aac-d6c5c1fcb51f
      version: -1
      name: tanium-tr-list-file-downloads
      script: Tanium Threat Response v2|||tanium-tr-list-file-downloads
      type: regular
      iscommand: true
      brand: Tanium Threat Response v2
    nexttasks:
      '#none#':
      - "28"
    scriptarguments:
      limit:
        simple: "80"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1882.5,
          "y": 2820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: 85c7be37-9e1d-46ca-84d0-9acb93abdfcc
    type: condition
    task:
      id: 85c7be37-9e1d-46ca-84d0-9acb93abdfcc
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "57"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.FileDownload.size
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.FileDownload.path
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.FileDownload.downloaded
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.FileDownload.hostname
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.FileDownload.processCreationTime
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.FileDownload.hash
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.FileDownload.uuid
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.FileDownload.lastModified
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.FileDownload.createdBy
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.FileDownload.createdByProc
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.FileDownload.lastModifiedBy
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.FileDownload.lastModifiedByProc
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.FileDownload.evidenceType
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1882.5,
          "y": 2995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: 3a0b430c-4613-4c6b-8e65-5630e1f16430
    type: regular
    task:
      id: 3a0b430c-4613-4c6b-8e65-5630e1f16430
      version: -1
      name: tanium-tr-get-downloaded-file
      script: Tanium Threat Response v2|||tanium-tr-get-downloaded-file
      type: regular
      iscommand: true
      brand: Tanium Threat Response v2
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      file_id:
        complex:
          root: Tanium.FileDownload
          accessor: uuid
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1882.5,
          "y": 3345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: 7334a8c4-d279-44a4-809a-db8feb6dcac5
    type: condition
    task:
      id: 7334a8c4-d279-44a4-809a-db8feb6dcac5
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "33"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: File.EntryID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: File.Extension
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: File.Info
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: File.MD5
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: File.Name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: File.SHA1
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: File.SHA256
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: File.SHA512
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: File.SSDeep
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: File.Size
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: File.Type
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1882.5,
          "y": 3520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: 4b42cc2a-3024-4d71-8c5b-8838cf860fb9
    type: regular
    task:
      id: 4b42cc2a-3024-4d71-8c5b-8838cf860fb9
      version: -1
      name: tanium-tr-list-events-by-connection
      script: Tanium Threat Response v2|||tanium-tr-list-events-by-connection
      type: regular
      iscommand: true
      brand: Tanium Threat Response v2
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      connection_id:
        complex:
          root: Tanium.Connection
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: Tanium.Connection.status
                iscontext: true
              right:
                value:
                  simple: connected
          accessor: id
          transformers:
          - operator: FirstArrayElement
      type:
        simple: Process
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: ec21a808-9134-4863-8e4a-bfdeef32fe84
    type: condition
    task:
      id: ec21a808-9134-4863-8e4a-bfdeef32fe84
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "35"
      - "82"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: TaniumEvent.groupName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: TaniumEvent.processPath
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: TaniumEvent.processTableId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: TaniumEvent.userName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: TaniumEvent.createTime
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: TaniumEvent.endTime
            iscontext: true
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: 046edf0e-d264-419c-84eb-7d3e6e536036
    type: regular
    task:
      id: 046edf0e-d264-419c-84eb-7d3e6e536036
      version: -1
      name: tanium-tr-get-file-download-info
      script: Tanium Threat Response v2|||tanium-tr-get-file-download-info
      type: regular
      iscommand: true
      brand: Tanium Threat Response v2
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      file_id:
        complex:
          root: Tanium.FileDownload
          accessor: uuid
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1882.5,
          "y": 3695
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: af8465d6-58dd-41d5-85f8-b417e5fa535c
    type: condition
    task:
      id: af8465d6-58dd-41d5-85f8-b417e5fa535c
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "79"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.FileDownload.size
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.FileDownload.path
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.FileDownload.downloaded
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.FileDownload.hostname
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.FileDownload.processCreationTime
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.FileDownload.hash
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.FileDownload.uuid
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.FileDownload.lastModified
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.FileDownload.createdBy
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.FileDownload.createdByProc
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.FileDownload.lastModifiedBy
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.FileDownload.lastModifiedByProc
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.FileDownload.evidenceType
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1882.5,
          "y": 3870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: c6066290-7cb6-427a-8485-81b53930edc5
    type: regular
    task:
      id: c6066290-7cb6-427a-8485-81b53930edc5
      version: -1
      name: tanium-tr-get-process-info
      script: Tanium Threat Response v2|||tanium-tr-get-process-info
      type: regular
      iscommand: true
      brand: Tanium Threat Response v2
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      connection_id:
        complex:
          root: Tanium.Connection
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: Tanium.Connection.status
                iscontext: true
              right:
                value:
                  simple: connected
          accessor: id
          transformers:
          - operator: FirstArrayElement
      ptid:
        complex:
          root: TaniumEvent
          accessor: processTableId
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: 57da7e85-663e-4553-810b-6d70d7e2cfdb
    type: condition
    task:
      id: 57da7e85-663e-4553-810b-6d70d7e2cfdb
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "37"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessInfo.childrenCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessInfo.context
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessInfo.createTime
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessInfo.createTimeRaw
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessInfo.groupName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessInfo.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessInfo.parentProcessTableId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessInfo.pid
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessInfo.processTableId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessInfo.userName
            iscontext: true
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: d27d0972-2d8e-4402-8562-efb4ec962593
    type: regular
    task:
      id: d27d0972-2d8e-4402-8562-efb4ec962593
      version: -1
      name: tanium-tr-get-events-by-process
      script: Tanium Threat Response v2|||tanium-tr-get-events-by-process
      type: regular
      iscommand: true
      brand: Tanium Threat Response v2
    nexttasks:
      '#none#':
      - "38"
    scriptarguments:
      connection_id:
        complex:
          root: Tanium.Connection
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: Tanium.Connection.status
                iscontext: true
              right:
                value:
                  simple: connected
          accessor: id
          transformers:
          - operator: FirstArrayElement
      ptid:
        complex:
          root: Tanium.ProcessInfo
          accessor: processTableId
          transformers:
          - operator: FirstArrayElement
      type:
        simple: Process
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: 70226ada-efdb-4f1e-8f77-05184e1eb87a
    type: condition
    task:
      id: 70226ada-efdb-4f1e-8f77-05184e1eb87a
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "39"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessEvent.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessEvent.detail
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessEvent.operation
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessEvent.timestamp
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessEvent.type
            iscontext: true
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: 9889dddb-a2e7-44bd-8401-d6621b0cafc3
    type: regular
    task:
      id: 9889dddb-a2e7-44bd-8401-d6621b0cafc3
      version: -1
      name: tanium-tr-get-process-children
      script: Tanium Threat Response v2|||tanium-tr-get-process-children
      type: regular
      iscommand: true
      brand: Tanium Threat Response v2
    nexttasks:
      '#none#':
      - "40"
    scriptarguments:
      connection_id:
        complex:
          root: Tanium.Connection
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: Tanium.Connection.status
                iscontext: true
              right:
                value:
                  simple: connected
          accessor: id
          transformers:
          - operator: FirstArrayElement
      ptid:
        complex:
          root: Tanium.ProcessInfo
          accessor: parentProcessTableId
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: ef14db44-dcad-46cc-870f-7c07b0ed263e
    type: condition
    task:
      id: ef14db44-dcad-46cc-870f-7c07b0ed263e
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "41"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessChildren.childrenCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessChildren.context
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessChildren.createTime
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessChildren.createTimeRaw
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessChildren.dnsEventsCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessChildren.driverEventsCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessChildren.fileEventsCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessChildren.groupName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessChildren.hashTypeName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessChildren.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessChildren.imageEventsCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessChildren.networkEventsCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessChildren.parentProcessTableId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessChildren.pid
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessChildren.processEventsCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessChildren.processHash
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessChildren.processPath
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessChildren.processTableId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessChildren.registryEventsCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessChildren.securityEventsCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessChildren.uniqueProcessId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessChildren.userName
            iscontext: true
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 2820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: 10a87f9d-2569-433a-802d-d6345ec74f14
    type: regular
    task:
      id: 10a87f9d-2569-433a-802d-d6345ec74f14
      version: -1
      name: tanium-tr-get-parent-process
      script: Tanium Threat Response v2|||tanium-tr-get-parent-process
      type: regular
      iscommand: true
      brand: Tanium Threat Response v2
    nexttasks:
      '#none#':
      - "42"
    scriptarguments:
      connection_id:
        complex:
          root: Tanium.Connection
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: Tanium.Connection.status
                iscontext: true
              right:
                value:
                  simple: connected
          accessor: id
          transformers:
          - operator: FirstArrayElement
      ptid:
        complex:
          root: Tanium.ProcessChildren
          accessor: processTableId
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 2995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: 44baf263-781e-432e-8d61-fd2136976279
    type: condition
    task:
      id: 44baf263-781e-432e-8d61-fd2136976279
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "45"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessParent.childrenCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessParent.context
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessParent.createTime
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessParent.createTimeRaw
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessParent.dnsEventsCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessParent.driverEventsCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessParent.fileEventsCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessParent.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessParent.imageEventsCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessParent.networkEventsCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessParent.parentProcessTableId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessParent.pid
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessParent.processEventsCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessParent.processPath
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessParent.processTableId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessParent.registryEventsCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessParent.securityEventsCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessParent.uniqueProcessId
            iscontext: true
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: ca7c5fb7-de0b-478c-83c3-70ae632553d8
    type: regular
    task:
      id: ca7c5fb7-de0b-478c-83c3-70ae632553d8
      version: -1
      name: tanium-tr-get-process-tree
      script: Tanium Threat Response v2|||tanium-tr-get-process-tree
      type: regular
      iscommand: true
      brand: Tanium Threat Response v2
    nexttasks:
      '#none#':
      - "46"
    scriptarguments:
      connection_id:
        complex:
          root: Tanium.Connection
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: Tanium.Connection.status
                iscontext: true
              right:
                value:
                  simple: connected
          accessor: id
          transformers:
          - operator: FirstArrayElement
      ptid:
        complex:
          root: Tanium.ProcessParent
          accessor: processTableId
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 3345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: 1a853c1c-8a87-49a1-84be-e0402f0a6009
    type: condition
    task:
      id: 1a853c1c-8a87-49a1-84be-e0402f0a6009
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "22"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessTree.childrenCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessTree.context
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessTree.createTime
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessTree.createTimeRaw
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessTree.dnsEventsCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessTree.fileEventsCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessTree.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessTree.imageEventsCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessTree.networkEventsCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessTree.parentProcessTableId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessTree.pid
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessTree.processEventsCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessTree.processPath
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessTree.processTableId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessTree.registryEventsCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessTree.securityEventsCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.ProcessTree.uniqueProcessId
            iscontext: true
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 3520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: 84dd3135-10ce-4f8f-84e6-e8b1285d20f2
    type: regular
    task:
      id: 84dd3135-10ce-4f8f-84e6-e8b1285d20f2
      version: -1
      name: tanium-tr-event-evidence-list
      script: Tanium Threat Response v2|||tanium-tr-event-evidence-list
      type: regular
      iscommand: true
      brand: Tanium Threat Response v2
    nexttasks:
      '#none#':
      - "48"
    scriptarguments:
      limit:
        simple: "150"
      offset:
        simple: "30"
      type:
        simple: event
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2312.5,
          "y": 2995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: 54ea176a-1f39-4ee2-8c45-020878cccdec
    type: condition
    task:
      id: 54ea176a-1f39-4ee2-8c45-020878cccdec
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "49"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Evidence.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Evidence.uuid
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Evidence.createdAt
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Evidence.hostname
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Evidence.evidenceType
            iscontext: true
    view: |-
      {
        "position": {
          "x": 2312.5,
          "y": 3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: 39fe5db7-40c0-4285-8888-913e28e7ac1c
    type: regular
    task:
      id: 39fe5db7-40c0-4285-8888-913e28e7ac1c
      version: -1
      name: tanium-tr-event-evidence-get-properties
      script: Tanium Threat Response v2|||tanium-tr-event-evidence-get-properties
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "51"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2312.5,
          "y": 3345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: 04b4b1f9-ac68-4328-8bec-9075222e8e06
    type: regular
    task:
      id: 04b4b1f9-ac68-4328-8bec-9075222e8e06
      version: -1
      name: tanium-tr-get-evidence-by-id
      script: Tanium Threat Response v2|||tanium-tr-get-evidence-by-id
      type: regular
      iscommand: true
      brand: Tanium Threat Response v2
    nexttasks:
      '#none#':
      - "52"
    scriptarguments:
      evidence_id:
        complex:
          root: Tanium.Evidence
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: Tanium.Evidence.evidenceType
                iscontext: true
              right:
                value:
                  simple: event
          accessor: uuid
          transformers:
          - operator: LastArrayElement
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2312.5,
          "y": 3695
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "52":
    id: "52"
    taskid: 74337e0b-3773-4b89-8b65-c7434b2d82b8
    type: condition
    task:
      id: 74337e0b-3773-4b89-8b65-c7434b2d82b8
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "79"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Evidence.createTime
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Evidence.createTimeRaw
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Evidence.created
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Evidence.eventtype
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Evidence.evidencetype
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Evidence.hostname
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Evidence.summary
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Evidence.username
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Evidence.uuid
            iscontext: true
    view: |-
      {
        "position": {
          "x": 2312.5,
          "y": 3870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: 1833244f-b85f-4ed6-8787-1457e5b8fda4
    type: regular
    task:
      id: 1833244f-b85f-4ed6-8787-1457e5b8fda4
      version: -1
      name: tanium-tr-create-evidence
      script: Tanium Threat Response v2|||tanium-tr-create-evidence
      type: regular
      iscommand: true
      brand: Tanium Threat Response v2
    nexttasks:
      '#none#':
      - "54"
    scriptarguments:
      connection_id:
        complex:
          root: Tanium.Connection
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: Tanium.Connection.status
                iscontext: true
              right:
                value:
                  simple: connected
          accessor: id
          transformers:
          - operator: FirstArrayElement
      hostname:
        complex:
          root: Tanium.Connection
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: Tanium.Connection.status
                iscontext: true
              right:
                value:
                  simple: connected
          accessor: hostname
          transformers:
          - operator: FirstArrayElement
      ptid:
        complex:
          root: TaniumEvent
          accessor: processTableId
          transformers:
          - operator: FirstArrayElement
      summary:
        simple: Test description.
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1022.5,
          "y": 3345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "54":
    id: "54"
    taskid: 4324228d-cecb-4cd9-84b1-6310b3869b01
    type: regular
    task:
      id: 4324228d-cecb-4cd9-84b1-6310b3869b01
      version: -1
      name: tanium-tr-delete-evidence
      script: Tanium Threat Response v2|||tanium-tr-delete-evidence
      type: regular
      iscommand: true
      brand: Tanium Threat Response v2
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      evidence_ids:
        complex:
          root: Tanium.Evidence
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: Tanium.Evidence.evidenceType
                iscontext: true
              right:
                value:
                  simple: event
          accessor: uuid
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1022.5,
          "y": 3520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "55":
    id: "55"
    taskid: 0582779a-7d36-43f5-8646-625ee8c9ee02
    type: regular
    task:
      id: 0582779a-7d36-43f5-8646-625ee8c9ee02
      version: -1
      name: tanium-tr-request-file-download
      script: Tanium Threat Response v2|||tanium-tr-request-file-download
      type: regular
      iscommand: true
      brand: Tanium Threat Response v2
    nexttasks:
      '#none#':
      - "56"
    scriptarguments:
      connection_id:
        complex:
          root: Tanium.Connection
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: Tanium.Connection.status
                iscontext: true
              right:
                value:
                  simple: connected
          accessor: id
          transformers:
          - operator: FirstArrayElement
      path:
        simple: C:\Windows\System32\AtBroker.exe
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1452.5,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "56":
    id: "56"
    taskid: a53b6d35-d72d-42f5-80f7-49fc5753dc1a
    type: condition
    task:
      id: a53b6d35-d72d-42f5-80f7-49fc5753dc1a
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "58"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.FileDownloadTask.compress
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.FileDownloadTask.connection
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.FileDownloadTask.taskId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.FileDownloadTask.paths
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.FileDownloadTask.startTime
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.FileDownloadTask.status
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1452.5,
          "y": 2820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "57":
    id: "57"
    taskid: 65b0ac09-d1ef-4e63-8c0f-6874ca52dc3d
    type: regular
    task:
      id: 65b0ac09-d1ef-4e63-8c0f-6874ca52dc3d
      version: -1
      name: tanium-tr-delete-file-download
      script: Tanium Threat Response v2|||tanium-tr-delete-file-download
      type: regular
      iscommand: true
      brand: Tanium Threat Response v2
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      file_id:
        complex:
          root: Tanium.FileDownload
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: Tanium.FileDownload.path
                iscontext: true
              right:
                value:
                  simple: C:\Windows\System32\AtBroker.exe
          accessor: uuid
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1882.5,
          "y": 3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "58":
    id: "58"
    taskid: 928a519d-d8d6-4d50-8d35-08011a5fc225
    type: regular
    task:
      id: 928a519d-d8d6-4d50-8d35-08011a5fc225
      version: -1
      name: tanium-tr-list-files-in-directory
      script: Tanium Threat Response v2|||tanium-tr-list-files-in-directory
      type: regular
      iscommand: true
      brand: Tanium Threat Response v2
    nexttasks:
      '#none#':
      - "59"
    scriptarguments:
      connection_id:
        complex:
          root: Tanium.Connection
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: Tanium.Connection.status
                iscontext: true
              right:
                value:
                  simple: connected
          - - operator: isEqualString
              left:
                value:
                  simple: Tanium.Connection.platform
                iscontext: true
              right:
                value:
                  simple: Windows
          accessor: id
          transformers:
          - operator: FirstArrayElement
      path:
        simple: C:\Users\Administrator\Desktop\
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1452.5,
          "y": 2995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "59":
    id: "59"
    taskid: 76ae7d48-3e44-4605-84ee-cc421c297693
    type: condition
    task:
      id: 76ae7d48-3e44-4605-84ee-cc421c297693
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "60"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.File.connectionId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.File.createdDate
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.File.modifiedDate
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.File.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.File.path
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.File.permissions
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.File.size
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.File.type
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1452.5,
          "y": 3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: 7d026dfa-c834-4b76-832e-24cb85bfa07c
    type: regular
    task:
      id: 7d026dfa-c834-4b76-832e-24cb85bfa07c
      version: -1
      name: tanium-tr-get-file-info
      script: Tanium Threat Response v2|||tanium-tr-get-file-info
      type: regular
      iscommand: true
      brand: Tanium Threat Response v2
    nexttasks:
      '#none#':
      - "61"
    scriptarguments:
      connection_id:
        complex:
          root: Tanium.File
          accessor: connectionId
          transformers:
          - operator: FirstArrayElement
      path:
        complex:
          root: Tanium.File
          accessor: path
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1452.5,
          "y": 3345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    id: "61"
    taskid: 658a16b1-be10-4332-83f5-0295e354ea4d
    type: condition
    task:
      id: 658a16b1-be10-4332-83f5-0295e354ea4d
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "22"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.File.canonicalPath
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.File.cid
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.File.connectionId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.File.createdDate
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.File.modifiedDate
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.File.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.File.path
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.File.permissions
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.File.size
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.File.type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.File.sessionId
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1452.5,
          "y": 3520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: 5fcb9318-97b5-440c-8f71-086024b70fe5
    type: regular
    task:
      id: 5fcb9318-97b5-440c-8f71-086024b70fe5
      version: -1
      name: tanium-tr-intel-docs-labels-list
      script: Tanium Threat Response v2|||tanium-tr-intel-docs-labels-list
      type: regular
      iscommand: true
      brand: Tanium Threat Response v2
    nexttasks:
      '#none#':
      - "64"
    scriptarguments:
      intel_doc_id:
        simple: ${Tanium.IntelDoc.ID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 3172.5,
          "y": 2995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "64":
    id: "64"
    taskid: f9de2a8f-042f-4d42-8b97-e8fbd5583788
    type: condition
    task:
      id: f9de2a8f-042f-4d42-8b97-e8fbd5583788
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "65"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.IntelDocLabel.LabelsList.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.IntelDocLabel.LabelsList.Name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.IntelDocLabel.LabelsList.CreatedAt
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.IntelDocLabel.IntelDocID
            iscontext: true
    view: |-
      {
        "position": {
          "x": 3172.5,
          "y": 3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "65":
    id: "65"
    taskid: 94caa10c-7255-4c6e-81a8-6735a862b44c
    type: regular
    task:
      id: 94caa10c-7255-4c6e-81a8-6735a862b44c
      version: -1
      name: tanium-tr-intel-docs-add-label
      script: Tanium Threat Response v2|||tanium-tr-intel-docs-add-label
      type: regular
      iscommand: true
      brand: Tanium Threat Response v2
    nexttasks:
      '#none#':
      - "66"
    scriptarguments:
      intel_doc_id:
        simple: ${Tanium.IntelDoc.ID}
      label_id:
        simple: "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 3172.5,
          "y": 3345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "66":
    id: "66"
    taskid: 6ad44fa8-fb83-4da7-807d-a33c17eb0c4f
    type: condition
    task:
      id: 6ad44fa8-fb83-4da7-807d-a33c17eb0c4f
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "67"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.IntelDocLabel.LabelsList.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.IntelDocLabel.LabelsList.Name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.IntelDocLabel..LabelsList.Description
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.IntelDocLabel.LabelsList.IndicatorCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.IntelDocLabel.LabelsList.CreatedAt
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.IntelDocLabel.LabelsList.UpdatedAt
            iscontext: true
    view: |-
      {
        "position": {
          "x": 3172.5,
          "y": 3520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "67":
    id: "67"
    taskid: dffc1c4b-7af2-45fc-8c66-23d3bc34abe0
    type: regular
    task:
      id: dffc1c4b-7af2-45fc-8c66-23d3bc34abe0
      version: -1
      name: tanium-tr-intel-docs-remove-label
      script: Tanium Threat Response v2|||tanium-tr-intel-docs-remove-label
      type: regular
      iscommand: true
      brand: Tanium Threat Response v2
    nexttasks:
      '#none#':
      - "83"
    scriptarguments:
      intel_doc_id:
        simple: ${Tanium.IntelDocLabel.IntelDocID}
      label_id:
        simple: "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 3172.5,
          "y": 3690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "75":
    id: "75"
    taskid: 0d6a0088-4466-4083-8786-6cadff095c78
    type: regular
    task:
      id: 0d6a0088-4466-4083-8786-6cadff095c78
      version: -1
      name: tanium-tr-get-task-by-id
      script: Tanium Threat Response v2|||tanium-tr-get-task-by-id
      type: regular
      iscommand: true
      brand: Tanium Threat Response v2
    nexttasks:
      '#none#':
      - "76"
    scriptarguments:
      task_id:
        simple: ${Tanium.SnapshotTask.taskId}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "76":
    id: "76"
    taskid: 54925ddf-3ea2-4bc2-82f1-9da78fac1673
    type: condition
    task:
      id: 54925ddf-3ea2-4bc2-82f1-9da78fac1673
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "22"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Task.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Task.updatedAt
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Task.startTime
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Task.status
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Task.type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.Task.metadata
            iscontext: true
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 3345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "77":
    id: "77"
    taskid: 9d76cc79-3b2a-49fa-887b-4c8868adbbd9
    type: regular
    task:
      id: 9d76cc79-3b2a-49fa-887b-4c8868adbbd9
      version: -1
      name: tanium-tr-get-system-status
      script: Tanium Threat Response v2|||tanium-tr-get-system-status
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "78"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "78":
    id: "78"
    taskid: 7e536ca7-d3e2-4197-81e8-48eb1376f3ab
    type: condition
    task:
      id: 7e536ca7-d3e2-4197-81e8-48eb1376f3ab
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "80"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.SystemStatus.clientId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.SystemStatus.computerId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.SystemStatus.hostName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.SystemStatus.ipaddressClient
            iscontext: true
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "79":
    id: "79"
    taskid: 7bb2b395-8c60-4734-868f-8cbcbcac7e87
    type: title
    task:
      id: 7bb2b395-8c60-4734-868f-8cbcbcac7e87
      version: -1
      name: Test Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2312.5,
          "y": 4045
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "80":
    id: "80"
    taskid: 6dde4a44-f9b4-4bcb-835a-07d73aa21501
    type: regular
    task:
      id: 6dde4a44-f9b4-4bcb-835a-07d73aa21501
      version: -1
      name: tanium-tr-create-connection
      script: Tanium Threat Response v2|||tanium-tr-create-connection
      type: regular
      iscommand: true
      brand: Tanium Threat Response v2
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      client_id:
        complex:
          root: Tanium.SystemStatus
          accessor: clientId
          transformers:
          - operator: FirstArrayElement
      hostname:
        complex:
          root: Tanium.SystemStatus
          accessor: hostName
          transformers:
          - operator: FirstArrayElement
      ip:
        complex:
          root: Tanium.SystemStatus
          accessor: ipaddressClient
          transformers:
          - operator: FirstArrayElement
      platform:
        simple: Windows
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "81":
    id: "81"
    taskid: fa588119-23cf-4270-88a4-2e12292aeb08
    type: regular
    task:
      id: fa588119-23cf-4270-88a4-2e12292aeb08
      version: -1
      name: tanium-tr-list-connections
      script: Tanium Threat Response v2|||tanium-tr-list-connections
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "86"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "82":
    id: "82"
    taskid: 951b4f99-d3e6-4319-82d5-0caadffdcefa
    type: regular
    task:
      id: 951b4f99-d3e6-4319-82d5-0caadffdcefa
      version: -1
      name: tanium-tr-event-evidence-list
      script: Tanium Threat Response v2|||tanium-tr-event-evidence-list
      type: regular
      iscommand: true
      brand: Tanium Threat Response v2
    nexttasks:
      '#none#':
      - "53"
    scriptarguments:
      limit:
        simple: "100"
      offset:
        simple: "20"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1022.5,
          "y": 3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "83":
    id: "83"
    taskid: c4855ca8-2774-4c34-83eb-af04ba109f9a
    type: condition
    task:
      id: c4855ca8-2774-4c34-83eb-af04ba109f9a
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "79"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.IntelDocLabel.LabelsList.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.IntelDocLabel.LabelsList.Name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.IntelDocLabel..LabelsList.Description
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.IntelDocLabel.LabelsList.IndicatorCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.IntelDocLabel.LabelsList.CreatedAt
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.IntelDocLabel.LabelsList.UpdatedAt
            iscontext: true
    view: |-
      {
        "position": {
          "x": 3172.5,
          "y": 3870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "84":
    id: "84"
    taskid: 9667ae3c-b227-4e63-8dd5-b23cefe1297b
    type: regular
    task:
      id: 9667ae3c-b227-4e63-8dd5-b23cefe1297b
      version: -1
      name: Sleep - waiting connection to connect
      description: Sleep for X seconds
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "81"
    scriptarguments:
      seconds:
        simple: "5"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "85":
    id: "85"
    taskid: 69e3ebc9-f99e-47d9-8511-e3acbc0bcf92
    type: playbook
    task:
      id: 69e3ebc9-f99e-47d9-8511-e3acbc0bcf92
      version: -1
      name: Fetch Incidents Test
      playbookName: Fetch Incidents Test
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "79"
    scriptarguments:
      searchfield:
        simple: CustomFields.alertid
      sourcebrand:
        simple: Tanium Threat Response v2
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 2742.5,
          "y": 3870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "86":
    id: "86"
    taskid: 8d8d0150-bd2a-4b67-8967-011e72c795c4
    type: condition
    task:
      id: 8d8d0150-bd2a-4b67-8967-011e72c795c4
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "79"
      "yes":
      - "55"
      - "31"
      - "14"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Tanium.Connection
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: Tanium.Connection.status
                      iscontext: true
                    right:
                      value:
                        simple: connected
                accessor: id
            iscontext: true
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "87":
    id: "87"
    taskid: 011f0188-d08d-4816-8c0b-ee3f4086fbed
    type: regular
    task:
      id: 011f0188-d08d-4816-8c0b-ee3f4086fbed
      version: -1
      name: tanium-tr-list-intel-docs
      description: Returns a comma-separated list of all intel documents.
      script: Tanium Threat Response v2|||tanium-tr-list-intel-docs
      type: regular
      iscommand: true
      brand: Tanium Threat Response v2
    nexttasks:
      '#none#':
      - "91"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 3172.5,
          "y": 2280
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "88":
    id: "88"
    taskid: 31fdf584-2dd6-458e-8b3e-fbf58f68d101
    type: regular
    task:
      id: 31fdf584-2dd6-458e-8b3e-fbf58f68d101
      version: -1
      name: tanium-tr-start-quick-scan
      description: Scan a computer group for hashes in intel document. Computer groups
        can be viewed by navigating to `Administration -> Computer Groups` in the
        Threat-Response product console. Computer group names and IDs can also be
        retrieved by using the `tn-list-groups` command in the `Tanium` integration.
      script: '|||tanium-tr-start-quick-scan'
      type: regular
      iscommand: true
      brand: Tanium Threat Response v2
    nexttasks:
      '#none#':
      - "90"
    scriptarguments:
      computer_group_name:
        simple: ${inputs.computer_group_name}
      intel_doc_id:
        simple: ${TaniumIntelDocID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 3172.5,
          "y": 1750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "89":
    id: "89"
    taskid: f2fdd214-2331-49af-89b8-5e79e48df1f7
    type: regular
    task:
      id: f2fdd214-2331-49af-89b8-5e79e48df1f7
      version: -1
      name: tanium-tr-intel-doc-delete
      description: Remove an intel document from the system by providing its ID
      script: '|||tanium-tr-intel-doc-delete'
      type: regular
      iscommand: true
      brand: Tanium Threat Response v2
    nexttasks:
      '#none#':
      - "87"
    scriptarguments:
      intel_doc_id:
        simple: ${TaniumIntelDocID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 3172.5,
          "y": 2105
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "90":
    id: "90"
    taskid: a3193ce9-00e3-4639-8f4e-72002164f17a
    type: condition
    task:
      id: a3193ce9-00e3-4639-8f4e-72002164f17a
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "89"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.QuickScan.IntelDocId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.QuickScan.ComputerGroupId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.QuickScan.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.QuickScan.AlertCount
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.QuickScan.CreatedAt
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.QuickScan.UserId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Tanium.QuickScan.QuestionId
            iscontext: true
    view: |-
      {
        "position": {
          "x": 3172.5,
          "y": 1925
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "91":
    id: "91"
    taskid: 4998c67a-02b4-4cef-870d-52f4d1199563
    type: condition
    task:
      id: 4998c67a-02b4-4cef-870d-52f4d1199563
      version: -1
      name: Verify Intel Doc was deleted
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "2"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: notIn
          left:
            value:
              simple: TaniumIntelDocID
            iscontext: true
          right:
            value:
              simple: Tanium.IntelDoc.ID
            iscontext: true
    view: |-
      {
        "position": {
          "x": 3172.5,
          "y": 2455
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "92":
    id: "92"
    taskid: f00d43b4-7218-4690-8023-dc71c26cbde6
    type: regular
    task:
      id: f00d43b4-7218-4690-8023-dc71c26cbde6
      version: -1
      name: Set TaniumIntelDocID
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "93"
    scriptarguments:
      key:
        simple: TaniumIntelDocID
      value:
        complex:
          root: Tanium.IntelDoc
          accessor: ID
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 3172.5,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "93":
    id: "93"
    taskid: d5535f55-ae1c-4988-8c1e-748944cf2d5f
    type: regular
    task:
      id: d5535f55-ae1c-4988-8c1e-748944cf2d5f
      version: -1
      name: Delete Tanium.IntelDoc context
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "88"
    scriptarguments:
      key:
        simple: Tanium.IntelDoc
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 3172.5,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "48_49_yes": 0.19
    },
    "paper": {
      "dimensions": {
        "height": 4060,
        "width": 3502.5,
        "x": 50,
        "y": 50
      }
    }
  }
inputs:
- key: computer_group_name
  value:
    simple: All Computers
  required: false
  description: ""
  playbookInputQuery: null
outputs: []
fromversion: 5.0.0