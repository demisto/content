#### Integrations

##### Datadog Cloud SIEM

- **Breaking Changes**
  - **Major Architecture Change**: Completely refactored integration to focus exclusively on Datadog Cloud SIEM functionality. The previous implementation incorrectly mapped Datadog Incident Management incidents to XSOAR incidents, which conflated two different Datadog products (Incident Management vs. Cloud SIEM). This integration now correctly maps **Datadog Cloud SIEM Security Signals** to XSOAR incidents.
  - **Removed Commands**: All commands unrelated to Cloud SIEM have been removed to maintain product focus and avoid confusion:
    - Removed `datadog-event-create` and `datadog-event-list` (Events API)
    - Removed `datadog-tag-list`, `datadog-host-tag-create`, `datadog-host-tag-get`, `datadog-host-tag-update`, `datadog-host-tag-delete` (Tags/Hosts API)
    - Removed `datadog-active-metric-list`, `datadog-metric-search`, `datadog-metric-metadata-get`, `datadog-metric-metadata-update`, `datadog-time-series-point-query` (Metrics API)
    - Removed `datadog-incident-create`, `datadog-incident-delete`, `datadog-incident-update`, `datadog-incident-list` (Incident Management API - not part of Cloud SIEM)
  - **Changed Incident Mapping**: Now fetches Cloud SIEM Security Signals (not Incident Management incidents) as XSOAR incidents, aligning with proper SIEM integration patterns.

- **New Features**
  - Added **Security Signals API** integration with full CRUD operations:
    - `datadog-security-signal-get` - Retrieve a specific security signal by ID
    - `datadog-security-signals-list` - List and filter security signals with advanced query support
    - `datadog-security-signal-assignee-update` - Assign security signals to team members
    - `datadog-security-signal-state-update` - Update triage state (open, under_review, archived)
  - Added `datadog-logs-search` command for security investigations and threat hunting
  - **Automatic IOC Extraction**: All security signal commands now automatically extract and populate standard XSOAR contexts for:
    - IP addresses (filtering private IPs)
    - URLs
    - File hashes (MD5, SHA1, SHA256)
  - **Incident Fetching**: Configurable automatic fetching of security signals as XSOAR incidents with:
    - Severity-based filtering (info, low, medium, high, critical)
    - State-based filtering (open, under_review, archived)
    - Custom query filters using Datadog search syntax
    - Automatic severity mapping to XSOAR severity levels
    - Configurable fetch time range and limits

- **Improvements**
  - Complete rewrite using modern dataclass architecture for type safety and maintainability
  - Comprehensive context outputs for all security signal fields (triage state, assignee, rule details, etc.)
  - Support for Datadog's native search syntax in query parameters
  - Proper pagination support with configurable limits
  - Enhanced error handling and validation
  - Full support for security signal triage workflows (state management, assignments, comments, and reasons)

- **Documentation**
  - Completely rewritten README with detailed command examples and use cases
  - Added comprehensive context output documentation
  - Added troubleshooting section for common issues
  - Updated configuration guide for Cloud SIEM-specific settings

**Migration Notes**: This is a breaking change. Users of version 1.x must reconfigure the integration:
- Update incident fetch configuration to use security signals instead of incidents
- Remove any playbooks or automations that depend on the removed commands
- Update any references from `datadog-incident-*` commands to `datadog-security-signal-*` commands
- Note that the integration now focuses exclusively on Cloud SIEM; for Datadog Incident Management, metrics, events, or host/tag management, consider using separate integrations or the Datadog API directly