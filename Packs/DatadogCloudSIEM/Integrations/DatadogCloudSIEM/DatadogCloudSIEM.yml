category: Analytics & SIEM
commonfields:
  id: DatadogCloudSIEM
  version: -1
configuration:
  - additionalinfo: Datadog website URL
    display: Server URL
    name: site
    type: 15
    options:
      - datadoghq.com
      - us3.datadoghq.com
      - us5.datadoghq.com
      - ap1.datadoghq.com
      - ap2.datadoghq.com
      - datadoghq.eu
      - ddog-gov.com
    defaultvalue: "datadoghq.com"
    required: true
  - additionalinfo: The API Key to use for authentication
    display: API Key
    name: api_key
    type: 4
    required: true
  - additionalinfo: The APP Key to use for authentication
    display: APP Key
    name: app_key
    type: 4
    required: true
  - display: Fetch incidents
    name: isFetch
    type: 8
    required: false
  - display: Incident type
    name: incidentType
    type: 13
    required: false
  - additionalinfo: First fetch time range. How far back to fetch security signals on the first run. Examples "3 days", "7 days", "1 week"
    display: First fetch time
    name: first_fetch
    type: 0
    defaultvalue: "3 days"
    required: false
  - additionalinfo: Maximum number of incidents to fetch per cycle. Maximum is 200, recommended less than 100.
    display: Max fetch
    name: max_fetch
    type: 0
    defaultvalue: "50"
    required: false
  - additionalinfo: Fetch only security signals with these severity levels. Comma-separated list. Leave empty to fetch all severities.
    display: Fetch severity
    name: fetch_severity
    type: 15
    options:
      - info
      - low
      - medium
      - high
      - critical
    defaultvalue: "medium"
    required: false
  - additionalinfo: Fetch only security signals in this state. Default is "open".
    display: Fetch state
    name: fetch_state
    type: 15
    options:
      - open
      - under_review
      - archived
    defaultvalue: "open"
    required: false
  - additionalinfo: Additional custom query filter for fetching security signals. Uses Datadog search syntax.
    display: Fetch query
    name: fetch_query
    type: 0
    required: false
description: Datadog Cloud SIEM integration for XSOAR provides security signal management capabilities. This integration allows you to retrieve, filter, and manage security signals from Datadog's Cloud SIEM platform, enabling security teams to investigate threats, manage signal triage states, and assign signals to team members.
display: Datadog Cloud SIEM
name: DatadogCloudSIEM
script:
  commands:
    - arguments:
        - description: The unique identifier of the security signal to retrieve. If not provided, will attempt to get it from the current incident.
          name: signal_id
      name: datadog-security-signal-get
      description: Get a specific security signal by ID from Datadog Cloud SIEM.
      outputs:
        - contextPath: Datadog.SecuritySignal.id
          description: The unique identifier of the security signal.
          type: String
        - contextPath: Datadog.SecuritySignal.timestamp
          description: The timestamp when the security signal was generated.
          type: String
        - contextPath: Datadog.SecuritySignal.title
          description: The title of the security signal.
          type: String
        - contextPath: Datadog.SecuritySignal.message
          description: The message describing the security signal.
          type: String
        - contextPath: Datadog.SecuritySignal.severity
          description: The severity level of the security signal (low, medium, high, critical).
          type: String
        - contextPath: Datadog.SecuritySignal.host
          description: Host associated with the security signal.
          type: String
        - contextPath: Datadog.SecuritySignal.service
          description: List of services associated with the security signal.
          type: Unknown
        - contextPath: Datadog.SecuritySignal.tags
          description: List of tags associated with the security signal.
          type: Unknown
        - contextPath: Datadog.SecuritySignal.triggering_log_id
          description: ID of the log that triggered the security signal.
          type: String
        - contextPath: Datadog.SecuritySignal.rule.id
          description: The unique identifier of the security rule.
          type: String
        - contextPath: Datadog.SecuritySignal.rule.name
          description: The name of the security rule that triggered the signal.
          type: String
        - contextPath: Datadog.SecuritySignal.rule.type
          description: The type of the security rule.
          type: String
        - contextPath: Datadog.SecuritySignal.rule.tags
          description: List of tags associated with the security rule.
          type: Unknown
        - contextPath: Datadog.SecuritySignal.triage.state
          description: The current triage state of the security signal (open, under_review, archived).
          type: String
        - contextPath: Datadog.SecuritySignal.triage.comment
          description: The archive comment of the security signal.
          type: String
        - contextPath: Datadog.SecuritySignal.triage.reason
          description: The archive reason of the security signal.
          type: String
        - contextPath: Datadog.SecuritySignal.triage.assignee.id
          description: The ID of the user assigned to the security signal.
          type: Number
        - contextPath: Datadog.SecuritySignal.triage.assignee.uuid
          description: The UUID of the user assigned to the security signal.
          type: String
        - contextPath: Datadog.SecuritySignal.triage.assignee.name
          description: The name of the user assigned to the security signal.
          type: String
        - contextPath: Datadog.SecuritySignal.raw
          description: The raw signal object returned by the API.
          type: Unknown
    - arguments:
        - description: Filter signals by state (open, under_review, archived).
          name: state
          auto: PREDEFINED
          predefined:
            - open
            - under_review
            - archived
        - description: Filter signals by severity level (info, low, medium, high, critical).
          name: severity
          auto: PREDEFINED
          predefined:
            - info
            - low
            - medium
            - high
            - critical
        - description: Filter signals by source.
          name: source
        - description: Custom query string for advanced filtering. Uses Datadog search syntax.
          name: query
        - description: Start date for the search. Format can be relative (e.g., "7 days ago") or absolute (e.g., "2023-01-01T00:00:00Z").
          name: from_date
          defaultvalue: "-7days"
        - description: End date for the search. Format can be relative (e.g., "now") or absolute (e.g., "2023-01-01T23:59:59Z").
          name: to_date
          defaultvalue: "now"
        - description: Sort order for results.
          name: sort
          auto: PREDEFINED
          predefined:
            - asc
            - desc
          defaultvalue: "desc"
        - description: Number of results per page.
          name: page_size
        - description: Maximum number of results to return. If page_size is specified, limit is ignored.
          name: limit
          defaultvalue: "50"
      name: datadog-security-signal-list
      description: Get a list of security signals from Datadog Cloud SIEM with optional filtering and pagination.
      outputs:
        - contextPath: Datadog.SecuritySignal.id
          description: The unique identifier of the security signal.
          type: String
        - contextPath: Datadog.SecuritySignal.timestamp
          description: The timestamp when the security signal was generated.
          type: String
        - contextPath: Datadog.SecuritySignal.host
          description: Host associated with the security signal.
          type: String
        - contextPath: Datadog.SecuritySignal.service
          description: List of services associated with the security signal.
          type: Unknown
        - contextPath: Datadog.SecuritySignal.severity
          description: The severity level of the security signal (low, medium, high, critical).
          type: String
        - contextPath: Datadog.SecuritySignal.title
          description: The title of the security signal.
          type: String
        - contextPath: Datadog.SecuritySignal.message
          description: The message describing the security signal.
          type: String
        - contextPath: Datadog.SecuritySignal.tags
          description: List of tags associated with the security signal.
          type: Unknown
        - contextPath: Datadog.SecuritySignal.triggering_log_id
          description: ID of the log that triggered the security signal.
          type: String
        - contextPath: Datadog.SecuritySignal.rule.id
          description: The unique identifier of the security rule.
          type: String
        - contextPath: Datadog.SecuritySignal.rule.name
          description: The name of the security rule that triggered the signal.
          type: String
        - contextPath: Datadog.SecuritySignal.rule.type
          description: The type of the security rule.
          type: String
        - contextPath: Datadog.SecuritySignal.rule.tags
          description: List of tags associated with the security rule.
          type: Unknown
        - contextPath: Datadog.SecuritySignal.triage.state
          description: The current triage state of the security signal (open, under_review, archived).
          type: String
        - contextPath: Datadog.SecuritySignal.triage.comment
          description: The archive comment of the security signal.
          type: String
        - contextPath: Datadog.SecuritySignal.triage.reason
          description: The archive reason of the security signal.
          type: String
        - contextPath: Datadog.SecuritySignal.triage.assignee.id
          description: The ID of the user assigned to the security signal.
          type: Number
        - contextPath: Datadog.SecuritySignal.triage.assignee.uuid
          description: The UUID of the user assigned to the security signal.
          type: String
        - contextPath: Datadog.SecuritySignal.triage.assignee.name
          description: The name of the user assigned to the security signal.
          type: String
        - contextPath: Datadog.SecuritySignal.raw
          description: The raw signal object returned by the API
          type: Unknown
        - contextPath: IP.Address
          description: IP addresses extracted from security signals data
          type: String
        - contextPath: IP.DBotScore.Score
          description: The DBot score for extracted IP addresses
          type: Number
        - contextPath: IP.DBotScore.Vendor
          description: The vendor used to calculate the DBot score for IPs
          type: String
        - contextPath: URL.Data
          description: URLs extracted from security signals data
          type: String
        - contextPath: URL.DBotScore.Score
          description: The DBot score for extracted URLs
          type: Number
        - contextPath: URL.DBotScore.Vendor
          description: The vendor used to calculate the DBot score for URLs
          type: String
        - contextPath: File.MD5
          description: MD5 hash values extracted from security signals data
          type: String
        - contextPath: File.SHA1
          description: SHA1 hash values extracted from security signals data
          type: String
        - contextPath: File.SHA256
          description: SHA256 hash values extracted from security signals data
          type: String
        - contextPath: File.DBotScore.Score
          description: The DBot score for extracted file hashes
          type: Number
        - contextPath: File.DBotScore.Vendor
          description: The vendor used to calculate the DBot score for files
          type: String
    - arguments:
        - description: The unique identifier of the security signal to update. If not provided, will attempt to get it from the current incident.
          name: signal_id
        - description: Name or email of the user to assign to the security signal. Leave empty to unassign. At least one of assignee or state must be provided.
          name: assignee
        - description: The new state of the security signal. At least one of assignee or state must be provided.
          name: state
          auto: PREDEFINED
          predefined:
            - open
            - under_review
            - archived
        - description: Reason for the state change (used when changing state to archived).
          name: reason
          auto: PREDEFINED
          predefined:
            - none
            - false_positive
            - testing_or_maintenance
            - remediated
            - investigated_case_opened
            - other
            - true_positive_benign
            - true_positive_malicious
        - description: Comment about the state change (used when changing state).
          name: comment
      name: datadog-security-signal-update
      description: Update a security signal's assignee and/or state in Datadog Cloud SIEM. Can update assignee only, state only, or both in a single command.
      outputs:
        - contextPath: Datadog.SecuritySignal.id
          description: The unique identifier of the security signal.
          type: String
        - contextPath: Datadog.SecuritySignal.timestamp
          description: The timestamp when the security signal was generated.
          type: String
        - contextPath: Datadog.SecuritySignal.title
          description: The title of the security signal.
          type: String
        - contextPath: Datadog.SecuritySignal.message
          description: The message describing the security signal.
          type: String
        - contextPath: Datadog.SecuritySignal.severity
          description: The severity level of the security signal (low, medium, high, critical).
          type: String
        - contextPath: Datadog.SecuritySignal.host
          description: Host associated with the security signal.
          type: String
        - contextPath: Datadog.SecuritySignal.service
          description: List of services associated with the security signal.
          type: Unknown
        - contextPath: Datadog.SecuritySignal.tags
          description: List of tags associated with the security signal.
          type: Unknown
        - contextPath: Datadog.SecuritySignal.triggering_log_id
          description: ID of the log that triggered the security signal.
          type: String
        - contextPath: Datadog.SecuritySignal.rule.id
          description: The unique identifier of the security rule.
          type: String
        - contextPath: Datadog.SecuritySignal.rule.name
          description: The name of the security rule that triggered the signal.
          type: String
        - contextPath: Datadog.SecuritySignal.rule.type
          description: The type of the security rule.
          type: String
        - contextPath: Datadog.SecuritySignal.rule.tags
          description: List of tags associated with the security rule.
          type: Unknown
        - contextPath: Datadog.SecuritySignal.rule.url
          description: URL to view the security rule in Datadog UI.
          type: String
        - contextPath: Datadog.SecuritySignal.triage.state
          description: The current triage state of the security signal (open, under_review, archived).
          type: String
        - contextPath: Datadog.SecuritySignal.triage.archive_comment
          description: The archive comment of the security signal.
          type: String
        - contextPath: Datadog.SecuritySignal.triage.archive_reason
          description: The archive reason of the security signal.
          type: String
        - contextPath: Datadog.SecuritySignal.triage.assignee.uuid
          description: The UUID of the user assigned to the security signal.
          type: String
        - contextPath: Datadog.SecuritySignal.triage.assignee.name
          description: The name of the user assigned to the security signal.
          type: String
        - contextPath: Datadog.SecuritySignal.url
          description: URL to view the security signal in Datadog UI.
          type: String
        - contextPath: Datadog.SecuritySignal.raw
          description: The raw signal object returned by the API.
          type: Unknown
    - arguments:
        - description: Custom search query string. Uses Datadog search syntax.
          name: query
        - description: Filter logs by host name.
          name: host
        - description: Filter logs by source.
          name: source
        - description: Filter logs by status/level (info, warn, error, debug, etc.).
          name: status
        - description: Start date for the search. Format can be relative (e.g., "7 days ago") or absolute (e.g., "2023-01-01T00:00:00Z").
          name: from_date
          defaultvalue: "-7days"
        - description: End date for the search. Format can be relative (e.g., "now") or absolute (e.g., "2023-01-01T23:59:59Z").
          name: to_date
          defaultvalue: "now"
        - description: Sort order for results.
          name: sort
          auto: PREDEFINED
          predefined:
            - asc
            - desc
          defaultvalue: "desc"
        - description: Number of results per page.
          name: page_size
        - description: Maximum number of results to return. If page_size is specified, limit is ignored.
          name: limit
          defaultvalue: "50"
      name: datadog-logs-search
      description: Search for logs in Datadog Cloud SIEM with optional filtering for security investigations.
      outputs:
        - contextPath: Datadog.Log.id
          description: The unique identifier of the log entry.
          type: String
        - contextPath: Datadog.Log.timestamp
          description: The timestamp when the log was generated.
          type: String
        - contextPath: Datadog.Log.message
          description: The log message content.
          type: String
        - contextPath: Datadog.Log.service
          description: The service that generated the log.
          type: String
        - contextPath: Datadog.Log.host
          description: The host that generated the log.
          type: String
        - contextPath: Datadog.Log.source
          description: The source of the log entry.
          type: String
        - contextPath: Datadog.Log.status
          description: The status/level of the log entry.
          type: String
        - contextPath: Datadog.Log.tags
          description: List of tags associated with the log entry.
          type: Unknown
        - contextPath: Datadog.Log.raw
          description: The raw log object returned by the API
          type: Unknown
  dockerimage: demisto/datadog-api-client:1.0.0.1832460
  isfetch: true
  runonce: false
  script: "-"
  subtype: python3
  type: python
defaultclassifier: Datadog Cloud SIEM
defaultmapperin: Datadog Cloud SIEM - Incoming Mapper
tests:
  - DatadogCloudSIEM
fromversion: 6.8.0
