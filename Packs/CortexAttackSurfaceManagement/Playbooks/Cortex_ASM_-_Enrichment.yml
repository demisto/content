contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.8.0
    itemVersion: 1.6.6
    packID: ""
    packName: Cortex Attack Surface Management
    prevname: ""
    toServerVersion: ""
description: Used as a container folder for all enrichments of ASM alerts.
id: 1ac104b4-7fe2-4f84-8bc9-f04c70956a01
inputs:
- description: IP address of service
  key: RemoteIP
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: remoteip
      root: alert
name: Cortex ASM - Enrichment
outputs:
- contextPath: ASM.ExternalService.externally_detected_providers
  description: Providers of the external service.
  type: unknown
sourceplaybookid: Cortex ASM - Enrichment
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 973e8c1c-42a9-4ccd-8375-38973c38ef70
      iscommand: false
      name: ""
      version: -1
    taskid: 973e8c1c-42a9-4ccd-8375-38973c38ef70
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 460,
          "y": -180
        }
      }
  "1":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.RemoteIP
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "68"
      "yes":
      - "3"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determines if the IP address has been supplied to proceed with
        cloud enrichment.
      id: 74ac93ec-42aa-4161-8726-8f7590499b98
      iscommand: false
      name: Is there an IP address?
      type: condition
      version: -1
    taskid: 74ac93ec-42aa-4161-8726-8f7590499b98
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 100,
          "y": 1195
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "61"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1e7ff599-ba18-424c-8d6a-12c5c8a85c7a
      iscommand: false
      name: ServiceNow CMDB Enrichment
      type: title
      version: -1
    taskid: 1e7ff599-ba18-424c-8d6a-12c5c8a85c7a
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 460,
          "y": 1620
        }
      }
  "6":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ASM.ExternalService
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "1"
      "yes":
      - "67"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determines if there was a result from the previous command to continue
        cloud enrichment.
      id: 9b397636-ddb5-4246-8f31-a4022c47c7f8
      iscommand: false
      name: Was there a result?
      type: condition
      version: -1
    taskid: 9b397636-ddb5-4246-8f31-a4022c47c7f8
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 460,
          "y": 345
        }
      }
  "7":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: externally_detected_providers
                root: ASM.ExternalService
          operator: containsGeneral
          right:
            value:
              simple: Amazon Web Services
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.RemoteIP
          operator: isNotEmpty
      label: AWS
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: externally_detected_providers
                root: ASM.ExternalService
          operator: containsGeneral
          right:
            value:
              simple: Google
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.RemoteIP
          operator: isNotEmpty
      label: GCP
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: externally_detected_providers
                root: ASM.ExternalService
          operator: containsGeneral
          right:
            value:
              simple: Azure
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.RemoteIP
          operator: isNotEmpty
      label: Azure
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "1"
      AWS:
      - "64"
      Azure:
      - "69"
      GCP:
      - "76"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determines which cloud provider the service is in order to direct
        to the correct enrichment.
      id: 3d407493-5c5c-4741-8d73-97ad45f33bc4
      iscommand: false
      name: What provider is this service?
      type: condition
      version: -1
    taskid: 3d407493-5c5c-4741-8d73-97ad45f33bc4
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 460,
          "y": 900
        }
      }
  "11":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: modules.brand
                    operator: isEqualString
                    right:
                      value:
                        simple: Cortex Attack Surface Management
                - - left:
                      iscontext: true
                      value:
                        simple: modules.state
                    operator: isEqualString
                    right:
                      value:
                        simple: active
                root: modules
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "1"
      "yes":
      - "66"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determines if the "Cortex Attack Surface Management" integration
        instance is configured to continue with cloud enrichment.
      id: f23aa70e-67e9-4f22-8579-b5572babf414
      iscommand: false
      name: Is Cortex ASM enabled?
      type: condition
      version: -1
    taskid: f23aa70e-67e9-4f22-8579-b5572babf414
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 460,
          "y": -40
        }
      }
  "35":
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9555c794-de43-48cb-8b83-adb31a046368
      iscommand: false
      name: Cloud Enrichment
      type: title
      version: -1
    taskid: 9555c794-de43-48cb-8b83-adb31a046368
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 460,
          "y": 755
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 916ec5b7-68e6-4e84-8dbd-4ff28b517183
      iscommand: false
      name: Complete
      type: title
      version: -1
    taskid: 916ec5b7-68e6-4e84-8dbd-4ff28b517183
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 100,
          "y": 3600
        }
      }
  "61":
    continueonerrortype: ""
    id: "61"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "62"
    note: false
    quietmode: 0
    scriptarguments:
      RemoteIP:
        complex:
          root: inputs.RemoteIP
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: ddc0b60e-65b0-44f6-8c66-a49647e0c48b
      iscommand: false
      name: Cortex ASM - ServiceNow CMDB Enrichment
      playbookId: Cortex ASM - ServiceNow CMDB Enrichment
      type: playbook
      version: -1
    taskid: ddc0b60e-65b0-44f6-8c66-a49647e0c48b
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 460,
          "y": 1770
        }
      }
  "62":
    continueonerrortype: ""
    id: "62"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "63"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 96c26f28-5353-4ada-85aa-10cbc4e7d225
      iscommand: false
      name: Tenable.io Enrichment
      type: title
      version: -1
    taskid: 96c26f28-5353-4ada-85aa-10cbc4e7d225
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 460,
          "y": 1940
        }
      }
  "63":
    continueonerrortype: ""
    id: "63"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "70"
    note: false
    quietmode: 0
    scriptarguments:
      IPAddress:
        complex:
          root: inputs.RemoteIP
          transformers:
          - operator: uniq
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: Given the IP address this playbook enriches Tenable.io information
        relevant to ASM alerts.
      id: 1e4ccaf4-8e3e-4169-805f-a3b38b68ef04
      iscommand: false
      name: Cortex ASM - Tenable.io Enrichment
      playbookId: Cortex ASM - Tenable.io Enrichment
      type: playbook
      version: -1
    taskid: 1e4ccaf4-8e3e-4169-805f-a3b38b68ef04
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 460,
          "y": 2090
        }
      }
  "64":
    continueonerrortype: ""
    id: "64"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      RemoteIP:
        complex:
          root: inputs.RemoteIP
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: Given the IP address this playbook enriches AWS information relevant
        to ASM alerts.
      id: d5f71f03-2b27-4980-8839-b70c7bc63592
      iscommand: false
      name: Cortex ASM - AWS Enrichment
      playbookId: Cortex ASM - AWS Enrichment
      type: playbook
      version: -1
    taskid: d5f71f03-2b27-4980-8839-b70c7bc63592
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 460,
          "y": 1365
        }
      }
  "66":
    continueonerrortype: ""
    id: "66"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      service_id:
        complex:
          accessor: asmserviceid
          root: alert
          transformers:
          - args:
              chars:
                value:
                  simple: '[\"]'
            operator: StripChars
    separatecontext: false
    skipunavailable: false
    task:
      brand: Cortex Attack Surface Management
      description: Get service details according to the service ID.
      id: 4bd235cd-da2c-4a0c-80a4-088e6165df79
      iscommand: true
      name: Get external service information
      script: Cortex Attack Surface Management|||asm-get-external-service
      type: regular
      version: -1
    taskid: 4bd235cd-da2c-4a0c-80a4-088e6165df79
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 460,
          "y": 170
        }
      }
  "67":
    continueonerrortype: ""
    id: "67"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "35"
    note: false
    quietmode: 0
    scriptarguments:
      protocol:
        complex:
          accessor: protocol
          root: ASM.ExternalService
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 41e3395e-fb6c-40b1-8c2d-476f84521162
      iscommand: true
      name: Set protocol
      script: Builtin|||setAlert
      type: regular
      version: -1
    taskid: 41e3395e-fb6c-40b1-8c2d-476f84521162
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 460,
          "y": 580
        }
      }
  "68":
    continueonerrortype: ""
    id: "68"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "77"
    note: false
    quietmode: 0
    scriptarguments:
      active_classifications:
        complex:
          accessor: active_classifications
          root: ASM.ExternalService
      asm_tags:
        complex:
          accessor: asmtags
          root: alert
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Identify whether the service is a "development" server. Development
        servers have no external users and run no production workflows. These servers
        might be named "dev", but they might also be named "qa", "pre-production",
        "user acceptance testing", or use other non-production terms. This automation
        uses both public data visible to anyone (`active_classifications` as derived
        by Xpanse ASM) as well as checking internal data for AI-learned indicators
        of development systems (`asm_tags` as derived from integrations with non-public
        systems).
      id: e9ad862d-ceb2-4721-89d9-5557d76d491e
      iscommand: false
      name: Infer whether service is used for development (vs. production)
      script: InferWhetherServiceIsDev
      type: regular
      version: -1
    taskid: e9ad862d-ceb2-4721-89d9-5557d76d491e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 100,
          "y": 3260
        }
      }
  "69":
    continueonerrortype: ""
    id: "69"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      RemoteIP:
        complex:
          root: inputs.RemoteIP
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: Given the IP address, this playbook enriches Azure information
        relevant to ASM alerts.
      id: 7407116c-86ee-45d4-824f-8af299d8b012
      iscommand: false
      name: Cortex ASM - Azure Enrichment
      playbookId: Cortex ASM - Azure Enrichment
      type: playbook
      version: -1
    taskid: 7407116c-86ee-45d4-824f-8af299d8b012
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1020,
          "y": 1100
        }
      }
  "70":
    continueonerrortype: ""
    id: "70"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "71"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d298bb5d-5a5f-4b9c-8476-40fecd8d6762
      iscommand: false
      name: Splunk Enrichment
      type: title
      version: -1
    taskid: d298bb5d-5a5f-4b9c-8476-40fecd8d6762
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 460,
          "y": 2260
        }
      }
  "71":
    continueonerrortype: ""
    id: "71"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "73"
    note: false
    quietmode: 0
    scriptarguments:
      IP:
        complex:
          root: inputs.RemoteIP
          transformers:
          - operator: uniq
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: 'Given the IP address this playbook enriches information from Splunk
        results relevant to ASM alerts. '
      id: 463a1acd-9e33-4e75-8d3a-6cf6841a4b31
      iscommand: false
      name: Cortex ASM - Splunk Enrichment
      playbookId: Cortex ASM - Splunk Enrichment
      type: playbook
      version: -1
    taskid: 463a1acd-9e33-4e75-8d3a-6cf6841a4b31
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 460,
          "y": 2400
        }
      }
  "72":
    continueonerrortype: ""
    id: "72"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "74"
    note: false
    quietmode: 0
    scriptarguments:
      IPAddress:
        complex:
          root: inputs.RemoteIP
          transformers:
          - operator: uniq
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: Given the IP address this playbook enriches Rapid7 InsightVM (Nexpose)
        information relevant to ASM alerts.
      id: 102c844b-44d9-4c9f-8482-01fd6ea2c9b8
      iscommand: false
      name: Cortex ASM - Rapid7 Enrichment
      playbookId: Cortex ASM - Rapid7 Enrichment
      type: playbook
      version: -1
    taskid: 102c844b-44d9-4c9f-8482-01fd6ea2c9b8
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 460,
          "y": 2700
        }
      }
  "73":
    continueonerrortype: ""
    id: "73"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "72"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a435a614-13a8-434c-8aec-5f7bae4ca9ef
      iscommand: false
      name: Rapid7 Enrichment
      type: title
      version: -1
    taskid: a435a614-13a8-434c-8aec-5f7bae4ca9ef
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 460,
          "y": 2570
        }
      }
  "74":
    continueonerrortype: ""
    id: "74"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "75"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b3d27726-daad-4708-823c-b71f4db2bebf
      iscommand: false
      name: Qualys Enrichment
      type: title
      version: -1
    taskid: b3d27726-daad-4708-823c-b71f4db2bebf
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 460,
          "y": 2870
        }
      }
  "75":
    continueonerrortype: ""
    id: "75"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      QualysIP:
        complex:
          root: inputs.RemoteIP
          transformers:
          - operator: uniq
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: Given the IP address this playbook enriches information from Qualys
        assets.
      id: 924ea54c-0400-4862-8b52-cf6a7c983640
      iscommand: false
      name: Cortex ASM - Qualys Enrichment
      playbookId: Cortex ASM - Qualys Enrichment
      type: playbook
      version: -1
    taskid: 924ea54c-0400-4862-8b52-cf6a7c983640
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 460,
          "y": 3000
        }
      }
  "76":
    continueonerrortype: ""
    id: "76"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: Given the IP address this playbook enriches GCP information relevant
        to ASM alerts.
      id: d8ae13fc-7716-44a4-8072-da90531cbe5b
      iscommand: false
      name: Cortex ASM - GCP Enrichment_ACES-2509
      playbookId: e9149a70-29da-472c-8159-b5918264a4f9
      type: playbook
      version: -1
    taskid: d8ae13fc-7716-44a4-8072-da90531cbe5b
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 780,
          "y": 1250
        }
      }
  "77":
    continueonerrortype: ""
    id: "77"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: f83809e9-54d6-47e5-8025-0c0a6a63daeb
      iscommand: false
      name: Cortex ASM - Service Ownership
      playbookId: 3a1ae341-bbe0-4da9-85f1-527b508efd74
      type: playbook
      version: -1
    taskid: f83809e9-54d6-47e5-8025-0c0a6a63daeb
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 100,
          "y": 3430
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "11_1_#default#": 0.2,
      "11_66_yes": 0.59,
      "1_3_yes": 0.24,
      "6_1_#default#": 0.25,
      "6_67_yes": 0.62,
      "7_1_#default#": 0.35,
      "7_69_Azure": 0.81
    },
    "paper": {
      "dimensions": {
        "height": 3845,
        "width": 1300,
        "x": 100,
        "y": -180
      }
    }
  }
