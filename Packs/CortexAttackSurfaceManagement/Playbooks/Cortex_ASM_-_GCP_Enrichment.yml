id: Cortex ASM - GCP Enrichment
version: -1
name: Cortex ASM - GCP Enrichment
description: Given the IP address this playbook enriches GCP and Firewall information.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: dbe146a1-33df-422f-88ef-96f6ab6e847d
    type: start
    task:
      id: dbe146a1-33df-422f-88ef-96f6ab6e847d
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 877.5,
          "y": 20
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 3dfc02cd-76ff-4275-84f7-6dc2f3827cda
    type: playbook
    task:
      id: 3dfc02cd-76ff-4275-84f7-6dc2f3827cda
      version: -1
      name: GCP - Enrichment
      description: Given the IP address this playbook enriches GCP and Firewall information.
      playbookName: GCP - Enrichment
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      GcpIP:
        complex:
          root: inputs.RemoteIP
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 877.5,
          "y": 165
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: 14253757-0e5a-4790-8c58-34d93183dd31
    type: title
    task:
      id: 14253757-0e5a-4790-8c58-34d93183dd31
      version: -1
      name: Set Field
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "4"
      - "5"
      - "3"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 877.5,
          "y": 340
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 015af593-0ef3-4a73-8292-4b290428e480
    type: condition
    task:
      id: 015af593-0ef3-4a73-8292-4b290428e480
      version: -1
      name: Is there VM and IAM information?
      description: Determines if there is EC2 information to set the private IP, cloud, and tags fields.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "48"
      "yes":
      - "14"
      - "17"
      - "15"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: GoogleCloudCompute
                accessor: Instances
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2010,
          "y": 540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: c5f01515-ae90-4fb0-8b0f-0da3d2113ad6
    type: condition
    task:
      id: c5f01515-ae90-4fb0-8b0f-0da3d2113ad6
      version: -1
      name: Is there IAM information?
      description: Determines if there is IAM information to set in the service owner field.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "41"
      "yes":
      - "11"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: GCPIAM.Policy.bindings
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: GCPIAM.Policy.bindings.role
                      iscontext: true
                    right:
                      value:
                        simple: roles/owner
                accessor: members
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 100,
          "y": 485
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: f593001c-d9d6-4e88-85df-7b596c3347a8
    type: condition
    task:
      id: f593001c-d9d6-4e88-85df-7b596c3347a8
      version: -1
      name: Is there VM and firewall information?
      description: Determines if there is EC2 and security group information to set in the system IDs field.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "41"
      "yes":
      - "19"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: GoogleCloudCompute
                accessor: Instances
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: GoogleCloudCompute
                accessor: Firewalls
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 877.5,
          "y": 485
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: f9be4f60-d0b4-44d6-8bbb-837d8b188ab3
    type: regular
    task:
      id: f9be4f60-d0b4-44d6-8bbb-837d8b188ab3
      version: -1
      name: Set service owner grid field
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "42"
    scriptarguments:
      gridfield:
        simple: asmserviceowner
      keys:
        simple: Name,Email,Source,Timestamp
      val1:
        simple: n/a
      val2:
        complex:
          root: GCPIAM.Policy.bindings
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: GCPIAM.Policy.bindings.role
                iscontext: true
              right:
                value:
                  simple: roles/owner
          accessor: members
          transformers:
          - operator: replace
            args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: 'user:'
      val3:
        simple: GCP
      val4:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 100,
          "y": 850
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: ff06de29-44b2-467b-81f9-65c2cb084185
    type: title
    task:
      id: ff06de29-44b2-467b-81f9-65c2cb084185
      version: -1
      name: Service Owner
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "10"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 100,
          "y": 700
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: 7b74119c-f21a-444c-8f0e-1c7d2a72025e
    type: regular
    task:
      id: 7b74119c-f21a-444c-8f0e-1c7d2a72025e
      version: -1
      name: Set private IP grid field
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "50"
    scriptarguments:
      gridfield:
        simple: asmprivateip
      keys:
        simple: IP,Source
      val1:
        complex:
          root: GoogleCloudCompute.Instances.networkInterfaces
          accessor: networkIP
          transformers:
          - operator: uniq
      val2:
        simple: GCP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2402.5,
          "y": 1005
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 64ae29b4-a3c1-41f5-8af0-c95ef01505c4
    type: title
    task:
      id: 64ae29b4-a3c1-41f5-8af0-c95ef01505c4
      version: -1
      name: Private IP
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "13"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2402.5,
          "y": 865
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: c215497e-de3e-4b6f-86e5-03589f564f00
    type: title
    task:
      id: c215497e-de3e-4b6f-86e5-03589f564f00
      version: -1
      name: Cloud
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "39"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1557.5,
          "y": 765
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: 27065b27-56ef-47cd-8661-08655a96e333
    type: regular
    task:
      id: 27065b27-56ef-47cd-8661-08655a96e333
      version: -1
      name: Set cloud grid field
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "53"
    scriptarguments:
      gridfield:
        simple: asmcloud
      keys:
        simple: Provider,Organization,Project,Region,Other
      val1:
        simple: GCP
      val2:
        simple: n/a
      val3:
        complex:
          root: GoogleCloudCompute.Instances.networkInterfaces
          accessor: network
          transformers:
          - operator: RegexExtractAll
            args:
              error_if_no_match: {}
              ignore_case: {}
              multi_line: {}
              period_matches_newline: {}
              regex:
                value:
                  simple: (?<=projects/)[^/]+(?=/global)
              unpack_matches: {}
          - operator: uniq
      val4:
        complex:
          root: GoogleCloudCompute.Instances
          accessor: zone
          transformers:
          - operator: uniq
      val5:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1547.5,
          "y": 1275
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: 32e53423-305f-40d8-8164-48ed34593540
    type: title
    task:
      id: 32e53423-305f-40d8-8164-48ed34593540
      version: -1
      name: Tags
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "29"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2872.5,
          "y": 820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: cf9c3ca8-77de-425a-8255-a14b956860e0
    type: regular
    task:
      id: cf9c3ca8-77de-425a-8255-a14b956860e0
      version: -1
      name: Set tags grid field
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "52"
    scriptarguments:
      gridfield:
        simple: asmtags
      keys:
        simple: Key,Value,Source
      val1:
        complex:
          root: GoogleCloudCompute.Instances
          accessor: labels
          transformers:
          - operator: jmespath
            args:
              expression:
                value:
                  simple: keys(@)
      val2:
        complex:
          root: GoogleCloudCompute.Instances
          accessor: labels
          transformers:
          - operator: jmespath
            args:
              expression:
                value:
                  simple: values(@)
      val3:
        simple: GCP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2872.5,
          "y": 1170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: 7df92775-deb3-415c-8fec-17f00a985b49
    type: title
    task:
      id: 7df92775-deb3-415c-8fec-17f00a985b49
      version: -1
      name: System IDs
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "20"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 2e861db4-0fc1-4b3d-80d0-3393724288ed
    type: regular
    task:
      id: 2e861db4-0fc1-4b3d-80d0-3393724288ed
      version: -1
      name: Set system IDs grid field (VPC)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "21"
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: Type,ID,Link
      val1:
        simple: GCP-VPC
      val2:
        complex:
          root: GoogleCloudCompute.Instances.networkInterfaces
          accessor: network
          transformers:
          - operator: uniq
      val3:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 835
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: aaeed8d9-6386-43ce-8ee4-41ed0a541075
    type: regular
    task:
      id: aaeed8d9-6386-43ce-8ee4-41ed0a541075
      version: -1
      name: Set system IDs grid field (FW)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: Type,ID,Link
      val1:
        simple: GCP-FW
      val2:
        complex:
          root: GoogleCloudCompute.Firewalls
          accessor: id
          transformers:
          - operator: uniq
      val3:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 1010
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 85b26450-10c6-4801-80bd-cd2b7e7b875a
    type: regular
    task:
      id: 85b26450-10c6-4801-80bd-cd2b7e7b875a
      version: -1
      name: Set system IDs grid field (NET)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: Type,ID,Link
      val1:
        simple: GCP-NET
      val2:
        complex:
          root: GoogleCloudCompute.Instances.networkInterfaces
          accessor: subnetwork
          transformers:
          - operator: uniq
      val3:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 1185
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: cf23d625-ff3c-4881-8d14-404cd56a8329
    type: regular
    task:
      id: cf23d625-ff3c-4881-8d14-404cd56a8329
      version: -1
      name: Set system IDs grid field (NIC)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "24"
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: Type,ID,Link
      val1:
        simple: GCP-NIC
      val2:
        complex:
          root: GoogleCloudCompute.Instances.networkInterfaces
          accessor: name
          transformers:
          - operator: uniq
      val3:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 1360
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: 59fcc2b7-0add-41fd-8f62-e1e7cd570bed
    type: regular
    task:
      id: 59fcc2b7-0add-41fd-8f62-e1e7cd570bed
      version: -1
      name: Set system IDs grid field (VM)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "26"
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: Type,ID,Link
      val1:
        simple: GCP-VM
      val2:
        complex:
          root: GoogleCloudCompute.Instances
          accessor: id
          transformers:
          - operator: uniq
      val3:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 1535
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: 0352236d-97d9-448f-858e-b9ac35e0ba6d
    type: regular
    task:
      id: 0352236d-97d9-448f-858e-b9ac35e0ba6d
      version: -1
      name: Set system IDs grid field (ZONE)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: Type,ID,Link
      val1:
        simple: GCP-ZONE
      val2:
        complex:
          root: GoogleCloudCompute.Instances
          accessor: zone
          transformers:
          - operator: uniq
          - operator: RegexExtractAll
            args:
              error_if_no_match: {}
              ignore_case: {}
              multi_line: {}
              period_matches_newline: {}
              regex:
                value:
                  simple: (?<=zones\/)[^$]+
              unpack_matches: {}
      val3:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 1710
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: bc60cb8b-bc9e-49d9-8904-9509f2c3c5c6
    type: regular
    task:
      id: bc60cb8b-bc9e-49d9-8904-9509f2c3c5c6
      version: -1
      name: Set system IDs grid field (VM NAME)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "47"
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: Type,ID,Link
      val1:
        simple: GCP-VMNAME
      val2:
        complex:
          root: GoogleCloudCompute.Instances
          accessor: name
          transformers:
          - operator: uniq
      val3:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 1885
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: 09364e76-faae-445e-8835-52e1b751bd62
    type: condition
    task:
      id: 09364e76-faae-445e-8835-52e1b751bd62
      version: -1
      name: Are there any tags?
      description: |+
        Check whether there are any tags associated to instances.

      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "49"
      "yes":
      - "18"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: GoogleCloudCompute.Instances
                accessor: labels
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2872.5,
          "y": 950
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: 8faf407e-20e2-491d-89cb-586a8108d030
    type: condition
    task:
      id: 8faf407e-20e2-491d-89cb-586a8108d030
      version: -1
      name: Is service account field set?
      description: Determines if a service account associated with the Cloud Compute Instance was discovered and set on the alert.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "40"
      "yes":
      - "32"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: GoogleCloudCompute.Instances.serviceAccounts
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 100,
          "y": 1205
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: f12d8815-6ce0-4d15-8131-87341587f17f
    type: regular
    task:
      id: f12d8815-6ce0-4d15-8131-87341587f17f
      version: -1
      name: Add service account to unranked service owner list
      description: |-
        Automation used to more easily populate a grid field.  This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Example of command:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "40"
    scriptarguments:
      gridfield:
        simple: asmserviceownerunrankedraw
      keys:
        simple: name,email,source,timestamp
      val1:
        simple: n/a
      val2:
        complex:
          root: GoogleCloudCompute.Instances
          accessor: serviceAccounts
          transformers:
          - operator: getField
            args:
              field:
                value:
                  simple: email
      val3:
        simple: GCP
      val4:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 100,
          "y": 1425
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: c762786e-d5a3-40c7-8a05-044b10254a9a
    type: condition
    task:
      id: c762786e-d5a3-40c7-8a05-044b10254a9a
      version: -1
      name: Is there GCP project hierarchy information?
      description: Determines if there is GCP hierarchy information to set in the system IDs field.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "43"
      "yes":
      - "34"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: GCPHierarchy
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: GCPHierarchy.level
                      iscontext: true
                    right:
                      value:
                        simple: project
                accessor: number
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 2280
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: 951847ff-8bef-4c13-89e8-3cf22ec83384
    type: regular
    task:
      id: 951847ff-8bef-4c13-89e8-3cf22ec83384
      version: -1
      name: Set system IDs grid field (Project-Number)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "35"
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: Type,ID,Link
      val1:
        simple: GCP-Project-Number
      val2:
        complex:
          root: GCPHierarchy
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: GCPHierarchy.level
                iscontext: true
              right:
                value:
                  simple: project
          accessor: number
          transformers:
          - operator: replace
            args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: projects/
      val3:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 2510
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: 60b31782-414e-4569-8217-31562b4d9ada
    type: condition
    task:
      id: 60b31782-414e-4569-8217-31562b4d9ada
      version: -1
      name: Is there GCP folder hierarchy information?
      description: Determines if there is GCP folder hierarchy information to set in the system IDs field.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "43"
      "yes":
      - "36"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: GCPHierarchy.number
                filters:
                - - operator: containsGeneral
                    left:
                      value:
                        simple: GCPHierarchy.number
                      iscontext: true
                    right:
                      value:
                        simple: folders/
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 2720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: 193fa9e5-4717-42ac-8daa-eaaf709fa7f6
    type: regular
    task:
      id: 193fa9e5-4717-42ac-8daa-eaaf709fa7f6
      version: -1
      name: Set system IDs grid field (Folder-Number)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "43"
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: Type,ID,Link
      val1:
        simple: GCP-Folder-Number
      val2:
        complex:
          root: GCPHierarchy.number
          filters:
          - - operator: containsGeneral
              left:
                value:
                  simple: GCPHierarchy.number
                iscontext: true
              right:
                value:
                  simple: folders/
          transformers:
          - operator: replace
            args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: folders/
      val3:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 2960
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: 4bf3daa2-4b86-495e-8598-df15e4c08260
    type: regular
    task:
      id: 4bf3daa2-4b86-495e-8598-df15e4c08260
      version: -1
      name: Set Folders
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      key:
        simple: folder-ids
      value:
        complex:
          root: GCPHierarchy.id
          filters:
          - - operator: startWith
              left:
                value:
                  simple: GCPHierarchy.id
                iscontext: true
              right:
                value:
                  simple: folders/
          transformers:
          - operator: join
            args:
              separator:
                value:
                  simple: ','
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1802.5,
          "y": 1075
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: 5bec340c-a108-49d5-83fa-fc5051f342ed
    type: regular
    task:
      id: 5bec340c-a108-49d5-83fa-fc5051f342ed
      version: -1
      name: Set Folders to n/a
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      key:
        simple: folder-ids
      value:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1402.5,
          "y": 1075
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: 8b923853-4fd6-4667-8eec-917a023121ad
    type: condition
    task:
      id: 8b923853-4fd6-4667-8eec-917a023121ad
      version: -1
      name: Are there any folders?
      description: Determines if there is GCP folder information to set in the cloud field.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "38"
      "yes":
      - "37"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: GCPHierarchy.id
                filters:
                - - operator: startWith
                    left:
                      value:
                        simple: GCPHierarchy.id
                      iscontext: true
                    right:
                      value:
                        simple: folders/
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1557.5,
          "y": 875
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: 40044337-82d2-4b70-88bd-263c60a70bdb
    type: title
    task:
      id: 40044337-82d2-4b70-88bd-263c60a70bdb
      version: -1
      name: Service Owner - End
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "45"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 100,
          "y": 1665
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: d7765638-8dcd-4d84-89e0-1fc635ad0ec5
    type: regular
    task:
      id: d7765638-8dcd-4d84-89e0-1fc635ad0ec5
      version: -1
      name: Set false flag for completed enrichment
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "43"
      - "40"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: asm_enrichment_flag_gcp
      value:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 520,
          "y": 1205
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: ae940b20-cf23-48ce-8f39-b506f2602941
    type: regular
    task:
      id: ae940b20-cf23-48ce-8f39-b506f2602941
      version: -1
      name: Set true flag for completed enrichment
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: asm_enrichment_flag_gcp
      value:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 100,
          "y": 1030
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: a5d02de9-8973-4df0-835b-d748d246ba31
    type: title
    task:
      id: a5d02de9-8973-4df0-835b-d748d246ba31
      version: -1
      name: System IDs - End
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "45"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 740,
          "y": 3150
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "44":
    id: "44"
    taskid: 53e9bcc6-7233-4af0-836c-b5c1c2182add
    type: title
    task:
      id: 53e9bcc6-7233-4af0-836c-b5c1c2182add
      version: -1
      name: Complete
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1547.5,
          "y": 3950
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: b6543fde-80e6-45ee-8a9e-81d797060fe8
    type: title
    task:
      id: b6543fde-80e6-45ee-8a9e-81d797060fe8
      version: -1
      name: Closing Steps
      description: |-
        Automation used to more easily populate a grid field.  This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format. For example:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      type: title
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "56"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1547.5,
          "y": 3370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: 4e5751df-756d-4327-8aad-3fc0a947144e
    type: regular
    task:
      id: 4e5751df-756d-4327-8aad-3fc0a947144e
      version: -1
      name: Set true flag for completed enrichment
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "33"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: asm_enrichment_flag_gcp
      value:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 2060
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: 6cfd1678-f091-42aa-8dc5-5be506d6cfa0
    type: regular
    task:
      id: 6cfd1678-f091-42aa-8dc5-5be506d6cfa0
      version: -1
      name: Set false flag for completed enrichment
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "45"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: asm_enrichment_flag_gcp
      value:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2010,
          "y": 1520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: 264505ec-e441-4ce2-8df1-f58d73185c1f
    type: title
    task:
      id: 264505ec-e441-4ce2-8df1-f58d73185c1f
      version: -1
      name: Tags - End
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "45"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2872.5,
          "y": 1535
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: 12cd846a-2676-4945-8660-268d4102ef7b
    type: regular
    task:
      id: 12cd846a-2676-4945-8660-268d4102ef7b
      version: -1
      name: Set true flag for completed enrichment
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "51"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: asm_enrichment_flag_gcp
      value:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2402.5,
          "y": 1170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: 9d1a195c-5b64-4b62-8392-95cbfe681251
    type: title
    task:
      id: 9d1a195c-5b64-4b62-8392-95cbfe681251
      version: -1
      name: Private IP - End
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "45"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2402.5,
          "y": 1370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "52":
    id: "52"
    taskid: 7cc3857c-ae1c-427a-8bdd-f7a999d5e81a
    type: regular
    task:
      id: 7cc3857c-ae1c-427a-8bdd-f7a999d5e81a
      version: -1
      name: Set true flag for completed enrichment
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "49"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: asm_enrichment_flag_gcp
      value:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2872.5,
          "y": 1340
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: dce12328-fbf8-4ae5-83ab-2682f31bece1
    type: regular
    task:
      id: dce12328-fbf8-4ae5-83ab-2682f31bece1
      version: -1
      name: Set true flag for completed enrichment
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "54"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: asm_enrichment_flag_gcp
      value:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1547.5,
          "y": 1455
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "54":
    id: "54"
    taskid: 499b32bb-461f-4155-8880-31c02e452211
    type: title
    task:
      id: 499b32bb-461f-4155-8880-31c02e452211
      version: -1
      name: Cloud - End
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "45"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1547.5,
          "y": 1620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "55":
    id: "55"
    taskid: 11088f47-12dd-4d26-8bdb-c2d896f28d13
    type: regular
    task:
      id: 11088f47-12dd-4d26-8bdb-c2d896f28d13
      version: -1
      name: Set ASM enrichment status to true
      description: |-
        Automation used to more easily populate a grid field.  This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format. For example:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "44"
    scriptarguments:
      gridfield:
        simple: asmenrichmentstatus
      keys:
        simple: source,record_exists,timestamp
      val1:
        simple: GCP
      val2:
        complex:
          root: "true"
          transformers:
          - operator: Stringify
      val3:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1782.5,
          "y": 3730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "56":
    id: "56"
    taskid: 7cc9ed32-f001-4dc1-854e-78562e6c6153
    type: condition
    task:
      id: 7cc9ed32-f001-4dc1-854e-78562e6c6153
      version: -1
      name: Was enrichment performed?
      type: condition
      description: Check if enrichment was performed by checking for a value of true in the relevant flag variable
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "57"
      "yes":
      - "55"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: asm_enrichment_flag_gcp
            iscontext: true
          right:
            value:
              simple: "true"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1547.5,
          "y": 3510
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "57":
    id: "57"
    taskid: de746bac-6a4c-4faf-8679-853a120b5cb5
    type: regular
    task:
      id: de746bac-6a4c-4faf-8679-853a120b5cb5
      version: -1
      name: Set ASM enrichment status to false
      description: |-
        Automation used to more easily populate a grid field.  This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format. For example:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "44"
    scriptarguments:
      gridfield:
        simple: asmenrichmentstatus
      keys:
        simple: source,record_exists,timestamp
      val1:
        simple: GCP
      val2:
        complex:
          root: "false"
          transformers:
          - operator: Stringify
      val3:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1330,
          "y": 3730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "29_18_yes": 0.56,
      "31_32_yes": 0.68,
      "33_34_yes": 0.5,
      "33_43_#default#": 0.11,
      "35_36_yes": 0.54,
      "35_43_#default#": 0.2,
      "39_37_yes": 0.63,
      "39_38_#default#": 0.65,
      "3_17_yes": 0.76,
      "4_41_#default#": 0.31,
      "5_41_#default#": 0.41
    },
    "paper": {
      "dimensions": {
        "height": 3995,
        "width": 3152.5,
        "x": 100,
        "y": 20
      }
    }
  }
inputs:
- key: RemoteIP
  value:
    complex:
      root: alert
      accessor: remoteip
  required: false
  description: IP address of service
  playbookInputQuery:
outputs: []
tests:
- No tests (auto formatted)
fromversion: 6.8.0
