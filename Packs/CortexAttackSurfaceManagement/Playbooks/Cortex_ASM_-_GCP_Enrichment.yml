contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.5.0
    itemVersion: 1.6.6
    packID: ""
    packName: Cortex Attack Surface Management
    prevname: ""
    toServerVersion: ""
description: Given the IP address this playbook enriches GCP information relevant
  to ASM alerts.
id: e9149a70-29da-472c-8159-b5918264a4f9
inputs:
- description: IP address of service
  key: RemoteIP
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: remoteip
      root: alert
name: Cortex ASM - GCP Enrichment
outputs: []
sourceplaybookid: Cortex ASM - GCP Enrichment
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c6245be9-c179-4ae5-8349-e6f38b3c9204
      iscommand: false
      name: ""
      version: -1
    taskid: c6245be9-c179-4ae5-8349-e6f38b3c9204
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 450,
          "y": 50
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      GcpIP:
        complex:
          root: inputs.RemoteIP
    separatecontext: true
    skipunavailable: true
    task:
      brand: ""
      description: Given the IP address this playbook enriches GCP and Firewall information.
      id: 17107715-e114-4007-8d78-dbe7b96251ff
      iscommand: false
      name: GCP - Enrichment
      playbookId: GCP - Enrichment
      type: playbook
      version: -1
    taskid: 17107715-e114-4007-8d78-dbe7b96251ff
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 450,
          "y": 210
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
      - "5"
      - "3"
      - "35"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ee4812d0-34d9-41e9-8ddc-58390e5371eb
      iscommand: false
      name: Set Field
      type: title
      version: -1
    taskid: ee4812d0-34d9-41e9-8ddc-58390e5371eb
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 450,
          "y": 370
        }
      }
  "3":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Instances
                root: GoogleCloudCompute
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "9"
      "yes":
      - "15"
      - "14"
      - "17"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determines if there is EC2 information to set the private IP, cloud,
        and tags fields.
      id: 88926de3-c3aa-4c0d-85d7-33bbc47513c2
      iscommand: false
      name: Is there VM and IAM information?
      type: condition
      version: -1
    taskid: 88926de3-c3aa-4c0d-85d7-33bbc47513c2
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1380,
          "y": 590
        }
      }
  "4":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: members
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: GCPIAM.Policy.bindings.role
                    operator: isEqualString
                    right:
                      value:
                        simple: roles/owner
                root: GCPIAM.Policy.bindings
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "9"
      "yes":
      - "11"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determines if there is IAM information to set in the service owner
        field.
      id: 0d552da2-08ef-41c5-88d8-8a46a1e96d02
      iscommand: false
      name: Is there IAM information?
      type: condition
      version: -1
    taskid: 0d552da2-08ef-41c5-88d8-8a46a1e96d02
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -160,
          "y": 575
        }
      }
  "5":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Instances
                root: GoogleCloudCompute
          operator: isNotEmpty
          right:
            value: {}
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Firewalls
                root: GoogleCloudCompute
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "9"
      "yes":
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determines if there is EC2 and security group information to set
        in the system IDs field.
      id: 52473054-d75a-4982-8ee7-2ce9f2bcca8d
      iscommand: false
      name: Is there VM and firewall information?
      type: condition
      version: -1
    taskid: 52473054-d75a-4982-8ee7-2ce9f2bcca8d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 290,
          "y": 575
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 94c8bed8-1a07-4c51-83c0-56090e12ae5d
      iscommand: false
      name: Complete
      type: title
      version: -1
    taskid: 94c8bed8-1a07-4c51-83c0-56090e12ae5d
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 290,
          "y": 2190
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmserviceowner
      keys:
        simple: Name,Email,Source,Timestamp
      val1:
        simple: n/a
      val2:
        complex:
          accessor: members
          filters:
          - - left:
                iscontext: true
                value:
                  simple: GCPIAM.Policy.bindings.role
              operator: isEqualString
              right:
                value:
                  simple: roles/owner
          root: GCPIAM.Policy.bindings
          transformers:
          - args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: 'user:'
            operator: replace
      val3:
        simple: GCP
      val4:
        complex:
          root: TimeNowUnix
          transformers:
          - operator: TimeStampToDate
    separatecontext: false
    skipunavailable: true
    task:
      brand: Builtin
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: e33f7077-89fb-45d2-84e9-6c28941a00c6
      iscommand: false
      name: Set service owner grid field
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: e33f7077-89fb-45d2-84e9-6c28941a00c6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -150,
          "y": 1140
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1fc0f8de-68ac-49eb-8d8a-921918de4134
      iscommand: false
      name: Service Owner
      type: title
      version: -1
    taskid: 1fc0f8de-68ac-49eb-8d8a-921918de4134
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -150,
          "y": 855
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |
        Retrieves the current date and time.
      id: 2883c07f-4e15-4c82-8d36-041e0b5fba8e
      iscommand: false
      name: Get current time
      script: GetTime
      type: regular
      version: -1
    taskid: 2883c07f-4e15-4c82-8d36-041e0b5fba8e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -150,
          "y": 980
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmprivateip
      keys:
        simple: IP,Source
      val1:
        complex:
          accessor: networkIP
          root: GoogleCloudCompute.Instances.networkInterfaces
          transformers:
          - operator: uniq
      val2:
        simple: GCP
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: 347f1271-f64c-439d-8eb9-67e5a95b0d37
      iscommand: false
      name: Set private IP grid field
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: 347f1271-f64c-439d-8eb9-67e5a95b0d37
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 950,
          "y": 1045
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2829b3eb-1003-41ce-82b2-ab5e69b1a7fa
      iscommand: false
      name: Private IP
      type: title
      version: -1
    taskid: 2829b3eb-1003-41ce-82b2-ab5e69b1a7fa
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 950,
          "y": 925
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fc1927bb-a661-4ced-8f9d-05eeb7bef60e
      iscommand: false
      name: Cloud
      type: title
      version: -1
    taskid: fc1927bb-a661-4ced-8f9d-05eeb7bef60e
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1370,
          "y": 925
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmcloud
      keys:
        simple: Provider,Organization,Project,Region,Other
      val1:
        simple: GCP
      val2:
        simple: n/a
      val3:
        complex:
          accessor: network
          root: GoogleCloudCompute.Instances.networkInterfaces
          transformers:
          - args:
              error_if_no_match: {}
              ignore_case: {}
              multi_line: {}
              period_matches_newline: {}
              regex:
                value:
                  simple: (?<=projects/)[^/]+(?=/global)
              unpack_matches: {}
            operator: RegexExtractAll
          - operator: uniq
      val4:
        complex:
          accessor: zone
          root: GoogleCloudCompute.Instances
          transformers:
          - operator: uniq
      val5:
        simple: n/a
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: f7ee4b2f-ac30-4ba1-8255-6f24b48fa7f0
      iscommand: false
      name: Set cloud grid field
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: f7ee4b2f-ac30-4ba1-8255-6f24b48fa7f0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1370,
          "y": 1045
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d1020633-769e-485e-84e1-7eb9635e8062
      iscommand: false
      name: Tags - Compute Instance
      type: title
      version: -1
    taskid: d1020633-769e-485e-84e1-7eb9635e8062
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1810,
          "y": 920
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmtags
      keys:
        simple: Key,Value,Source
      val1:
        complex:
          accessor: labels
          root: GoogleCloudCompute.Instances
          transformers:
          - args:
              expression:
                value:
                  simple: keys(@)
            operator: jmespath
      val2:
        complex:
          accessor: labels
          root: GoogleCloudCompute.Instances
          transformers:
          - args:
              expression:
                value:
                  simple: values(@)
            operator: jmespath
      val3:
        simple: GCP-instance-labels
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: 6a45462b-7c61-49d9-83d5-f7224a92dd39
      iscommand: false
      name: Set tags grid field
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: 6a45462b-7c61-49d9-83d5-f7224a92dd39
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1810,
          "y": 1265
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2ef6effe-0d79-414a-802e-6d8063a54ec0
      iscommand: false
      name: System IDs
      type: title
      version: -1
    taskid: 2ef6effe-0d79-414a-802e-6d8063a54ec0
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 500,
          "y": 875
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "21"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: Type,ID,Link
      val1:
        simple: GCP-VPC
      val2:
        complex:
          accessor: network
          root: GoogleCloudCompute.Instances.networkInterfaces
          transformers:
          - operator: uniq
      val3:
        simple: n/a
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: 4c5da6f0-bddb-4add-8825-05dab108e917
      iscommand: false
      name: Set system IDs grid field (VPC)
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: 4c5da6f0-bddb-4add-8825-05dab108e917
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 500,
          "y": 1000
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: Type,ID,Link
      val1:
        simple: GCP-FW
      val2:
        complex:
          accessor: id
          root: GoogleCloudCompute.Firewalls
          transformers:
          - operator: uniq
      val3:
        simple: n/a
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: fa10f9e8-d55c-48b9-8262-ec2828d18cbc
      iscommand: false
      name: Set system IDs grid field (FW)
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: fa10f9e8-d55c-48b9-8262-ec2828d18cbc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 500,
          "y": 1150
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: Type,ID,Link
      val1:
        simple: GCP-NET
      val2:
        complex:
          accessor: subnetwork
          root: GoogleCloudCompute.Instances.networkInterfaces
          transformers:
          - operator: uniq
      val3:
        simple: n/a
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: e54a35cb-f1a2-425c-87fc-c338801f02af
      iscommand: false
      name: Set system IDs grid field (NET)
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: e54a35cb-f1a2-425c-87fc-c338801f02af
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 500,
          "y": 1300
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: Type,ID,Link
      val1:
        simple: GCP-NIC
      val2:
        complex:
          accessor: name
          root: GoogleCloudCompute.Instances.networkInterfaces
          transformers:
          - operator: uniq
      val3:
        simple: n/a
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: b415384b-b74b-445b-8dbf-6880e04b2e40
      iscommand: false
      name: Set system IDs grid field (NIC)
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: b415384b-b74b-445b-8dbf-6880e04b2e40
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 500,
          "y": 1460
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: Type,ID,Link
      val1:
        simple: GCP-VM
      val2:
        complex:
          accessor: id
          root: GoogleCloudCompute.Instances
          transformers:
          - operator: uniq
      val3:
        simple: n/a
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: 2db9ad64-599f-45d3-8d59-44283d3e8851
      iscommand: false
      name: Set system IDs grid field (VM)
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: 2db9ad64-599f-45d3-8d59-44283d3e8851
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 500,
          "y": 1610
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: Type,ID,Link
      val1:
        simple: GCP-ZONE
      val2:
        complex:
          accessor: zone
          root: GoogleCloudCompute.Instances
          transformers:
          - operator: uniq
          - args:
              error_if_no_match: {}
              ignore_case: {}
              multi_line: {}
              period_matches_newline: {}
              regex:
                value:
                  simple: (?<=zones\/)[^$]+
              unpack_matches: {}
            operator: RegexExtractAll
      val3:
        simple: n/a
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: 97bc1ae8-d977-4740-845c-a8c604abbca8
      iscommand: false
      name: Set system IDs grid field (ZONE)
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: 97bc1ae8-d977-4740-845c-a8c604abbca8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 500,
          "y": 1770
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: Type,ID,Link
      val1:
        simple: GCP-VMNAME
      val2:
        complex:
          accessor: name
          root: GoogleCloudCompute.Instances
          transformers:
          - operator: uniq
      val3:
        simple: n/a
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: e985a34e-00d0-4cc2-869f-acceb58716ce
      iscommand: false
      name: Set system IDs grid field (VM NAME)
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: e985a34e-00d0-4cc2-869f-acceb58716ce
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 500,
          "y": 1920
        }
      }
  "29":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: labels
                root: GoogleCloudCompute.Instances
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "9"
      "yes":
      - "18"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |+
        Check whether there are any tags associated to instances.

      id: bbb34ae1-c8fb-4877-8217-23df14b96c4a
      iscommand: false
      name: Are there any tags?
      type: condition
      version: -1
    taskid: bbb34ae1-c8fb-4877-8217-23df14b96c4a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1810,
          "y": 1065
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmtags
      keys:
        simple: Key,Value,Source
      val1:
        complex:
          accessor: key
          root: GCPIAM.TagBindings
      val2:
        complex:
          accessor: value
          root: GCPIAM.TagBindings
      val3:
        simple: GCP-project-folder-tags
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: 6326d4c8-637a-4734-8134-808b2bcbb99b
      iscommand: false
      name: Set tags grid field
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: 6326d4c8-637a-4734-8134-808b2bcbb99b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2230,
          "y": 1265
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "32"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1414247b-89e4-4a4d-88da-ca5ed991128d
      iscommand: false
      name: Tags - Project/Folder/Organization Tags
      type: title
      version: -1
    taskid: 1414247b-89e4-4a4d-88da-ca5ed991128d
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2230,
          "y": 920
        }
      }
  "35":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: TagBindings
                root: GCPIAM
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "9"
      "yes":
      - "34"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determines if there is GCP-IAM tagbindings information to populate
        tags field.
      id: 222d3b79-ea1b-4633-8f89-2c293e2066c7
      iscommand: false
      name: Is there tagbinding information?
      type: condition
      version: -1
    taskid: 222d3b79-ea1b-4633-8f89-2c293e2066c7
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2230,
          "y": 590
        }
      }
  "36":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: GoogleCloudCompute.Instances.serviceAccounts
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "9"
      "yes":
      - "37"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c1227327-d8ae-4ecb-8026-0ee28c2c7f04
      iscommand: false
      name: Is service account field set?
      type: condition
      version: -1
    taskid: c1227327-d8ae-4ecb-8026-0ee28c2c7f04
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -150,
          "y": 1300
        }
      }
  "37":
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmserviceowner
      keys:
        simple: Name,Email,Source,Timestamp
      val1:
        simple: n/a
      val2:
        complex:
          accessor: email
          root: GoogleCloudCompute.Instances.serviceAccounts
      val3:
        simple: Service account on instance
      val4:
        complex:
          root: TimeNowUnix
          transformers:
          - operator: TimeStampToDate
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: |-
        Automation used to more easily populate a grid field.  This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Example of command:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: 16198b08-31db-4ab1-8c29-60bbb86ae3c1
      iscommand: false
      name: Add service account to service owner grid field
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: 16198b08-31db-4ab1-8c29-60bbb86ae3c1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -150,
          "y": 1610
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "36_37_yes": 0.62
    },
    "paper": {
      "dimensions": {
        "height": 2205,
        "width": 2770,
        "x": -160,
        "y": 50
      }
    }
  }
