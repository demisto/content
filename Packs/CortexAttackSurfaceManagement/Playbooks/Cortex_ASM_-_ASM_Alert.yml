id: Cortex ASM - ASM Alert
version: -1
name: Cortex ASM - ASM Alert
description: This playbook handles ASM alerts by enriching asset information and providing a means of remediating the issue directly or through contacting service owners.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 79a7c8e5-9a6b-426f-8ed3-21ff1fe9124e
    type: start
    task:
      id: 79a7c8e5-9a6b-426f-8ed3-21ff1fe9124e
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "5"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 70,
          "y": -1780
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "4":
    id: "4"
    taskid: 548459c6-a71d-49ac-8910-fa07334e477c
    type: title
    task:
      id: 548459c6-a71d-49ac-8910-fa07334e477c
      version: -1
      name: Complete
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 70,
          "y": 5260
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "5":
    id: "5"
    taskid: 205caac4-7e93-4b53-8028-4798bd309ad4
    type: title
    task:
      id: 205caac4-7e93-4b53-8028-4798bd309ad4
      version: -1
      name: Triage and Qualifier Stage
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "180"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 70,
          "y": -1640
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "6":
    id: "6"
    taskid: 8cdc4fa7-9865-4a60-8254-a3fe2c1face9
    type: title
    task:
      id: 8cdc4fa7-9865-4a60-8254-a3fe2c1face9
      version: -1
      name: Enrichment Stage
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "97"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": -1000
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 952a8f66-7583-43da-8753-657b3f1425e2
    type: title
    task:
      id: 952a8f66-7583-43da-8753-657b3f1425e2
      version: -1
      name: Decision Stage
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "120"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 330
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: b78597f7-5761-4cd4-8a0b-f648f78192a7
    type: title
    task:
      id: b78597f7-5761-4cd4-8a0b-f648f78192a7
      version: -1
      name: Notification Stage
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "179"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 800,
          "y": 1570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 1c823068-38b4-47b9-8aef-f70adbaf768d
    type: title
    task:
      id: 1c823068-38b4-47b9-8aef-f70adbaf768d
      version: -1
      name: Validation Stage
      type: title
      iscommand: false
      brand: ""
      description: 'Send an email.'
    nexttasks:
      '#none#':
      - "86"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 3055
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: a1e55a91-099f-4100-829c-5d1caea841b3
    type: title
    task:
      id: a1e55a91-099f-4100-829c-5d1caea841b3
      version: -1
      name: Remediation Stage
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "167"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -690,
          "y": 1540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: 3d818954-51ff-4ae6-87bb-1951dd4c56c6
    type: title
    task:
      id: 3d818954-51ff-4ae6-87bb-1951dd4c56c6
      version: -1
      name: Summarization Stage
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "177"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 3855
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 078c10a4-ae07-4e7e-8aeb-d593bef0a521
    type: condition
    task:
      id: 078c10a4-ae07-4e7e-8aeb-d593bef0a521
      version: -1
      name: Service exposure still observable?
      description: Determines if service was still observable and also if automated remediation was done.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "21"
      "no":
      - "135"
    separatecontext: false
    conditions:
    - label: "no"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: alert.asmservicedetection
                accessor: scanresult
                transformers:
                - operator: LastArrayElement
            iscontext: true
          right:
            value:
              simple: REMEDIATED
        - operator: isEqualString
          left:
            value:
              complex:
                root: alert.asmremediation
                accessor: outcome
            iscontext: true
          right:
            value:
              simple: Success
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 3350
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: 0c54afdb-6281-4862-8f93-2c9108347625
    type: collection
    task:
      id: 0c54afdb-6281-4862-8f93-2c9108347625
      version: -1
      name: What to do if Remediation Confirmation Scan is inconclusive?
      description: Determines if alert should be closed or kept open for auto-closure based on analyst input.
      type: collection
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "135"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 310,
          "y": 3530
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to:
      subject:
      body:
        simple: The post migration NMAP scan wasn't conclusive, decide next steps.
      methods: []
      format: ""
      bcc:
      cc:
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
        completeafterv2: true
        completeaftersla: false
    form:
      questions:
      - id: "0"
        label: ""
        labelarg:
          simple: If you know the issue has been remediated, choose to keep open and have next Xpanse scan auto-close or manually close now.
        required: false
        gridcolumns: []
        defaultrows: []
        type: singleSelect
        options: []
        optionsarg:
        - simple: Close Now
        - simple: Wait to Auto-close
        fieldassociated: ""
        placeholder: ""
        tooltip: ""
        readonly: false
      title: Select a next step
      description: The post migration Remediation Confirmation Scan wasn't conclusive. Decide the next steps.
      sender: Your SOC team
      expired: false
      totalanswers: 0
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: 1c7b6823-28e7-4618-8ab0-5ef8da8b63fc
    type: condition
    task:
      id: 1c7b6823-28e7-4618-8ab0-5ef8da8b63fc
      version: -1
      name: What was data collection task response?
      description: Determines the next action (remediation or ticket) based on the previous data collection task.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "88"
      Automated remediation:
      - "12"
      Manual remediation:
      - "63"
      Notification email:
      - "60"
      ServiceNow ticket:
      - "10"
      Jira ticket:
      - "156"
    separatecontext: false
    conditions:
    - label: Automated remediation
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: alert.asmdatacollection
                accessor: "selected"
            iscontext: true
          right:
            value:
              simple: Automated remediation by restricting open ports
        - operator: isEqualString
          left:
            value:
              complex:
                root: alert.asmdatacollection
                accessor: selected
            iscontext: true
          right:
            value:
              simple: Automated remediation by creating empty S3 bucket
    - label: Manual remediation
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: alert.asmdatacollection
                accessor: "selected"
            iscontext: true
          right:
            value:
              simple: Manual remediation
    - label: ServiceNow ticket
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: alert.asmdatacollection
                accessor: "selected"
            iscontext: true
          right:
            value:
              simple: File a ServiceNow Ticket
    - label: Notification email
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: alert.asmdatacollection
                accessor: "selected"
            iscontext: true
          right:
            value:
              simple: Send a notification email
    - label: Jira ticket
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: alert.asmdatacollection
                accessor: selected
            iscontext: true
          right:
            value:
              simple: File a Jira Ticket
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 1315
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: 363d6454-984f-4e75-8e39-fce60e8a7aa5
    type: collection
    task:
      id: 363d6454-984f-4e75-8e39-fce60e8a7aa5
      version: -1
      name: Verify service exposure resolved by service owner
      description: Determines if manual remediation (by service owner or otherwise) was completed via analyst input.
      type: collection
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "72"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 800,
          "y": 2380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to:
      subject:
      body:
      methods: []
      format: ""
      bcc:
      cc:
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
        completeafterv2: true
        completeaftersla: false
    form:
      questions:
      - id: "0"
        label: ""
        labelarg:
          simple: 'Please verify service exposure was resolved by service owner and mark "complete" when done:'
        required: true
        gridcolumns: []
        defaultrows: []
        type: singleSelect
        options: []
        optionsarg:
        - simple: Yes, remediation complete
        fieldassociated: ""
        placeholder: ""
        tooltip: ""
        readonly: false
      title: Verify that service exposure was resolved by service owner
      description: ""
      sender: Your SOC team
      expired: false
      totalanswers: 0
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: d4b249ba-f931-4211-86ec-fed38bd28f2c
    type: title
    task:
      id: d4b249ba-f931-4211-86ec-fed38bd28f2c
      version: -1
      name: Notification Stage
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "176"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1220,
          "y": 1500
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: 2a74ea33-e35a-4e91-89ad-b4a454295dfc
    type: title
    task:
      id: 2a74ea33-e35a-4e91-89ad-b4a454295dfc
      version: -1
      name: Remediation Stage
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "88"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -270,
          "y": 1605
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "69":
    id: "69"
    taskid: 5a25a6a7-fd0f-42ba-8aee-499d94ad8d4c
    type: regular
    task:
      id: 5a25a6a7-fd0f-42ba-8aee-499d94ad8d4c
      version: -1
      name: Set remediation grid field
      description: |-
        Automation used to more easily populate a grid field.  This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: Builtin
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      gridfield:
        simple: asmremediation
      keys:
        simple: action,actiontimestamp,outcome,outcometimestamp
      val1:
        simple: Manual remediation
      val2:
        complex:
          root: alert.asmdatacollection
          accessor: timestamp
      val3:
        simple: Manual remediation completed
      val4:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 2880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "72":
    id: "72"
    taskid: a7f0052c-3310-433c-8a1d-b68b6d53ce1c
    type: condition
    task:
      id: a7f0052c-3310-433c-8a1d-b68b6d53ce1c
      version: -1
      name: Manual remediation selected?
      description: Determines if "manual remediation" was selected on main data collection task.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "73"
      manual from RPR:
      - "103"
      manual from data collection:
      - "69"
    separatecontext: false
    conditions:
    - label: "manual from data collection"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: alert.asmdatacollection
                accessor: "selected"
            iscontext: true
          right:
            value:
              simple: Manual remediation
          ignorecase: true
    - label: manual from RPR
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: RemediationAction
            iscontext: true
          right:
            value:
              simple: Manual
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 2650
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "73":
    id: "73"
    taskid: 400a5d2c-27fe-4cee-833a-a3d9951384f2
    type: regular
    task:
      id: 400a5d2c-27fe-4cee-833a-a3d9951384f2
      version: -1
      name: Set remediation grid field
      description: |-
        Automation used to more easily populate a grid field.  This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: Builtin
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      gridfield:
        simple: asmremediation
      keys:
        simple: action,actiontimestamp,outcome,outcometimestamp
      val1:
        complex:
          root: alert.asmnotification
          accessor: type
          transformers:
          - operator: concat
            args:
              prefix:
                value:
                  simple: 'Notified service owner via '
              suffix: {}
      val2:
        complex:
          root: alert.asmnotification
          accessor: timestamp
      val3:
        simple: Resolved by service owner
      val4:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 850,
          "y": 2880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "81":
    id: "81"
    taskid: 3029317d-a0aa-47bd-8667-a14c4704b52d
    type: regular
    task:
      id: 3029317d-a0aa-47bd-8667-a14c4704b52d
      version: -1
      name: Set alert summary grid field
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: Builtin
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "136"
    scriptarguments:
      gridfield:
        simple: asmalertsummary
      keys:
        simple: link,entryid
      val1:
        complex:
          root: demistoUrls
          accessor: server
          transformers:
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: /xsoar/entry/download/
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: ${lastCompletedTaskEntries.[0]}
                iscontext: true
          - operator: replace
            args:
              limit: {}
              replaceWith:
                value:
                  simple: '%40'
              toReplace:
                value:
                  simple: '@'
      val2:
        complex:
          root: lastCompletedTaskEntries
          accessor: '[0]'
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 4140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "86":
    id: "86"
    taskid: df2185f7-5dea-4431-8a00-1dff0d6b2d4d
    type: playbook
    task:
      id: df2185f7-5dea-4431-8a00-1dff0d6b2d4d
      version: -1
      name: Cortex ASM - Detect Service
      description: Playbook that looks at what ASM sub-type the alert is and directs it to different pre/post mitigation scans (such as NMAP).
      type: playbook
      iscommand: false
      brand: ""
      playbookId: Cortex ASM - Detect Service
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      ASMRuleID:
        complex:
          root: alert
          accessor: asmattacksurfaceruleid
      RemoteIP:
        complex:
          root: alert
          accessor: remoteip
      RemotePort:
        complex:
          root: alert
          accessor: remoteport
      ScanNumber:
        simple: "2"
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 70,
          "y": 3190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "88":
    id: "88"
    taskid: f80b1685-d83c-4d3f-8219-8176c830ac92
    type: collection
    task:
      id: f80b1685-d83c-4d3f-8219-8176c830ac92
      version: -1
      name: Complete manual remediation
      description: Determines if manual remediation (by service owner or otherwise) was completed via analyst input.
      type: collection
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "133"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 2230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to:
      subject:
      body:
      methods: []
      format: ""
      bcc:
      cc:
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
        completeafterv2: true
        completeaftersla: false
    form:
      questions:
      - id: "0"
        label: ""
        labelarg:
          simple: 'Please complete manual remediation and mark "complete" when done:'
        required: true
        gridcolumns: []
        defaultrows: []
        type: singleSelect
        options: []
        optionsarg:
        - simple: Yes, remediation complete
        fieldassociated: ""
        placeholder: ""
        tooltip: ""
        readonly: false
      title: Verify that manual remediation was completed
      description: ""
      sender: Your SOC team
      expired: false
      totalanswers: 0
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "97":
    id: "97"
    taskid: 71dcd381-9a60-4115-88fb-e1513cbb913b
    type: playbook
    task:
      id: 71dcd381-9a60-4115-88fb-e1513cbb913b
      version: -1
      name: Cortex ASM - Enrichment
      description: Used as a container folder for all enrichments of ASM alerts.
      type: playbook
      iscommand: false
      brand: ""
      playbookId: Cortex ASM - Enrichment
    nexttasks:
      '#none#':
      - "125"
    separatecontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": -870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    scriptarguments:
      AWSAssumeRoleName:
        simple: ${inputs.AWSAssumeRoleName}
      RemoteIP:
        complex:
          accessor: remoteip
          root: alert
  "103":
    id: "103"
    taskid: 9cd375bf-e85e-45fd-8fa4-ee8ef8bf3d10
    type: regular
    task:
      id: 9cd375bf-e85e-45fd-8fa4-ee8ef8bf3d10
      version: -1
      name: Set remediation grid field
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: Builtin
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      gridfield:
        simple: asmremediation
      keys:
        simple: action,actiontimestamp,outcome,outcometimestamp
      val1:
        simple: Manual remediation
      val2:
        complex:
          root: RPR_Timestamp
      val3:
        simple: Manual remediation completed
      val4:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 460,
          "y": 2880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "110":
    id: "110"
    taskid: 75485187-2003-44f4-8476-54d27fac1cf7
    type: condition
    task:
      id: 75485187-2003-44f4-8476-54d27fac1cf7
      version: -1
      name: Close or keep open?
      description: Determines if the alert will be closed or kept open.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Automated-Remediation':
      - "112"
      '#default#':
      - "4"
      Automated-Remediation With Rule Match:
      - "114"
      Close Now:
      - "111"
      Close Now With Rule Match:
      - "113"
    separatecontext: false
    conditions:
    - label: Automated-Remediation With Rule Match
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: alert.asmremediation
                accessor: outcome
            iscontext: true
          right:
            value:
              simple: Success
          ignorecase: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: alert
                accessor: asmremediationpathrule
            iscontext: true
    - label: ' Automated-Remediation'
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: alert.asmremediation
                accessor: outcome
            iscontext: true
          right:
            value:
              simple: Success
          ignorecase: true
    - label: Close Now With Rule Match
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Select a next step.Answers
                accessor: "0"
            iscontext: true
          right:
            value:
              simple: Close Now
          ignorecase: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: alert
                accessor: asmremediationpathrule
            iscontext: true
    - label: Close Now
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Select a next step.Answers
                accessor: "0"
            iscontext: true
          right:
            value:
              simple: Close Now
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 4470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "111":
    id: "111"
    taskid: faa2ac25-d58c-4d2b-8ad8-8ae1e27ec1c3
    type: regular
    task:
      id: faa2ac25-d58c-4d2b-8ad8-8ae1e27ec1c3
      version: -1
      name: Close alert (close now)
      description: Close the current alert because auto-close was selected.
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      closeNotes:
        simple: Alert status set to 'Resolved' by Active Response Module
      closeReason:
        simple: Resolved
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -150,
          "y": 4790
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "112":
    id: "112"
    taskid: 3484098d-2bfe-4d6c-8fc6-07c1cb7ad591
    type: regular
    task:
      id: 3484098d-2bfe-4d6c-8fc6-07c1cb7ad591
      version: -1
      name: Close alert (remediated automatically)
      description: Close the current alert because Automated Remediation path was selected.
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      closeNotes:
        simple: Alert status set to 'Resolved - Remediated Automatically' by Active Response Module
      closeReason:
        simple: Resolved - Remediated Automatically
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 290,
          "y": 4790
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "113":
    id: "113"
    taskid: f9691189-aae2-4973-89b1-45d513d7b4b1
    type: regular
    task:
      id: f9691189-aae2-4973-89b1-45d513d7b4b1
      version: -1
      name: Close alert (close now) with rule match
      description: Close the current alert because auto-close was selected.
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      closeNotes:
        complex:
          root: alert.asmremediationpathrule
          accessor: rule_name
          transformers:
          - operator: concat
            args:
              prefix:
                value:
                  simple: 'Alert status set to ''Resolved'' by Active Response Module - Remediation Path Rule: '
              suffix: {}
      closeReason:
        simple: Resolved
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -470,
          "y": 4650
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "114":
    id: "114"
    taskid: 0d6b5b4a-6676-4565-83c3-263bbb709ccd
    type: regular
    task:
      id: 0d6b5b4a-6676-4565-83c3-263bbb709ccd
      version: -1
      name: Close alert (remediated automatically) with rule match
      description: Close the current alert because Automated Remediation path was selected.
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      closeNotes:
        complex:
          root: alert.asmremediationpathrule
          accessor: rule_name
          transformers:
          - operator: concat
            args:
              prefix:
                value:
                  simple: 'Alert status set to ''Resolved - Remediated Automatically'' by Active Response Module - Remediation Path Rule: '
              suffix: {}
      closeReason:
        simple: Resolved - Remediated Automatically
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 660,
          "y": 4660
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "120":
    id: "120"
    taskid: bbcc2ebf-4475-4f87-8692-4b6960536228
    type: playbook
    task:
      id: bbcc2ebf-4475-4f87-8692-4b6960536228
      version: -1
      name: Cortex ASM - Remediation Path Rules
      type: playbook
      iscommand: false
      brand: ""
      playbookId: Cortex ASM - Remediation Path Rules
      description: ''
    nexttasks:
      '#none#':
      - "145"
    scriptarguments:
      BypassDevCheck:
        complex:
          root: inputs.BypassDevCheck
      ExternallyDetectedProviders:
        complex:
          root: ASM.ExternalService
          accessor: externally_detected_providers
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 70,
          "y": 470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "121":
    id: "121"
    taskid: abef44ae-926e-466b-8030-33c6078e12f4
    type: title
    task:
      id: abef44ae-926e-466b-8030-33c6078e12f4
      version: -1
      name: Analysis Stage
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "175"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": -535
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "124":
    id: "124"
    taskid: 7697188d-a525-43a6-8f5f-02d63024d1f0
    type: regular
    task:
      id: 7697188d-a525-43a6-8f5f-02d63024d1f0
      version: -1
      name: Set playbook stage grid field (triage)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: ""
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: triage
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": -1170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "125":
    id: "125"
    taskid: 73acc4cd-f162-4da9-8e80-bb677b24c0fa
    type: regular
    task:
      id: 73acc4cd-f162-4da9-8e80-bb677b24c0fa
      version: -1
      name: Set playbook stage grid field (enrichment)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: ""
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "121"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: enrichment
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": -705
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "126":
    id: "126"
    taskid: e00a985a-489a-449d-805d-929b07974977
    type: regular
    task:
      id: e00a985a-489a-449d-805d-929b07974977
      version: -1
      name: Set playbook stage grid field (analysis)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: ""
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "144"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: analysis
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": -40
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "128":
    id: "128"
    taskid: daacfc48-eb95-4aa6-8b43-92ad68d6b62c
    type: regular
    task:
      id: daacfc48-eb95-4aa6-8b43-92ad68d6b62c
      version: -1
      name: Set playbook stage grid field (decision)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: ""
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "63"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: decision
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -270,
          "y": 1180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "129":
    id: "129"
    taskid: fd339520-4a29-4412-8675-9a7ffb073f0c
    type: regular
    task:
      id: fd339520-4a29-4412-8675-9a7ffb073f0c
      version: -1
      name: Set playbook stage grid field (decision)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: ""
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: decision
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -700,
          "y": 1120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "130":
    id: "130"
    taskid: 569e4b63-d599-4604-8c97-7c7200c53c59
    type: regular
    task:
      id: 569e4b63-d599-4604-8c97-7c7200c53c59
      version: -1
      name: Set playbook stage grid field (decision)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: ""
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: decision
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 800,
          "y": 1105
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "131":
    id: "131"
    taskid: 33010b40-f580-4f68-8ee7-95208f3b4b5e
    type: regular
    task:
      id: 33010b40-f580-4f68-8ee7-95208f3b4b5e
      version: -1
      name: Set playbook stage grid field (decision)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: ""
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "60"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: decision
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1220,
          "y": 1025
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "133":
    id: "133"
    taskid: d0336db6-38a5-4c68-8e16-39fba3c1c026
    type: regular
    task:
      id: d0336db6-38a5-4c68-8e16-39fba3c1c026
      version: -1
      name: Set playbook stage grid field (remediation)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: ""
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "72"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: remediation
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 2400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "134":
    id: "134"
    taskid: a25d63b0-fffe-4304-8357-d10c0f1a5f34
    type: regular
    task:
      id: a25d63b0-fffe-4304-8357-d10c0f1a5f34
      version: -1
      name: Set playbook stage grid field (notification)
      description: |-
        Automation used to more easily populate a grid field.  This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: ""
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "50"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: notification
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 800,
          "y": 1965
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "135":
    id: "135"
    taskid: b89b04c5-a0d2-4ada-85e8-fb84fd8c0174
    type: regular
    task:
      id: b89b04c5-a0d2-4ada-85e8-fb84fd8c0174
      version: -1
      name: Set playbook stage grid field (validation)
      description: |-
        Automation used to more easily populate a grid field.  This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: ""
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: validation
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 3700
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "136":
    id: "136"
    taskid: ea15fff7-a44e-4f31-8e63-54f069aafdec
    type: regular
    task:
      id: ea15fff7-a44e-4f31-8e63-54f069aafdec
      version: -1
      name: Set playbook stage grid field (summarization)
      description: |-
        Automation used to more easily populate a grid field.  This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: ""
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "110"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: summarization
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 4310
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "141":
    id: "141"
    taskid: 5fc53955-e98a-4b57-82dc-185bb48a79bb
    type: title
    task:
      id: 5fc53955-e98a-4b57-82dc-185bb48a79bb
      version: -1
      name: continue
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "142"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -1110,
          "y": 995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "142":
    id: "142"
    taskid: 3759b6d2-40aa-4639-8de0-d7a5768f0f78
    type: regular
    task:
      id: 3759b6d2-40aa-4639-8de0-d7a5768f0f78
      version: -1
      name: Close alert (accepted risk)
      description: Close the current alert because the service is no longer observed.
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      closeNotes:
        simple: Alert status set to 'Resolved - Risk Accepted' by Active Response Module
      closeReason:
        simple: Resolved - Risk Accepted
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -920,
          "y": 4650
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "144":
    id: "144"
    taskid: df8b6de0-ebf2-4344-808f-773d0a40298c
    type: condition
    task:
      id: df8b6de0-ebf2-4344-808f-773d0a40298c
      version: -1
      name: Are there any matches from accepted risk lists?
      description: Checks if the system IDs, folders, and projects are present in the accepted risk lists.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "8"
      "yes":
      - "141"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: inList
          left:
            value:
              complex:
                root: alert.asmsystemids
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: alert.asmsystemids.type
                      iscontext: true
                    right:
                      value:
                        simple: ASSET-ID
                accessor: id
            iscontext: true
          right:
            value:
              complex:
                root: inputs.AcceptedRiskDs
            iscontext: true
        - operator: inList
          left:
            value:
              complex:
                root: alert.asmsystemids
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: alert.asmsystemids.type
                      iscontext: true
                    right:
                      value:
                        simple: GCP-Project-Number
                accessor: id
            iscontext: true
          right:
            value:
              complex:
                root: inputs.AcceptedRiskProjects
            iscontext: true
        - operator: inList
          left:
            value:
              complex:
                root: alert.asmcloud
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: alert.asmcloud.provider
                      iscontext: true
                    right:
                      value:
                        simple: AWS
                accessor: project
            iscontext: true
          right:
            value:
              complex:
                root: inputs.AcceptedRiskProjects
            iscontext: true
        - operator: inList
          left:
            value:
              complex:
                root: alert.asmsystemids
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: alert.asmsystemids.type
                      iscontext: true
                    right:
                      value:
                        simple: GCP-Folder-Number
                accessor: id
            iscontext: true
          right:
            value:
              complex:
                root: inputs.AcceptedRiskOther
            iscontext: true
        - operator: inList
          left:
            value:
              complex:
                root: alert.asmcloud
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: alert.asmcloud.provider
                      iscontext: true
                    right:
                      value:
                        simple: Azure
                accessor: organization
            iscontext: true
          right:
            value:
              complex:
                root: inputs.AcceptedRiskOther
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "145":
    id: "145"
    taskid: 4766c871-f8c3-4896-8a95-02019ce271fd
    type: condition
    task:
      id: 4766c871-f8c3-4896-8a95-02019ce271fd
      version: -1
      name: What is the remediation action?
      description: Determines what the remediation action is (direct action or data collection task).
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "48"
      Automated Remediation:
      - "146"
      Jira Ticket:
      - "161"
      Manual Remediation:
      - "152"
      Notification Email:
      - "163"
      ServiceNow Ticket:
      - "162"
    separatecontext: false
    conditions:
    - label: Automated Remediation
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: RemediationAction
            iscontext: true
          right:
            value:
              simple: AR
    - label: ServiceNow Ticket
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: RemediationAction
            iscontext: true
          right:
            value:
              simple: SNOW
    - label: Notification Email
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: RemediationAction
            iscontext: true
          right:
            value:
              simple: Email
    - label: Manual Remediation
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: RemediationAction
            iscontext: true
          right:
            value:
              simple: Manual
    - label: Jira Ticket
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: RemediationAction
            iscontext: true
          right:
            value:
              simple: Jira
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 660
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "146":
    id: "146"
    taskid: 0bcc9690-5c1b-4eb9-88de-d991f31820f1
    type: title
    task:
      id: 0bcc9690-5c1b-4eb9-88de-d991f31820f1
      version: -1
      name: Automated Remediation
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "129"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -700,
          "y": 995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "152":
    id: "152"
    taskid: a4b94f6b-2c42-4a0e-8dfc-210138a74131
    type: title
    task:
      id: a4b94f6b-2c42-4a0e-8dfc-210138a74131
      version: -1
      name: Manual Remediation
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "128"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -270,
          "y": 1050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "156":
    id: "156"
    taskid: 3d527f85-362a-4c68-8380-316a62e1924f
    type: title
    task:
      id: 3d527f85-362a-4c68-8380-316a62e1924f
      version: -1
      name: Notification Stage
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "178"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 370,
          "y": 1630
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "157":
    id: "157"
    taskid: ee8d767a-885a-444c-8465-7c0382db096d
    type: regular
    task:
      id: ee8d767a-885a-444c-8465-7c0382db096d
      version: -1
      name: Set playbook stage grid field (decision)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: ""
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "156"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: decision
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 370,
          "y": 1175
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "161":
    id: "161"
    taskid: f12b3c1f-6c94-4918-807a-e758e467373b
    type: title
    task:
      id: f12b3c1f-6c94-4918-807a-e758e467373b
      version: -1
      name: Jira Ticket
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "157"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 370,
          "y": 1040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "162":
    id: "162"
    taskid: bcef69e4-70a6-497d-8373-e29789f4c2e1
    type: title
    task:
      id: bcef69e4-70a6-497d-8373-e29789f4c2e1
      version: -1
      name: ServiceNow Ticket
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "130"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 800,
          "y": 970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "163":
    id: "163"
    taskid: 2313dded-570c-4388-8dd7-0de43fbbf80c
    type: title
    task:
      id: 2313dded-570c-4388-8dd7-0de43fbbf80c
      version: -1
      name: Email Notification
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "131"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1220,
          "y": 890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "164":
    id: "164"
    taskid: 83b8f6d3-b38f-4c08-884c-0a8f684e3b39
    type: regular
    task:
      id: 83b8f6d3-b38f-4c08-884c-0a8f684e3b39
      version: -1
      name: Set remediation grid field
      description: |-
        Automation used to more easily populate a grid field.  This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: Builtin
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "168"
    scriptarguments:
      gridfield:
        simple: asmremediation
      keys:
        simple: action,actiontimestamp,outcome,outcometimestamp
      val1:
        simple: close service port from internet
      val2:
        simple: TIMESTAMP
      val3:
        simple: Success
      val4:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -690,
          "y": 1860
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "165":
    id: "165"
    taskid: ec8df44c-301c-4a09-84ba-5c8855f89129
    type: condition
    task:
      id: ec8df44c-301c-4a09-84ba-5c8855f89129
      version: -1
      name: Are there service owners with emails?
      description: Verifies if we have emails for service owners.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "11"
      "yes":
      - "166"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: alert.asmserviceowner
                filters:
                - - operator: containsGeneral
                    left:
                      value:
                        simple: alert.asmserviceowner.email
                      iscontext: true
                    right:
                      value:
                        simple: '@'
                accessor: email
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -690,
          "y": 2210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "166":
    id: "166"
    taskid: e9e352cd-b065-465f-899b-190f21c9ce72
    type: regular
    task:
      id: e9e352cd-b065-465f-899b-190f21c9ce72
      version: -1
      name: Send remediation notification email to service owners
      description: Send an email to service owners regarding the status of the automated remediation action that was taken.
      script: '|||send-mail'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "169"
    scriptarguments:
      htmlBody:
        complex:
          root: inputs.RemediationNotificationHTMLBody
      subject:
        complex:
          root: inputs.RemediationNotificationSubject
      to:
        complex:
          root: alert.asmserviceowner
          filters:
          - - operator: containsGeneral
              left:
                value:
                  simple: alert.asmserviceowner.email
                iscontext: true
              right:
                value:
                  simple: '@'
          accessor: email
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -810,
          "y": 2440
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "167":
    id: "167"
    taskid: 7d17750d-0e91-4915-887a-43ddbbfbe339
    type: playbook
    task:
      id: 7d17750d-0e91-4915-887a-43ddbbfbe339
      version: -1
      name: Cortex ASM - Remediation
      description: This playbook contains all the cloud provider sub playbooks for remediation.
      type: playbook
      iscommand: false
      brand: ""
      playbookId: Cortex ASM - Remediation
    nexttasks:
      '#none#':
      - "164"
    separatecontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -690,
          "y": 1685
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    scriptarguments:
      AWSAssumeRoleName:
        simple: ${inputs.AWSAssumeRoleName}
  "168":
    id: "168"
    taskid: e28aa7c4-0b2f-4e12-8041-731c10074f0b
    type: regular
    task:
      id: e28aa7c4-0b2f-4e12-8041-731c10074f0b
      version: -1
      name: Set playbook stage grid field (remediation)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: ""
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "165"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: remediation
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -690,
          "y": 2040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "169":
    id: "169"
    taskid: ee06492a-abbb-4981-8851-732e9045e95b
    type: regular
    task:
      id: ee06492a-abbb-4981-8851-732e9045e95b
      version: -1
      name: Set playbook stage grid field (notification)
      description: |-
        Automation used to more easily populate a grid field.  This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: ""
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: notification
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -810,
          "y": 2600
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "171":
    id: "171"
    taskid: a44a0f99-00de-4901-8cd8-85bc94ed366a
    type: regular
    task:
      id: a44a0f99-00de-4901-8cd8-85bc94ed366a
      version: -1
      name: Initialize grid fields
      description: Clear ASM grid fields in case the playbook is rerun.
      script: Builtin|||setAlert
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "124"
    scriptarguments:
      asmalertsummary:
        simple: '[]'
      asmcloud:
        simple: '[]'
      asmdatacollection:
        simple: '[]'
      asmdevcheckdetails:
        simple: '[]'
      asmenrichmentstatus:
        simple: '[]'
      asmnotification:
        simple: '[]'
      asmplaybookstage:
        simple: '[]'
      asmprivateip:
        simple: '[]'
      asmremediation:
        simple: '[]'
      asmremediationobjectives:
        simple: '[{"option": "File a ServiceNow Ticket", "statement": "In this case, a ServiceNow ticket will be created with some information on the alert and possible remediation guidance suggestions."},{"option": "File a Jira Ticket", "statement": "In this case, a Jira ticket will be created with some information on the alert and possible remediation guidance suggestions."},{"option": "Send a notification email", "statement": "In this case, an email ticket will be created with some information on the alert and possible remediation guidance suggestions."},{"option": "Manual remediation", "statement": "In this case, we will require you to manually remediate this exposure."}]'
      asmremediationpathrule:
        simple: '[]'
      asmservicedetection:
        simple: '[]'
      asmserviceowner:
        simple: '[]'
      asmserviceownerunrankedraw:
        simple: '[]'
      asmsystemids:
        simple: '[]'
      asmtags:
        simple: '[]'
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": -1340
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "172":
    id: "172"
    taskid: aae9af2f-62f1-49cf-8987-9bbc9912fab4
    type: regular
    task:
      id: aae9af2f-62f1-49cf-8987-9bbc9912fab4
      version: -1
      name: GenerateSummaryReport - Analysis
      description: Generate an ASM Alert Summary report.
      type: regular
      iscommand: false
      brand: ""
      script: GenerateASMReport
    nexttasks:
      '#none#':
      - "126"
    scriptarguments:
      alert_details:
        complex:
          root: alert
          accessor: details
      alert_id:
        complex:
          root: alert
          accessor: id
      alert_name:
        complex:
          root: alert
          accessor: name
      alert_severityStr:
        complex:
          root: alert
          accessor: severityStr
      asm_asset_id:
        complex:
          root: alert
          accessor: asmassetid
      asm_cloud:
        complex:
          root: alert
          accessor: asmcloud
      asm_data_collection:
        complex:
          root: alert
          accessor: asmdatacollection
      asm_notification:
        complex:
          root: alert
          accessor: asmnotification
      asm_private_ip:
        complex:
          root: alert
          accessor: asmprivateip
      asm_related:
        complex:
          root: alert
          accessor: asmrelated
      asm_remediation:
        complex:
          root: alert
          accessor: asmremediation
      asm_remediation_guidance:
        complex:
          root: RemediationGuidance
      asm_remediation_path_rule:
        complex:
          root: alert
          accessor: asmremediationpathrule
      asm_service_detection:
        complex:
          root: alert
          accessor: asmservicedetection
      asm_service_id:
        complex:
          root: alert
          accessor: asmserviceid
      asm_service_owner:
        complex:
          root: alert
          accessor: asmserviceowner
      asm_system_ids:
        complex:
          root: alert
          accessor: asmsystemids
      asm_tags:
        complex:
          root: alert
          accessor: asmtags
      report_type:
        simple: analysis
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "175":
    id: "175"
    taskid: 1c18b32d-27ea-4d7d-8387-d96f9b6422af
    type: playbook
    task:
      id: 1c18b32d-27ea-4d7d-8387-d96f9b6422af
      version: -1
      name: Cortex ASM - Remediation Guidance
      type: playbook
      iscommand: false
      brand: ""
      playbookId: Cortex ASM - Remediation Guidance
      description: ''
    nexttasks:
      '#none#':
      - "172"
    separatecontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "176":
    id: "176"
    taskid: a68a7331-0bff-40c2-8231-c42822b96c12
    type: playbook
    task:
      id: a68a7331-0bff-40c2-8231-c42822b96c12
      version: -1
      name: Cortex ASM - Email Notification
      description: This playbook is used to send email notifications to service owners to notify them of their internet exposures.
      type: playbook
      iscommand: false
      brand: ""
      playbookId: Cortex ASM - Email Notification
    nexttasks:
      '#none#':
      - "134"
    scriptarguments:
      OwnerNotificationBody:
        complex:
          root: inputs.OwnerNotificationBody
      OwnerNotificationSubject:
        complex:
          root: inputs.OwnerNotificationSubject
      RemediationGuidance:
        complex:
          root: RemediationGuidance
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 1220,
          "y": 1635
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "177":
    id: "177"
    taskid: c5ee8b3b-80c8-4e66-8d23-fed4fe1714d7
    type: regular
    task:
      id: c5ee8b3b-80c8-4e66-8d23-fed4fe1714d7
      version: -1
      name: GenerateSummaryReport - Summary
      description: Generate an ASM Alert Summary report.
      type: regular
      iscommand: false
      brand: ""
      script: GenerateASMReport
    nexttasks:
      '#none#':
      - "81"
    scriptarguments:
      alert_details:
        complex:
          root: alert
          accessor: details
      alert_id:
        complex:
          root: alert
          accessor: id
      alert_name:
        complex:
          root: alert
          accessor: name
      alert_severityStr:
        complex:
          root: alert
          accessor: severityStr
      asm_asset_id:
        complex:
          root: alert
          accessor: asmassetid
      asm_cloud:
        complex:
          root: alert
          accessor: asmcloud
      asm_data_collection:
        complex:
          root: alert
          accessor: asmdatacollection
      asm_notification:
        complex:
          root: alert
          accessor: asmnotification
      asm_private_ip:
        complex:
          root: alert
          accessor: asmprivateip
      asm_related:
        complex:
          root: alert
          accessor: asmrelated
      asm_remediation:
        complex:
          root: alert
          accessor: asmremediation
      asm_remediation_guidance:
        complex:
          root: RemediationGuidance
      asm_remediation_path_rule:
        complex:
          root: alert
          accessor: asmremediationpathrule
      asm_service_detection:
        complex:
          root: alert
          accessor: asmservicedetection
      asm_service_id:
        complex:
          root: alert
          accessor: asmserviceid
      asm_service_owner:
        complex:
          root: alert
          accessor: asmserviceowner
      asm_system_ids:
        complex:
          root: alert
          accessor: asmsystemids
      asm_tags:
        complex:
          root: alert
          accessor: asmtags
      report_type:
        simple: summary
      retry-count:
        simple: "1"
      retry-interval:
        simple: "30"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 3980
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "178":
    id: "178"
    taskid: 38b28acb-6ef9-4c39-88a9-f396fd067a70
    type: playbook
    task:
      id: 38b28acb-6ef9-4c39-88a9-f396fd067a70
      version: -1
      name: Cortex ASM - Jira Notification
      type: playbook
      iscommand: false
      brand: ""
      playbookId: Cortex ASM - Jira Notification
      description: ''
    nexttasks:
      '#none#':
      - "134"
    scriptarguments:
      JiraProjectKey:
        complex:
          root: inputs.JiraProjectKey
      OwnerNotificationBody:
        complex:
          root: inputs.OwnerNotificationBody
      RemediationGuidance:
        complex:
          root: RemediationGuidance
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 370,
          "y": 1780
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "179":
    id: "179"
    taskid: a9ddad5d-48a5-408c-8ffa-0befe07917c4
    type: playbook
    task:
      id: a9ddad5d-48a5-408c-8ffa-0befe07917c4
      version: -1
      name: Cortex ASM - ServiceNow Notification
      type: playbook
      iscommand: false
      brand: ""
      playbookId: Cortex ASM - ServiceNow Notification
      description: ''
    nexttasks:
      '#none#':
      - "134"
    scriptarguments:
      OwnerNotificationBody:
        complex:
          root: inputs.OwnerNotificationBody
      RemediationGuidance:
        complex:
          root: RemediationGuidance
      NotificationTicketType:
        complex:
          root: inputs.NotificationTicketType
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 800,
          "y": 1755
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "180":
    id: "180"
    taskid: 21d391e7-543a-4bd0-8b0b-bc56ac517439
    type: regular
    task:
      id: 21d391e7-543a-4bd0-8b0b-bc56ac517439
      version: -1
      name: Delete context
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.12/Cortex-XSOAR-Administrator-Guide/Automations
      type: regular
      iscommand: false
      brand: ""
      script: DeleteContext
    nexttasks:
      '#none#':
      - "171"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": -1500
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "110_111_Close Now": 0.88,
      "110_112_ Automated-Remediation": 0.88,
      "145_152_Manual Remediation": 0.68,
      "145_161_Jira Ticket": 0.87,
      "145_163_Notification Email": 0.74,
      "20_135_no": 0.53,
      "48_10_ServiceNow ticket": 0.82,
      "48_60_Notification email": 0.88,
      "48_63_Manual remediation": 0.52
    },
    "paper": {
      "dimensions": {
        "height": 7105,
        "width": 2710,
        "x": -1110,
        "y": -1780
      }
    }
  }
inputs:
- key: OwnerNotificationSubject
  value:
    simple: "A new security risk was identified on an external service owned by your team"
  required: true
  description: 'Subject of the notification (email or ticket) sent to potential service owner.'
  playbookInputQuery:
- key: OwnerNotificationBody
  value:
    simple: |+
      Infosec identified a security risk on an external service potentially owned by your team: ${alert.name}<br><br>

      Description: ${alert.details}
      <br><br>

  required: true
  description: Body of the notification (email or ticket) sent to potential service owner.
  playbookInputQuery:
- key: NotificationTicketType
  value:
    simple: incident
  required: true
  description: The ticket type used by ticketing systems. The default is "incident" because ticketing systems such as ServiceNow and Cherwell use it as default.
  playbookInputQuery:
- key: RemediationNotificationSubject
  value:
    simple: |-
      A new security risk was addressed on an external service owned by your team
  required: true
  description: Subject of the notification (email or ticket) sent to the service owner after remediation.
  playbookInputQuery:
- key: RemediationNotificationHTMLBody
  value:
    simple: |-
      <!DOCTYPE html>
      <html lang="en">
      <body>
          <p>
              Infosec identified a security risk on an external service potentially owned by your
              team:<br><b>${alert.name}</b>
          </p>
          <p>
              <b>Alert Details:</b> ${alert.details}<br>
              <b>Action Taken:</b> ${alert.asmremediation.[0].action}<br>
              <b>Action Outcome:</b> ${alert.asmremediation.[0].outcome}<br>
          </p>
      </body>
      </html>
  required: true
  description: 'Body of the notification (email or ticket) sent to the service owner after remediation.'
  playbookInputQuery:
- key: BypassDevCheck
  value:
    simple: "False"
  required: false
  description: |-
    Determine whether to bypass the Dev Check in automated remediation criteria: https://docs-cortex.paloaltonetworks.com/r/Cortex-XPANSE/Cortex-Xpanse-Expander-User-Guide/Automated-Remediation-Capabilities-Matrix

    Set to "True" if you want to bypass.  Default is "False".
  playbookInputQuery:
- key: AcceptedRiskDs
  value: {}
  required: false
  description: Comma-separated list of instance/VM IDs that are considered an accepted risk and that should be closed.
  playbookInputQuery:
- key: AcceptedRiskProjects
  value: {}
  required: false
  description: Comma-separated list of projects numbers that are considered an accepted risk and that should be closed.  For example, a list of GCP projects and AWS accounts.
  playbookInputQuery:
- key: AcceptedRiskOther
  value: {}
  required: false
  description: Comma-separated list of other items that are considered an accepted risk and that should be closed. For example, a list of folders numbers in GCP and subscription IDs in Azure.
  playbookInputQuery:
- key: JiraProjectKey
  value: {}
  required: true
  description: The Jira project key to associate with the issue.
  playbookInputQuery:
- description: If assuming roles for AWS, this is the name of the role to assume (should be the same for all organizations).
  key: AWSAssumeRoleName
  playbookInputQuery:
  required: false
  value: {}
outputs: []
tests:
- No tests (auto formatted)
fromversion: 6.9.0
