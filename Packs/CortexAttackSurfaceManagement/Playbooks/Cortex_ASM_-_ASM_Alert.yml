id: Cortex ASM - ASM Alert
version: -1
name: Cortex ASM - ASM Alert
description: This playbook handles ASM alerts by enriching asset information and providing a means of remediating the issue directly or through contacting service owners.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 5f74e3d4-a98b-4425-85ba-056b32a8c96b
    type: start
    task:
      id: 5f74e3d4-a98b-4425-85ba-056b32a8c96b
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "5"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": -1400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: d8b21011-93d6-4b5c-82fa-bfa5b7bad044
    type: title
    task:
      id: d8b21011-93d6-4b5c-82fa-bfa5b7bad044
      version: -1
      name: Complete
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 5260
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 9c94a65b-ec31-4f84-8e53-238c0ba400e5
    type: title
    task:
      id: 9c94a65b-ec31-4f84-8e53-238c0ba400e5
      version: -1
      name: Triage and Qualifier Stage
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "171"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": -1270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 0d81d9c5-0219-481c-8528-92313b69ea7f
    type: title
    task:
      id: 0d81d9c5-0219-481c-8528-92313b69ea7f
      version: -1
      name: Enrichment Stage
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "97"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": -790
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: e5e7b4c5-0f88-4bd3-88ce-bc09a3a38210
    type: title
    task:
      id: e5e7b4c5-0f88-4bd3-88ce-bc09a3a38210
      version: -1
      name: Decision Stage
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "120"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 330
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: a071ba68-f8dd-4b1e-8c26-715bcca10db8
    type: title
    task:
      id: a071ba68-f8dd-4b1e-8c26-715bcca10db8
      version: -1
      name: Notification Stage
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "158"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 800,
          "y": 1570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: fb2870a4-dd48-414b-8ac2-78bba34fac94
    type: title
    task:
      id: fb2870a4-dd48-414b-8ac2-78bba34fac94
      version: -1
      name: Validation Stage
      description: Send an email
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "86"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 3055
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: ac0cb11e-8dd0-4077-8c7e-573a63a23dc5
    type: title
    task:
      id: ac0cb11e-8dd0-4077-8c7e-573a63a23dc5
      version: -1
      name: Remediation Stage
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "167"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -690,
          "y": 1540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: c0dc3a7c-5b0c-4057-87db-51092d522a9a
    type: title
    task:
      id: c0dc3a7c-5b0c-4057-87db-51092d522a9a
      version: -1
      name: Summarization Stage
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "93"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 3855
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 818dc0c5-4b28-42bd-81c5-09d85cf07d1f
    type: condition
    task:
      id: 818dc0c5-4b28-42bd-81c5-09d85cf07d1f
      version: -1
      name: Service exposure still observable?
      description: Determines if service was still observable and also if automated remediation was done.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "21"
      "no":
      - "135"
    separatecontext: false
    conditions:
    - label: "no"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: alert.asmservicedetection
                accessor: scanresult
                transformers:
                - operator: LastArrayElement
            iscontext: true
          right:
            value:
              simple: REMEDIATED
        - operator: isEqualString
          left:
            value:
              complex:
                root: alert.asmremediation
                accessor: outcome
            iscontext: true
          right:
            value:
              simple: Success
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 3350
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: cb99f386-4096-4789-8579-7e53fcb9d0df
    type: collection
    task:
      id: cb99f386-4096-4789-8579-7e53fcb9d0df
      version: -1
      name: What to do if Remediation Confirmation Scan is inconclusive?
      description: Determines if alert should be closed or kept open for auto-closure based on analyst input.
      type: collection
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "135"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 310,
          "y": 3530
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to:
      subject:
      body:
        simple: The post migration NMAP scan wasn't conclusive, decide next steps.
      methods: []
      format: ""
      bcc:
      cc:
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
        completeafterv2: true
        completeaftersla: false
    form:
      questions:
      - id: "0"
        label: ""
        labelarg:
          simple: If you know the issue has been remediated, choose to keep open and have next Xpanse scan auto-close or manually close now.
        required: false
        gridcolumns: []
        defaultrows: []
        type: singleSelect
        options: []
        optionsarg:
        - simple: Close Now
        - simple: Wait to Auto-close
        fieldassociated: ""
        placeholder: ""
        tooltip: ""
        readonly: false
      title: Select a next step
      description: The post migration Remediation Confirmation Scan wasn't conclusive. Decide the next steps.
      sender: Your SOC team
      expired: false
      totalanswers: 0
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: b676cc13-4dac-48aa-8221-0b52451cf9d4
    type: condition
    task:
      id: b676cc13-4dac-48aa-8221-0b52451cf9d4
      version: -1
      name: What was data collection task response?
      description: Determines the next action (remediation or ticket) based on the previous data collection task.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "88"
      Automated remediation:
      - "12"
      Jira ticket:
      - "156"
      Manual remediation:
      - "63"
      Notification email:
      - "60"
      ServiceNow ticket:
      - "10"
    separatecontext: false
    conditions:
    - label: Automated remediation
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: alert.asmdatacollection
                accessor: selected
            iscontext: true
          right:
            value:
              simple: Automated remediation by restricting open ports
        - operator: isEqualString
          left:
            value:
              complex:
                root: alert.asmdatacollection
                accessor: selected
            iscontext: true
          right:
            value:
              simple: Automated remediation by creating empty S3 bucket
    - label: Manual remediation
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: alert.asmdatacollection
                accessor: selected
            iscontext: true
          right:
            value:
              simple: Manual remediation
    - label: ServiceNow ticket
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: alert.asmdatacollection
                accessor: selected
            iscontext: true
          right:
            value:
              simple: File a ServiceNow Ticket
    - label: Notification email
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: alert.asmdatacollection
                accessor: selected
            iscontext: true
          right:
            value:
              simple: Send a notification email
    - label: Jira ticket
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: alert.asmdatacollection
                accessor: selected
            iscontext: true
          right:
            value:
              simple: File a Jira Ticket
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 1315
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: 7165c67a-9081-4cc6-8a6b-7719f190e23d
    type: collection
    task:
      id: 7165c67a-9081-4cc6-8a6b-7719f190e23d
      version: -1
      name: Verify service exposure resolved by service owner
      description: Determines if manual remediation (by service owner or otherwise) was completed via analyst input.
      type: collection
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "72"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 800,
          "y": 2380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to:
      subject:
      body:
      methods: []
      format: ""
      bcc:
      cc:
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
        completeafterv2: true
        completeaftersla: false
    form:
      questions:
      - id: "0"
        label: ""
        labelarg:
          simple: 'Please verify service exposure was resolved by service owner and mark "complete" when done:'
        required: true
        gridcolumns: []
        defaultrows: []
        type: singleSelect
        options: []
        optionsarg:
        - simple: Yes, remediation complete
        fieldassociated: ""
        placeholder: ""
        tooltip: ""
        readonly: false
      title: Verify that service exposure was resolved by service owner
      description: ""
      sender: Your SOC team
      expired: false
      totalanswers: 0
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: 5ca2243e-cf3d-4826-8225-669e58e56a12
    type: title
    task:
      id: 5ca2243e-cf3d-4826-8225-669e58e56a12
      version: -1
      name: Notification Stage
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "159"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1220,
          "y": 1500
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: 9bd4de64-7f73-4ba3-8b3c-8ec10cecdb0b
    type: title
    task:
      id: 9bd4de64-7f73-4ba3-8b3c-8ec10cecdb0b
      version: -1
      name: Remediation Stage
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "88"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -270,
          "y": 1605
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "69":
    id: "69"
    taskid: c7ff010a-538b-4c51-8526-166c161f5b41
    type: regular
    task:
      id: c7ff010a-538b-4c51-8526-166c161f5b41
      version: -1
      name: Set remediation grid field
      description: |-
        Automation used to more easily populate a grid field.  This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      gridfield:
        simple: asmremediation
      keys:
        simple: action,actiontimestamp,outcome,outcometimestamp
      val1:
        simple: Manual remediation
      val2:
        complex:
          root: alert.asmdatacollection
          accessor: timestamp
      val3:
        simple: Manual remediation completed
      val4:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 2880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "72":
    id: "72"
    taskid: e52a6e9a-0ca3-44ce-8b03-148f0f052d7c
    type: condition
    task:
      id: e52a6e9a-0ca3-44ce-8b03-148f0f052d7c
      version: -1
      name: Manual remediation selected?
      description: Determines if "manual remediation" was selected on main data collection task.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "73"
      manual from RPR:
      - "103"
      manual from data collection:
      - "69"
    separatecontext: false
    conditions:
    - label: manual from data collection
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: alert.asmdatacollection
                accessor: selected
            iscontext: true
          right:
            value:
              simple: Manual remediation
          ignorecase: true
    - label: manual from RPR
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: RemediationAction
            iscontext: true
          right:
            value:
              simple: Manual
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 2650
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "73":
    id: "73"
    taskid: 54f1f028-be62-4e71-8e5e-94b00d27bc8f
    type: regular
    task:
      id: 54f1f028-be62-4e71-8e5e-94b00d27bc8f
      version: -1
      name: Set remediation grid field
      description: |-
        Automation used to more easily populate a grid field.  This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      gridfield:
        simple: asmremediation
      keys:
        simple: action,actiontimestamp,outcome,outcometimestamp
      val1:
        complex:
          root: alert.asmnotification
          accessor: type
          transformers:
          - operator: concat
            args:
              prefix:
                value:
                  simple: 'Notified service owner via '
              suffix: {}
      val2:
        complex:
          root: alert.asmnotification
          accessor: timestamp
      val3:
        simple: Resolved by service owner
      val4:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 850,
          "y": 2880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "81":
    id: "81"
    taskid: 392b206a-2ce0-4df7-8ea8-5de259a2c9dc
    type: regular
    task:
      id: 392b206a-2ce0-4df7-8ea8-5de259a2c9dc
      version: -1
      name: Set alert summary grid field
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "136"
    scriptarguments:
      gridfield:
        simple: asmalertsummary
      keys:
        simple: link,entryid
      val1:
        complex:
          root: demistoUrls
          accessor: server
          transformers:
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: /xsoar/entry/download/
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: ${lastCompletedTaskEntries.[0]}
                iscontext: true
          - operator: replace
            args:
              limit: {}
              replaceWith:
                value:
                  simple: '%40'
              toReplace:
                value:
                  simple: '@'
      val2:
        complex:
          root: lastCompletedTaskEntries
          accessor: '[0]'
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 4140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "86":
    id: "86"
    taskid: 61952b89-0ee9-4d72-8e9a-85320b67134c
    type: playbook
    task:
      id: 61952b89-0ee9-4d72-8e9a-85320b67134c
      version: -1
      name: Cortex ASM - Detect Service
      description: Playbook that looks at what ASM sub-type the alert is and directs it to different pre/post mitigation scans (such as NMAP).
      playbookName: Cortex ASM - Detect Service
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      ASMRuleID:
        complex:
          root: alert
          accessor: asmattacksurfaceruleid
      RemoteIP:
        complex:
          root: alert
          accessor: remoteip
      RemotePort:
        complex:
          root: alert
          accessor: remoteport
      ScanNumber:
        simple: "2"
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 70,
          "y": 3190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "88":
    id: "88"
    taskid: 37e5dd13-953f-442c-840f-c82be8227d2c
    type: collection
    task:
      id: 37e5dd13-953f-442c-840f-c82be8227d2c
      version: -1
      name: Complete manual remediation
      description: Determines if manual remediation (by service owner or otherwise) was completed via analyst input.
      type: collection
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "133"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 2230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to:
      subject:
      body:
      methods: []
      format: ""
      bcc:
      cc:
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
        completeafterv2: true
        completeaftersla: false
    form:
      questions:
      - id: "0"
        label: ""
        labelarg:
          simple: 'Please complete manual remediation and mark "complete" when done:'
        required: true
        gridcolumns: []
        defaultrows: []
        type: singleSelect
        options: []
        optionsarg:
        - simple: Yes, remediation complete
        fieldassociated: ""
        placeholder: ""
        tooltip: ""
        readonly: false
      title: Verify that manual remediation was completed
      description: ""
      sender: Your SOC team
      expired: false
      totalanswers: 0
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "93":
    id: "93"
    taskid: 0a9a40fd-49de-4c82-8dd8-0a06843aecdd
    type: regular
    task:
      id: 0a9a40fd-49de-4c82-8dd8-0a06843aecdd
      version: -1
      name: GenerateSummaryReport - Summary
      description: Generate an ASM Alert Summary report.
      scriptName: GenerateASMReport
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "81"
    scriptarguments:
      alert_details:
        complex:
          root: alert
          accessor: details
      alert_id:
        complex:
          root: alert
          accessor: id
      alert_name:
        complex:
          root: alert
          accessor: name
      alert_severityStr:
        complex:
          root: alert
          accessor: severityStr
      asm_asset_id:
        complex:
          root: alert
          accessor: asmassetid
      asm_cloud:
        complex:
          root: alert
          accessor: asmcloud
      asm_data_collection:
        complex:
          root: alert
          accessor: asmdatacollection
      asm_notification:
        complex:
          root: alert
          accessor: asmnotification
      asm_private_ip:
        complex:
          root: alert
          accessor: asmprivateip
      asm_related:
        complex:
          root: alert
          accessor: asmrelated
      asm_remediation:
        complex:
          root: alert
          accessor: asmremediation
      asm_remediation_path_rule:
        complex:
          root: alert
          accessor: asmremediationpathrule
      asm_service_detection:
        complex:
          root: alert
          accessor: asmservicedetection
      asm_service_id:
        complex:
          root: alert
          accessor: asmserviceid
      asm_service_owner:
        complex:
          root: alert
          accessor: asmserviceowner
      asm_system_ids:
        complex:
          root: alert
          accessor: asmsystemids
      asm_tags:
        complex:
          root: alert
          accessor: asmtags
      report_type:
        simple: summary
      retry-count:
        simple: "1"
      retry-interval:
        simple: "30"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 3980
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "97":
    id: "97"
    taskid: a77560dd-fd29-4480-8067-e1e6bd9faa5e
    type: playbook
    task:
      id: a77560dd-fd29-4480-8067-e1e6bd9faa5e
      version: -1
      name: Cortex ASM - Enrichment
      description: Used as a container folder for all enrichments of ASM alerts.
      playbookName: Cortex ASM - Enrichment
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "125"
    separatecontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": -660
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "103":
    id: "103"
    taskid: 4d8fca4a-2d3b-454b-8d0f-aca40712c9da
    type: regular
    task:
      id: 4d8fca4a-2d3b-454b-8d0f-aca40712c9da
      version: -1
      name: Set remediation grid field
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      gridfield:
        simple: asmremediation
      keys:
        simple: action,actiontimestamp,outcome,outcometimestamp
      val1:
        simple: Manual remediation
      val2:
        complex:
          root: RPR_Timestamp
      val3:
        simple: Manual remediation completed
      val4:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 460,
          "y": 2880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "110":
    id: "110"
    taskid: 022a3ead-e521-4e29-8c1e-3f3969041aab
    type: condition
    task:
      id: 022a3ead-e521-4e29-8c1e-3f3969041aab
      version: -1
      name: Close or keep open?
      description: Determines if the alert will be closed or kept open.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Automated-Remediation':
      - "112"
      '#default#':
      - "4"
      Automated-Remediation With Rule Match:
      - "114"
      Close Now:
      - "111"
      Close Now With Rule Match:
      - "113"
    separatecontext: false
    conditions:
    - label: Automated-Remediation With Rule Match
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: alert.asmremediation
                accessor: outcome
            iscontext: true
          right:
            value:
              simple: Success
          ignorecase: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: alert
                accessor: asmremediationpathrule
            iscontext: true
    - label: ' Automated-Remediation'
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: alert.asmremediation
                accessor: outcome
            iscontext: true
          right:
            value:
              simple: Success
          ignorecase: true
    - label: Close Now With Rule Match
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Select a next step.Answers
                accessor: "0"
            iscontext: true
          right:
            value:
              simple: Close Now
          ignorecase: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: alert
                accessor: asmremediationpathrule
            iscontext: true
    - label: Close Now
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Select a next step.Answers
                accessor: "0"
            iscontext: true
          right:
            value:
              simple: Close Now
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 4470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "111":
    id: "111"
    taskid: 286c6bf2-6631-4ff5-829e-402e4dad06f0
    type: regular
    task:
      id: 286c6bf2-6631-4ff5-829e-402e4dad06f0
      version: -1
      name: Close alert (close now)
      description: Close the current alert because auto-close was selected.
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      closeNotes:
        simple: Alert status set to 'Resolved' by Active Response Module
      closeReason:
        simple: Resolved
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -150,
          "y": 4790
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "112":
    id: "112"
    taskid: fa115b90-0879-44b2-89d9-563af80c467c
    type: regular
    task:
      id: fa115b90-0879-44b2-89d9-563af80c467c
      version: -1
      name: Close alert (remediated automatically)
      description: Close the current alert because Automated Remediation path was selected.
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      closeNotes:
        simple: Alert status set to 'Resolved - Remediated Automatically' by Active Response Module
      closeReason:
        simple: Resolved - Remediated Automatically
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 290,
          "y": 4790
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "113":
    id: "113"
    taskid: f7dc6da9-017e-490a-8963-cdee6b81a0d2
    type: regular
    task:
      id: f7dc6da9-017e-490a-8963-cdee6b81a0d2
      version: -1
      name: Close alert (close now) with rule match
      description: Close the current alert because auto-close was selected.
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      closeNotes:
        complex:
          root: alert.asmremediationpathrule
          accessor: rule_name
          transformers:
          - operator: concat
            args:
              prefix:
                value:
                  simple: 'Alert status set to ''Resolved'' by Active Response Module - Remediation Path Rule: '
              suffix: {}
      closeReason:
        simple: Resolved
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -470,
          "y": 4650
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "114":
    id: "114"
    taskid: d77e73aa-8d8b-4b74-8149-8a7a3074aaa2
    type: regular
    task:
      id: d77e73aa-8d8b-4b74-8149-8a7a3074aaa2
      version: -1
      name: Close alert (remediated automatically) with rule match
      description: Close the current alert because Automated Remediation path was selected.
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      closeNotes:
        complex:
          root: alert.asmremediationpathrule
          accessor: rule_name
          transformers:
          - operator: concat
            args:
              prefix:
                value:
                  simple: 'Alert status set to ''Resolved - Remediated Automatically'' by Active Response Module - Remediation Path Rule: '
              suffix: {}
      closeReason:
        simple: Resolved - Remediated Automatically
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 660,
          "y": 4660
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "120":
    id: "120"
    taskid: af17322e-fdb3-4997-87b3-22b5bfb62627
    type: playbook
    task:
      id: af17322e-fdb3-4997-87b3-22b5bfb62627
      version: -1
      name: Cortex ASM - Remediation Path Rules
      playbookName: Cortex ASM - Remediation Path Rules
      type: playbook
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "145"
    scriptarguments:
      BypassDevCheck:
        complex:
          root: inputs.BypassDevCheck
      ExternallyDetectedProviders:
        complex:
          root: ASM.ExternalService
          accessor: externally_detected_providers
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 70,
          "y": 470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "121":
    id: "121"
    taskid: 38612ed4-9e45-487f-8197-c29ff4a6b1b8
    type: title
    task:
      id: 38612ed4-9e45-487f-8197-c29ff4a6b1b8
      version: -1
      name: Analysis Stage
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "123"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": -335
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "123":
    id: "123"
    taskid: f0961cac-382a-4132-826c-221a31f9c399
    type: regular
    task:
      id: f0961cac-382a-4132-826c-221a31f9c399
      version: -1
      name: GenerateSummaryReport - Analysis
      description: Generate an ASM Alert Summary report.
      scriptName: GenerateASMReport
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "126"
    scriptarguments:
      alert_details:
        complex:
          root: alert
          accessor: details
      alert_id:
        complex:
          root: alert
          accessor: id
      alert_name:
        complex:
          root: alert
          accessor: name
      alert_severityStr:
        complex:
          root: alert
          accessor: severityStr
      asm_asset_id:
        complex:
          root: alert
          accessor: asmassetid
      asm_cloud:
        complex:
          root: alert
          accessor: asmcloud
      asm_data_collection:
        complex:
          root: alert
          accessor: asmdatacollection
      asm_notification:
        complex:
          root: alert
          accessor: asmnotification
      asm_private_ip:
        complex:
          root: alert
          accessor: asmprivateip
      asm_related:
        complex:
          root: alert
          accessor: asmrelated
      asm_remediation:
        complex:
          root: alert
          accessor: asmremediation
      asm_remediation_path_rule:
        complex:
          root: alert
          accessor: asmremediationpathrule
      asm_service_detection:
        complex:
          root: alert
          accessor: asmservicedetection
      asm_service_id:
        complex:
          root: alert
          accessor: asmserviceid
      asm_service_owner:
        complex:
          root: alert
          accessor: asmserviceowner
      asm_system_ids:
        complex:
          root: alert
          accessor: asmsystemids
      asm_tags:
        complex:
          root: alert
          accessor: asmtags
      report_type:
        simple: analysis
      retry-count:
        simple: "1"
      retry-interval:
        simple: "30"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": -200
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "124":
    id: "124"
    taskid: 53703150-25d1-4be1-835a-aa734d3f8aa9
    type: regular
    task:
      id: 53703150-25d1-4be1-835a-aa734d3f8aa9
      version: -1
      name: Set playbook stage grid field (triage)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: triage
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": -960
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "125":
    id: "125"
    taskid: df13515c-2392-457d-82b1-b258d763ddb0
    type: regular
    task:
      id: df13515c-2392-457d-82b1-b258d763ddb0
      version: -1
      name: Set playbook stage grid field (enrichment)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "121"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: enrichment
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": -495
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "126":
    id: "126"
    taskid: da4035eb-9c45-42e1-8b0d-eb1beb90162c
    type: regular
    task:
      id: da4035eb-9c45-42e1-8b0d-eb1beb90162c
      version: -1
      name: Set playbook stage grid field (analysis)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "144"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: analysis
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": -40
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "128":
    id: "128"
    taskid: 2ce7d3ac-037c-435a-861e-ac7c4b8ced75
    type: regular
    task:
      id: 2ce7d3ac-037c-435a-861e-ac7c4b8ced75
      version: -1
      name: Set playbook stage grid field (decision)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "63"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: decision
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -270,
          "y": 1180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "129":
    id: "129"
    taskid: 8fc5f50c-6e63-4f3c-8f03-ad76858a5bf5
    type: regular
    task:
      id: 8fc5f50c-6e63-4f3c-8f03-ad76858a5bf5
      version: -1
      name: Set playbook stage grid field (decision)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: decision
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -700,
          "y": 1120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "130":
    id: "130"
    taskid: ec56d4d3-4300-44dd-8957-2c0640083e60
    type: regular
    task:
      id: ec56d4d3-4300-44dd-8957-2c0640083e60
      version: -1
      name: Set playbook stage grid field (decision)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: decision
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 800,
          "y": 1105
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "131":
    id: "131"
    taskid: c4188137-abdc-4b2c-88c0-8316bf2497b6
    type: regular
    task:
      id: c4188137-abdc-4b2c-88c0-8316bf2497b6
      version: -1
      name: Set playbook stage grid field (decision)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "60"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: decision
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1220,
          "y": 1025
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "133":
    id: "133"
    taskid: a349116c-5449-4126-8446-39d00e264815
    type: regular
    task:
      id: a349116c-5449-4126-8446-39d00e264815
      version: -1
      name: Set playbook stage grid field (remediation)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "72"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: remediation
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 2400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "134":
    id: "134"
    taskid: a25729fa-3d59-4c90-883d-f7db1542f40a
    type: regular
    task:
      id: a25729fa-3d59-4c90-883d-f7db1542f40a
      version: -1
      name: Set playbook stage grid field (notification)
      description: |-
        Automation used to more easily populate a grid field.  This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "50"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: notification
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 800,
          "y": 1965
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "135":
    id: "135"
    taskid: 889ce0c5-7074-4de2-85c6-d20a5692ec02
    type: regular
    task:
      id: 889ce0c5-7074-4de2-85c6-d20a5692ec02
      version: -1
      name: Set playbook stage grid field (validation)
      description: |-
        Automation used to more easily populate a grid field.  This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: validation
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 3700
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "136":
    id: "136"
    taskid: 15091cc5-e845-4199-852c-5a3efe22b013
    type: regular
    task:
      id: 15091cc5-e845-4199-852c-5a3efe22b013
      version: -1
      name: Set playbook stage grid field (summarization)
      description: |-
        Automation used to more easily populate a grid field.  This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "110"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: summarization
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 4310
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "141":
    id: "141"
    taskid: 3377b622-c50e-4291-8d98-596fd94f7aac
    type: title
    task:
      id: 3377b622-c50e-4291-8d98-596fd94f7aac
      version: -1
      name: continue
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "142"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -1110,
          "y": 995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "142":
    id: "142"
    taskid: 15c3d3b8-c30f-4eed-81b7-6c8b63cb11c7
    type: regular
    task:
      id: 15c3d3b8-c30f-4eed-81b7-6c8b63cb11c7
      version: -1
      name: Close alert (accepted risk)
      description: Close the current alert because the service is no longer observed.
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      closeNotes:
        simple: Alert status set to 'Resolved - Risk Accepted' by Active Response Module
      closeReason:
        simple: Resolved - Risk Accepted
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -920,
          "y": 4650
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "144":
    id: "144"
    taskid: 498b02e9-c216-483b-8fb0-f375ff9f45d0
    type: condition
    task:
      id: 498b02e9-c216-483b-8fb0-f375ff9f45d0
      version: -1
      name: Are there any matches from accepted risk lists?
      description: Checks if the system IDs, folders, and projects are present in the accepted risk lists.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "8"
      "yes":
      - "141"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: inList
          left:
            value:
              complex:
                root: alert.asmsystemids
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: alert.asmsystemids.type
                      iscontext: true
                    right:
                      value:
                        simple: ASSET-ID
                accessor: id
            iscontext: true
          right:
            value:
              complex:
                root: inputs.AcceptedRiskDs
            iscontext: true
        - operator: inList
          left:
            value:
              complex:
                root: alert.asmsystemids
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: alert.asmsystemids.type
                      iscontext: true
                    right:
                      value:
                        simple: GCP-Project-Number
                accessor: id
            iscontext: true
          right:
            value:
              complex:
                root: inputs.AcceptedRiskProjects
            iscontext: true
        - operator: inList
          left:
            value:
              complex:
                root: alert.asmcloud
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: alert.asmcloud.provider
                      iscontext: true
                    right:
                      value:
                        simple: AWS
                accessor: project
            iscontext: true
          right:
            value:
              complex:
                root: inputs.AcceptedRiskProjects
            iscontext: true
        - operator: inList
          left:
            value:
              complex:
                root: alert.asmsystemids
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: alert.asmsystemids.type
                      iscontext: true
                    right:
                      value:
                        simple: GCP-Folder-Number
                accessor: id
            iscontext: true
          right:
            value:
              complex:
                root: inputs.AcceptedRiskOther
            iscontext: true
        - operator: inList
          left:
            value:
              complex:
                root: alert.asmcloud
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: alert.asmcloud.provider
                      iscontext: true
                    right:
                      value:
                        simple: Azure
                accessor: organization
            iscontext: true
          right:
            value:
              complex:
                root: inputs.AcceptedRiskOther
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "145":
    id: "145"
    taskid: 93018e08-34f3-48a6-8e62-2fd6a2b9122a
    type: condition
    task:
      id: 93018e08-34f3-48a6-8e62-2fd6a2b9122a
      version: -1
      name: What is the remediation action?
      description: Determines what the remediation action is (direct action or data collection task).
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "48"
      Automated Remediation:
      - "146"
      Jira Ticket:
      - "161"
      Manual Remediation:
      - "152"
      Notification Email:
      - "163"
      ServiceNow Ticket:
      - "162"
    separatecontext: false
    conditions:
    - label: Automated Remediation
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: RemediationAction
            iscontext: true
          right:
            value:
              simple: AR
    - label: ServiceNow Ticket
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: RemediationAction
            iscontext: true
          right:
            value:
              simple: SNOW
    - label: Notification Email
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: RemediationAction
            iscontext: true
          right:
            value:
              simple: Email
    - label: Manual Remediation
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: RemediationAction
            iscontext: true
          right:
            value:
              simple: Manual
    - label: Jira Ticket
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: RemediationAction
            iscontext: true
          right:
            value:
              simple: Jira
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 660
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "146":
    id: "146"
    taskid: d8033440-ad22-42db-8b46-2a3746edb2c7
    type: title
    task:
      id: d8033440-ad22-42db-8b46-2a3746edb2c7
      version: -1
      name: Automated Remediation
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "129"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -700,
          "y": 995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "152":
    id: "152"
    taskid: a7200b67-7995-492a-8e56-740fe7693581
    type: title
    task:
      id: a7200b67-7995-492a-8e56-740fe7693581
      version: -1
      name: Manual Remediation
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "128"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -270,
          "y": 1050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "154":
    id: "154"
    taskid: 01661a90-d299-4a94-8545-2c29245b3aaa
    type: playbook
    task:
      id: 01661a90-d299-4a94-8545-2c29245b3aaa
      version: -1
      name: Cortex ASM - Jira Notification
      description: This playbook is used to direct Jira tickets to service owners to notify them of their internet exposures.
      playbookName: Cortex ASM - Jira Notification
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "134"
    scriptarguments:
      JiraProjectKey:
        complex:
          root: inputs.JiraProjectKey
      OwnerNotificationBody:
        complex:
          root: inputs.OwnerNotificationBody
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 370,
          "y": 1760
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "156":
    id: "156"
    taskid: e6407346-0b25-49ef-808c-210070e356c3
    type: title
    task:
      id: e6407346-0b25-49ef-808c-210070e356c3
      version: -1
      name: Notification Stage
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "154"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 370,
          "y": 1630
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "157":
    id: "157"
    taskid: fc927b90-0fc6-40d3-8f08-c53e6ea4961b
    type: regular
    task:
      id: fc927b90-0fc6-40d3-8f08-c53e6ea4961b
      version: -1
      name: Set playbook stage grid field (decision)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "156"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: decision
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 370,
          "y": 1175
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "158":
    id: "158"
    taskid: 945cf396-8f46-4b7a-8c7f-3a90dbfd1af1
    type: playbook
    task:
      id: 945cf396-8f46-4b7a-8c7f-3a90dbfd1af1
      version: -1
      name: Cortex ASM - ServiceNow Notification
      description: This playbook is used to direct ServiceNow tickets to service owners to notify them of their internet exposures.
      playbookName: Cortex ASM - ServiceNow Notification
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "134"
    scriptarguments:
      OwnerNotificationBody:
        complex:
          root: inputs.OwnerNotificationBody
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 800,
          "y": 1700
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "159":
    id: "159"
    taskid: a0fd44d7-b931-452b-83d2-4894b2cae813
    type: playbook
    task:
      id: a0fd44d7-b931-452b-83d2-4894b2cae813
      version: -1
      name: Cortex ASM - Email Notification
      description: This playbook is used to send email notifications to service owners to notify them of their internet exposures.
      playbookName: Cortex ASM - Email Notification
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "134"
    scriptarguments:
      OwnerNotificationBody:
        complex:
          root: inputs.OwnerNotificationBody
      OwnerNotificationSubject:
        complex:
          root: inputs.OwnerNotificationSubject
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 1220,
          "y": 1635
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "161":
    id: "161"
    taskid: 9dc364d1-ce5f-4e1f-8bb6-0106976c4b43
    type: title
    task:
      id: 9dc364d1-ce5f-4e1f-8bb6-0106976c4b43
      version: -1
      name: Jira Ticket
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "157"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 370,
          "y": 1040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "162":
    id: "162"
    taskid: 3cb0f4fe-dc9b-4a2d-8673-961d856bd846
    type: title
    task:
      id: 3cb0f4fe-dc9b-4a2d-8673-961d856bd846
      version: -1
      name: ServiceNow Ticket
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "130"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 800,
          "y": 970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "163":
    id: "163"
    taskid: e1226618-4fba-46d7-8df3-812766ac1bcc
    type: title
    task:
      id: e1226618-4fba-46d7-8df3-812766ac1bcc
      version: -1
      name: Email Notification
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "131"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1220,
          "y": 890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "164":
    id: "164"
    taskid: 694a0e4c-78bf-48e0-83da-27bd08d3a597
    type: regular
    task:
      id: 694a0e4c-78bf-48e0-83da-27bd08d3a597
      version: -1
      name: Set remediation grid field
      description: |-
        Automation used to more easily populate a grid field.  This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "168"
    scriptarguments:
      gridfield:
        simple: asmremediation
      keys:
        simple: action,actiontimestamp,outcome,outcometimestamp
      val1:
        simple: close service port from internet
      val2:
        simple: TIMESTAMP
      val3:
        simple: Success
      val4:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -690,
          "y": 1860
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "165":
    id: "165"
    taskid: 9766e878-ca17-4ede-8edc-d52a85f50572
    type: condition
    task:
      id: 9766e878-ca17-4ede-8edc-d52a85f50572
      version: -1
      name: Are there service owners with emails?
      description: Verifies if we have emails for service owners.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "11"
      "yes":
      - "166"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: alert.asmserviceowner
                filters:
                - - operator: containsGeneral
                    left:
                      value:
                        simple: alert.asmserviceowner.email
                      iscontext: true
                    right:
                      value:
                        simple: '@'
                accessor: email
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -690,
          "y": 2210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "166":
    id: "166"
    taskid: 65ff4507-e0b4-45cf-8eb7-093c23437b3d
    type: regular
    task:
      id: 65ff4507-e0b4-45cf-8eb7-093c23437b3d
      version: -1
      name: Send remediation notification email to service owners
      description: Send an email to service owners regarding the status of the automated remediation action that was taken.
      script: '|||send-mail'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "169"
    scriptarguments:
      htmlBody:
        complex:
          root: inputs.RemediationNotificationHTMLBody
      subject:
        complex:
          root: inputs.RemediationNotificationSubject
      to:
        complex:
          root: alert.asmserviceowner
          filters:
          - - operator: containsGeneral
              left:
                value:
                  simple: alert.asmserviceowner.email
                iscontext: true
              right:
                value:
                  simple: '@'
          accessor: email
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -810,
          "y": 2440
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "167":
    id: "167"
    taskid: 5ed915a6-10ec-457e-82e1-e43fce2fbd20
    type: playbook
    task:
      id: 5ed915a6-10ec-457e-82e1-e43fce2fbd20
      version: -1
      name: Cortex ASM - Remediation
      description: This playbook contains all the cloud provider sub-playbooks for remediation.
      playbookName: Cortex ASM - Remediation
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "164"
    separatecontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -690,
          "y": 1685
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "168":
    id: "168"
    taskid: b8c22c39-7ffa-45cd-820a-ecf45a7c404d
    type: regular
    task:
      id: b8c22c39-7ffa-45cd-820a-ecf45a7c404d
      version: -1
      name: Set playbook stage grid field (remediation)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "165"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: remediation
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -690,
          "y": 2040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "169":
    id: "169"
    taskid: 5d8aa595-66bd-4d5b-8f7f-9f8904a95359
    type: regular
    task:
      id: 5d8aa595-66bd-4d5b-8f7f-9f8904a95359
      version: -1
      name: Set playbook stage grid field (notification)
      description: |-
        Automation used to more easily populate a grid field.  This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: notification
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -810,
          "y": 2600
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "171":
    id: "171"
    taskid: fe9fb336-9093-4cd5-8858-7e026f3a049c
    type: regular
    task:
      id: fe9fb336-9093-4cd5-8858-7e026f3a049c
      version: -1
      name: Initialize grid fields
      description: Clear ASM grid fields in case the playbook is rerun.
      script: Builtin|||setAlert
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "124"
    scriptarguments:
      asmalertsummary:
        simple: '[]'
      asmcloud:
        simple: '[]'
      asmdatacollection:
        simple: '[]'
      asmdevcheckdetails:
        simple: '[]'
      asmenrichmentstatus:
        simple: '[]'
      asmnotification:
        simple: '[]'
      asmplaybookstage:
        simple: '[]'
      asmprivateip:
        simple: '[]'
      asmremediation:
        simple: '[]'
      asmremediationobjectives:
        simple: '[{"option": "File a ServiceNow Ticket", "statement": "In this case, a ServiceNow ticket will be created with some information on the alert and possible remediation guidance suggestions."},{"option": "File a Jira Ticket", "statement": "In this case, a Jira ticket will be created with some information on the alert and possible remediation guidance suggestions."},{"option": "Send a notification email", "statement": "In this case, an email ticket will be created with some information on the alert and possible remediation guidance suggestions."},{"option": "Manual remediation", "statement": "In this case, we will require you to manually remediate this exposure."}]'
      asmremediationpathrule:
        simple: '[]'
      asmservicedetection:
        simple: '[]'
      asmserviceowner:
        simple: '[]'
      asmserviceownerunrankedraw:
        simple: '[]'
      asmsystemids:
        simple: '[]'
      asmtags:
        simple: '[]'
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": -1130
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "110_111_Close Now": 0.88,
      "110_112_ Automated-Remediation": 0.88,
      "145_152_Manual Remediation": 0.68,
      "145_161_Jira Ticket": 0.87,
      "145_163_Notification Email": 0.74,
      "20_135_no": 0.53,
      "48_10_ServiceNow ticket": 0.82,
      "48_60_Notification email": 0.88,
      "48_63_Manual remediation": 0.52
    },
    "paper": {
      "dimensions": {
        "height": 6725,
        "width": 2710,
        "x": -1110,
        "y": -1400
      }
    }
  }
inputs:
- key: OwnerNotificationSubject
  value:
    simple: A new security risk was identified on an external service owned by your team
  required: true
  description: Subject of the notification (email or ticket) sent to potential service owner.
  playbookInputQuery:
- key: OwnerNotificationBody
  value:
    simple: |+
      Infosec identified a security risk on an external service potentially owned by your team: ${alert.name}<br><br>

      Description: ${alert.details}
      <br><br>

  required: true
  description: Body of the notification (email or ticket) sent to potential service owner.
  playbookInputQuery:
- key: RemediationNotificationSubject
  value:
    simple: A new security risk was addressed on an external service owned by your team
  required: true
  description: Subject of the notification (email or ticket) sent to the service owner after remediation.
  playbookInputQuery:
- key: RemediationNotificationHTMLBody
  value:
    simple: |-
      <!DOCTYPE html>
      <html lang="en">
      <body>
          <p>
              Infosec identified a security risk on an external service potentially owned by your
              team:<br><b>${alert.name}</b>
          </p>
          <p>
              <b>Alert Details:</b> ${alert.details}<br>
              <b>Action Taken:</b> ${alert.asmremediation.[0].action}<br>
              <b>Action Outcome:</b> ${alert.asmremediation.[0].outcome}<br>
          </p>
      </body>
      </html>
  required: true
  description: Body of the notification (email or ticket) sent to the service owner after remediation.
  playbookInputQuery:
- key: BypassDevCheck
  value:
    simple: "False"
  required: false
  description: |-
    Determine whether to bypass the Dev Check in automated remediation criteria: https://docs-cortex.paloaltonetworks.com/r/Cortex-XPANSE/Cortex-Xpanse-Expander-User-Guide/Automated-Remediation-Capabilities-Matrix

    Set to "True" if you want to bypass.  Default is "False".
  playbookInputQuery:
- key: AcceptedRiskDs
  value: {}
  required: false
  description: Comma-separated list of instance/VM IDs that are considered an accepted risk and that should be closed.
  playbookInputQuery:
- key: AcceptedRiskProjects
  value: {}
  required: false
  description: Comma-separated list of projects numbers that are considered an accepted risk and that should be closed.  For example, a list of GCP projects and AWS accounts.
  playbookInputQuery:
- key: AcceptedRiskOther
  value: {}
  required: false
  description: Comma-separated list of other items that are considered an accepted risk and that should be closed. For example, a list of folders numbers in GCP and subscription IDs in Azure.
  playbookInputQuery:
- key: JiraProjectKey
  value:
    simple: XPANSE
  required: true
  description: The Jira project key to associate with the issue.
  playbookInputQuery:
outputs: []
tests:
- No tests (auto formatted)
fromversion: 6.9.0
