id: Cortex ASM - ASM Alert
version: -1
name: Cortex ASM - ASM Alert
description: This playbook handles ASM alerts by enriching asset information and providing a means of remediating the issue directly or through contacting service owners.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 84576b4c-b776-424e-87a8-711902dee83a
    type: start
    task:
      id: 84576b4c-b776-424e-87a8-711902dee83a
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "5"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 70,
          "y": -1400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "4":
    id: "4"
    taskid: 34db70c9-1ac3-481f-854d-81620704b1d5
    type: title
    task:
      id: 34db70c9-1ac3-481f-854d-81620704b1d5
      version: -1
      name: Complete
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 70,
          "y": 5260
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "5":
    id: "5"
    taskid: f0857763-7f31-49b4-8d66-efb8b970782a
    type: title
    task:
      id: f0857763-7f31-49b4-8d66-efb8b970782a
      version: -1
      name: Triage and Qualifier Stage
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "138"
      - "170"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 70,
          "y": -1270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "6":
    id: "6"
    taskid: 41853c06-18a3-4f8f-8f9a-f185ddaa6d81
    type: title
    task:
      id: 41853c06-18a3-4f8f-8f9a-f185ddaa6d81
      version: -1
      name: Enrichment Stage
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "97"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": -790
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: e675fced-3b5d-455e-8a46-13be6f7fb31a
    type: title
    task:
      id: e675fced-3b5d-455e-8a46-13be6f7fb31a
      version: -1
      name: Decision Stage
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "120"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 330
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: f0935653-c57f-4ec4-831c-a09890708e78
    type: title
    task:
      id: f0935653-c57f-4ec4-831c-a09890708e78
      version: -1
      name: Notification Stage
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "158"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 800,
          "y": 1570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 2d35652f-08b8-4920-8a75-7a3bfaa35656
    type: title
    task:
      id: 2d35652f-08b8-4920-8a75-7a3bfaa35656
      version: -1
      name: Validation Stage
      type: title
      iscommand: false
      brand: ""
      description: 'Send an email'
    nexttasks:
      '#none#':
      - "86"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 3055
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: d4b368b7-a75a-48e1-86e3-036541200406
    type: title
    task:
      id: d4b368b7-a75a-48e1-86e3-036541200406
      version: -1
      name: Remediation Stage
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "167"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -690,
          "y": 1540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: ddcf1c90-12ee-4197-8b71-7eceed1660a4
    type: title
    task:
      id: ddcf1c90-12ee-4197-8b71-7eceed1660a4
      version: -1
      name: Summarization Stage
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "93"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 3855
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: c5a60b15-6304-46ba-8e82-588befacd5c9
    type: condition
    task:
      id: c5a60b15-6304-46ba-8e82-588befacd5c9
      version: -1
      name: Service exposure still observable?
      description: Determines if service was still observable and also if automated remediation was done.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "21"
      "no":
      - "135"
    separatecontext: false
    conditions:
    - label: "no"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: alert.asmservicedetection
                accessor: ScanResult
                transformers:
                - operator: LastArrayElement
            iscontext: true
          right:
            value:
              simple: REMEDIATED
        - operator: isEqualString
          left:
            value:
              complex:
                root: alert.asmremediation
                accessor: Outcome
            iscontext: true
          right:
            value:
              simple: Success
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 3350
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: 45cac138-9d24-4c81-8dff-1dffc0f39f20
    type: collection
    task:
      id: 45cac138-9d24-4c81-8dff-1dffc0f39f20
      version: -1
      name: What to do if Remediation Confirmation Scan is inconclusive?
      description: Determines if alert should be closed or kept open for auto-closure based on analyst input.
      type: collection
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "135"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 310,
          "y": 3530
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to:
      subject:
      body:
        simple: The post migration NMAP scan wasn't conclusive, decide next steps.
      methods: []
      format: ""
      bcc:
      cc:
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
        completeafterv2: true
        completeaftersla: false
    form:
      questions:
      - id: "0"
        label: ""
        labelarg:
          simple: If you know the issue has been remediated, choose to keep open and have next Xpanse scan auto-close or manually close now.
        required: false
        gridcolumns: []
        defaultrows: []
        type: singleSelect
        options: []
        optionsarg:
        - simple: Close Now
        - simple: Wait to Auto-close
        fieldassociated: ""
        placeholder: ""
        tooltip: ""
        readonly: false
      title: Select a next step
      description: The post migration Remediation Confirmation Scan wasn't conclusive. Decide the next steps.
      sender: Your SOC team
      expired: false
      totalanswers: 0
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: 0313f70b-610c-43f0-8c34-8946d941a546
    type: condition
    task:
      id: 0313f70b-610c-43f0-8c34-8946d941a546
      version: -1
      name: What was data collection task response?
      description: Determines the next action (remediation or ticket) based on the previous data collection task.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "88"
      Automated remediation:
      - "12"
      Manual remediation:
      - "63"
      Notification email:
      - "60"
      ServiceNow ticket:
      - "10"
      Jira ticket:
      - "156"
    separatecontext: false
    conditions:
    - label: Automated remediation
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Select a remediation option.Answers
                accessor: "0"
            iscontext: true
          right:
            value:
              simple: Automated remediation by restricting open ports
        - operator: isEqualString
          left:
            value:
              complex:
                root: Select a remediation option.Answers
                accessor: "0"
            iscontext: true
          right:
            value:
              simple: Automated remediation by creating empty S3 bucket
    - label: Manual remediation
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Select a remediation option.Answers
                accessor: "0"
            iscontext: true
          right:
            value:
              simple: Manual remediation
    - label: ServiceNow ticket
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Select a remediation option.Answers
                accessor: "0"
            iscontext: true
          right:
            value:
              simple: File a ServiceNow Ticket
    - label: Notification email
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Select a remediation option.Answers
                accessor: "0"
            iscontext: true
          right:
            value:
              simple: Send a notification email
    - label: Jira ticket
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Select a remediation option.Answers
                accessor: "0"
            iscontext: true
          right:
            value:
              simple: File a Jira Ticket
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 1315
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: 573c0802-e6a9-475c-8f31-06894bb3c1ba
    type: collection
    task:
      id: 573c0802-e6a9-475c-8f31-06894bb3c1ba
      version: -1
      name: Verify service exposure resolved by service owner
      description: Determines if manual remediation (by service owner or otherwise) was completed via analyst input.
      type: collection
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "72"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 800,
          "y": 2380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to:
      subject:
      body:
      methods: []
      format: ""
      bcc:
      cc:
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
        completeafterv2: true
        completeaftersla: false
    form:
      questions:
      - id: "0"
        label: ""
        labelarg:
          simple: 'Please verify service exposure was resolved by service owner and mark "complete" when done:'
        required: true
        gridcolumns: []
        defaultrows: []
        type: singleSelect
        options: []
        optionsarg:
        - simple: Yes, remediation complete
        fieldassociated: ""
        placeholder: ""
        tooltip: ""
        readonly: false
      title: Verify that service exposure was resolved by service owner
      description: ""
      sender: Your SOC team
      expired: false
      totalanswers: 0
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: dc9eb1de-3ccf-47bc-8cde-7f850851a888
    type: title
    task:
      id: dc9eb1de-3ccf-47bc-8cde-7f850851a888
      version: -1
      name: Notification Stage
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "159"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1220,
          "y": 1500
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: e4d4fbf3-1f17-4798-8000-2074df4c434b
    type: title
    task:
      id: e4d4fbf3-1f17-4798-8000-2074df4c434b
      version: -1
      name: Remediation Stage
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "88"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -270,
          "y": 1605
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "69":
    id: "69"
    taskid: c886fd8e-e3ce-483a-816a-519e8dc854e5
    type: regular
    task:
      id: c886fd8e-e3ce-483a-816a-519e8dc854e5
      version: -1
      name: Set remediation grid field
      description: |-
        Automation used to more easily populate a grid field.  This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      gridfield:
        simple: asmremediation
      keys:
        simple: Action,ActionTimestamp,Outcome,OutcomeTimestamp
      val1:
        simple: Manual remediation
      val2:
        complex:
          root: alert.asmdatacollection
          accessor: Timestamp
      val3:
        simple: Manual remediation completed
      val4:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 2880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "72":
    id: "72"
    taskid: e7a59013-71cb-44e9-8386-dc3bcf5f6b3e
    type: condition
    task:
      id: e7a59013-71cb-44e9-8386-dc3bcf5f6b3e
      version: -1
      name: Manual remediation selected?
      description: Determines if "manual remediation" was selected on main data collection task.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "73"
      manual from RPR:
      - "103"
      manual from data collection:
      - "69"
    separatecontext: false
    conditions:
    - label: "manual from data collection"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Select a remediation option.Answers
                accessor: "0"
            iscontext: true
          right:
            value:
              simple: Manual remediation
          ignorecase: true
    - label: manual from RPR
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: RemediationAction
            iscontext: true
          right:
            value:
              simple: Manual
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 2650
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "73":
    id: "73"
    taskid: 260da4cc-cde3-4e39-86b3-1bb1e69c0a5d
    type: regular
    task:
      id: 260da4cc-cde3-4e39-86b3-1bb1e69c0a5d
      version: -1
      name: Set remediation grid field
      description: |-
        Automation used to more easily populate a grid field.  This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      gridfield:
        simple: asmremediation
      keys:
        simple: Action,ActionTimestamp,Outcome,OutcomeTimestamp
      val1:
        complex:
          root: alert.asmnotification
          accessor: Type
          transformers:
          - operator: concat
            args:
              prefix:
                value:
                  simple: 'Notified service owner via '
              suffix: {}
      val2:
        complex:
          root: alert.asmnotification
          accessor: Timestamp
      val3:
        simple: Resolved by service owner
      val4:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 850,
          "y": 2880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "81":
    id: "81"
    taskid: 2b4f7751-1391-4332-8d6c-3d220fb1a66d
    type: regular
    task:
      id: 2b4f7751-1391-4332-8d6c-3d220fb1a66d
      version: -1
      name: Set alert summary grid field
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "110"
    scriptarguments:
      gridfield:
        simple: asmalertsummary
      keys:
        simple: Link,EntryID
      val1:
        complex:
          root: demistoUrls
          accessor: server
          transformers:
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: /xsoar/entry/download/
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: ${lastCompletedTaskEntries.[0]}
                iscontext: true
          - operator: replace
            args:
              limit: {}
              replaceWith:
                value:
                  simple: '%40'
              toReplace:
                value:
                  simple: '@'
      val2:
        complex:
          root: lastCompletedTaskEntries
          accessor: '[0]'
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 4310
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "86":
    id: "86"
    taskid: 9f423faf-2a12-4cdd-84c6-c16f50f54e11
    type: playbook
    task:
      id: 9f423faf-2a12-4cdd-84c6-c16f50f54e11
      version: -1
      name: Cortex ASM - Detect Service
      description: Playbook that looks at what ASM sub-type the alert is and directs it to different pre/post mitigation scans (such as NMAP).
      playbookName: Cortex ASM - Detect Service
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      ASMRuleID:
        complex:
          root: alert
          accessor: asmattacksurfaceruleid
      RemoteIP:
        complex:
          root: alert
          accessor: remoteip
      RemotePort:
        complex:
          root: alert
          accessor: remoteport
      ScanNumber:
        simple: "2"
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 70,
          "y": 3190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "88":
    id: "88"
    taskid: 558427ae-e372-40d0-87e6-793549cebd3d
    type: collection
    task:
      id: 558427ae-e372-40d0-87e6-793549cebd3d
      version: -1
      name: Complete manual remediation
      description: Determines if manual remediation (by service owner or otherwise) was completed via analyst input.
      type: collection
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "133"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 2230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to:
      subject:
      body:
      methods: []
      format: ""
      bcc:
      cc:
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
        completeafterv2: true
        completeaftersla: false
    form:
      questions:
      - id: "0"
        label: ""
        labelarg:
          simple: 'Please complete manual remediation and mark "complete" when done:'
        required: true
        gridcolumns: []
        defaultrows: []
        type: singleSelect
        options: []
        optionsarg:
        - simple: Yes, remediation complete
        fieldassociated: ""
        placeholder: ""
        tooltip: ""
        readonly: false
      title: Verify that manual remediation was completed
      description: ""
      sender: Your SOC team
      expired: false
      totalanswers: 0
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "93":
    id: "93"
    taskid: 64e537fa-2075-4958-876b-fdd4c1c382e6
    type: regular
    task:
      id: 64e537fa-2075-4958-876b-fdd4c1c382e6
      version: -1
      name: GenerateSummaryReport - Summary
      description: Generate an ASM Alert Summary report.
      scriptName: GenerateASMReport
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "136"
    scriptarguments:
      alert_details:
        complex:
          root: alert
          accessor: details
      alert_id:
        complex:
          root: alert
          accessor: id
      alert_name:
        complex:
          root: alert
          accessor: name
      alert_severityStr:
        complex:
          root: alert
          accessor: severityStr
      asm_cloud:
        complex:
          root: alert
          accessor: asmcloud
      asm_data_collection:
        complex:
          root: alert
          accessor: asmdatacollection
      asm_notification:
        complex:
          root: alert
          accessor: asmnotification
      asm_private_ip:
        complex:
          root: alert
          accessor: asmprivateip
      asm_related:
        complex:
          root: alert
          accessor: asmrelated
      asm_remediation:
        complex:
          root: alert
          accessor: asmremediation
      asm_service_detection:
        complex:
          root: alert
          accessor: asmservicedetection
      asm_service_owner:
        complex:
          root: alert
          accessor: asmserviceowner
      asm_system_ids:
        complex:
          root: alert
          accessor: asmsystemids
      asm_tags:
        complex:
          root: alert
          accessor: asmtags
      asm_asset_id:
        complex:
          root: alert
          accessor: asmassetid
      asm_remediation_path_rule:
        complex:
          root: alert
          accessor: asmremediationpathrule
      asm_service_id:
        complex:
          root: alert
          accessor: asmserviceid
      report_type:
        simple: summary
      retry-count:
        simple: "1"
      retry-interval:
        simple: "30"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 3980
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "97":
    id: "97"
    taskid: becba0c7-0e1a-47ac-85a2-d52152c6f50a
    type: playbook
    task:
      id: becba0c7-0e1a-47ac-85a2-d52152c6f50a
      version: -1
      name: Cortex ASM - Enrichment
      description: Used as a container folder for all enrichments of ASM alerts.
      playbookName: Cortex ASM - Enrichment
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "125"
    separatecontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": -660
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "103":
    id: "103"
    taskid: cda93bd9-0a01-421f-808f-8d1985492bc2
    type: regular
    task:
      id: cda93bd9-0a01-421f-808f-8d1985492bc2
      version: -1
      name: Set remediation grid field
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      gridfield:
        simple: asmremediation
      keys:
        simple: Action,ActionTimestamp,Outcome,OutcomeTimestamp
      val1:
        simple: Manual remediation
      val2:
        complex:
          root: RPR_Timestamp
      val3:
        simple: Manual remediation completed
      val4:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 460,
          "y": 2880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "110":
    id: "110"
    taskid: ac999a8d-91d8-46a0-8697-0ced47317930
    type: condition
    task:
      id: ac999a8d-91d8-46a0-8697-0ced47317930
      version: -1
      name: Close or keep open?
      description: Determines if the alert will be closed or kept open.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Automated-Remediation':
      - "112"
      '#default#':
      - "4"
      Automated-Remediation With Rule Match:
      - "114"
      Close Now:
      - "111"
      Close Now With Rule Match:
      - "113"
    separatecontext: false
    conditions:
    - label: Automated-Remediation With Rule Match
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: alert.asmremediation
                accessor: Outcome
            iscontext: true
          right:
            value:
              simple: Success
          ignorecase: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: alert
                accessor: asmremediationpathrule
            iscontext: true
    - label: ' Automated-Remediation'
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: alert.asmremediation
                accessor: Outcome
            iscontext: true
          right:
            value:
              simple: Success
          ignorecase: true
    - label: Close Now With Rule Match
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Select a next step.Answers
                accessor: "0"
            iscontext: true
          right:
            value:
              simple: Close Now
          ignorecase: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: alert
                accessor: asmremediationpathrule
            iscontext: true
    - label: Close Now
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Select a next step.Answers
                accessor: "0"
            iscontext: true
          right:
            value:
              simple: Close Now
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 4470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "111":
    id: "111"
    taskid: 54ba2a93-2655-49ab-8cb8-556f39d32fee
    type: regular
    task:
      id: 54ba2a93-2655-49ab-8cb8-556f39d32fee
      version: -1
      name: Close alert (close now)
      description: Close the current alert because auto-close was selected.
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      closeNotes:
        simple: Alert status set to 'Resolved' by Active Response Module
      closeReason:
        simple: Resolved
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -150,
          "y": 4790
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "112":
    id: "112"
    taskid: 37f3dfdd-c38c-4324-868c-e5859a772cde
    type: regular
    task:
      id: 37f3dfdd-c38c-4324-868c-e5859a772cde
      version: -1
      name: Close alert (remediated automatically)
      description: Close the current alert because Automated Remediation path was selected.
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      closeNotes:
        simple: Alert status set to 'Resolved - Remediated Automatically' by Active Response Module
      closeReason:
        simple: Resolved - Remediated Automatically
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 290,
          "y": 4790
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "113":
    id: "113"
    taskid: c6cfe0d1-7fed-4ecf-86f7-9bcb45af814e
    type: regular
    task:
      id: c6cfe0d1-7fed-4ecf-86f7-9bcb45af814e
      version: -1
      name: Close alert (close now) with rule match
      description: Close the current alert because auto-close was selected.
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      closeNotes:
        complex:
          root: alert.asmremediationpathrule
          accessor: rule_name
          transformers:
          - operator: concat
            args:
              prefix:
                value:
                  simple: 'Alert status set to ''Resolved'' by Active Response Module - Remediation Path Rule: '
              suffix: {}
      closeReason:
        simple: Resolved
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -470,
          "y": 4650
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "114":
    id: "114"
    taskid: 26b53ec3-9c6f-458c-842a-f5dba64d8860
    type: regular
    task:
      id: 26b53ec3-9c6f-458c-842a-f5dba64d8860
      version: -1
      name: Close alert (remediated automatically) with rule match
      description: Close the current alert because Automated Remediation path was selected.
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      closeNotes:
        complex:
          root: alert.asmremediationpathrule
          accessor: rule_name
          transformers:
          - operator: concat
            args:
              prefix:
                value:
                  simple: 'Alert status set to ''Resolved - Remediated Automatically'' by Active Response Module - Remediation Path Rule: '
              suffix: {}
      closeReason:
        simple: Resolved - Remediated Automatically
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 660,
          "y": 4660
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "120":
    id: "120"
    taskid: 8fd1bd06-2670-43fe-86bf-cf71535283a6
    type: playbook
    task:
      id: 8fd1bd06-2670-43fe-86bf-cf71535283a6
      version: -1
      name: Cortex ASM - Remediation Path Rules
      playbookName: Cortex ASM - Remediation Path Rules
      type: playbook
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "145"
    scriptarguments:
      BypassDevCheck:
        complex:
          root: inputs.BypassDevCheck
      ExternallyDetectedProviders:
        complex:
          root: ASM.ExternalService
          accessor: externally_detected_providers
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 70,
          "y": 470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "121":
    id: "121"
    taskid: ee1fdd81-7b24-41fb-8afe-5b7414253e9e
    type: title
    task:
      id: ee1fdd81-7b24-41fb-8afe-5b7414253e9e
      version: -1
      name: Analysis Stage
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "123"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": -335
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "123":
    id: "123"
    taskid: c541f3bb-b503-47a4-8819-f92118911588
    type: regular
    task:
      id: c541f3bb-b503-47a4-8819-f92118911588
      version: -1
      name: GenerateSummaryReport - Analysis
      description: Generate an ASM Alert Summary report.
      scriptName: GenerateASMReport
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "126"
    scriptarguments:
      alert_details:
        complex:
          root: alert
          accessor: details
      alert_id:
        complex:
          root: alert
          accessor: id
      alert_name:
        complex:
          root: alert
          accessor: name
      alert_severityStr:
        complex:
          root: alert
          accessor: severityStr
      asm_asset_id:
        complex:
          root: alert
          accessor: asmassetid
      asm_cloud:
        complex:
          root: alert
          accessor: asmcloud
      asm_data_collection:
        complex:
          root: alert
          accessor: asmdatacollection
      asm_notification:
        complex:
          root: alert
          accessor: asmnotification
      asm_private_ip:
        complex:
          root: alert
          accessor: asmprivateip
      asm_related:
        complex:
          root: alert
          accessor: asmrelated
      asm_remediation:
        complex:
          root: alert
          accessor: asmremediation
      asm_remediation_path_rule:
        complex:
          root: alert
          accessor: asmremediationpathrule
      asm_service_detection:
        complex:
          root: alert
          accessor: asmservicedetection
      asm_service_id:
        complex:
          root: alert
          accessor: asmserviceid
      asm_service_owner:
        complex:
          root: alert
          accessor: asmserviceowner
      asm_system_ids:
        complex:
          root: alert
          accessor: asmsystemids
      asm_tags:
        complex:
          root: alert
          accessor: asmtags
      report_type:
        simple: analysis
      retry-count:
        simple: "1"
      retry-interval:
        simple: "30"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": -200
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "124":
    id: "124"
    taskid: c44f7015-582f-461c-8a5d-52e5748adbfa
    type: regular
    task:
      id: c44f7015-582f-461c-8a5d-52e5748adbfa
      version: -1
      name: Set playbook stage grid field (triage)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: triage
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": -960
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "125":
    id: "125"
    taskid: 17079024-16ff-45ac-813a-f89e32f4cd6b
    type: regular
    task:
      id: 17079024-16ff-45ac-813a-f89e32f4cd6b
      version: -1
      name: Set playbook stage grid field (enrichment)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "121"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: enrichment
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": -495
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "126":
    id: "126"
    taskid: ac937d90-ae1a-41e3-8aa4-69a469a5960d
    type: regular
    task:
      id: ac937d90-ae1a-41e3-8aa4-69a469a5960d
      version: -1
      name: Set playbook stage grid field (analysis)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "144"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: analysis
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": -40
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "128":
    id: "128"
    taskid: fd248ad8-bee5-428e-8918-042e8b3865c8
    type: regular
    task:
      id: fd248ad8-bee5-428e-8918-042e8b3865c8
      version: -1
      name: Set playbook stage grid field (decision)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "63"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: decision
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -270,
          "y": 1180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "129":
    id: "129"
    taskid: c92d3355-efa6-4968-8ae0-895cf615fc8a
    type: regular
    task:
      id: c92d3355-efa6-4968-8ae0-895cf615fc8a
      version: -1
      name: Set playbook stage grid field (decision)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: decision
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -700,
          "y": 1120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "130":
    id: "130"
    taskid: d7e54556-33f6-40d2-85c3-9497e480c8cd
    type: regular
    task:
      id: d7e54556-33f6-40d2-85c3-9497e480c8cd
      version: -1
      name: Set playbook stage grid field (decision)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: decision
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 800,
          "y": 1105
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "131":
    id: "131"
    taskid: 82f16b4f-24ef-42e1-8e88-81ee4fbc9d56
    type: regular
    task:
      id: 82f16b4f-24ef-42e1-8e88-81ee4fbc9d56
      version: -1
      name: Set playbook stage grid field (decision)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "60"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: decision
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1220,
          "y": 1025
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "133":
    id: "133"
    taskid: 2083b835-6639-4b1b-8fc9-8c3e6f13dd0e
    type: regular
    task:
      id: 2083b835-6639-4b1b-8fc9-8c3e6f13dd0e
      version: -1
      name: Set playbook stage grid field (remediation)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "72"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: remediation
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 2400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "134":
    id: "134"
    taskid: c1736708-3f44-4393-84f0-5e0b37f6f06a
    type: regular
    task:
      id: c1736708-3f44-4393-84f0-5e0b37f6f06a
      version: -1
      name: Set playbook stage grid field (notification)
      description: |-
        Automation used to more easily populate a grid field.  This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "50"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: notification
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 800,
          "y": 1965
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "135":
    id: "135"
    taskid: 604aa082-f2a8-420b-88e1-5395e1beaf6a
    type: regular
    task:
      id: 604aa082-f2a8-420b-88e1-5395e1beaf6a
      version: -1
      name: Set playbook stage grid field (validation)
      description: |-
        Automation used to more easily populate a grid field.  This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: validation
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 3700
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "136":
    id: "136"
    taskid: 3bc9dee8-0dd0-44d1-87cd-45ece79a6914
    type: regular
    task:
      id: 3bc9dee8-0dd0-44d1-87cd-45ece79a6914
      version: -1
      name: Set playbook stage grid field (summarization)
      description: |-
        Automation used to more easily populate a grid field.  This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "81"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: 'summarization'
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 4140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "138":
    id: "138"
    taskid: 5acd28f5-924d-4b69-8282-38d0acab0cf9
    type: regular
    task:
      id: 5acd28f5-924d-4b69-8282-38d0acab0cf9
      version: -1
      name: Initialize playbook stage grid field
      description: Initialize "ASM - Playbook Stage" to blank in case the playbook is re-run.
      script: Builtin|||setAlert
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "124"
    scriptarguments:
      asmplaybookstage:
        simple: '[]'
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -170,
          "y": -1130
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "141":
    id: "141"
    taskid: 41281e23-7c21-4956-83e4-c554c017ebde
    type: title
    task:
      id: 41281e23-7c21-4956-83e4-c554c017ebde
      version: -1
      name: continue
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "142"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -1110,
          "y": 995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "142":
    id: "142"
    taskid: 914ba991-8dd5-4b24-873b-80f0c20d6001
    type: regular
    task:
      id: 914ba991-8dd5-4b24-873b-80f0c20d6001
      version: -1
      name: Close alert (accepted risk)
      description: Close the current alert because the service is no longer observed.
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      closeNotes:
        simple: Alert status set to 'Resolved - Risk Accepted' by Active Response Module
      closeReason:
        simple: Resolved - Risk Accepted
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -920,
          "y": 4650
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "144":
    id: "144"
    taskid: 722a8da8-13d4-438f-83c5-90fabc6c14a8
    type: condition
    task:
      id: 722a8da8-13d4-438f-83c5-90fabc6c14a8
      version: -1
      name: Are there any matches from accepted risk lists?
      description: Checks if the system IDs, folders, and projects are present in the accepted risk lists.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "8"
      "yes":
      - "141"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: inList
          left:
            value:
              complex:
                root: alert.asmsystemids
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: alert.asmsystemids.Type
                      iscontext: true
                    right:
                      value:
                        simple: AWS-EC2
                  - operator: isEqualString
                    left:
                      value:
                        simple: alert.asmsystemids.Type
                      iscontext: true
                    right:
                      value:
                        simple: GCP-VM
                  - operator: isEqualString
                    left:
                      value:
                        simple: alert.asmsystemids.Type
                      iscontext: true
                    right:
                      value:
                        simple: Azure-Compute-ID
                accessor: ID
            iscontext: true
          right:
            value:
              complex:
                root: inputs.AcceptedRiskDs
            iscontext: true
        - operator: inList
          left:
            value:
              complex:
                root: alert.asmsystemids
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: alert.asmsystemids.Type
                      iscontext: true
                    right:
                      value:
                        simple: GCP-Project-Number
                accessor: ID
            iscontext: true
          right:
            value:
              complex:
                root: inputs.AcceptedRiskProjects
            iscontext: true
        - operator: inList
          left:
            value:
              complex:
                root: alert.asmcloud
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: alert.asmcloud.Provider
                      iscontext: true
                    right:
                      value:
                        simple: AWS
                accessor: Project
            iscontext: true
          right:
            value:
              complex:
                root: inputs.AcceptedRiskProjects
            iscontext: true
        - operator: inList
          left:
            value:
              complex:
                root: alert.asmsystemids
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: alert.asmsystemids.Type
                      iscontext: true
                    right:
                      value:
                        simple: GCP-Folder-Number
                accessor: ID
            iscontext: true
          right:
            value:
              complex:
                root: inputs.AcceptedRiskOther
            iscontext: true
        - operator: inList
          left:
            value:
              complex:
                root: alert.asmcloud
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: alert.asmcloud.Provider
                      iscontext: true
                    right:
                      value:
                        simple: Azure
                accessor: Organization
            iscontext: true
          right:
            value:
              complex:
                root: inputs.AcceptedRiskOther
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "145":
    id: "145"
    taskid: 7a7c9bc9-3aef-47cf-8d50-e5486ae69d37
    type: condition
    task:
      id: 7a7c9bc9-3aef-47cf-8d50-e5486ae69d37
      version: -1
      name: What is the remediation action?
      description: Determines what the remediation action is (direct action or data collection task).
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "48"
      Automated Remediation:
      - "146"
      Manual Remediation:
      - "152"
      Notification Email:
      - "163"
      ServiceNow Ticket:
      - "162"
      Jira Ticket:
      - "161"
    separatecontext: false
    conditions:
    - label: Automated Remediation
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: RemediationAction
            iscontext: true
          right:
            value:
              simple: AR
    - label: ServiceNow Ticket
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: RemediationAction
            iscontext: true
          right:
            value:
              simple: SNOW
    - label: Notification Email
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: RemediationAction
            iscontext: true
          right:
            value:
              simple: Email
    - label: Manual Remediation
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: RemediationAction
            iscontext: true
          right:
            value:
              simple: Manual
    - label: Jira Ticket
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: RemediationAction
            iscontext: true
          right:
            value:
              simple: Jira
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 70,
          "y": 660
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "146":
    id: "146"
    taskid: 1fbf8aec-f49d-4e1f-8bf2-9f5d2d289ed6
    type: title
    task:
      id: 1fbf8aec-f49d-4e1f-8bf2-9f5d2d289ed6
      version: -1
      name: Automated Remediation
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "129"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -700,
          "y": 995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "152":
    id: "152"
    taskid: c80945cf-8455-4f58-878d-c134f8e308ce
    type: title
    task:
      id: c80945cf-8455-4f58-878d-c134f8e308ce
      version: -1
      name: Manual Remediation
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "128"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -270,
          "y": 1050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "154":
    id: "154"
    taskid: e85a39ea-488e-4de4-8cfd-3416d2fb7ba8
    type: playbook
    task:
      id: e85a39ea-488e-4de4-8cfd-3416d2fb7ba8
      version: -1
      name: Cortex ASM - Jira Notification
      type: playbook
      iscommand: false
      brand: ""
      description: 'This playbook is used to direct Jira tickets to service owners to notify them of their internet exposures.'
      playbookName: Cortex ASM - Jira Notification
    nexttasks:
      '#none#':
      - "134"
    separatecontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 370,
          "y": 1760
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    scriptarguments:
      JiraProjectKey:
        complex:
          root: inputs.JiraProjectKey
      OwnerNotificationBody:
        complex:
          root: inputs.OwnerNotificationBody
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
  "156":
    id: "156"
    taskid: e2f4953f-b247-443a-8fa4-f2fbc31585ec
    type: title
    task:
      id: e2f4953f-b247-443a-8fa4-f2fbc31585ec
      version: -1
      name: Notification Stage
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "154"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 370,
          "y": 1630
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "157":
    id: "157"
    taskid: 6bb61627-14d9-4aae-8562-43786e4408b3
    type: regular
    task:
      id: 6bb61627-14d9-4aae-8562-43786e4408b3
      version: -1
      name: Set playbook stage grid field (decision)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "156"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: decision
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 370,
          "y": 1175
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "158":
    id: "158"
    taskid: 2f89be33-0e0f-4989-8328-d783ee1fdd08
    type: playbook
    task:
      id: 2f89be33-0e0f-4989-8328-d783ee1fdd08
      version: -1
      name: Cortex ASM - ServiceNow Notification
      description: This playbook is used to direct ServiceNow tickets to service owners to notify them of their internet exposures.
      playbookName: Cortex ASM - ServiceNow Notification
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "134"
    scriptarguments:
      OwnerNotificationBody:
        complex:
          root: inputs.OwnerNotificationBody
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 800,
          "y": 1700
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "159":
    id: "159"
    taskid: 57a99cce-e18a-433c-83a1-7f109d34cdb6
    type: playbook
    task:
      id: 57a99cce-e18a-433c-83a1-7f109d34cdb6
      version: -1
      name: Cortex ASM - Email Notification
      description: This playbook is used to send email notifications to service owners to notify them of their internet exposures.
      playbookName: Cortex ASM - Email Notification
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "134"
    scriptarguments:
      OwnerNotificationBody:
        complex:
          root: inputs.OwnerNotificationBody
      OwnerNotificationSubject:
        complex:
          root: inputs.OwnerNotificationSubject
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 1220,
          "y": 1635
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "161":
    id: "161"
    taskid: 1e7969a9-ad77-4cb5-801b-a406404deb9d
    type: title
    task:
      id: 1e7969a9-ad77-4cb5-801b-a406404deb9d
      version: -1
      name: Jira Ticket
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "157"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 370,
          "y": 1040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "162":
    id: "162"
    taskid: 1802ff08-bf0e-4515-8814-bd12689c9c6a
    type: title
    task:
      id: 1802ff08-bf0e-4515-8814-bd12689c9c6a
      version: -1
      name: ServiceNow Ticket
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "130"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 800,
          "y": 970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "163":
    id: "163"
    taskid: 41899f27-9544-47e9-8cd5-76be614ee08f
    type: title
    task:
      id: 41899f27-9544-47e9-8cd5-76be614ee08f
      version: -1
      name: Email Notification
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "131"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1220,
          "y": 890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "164":
    id: "164"
    taskid: 8ffa4256-168f-40ab-8854-5bdebd63711f
    type: regular
    task:
      id: 8ffa4256-168f-40ab-8854-5bdebd63711f
      version: -1
      name: Set remediation grid field
      description: |-
        Automation used to more easily populate a grid field.  This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "168"
    scriptarguments:
      gridfield:
        simple: asmremediation
      keys:
        simple: Action,ActionTimestamp,Outcome,OutcomeTimestamp
      val1:
        simple: close service port from internet
      val2:
        simple: TIMESTAMP
      val3:
        simple: Success
      val4:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -690,
          "y": 1860
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "165":
    id: "165"
    taskid: 051f0d38-ddb5-4f35-8163-25bcebacaa02
    type: condition
    task:
      id: 051f0d38-ddb5-4f35-8163-25bcebacaa02
      version: -1
      name: Are there service owners with emails?
      description: Verifies if we have emails for service owners.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "11"
      "yes":
      - "166"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: alert.asmserviceowner
                filters:
                - - operator: containsGeneral
                    left:
                      value:
                        simple: alert.asmserviceowner.Email
                      iscontext: true
                    right:
                      value:
                        simple: '@'
                accessor: Email
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -690,
          "y": 2210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "166":
    id: "166"
    taskid: ad01d4fe-6640-4a75-8132-6b7baa51cb97
    type: regular
    task:
      id: ad01d4fe-6640-4a75-8132-6b7baa51cb97
      version: -1
      name: Send remediation notification email to service owners
      description: Send an email to service owners regarding the status of the automated remediation action that was taken.
      script: '|||send-mail'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "169"
    scriptarguments:
      htmlBody:
        complex:
          root: inputs.RemediationNotificationHTMLBody
      subject:
        complex:
          root: inputs.RemediationNotificationSubject
      to:
        complex:
          root: alert.asmserviceowner
          filters:
          - - operator: containsGeneral
              left:
                value:
                  simple: alert.asmserviceowner.Email
                iscontext: true
              right:
                value:
                  simple: '@'
          accessor: Email
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -810,
          "y": 2440
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "167":
    id: "167"
    taskid: b4bfa598-714a-4b47-8b0e-1a3e86a75a46
    type: playbook
    task:
      id: b4bfa598-714a-4b47-8b0e-1a3e86a75a46
      version: -1
      name: Cortex ASM - Remediation
      description: This playbook contains all the cloud provider sub-playbooks for remediation.
      playbookName: Cortex ASM - Remediation
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "164"
    separatecontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -690,
          "y": 1685
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "168":
    id: "168"
    taskid: 13e46c53-cb29-49c8-8280-9b7558ac7139
    type: regular
    task:
      id: 13e46c53-cb29-49c8-8280-9b7558ac7139
      version: -1
      name: Set playbook stage grid field (remediation)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "165"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: remediation
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -690,
          "y": 2040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "169":
    id: "169"
    taskid: 57e40a4b-eeba-4618-8bac-298e0a56c081
    type: regular
    task:
      id: 57e40a4b-eeba-4618-8bac-298e0a56c081
      version: -1
      name: Set playbook stage grid field (notification)
      description: |-
        Automation used to more easily populate a grid field.  This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      scriptName: GridFieldSetup
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: notification
      val2:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -810,
          "y": 2600
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "170":
    id: "170"
    taskid: 42b020e8-d860-4fb5-8af5-b978c79f909a
    type: regular
    task:
      id: 42b020e8-d860-4fb5-8af5-b978c79f909a
      version: -1
      name: Initialize remediation objectives grid field
      description: Initialize "ASM - Remediation Objectives" to defaults in case playbook is re-run.
      script: Builtin|||setAlert
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "124"
    scriptarguments:
      asmremediationobjectives:
        simple: '[{"option": "File a ServiceNow Ticket", "statement": "In this case, a ServiceNow ticket will be created with some information on the alert and possible remediation guidance suggestions."},{"option": "File a Jira Ticket", "statement": "In this case, a Jira ticket will be created with some information on the alert and possible remediation guidance suggestions."},{"option": "Send a notification email", "statement": "In this case, an email ticket will be created with some information on the alert and possible remediation guidance suggestions."},{"option": "Manual remediation", "statement": "In this case, we will require you to manually remediate this exposure."}]'
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 310,
          "y": -1130
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "110_111_Close Now": 0.88,
      "110_112_ Automated-Remediation": 0.88,
      "145_152_Manual Remediation": 0.68,
      "145_161_Jira Ticket": 0.87,
      "145_163_Notification Email": 0.74,
      "20_135_no": 0.53,
      "48_10_ServiceNow ticket": 0.82,
      "48_60_Notification email": 0.88,
      "48_63_Manual remediation": 0.52
    },
    "paper": {
      "dimensions": {
        "height": 6725,
        "width": 2710,
        "x": -1110,
        "y": -1400
      }
    }
  }
inputs:
- key: OwnerNotificationSubject
  value:
    simple: "A new security risk was identified on an external service owned by your team"
  required: true
  description: "Subject of the notification (email or ticket) sent to potential service owner."
  playbookInputQuery:
- key: OwnerNotificationBody
  value:
    simple: |+
      Infosec identified a security risk on an external service potentially owned by your team: ${alert.name}<br><br>

      Description: ${alert.details}
      <br><br>

  required: true
  description: Body of the notification (email or ticket) sent to potential service owner.
  playbookInputQuery:
- key: RemediationNotificationSubject
  value:
    simple: |-
      A new security risk was addressed on an external service owned by your team
  required: true
  description: Subject of the notification (email or ticket) sent to the service owner after remediation.
  playbookInputQuery:
- key: RemediationNotificationHTMLBody
  value:
    simple: |-
      <!DOCTYPE html>
      <html lang="en">
      <body>
          <p>
              Infosec identified a security risk on an external service potentially owned by your
              team:<br><b>${alert.name}</b>
          </p>
          <p>
              <b>Alert Details:</b> ${alert.details}<br>
              <b>Action Taken:</b> ${alert.asmremediation.[0].Action}<br>
              <b>Action Outcome:</b> ${alert.asmremediation.[0].Outcome}<br>
          </p>
      </body>
      </html>
  required: true
  description: 'Body of the notification (email or ticket) sent to the service owner after remediation.'
  playbookInputQuery:
- key: BypassDevCheck
  value:
    simple: "False"
  required: false
  description: |-
    Determine whether to bypass the Dev Check in automated remediation criteria: https://docs-cortex.paloaltonetworks.com/r/Cortex-XPANSE/Cortex-Xpanse-Expander-User-Guide/Automated-Remediation-Capabilities-Matrix

    Set to "True" if you want to bypass.  Default is "False".
  playbookInputQuery:
- key: AcceptedRiskDs
  value: {}
  required: false
  description: Comma separated list of instance/VM IDs that are considered accepted risk and that should be closed.
  playbookInputQuery:
- key: AcceptedRiskProjects
  value: {}
  required: false
  description: Comma separated list of projects numbers that are considered accepted risk and that should be closed.  For example, the could be list of GCP projects and AWS accounts.
  playbookInputQuery:
- key: AcceptedRiskOther
  value: {}
  required: false
  description: Comma separated list of other items that are considered accepted risk and that should be closed. For example, the could be list of folders numbers in GCP and subscription IDs in Azure.
  playbookInputQuery:
- key: JiraProjectKey
  value:
    simple: XPANSE
  required: true
  description: The Jira project key to associate with the issue.
  playbookInputQuery:
outputs: []
tests:
- No tests (auto formatted)
fromversion: 6.9.0
contentitemexportablefields:
  contentitemfields: {}
