category: Utilities
commonfields:
  id: Cortex Attack Surface Management
  version: -1
configuration:
- defaultvalue: "false"
  display: Use system proxy
  name: proxy
  required: false
  type: 8
- defaultvalue: "false"
  display: Trust any certificate
  name: insecure
  required: false
  type: 8
description: Integration to pull asset and other ASM related information
display: Cortex Attack Surface Management
name: Cortex Attack Surface Management
script:
  commands:
  - arguments:
    - description: IP Address to search on
      name: ip_address
    - description: Domain to search on
      name: domain
    - auto: PREDEFINED
      description: is the service active or not
      name: is_active
      predefined:
      - "yes"
      - "no"
    - auto: PREDEFINED
      description: how service was discovered
      name: discovery_type
      predefined:
      - colocated_on_ip
      - directly_discovery
      - unknown
    description: Get a list of all your external services filtered by business units, externally detected providers, domain, externally inferred CVEs, acve classificaons, inacve classificaons, service name, service type, protocol, IP address, is acve, and discovery type. Maximum result limit is 100 assets.
    name: asm-getexternalservices
    outputs:
    - contextPath: ASM.GetExternalServices.service_id
      description: External service UUID
      type: String
    - contextPath: ASM.GetExternalServices.service_name
      description: Name of the external service
      type: String
    - contextPath: ASM.GetExternalServices.service_type
      description: Type of external service
      type: String
    - contextPath: ASM.GetExternalServices.ip_address
      description: IP address of external service
      type: String
    - contextPath: ASM.GetExternalServices.externally_detected_providers
      description: Providers of external service
      type: String
    - contextPath: ASM.GetExternalServices.is_active
      description: Is external service active or not
      type: String
    - contextPath: ASM.GetExternalServices.first_observed
      description: Date of first observation of external service
      type: Date
    - contextPath: ASM.GetExternalServices.last_observed
      description: Date of last observation of external service
      type: Date
    - contextPath: ASM.GetExternalServices.port
      description: Port number of external service
      type: Number
    - contextPath: ASM.GetExternalServices.protocol
      description: Protocol number of external service
      type: String
    - contextPath: ASM.GetExternalServices.inactive_classifications
      description: External service classifications that are no longer active
      type: String
    - contextPath: ASM.GetExternalServices.discovery_type
      description: How external service was discovered
      type: String
    - contextPath: ASM.GetExternalServices.business_units
      description: External service associated business units
      type: String
    - contextPath: ASM.GetExternalServices.externally_inferred_vulnerability_score
      description: External service vulnerability score
      type: Unknown
  - arguments:
    - description: An string represenng the service ID you want get details for.
      name: service_id
      required: true
    description: Get service details according to the service ID.
    name: asm-getexternalservice
    outputs:
    - contextPath: ASM.GetExternalService.service_id
      description: External service UUID
      type: String
    - contextPath: ASM.GetExternalService.service_name
      description: Name of the external service
      type: String
    - contextPath: ASM.GetExternalService.service_type
      description: Type of external service
      type: String
    - contextPath: ASM.GetExternalService.ip_address
      description: IP address of external service
      type: String
    - contextPath: ASM.GetExternalService.externally_detected_providers
      description: Providers of external service
      type: String
    - contextPath: ASM.GetExternalService.is_active
      description: Is external service active or not
      type: String
    - contextPath: ASM.GetExternalService.first_observed
      description: Date of first observation of external service
      type: Date
    - contextPath: ASM.GetExternalService.last_observed
      description: Date of last observation of external service
      type: Date
    - contextPath: ASM.GetExternalService.port
      description: Port number of external service
      type: Number
    - contextPath: ASM.GetExternalService.protocol
      description: Protocol of external service
      type: String
    - contextPath: ASM.GetExternalService.inactive_classifications
      description: External service classifications that are no longer active
      type: String
    - contextPath: ASM.GetExternalService.discovery_type
      description: How external service was discovered
      type: String
    - contextPath: ASM.GetExternalService.business_units
      description: External service associated business units
      type: String
    - contextPath: ASM.GetExternalService.externally_inferred_vulnerability_score
      description: External service vulnerability score
      type: Unknown
    - contextPath: ASM.GetExternalService.details
      description: Additional details
      type: String
  - arguments: []
    description: Get a list of all your Internet exposure filtered by business units and organization handles. Maximum result limit is 100 ranges.
    name: asm-getexternalipaddressranges
    outputs:
    - contextPath: ASM.GetExternalIpAddressRanges.range_id
      description: External IP address range UUID
      type: String
    - contextPath: ASM.GetExternalIpAddressRanges.first_ip
      description: First IP address of external IP address range
      type: String
    - contextPath: ASM.GetExternalIpAddressRanges.last_ip
      description: Last IP address of external IP address range
      type: String
    - contextPath: ASM.GetExternalIpAddressRanges.ips_count
      description: Number of IP addresses of external IP address range
      type: Number
    - contextPath: ASM.GetExternalIpAddressRanges.active_responsive_ips_count
      description: How many IPs in external address range are actively responsive
      type: Number
    - contextPath: ASM.GetExternalIpAddressRanges.date_added
      description: Date the external IP address range was added
      type: Date
    - contextPath: ASM.GetExternalIpAddressRanges.business_units
      description: External IP address range associated business units
      type: String
    - contextPath: ASM.GetExternalIpAddressRanges.organization_handles
      description: External IP address range associated organization handles
      type: String
  - arguments:
    - description: An string representing the range ID for which you want to get the details for.
      name: range_id
      required: true
    description: Get external IP address range details according to the range IDs.
    name: asm-getexternalipaddressrange
    outputs:
    - contextPath: ASM.GetExternalIpAddressRange.range_id
      description: External IP address range UUID
      type: String
    - contextPath: ASM.GetExternalIpAddressRange.first_ip
      description: First IP address of external IP address range
      type: String
    - contextPath: ASM.GetExternalIpAddressRange.last_ip
      description: Last IP address of external IP address range
      type: String
    - contextPath: ASM.GetExternalIpAddressRange.ips_count
      description: Number of IP addresses of external IP address range
      type: Number
    - contextPath: ASM.GetExternalIpAddressRange.active_responsive_ips_count
      description: How many IPs in external address range are actively responsive
      type: Number
    - contextPath: ASM.GetExternalIpAddressRange.date_added
      description: Date the external IP address range was added
      type: Date
    - contextPath: ASM.GetExternalIpAddressRange.business_units
      description: External IP address range associated business units
      type: String
    - contextPath: ASM.GetExternalIpAddressRange.organization_handles
      description: External IP address range associated organization handles
      type: String
    - contextPath: ASM.GetExternalIpAddressRange.details
      description: Additional information
      type: String
  - arguments: []
    description: CHANGEME
    name: asm-getassetsinternetexposure
    outputs:
    - contextPath: ASM.GetAssetsInternetExposure.total_count
      description: ""
      type: Number
    - contextPath: ASM.GetAssetsInternetExposure.result_count
      description: ""
      type: Number
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.asm_ids
      description: ""
      type: String
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.name
      description: ""
      type: String
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.asset_type
      description: ""
      type: String
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.cloud_provider
      description: ""
      type: Unknown
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.region
      description: ""
      type: Unknown
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.business_units
      description: ""
      type: String
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.iot_model
      description: ""
      type: Unknown
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.iot_category
      description: ""
      type: Unknown
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.iot_profile
      description: ""
      type: Unknown
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.sensor
      description: ""
      type: String
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.last_observed
      description: ""
      type: Unknown
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.first_observed
      description: ""
      type: Unknown
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.has_active_externally_services
      description: ""
      type: Boolean
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.has_xdr_agent
      description: ""
      type: String
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.certificate_classifications
      description: ""
      type: String
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.certificate_issuer
      description: ""
      type: String
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.certificate_algorithm
      description: ""
      type: String
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.cloud_id
      description: ""
      type: Unknown
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.domain_resolves
      description: ""
      type: Boolean
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.operation_system
      description: ""
      type: Unknown
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.asm_va_score
      description: ""
      type: Unknown
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.agent_id
      description: ""
      type: Unknown
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.externally_detected_providers
      description: ""
      type: String
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.service_type
      description: ""
      type: String
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.externally_inferred_cves
      description: ""
      type: String
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.ips
      description: ""
      type: String
  - arguments:
    - description: An string representing the asset ID for which you want to get the details for
      name: asm_id
      required: true
    description: Get Internet exposure asset details according to the asset ID.
    name: asm-getassetinternetexposure
    outputs:
    - contextPath: ASM.GetAssetInternetExposure.asm_ids
      description: Attack surface managment UUID
      type: String
    - contextPath: ASM.GetAssetInternetExposure.name
      description: Name of the exposed asset
      type: String
    - contextPath: ASM.GetAssetInternetExposure.type
      description: Type of the exposed asset
      type: String
    - contextPath: ASM.GetAssetInternetExposure.last_observed
      description: Last time exposure was observed
      type: Unknown
    - contextPath: ASM.GetAssetInternetExposure.first_observed
      description: First time exposure was observed
      type: Unknown
    - contextPath: ASM.GetAssetInternetExposure.created
      description: Date the ASM Issue was created
      type: Date
    - contextPath: ASM.GetAssetInternetExposure.business_units
      description: Asset associated business units
      type: String
    - contextPath: ASM.GetAssetInternetExposure.domain
      description: Asset associated domain
      type: Unknown
    - contextPath: ASM.GetAssetInternetExposure.certificate_issuer
      description: Asset certificate issuer
      type: String
    - contextPath: ASM.GetAssetInternetExposure.certificate_algorithm
      description: Asset certificate algorithm
      type: String
    - contextPath: ASM.GetAssetInternetExposure.certificate_classifications
      description: Asset certificate classifications
      type: String
    - contextPath: ASM.GetAssetInternetExposure.resolves
      description: Does the asset have DNS resolution
      type: Boolean
    - contextPath: ASM.GetAssetInternetExposure.details
      description: Additional details
      type: Unknown
    - contextPath: ASM.GetAssetInternetExposure.externally_inferred_vulnerability_score
      description: Asset vulnerability score
      type: Unknown
  dockerimage: demisto/python3:3.10.5.33323
  runonce: false
  script: ''
  subtype: python3
  type: python
