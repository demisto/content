category: Utilities
commonfields:
  id: Cortex Attack Surface Management
  version: -1
configuration:
- defaultvalue: "false"
  display: Use system proxy
  name: proxy
  required: false
  type: 8
- defaultvalue: "false"
  display: Trust any certificate
  name: insecure
  required: false
  type: 8
description: Integration to pull asset and other ASM related information
display: Cortex Attack Surface Management
name: Cortex Attack Surface Management
script:
  commands:
  - arguments:
    - name: field
    - name: operator
    - name: value
    description: |-
      Create or update incident according to JSON structure.
      To update incident custom fields you should lowercase them and remove all spaces. For example: Scan IP -> scanip
      To get the actual key name you can also go to Cortex XSOAR CLI and run /incident_add and look for the key that you would like to update

      Use the 'createInvestigation\: True' to start the investigation process automatically. (by running a playbook based on incident type.)
    name: asm-getexternalservices
    outputs:
    - contextPath: ASM.GetExternalServices.total_count
      description: ""
      type: Number
    - contextPath: ASM.GetExternalServices.result_count
      description: ""
      type: Number
    - contextPath: ASM.GetExternalServices.external_services.service_id
      description: ""
      type: String
    - contextPath: ASM.GetExternalServices.external_services.service_name
      description: ""
      type: String
    - contextPath: ASM.GetExternalServices.external_services.service_type
      description: ""
      type: String
    - contextPath: ASM.GetExternalServices.external_services.ip_address
      description: ""
      type: String
    - contextPath: ASM.GetExternalServices.external_services.externally_detected_providers
      description: ""
      type: String
    - contextPath: ASM.GetExternalServices.external_services.is_active
      description: ""
      type: String
    - contextPath: ASM.GetExternalServices.external_services.first_observed
      description: ""
      type: Date
    - contextPath: ASM.GetExternalServices.external_services.last_observed
      description: ""
      type: Date
    - contextPath: ASM.GetExternalServices.external_services.port
      description: ""
      type: Number
    - contextPath: ASM.GetExternalServices.external_services.protocol
      description: ""
      type: String
    - contextPath: ASM.GetExternalServices.external_services.inactive_classifications
      description: ""
      type: String
    - contextPath: ASM.GetExternalServices.external_services.discovery_type
      description: ""
      type: String
    - contextPath: ASM.GetExternalServices.external_services.business_units
      description: ""
      type: String
    - contextPath: ASM.GetExternalServices.external_services.externally_inferred_vulnerability_score
      description: ""
      type: Unknown
  - arguments:
    - description: An string represenî€€ng the service ID you want get details for.
      name: service_id
      required: true
    description: |-
      Get service details according to the service ID.
    name: asm-getexternalservice
    outputs:
    - contextPath: ASM.GetExternalService.service_id
      description: "External service UUID"
      type: String
    - contextPath: ASM.GetExternalService.service_name
      description: "Name of the external service"
      type: String
    - contextPath: ASM.GetExternalService.service_type
      description: "Type of external service"
      type: String
    - contextPath: ASM.GetExternalService.ip_address
      description: "Ip address of external service"
      type: String
    - contextPath: ASM.GetExternalService.externally_detected_providers
      description: "Providers of external service"
      type: String
    - contextPath: ASM.GetExternalService.is_active
      description: "Is external service active or not"
      type: String
    - contextPath: ASM.GetExternalService.first_observed
      description: "Date of first observation of external service"
      type: Date
    - contextPath: ASM.GetExternalService.last_observed
      description: "Date of last observation of external service"
      type: Date
    - contextPath: ASM.GetExternalService.port
      description: "Port number of external service"
      type: Number
    - contextPath: ASM.GetExternalService.protocol
      description: "Protocol of external service"
      type: String
    - contextPath: ASM.GetExternalService.inactive_classifications
      description: "External service classifications that are no longer active"
      type: String
    - contextPath: ASM.GetExternalService.discovery_type
      description: "How external service was discovered"
      type: String
    - contextPath: ASM.GetExternalService.business_units
      description: "External service associated business units"
      type: String
    - contextPath: ASM.GetExternalService.externally_inferred_vulnerability_score
      description: "External service vulnerability score"
      type: Unknown
    - contextPath: ASM.GetExternalService.details
      description: "Additional details"
      type: String
  - arguments: []
    description: |-
      Create or update incident according to JSON structure.
      To update incident custom fields you should lowercase them and remove all spaces. For example: Scan IP -> scanip
      To get the actual key name you can also go to Cortex XSOAR CLI and run /incident_add and look for the key that you would like to update

      Use the 'createInvestigation\: True' to start the investigation process automatically. (by running a playbook based on incident type.)
    name: asm-getexternalipaddressranges
    outputs:
    - contextPath: ASM.GetExternalIpAddressRanges.total_count
      description: ""
      type: Number
    - contextPath: ASM.GetExternalIpAddressRanges.result_count
      description: ""
      type: Number
    - contextPath: ASM.GetExternalIpAddressRanges.external_ip_address_ranges.range_id
      description: ""
      type: String
    - contextPath: ASM.GetExternalIpAddressRanges.external_ip_address_ranges.first_ip
      description: ""
      type: String
    - contextPath: ASM.GetExternalIpAddressRanges.external_ip_address_ranges.last_ip
      description: ""
      type: String
    - contextPath: ASM.GetExternalIpAddressRanges.external_ip_address_ranges.ips_count
      description: ""
      type: Number
    - contextPath: ASM.GetExternalIpAddressRanges.external_ip_address_ranges.active_responsive_ips_count
      description: ""
      type: Number
    - contextPath: ASM.GetExternalIpAddressRanges.external_ip_address_ranges.date_added
      description: ""
      type: Date
    - contextPath: ASM.GetExternalIpAddressRanges.external_ip_address_ranges.business_units
      description: ""
      type: String
    - contextPath: ASM.GetExternalIpAddressRanges.external_ip_address_ranges.organization_handles
      description: ""
      type: String
  - arguments:
    - description: An string representing the range ID for which you want to get the details for.
      name: range_id
      required: true
    description: Get external IP address range details according to the range IDs.
    name: asm-getexternalipaddressrange
    outputs:
    - contextPath: ASM.GetExternalIpAddressRange.range_id
      description: External IP address range UUID
      type: String
    - contextPath: ASM.GetExternalIpAddressRange.first_ip
      description: First IP address of external IP address range
      type: String
    - contextPath: ASM.GetExternalIpAddressRange.last_ip
      description: Last IP address of external IP address range
      type: String
    - contextPath: ASM.GetExternalIpAddressRange.ips_count
      description: Number of IP addresses of external IP address range
      type: Number
    - contextPath: ASM.GetExternalIpAddressRange.active_responsive_ips_count
      description: How many IPs in external address range and actively responsive
      type: Number
    - contextPath: ASM.GetExternalIpAddressRange.date_added
      description: Date the external IP address range was added
      type: Date
    - contextPath: ASM.GetExternalIpAddressRange.business_units
      description: External IP address range associated business units
      type: String
    - contextPath: ASM.GetExternalIpAddressRange.organization_handles
      description: External IP address range associated organization handles
      type: String
    - contextPath: ASM.GetExternalIpAddressRange.details
      description: Additional information
      type: String
  - arguments: []
    description: |-
      Create or update incident according to JSON structure.
      To update incident custom fields you should lowercase them and remove all spaces. For example: Scan IP -> scanip
      To get the actual key name you can also go to Cortex XSOAR CLI and run /incident_add and look for the key that you would like to update

      Use the 'createInvestigation\: True' to start the investigation process automatically. (by running a playbook based on incident type.)
    name: asm-getassetsinternetexposure
    outputs:
    - contextPath: ASM.GetAssetsInternetExposure.total_count
      description: ""
      type: Number
    - contextPath: ASM.GetAssetsInternetExposure.result_count
      description: ""
      type: Number
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.asm_ids
      description: ""
      type: String
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.name
      description: ""
      type: String
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.asset_type
      description: ""
      type: String
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.cloud_provider
      description: ""
      type: Unknown
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.region
      description: ""
      type: Unknown
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.business_units
      description: ""
      type: String
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.iot_model
      description: ""
      type: Unknown
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.iot_category
      description: ""
      type: Unknown
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.iot_profile
      description: ""
      type: Unknown
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.sensor
      description: ""
      type: String
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.last_observed
      description: ""
      type: Unknown
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.first_observed
      description: ""
      type: Unknown
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.has_active_externally_services
      description: ""
      type: Boolean
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.has_xdr_agent
      description: ""
      type: String
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.certificate_classifications
      description: ""
      type: String
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.certificate_issuer
      description: ""
      type: String
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.certificate_algorithm
      description: ""
      type: String
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.cloud_id
      description: ""
      type: Unknown
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.domain_resolves
      description: ""
      type: Boolean
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.operation_system
      description: ""
      type: Unknown
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.asm_va_score
      description: ""
      type: Unknown
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.agent_id
      description: ""
      type: Unknown
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.externally_detected_providers
      description: ""
      type: String
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.service_type
      description: ""
      type: String
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.externally_inferred_cves
      description: ""
      type: String
    - contextPath: ASM.GetAssetsInternetExposure.assets_internet_exposure.ips
      description: ""
      type: String
  - arguments:
    - description: An string representing the asset ID for which you want to get the details for
      name: asm_id
      required: true
    description: Get Internet exposure asset details according to the asset ID.
    name: asm-getassetinternetexposure
    outputs:
    - contextPath: ASM.GetAssetInternetExposure.asm_ids
      description: Attack surface managment UUID
      type: String
    - contextPath: ASM.GetAssetInternetExposure.name
      description: Name of the exposed asset
      type: String
    - contextPath: ASM.GetAssetInternetExposure.type
      description: Type of the exposed asset
      type: String
    - contextPath: ASM.GetAssetInternetExposure.last_observed
      description: Last time exposure was observed
      type: Unknown
    - contextPath: ASM.GetAssetInternetExposure.first_observed
      description: First time exposure was observed
      type: Unknown
    - contextPath: ASM.GetAssetInternetExposure.created
      description: Date the ASM Issue was created
      type: Date
    - contextPath: ASM.GetAssetInternetExposure.business_units
      description: Asset associated business units
      type: String
    - contextPath: ASM.GetAssetInternetExposure.domain
      description: Asset associated domain
      type: Unknown
    - contextPath: ASM.GetAssetInternetExposure.certificate_issuer
      description: Asset certificate issuer
      type: String
    - contextPath: ASM.GetAssetInternetExposure.certificate_algorithm
      description: Asset certificate algorithm
      type: String
    - contextPath: ASM.GetAssetInternetExposure.certificate_classifications
      description: Asset certificate classifications
      type: String
    - contextPath: ASM.GetAssetInternetExposure.resolves
      description: Does the asset have DNS resolution
      type: Boolean
    - contextPath: ASM.GetAssetInternetExposure.details
      description: Additional details
      type: Unknown
    - contextPath: ASM.GetAssetInternetExposure.externally_inferred_vulnerability_score
      description: Asset vulnerability score
      type: Unknown
  dockerimage: demisto/python3:3.10.5.33323
  runonce: false
  script: ''
  subtype: python3
  type: python
