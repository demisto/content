category: Utilities
commonfields:
  id: Cortex Attack Surface Management
  version: -1
configuration:
- additionalinfo: Should be the web UI with `api-` appended to front.
  display: Server URL (e.g., https://api-xsiam.paloaltonetworks.com)
  name: url
  required: true
  type: 0
- additionalinfo: reference https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-api/cortex-xdr-api-overview/get-started-with-cortex-xdr-apis
  display: API Key
  name: api_key
  required: false
  type: 4
- additionalinfo: reference https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-api/cortex-xdr-api-overview/get-started-with-cortex-xdr-apis
  display: API Key ID
  name: x-xdr-auth-id
  required: false
  type: 0
description: Integration to pull asset and other ASM related information
display: Cortex Attack Surface Management
name: Cortex Attack Surface Management
script:
  commands:
  - arguments:
    - description: IP Address to search on
      name: ip_address
    - description: Domain to search on
      name: domain
    - auto: PREDEFINED
      description: is the service active or not
      name: is_active
      predefined:
      - "yes"
      - "no"
    - auto: PREDEFINED
      description: how service was discovered
      name: discovery_type
      predefined:
      - colocated_on_ip
      - directly_discovery
      - unknown
    description: Get a list of all your external services filtered by business units, externally detected providers, domain, externally inferred CVEs, acve classificaons, inacve classificaons, service name, service type, protocol, IP address, is acve, and discovery type. Maximum result limit is 100 assets.
    name: asm-getexternalservices
    outputs:
    - contextPath: ASM.GetExternalServices.service_id
      description: External service UUID
      type: String
    - contextPath: ASM.GetExternalServices.service_name
      description: Name of the external service
      type: String
    - contextPath: ASM.GetExternalServices.service_type
      description: Type of external service
      type: String
    - contextPath: ASM.GetExternalServices.ip_address
      description: IP address of external service
      type: String
    - contextPath: ASM.GetExternalServices.externally_detected_providers
      description: Providers of external service
      type: String
    - contextPath: ASM.GetExternalServices.is_active
      description: Is external service active or not
      type: String
    - contextPath: ASM.GetExternalServices.first_observed
      description: Date of first observation of external service
      type: Date
    - contextPath: ASM.GetExternalServices.last_observed
      description: Date of last observation of external service
      type: Date
    - contextPath: ASM.GetExternalServices.port
      description: Port number of external service
      type: Number
    - contextPath: ASM.GetExternalServices.protocol
      description: Protocol number of external service
      type: String
    - contextPath: ASM.GetExternalServices.inactive_classifications
      description: External service classifications that are no longer active
      type: String
    - contextPath: ASM.GetExternalServices.discovery_type
      description: How external service was discovered
      type: String
    - contextPath: ASM.GetExternalServices.business_units
      description: External service associated business units
      type: String
    - contextPath: ASM.GetExternalServices.externally_inferred_vulnerability_score
      description: External service vulnerability score
      type: Unknown
  - arguments:
    - description: A string represenng the service ID you want get details for.
      name: service_id
      required: true
    description: Get service details according to the service ID.
    name: asm-getexternalservice
    outputs:
    - contextPath: ASM.GetExternalService.service_id
      description: External service UUID
      type: String
    - contextPath: ASM.GetExternalService.service_name
      description: Name of the external service
      type: String
    - contextPath: ASM.GetExternalService.service_type
      description: Type of external service
      type: String
    - contextPath: ASM.GetExternalService.ip_address
      description: IP address of external service
      type: String
    - contextPath: ASM.GetExternalService.externally_detected_providers
      description: Providers of external service
      type: String
    - contextPath: ASM.GetExternalService.is_active
      description: Is external service active or not
      type: String
    - contextPath: ASM.GetExternalService.first_observed
      description: Date of first observation of external service
      type: Date
    - contextPath: ASM.GetExternalService.last_observed
      description: Date of last observation of external service
      type: Date
    - contextPath: ASM.GetExternalService.port
      description: Port number of external service
      type: Number
    - contextPath: ASM.GetExternalService.protocol
      description: Protocol of external service
      type: String
    - contextPath: ASM.GetExternalService.inactive_classifications
      description: External service classifications that are no longer active
      type: String
    - contextPath: ASM.GetExternalService.discovery_type
      description: How external service was discovered
      type: String
    - contextPath: ASM.GetExternalService.business_units
      description: External service associated business units
      type: String
    - contextPath: ASM.GetExternalService.externally_inferred_vulnerability_score
      description: External service vulnerability score
      type: Unknown
    - contextPath: ASM.GetExternalService.details
      description: Additional details
      type: String
  - arguments: []
    description: Get a list of all your Internet exposure filtered by business units and organization handles. Maximum result limit is 100 ranges.
    name: asm-getexternalipaddressranges
    outputs:
    - contextPath: ASM.GetExternalIpAddressRanges.range_id
      description: External IP address range UUID
      type: String
    - contextPath: ASM.GetExternalIpAddressRanges.first_ip
      description: First IP address of external IP address range
      type: String
    - contextPath: ASM.GetExternalIpAddressRanges.last_ip
      description: Last IP address of external IP address range
      type: String
    - contextPath: ASM.GetExternalIpAddressRanges.ips_count
      description: Number of IP addresses of external IP address range
      type: Number
    - contextPath: ASM.GetExternalIpAddressRanges.active_responsive_ips_count
      description: How many IPs in external address range are actively responsive
      type: Number
    - contextPath: ASM.GetExternalIpAddressRanges.date_added
      description: Date the external IP address range was added
      type: Date
    - contextPath: ASM.GetExternalIpAddressRanges.business_units
      description: External IP address range associated business units
      type: String
    - contextPath: ASM.GetExternalIpAddressRanges.organization_handles
      description: External IP address range associated organization handles
      type: String
  - arguments:
    - description: A string representing the range ID for which you want to get the details for.
      name: range_id
      required: true
    description: Get external IP address range details according to the range IDs.
    name: asm-getexternalipaddressrange
    outputs:
    - contextPath: ASM.GetExternalIpAddressRange.range_id
      description: External IP address range UUID
      type: String
    - contextPath: ASM.GetExternalIpAddressRange.first_ip
      description: First IP address of external IP address range
      type: String
    - contextPath: ASM.GetExternalIpAddressRange.last_ip
      description: Last IP address of external IP address range
      type: String
    - contextPath: ASM.GetExternalIpAddressRange.ips_count
      description: Number of IP addresses of external IP address range
      type: Number
    - contextPath: ASM.GetExternalIpAddressRange.active_responsive_ips_count
      description: How many IPs in external address range are actively responsive
      type: Number
    - contextPath: ASM.GetExternalIpAddressRange.date_added
      description: Date the external IP address range was added
      type: Date
    - contextPath: ASM.GetExternalIpAddressRange.business_units
      description: External IP address range associated business units
      type: String
    - contextPath: ASM.GetExternalIpAddressRange.organization_handles
      description: External IP address range associated organization handles
      type: String
    - contextPath: ASM.GetExternalIpAddressRange.details
      description: Additional information
      type: String
  - arguments:
    - description: IP Address to search on
      name: ip_address
    - description: name of asset to search on
      name: name
    - auto: PREDEFINED
      description: type of external service
      name: type
      predefined:
      - certificate
      - cloud_compute_instance
      - on_prem
      - domain
      - unassociated_responsive_ip
    - auto: PREDEFINED
      description: does the internet exposure have an active external service
      name: has_active_external_services
      predefined:
      - "yes"
      - "no"
    description: Get a list of all your Internet exposure filtered by ip address, domain, type, and/or if there is an active external service. Maximum result limit is 100 assets.
    name: asm-getassetsinternetexposure
    outputs:
    - contextPath: ASM.GetAssetsInternetExposure.asm_ids
      description: Attack surface managment UUID
      type: String
    - contextPath: ASM.GetAssetsInternetExposure.name
      description: Name of the exposed asset
      type: String
    - contextPath: ASM.GetAssetsInternetExposure.asset_type
      description: Type of the exposed asset
      type: String
    - contextPath: ASM.GetAssetsInternetExposure.cloud_provider
      description: The cloud provider used to collect these cloud assets as either GCP, AWS, or Azure
      type: Unknown
    - contextPath: ASM.GetAssetsInternetExposure.region
      description: Displays the region as provided by the Cloud provider
      type: Unknown
    - contextPath: ASM.GetAssetsInternetExposure.last_observed
      description: Last time exposure was observed
      type: Unknown
    - contextPath: ASM.GetAssetsInternetExposure.first_observed
      description: First time exposure was observed
      type: Unknown
    - contextPath: ASM.GetAssetsInternetExposure.has_active_externally_services
      description: If the internet exposure is associated with active external service(s)
      type: Boolean
    - contextPath: ASM.GetAssetsInternetExposure.has_xdr_agent
      description: If the internet exposure asset has an XDR agent
      type: String
    - contextPath: ASM.GetAssetsInternetExposure.cloud_id
      description: Displays the Resource ID as provided from the cloud provider
      type: Unknown
    - contextPath: ASM.GetAssetsInternetExposure.domain_resolves
      description: is the asset domain resolvable
      type: Boolean
    - contextPath: ASM.GetAssetsInternetExposure.operation_system
      description: The operang system reported by the source for this asset
      type: Unknown
    - contextPath: ASM.GetAssetsInternetExposure.agent_id
      description: If there is an endpoint installed on this asset, this is the endpoint ID
      type: Unknown
    - contextPath: ASM.GetAssetsInternetExposure.externally_detected_providers
      description: The provider of the asset as determined by an external assessment
      type: String
    - contextPath: ASM.GetAssetsInternetExposure.service_type
      description: Type of asset
      type: String
    - contextPath: ASM.GetAssetsInternetExposure.externally_inferred_cves
      description: If the internet exposure has associated CVEs
      type: String
    - contextPath: ASM.GetAssetsInternetExposure.ips
      description: IP addresses associated wih the internet exposure
      type: String
  - arguments:
    - description: A string representing the asset ID for which you want to get the details for
      name: asm_id
      required: true
    description: Get Internet exposure asset details according to the asset ID.
    name: asm-getassetinternetexposure
    outputs:
    - contextPath: ASM.GetAssetInternetExposure.asm_ids
      description: Attack surface managment UUID
      type: String
    - contextPath: ASM.GetAssetInternetExposure.name
      description: Name of the exposed asset
      type: String
    - contextPath: ASM.GetAssetInternetExposure.type
      description: Type of the exposed asset
      type: String
    - contextPath: ASM.GetAssetInternetExposure.last_observed
      description: Last time exposure was observed
      type: Unknown
    - contextPath: ASM.GetAssetInternetExposure.first_observed
      description: First time exposure was observed
      type: Unknown
    - contextPath: ASM.GetAssetInternetExposure.created
      description: Date the ASM Issue was created
      type: Date
    - contextPath: ASM.GetAssetInternetExposure.business_units
      description: Asset associated business units
      type: String
    - contextPath: ASM.GetAssetInternetExposure.domain
      description: Asset associated domain
      type: Unknown
    - contextPath: ASM.GetAssetInternetExposure.certificate_issuer
      description: Asset certificate issuer
      type: String
    - contextPath: ASM.GetAssetInternetExposure.certificate_algorithm
      description: Asset certificate algorithm
      type: String
    - contextPath: ASM.GetAssetInternetExposure.certificate_classifications
      description: Asset certificate classifications
      type: String
    - contextPath: ASM.GetAssetInternetExposure.resolves
      description: Does the asset have DNS resolution
      type: Boolean
    - contextPath: ASM.GetAssetInternetExposure.details
      description: Additional details
      type: Unknown
    - contextPath: ASM.GetAssetInternetExposure.externally_inferred_vulnerability_score
      description: Asset vulnerability score
      type: Unknown
  dockerimage: demisto/python3:3.10.7.33922
  runonce: false
  script: ''
  subtype: python3
  type: python
fromversion: 6.5.0
tests:
- No tests (auto formatted)
