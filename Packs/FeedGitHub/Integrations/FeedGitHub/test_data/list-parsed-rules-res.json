[{"value": "Lorem_Malware_Mar18_Rule1", "type": "YARA Rule", "service": "github", "fields": {"value": "Lorem_Malware_Mar18_Rule1", "description": "Detects malware from Lorem Ipsum report", "author": "Lorem Ipsum (Example Systems)", "rulereference": "https://example.com", "sourcetimestamp": "2018-03-10", "ruleid": "12345678-1234-1234-1234-1234567890ab", "rulestrings": [{"index": "$s1", "string": "\\\\Release\\\\LoremCli.pdb", "type": "text", "modifiers": ["ascii"]}, {"index": "$s2", "string": "%snewcmd.exe", "type": "text", "modifiers": ["fullword", "ascii"]}, {"index": "$s3", "string": "Run cmd error %d", "type": "text", "modifiers": ["fullword", "ascii"]}, {"index": "$s4", "string": "%s~loremtmp%08x.ini", "type": "text", "modifiers": ["fullword", "ascii"]}, {"index": "$s5", "string": "run file failed", "type": "text", "modifiers": ["fullword", "ascii"]}, {"index": "$s6", "string": "Cmd timeout %d", "type": "text", "modifiers": ["fullword", "ascii"]}, {"index": "$s7", "string": "2 %s  %d 0 %d", "type": "text", "modifiers": ["fullword", "ascii"]}], "condition": "uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 2 of them", "references": "example.com", "rawrule": "```\n import \"pe\"\n\nrule Lorem_Malware_Mar18_Rule1\n{\n\tmeta:\n\t\tdescription = \"Detects malware from Lorem Ipsum report\"\n\t\tlicense = \"Detection Rule License 1.1 https://example.com/license\"\n\t\tauthor = \"Lorem Ipsum (Example Systems)\"\n\t\treference = \"https://example.com\"\n\t\tdate = \"2018-03-10\"\n\t\thash1 = \"1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef\"\n\t\tid = \"12345678-1234-1234-1234-1234567890ab\"\n\n\tstrings:\n\t\t$s1 = \"\\\\Release\\\\LoremCli.pdb\" ascii\n\t\t$s2 = \"%snewcmd.exe\" fullword ascii\n\t\t$s3 = \"Run cmd error %d\" fullword ascii\n\t\t$s4 = \"%s~loremtmp%08x.ini\" fullword ascii\n\t\t$s5 = \"run file failed\" fullword ascii\n\t\t$s6 = \"Cmd timeout %d\" fullword ascii\n\t\t$s7 = \"2 %s  %d 0 %d\" fullword ascii\n\n\tcondition:\n\t\tuint16(0)==0x5a4d and filesize <200KB and 2 of them\n}\n \n```"}, "score": 0, "firstseenbysource": "2024-05-12T15:30:49.330015", "rawJSON": {"value": "Lorem_Malware_Mar18_Rule1", "type": "YARA Rule"}}, {"value": "Lorem_Malware_Mar18_Rule2", "type": "YARA Rule", "service": "github", "fields": {"value": "Lorem_Malware_Mar18_Rule2", "description": "Detects malware from Lorem Ipsum report", "author": "Lorem Ipsum (Example Systems)", "rulereference": "https://example.com", "sourcetimestamp": "2018-03-10", "ruleid": "abcdef12-3456-7890-abcd-ef1234567890", "rulestrings": [{"index": "$x1", "string": "del c:\\\\windows\\\\temp\\\\r.exe /f /q", "type": "text", "modifiers": ["fullword", "ascii"]}, {"index": "$x2", "string": "%s\\\\r.exe", "type": "text", "modifiers": ["fullword", "ascii"]}, {"index": "$s1", "string": "rights.dll", "type": "text", "modifiers": ["fullword", "ascii"]}, {"index": "$s2", "string": "\\\"%s\\\">>\\\"%s\\\"\\\\s.txt", "type": "text", "modifiers": ["fullword", "ascii"]}, {"index": "$s3", "string": "Nwsapagent", "type": "text", "modifiers": ["fullword", "ascii"]}, {"index": "$s4", "string": "%s\\\\r.bat", "type": "text", "modifiers": ["fullword", "ascii"]}, {"index": "$s5", "string": "%s\\\\s.txt", "type": "text", "modifiers": ["fullword", "ascii"]}, {"index": "$s6", "string": "runexe", "type": "text", "modifiers": ["fullword", "ascii"]}], "condition": "uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( ( pe.exports ( \"RunInstallA\" ) and pe.exports ( \"RunUninstallA\" ) ) or 1 of ( $x* ) or 2 of them )", "references": "example.com", "rawrule": "```\n import \"pe\"\n\nrule Lorem_Malware_Mar18_Rule2\n{\n\tmeta:\n\t\tdescription = \"Detects malware from Lorem Ipsum report\"\n\t\tlicense = \"Detection Rule License 1.1 https://example.com/license\"\n\t\tauthor = \"Lorem Ipsum (Example Systems)\"\n\t\treference = \"https://example.com\"\n\t\tdate = \"2018-03-10\"\n\t\thash1 = \"abcdef1234567890abcdef1234567890abcdef1234567890abcdef1234567890\"\n\t\tid = \"abcdef12-3456-7890-abcd-ef1234567890\"\n\n\tstrings:\n\t\t$x1 = \"del c:\\\\windows\\\\temp\\\\r.exe /f /q\" fullword ascii\n\t\t$x2 = \"%s\\\\r.exe\" fullword ascii\n\t\t$s1 = \"rights.dll\" fullword ascii\n\t\t$s2 = \"\\\"%s\\\">>\\\"%s\\\"\\\\s.txt\" fullword ascii\n\t\t$s3 = \"Nwsapagent\" fullword ascii\n\t\t$s4 = \"%s\\\\r.bat\" fullword ascii\n\t\t$s5 = \"%s\\\\s.txt\" fullword ascii\n\t\t$s6 = \"runexe\" fullword ascii\n\n\tcondition:\n\t\tuint16(0)==0x5a4d and filesize <200KB and ((pe.exports(\"RunInstallA\") and pe.exports(\"RunUninstallA\")) or 1 of ($x*) or 2 of them )\n}\n \n```"}, "score": 0, "firstseenbysource": "2024-05-12T15:30:49.330015", "rawJSON": {"value": "Lorem_Malware_Mar18_Rule2", "type": "YARA Rule"}}, {"value": "Lorem_Malware_Mar18_Rule3", "type": "YARA Rule", "service": "github", "fields": {"value": "Lorem_Malware_Mar18_Rule3", "description": "Detects malware from Lorem Ipsum report", "author": "Lorem Ipsum (Example Systems)", "rulereference": "https://example.com", "sourcetimestamp": "2018-03-10", "ruleid": "abcdef12-3456-7890-abcd-ef1234567890", "rulestrings": [{"index": "$x1", "string": "AAAAKQAASCMAABi+AABnhEBj8vep7VRoAEPRWLweGc0/eiDrXGajJXRxbXsTXAcZAABK4QAAPWwAACzWAAByrg==", "type": "text", "modifiers": ["fullword", "ascii"]}, {"index": "$x2", "string": "AAAAKQAASCMAABi+AABnhKv3kXJJousn5YzkjGF46eE3G8ZGse4B9uoqJo8Q2oF0AABK4QAAPWwAACzWAAByrg==", "type": "text", "modifiers": ["fullword", "ascii"]}, {"index": "$a1", "string": "http://%s/content.html?id=%s", "type": "text", "modifiers": ["fullword", "ascii"]}, {"index": "$a2", "string": "http://%s/main.php?ssid=%s", "type": "text", "modifiers": ["fullword", "ascii"]}, {"index": "$a3", "string": "http://%s/webmail.php?id=%s", "type": "text", "modifiers": ["fullword", "ascii"]}, {"index": "$a9", "string": "http://%s/error.html?tab=%s", "type": "text", "modifiers": ["fullword", "ascii"]}, {"index": "$s1", "string": "%s\\\\~tmp.txt", "type": "text", "modifiers": ["fullword", "ascii"]}, {"index": "$s2", "string": "%s /C %s >>\\\"%s\\\" 2>&1", "type": "text", "modifiers": ["fullword", "ascii"]}, {"index": "$s3", "string": "DisableFirstRunCustomize", "type": "text", "modifiers": ["fullword", "ascii"]}], "condition": "uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( 1 of ( $x* ) or 2 of them )", "references": "example.com", "rawrule": "```\n import \"pe\"\n\nrule Lorem_Malware_Mar18_Rule3\n{\n\tmeta:\n\t\tdescription = \"Detects malware from Lorem Ipsum report\"\n\t\tlicense = \"Detection Rule License 1.1 https://example.com/license\"\n\t\tauthor = \"Lorem Ipsum (Example Systems)\"\n\t\treference = \"https://example.com\"\n\t\tdate = \"2018-03-10\"\n\t\thash1 = \"abcdef1234567890abcdef1234567890abcdef1234567890abcdef1234567890\"\n\t\tid = \"abcdef12-3456-7890-abcd-ef1234567890\"\n\n\tstrings:\n\t\t$x1 = \"AAAAKQAASCMAABi+AABnhEBj8vep7VRoAEPRWLweGc0/eiDrXGajJXRxbXsTXAcZAABK4QAAPWwAACzWAAByrg==\" fullword ascii\n\t\t$x2 = \"AAAAKQAASCMAABi+AABnhKv3kXJJousn5YzkjGF46eE3G8ZGse4B9uoqJo8Q2oF0AABK4QAAPWwAACzWAAByrg==\" fullword ascii\n\t\t$a1 = \"http://%s/content.html?id=%s\" fullword ascii\n\t\t$a2 = \"http://%s/main.php?ssid=%s\" fullword ascii\n\t\t$a3 = \"http://%s/webmail.php?id=%s\" fullword ascii\n\t\t$a9 = \"http://%s/error.html?tab=%s\" fullword ascii\n\t\t$s1 = \"%s\\\\~tmp.txt\" fullword ascii\n\t\t$s2 = \"%s /C %s >>\\\"%s\\\" 2>&1\" fullword ascii\n\t\t$s3 = \"DisableFirstRunCustomize\" fullword ascii\n\n\tcondition:\n\t\tuint16(0)==0x5a4d and filesize <200KB and (1 of ($x*) or 2 of them )\n}\n \n```"}, "score": 0, "firstseenbysource": "2024-05-12T15:30:49.330015", "rawJSON": {"value": "Lorem_Malware_Mar18_Rule3", "type": "YARA Rule"}}, {"value": "Lorem_Malware_Mar18_Rule4", "type": "YARA Rule", "service": "github", "fields": {"value": "Lorem_Malware_Mar18_Rule4", "description": "Detects malware from Lorem Ipsum report", "author": "Lorem Ipsum (Example Systems)", "rulereference": "https://example.com", "sourcetimestamp": "2018-03-10", "ruleid": "abcdef12-3456-7890-abcd-ef1234567890", "rulestrings": [{"index": "$s1", "string": "\\\\Release\\\\LoremTool.pdb", "type": "text", "modifiers": ["ascii"]}, {"index": "$s2", "string": "LoremTool.exe", "type": "text", "modifiers": ["fullword", "wide"]}, {"index": "$s3", "string": "Microsoft.Lorem.WebServices.Data", "type": "text", "modifiers": ["fullword", "ascii"]}, {"index": "$s4", "string": "tmp.dat", "type": "text", "modifiers": ["fullword", "wide"]}, {"index": "$s6", "string": "/v or /t is null", "type": "text", "modifiers": ["fullword", "wide"]}], "condition": "uint16 ( 0 ) == 0x5a4d and filesize < 40KB and all of them", "references": "example.com", "rawrule": "```\n import \"pe\"\n\nrule Lorem_Malware_Mar18_Rule4\n{\n\tmeta:\n\t\tdescription = \"Detects malware from Lorem Ipsum report\"\n\t\tlicense = \"Detection Rule License 1.1 https://example.com/license\"\n\t\tauthor = \"Lorem Ipsum (Example Systems)\"\n\t\treference = \"https://example.com\"\n\t\tdate = \"2018-03-10\"\n\t\thash1 = \"abcdef1234567890abcdef1234567890abcdef1234567890abcdef1234567890\"\n\t\tid = \"abcdef12-3456-7890-abcd-ef1234567890\"\n\n\tstrings:\n\t\t$s1 = \"\\\\Release\\\\LoremTool.pdb\" ascii\n\t\t$s2 = \"LoremTool.exe\" fullword wide\n\t\t$s3 = \"Microsoft.Lorem.WebServices.Data\" fullword ascii\n\t\t$s4 = \"tmp.dat\" fullword wide\n\t\t$s6 = \"/v or /t is null\" fullword wide\n\n\tcondition:\n\t\tuint16(0)==0x5a4d and filesize <40KB and all of them\n}\n \n```"}, "score": 0, "firstseenbysource": "2024-05-12T15:30:49.330015", "rawJSON": {"value": "Lorem_Malware_Mar18_Rule4", "type": "YARA Rule"}}, {"value": "clean_lorem_patchedcmd", "type": "YARA Rule", "service": "github", "fields": {"value": "clean_lorem_patchedcmd", "description": "This is a patched CMD. This is the CMD that LoremCli uses.", "author": "Lorem Ipsum", "rulereference": "", "sourcetimestamp": "", "ruleid": "abcdef12-3456-7890-abcd-ef1234567890", "rulestrings": [{"index": "$", "string": "disableCMD", "type": "text", "modifiers": ["wide"]}, {"index": "$", "string": "%WINDOWS_COPYRIGHT%", "type": "text", "modifiers": ["wide"]}, {"index": "$", "string": "Cmd.Exe", "type": "text", "modifiers": ["wide"]}, {"index": "$", "string": "Windows Command Processor", "type": "text", "modifiers": ["wide"]}], "condition": "uint16 ( 0 ) == 0x5A4D and all of them", "references": "example.com", "rawrule": "```\n import \"pe\"\n\nrule clean_lorem_patchedcmd\n{\n\tmeta:\n\t\tauthor = \"Lorem Ipsum\"\n\t\tdescription = \"This is a patched CMD. This is the CMD that LoremCli uses.\"\n\t\tsha256 = \"abcdef1234567890abcdef1234567890abcdef1234567890abcdef1234567890\"\n\t\tid = \"abcdef12-3456-7890-abcd-ef1234567890\"\n\n\tstrings:\n\t\t$ = \"disableCMD\" wide\n\t\t$ = \"%WINDOWS_COPYRIGHT%\" wide\n\t\t$ = \"Cmd.Exe\" wide\n\t\t$ = \"Windows Command Processor\" wide\n\n\tcondition:\n\t\tuint16(0)==0x5A4D and all of them\n}\n \n```"}, "score": 0, "firstseenbysource": "2024-05-12T15:30:49.330015", "rawJSON": {"value": "clean_lorem_patchedcmd", "type": "YARA Rule"}}, {"value": "malware_lorem_royalcli_1", "type": "YARA Rule", "service": "github", "fields": {"value": "malware_lorem_royalcli_1", "description": "Generic strings found in the Lorem CLI tool", "author": "Lorem Ipsum", "rulereference": "", "sourcetimestamp": "", "ruleid": "abcdef12-3456-7890-abcd-ef1234567890", "rulestrings": [{"index": "$", "string": "%s~loremtmp%08x.tmp", "type": "text", "modifiers": ["fullword"]}, {"index": "$", "string": "%s /c %s>%s", "type": "text", "modifiers": ["fullword"]}, {"index": "$", "string": "%snewcmd.exe", "type": "text", "modifiers": ["fullword"]}, {"index": "$", "string": "%shkcmd.exe", "type": "text", "modifiers": ["fullword"]}, {"index": "$", "string": "%s~loremtmp%08x.ini", "type": "text", "modifiers": ["fullword"]}, {"index": "$", "string": "myRObject", "type": "text", "modifiers": ["fullword"]}, {"index": "$", "string": "myWObject", "type": "text", "modifiers": ["fullword"]}, {"index": "$", "string": "2 %s  %d 0 %d\\x0D\\x0A", "type": "text", "modifiers": null}, {"index": "$", "string": "2 %s  %d 1 %d\\x0D\\x0A", "type": "text", "modifiers": null}, {"index": "$", "string": "%s file not exist", "type": "text", "modifiers": ["fullword"]}], "condition": "uint16 ( 0 ) == 0x5A4D and 5 of them", "references": "example.com", "rawrule": "```\n import \"pe\"\n\nrule malware_lorem_royalcli_1\n{\n\tmeta:\n\t\tdescription = \"Generic strings found in the Lorem CLI tool\"\n\t\tauthor = \"Lorem Ipsum\"\n\t\tsha256 = \"abcdef1234567890abcdef1234567890abcdef1234567890abcdef1234567890\"\n\t\tid = \"abcdef12-3456-7890-abcd-ef1234567890\"\n\n\tstrings:\n\t\t$ = \"%s~loremtmp%08x.tmp\" fullword\n\t\t$ = \"%s /c %s>%s\" fullword\n\t\t$ = \"%snewcmd.exe\" fullword\n\t\t$ = \"%shkcmd.exe\" fullword\n\t\t$ = \"%s~loremtmp%08x.ini\" fullword\n\t\t$ = \"myRObject\" fullword\n\t\t$ = \"myWObject\" fullword\n\t\t$ = \"2 %s  %d 0 %d\\x0D\\x0A\"\n\t\t$ = \"2 %s  %d 1 %d\\x0D\\x0A\"\n\t\t$ = \"%s file not exist\" fullword\n\n\tcondition:\n\t\tuint16(0)==0x5A4D and 5 of them\n}\n \n```"}, "score": 0, "firstseenbysource": "2024-05-12T15:30:49.330015", "rawJSON": {"value": "malware_lorem_royalcli_1", "type": "YARA Rule"}}, {"value": "malware_lorem_royalcli_2", "type": "YARA Rule", "service": "github", "fields": {"value": "malware_lorem_royalcli_2", "description": "Lorem RoyalCli backdoor", "author": "Lorem Ipsum", "rulereference": "", "sourcetimestamp": "", "ruleid": "abcdef12-3456-7890-abcd-ef1234567890", "rulestrings": [{"index": "$string1", "string": "%shkcmd.exe", "type": "text", "modifiers": ["fullword"]}, {"index": "$string2", "string": "myRObject", "type": "text", "modifiers": ["fullword"]}, {"index": "$string3", "string": "%snewcmd.exe", "type": "text", "modifiers": ["fullword"]}, {"index": "$string4", "string": "%s~loremtmp%08x.tmp", "type": "text", "modifiers": ["fullword"]}, {"index": "$string6", "string": "myWObject", "type": "text", "modifiers": ["fullword"]}], "condition": "uint16 ( 0 ) == 0x5A4D and 2 of them", "references": "example.com", "rawrule": "```\n import \"pe\"\n\nrule malware_lorem_royalcli_2\n{\n\tmeta:\n\t\tauthor = \"Lorem Ipsum\"\n\t\tdescription = \"Lorem RoyalCli backdoor\"\n\t\tid = \"abcdef12-3456-7890-abcd-ef1234567890\"\n\n\tstrings:\n\t\t$string1 = \"%shkcmd.exe\" fullword\n\t\t$string2 = \"myRObject\" fullword\n\t\t$string3 = \"%snewcmd.exe\" fullword\n\t\t$string4 = \"%s~loremtmp%08x.tmp\" fullword\n\t\t$string6 = \"myWObject\" fullword\n\n\tcondition:\n\t\tuint16(0)==0x5A4D and 2 of them\n}\n \n```"}, "score": 0, "firstseenbysource": "2024-05-12T15:30:49.330015", "rawJSON": {"value": "malware_lorem_royalcli_2", "type": "YARA Rule"}}]