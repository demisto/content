MalwareBazaar is a project from abuse.ch with the goal of sharing malware samples with the infosec community, AV vendors and threat intelligence providers.
This integration was integrated and tested with version xx of MalwareBazaar

## Configure MalwareBazaar on Cortex XSOAR

1. Navigate to **Settings** > **Integrations** > **Servers & Services**.
2. Search for MalwareBazaar.
3. Click **Add instance** to create and configure a new integration instance.

    | **Parameter** | **Description** | **Required** |
    | --- | --- | --- |
    | Server URL |  | True |
    | API Key | API key is required in order to comment a malware sample | False |
    | Use system proxy settings |  | False |
    | Trust any certificate (not secure) |  | False |

4. Click **Test** to validate the URLs, token, and connection.
## Commands
You can execute these commands from the Cortex XSOAR CLI, as part of an automation, or in a playbook.
After you successfully execute a command, a DBot message appears in the War Room with the command details.
### file
***
Check if a particular malware sample is known to MalwareBazaar.


#### Base Command

`file`
#### Input

| **Argument Name** | **Description** | **Required** |
| --- | --- | --- |
| file | list of SHA256, MD5 or SHA1 hash of the malware samples you want. to query. | Required | 


#### Context Output

| **Path** | **Type** | **Description** |
| --- | --- | --- |
| MalwareBazaar.File.sha256_hash | String | SHA256 hash of the malware sample. | 
| MalwareBazaar.File.sha3_384_hash | String | SHA3-384 hash of the malware sample. | 
| MalwareBazaar.File.sha1_hash | String | SHA1 hash of the malware sample. | 
| MalwareBazaar.File.md5_hash | String | MD5 hash of the malware sample. | 
| MalwareBazaar.File.first_seen | Date | TS when the file has been first seen by MalwareBazaar \(UTC\). | 
| MalwareBazaar.File.last_seen | Date | TS when the file has been last seen by MalwareBazaar \(UTC\). | 
| MalwareBazaar.File.file_name | String | Malware sample's file name. | 
| MalwareBazaar.File.file_size | Number | File size in bytes. | 
| MalwareBazaar.File.file_type_mime | String | MIME file type. | 
| MalwareBazaar.File.file_type | String | File type. | 
| MalwareBazaar.File.reporter | String | Twitter handle of the report \(or anonymous for anonymous submissions\). | 
| MalwareBazaar.File.origin_country | String | Two letter country code of the country where the sample was uploaded from. | 
| MalwareBazaar.File.anonymous | Number | 1 \(true\) or 0 \(false\). | 
| MalwareBazaar.File.signature | String | Malware family \(if available\). | 
| MalwareBazaar.File.imphash | String | imphash \(only available for PE executables\). | 
| MalwareBazaar.File.tlsh | String | Trend Micro Locality Sensitive Hash \(tlsh\). | 
| MalwareBazaar.File.telfhash | Unknown | Trend Micro ELF Hash \(telfhash\). | 
| MalwareBazaar.File.ssdeep | String | ssdeep. | 
| MalwareBazaar.File.dhash_icon | Unknown | In case the file is a PE executable: dhash of the samples icon. | 
| MalwareBazaar.File.comment | Unknown | comment. | 
| MalwareBazaar.File.tags | String | list of tags. | 
| MalwareBazaar.File.code_sign.subject_cn | Unknown | Subject Common Name \(CN\). | 
| MalwareBazaar.File.code_sign.issuer_cn | Unknown | Issuer Common Name \(CN\). | 
| MalwareBazaar.File.code_sign.algorithm | Unknown | Algorithm used. | 
| MalwareBazaar.File.code_sign.valid_from | Unknown | Datetime valid from. | 
| MalwareBazaar.File.code_sign.valid_to | Unknown | Datetime valid to \(expire date\). | 
| MalwareBazaar.File.code_sign.serial_number | Unknown | Serial number. | 
| MalwareBazaar.File.code_sign.cscb_listed | Unknown | Code Signing Certificate Blocklist \(CSCB\) status \(True or False\). | 
| MalwareBazaar.File.code_sign.cscb_reason | Unknown | Code Signing Certificate Blocklist \(CSCB\) listing reason. | 
| MalwareBazaar.File.delivery_method.email_attachment | Unknown | Distributed via e-mail attachment. | 
| MalwareBazaar.File.delivery_method.email_link | Unknown | Distributed via e-mail link. | 
| MalwareBazaar.File.delivery_method.web_download | Unknown | Distributed via web download. | 
| MalwareBazaar.File.delivery_method.web_drive-by | Unknown | Distributed via drive-by. | 
| MalwareBazaar.File.delivery_method.multiple | Unknown | Multiple delivery methods used. | 
| MalwareBazaar.File.delivery_method.other | Unknown | Other delivery methods used. | 
| MalwareBazaar.File.file_information | Unknown | Contextual information about the file sample. | 
| MalwareBazaar.File.yara_rules.rule_name | String | Name of the YARA rule that triggered. | 
| MalwareBazaar.File.yara_rules.author | String | Author of the YARA rule. | 
| MalwareBazaar.File.yara_rules.description | Unknown | Description of the YARA rule. | 
| MalwareBazaar.File.yara_rules.reference | Unknown | Reference of the YARA rule. | 
| MalwareBazaar.File.vendor_intel.ANY.RUN | Unknown | Dynamic malware analysis from ANY.RUN. | 
| MalwareBazaar.File.vendor_intel.CAPE | Unknown | Dynamic malware analysis from CAPE Sandbox. | 
| MalwareBazaar.File.vendor_intel.CERT-PL_MWDB | Unknown | Threat intel from CERT.PL Malware Database. | 
| MalwareBazaar.File.vendor_intel.vxCube | Unknown | Dynamic malware analysis from Dr.Web vxCube. | 
| MalwareBazaar.File.vendor_intel.DocGuard | Unknown | Office document reputation from DocGuad. | 
| MalwareBazaar.File.vendor_intel.FileScan-IO | Unknown | Malware analysis service from FileScan.IO. | 
| MalwareBazaar.File.vendor_intel.InQuest Labs | Unknown | File reputation service from InQuest Labs. | 
| MalwareBazaar.File.vendor_intel.Intezer | Unknown | Code analysis from Intezer. | 
| MalwareBazaar.File.vendor_intel.ReversingLabs | Unknown | File reputation &amp; intelligence from ReversingLabs TitaniumCloud. | 
| MalwareBazaar.File.vendor_intel.Spamhaus_HBL | Unknown | File reputation from Spamhaus Hash Blocklist \(HBL\). | 
| MalwareBazaar.File.vendor_intel.Triage | Unknown | Dynamic malware analysis from Hatching Triage. | 
| MalwareBazaar.File.vendor_intel.UnpacMe | Unknown | Malware unpacking service from UnpacMe. | 
| MalwareBazaar.File.vendor_intel.VMRay | Unknown | Dynamic malware analysis from VMRay. | 
| MalwareBazaar.File.vendor_intel.YOROI_YOMI | Unknown | Dynamic malware analysis from YOROI YOMI. | 
| MalwareBazaar.File.comments.id | String | Unique id that identifies this comment. | 
| MalwareBazaar.File.comments.date_added | Date | Timestamp \(UTC\) when this comment has been made. | 
| MalwareBazaar.File.comments.twitter_handle | String | Twitter handle who wrote this comment. | 
| MalwareBazaar.File.comments.display_name | String | Twitter display name. | 
| MalwareBazaar.File.comments.comment | String | The comment itself. | 


#### Command Example
```!file file=094fd325049b8a9cf6d3e5ef2a6d4cc6a567d7d49c35f8bb8dd9e3c6acf3d78d```

#### Context Example
```json
{
    "DBotScore": {
        "Indicator": "094fd325049b8a9cf6d3e5ef2a6d4cc6a567d7d49c35f8bb8dd9e3c6acf3d78d",
        "Reliability": "A - Completely reliable",
        "Score": 3,
        "Type": "file",
        "Vendor": "MalwareBazaar"
    },
    "File": {
        "MD5": "2f6432c5af8d10b04caed90d410ec7ad",
        "Malicious": {
            "Description": null,
            "Vendor": "MalwareBazaar"
        },
        "Relationships": [
            {
                "EntityA": "094fd325049b8a9cf6d3e5ef2a6d4cc6a567d7d49c35f8bb8dd9e3c6acf3d78d",
                "EntityAType": "File",
                "EntityB": "AgentTesla",
                "EntityBType": "Malware",
                "Relationship": "indicator-of"
            }
        ],
        "SHA1": "4b1fc10818dd534922feef4d521eb3574337e3c0",
        "SHA256": "094fd325049b8a9cf6d3e5ef2a6d4cc6a567d7d49c35f8bb8dd9e3c6acf3d78d",
        "Size": 472064,
        "Type": "exe"
    },
    "MalwareBazaar": {
        "File": {
            "anonymous": 0,
            "code_sign": null,
            "comment": null,
            "comments": [
                {
                    "comment": "test",
                    "date_added": "2021-09-26 07:07:00",
                    "display_name": "mr tall",
                    "id": "25397",
                    "twitter_handle": "tiulog"
                },
                {
                    "comment": "test",
                    "date_added": "2021-09-26 08:16:59",
                    "display_name": "mr tall",
                    "id": "25405",
                    "twitter_handle": "tiulog"
                },
                {
                    "comment": "Swiss chocolate is the best chocolate",
                    "date_added": "2021-09-26 14:57:36",
                    "display_name": "mr tall",
                    "id": "25412",
                    "twitter_handle": "tiulog"
                },
                {
                    "comment": "test",
                    "date_added": "2021-09-29 15:10:09",
                    "display_name": "mr tall",
                    "id": "25689",
                    "twitter_handle": "tiulog"
                },
                {
                    "comment": "test new",
                    "date_added": "2021-10-03 10:53:34",
                    "display_name": "mr tall",
                    "id": "25968",
                    "twitter_handle": "tiulog"
                },
                {
                    "comment": "test",
                    "date_added": "2021-10-03 11:03:32",
                    "display_name": "mr tall",
                    "id": "25978",
                    "twitter_handle": "tiulog"
                },
                {
                    "comment": "test",
                    "date_added": "2021-10-04 09:07:37",
                    "display_name": "mr tall",
                    "id": "26069",
                    "twitter_handle": "tiulog"
                },
                {
                    "comment": "test new",
                    "date_added": "2021-10-04 11:15:43",
                    "display_name": "mr tall",
                    "id": "26098",
                    "twitter_handle": "tiulog"
                },
                {
                    "comment": "test new",
                    "date_added": "2021-10-04 11:15:58",
                    "display_name": "mr tall",
                    "id": "26099",
                    "twitter_handle": "tiulog"
                },
                {
                    "comment": "test",
                    "date_added": "2021-10-04 11:26:47",
                    "display_name": "mr tall",
                    "id": "26100",
                    "twitter_handle": "tiulog"
                },
                {
                    "comment": "test",
                    "date_added": "2021-10-04 12:11:40",
                    "display_name": "mr tall",
                    "id": "26106",
                    "twitter_handle": "tiulog"
                },
                {
                    "comment": "test",
                    "date_added": "2021-10-04 12:41:08",
                    "display_name": "mr tall",
                    "id": "26109",
                    "twitter_handle": "tiulog"
                },
                {
                    "comment": "test",
                    "date_added": "2021-10-05 08:20:09",
                    "display_name": "mr tall",
                    "id": "26169",
                    "twitter_handle": "tiulog"
                },
                {
                    "comment": "test_module",
                    "date_added": "2021-10-05 13:56:59",
                    "display_name": "mr tall",
                    "id": "26190",
                    "twitter_handle": "tiulog"
                },
                {
                    "comment": "test_module",
                    "date_added": "2021-10-05 14:06:40",
                    "display_name": "mr tall",
                    "id": "26194",
                    "twitter_handle": "tiulog"
                },
                {
                    "comment": "test",
                    "date_added": "2021-10-05 15:14:51",
                    "display_name": "mr tall",
                    "id": "26200",
                    "twitter_handle": "tiulog"
                },
                {
                    "comment": "test",
                    "date_added": "2021-10-05 15:16:17",
                    "display_name": "mr tall",
                    "id": "26201",
                    "twitter_handle": "tiulog"
                },
                {
                    "comment": "test",
                    "date_added": "2021-10-06 14:42:17",
                    "display_name": "mr tall",
                    "id": "26263",
                    "twitter_handle": "tiulog"
                },
                {
                    "comment": "test",
                    "date_added": "2021-10-07 07:13:43",
                    "display_name": "mr tall",
                    "id": "26325",
                    "twitter_handle": "tiulog"
                },
                {
                    "comment": "test",
                    "date_added": "2021-10-07 07:16:53",
                    "display_name": "mr tall",
                    "id": "26326",
                    "twitter_handle": "tiulog"
                },
                {
                    "comment": "test",
                    "date_added": "2021-10-07 07:17:36",
                    "display_name": "mr tall",
                    "id": "26327",
                    "twitter_handle": "tiulog"
                },
                {
                    "comment": "test",
                    "date_added": "2021-10-07 07:43:28",
                    "display_name": "mr tall",
                    "id": "26328",
                    "twitter_handle": "tiulog"
                },
                {
                    "comment": "test",
                    "date_added": "2021-10-07 07:46:45",
                    "display_name": "mr tall",
                    "id": "26329",
                    "twitter_handle": "tiulog"
                },
                {
                    "comment": "test",
                    "date_added": "2021-10-07 11:39:00",
                    "display_name": "mr tall",
                    "id": "26353",
                    "twitter_handle": "tiulog"
                },
                {
                    "comment": "test",
                    "date_added": "2021-10-07 11:39:55",
                    "display_name": "mr tall",
                    "id": "26354",
                    "twitter_handle": "tiulog"
                },
                {
                    "comment": "test",
                    "date_added": "2021-10-07 11:41:41",
                    "display_name": "mr tall",
                    "id": "26355",
                    "twitter_handle": "tiulog"
                },
                {
                    "comment": "test",
                    "date_added": "2021-10-07 11:50:55",
                    "display_name": "mr tall",
                    "id": "26356",
                    "twitter_handle": "tiulog"
                },
                {
                    "comment": "test",
                    "date_added": "2021-10-07 12:19:14",
                    "display_name": "mr tall",
                    "id": "26357",
                    "twitter_handle": "tiulog"
                },
                {
                    "comment": "test",
                    "date_added": "2021-10-07 13:11:26",
                    "display_name": "mr tall",
                    "id": "26361",
                    "twitter_handle": "tiulog"
                },
                {
                    "comment": "test",
                    "date_added": "2021-10-07 15:44:49",
                    "display_name": "mr tall",
                    "id": "26367",
                    "twitter_handle": "tiulog"
                },
                {
                    "comment": "test",
                    "date_added": "2021-10-10 09:17:58",
                    "display_name": "mr tall",
                    "id": "26633",
                    "twitter_handle": "tiulog"
                }
            ],
            "delivery_method": null,
            "dhash_icon": null,
            "file_information": null,
            "file_name": "COPY-SCANB840284-IMG-2020-13-02-DOCUMENT-PDF.exe",
            "file_size": 472064,
            "file_type": "exe",
            "file_type_mime": "application/x-dosexec",
            "first_seen": "2020-02-13 11:55:46",
            "imphash": "f34d5f2d4577ed6d9ceec516c1f5a744",
            "intelligence": {
                "clamav": [
                    "SecuriteInfo.com.Trojan.PackedNET.211.15710.28159.UNOFFICIAL"
                ],
                "downloads": "2426",
                "mail": null,
                "uploads": "2"
            },
            "last_seen": "2021-06-02 16:06:57",
            "md5_hash": "2f6432c5af8d10b04caed90d410ec7ad",
            "ole_information": [],
            "origin_country": "CH",
            "reporter": "abuse_ch",
            "sha1_hash": "4b1fc10818dd534922feef4d521eb3574337e3c0",
            "sha256_hash": "094fd325049b8a9cf6d3e5ef2a6d4cc6a567d7d49c35f8bb8dd9e3c6acf3d78d",
            "sha3_384_hash": "19ae5c4841f72a91eb66db9191d879a33cf87e69f07809105d25de6aa90fbce69c9e795a4a0b984bd33537502361bb9b",
            "signature": "AgentTesla",
            "ssdeep": "12288:GCU4gtAxIflaBAFGWf1yN6OcsiUIpqpcsHs4d8/U:MwIflaBaIH2Us69d88",
            "tags": [
                "AgentTesla",
                "exe"
            ],
            "telfhash": null,
            "tlsh": "65A4BF181BB98C13F54BA6BAC4D942C9E2FCD57B8907F759D41129D60F0ABA7AC023C7",
            "vendor_intel": {
                "ReversingLabs": {
                    "first_seen": "2020-02-14 04:28:36",
                    "scanner_count": "31",
                    "scanner_match": "26",
                    "scanner_percent": "83.87",
                    "status": "MALICIOUS",
                    "threat_name": "ByteCode-MSIL.Trojan.Kryptik"
                },
                "Spamhaus_HBL": [
                    {
                        "detection": "malicious",
                        "link": "https://www.spamhaus.org/hbl/"
                    }
                ],
                "Triage": {
                    "link": "https://tria.ge/reports/201109-7p6mxbz6r2/",
                    "malware_config": [],
                    "malware_family": "agenttesla",
                    "score": "10",
                    "signatures": [
                        {
                            "score": "10",
                            "signature": "AgentTesla"
                        },
                        {
                            "score": "9",
                            "signature": "AgentTesla Payload"
                        },
                        {
                            "score": "7",
                            "signature": "Reads data files stored by FTP clients"
                        },
                        {
                            "score": "7",
                            "signature": "Reads user/profile data of local email clients"
                        },
                        {
                            "score": "7",
                            "signature": "Reads user/profile data of web browsers"
                        },
                        {
                            "score": "6",
                            "signature": "Adds Run key to start application"
                        },
                        {
                            "score": "6",
                            "signature": "Looks up external IP address via web service"
                        },
                        {
                            "score": "5",
                            "signature": "Suspicious use of SetThreadContext"
                        },
                        {
                            "score": null,
                            "signature": "Suspicious behavior: EnumeratesProcesses"
                        },
                        {
                            "score": null,
                            "signature": "Suspicious behavior: MapViewOfSection"
                        },
                        {
                            "score": null,
                            "signature": "Suspicious use of AdjustPrivilegeToken"
                        },
                        {
                            "score": null,
                            "signature": "Suspicious use of SetWindowsHookEx"
                        },
                        {
                            "score": null,
                            "signature": "Suspicious use of WriteProcessMemory"
                        }
                    ],
                    "tags": [
                        "family:agenttesla",
                        "keylogger",
                        "persistence",
                        "spyware",
                        "stealer",
                        "trojan"
                    ]
                },
                "YOROI_YOMI": {
                    "detection": "Unknown",
                    "score": "1.00"
                }
            },
            "yara_rules": [
                {
                    "author": "JPCERT/CC Incident Response Group",
                    "description": "detect Agenttesla in memory",
                    "reference": "internal research",
                    "rule_name": "Agenttesla_type2"
                },
                {
                    "author": "Brian C. Bell -- @biebsmalwareguy",
                    "description": null,
                    "reference": "https://github.com/DFIRnotes/rules/blob/master/CAP_HookExKeylogger.yar",
                    "rule_name": "CAP_HookExKeylogger"
                },
                {
                    "author": "Daniel Plohmann <daniel.plohmann@fkie.fraunhofer.de>",
                    "description": null,
                    "reference": null,
                    "rule_name": "win_agent_tesla_g2"
                }
            ]
        }
    }
}
```

#### Human Readable Output

>### MalwareBazaar File reputation for: 094fd325049b8a9cf6d3e5ef2a6d4cc6a567d7d49c35f8bb8dd9e3c6acf3d78d
>|Md5 Hash|File Name|File Type|File Size|Tags|First Seen|Last Seen|
>|---|---|---|---|---|---|---|
>| 2f6432c5af8d10b04caed90d410ec7ad | COPY-SCANB840284-IMG-2020-13-02-DOCUMENT-PDF.exe | exe | 472064 | AgentTesla,<br/>exe | 2020-02-13 11:55:46 | 2021-06-02 16:06:57 |


### malwarebazaar-download-sample
***
Download (fetch) malware samples from MalwareBazaar. Any malware sample downloaded from MalwareBazaar is zipped and password protected using the password "infected" (without "").


#### Base Command

`malwarebazaar-download-sample`
#### Input

| **Argument Name** | **Description** | **Required** |
| --- | --- | --- |
| sha256_hash | SHA256 hash of the malware sample to download. | Required | 


#### Context Output

| **Path** | **Type** | **Description** |
| --- | --- | --- |
| File.Size | String | The size of the file. | 
| File.SHA1 | String | The SHA1 hash of the file. | 
| File.SHA256 | String | The SHA256 hash of the file. | 
| File.SHA512 | String | The SHA512 hash of the file. | 
| File.Name | String | The name of the file. | 
| File.SSDeep | String | The SSDeep hash of the file. | 
| File.EntryID | String | EntryID of the file | 
| File.Info | String | Information about the file. | 
| File.Type | String | The file type. | 
| File.MD5 | String | The MD5 hash of the file. | 
| File.Extension | String | The extension of the file. | 


#### Command Example
```!malwarebazaar-download-sample sha256_hash=094fd325049b8a9cf6d3e5ef2a6d4cc6a567d7d49c35f8bb8dd9e3c6acf3d78```

#### Context Example
```json
{
    "File": {
        "EntryID": "7712@e99f97d1-7225-4c75-896c-3c960febbe8c",
        "Extension": "zip",
        "Info": "application/zip",
        "MD5": "23c96a2ba1a4d7cd8d179641aac32f0d",
        "Name": "094fd325049b8a9cf6d3e5ef2a6d4cc6a567d7d49c35f8bb8dd9e3c6acf3d78.zip",
        "SHA1": "b11025b4d625079d201ac9ba0552291a60be9c1e",
        "SHA256": "d727a2f40a5151d7a0e3bf9ebf77a8bf17a965505eb6db68080a38330c3fb743",
        "SHA512": "49f45537621ac26e7c5d7fea643fba27153070a52b8ebc56cab7e8522f5d8087697be6df969e9cfac74cefddceb6271aae1796f819fa3f405f909e3a488e4d18",
        "SSDeep": "3:HzH1IOH0Wp6FYn:Hr1I2xaY",
        "Size": 45,
        "Type": "JSON data"
    }
}
```

#### Human Readable Output



### malwarebazaar-comment-add
***
Comment a malware sample.


#### Base Command

`malwarebazaar-comment-add`
#### Input

| **Argument Name** | **Description** | **Required** |
| --- | --- | --- |
| sha256_hash | SHA256 hash of the malware sample you want comment. | Required | 
| comment | Comment on the sample. | Required | 


#### Context Output

| **Path** | **Type** | **Description** |
| --- | --- | --- |
| MalwareBazaar.MalwarebazaarCommentAdd.sha256_hash | String | SHA256 hash of given file. | 
| MalwareBazaar.MalwarebazaarCommentAdd.comment | String | The comment that was added to the malware sample. | 


#### Command Example
```!malwarebazaar-comment-add comment="test" sha256_hash=094fd325049b8a9cf6d3e5ef2a6d4cc6a567d7d49c35f8bb8dd9e3c6acf3d78d```

#### Context Example
```json
{
    "MalwareBazaar": {
        "MalwarebazaarCommentAdd": {
            "comment": "test",
            "sha256_hash": "094fd325049b8a9cf6d3e5ef2a6d4cc6a567d7d49c35f8bb8dd9e3c6acf3d78d"
        }
    }
}
```

#### Human Readable Output

>Comment added to 094fd325049b8a9cf6d3e5ef2a6d4cc6a567d7d49c35f8bb8dd9e3c6acf3d78d malware sample successfully

### malwarebazaar-samples-list
***
Retrieves a list of recent malware samples (max 1'000) associated with a specific sample type. Be aware, in case of use limit and page_size and page, only limit will be taken into considaration


#### Base Command

`malwarebazaar-samples-list`
#### Input

| **Argument Name** | **Description** | **Required** |
| --- | --- | --- |
| sample_type | Type of sample based on it the API will we queried. Possible values are: tag, signature, file_type, clamav, imphash, yara_rule, issuer_cn. | Required | 
| sample_value | Value of the sample selected. | Required | 
| limit | Max number of results is 1000. Be aware, when using issuer_cn, all relevant result will display (max 100). | Optional | 
| page | Page number you would like to view. Each page contains page_size values. If not inserted you will be displayed with the first page. | Optional | 
| page_size | Number of results per page to display. Be aware that the max number of result we are able to retrieve from MalwareBazaar is 1000. | Optional | 


#### Context Output

| **Path** | **Type** | **Description** |
| --- | --- | --- |
| MalwareBazaar.MalwarebazaarSamplesList.sha256_hash | String | SHA256 hash of the malware sample. | 
| MalwareBazaar.MalwarebazaarSamplesList.sha3_384_hash | String | SHA3-384 hash of the malware sample. | 
| MalwareBazaar.MalwarebazaarSamplesList.sha1_hash | String | SHA1 hash of the malware sample. | 
| MalwareBazaar.MalwarebazaarSamplesList.md5_hash | String | MD5 hash of the malware sample. | 
| MalwareBazaar.MalwarebazaarSamplesList.first_seen | Date | TS when the file has been first seen by MalwareBazaar \(UTC\). | 
| MalwareBazaar.MalwarebazaarSamplesList.last_seen | Unknown | TS when the file has been last seen by MalwareBazaar \(UTC\). | 
| MalwareBazaar.MalwarebazaarSamplesList.file_name | String | Malware sample's file name. | 
| MalwareBazaar.MalwarebazaarSamplesList.file_size | Number | File size in bytes. | 
| MalwareBazaar.MalwarebazaarSamplesList.file_type_mime | String | MIME file type. | 
| MalwareBazaar.MalwarebazaarSamplesList.file_type | String | File type. | 
| MalwareBazaar.MalwarebazaarSamplesList.reporter | String | Twitter handle of the report \(or anonymous for anonymous submissions\). | 
| MalwareBazaar.MalwarebazaarSamplesList.anonymous | Number | 1 \(true\) or 0 \(false\). | 
| MalwareBazaar.MalwarebazaarSamplesList.signature | String | Malware family \(if available\). | 
| MalwareBazaar.MalwarebazaarSamplesList.imphash | Unknown | imphash \(only available for PE executables\). | 
| MalwareBazaar.MalwarebazaarSamplesList.tlsh | String | Trend Micro Locality Sensitive Hash \(tlsh\). | 
| MalwareBazaar.MalwarebazaarSamplesList.telfhash | Unknown | Trend Micro ELF Hash \(telfhash\). | 
| MalwareBazaar.MalwarebazaarSamplesList.ssdeep | String | ssdeep. | 
| MalwareBazaar.MalwarebazaarSamplesList.dhash_icon | Unknown | In case the file is a PE executable: dhash of the samples icon. | 
| MalwareBazaar.MalwarebazaarSamplesList.tags | String | list of tags. | 
| MalwareBazaar.MalwarebazaarSamplesList.code_sign.subject_cn | String | Subject Common Name \(CN\). | 
| MalwareBazaar.MalwarebazaarSamplesList.code_sign.issuer_cn | String | Issuer Common Name \(CN\). | 
| MalwareBazaar.MalwarebazaarSamplesList.code_sign.algorithm | String | Algorithm used. | 
| MalwareBazaar.MalwarebazaarSamplesList.code_sign.valid_from | String | Datetime valid from. | 
| MalwareBazaar.MalwarebazaarSamplesList.code_sign.valid_to | String | Datetime valid to \(expire date\). | 
| MalwareBazaar.MalwarebazaarSamplesList.code_sign.serial_number | String | Serial number. | 
| MalwareBazaar.MalwarebazaarSamplesList.code_sign.cscb_listed | String | Code Signing Certificate Blocklist \(CSCB\) status \(True or False\). | 
| MalwareBazaar.MalwarebazaarSamplesList.code_sign.cscb_reason | String | Code Signing Certificate Blocklist \(CSCB\) listing reason. | 
| MalwareBazaar.MalwarebazaarSamplesList.intelligence.clamav | String | List of ClamAV detections \(offical and unofficial rules\). | 
| MalwareBazaar.MalwarebazaarSamplesList.intelligence.downloads | String | number \(int\) of downloads from MalwareBazaar. | 
| MalwareBazaar.MalwarebazaarSamplesList.intelligence.uploads | String | number \(int\) of uploads to MalwareBazaar. | 
| MalwareBazaar.MalwarebazaarSamplesList.intelligence.mail | Unknown | Mail intelligence using spamtrap data. | 


#### Command Example
```!malwarebazaar-samples-list sample_type=tag sample_value=TrickBot limit=2```

#### Context Example
```json
{
    "MalwareBazaar": {
        "MalwarebazaarSamplesList": [
            {
                "anonymous": 0,
                "code_sign": [],
                "dhash_icon": "71b119dcce576333",
                "file_name": "978fb9a64fb30f1fb07770c377d18a40.exe",
                "file_size": 450560,
                "file_type": "exe",
                "file_type_mime": "application/x-dosexec",
                "first_seen": "2021-10-09 06:39:03",
                "imphash": "f8cb6cf7a746c79f8c917be532cea46e",
                "intelligence": {
                    "clamav": [
                        "SecuriteInfo.com.Trojan.KillProc2.16767.28202.2196.UNOFFICIAL"
                    ],
                    "downloads": "304",
                    "mail": null,
                    "uploads": "2"
                },
                "last_seen": "2021-10-09 07:58:48",
                "md5_hash": "978fb9a64fb30f1fb07770c377d18a40",
                "reporter": "abuse_ch",
                "sha1_hash": "4608fe044c4d02ea260adb55b386f8cd1a5ea5e7",
                "sha256_hash": "8eac3ed65663a97d4eb125832d86ba9f6efc4e28b681b64253013d9e00d6659d",
                "sha3_384_hash": "3ab8cc96c8bdf05f1cff5535d0ed7c56bd9e0275ba1369a1d54e57fb2c6a17029cabe8ac79ce018ec8525c4204f3e3b5",
                "signature": "TrickBot",
                "ssdeep": "6144:oxcZrtODZGn9XI1c2Ykh2JmvYvWFuQX7tPbzHhzWEI8BmNbeIM625anGD:emIDZIkRYvWMQX5z0J8INqzkGD",
                "tags": [
                    "exe",
                    "lib161",
                    "TrickBot"
                ],
                "telfhash": null,
                "tlsh": "T11DA4D023F1F0C8F6C1A316710DB15BAE7676FC10CBB5DA9753805A2E1C7269689233A7"
            },
            {
                "anonymous": 0,
                "code_sign": [],
                "dhash_icon": "71b119dcce576333",
                "file_name": "864e1e300e32b0d2e40f145186719f36.exe",
                "file_size": 450560,
                "file_type": "exe",
                "file_type_mime": "application/x-dosexec",
                "first_seen": "2021-10-08 18:06:14",
                "imphash": "f8cb6cf7a746c79f8c917be532cea46e",
                "intelligence": {
                    "clamav": [
                        "SecuriteInfo.com.W32.AIDetect.malware2.21815.7403.UNOFFICIAL"
                    ],
                    "downloads": "407",
                    "mail": null,
                    "uploads": "2"
                },
                "last_seen": "2021-10-08 19:13:52",
                "md5_hash": "864e1e300e32b0d2e40f145186719f36",
                "reporter": "abuse_ch",
                "sha1_hash": "b78e1c74f4017166c5b673952e254600dae2f6d5",
                "sha256_hash": "7329669d8afc510a838f43ca91821e5b01c157fb397f1f347490b4e028bbf6eb",
                "sha3_384_hash": "0c69fbc95f717ff52290cb045a5385c8a59b4f1c3b12bdd41a6278198832a1064d5dc1565f0ffaddb89ccb66a94b894b",
                "signature": "TrickBot",
                "ssdeep": "6144:X9cZrtODhev9zIVchYkh2Kb//xHEZ0rmMTG9VVwF85HA5ke1W1DJSqFD:tmIDh1kB/xkOF0LNA5W1D5D",
                "tags": [
                    "exe",
                    "TrickBot"
                ],
                "telfhash": null,
                "tlsh": "T10BA4D033F1E4C8F6D1F712700EA65BA9B63AFC10CBB0EA5753805A5D1C76A858923367"
            }
        ]
    }
}
```

#### Human Readable Output

>### Sample List
>|Md5 Hash|File Name|File Type|File Size|Tags|First Seen|Last Seen|
>|---|---|---|---|---|---|---|
>| 978fb9a64fb30f1fb07770c377d18a40 | 978fb9a64fb30f1fb07770c377d18a40.exe | exe | 450560 | exe,<br/>lib161,<br/>TrickBot | 2021-10-09 06:39:03 | 2021-10-09 07:58:48 |
>| 864e1e300e32b0d2e40f145186719f36 | 864e1e300e32b0d2e40f145186719f36.exe | exe | 450560 | exe,<br/>TrickBot | 2021-10-08 18:06:14 | 2021-10-08 19:13:52 |

