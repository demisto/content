category: Data Enrichment & Threat Intelligence
commonfields:
  id: MalwareBazaar
  version: -1
configuration:
- defaultvalue: https://mb-api.abuse.ch/api/v1/
  display: Server URL
  name: url
  required: true
  type: 0
- additionalinfo: API key is required in order to comment a malware sample
  display: API Key
  name: api_key
  required: false
  type: 4
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
description: MalwareBazaar is a project from abuse.ch with the goal of sharing malware
  samples with the infosec community, AV vendors and threat intelligence providers.
display: MalwareBazaar
name: MalwareBazaar
script:
  commands:
  - arguments:
    - default: true
      description: list of SHA256, MD5 or SHA1 hash of the malware samples you want.
        to query
      isArray: false
      name: file
      required: true
      secret: false
    deprecated: false
    description: Check if a particular malware sample is known to MalwareBazaar.
    execution: false
    name: file
    outputs:
    - contextPath: MalwareBazaar.File.sha256_hash
      description: SHA256 hash of the malware sample.
      type: String
    - contextPath: MalwareBazaar.File.sha3_384_hash
      description: SHA3-384 hash of the malware sample.
      type: String
    - contextPath: MalwareBazaar.File.sha1_hash
      description: SHA1 hash of the malware sample.
      type: String
    - contextPath: MalwareBazaar.File.md5_hash
      description: MD5 hash of the malware sample.
      type: String
    - contextPath: MalwareBazaar.File.first_seen
      description: TS when the file has been first seen by MalwareBazaar (UTC).
      type: Date
    - contextPath: MalwareBazaar.File.last_seen
      description: TS when the file has been last seen by MalwareBazaar (UTC).
      type: Date
    - contextPath: MalwareBazaar.File.file_name
      description: Malware sample's file name.
      type: String
    - contextPath: MalwareBazaar.File.file_size
      description: File size in bytes.
      type: Number
    - contextPath: MalwareBazaar.File.file_type_mime
      description: MIME file type.
      type: String
    - contextPath: MalwareBazaar.File.file_type
      description: File type.
      type: String
    - contextPath: MalwareBazaar.File.reporter
      description: Twitter handle of the report (or anonymous for anonymous submissions).
      type: String
    - contextPath: MalwareBazaar.File.origin_country
      description: Two letter country code of the country where the sample was uploaded
        from.
      type: String
    - contextPath: MalwareBazaar.File.anonymous
      description: 1 (true) or 0 (false).
      type: Number
    - contextPath: MalwareBazaar.File.signature
      description: Malware family (if available).
      type: String
    - contextPath: MalwareBazaar.File.imphash
      description: imphash (only available for PE executables).
      type: String
    - contextPath: MalwareBazaar.File.tlsh
      description: Trend Micro Locality Sensitive Hash (tlsh).
      type: String
    - contextPath: MalwareBazaar.File.telfhash
      description: Trend Micro ELF Hash (telfhash).
      type: String
    - contextPath: MalwareBazaar.File.ssdeep
      description: ssdeep.
      type: String
    - contextPath: MalwareBazaar.File.dhash_icon
      description: 'In case the file is a PE executable: dhash of the samples icon.'
      type: Unknown
    - contextPath: MalwareBazaar.File.comment
      description: comment.
      type: String
    - contextPath: MalwareBazaar.File.tags
      description: list of tags.
      type: String
    - contextPath: MalwareBazaar.File.code_sign.subject_cn
      description: Subject Common Name (CN).
      type: String
    - contextPath: MalwareBazaar.File.code_sign.issuer_cn
      description: Issuer Common Name (CN).
      type: String
    - contextPath: MalwareBazaar.File.code_sign.algorithm
      description: Algorithm used.
      type: String
    - contextPath: MalwareBazaar.File.code_sign.valid_from
      description: Datetime valid from.
      type: Date
    - contextPath: MalwareBazaar.File.code_sign.valid_to
      description: Datetime valid to (expire date).
      type: Date
    - contextPath: MalwareBazaar.File.code_sign.serial_number
      description: Serial number.
      type: String
    - contextPath: MalwareBazaar.File.code_sign.cscb_listed
      description: Code Signing Certificate Blocklist (CSCB) status (True or False).
      type: String
    - contextPath: MalwareBazaar.File.code_sign.cscb_reason
      description: Code Signing Certificate Blocklist (CSCB) listing reason.
      type: String
    - contextPath: MalwareBazaar.File.delivery_method.email_attachment
      description: Distributed via e-mail attachment.
      type: Unknown
    - contextPath: MalwareBazaar.File.delivery_method.email_link
      description: Distributed via e-mail link.
      type: String
    - contextPath: MalwareBazaar.File.delivery_method.web_download
      description: Distributed via web download.
      type: Unknown
    - contextPath: MalwareBazaar.File.delivery_method.web_drive-by
      description: Distributed via drive-by.
      type: Unknown
    - contextPath: MalwareBazaar.File.delivery_method.multiple
      description: Multiple delivery methods used.
      type: Unknown
    - contextPath: MalwareBazaar.File.delivery_method.other
      description: Other delivery methods used.
      type: Unknown
    - contextPath: MalwareBazaar.File.file_information
      description: Contextual information about the file sample.
      type: Unknown
    - contextPath: MalwareBazaar.File.yara_rules.rule_name
      description: Name of the YARA rule that triggered.
      type: String
    - contextPath: MalwareBazaar.File.yara_rules.author
      description: Author of the YARA rule.
      type: String
    - contextPath: MalwareBazaar.File.yara_rules.description
      description: Description of the YARA rule.
      type: String
    - contextPath: MalwareBazaar.File.yara_rules.reference
      description: Reference of the YARA rule.
      type: Unknown
    - contextPath: MalwareBazaar.File.vendor_intel.ANY.RUN
      description: Dynamic malware analysis from ANY.RUN.
      type: Unknown
    - contextPath: MalwareBazaar.File.vendor_intel.CAPE
      description: Dynamic malware analysis from CAPE Sandbox.
      type: Unknown
    - contextPath: MalwareBazaar.File.vendor_intel.CERT-PL_MWDB
      description: Threat intel from CERT.PL Malware Database.
      type: Unknown
    - contextPath: MalwareBazaar.File.vendor_intel.vxCube
      description: Dynamic malware analysis from Dr.Web vxCube.
      type: Unknown
    - contextPath: MalwareBazaar.File.vendor_intel.DocGuard
      description: Office document reputation from DocGuad.
      type: Unknown
    - contextPath: MalwareBazaar.File.vendor_intel.FileScan-IO
      description: Malware analysis service from FileScan.IO.
      type: Unknown
    - contextPath: MalwareBazaar.File.vendor_intel.InQuest Labs
      description: File reputation service from InQuest Labs.
      type: Unknown
    - contextPath: MalwareBazaar.File.vendor_intel.Intezer
      description: Code analysis from Intezer.
      type: Unknown
    - contextPath: MalwareBazaar.File.vendor_intel.ReversingLabs
      description: File reputation & intelligence from ReversingLabs TitaniumCloud.
      type: Unknown
    - contextPath: MalwareBazaar.File.vendor_intel.Spamhaus_HBL
      description: File reputation from Spamhaus Hash Blocklist (HBL).
      type: Unknown
    - contextPath: MalwareBazaar.File.vendor_intel.Triage
      description: Dynamic malware analysis from Hatching Triage.
      type: Unknown
    - contextPath: MalwareBazaar.File.vendor_intel.UnpacMe
      description: Malware unpacking service from UnpacMe.
      type: Unknown
    - contextPath: MalwareBazaar.File.vendor_intel.VMRay
      description: Dynamic malware analysis from VMRay.
      type: Unknown
    - contextPath: MalwareBazaar.File.vendor_intel.YOROI_YOMI
      description: Dynamic malware analysis from YOROI YOMI.
      type: Unknown
    - contextPath: MalwareBazaar.File.comments.id
      description: Unique id that identifies this comment.
      type: String
    - contextPath: MalwareBazaar.File.comments.date_added
      description: Timestamp (UTC) when this comment has been made.
      type: Date
    - contextPath: MalwareBazaar.File.comments.twitter_handle
      description: Twitter handle who wrote this comment.
      type: String
    - contextPath: MalwareBazaar.File.comments.display_name
      description: Twitter display name.
      type: String
    - contextPath: MalwareBazaar.File.comments.comment
      description: The comment itself.
      type: String
  - arguments:
    - default: false
      description: SHA256 hash of the malware sample to download.
      isArray: false
      name: sha256_hash
      required: true
      secret: false
    deprecated: false
    description: Download malware samples from MalwareBazaar. Any malware sample downloaded
      from MalwareBazaar is zipped and password protected using the password "infected"
      (without "").
    execution: true
    name: malwarebazaar-download-sample
    outputs:
    - contextPath: File.Size
      description: The size of the file.
      type: String
    - contextPath: File.SHA1
      description: The SHA1 hash of the file.
      type: String
    - contextPath: File.SHA256
      description: The SHA256 hash of the file.
      type: String
    - contextPath: File.SHA512
      description: The SHA512 hash of the file.
      type: String
    - contextPath: File.Name
      description: The name of the file.
      type: String
    - contextPath: File.SSDeep
      description: The SSDeep hash of the file.
      type: String
    - contextPath: File.EntryID
      description: EntryID of the file
      type: String
    - contextPath: File.Info
      description: Information about the file.
      type: String
    - contextPath: File.Type
      description: The file type.
      type: String
    - contextPath: File.MD5
      description: The MD5 hash of the file.
      type: String
    - contextPath: File.Extension
      description: The extension of the file.
      type: String
  - arguments:
    - default: false
      description: SHA256 hash of the malware sample you want comment.
      isArray: false
      name: sha256_hash
      required: true
      secret: false
    - default: false
      description: Comment on the sample.
      isArray: false
      name: comment
      required: true
      secret: false
    deprecated: false
    description: Comment a malware sample.
    execution: false
    name: malwarebazaar-comment-add
    outputs:
    - contextPath: MalwareBazaar.MalwarebazaarCommentAdd.sha256_hash
      description: SHA256 hash of given file.
      type: String
    - contextPath: MalwareBazaar.MalwarebazaarCommentAdd.comment
      description: The comment that was added to the malware sample.
      type: String
  - arguments:
    - auto: PREDEFINED
      default: false
      description: Type of sample based on it the API will we queried.
      isArray: false
      name: sample_type
      predefined:
      - tag
      - signature
      - file_type
      - clamav
      - imphash
      - yara_rule
      - issuer_cn
      required: true
      secret: false
    - default: false
      description: Value of the sample selected.
      isArray: false
      name: sample_value
      required: true
      secret: false
    - default: false
      description: Max number of results is 1000. Be aware, when using issuer_cn,
        all relevant result will display (max 100).
      isArray: false
      name: limit
      required: false
      secret: false
    - default: false
      description: Page number you would like to view. Each page contains page_size
        values. Must be used along with page_size.
      isArray: false
      name: page
      required: false
      secret: false
    - default: false
      description: Number of results per page to display.
      isArray: false
      name: page_size
      required: false
      secret: false
    deprecated: false
    description: Retrieves a list of recent malware samples (max 1'000) associated
      with a specific sample type. Be aware, you can either use limit or page and
      page_size.
    execution: false
    name: malwarebazaar-samples-list
    outputs:
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.sha256_hash
      description: SHA256 hash of the malware sample.
      type: String
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.sha3_384_hash
      description: SHA3-384 hash of the malware sample.
      type: String
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.sha1_hash
      description: SHA1 hash of the malware sample.
      type: String
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.md5_hash
      description: MD5 hash of the malware sample.
      type: String
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.first_seen
      description: TS when the file has been first seen by MalwareBazaar (UTC).
      type: Date
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.last_seen
      description: TS when the file has been last seen by MalwareBazaar (UTC).
      type: Date
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.file_name
      description: Malware sample's file name.
      type: String
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.file_size
      description: File size in bytes.
      type: Number
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.file_type_mime
      description: MIME file type.
      type: String
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.file_type
      description: File type.
      type: String
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.reporter
      description: Twitter handle of the report (or anonymous for anonymous submissions).
      type: String
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.anonymous
      description: 1 (true) or 0 (false).
      type: Number
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.signature
      description: Malware family (if available).
      type: String
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.imphash
      description: imphash (only available for PE executables).
      type: String
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.tlsh
      description: Trend Micro Locality Sensitive Hash (tlsh).
      type: String
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.telfhash
      description: Trend Micro ELF Hash (telfhash).
      type: String
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.ssdeep
      description: ssdeep.
      type: String
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.dhash_icon
      description: 'In case the file is a PE executable: dhash of the samples icon.'
      type: Unknown
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.tags
      description: list of tags.
      type: String
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.code_sign.subject_cn
      description: Subject Common Name (CN).
      type: String
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.code_sign.issuer_cn
      description: Issuer Common Name (CN).
      type: String
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.code_sign.algorithm
      description: Algorithm used.
      type: String
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.code_sign.valid_from
      description: Datetime valid from.
      type: Date
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.code_sign.valid_to
      description: Datetime valid to (expire date).
      type: Date
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.code_sign.serial_number
      description: Serial number.
      type: String
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.code_sign.cscb_listed
      description: Code Signing Certificate Blocklist (CSCB) status (True or False).
      type: String
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.code_sign.cscb_reason
      description: Code Signing Certificate Blocklist (CSCB) listing reason.
      type: String
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.intelligence.clamav
      description: List of ClamAV detections (offical and unofficial rules).
      type: String
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.intelligence.downloads
      description: number (int) of downloads from MalwareBazaar.
      type: Number
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.intelligence.uploads
      description: number (int) of uploads to MalwareBazaar.
      type: Number
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.intelligence.mail
      description: Mail intelligence using spamtrap data.
      type: String
  dockerimage: demisto/python3:3.9.7.24076
  feed: false
  isfetch: false
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  subtype: python3
  type: python
tests:
- MalwareBazaar_Test
fromversion: 6.0.0
