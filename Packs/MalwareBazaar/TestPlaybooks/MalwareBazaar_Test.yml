id: MalwareBazaar_Test
version: -1
contentitemexportablefields:
  contentitemfields: {}
name: MalwareBazaar_Test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 871b99ec-dd31-4767-8dbe-1929d46af813
    type: start
    task:
      id: 871b99ec-dd31-4767-8dbe-1929d46af813
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: e8db87d1-a35f-46c9-b7f4-2ca15b18576b
    type: regular
    task:
      id: e8db87d1-a35f-46c9-b7f4-2ca15b18576b
      version: -1
      name: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 200
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: d70b4f62-0c95-4c98-8bad-dc25beaf6f94
    type: regular
    task:
      id: d70b4f62-0c95-4c98-8bad-dc25beaf6f94
      version: -1
      name: file
      script: MalwareBazaar|||file
      type: regular
      iscommand: true
      brand: MalwareBazaar
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      file:
        simple: 094fd325049b8a9cf6d3e5ef2a6d4cc6a567d7d49c35f8bb8dd9e3c6acf3d78d
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 68300663-d525-4e80-8621-d0e229fd648c
    type: condition
    task:
      id: 68300663-d525-4e80-8621-d0e229fd648c
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "4"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MalwareBazaar.File.md5_hash
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MalwareBazaar.File.file_name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MalwareBazaar.File.file_size
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MalwareBazaar.File.file_type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MalwareBazaar.File.tags
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 600
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: a8f93917-d5d3-4dcb-8d5a-056c1b45ad05
    type: regular
    task:
      id: a8f93917-d5d3-4dcb-8d5a-056c1b45ad05
      version: -1
      name: malwarebazaar-download-sample
      script: MalwareBazaar|||malwarebazaar-download-sample
      type: regular
      iscommand: true
      brand: MalwareBazaar
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      sha256_hash:
        simple: 094fd325049b8a9cf6d3e5ef2a6d4cc6a567d7d49c35f8bb8dd9e3c6acf3d78d
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 800
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: b6035a1b-9e31-4d96-8f58-69c90788a71a
    type: condition
    task:
      id: b6035a1b-9e31-4d96-8f58-69c90788a71a
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "6"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: File.Size
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: File.SHA1
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: File.SHA256
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: File.Name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: File.EntryID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: File.Info
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: File.Type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: File.MD5
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: File.Extension
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1000
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: f9e869b7-53b6-4d47-80f3-31a2e27323bd
    type: regular
    task:
      id: f9e869b7-53b6-4d47-80f3-31a2e27323bd
      version: -1
      name: malwarebazaar-comment-add
      script: MalwareBazaar|||malwarebazaar-comment-add
      type: regular
      iscommand: true
      brand: MalwareBazaar
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      comment:
        simple: test
      sha256_hash:
        simple: 094fd325049b8a9cf6d3e5ef2a6d4cc6a567d7d49c35f8bb8dd9e3c6acf3d78d
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1200
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: 8fa06ce3-8227-4615-81e3-e816e3cb1781
    type: condition
    task:
      id: 8fa06ce3-8227-4615-81e3-e816e3cb1781
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "8"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MalwareBazaar.MalwarebazaarCommentAdd.comment
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 03716014-5f0c-40fc-8ac8-592dde7b78b0
    type: regular
    task:
      id: 03716014-5f0c-40fc-8ac8-592dde7b78b0
      version: -1
      name: malwarebazaar-samples-list
      script: MalwareBazaar|||malwarebazaar-samples-list
      type: regular
      iscommand: true
      brand: MalwareBazaar
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      limit:
        simple: "2"
      sample_type:
        simple: tag
      sample_value:
        simple: TrickBot
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1600
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: f4b02952-b5a2-458b-8a43-55e0e574f95d
    type: condition
    task:
      id: f4b02952-b5a2-458b-8a43-55e0e574f95d
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "11"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MalwareBazaar.MalwarebazaarSamplesList.md5_hash
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MalwareBazaar.MalwarebazaarSamplesList.file_name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MalwareBazaar.MalwarebazaarSamplesList.file_size
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MalwareBazaar.MalwarebazaarSamplesList.file_type
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1800
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: a178c8a4-2062-4e99-b73e-ff4cc3c7841a
    type: title
    task:
      id: a178c8a4-2062-4e99-b73e-ff4cc3c7841a
      version: -1
      name: Test Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4340
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 445f7f49-92cb-4d3f-805b-096519738a13
    type: regular
    task:
      id: 445f7f49-92cb-4d3f-805b-096519738a13
      version: -1
      name: malwarebazaar-samples-list
      script: MalwareBazaar|||malwarebazaar-samples-list
      type: regular
      iscommand: true
      brand: MalwareBazaar
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      limit:
        simple: "2"
      sample_type:
        simple: signature
      sample_value:
        simple: TrickBot
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2000
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: 4bd78019-8f13-4ca9-85d5-081037c0da24
    type: condition
    task:
      id: 4bd78019-8f13-4ca9-85d5-081037c0da24
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "13"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MalwareBazaar.MalwarebazaarSamplesList.md5_hash
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MalwareBazaar.MalwarebazaarSamplesList.file_name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MalwareBazaar.MalwarebazaarSamplesList.file_size
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MalwareBazaar.MalwarebazaarSamplesList.file_type
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: a5b1126a-b6a2-4aa2-8ba6-eb074c341d94
    type: regular
    task:
      id: a5b1126a-b6a2-4aa2-8ba6-eb074c341d94
      version: -1
      name: malwarebazaar-samples-list
      script: MalwareBazaar|||malwarebazaar-samples-list
      type: regular
      iscommand: true
      brand: MalwareBazaar
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      limit:
        simple: "2"
      sample_type:
        simple: file_type
      sample_value:
        simple: elf
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 7a3f27b8-f33f-468b-81d1-bf7e83786fed
    type: condition
    task:
      id: 7a3f27b8-f33f-468b-81d1-bf7e83786fed
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "15"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MalwareBazaar.MalwarebazaarSamplesList.md5_hash
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MalwareBazaar.MalwarebazaarSamplesList.file_name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MalwareBazaar.MalwarebazaarSamplesList.file_size
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MalwareBazaar.MalwarebazaarSamplesList.file_type
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 1dd2e094-2f3d-4f49-85b6-b8a05b07c8ef
    type: regular
    task:
      id: 1dd2e094-2f3d-4f49-85b6-b8a05b07c8ef
      version: -1
      name: malwarebazaar-samples-list
      script: MalwareBazaar|||malwarebazaar-samples-list
      type: regular
      iscommand: true
      brand: MalwareBazaar
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      limit:
        simple: "2"
      sample_type:
        simple: clamav
      sample_value:
        simple: Doc.Downloader.Emotet-7580152-0
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2760
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: fbe8dcb1-5bb9-42cf-8238-c04dabef7e63
    type: condition
    task:
      id: fbe8dcb1-5bb9-42cf-8238-c04dabef7e63
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "17"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MalwareBazaar.MalwarebazaarSamplesList.md5_hash
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MalwareBazaar.MalwarebazaarSamplesList.file_name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MalwareBazaar.MalwarebazaarSamplesList.file_size
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MalwareBazaar.MalwarebazaarSamplesList.file_type
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: fe5e2dc2-d5c1-4e75-8fe6-10594a07fe9c
    type: regular
    task:
      id: fe5e2dc2-d5c1-4e75-8fe6-10594a07fe9c
      version: -1
      name: malwarebazaar-samples-list
      script: MalwareBazaar|||malwarebazaar-samples-list
      type: regular
      iscommand: true
      brand: MalwareBazaar
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      limit:
        simple: "2"
      sample_type:
        simple: imphash
      sample_value:
        simple: 45d579faec0eaf279c0841b2233727cf
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3160
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: eca670cc-3e60-47dd-8bad-4208f122f09a
    type: condition
    task:
      id: eca670cc-3e60-47dd-8bad-4208f122f09a
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "19"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MalwareBazaar.MalwarebazaarSamplesList.md5_hash
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MalwareBazaar.MalwarebazaarSamplesList.file_name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MalwareBazaar.MalwarebazaarSamplesList.file_size
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MalwareBazaar.MalwarebazaarSamplesList.file_type
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3360
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: 0fe84b88-b95a-4167-8085-7b28eeda8b2d
    type: regular
    task:
      id: 0fe84b88-b95a-4167-8085-7b28eeda8b2d
      version: -1
      name: malwarebazaar-samples-list
      script: MalwareBazaar|||malwarebazaar-samples-list
      type: regular
      iscommand: true
      brand: MalwareBazaar
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      limit:
        simple: "2"
      sample_type:
        simple: yara_rule
      sample_value:
        simple: win_remcos_g0
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: d277e675-9517-4199-8844-ab7ce16b7f9f
    type: condition
    task:
      id: d277e675-9517-4199-8844-ab7ce16b7f9f
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "21"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MalwareBazaar.MalwarebazaarSamplesList.md5_hash
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MalwareBazaar.MalwarebazaarSamplesList.file_name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MalwareBazaar.MalwarebazaarSamplesList.file_size
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MalwareBazaar.MalwarebazaarSamplesList.file_type
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: eb389dd4-28c5-44c6-8305-403887e6f053
    type: regular
    task:
      id: eb389dd4-28c5-44c6-8305-403887e6f053
      version: -1
      name: malwarebazaar-samples-list
      script: MalwareBazaar|||malwarebazaar-samples-list
      type: regular
      iscommand: true
      brand: MalwareBazaar
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      limit:
        simple: "2"
      sample_type:
        simple: issuer_cn
      sample_value:
        simple: Sectigo RSA Code Signing CA
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3940
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: ae350276-4ba2-47d6-8ee7-0e7540ec6154
    type: condition
    task:
      id: ae350276-4ba2-47d6-8ee7-0e7540ec6154
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "10"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MalwareBazaar.MalwarebazaarSamplesList.md5_hash
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MalwareBazaar.MalwarebazaarSamplesList.file_name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MalwareBazaar.MalwarebazaarSamplesList.file_size
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MalwareBazaar.MalwarebazaarSamplesList.file_type
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
system: true
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 4355,
        "width": 380,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
fromversion: 6.0.0
description: Test playook for MalwareBazaar integration. All commands are tested in
  this playbook, including all possible inputs for malwarebazaar_samples_list_command
