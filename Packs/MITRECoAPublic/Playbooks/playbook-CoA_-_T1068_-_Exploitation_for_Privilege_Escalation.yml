description: "This playbook Remediates the Exploitation for Privilege Escalation technique using intelligence-driven Courses of Action (COA) defined by Palo Alto Networks Unit 42 team.\n \n***Disclaimer: This playbook does not simulate an attack using the specified technique, but follows the steps to remediation as defined by Palo Alto Networks Unit 42 team’s Actionable Threat Objects and Mitigations (ATOMs).\nTechniques Handled:\n- T1068: Exploitation for Privilege Escalation\n\nKill Chain phases:\n- Privilege Escalation\n\nMITRE ATT&CK Description:\nAdversaries may exploit software vulnerabilities in an attempt to collect elevate privileges. Exploitation of a software vulnerability occurs when an adversary takes advantage of a programming error in a program, service, or within the operating system software or kernel itself to execute adversary-controlled code. Security constructs such as permission levels will often hinder access to information and use of certain techniques, so adversaries will likely need to perform privilege escalation to include use of software exploitation to circumvent those restrictions.\n\nWhen initially gaining access to a system, an adversary may be operating within a lower privileged process which will prevent them from accessing certain resources on the system. Vulnerabilities may exist, usually in operating system components and software commonly running at higher permissions, that can be exploited to gain higher levels of access on the system. This could enable someone to move from unprivileged or user level permissions to SYSTEM or root permissions depending on the component that is vulnerable. This may be a necessary step for an adversary compromising a endpoint system that has been properly configured and limits other privilege escalation methods.\n\nPossible playbook uses:\n- The playbook can be used independently to handle and remediate the specific technique.\n- The playbook can be used as a part of the “Courses of Action - Defense Evasion” playbook to remediate techniques based on the kill chain phase.\n- The playbook can be used as a part of the “MITRE ATT&CK - Courses of Action” playbook, which can be triggered by different sources and accepts the technique MITRE ATT&CK ID as an input.\n"
id: MITRE ATT&CK CoA - T1068 - Exploitation for Privilege Escalation
inputs: []
name: MITRE ATT&CK CoA - T1068 - Exploitation for Privilege Escalation
outputs:
- contextPath: Handled.Techniques
  description: The techniques handled in this playbook
  type: unknown
starttaskid: "0"
tasks:
  "0":
    id: "0"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fb769129-08cd-4e34-8bbb-2854e0c0111a
      iscommand: false
      name: ""
      version: -1
      description: ''
    taskid: fb769129-08cd-4e34-8bbb-2854e0c0111a
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 50,
          "y": -230
        }
      }
  "1":
    id: "1"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Manual - Enable XDR Anti-Exploit and Anti-Malware Protection.
      id: 002793ea-0107-4461-87dc-33042e9b0f68
      iscommand: false
      name: Manual - Enable XDR Anti-Exploit and Anti-Malware Protection
      type: regular
      version: -1
    taskid: 002793ea-0107-4461-87dc-33042e9b0f68
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 275
        }
      }
  "2":
    id: "2"
    ignoreworker: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 295723b4-b8b9-4ef4-8b46-d6d3321343c6
      iscommand: false
      name: Done
      type: title
      version: -1
      description: ''
    taskid: 295723b4-b8b9-4ef4-8b46-d6d3321343c6
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 50,
          "y": 845
        }
      }
  "3":
    id: "3"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Handled.Techniques
      stringify: {}
      value:
        simple: T1068
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 19575e60-c675-4c75-8613-3396ae43b853
      iscommand: false
      name: Set technique handled
      script: Set
      type: regular
      version: -1
    taskid: 19575e60-c675-4c75-8613-3396ae43b853
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 470
        }
      }
  "4":
    id: "4"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "1"
    note: false
    quietmode: 0
    scriptarguments:
      brandname:
        simple: Cortex XDR - IR
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns 'yes' if integration brand is available. Otherwise returns 'no'
      id: 158790c5-a893-4bd6-8ef5-9972296bed9f
      iscommand: false
      name: Is Cortex XDR integration Enabled?
      script: IsIntegrationAvailable
      type: condition
      version: -1
    taskid: 158790c5-a893-4bd6-8ef5-9972296bed9f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 50,
          "y": -70
        }
      }
  "5":
    id: "5"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |
        Enable the Cortex XDR integration to follow this CoA.

        If needed - please contact your Palo Alto Networks account manager for future guidance and assistance.
      id: 9f1a216f-033d-43cf-8fea-920644764149
      iscommand: false
      name: Manual - Enable Cortex XDR integration
      type: regular
      version: -1
    taskid: 9f1a216f-033d-43cf-8fea-920644764149
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 420,
          "y": 100
        }
      }
  "6":
    continueonerror: true
    id: "6"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      columns:
        simple: technique
      context_path:
        simple: Handled.Techniques
      grid_id:
        simple: handledtechniques
      keys: {}
      overwrite: {}
      sort_by: {}
      unpack_nested_elements: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Creates a Grid table from items or key-value pairs.
      id: 536cf3ac-e52b-4c74-865f-a346ed1aa777
      iscommand: false
      name: Set grid field
      script: SetGridField
      type: regular
      version: -1
    taskid: 536cf3ac-e52b-4c74-865f-a346ed1aa777
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 660
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1140,
        "width": 750,
        "x": 50,
        "y": -230
      }
    }
  }
tests:
- No tests (auto formatted)
fromversion: 6.5.0
