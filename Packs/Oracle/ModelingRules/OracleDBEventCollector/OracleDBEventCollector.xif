[MODEL: dataset=filestream_filestream_raw, model=Audit]
filter json_extract_scalar(_raw_log, "$.ACTION_NAME") in ("AUDIT OBJECT", "NOAUDIT OBJECT", "CREATE USER", "CREATE ROLE", "DROP USER", "DROP ROLE", "SET ROLE", "SESSION REC", "SYSTEM AUDIT", "SYSTEM NOAUDIT", "AUDIT DEFAULT", "NOAUDIT DEFAULT", "SYSTEM GRANT", "SYSTEM REVOKE", "GRANT ROLE", "REVOKE ROLE")
| alter XDM.Audit.TriggeredBy.identity.name = json_extract_scalar(_raw_log, "$.OS_USERNAME"),
XDM.Audit.event_timestamp = parse_timestamp("%Y-%m-%d %H:%M:%S", json_extract(_raw_log, "$.EVENT_TIMESTAMP")),
XDM.Audit.operation_type = json_extract_scalar(_raw_log, "$.ACTION_NAME"),
XDM.Audit.reason = json_extract_scalar(_raw_log, "$.SQL_TEXT");

[MODEL: dataset=oracle_db_raw, model=Auth]
filter json_extract_scalar(_raw_log, "$.ACTION_NAME") in ("ALTER SESSION","ALTER USER","LOGON","LOGOFF","LOGOFF BY CLEANUP")
| alter XDM.Auth.session_id = json_extract_scalar(_raw_log, "$.SESSIONID"),
XDM.Auth.Client.user.username = json_extract_scalar(_raw_log, "$.OS_USERNAME"),
XDM.Auth.ntlm.rsp_hostname = json_extract_scalar(_raw_log, "$.USERHOST"),
XDM.Auth.logon.type = json_extract_scalar(_raw_log, "$.AUTHENTICATION_TYPE"),
XDM.Auth.Client.application.name = json_extract_scalar(_raw_log, "$.CLIENT_PROGRAM_NAME"),
XDM.Auth.event_timestamp = parse_timestamp("%Y-%m-%d %H:%M:%S", json_extract(_raw_log, "$.EVENT_TIMESTAMP")),
XDM.Auth.reason = json_extract_scalar(_raw_log, "$.ACTION_NAME");

[MODEL: dataset=oracle_db_raw, model=Database]
filter json_extract_scalar(_raw_log, "$.ACTION_NAME") in ("CREATE TABLE","INSERT","SELECT","CREATE CLUSTER","ALTER CLUSTER","UPDATE","DELETE","DROP CLUSTER","CREATE INDEX","DROP INDEX","ALTER INDEX","DROP TABLE","CREATE SEQUENCE","ALTER SEQUENCE","ALTER TABLE","DROP SEQUENCE","GRANT OBJECT","REVOKE OBJECT","CREATE SYNONYM","DROP SYNONYM","CREATE VIEW","DROP VIEW","VALIDATE INDEX","CREATE PROCEDURE","ALTER PROCEDURE","LOCK","NO-OP","RENAME","COMMENT","CREATE DATABASE LINK","DROP DATABASE LINK","CREATE DATABASE","ALTER DATABASE","CREATE ROLLBACK SEG","ALTER ROLLBACK SEG","DROP ROLLBACK SEG","CREATE TABLESPACE","ALTER TABLESPACE","DROP TABLESPACE","COMMIT","ROLLBACK","SAVEPOINT","PL/SQL EXECUTE","SET TRANSACTION","ALTER SYSTEM","EXPLAIN","CREATE SCHEMA","CREATE CONTROL FILE","CREATE TRIGGER","ALTER TRIGGER","DROP TRIGGER","ANALYZE TABLE","ANALYZE INDEX","ANALYZE CLUSTER","CREATE PROFILE","DROP PROFILE","ALTER PROFILE","DROP PROCEDURE","ALTER RESOURCE COST","CREATE MATERIALIZED VIEW LOG","ALTER MATERIALIZED VIEW LOG","DROP MATERIALIZED VIEW LOG","CREATE MATERIALIZED VIEW","ALTER MATERIALIZED VIEW","DROP MATERIALIZED VIEW","CREATE TYPE","DROP TYPE","ALTER ROLE","ALTER TYPE","CREATE TYPE BODY","ALTER TYPE BODY","DROP TYPE BODY","DROP LIBRARY","TRUNCATE TABLE","TRUNCATE CLUSTER","CREATE FUNCTION","ALTER FUNCTION","DROP FUNCTION","CREATE PACKAGE","ALTER PACKAGE","DROP PACKAGE","CREATE PACKAGE BODY","ALTER PACKAGE BODY","DROP PACKAGE BODY","CREATE PUBLIC SYNONYM","DROP PUBLIC SYNONYM","CREATE PUBLIC DATABASE LINK","DROP PUBLIC DATABASE LINK","EXECUTE PROCEDURE","USER COMMENT","ENABLE TRIGGER","DISABLE TRIGGER","ENABLE ALL TRIGGERS","DISABLE ALL TRIGGERS","NETWORK ERROR","EXECUTE TYPE","CREATE DIRECTORY","DROP DIRECTORY","CREATE LIBRARY","CREATE JAVA","ALTER JAVA","DROP JAVA","CREATE OPERATOR","CREATE INDEXTYPE","DROP INDEXTYPE","DROP OPERATOR","ASSOCIATE STATISTICS","DISASSOCIATE STATISTICS","CALL METHOD","CREATE SUMMARY","ALTER SUMMARY","DROP SUMMARY","CREATE DIMENSION","ALTER DIMENSION","DROP DIMENSION","CREATE CONTEXT","DROP CONTEXT","ALTER OUTLINE","CREATE OUTLINE","DROP OUTLINE","UPDATE INDEXES","ALTER OPERATOR")
| alter XDM.Database.connection_id = json_extract_scalar(_raw_log, "$.SESSIONID"),
XDM.Database.Client.user.username = json_extract_scalar(_raw_log, "$.OS_USERNAME"),
XDM.Database.event_timestamp = parse_timestamp("%Y-%m-%d %H:%M:%S", json_extract(_raw_log, "$.EVENT_TIMESTAMP")),
XDM.Database.operation = json_extract_scalar(_raw_log, "$.ACTION_NAME"),
XDM.Database.statement = json_extract_scalar(_raw_log, "$.SQL_TEXT");
