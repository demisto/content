commonfields:
  id: CreateAppsecRule
  version: -1
name: CreateAppsecRule
display: CAS - Create Appsec Rule 
description: Creates a new Application Security rule in Cortex Platform. An AppSec rule defines the specific criteria and scanners used to detect vulnerabilities or misconfigurations across your application lifecycle.
category: Utilities
requiresuserapproval: false
marketplaces:
  - platform
supportedModules:
  - agentix
  - xsiam
  - cloud_posture
tags:
  - Appsec
  - Rules
args:
- name: rule_name
  underlyingargname: rule_name
  description: >
    A unique name for the AppSec rule following the organization's naming conventions.
  type: string
  required: true
- name: description
  underlyingargname: description
  description: >
    A descriptive summary of the rule's objective and expected outcomes.
  type: string
  required: false
- name: labels
  underlyingargname: labels
  description: >
    A comma-separated list of rule labels to apply the rule to.
  type: string
  required: false
- name: severity
  underlyingargname: severity
  description: >
    Filter findings based on their severity level.
    Options: CRITICAL, HIGH, MEDIUM, LOW.
  type: string
  required: true
- name: scanner
  underlyingargname: scanner
  description: >
    The type of security scanner used to detect findings of this rule. 
    Options: SECRETS, IAC.
  type: string
  required: true
- name: category
  underlyingargname: category
  description: >
    Custom rule secret category
    Options: API_KEYS, DATABASE_CREDENTIALS, ENCRYPTION_KEYS, CLOUD_SERVICE_PROVIDER_KEYS, SSH_KEYS, ENVIRONMENT_VARIABLES, SENSITIVE_TOKENS, THIRD_PARTY_SERVICES.
  type: string
  required: true
- name: frameworks
  underlyingargname: frameworks
  description: >
    list of {name:string,definition:string} fot the rule
  isArray: true
outputs:
- name: rule_name
  underlyingargname: rule_name
  description: >
    A unique name for the AppSec rule following the organization's naming conventions.
  type: string
  required: true
- name: description
  underlyingargname: description
  description: >
    A descriptive summary of the rule's objective and expected outcomes.
  type: string
  required: false
- name: labels
  underlyingargname: labels
  description: >
    A comma-separated list of rule labels to apply the rule to.
  type: string
  required: false
- name: severity
  underlyingargname: severity
  description: >
    Filter findings based on their severity level.
    Options: CRITICAL, HIGH, MEDIUM, LOW.
  type: string
  required: true
- name: scanner
  underlyingargname: scanner
  description: >
    The type of security scanner used to detect findings of this rule. 
    Options: SECRETS.
  type: string
  required: true
- name: category
  underlyingargname: category
  description: >
    Custom rule secret category
    Options: API_KEYS, DATABASE_CREDENTIALS, ENCRYPTION_KEYS, CLOUD_SERVICE_PROVIDER_KEYS, SSH_KEYS, ENVIRONMENT_VARIABLES, SENSITIVE_TOKENS, THIRD_PARTY_SERVICES.
  type: string
  required: true
- name: frameworks
  underlyingargname: frameworks
  description: >
    list of {name:string,definition:string} fot the rule
  isArray: true
underlyingcontentitem:
  id: CreateAppsecRule
  name: CreateAppsecRule
  type: script
  version: -1
  command: ""