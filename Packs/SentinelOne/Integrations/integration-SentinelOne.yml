commonfields:
  id: SentinelOne
  version: -1
name: SentinelOne
display: SentinelOne
fromversion: 5.0.0
category: Endpoint
image: data:image/png;base64,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
description: End point protection
configuration:
- display: Server URL (e.g. https://192.168.0.1)
  name: url
  defaultvalue: ""
  type: 0
  required: true
- display: Username
  name: credentials
  defaultvalue: ""
  type: 9
  required: false
- display: API Version
  name: version
  defaultvalue: "2.0"
  type: 0
  required: false
- display: Token
  name: token
  defaultvalue: ""
  type: 4
  required: false
- display: Trust any certificate (not secure)
  name: insecure
  type: 8
  required: false
script:
  script: >-
    var SentinelOne = function() {
        var builder = (function() {
            var buildURL = function(urlTemplate, urlArgs) {
                //params.url = params.url.replace(/[\/]+$/, '');
                return replaceInTemplates(urlTemplate, urlArgs);
            };
            var createQueryString = function(queryArgs) {
                return encodeToURLQuery(queryArgs);
            };
            var buildRequestBody = function(bodyArgs) {
                return JSON.stringify(bodyArgs);
            };
            var buildPATH = function(pathTemlate, pathArgs) {
                return replaceInTemplatesAndRemove(pathTemlate, pathArgs);
            };
            return {
                url: buildURL,
                body: buildRequestBody,
                path: buildPATH,
                queryString: createQueryString
            };
        })();

        var group_translator = [
            {to: 'Id' , from: 'id'},
            {to: 'Name', from: 'name'},
            {to: 'PolicyId', from: 'policy_id'},
            {to: 'FilterId', from: 'filter_id'},
            {to: 'UserId', from: 'user_id'},
            {to: 'IsDefault', from: 'is_default'},
            {to: 'CreatedAt', from: 'meta_data.created_at'},
            {to: 'UpdatedAt', from: 'meta_data.created_at'},
            {to: 'Source', from: 'source'},
            {to: 'AdQuery', from: 'ad_query'}
        ];

        var hash_translator = [
            {to: 'Id', from: 'id'},
            {to: 'OsFamily', from: 'os_family'},
            {to: 'IsBlack', from: 'is_black'},
            {to: 'Description', from: 'description'},
            {to: 'UpdatedAt', from: 'updated_at'},
            {to: 'CreatedAt', from: 'created_at'},
            {to: 'UserId', from: 'user_id'},
            {to: 'FromCloud', from:'from_cloud'},
            {to: 'FromImmune', from: 'from_immune'}
        ];

        var exclusion_list_translator = [
            {to: 'Id', from: 'id'},
            {to: 'Name', from: 'name'},
            {to: 'CreatedAt', from: 'meta_data.created_at'},
            {to: 'UpdatedAt', from: 'meta_data.updated_at'},
        ];

        var threat_translator = [
            {to: 'Id' , from: 'id'},
            {to: 'Agent', from: 'agent'},
            {to: 'AgentVersion', from: 'agent_version'},
            {to: 'CreatedDate', from: 'created_date'},
            {to: 'Description', from: 'description'},
            {to: 'SilentThreat', from: 'silent_Threat'},
            {to: 'InQuarantine', from: 'in_quarantine'},
            {to: 'InLearningMode', from: 'in_learning_mode'},
            {to: 'Resolved', from: 'resolved'},
            {to: 'Hidden', from: 'hidden'},
            {to: 'Suspicious', from: 'suspicious'},
            {to: 'LearningMode', from: 'learning_mode'},
            {to: 'MitigationActions', from: 'mitigation_actions'},
            {to: 'MitigationResults', from: 'mitigation_results'},
            {to: 'KillStatus', from: 'mitigation_report.kill.status'},
            {to: 'QuarantineStatus', from: 'mitigation_report.quarantine.status'},
            {to: 'RemediateStatus', from: 'mitigation_report.remediate.status'},
            {to: 'RollbackStatus', from: 'mitigation_report.rollback.status'},
            {to: 'NetworkQuarantineStatus', from: 'mitigation_report.network_quarantine.status'},
            {to: 'AffectedFiles', from: 'affected_files'},
            {to: 'MaliciousGroupId', from: 'malicious_group_id'},
            {to: 'FileId', from: 'file_id.object_id'},
            {to: 'FilePermission', from: 'file_id.permission'},
            {to: 'FilePath', from: 'file_id.path'},
            {to: 'FileContentHash', from: 'file_id.content_hash'},
            {to: 'FileSize', from: 'file_id.size'},
            {to: 'IsSystemFile', from: 'file_id.is_system'},
            {to: 'FileName', from: 'file_id.display_name'},
            {to: 'CreatedAt', from: 'meta_data.created_at'},
            {to: 'UpdatedAt', from: 'meta_data.updated_at'}
        ];

        var activities_translator = [
            {to: 'CreatedAt', from: 'meta_data.created_at'},
            {to: 'OsFamily', from: 'os_family'},
            {to: 'User', from: 'user'},
            {to: 'UserId', from: 'user_id'},
            {to: 'Group', from: 'group'},
            {to: 'Id', from: 'id'},
            {to: 'MitigationPolicyCommand', from: 'mitigation_policy_command'},
            {to: 'AgentId', from: 'agent_id'},
            {to: 'Hash', from: 'hash'},
            {to: 'Description', from: 'description'},
            {to: 'ThreatId', from: 'threat_id'},
            {to: 'ActivityType', from: 'activity_type'}
        ];

        var agent_translator = [
            {to: 'NetworkStatus', from: 'network_status'},
            {to: 'Id', from: 'id'},
            {to: 'GroupId', from: 'group_id'},
            {to: 'AgentVersion', from: 'agent_version'},
            {to: 'IsPendingUninstall', from: 'is_pending_uninstall'},
            {to: 'IsUninstalled', from: 'is_uninstalled'},
            {to: 'IsDecomissioned', from: 'is_decommissioned'},
            {to: 'IsActive', from: 'is_active'},
            {to: 'LastActiveDate', from: 'last_active_date'},
            {to: 'RegisteredAt', from: 'registered_at'},
            {to: 'Uuid', from: 'uuid'},
            {to: 'ExternalIp', from: 'external_ip'},
            {to: 'GroupIp', from: 'group_ip'},
            {to: 'IsUpToDate', from: 'is_up_to_date'},
            {to: 'ThreatCount', from: 'threat_count'},
            {to: 'EncryptedApplications', from: 'encrypted_applications'},
            {to: 'OsName', from: 'software_information.os_name'},
            {to: 'ComputerName', from: 'network_information.computer_name'},
            {to: 'Domain', from: 'network_information.domain'},
            {to: 'Interfaces', from: 'network_information.interfaces'},
            {to: 'Configuration', from: 'configuration'},
            {to: 'CreatedAt', from: 'meta_data.created_at'},
            {to: 'UpdatedAt', from: 'meta_data.updated_at'}
        ];

        var commands = {
            'so-activities': {
                path: "activities",
                method: 'GET',
                extended: true,
                title: 'Sentinel One Activities',
                contextPath: 'SentinelOne.Activities(obj.Id==val.Id)',
                translator: activities_translator
            },
            //Agent
            'so-count-by-filters': {
                path: "agents/count-by-filters",
                method: 'GET'
            },
            'so-agents-count': {
                path: "agents/count",
                method: 'GET'
            },
            'so-agent-decommission': {
                path: "agents/%agent_id%/decommission",
                method: 'POST'
            },
            'so-get-agent': {
                path: "agents/%agent_id%",
                method: 'GET',
                extended: true,
                title: 'Sentinel One Agent',
                contextPath: 'SentinelOne.Agents(obj.Id==val.Id)',
                translator: agent_translator
                },
            'so-agents-query': {
                path: "agents",
                method: 'GET',
                extended: true,
                title: 'Sentinel One Agents',
                contextPath: 'SentinelOne.Agents(obj.Id==val.Id)',
                translator: agent_translator
            },
            'so-get-agent-processes': {
                path: "agents/%agent_id%/processes",
                method: 'GET'
            },
            'so-agent-recommission': {
                path: "agents/%agent_id%/recommission",
                method: 'POST'
            },
            'so-agent-unquarentine': {
                path: "agents/%agent_id%/connect",
                method: 'POST'
            },
            'so-agent-shutdown': {
                path: "agents/%agent_id%/shutdown",
                method:'POST'
            },
            'so-agent-uninstall': {
                path: "agents/%agent_id%/uninstall",
                method: 'POST'
            },
            //Agents action
            'so-agents-broadcast': {
                path: "agents/broadcast",
                method: 'POST'
            },
            'so-agents-connect': {
                path: "agents/connect",
                method: 'POST'
            },
            'so-agents-decommission': {
                path: "agents/decommission",
                method:'POST'
            },
            'so-agents-disconnect': {
                path: "agents/disconnect",
                method: 'POST'
            },
            'so-agents-fetch-logs': {
                path: "agents/fetch-logs",
                method: 'POST'
            },
            'so-agents-shutdown': {
                path: "agents/shutdown",
                method:'POST'
            },
            'so-agents-uninstall': {
                path: "agents/uninstall",
                method: 'POST'
            },
            'so-agents-upgrade-software': {
                path: "agents/update-software",
                method: 'POST'
            },
            //Exclusion list
            'so-create-exclusion-list': {
                path: "exclusion-lists",
                method: "POST",
                extended: true,
                title: 'Sentinel One create exclusion list',
                contextPath: 'SentinelOne.ExclusionLists(val.Id==obj.Id)',
                translator: exclusion_list_translator
            },
            'so-delete-exclusion-list': {
                path: "exclusion-lists/%list_id%",
                method: "DELETE"
            },
            'so-get-exclusion-list': {
                path: "exclusion-lists/%list_id%",
                method: 'GET',
                extended: true,
                title: 'Sentinel One create get list',
                contextPath: 'SentinelOne.ExclusionLists(val.Id==obj.Id)',
                translator: exclusion_list_translator
            },
           'so-get-exclusion-lists': {
                path: "exclusion-lists",
                method: 'GET',
                extended: true,
                title: 'Sentinel One get exclusion lists',
                contextPath: 'SentinelOne.ExclusionLists(val.Id==obj.Id)',
                translator: exclusion_list_translator
            },
            'so-update-exclusion-list': {
                path: "exclusion-lists/%list_id%",
                method: 'PUT'
            },
            //Group
            'so-get-groups': {
                path: "groups?policy_id=%policy_id%",
                method: 'GET',
                title: 'Sentinel One create groups',
                extended: true,
                translator: group_translator,
                contextPath: 'SentinelOne.Groups(val.Id==obj.Id)'
            },
            'so-create-group': {
                path: "groups",
                method: 'POST',
                title: 'Sentinel One create group',
                extended: true,
                translator: group_translator,
                contextPath: 'SentinelOne.Groups(val.Id==obj.Id)'
            },
            'so-get-group': {
                path: "groups/%group_id%",
                method: 'GET',
                title: 'Sentinel One get group',
                extended: true,
                translator: group_translator,
                contextPath: 'SentinelOne.Groups(val.Id==obj.Id)'
            },
            'so-update-group': {
                path: "groups/%group_id%",
                method: 'PUT',
                title: 'Sentinel One update group',
                extended: true,
                translator: group_translator,
                contextPath: 'SentinelOne.Groups(val.Id==obj.Id)'
            },
            'so-delete-group': {
                path: "groups/%group_id%",
                method: 'DELETE'
            },
            'so-add-agent-to-group': {
                path: "groups/%group_id%/add-agents",
                method: 'PUT'
            },
            //System configuration
            'so-set-cloud-intelligence': {
                path: "settings/agents/mode/options",
                method: 'PUT'
            },
            //Hash
            'so-create-hash': {
                path: "hashes",
                method: 'POST',
                extended: true,
                title: 'Sentinel One create hash',
                contextPath: 'SentinelOne.Hashes(val.Id==obj.Id)',
                translator: hash_translator
            },
            'so-delete-hash':{
                path: "hashes/%hash_id%",
                method: 'DELETE'
            },
            'so-get-hash-reputation': {
                path: "hashes/%hash_id%/reputation",
                method: 'GET',
            },
            'so-get-hash': {
                path: "hashes/%hash_id%",
                method: 'GET',
                extended: true,
                title: 'Sentinel One get hash',
                contextPath: 'SentinelOne.Hashes(val.Id==obj.Id)',
                translator: hash_translator
            },
            'so-get-hashes': {
                path: "hashes",
                method: 'GET',
                extended: true,
                title: 'Sentinel One get hashes',
                contextPath: 'SentinelOne.Hashes(val.Id==obj.Id)',
                translator: hash_translator
            },
            'so-update-hash': {
                path: "hashes/%hash%",
                method: 'PUT'
            },
            //Policies
            'so-get-policies': {
                path: "policies",
                method: 'GET'
            },
            'so-create-policy': {
                path: "policies",
                method: 'POST'
            },
            'so-get-policy': {
                path: "policies/%policy_id%",
                method: 'GET'
            },
            'so-update-policy': {
                path: "policies/%policy_id%",
                method: 'PUT'
            },
            'so-delete-policy': {
                path: "policies/%policy_id%",
                method: 'DELETE'
            },
            //Threats
            'so-get-threat': {
                path: "threats/%threat_id%",
                method: 'GET',
                extended: true,
                title: 'Sentinel One Threat',
                contextPath: 'SentinelOne.Threats',
                translator: threat_translator
            },
            'so-get-threats': {
                path: "threats",
                method: 'GET',
                extended: true,
                title: 'Sentinel One Threats',
                contextPath: 'SentinelOne.Threats',
                translator: threat_translator
            },
            'so-threat-summary': {
                path: "threats/summary",
                method: 'GET'
            },
            'so-mark-as-threat': {
                path: 'threats/%threat_id%/mark-as-threat',
                method: 'POST'
            },
            'so-mitigate-threat': {
                path: 'threats/%threat_id%/mitigate/%action%',
                method: 'POST'
            },
            'so-reslove-threats': {
                path: 'threats/%threat_id%/resolve',
                method: 'POST'
            }
        };

        var queryMap = {
            content_hash: true,
            mitigation_status: true,
            activity_type__in: true,
            activity_type__nin: true,
            resolved: true,
            hidden: true,
            display_name: true,
            created_at__lt: true,
            created_at__gt: true,
            created_at__lte: true,
            created_at__gte: true,
            updated_at__lt: true,
            updated_at__gt: true,
            updated_at__lte: true,
            updated_at__gte: true,
            skip: true,
            limit: true,
            participating_fields: true,
            query: true,
            registered_at__lt: true,
            registered_at__gt: true,
            last_active_date__lt: true,
            ast_active_date__gt: true,
            total_memory__lte: true,
            total_memory__gte: true,
            core_count__lte: true,
            core_count__gte: true,
            cpu_count__lte: true,
            cpu_count__gte: true,
            is_active: true,
            infected: true,
            is_pending_uninstall: true,
            is_decommissioned: true,
            is_up_to_date: true,
            encrypted_applications: true,
            id__in: true,
            id__nin: true,
            group_id: true,
            group_id__in: true,
            policy_id__in: true,
            computer_name__like: true,
            agent_version__in: true,
            os_type__in: true,
            machine_type__in: true,
            domain__in: true
        };

        var urlTemplate = "%url%/web/api/v%version%/";
        var loginPath = 'users/login';
        var logoutPath = 'users/logout';
        var statusLBound = 200;
        var statusUBound = 300;
        var apiToken = params.token;
        var userToken;
        var fail = false;
        var success = true;
        var insecure = params.insecure;

        var url = builder.url(urlTemplate, params);

        function getqueryArgs(commadArgs) {
            var queryArgs = {};
            for (var arg in commadArgs) {
                if (queryMap[arg]) {
                    queryArgs[arg] = commadArgs[arg];
                    delete commadArgs[arg];
                }
            }
            return queryArgs;
        }

        var sendRequest = function(fullurl, method, headers, body) {
            var req = {
                Method: method,
                Headers: headers
            };
            if (body) {
                req.Body = body;
            }
            var res = http(fullurl, req, params.insecure);
            var resBody;
            try {
                resBody = JSON.parse(res.Body);
            } catch (err) {
                resBody = res.Body;
            }
            if (res.StatusCode < statusLBound || res.StatusCode >= statusUBound) {
                throw 'Request Failed.\nStatus code: ' + res.StatusCode +'.\nBody: ' + JSON.stringify(res) + '.';
            }
            return {status: success, body: resBody, statusCode: res.StatusCode};
        };

        var login = function(){
            if(apiToken){
                return {status : 'Success'};
            }
            if(!params.credentials.identifier){
                throw 'Must provide username and password or API Token in order to login';
            }
            var body = builder.body({username: params.credentials.identifier, password: params.credentials.password});
            var headers = {'Content-Type': ['application/json']};
            var res = sendRequest(url + loginPath, 'POST', headers, body);
            if (!res.status) {
                var m = (typeof res.body.message) === 'string' ? res.body.message : JSON.stringify(res.body.message);
                res.message = 'Failed to login.\n' + m;
            } else if (res.body.token) {
                userToken = res.body.token;
                res.message = 'Logged in successfully.';
            } else {
                res.status = fail;
                res.message = 'Failed to login. No token in response';
            }
            return res;
        };

        var logout = function() {
            if(apiToken){
                return {status : 'No need to logout'};
            }
            if (!userToken) {
                return { status: fail, body: null, message: 'Failed to logout from SentinelOne, login token is missing'};
            }
            var headers = {
                'Content-Type': ['application/json'],
                'Authorization': ['Token ' + userToken]
            };
            var res = sendRequest(url + logoutPath, 'POST', headers);
            if (!res.status) {
                throw 'Failed to logout. \n: ' +  JSON.stringify(res);
            }
            return res;
        };

        var logErr = function(logRes, output) {
            var oRes = output.concat('.Response');
            var oMes = output.concat('.ErrorMessage');
            return {
                Type: entryTypes.error,
                Contents: logRes.message,
                ContentsFormat: formats.text,
            };
        };

        var testLog = function() {
            if(!apiToken){
                var loginRes = login();
                if (!loginRes.status) {
                    return logErr(loginRes, 'Test.Login');
                }
            }
            var logoutRes = logout();
            if (!logoutRes.status) {
                return logoutRes;
            }
            return 'ok';
        };

        var underscoreToCapital = function(string){
            var ret_string = '_'+string;
            return ret_string.replace(/_([a-z])/g, function (g) { return ' '+g[1].toUpperCase(); });
        };

        var camelToCapital = function(string){
            return string.replace(/[A-Z]/g, function (g) { return ' '+g[0]; });
        };

        var executeCommand = function(commandName){
            if (!apiToken){
                var loginRes = login();
                if (!loginRes.status) {
                    return logErr(loginRes, 'ExecuteCommand.Login.Response');
                }
            }

            var cmd = commands[commandName];
            if(commandName !== 'so-agents-upgrade-software'){
                queryMap['os_type'] = true;
            }
            var full = url + builder.path(cmd.path, args) + builder.queryString(getqueryArgs(args));
            var method = cmd.method;
            var headers = {
                'Content-Type': ['application/json'],
                'Authorization': (apiToken? ['APIToken ' + apiToken] : ['Token ' + userToken])
            };
            if(commandName === 'so-update-group' && !args.ad_query){
                args.ad_query = '';
            }
            try {
                var res = sendRequest(full, method, headers, JSON.stringify(args));
            }
            catch(err) {
                logout();
                throw err;
            }
            if(res.statusCode === 204){
                return 'Command executed successfully';
            }
            var entry = {
                Type: entryTypes.note,
                Contents: res.body,
                ContentsFormat: formats.json,
                HumanReadableFormat: formats.markdown
            };
            if (cmd.extended) {
                var translated = mapObjFunction(cmd.translator)(res.body);
                entry.ReadableContentsFormat = formats.markdown;
                entry.HumanReadable = tableToMarkdown(cmd.title, translated, undefined, undefined, camelToCapital);
                if(cmd.contextPath){
                    entry.EntryContext = {};
                    entry.EntryContext[cmd.contextPath] = createContext(translated);
                }
            }
            else{
                entry.HumanReadable = tableToMarkdown(cmd.title, res.body, undefined, undefined, underscoreToCapital);
            }
            return entry;
        };
        return {
            runTest: testLog,
            execute: executeCommand
        };
    };


    var sentinelOne = SentinelOne();


    switch (command) {
        case 'test-module':
            return sentinelOne.runTest();
        default:
            return sentinelOne.execute(command);
    }
  type: javascript
  commands:
  - name: so-activities
    arguments:
    - name: activity_type__in
      description: Activity types list (by comma separator)
    - name: activity_type__nin
      description: Excluded Activity types list (by comma separator).
    - name: created_at__lt
      description: Reported date (less than).
    - name: created_at__gt
      description: Reported date (greater than).
    - name: created_at__lte
      description: Reported date (less than or equal).
    - name: created_at__gte
      description: Reported date (greater than or equal).
    - name: skip
      description: Skip a number of items.
    - name: limit
      description: Limit a number of items in the query.
    outputs:
    - contextPath: SentinelOne.Activities.CreatedAt
      description: Activity creation time
    - contextPath: SentinelOne.Activities.OsFamily
      description: OS family
    - contextPath: SentinelOne.Activities.User
      description: Created by user
    - contextPath: SentinelOne.Activities.UserId
      description: Created by user id
    - contextPath: SentinelOne.Activities.Group
      description: Group
    - contextPath: SentinelOne.Activities.Id
      description: Activity id
    - contextPath: SentinelOne.Activities.MitigationPolicyCommand
      description: Mitigation Policy Command
    - contextPath: SentinelOne.Activities.AgentId
      description: Agent
    - contextPath: SentinelOne.Activities.Hash
      description: Hash
    - contextPath: SentinelOne.Activities.Description
      description: Activity description
    - contextPath: SentinelOne.Activities.ThreatId
      description: Threat Id
    description: commands.server.so.commands.activities.description
  - name: so-count-by-filters
    arguments:
    - name: participating_fields
      description: Which fields to get counts for. Allowed values software_information__os_type software_information__os_arch hardware_information__machine_type network_information__domain network_status configuration__learning_mode is_pending_uninstall is_up_to_date infected policy_id is_active
    - name: query
      description: Free text search on Agent's network computer name, IP & Mac addresses, Domain and Group name, and agent version (contains).
    - name: created_at__lt
      description: Created date (less than)
    - name: created_at__gt
      description: Created date (greater than)
    - name: registered_at__lt
      description: Registered date (less than).
    - name: registerd_at__gt
      description: Registered date (greater than)
    - name: last_active_date__lt
      description: Last active date (less than)
    - name: last_active_date__gt
      description: Last active date (greater than)
    - name: total_memory__lte
      description: Total memory (less than or equal)
    - name: total_memory__gte
      description: Total memory (greater than or equal)
    - name: core_count__lte
      description: Cores count (less than or equal)
    - name: core_count__gte
      description: Cores count (greater than or equal)
    - name: cpu_count__lte
      description: CPU count (less than or equal)
    - name: cpu_count__gte
      description: CPU count (greater than or equal)
    - name: is_active
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent status
    - name: infected
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent infection status
    - name: is_pending_uninstall
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent with pending uninstall requests.
    - name: include_decommissioned
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Enable the ability to query on each agents that ever subscribed (decommission or commissioned).
    - name: is_decommissioned
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Is agent decommissioned
    - name: is_uninstalled
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: is uninstalled agent
    - name: is_up_to_date
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent version status
    - name: encrypted_applications
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent disk encryption status
    - name: id__in
      description: Agents ids list (by comma separator)
    - name: id__nin
      description: Excluded agents ids list (by comma separator)
    - name: group_id
      description: Related group id
    - name: group_id__in
      description: Group ids list (by comma separator)
    - name: policy_id__in
      description: Policy ids list (by comma separator)
    - name: computer_name__like
      description: Agent computer name (contains)
    - name: agent_version__in
      description: Agent with any of given versions (contains)
    - name: os_type__in
      description: Agent of specific os type (contains)
    - name: os_type
      auto: PREDEFINED
      predefined:
      - unknown
      - osx
      - windows
      - android
      - linux
      description: Agent of specific os type
    - name: machine_type__in
      description: Agent of specific machine type (contains)
    - name: domain__in
      description: Agent of a specific domain (contains)
    - name: skip
      description: Skip a number of items
    - name: limit
      description: Limit a number of items in the query
    - name: network_status
      description: The agent network status
    description: Count agent by filters
  - name: so-agents-count
    arguments:
    - name: query
      description: Free text search on Agent's network computer name, IP & Mac addresses, Domain and Group name, and agent version (contains).
    - name: created_at__lt
      description: Created date (less than).
    - name: created_at__gt
      description: Created date (greater than).
    - name: registered_at__lt
      description: Registered date (less than).
    - name: registerd_at__gt
      description: Registered date (greater than).
    - name: last_active_date__lt
      description: Last active date (less than).
    - name: last_active_date__gt
      description: Last active date (greater than).
    - name: total_memory__lte
      description: Total memory (less than or equal).
    - name: total_memory__gte
      description: Total memory (greater than or equal).
    - name: core_count__lte
      description: Cores count (less than or equal).
    - name: core_count__gte
      description: Cores count (greater than or equal).
    - name: cpu_count__lte
      description: CPU count (less than or equal).
    - name: cpu_count__gte
      description: CPU count (greater than or equal)
    - name: is_active
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent status.
    - name: infected
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent infection status.
    - name: is_pending_uninstall
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent with pending uninstall requests.
    - name: include_decommissioned
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: enable the ability to query on each agents that ever subscribed (decommission or commissioned).
    - name: is_decommissioned
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: is decommissioned agent.
    - name: is_uninstalled
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: is uninstalled agent
    - name: is_up_to_date
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent version status
    - name: encrypted_applications
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent disk encryption status
    - name: id__in
      description: Agents ids list (by comma separator)
    - name: id__nin
      description: Excluded agents ids list (by comma separator)
    - name: group_id
      description: Related group id.
    - name: group_id__in
      description: Group ids list (by comma separator)
    - name: policy_id__in
      description: Policy ids list (by comma separator)
    - name: computer_name__like
      description: Agent computer name (contains).
    - name: agent_version__in
      description: Agent with any of given versions (contains).
    - name: os_type__in
      description: Agent of specific os type (contains).
    - name: os_type
      auto: PREDEFINED
      predefined:
      - unknown
      - osx
      - windows
      - android
      - linux
      description: Agent of specific os type.
    - name: machine_type__in
      description: Agent of specific machine type (contains).
    - name: domain__in
      description: Agent of a specific domain (contains).
    - name: skip
      description: Skip a number of items
    - name: limit
      description: Limit a number of items in the query.
    - name: network_status
      description: The agent network status
    description: Count agents
  - name: so-agent-decommission
    arguments:
    - name: agent_id
      required: true
      default: true
      description: The agent id
    description: Decommission agent
  - name: so-get-agent
    arguments:
    - name: agent_id
      required: true
      default: true
      description: The agent id
    description: Get agent
  - name: so-agents-query
    arguments:
    - name: query
      description: Free text search on Agent's network computer name, IP & Mac addresses, Domain and Group name, and agent version (contains).
    - name: created_at__lt
      description: Created date (less than).
    - name: created_at__gt
      description: Created date (greater than).
    - name: registered_at__lt
      description: Registered date (less than).
    - name: registerd_at__gt
      description: Registered date (greater than).
    - name: last_active_date__lt
      description: Last active date (less than).
    - name: last_active_date__gt
      description: Last active date (greater than).
    - name: total_memory__lte
      description: Total memory (less than or equal).
    - name: total_memory__gte
      description: Total memory (greater than or equal).
    - name: core_count__lte
      description: Cores count (less than or equal).
    - name: core_count__gte
      description: Cores count (greater than or equal).
    - name: cpu_count__lte
      description: CPU count (less than or equal).
    - name: cpu_count__gte
      description: CPU count (greater than or equal)
    - name: is_active
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent status.
    - name: infected
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent infection status.
    - name: is_pending_uninstall
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent with pending uninstall requests.
    - name: include_decommissioned
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: enable the ability to query on each agents that ever subscribed (decommission or commissioned).
    - name: is_decommissioned
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: is decommissioned agent.
    - name: is_uninstalled
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: is uninstalled agent
    - name: is_up_to_date
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent version status
    - name: encrypted_applications
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent disk encryption status
    - name: id__in
      description: Agents ids list (by comma separator)
    - name: id__nin
      description: Excluded agents ids list (by comma separator)
    - name: group_id
      description: Related group id.
    - name: group_id__in
      description: Group ids list (by comma separator)
    - name: policy_id__in
      description: Policy ids list (by comma separator)
    - name: computer_name__like
      description: Agent computer name (contains).
    - name: agent_version__in
      description: Agent with any of given versions (contains).
    - name: os_type__in
      description: Agent of specific os type (contains).
    - name: os_type
      auto: PREDEFINED
      predefined:
      - unknown
      - osx
      - windows
      - android
      - linux
      description: Agent of specific os type.
    - name: machine_type__in
      description: Agent of specific machine type (contains).
    - name: domain__in
      description: Agent of a specific domain (contains).
    - name: skip
      description: Skip a number of items
    - name: limit
      description: Limit a number of items in the query.
    - name: network_status
      description: The agent network status
    outputs:
    - contextPath: SentinelOne.Agents.NetworkStatus
      description: The agent network status
    - contextPath: SentinelOne.Agents.Id
      description: The agent ID
    - contextPath: SentinelOne.Agents.GroupId
      description: The agent group ID
    - contextPath: SentinelOne.Agents.AgentVersion
      description: The agent software version
    - contextPath: SentinelOne.Agents.IsPendingUninstall
      description: Is the agent pending uninstall
    - contextPath: SentinelOne.Agents.IsUninstalled
      description: Is the agent uninstalled
    - contextPath: SentinelOne.Agents.IsDecomissioned
      description: Is the agent decommissioned
    - contextPath: SentinelOne.Agents.IsActive
      description: Is the agent active
    - contextPath: SentinelOne.Agents.LastActiveDate
      description: The last active date of the agent
    - contextPath: SentinelOne.Agents.RegisteredAt
      description: The registration date of the agent
    - contextPath: SentinelOne.Agents.Uuid
      description: UUID of the agent
    - contextPath: SentinelOne.Agents.ExternalIp
      description: The agent IP address
    - contextPath: SentinelOne.Agents.GroupIp
      description: The agent group IP
    - contextPath: SentinelOne.Agents.IsUpToDate
      description: Is the agent software up to date
    - contextPath: SentinelOne.Agents.ThreatCount
      description: Number of active threats
    - contextPath: SentinelOne.Agents.EncryptedApplications
      description: Is disk encryption on
    - contextPath: SentinelOne.Agents.OsName
      description: Name of operation system
    - contextPath: SentinelOne.Agents.ComputerName
      description: Name of agent computer
    - contextPath: SentinelOne.Agents.Domain
      description: Domain name of agent
    - contextPath: SentinelOne.Agents.Interfaces
      description: Network interfaces
    - contextPath: SentinelOne.Agents.Configuration
      description: The agent configuration
    - contextPath: SentinelOne.Agents.CreatedAt
      description: Agent creation time
    - contextPath: SentinelOne.Agents.UpdatedAt
      description: Agent update time
    description: Agents list and search
  - name: so-get-agent-processes
    arguments:
    - name: agent_id
      required: true
      default: true
      description: The agent id.
    description: Get agent proccesses
  - name: so-agent-recommission
    arguments:
    - name: agent_id
      required: true
      default: true
      description: The agent id.
    description: Recommission agent
  - name: so-agent-unquarentine
    arguments:
    - name: agent_id
      required: true
      description: The agent id.
    description: Reconnect agent network
  - name: so-agent-shutdown
    arguments:
    - name: agent_id
      required: true
      description: The agent id.
    description: Shutdown agent
  - name: so-agent-uninstall
    arguments:
    - name: agent_id
      required: true
      description: The agent id.
    description: uninstall agent
  - name: so-agents-broadcast
    arguments:
    - name: message
      required: true
      description: The broadcast message to send
    - name: query
      description: Free text search on Agent's network computer name, IP & Mac addresses, Domain and Group name, and agent version (contains).
    - name: created_at__lt
      description: Created date (less than).
    - name: created_at__gt
      description: Created date (greater than).
    - name: registered_at__lt
      description: Registered date (less than).
    - name: registerd_at__gt
      description: Registered date (greater than).
    - name: last_active_date__lt
      description: Last active date (less than).
    - name: last_active_date__gt
      description: Last active date (greater than).
    - name: total_memory__lte
      description: Total memory (less than or equal).
    - name: total_memory__gte
      description: Total memory (greater than or equal).
    - name: core_count__lte
      description: Cores count (less than or equal).
    - name: core_count__gte
      description: Cores count (greater than or equal).
    - name: cpu_count__lte
      description: CPU count (less than or equal).
    - name: cpu_count__gte
      description: CPU count (greater than or equal)
    - name: is_active
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent status.
    - name: infected
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent infection status.
    - name: is_pending_uninstall
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent with pending uninstall requests.
    - name: include_decommissioned
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: enable the ability to query on each agents that ever subscribed (decommission or commissioned).
    - name: is_decommissioned
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: is decommissioned agent.
    - name: is_uninstalled
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: is uninstalled agent
    - name: is_up_to_date
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent version status
    - name: encrypted_applications
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent disk encryption status
    - name: id__in
      description: Agents ids list (by comma separator)
    - name: id__nin
      description: Excluded agents ids list (by comma separator)
    - name: group_id
      description: Related group id.
    - name: group_id__in
      description: Group ids list (by comma separator)
    - name: policy_id__in
      description: Policy ids list (by comma separator)
    - name: computer_name__like
      description: Agent computer name (contains).
    - name: agent_version__in
      description: Agent with any of given versions (contains).
    - name: os_type__in
      description: Agent of specific os type (contains).
    - name: os_type
      auto: PREDEFINED
      predefined:
      - unknown
      - osx
      - windows
      - android
      - linux
      description: Agent of specific os type.
    - name: machine_type__in
      description: Agent of specific machine type (contains).
    - name: domain__in
      description: Agent of a specific domain (contains).
    - name: skip
      description: Skip a number of items
    - name: limit
      description: Limit a number of items in the query.
    - name: network_status
      description: The agent network status
    description: Boadcast
  - name: so-agents-connect
    arguments:
    - name: query
      description: Free text search on Agent's network computer name, IP & Mac addresses, Domain and Group name, and agent version (contains).
    - name: created_at__lt
      description: Created date (less than).
    - name: created_at__gt
      description: Created date (greater than).
    - name: registered_at__lt
      description: Registered date (less than).
    - name: registerd_at__gt
      description: Registered date (greater than).
    - name: last_active_date__lt
      description: Last active date (less than).
    - name: last_active_date__gt
      description: Last active date (greater than).
    - name: total_memory__lte
      description: Total memory (less than or equal).
    - name: total_memory__gte
      description: Total memory (greater than or equal).
    - name: core_count__lte
      description: Cores count (less than or equal).
    - name: core_count__gte
      description: Cores count (greater than or equal).
    - name: cpu_count__lte
      description: CPU count (less than or equal).
    - name: cpu_count__gte
      description: CPU count (greater than or equal)
    - name: is_active
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent status.
    - name: infected
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent infection status.
    - name: is_pending_uninstall
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent with pending uninstall requests.
    - name: include_decommissioned
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: enable the ability to query on each agents that ever subscribed (decommission or commissioned).
    - name: is_decommissioned
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: is decommissioned agent.
    - name: is_uninstalled
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: is uninstalled agent
    - name: is_up_to_date
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent version status
    - name: encrypted_applications
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent disk encryption status
    - name: id__in
      description: Agents ids list (by comma separator)
    - name: id__nin
      description: Excluded agents ids list (by comma separator)
    - name: group_id
      description: Related group id.
    - name: group_id__in
      description: Group ids list (by comma separator)
    - name: policy_id__in
      description: Policy ids list (by comma separator)
    - name: computer_name__like
      description: Agent computer name (contains).
    - name: agent_version__in
      description: Agent with any of given versions (contains).
    - name: os_type__in
      description: Agent of specific os type (contains).
    - name: os_type
      auto: PREDEFINED
      predefined:
      - unknown
      - osx
      - windows
      - android
      - linux
      description: Agent of specific os type.
    - name: machine_type__in
      description: Agent of specific machine type (contains).
    - name: domain__in
      description: Agent of a specific domain (contains).
    - name: skip
      description: Skip a number of items
    - name: limit
      description: Limit a number of items in the query.
    - name: network_status
      description: The agent network status
    description: Connect to network
  - name: so-agent-quarentine
    arguments:
    - name: agent_id
      required: true
      description: The agent id.
    description: Connect to network
  - name: so-agents-decommission
    arguments:
    - name: query
      description: Free text search on Agent's network computer name, IP & Mac addresses, Domain and Group name, and agent version (contains).
    - name: created_at__lt
      description: Created date (less than).
    - name: created_at__gt
      description: Created date (greater than).
    - name: registered_at__lt
      description: Registered date (less than).
    - name: registerd_at__gt
      description: Registered date (greater than).
    - name: last_active_date__lt
      description: Last active date (less than).
    - name: last_active_date__gt
      description: Last active date (greater than).
    - name: total_memory__lte
      description: Total memory (less than or equal).
    - name: total_memory__gte
      description: Total memory (greater than or equal).
    - name: core_count__lte
      description: Cores count (less than or equal).
    - name: core_count__gte
      description: Cores count (greater than or equal).
    - name: cpu_count__lte
      description: CPU count (less than or equal).
    - name: cpu_count__gte
      description: CPU count (greater than or equal)
    - name: is_active
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent status.
    - name: infected
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent infection status.
    - name: is_pending_uninstall
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent with pending uninstall requests.
    - name: include_decommissioned
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: enable the ability to query on each agents that ever subscribed (decommission or commissioned).
    - name: is_decommissioned
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: is decommissioned agent.
    - name: is_uninstalled
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: is uninstalled agent
    - name: is_up_to_date
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent version status
    - name: encrypted_applications
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent disk encryption status
    - name: id__in
      description: Agents ids list (by comma separator)
    - name: id__nin
      description: Excluded agents ids list (by comma separator)
    - name: group_id
      description: Related group id.
    - name: group_id__in
      description: Group ids list (by comma separator)
    - name: policy_id__in
      description: Policy ids list (by comma separator)
    - name: computer_name__like
      description: Agent computer name (contains).
    - name: agent_version__in
      description: Agent with any of given versions (contains).
    - name: os_type__in
      description: Agent of specific os type (contains).
    - name: os_type
      auto: PREDEFINED
      predefined:
      - unknown
      - osx
      - windows
      - android
      - linux
      description: Agent of specific os type.
    - name: machine_type__in
      description: Agent of specific machine type (contains).
    - name: domain__in
      description: Agent of a specific domain (contains).
    - name: skip
      description: Skip a number of items
    - name: limit
      description: Limit a number of items in the query.
    - name: network_status
      description: The agent network status
    description: Decommission
  - name: so-agents-disconnect
    arguments:
    - name: query
      description: Free text search on Agent's network computer name, IP & Mac addresses, Domain and Group name, and agent version (contains).
    - name: created_at__lt
      description: Created date (less than).
    - name: created_at__gt
      description: Created date (greater than).
    - name: registered_at__lt
      description: Registered date (less than).
    - name: registerd_at__gt
      description: Registered date (greater than).
    - name: last_active_date__lt
      description: Last active date (less than).
    - name: last_active_date__gt
      description: Last active date (greater than).
    - name: total_memory__lte
      description: Total memory (less than or equal).
    - name: total_memory__gte
      description: Total memory (greater than or equal).
    - name: core_count__lte
      description: Cores count (less than or equal).
    - name: core_count__gte
      description: Cores count (greater than or equal).
    - name: cpu_count__lte
      description: CPU count (less than or equal).
    - name: cpu_count__gte
      description: CPU count (greater than or equal)
    - name: is_active
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent status.
    - name: infected
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent infection status.
    - name: is_pending_uninstall
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent with pending uninstall requests.
    - name: include_decommissioned
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: enable the ability to query on each agents that ever subscribed (decommission or commissioned).
    - name: is_decommissioned
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: is decommissioned agent.
    - name: is_uninstalled
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: is uninstalled agent
    - name: is_up_to_date
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent version status
    - name: encrypted_applications
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent disk encryption status
    - name: id__in
      description: Agents ids list (by comma separator)
    - name: id__nin
      description: Excluded agents ids list (by comma separator)
    - name: group_id
      description: Related group id.
    - name: group_id__in
      description: Group ids list (by comma separator)
    - name: policy_id__in
      description: Policy ids list (by comma separator)
    - name: computer_name__like
      description: Agent computer name (contains).
    - name: agent_version__in
      description: Agent with any of given versions (contains).
    - name: os_type__in
      description: Agent of specific os type (contains).
    - name: os_type
      auto: PREDEFINED
      predefined:
      - unknown
      - osx
      - windows
      - android
      - linux
      description: Agent of specific os type.
    - name: machine_type__in
      description: Agent of specific machine type (contains).
    - name: domain__in
      description: Agent of a specific domain (contains).
    - name: skip
      description: Skip a number of items
    - name: limit
      description: Limit a number of items in the query.
    - name: network_status
      description: The agent network status
    description: Disconnect From Network
  - name: so-agents-fetch-logs
    arguments:
    - name: query
      description: Free text search on Agent's network computer name, IP & Mac addresses, Domain and Group name, and agent version (contains).
    - name: created_at__lt
      description: Created date (less than).
    - name: created_at__gt
      description: Created date (greater than).
    - name: registered_at__lt
      description: Registered date (less than).
    - name: registerd_at__gt
      description: Registered date (greater than).
    - name: last_active_date__lt
      description: Last active date (less than).
    - name: last_active_date__gt
      description: Last active date (greater than).
    - name: total_memory__lte
      description: Total memory (less than or equal).
    - name: total_memory__gte
      description: Total memory (greater than or equal).
    - name: core_count__lte
      description: Cores count (less than or equal).
    - name: core_count__gte
      description: Cores count (greater than or equal).
    - name: cpu_count__lte
      description: CPU count (less than or equal).
    - name: cpu_count__gte
      description: CPU count (greater than or equal)
    - name: is_active
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent status.
    - name: infected
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent infection status.
    - name: is_pending_uninstall
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent with pending uninstall requests.
    - name: include_decommissioned
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: enable the ability to query on each agents that ever subscribed (decommission or commissioned).
    - name: is_decommissioned
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: is decommissioned agent.
    - name: is_uninstalled
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: is uninstalled agent
    - name: is_up_to_date
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent version status
    - name: encrypted_applications
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent disk encryption status
    - name: id__in
      description: Agents ids list (by comma separator)
    - name: id__nin
      description: Excluded agents ids list (by comma separator)
    - name: group_id
      description: Related group id.
    - name: group_id__in
      description: Group ids list (by comma separator)
    - name: policy_id__in
      description: Policy ids list (by comma separator)
    - name: computer_name__like
      description: Agent computer name (contains).
    - name: agent_version__in
      description: Agent with any of given versions (contains).
    - name: os_type__in
      description: Agent of specific os type (contains).
    - name: os_type
      auto: PREDEFINED
      predefined:
      - unknown
      - osx
      - windows
      - android
      - linux
      description: Agent of specific os type.
    - name: machine_type__in
      description: Agent of specific machine type (contains).
    - name: domain__in
      description: Agent of a specific domain (contains).
    - name: skip
      description: Skip a number of items
    - name: limit
      description: Limit a number of items in the query.
    - name: network_status
      description: The agent network status
    description: Fetch log
  - name: so-agents-shutdown
    arguments:
    - name: query
      description: Free text search on Agent's network computer name, IP & Mac addresses, Domain and Group name, and agent version (contains).
    - name: created_at__lt
      description: Created date (less than).
    - name: created_at__gt
      description: Created date (greater than).
    - name: registered_at__lt
      description: Registered date (less than).
    - name: registerd_at__gt
      description: Registered date (greater than).
    - name: last_active_date__lt
      description: Last active date (less than).
    - name: last_active_date__gt
      description: Last active date (greater than).
    - name: total_memory__lte
      description: Total memory (less than or equal).
    - name: total_memory__gte
      description: Total memory (greater than or equal).
    - name: core_count__lte
      description: Cores count (less than or equal).
    - name: core_count__gte
      description: Cores count (greater than or equal).
    - name: cpu_count__lte
      description: CPU count (less than or equal).
    - name: cpu_count__gte
      description: CPU count (greater than or equal)
    - name: is_active
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent status.
    - name: infected
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent infection status.
    - name: is_pending_uninstall
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent with pending uninstall requests.
    - name: include_decommissioned
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: enable the ability to query on each agents that ever subscribed (decommission or commissioned).
    - name: is_decommissioned
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: is decommissioned agent.
    - name: is_uninstalled
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: is uninstalled agent
    - name: is_up_to_date
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent version status
    - name: encrypted_applications
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent disk encryption status
    - name: id__in
      description: Agents ids list (by comma separator)
    - name: id__nin
      description: Excluded agents ids list (by comma separator)
    - name: group_id
      description: Related group id.
    - name: group_id__in
      description: Group ids list (by comma separator)
    - name: policy_id__in
      description: Policy ids list (by comma separator)
    - name: computer_name__like
      description: Agent computer name (contains).
    - name: agent_version__in
      description: Agent with any of given versions (contains).
    - name: os_type__in
      description: Agent of specific os type (contains).
    - name: os_type
      auto: PREDEFINED
      predefined:
      - unknown
      - osx
      - windows
      - android
      - linux
      description: Agent of specific os type.
    - name: machine_type__in
      description: Agent of specific machine type (contains).
    - name: domain__in
      description: Agent of a specific domain (contains).
    - name: skip
      description: Skip a number of items
    - name: limit
      description: Limit a number of items in the query.
    - name: network_status
      description: The agent network status
    description: Shutdown agents
  - name: so-agents-uninstall
    arguments:
    - name: query
      description: Free text search on Agent's network computer name, IP & Mac addresses, Domain and Group name, and agent version (contains).
    - name: created_at__lt
      description: Created date (less than).
    - name: created_at__gt
      description: Created date (greater than).
    - name: registered_at__lt
      description: Registered date (less than).
    - name: registerd_at__gt
      description: Registered date (greater than).
    - name: last_active_date__lt
      description: Last active date (less than).
    - name: last_active_date__gt
      description: Last active date (greater than).
    - name: total_memory__lte
      description: Total memory (less than or equal).
    - name: total_memory__gte
      description: Total memory (greater than or equal).
    - name: core_count__lte
      description: Cores count (less than or equal).
    - name: core_count__gte
      description: Cores count (greater than or equal).
    - name: cpu_count__lte
      description: CPU count (less than or equal).
    - name: cpu_count__gte
      description: CPU count (greater than or equal)
    - name: is_active
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent status.
    - name: infected
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent infection status.
    - name: is_pending_uninstall
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent with pending uninstall requests.
    - name: include_decommissioned
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: enable the ability to query on each agents that ever subscribed (decommission or commissioned).
    - name: is_decommissioned
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: is decommissioned agent.
    - name: is_uninstalled
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: is uninstalled agent
    - name: is_up_to_date
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent version status
    - name: encrypted_applications
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent disk encryption status
    - name: id__in
      description: Agents ids list (by comma separator)
    - name: id__nin
      description: Excluded agents ids list (by comma separator)
    - name: group_id
      description: Related group id.
    - name: group_id__in
      description: Group ids list (by comma separator)
    - name: policy_id__in
      description: Policy ids list (by comma separator)
    - name: computer_name__like
      description: Agent computer name (contains).
    - name: agent_version__in
      description: Agent with any of given versions (contains).
    - name: os_type__in
      description: Agent of specific os type (contains).
    - name: os_type
      auto: PREDEFINED
      predefined:
      - unknown
      - osx
      - windows
      - android
      - linux
      description: Agent of specific os type.
    - name: machine_type__in
      description: Agent of specific machine type (contains).
    - name: domain__in
      description: Agent of a specific domain (contains).
    - name: skip
      description: Skip a number of items
    - name: limit
      description: Limit a number of items in the query.
    - name: network_status
      description: The agent network status
    description: Uninsatll agents
  - name: so-agents-upgrade-software
    arguments:
    - name: use_recent
      required: true
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Flag for use recent uploaded package.
    - name: package_name
      required: true
      description: File name for recent uploaded package.
    - name: query
      description: Free text search on Agent's network computer name, IP & Mac addresses, Domain and Group name, and agent version (contains).
    - name: created_at__lt
      description: Created date (less than).
    - name: created_at__gt
      description: Created date (greater than).
    - name: registered_at__lt
      description: Registered date (less than).
    - name: registerd_at__gt
      description: Registered date (greater than).
    - name: last_active_date__lt
      description: Last active date (less than).
    - name: last_active_date__gt
      description: Last active date (greater than).
    - name: total_memory__lte
      description: Total memory (less than or equal).
    - name: total_memory__gte
      description: Total memory (greater than or equal).
    - name: core_count__lte
      description: Cores count (less than or equal).
    - name: core_count__gte
      description: Cores count (greater than or equal).
    - name: cpu_count__lte
      description: CPU count (less than or equal).
    - name: cpu_count__gte
      description: CPU count (greater than or equal)
    - name: is_active
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent status.
    - name: infected
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent infection status.
    - name: is_pending_uninstall
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent with pending uninstall requests.
    - name: include_decommissioned
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: enable the ability to query on each agents that ever subscribed (decommission or commissioned).
    - name: is_decommissioned
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: is decommissioned agent.
    - name: is_uninstalled
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: is uninstalled agent
    - name: is_up_to_date
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent version status
    - name: encrypted_applications
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Agent disk encryption status
    - name: id__in
      description: Agents ids list (by comma separator)
    - name: id__nin
      description: Excluded agents ids list (by comma separator)
    - name: group_id
      description: Related group id.
    - name: group_id__in
      description: Group ids list (by comma separator)
    - name: policy_id__in
      description: Policy ids list (by comma separator)
    - name: computer_name__like
      description: Agent computer name (contains).
    - name: agent_version__in
      description: Agent with any of given versions (contains).
    - name: os_type__in
      description: Agent of specific os type (contains).
    - name: os_type
      required: true
      auto: PREDEFINED
      predefined:
      - unknown
      - osx
      - windows
      - android
      - linux
      description: OS type for desired update.
    - name: machine_type__in
      description: Agent of specific machine type (contains).
    - name: domain__in
      description: Agent of a specific domain (contains).
    - name: skip
      description: Skip a number of items
    - name: limit
      description: Limit a number of items in the query.
    - name: network_status
      description: The agent network status
    description: Upgrade agents software
  - name: so-create-exclusion-list
    arguments:
    - name: name
      required: true
      description: The list name
    outputs:
    - contextPath: SentinelOne.ExclusionLists.CreateExclusionList.Id
      description: The list id.
    - contextPath: SentinelOne.ExclusionLists.CreateExclusionList.Name
      description: The list name.
    - contextPath: SentinelOne.ExclusionLists.CreateExclusionList.CreatedAt
      description: The time the list was created.
    - contextPath: SentinelOne.ExclusionLists.CreateExclusionList.UpdatedAt
      description: The last time the list was updated.
    description: Create exclusion list
  - name: so-delete-exclusion-list
    arguments:
    - name: list_id
      required: true
      description: The list id
    description: Delete exclusion list
  - name: so-get-exclusion-list
    arguments:
    - name: list_id
      required: true
      description: The list id
    outputs:
    - contextPath: SentinelOne.ExclusionLists.GetExclusionList.Id
      description: The list id.
    - contextPath: SentinelOne.ExclusionLists.GetExclusionList.Name
      description: The list name.
    - contextPath: SentinelOne.ExclusionLists.GetExclusionList.CreatedAt
      description: The time the list was created.
    - contextPath: SentinelOne.ExclusionLists.GetExclusionList.UpdatedAt
      description: The last time the list was updated.
    description: Get exclusion list
  - name: so-get-exclusion-lists
    arguments: []
    outputs:
    - contextPath: SentinelOne.ExclusionLists.GetExclusionLists.Id
      description: The list id.
    - contextPath: SentinelOne.ExclusionLists.GetExclusionLists.Name
      description: The list name.
    - contextPath: SentinelOne.ExclusionLists.GetExclusionLists.CreatedAt
      description: The time the list was created.
    - contextPath: SentinelOne.ExclusionLists.GetExclusionLists.UpdatedAt
      description: The last time the list was updated.
    description: Get exclusion lists
  - name: so-update-exclusion-list
    arguments:
    - name: list_id
      required: true
      description: The list id
    - name: name
      required: true
      description: The group name
    description: Update exclusion list
  - name: so-get-groups
    arguments:
    - name: policy_id
      required: true
      description: The group policy id.
    outputs:
    - contextPath: SentinelOne.Groups.GetGroups.Id
      description: The group id.
    - contextPath: SentinelOne.Groups.GetGroups.Name
      description: The group name.
    - contextPath: SentinelOne.Groups.GetGroups.PolicyId
      description: The group policy id
    - contextPath: SentinelOne.Groups.GetGroups.FilterId
      description: The group filter id
    - contextPath: SentinelOne.Groups.GetGroups.UserId
      description: The user id who created the group.
    - contextPath: SentinelOne.Groups.GetGroups.IsDefault
      description: Flag for catch-all group.
    - contextPath: SentinelOne.Groups.GetGroups.CreatedAt
      description: The time the group was created.
    - contextPath: SentinelOne.Groups.GetGroups.UpdatedAt
      description: The last time the group was updated.
    - contextPath: SentinelOne.Groups.GetGroups.Source
      description: The group source
    - contextPath: SentinelOne.Groups.GetGroups.AdQuery
      description: AD query
    description: Get groups
  - name: so-create-group
    arguments:
    - name: name
      required: true
      description: The group name.
    - name: policy_id
      description: The group policy id.
    - name: ad_query
      required: true
      description: The dynamic group ad query.
    - name: rank
      required: true
      description: The group ramk
    outputs:
    - contextPath: SentinelOne.Groups.CreateGroups.Id
      description: The group id.
    - contextPath: SentinelOne.Groups.CreateGroups.Name
      description: The group name.
    - contextPath: SentinelOne.Groups.CreateGroups.PolicyId
      description: The group policy id
    - contextPath: SentinelOne.Groups.CreateGroups.FilterId
      description: The group filter id
    - contextPath: SentinelOne.Groups.CreateGroups.UserId
      description: The user id who created the group.
    - contextPath: SentinelOne.Groups.CreateGroups.IsDefault
      description: Flag for catch-all group.
    - contextPath: SentinelOne.Groups.CreateGroups.CreatedAt
      description: The time the group was created.
    - contextPath: SentinelOne.Groups.CreateGroups.UpdatedAt
      description: The last time the group was updated.
    - contextPath: SentinelOne.Groups.CreateGroups.Source
      description: The group source
    - contextPath: SentinelOne.Groups.CreateGroups.AdQuery
      description: AD query
    description: Create groups
  - name: so-get-group
    arguments:
    - name: group_id
      required: true
      description: The group id.
    outputs:
    - contextPath: SentinelOne.Groups.GetGroup.Id
      description: The group id.
    - contextPath: SentinelOne.Groups.GetGroup.Name
      description: The group name.
    - contextPath: SentinelOne.Groups.GetGroup.PolicyId
      description: The group policy id
    - contextPath: SentinelOne.Groups.GetGroup.FilterId
      description: The group filter id
    - contextPath: SentinelOne.Groups.GetGroup.UserId
      description: The user id who created the group.
    - contextPath: SentinelOne.Groups.GetGroup.IsDefault
      description: Flag for catch-all group.
    - contextPath: SentinelOne.Groups.GetGroup.CreatedAt
      description: The time the group was created.
    - contextPath: SentinelOne.Groups.GetGroup.UpdatedAt
      description: The last time the group was updated.
    - contextPath: SentinelOne.Groups.GetGroup.Source
      description: The group source
    - contextPath: SentinelOne.Groups.GetGroup.AdQuery
      description: AD query
    description: Get groups
  - name: so-update-group
    arguments:
    - name: group_id
      required: true
      description: The group id.
    - name: name
      required: true
      description: The group name.
    - name: policy_id
      required: true
      description: The group policy id.
    - name: ad_query
      description: The dynamic group ad query.
    - name: rank
      required: true
      description: The group ramk
    - name: filter_id
      required: true
      description: The filter id
    outputs:
    - contextPath: SentinelOne.Groups.UpdateGroup.Id
      description: The group id.
    - contextPath: SentinelOne.Groups.UpdateGroup.Name
      description: The group name.
    - contextPath: SentinelOne.Groups.UpdateGroup.PolicyId
      description: The group policy id
    - contextPath: SentinelOne.Groups.UpdateGroup.FilterId
      description: The group filter id
    - contextPath: SentinelOne.Groups.UpdateGroup.UserId
      description: The user id who created the group.
    - contextPath: SentinelOne.Groups.UpdateGroup.IsDefault
      description: Flag for catch-all group.
    - contextPath: SentinelOne.Groups.UpdateGroup.CreatedAt
      description: The time the group was created.
    - contextPath: SentinelOne.Groups.UpdateGroup.UpdatedAt
      description: The last time the group was updated.
    - contextPath: SentinelOne.Groups.UpdateGroup.Source
      description: The group source
    - contextPath: SentinelOne.Groups.UpdateGroup.AdQuery
      description: AD query
    description: Update groups
  - name: so-delete-group
    arguments:
    - name: group_id
      required: true
      description: The group id.
    description: Delete groups
  - name: so-add-agent-to-group
    arguments:
    - name: group_id
      required: true
      description: The group id.
    - name: query
      description: Free text search on Agent's network computer name, IP & Mac addresses, Domain and Group name, and agent version (contains).
    - name: id__in
      description: Agents ids list (by comma separator)
    - name: id__nin
      description: Excluded agents ids list (by comma separator)
    description: Add agent to groups
  - name: so-set-cloud-intelligence
    arguments:
    - name: cloud_intelligence_on
      required: true
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Cloud intelligence mode
    - name: global_two_fa_enabled
      required: true
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Global two factor authentication mode
    - name: remember_me_length
      required: true
      description: Remember logged in user duration in days
    description: Update
  - name: so-create-hash
    arguments:
    - name: hash
      required: true
      description: The content hash.
    - name: os_family
      required: true
      auto: PREDEFINED
      predefined:
      - osx
      - windows
      - linux
      - android
      description: Threat's operation system.
    - name: is_black
      required: true
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Is black hash
    - name: description
      required: true
      description: The hash description.
    outputs:
    - contextPath: SentinelOne.Hashes.CreateHash.Hash
      description: The content hash.
    - contextPath: SentinelOne.Hashes.CreateHash.OsFamily
      description: Threat's operation system
    - contextPath: SentinelOne.Hashes.CreateHash.IsBlack
      description: Is black hash
    - contextPath: SentinelOne.Hashes.CreateHash.Description
      description: The hash description.
    description: Create hash.
  - name: so-delete-hash
    arguments:
    - name: hash_id
      required: true
      description: The hash id.
    description: Delete hash
  - name: so-get-hash-reputation
    arguments:
    - name: hash_id
      required: true
      description: The hash id.
    description: Get hash reputation.
  - name: so-get-hash
    arguments:
    - name: hash_id
      required: true
      description: The hash id.
    outputs:
    - contextPath: SentinelOne.Hashes.GetHash.Hash
      description: The content hash.
    - contextPath: SentinelOne.Hashes.GetHash.OsFamily
      description: Threat's operation system
    - contextPath: SentinelOne.Hashes.GetHash.IsBlack
      description: Is black hash
    - contextPath: SentinelOne.Hashes.GetHash.Description
      description: The hash description.
    description: Get hash reputation.
  - name: so-get-hashes
    arguments:
    - name: created_at__lt
      description: System creation date (less than).
    - name: created_at__gt
      description: System creation date (greater than).
    - name: updated_at__lt
      description: ystem update date (less than).
    - name: updated_at__gt
      description: System update date (greater than).
    - name: os_family
      auto: PREDEFINED
      predefined:
      - osx
      - windows
      - linux
      - android
      description: Threat's operation system.
    - name: is_black
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Is black hash
    - name: query
      description: Free text search on Agent's network computer name, IP & Mac addresses, Domain and Group name, and agent version (contains).
    - name: skip
      description: Skip a number of items
    - name: limit
      description: Limit a number of items in the query.
    description: Get hash reputation.
  - name: so-update-hash
    arguments:
    - name: hash
      required: true
      description: The content hash.
    - name: os_family
      required: true
      auto: PREDEFINED
      predefined:
      - osx
      - windows
      - linux
      - android
      description: Threat's operation system.
    - name: is_black
      required: true
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Is black hash
    - name: description
      required: true
      description: The hash description.
    description: Create hash.
  - name: so-get-policies
    arguments: []
    description: Get Policies list.
  - name: so-create-policy
    arguments:
    - name: name
      required: true
      description: The policy name.
    - name: cloud_validation_on
      required: true
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Cloud validation mode on/off.
    - name: auto_mitigation_action
      required: true
      auto: PREDEFINED
      predefined:
      - mitigation.none
      - mitigation.killThreat
      - mitigation.quarantineThreat
      - mitigation.remediateThreat
      - mitigation.rollbackThreat
      description: The automatic mitigation action.
    - name: network_quarantine_on
      required: true
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Automatic network quarantine on/off.
    - name: auto_immune_on
      required: true
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Automatic immune on/off.
    - name: auto_decommission_on
      required: true
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Automatic decommission on/off.
    - name: auto_decommission_days
      required: true
      description: Automatic decommission period in days.
    - name: research_on
      required: true
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Share data with SentinelOne.
    - name: show_suspicious_on
      required: true
      description: Show suspicious activities
      auto: PREDEFINED
      predefined:
      - "true"
      - "false"
    description: Create Policy.
  - name: so-get-policy
    arguments:
    - name: policy_id
      required: true
      description: The policy id.
    description: Get policy
  - name: so-update-policy
    arguments:
    - name: policy_id
      required: true
      description: The policy id.
    - name: name
      required: true
      description: The policy name.
    - name: cloud_validation_on
      required: true
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Cloud validation mode on/off.
    - name: auto_mitigation_action
      required: true
      auto: PREDEFINED
      predefined:
      - mitigation.none
      - mitigation.killThreat
      - mitigation.quarantineThreat
      - mitigation.remediateThreat
      - mitigation.rollbackThreat
      description: The automatic mitigation action.
    - name: network_quarantine_on
      required: true
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Automatic network quarantine on/off.
    - name: auto_immune
      required: true
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Automatic immune on/off.
    - name: auto_decommission_on
      required: true
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Automatic decommission on/off.
    - name: auto_decommission_days
      required: true
      description: Automatic decommission period in days.
    - name: research_on
      required: true
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Share data with SentinelOne.
    description: Create Policy.
  - name: so-delete-policy
    arguments:
    - name: policy_id
      required: true
      description: The policy id.
    description: Delete policy
  - name: so-get-threat
    arguments:
    - name: threat_id
      required: true
      description: The threat id.
    outputs:
    - contextPath: SentinelOne.Threats.GetThreat.ThreatId
      description: The threat id.
    - contextPath: SentinelOne.Threats.GetThreat.Agent
      description: Affected agent id
    - contextPath: SentinelOne.Threats.GetThreat.AgentVersion
      description: The agent software version.
    - contextPath: SentinelOne.Threats.GetThreat.CreatedDate
      description: The occurrence date.
    - contextPath: SentinelOne.Threats.GetThreat.Description
      description: The threat description.
    - contextPath: SentinelOne.Threats.GetThreat.SilentThreat
      description: Silent threat.
    - contextPath: SentinelOne.Threats.GetThreat.InQuarantine
      description: Quarantined threat.
    - contextPath: SentinelOne.Threats.GetThreat.InLearningMode
      description: Learning mode threat.
    - contextPath: SentinelOne.Threats.GetThreat.Resolved
      description: Resolved threat.
    - contextPath: SentinelOne.Threats.GetThreat.Hidden
      description: Hidden threat.
    - contextPath: SentinelOne.Threats.GetThreat.Suspicious
      description: Suspicious threat.
    - contextPath: SentinelOne.Threats.GetThreat.LearningMode
      description: Learning mode threat.
    - contextPath: SentinelOne.Threats.GetThreat.MitigationActions
      description: List of mitigation actions.
    - contextPath: SentinelOne.Threats.GetThreat.MitigationResults
      description: Mitigation results.
    - contextPath: SentinelOne.Threats.GetThreat.MitigationStatus
      description: Threat status.
    - contextPath: SentinelOne.Threats.GetThreat.KillSuccess
      description: Threat killed report status.
    - contextPath: SentinelOne.Threats.GetThreat.QuarantineStatus
      description: Threat quarantine report status.
    - contextPath: SentinelOne.Threats.GetThreat.RemediateStatus
      description: Threat remediate report status.
    - contextPath: SentinelOne.Threats.GetThreat.RollbackStatus
      description: Threat rollback report status.
    - contextPath: SentinelOne.Threats.GetThreat.NetworkQuarantineStatus
      description: Agent quarantine report status.
    - contextPath: SentinelOne.Threats.GetThreat.AffectedFiles
      description: affected_files.
    - contextPath: SentinelOne.Threats.GetThreat.MaliciousGroupId
      description: The file group id
    - contextPath: SentinelOne.Threats.GetThreat.FileId
      description: The file object id
    - contextPath: SentinelOne.Threats.GetThreat.FilePermission
      description: The file permissions
    - contextPath: SentinelOne.Threats.GetThreat.FilePath
      description: The file path
    - contextPath: SentinelOne.Threats.GetThreat.FileContentHash
      description: The file content hash.
    - contextPath: SentinelOne.Threats.GetThreat.FileSize
      description: The file size (Bytes)
    - contextPath: SentinelOne.Threats.GetThreat.IsSystemFile
      description: Is system file.
    - contextPath: SentinelOne.Threats.GetThreat.FileName
      description: File name.
    - contextPath: SentinelOne.Threats.GetThreat.CreatedAt
      description: Threat object creation time.
    - contextPath: SentinelOne.Threats.GetThreat.UpdatedAt
      description: Threat object updated time.
    description: Get threat
  - name: so-get-threats
    arguments:
    - name: content_hash
      description: Threat's content hash.
    - name: mitigation_status
      auto: PREDEFINED
      predefined:
      - "0"
      - "1"
      - "2"
      - "3"
      - "4"
      - "5"
      description: Threat's mitigation status. Allowed values 0- Mitigated, 1- Active, 2-Blocked, 3- Suspicious, 4- Pending, 5- Suspicious canceled
    - name: created_at__lt
      description: System creation date (less than).
    - name: created_at__gt
      description: System creation date (greater than).
    - name: created_at__lte
      description: System creation date (less than or equal).
    - name: created_at__gte
      description: System creation date (greater than or equal).
    - name: updated_at__lt
      description: ystem update date (less than).
    - name: updated_at__gt
      description: System update date (greater than).
    - name: updated_at__lte
      description: ystem update date (less than or equal).
    - name: updated_at__gte
      description: System update date (greater than or equal).
    - name: resolved
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Resolved threat yes/no
    - name: hidden
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
      description: Hidden threat yes/no
    - name: display_name
      description: Threat display name.
    - name: skip
      description: Skip a number of items
    - name: limit
      description: Limit a number of items in the query. Default is 50
      defaultValue: "50"
    description: Get threats
  - name: so-threat-summary
    arguments: []
    description: Threats summary
  - name: so-mark-as-threat
    arguments:
    - name: threat_id
      required: true
      default: true
      description: ID of threat
    description: Mark as Threat
  - name: so-mitigate-threat
    arguments:
    - name: threat_id
      description: The threat id
      required: true
      default: true
    - name: action
      required: true
      auto: PREDEFINED
      predefined:
      - kill
      - quarantine
      - un-quarantine
      - remediate
      - rollback-remediation
      description: The action to take
    description: Mitigate threat
  - name: so-reslove-threats
    arguments:
    - name: threat_id
      required: true
      default: true
      description: The ID of the threat
    description: Resolve threats
tests:
- no test
