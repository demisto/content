id: Silverfort-test
version: 21
name: Silverfort-test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 74c9c774-f2b4-4642-80f1-44cdc6c9aa5e
    type: start
    task:
      id: 74c9c774-f2b4-4642-80f1-44cdc6c9aa5e
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "1":
    id: "1"
    taskid: 58cabd42-723c-4d40-8c24-3209b051747e
    type: regular
    task:
      id: 58cabd42-723c-4d40-8c24-3209b051747e
      version: -1
      name: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "2"
      - "9"
      - "10"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 200
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "2":
    id: "2"
    taskid: 1cfbe583-ebc4-421b-87e5-4f5e7d6c0533
    type: regular
    task:
      id: 1cfbe583-ebc4-421b-87e5-4f5e7d6c0533
      version: -1
      name: silverfort-get-user-risk
      script: '|||silverfort-get-user-risk'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      domain: {}
      email: {}
      sam_account: {}
      upn:
        simple: sfuser@silverfort.io
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "3":
    id: "3"
    taskid: 68c82d64-05b1-4418-8180-a90ea725e986
    type: condition
    task:
      id: 68c82d64-05b1-4418-8180-a90ea725e986
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "4"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Silverfort.UserRisk.Risk
            iscontext: true
          right:
            value:
              simple: Low
      - - operator: isEqualString
          left:
            value:
              simple: Silverfort.UserRisk.Reasons
            iscontext: true
          right:
            value:
              simple: Password never expires
      - - operator: isEqualString
          left:
            value:
              simple: Silverfort.UserRisk.UPN
            iscontext: true
          right:
            value:
              simple: sfuser@silverfort.io
    view: |-
      {
        "position": {
          "x": 50,
          "y": 600
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "4":
    id: "4"
    taskid: 9d62ab81-9937-42a0-81f0-925065c59b69
    type: regular
    task:
      id: 9d62ab81-9937-42a0-81f0-925065c59b69
      version: -1
      name: silverfort-get-resource-risk
      script: '|||silverfort-get-resource-risk'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      domain_name:
        simple: silverfort.io
      resource_name:
        simple: SF-DC-1
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 800
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "5":
    id: "5"
    taskid: cf6bcf37-4a58-4ac9-819e-feb152da40d5
    type: condition
    task:
      id: cf6bcf37-4a58-4ac9-819e-feb152da40d5
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "6"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Silverfort.ResourceRisk.Risk
            iscontext: true
          right:
            value:
              simple: High
      - - operator: isEqualString
          left:
            value:
              simple: Silverfort.ResourceRisk.Reasons
            iscontext: true
          right:
            value:
              simple: Malware detected
      - - operator: isEqualString
          left:
            value:
              simple: Silverfort.ResourceRisk.ResourceName
            iscontext: true
          right:
            value:
              simple: SF-DC-1
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1000
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "6":
    id: "6"
    taskid: 8f0f4504-8684-451f-8b9b-95102ecd1e8e
    type: regular
    task:
      id: 8f0f4504-8684-451f-8b9b-95102ecd1e8e
      version: -1
      name: silverfort-update-user-risk
      script: '|||silverfort-update-user-risk'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      description:
        simple: Suspicious activity
      domain: {}
      email: {}
      risk_name:
        simple: activity_risk
      sam_account: {}
      severity:
        simple: medium
      upn:
        simple: sfuser@silverfort.io
      valid_for:
        simple: "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1200
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "7":
    id: "7"
    taskid: c0c9ad4e-d87f-4250-8bdb-e050d01c2f91
    type: regular
    task:
      id: c0c9ad4e-d87f-4250-8bdb-e050d01c2f91
      version: -1
      name: silverfort-update-resource-risk
      script: '|||silverfort-update-resource-risk'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      description:
        simple: Malware detected
      domain_name:
        simple: silverfort.io
      resource_name:
        simple: SF-DC-1
      risk_name:
        simple: malware_risk
      severity:
        simple: high
      valid_for:
        simple: "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "8":
    id: "8"
    taskid: dcbd3823-07d6-4fc9-88c7-d12bbf540597
    type: title
    task:
      id: dcbd3823-07d6-4fc9-88c7-d12bbf540597
      version: -1
      name: Test Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1600
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "9":
    id: "9"
    taskid: cf86d354-4ae6-4413-8c74-eb4b348d0216
    type: regular
    task:
      id: cf86d354-4ae6-4413-8c74-eb4b348d0216
      version: -1
      name: silverfort-get-user-risk buy sam account&domain
      script: '|||silverfort-get-user-risk'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      domain:
        simple: silverfort.io
      email: {}
      sam_account:
        simple: sfuser
      upn: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "10":
    id: "10"
    taskid: 2e040bf7-0a64-486f-882e-5991486d2801
    type: regular
    task:
      id: 2e040bf7-0a64-486f-882e-5991486d2801
      version: -1
      name: silverfort-get-user-risk by email&domain
      script: '|||silverfort-get-user-risk'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      domain:
        simple: silverfort.io
      email:
        simple: sfuser@silverfort.com
      sam_account: {}
      upn: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -350,
          "y": 400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1615,
        "width": 1180,
        "x": -350,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
