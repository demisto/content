id: Silverfort Update Risk for Domain Admins Incidents
version: -1
rolename:
- Read-Only
name: Silverfort Update Risk for Domain Admins Incidents
description: This playbook Gets Brute Force attack incident, Blocks the user and updates
  Silverfort.
starttaskid: '0'
tasks:
  '0':
    id: '0'
    taskid: 193ff948-e457-4ab4-8183-9348c1c894c5
    type: start
    task:
      id: 193ff948-e457-4ab4-8183-9348c1c894c5
      version: -1
      name: ''
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '10'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  '1':
    id: '1'
    taskid: 0d8c48d5-4deb-498e-859b-83da67f5621a
    type: title
    task:
      id: 0d8c48d5-4deb-498e-859b-83da67f5621a
      version: -1
      name: Update User Risk in Silverfort
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '16'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  '2':
    id: '2'
    taskid: d3e89a7c-5761-4cef-82fb-983658fe6258
    type: regular
    task:
      id: d3e89a7c-5761-4cef-82fb-983658fe6258
      version: -1
      name: Update the user risk in Silverfort
      description: ''
      script: '|||silverfort-update-user-risk'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '12'
    scriptarguments:
      description:
        simple: Suspicious activity
      domain:
        simple: ${Account.Domain.Domain}
      email: {}
      risk_name:
        simple: activity_risk
      sam_account:
        simple: ${ActiveDirectory.Users.sAMAccountName}
      severity:
        simple: medium
      upn: {}
      valid_for:
        simple: '1'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  '10':
    id: '10'
    taskid: 5634c03f-b0fc-4b38-872c-26132a8fa9c4
    type: playbook
    task:
      id: 5634c03f-b0fc-4b38-872c-26132a8fa9c4
      version: -1
      name: Account Enrichment - Generic v2.1
      description: ''
      playbookName: Account Enrichment - Generic v2.1
      type: playbook
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '17'
    scriptarguments:
      Username:
        complex:
          root: Account
          accessor: Username
    separatecontext: false
    loop:
      iscommand: false
      exitCondition: ''
      wait: 1
    view: |-
      {
        "position": {
          "x": 265,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  '12':
    id: '12'
    taskid: 18b08b98-887a-4f4c-8524-11a3938e0dd9
    type: title
    task:
      id: 18b08b98-887a-4f4c-8524-11a3938e0dd9
      version: -1
      name: Silverfort Risk Updated Successfully
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '15'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1215
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  '13':
    id: '13'
    taskid: d15d112a-1639-4ef4-82fa-b25589e55488
    type: condition
    task:
      id: d15d112a-1639-4ef4-82fa-b25589e55488
      version: -1
      name: Is the Account a Domain Admin?
      type: condition
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#default#':
      - '14'
      'yes':
      - '1'
    separatecontext: false
    conditions:
    - label: 'yes'
      condition:
      - - operator: containsString
          left:
            value:
              simple: ADMembership
            iscontext: true
          right:
            value:
              simple: Domain Admins
    view: |-
      {
        "position": {
          "x": 265,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  '14':
    id: '14'
    taskid: 7459d73d-89fa-4483-804c-536b4964bb81
    type: title
    task:
      id: 7459d73d-89fa-4483-804c-536b4964bb81
      version: -1
      name: Do Nothing
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '15'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1215
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  '15':
    id: '15'
    taskid: 1c741b57-0f6f-41e8-8944-047c8df3c3e9
    type: title
    task:
      id: 1c741b57-0f6f-41e8-8944-047c8df3c3e9
      version: -1
      name: End
      type: title
      iscommand: false
      brand: ''
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1360
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  '16':
    id: '16'
    taskid: 9b0c9557-ffed-49e5-8872-ddbf758da837
    type: regular
    task:
      id: 9b0c9557-ffed-49e5-8872-ddbf758da837
      version: -1
      name: Extract Domain from DN
      scriptName: ExtractDomainFromDN
      type: regular
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '2'
    scriptarguments:
      dn:
        simple: ${ActiveDirectory.Users.dn}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 865
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  '17':
    id: '17'
    taskid: f4d4547a-8882-4198-84a3-f2f6e3dbf1c6
    type: regular
    task:
      id: f4d4547a-8882-4198-84a3-f2f6e3dbf1c6
      version: -1
      name: ExtractADMembership
      description: ''
      scriptName: Set
      type: regular
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '13'
    scriptarguments:
      append: {}
      key:
        simple: ADMembership
      stringify: {}
      value:
        simple: ${ActiveDirectory.Users.memberOf}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1375,
        "width": 810,
        "x": 50,
        "y": 50
      }
    }
  }
inputs:
- key: Username
  value:
    complex:
      root: Account
      accessor: Username
      transformers:
      - operator: uniq
  required: false
  description: Account Username
outputs: []
fromversion: 5.0.0
