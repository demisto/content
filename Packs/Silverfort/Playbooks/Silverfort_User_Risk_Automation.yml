id: Silverfort User Risk Automation
version: -1
rolename:
- Read-Only
name: Silverfort User Risk Automation
description: This playbook gets the user risk from Silverfort DB. If the risk is medium
  or higher, the user will be blocked & alert will be sent.
starttaskid: '0'
tasks:
  '0':
    id: '0'
    taskid: 91ebdb53-730d-45a6-827a-e5f42c428da4
    type: start
    task:
      id: 91ebdb53-730d-45a6-827a-e5f42c428da4
      version: -1
      name: ''
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '10'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  '2':
    id: '2'
    taskid: 627cda6e-935f-4db1-8a50-e06969801ebc
    type: regular
    task:
      id: 627cda6e-935f-4db1-8a50-e06969801ebc
      version: -1
      name: Get User Risk from Silverfort
      description: ''
      script: '|||silverfort-get-user-risk'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '5'
    scriptarguments:
      domain:
        simple: ${Account.Domain.Domain}
      email: {}
      sam_account:
        simple: ${ActiveDirectory.Users.sAMAccountName}
      upn: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  '5':
    id: '5'
    taskid: 5b06464d-6697-441b-8db4-525c21d89c65
    type: condition
    task:
      id: 5b06464d-6697-441b-8db4-525c21d89c65
      version: -1
      name: Check Silverfort User Risk
      type: condition
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      HighOrCritical:
      - '7'
      LowOrMedium:
      - '8'
    separatecontext: false
    conditions:
    - label: HighOrCritical
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Silverfort.UserRisk.Risk
            iscontext: true
          right:
            value:
              simple: High
        - operator: isEqualString
          left:
            value:
              simple: Silverfort.UserRisk.Risk
            iscontext: true
          right:
            value:
              simple: Critical
    - label: LowOrMedium
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Silverfort.UserRisk.Risk
            iscontext: true
          right:
            value:
              simple: Low
        - operator: isEqualString
          left:
            value:
              simple: Silverfort.UserRisk.Risk
            iscontext: true
          right:
            value:
              simple: Medium
    view: |-
      {
        "position": {
          "x": 265,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  '7':
    id: '7'
    taskid: 44425412-ffb6-448b-8856-70bb40bed260
    type: title
    task:
      id: 44425412-ffb6-448b-8856-70bb40bed260
      version: -1
      name: Block the user in AD
      type: title
      iscommand: false
      brand: ''
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  '8':
    id: '8'
    taskid: 0419769e-0d4d-48c1-80c5-fb5ab65508f7
    type: title
    task:
      id: 0419769e-0d4d-48c1-80c5-fb5ab65508f7
      version: -1
      name: DoNothing
      type: title
      iscommand: false
      brand: ''
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  '9':
    id: '9'
    taskid: 7e19ee9f-619f-4a1b-8f32-10a0fd549f3a
    type: regular
    task:
      id: 7e19ee9f-619f-4a1b-8f32-10a0fd549f3a
      version: -1
      name: Extract domain from DN
      scriptName: ExtractDomainFromDN
      type: regular
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '2'
    scriptarguments:
      dn:
        simple: ${ActiveDirectory.Users.dn}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  '10':
    id: '10'
    taskid: 0f2d6fbc-e3bd-4497-89ff-17eab8830ad8
    type: playbook
    task:
      id: 0f2d6fbc-e3bd-4497-89ff-17eab8830ad8
      version: -1
      name: Account Enrichment - Generic v2.1
      playbookName: Account Enrichment - Generic v2.1
      type: playbook
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '9'
    scriptarguments:
      Username:
        complex:
          root: Account
          accessor: Username
          transformers:
          - operator: uniq
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ''
      wait: 1
    view: |-
      {
        "position": {
          "x": 265,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 910,
        "width": 810,
        "x": 50,
        "y": 50
      }
    }
  }
inputs:
- key: Username
  value:
    complex:
      root: Account
      accessor: Username
      transformers:
      - operator: uniq
  required: false
  description: Account Username
outputs: []
fromversion: 5.0.0
