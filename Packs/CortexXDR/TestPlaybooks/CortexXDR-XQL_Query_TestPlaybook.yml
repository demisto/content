id: Cortex XDR - XQL Query - Test
version: -1
vcShouldKeepItemLegacyProdMachine: false
name: Cortex XDR - XQL Query - Test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 93fbe742-2b28-41f7-83a5-5ac8556d44ce
    type: start
    task:
      id: 93fbe742-2b28-41f7-83a5-5ac8556d44ce
      version: -1
      name: ""
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 281b5993-7fea-4fb4-8738-84dc5baa42e8
    type: regular
    task:
      id: 281b5993-7fea-4fb4-8738-84dc5baa42e8
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: a04d17ac-e9c3-452b-83b8-16c3273d1147
    type: title
    task:
      id: a04d17ac-e9c3-452b-83b8-16c3273d1147
      version: -1
      name: Generic Queries
      type: title
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "3"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 405
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: ddf20606-65e3-4106-8fd6-4b1ab3a779de
    type: regular
    task:
      id: ddf20606-65e3-4106-8fd6-4b1ab3a779de
      version: -1
      name: XDR start xql query
      description: Execute an XQL query and retrieve results of an executed XQL query
        API. The command will be executed every 10 seconds until results are retrieved
        or until a timeout error is raised.
      script: '|||xdr-xql-generic-query'
      type: regular
      iscommand: true
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      query:
        simple: "dataset = xdr_data\n | filter event_type = EVENT_LOG \n | fields
          action_evtlog_message, event_id\n| limit 10"
      query_name:
        simple: PlaybookTest1
      time_frame:
        simple: 1 month
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 575
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: f51ddf5b-68b5-444a-81b1-85c404497ee9
    type: condition
    task:
      id: f51ddf5b-68b5-444a-81b1-85c404497ee9
      version: -1
      name: Verify query results
      type: condition
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      "yes":
      - "5"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PaloAltoNetworksXQL.GenericQuery
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: PaloAltoNetworksXQL.GenericQuery.query_name
                      iscontext: true
                    right:
                      value:
                        simple: PlaybookTest1
                accessor: execution_id
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              complex:
                root: PaloAltoNetworksXQL.GenericQuery
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: PaloAltoNetworksXQL.GenericQuery.query_name
                      iscontext: true
                    right:
                      value:
                        simple: PlaybookTest1
                accessor: status
            iscontext: true
          right:
            value:
              simple: SUCCESS
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 760
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 5cd66c63-ef9d-4f32-8d08-885a0ddbec5c
    type: regular
    task:
      id: 5cd66c63-ef9d-4f32-8d08-885a0ddbec5c
      version: -1
      name: XDR get query results
      description: Retrieve results of an executed XQL query API.
      script: '|||xdr-xql-get-query-results'
      type: regular
      iscommand: true
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      query_id:
        complex:
          root: PaloAltoNetworksXQL.GenericQuery
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: PaloAltoNetworksXQL.GenericQuery.query_name
                iscontext: true
              right:
                value:
                  simple: PlaybookTest1
          accessor: execution_id
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: dced7bc0-4b8f-4e79-80d3-77fc458fea04
    type: condition
    task:
      id: dced7bc0-4b8f-4e79-80d3-77fc458fea04
      version: -1
      name: Verify query results
      type: condition
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      "yes":
      - "7"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXQL.GenericQuery.execution_id
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: PaloAltoNetworksXQL.GenericQuery.status
            iscontext: true
          right:
            value:
              simple: SUCCESS
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1130
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: 0665912e-9997-4f2c-8fcd-4e37bebc6829
    type: regular
    task:
      id: 0665912e-9997-4f2c-8fcd-4e37bebc6829
      version: -1
      name: XDR get quota
      description: Retrieve the amount of query quota available and used.
      script: '|||xdr-xql-get-quota'
      type: regular
      iscommand: true
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "8"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1315
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: e32b1058-fbc4-487c-82f6-adbd46dabb76
    type: condition
    task:
      id: e32b1058-fbc4-487c-82f6-adbd46dabb76
      version: -1
      name: Verify quota results
      type: condition
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      "yes":
      - "11"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXQL.Quota.license_quota
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXQL.Quota.used_quota
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1500
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: d2c44954-fec6-4c85-8ab8-21f281c38266
    type: title
    task:
      id: d2c44954-fec6-4c85-8ab8-21f281c38266
      version: -1
      name: Built-In Queries
      type: title
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "10"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: 65c65186-3fde-44bb-858c-e753fa025e0c
    type: regular
    task:
      id: 65c65186-3fde-44bb-858c-e753fa025e0c
      version: -1
      name: XDR file event query
      description: Query file events by file sha256.
      script: '|||xdr-xql-file-event-query'
      type: regular
      iscommand: true
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      endpoint_id:
        simple: '*'
      file_sha256:
        simple: '*'
      limit:
        simple: "1"
      query_name:
        simple: FileEvent1
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 7f403930-970c-47f4-8c6c-6b169b84e235
    type: regular
    task:
      id: 7f403930-970c-47f4-8c6c-6b169b84e235
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1685
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 2c06f096-d723-48f7-8ab0-082650f1cfe9
    type: regular
    task:
      id: 2c06f096-d723-48f7-8ab0-082650f1cfe9
      version: -1
      name: XDR dll module query
      description: Query DLL module events by DLL sha256.
      script: '|||xdr-xql-dll-module-query'
      type: regular
      iscommand: true
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      endpoint_id:
        simple: '*'
      limit:
        simple: "2"
      loaded_module_sha256:
        simple: '*'
      query_name:
        simple: DllModule1
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: 6ca2c2e2-29b1-48b9-84fa-f5f8f775d033
    type: regular
    task:
      id: 6ca2c2e2-29b1-48b9-84fa-f5f8f775d033
      version: -1
      name: XDR network connection query
      description: Query network connections between a source ip, destination ip and
        port.
      script: '|||xdr-xql-network-connection-query'
      type: regular
      iscommand: true
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      endpoint_id:
        simple: '*'
      limit:
        simple: "2"
      local_ip:
        simple: '*'
      port:
        simple: "4444"
      query_name:
        simple: NetworkConnection1
      remote_ip:
        simple: '*'
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: 56cd0b81-b01e-443e-85bb-e378344bef97
    type: regular
    task:
      id: 56cd0b81-b01e-443e-85bb-e378344bef97
      version: -1
      name: XDR registry query
      description: Query windows registry by registry key name.
      script: '|||xdr-xql-registry-query'
      type: regular
      iscommand: true
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "21"
    scriptarguments:
      endpoint_id:
        simple: '*'
      limit:
        simple: "2"
      query_name:
        simple: Registry1
      reg_key_name:
        simple: '*'
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2780
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: a017a28a-d110-4eeb-802d-802b7d36531e
    type: regular
    task:
      id: a017a28a-d110-4eeb-802d-802b7d36531e
      version: -1
      name: XDR event log query
      description: Query event logs by event ID.
      script: '|||xdr-xql-event-log-query'
      type: regular
      iscommand: true
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      endpoint_id:
        simple: '*'
      event_id:
        simple: "4444"
      limit:
        simple: "2"
      query_name:
        simple: EventLog1
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2965
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: 80009096-308d-4e40-8c43-fefab670458a
    type: regular
    task:
      id: 80009096-308d-4e40-8c43-fefab670458a
      version: -1
      name: XDR dns query
      description: Query by dns query or domain name.
      script: '|||xdr-xql-dns-query'
      type: regular
      iscommand: true
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "25"
    scriptarguments:
      endpoint_id:
        simple: '*'
      external_domain:
        simple: '*'
      limit:
        simple: "2"
      query_name:
        simple: DNS1
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3150
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "25":
    id: "25"
    taskid: 1c742401-45dd-4bc2-87ae-7cca0317ef57
    type: regular
    task:
      id: 1c742401-45dd-4bc2-87ae-7cca0317ef57
      version: -1
      name: XDR file dropper query
      description: Search for the process who wrote the given file, by its sha256
        or file path.
      script: '|||xdr-xql-file-dropper-query'
      type: regular
      iscommand: true
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      endpoint_id:
        simple: '*'
      file_path:
        simple: '*'
      file_sha256:
        simple: '*'
      limit:
        simple: "2"
      query_name:
        simple: FileDropper1
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3335
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: ab1a1f4b-5a16-4513-8758-586f319cbf81
    type: regular
    task:
      id: ab1a1f4b-5a16-4513-8758-586f319cbf81
      version: -1
      name: XDR process instance network activity query
      description: Search for network connection created by a given process instace
        ID.
      script: '|||xdr-xql-process-instance-network-activity-query'
      type: regular
      iscommand: true
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      endpoint_id:
        simple: '*'
      limit:
        simple: "2"
      process_instace_id:
        simple: '*'
      process_instance_id:
        simple: '*'
      query_name:
        simple: ProcessInstanceNetwork1
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: f3c70dd4-9b1d-42f1-88c5-2a45909956bf
    type: regular
    task:
      id: f3c70dd4-9b1d-42f1-88c5-2a45909956bf
      version: -1
      name: XDR process instance causality activity query
      description: Search for network connection created by a given process causality
        ID.
      script: '|||xdr-xql-process-causality-network-activity-query'
      type: regular
      iscommand: true
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      endpoint_id:
        simple: '*'
      limit:
        simple: "2"
      process_causality_id:
        simple: '*'
      query_name:
        simple: ProcessInstanceCasuality1
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3705
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: 5f09bb7e-0c46-427e-8c6a-ed4d4f142b88
    type: condition
    task:
      id: 5f09bb7e-0c46-427e-8c6a-ed4d4f142b88
      version: -1
      name: Verify query results
      type: condition
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      "yes":
      - "33"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PaloAltoNetworksXQL.FileEvent
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: PaloAltoNetworksXQL.FileEvent.query_name
                      iscontext: true
                    right:
                      value:
                        simple: FileEvent1
                accessor: execution_id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PaloAltoNetworksXQL.ProcessEvent
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: PaloAltoNetworksXQL.ProcessEvent.query_name
                      iscontext: true
                    right:
                      value:
                        simple: ProcessEvent1
                accessor: execution_id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PaloAltoNetworksXQL.DllModule
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: PaloAltoNetworksXQL.DllModule.query_name
                      iscontext: true
                    right:
                      value:
                        simple: DllModule1
                accessor: execution_id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PaloAltoNetworksXQL.NetworkConnection
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: PaloAltoNetworksXQL.NetworkConnection.query_name
                      iscontext: true
                    right:
                      value:
                        simple: NetworkConnection1
                accessor: execution_id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PaloAltoNetworksXQL.Registry
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: PaloAltoNetworksXQL.Registry.query_name
                      iscontext: true
                    right:
                      value:
                        simple: Registry1
                accessor: execution_id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PaloAltoNetworksXQL.EventLog
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: PaloAltoNetworksXQL.EventLog.query_name
                      iscontext: true
                    right:
                      value:
                        simple: EventLog1
                accessor: execution_id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PaloAltoNetworksXQL.DNS
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: PaloAltoNetworksXQL.DNS.query_name
                      iscontext: true
                    right:
                      value:
                        simple: DNS1
                accessor: execution_id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PaloAltoNetworksXQL.FileDropper
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: PaloAltoNetworksXQL.FileDropper.query_name
                      iscontext: true
                    right:
                      value:
                        simple: FileDropper1
                accessor: execution_id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PaloAltoNetworksXQL.ProcessInstanceNetworkActivity
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: PaloAltoNetworksXQL.ProcessInstanceNetworkActivity.query_name
                      iscontext: true
                    right:
                      value:
                        simple: ProcessInstanceNetwork1
                accessor: execution_id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PaloAltoNetworksXQL.ProcessCausalityNetworkActivity
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: PaloAltoNetworksXQL.ProcessCausalityNetworkActivity.query_name
                      iscontext: true
                    right:
                      value:
                        simple: ProcessInstanceCasuality1
                accessor: execution_id
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: 0ecc13e2-215b-4408-8d51-d09472b0c6c5
    type: title
    task:
      id: 0ecc13e2-215b-4408-8d51-d09472b0c6c5
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: b5c0c79d-2e89-4238-8480-9f1722bb44e1
    type: regular
    task:
      id: b5c0c79d-2e89-4238-8480-9f1722bb44e1
      version: -1
      name: XDR process event query
      description: Query process events by process sha256.
      script: '|||xdr-xql-process-event-query'
      type: regular
      iscommand: true
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      endpoint_id:
        simple: '*'
      limit:
        simple: "2"
      process_sha256:
        simple: '*'
      query_name:
        simple: ProcessEvent1
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2225
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: 9b1363c7-5dd0-4236-bae5-9cf9961ecc42
    type: title
    task:
      id: 9b1363c7-5dd0-4236-bae5-9cf9961ecc42
      version: -1
      name: Library Query V4
      type: title
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "34"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4075
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: 91a260f8-d4fb-4a5d-bbcf-b3bb5c16caa8
    type: regular
    task:
      id: 91a260f8-d4fb-4a5d-bbcf-b3bb5c16caa8
      version: -1
      name: List Queries
      description: Gets a list of XQL queries from the library.
      script: Cortex XDR - XQL Query Engine|||xdr-xql-library-list
      type: regular
      iscommand: true
      brand: Cortex XDR - XQL Query Engine
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "35"
    scriptarguments:
      extra_data:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: 0c439ae2-4a95-4540-a8d0-070c701d0ba4
    type: regular
    task:
      id: 0c439ae2-4a95-4540-a8d0-070c701d0ba4
      version: -1
      name: Create Query
      description: Creates or updates XQL queries in the library.
      script: Cortex XDR - XQL Query Engine|||xdr-xql-library-create
      type: regular
      iscommand: true
      brand: Cortex XDR - XQL Query Engine
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      override_existing:
        simple: "true"
      xql_query:
        simple: '"TPB TEST | TEST"'
      xql_query_name:
        simple: '"TPB TEST"'
      xql_query_tag:
        simple: '"TPB TEST TAG"'
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4430
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: b93ea0c4-354e-4afa-86b3-23c7c753aa87
    type: regular
    task:
      id: b93ea0c4-354e-4afa-86b3-23c7c753aa87
      version: -1
      name: Search Query
      description: Gets a list of XQL queries from the library.
      script: Cortex XDR - XQL Query Engine|||xdr-xql-library-list
      type: regular
      iscommand: true
      brand: Cortex XDR - XQL Query Engine
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "37"
    scriptarguments:
      xql_query_name:
        simple: '"TPB TEST"'
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: 19ae939d-3abc-4f02-a1dd-ef82be0484bc
    type: condition
    task:
      id: 19ae939d-3abc-4f02-a1dd-ef82be0484bc
      version: -1
      name: Verify Results
      type: condition
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      "yes":
      - "38"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PaloAltoNetworksXQL.Library.name
            iscontext: true
          right:
            value:
              simple: '"TPB TEST"'
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4800
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: 591485f6-0761-44cd-abf6-bebd849f2f39
    type: regular
    task:
      id: 591485f6-0761-44cd-abf6-bebd849f2f39
      version: -1
      name: Delete new Query
      description: Deletes XQL queries from the library.
      script: Cortex XDR - XQL Query Engine|||xdr-xql-library-delete
      type: regular
      iscommand: true
      brand: Cortex XDR - XQL Query Engine
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      xql_query_name:
        simple: '"TPB TEST"'
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4985
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "8_11_yes": 0.87
    },
    "paper": {
      "dimensions": {
        "height": 5180,
        "width": 380,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
fromversion: 5.0.0