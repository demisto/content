id: Test Playbook - Cortex XDR - Retrieve File by sha256
version: -1
name: Test Playbook - Cortex XDR - Retrieve File by sha256
description: "This playbook tests the ‘Cortex XDR - Retrieve File by sha256’ playbook which is part of the ‘Malware Investigation and Response’ pack.\nFollowing are the tests conducted in the playbook:\n1- Ensure that an error message is printed if the 'Cortex XDR - Get File Path from Alerts by Hash' sub-playbook fails to retrieve a file path. \n2- Ensure all context data was extracted properly.\n3- Review and validate the playbook's outputs.\n4- Ensure the 'xdr-file-retrieve' command was successfully executed. \n5 - Ensure that the retrieved files were unzipped using the 'UnzipFile' command "
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: d7d719b6-523b-4b10-8e2d-c2b1a6b8efe5
    type: start
    task:
      id: d7d719b6-523b-4b10-8e2d-c2b1a6b8efe5
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "32"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 630,
          "y": -2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: 03012e0c-fd5e-407c-8704-6e658a63cad7
    type: regular
    task:
      id: 03012e0c-fd5e-407c-8704-6e658a63cad7
      version: -1
      name: Delete Context
      description: The task deletes all of the context data. Having a clean beginning to a test playbook ensures that a test can be sterile and that unrelated issues can be eliminated.
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "154"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 630,
          "y": -2515
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: 063dd8d9-beae-4be2-8160-02aa1162d497
    type: regular
    task:
      id: 063dd8d9-beae-4be2-8160-02aa1162d497
      version: -1
      name: Investigate the incident
      description: Begin investigating the incident.
      type: regular
      iscommand: false
      brand: Builtin
      script: InvestigateMine
    nexttasks:
      '#none#':
      - "255"
    scriptarguments:
      id:
        complex:
          root: CreatedIncidentID
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 630,
          "y": -1705
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: 05914438-24b1-450b-8ed4-717f4a83853f
    type: regular
    task:
      id: 05914438-24b1-450b-8ed4-717f4a83853f
      version: -1
      name: Wait for incident to be created
      description: 'This task delays the playbook flow progress for 15 seconds to ensure that the incident has been created before moving on. '
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "186"
    scriptarguments:
      seconds:
        simple: "15"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 630,
          "y": -2190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "84":
    id: "84"
    taskid: 07d7429f-eb99-48ba-8a3e-54d5ff0c8313
    type: title
    task:
      id: 07d7429f-eb99-48ba-8a3e-54d5ff0c8313
      version: -1
      name: Start Tests
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "210"
      - "249"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 630,
          "y": -1060
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "93":
    id: "93"
    taskid: 000489a5-e952-427f-845c-63b8a8e88575
    type: regular
    task:
      id: 000489a5-e952-427f-845c-63b8a8e88575
      version: -1
      name: Set playbook for new incident
      description: Assign the 'Cortex XDR - Retrieve File by sha256' playbook to the newly created test incident.
      script: Builtin|||setPlaybook
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      incidentId:
        complex:
          root: CreatedIncidentID
      name:
        simple: Cortex XDR - Retrieve File by sha256
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 630,
          "y": -1870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "154":
    id: "154"
    taskid: b4b53325-c338-4204-819b-0a89c325fa22
    type: regular
    task:
      id: b4b53325-c338-4204-819b-0a89c325fa22
      version: -1
      name: Create New Incident For Testing
      description: 'As part of this task, an incident will be created for testing purposes, which includes all the incident fields that are essential to the testing process. '
      script: Builtin|||createNewIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "47"
    scriptarguments:
      deviceid:
        simple: aeec6a2cc92e46fab3b6f621722e9916
      filesha256:
        simple: 652607db7763f423419fd98807a2436f22007e0a54965f24c671bbd1a20197d6
      name:
        simple: Test Incident for Cortex XDR - Retrieve File by sha256
      type:
        simple: Malware Investigation and Response
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 630,
          "y": -2350
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "186":
    id: "186"
    taskid: c0889235-dc9d-40d0-8870-06d9a0c56609
    type: regular
    task:
      id: c0889235-dc9d-40d0-8870-06d9a0c56609
      version: -1
      name: Set 'fileRetrieval.path' To Context
      description: For testing purposes, the task establishes the context data key and value for 'fileRetrieval.path'.
      scriptName: SetByIncidentId
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "93"
    scriptarguments:
      id:
        complex:
          root: CreatedIncidentID
      key:
        simple: fileRetrieval.path
      value:
        simple: C:\Windows\System32\lsass.exe
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 630,
          "y": -2030
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "202":
    id: "202"
    taskid: 5a19b9e2-31f8-4ef6-8077-4b177b8a8a0c
    type: title
    task:
      id: 5a19b9e2-31f8-4ef6-8077-4b177b8a8a0c
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 670,
          "y": -70
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "203":
    id: "203"
    taskid: 6cfa4ac0-fec9-4cc3-8b47-9c7d3df8156c
    type: regular
    task:
      id: 6cfa4ac0-fec9-4cc3-8b47-9c7d3df8156c
      version: -1
      name: Wait for playbook to end running
      description: Wait until the final task (Done) has been completed before starting tests.
      scriptName: WaitAndCompleteTask
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "208"
    scriptarguments:
      complete_task:
        simple: "false"
      incident_id:
        complex:
          root: CreatedIncidentID
      interval_between_tries:
        simple: "10"
      max_timeout:
        simple: "300"
      task_name:
        simple: Done
      task_states:
        simple: Completed
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 630,
          "y": -1385
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "208":
    id: "208"
    taskid: 01103474-a098-4412-84f9-37ebc1e34f5a
    type: regular
    task:
      id: 01103474-a098-4412-84f9-37ebc1e34f5a
      version: -1
      name: Close Incident
      description: commands.local.cmd.close.inv
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "84"
    scriptarguments:
      closeNotes:
        simple: Done testing mocked incident for 'Test Playbook - Cortex XDR - Retrieve File by sha256' playbook.
      id:
        complex:
          root: CreatedIncidentID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 630,
          "y": -1220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "209":
    id: "209"
    taskid: ec0874d1-db70-44a9-84fb-f02c246965c3
    type: regular
    task:
      id: ec0874d1-db70-44a9-84fb-f02c246965c3
      version: -1
      name: Get the final 'PaloAltoNetworksXDR.RetrievedFiles' context
      description: Gets a value from the specified incident's context.
      scriptName: GetByIncidentId
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "211"
    scriptarguments:
      get_key:
        simple: PaloAltoNetworksXDR.RetrievedFiles
      incident_id:
        complex:
          root: CreatedIncidentID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1330,
          "y": -780
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "210":
    id: "210"
    taskid: a1d36eb5-5981-4000-80e0-5a90224e170b
    type: title
    task:
      id: a1d36eb5-5981-4000-80e0-5a90224e170b
      version: -1
      name: Check Context Data
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "209"
      - "222"
      - "226"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 630,
          "y": -920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "211":
    id: "211"
    taskid: cb48c3c4-1a81-4df4-8e78-296c3057e0f1
    type: title
    task:
      id: cb48c3c4-1a81-4df4-8e78-296c3057e0f1
      version: -1
      name: '''PaloAltoNetworksXDR.RetrievedFiles'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "213"
      - "216"
      - "217"
      - "220"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1330,
          "y": -620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "212":
    id: "212"
    taskid: 2beb247f-380b-4d50-86ff-de23ffe7ec38
    type: title
    task:
      id: 2beb247f-380b-4d50-86ff-de23ffe7ec38
      version: -1
      name: '''ExtractedFiles'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "223"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 0,
          "y": -620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "213":
    id: "213"
    taskid: 060926ea-5892-4f75-89a1-c63109400428
    type: condition
    task:
      id: 060926ea-5892-4f75-89a1-c63109400428
      version: -1
      name: Verify Action ID
      description: Verify that the 'PaloAltoNetworksXDR.RetrievedFiles.action_id’ context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "214"
      Verified:
      - "215"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.RetrievedFiles
                accessor: action_id
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2540,
          "y": -480
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "214":
    id: "214"
    taskid: 005bf601-3bd7-4e21-8760-4d527fe675e2
    type: regular
    task:
      id: 005bf601-3bd7-4e21-8760-4d527fe675e2
      version: -1
      name: Verify Context Error - Action ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'PaloAltoNetworksXDR.RetrievedFiles.action_id’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR - Retrieve File by sha256' playbook:
          1- The 'xdr-file-retrieve' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.RetrievedFiles.action_id' context key.
          2- Either the 'endpoint_ids' or the 'generic_file_path' input configurations were changed for the 'xdr-file-retrieve' automation of the 'Cortex XDR - Retrieve File' task.
          3- The automation failed to execute as the host cannot be reached since the endpoint is offline or isolated.
          4- An API error prevented the API call from being made.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2540,
          "y": -255
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "215":
    id: "215"
    taskid: c0130dc4-92db-46cd-8574-b48fae1e117a
    type: title
    task:
      id: c0130dc4-92db-46cd-8574-b48fae1e117a
      version: -1
      name: Done verifying 'PaloAltoNetworksXDR.RetrievedFiles'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "202"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 940,
          "y": -310
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "216":
    id: "216"
    taskid: 4e905138-8185-4680-83ff-dded4fb06705
    type: condition
    task:
      id: 4e905138-8185-4680-83ff-dded4fb06705
      version: -1
      name: Verify Endpoint ID
      description: Verify that the 'PaloAltoNetworksXDR.RetrievedFiles.endpoint_id’ context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "215"
      '#default#':
      - "218"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.RetrievedFiles
                accessor: endpoint_id
            iscontext: true
          right:
            value:
              simple: aeec6a2cc92e46fab3b6f621722e9916
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2140,
          "y": -480
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "217":
    id: "217"
    taskid: 4a22bc42-6d9d-4323-8a73-a284134bb660
    type: condition
    task:
      id: 4a22bc42-6d9d-4323-8a73-a284134bb660
      version: -1
      name: Verify File Link
      description: Verify that the 'PaloAltoNetworksXDR.RetrievedFiles.file_link’ context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "219"
      Verified:
      - "215"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.RetrievedFiles
                accessor: file_link
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1730,
          "y": -480
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "218":
    id: "218"
    taskid: 1b4ca8f3-0f74-4b96-8eb4-6dd1aedca057
    type: regular
    task:
      id: 1b4ca8f3-0f74-4b96-8eb4-6dd1aedca057
      version: -1
      name: Verify Context Error - Endpoint ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'PaloAltoNetworksXDR.RetrievedFiles.endpoint_id’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR - Retrieve File by sha256' playbook:
          1- The file retrieval operation failed (Endpoint ID is added only when the operation succeeds).
          2- The 'xdr-file-retrieve' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.RetrievedFiles.endpoint_id' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2140,
          "y": -255
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "219":
    id: "219"
    taskid: eb384f05-b99c-41fb-81ca-dafed79caf88
    type: regular
    task:
      id: eb384f05-b99c-41fb-81ca-dafed79caf88
      version: -1
      name: Verify Context Error - File Link
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'PaloAltoNetworksXDR.RetrievedFiles.file_link’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR - Retrieve File by sha256' playbook:
          1- The file retrieval operation failed (File link is added only when the operation succeeds).
          2- The 'xdr-file-retrieve' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.RetrievedFiles.file_link' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1730,
          "y": -255
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "220":
    id: "220"
    taskid: ae6eec5c-19af-47ad-8cb6-0afca119422e
    type: condition
    task:
      id: ae6eec5c-19af-47ad-8cb6-0afca119422e
      version: -1
      name: Verify Status
      description: Verify that the 'PaloAltoNetworksXDR.RetrievedFiles.status’ context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "221"
      Verified:
      - "215"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotExists
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.RetrievedFiles
                accessor: status
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1330,
          "y": -480
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "221":
    id: "221"
    taskid: 3354ba4f-72ac-4c32-8685-6bc9e85bbcbf
    type: regular
    task:
      id: 3354ba4f-72ac-4c32-8685-6bc9e85bbcbf
      version: -1
      name: Verify Context Error - Status
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'PaloAltoNetworksXDR.RetrievedFiles.status’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR - Retrieve File by sha256' playbook:
          1- The file retrieval operation failed (Status is added only when the operation is unsuccessful).
          2- The 'xdr-file-retrieve' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.RetrievedFiles.status' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1330,
          "y": -255
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "222":
    id: "222"
    taskid: 2b482879-2403-4b6e-895d-2a1a52ac1b98
    type: regular
    task:
      id: 2b482879-2403-4b6e-895d-2a1a52ac1b98
      version: -1
      name: Get the final 'ExtractedFiles' context
      description: Gets a value from the specified incident's context.
      scriptName: GetByIncidentId
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "212"
    scriptarguments:
      get_key:
        simple: ExtractedFiles
      incident_id:
        complex:
          root: CreatedIncidentID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 0,
          "y": -780
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "223":
    id: "223"
    taskid: 82958444-efeb-4427-8967-b9747c847891
    type: condition
    task:
      id: 82958444-efeb-4427-8967-b9747c847891
      version: -1
      name: Verify Extracted Files
      description: 'Verify that the ''ExtractedFiles'' context key has been extracted correctly and contains both the ''manifest.json'' and ''GoogleUpdate.exe'' files. '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "224"
      Verified:
      - "225"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: ExtractedFiles
            iscontext: true
          right:
            value:
              simple: manifest.json
          ignorecase: true
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: ExtractedFiles
            iscontext: true
          right:
            value:
              simple: lsass.exe
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 0,
          "y": -490
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "224":
    id: "224"
    taskid: ec450142-57ef-4d12-8011-2db1daf506b8
    type: regular
    task:
      id: ec450142-57ef-4d12-8011-2db1daf506b8
      version: -1
      name: Verify Context Error - Extracted Files
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'ExtractedFiles’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR - Retrieve File by sha256' playbook:
          1- The 'lastZipFileInWarroom' input configuration was changed for the 'UnzipFile' automation used in the 'UnZip File' task.
          2-The file retrieval operation fails and either the 'Were any errors?' or the 'Did the file retrieval fail?' tasks were modified, causing the playbook flow to proceed to the 'Unzip File' task, which should not have happened.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 0,
          "y": -255
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "225":
    id: "225"
    taskid: e5efdd8f-9c61-44a0-849b-337430140dea
    type: title
    task:
      id: e5efdd8f-9c61-44a0-849b-337430140dea
      version: -1
      name: Done verifying 'ExtractedFiles'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "202"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 390,
          "y": -310
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "226":
    id: "226"
    taskid: d0707c31-925c-4f20-846f-3ee19b928dea
    type: regular
    task:
      id: d0707c31-925c-4f20-846f-3ee19b928dea
      version: -1
      name: Get the final 'File' context
      description: Gets a value from the specified incident's context.
      scriptName: GetByIncidentId
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "227"
    scriptarguments:
      get_key:
        simple: File
      incident_id:
        complex:
          root: CreatedIncidentID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -960,
          "y": -780
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "227":
    id: "227"
    taskid: d9f9ebc7-a6ef-4ee7-87cc-58e95f638e74
    type: title
    task:
      id: d9f9ebc7-a6ef-4ee7-87cc-58e95f638e74
      version: -1
      name: '''File'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "228"
      - "231"
      - "233"
      - "235"
      - "237"
      - "239"
      - "241"
      - "243"
      - "245"
      - "247"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -960,
          "y": -620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "228":
    id: "228"
    taskid: aaee32b1-8175-4a41-83c7-875ff2894e23
    type: condition
    task:
      id: aaee32b1-8175-4a41-83c7-875ff2894e23
      version: -1
      name: Verify Name
      description: Verify that the 'File.Name' context key has been extracted correctly and contains both ZIP and Unzipped file names.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "229"
      Verified:
      - "230"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: File
                accessor: Name
            iscontext: true
          right:
            value:
              simple: manifest.json
          ignorecase: true
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: File
                accessor: Name
            iscontext: true
          right:
            value:
              simple: lsass.exe
          ignorecase: true
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: File
                accessor: Name
            iscontext: true
          right:
            value:
              simple: aeec6a2cc92e46fab3b6f621722e9916_1.zip
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -4580,
          "y": -470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "229":
    id: "229"
    taskid: d320f7b7-3347-4f5a-8bd3-56888b6c01ef
    type: regular
    task:
      id: d320f7b7-3347-4f5a-8bd3-56888b6c01ef
      version: -1
      name: Verify Context Error - Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'File.Name’ context key was not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR - Retrieve File by sha256' playbook:
          1- The file retrieval operation failed (the 'ExtractedFiles' context key is empty).
          2- The 'lastZipFileInWarroom' input configuration was changed for the 'UnzipFile' automation used in the 'UnZip File' task.
          3- The 'ExtractedFiles' context key does not contain both the 'manifest.json' and 'GoogleUpdate.exe' file names.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -4580,
          "y": -235
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "230":
    id: "230"
    taskid: 913ddb3a-90cf-453a-805d-fe301692251f
    type: title
    task:
      id: 913ddb3a-90cf-453a-805d-fe301692251f
      version: -1
      name: Done verifying 'File'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "202"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -580,
          "y": -300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "231":
    id: "231"
    taskid: 7bf75165-e88d-48f1-8af6-024acf7aa621
    type: condition
    task:
      id: 7bf75165-e88d-48f1-8af6-024acf7aa621
      version: -1
      name: Verify Entry ID
      description: Verify that the 'File.EntryID' context key has been extracted.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "232"
      Verified:
      - "230"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: File
                accessor: EntryID
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -4180,
          "y": -470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "232":
    id: "232"
    taskid: 26b35f6b-9522-4cab-868a-cf4a42fd98c6
    type: regular
    task:
      id: 26b35f6b-9522-4cab-868a-cf4a42fd98c6
      version: -1
      name: Verify Context Error - Entry ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'File.EntryID’ context key was not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR - Retrieve File by sha256' playbook:
          1- The file retrieval operation failed (the 'ExtractedFiles' context key is empty).
          2- The 'lastZipFileInWarroom' input configuration was changed for the 'UnzipFile' automation used in the 'UnZip File' task.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -4180,
          "y": -235
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "233":
    id: "233"
    taskid: 01b62a15-56ea-4290-8dc4-c8833740005c
    type: condition
    task:
      id: 01b62a15-56ea-4290-8dc4-c8833740005c
      version: -1
      name: Verify Size
      description: Verify that the 'File.SHA512' context key has been extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "234"
      Verified:
      - "230"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: File
                accessor: Size
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -3770,
          "y": -470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "234":
    id: "234"
    taskid: 84f5b4bf-2ce5-4e01-857e-6c630771b758
    type: regular
    task:
      id: 84f5b4bf-2ce5-4e01-857e-6c630771b758
      version: -1
      name: Verify Context Error - Size
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'File.Size’ context key was not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR - Retrieve File by sha256' playbook:
          1- The file retrieval operation failed (the 'ExtractedFiles' context key is empty).
          2- The 'lastZipFileInWarroom' input configuration was changed for the 'UnzipFile' automation used in the 'UnZip File' task.
          3- The 'ExtractedFiles' context key does not contain both ZIP and Unzipped file names.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -3770,
          "y": -235
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "235":
    id: "235"
    taskid: 8b3fb5b2-36b4-42f3-8658-26f965a3f35a
    type: condition
    task:
      id: 8b3fb5b2-36b4-42f3-8658-26f965a3f35a
      version: -1
      name: Verify MD5
      description: Verify that the 'File.MD5' context key has been extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "236"
      Verified:
      - "230"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: File
                accessor: MD5
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -3370,
          "y": -470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "236":
    id: "236"
    taskid: accf522e-18d2-40dc-8d48-73fea72aa3fc
    type: regular
    task:
      id: accf522e-18d2-40dc-8d48-73fea72aa3fc
      version: -1
      name: Verify Context Error - MD5
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'File.MD5’ context key was not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR - Retrieve File by sha256' playbook:
          1- The file retrieval operation failed (the 'ExtractedFiles' context key is empty).
          2- The 'lastZipFileInWarroom' input configuration was changed for the 'UnzipFile' automation used in the 'UnZip File' task.
          3- The 'ExtractedFiles' context key does not contain both the 'manifest.json' and 'GoogleUpdate.exe' MD5 hashes.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -3370,
          "y": -235
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "237":
    id: "237"
    taskid: 58093bad-2fbd-4ffb-8a4c-43da01032cc4
    type: condition
    task:
      id: 58093bad-2fbd-4ffb-8a4c-43da01032cc4
      version: -1
      name: Verify SHA1
      description: Verify that the 'File.SHA1' context key has been extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "238"
      Verified:
      - "230"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: File
                accessor: SHA1
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -2960,
          "y": -470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "238":
    id: "238"
    taskid: be0ef5b7-d5b7-4e66-8f6a-a90bb0cc3fe4
    type: regular
    task:
      id: be0ef5b7-d5b7-4e66-8f6a-a90bb0cc3fe4
      version: -1
      name: Verify Context Error - SHA1
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'File.SHA1’ context key was not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR - Retrieve File by sha256' playbook:
          1- The file retrieval operation failed (the 'ExtractedFiles' context key is empty).
          2- The 'lastZipFileInWarroom' input configuration was changed for the 'UnzipFile' automation used in the 'UnZip File' task.
          3- The 'ExtractedFiles' context key does not contain both the 'manifest.json' and 'GoogleUpdate.exe' SHA1 hashes.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -2960,
          "y": -235
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "239":
    id: "239"
    taskid: c3c68bf3-694c-4bd6-8e2e-0a91767059d6
    type: condition
    task:
      id: c3c68bf3-694c-4bd6-8e2e-0a91767059d6
      version: -1
      name: Verify SHA256
      description: 'Verify that the ''File.SHA256'' context key has been extracted correctly.'
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "240"
      Verified:
      - "230"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: File
                accessor: SHA256
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -2560,
          "y": -470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "240":
    id: "240"
    taskid: ec4fe2a4-43cc-43e3-8fda-918db14bae4b
    type: regular
    task:
      id: ec4fe2a4-43cc-43e3-8fda-918db14bae4b
      version: -1
      name: Verify Context Error - SHA256
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'File.SHA256’ context key was not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR - Retrieve File by sha256' playbook:
          1- The file retrieval operation failed (the 'ExtractedFiles' context key is empty).
          2- The 'lastZipFileInWarroom' input configuration was changed for the 'UnzipFile' automation used in the 'UnZip File' task.
          3- The 'ExtractedFiles' context key does not contain both the 'manifest.json' and 'GoogleUpdate.exe' SHA256 hashes.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -2560,
          "y": -235
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "241":
    id: "241"
    taskid: d5a66a13-7d3e-45a1-8334-690e29ffde9a
    type: condition
    task:
      id: d5a66a13-7d3e-45a1-8334-690e29ffde9a
      version: -1
      name: Verify SHA512
      description: 'Verify that the ''File.SHA512'' context key has been extracted correctly.'
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "242"
      Verified:
      - "230"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: File
                accessor: SHA512
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -2160,
          "y": -470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "242":
    id: "242"
    taskid: 5890e022-cc6b-4c8d-89ef-74f9ef6364ab
    type: regular
    task:
      id: 5890e022-cc6b-4c8d-89ef-74f9ef6364ab
      version: -1
      name: Verify Context Error - SHA512
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'File.SHA512’ context key was not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR - Retrieve File by sha256' playbook:
          1- The file retrieval operation failed (the 'ExtractedFiles' context key is empty).
          2- The 'lastZipFileInWarroom' input configuration was changed for the 'UnzipFile' automation used in the 'UnZip File' task.
          3- The 'ExtractedFiles' context key does not contain both the 'manifest.json' and 'GoogleUpdate.exe' SHA512 hashes.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -2160,
          "y": -235
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "243":
    id: "243"
    taskid: 8f6e91a5-cd4b-4765-8c86-58dffaf84b1d
    type: condition
    task:
      id: 8f6e91a5-cd4b-4765-8c86-58dffaf84b1d
      version: -1
      name: Verify Extension
      description: Verify that the 'File.Extension' context key has been extracted correctly and contains both ZIP and Unzipped file extensions.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "244"
      Verified:
      - "230"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: File
                accessor: Extension
            iscontext: true
          right:
            value:
              simple: json
          ignorecase: true
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: File
                accessor: Extension
            iscontext: true
          right:
            value:
              simple: exe
          ignorecase: true
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: File
                accessor: Extension
            iscontext: true
          right:
            value:
              simple: zip
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -1760,
          "y": -470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "244":
    id: "244"
    taskid: 06409208-614d-4f4b-8d6d-ba5a04b34093
    type: regular
    task:
      id: 06409208-614d-4f4b-8d6d-ba5a04b34093
      version: -1
      name: Verify Context Error - Extension
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'File.Extension’ context key was not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR - Retrieve File by sha256' playbook:
          1- The file retrieval operation failed (the 'ExtractedFiles' context key is empty).
          2- The 'lastZipFileInWarroom' input configuration was changed for the 'UnzipFile' automation used in the 'UnZip File' task.
          3- The 'ExtractedFiles' context key does not contain both ZIP and Unzipped file extensions.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -1760,
          "y": -235
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "245":
    id: "245"
    taskid: 0b57c8a6-3655-4f90-8fae-53aa98a03d11
    type: condition
    task:
      id: 0b57c8a6-3655-4f90-8fae-53aa98a03d11
      version: -1
      name: Verify Type
      description: Verify that the 'File.Type' context key has been extracted correctly and contains both ZIP and Unzipped file types.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "246"
      Verified:
      - "230"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: File
                accessor: Type
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -1360,
          "y": -470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "246":
    id: "246"
    taskid: 8e5f1c42-c29f-44bf-8cb6-ff80c3959718
    type: regular
    task:
      id: 8e5f1c42-c29f-44bf-8cb6-ff80c3959718
      version: -1
      name: Verify Context Error - Type
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'File.Type’ context key was not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR - Retrieve File by sha256' playbook:
          1- The file retrieval operation failed (the 'ExtractedFiles' context key is empty).
          2- The 'lastZipFileInWarroom' input configuration was changed for the 'UnzipFile' automation used in the 'UnZip File' task.
          3- The 'ExtractedFiles' context key does not contain both ZIP and Unzipped file types.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -1360,
          "y": -235
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "247":
    id: "247"
    taskid: 46503fc2-416f-44ce-8294-af84cec1021c
    type: condition
    task:
      id: 46503fc2-416f-44ce-8294-af84cec1021c
      version: -1
      name: Verify Unzipped
      description: Verify that the 'File.Unzipped' context key has been extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "248"
      Verified:
      - "230"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isTrue
          left:
            value:
              complex:
                root: File
                accessor: Unzipped
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -960,
          "y": -470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "248":
    id: "248"
    taskid: 501deff0-6a63-4a91-8169-f2defbd2268f
    type: regular
    task:
      id: 501deff0-6a63-4a91-8169-f2defbd2268f
      version: -1
      name: Verify Context Error - Unzipped
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'File.Unzipped’ context key was not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR - Retrieve File by sha256' playbook:
          1- The file retrieval operation failed (the 'ExtractedFiles' context key is empty).
          2- The 'lastZipFileInWarroom' input configuration was changed for the 'UnzipFile' automation used in the 'UnZip File' task.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -960,
          "y": -235
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "249":
    id: "249"
    taskid: 5357dbf2-c0b4-42a8-8085-eadfc081a844
    type: title
    task:
      id: 5357dbf2-c0b4-42a8-8085-eadfc081a844
      version: -1
      name: Test 'Print Error'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "262"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3430,
          "y": -920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "253":
    id: "253"
    taskid: 61301a5f-b2fb-4b40-8dcd-691f2ace14a4
    type: title
    task:
      id: 61301a5f-b2fb-4b40-8dcd-691f2ace14a4
      version: -1
      name: Done Verifying 'Print Error'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "202"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3050,
          "y": -280
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "254":
    id: "254"
    taskid: f1881ddf-ca6a-49c7-8887-454e478e8cf8
    type: regular
    task:
      id: f1881ddf-ca6a-49c7-8887-454e478e8cf8
      version: -1
      name: Verify Print Error Message Was Failed
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The error entry message associated with the 'Print Error - No path was found' task does not equal the phrase "No Path was provided for ${inputs.Sha256}. Cannot retrieve the file without a proper path". This may indicate that one or more of the following changes have been made to the 'Cortex XDR - Retrieve File by sha256' playbook:
          1- The 'value' input configuration was changed for the 'Print' automation used in the 'Print Error - No path was found' task.
          2 - The 'Is there a path for the provided sha256?' conditional task returned 'Yes', causing the playbook flow to proceed to 'Cortex XDR - Retrieve File' instead.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3430,
          "y": -215
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "255":
    id: "255"
    taskid: 3349c3ff-73c5-4dba-8d09-1cf8de086452
    type: regular
    task:
      id: 3349c3ff-73c5-4dba-8d09-1cf8de086452
      version: -1
      name: Wait for the files to be retrieved from XDR
      description: Ensure that 'Cortex XDR - Retrieve File' is complete before closing the incident and starting tests.
      scriptName: WaitAndCompleteTask
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "203"
    scriptarguments:
      complete_task:
        simple: "false"
      incident_id:
        complex:
          root: CreatedIncidentID
      interval_between_tries:
        simple: "10"
      max_timeout:
        simple: "300"
      task_name:
        simple: Cortex XDR - Retrieve File
      task_states:
        simple: Completed
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 630,
          "y": -1545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "260":
    id: "260"
    taskid: 9fe2c8a5-d720-4781-8212-d684d89efb92
    type: regular
    task:
      id: 9fe2c8a5-d720-4781-8212-d684d89efb92
      version: -1
      name: Get Error Entries
      description: Get the error(s) associated with a given entry/entries. Use ${lastCompletedTaskEntries} to check the previous task entries. The automation will return an array of the error contents from those entries.
      scriptName: GetErrorsFromEntry
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "261"
    scriptarguments:
      entry_id:
        simple: ${lastCompletedTaskEntries}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3430,
          "y": -620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "261":
    id: "261"
    taskid: 271fdc61-f4a9-4574-856f-b71a6fb90a07
    type: condition
    task:
      id: 271fdc61-f4a9-4574-856f-b71a6fb90a07
      version: -1
      name: Verify Error Message
      description: Ensure that an error message was printed for the 'Print Error - No path was found' task.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "254"
      Verified:
      - "253"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: ErrorEntries
            iscontext: true
          right:
            value:
              simple: No Path was provided for 07dc0e82e198278b8b7179b01dd69f6203fb128b20484edbcdbaa19ec2ee09f0. Cannot retrieve the file without a proper path.
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3430,
          "y": -455
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "262":
    id: "262"
    taskid: 7ff04827-f27c-4b0f-851f-ebfacde7ab2d
    type: playbook
    task:
      id: 7ff04827-f27c-4b0f-851f-ebfacde7ab2d
      version: -1
      name: Cortex XDR - Retrieve File by sha256
      description: |-
        This playbook is part of the 'Malware Investigation And Response' pack. For more information, refer to https://xsoar.pan.dev/docs/reference/packs/malware-investigation-and-response.
        The playbook facilitates the process of retrieving files from the investigated devices, unzipping the retrieved files, and loading them into the War Room.

        This playbook consists of the following steps:
        Initially, the sub-playbook 'Cortex XDR - Get File Path from alerts by hash' examines the SHA256 file hashes and retrieves the file paths associated with each hash.
        As soon as the SHA256 hashes, file paths, and endpoint IDs are obtained, the playbook attempts to retrieve the files from all the investigated devices.
        Once the file retrieval automation has been completed successfully, the playbook will unzip the files and load them into the War Room.

        Note: When retrieving multiple files, ensure that the SHA256 input is set to run in a loop.
      playbookName: Cortex XDR - Retrieve File by sha256
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "260"
    scriptarguments:
      Sha256:
        simple: 07dc0e82e198278b8b7179b01dd69f6203fb128b20484edbcdbaa19ec2ee09f0
    separatecontext: false
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 3430,
          "y": -790
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "213_215_Verified": 0.12,
      "216_215_ Verified": 0.15,
      "217_215_Verified": 0.25,
      "228_230_Verified": 0.1,
      "231_230_Verified": 0.1,
      "233_230_Verified": 0.1,
      "235_230_Verified": 0.1,
      "237_230_Verified": 0.1,
      "239_230_Verified": 0.1,
      "241_230_Verified": 0.13,
      "243_230_Verified": 0.3,
      "245_230_Verified": 0.36,
      "247_230_Verified": 0.3
    },
    "paper": {
      "dimensions": {
        "height": 2640,
        "width": 8390,
        "x": -4580,
        "y": -2645
      }
    }
  }
inputs: []
outputs: []
fromversion: 6.5.0