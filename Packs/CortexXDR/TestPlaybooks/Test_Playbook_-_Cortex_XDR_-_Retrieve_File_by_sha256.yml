id: Test Playbook - Cortex XDR - Retrieve File by sha256
version: -1
name: Test Playbook - Cortex XDR - Retrieve File by sha256
description: "This playbook tests the ‘Cortex XDR - Retrieve File by sha256’ playbook which is part of the ‘Malware Investigation and Response’ pack.\nFollowing are the tests conducted in the playbook:\n1- Ensure that an error message is printed if the 'Cortex XDR - Get File Path from Alerts by Hash' sub-playbook fails to retrieve a file path. \n2- Ensure all context data was extracted properly.\n3- Review and validate the playbook's outputs.\n4- Ensure the 'xdr-file-retrieve' command was successfully executed. \n5 - Ensure that the retrieved files were unzipped using the 'UnzipFile' command "
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 03b44ca4-1adb-4188-8ebb-f1e9c4bd4cd2
    type: start
    task:
      id: 03b44ca4-1adb-4188-8ebb-f1e9c4bd4cd2
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "32"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 630,
          "y": -2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: 796158ec-c361-4287-8270-a75bb319ab4c
    type: regular
    task:
      id: 796158ec-c361-4287-8270-a75bb319ab4c
      version: -1
      name: Delete Context
      description: The task deletes all of the context data. Having a clean beginning to a test playbook ensures that a test can be sterile and that unrelated issues can be eliminated.
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "154"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 630,
          "y": -2515
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: 7cb54109-5acc-4566-859d-8f635e3e823a
    type: regular
    task:
      id: 7cb54109-5acc-4566-859d-8f635e3e823a
      version: -1
      name: Investigate the incident
      description: Begin investigating the incident.
      type: regular
      iscommand: false
      brand: Builtin
      script: InvestigateMine
    nexttasks:
      '#none#':
      - "255"
    scriptarguments:
      id:
        complex:
          root: CreatedIncidentID
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 630,
          "y": -1705
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: 1690acc5-94e3-41af-8198-9067a3942dc8
    type: regular
    task:
      id: 1690acc5-94e3-41af-8198-9067a3942dc8
      version: -1
      name: Wait for incident to be created
      description: 'This task delays the playbook flow progress for 15 seconds to ensure that the incident has been created before moving on. '
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "186"
    scriptarguments:
      seconds:
        simple: "15"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 630,
          "y": -2190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "84":
    id: "84"
    taskid: 6533c65a-d18a-4881-8096-fa841b216721
    type: title
    task:
      id: 6533c65a-d18a-4881-8096-fa841b216721
      version: -1
      name: Start Tests
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "210"
      - "249"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 630,
          "y": -1060
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "93":
    id: "93"
    taskid: ca815873-55e5-485d-8e76-ecd0bd3b0034
    type: regular
    task:
      id: ca815873-55e5-485d-8e76-ecd0bd3b0034
      version: -1
      name: Set playbook for new incident
      description: Assign the 'Cortex XDR - Retrieve File by sha256' playbook to the newly created test incident.
      script: Builtin|||setPlaybook
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      incidentId:
        complex:
          root: CreatedIncidentID
      name:
        simple: Cortex XDR - Retrieve File by sha256
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 630,
          "y": -1870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "154":
    id: "154"
    taskid: 77d74bf7-fb47-48d7-8f2e-da55538e199a
    type: regular
    task:
      id: 77d74bf7-fb47-48d7-8f2e-da55538e199a
      version: -1
      name: Create New Incident For Testing
      description: 'As part of this task, an incident will be created for testing purposes, which includes all the incident fields that are essential to the testing process. '
      script: Builtin|||createNewIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "47"
    scriptarguments:
      deviceid:
        simple: aeec6a2cc92e46fab3b6f621722e9916
      name:
        simple: Test Incident for Cortex XDR - Retrieve File by sha256
      type:
        simple: Malware Investigation and Response
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 630,
          "y": -2350
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "186":
    id: "186"
    taskid: e7b789b0-d188-4cf1-8c09-2efb63d18917
    type: regular
    task:
      id: e7b789b0-d188-4cf1-8c09-2efb63d18917
      version: -1
      name: Set 'fileRetrieval.path' To Context
      description: For testing purposes, the task establishes the context data key and value for 'fileRetrieval.path'.
      scriptName: SetByIncidentId
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "93"
    scriptarguments:
      id:
        complex:
          root: CreatedIncidentID
      key:
        simple: fileRetrieval.path
      value:
        simple: C:\Windows\System32\cmd.exe
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 630,
          "y": -2030
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "202":
    id: "202"
    taskid: 14cdf885-ab0b-445e-8f13-ed77a70f1dff
    type: title
    task:
      id: 14cdf885-ab0b-445e-8f13-ed77a70f1dff
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 670,
          "y": -70
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "203":
    id: "203"
    taskid: a2bdf3d0-d5c2-49c4-8203-901152601fa7
    type: regular
    task:
      id: a2bdf3d0-d5c2-49c4-8203-901152601fa7
      version: -1
      name: Wait for playbook to end running
      description: Wait until the final task (Done) has been completed before starting tests.
      scriptName: WaitAndCompleteTask
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "208"
    scriptarguments:
      complete_task:
        simple: "false"
      incident_id:
        complex:
          root: CreatedIncidentID
      interval_between_tries:
        simple: "10"
      max_timeout:
        simple: "300"
      task_name:
        simple: Done
      task_states:
        simple: Completed
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 630,
          "y": -1385
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "208":
    id: "208"
    taskid: 2eaa6c11-dba0-4525-8ad2-eced046474f3
    type: regular
    task:
      id: 2eaa6c11-dba0-4525-8ad2-eced046474f3
      version: -1
      name: Close Incident
      description: commands.local.cmd.close.inv
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "84"
    scriptarguments:
      closeNotes:
        simple: Done testing mocked incident for 'Test Playbook - Cortex XDR - Retrieve File by sha256' playbook.
      id:
        complex:
          root: CreatedIncidentID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 630,
          "y": -1220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "209":
    id: "209"
    taskid: 9df50fce-6504-4cda-8bb4-02859130eca0
    type: regular
    task:
      id: 9df50fce-6504-4cda-8bb4-02859130eca0
      version: -1
      name: Get the final 'PaloAltoNetworksXDR.RetrievedFiles' context
      description: Gets a value from the specified incident's context.
      scriptName: GetByIncidentId
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "211"
    scriptarguments:
      get_key:
        simple: PaloAltoNetworksXDR.RetrievedFiles
      incident_id:
        complex:
          root: CreatedIncidentID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1330,
          "y": -780
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "210":
    id: "210"
    taskid: 27ea0380-0762-4752-8957-72a74fae99fe
    type: title
    task:
      id: 27ea0380-0762-4752-8957-72a74fae99fe
      version: -1
      name: Check Context Data
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "209"
      - "222"
      - "226"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 630,
          "y": -920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "211":
    id: "211"
    taskid: 67f1f502-ced6-4a38-85e6-f9b0e4a59ac2
    type: title
    task:
      id: 67f1f502-ced6-4a38-85e6-f9b0e4a59ac2
      version: -1
      name: '''PaloAltoNetworksXDR.RetrievedFiles'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "213"
      - "216"
      - "217"
      - "220"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1330,
          "y": -620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "212":
    id: "212"
    taskid: 2e2a939b-1210-406e-8e85-e15f8c340a27
    type: title
    task:
      id: 2e2a939b-1210-406e-8e85-e15f8c340a27
      version: -1
      name: '''ExtractedFiles'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "223"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 0,
          "y": -620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "213":
    id: "213"
    taskid: f8a1fdce-56d7-42b4-8293-c13352b2d6f3
    type: condition
    task:
      id: f8a1fdce-56d7-42b4-8293-c13352b2d6f3
      version: -1
      name: Verify Action ID
      description: Verify that the 'PaloAltoNetworksXDR.RetrievedFiles.action_id’ context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "214"
      Verified:
      - "215"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.RetrievedFiles
                accessor: action_id
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2540,
          "y": -480
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "214":
    id: "214"
    taskid: 2f0867c2-e2a7-4282-8cdc-69ca57b066dc
    type: regular
    task:
      id: 2f0867c2-e2a7-4282-8cdc-69ca57b066dc
      version: -1
      name: Verify Context Error - Action ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'PaloAltoNetworksXDR.RetrievedFiles.action_id’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR - Retrieve File by sha256' playbook:
          1- The 'xdr-file-retrieve' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.RetrievedFiles.action_id' context key.
          2- Either the 'endpoint_ids' or the 'generic_file_path' input configurations were changed for the 'xdr-file-retrieve' automation of the 'Cortex XDR - Retrieve File' task.
          3- The automation failed to execute as the host cannot be reached since the endpoint is offline or isolated.
          4- An API error prevented the API call from being made.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2540,
          "y": -255
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "215":
    id: "215"
    taskid: de708fac-7ae6-4def-81f9-a7c7a64395af
    type: title
    task:
      id: de708fac-7ae6-4def-81f9-a7c7a64395af
      version: -1
      name: Done verifying 'PaloAltoNetworksXDR.RetrievedFiles'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "202"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 940,
          "y": -310
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "216":
    id: "216"
    taskid: 4fd27c29-9678-4bbc-8d51-25f8ef6c16e7
    type: condition
    task:
      id: 4fd27c29-9678-4bbc-8d51-25f8ef6c16e7
      version: -1
      name: Verify Endpoint ID
      description: Verify that the 'PaloAltoNetworksXDR.RetrievedFiles.endpoint_id’ context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "215"
      '#default#':
      - "218"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.RetrievedFiles
                accessor: endpoint_id
            iscontext: true
          right:
            value:
              simple: aeec6a2cc92e46fab3b6f621722e9916
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2140,
          "y": -480
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "217":
    id: "217"
    taskid: d51f14c4-f994-454c-89d4-36316b2f225c
    type: condition
    task:
      id: d51f14c4-f994-454c-89d4-36316b2f225c
      version: -1
      name: Verify File Link
      description: Verify that the 'PaloAltoNetworksXDR.RetrievedFiles.file_link’ context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "219"
      Verified:
      - "215"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.RetrievedFiles
                accessor: file_link
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1730,
          "y": -480
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "218":
    id: "218"
    taskid: 55572430-d30e-4ebb-85bc-2c09dd294935
    type: regular
    task:
      id: 55572430-d30e-4ebb-85bc-2c09dd294935
      version: -1
      name: Verify Context Error - Endpoint ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'PaloAltoNetworksXDR.RetrievedFiles.endpoint_id’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR - Retrieve File by sha256' playbook:
          1- The file retrieval operation failed (Endpoint ID is added only when the operation succeeds).
          2- The 'xdr-file-retrieve' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.RetrievedFiles.endpoint_id' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2140,
          "y": -255
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "219":
    id: "219"
    taskid: d59a46bf-d74a-4e7b-8203-ea1bbd336dc4
    type: regular
    task:
      id: d59a46bf-d74a-4e7b-8203-ea1bbd336dc4
      version: -1
      name: Verify Context Error - File Link
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'PaloAltoNetworksXDR.RetrievedFiles.file_link’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR - Retrieve File by sha256' playbook:
          1- The file retrieval operation failed (File link is added only when the operation succeeds).
          2- The 'xdr-file-retrieve' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.RetrievedFiles.file_link' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1730,
          "y": -255
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "220":
    id: "220"
    taskid: fe58952d-659b-4f4c-8672-e0197ce926d3
    type: condition
    task:
      id: fe58952d-659b-4f4c-8672-e0197ce926d3
      version: -1
      name: Verify Status
      description: Verify that the 'PaloAltoNetworksXDR.RetrievedFiles.status’ context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "221"
      Verified:
      - "215"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotExists
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.RetrievedFiles
                accessor: status
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1330,
          "y": -480
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "221":
    id: "221"
    taskid: 45e8454a-b099-4e12-8594-02c1ac3f29d0
    type: regular
    task:
      id: 45e8454a-b099-4e12-8594-02c1ac3f29d0
      version: -1
      name: Verify Context Error - Status
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'PaloAltoNetworksXDR.RetrievedFiles.status’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR - Retrieve File by sha256' playbook:
          1- The file retrieval operation failed (Status is added only when the operation is unsuccessful).
          2- The 'xdr-file-retrieve' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.RetrievedFiles.status' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1330,
          "y": -255
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "222":
    id: "222"
    taskid: cd666027-b5e3-4f9c-85f0-1f67b7a30997
    type: regular
    task:
      id: cd666027-b5e3-4f9c-85f0-1f67b7a30997
      version: -1
      name: Get the final 'ExtractedFiles' context
      description: Gets a value from the specified incident's context.
      scriptName: GetByIncidentId
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "212"
    scriptarguments:
      get_key:
        simple: ExtractedFiles
      incident_id:
        complex:
          root: CreatedIncidentID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 0,
          "y": -780
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "223":
    id: "223"
    taskid: e6130663-12cc-4dbb-8f0d-7763b4f1f975
    type: condition
    task:
      id: e6130663-12cc-4dbb-8f0d-7763b4f1f975
      version: -1
      name: Verify Extracted Files
      description: 'Verify that the ''ExtractedFiles'' context key has been extracted correctly and contains both the ''manifest.json'' and ''GoogleUpdate.exe'' files. '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "224"
      Verified:
      - "225"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: ExtractedFiles
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 0,
          "y": -490
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "224":
    id: "224"
    taskid: 329563f4-a813-41e5-8847-125121af0110
    type: regular
    task:
      id: 329563f4-a813-41e5-8847-125121af0110
      version: -1
      name: Verify Context Error - Extracted Files
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'ExtractedFiles’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR - Retrieve File by sha256' playbook:
          1- The 'lastZipFileInWarroom' input configuration was changed for the 'UnzipFile' automation used in the 'UnZip File' task.
          2-The file retrieval operation fails and either the 'Were any errors?' or the 'Did the file retrieval fail?' tasks were modified, causing the playbook flow to proceed to the 'Unzip File' task, which should not have happened.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 0,
          "y": -255
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "225":
    id: "225"
    taskid: e968300f-59ec-4386-83de-75d8489dee6b
    type: title
    task:
      id: e968300f-59ec-4386-83de-75d8489dee6b
      version: -1
      name: Done verifying 'ExtractedFiles'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "202"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 390,
          "y": -310
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "226":
    id: "226"
    taskid: b40a3cfc-9688-414c-86ec-a5f825299346
    type: regular
    task:
      id: b40a3cfc-9688-414c-86ec-a5f825299346
      version: -1
      name: Get the final 'File' context
      description: Gets a value from the specified incident's context.
      scriptName: GetByIncidentId
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "227"
    scriptarguments:
      get_key:
        simple: File
      incident_id:
        complex:
          root: CreatedIncidentID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -960,
          "y": -780
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "227":
    id: "227"
    taskid: 9c6cf5fa-5810-45d1-80bf-6e81c05b61f5
    type: title
    task:
      id: 9c6cf5fa-5810-45d1-80bf-6e81c05b61f5
      version: -1
      name: '''File'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "228"
      - "231"
      - "233"
      - "235"
      - "237"
      - "239"
      - "241"
      - "243"
      - "245"
      - "247"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -960,
          "y": -620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "228":
    id: "228"
    taskid: a7995c6b-4cd4-47b9-82bb-424d5ce0cceb
    type: condition
    task:
      id: a7995c6b-4cd4-47b9-82bb-424d5ce0cceb
      version: -1
      name: Verify Name
      description: Verify that the 'File.Name' context key has been extracted correctly and contains both ZIP and Unzipped file names.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "229"
      Verified:
      - "230"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: File
                accessor: Name
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -4580,
          "y": -470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "229":
    id: "229"
    taskid: 9d643c0d-3edc-4261-804f-1b82fc9bedb8
    type: regular
    task:
      id: 9d643c0d-3edc-4261-804f-1b82fc9bedb8
      version: -1
      name: Verify Context Error - Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'File.Name’ context key was not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR - Retrieve File by sha256' playbook:
          1- The file retrieval operation failed (the 'ExtractedFiles' context key is empty).
          2- The 'lastZipFileInWarroom' input configuration was changed for the 'UnzipFile' automation used in the 'UnZip File' task.
          3- The 'ExtractedFiles' context key does not contain both the 'manifest.json' and 'GoogleUpdate.exe' file names.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -4580,
          "y": -235
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "230":
    id: "230"
    taskid: 9fdc7904-1f9c-40f4-8a3b-c8bc2fb53a01
    type: title
    task:
      id: 9fdc7904-1f9c-40f4-8a3b-c8bc2fb53a01
      version: -1
      name: Done verifying 'File'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "202"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -580,
          "y": -300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "231":
    id: "231"
    taskid: f0d57dfc-9aca-4419-8c38-1a4153e28843
    type: condition
    task:
      id: f0d57dfc-9aca-4419-8c38-1a4153e28843
      version: -1
      name: Verify Entry ID
      description: Verify that the 'File.EntryID' context key has been extracted.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "232"
      Verified:
      - "230"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: File
                accessor: EntryID
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -4180,
          "y": -470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "232":
    id: "232"
    taskid: eed9f3e4-3d4a-4815-81ed-e4ffc2accbfa
    type: regular
    task:
      id: eed9f3e4-3d4a-4815-81ed-e4ffc2accbfa
      version: -1
      name: Verify Context Error - Entry ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'File.EntryID’ context key was not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR - Retrieve File by sha256' playbook:
          1- The file retrieval operation failed (the 'ExtractedFiles' context key is empty).
          2- The 'lastZipFileInWarroom' input configuration was changed for the 'UnzipFile' automation used in the 'UnZip File' task.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -4180,
          "y": -235
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "233":
    id: "233"
    taskid: 15cb9902-aeb9-484f-8ac9-941d9c15a694
    type: condition
    task:
      id: 15cb9902-aeb9-484f-8ac9-941d9c15a694
      version: -1
      name: Verify Size
      description: Verify that the 'File.SHA512' context key has been extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "234"
      Verified:
      - "230"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: File
                accessor: Size
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -3770,
          "y": -470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "234":
    id: "234"
    taskid: 85dfd3b5-ba28-4912-821a-12efad4fd335
    type: regular
    task:
      id: 85dfd3b5-ba28-4912-821a-12efad4fd335
      version: -1
      name: Verify Context Error - Size
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'File.Size’ context key was not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR - Retrieve File by sha256' playbook:
          1- The file retrieval operation failed (the 'ExtractedFiles' context key is empty).
          2- The 'lastZipFileInWarroom' input configuration was changed for the 'UnzipFile' automation used in the 'UnZip File' task.
          3- The 'ExtractedFiles' context key does not contain both ZIP and Unzipped file names.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -3770,
          "y": -235
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "235":
    id: "235"
    taskid: fa0080a7-e10e-45ab-8b52-9a2f8537a7da
    type: condition
    task:
      id: fa0080a7-e10e-45ab-8b52-9a2f8537a7da
      version: -1
      name: Verify MD5
      description: Verify that the 'File.MD5' context key has been extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "236"
      Verified:
      - "230"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: File
                accessor: MD5
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -3370,
          "y": -470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "236":
    id: "236"
    taskid: dba52cd4-4654-4f7f-81e8-a0b44ffa15f3
    type: regular
    task:
      id: dba52cd4-4654-4f7f-81e8-a0b44ffa15f3
      version: -1
      name: Verify Context Error - MD5
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'File.MD5’ context key was not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR - Retrieve File by sha256' playbook:
          1- The file retrieval operation failed (the 'ExtractedFiles' context key is empty).
          2- The 'lastZipFileInWarroom' input configuration was changed for the 'UnzipFile' automation used in the 'UnZip File' task.
          3- The 'ExtractedFiles' context key does not contain both the 'manifest.json' and 'GoogleUpdate.exe' MD5 hashes.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -3370,
          "y": -235
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "237":
    id: "237"
    taskid: 95760c2e-41c1-4ec6-8cfa-79f1fef120ac
    type: condition
    task:
      id: 95760c2e-41c1-4ec6-8cfa-79f1fef120ac
      version: -1
      name: Verify SHA1
      description: Verify that the 'File.SHA1' context key has been extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "238"
      Verified:
      - "230"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: File
                accessor: SHA1
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -2960,
          "y": -470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "238":
    id: "238"
    taskid: 01314aa0-0b24-43ef-8266-59ebb8fb4afd
    type: regular
    task:
      id: 01314aa0-0b24-43ef-8266-59ebb8fb4afd
      version: -1
      name: Verify Context Error - SHA1
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'File.SHA1’ context key was not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR - Retrieve File by sha256' playbook:
          1- The file retrieval operation failed (the 'ExtractedFiles' context key is empty).
          2- The 'lastZipFileInWarroom' input configuration was changed for the 'UnzipFile' automation used in the 'UnZip File' task.
          3- The 'ExtractedFiles' context key does not contain both the 'manifest.json' and 'GoogleUpdate.exe' SHA1 hashes.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -2960,
          "y": -235
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "239":
    id: "239"
    taskid: 26f03ba1-cc42-44ce-81ee-a5096542c799
    type: condition
    task:
      id: 26f03ba1-cc42-44ce-81ee-a5096542c799
      version: -1
      name: Verify SHA256
      description: 'Verify that the ''File.SHA256'' context key has been extracted correctly.'
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "240"
      Verified:
      - "230"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: File
                accessor: SHA256
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -2560,
          "y": -470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "240":
    id: "240"
    taskid: 532768d8-84e9-47ae-81cc-c3da40322005
    type: regular
    task:
      id: 532768d8-84e9-47ae-81cc-c3da40322005
      version: -1
      name: Verify Context Error - SHA256
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'File.SHA256’ context key was not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR - Retrieve File by sha256' playbook:
          1- The file retrieval operation failed (the 'ExtractedFiles' context key is empty).
          2- The 'lastZipFileInWarroom' input configuration was changed for the 'UnzipFile' automation used in the 'UnZip File' task.
          3- The 'ExtractedFiles' context key does not contain both the 'manifest.json' and 'GoogleUpdate.exe' SHA256 hashes.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -2560,
          "y": -235
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "241":
    id: "241"
    taskid: ceffd271-28b5-4b3d-871d-9924161add28
    type: condition
    task:
      id: ceffd271-28b5-4b3d-871d-9924161add28
      version: -1
      name: Verify SHA512
      description: 'Verify that the ''File.SHA512'' context key has been extracted correctly.'
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "242"
      Verified:
      - "230"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: File
                accessor: SHA512
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -2160,
          "y": -470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "242":
    id: "242"
    taskid: 7635b0e0-6d94-496f-87d3-59dd3b0662a6
    type: regular
    task:
      id: 7635b0e0-6d94-496f-87d3-59dd3b0662a6
      version: -1
      name: Verify Context Error - SHA512
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'File.SHA512’ context key was not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR - Retrieve File by sha256' playbook:
          1- The file retrieval operation failed (the 'ExtractedFiles' context key is empty).
          2- The 'lastZipFileInWarroom' input configuration was changed for the 'UnzipFile' automation used in the 'UnZip File' task.
          3- The 'ExtractedFiles' context key does not contain both the 'manifest.json' and 'GoogleUpdate.exe' SHA512 hashes.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -2160,
          "y": -235
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "243":
    id: "243"
    taskid: 888798f8-b067-4a4d-87d3-ec676b536121
    type: condition
    task:
      id: 888798f8-b067-4a4d-87d3-ec676b536121
      version: -1
      name: Verify Extension
      description: Verify that the 'File.Extension' context key has been extracted correctly and contains both ZIP and Unzipped file extensions.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "244"
      Verified:
      - "230"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: File
                accessor: Extension
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -1760,
          "y": -470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "244":
    id: "244"
    taskid: a47922f5-72b4-4d1a-8c79-1b9e30afe6e8
    type: regular
    task:
      id: a47922f5-72b4-4d1a-8c79-1b9e30afe6e8
      version: -1
      name: Verify Context Error - Extension
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'File.Extension’ context key was not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR - Retrieve File by sha256' playbook:
          1- The file retrieval operation failed (the 'ExtractedFiles' context key is empty).
          2- The 'lastZipFileInWarroom' input configuration was changed for the 'UnzipFile' automation used in the 'UnZip File' task.
          3- The 'ExtractedFiles' context key does not contain both ZIP and Unzipped file extensions.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -1760,
          "y": -235
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "245":
    id: "245"
    taskid: 5825dfea-01c7-4683-8adf-3dc557cf8b27
    type: condition
    task:
      id: 5825dfea-01c7-4683-8adf-3dc557cf8b27
      version: -1
      name: Verify Type
      description: Verify that the 'File.Type' context key has been extracted correctly and contains both ZIP and Unzipped file types.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "246"
      Verified:
      - "230"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: File
                accessor: Type
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -1360,
          "y": -470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "246":
    id: "246"
    taskid: 53f4233c-7c37-414a-85b2-fbf05f43f991
    type: regular
    task:
      id: 53f4233c-7c37-414a-85b2-fbf05f43f991
      version: -1
      name: Verify Context Error - Type
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'File.Type’ context key was not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR - Retrieve File by sha256' playbook:
          1- The file retrieval operation failed (the 'ExtractedFiles' context key is empty).
          2- The 'lastZipFileInWarroom' input configuration was changed for the 'UnzipFile' automation used in the 'UnZip File' task.
          3- The 'ExtractedFiles' context key does not contain both ZIP and Unzipped file types.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -1360,
          "y": -235
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "247":
    id: "247"
    taskid: 05b5ddd8-93c3-44f0-81c1-b493c513d092
    type: condition
    task:
      id: 05b5ddd8-93c3-44f0-81c1-b493c513d092
      version: -1
      name: Verify Unzipped
      description: Verify that the 'File.Unzipped' context key has been extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "248"
      Verified:
      - "230"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isTrue
          left:
            value:
              complex:
                root: File
                accessor: Unzipped
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -960,
          "y": -470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "248":
    id: "248"
    taskid: bad66147-a1ea-461c-8045-7a408c0a3788
    type: regular
    task:
      id: bad66147-a1ea-461c-8045-7a408c0a3788
      version: -1
      name: Verify Context Error - Unzipped
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'File.Unzipped’ context key was not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR - Retrieve File by sha256' playbook:
          1- The file retrieval operation failed (the 'ExtractedFiles' context key is empty).
          2- The 'lastZipFileInWarroom' input configuration was changed for the 'UnzipFile' automation used in the 'UnZip File' task.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -960,
          "y": -235
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "249":
    id: "249"
    taskid: e5b9eb3e-3b30-4167-8857-a3f0074f3e6f
    type: title
    task:
      id: e5b9eb3e-3b30-4167-8857-a3f0074f3e6f
      version: -1
      name: Test 'Print Error'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "262"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3430,
          "y": -920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "253":
    id: "253"
    taskid: 024b292b-16d0-4a6d-835a-4223f1b56ce2
    type: title
    task:
      id: 024b292b-16d0-4a6d-835a-4223f1b56ce2
      version: -1
      name: Done Verifying 'Print Error'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "202"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3050,
          "y": -280
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "254":
    id: "254"
    taskid: 4db66e6f-e41b-4a82-8006-eeb97dca9a5f
    type: regular
    task:
      id: 4db66e6f-e41b-4a82-8006-eeb97dca9a5f
      version: -1
      name: Verify Print Error Message Was Failed
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The error entry message associated with the 'Print Error - No path was found' task does not equal the phrase "No Path was provided for ${inputs.Sha256}. Cannot retrieve the file without a proper path". This may indicate that one or more of the following changes have been made to the 'Cortex XDR - Retrieve File by sha256' playbook:
          1- The 'value' input configuration was changed for the 'Print' automation used in the 'Print Error - No path was found' task.
          2 - The 'Is there a path for the provided sha256?' conditional task returned 'Yes', causing the playbook flow to proceed to 'Cortex XDR - Retrieve File' instead.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3430,
          "y": -215
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "255":
    id: "255"
    taskid: e62e63ac-b914-4356-8c7f-fad6acc78b9a
    type: regular
    task:
      id: e62e63ac-b914-4356-8c7f-fad6acc78b9a
      version: -1
      name: Wait for the files to be retrieved from XDR
      description: Ensure that 'Cortex XDR - Retrieve File' is complete before closing the incident and starting tests.
      scriptName: WaitAndCompleteTask
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "203"
    scriptarguments:
      complete_task:
        simple: "false"
      incident_id:
        complex:
          root: CreatedIncidentID
      interval_between_tries:
        simple: "10"
      max_timeout:
        simple: "300"
      task_name:
        simple: Cortex XDR - Retrieve File
      task_states:
        simple: Completed
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 630,
          "y": -1545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "260":
    id: "260"
    taskid: 03576e01-b312-4b88-8f80-85f97e4d6d0a
    type: regular
    task:
      id: 03576e01-b312-4b88-8f80-85f97e4d6d0a
      version: -1
      name: Get Error Entries
      description: Get the error(s) associated with a given entry/entries. Use ${lastCompletedTaskEntries} to check the previous task entries. The automation will return an array of the error contents from those entries.
      scriptName: GetErrorsFromEntry
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "261"
    scriptarguments:
      entry_id:
        simple: ${lastCompletedTaskEntries}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3430,
          "y": -620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "261":
    id: "261"
    taskid: 15ab3a37-3a8a-48f4-8fd5-6042a2c74c5f
    type: condition
    task:
      id: 15ab3a37-3a8a-48f4-8fd5-6042a2c74c5f
      version: -1
      name: Verify Error Message
      description: Ensure that an error message was printed for the 'Print Error - No path was found' task.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "254"
      Verified:
      - "253"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: ErrorEntries
            iscontext: true
          right:
            value:
              simple: No Path was provided for 07dc0e82e198278b8b7179b01dd69f6203fb128b20484edbcdbaa19ec2ee09f0. Cannot retrieve the file without a proper path.
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3430,
          "y": -455
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "262":
    id: "262"
    taskid: 2cc4462c-25ec-4bb5-84ba-a7235c7bc1f4
    type: playbook
    task:
      id: 2cc4462c-25ec-4bb5-84ba-a7235c7bc1f4
      version: -1
      name: Cortex XDR - Retrieve File by sha256
      description: |-
        This playbook is part of the 'Malware Investigation And Response' pack. For more information, refer to https://xsoar.pan.dev/docs/reference/packs/malware-investigation-and-response.
        The playbook facilitates the process of retrieving files from the investigated devices, unzipping the retrieved files, and loading them into the War Room.

        This playbook consists of the following steps:
        Initially, the sub-playbook 'Cortex XDR - Get File Path from alerts by hash' examines the SHA256 file hashes and retrieves the file paths associated with each hash.
        As soon as the SHA256 hashes, file paths, and endpoint IDs are obtained, the playbook attempts to retrieve the files from all the investigated devices.
        Once the file retrieval automation has been completed successfully, the playbook will unzip the files and load them into the War Room.

        Note: When retrieving multiple files, ensure that the SHA256 input is set to run in a loop.
      playbookName: Cortex XDR - Retrieve File by sha256
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "260"
    scriptarguments:
      Sha256:
        simple: 07dc0e82e198278b8b7179b01dd69f6203fb128b20484edbcdbaa19ec2ee09f0
    separatecontext: false
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 3430,
          "y": -790
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "213_215_Verified": 0.12,
      "216_215_ Verified": 0.15,
      "217_215_Verified": 0.25,
      "228_230_Verified": 0.1,
      "231_230_Verified": 0.1,
      "233_230_Verified": 0.1,
      "235_230_Verified": 0.1,
      "237_230_Verified": 0.1,
      "239_230_Verified": 0.1,
      "241_230_Verified": 0.13,
      "243_230_Verified": 0.3,
      "245_230_Verified": 0.36,
      "247_230_Verified": 0.3
    },
    "paper": {
      "dimensions": {
        "height": 2640,
        "width": 8390,
        "x": -4580,
        "y": -2645
      }
    }
  }
inputs: []
outputs: []
fromversion: 6.5.0
