id: XDR_Testplaybook_V4
version: -1
vcShouldKeepItemLegacyProdMachine: false
name: XDR_Testplaybook_V4
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: a41db5d3-e259-44b5-8b48-03f2538215da
    type: start
    task:
      id: a41db5d3-e259-44b5-8b48-03f2538215da
      version: -1
      name: ""
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "6"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: d78e9f32-d4fd-4702-86e5-f820c1305ae7
    type: regular
    task:
      id: d78e9f32-d4fd-4702-86e5-f820c1305ae7
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: bae7ced5-0377-42fd-a9f4-69a06c8978c3
    type: regular
    task:
      id: bae7ced5-0377-42fd-a9f4-69a06c8978c3
      version: -1
      name: List Assets
      description: Returns a list of assets.
      script: Cortex XDR - IR|||xdr-asset-list
      type: regular
      iscommand: true
      brand: Cortex XDR - IR
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "3"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 575
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 0d9efa92-14f9-44cb-bbf4-67af61fb9b1a
    type: regular
    task:
      id: 0d9efa92-14f9-44cb-bbf4-67af61fb9b1a
      version: -1
      name: Get Asset
      description: Returns a list of assets.
      script: Cortex XDR - IR|||xdr-asset-list
      type: regular
      iscommand: true
      brand: Cortex XDR - IR
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      asset_id:
        complex:
          root: PaloAltoNetworksXDR.Asset.xdm.asset
          accessor: id
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 760
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: bf052793-783b-4171-80c7-ea58e6b89181
    type: regular
    task:
      id: bf052793-783b-4171-80c7-ea58e6b89181
      version: -1
      name: List 5 Asset Groups
      description: Returns a list of asset groups.
      script: '|||xdr-asset-group-list'
      type: regular
      iscommand: true
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      page_size:
        simple: "5"
      sort_field:
        simple: XDM.ASSET_GROUP.NAME
      sort_order:
        simple: ASC
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: d72e19cb-4c8d-42dd-8572-12d43ac9072e
    type: condition
    task:
      id: d72e19cb-4c8d-42dd-8572-12d43ac9072e
      version: -1
      name: Check if there are 5 results in Asset Groups List
      type: condition
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      "yes":
      - "7"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: hasLength
          left:
            value:
              simple: PaloAltoNetworksXDR.AssetGroup
            iscontext: true
          right:
            value:
              simple: "5"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1130
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 04f29040-5e2b-462b-94ca-cb6c35e0a2d9
    type: title
    task:
      id: 04f29040-5e2b-462b-94ca-cb6c35e0a2d9
      version: -1
      name: Assets Commands
      type: title
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: 129beb78-fff0-4368-9322-185806e63790
    type: regular
    task:
      id: 129beb78-fff0-4368-9322-185806e63790
      version: -1
      name: Get Schema
      description: Gets the schema of the asset inventory.
      script: '|||xdr-asset-schema-get'
      type: regular
      iscommand: true
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "8"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1290
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 6cdded06-e0c8-4eff-9c46-0eab1e12fa80
    type: regular
    task:
      id: 6cdded06-e0c8-4eff-9c46-0eab1e12fa80
      version: -1
      name: Get Schema Options
      description: Gets the enum values of a specified field in the asset schema.
      script: Cortex XDR - IR|||xdr-asset-schema-field-options-get
      type: regular
      iscommand: true
      brand: Cortex XDR - IR
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      field_name:
        simple: xdm.asset.provider
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1440
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: 8b473bf8-60ca-4d3d-bfc9-affecb9a7a0c
    type: regular
    task:
      id: 8b473bf8-60ca-4d3d-bfc9-affecb9a7a0c
      version: -1
      name: Get the new Asset Group
      description: Returns a list of asset groups.
      script: '|||xdr-asset-group-list'
      type: regular
      iscommand: true
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      filter_json:
        simple: '{"AND": [{"SEARCH_FIELD": "XDM.ASSET_GROUP.NAME", "SEARCH_TYPE":
          "EQ", "SEARCH_VALUE": "tpbgroup"}]}'
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 6d8eec60-b8a9-448c-a082-8938916df816
    type: regular
    task:
      id: 6d8eec60-b8a9-448c-a082-8938916df816
      version: -1
      name: Delete new Asset Group
      description: Deletes an asset group.
      script: Cortex XDR - IR|||xdr-asset-group-delete
      type: regular
      iscommand: true
      brand: Cortex XDR - IR
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      group_id:
        simple: ${PaloAltoNetworksXDR.AssetGroup.XDM_ASSET_GROUP_ID}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: 637d0ff8-b1af-4cbb-b184-4f4fed933297
    type: title
    task:
      id: 637d0ff8-b1af-4cbb-b184-4f4fed933297
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: b65ce782-cb9e-4ab5-b513-e7447b0507a0
    type: regular
    task:
      id: b65ce782-cb9e-4ab5-b513-e7447b0507a0
      version: -1
      name: Create Asset Group
      description: Creates an asset group.
      script: Cortex XDR - IR|||xdr-asset-group-create
      type: regular
      iscommand: true
      brand: Cortex XDR - IR
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      group_name:
        simple: tpbgroup
      group_type:
        simple: Dynamic
      membership_predicate_json:
        simple: '{"AND":[{"SEARCH_FIELD":"xdm.asset.type.class","SEARCH_TYPE":"NEQ","SEARCH_VALUE":"Other"}]}'
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1590
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2050,
        "width": 380,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
fromversion: '5.5.0'
