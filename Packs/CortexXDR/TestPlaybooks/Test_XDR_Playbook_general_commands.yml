id: Test XDR Playbook general commands
version: -1
vcShouldKeepItemLegacyProdMachine: false
name: Test XDR Playbook general commands
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: fcce70b3-a2c2-4e6b-865d-ce1dfaa5479a
    type: start
    task:
      id: fcce70b3-a2c2-4e6b-865d-ce1dfaa5479a
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "59"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: a72264cc-da77-4792-8776-e9cd048935b2
    type: regular
    task:
      id: a72264cc-da77-4792-8776-e9cd048935b2
      version: -1
      name: DeleteContext
      description: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: 022dbe2b-198d-436f-aef0-4de9277c0362
    type: regular
    task:
      id: 022dbe2b-198d-436f-aef0-4de9277c0362
      version: -1
      name: xdr-get-incidents
      description: xdr-get-incidents
      script: '|||xdr-get-incidents'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      gte_creation_time:
        simple: 2010-10-10T00:00:00
      limit:
        simple: "3"
      sort_by_creation_time:
        simple: desc
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 98a713e9-3787-426e-868a-b7c9007bba5b
    type: condition
    task:
      id: 98a713e9-3787-426e-868a-b7c9007bba5b
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "4"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.incident_id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.severity
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.xdr_url
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.status
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: b124630c-941b-485d-8ea2-315e77c02c54
    type: regular
    task:
      id: b124630c-941b-485d-8ea2-315e77c02c54
      version: -1
      name: xdr-get-incident-extra-data
      description: xdr-get-incident-extra-data
      script: '|||xdr-get-incident-extra-data'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      incident_id:
        simple: ${PaloAltoNetworksXDR.Incident.incident_id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 275,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 6286fb57-4970-478a-8de6-d1d98a992a1d
    type: condition
    task:
      id: 6286fb57-4970-478a-8de6-d1d98a992a1d
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "6"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.incident_id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.severity
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.status
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: dba765f6-9dba-480b-8098-f696d2dd018a
    type: regular
    task:
      id: dba765f6-9dba-480b-8098-f696d2dd018a
      version: -1
      name: xdr-update-incident
      description: xdr-update-incident
      script: '|||xdr-update-incident'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      incident_id:
        complex:
          root: PaloAltoNetworksXDR
          accessor: Incident.incident_id
          transformers:
          - operator: FirstArrayElement
      manual_severity:
        simple: HIGH
      status:
        simple: UNDER_INVESTIGATION
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: 827f62e9-9e06-4b4b-8106-c80b824c57a1
    type: regular
    task:
      id: 827f62e9-9e06-4b4b-8106-c80b824c57a1
      version: -1
      name: Save incident id
      description: Save incident id
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      key:
        simple: XDRIncidentID
      stringify:
        simple: "true"
      value:
        complex:
          root: PaloAltoNetworksXDR
          accessor: Incident.incident_id
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 54d0252a-e18d-4d68-8dca-75303debef62
    type: regular
    task:
      id: 54d0252a-e18d-4d68-8dca-75303debef62
      version: -1
      name: DeleteContext
      description: DeleteContext
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: XDRIncidentID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: 6ccb449e-aafa-4c37-80ce-5760129f61c1
    type: regular
    task:
      id: 6ccb449e-aafa-4c37-80ce-5760129f61c1
      version: -1
      name: xdr-get-incidents
      description: xdr-get-incidents
      script: '|||xdr-get-incidents'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      incident_id_list:
        simple: ${XDRIncidentID}
      sort_by_creation_time:
        simple: desc
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: 10f9ebeb-8be4-4ee9-8ed4-ab2372216a69
    type: condition
    task:
      id: 10f9ebeb-8be4-4ee9-8ed4-ab2372216a69
      version: -1
      name: Verify updated values
      description: Verify updated values
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "87"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.severity
            iscontext: true
          right:
            value:
              simple: high
      - - operator: isEqualString
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.status
            iscontext: true
          right:
            value:
              simple: under_investigation
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 357c1690-ddf7-4b97-86b6-dd2de344a60f
    type: regular
    task:
      id: 357c1690-ddf7-4b97-86b6-dd2de344a60f
      version: -1
      name: xdr-update-incident
      description: xdr-update-incident
      script: '|||xdr-update-incident'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      incident_id:
        simple: ${PaloAltoNetworksXDR.Incident.incident_id}
      manual_severity:
        simple: LOW
      status:
        simple: NEW
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4395
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: 9788738b-ef46-4a5e-887c-716f6df37691
    type: regular
    task:
      id: 9788738b-ef46-4a5e-887c-716f6df37691
      version: -1
      name: xdr-insert-parsed-alert
      description: xdr-insert-parsed-alert
      script: '|||xdr-insert-parsed-alert'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      alert_description:
        simple: This alert from content  TestXDRPlaybook description
      alert_name:
        simple: This alert from content  TestXDRPlaybook
      local_ip:
        simple: 196.168.0.111
      local_port:
        simple: "2000"
      product:
        simple: SandBlast
      remote_ip:
        simple: 2.2.2.2
      remote_port:
        simple: "6000"
      severity:
        simple: High
      vendor:
        simple: Checkpoint
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4537
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: 3184d7d7-cd1e-43a8-8e6c-14425392c2b8
    type: regular
    task:
      id: 3184d7d7-cd1e-43a8-8e6c-14425392c2b8
      version: -1
      name: Set 2 CEF alerts to context
      description: Set 2 CEF alerts to context
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: cef_alerts
      value:
        simple: |-
          [
                      "CEF:0|Check Point|VPN-1 & FireWall-1|Check Point|Log|microsoft-ds|Unknown|act=AcceptdeviceDirection=0 rt=1569477512000 spt=56957 dpt=445 cs2Label=Rule Name cs2=ADPrimery layer_name=FW_Device_blackened Securitylayer_uuid=07693fc7-1a5c-4f31-8afe-77ae96c71b8c match_id=1806 parent_rule=0rule_action=Accept rule_uid=8e45f36b-d106-4d81-a1f0-9d1ed9a6be5c ifname=bond2logid=0 loguid={0x5d8c5388,0x61,0x29321fac,0xc0000022} origin=1.1.1.1originsicname=CN=DWdeviceBlackend,O=Blackend sequencenum=363 version=5dst=1.1.1.1 inzone=External outzone=Internal product=VPN-1 & FireWall-1 proto=6service_id=microsoft-ds src=1.1.1.1",
                      "CEF:0|Check Point|VPN-1 & FireWall-1|Check Point|Log|Log|Unknown|act=AcceptdeviceDirection=0 rt=1569477501000 spt=63088 dpt=5985 cs2Label=Rule Namelayer_name=FW_Device_blackened Securitylayer_uuid=07693fc7-1a5c-4f31-8afe-77ae96c71b8c match_id=8899 parent_rule=0rule_action=Accept rule_uid=ae987933-82c0-470f-ab1c-1ad552c82369conn_direction=Internal ifname=bond1.12 logid=0loguid={0x5d8c537d,0xbb,0x29321fac,0xc0000014} origin=1.1.1.1originsicname=CN=DWdeviceBlackend,O=Blackend sequencenum=899 version=5dst=1.1.1.1 product=VPN-1 & FireWall-1 proto=6 src=1.1.1.1"
                  ]
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4687
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 78b83f2c-455e-4d3a-8e84-110a167836d6
    type: regular
    task:
      id: 78b83f2c-455e-4d3a-8e84-110a167836d6
      version: -1
      name: xdr-insert-cef-alerts
      description: xdr-insert-cef-alerts
      script: '|||xdr-insert-cef-alerts'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "96"
    scriptarguments:
      cef_alerts:
        simple: ${cef_alerts}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4824
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 50e30388-727d-46ea-8fb4-b1a43aa5edf1
    type: regular
    task:
      id: 50e30388-727d-46ea-8fb4-b1a43aa5edf1
      version: -1
      name: Get Endpoint aeec6a2cc92e46fab3b6f621722e9916
      description: Gets a list of endpoints, according to the passed filters. Filtering
        by multiple fields will be concatenated using AND condition (OR is not supported).
        Maximum result set size is 100. Offset is the zero-based number of endpoint
        from the start of the result set (start by counting from 0).
      script: '|||xdr-get-endpoints'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      endpoint_id_list:
        simple: aeec6a2cc92e46fab3b6f621722e9916
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5136
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: f0eee03e-f148-46a1-893a-3fb4618e9266
    type: condition
    task:
      id: f0eee03e-f148-46a1-893a-3fb4618e9266
      version: -1
      name: To isolate ?
      description: To isolate
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "17"
      "yes":
      - "94"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PaloAltoNetworksXDR.Endpoint.is_isolated
            iscontext: true
          right:
            value:
              simple: AGENT_UNISOLATED
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: b961f93d-b805-43f2-8a8a-eb8255ce7d0e
    type: condition
    task:
      id: b961f93d-b805-43f2-8a8a-eb8255ce7d0e
      version: -1
      name: To unisolate?
      description: To unisolate
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "22"
      "yes":
      - "95"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PaloAltoNetworksXDR.Endpoint.is_isolated
            iscontext: true
          right:
            value:
              simple: AGENT_ISOLATED
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 55,
          "y": 5450
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: c603f819-5bae-4a35-86e1-eb1728f7acd7
    type: regular
    task:
      id: c603f819-5bae-4a35-86e1-eb1728f7acd7
      version: -1
      name: xdr-endpoint-unisolate
      description: Reverses the isolation of an endpoint.
      script: '|||xdr-endpoint-unisolate'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      endpoint_id:
        simple: ${Endpoint.ID}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -267.5,
          "y": 5780
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: b6740271-ed74-4208-8be6-0e598428e5d5
    type: regular
    task:
      id: b6740271-ed74-4208-8be6-0e598428e5d5
      version: -1
      name: xdr-endpoint-isolate
      description: Isolates the specified endpoint.
      script: '|||xdr-endpoint-isolate'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      endpoint_id:
        simple: ${Endpoint.ID}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 482.5,
          "y": 5620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 8de5b6e3-6437-4013-8a9b-a2bcee5a05a4
    type: regular
    task:
      id: 8de5b6e3-6437-4013-8a9b-a2bcee5a05a4
      version: -1
      name: xdr-get-endpoints
      description: xdr-get-endpoints
      script: '|||xdr-get-endpoints'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "21"
    scriptarguments:
      hostname:
        simple: DESKTOP-S2455R8
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 6120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: ee2dcb3f-118f-4d00-8bb8-c110ff7a17ca
    type: condition
    task:
      id: ee2dcb3f-118f-4d00-8bb8-c110ff7a17ca
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "54"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Endpoint.endpoint_id
            iscontext: true
      - - operator: containsGeneral
          left:
            value:
              simple: PaloAltoNetworksXDR.Endpoint.os_type
            iscontext: true
          right:
            value:
              simple: AGENT_OS_WINDOWS
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Endpoint.ip
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 6285
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 5e25c3e7-9e96-4e01-8be3-cfc7096cdfde
    type: title
    task:
      id: 5e25c3e7-9e96-4e01-8be3-cfc7096cdfde
      version: -1
      name: Isolation done
      description: Isolation done
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 5995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: dd4fa72a-79a1-4130-8954-7f39a7f0ee2a
    type: title
    task:
      id: dd4fa72a-79a1-4130-8954-7f39a7f0ee2a
      version: -1
      name: Success!
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 13545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: 3ab8047a-0799-47e8-83a3-77eb3dda258d
    type: condition
    task:
      id: 3ab8047a-0799-47e8-83a3-77eb3dda258d
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "62"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.ScriptCode
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 10405
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: 2095d4ef-69ec-458b-8931-23180137f355
    type: regular
    task:
      id: 2095d4ef-69ec-458b-8931-23180137f355
      version: -1
      name: xdr-get-script-code
      description: Gets the code of a specific script in the script library.
      script: '|||xdr-get-script-code'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      script_uid:
        complex:
          root: PaloAltoNetworksXDR.Scripts
          accessor: script_uid
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 10240
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: 266d5ed4-0219-499a-8d83-cdeb695eb696
    type: condition
    task:
      id: 266d5ed4-0219-499a-8d83-cdeb695eb696
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "31"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.ScriptMetadata
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 10055
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: 9a256aa6-7440-42a4-8cb6-fba4073da0d5
    type: regular
    task:
      id: 9a256aa6-7440-42a4-8cb6-fba4073da0d5
      version: -1
      name: xdr-get-script-metadata
      description: Gets the full definition of a specific script in the scripts library.
      script: '|||xdr-get-script-metadata'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      script_uid:
        complex:
          root: PaloAltoNetworksXDR.Scripts
          accessor: script_uid
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 9900
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: 7ae8c6a0-07b8-4e1a-8e68-ffdc52b687b8
    type: condition
    task:
      id: 7ae8c6a0-07b8-4e1a-8e68-ffdc52b687b8
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "33"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.Scripts
                accessor: script_uid
                transformers:
                - operator: FirstArrayElement
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 9725
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: 52bc6b80-bcdf-4c80-8586-775166d64ec7
    type: regular
    task:
      id: 52bc6b80-bcdf-4c80-8586-775166d64ec7
      version: -1
      name: xdr-get-scripts
      description: Gets a list of scripts available in the scripts library.
      script: '|||xdr-get-scripts'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "34"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 9560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: 2b648859-bfae-4472-8cc8-6b141348d0cd
    type: condition
    task:
      id: 2b648859-bfae-4472-8cc8-6b141348d0cd
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "35"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.EndpointViolations
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 9375
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: 1fc40c50-0a00-42ce-8b2f-096d18145732
    type: regular
    task:
      id: 1fc40c50-0a00-42ce-8b2f-096d18145732
      version: -1
      name: xdr-get-endpoint-device-control-violations
      description: Gets a list of device control violations filtered by selected fields.
        You can retrieve up to 100 violations.
      script: '|||xdr-get-endpoint-device-control-violations'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "35"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 9210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: 78367811-1a3f-45c7-8fd1-3f5e79a5677c
    type: condition
    task:
      id: 78367811-1a3f-45c7-8fd1-3f5e79a5677c
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "37"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Policy.policy_name
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 9025
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: 3724301e-c889-4768-828b-ece82abadf93
    type: regular
    task:
      id: 3724301e-c889-4768-828b-ece82abadf93
      version: -1
      name: xdr-get-policy
      description: Gets the policy name for a specific endpoint.
      script: '|||xdr-get-policy'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "38"
    scriptarguments:
      endpoint_id:
        simple: aeec6a2cc92e46fab3b6f621722e9916
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 8860
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: c2d608b4-9a37-4c97-8a07-6790ec9138e8
    type: condition
    task:
      id: c2d608b4-9a37-4c97-8a07-6790ec9138e8
      version: -1
      name: Check the number of endpoints in context
      description: Check the number of endpoints in context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "39"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: greaterThanOrEqual
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR
                accessor: Endpoint
                transformers:
                - operator: count
            iscontext: true
          right:
            value:
              simple: "1"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 8685
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: 18ae9373-256f-4f62-8d95-d6679dd51149
    type: regular
    task:
      id: 18ae9373-256f-4f62-8d95-d6679dd51149
      version: -1
      name: xdr-get-endpoints
      description: Gets a list of endpoints, according to the passed filters. If there
        are no filters, all endpoints are returned. Filtering by multiple fields will
        be concatenated using AND condition (OR is not supported). Maximum result
        set size is 100. Offset is the zero-based number of endpoint from the start
        of the result set (start by counting from 0).
      script: '|||xdr-get-endpoints'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "41"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 8530
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: 5430fd6f-1a0e-4713-83f9-0b9d6b08a3be
    type: condition
    task:
      id: 5430fd6f-1a0e-4713-83f9-0b9d6b08a3be
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "42"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.AuditAgentReports.ENDPOINTNAME
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.AuditAgentReports.ENDPOINTID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Endpoint.ID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 8355
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "44":
    id: "44"
    taskid: 2db57f92-4e1b-4cb9-882e-66d7e993a80e
    type: regular
    task:
      id: 2db57f92-4e1b-4cb9-882e-66d7e993a80e
      version: -1
      name: xdr-get-audit-agent-reports
      description: xdr-get-audit-agent-reports
      script: '|||xdr-get-audit-agent-reports'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "43"
    scriptarguments:
      limit:
        simple: "5"
      retry-count:
        simple: "3"
      retry-interval:
        simple: "30"
      sort_by:
        simple: category
      sort_order:
        simple: desc
      timestamp_gte:
        simple: "2019-10-10"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 8190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: aba3846a-7f77-41f0-8e98-631f56a77edb
    type: condition
    task:
      id: aba3846a-7f77-41f0-8e98-631f56a77edb
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "44"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: PaloAltoNetworksXDR.AuditManagementLogs.AUDIT_ENTITY_SUBTYPE
            iscontext: true
          right:
            value:
              simple: Authentication failed
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.AuditManagementLogs.AUDIT_ID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 7995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: 04270673-f8da-4bbc-8277-d1f45cd44638
    type: regular
    task:
      id: 04270673-f8da-4bbc-8277-d1f45cd44638
      version: -1
      name: xdr-get-audit-management-logs
      description: xdr-get-audit-management-logs
      script: '|||xdr-get-audit-management-logs'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "45"
    scriptarguments:
      limit:
        simple: "5"
      sort_by:
        simple: sub_type
      sort_order:
        simple: asc
      sub_type:
        simple: Authentication failed
      timestamp_gte:
        simple: "0"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 7830
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: 83b6027d-2ac7-4d20-80f3-7b186566a3f5
    type: condition
    task:
      id: 83b6027d-2ac7-4d20-80f3-7b186566a3f5
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "46"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Distribution.url
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 7645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: 33dc4ef1-2fed-4574-8f4e-22dd2394344b
    type: regular
    task:
      id: 33dc4ef1-2fed-4574-8f4e-22dd2394344b
      version: -1
      name: xdr-get-distribution-url
      description: xdr-get-distribution-url
      script: '|||xdr-get-distribution-url'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "47"
    scriptarguments:
      distribution_id:
        simple: 2c74c11b63074653aa01d575a82bf52a
      package_type:
        simple: sh
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 7490
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: 93700e16-c3cd-49ce-8f1f-35de7efb7d71
    type: condition
    task:
      id: 93700e16-c3cd-49ce-8f1f-35de7efb7d71
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "48"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PaloAltoNetworksXDR.Distribution.status
            iscontext: true
          right:
            value:
              simple: Completed
        - operator: isEqualString
          left:
            value:
              simple: PaloAltoNetworksXDR.Distribution.status
            iscontext: true
          right:
            value:
              simple: In Progress
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 7305
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: 80aee010-a4dc-4441-898e-77c3a9c2797b
    type: regular
    task:
      id: 80aee010-a4dc-4441-898e-77c3a9c2797b
      version: -1
      name: xdr-get-create-distribution-status
      description: xdr-get-create-distribution-status
      script: '|||xdr-get-create-distribution-status'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "49"
    scriptarguments:
      distribution_ids:
        simple: ${PaloAltoNetworksXDR.Distribution.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 7150
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: b6c819a5-158f-426f-8916-6a530c119af9
    type: condition
    task:
      id: b6c819a5-158f-426f-8916-6a530c119af9
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "50"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Distribution.id
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: PaloAltoNetworksXDR.Distribution.platform
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 6965
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "52":
    id: "52"
    taskid: c8929ec2-1200-4c7c-8ab8-0e4ed92e16f6
    type: regular
    task:
      id: c8929ec2-1200-4c7c-8ab8-0e4ed92e16f6
      version: -1
      name: xdr-create-distribution
      description: xdr-create-distribution
      script: '|||xdr-create-distribution'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "51"
    scriptarguments:
      agent_version:
        complex:
          root: PaloAltoNetworksXDR
          accessor: DistributionVersions.linux
          transformers:
          - operator: FirstArrayElement
      description:
        simple: Created by TestXDRPlaybook
      name:
        simple: This is test distribution
      package_type:
        simple: standalone
      platform:
        simple: linux
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 6810
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: 7c8b1ddd-2aff-4296-8772-8b7fe7293537
    type: condition
    task:
      id: 7c8b1ddd-2aff-4296-8772-8b7fe7293537
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "52"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.DistributionVersions.windows
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.DistributionVersions.linux
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 6625
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "54":
    id: "54"
    taskid: 01a5ff9e-914e-4292-8bc9-1cefb939b13b
    type: regular
    task:
      id: 01a5ff9e-914e-4292-8bc9-1cefb939b13b
      version: -1
      name: xdr-get-distribution-versions
      description: xdr-get-distribution-versions
      script: '|||xdr-get-distribution-versions'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "53"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 6470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "55":
    id: "55"
    taskid: f21215cd-45c8-4f17-8018-d30715279337
    type: regular
    task:
      id: f21215cd-45c8-4f17-8018-d30715279337
      version: -1
      name: xdr-get-contributing-event
      description: Retrieves contributing events for a specific alert.
      script: '|||xdr-get-contributing-event'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "56"
    scriptarguments:
      alert_ids:
        complex:
          root: PaloAltoNetworksXDR.Alert
          accessor: internal_id
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 152.5,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
    isoversize: false
    isautoswitchedtoquietmode: false
  "56":
    id: "56"
    taskid: b5f67993-3f47-477e-8461-590a0c7403e3
    type: condition
    task:
      id: b5f67993-3f47-477e-8461-590a0c7403e3
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "57"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.ContributingEvent
                accessor: alertID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.ContributingEvent
                accessor: events
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 152.5,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "57":
    id: "57"
    taskid: beacfe53-8c71-4139-84be-ef206256fd7d
    type: regular
    task:
      id: beacfe53-8c71-4139-84be-ef206256fd7d
      version: -1
      name: xdr-replace-featured-field
      description: Replace the featured hosts\users\ips\active-directory_groups listed
        in your environment.
      script: '|||xdr-replace-featured-field'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "58"
    scriptarguments:
      comments:
        simple: This is a test comment
      field_type:
        simple: ip_addresses
      values:
        simple: 1.1.1.1
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "58":
    id: "58"
    taskid: 3889314b-036d-4ac3-8e7f-b7f3f9dbbf88
    type: condition
    task:
      id: 3889314b-036d-4ac3-8e7f-b7f3f9dbbf88
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "1"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.FeaturedField
                accessor: fieldType
            iscontext: true
          right:
            value:
              simple: ip_addresses
      - - operator: isEqualString
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.FeaturedField.fields
                accessor: value
            iscontext: true
          right:
            value:
              simple: 1.1.1.1
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "59":
    id: "59"
    taskid: e54c1d90-1af8-4238-86dd-43bf015ecb53
    type: regular
    task:
      id: e54c1d90-1af8-4238-86dd-43bf015ecb53
      version: -1
      name: DeleteContext
      description: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "81"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: 152d7fd2-3c03-41ea-8ea6-95f9d5e94105
    type: regular
    task:
      id: 152d7fd2-3c03-41ea-8ea6-95f9d5e94105
      version: -1
      name: Get endpoint
      description: Gets a list of endpoints, according to the passed filters. If there
        are no filters, all endpoints are returned. Filtering by multiple fields will
        be concatenated using AND condition (OR is not supported). Maximum result
        set size is 100. Offset is the zero-based number of endpoint from the start
        of the result set (start by counting from 0).
      script: '|||xdr-get-endpoints'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "61"
    scriptarguments:
      endpoint_id_list:
        simple: aeec6a2cc92e46fab3b6f621722e9916
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 10775
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    id: "61"
    taskid: 331e6538-4d24-4ced-8c68-b29e72d6c9c0
    type: regular
    task:
      id: 331e6538-4d24-4ced-8c68-b29e72d6c9c0
      version: -1
      name: Save original alias name
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "63"
    scriptarguments:
      key:
        simple: old_name
      value:
        complex:
          root: PaloAltoNetworksXDR.Endpoint
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: PaloAltoNetworksXDR.Endpoint.endpoint_id
                iscontext: true
              right:
                value:
                  simple: aeec6a2cc92e46fab3b6f621722e9916
          accessor: alias
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 10930
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "62":
    id: "62"
    taskid: 0b70dde0-7930-4849-8157-5445a49aa43d
    type: regular
    task:
      id: 0b70dde0-7930-4849-8157-5445a49aa43d
      version: -1
      name: Delete context
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "60"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 10610
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: aaa993a0-05f0-42e3-82fb-5a5c8c069b75
    type: regular
    task:
      id: aaa993a0-05f0-42e3-82fb-5a5c8c069b75
      version: -1
      name: Change alias name
      description: Gets a list of endpoints according to the passed filters, and changes
        their alias name. Filtering by multiple fields will be concatenated using
        the AND condition (OR is not supported).
      script: '|||xdr-endpoint-alias-change'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "65"
    scriptarguments:
      endpoint_id_list:
        simple: aeec6a2cc92e46fab3b6f621722e9916
      new_alias_name:
        simple: testing
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 11105
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "64":
    id: "64"
    taskid: a4b1b101-e0a0-4a7d-81fa-8c84968e3e74
    type: condition
    task:
      id: a4b1b101-e0a0-4a7d-81fa-8c84968e3e74
      version: -1
      name: Verify the name was changed
      description: Gets a list of endpoints, according to the passed filters. If there
        are no filters, all endpoints are returned. Filtering by multiple fields will
        be concatenated using AND condition (OR is not supported). Maximum result
        set size is 100. Offset is the zero-based number of endpoint from the start
        of the result set (start by counting from 0).
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "66"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.Endpoint
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: PaloAltoNetworksXDR.Endpoint.endpoint_id
                      iscontext: true
                    right:
                      value:
                        simple: aeec6a2cc92e46fab3b6f621722e9916
                accessor: alias
            iscontext: true
          right:
            value:
              simple: testing
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 11445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "65":
    id: "65"
    taskid: 864435d7-40bb-4e98-8085-e3008c2b5915
    type: regular
    task:
      id: 864435d7-40bb-4e98-8085-e3008c2b5915
      version: -1
      name: Get endpoint
      description: Gets a list of endpoints, according to the passed filters. If there
        are no filters, all endpoints are returned. Filtering by multiple fields will
        be concatenated using AND condition (OR is not supported). Maximum result
        set size is 100. Offset is the zero-based number of endpoint from the start
        of the result set (start by counting from 0).
      script: '|||xdr-get-endpoints'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "64"
    scriptarguments:
      endpoint_id_list:
        simple: aeec6a2cc92e46fab3b6f621722e9916
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 11270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "66":
    id: "66"
    taskid: 62614fa0-6148-4573-86dd-9a7d07ed8503
    type: regular
    task:
      id: 62614fa0-6148-4573-86dd-9a7d07ed8503
      version: -1
      name: Change alias name to the original name
      description: Gets a list of endpoints according to the passed filters, and changes
        their alias name. Filtering by multiple fields will be concatenated using
        the AND condition (OR is not supported).
      script: '|||xdr-endpoint-alias-change'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "67"
    scriptarguments:
      alias_name:
        complex:
          root: old_name
      endpoint_id_list:
        simple: aeec6a2cc92e46fab3b6f621722e9916
      new_alias_name:
        simple: testing
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 11630
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "67":
    id: "67"
    taskid: 89437b11-5cf3-4c04-8b5b-0647aa75ebc7
    type: regular
    task:
      id: 89437b11-5cf3-4c04-8b5b-0647aa75ebc7
      version: -1
      name: xdr-list-users
      description: Retrieve a list of the current users in your environment.
      script: '|||xdr-list-users'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "68"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 11800
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "68":
    id: "68"
    taskid: bc6a816c-d044-43ab-899a-75e6ecd04008
    type: condition
    task:
      id: bc6a816c-d044-43ab-899a-75e6ecd04008
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "72"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: in
          left:
            value:
              simple: Adi
          right:
            value:
              simple: PaloAltoNetworksXDR.User.user_first_name
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 11970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "72":
    id: "72"
    taskid: 1100e22a-3997-4bba-898f-834f67c1879b
    type: regular
    task:
      id: 1100e22a-3997-4bba-898f-834f67c1879b
      version: -1
      name: xdr-list-risky-users
      description: Retrieve the risk score of a specific user or list of users with
        the highest risk score in your environment along with the reason affecting
        each score.
      script: '|||xdr-list-risky-users'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "83"
    scriptarguments:
      limit:
        simple: "3"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 12165
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "76":
    id: "76"
    taskid: dc5fdcb7-ff17-412c-8c71-ab05c3d6ae8d
    type: regular
    task:
      id: dc5fdcb7-ff17-412c-8c71-ab05c3d6ae8d
      version: -1
      name: xdr-list-risky-hosts
      description: Retrieve the risk score of a specific host or list of hosts with
        the highest risk score in your environment along with the reason affecting
        each score.
      script: '|||xdr-list-risky-hosts'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "77"
    scriptarguments:
      limit:
        simple: "3"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 12670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "77":
    id: "77"
    taskid: 09aad7c4-68bc-47cf-814e-d125ebbd1055
    type: condition
    task:
      id: 09aad7c4-68bc-47cf-814e-d125ebbd1055
      version: -1
      name: Assert wasnt returned
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "85"
      "yes":
      - "78"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              simple: PaloAltoNetworksXDR.RiskyHost
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 12825
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "78":
    id: "78"
    taskid: f6f846b9-b665-4171-837f-2fb53b8c70b6
    type: regular
    task:
      id: f6f846b9-b665-4171-837f-2fb53b8c70b6
      version: -1
      name: xdr-list-roles
      description: Retrieve information about one or more roles created in your environment.
      script: '|||xdr-list-roles'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "79"
    scriptarguments:
      role_names:
        simple: Admin
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 13225
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "79":
    id: "79"
    taskid: 55f406aa-f276-432f-81bf-c71fd8be81b1
    type: condition
    task:
      id: 55f406aa-f276-432f-81bf-c71fd8be81b1
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "24"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.Role
                accessor: pretty_name
            iscontext: true
          right:
            value:
              simple: Admin
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 13380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "81":
    id: "81"
    taskid: f200d143-d4b8-4fd0-871f-253bdd52a914
    type: regular
    task:
      id: f200d143-d4b8-4fd0-871f-253bdd52a914
      version: -1
      name: get-correlation-alerts
      description: "Returns a list of alerts and their metadata, which you can filter
        by built-in arguments or use the custom_filter to input a JSON filter object.
        \nMultiple filter arguments will be concatenated using the AND operator, while
        arguments that support a comma-separated list of values will use an OR operator
        between each value."
      script: '|||xdr-get-alerts'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "82"
    scriptarguments:
      alert_source:
        simple: correlation
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "82":
    id: "82"
    taskid: 89fedb81-ff8c-4877-8a69-8ff2facfa8df
    type: condition
    task:
      id: 89fedb81-ff8c-4877-8a69-8ff2facfa8df
      version: -1
      name: check if have any correlation alerts
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "57"
      "yes":
      - "55"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Alert.internal_id
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "83":
    id: "83"
    taskid: bf47eb2c-455e-4580-8100-0d4de7da1e56
    type: condition
    task:
      id: bf47eb2c-455e-4580-8100-0d4de7da1e56
      version: -1
      name: Verify outputs if exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "84"
      "yes":
      - "76"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: PaloAltoNetworksXDR.RiskyUser.type
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: PaloAltoNetworksXDR.RiskyUser.id
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: PaloAltoNetworksXDR.RiskyUser.score
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 12340
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "84":
    id: "84"
    taskid: deafd417-5b86-4c53-8864-ec4e7a57579c
    type: condition
    task:
      id: deafd417-5b86-4c53-8864-ec4e7a57579c
      version: -1
      name: Assert wasnt returned
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "76"
    separatecontext: false
    defaultassigneecomplex:
      simple: ${PaloAltoNetworksXDR.RiskyUser}
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              simple: PaloAltoNetworksXDR.RiskyUser
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 275,
          "y": 12485
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "85":
    id: "85"
    taskid: f015c1ea-0c78-43b3-8823-1c8d2bdb481a
    type: condition
    task:
      id: f015c1ea-0c78-43b3-8823-1c8d2bdb481a
      version: -1
      name: Assert schema
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "78"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: PaloAltoNetworksXDR.RiskyHost.type
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: PaloAltoNetworksXDR.RiskyHost.id
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: PaloAltoNetworksXDR.RiskyHost.score
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 275,
          "y": 13000
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "87":
    id: "87"
    taskid: 5f9e57c5-4e62-4a6d-89ac-9c03517174b1
    type: regular
    task:
      id: 5f9e57c5-4e62-4a6d-89ac-9c03517174b1
      version: -1
      name: xdr-update-incident-including-alerts
      description: Updates one or more fields of a specified incident. Missing fields
        will be ignored. To remove the assignment for an incident, pass a null value
        in the assignee email argument.
      script: '|||xdr-update-incident'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "90"
    scriptarguments:
      incident_id:
        simple: ${XDRIncidentID}
      manual_severity:
        simple: LOW
      resolve_alerts:
        simple: "true"
      resolve_comment:
        simple: i am resolved
      status:
        simple: RESOLVED_DUPLICATE
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "88":
    id: "88"
    taskid: 5baf4bee-08f8-4168-894d-a0c4c4edc8dd
    type: regular
    task:
      id: 5baf4bee-08f8-4168-894d-a0c4c4edc8dd
      version: -1
      name: xdr-get-incident-extra-data
      description: Returns additional data for the specified incident, for example,
        related alerts, file artifacts, network artifacts, and so on.
      script: '|||xdr-get-incident-extra-data'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "89"
    scriptarguments:
      alerts_limit:
        simple: "1"
      incident_id:
        complex:
          root: PaloAltoNetworksXDR.Incident
          accessor: incident_id
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3705
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "89":
    id: "89"
    taskid: fe385f2d-9f05-46a2-82f9-1ed91b74d462
    type: regular
    task:
      id: fe385f2d-9f05-46a2-82f9-1ed91b74d462
      version: -1
      name: xdr-update-alert
      description: |-
        Update one or more alerts with the provided arguments.
        Required license: Cortex XDR Prevent, Cortex XDR Pro per Endpoint, or Cortex XDR Pro per GB.
      script: '|||xdr-update-alert'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "92"
    scriptarguments:
      alert_ids:
        complex:
          root: PaloAltoNetworksXDR.Incident.alerts
          accessor: alert_id
          transformers:
          - operator: FirstArrayElement
      comment:
        simple: i was updated from playbook
      severity:
        simple: low
      status:
        simple: under_investigation
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "90":
    id: "90"
    taskid: 772bf0b2-b990-400a-8e37-f8dbe2f84058
    type: regular
    task:
      id: 772bf0b2-b990-400a-8e37-f8dbe2f84058
      version: -1
      name: xdr-get-incident-extra-data
      description: Returns additional data for the specified incident, for example,
        related alerts, file artifacts, network artifacts, and so on.
      script: '|||xdr-get-incident-extra-data'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "91"
    scriptarguments:
      incident_id:
        simple: ${XDRIncidentID}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "91":
    id: "91"
    taskid: cd3d116b-57c0-4ad2-868f-8d7b858c649e
    type: condition
    task:
      id: cd3d116b-57c0-4ad2-868f-8d7b858c649e
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "88"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: ${PaloAltoNetworksXDR.Incident.severity}
            iscontext: true
          right:
            value:
              simple: low
      - - operator: isEqualString
          left:
            value:
              simple: ${PaloAltoNetworksXDR.Incident.resolve_comment}
            iscontext: true
          right:
            value:
              simple: i am resolved
      - - operator: isEqualString
          left:
            value:
              simple: ${PaloAltoNetworksXDR.Incident.alerts.[0].resolution_status}
            iscontext: true
          right:
            value:
              simple: STATUS_050_RESOLVED_DUPLICATE
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "92":
    id: "92"
    taskid: be17a3c3-ad37-4026-8636-0513b1c675d9
    type: regular
    task:
      id: be17a3c3-ad37-4026-8636-0513b1c675d9
      version: -1
      name: xdr-get-incident-extra-data
      description: Returns additional data for the specified incident, for example,
        related alerts, file artifacts, network artifacts, and so on.
      script: '|||xdr-get-incident-extra-data'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "93"
    scriptarguments:
      incident_id:
        complex:
          root: PaloAltoNetworksXDR.Incident
          accessor: incident_id
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4045
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "93":
    id: "93"
    taskid: 2e6d5676-452b-4d80-8232-4e48e5ac555e
    type: condition
    task:
      id: 2e6d5676-452b-4d80-8232-4e48e5ac555e
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "11"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: ${PaloAltoNetworksXDR.Incident.alerts.severity(val=="low")}
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: ${PaloAltoNetworksXDR.Incident.alerts.resolution_comment(val=="i
                was updated from playbook")}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
    isoversize: false
    isautoswitchedtoquietmode: false
  "94":
    id: "94"
    taskid: ecf25987-7c24-42d9-8b63-823a21707a66
    type: regular
    task:
      id: ecf25987-7c24-42d9-8b63-823a21707a66
      version: -1
      name: Sleep
      description: Sleep for X seconds.
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      seconds:
        simple: "7"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 482.5,
          "y": 5450
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "95":
    id: "95"
    taskid: b124f81e-b4b8-4b7f-8bc4-a207213dc0e3
    type: regular
    task:
      id: b124f81e-b4b8-4b7f-8bc4-a207213dc0e3
      version: -1
      name: Sleep
      description: Sleep for X seconds.
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      seconds:
        simple: "7"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -267.5,
          "y": 5620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "96":
    id: "96"
    taskid: dff2cbfa-deec-426b-8541-dd298090d7a6
    type: regular
    task:
      id: dff2cbfa-deec-426b-8541-dd298090d7a6
      version: -1
      name: DeleteContext
      description: DeleteContext
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: XDRIncidentID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4985
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "17_22_#default#": 0.47
    },
    "paper": {
      "dimensions": {
        "height": 13555,
        "width": 1130,
        "x": -267.5,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
fromversion: 5.0.0
