id: Test XDR Playbook general commands
version: -1
vcShouldKeepItemLegacyProdMachine: false
name: Test XDR Playbook general commands
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: ee908921-4878-4200-8a8b-e3124234820d
    type: start
    task:
      id: ee908921-4878-4200-8a8b-e3124234820d
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "59"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 24ed80bb-b8f6-451c-8025-07536c961b18
    type: regular
    task:
      id: 24ed80bb-b8f6-451c-8025-07536c961b18
      version: -1
      name: DeleteContext
      description: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1435
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: 94b4594c-c32e-4001-840e-c932467e14b2
    type: regular
    task:
      id: 94b4594c-c32e-4001-840e-c932467e14b2
      version: -1
      name: xdr-get-incidents
      description: xdr-get-incidents
      script: '|||xdr-get-incidents'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      gte_creation_time:
        simple: 2010-10-10T00:00:00
      limit:
        simple: "3"
      sort_by_creation_time:
        simple: desc
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1610
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: bbda099e-f44d-412e-8a5a-d8372b68600e
    type: condition
    task:
      id: bbda099e-f44d-412e-8a5a-d8372b68600e
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "4"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.incident_id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.severity
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.xdr_url
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.status
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1785
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 7bb6213e-d26d-430b-852b-ce4099d5c8f9
    type: regular
    task:
      id: 7bb6213e-d26d-430b-852b-ce4099d5c8f9
      version: -1
      name: xdr-get-incident-extra-data
      description: xdr-get-incident-extra-data
      script: '|||xdr-get-incident-extra-data'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      incident_id:
        simple: ${PaloAltoNetworksXDR.Incident.incident_id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1960
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 2e7ef2c4-2c72-4d29-805c-6bec70bd6da2
    type: condition
    task:
      id: 2e7ef2c4-2c72-4d29-805c-6bec70bd6da2
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "6"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.incident_id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.severity
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.status
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2135
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 9c19358e-f6b3-4848-803f-5764433db79b
    type: regular
    task:
      id: 9c19358e-f6b3-4848-803f-5764433db79b
      version: -1
      name: xdr-update-incident
      description: xdr-update-incident
      script: '|||xdr-update-incident'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      incident_id:
        complex:
          root: PaloAltoNetworksXDR
          accessor: Incident.incident_id
          transformers:
          - operator: FirstArrayElement
      manual_severity:
        simple: HIGH
      status:
        simple: UNDER_INVESTIGATION
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2310
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: 8b7997cf-7d75-41db-89eb-2f0406112767
    type: regular
    task:
      id: 8b7997cf-7d75-41db-89eb-2f0406112767
      version: -1
      name: Save incident id
      description: Save incident id
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      key:
        simple: XDRIncidentID
      stringify:
        simple: "true"
      value:
        complex:
          root: PaloAltoNetworksXDR
          accessor: Incident.incident_id
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2485
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 7a0a2f32-3ed3-4238-8f80-e4b3ef841363
    type: regular
    task:
      id: 7a0a2f32-3ed3-4238-8f80-e4b3ef841363
      version: -1
      name: DeleteContext
      description: DeleteContext
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: XDRIncidentID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2660
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: ee5fd1e1-dc14-4a5e-83a6-bd8f2e3a811b
    type: regular
    task:
      id: ee5fd1e1-dc14-4a5e-83a6-bd8f2e3a811b
      version: -1
      name: xdr-get-incidents
      description: xdr-get-incidents
      script: '|||xdr-get-incidents'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      incident_id_list:
        simple: ${XDRIncidentID}
      sort_by_creation_time:
        simple: desc
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2835
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: af8e89a5-f565-41ea-8e70-6985516f4c38
    type: condition
    task:
      id: af8e89a5-f565-41ea-8e70-6985516f4c38
      version: -1
      name: Verify updated values
      description: Verify updated values
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "87"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.severity
            iscontext: true
          right:
            value:
              simple: high
      - - operator: isEqualString
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.status
            iscontext: true
          right:
            value:
              simple: under_investigation
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3010
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 98e775be-034d-4755-8663-39d83658ad39
    type: regular
    task:
      id: 98e775be-034d-4755-8663-39d83658ad39
      version: -1
      name: xdr-update-incident
      description: xdr-update-incident
      script: '|||xdr-update-incident'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      incident_id:
        simple: ${PaloAltoNetworksXDR.Incident.incident_id}
      manual_severity:
        simple: LOW
      status:
        simple: NEW
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: e02fd562-34fe-46f3-8513-a63520b0bd9b
    type: regular
    task:
      id: e02fd562-34fe-46f3-8513-a63520b0bd9b
      version: -1
      name: xdr-insert-parsed-alert
      description: xdr-insert-parsed-alert
      script: '|||xdr-insert-parsed-alert'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      alert_description:
        simple: This alert from content  TestXDRPlaybook description
      alert_name:
        simple: This alert from content  TestXDRPlaybook
      local_ip:
        simple: 196.168.0.111
      local_port:
        simple: "2000"
      product:
        simple: SandBlast
      remote_ip:
        simple: 2.2.2.2
      remote_port:
        simple: "6000"
      severity:
        simple: High
      vendor:
        simple: Checkpoint
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4585
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: e542dfaf-e907-464d-8f23-e8d59d230cca
    type: regular
    task:
      id: e542dfaf-e907-464d-8f23-e8d59d230cca
      version: -1
      name: Set 2 CEF alerts to context
      description: Set 2 CEF alerts to context
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: cef_alerts
      value:
        simple: |-
          [
                      "CEF:0|Check Point|VPN-1 & FireWall-1|Check Point|Log|microsoft-ds|Unknown|act=AcceptdeviceDirection=0 rt=1569477512000 spt=56957 dpt=445 cs2Label=Rule Name cs2=ADPrimery layer_name=FW_Device_blackened Securitylayer_uuid=07693fc7-1a5c-4f31-8afe-77ae96c71b8c match_id=1806 parent_rule=0rule_action=Accept rule_uid=8e45f36b-d106-4d81-a1f0-9d1ed9a6be5c ifname=bond2logid=0 loguid={0x5d8c5388,0x61,0x29321fac,0xc0000022} origin=1.1.1.1originsicname=CN=DWdeviceBlackend,O=Blackend sequencenum=363 version=5dst=1.1.1.1 inzone=External outzone=Internal product=VPN-1 & FireWall-1 proto=6service_id=microsoft-ds src=1.1.1.1",
                      "CEF:0|Check Point|VPN-1 & FireWall-1|Check Point|Log|Log|Unknown|act=AcceptdeviceDirection=0 rt=1569477501000 spt=63088 dpt=5985 cs2Label=Rule Namelayer_name=FW_Device_blackened Securitylayer_uuid=07693fc7-1a5c-4f31-8afe-77ae96c71b8c match_id=8899 parent_rule=0rule_action=Accept rule_uid=ae987933-82c0-470f-ab1c-1ad552c82369conn_direction=Internal ifname=bond1.12 logid=0loguid={0x5d8c537d,0xbb,0x29321fac,0xc0000014} origin=1.1.1.1originsicname=CN=DWdeviceBlackend,O=Blackend sequencenum=899 version=5dst=1.1.1.1 product=VPN-1 & FireWall-1 proto=6 src=1.1.1.1"
                  ]
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4760
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 666d2d6d-8dfb-4d9c-8794-8cb9972db997
    type: regular
    task:
      id: 666d2d6d-8dfb-4d9c-8794-8cb9972db997
      version: -1
      name: xdr-insert-cef-alerts
      description: xdr-insert-cef-alerts
      script: '|||xdr-insert-cef-alerts'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "96"
    scriptarguments:
      cef_alerts:
        simple: ${cef_alerts}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4935
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: a404fba6-992e-4c45-8943-a34a2ba825f3
    type: regular
    task:
      id: a404fba6-992e-4c45-8943-a34a2ba825f3
      version: -1
      name: Get Endpoint aeec6a2cc92e46fab3b6f621722e9916
      description: Gets a list of endpoints, according to the passed filters. Filtering
        by multiple fields will be concatenated using AND condition (OR is not supported).
        Maximum result set size is 100. Offset is the zero-based number of endpoint
        from the start of the result set (start by counting from 0).
      script: '|||xdr-get-endpoints'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      endpoint_id_list:
        simple: aeec6a2cc92e46fab3b6f621722e9916
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5285
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: b5bd0c08-05d7-447d-8591-7d1ce06e32f7
    type: condition
    task:
      id: b5bd0c08-05d7-447d-8591-7d1ce06e32f7
      version: -1
      name: To isolate ?
      description: To isolate
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "17"
      "yes":
      - "94"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PaloAltoNetworksXDR.Endpoint.is_isolated
            iscontext: true
          right:
            value:
              simple: AGENT_UNISOLATED
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5460
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: bfd9eaff-d47f-43cf-87b9-6f47fd486f82
    type: condition
    task:
      id: bfd9eaff-d47f-43cf-87b9-6f47fd486f82
      version: -1
      name: To unisolate?
      description: To unisolate
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "22"
      "yes":
      - "95"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PaloAltoNetworksXDR.Endpoint.is_isolated
            iscontext: true
          right:
            value:
              simple: AGENT_ISOLATED
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5635
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: eb796cd6-c50c-41e5-870a-bea02e81a4e0
    type: regular
    task:
      id: eb796cd6-c50c-41e5-870a-bea02e81a4e0
      version: -1
      name: xdr-endpoint-unisolate
      description: Reverses the isolation of an endpoint.
      script: '|||xdr-endpoint-unisolate'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      endpoint_id:
        simple: ${Endpoint.ID}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 5985
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: af963ca5-e971-458f-824e-7cf6a90198ce
    type: regular
    task:
      id: af963ca5-e971-458f-824e-7cf6a90198ce
      version: -1
      name: xdr-endpoint-isolate
      description: Isolates the specified endpoint.
      script: '|||xdr-endpoint-isolate'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      endpoint_id:
        simple: ${Endpoint.ID}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 5985
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 98276cbd-bf68-458c-833c-7ced8c2409da
    type: regular
    task:
      id: 98276cbd-bf68-458c-833c-7ced8c2409da
      version: -1
      name: xdr-get-endpoints
      description: xdr-get-endpoints
      script: '|||xdr-get-endpoints'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "21"
    scriptarguments:
      hostname:
        simple: DESKTOP-S2455R8
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 6320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: 612d4cdf-e7d1-4097-8af6-afbff441740d
    type: condition
    task:
      id: 612d4cdf-e7d1-4097-8af6-afbff441740d
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "54"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Endpoint.endpoint_id
            iscontext: true
      - - operator: containsGeneral
          left:
            value:
              simple: PaloAltoNetworksXDR.Endpoint.os_type
            iscontext: true
          right:
            value:
              simple: AGENT_OS_WINDOWS
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Endpoint.ip
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 6495
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 25c435e1-b462-407c-8c43-07d48d00a007
    type: title
    task:
      id: 25c435e1-b462-407c-8c43-07d48d00a007
      version: -1
      name: Isolation done
      description: Isolation done
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 6160
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: b5e2fa8e-1446-4d7f-8732-ed4c00b22fa8
    type: title
    task:
      id: b5e2fa8e-1446-4d7f-8732-ed4c00b22fa8
      version: -1
      name: Success!
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 15915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: f7894df9-a224-47e2-81ae-1495ec379823
    type: condition
    task:
      id: f7894df9-a224-47e2-81ae-1495ec379823
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "62"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.ScriptCode
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 10695
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: 0419fc6d-0323-4571-83ac-1a406eca1cf6
    type: regular
    task:
      id: 0419fc6d-0323-4571-83ac-1a406eca1cf6
      version: -1
      name: xdr-get-script-code
      description: Gets the code of a specific script in the script library.
      script: '|||xdr-get-script-code'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      script_uid:
        complex:
          root: PaloAltoNetworksXDR.Scripts
          accessor: script_uid
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 10520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: bbbcb5f6-0338-492f-8a9f-7da939a0c86e
    type: condition
    task:
      id: bbbcb5f6-0338-492f-8a9f-7da939a0c86e
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "31"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.ScriptMetadata
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 10345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: b67c6558-da28-4d54-86eb-2939fb5fc0b8
    type: regular
    task:
      id: b67c6558-da28-4d54-86eb-2939fb5fc0b8
      version: -1
      name: xdr-get-script-metadata
      description: Gets the full definition of a specific script in the scripts library.
      script: '|||xdr-get-script-metadata'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      script_uid:
        complex:
          root: PaloAltoNetworksXDR.Scripts
          accessor: script_uid
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 10170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: 94d5475f-365f-4522-82c6-b12e9bfc1910
    type: condition
    task:
      id: 94d5475f-365f-4522-82c6-b12e9bfc1910
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "33"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.Scripts
                accessor: script_uid
                transformers:
                - operator: FirstArrayElement
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 9995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: 59f6e717-a487-4238-8be3-b586293e9601
    type: regular
    task:
      id: 59f6e717-a487-4238-8be3-b586293e9601
      version: -1
      name: xdr-get-scripts
      description: Gets a list of scripts available in the scripts library.
      script: '|||xdr-get-scripts'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "34"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 9820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: f9097d12-b0af-451e-8af0-f5a2d7e89548
    type: condition
    task:
      id: f9097d12-b0af-451e-8af0-f5a2d7e89548
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "35"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.EndpointViolations
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 9645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: cbe4d055-0835-44e8-8f27-4e93d1650c80
    type: regular
    task:
      id: cbe4d055-0835-44e8-8f27-4e93d1650c80
      version: -1
      name: xdr-get-endpoint-device-control-violations
      description: Gets a list of device control violations filtered by selected fields.
        You can retrieve up to 100 violations.
      script: '|||xdr-get-endpoint-device-control-violations'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "36"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 9470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: 2bfa355c-9015-4376-8116-30cc9ce41e36
    type: condition
    task:
      id: 2bfa355c-9015-4376-8116-30cc9ce41e36
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "37"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Policy.policy_name
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 9295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: 60847401-6629-477b-8fc6-a7436ef52b9d
    type: regular
    task:
      id: 60847401-6629-477b-8fc6-a7436ef52b9d
      version: -1
      name: xdr-get-policy
      description: Gets the policy name for a specific endpoint.
      script: '|||xdr-get-policy'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "38"
    scriptarguments:
      endpoint_id:
        simple: aeec6a2cc92e46fab3b6f621722e9916
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 9120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: 03651794-d168-4eab-8402-67ce5b173430
    type: condition
    task:
      id: 03651794-d168-4eab-8402-67ce5b173430
      version: -1
      name: Check the number of endpoints in context
      description: Check the number of endpoints in context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "39"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: greaterThanOrEqual
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR
                accessor: Endpoint
                transformers:
                - operator: count
            iscontext: true
          right:
            value:
              simple: "1"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 8945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: 42ac9b65-48ba-4414-81f9-ab7b94a54be9
    type: regular
    task:
      id: 42ac9b65-48ba-4414-81f9-ab7b94a54be9
      version: -1
      name: xdr-get-endpoints
      description: Gets a list of endpoints, according to the passed filters. If there
        are no filters, all endpoints are returned. Filtering by multiple fields will
        be concatenated using AND condition (OR is not supported). Maximum result
        set size is 100. Offset is the zero-based number of endpoint from the start
        of the result set (start by counting from 0).
      script: '|||xdr-get-endpoints'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "41"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 8770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: 4a06b7b8-7296-428e-8b4e-b380502412e0
    type: condition
    task:
      id: 4a06b7b8-7296-428e-8b4e-b380502412e0
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "42"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.AuditAgentReports.ENDPOINTNAME
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.AuditAgentReports.ENDPOINTID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Endpoint.ID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 8595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "44":
    id: "44"
    taskid: 5f10ce25-58c0-4523-8acb-c069d9852faa
    type: regular
    task:
      id: 5f10ce25-58c0-4523-8acb-c069d9852faa
      version: -1
      name: xdr-get-audit-agent-reports
      description: xdr-get-audit-agent-reports
      script: '|||xdr-get-audit-agent-reports'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "43"
    scriptarguments:
      limit:
        simple: "5"
      retry-count:
        simple: "3"
      retry-interval:
        simple: "30"
      sort_by:
        simple: category
      sort_order:
        simple: desc
      timestamp_gte:
        simple: "2019-10-10"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 8420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: 2418da65-5434-4cf7-86a5-3345b0cd5606
    type: condition
    task:
      id: 2418da65-5434-4cf7-86a5-3345b0cd5606
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "44"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: PaloAltoNetworksXDR.AuditManagementLogs.AUDIT_ENTITY_SUBTYPE
            iscontext: true
          right:
            value:
              simple: Authentication failed
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.AuditManagementLogs.AUDIT_ID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 8245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: b8914f36-0a39-4759-8ebf-47bf8677e1cb
    type: regular
    task:
      id: b8914f36-0a39-4759-8ebf-47bf8677e1cb
      version: -1
      name: xdr-get-audit-management-logs
      description: xdr-get-audit-management-logs
      script: '|||xdr-get-audit-management-logs'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "45"
    scriptarguments:
      limit:
        simple: "5"
      sort_by:
        simple: sub_type
      sort_order:
        simple: asc
      sub_type:
        simple: Authentication failed
      timestamp_gte:
        simple: "0"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 8070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: 2cbafc7f-12b0-47cf-813e-a6079fe50cee
    type: condition
    task:
      id: 2cbafc7f-12b0-47cf-813e-a6079fe50cee
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "46"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Distribution.url
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 7895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: 68fcebc8-4159-4daa-86de-31d20d062910
    type: regular
    task:
      id: 68fcebc8-4159-4daa-86de-31d20d062910
      version: -1
      name: xdr-get-distribution-url
      description: xdr-get-distribution-url
      script: '|||xdr-get-distribution-url'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "47"
    scriptarguments:
      distribution_id:
        simple: 2c74c11b63074653aa01d575a82bf52a
      package_type:
        simple: sh
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 7720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: 9b8ba298-54f3-4051-8bc7-e94a31fa4d9e
    type: condition
    task:
      id: 9b8ba298-54f3-4051-8bc7-e94a31fa4d9e
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "48"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PaloAltoNetworksXDR.Distribution.status
            iscontext: true
          right:
            value:
              simple: Completed
        - operator: isEqualString
          left:
            value:
              simple: PaloAltoNetworksXDR.Distribution.status
            iscontext: true
          right:
            value:
              simple: In Progress
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 7545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: d190a7f7-ff8a-4ea1-8263-7b988134f98d
    type: regular
    task:
      id: d190a7f7-ff8a-4ea1-8263-7b988134f98d
      version: -1
      name: xdr-get-create-distribution-status
      description: xdr-get-create-distribution-status
      script: '|||xdr-get-create-distribution-status'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "49"
    scriptarguments:
      distribution_ids:
        simple: ${PaloAltoNetworksXDR.Distribution.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 7370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: f00fd712-7e83-48f4-83fd-cf523272ca28
    type: condition
    task:
      id: f00fd712-7e83-48f4-83fd-cf523272ca28
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "50"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Distribution.id
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: PaloAltoNetworksXDR.Distribution.platform
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 7195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "52":
    id: "52"
    taskid: 64ded39e-f509-4956-8f09-cdd95faf3df0
    type: regular
    task:
      id: 64ded39e-f509-4956-8f09-cdd95faf3df0
      version: -1
      name: xdr-create-distribution
      description: xdr-create-distribution
      script: '|||xdr-create-distribution'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "51"
    scriptarguments:
      agent_version:
        complex:
          root: PaloAltoNetworksXDR
          accessor: DistributionVersions.linux
          transformers:
          - operator: FirstArrayElement
      description:
        simple: Created by TestXDRPlaybook
      name:
        simple: This is test distribution
      package_type:
        simple: standalone
      platform:
        simple: linux
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 7020
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: 2eacacdc-b979-4439-836a-0b3c8856b741
    type: condition
    task:
      id: 2eacacdc-b979-4439-836a-0b3c8856b741
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "52"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.DistributionVersions.windows
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.DistributionVersions.linux
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 6845
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "54":
    id: "54"
    taskid: 2c49fc9d-7d64-4e7a-8556-41ee56e45648
    type: regular
    task:
      id: 2c49fc9d-7d64-4e7a-8556-41ee56e45648
      version: -1
      name: xdr-get-distribution-versions
      description: xdr-get-distribution-versions
      script: '|||xdr-get-distribution-versions'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "53"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 6670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "55":
    id: "55"
    taskid: 0028e30a-c602-47f9-8cc6-798c3b0b2c3d
    type: regular
    task:
      id: 0028e30a-c602-47f9-8cc6-798c3b0b2c3d
      version: -1
      name: xdr-get-contributing-event
      description: Retrieves contributing events for a specific alert.
      script: '|||xdr-get-contributing-event'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "56"
    scriptarguments:
      alert_ids:
        complex:
          root: PaloAltoNetworksXDR.Alert
          accessor: internal_id
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 152.5,
          "y": 735
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
    isoversize: false
    isautoswitchedtoquietmode: false
  "56":
    id: "56"
    taskid: 15ef29f9-d034-437a-80e1-7439d87f4821
    type: condition
    task:
      id: 15ef29f9-d034-437a-80e1-7439d87f4821
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "57"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.ContributingEvent
                accessor: alertID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.ContributingEvent
                accessor: events
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 152.5,
          "y": 910
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "57":
    id: "57"
    taskid: a6e12c67-044e-4fe1-81c2-8eb6782dafda
    type: regular
    task:
      id: a6e12c67-044e-4fe1-81c2-8eb6782dafda
      version: -1
      name: xdr-replace-featured-field
      description: Replace the featured hosts\users\ips\active-directory_groups listed
        in your environment.
      script: '|||xdr-replace-featured-field'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "58"
    scriptarguments:
      comments:
        simple: This is a test comment
      field_type:
        simple: ip_addresses
      values:
        simple: 1.1.1.1
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1085
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "58":
    id: "58"
    taskid: b1864ddd-424c-41d6-8163-abf355feae95
    type: condition
    task:
      id: b1864ddd-424c-41d6-8163-abf355feae95
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "1"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.FeaturedField
                accessor: fieldType
            iscontext: true
          right:
            value:
              simple: ip_addresses
      - - operator: isEqualString
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.FeaturedField.fields
                accessor: value
            iscontext: true
          right:
            value:
              simple: 1.1.1.1
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1260
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "59":
    id: "59"
    taskid: 2961da5b-6275-4246-8b3a-f3d0ccc9306d
    type: regular
    task:
      id: 2961da5b-6275-4246-8b3a-f3d0ccc9306d
      version: -1
      name: DeleteContext
      description: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "81"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: b4acc98b-e661-4db9-8005-c5bbfa596115
    type: regular
    task:
      id: b4acc98b-e661-4db9-8005-c5bbfa596115
      version: -1
      name: Get endpoint
      description: Gets a list of endpoints, according to the passed filters. If there
        are no filters, all endpoints are returned. Filtering by multiple fields will
        be concatenated using AND condition (OR is not supported). Maximum result
        set size is 100. Offset is the zero-based number of endpoint from the start
        of the result set (start by counting from 0).
      script: '|||xdr-get-endpoints'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "61"
    scriptarguments:
      endpoint_id_list:
        simple: aeec6a2cc92e46fab3b6f621722e9916
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 11045
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    id: "61"
    taskid: 976d56da-854c-435c-88e5-ae7ee59e76b8
    type: regular
    task:
      id: 976d56da-854c-435c-88e5-ae7ee59e76b8
      version: -1
      name: Save original alias name
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "63"
    scriptarguments:
      key:
        simple: old_name
      value:
        complex:
          root: PaloAltoNetworksXDR.Endpoint
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: PaloAltoNetworksXDR.Endpoint.endpoint_id
                iscontext: true
              right:
                value:
                  simple: aeec6a2cc92e46fab3b6f621722e9916
          accessor: alias
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 11220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "62":
    id: "62"
    taskid: fc8bf3ed-6af4-45f1-8ccd-2f92b9130c48
    type: regular
    task:
      id: fc8bf3ed-6af4-45f1-8ccd-2f92b9130c48
      version: -1
      name: Delete context
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "60"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 10870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: f2fe6fdd-b5c9-4a47-85d3-81dcc56b2983
    type: regular
    task:
      id: f2fe6fdd-b5c9-4a47-85d3-81dcc56b2983
      version: -1
      name: Change alias name
      description: Gets a list of endpoints according to the passed filters, and changes
        their alias name. Filtering by multiple fields will be concatenated using
        the AND condition (OR is not supported).
      script: '|||xdr-endpoint-alias-change'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "65"
    scriptarguments:
      endpoint_id_list:
        simple: aeec6a2cc92e46fab3b6f621722e9916
      new_alias_name:
        simple: testing
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 11395
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "64":
    id: "64"
    taskid: d389949e-ad46-44cd-8410-9bbcc4620f96
    type: condition
    task:
      id: d389949e-ad46-44cd-8410-9bbcc4620f96
      version: -1
      name: Verify the name was changed
      description: Gets a list of endpoints, according to the passed filters. If there
        are no filters, all endpoints are returned. Filtering by multiple fields will
        be concatenated using AND condition (OR is not supported). Maximum result
        set size is 100. Offset is the zero-based number of endpoint from the start
        of the result set (start by counting from 0).
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "66"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.Endpoint
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: PaloAltoNetworksXDR.Endpoint.endpoint_id
                      iscontext: true
                    right:
                      value:
                        simple: aeec6a2cc92e46fab3b6f621722e9916
                accessor: alias
            iscontext: true
          right:
            value:
              simple: testing
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 11745
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "65":
    id: "65"
    taskid: ccea2443-2e8c-41b5-8334-58b711d0c486
    type: regular
    task:
      id: ccea2443-2e8c-41b5-8334-58b711d0c486
      version: -1
      name: Get endpoint
      description: Gets a list of endpoints, according to the passed filters. If there
        are no filters, all endpoints are returned. Filtering by multiple fields will
        be concatenated using AND condition (OR is not supported). Maximum result
        set size is 100. Offset is the zero-based number of endpoint from the start
        of the result set (start by counting from 0).
      script: '|||xdr-get-endpoints'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "64"
    scriptarguments:
      endpoint_id_list:
        simple: aeec6a2cc92e46fab3b6f621722e9916
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 11570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "66":
    id: "66"
    taskid: bd48df5f-de2f-4584-862d-a72aab71e024
    type: regular
    task:
      id: bd48df5f-de2f-4584-862d-a72aab71e024
      version: -1
      name: Change alias name to the original name
      description: Gets a list of endpoints according to the passed filters, and changes
        their alias name. Filtering by multiple fields will be concatenated using
        the AND condition (OR is not supported).
      script: '|||xdr-endpoint-alias-change'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "67"
    scriptarguments:
      alias_name:
        complex:
          root: old_name
      endpoint_id_list:
        simple: aeec6a2cc92e46fab3b6f621722e9916
      new_alias_name:
        simple: testing
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 11920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "67":
    id: "67"
    taskid: 087651c5-d77d-4769-88fc-f71042ee7a52
    type: regular
    task:
      id: 087651c5-d77d-4769-88fc-f71042ee7a52
      version: -1
      name: xdr-list-users
      description: Retrieve a list of the current users in your environment.
      script: '|||xdr-list-users'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "68"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 12095
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "68":
    id: "68"
    taskid: c3af5ce8-9cb6-4346-8741-b7f714559b70
    type: condition
    task:
      id: c3af5ce8-9cb6-4346-8741-b7f714559b70
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "72"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: in
          left:
            value:
              simple: Adi
          right:
            value:
              simple: PaloAltoNetworksXDR.User.user_first_name
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 12270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "72":
    id: "72"
    taskid: 76b66909-9767-4432-8ffb-2abde58b573a
    type: regular
    task:
      id: 76b66909-9767-4432-8ffb-2abde58b573a
      version: -1
      name: xdr-list-risky-users
      description: Retrieve the risk score of a specific user or list of users with
        the highest risk score in your environment along with the reason affecting
        each score.
      script: '|||xdr-list-risky-users'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "83"
    scriptarguments:
      limit:
        simple: "3"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 12445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "76":
    id: "76"
    taskid: 7ee27595-a487-4776-8e03-d3a992c1709f
    type: regular
    task:
      id: 7ee27595-a487-4776-8e03-d3a992c1709f
      version: -1
      name: xdr-list-risky-hosts
      description: Retrieve the risk score of a specific host or list of hosts with
        the highest risk score in your environment along with the reason affecting
        each score.
      script: '|||xdr-list-risky-hosts'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "77"
    scriptarguments:
      limit:
        simple: "3"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 12970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "77":
    id: "77"
    taskid: a1a5b628-7c9d-4d62-8b45-0b93b7a0c559
    type: condition
    task:
      id: a1a5b628-7c9d-4d62-8b45-0b93b7a0c559
      version: -1
      name: Assert wasnt returned
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "85"
      "yes":
      - "78"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              simple: PaloAltoNetworksXDR.RiskyHost
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 13145
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "78":
    id: "78"
    taskid: 8422b9e5-6d96-4667-8558-921b5121872e
    type: regular
    task:
      id: 8422b9e5-6d96-4667-8558-921b5121872e
      version: -1
      name: xdr-list-roles
      description: Retrieve information about one or more roles created in your environment.
      script: '|||xdr-list-roles'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "79"
    scriptarguments:
      role_names:
        simple: Admin
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 13495
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "79":
    id: "79"
    taskid: 4ab30432-94e1-4e46-858b-5a9d21dfe47f
    type: condition
    task:
      id: 4ab30432-94e1-4e46-858b-5a9d21dfe47f
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "100"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.Role
                accessor: pretty_name
            iscontext: true
          right:
            value:
              simple: Admin
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 13670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "81":
    id: "81"
    taskid: 6074388e-6333-4fe4-86ca-bb01af3d6bd5
    type: regular
    task:
      id: 6074388e-6333-4fe4-86ca-bb01af3d6bd5
      version: -1
      name: get-correlation-alerts
      description: "Returns a list of alerts and their metadata, which you can filter
        by built-in arguments or use the custom_filter to input a JSON filter object.
        \nMultiple filter arguments will be concatenated using the AND operator, while
        arguments that support a comma-separated list of values will use an OR operator
        between each value."
      script: '|||xdr-get-alerts'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "82"
    scriptarguments:
      alert_source:
        simple: correlation
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 385
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "82":
    id: "82"
    taskid: 14f1df23-ced1-456f-87f9-360e1d591071
    type: condition
    task:
      id: 14f1df23-ced1-456f-87f9-360e1d591071
      version: -1
      name: check if have any correlation alerts
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "57"
      "yes":
      - "55"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Alert.internal_id
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "83":
    id: "83"
    taskid: 5389243e-dcfe-4490-8e5c-60de8e1c360d
    type: condition
    task:
      id: 5389243e-dcfe-4490-8e5c-60de8e1c360d
      version: -1
      name: Verify outputs if exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "84"
      "yes":
      - "76"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: PaloAltoNetworksXDR.RiskyUser.type
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: PaloAltoNetworksXDR.RiskyUser.id
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: PaloAltoNetworksXDR.RiskyUser.score
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 12620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "84":
    id: "84"
    taskid: cf614696-7c53-4281-81d9-2484a7d43ebd
    type: condition
    task:
      id: cf614696-7c53-4281-81d9-2484a7d43ebd
      version: -1
      name: Assert wasnt returned
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "76"
    separatecontext: false
    defaultassigneecomplex:
      simple: ${PaloAltoNetworksXDR.RiskyUser}
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              simple: PaloAltoNetworksXDR.RiskyUser
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 275,
          "y": 12795
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "85":
    id: "85"
    taskid: 9e3e4bfd-b084-48f1-872a-861d5aa66fb0
    type: condition
    task:
      id: 9e3e4bfd-b084-48f1-872a-861d5aa66fb0
      version: -1
      name: Assert schema
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "78"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: PaloAltoNetworksXDR.RiskyHost.type
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: PaloAltoNetworksXDR.RiskyHost.id
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: PaloAltoNetworksXDR.RiskyHost.score
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 275,
          "y": 13320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "87":
    id: "87"
    taskid: 2b22d120-1279-40e7-804d-c6377880fa9d
    type: regular
    task:
      id: 2b22d120-1279-40e7-804d-c6377880fa9d
      version: -1
      name: xdr-update-incident-including-alerts
      description: Updates one or more fields of a specified incident. Missing fields
        will be ignored. To remove the assignment for an incident, pass a null value
        in the assignee email argument.
      script: '|||xdr-update-incident'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "90"
    scriptarguments:
      incident_id:
        simple: ${XDRIncidentID}
      manual_severity:
        simple: LOW
      resolve_alerts:
        simple: "true"
      resolve_comment:
        simple: i am resolved
      status:
        simple: RESOLVED_DUPLICATE
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3185
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "88":
    id: "88"
    taskid: 2260f491-2b00-487c-885f-3aaeaac8387f
    type: regular
    task:
      id: 2260f491-2b00-487c-885f-3aaeaac8387f
      version: -1
      name: xdr-get-incident-extra-data
      description: Returns additional data for the specified incident, for example,
        related alerts, file artifacts, network artifacts, and so on.
      script: '|||xdr-get-incident-extra-data'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "89"
    scriptarguments:
      alerts_limit:
        simple: "1"
      incident_id:
        complex:
          root: PaloAltoNetworksXDR.Incident
          accessor: incident_id
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3710
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "89":
    id: "89"
    taskid: a4aa360f-711f-4329-8479-c41a78bf6d8b
    type: regular
    task:
      id: a4aa360f-711f-4329-8479-c41a78bf6d8b
      version: -1
      name: xdr-update-alert
      description: |-
        Update one or more alerts with the provided arguments.
        Required license: Cortex XDR Prevent, Cortex XDR Pro per Endpoint, or Cortex XDR Pro per GB.
      script: '|||xdr-update-alert'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "92"
    scriptarguments:
      alert_ids:
        complex:
          root: PaloAltoNetworksXDR.Incident.alerts
          accessor: alert_id
          transformers:
          - operator: FirstArrayElement
      comment:
        simple: i was updated from playbook
      severity:
        simple: low
      status:
        simple: under_investigation
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3885
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "90":
    id: "90"
    taskid: e8218111-d923-4cfc-8a45-ec6dcbd84efd
    type: regular
    task:
      id: e8218111-d923-4cfc-8a45-ec6dcbd84efd
      version: -1
      name: xdr-get-incident-extra-data
      description: Returns additional data for the specified incident, for example,
        related alerts, file artifacts, network artifacts, and so on.
      script: '|||xdr-get-incident-extra-data'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "91"
    scriptarguments:
      incident_id:
        simple: ${XDRIncidentID}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3360
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "91":
    id: "91"
    taskid: d63d7033-0eda-4141-8927-7fda3f856b76
    type: condition
    task:
      id: d63d7033-0eda-4141-8927-7fda3f856b76
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "88"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: ${PaloAltoNetworksXDR.Incident.severity}
            iscontext: true
          right:
            value:
              simple: low
      - - operator: isEqualString
          left:
            value:
              simple: ${PaloAltoNetworksXDR.Incident.resolve_comment}
            iscontext: true
          right:
            value:
              simple: i am resolved
      - - operator: isEqualString
          left:
            value:
              simple: ${PaloAltoNetworksXDR.Incident.alerts.[0].resolution_status}
            iscontext: true
          right:
            value:
              simple: STATUS_050_RESOLVED_DUPLICATE
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3535
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "92":
    id: "92"
    taskid: 115935e9-ef95-4b52-8ab6-94e9d847ba51
    type: regular
    task:
      id: 115935e9-ef95-4b52-8ab6-94e9d847ba51
      version: -1
      name: xdr-get-incident-extra-data
      description: Returns additional data for the specified incident, for example,
        related alerts, file artifacts, network artifacts, and so on.
      script: '|||xdr-get-incident-extra-data'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "93"
    scriptarguments:
      incident_id:
        complex:
          root: PaloAltoNetworksXDR.Incident
          accessor: incident_id
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4060
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "93":
    id: "93"
    taskid: 4ed7a75d-d29b-4a7c-8562-9af9ce5ec1fe
    type: condition
    task:
      id: 4ed7a75d-d29b-4a7c-8562-9af9ce5ec1fe
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "11"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: ${PaloAltoNetworksXDR.Incident.alerts.severity(val=="low")}
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: ${PaloAltoNetworksXDR.Incident.alerts.resolution_comment(val=="i
                was updated from playbook")}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4235
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
    isoversize: false
    isautoswitchedtoquietmode: false
  "94":
    id: "94"
    taskid: 2f08560c-a36d-4614-8592-9b1725ec703e
    type: regular
    task:
      id: 2f08560c-a36d-4614-8592-9b1725ec703e
      version: -1
      name: Sleep
      description: Sleep for X seconds.
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      seconds:
        simple: "7"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 5810
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "95":
    id: "95"
    taskid: da63e127-7e9d-4c35-8190-26ae4d1ac30b
    type: regular
    task:
      id: da63e127-7e9d-4c35-8190-26ae4d1ac30b
      version: -1
      name: Sleep
      description: Sleep for X seconds.
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      seconds:
        simple: "7"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 5810
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "96":
    id: "96"
    taskid: 1c3bb0f0-8e73-4a36-8a0e-e906f657d540
    type: regular
    task:
      id: 1c3bb0f0-8e73-4a36-8a0e-e906f657d540
      version: -1
      name: DeleteContext
      description: DeleteContext
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: XDRIncidentID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5110
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "100":
    id: "100"
    taskid: 8cbe9e85-9ff3-4f6c-804f-09b7390831e5
    type: title
    task:
      id: 8cbe9e85-9ff3-4f6c-804f-09b7390831e5
      version: -1
      name: Assets Commands
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "101"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 13845
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "101":
    id: "101"
    taskid: bb87ed4a-d42e-4939-8f1e-6db9d457f9d6
    type: regular
    task:
      id: bb87ed4a-d42e-4939-8f1e-6db9d457f9d6
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default\n
        \ Limited User role, unless you explicitly change the permissions.\nFor more\n
        \ information, see the section about permissions here:\n- For Cortex XSOAR
        6\n  see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations\n
        \ \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-\n
        \ For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "102"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 14005
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "102":
    id: "102"
    taskid: ccec8053-c4c6-4f99-85ee-4e944d635fbe
    type: regular
    task:
      id: ccec8053-c4c6-4f99-85ee-4e944d635fbe
      version: -1
      name: List Assets
      description: Returns a list of assets.
      script: Cortex XDR - IR|||xdr-asset-list
      type: regular
      iscommand: true
      brand: Cortex XDR - IR
    nexttasks:
      '#none#':
      - "103"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 14180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "103":
    id: "103"
    taskid: 16bb98b5-e98a-40ae-80f3-845f66b2e1c5
    type: regular
    task:
      id: 16bb98b5-e98a-40ae-80f3-845f66b2e1c5
      version: -1
      name: Get Asset
      description: Returns a list of assets.
      script: Cortex XDR - IR|||xdr-asset-list
      type: regular
      iscommand: true
      brand: Cortex XDR - IR
    nexttasks:
      '#none#':
      - "104"
    scriptarguments:
      asset_id:
        complex:
          root: PaloAltoNetworksXDR.Asset.xdm.asset
          accessor: id
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 14355
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "104":
    id: "104"
    taskid: a3118bc4-15c8-4d56-8e6a-1f1b80e88ee8
    type: regular
    task:
      id: a3118bc4-15c8-4d56-8e6a-1f1b80e88ee8
      version: -1
      name: List 5 Asset Groups
      description: Returns a list of asset groups.
      script: '|||xdr-asset-group-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "106"
    scriptarguments:
      page_size:
        simple: "5"
      sort_field:
        simple: XDM.ASSET_GROUP.NAME
      sort_order:
        simple: ASC
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 14530
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "106":
    id: "106"
    taskid: 9541ddc6-9538-4765-8763-54da1f7ab37d
    type: regular
    task:
      id: 9541ddc6-9538-4765-8763-54da1f7ab37d
      version: -1
      name: Get Schema
      description: Gets the schema of the asset inventory.
      script: '|||xdr-asset-schema-get'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "107"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 14705
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "107":
    id: "107"
    taskid: 0302ecaf-cd2a-42e5-815a-5c654668c4e1
    type: regular
    task:
      id: 0302ecaf-cd2a-42e5-815a-5c654668c4e1
      version: -1
      name: Get Schema Options
      description: Gets the enum values of a specified field in the asset schema.
      script: Cortex XDR - IR|||xdr-asset-schema-field-options-get
      type: regular
      iscommand: true
      brand: Cortex XDR - IR
    nexttasks:
      '#none#':
      - "112"
    scriptarguments:
      field_name:
        simple: xdm.asset.provider
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 14880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "108":
    id: "108"
    taskid: 1806c75b-3228-4aa3-8f7d-1c56eed7a3f8
    type: regular
    task:
      id: 1806c75b-3228-4aa3-8f7d-1c56eed7a3f8
      version: -1
      name: Create Asset Group
      description: Creates an asset group.
      script: Cortex XDR - IR|||xdr-asset-group-create
      type: regular
      iscommand: true
      brand: Cortex XDR - IR
    nexttasks:
      '#none#':
      - "109"
    scriptarguments:
      group_name:
        simple: tpbassetgroup${TimeNow}
      group_type:
        simple: Dynamic
      membership_predicate_json:
        simple: '{"AND":[{"SEARCH_FIELD":"xdm.asset.type.class","SEARCH_TYPE":"NEQ","SEARCH_VALUE":"Other"}]}'
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 15230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "109":
    id: "109"
    taskid: cd8a768a-ad52-4c62-b240-0687e74376dc
    type: regular
    task:
      id: cd8a768a-ad52-4c62-b240-0687e74376dc
      version: -1
      name: Get the new Asset Group
      description: Returns a list of asset groups.
      script: '|||xdr-asset-group-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "110"
    scriptarguments:
      filter_json:
        simple: '{"AND": [{"SEARCH_FIELD": "XDM.ASSET_GROUP.NAME", "SEARCH_TYPE":
          "EQ", "SEARCH_VALUE": "tpbassetgroup${TimeNow}"}]}'
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 15405
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "110":
    id: "110"
    taskid: 5b18a273-aa12-4279-b842-6173712c52fc
    type: regular
    task:
      id: 5b18a273-aa12-4279-b842-6173712c52fc
      version: -1
      name: Delete new Asset Group
      description: Deletes an asset group.
      script: Cortex XDR - IR|||xdr-asset-group-delete
      type: regular
      iscommand: true
      brand: Cortex XDR - IR
    nexttasks:
      '#none#':
      - "111"
    scriptarguments:
      group_id:
        complex:
          root: PaloAltoNetworksXDR.AssetGroup
          accessor: XDM_ASSET_GROUP_ID
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 15580
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "111":
    id: "111"
    taskid: 54fd3b00-bf6c-43e3-88af-8f8738739760
    type: title
    task:
      id: 54fd3b00-bf6c-43e3-88af-8f8738739760
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "24"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 15755
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "112":
    id: "112"
    taskid: a5e3ce30-bb8e-4332-b639-09f216cb39aa
    type: regular
    task:
      id: a5e3ce30-bb8e-4332-b639-09f216cb39aa
      version: -1
      name: Get Timestamp
      description: Retrieves the current date and time.
      scriptName: GetTime
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "108"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 15055
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "17_22_#default#": 0.47
    },
    "paper": {
      "dimensions": {
        "height": 15925,
        "width": 922.5,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
fromversion: 5.0.0