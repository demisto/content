id: Test Playbook - Cortex XDR Malware - Incident Enrichment
version: -1
name: Test Playbook - Cortex XDR Malware - Incident Enrichment
description: "This playbook tests the ‘Cortex XDR Malware - Incident Enrichment’ playbook which is part of the ‘Malware Investigation and Response’ pack.\nThe tests were constructed based on alert number 63 of the Cortex XDR development environment.\n\nFollowing are the tests conducted in the playbook:\n1- Confirm that incident fields were populated correctly by the custom output mapping rules and the 'setIncident' automation. \n2- Validate the enrichment of XDR incidents.\n3- Validate the enrichment of alerts and incident entities.\n3- Ensure that the context data was properly extracted.\n4. Check that the XDR alert information was correctly populated into the 'Alert' grid table of the Malware-Investigation and Response layout.\n5- Validate the outputs of the playbook."
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 3f4e9d64-ac90-4fe6-8db9-9c1bf19300b5
    type: start
    task:
      id: 3f4e9d64-ac90-4fe6-8db9-9c1bf19300b5
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "32"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": -1305
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: ad628ec6-62fc-4169-8c17-fa3f74befc77
    type: regular
    task:
      id: ad628ec6-62fc-4169-8c17-fa3f74befc77
      version: -1
      name: Delete Context
      description: The task deletes all of the context data. Having a clean beginning to a test playbook ensures that a test can be sterile and that unrelated issues can be eliminated.
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "149"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": -1175
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: c4a8cdbb-13d3-45b0-8e2f-e00eeaefa685
    type: title
    task:
      id: c4a8cdbb-13d3-45b0-8e2f-e00eeaefa685
      version: -1
      name: '''ExtractedIndicators'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "102"
      - "40"
      - "103"
      - "101"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 2035
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: 6329a83b-18de-4af3-83c2-55b117dffc44
    type: condition
    task:
      id: 6329a83b-18de-4af3-83c2-55b117dffc44
      version: -1
      name: Verify Domain
      description: Verify that the ‘ExtractedIndicators.Domain’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "105"
      Verified:
      - "53"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: ExtractedIndicators
                accessor: Domain
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 2180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: 37dd6b89-a138-49b0-8b1c-ca3aa6b9b8a0
    type: condition
    task:
      id: 37dd6b89-a138-49b0-8b1c-ca3aa6b9b8a0
      version: -1
      name: Verify  Incident
      description: |
        Verify that the ‘PaloAltoNetworksXDR.Incident’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "117"
      Verified:
      - "113"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR
                accessor: Incident
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1780,
          "y": 1560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: bca0213c-20b3-4bc2-8806-a57377b467f6
    type: title
    task:
      id: bca0213c-20b3-4bc2-8806-a57377b467f6
      version: -1
      name: Done verifying 'ExtractedIndicators'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6120,
          "y": 2370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: 2fcd7a03-1069-493e-8c48-dc5b23fff748
    type: title
    task:
      id: 2fcd7a03-1069-493e-8c48-dc5b23fff748
      version: -1
      name: '''Account'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "79"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "64":
    id: "64"
    taskid: 51c4c257-b2b0-48a5-8762-585ff8a5bbb2
    type: title
    task:
      id: 51c4c257-b2b0-48a5-8762-585ff8a5bbb2
      version: -1
      name: '''File'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "218"
      - "220"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 2650
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "65":
    id: "65"
    taskid: 8d859cac-0100-4252-8af2-db01e1a6a4ab
    type: title
    task:
      id: 8d859cac-0100-4252-8af2-db01e1a6a4ab
      version: -1
      name: '''Endpoint'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "199"
      - "200"
      - "202"
      - "203"
      - "204"
      - "205"
      - "206"
      - "207"
      - "208"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 3225
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "67":
    id: "67"
    taskid: 815d0e91-61b0-474e-81f0-426161d0f412
    type: title
    task:
      id: 815d0e91-61b0-474e-81f0-426161d0f412
      version: -1
      name: '''IP'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "81"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 860
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "69":
    id: "69"
    taskid: 58ef5e7e-84bb-4296-81bd-210c9c975829
    type: title
    task:
      id: 58ef5e7e-84bb-4296-81bd-210c9c975829
      version: -1
      name: '''Domain'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "265"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 3790
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "73":
    id: "73"
    taskid: 81f4591b-7603-4f4a-8d7b-5386173ee447
    type: condition
    task:
      id: 81f4591b-7603-4f4a-8d7b-5386173ee447
      version: -1
      name: Verify Alerts
      description: Verify that the ‘PaloAltoNetworksXDR.Incident.Alerts’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "116"
      Verified:
      - "113"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.Incident
                accessor: alerts
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "75":
    id: "75"
    taskid: e6e3ee65-fc60-45c9-854b-7145c7d321a8
    type: condition
    task:
      id: e6e3ee65-fc60-45c9-854b-7145c7d321a8
      version: -1
      name: Verify File Artifacts
      description: |
        Verify that the ‘PaloAltoNetworksXDR.Incident.file_artifacts’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "113"
      '#default#':
      - "114"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.file_artifacts
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 1560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "79":
    id: "79"
    taskid: 57770e5e-9e2e-4bf0-8d93-55da6ec585bd
    type: condition
    task:
      id: 57770e5e-9e2e-4bf0-8d93-55da6ec585bd
      version: -1
      name: Verify Email Address
      description: Verify that the 'Account.Email.Address’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "144"
      Verified:
      - "198"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: Account.Email
                accessor: Address
            iscontext: true
          right:
            value:
              complex:
                root: PaloAltoNetworksXDR.Incident
                accessor: assigned_user_mail
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "81":
    id: "81"
    taskid: ce567743-e042-4e90-8968-ea226e6eddd8
    type: condition
    task:
      id: ce567743-e042-4e90-8968-ea226e6eddd8
      version: -1
      name: Verify IP Address
      description: Verify that the 'IP.Address’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "145"
      Verified:
      - "131"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: IP
                accessor: Address
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: detectedinternalips
            iscontext: true
        - operator: in
          left:
            value:
              complex:
                root: IP
                accessor: Address
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: sourceips
            iscontext: true
        - operator: in
          left:
            value:
              complex:
                root: IP
                accessor: Address
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: devicelocalip
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 990
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "84":
    id: "84"
    taskid: 41b299e7-b523-413c-86ae-6993ae391366
    type: title
    task:
      id: 41b299e7-b523-413c-86ae-6993ae391366
      version: -1
      name: Start Tests
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "132"
      - "151"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": -680
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "101":
    id: "101"
    taskid: a9815dcd-9678-4916-8d19-cb2ebde5c76b
    type: condition
    task:
      id: a9815dcd-9678-4916-8d19-cb2ebde5c76b
      version: -1
      name: Verify File
      description: Verify that the ‘ExtractedIndicators.File’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "53"
      '#default#':
      - "107"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: incident
                accessor: filesha256
            iscontext: true
          right:
            value:
              complex:
                root: ExtractedIndicators
                accessor: File
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2240,
          "y": 2180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "102":
    id: "102"
    taskid: fc130f9a-bcfe-407b-836f-b10c06d4f415
    type: condition
    task:
      id: fc130f9a-bcfe-407b-836f-b10c06d4f415
      version: -1
      name: Verify IP
      description: Verify that the ‘ExtractedIndicators.IP’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "53"
      '#default#':
      - "108"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: ExtractedIndicators
                accessor: IP
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: devicelocalip
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1350,
          "y": 2180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "103":
    id: "103"
    taskid: 27f45f25-99c8-49d5-8123-a11759d71112
    type: condition
    task:
      id: 27f45f25-99c8-49d5-8123-a11759d71112
      version: -1
      name: Verify URL
      description: Verify that the ‘ExtractedIndicators.URL’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "53"
      '#default#':
      - "109"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: ExtractedIndicators
                accessor: URL
            iscontext: true
          right:
            value: {}
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1800,
          "y": 2180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "105":
    id: "105"
    taskid: a598e464-4420-4796-8a84-3c1f065fd408
    type: regular
    task:
      id: a598e464-4420-4796-8a84-3c1f065fd408
      version: -1
      name: Verify Context Data Error - Domain
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Domain' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'extractIndicators' automation outputs have been modified and no longer contain the 'ExtractedIndicators.Domain' context key. \n2- The 'text' input configuration was changed for the 'extractIndicators' automation used in the 'Extract Indicators' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 2435
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "107":
    id: "107"
    taskid: f89675cd-b53d-491d-8ac4-79e570f2445b
    type: regular
    task:
      id: f89675cd-b53d-491d-8ac4-79e570f2445b
      version: -1
      name: Verify Context Data Error - File
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'File' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'extractIndicators' automation outputs have been modified and no longer contain the 'ExtractedIndicators.File' context key. \n2- The 'text' input configuration was changed for the 'extractIndicators' automation used in the 'Extract Indicators' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2240,
          "y": 2435
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "108":
    id: "108"
    taskid: 24bc5de4-5a07-4ffa-814d-01f4c58d68db
    type: regular
    task:
      id: 24bc5de4-5a07-4ffa-814d-01f4c58d68db
      version: -1
      name: Verify Context Data Error - IP
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'IP' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'extractIndicators' automation outputs have been modified and no longer contain the 'ExtractedIndicators.IP' context key. \n2- The 'text' input configuration was changed for the 'extractIndicators' automation used in the 'Extract Indicators' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1350,
          "y": 2435
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "109":
    id: "109"
    taskid: 44eefb86-40b4-477c-87eb-7fa154032c33
    type: regular
    task:
      id: 44eefb86-40b4-477c-87eb-7fa154032c33
      version: -1
      name: Verify Context Data Error - URL
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'URL' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'extractIndicators' automation outputs have been modified and no longer contain the 'ExtractedIndicators.URL' context key. \n2- The 'text' input configuration was changed for the 'extractIndicators' automation used in the 'Extract Indicators' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1800,
          "y": 2435
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "112":
    id: "112"
    taskid: 6abe1679-e231-48a8-81cd-63dda93c5d63
    type: title
    task:
      id: 6abe1679-e231-48a8-81cd-63dda93c5d63
      version: -1
      name: '''PaloAltoNetworksXDR'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "46"
      - "73"
      - "75"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 1410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "113":
    id: "113"
    taskid: 79a2f814-5c87-485c-8274-1ec75fa9fc8c
    type: title
    task:
      id: 79a2f814-5c87-485c-8274-1ec75fa9fc8c
      version: -1
      name: Done verifying 'PaloAltoNetworksXDR'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6120,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "114":
    id: "114"
    taskid: dff4f8c9-65f3-42b7-81a0-2a4642626003
    type: regular
    task:
      id: dff4f8c9-65f3-42b7-81a0-2a4642626003
      version: -1
      name: Verify Context Error - File Artifacts
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'PaloAltoNetworksXDR.Incident.file_artifacts' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.Incident.file_artifacts' context key. \n2- The 'incident_id' input configuration was changed for the 'xdr-get-incident-extra-data' automation used in the 'Get Full Incident Details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 1805
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "116":
    id: "116"
    taskid: 06e50144-748e-4e32-8730-7504535f1b7c
    type: regular
    task:
      id: 06e50144-748e-4e32-8730-7504535f1b7c
      version: -1
      name: Verify Context Data Error - Alerts
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'PaloAltoNetworksXDR.Incident.alerts' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.Incident.alerts' context key. \n2- The 'incident_id' input configuration was changed for the 'xdr-get-incident-extra-data' automation used in the 'Get Full Incident Details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1805
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "117":
    id: "117"
    taskid: cf0fd222-0bf1-45ef-8d87-cff57f9e61fa
    type: regular
    task:
      id: cf0fd222-0bf1-45ef-8d87-cff57f9e61fa
      version: -1
      name: Verify Context Data Error - Incident
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'PaloAltoNetworksXDR.Incident' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.Incident' context key. \n2- The 'incident_id' input configuration was changed for the 'xdr-get-incident-extra-data' automation used in the 'Get Full Incident Details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1780,
          "y": 1805
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "125":
    id: "125"
    taskid: 9ada667b-8bbf-477a-86f8-2ee768fd031f
    type: regular
    task:
      id: 9ada667b-8bbf-477a-86f8-2ee768fd031f
      version: -1
      name: Verify Context Error  - Hostname
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.Hostname’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.Hostname' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task.\n3- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'Endpoint.Hostname' context key. \n4- The 'incident_id' input configuration was changed for the 'xdr-get-incident-extra-data' automation used in the 'Get Full Incident Details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4135,
          "y": 3615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "126":
    id: "126"
    taskid: 8bc18ddc-3660-4297-8cff-1a42d4baef17
    type: title
    task:
      id: 8bc18ddc-3660-4297-8cff-1a42d4baef17
      version: -1
      name: Done verifying 'Domain' context
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6130,
          "y": 4130
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "127":
    id: "127"
    taskid: a5afc08e-d33d-43a3-8c23-e17afdcc43d3
    type: title
    task:
      id: a5afc08e-d33d-43a3-8c23-e17afdcc43d3
      version: -1
      name: Done verifying 'Endpoint'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6130,
          "y": 3570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "128":
    id: "128"
    taskid: 568b5899-7ed9-4c65-8fe0-8cf2c29bc01c
    type: title
    task:
      id: 568b5899-7ed9-4c65-8fe0-8cf2c29bc01c
      version: -1
      name: Done verifying 'File'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6120,
          "y": 2980
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "131":
    id: "131"
    taskid: 663a2b84-568a-4f22-86ba-d2a12f3b807a
    type: title
    task:
      id: 663a2b84-568a-4f22-86ba-d2a12f3b807a
      version: -1
      name: Done verifying 'IP' context
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6120,
          "y": 1230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "132":
    id: "132"
    taskid: 0f6516cb-8673-4233-8569-bcde45b77c29
    type: title
    task:
      id: 0f6516cb-8673-4233-8569-bcde45b77c29
      version: -1
      name: Check Incident Fields
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "137"
      - "152"
      - "153"
      - "154"
      - "155"
      - "156"
      - "167"
      - "166"
      - "163"
      - "162"
      - "161"
      - "255"
      - "257"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": -540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "136":
    id: "136"
    taskid: fc4e0550-9a27-48dc-8e59-e1c4e60306e2
    type: title
    task:
      id: fc4e0550-9a27-48dc-8e59-e1c4e60306e2
      version: -1
      name: Done verifying Incident Fields
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6130,
          "y": -165
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "137":
    id: "137"
    taskid: eea8f07a-e7c5-4213-8e94-a36bea70aebd
    type: condition
    task:
      id: eea8f07a-e7c5-4213-8e94-a36bea70aebd
      version: -1
      name: Verify Alerts And Related Info
      description: |-
        Verify that the ‘alertsandrelatedinfo’ incident field was filled out correctly.
        These Incident Field are affecting the incident layouts (grid_id)
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "138"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: incident.alertsandrelatedinfo.alertname
            iscontext: true
          right:
            value:
              complex:
                root: PaloAltoNetworksXDR.Incident.alerts
                accessor: name
            iscontext: true
          ignorecase: true
      - - operator: containsGeneral
          left:
            value:
              simple: incident.alertsandrelatedinfo.hostname
            iscontext: true
          right:
            value:
              complex:
                root: PaloAltoNetworksXDR.Incident.alerts
                accessor: host_name
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "138":
    id: "138"
    taskid: 4cfeda80-a069-425e-82d5-9093bff55a8e
    type: regular
    task:
      id: 4cfeda80-a069-425e-82d5-9093bff55a8e
      version: -1
      name: Verify Incident Field Error - Alerts And Related Info
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'alertsandrelatedinfo' incident field was not set correctly. This may indicate that the following change has been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:
          1- The 'grid_id' input configuration was changed for the 'SetGridField' automation used in the 'Set Alerts Table Info in the Layout' task.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "140":
    id: "140"
    taskid: a07eca09-4876-42ad-8424-27ff32e1ee64
    type: regular
    task:
      id: a07eca09-4876-42ad-8424-27ff32e1ee64
      version: -1
      name: Verify Incident Field Error - MD5
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'MD5' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.Incident.alerts.actor_process_image_md5' context key. \n2- The 'MD5' input configuration was changed for the 'setIncident' automation used in the 'Set Process Details To Layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "144":
    id: "144"
    taskid: 7b1fa7af-f190-4def-855f-d90ee4d70570
    type: regular
    task:
      id: 7b1fa7af-f190-4def-855f-d90ee4d70570
      version: -1
      name: Verify Context Error - Email Address
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Account.Email.Address’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'Account Enrichment - Generic v2.1' sub-playbook outputs have been modified and no longer contain the 'Account.Email.Address' context key. \n2- The 'Username' input configuration was changed for the 'Account Enrichment - Generic v2.1' sub-playbook inputs."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 640
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "145":
    id: "145"
    taskid: ef927510-1489-4c02-8ac5-401294e24c5a
    type: regular
    task:
      id: ef927510-1489-4c02-8ac5-401294e24c5a
      version: -1
      name: Verify Context Error  - IP Address
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'IP.Address’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'extractIndicators' automation outputs have been modified and no longer contain the 'IP' context key. \n2- The 'text' input configuration was changed for the 'extractIndicators' automation used in the 'Extract Indicators' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 920,
          "y": 1200
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "149":
    id: "149"
    taskid: 0c220317-bbb1-4e1d-8f9c-230b94e9a461
    type: regular
    task:
      id: 0c220317-bbb1-4e1d-8f9c-230b94e9a461
      version: -1
      name: Set Incident Fields To Context
      description: Add incident fields required for testing to the mock incident.
      script: Builtin|||setIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "150"
    scriptarguments:
      agentsid:
        simple: aeec6a2cc92e46fab3b6f621722e9916
      alertsandrelatedinfo:
        simple: '[{"columnheader3":""},{},{}]'
      externalsystemid:
        simple: "812"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": -1010
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    fieldMapping:
    - incidentfield: Agents ID
      output:
        simple: aeec6a2cc92e46fab3b6f621722e9916
  "150":
    id: "150"
    taskid: 72f7258f-f6ba-4d46-834f-0de1ec2351fd
    type: playbook
    task:
      id: 72f7258f-f6ba-4d46-834f-0de1ec2351fd
      version: -1
      name: Cortex XDR Malware - Incident Enrichment
      playbookName: Cortex XDR Malware - Incident Enrichment
      type: playbook
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "84"
    scriptarguments:
      IncidentID:
        complex:
          root: incident
          accessor: externalsystemid
    separatecontext: false
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 590,
          "y": -850
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "151":
    id: "151"
    taskid: 2b6fc58a-6410-4e10-8e49-dc3b89c4c9a8
    type: title
    task:
      id: 2b6fc58a-6410-4e10-8e49-dc3b89c4c9a8
      version: -1
      name: Check Context Data
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "63"
      - "67"
      - "112"
      - "39"
      - "64"
      - "69"
      - "278"
      - "65"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": 125
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "152":
    id: "152"
    taskid: ccbfd03a-d592-4f31-8fb3-95ef1c4f6403
    type: condition
    task:
      id: ccbfd03a-d592-4f31-8fb3-95ef1c4f6403
      version: -1
      name: Verify MD5
      description: |
        Verify that the ‘MD5’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "140"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: incident.md5
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "153":
    id: "153"
    taskid: 2567b6e4-ebdd-45e6-8603-1fb510a68f62
    type: condition
    task:
      id: 2567b6e4-ebdd-45e6-8603-1fb510a68f62
      version: -1
      name: Verify Parent Process File Path
      description: |
        Verify that the ‘parentprocessfilepath’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "157"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: incident.parentprocessfilepath
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1740,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "154":
    id: "154"
    taskid: 6da95ab3-3dc8-4afc-82e2-82aea6e20df1
    type: condition
    task:
      id: 6da95ab3-3dc8-4afc-82e2-82aea6e20df1
      version: -1
      name: Verify Process Name
      description: |
        Verify that the ‘processname’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "158"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: incident.processname
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2140,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "155":
    id: "155"
    taskid: 10760210-a42e-407c-8ff4-ba493f7b2532
    type: condition
    task:
      id: 10760210-a42e-407c-8ff4-ba493f7b2532
      version: -1
      name: Verify Process Path
      description: |
        Verify that the ‘processpath’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "159"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: incident.processpath
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2540,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "156":
    id: "156"
    taskid: ee5ef1cb-8861-44a0-8cf5-bffbf36ca2b0
    type: condition
    task:
      id: ee5ef1cb-8861-44a0-8cf5-bffbf36ca2b0
      version: -1
      name: Verify SHA256
      description: |
        Verify that the ‘SHA256’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "160"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: incident.sha256
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2940,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "157":
    id: "157"
    taskid: 1a6fb3db-257f-4fe8-8955-5cbf4eb8c412
    type: regular
    task:
      id: 1a6fb3db-257f-4fe8-8955-5cbf4eb8c412
      version: -1
      name: Verify Incident Field Error - Parent Process File Path
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'parentprocessfilepath' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.Incident.alerts.causality_actor_process_image_path' context key. \n2- The 'parentprocessfilepath' input configuration was changed for the 'setIncident' automation used in the 'Set Process Details To Layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1740,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "158":
    id: "158"
    taskid: a557f4e5-9cb3-43b7-8ef8-8decdc10d85b
    type: regular
    task:
      id: a557f4e5-9cb3-43b7-8ef8-8decdc10d85b
      version: -1
      name: Verify Incident Field Error - Process Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'processname' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.Incident.alerts.actor_process_image_name' context key. \n2- The 'processname' input configuration was changed for the 'setIncident' automation used in the 'Set Process Details To Layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2140,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "159":
    id: "159"
    taskid: b3ca26ff-adb7-4bdf-8479-9fd1573539e6
    type: regular
    task:
      id: b3ca26ff-adb7-4bdf-8479-9fd1573539e6
      version: -1
      name: Verify Incident Field Error - Process Path
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'processpath' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.Incident.alerts.actor_process_image_path' context key. \n2- The 'processpath' input configuration was changed for the 'setIncident' automation used in the 'Set Process Details To Layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2540,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "160":
    id: "160"
    taskid: 517f1b25-68b7-4cd7-8872-bf1a7c0f0041
    type: regular
    task:
      id: 517f1b25-68b7-4cd7-8872-bf1a7c0f0041
      version: -1
      name: Verify Incident Field Error - SHA256
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'sha256' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.Incident.alerts.actor_process_image_sha256' context key. \n2- The 'sha256' input configuration was changed for the 'setIncident' automation used in the 'Set Process Details To Layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2940,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "161":
    id: "161"
    taskid: ff078ec4-6ce9-4c31-8d9e-12b6a43d52e0
    type: condition
    task:
      id: ff078ec4-6ce9-4c31-8d9e-12b6a43d52e0
      version: -1
      name: Verify Account Member Of
      description: |
        Verify that the ‘accountmemberof’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "168"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: incident
                accessor: accountmemberof
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3350,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "162":
    id: "162"
    taskid: 17dc822e-80b1-494d-80f4-2eb30b9f1341
    type: condition
    task:
      id: 17dc822e-80b1-494d-80f4-2eb30b9f1341
      version: -1
      name: Verify Account Name
      description: |
        Verify that the ‘accountname’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "169"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: incident
                accessor: accountname
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3755,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "163":
    id: "163"
    taskid: efcd6ad0-b0a6-47f6-83f0-aee5b92e3b62
    type: condition
    task:
      id: efcd6ad0-b0a6-47f6-83f0-aee5b92e3b62
      version: -1
      name: Verify Account Status
      description: |
        Verify that the ‘accountstatus’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "170"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: incident
                accessor: accountstatus
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4150,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "166":
    id: "166"
    taskid: 9b5994f7-bd13-4ddc-8937-563b1104a9a5
    type: condition
    task:
      id: 9b5994f7-bd13-4ddc-8937-563b1104a9a5
      version: -1
      name: Verify Manager Name
      description: |
        Verify that the ‘managername’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "173"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: incident
                accessor: managername
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4550,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "167":
    id: "167"
    taskid: 300b4a80-f1bb-4a7c-80b4-eaa66adacde6
    type: condition
    task:
      id: 300b4a80-f1bb-4a7c-80b4-eaa66adacde6
      version: -1
      name: Verify SAM Account Name
      description: |
        Verify that the ‘samaccountname’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "174"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: incident
                accessor: samaccountname
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4950,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "168":
    id: "168"
    taskid: 5f5d3080-df05-4ce4-861a-0f2dff1bea1a
    type: regular
    task:
      id: 5f5d3080-df05-4ce4-861a-0f2dff1bea1a
      version: -1
      name: Verify Incident Field Error - Account Member Of
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'accountmemberof' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'Account Enrichment - Generic v2.1' sub-playbook outputs have been modified and no longer contain the 'Account.Groups' context key. \n2- The 'accountmemberof' input configuration was changed for the 'setIncident' automation used in the 'Set Account information to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3350,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "169":
    id: "169"
    taskid: 8b4c6cce-a9e9-4851-8f28-9b002b5f96ce
    type: regular
    task:
      id: 8b4c6cce-a9e9-4851-8f28-9b002b5f96ce
      version: -1
      name: Verify Incident Field Error - Account Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'accountname' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'Account Enrichment - Generic v2.1' sub-playbook outputs have been modified and no longer contain the 'Account.DisplayName' context key. \n2- The 'accountname' input configuration was changed for the 'setIncident' automation used in the 'Set Account information to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3750,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "170":
    id: "170"
    taskid: 44afd435-ad85-43e0-8e65-85367b8b09f9
    type: regular
    task:
      id: 44afd435-ad85-43e0-8e65-85367b8b09f9
      version: -1
      name: Verify Incident Field Error - Account Status
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'accountstatus' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'Account Enrichment - Generic v2.1' sub-playbook outputs have been modified and no longer contain the 'Account.Status' context key. \n2- The 'accountstatus' input configuration was changed for the 'setIncident' automation used in the 'Set Account information to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4150,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "173":
    id: "173"
    taskid: e29279fd-9d70-471a-81ef-84329ab1ffd2
    type: regular
    task:
      id: e29279fd-9d70-471a-81ef-84329ab1ffd2
      version: -1
      name: Verify Incident Field Error - Manager Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'managername' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'Account Enrichment - Generic v2.1' sub-playbook outputs have been modified and no longer contain the 'Account.Manager' context key. \n2- The 'managername' input configuration was changed for the 'setIncident' automation used in the 'Set Account information to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4560,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "174":
    id: "174"
    taskid: 515e718b-e95c-44be-8265-b95c4b5a687c
    type: regular
    task:
      id: 515e718b-e95c-44be-8265-b95c4b5a687c
      version: -1
      name: Verify Incident Field Error - SAM Account Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'samaccountname' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'Account Enrichment - Generic v2.1' sub-playbook outputs have been modified and no longer contain the 'Account.Username' context key. \n2- The 'samaccountname' input configuration was changed for the 'setIncident' automation used in the 'Set Account information to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4950,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "198":
    id: "198"
    taskid: 2cc817b4-1cf4-4cba-8f11-d3ac903a1c59
    type: title
    task:
      id: 2cc817b4-1cf4-4cba-8f11-d3ac903a1c59
      version: -1
      name: Done verifying 'Account'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6120,
          "y": 630
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "199":
    id: "199"
    taskid: 98a14168-7a06-4e8b-8240-463fb0902351
    type: condition
    task:
      id: 98a14168-7a06-4e8b-8240-463fb0902351
      version: -1
      name: Verify Hostname
      description: Verify that the 'Endpoint.Hostname’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "125"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: Endpoint
                accessor: Hostname
            iscontext: true
          right:
            value:
              complex:
                root: PaloAltoNetworksXDR.Incident.alerts
                accessor: host_name
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4135,
          "y": 3370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "200":
    id: "200"
    taskid: d78718ef-9372-4b36-8ef7-3d5b42a70d3c
    type: condition
    task:
      id: d78718ef-9372-4b36-8ef7-3d5b42a70d3c
      version: -1
      name: Verify Is Isolated
      description: Verify that the 'Endpoint.IsIsolated’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "201"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: Endpoint
                accessor: IsIsolated
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: isolated
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3735,
          "y": 3370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "201":
    id: "201"
    taskid: 95e7105b-0a0a-45bb-86d3-83fcf6d7ae4f
    type: regular
    task:
      id: 95e7105b-0a0a-45bb-86d3-83fcf6d7ae4f
      version: -1
      name: Verify Context Error  -  Is Isolated
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.IsIsolated’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.IsIsolated' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3735,
          "y": 3615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "202":
    id: "202"
    taskid: 4f83694c-e6e0-405d-8c8a-773d3b63b398
    type: condition
    task:
      id: 4f83694c-e6e0-405d-8c8a-773d3b63b398
      version: -1
      name: Verify Domain
      description: Verify that the 'Endpoint.Domain’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "209"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: Endpoint
                accessor: Domain
            iscontext: true
          right:
            value: {}
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3335,
          "y": 3370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "203":
    id: "203"
    taskid: 0ab83395-9ad7-4ec0-8a97-0aef09f8d737
    type: condition
    task:
      id: 0ab83395-9ad7-4ec0-8a97-0aef09f8d737
      version: -1
      name: Verify OS
      description: Verify that the 'Endpoint.OS’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "210"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: Endpoint
                accessor: OS
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: deviceosname
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2935,
          "y": 3370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "204":
    id: "204"
    taskid: 0bc09e5d-5416-4222-890d-893859bb5cee
    type: condition
    task:
      id: 0bc09e5d-5416-4222-890d-893859bb5cee
      version: -1
      name: Verify MAC Address
      description: Verify that the 'Endpoint.MACAddress’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "211"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: Endpoint
                accessor: MACAddress
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: devicemacaddress
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2545,
          "y": 3370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "205":
    id: "205"
    taskid: d3bdbfaf-7931-43ec-875d-1fac60556cf4
    type: condition
    task:
      id: d3bdbfaf-7931-43ec-875d-1fac60556cf4
      version: -1
      name: Verify Vendor
      description: Verify that the 'Endpoint.Vendor’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "212"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: Endpoint
                accessor: Vendor
            iscontext: true
          right:
            value: {}
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2135,
          "y": 3370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "206":
    id: "206"
    taskid: 87e35495-5e7b-4735-887b-518f3b40bf3e
    type: condition
    task:
      id: 87e35495-5e7b-4735-887b-518f3b40bf3e
      version: -1
      name: Verify IP Address
      description: Verify that the 'Endpoint.IPAddress’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "213"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: Endpoint
                accessor: IPAddress
            iscontext: true
          right:
            value:
              complex:
                root: PaloAltoNetworksXDR.Incident.alerts
                accessor: host_ip
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1735,
          "y": 3370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "207":
    id: "207"
    taskid: f0775a4e-6464-4cf1-824c-5dc64df7b3d7
    type: condition
    task:
      id: f0775a4e-6464-4cf1-824c-5dc64df7b3d7
      version: -1
      name: Verify Status
      description: Verify that the 'Endpoint.Status’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "214"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: Endpoint
                accessor: Status
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: devicestatus
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1335,
          "y": 3370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "208":
    id: "208"
    taskid: 737b091c-1f60-4dbb-88c2-d842439bd97f
    type: condition
    task:
      id: 737b091c-1f60-4dbb-88c2-d842439bd97f
      version: -1
      name: Verify ID
      description: Verify that the 'Endpoint.ID’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "215"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: Endpoint
                accessor: ID
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: deviceid
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 3370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "209":
    id: "209"
    taskid: 38ebbc6d-95ac-4b46-8eb5-34419ba532dc
    type: regular
    task:
      id: 38ebbc6d-95ac-4b46-8eb5-34419ba532dc
      version: -1
      name: Verify Context Error  -  Domain
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.Domain’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.Domain' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3335,
          "y": 3615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "210":
    id: "210"
    taskid: bbe05abb-6962-4ece-8c06-e5cd514f94ea
    type: regular
    task:
      id: bbe05abb-6962-4ece-8c06-e5cd514f94ea
      version: -1
      name: Verify Context Error  -  OS
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.OS’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.OS' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2925,
          "y": 3615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "211":
    id: "211"
    taskid: ad082545-8c60-40af-82ac-abc942c59527
    type: regular
    task:
      id: ad082545-8c60-40af-82ac-abc942c59527
      version: -1
      name: Verify Context Error  - MAC Address
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.MACAddress’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.MACAddress' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2525,
          "y": 3615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "212":
    id: "212"
    taskid: 2959888b-84a1-421b-8985-a1c8f2286ab2
    type: regular
    task:
      id: 2959888b-84a1-421b-8985-a1c8f2286ab2
      version: -1
      name: Verify Context Error  - Vendor
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.Vendor’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.Vendor' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2125,
          "y": 3615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "213":
    id: "213"
    taskid: 24f4507c-4a51-44f5-8c65-0a46523cf182
    type: regular
    task:
      id: 24f4507c-4a51-44f5-8c65-0a46523cf182
      version: -1
      name: Verify Context Error  - IP Address
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.IPAddress’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.IPAddress' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1725,
          "y": 3610
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "214":
    id: "214"
    taskid: 15f322e7-a0fd-4d29-87f2-a565d0eba7e4
    type: regular
    task:
      id: 15f322e7-a0fd-4d29-87f2-a565d0eba7e4
      version: -1
      name: Verify Context Error  - Status
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.Status’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.Status' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1335,
          "y": 3615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "215":
    id: "215"
    taskid: 6fb97ca0-4333-4df7-8ca4-67dbe7ae3448
    type: regular
    task:
      id: 6fb97ca0-4333-4df7-8ca4-67dbe7ae3448
      version: -1
      name: Verify Context Error  - ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.ID’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.ID' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 3615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "218":
    id: "218"
    taskid: 4f147585-8a72-455f-8eaa-34be5ae45bb3
    type: condition
    task:
      id: 4f147585-8a72-455f-8eaa-34be5ae45bb3
      version: -1
      name: Verify SHA265
      description: Verify that the 'File.SHA256’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "219"
      Verified:
      - "128"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: File
                accessor: SHA256
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: filesha256
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1335,
          "y": 2795
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "219":
    id: "219"
    taskid: 09d3fe22-ebef-492e-8f6f-8643ab2c5503
    type: regular
    task:
      id: 09d3fe22-ebef-492e-8f6f-8643ab2c5503
      version: -1
      name: Verify Context Error - SHA265
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'File.SHA256’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'File.SHA256' context key. \n2- The 'incident_id' input configuration was changed for the 'xdr-get-incident-extra-data' automation used in the 'Get Full Incident Details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1335,
          "y": 3015
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "220":
    id: "220"
    taskid: c8c4d80f-c257-44bc-8501-2e0b534b31cc
    type: condition
    task:
      id: c8c4d80f-c257-44bc-8501-2e0b534b31cc
      version: -1
      name: Verify Name
      description: Verify that the 'File.Name’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "221"
      Verified:
      - "128"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: File
                accessor: Name
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: filenames
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 2795
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "221":
    id: "221"
    taskid: 69273d11-d282-4fcd-8feb-76890ee4b28e
    type: regular
    task:
      id: 69273d11-d282-4fcd-8feb-76890ee4b28e
      version: -1
      name: Verify Context Error - Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'File.Name’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'File.Name' context key. \n2- The 'incident_id' input configuration was changed for the 'xdr-get-incident-extra-data' automation used in the 'Get Full Incident Details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 3015
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "255":
    id: "255"
    taskid: 9eb1ee24-48ab-4482-8dca-dad70357755c
    type: condition
    task:
      id: 9eb1ee24-48ab-4482-8dca-dad70357755c
      version: -1
      name: Verify Hostnames
      description: |
        Verify that the ‘hostnames’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "256"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: hostnames
            iscontext: true
          right:
            value:
              complex:
                root: PaloAltoNetworksXDR.Incident.alerts
                accessor: host_name
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5360,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "256":
    id: "256"
    taskid: dadd41bb-cc26-41f8-8fec-3e79b7deb68f
    type: regular
    task:
      id: dadd41bb-cc26-41f8-8fec-3e79b7deb68f
      version: -1
      name: Verify Incident Field Error - Hostnames
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Hostnames' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.Incident.alerts.host_name' context key. \n2- The 'incident_id' input configuration was changed for the 'xdr-get-incident-extra-data' automation used in the 'Get Full Incident Details' task.\n3- The custom output mapping rule for the 'Hostnames' incident field configured within the 'Get Full Incident Details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5360,
          "y": -90
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "257":
    id: "257"
    taskid: ef512a3f-4beb-40f0-8c93-916ad1e0f6fb
    type: condition
    task:
      id: ef512a3f-4beb-40f0-8c93-916ad1e0f6fb
      version: -1
      name: Verify Detected Users
      description: |
        Verify that the ‘detectedusers’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "258"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: incident
                accessor: detectedusers
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5760,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "258":
    id: "258"
    taskid: 008b0762-f66b-4fd0-8795-738b2f30fc3f
    type: regular
    task:
      id: 008b0762-f66b-4fd0-8795-738b2f30fc3f
      version: -1
      name: Verify Incident Field Error - Detected Users
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'detectedusers' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.Incident.alerts.user_name' context key. \n2- The 'incident_id' input configuration was changed for the 'xdr-get-incident-extra-data' automation used in the 'Get Full Incident Details' task.\n3- The custom output mapping rule for the 'detectedusers' incident field configured within the 'Get Full Incident Details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5760,
          "y": -85
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "265":
    id: "265"
    taskid: 1c6c2342-af06-4e36-884b-0004a6b4be5d
    type: condition
    task:
      id: 1c6c2342-af06-4e36-884b-0004a6b4be5d
      version: -1
      name: Verify Context - Name
      description: Verify that the 'Domain.Name’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "266"
      Verified:
      - "126"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Domain
                accessor: Name
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 3920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "266":
    id: "266"
    taskid: 5635ed70-539f-4e96-813e-06244671fa8a
    type: regular
    task:
      id: 5635ed70-539f-4e96-813e-06244671fa8a
      version: -1
      name: Verify Context Error  - Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Domain.Name’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'extractIndicators' automation outputs have been modified and no longer contain the 'Domain' context key. \n2- The 'text' input configuration was changed for the 'extractIndicators' automation used in the 'Extract Indicators' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 4150
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "277":
    id: "277"
    taskid: fa389d4b-7181-4107-8ae4-06b68b42f98c
    type: title
    task:
      id: fa389d4b-7181-4107-8ae4-06b68b42f98c
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6400,
          "y": 4830
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "278":
    id: "278"
    taskid: 8e12b74b-49bd-49f6-8dfb-8783c8e2a3ae
    type: title
    task:
      id: 8e12b74b-49bd-49f6-8dfb-8783c8e2a3ae
      version: -1
      name: '''URL'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "290"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 4360
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "281":
    id: "281"
    taskid: b65c69d4-5a65-445d-8dd0-3c701fb8e58d
    type: title
    task:
      id: b65c69d4-5a65-445d-8dd0-3c701fb8e58d
      version: -1
      name: Done verifying 'URL'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6130,
          "y": 4685
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "290":
    id: "290"
    taskid: 0f20b500-f122-4b5e-8c81-5294931f7294
    type: condition
    task:
      id: 0f20b500-f122-4b5e-8c81-5294931f7294
      version: -1
      name: Verify Data
      description: Verify that the 'URL.Data’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "291"
      Verified:
      - "281"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: URL
                accessor: Data
            iscontext: true
          right:
            value:
              complex:
                root: ExtractedIndicators
                accessor: URL
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 4495
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "291":
    id: "291"
    taskid: 7cf71d8f-9c21-4b06-8b57-eca631086d08
    type: regular
    task:
      id: 7cf71d8f-9c21-4b06-8b57-eca631086d08
      version: -1
      name: Verify Context Error - Data
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'URL.Data’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'extractIndicators' automation outputs have been modified and no longer contain the 'URL' context key. \n2- The 'text' input configuration was changed for the 'extractIndicators' automation used in the 'Extract Indicators' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 4715
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "101_53_ Verified": 0.1,
      "102_53_ Verified": 0.11,
      "103_53_ Verified": 0.1,
      "137_136_Verified": 0.1,
      "152_136_Verified": 0.1,
      "40_53_Verified": 0.1,
      "46_113_Verified": 0.1,
      "73_116_#default#": 0.7,
      "75_113_ Verified": 0.1
    },
    "paper": {
      "dimensions": {
        "height": 6200,
        "width": 6190,
        "x": 590,
        "y": -1305
      }
    }
  }
inputs: []
outputs: []
fromversion: 6.5.0