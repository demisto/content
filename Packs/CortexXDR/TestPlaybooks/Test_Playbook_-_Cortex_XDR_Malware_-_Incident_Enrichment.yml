id: Test Playbook - Cortex XDR Malware - Incident Enrichment
version: -1
vcShouldKeepItemLegacyProdMachine: false
name: Test Playbook - Cortex XDR Malware - Incident Enrichment
description: "This playbook tests the ‘Cortex XDR Malware - Incident Enrichment’ playbook
  which is part of the ‘Malware Investigation and Response’ pack.\nThe tests were
  constructed based on alert number 63 of the Cortex XDR development environment.\n\nFollowing
  are the tests conducted in the playbook:\n1- Confirm that incident fields were populated
  correctly by the custom output mapping rules and the 'setIncident' automation. \n2-
  Validate the enrichment of XDR incidents.\n3- Validate the enrichment of alerts
  and incident entities.\n3- Ensure that the context data was properly extracted.\n4.
  Check that the XDR alert information was correctly populated into the 'Alert' grid
  table of the Malware-Investigation and Response layout.\n5- Validate the outputs
  of the playbook."
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: d2bd18b2-f781-4cde-8cfe-5a66462f00d0
    type: start
    task:
      id: d2bd18b2-f781-4cde-8cfe-5a66462f00d0
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": -1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: fc4b40fd-aa26-4b27-8417-6d4bd76f49c9
    type: regular
    task:
      id: fc4b40fd-aa26-4b27-8417-6d4bd76f49c9
      version: -1
      name: Delete Context
      description: The task deletes all of the context data. Having a clean beginning
        to a test playbook ensures that a test can be sterile and that unrelated issues
        can be eliminated.
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "292"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": -1465
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: 35972da6-039f-4eb1-894b-70a178fca38e
    type: title
    task:
      id: 35972da6-039f-4eb1-894b-70a178fca38e
      version: -1
      name: '''ExtractedIndicators'' Context Data'
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "102"
      - "40"
      - "103"
      - "101"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 2035
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: 97cac227-503e-4cc2-8a36-e1c258db65dd
    type: condition
    task:
      id: 97cac227-503e-4cc2-8a36-e1c258db65dd
      version: -1
      name: Verify Domain
      description: Verify that the ‘ExtractedIndicators.Domain’ context key was extracted
        correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "105"
      Verified:
      - "53"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: ExtractedIndicators
                accessor: Domain
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 2180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: ecb56331-656d-4b72-85f5-17619a1c84eb
    type: condition
    task:
      id: ecb56331-656d-4b72-85f5-17619a1c84eb
      version: -1
      name: Verify  Incident
      description: |
        Verify that the ‘PaloAltoNetworksXDR.Incident’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "117"
      Verified:
      - "113"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR
                accessor: Incident
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1780,
          "y": 1560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: f64bccd9-cbd4-42e0-8c37-fedc206bb7e8
    type: title
    task:
      id: f64bccd9-cbd4-42e0-8c37-fedc206bb7e8
      version: -1
      name: Done verifying 'ExtractedIndicators'
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6120,
          "y": 2370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: d673fb39-710e-4b7c-8536-d847d142d7ee
    type: title
    task:
      id: d673fb39-710e-4b7c-8536-d847d142d7ee
      version: -1
      name: '''Account'' Context Data'
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "79"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "64":
    id: "64"
    taskid: 2280983b-e2b1-4a99-834e-36e969e3293b
    type: title
    task:
      id: 2280983b-e2b1-4a99-834e-36e969e3293b
      version: -1
      name: '''File'' Context Data'
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "218"
      - "220"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 2650
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "65":
    id: "65"
    taskid: a45e807d-7be1-446f-82d3-0fa4bb9a2116
    type: title
    task:
      id: a45e807d-7be1-446f-82d3-0fa4bb9a2116
      version: -1
      name: '''Endpoint'' Context Data'
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "199"
      - "200"
      - "202"
      - "203"
      - "204"
      - "205"
      - "206"
      - "207"
      - "208"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 3225
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "67":
    id: "67"
    taskid: 49438f15-09d5-458c-80a0-cc5b9c6eb295
    type: title
    task:
      id: 49438f15-09d5-458c-80a0-cc5b9c6eb295
      version: -1
      name: '''IP'' Context Data'
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "81"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 860
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "69":
    id: "69"
    taskid: befa2ad1-ae14-4a90-8a75-e0cf61d75514
    type: title
    task:
      id: befa2ad1-ae14-4a90-8a75-e0cf61d75514
      version: -1
      name: '''Domain'' Context Data'
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "265"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 3790
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "73":
    id: "73"
    taskid: b11d45c8-d35f-434e-8417-06f4bbc1c72d
    type: condition
    task:
      id: b11d45c8-d35f-434e-8417-06f4bbc1c72d
      version: -1
      name: Verify Alerts
      description: Verify that the ‘PaloAltoNetworksXDR.Incident.Alerts’ context key
        was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "116"
      Verified:
      - "113"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.Incident
                accessor: alerts
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "75":
    id: "75"
    taskid: 2ed7aaed-c7ea-4e0d-80bc-59c013ee2e22
    type: condition
    task:
      id: 2ed7aaed-c7ea-4e0d-80bc-59c013ee2e22
      version: -1
      name: Verify File Artifacts
      description: |
        Verify that the ‘PaloAltoNetworksXDR.Incident.file_artifacts’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "113"
      '#default#':
      - "114"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.file_artifacts
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 1560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "79":
    id: "79"
    taskid: 140695ed-68ca-4fe4-80ca-1409da92d422
    type: condition
    task:
      id: 140695ed-68ca-4fe4-80ca-1409da92d422
      version: -1
      name: Verify Email Address
      description: Verify that the 'Account.Email.Address’ context key was extracted
        correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "144"
      Verified:
      - "198"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: Account.Email
                accessor: Address
            iscontext: true
          right:
            value:
              complex:
                root: PaloAltoNetworksXDR.Incident
                accessor: assigned_user_mail
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "81":
    id: "81"
    taskid: f7d988be-c6e2-439a-8f59-aef0dced72ba
    type: condition
    task:
      id: f7d988be-c6e2-439a-8f59-aef0dced72ba
      version: -1
      name: Verify IP Address
      description: Verify that the 'IP.Address’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "145"
      Verified:
      - "131"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: IP
                accessor: Address
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: detectedinternalips
            iscontext: true
        - operator: in
          left:
            value:
              complex:
                root: IP
                accessor: Address
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: sourceips
            iscontext: true
        - operator: in
          left:
            value:
              complex:
                root: IP
                accessor: Address
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: devicelocalip
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 990
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "84":
    id: "84"
    taskid: 6fc9698d-6f6c-4a99-8f2d-0a684a359102
    type: title
    task:
      id: 6fc9698d-6f6c-4a99-8f2d-0a684a359102
      version: -1
      name: Start Tests
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "132"
      - "151"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": -680
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "101":
    id: "101"
    taskid: 6b58a392-85e6-4b15-84c7-01d20730477b
    type: condition
    task:
      id: 6b58a392-85e6-4b15-84c7-01d20730477b
      version: -1
      name: Verify File
      description: Verify that the ‘ExtractedIndicators.File’ context key was extracted
        correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "53"
      '#default#':
      - "107"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: incident
                accessor: filesha256
            iscontext: true
          right:
            value:
              complex:
                root: ExtractedIndicators
                accessor: File
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2240,
          "y": 2180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "102":
    id: "102"
    taskid: 81c4a2ea-dacf-4cb0-822c-73fb2c220ed5
    type: condition
    task:
      id: 81c4a2ea-dacf-4cb0-822c-73fb2c220ed5
      version: -1
      name: Verify IP
      description: Verify that the ‘ExtractedIndicators.IP’ context key was extracted
        correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "53"
      '#default#':
      - "108"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: ExtractedIndicators
                accessor: IP
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: devicelocalip
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1350,
          "y": 2180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "103":
    id: "103"
    taskid: 1aa5d193-9c5d-44ac-846c-eea3fd1a12ce
    type: condition
    task:
      id: 1aa5d193-9c5d-44ac-846c-eea3fd1a12ce
      version: -1
      name: Verify URL
      description: Verify that the ‘ExtractedIndicators.URL’ context key was extracted
        correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "53"
      '#default#':
      - "109"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: ExtractedIndicators
                accessor: URL
            iscontext: true
          right:
            value: {}
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1800,
          "y": 2180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "105":
    id: "105"
    taskid: 2bbfe7cf-84e0-44fa-8a6a-ae6937e31b18
    type: regular
    task:
      id: 2bbfe7cf-84e0-44fa-8a6a-ae6937e31b18
      version: -1
      name: Verify Context Data Error - Domain
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Domain' context key not extracted properly. This may indicate
          that one or more of the following changes have been made to the 'Cortex
          XDR Malware - Incident Enrichment' playbook:\n1- The 'extractIndicators'
          automation outputs have been modified and no longer contain the 'ExtractedIndicators.Domain'
          context key. \n2- The 'text' input configuration was changed for the 'extractIndicators'
          automation used in the 'Extract Indicators' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 2435
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "107":
    id: "107"
    taskid: ec3377d6-50eb-4424-8fa6-be126bb735a4
    type: regular
    task:
      id: ec3377d6-50eb-4424-8fa6-be126bb735a4
      version: -1
      name: Verify Context Data Error - File
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'File' context key not extracted properly. This may indicate
          that one or more of the following changes have been made to the 'Cortex
          XDR Malware - Incident Enrichment' playbook:\n1- The 'extractIndicators'
          automation outputs have been modified and no longer contain the 'ExtractedIndicators.File'
          context key. \n2- The 'text' input configuration was changed for the 'extractIndicators'
          automation used in the 'Extract Indicators' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2240,
          "y": 2435
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "108":
    id: "108"
    taskid: 36ec2675-2e50-45d7-8864-439a10c719f0
    type: regular
    task:
      id: 36ec2675-2e50-45d7-8864-439a10c719f0
      version: -1
      name: Verify Context Data Error - IP
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'IP' context key not extracted properly. This may indicate that
          one or more of the following changes have been made to the 'Cortex XDR Malware
          - Incident Enrichment' playbook:\n1- The 'extractIndicators' automation
          outputs have been modified and no longer contain the 'ExtractedIndicators.IP'
          context key. \n2- The 'text' input configuration was changed for the 'extractIndicators'
          automation used in the 'Extract Indicators' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1350,
          "y": 2435
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "109":
    id: "109"
    taskid: 48ade09f-61e8-452b-8b75-346e2f7af0e9
    type: regular
    task:
      id: 48ade09f-61e8-452b-8b75-346e2f7af0e9
      version: -1
      name: Verify Context Data Error - URL
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'URL' context key not extracted properly. This may indicate that
          one or more of the following changes have been made to the 'Cortex XDR Malware
          - Incident Enrichment' playbook:\n1- The 'extractIndicators' automation
          outputs have been modified and no longer contain the 'ExtractedIndicators.URL'
          context key. \n2- The 'text' input configuration was changed for the 'extractIndicators'
          automation used in the 'Extract Indicators' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1800,
          "y": 2435
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "112":
    id: "112"
    taskid: 18d18180-91a1-43db-8d7f-e16da4cd9944
    type: title
    task:
      id: 18d18180-91a1-43db-8d7f-e16da4cd9944
      version: -1
      name: '''PaloAltoNetworksXDR'' Context Data'
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "46"
      - "73"
      - "75"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 1410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "113":
    id: "113"
    taskid: cba4b127-acb5-4f8a-8149-f0ce575c9fe1
    type: title
    task:
      id: cba4b127-acb5-4f8a-8149-f0ce575c9fe1
      version: -1
      name: Done verifying 'PaloAltoNetworksXDR'
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6120,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "114":
    id: "114"
    taskid: b983de0c-ddae-49e9-8759-858fbaa5f224
    type: regular
    task:
      id: b983de0c-ddae-49e9-8759-858fbaa5f224
      version: -1
      name: Verify Context Error - File Artifacts
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'PaloAltoNetworksXDR.Incident.file_artifacts' context key not
          extracted properly. This may indicate that one or more of the following
          changes have been made to the 'Cortex XDR Malware - Incident Enrichment'
          playbook:\n1- The 'xdr-get-incident-extra-data' automation outputs have
          been modified and no longer contain the 'PaloAltoNetworksXDR.Incident.file_artifacts'
          context key. \n2- The 'incident_id' input configuration was changed for
          the 'xdr-get-incident-extra-data' automation used in the 'Get Full Incident
          Details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 1805
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "116":
    id: "116"
    taskid: 496e168c-3653-4f9f-8409-9269afaf775a
    type: regular
    task:
      id: 496e168c-3653-4f9f-8409-9269afaf775a
      version: -1
      name: Verify Context Data Error - Alerts
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'PaloAltoNetworksXDR.Incident.alerts' context key not extracted
          properly. This may indicate that one or more of the following changes have
          been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1-
          The 'xdr-get-incident-extra-data' automation outputs have been modified
          and no longer contain the 'PaloAltoNetworksXDR.Incident.alerts' context
          key. \n2- The 'incident_id' input configuration was changed for the 'xdr-get-incident-extra-data'
          automation used in the 'Get Full Incident Details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1805
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "117":
    id: "117"
    taskid: 46d320c8-532d-4fc0-8fb1-50fb9f181278
    type: regular
    task:
      id: 46d320c8-532d-4fc0-8fb1-50fb9f181278
      version: -1
      name: Verify Context Data Error - Incident
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'PaloAltoNetworksXDR.Incident' context key not extracted properly.
          This may indicate that one or more of the following changes have been made
          to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data'
          automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.Incident'
          context key. \n2- The 'incident_id' input configuration was changed for
          the 'xdr-get-incident-extra-data' automation used in the 'Get Full Incident
          Details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1780,
          "y": 1805
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "125":
    id: "125"
    taskid: ed093164-60c4-460d-83db-d1dc047975c0
    type: regular
    task:
      id: ed093164-60c4-460d-83db-d1dc047975c0
      version: -1
      name: Verify Context Error  - Hostname
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.Hostname’ context key not extracted properly. This
          may indicate that one or more of the following changes have been made to
          the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint'
          automation outputs have been modified and no longer contain the 'Endpoint.Hostname'
          context key. \n2- The 'id' input configuration was changed for the 'endpoint'
          automation used in the 'Enrich endpoint details' task.\n3- The 'xdr-get-incident-extra-data'
          automation outputs have been modified and no longer contain the 'Endpoint.Hostname'
          context key. \n4- The 'incident_id' input configuration was changed for
          the 'xdr-get-incident-extra-data' automation used in the 'Get Full Incident
          Details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4135,
          "y": 3615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "126":
    id: "126"
    taskid: 3704f0db-b4b2-4b25-846a-e396892b104b
    type: title
    task:
      id: 3704f0db-b4b2-4b25-846a-e396892b104b
      version: -1
      name: Done verifying 'Domain' context
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6130,
          "y": 4130
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "127":
    id: "127"
    taskid: 7d942e24-879b-467c-8dea-1efea6abb640
    type: title
    task:
      id: 7d942e24-879b-467c-8dea-1efea6abb640
      version: -1
      name: Done verifying 'Endpoint'
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6130,
          "y": 3570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "128":
    id: "128"
    taskid: 4f9ada41-298c-4bbf-85b7-8c06f39ab0b4
    type: title
    task:
      id: 4f9ada41-298c-4bbf-85b7-8c06f39ab0b4
      version: -1
      name: Done verifying 'File'
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6120,
          "y": 2980
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "131":
    id: "131"
    taskid: bc494092-db75-4b5d-8ab3-524178965c72
    type: title
    task:
      id: bc494092-db75-4b5d-8ab3-524178965c72
      version: -1
      name: Done verifying 'IP' context
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6120,
          "y": 1230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "132":
    id: "132"
    taskid: a388e38b-3c2a-4c01-8e38-eb16a97af860
    type: title
    task:
      id: a388e38b-3c2a-4c01-8e38-eb16a97af860
      version: -1
      name: Check Incident Fields
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "137"
      - "152"
      - "153"
      - "154"
      - "155"
      - "156"
      - "167"
      - "166"
      - "163"
      - "162"
      - "161"
      - "255"
      - "257"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": -540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "136":
    id: "136"
    taskid: 2e54d79a-8c22-4126-811e-654e916fed44
    type: title
    task:
      id: 2e54d79a-8c22-4126-811e-654e916fed44
      version: -1
      name: Done verifying Incident Fields
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6130,
          "y": -165
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "137":
    id: "137"
    taskid: b56a70a7-93a9-4c7b-8a13-aad8d99d9d25
    type: condition
    task:
      id: b56a70a7-93a9-4c7b-8a13-aad8d99d9d25
      version: -1
      name: Verify Alerts And Related Info
      description: |-
        Verify that the ‘alertsandrelatedinfo’ incident field was filled out correctly.
        These Incident Field are affecting the incident layouts (grid_id)
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "138"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: incident.alertsandrelatedinfo.alertname
            iscontext: true
          right:
            value:
              complex:
                root: PaloAltoNetworksXDR.Incident.alerts
                accessor: name
            iscontext: true
          ignorecase: true
      - - operator: containsGeneral
          left:
            value:
              simple: incident.alertsandrelatedinfo.hostname
            iscontext: true
          right:
            value:
              complex:
                root: PaloAltoNetworksXDR.Incident.alerts
                accessor: host_name
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "138":
    id: "138"
    taskid: e4a18c2d-43ef-4cb3-84fc-794ad9a88ddb
    type: regular
    task:
      id: e4a18c2d-43ef-4cb3-84fc-794ad9a88ddb
      version: -1
      name: Verify Incident Field Error - Alerts And Related Info
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'alertsandrelatedinfo' incident field was not set correctly. This may indicate that the following change has been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:
          1- The 'grid_id' input configuration was changed for the 'SetGridField' automation used in the 'Set Alerts Table Info in the Layout' task.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "140":
    id: "140"
    taskid: 7135c361-03b7-463d-8733-73896dd9e704
    type: regular
    task:
      id: 7135c361-03b7-463d-8733-73896dd9e704
      version: -1
      name: Verify Incident Field Error - MD5
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'MD5' incident field was not set correctly. This may indicate
          that one or more of the following changes have been made to the 'Cortex
          XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data'
          automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.Incident.alerts.actor_process_image_md5'
          context key. \n2- The 'MD5' input configuration was changed for the 'setIncident'
          automation used in the 'Set Process Details To Layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "144":
    id: "144"
    taskid: 92c7de6f-3f3f-4437-8b19-5e7fd3e8cc3c
    type: regular
    task:
      id: 92c7de6f-3f3f-4437-8b19-5e7fd3e8cc3c
      version: -1
      name: Verify Context Error - Email Address
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Account.Email.Address’ context key not extracted properly. This
          may indicate that one or more of the following changes have been made to
          the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'Account
          Enrichment - Generic v2.1' sub-playbook outputs have been modified and no
          longer contain the 'Account.Email.Address' context key. \n2- The 'Username'
          input configuration was changed for the 'Account Enrichment - Generic v2.1'
          sub-playbook inputs."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 640
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "145":
    id: "145"
    taskid: a1f91cbd-3d10-4a1c-8151-dfde87f17141
    type: regular
    task:
      id: a1f91cbd-3d10-4a1c-8151-dfde87f17141
      version: -1
      name: Verify Context Error  - IP Address
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'IP.Address’ context key not extracted properly. This may indicate
          that one or more of the following changes have been made to the 'Cortex
          XDR Malware - Incident Enrichment' playbook:\n1- The 'extractIndicators'
          automation outputs have been modified and no longer contain the 'IP' context
          key. \n2- The 'text' input configuration was changed for the 'extractIndicators'
          automation used in the 'Extract Indicators' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 920,
          "y": 1200
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "149":
    id: "149"
    taskid: 28d379ef-9539-4375-84d1-bfd9f84f223f
    type: regular
    task:
      id: 28d379ef-9539-4375-84d1-bfd9f84f223f
      version: -1
      name: Set Incident Fields To Context
      description: Add incident fields required for testing to the mock incident.
      script: Builtin|||setIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "150"
    scriptarguments:
      agentsid:
        simple: aeec6a2cc92e46fab3b6f621722e9916
      alertsandrelatedinfo:
        simple: '[{"columnheader3":""},{},{}]'
      externalsystemid:
        complex:
          root: PaloAltoNetworksXDR.Incident
          accessor: incident_id
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": -1005
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    fieldMapping:
    - incidentfield: Agents ID
      output:
        simple: aeec6a2cc92e46fab3b6f621722e9916
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "150":
    id: "150"
    taskid: 09ffabc6-c475-4b15-bcc4-a326f9922d67
    type: playbook
    task:
      id: 09ffabc6-c475-4b15-bcc4-a326f9922d67
      version: -1
      name: Cortex XDR Malware - Incident Enrichment
      description: |-
        This playbook is part of the 'Malware Investigation And Response' pack. For more information, refer to https://xsoar.pan.dev/docs/reference/packs/malware-investigation-and-response.
        This playbook enriches the Cortex XDR incident. The enrichment is done on the involved endpoint and Mitre technique ID information, and sets the 'Malware-Investigation and Response' layout.
      playbookName: Cortex XDR Malware - Incident Enrichment
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "84"
    scriptarguments:
      IncidentID:
        complex:
          root: incident
          accessor: externalsystemid
    separatecontext: false
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 590,
          "y": -850
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "151":
    id: "151"
    taskid: 235c9738-6b68-4996-89dd-79e5e380fe66
    type: title
    task:
      id: 235c9738-6b68-4996-89dd-79e5e380fe66
      version: -1
      name: Check Context Data
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "63"
      - "67"
      - "112"
      - "39"
      - "64"
      - "69"
      - "278"
      - "65"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": 125
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "152":
    id: "152"
    taskid: 1b4ae2d6-110f-4468-8338-ddaf1fd7d29e
    type: condition
    task:
      id: 1b4ae2d6-110f-4468-8338-ddaf1fd7d29e
      version: -1
      name: Verify MD5
      description: |
        Verify that the ‘MD5’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "140"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: incident.md5
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "153":
    id: "153"
    taskid: d107a255-0294-42a6-82b3-03a978311ed6
    type: condition
    task:
      id: d107a255-0294-42a6-82b3-03a978311ed6
      version: -1
      name: Verify Parent Process File Path
      description: |
        Verify that the ‘parentprocessfilepath’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "157"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: incident.parentprocessfilepath
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1740,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "154":
    id: "154"
    taskid: ef731809-979d-4e54-88a6-55ddc6886fb2
    type: condition
    task:
      id: ef731809-979d-4e54-88a6-55ddc6886fb2
      version: -1
      name: Verify Process Name
      description: |
        Verify that the ‘processname’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "158"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: incident.processname
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2140,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "155":
    id: "155"
    taskid: 0c63455c-5fd7-483f-8cc4-b4b4b78d2e80
    type: condition
    task:
      id: 0c63455c-5fd7-483f-8cc4-b4b4b78d2e80
      version: -1
      name: Verify Process Path
      description: |
        Verify that the ‘processpath’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "159"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: incident.processpath
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2540,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "156":
    id: "156"
    taskid: 48601737-1349-4add-85b4-6f142c136037
    type: condition
    task:
      id: 48601737-1349-4add-85b4-6f142c136037
      version: -1
      name: Verify SHA256
      description: |
        Verify that the ‘SHA256’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "160"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: incident.sha256
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2940,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "157":
    id: "157"
    taskid: b44620e6-a8dc-4b70-8359-92589370a38b
    type: regular
    task:
      id: b44620e6-a8dc-4b70-8359-92589370a38b
      version: -1
      name: Verify Incident Field Error - Parent Process File Path
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'parentprocessfilepath' incident field was not set correctly.
          This may indicate that one or more of the following changes have been made
          to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data'
          automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.Incident.alerts.causality_actor_process_image_path'
          context key. \n2- The 'parentprocessfilepath' input configuration was changed
          for the 'setIncident' automation used in the 'Set Process Details To Layout'
          task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1740,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "158":
    id: "158"
    taskid: d3c5b859-9781-4fc8-86e8-74ca8e847833
    type: regular
    task:
      id: d3c5b859-9781-4fc8-86e8-74ca8e847833
      version: -1
      name: Verify Incident Field Error - Process Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'processname' incident field was not set correctly. This may
          indicate that one or more of the following changes have been made to the
          'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data'
          automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.Incident.alerts.actor_process_image_name'
          context key. \n2- The 'processname' input configuration was changed for
          the 'setIncident' automation used in the 'Set Process Details To Layout'
          task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2140,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "159":
    id: "159"
    taskid: 23e2a9db-635d-423f-8019-2e18208993d2
    type: regular
    task:
      id: 23e2a9db-635d-423f-8019-2e18208993d2
      version: -1
      name: Verify Incident Field Error - Process Path
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'processpath' incident field was not set correctly. This may
          indicate that one or more of the following changes have been made to the
          'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data'
          automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.Incident.alerts.actor_process_image_path'
          context key. \n2- The 'processpath' input configuration was changed for
          the 'setIncident' automation used in the 'Set Process Details To Layout'
          task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2540,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "160":
    id: "160"
    taskid: ef25ebc6-ae90-4ea7-8636-c59c49139509
    type: regular
    task:
      id: ef25ebc6-ae90-4ea7-8636-c59c49139509
      version: -1
      name: Verify Incident Field Error - SHA256
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'sha256' incident field was not set correctly. This may indicate
          that one or more of the following changes have been made to the 'Cortex
          XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data'
          automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.Incident.alerts.actor_process_image_sha256'
          context key. \n2- The 'sha256' input configuration was changed for the 'setIncident'
          automation used in the 'Set Process Details To Layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2940,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "161":
    id: "161"
    taskid: 8b171c30-8b8c-4ad6-8eec-63f2d0df8de9
    type: condition
    task:
      id: 8b171c30-8b8c-4ad6-8eec-63f2d0df8de9
      version: -1
      name: Verify Account Member Of
      description: |
        Verify that the ‘accountmemberof’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "168"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: incident
                accessor: accountmemberof
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3350,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "162":
    id: "162"
    taskid: 03572343-aca9-40f5-89ce-0e55f9d0348c
    type: condition
    task:
      id: 03572343-aca9-40f5-89ce-0e55f9d0348c
      version: -1
      name: Verify Account Name
      description: |
        Verify that the ‘accountname’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "169"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: incident
                accessor: accountname
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3755,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "163":
    id: "163"
    taskid: ca11c7e8-f76a-4119-8cdb-af06b66af790
    type: condition
    task:
      id: ca11c7e8-f76a-4119-8cdb-af06b66af790
      version: -1
      name: Verify Account Status
      description: |
        Verify that the ‘accountstatus’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "170"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: incident
                accessor: accountstatus
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4150,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "166":
    id: "166"
    taskid: b3f23e26-9935-436d-825c-d5045b8c4e57
    type: condition
    task:
      id: b3f23e26-9935-436d-825c-d5045b8c4e57
      version: -1
      name: Verify Manager Name
      description: |
        Verify that the ‘managername’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "173"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: incident
                accessor: managername
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4550,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "167":
    id: "167"
    taskid: 8b8c75e5-8d77-4aa4-81cb-de09a246dc3c
    type: condition
    task:
      id: 8b8c75e5-8d77-4aa4-81cb-de09a246dc3c
      version: -1
      name: Verify SAM Account Name
      description: |
        Verify that the ‘samaccountname’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "174"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: incident
                accessor: samaccountname
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4950,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "168":
    id: "168"
    taskid: 13363a5b-00ce-4ab5-8c87-2fd07b4b478a
    type: regular
    task:
      id: 13363a5b-00ce-4ab5-8c87-2fd07b4b478a
      version: -1
      name: Verify Incident Field Error - Account Member Of
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'accountmemberof' incident field was not set correctly. This
          may indicate that one or more of the following changes have been made to
          the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'Account
          Enrichment - Generic v2.1' sub-playbook outputs have been modified and no
          longer contain the 'Account.Groups' context key. \n2- The 'accountmemberof'
          input configuration was changed for the 'setIncident' automation used in
          the 'Set Account information to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3350,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "169":
    id: "169"
    taskid: 2bfb43f8-6dc6-4583-8a6e-fed22375948e
    type: regular
    task:
      id: 2bfb43f8-6dc6-4583-8a6e-fed22375948e
      version: -1
      name: Verify Incident Field Error - Account Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'accountname' incident field was not set correctly. This may
          indicate that one or more of the following changes have been made to the
          'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'Account Enrichment
          - Generic v2.1' sub-playbook outputs have been modified and no longer contain
          the 'Account.DisplayName' context key. \n2- The 'accountname' input configuration
          was changed for the 'setIncident' automation used in the 'Set Account information
          to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3750,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "170":
    id: "170"
    taskid: bdfa6d21-feb6-428f-8143-3f31a5432d32
    type: regular
    task:
      id: bdfa6d21-feb6-428f-8143-3f31a5432d32
      version: -1
      name: Verify Incident Field Error - Account Status
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'accountstatus' incident field was not set correctly. This may
          indicate that one or more of the following changes have been made to the
          'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'Account Enrichment
          - Generic v2.1' sub-playbook outputs have been modified and no longer contain
          the 'Account.Status' context key. \n2- The 'accountstatus' input configuration
          was changed for the 'setIncident' automation used in the 'Set Account information
          to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4150,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "173":
    id: "173"
    taskid: 91f84d63-50a9-4e67-81f8-916a4f493cc8
    type: regular
    task:
      id: 91f84d63-50a9-4e67-81f8-916a4f493cc8
      version: -1
      name: Verify Incident Field Error - Manager Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'managername' incident field was not set correctly. This may
          indicate that one or more of the following changes have been made to the
          'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'Account Enrichment
          - Generic v2.1' sub-playbook outputs have been modified and no longer contain
          the 'Account.Manager' context key. \n2- The 'managername' input configuration
          was changed for the 'setIncident' automation used in the 'Set Account information
          to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4560,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "174":
    id: "174"
    taskid: 92d45d64-bf6f-425d-8af0-27f03765b3c3
    type: regular
    task:
      id: 92d45d64-bf6f-425d-8af0-27f03765b3c3
      version: -1
      name: Verify Incident Field Error - SAM Account Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'samaccountname' incident field was not set correctly. This may
          indicate that one or more of the following changes have been made to the
          'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'Account Enrichment
          - Generic v2.1' sub-playbook outputs have been modified and no longer contain
          the 'Account.Username' context key. \n2- The 'samaccountname' input configuration
          was changed for the 'setIncident' automation used in the 'Set Account information
          to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4950,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "198":
    id: "198"
    taskid: 50b99f6e-122b-4d2f-8da4-98889e237cb9
    type: title
    task:
      id: 50b99f6e-122b-4d2f-8da4-98889e237cb9
      version: -1
      name: Done verifying 'Account'
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6120,
          "y": 630
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "199":
    id: "199"
    taskid: fb1cb2f0-aa2c-4d1e-8020-f3ba5a1a563e
    type: condition
    task:
      id: fb1cb2f0-aa2c-4d1e-8020-f3ba5a1a563e
      version: -1
      name: Verify Hostname
      description: Verify that the 'Endpoint.Hostname’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "125"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: Endpoint
                accessor: Hostname
            iscontext: true
          right:
            value:
              complex:
                root: PaloAltoNetworksXDR.Incident.alerts
                accessor: host_name
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4135,
          "y": 3370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "200":
    id: "200"
    taskid: fae38a53-7201-49f8-8c31-34ca9c560f93
    type: condition
    task:
      id: fae38a53-7201-49f8-8c31-34ca9c560f93
      version: -1
      name: Verify Is Isolated
      description: Verify that the 'Endpoint.IsIsolated’ context key was extracted
        correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "201"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: Endpoint
                accessor: IsIsolated
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: isolated
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3735,
          "y": 3370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "201":
    id: "201"
    taskid: 00270021-d896-49bb-86aa-1e15db086d9c
    type: regular
    task:
      id: 00270021-d896-49bb-86aa-1e15db086d9c
      version: -1
      name: Verify Context Error  -  Is Isolated
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.IsIsolated’ context key not extracted properly. This
          may indicate that one or more of the following changes have been made to
          the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint'
          automation outputs have been modified and no longer contain the 'Endpoint.IsIsolated'
          context key. \n2- The 'id' input configuration was changed for the 'endpoint'
          automation used in the 'Enrich endpoint details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3735,
          "y": 3615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "202":
    id: "202"
    taskid: 0e065392-7ec8-4535-8655-b10da3a36749
    type: condition
    task:
      id: 0e065392-7ec8-4535-8655-b10da3a36749
      version: -1
      name: Verify Domain
      description: Verify that the 'Endpoint.Domain’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "209"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: Endpoint
                accessor: Domain
            iscontext: true
          right:
            value: {}
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3335,
          "y": 3370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "203":
    id: "203"
    taskid: c3c242bb-e61a-4a69-8662-0d50df4e4d10
    type: condition
    task:
      id: c3c242bb-e61a-4a69-8662-0d50df4e4d10
      version: -1
      name: Verify OS
      description: Verify that the 'Endpoint.OS’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "210"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: Endpoint
                accessor: OS
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: deviceosname
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2935,
          "y": 3370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "204":
    id: "204"
    taskid: 456baae1-2dd4-4ad5-8faa-b084c908ee71
    type: condition
    task:
      id: 456baae1-2dd4-4ad5-8faa-b084c908ee71
      version: -1
      name: Verify MAC Address
      description: Verify that the 'Endpoint.MACAddress’ context key was extracted
        correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "211"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: Endpoint
                accessor: MACAddress
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: devicemacaddress
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2545,
          "y": 3370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "205":
    id: "205"
    taskid: e2a52a4f-d789-4d39-8481-0752521c077e
    type: condition
    task:
      id: e2a52a4f-d789-4d39-8481-0752521c077e
      version: -1
      name: Verify Vendor
      description: Verify that the 'Endpoint.Vendor’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "212"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: Endpoint
                accessor: Vendor
            iscontext: true
          right:
            value: {}
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2135,
          "y": 3370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "206":
    id: "206"
    taskid: d4a3ecf3-4705-41b8-8afd-eeb6f9c970c0
    type: condition
    task:
      id: d4a3ecf3-4705-41b8-8afd-eeb6f9c970c0
      version: -1
      name: Verify IP Address
      description: Verify that the 'Endpoint.IPAddress’ context key was extracted
        correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "213"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: Endpoint
                accessor: IPAddress
            iscontext: true
          right:
            value:
              complex:
                root: PaloAltoNetworksXDR.Incident.alerts
                accessor: host_ip
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1735,
          "y": 3370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "207":
    id: "207"
    taskid: b93e4ec6-afa0-40fb-8d86-2a0872f4606c
    type: condition
    task:
      id: b93e4ec6-afa0-40fb-8d86-2a0872f4606c
      version: -1
      name: Verify Status
      description: Verify that the 'Endpoint.Status’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "214"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: Endpoint
                accessor: Status
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: devicestatus
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1335,
          "y": 3370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "208":
    id: "208"
    taskid: 9bd0eaa4-534d-4eca-8bc8-38bfc4e5ad86
    type: condition
    task:
      id: 9bd0eaa4-534d-4eca-8bc8-38bfc4e5ad86
      version: -1
      name: Verify ID
      description: Verify that the 'Endpoint.ID’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "215"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: Endpoint
                accessor: ID
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: deviceid
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 3370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "209":
    id: "209"
    taskid: f197a159-83b4-44dc-89c5-3733d5f842eb
    type: regular
    task:
      id: f197a159-83b4-44dc-89c5-3733d5f842eb
      version: -1
      name: Verify Context Error  -  Domain
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.Domain’ context key not extracted properly. This may
          indicate that one or more of the following changes have been made to the
          'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint'
          automation outputs have been modified and no longer contain the 'Endpoint.Domain'
          context key. \n2- The 'id' input configuration was changed for the 'endpoint'
          automation used in the 'Enrich endpoint details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3335,
          "y": 3615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "210":
    id: "210"
    taskid: eda0f190-83a8-4273-8462-c4db6ddc1392
    type: regular
    task:
      id: eda0f190-83a8-4273-8462-c4db6ddc1392
      version: -1
      name: Verify Context Error  -  OS
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.OS’ context key not extracted properly. This may indicate
          that one or more of the following changes have been made to the 'Cortex
          XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation
          outputs have been modified and no longer contain the 'Endpoint.OS' context
          key. \n2- The 'id' input configuration was changed for the 'endpoint' automation
          used in the 'Enrich endpoint details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2925,
          "y": 3615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "211":
    id: "211"
    taskid: 7d6bd665-649a-434b-8751-213d37816c32
    type: regular
    task:
      id: 7d6bd665-649a-434b-8751-213d37816c32
      version: -1
      name: Verify Context Error  - MAC Address
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.MACAddress’ context key not extracted properly. This
          may indicate that one or more of the following changes have been made to
          the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint'
          automation outputs have been modified and no longer contain the 'Endpoint.MACAddress'
          context key. \n2- The 'id' input configuration was changed for the 'endpoint'
          automation used in the 'Enrich endpoint details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2525,
          "y": 3615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "212":
    id: "212"
    taskid: 1fd320f0-c324-46aa-8be1-71639e1441f2
    type: regular
    task:
      id: 1fd320f0-c324-46aa-8be1-71639e1441f2
      version: -1
      name: Verify Context Error  - Vendor
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.Vendor’ context key not extracted properly. This may
          indicate that one or more of the following changes have been made to the
          'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint'
          automation outputs have been modified and no longer contain the 'Endpoint.Vendor'
          context key. \n2- The 'id' input configuration was changed for the 'endpoint'
          automation used in the 'Enrich endpoint details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2125,
          "y": 3615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "213":
    id: "213"
    taskid: cced1f4b-0c86-4012-8772-d940a8de6e2b
    type: regular
    task:
      id: cced1f4b-0c86-4012-8772-d940a8de6e2b
      version: -1
      name: Verify Context Error  - IP Address
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.IPAddress’ context key not extracted properly. This
          may indicate that one or more of the following changes have been made to
          the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint'
          automation outputs have been modified and no longer contain the 'Endpoint.IPAddress'
          context key. \n2- The 'id' input configuration was changed for the 'endpoint'
          automation used in the 'Enrich endpoint details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1725,
          "y": 3610
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "214":
    id: "214"
    taskid: ba5a91f2-c58e-4b5f-87d4-e1caf1464537
    type: regular
    task:
      id: ba5a91f2-c58e-4b5f-87d4-e1caf1464537
      version: -1
      name: Verify Context Error  - Status
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.Status’ context key not extracted properly. This may
          indicate that one or more of the following changes have been made to the
          'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint'
          automation outputs have been modified and no longer contain the 'Endpoint.Status'
          context key. \n2- The 'id' input configuration was changed for the 'endpoint'
          automation used in the 'Enrich endpoint details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1335,
          "y": 3615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "215":
    id: "215"
    taskid: 12e7a145-5c7c-4c98-82ce-267496d84b88
    type: regular
    task:
      id: 12e7a145-5c7c-4c98-82ce-267496d84b88
      version: -1
      name: Verify Context Error  - ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.ID’ context key not extracted properly. This may indicate
          that one or more of the following changes have been made to the 'Cortex
          XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation
          outputs have been modified and no longer contain the 'Endpoint.ID' context
          key. \n2- The 'id' input configuration was changed for the 'endpoint' automation
          used in the 'Enrich endpoint details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 3615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "218":
    id: "218"
    taskid: 62b724ab-0b17-46c4-8c10-8a645a197b3a
    type: condition
    task:
      id: 62b724ab-0b17-46c4-8c10-8a645a197b3a
      version: -1
      name: Verify SHA265
      description: Verify that the 'File.SHA256’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "219"
      Verified:
      - "128"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: File
                accessor: SHA256
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: filesha256
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1335,
          "y": 2795
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "219":
    id: "219"
    taskid: f492dbc0-7f2d-49db-89e2-e2b228ce2d8f
    type: regular
    task:
      id: f492dbc0-7f2d-49db-89e2-e2b228ce2d8f
      version: -1
      name: Verify Context Error - SHA265
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'File.SHA256’ context key not extracted properly. This may indicate
          that one or more of the following changes have been made to the 'Cortex
          XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data'
          automation outputs have been modified and no longer contain the 'File.SHA256'
          context key. \n2- The 'incident_id' input configuration was changed for
          the 'xdr-get-incident-extra-data' automation used in the 'Get Full Incident
          Details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1335,
          "y": 3015
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "220":
    id: "220"
    taskid: 521781e3-002b-4d5d-858f-e5a5108b92d8
    type: condition
    task:
      id: 521781e3-002b-4d5d-858f-e5a5108b92d8
      version: -1
      name: Verify Name
      description: Verify that the 'File.Name’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "221"
      Verified:
      - "128"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: File
                accessor: Name
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: filenames
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 2795
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "221":
    id: "221"
    taskid: e27f5d56-411a-4c84-8393-3ebfbe3d6ebc
    type: regular
    task:
      id: e27f5d56-411a-4c84-8393-3ebfbe3d6ebc
      version: -1
      name: Verify Context Error - Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'File.Name’ context key not extracted properly. This may indicate
          that one or more of the following changes have been made to the 'Cortex
          XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data'
          automation outputs have been modified and no longer contain the 'File.Name'
          context key. \n2- The 'incident_id' input configuration was changed for
          the 'xdr-get-incident-extra-data' automation used in the 'Get Full Incident
          Details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 3015
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "255":
    id: "255"
    taskid: 66817bd0-9b69-45a9-8992-72eca460d859
    type: condition
    task:
      id: 66817bd0-9b69-45a9-8992-72eca460d859
      version: -1
      name: Verify Hostnames
      description: |
        Verify that the ‘hostnames’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "256"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: hostnames
            iscontext: true
          right:
            value:
              complex:
                root: PaloAltoNetworksXDR.Incident.alerts
                accessor: host_name
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5360,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "256":
    id: "256"
    taskid: 8dede955-964f-4823-8928-9c0e2a1b3cd5
    type: regular
    task:
      id: 8dede955-964f-4823-8928-9c0e2a1b3cd5
      version: -1
      name: Verify Incident Field Error - Hostnames
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Hostnames' incident field was not set correctly. This may indicate
          that one or more of the following changes have been made to the 'Cortex
          XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data'
          automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.Incident.alerts.host_name'
          context key. \n2- The 'incident_id' input configuration was changed for
          the 'xdr-get-incident-extra-data' automation used in the 'Get Full Incident
          Details' task.\n3- The custom output mapping rule for the 'Hostnames' incident
          field configured within the 'Get Full Incident Details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5360,
          "y": -90
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "257":
    id: "257"
    taskid: bd7afc60-22b2-4ae0-805e-0ca3305903da
    type: condition
    task:
      id: bd7afc60-22b2-4ae0-805e-0ca3305903da
      version: -1
      name: Verify Detected Users
      description: |
        Verify that the ‘detectedusers’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "258"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: incident
                accessor: detectedusers
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5760,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "258":
    id: "258"
    taskid: 0e01e8b5-dcd8-4b50-8c8d-00b1ff9621fb
    type: regular
    task:
      id: 0e01e8b5-dcd8-4b50-8c8d-00b1ff9621fb
      version: -1
      name: Verify Incident Field Error - Detected Users
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'detectedusers' incident field was not set correctly. This may
          indicate that one or more of the following changes have been made to the
          'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data'
          automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.Incident.alerts.user_name'
          context key. \n2- The 'incident_id' input configuration was changed for
          the 'xdr-get-incident-extra-data' automation used in the 'Get Full Incident
          Details' task.\n3- The custom output mapping rule for the 'detectedusers'
          incident field configured within the 'Get Full Incident Details' task was
          changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5760,
          "y": -85
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "265":
    id: "265"
    taskid: 274cede4-952e-42b0-8a01-bd41c50f1a28
    type: condition
    task:
      id: 274cede4-952e-42b0-8a01-bd41c50f1a28
      version: -1
      name: Verify Context - Name
      description: Verify that the 'Domain.Name’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "266"
      Verified:
      - "126"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Domain
                accessor: Name
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 3920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "266":
    id: "266"
    taskid: 913c1f00-68c4-49b0-8a44-0b7acdffab62
    type: regular
    task:
      id: 913c1f00-68c4-49b0-8a44-0b7acdffab62
      version: -1
      name: Verify Context Error  - Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Domain.Name’ context key not extracted properly. This may indicate
          that one or more of the following changes have been made to the 'Cortex
          XDR Malware - Incident Enrichment' playbook:\n1- The 'extractIndicators'
          automation outputs have been modified and no longer contain the 'Domain'
          context key. \n2- The 'text' input configuration was changed for the 'extractIndicators'
          automation used in the 'Extract Indicators' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 4150
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "277":
    id: "277"
    taskid: eddfd539-0fbe-45d4-89fa-46c81d3c6980
    type: title
    task:
      id: eddfd539-0fbe-45d4-89fa-46c81d3c6980
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6400,
          "y": 4830
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "278":
    id: "278"
    taskid: c7d85d7d-5cb4-42af-87c6-c2338ff9e6d3
    type: title
    task:
      id: c7d85d7d-5cb4-42af-87c6-c2338ff9e6d3
      version: -1
      name: '''URL'' Context Data'
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "290"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 4360
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "281":
    id: "281"
    taskid: 4e24bf46-052f-49c4-87a3-3a4111759679
    type: title
    task:
      id: 4e24bf46-052f-49c4-87a3-3a4111759679
      version: -1
      name: Done verifying 'URL'
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6130,
          "y": 4685
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "290":
    id: "290"
    taskid: 1fdae198-bba1-46d2-9aa5-8402e361cfa2
    type: condition
    task:
      id: 1fdae198-bba1-46d2-9aa5-8402e361cfa2
      version: -1
      name: Verify Data
      description: Verify that the 'URL.Data’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "291"
      Verified:
      - "281"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: URL
                accessor: Data
            iscontext: true
          right:
            value:
              complex:
                root: ExtractedIndicators
                accessor: URL
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 4495
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "291":
    id: "291"
    taskid: b4100454-6a0a-48ef-85fd-fc5d503375d6
    type: regular
    task:
      id: b4100454-6a0a-48ef-85fd-fc5d503375d6
      version: -1
      name: Verify Context Error - Data
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'URL.Data’ context key not extracted properly. This may indicate
          that one or more of the following changes have been made to the 'Cortex
          XDR Malware - Incident Enrichment' playbook:\n1- The 'extractIndicators'
          automation outputs have been modified and no longer contain the 'URL' context
          key. \n2- The 'text' input configuration was changed for the 'extractIndicators'
          automation used in the 'Extract Indicators' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 4715
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "292":
    id: "292"
    taskid: 435ffd06-bf86-47c3-9e6a-569f202d99a7
    type: regular
    task:
      id: 435ffd06-bf86-47c3-9e6a-569f202d99a7
      version: -1
      name: Get incidents
      description: |-
        Returns a list of incidents, which you can filter by a list of incident IDs (max. 100), the time the incident was last modified, and the time the incident was created.
        If you pass multiple filtering arguments, they will be concatenated using the AND condition. The OR condition is not supported.
      script: '|||xdr-get-incidents'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "149"
    scriptarguments:
      gte_creation_time:
        simple: 2025-11-30T07:16:00
      sort_by_creation_time:
        simple: asc
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": -1220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "101_53_ Verified": 0.1,
      "102_53_ Verified": 0.11,
      "103_53_ Verified": 0.1,
      "137_136_Verified": 0.1,
      "152_136_Verified": 0.1,
      "40_53_Verified": 0.1,
      "46_113_Verified": 0.1,
      "73_116_#default#": 0.7,
      "75_113_ Verified": 0.1
    },
    "paper": {
      "dimensions": {
        "height": 6485,
        "width": 6190,
        "x": 590,
        "y": -1595
      }
    }
  }
inputs: []
outputs: []
fromversion: 6.5.0
