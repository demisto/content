id: Test_Playbook-Cortex_XDR_Malware_-_Incident Enrichment
version: -1
name: Test_Playbook-Cortex_XDR_Malware_-_Incident Enrichment
description: "This playbook tests the ‘Cortex XDR Malware - Incident Enrichment’ playbook which is part of the ‘Malware Investigation and Response’ pack.\n\nFollowing are the tests conducted in the playbook:\n1- Confirm that incident fields were populated correctly by the custom output mapping rules and the 'setIncident' automation. \n2- Validate the enrichment of XDR incidents.\n3- Validate the enrichment of alerts and incident entities.\n3- Ensure that the context data was properly extracted.\n4. Check that the XDR alert information was correctly populated into the 'Alert' grid table of the Malware-Investigation and Response layout.\n5- Validate the outputs of the playbook."
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: ce53f9de-f436-41e7-8503-462a2f1d335b
    type: start
    task:
      id: ce53f9de-f436-41e7-8503-462a2f1d335b
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "32"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": -1305
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: 41d60b6d-e2e8-46db-8c86-5dd132deea9d
    type: regular
    task:
      id: 41d60b6d-e2e8-46db-8c86-5dd132deea9d
      version: -1
      name: Delete Context
      description: The task deletes all of the context data. Having a clean beginning to a test playbook ensures that a test can be sterile and that unrelated issues can be eliminated.
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "149"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": -1175
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: 2cf93b06-d0ce-4420-84a2-1a03397d6c3f
    type: title
    task:
      id: 2cf93b06-d0ce-4420-84a2-1a03397d6c3f
      version: -1
      name: '''ExtractedIndicators'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "102"
      - "100"
      - "40"
      - "103"
      - "101"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 2035
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: 0c1c076f-d4f5-485b-8a13-e6eff38ea4d7
    type: condition
    task:
      id: 0c1c076f-d4f5-485b-8a13-e6eff38ea4d7
      version: -1
      name: Verify Domain
      description: Verify that the ‘ExtractedIndicators.Domain’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "105"
      Verified:
      - "53"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: ExtractedIndicators
                accessor: Domain
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 2180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: 5ab255da-6c10-4a9d-8171-2559b6a816d5
    type: condition
    task:
      id: 5ab255da-6c10-4a9d-8171-2559b6a816d5
      version: -1
      name: Verify  Incident
      description: |
        Verify that the ‘PaloAltoNetworksXDR.Incident’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "117"
      Verified:
      - "113"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR
                accessor: Incident
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2255,
          "y": 1560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: 51fe6e6d-8a39-4fab-843a-bb261595a1b4
    type: title
    task:
      id: 51fe6e6d-8a39-4fab-843a-bb261595a1b4
      version: -1
      name: Done verifying 'ExtractedIndicators'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6120,
          "y": 2370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: 2bc0cf95-7583-4dc1-8b32-a441b586be48
    type: title
    task:
      id: 2bc0cf95-7583-4dc1-8b32-a441b586be48
      version: -1
      name: '''Account'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "79"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "64":
    id: "64"
    taskid: 33fc1a06-3fe3-4792-88fe-e8f8055a0c21
    type: title
    task:
      id: 33fc1a06-3fe3-4792-88fe-e8f8055a0c21
      version: -1
      name: '''File'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "78"
      - "218"
      - "220"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 2650
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "65":
    id: "65"
    taskid: e316fa9b-05b4-4ac3-8288-0337a4d40cb8
    type: title
    task:
      id: e316fa9b-05b4-4ac3-8288-0337a4d40cb8
      version: -1
      name: '''Endpoint'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "199"
      - "200"
      - "202"
      - "203"
      - "204"
      - "205"
      - "206"
      - "207"
      - "208"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 3225
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "67":
    id: "67"
    taskid: 8504176f-fe3d-43b8-8b52-83607070b028
    type: title
    task:
      id: 8504176f-fe3d-43b8-8b52-83607070b028
      version: -1
      name: '''IP'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "81"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 860
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "69":
    id: "69"
    taskid: 9d986bde-c7e1-42d7-809f-65ca58266e0e
    type: title
    task:
      id: 9d986bde-c7e1-42d7-809f-65ca58266e0e
      version: -1
      name: '''Domain'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "265"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 3790
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "73":
    id: "73"
    taskid: cf407188-3109-45d4-86f1-d33c53353c13
    type: condition
    task:
      id: cf407188-3109-45d4-86f1-d33c53353c13
      version: -1
      name: Verify Alerts
      description: Verify that the ‘PaloAltoNetworksXDR.Incident.Alerts’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "116"
      Verified:
      - "113"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.Incident.alerts
                accessor: '[0]'
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1820,
          "y": 1560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "74":
    id: "74"
    taskid: 5d65323e-8979-45a8-8af7-6e2f2b594017
    type: condition
    task:
      id: 5d65323e-8979-45a8-8af7-6e2f2b594017
      version: -1
      name: Verify Network Artifacts
      description: |
        Verify that the ‘PaloAltoNetworksXDR.Incident.network_artifacts’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "113"
      '#default#':
      - "115"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isExists
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.network_artifacts
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1370,
          "y": 1560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "75":
    id: "75"
    taskid: 64af3f3f-a31b-48e8-89df-65c94480b7f8
    type: condition
    task:
      id: 64af3f3f-a31b-48e8-89df-65c94480b7f8
      version: -1
      name: Verify File Artifacts
      description: |
        Verify that the ‘PaloAltoNetworksXDR.Incident.file_artifacts’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "113"
      '#default#':
      - "114"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isExists
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.file_artifacts
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 1560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "78":
    id: "78"
    taskid: 499b1aad-f5f6-40c3-8138-c94104aeb84c
    type: condition
    task:
      id: 499b1aad-f5f6-40c3-8138-c94104aeb84c
      version: -1
      name: Verify Path
      description: Verify that the 'File.Path’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "142"
      Verified:
      - "128"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: Path
            iscontext: true
          right:
            value: {}
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1740,
          "y": 2795
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "79":
    id: "79"
    taskid: 1b8780f5-c88b-4c1b-822d-842f527586e5
    type: condition
    task:
      id: 1b8780f5-c88b-4c1b-822d-842f527586e5
      version: -1
      name: Verify Email Address
      description: Verify that the 'Account.Email.Address’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "144"
      Verified:
      - "198"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: Account.Email
                accessor: Address
            iscontext: true
          right:
            value:
              complex:
                root: PaloAltoNetworksXDR.Incident
                accessor: assigned_user_mail
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "81":
    id: "81"
    taskid: 2ffd56b0-26e8-4d21-857c-f59870b6a52c
    type: condition
    task:
      id: 2ffd56b0-26e8-4d21-857c-f59870b6a52c
      version: -1
      name: Verify IP Address
      description: Verify that the 'IP.Address’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "145"
      Verified:
      - "131"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: IP
                accessor: Address
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: detectedinternalips
            iscontext: true
        - operator: in
          left:
            value:
              complex:
                root: IP
                accessor: Address
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: sourceips
            iscontext: true
        - operator: in
          left:
            value:
              complex:
                root: IP
                accessor: Address
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: devicelocalip
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 990
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "84":
    id: "84"
    taskid: 2e4e3fde-110c-4ce4-8f40-00180e9ff00e
    type: title
    task:
      id: 2e4e3fde-110c-4ce4-8f40-00180e9ff00e
      version: -1
      name: Start Tests
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "132"
      - "151"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": -680
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "100":
    id: "100"
    taskid: b9e7e466-f574-48ee-8d3d-4a49c619d342
    type: condition
    task:
      id: b9e7e466-f574-48ee-8d3d-4a49c619d342
      version: -1
      name: Verify Email
      description: Verify that the ‘ExtractedIndicators.Email’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "53"
      '#default#':
      - "106"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: ExtractedIndicators
                accessor: Email
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 2180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "101":
    id: "101"
    taskid: c24411ce-fc68-460e-8e82-b6efd66d1567
    type: condition
    task:
      id: c24411ce-fc68-460e-8e82-b6efd66d1567
      version: -1
      name: Verify File
      description: Verify that the ‘ExtractedIndicators.File’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "53"
      '#default#':
      - "107"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: containsString
          left:
            value:
              complex:
                root: ExtractedIndicators
                accessor: File
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: filesha256
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2640,
          "y": 2180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "102":
    id: "102"
    taskid: a251aba9-1639-4fc8-8cb7-ca6b2c1587f5
    type: condition
    task:
      id: a251aba9-1639-4fc8-8cb7-ca6b2c1587f5
      version: -1
      name: Verify IP
      description: Verify that the ‘ExtractedIndicators.IP’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "53"
      '#default#':
      - "108"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: ExtractedIndicators
                accessor: IP
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: devicelocalip
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1750,
          "y": 2180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "103":
    id: "103"
    taskid: 8635ae04-8b35-4b46-8a85-6c0f80a3d4dc
    type: condition
    task:
      id: 8635ae04-8b35-4b46-8a85-6c0f80a3d4dc
      version: -1
      name: Verify URL
      description: Verify that the ‘ExtractedIndicators.URL’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "53"
      '#default#':
      - "109"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: ExtractedIndicators
                accessor: URL
            iscontext: true
          right:
            value: {}
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2200,
          "y": 2180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "105":
    id: "105"
    taskid: 8be2b5f3-ca3c-4833-87f3-e6a263029abe
    type: regular
    task:
      id: 8be2b5f3-ca3c-4833-87f3-e6a263029abe
      version: -1
      name: Verify Context Data Error - Domain
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Domain' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'extractIndicators' automation outputs have been modified and no longer contain the 'ExtractedIndicators.Domain' context key. \n2- The 'text' input configuration was changed for the 'extractIndicators' automation used in the 'Extract Indicators' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 2435
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "106":
    id: "106"
    taskid: 2c28a092-b5fc-4a3b-889a-9f1941aac644
    type: regular
    task:
      id: 2c28a092-b5fc-4a3b-889a-9f1941aac644
      version: -1
      name: Verify Context Data Error - Email
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Email' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'extractIndicators' automation outputs have been modified and no longer contain the 'ExtractedIndicators.Email' context key. \n2- The 'text' input configuration was changed for the 'extractIndicators' automation used in the 'Extract Indicators' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 2435
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "107":
    id: "107"
    taskid: 8be47a5f-2b05-452c-8a6c-465312a53367
    type: regular
    task:
      id: 8be47a5f-2b05-452c-8a6c-465312a53367
      version: -1
      name: Verify Context Data Error - File
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'File' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'extractIndicators' automation outputs have been modified and no longer contain the 'ExtractedIndicators.File' context key. \n2- The 'text' input configuration was changed for the 'extractIndicators' automation used in the 'Extract Indicators' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2640,
          "y": 2435
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "108":
    id: "108"
    taskid: 111faec1-1b82-4b5f-8b29-79c17186dfdb
    type: regular
    task:
      id: 111faec1-1b82-4b5f-8b29-79c17186dfdb
      version: -1
      name: Verify Context Data Error - IP
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'IP' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'extractIndicators' automation outputs have been modified and no longer contain the 'ExtractedIndicators.IP' context key. \n2- The 'text' input configuration was changed for the 'extractIndicators' automation used in the 'Extract Indicators' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1750,
          "y": 2435
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "109":
    id: "109"
    taskid: b1dc2e5d-9f6a-4fe0-801e-d9f82a9af649
    type: regular
    task:
      id: b1dc2e5d-9f6a-4fe0-801e-d9f82a9af649
      version: -1
      name: Verify Context Data Error - URL
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'URL' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'extractIndicators' automation outputs have been modified and no longer contain the 'ExtractedIndicators.URL' context key. \n2- The 'text' input configuration was changed for the 'extractIndicators' automation used in the 'Extract Indicators' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2200,
          "y": 2435
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "112":
    id: "112"
    taskid: 40f54a83-2c2d-4da1-8225-171b5051dd5d
    type: title
    task:
      id: 40f54a83-2c2d-4da1-8225-171b5051dd5d
      version: -1
      name: '''PaloAltoNetworksXDR'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "46"
      - "73"
      - "74"
      - "75"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 1410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "113":
    id: "113"
    taskid: 0dcedcb6-4ae0-47c8-872b-b8875264ef6f
    type: title
    task:
      id: 0dcedcb6-4ae0-47c8-872b-b8875264ef6f
      version: -1
      name: Done verifying 'PaloAltoNetworksXDR'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6120,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "114":
    id: "114"
    taskid: be839f39-77e9-4997-863d-a35a4bd4c1f6
    type: regular
    task:
      id: be839f39-77e9-4997-863d-a35a4bd4c1f6
      version: -1
      name: Verify Context Error - File Artifacts
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'PaloAltoNetworksXDR.Incident.file_artifacts' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.Incident.file_artifacts' context key. \n2- The 'incident_id' input configuration was changed for the 'xdr-get-incident-extra-data' automation used in the 'Get Full Incident Details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 1805
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "115":
    id: "115"
    taskid: 332301b1-ea6a-4ce8-855a-e62cbe831d9c
    type: regular
    task:
      id: 332301b1-ea6a-4ce8-855a-e62cbe831d9c
      version: -1
      name: Verify Context Error - Network Artifacts
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'PaloAltoNetworksXDR.Incident.network_artifacts' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.Incident.network_artifacts' context key. \n2- The 'incident_id' input configuration was changed for the 'xdr-get-incident-extra-data' automation used in the 'Get Full Incident Details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1370,
          "y": 1805
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "116":
    id: "116"
    taskid: 2916273e-6b3b-4d10-844a-d273b741e083
    type: regular
    task:
      id: 2916273e-6b3b-4d10-844a-d273b741e083
      version: -1
      name: Verify Context Data Error - Alerts
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'PaloAltoNetworksXDR.Incident.alerts' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.Incident.alerts' context key. \n2- The 'incident_id' input configuration was changed for the 'xdr-get-incident-extra-data' automation used in the 'Get Full Incident Details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1820,
          "y": 1805
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "117":
    id: "117"
    taskid: 222aaff8-e607-4ffc-8b85-0ef50cd419bc
    type: regular
    task:
      id: 222aaff8-e607-4ffc-8b85-0ef50cd419bc
      version: -1
      name: Verify Context Data Error - Incident
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'PaloAltoNetworksXDR.Incident' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.Incident' context key. \n2- The 'incident_id' input configuration was changed for the 'xdr-get-incident-extra-data' automation used in the 'Get Full Incident Details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2260,
          "y": 1805
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "125":
    id: "125"
    taskid: 1f85052d-18bb-44df-8ab6-38a752b9f717
    type: regular
    task:
      id: 1f85052d-18bb-44df-8ab6-38a752b9f717
      version: -1
      name: Verify Context Error  - Hostname
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.Hostname’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.Hostname' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task.\n3- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'Endpoint.Hostname' context key. \n4- The 'incident_id' input configuration was changed for the 'xdr-get-incident-extra-data' automation used in the 'Get Full Incident Details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4135,
          "y": 3615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "126":
    id: "126"
    taskid: 14c72629-852c-40e2-8836-dacbe996e37f
    type: title
    task:
      id: 14c72629-852c-40e2-8836-dacbe996e37f
      version: -1
      name: Done verifying 'Domain' context
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6130,
          "y": 4130
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "127":
    id: "127"
    taskid: c7e143a3-37dc-4fd3-86c3-33e52ea9b141
    type: title
    task:
      id: c7e143a3-37dc-4fd3-86c3-33e52ea9b141
      version: -1
      name: Done verifying 'Endpoint'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6130,
          "y": 3570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "128":
    id: "128"
    taskid: deb17f30-6cad-455c-8a1d-741f58ca9e05
    type: title
    task:
      id: deb17f30-6cad-455c-8a1d-741f58ca9e05
      version: -1
      name: Done verifying 'File'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6120,
          "y": 2980
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "131":
    id: "131"
    taskid: 8d5c5a9a-263b-46f8-8ae3-a67854a3dd57
    type: title
    task:
      id: 8d5c5a9a-263b-46f8-8ae3-a67854a3dd57
      version: -1
      name: Done verifying 'IP' context
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6120,
          "y": 1230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "132":
    id: "132"
    taskid: f27e3e88-b3ca-4731-8f6a-c94b64da9a1d
    type: title
    task:
      id: f27e3e88-b3ca-4731-8f6a-c94b64da9a1d
      version: -1
      name: Check Incident Fields
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "137"
      - "152"
      - "153"
      - "154"
      - "155"
      - "156"
      - "182"
      - "183"
      - "179"
      - "178"
      - "177"
      - "176"
      - "180"
      - "167"
      - "166"
      - "164"
      - "163"
      - "162"
      - "161"
      - "255"
      - "257"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": -540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "136":
    id: "136"
    taskid: e3e8abb4-8759-4314-8a2b-c195500c2d51
    type: title
    task:
      id: e3e8abb4-8759-4314-8a2b-c195500c2d51
      version: -1
      name: Done verifying Incident Fields
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 9480,
          "y": -180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "137":
    id: "137"
    taskid: 72db65a3-b44c-4912-8cfe-b9e82c066eea
    type: condition
    task:
      id: 72db65a3-b44c-4912-8cfe-b9e82c066eea
      version: -1
      name: Verify Alerts And Related Info
      description: |-
        Verify that the ‘alertsandrelatedinfo’ incident field was filled out correctly.
        These Incident Field are affecting the incident layouts (grid_id)
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "138"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: incident.alertsandrelatedinfo.alertname
            iscontext: true
          right:
            value:
              complex:
                root: PaloAltoNetworksXDR.Incident.alerts
                accessor: name
            iscontext: true
          ignorecase: true
      - - operator: containsGeneral
          left:
            value:
              simple: incident.alertsandrelatedinfo.hostname
            iscontext: true
          right:
            value:
              complex:
                root: PaloAltoNetworksXDR.Incident.alerts
                accessor: host_name
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "138":
    id: "138"
    taskid: f8a58928-9237-45a0-8da3-8df1c4ee736c
    type: regular
    task:
      id: f8a58928-9237-45a0-8da3-8df1c4ee736c
      version: -1
      name: Verify Incident Field Error - Alerts And Related Info
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'alertsandrelatedinfo' incident field was not set correctly. This may indicate that the following change has been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:
          1- The 'grid_id' input configuration was changed for the 'SetGridField' automation used in the 'Set Alerts Table Info in the Layout' task.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "140":
    id: "140"
    taskid: 992e6a77-8ea9-4c50-825c-0b74b7e80dbe
    type: regular
    task:
      id: 992e6a77-8ea9-4c50-825c-0b74b7e80dbe
      version: -1
      name: Verify Incident Field Error - MD5
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'MD5' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.Incident.alerts.actor_process_image_md5' context key. \n2- The 'MD5' input configuration was changed for the 'setIncident' automation used in the 'Set Process Details To Layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "142":
    id: "142"
    taskid: e9c14ff9-1a15-4aaa-8135-fada3c59b25b
    type: regular
    task:
      id: e9c14ff9-1a15-4aaa-8135-fada3c59b25b
      version: -1
      name: Verify Context Error - Path
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'File.Path’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'File.Path' context key. \n2- The 'incident_id' input configuration was changed for the 'xdr-get-incident-extra-data' automation used in the 'Get Full Incident Details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1735,
          "y": 3015
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "144":
    id: "144"
    taskid: 290a1358-4eed-412d-8ce2-1cebf7d508dc
    type: regular
    task:
      id: 290a1358-4eed-412d-8ce2-1cebf7d508dc
      version: -1
      name: Verify Context Error - Email Address
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Account.Email.Address’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'Account Enrichment - Generic v2.1' sub-playbook outputs have been modified and no longer contain the 'Account.Email.Address' context key. \n2- The 'Username' input configuration was changed for the 'Account Enrichment - Generic v2.1' sub-playbook inputs."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 640
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "145":
    id: "145"
    taskid: 2ee6801d-e142-42fe-896e-4b1d2b4403ab
    type: regular
    task:
      id: 2ee6801d-e142-42fe-896e-4b1d2b4403ab
      version: -1
      name: Verify Context Error  - IP Address
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'IP.Address’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'extractIndicators' automation outputs have been modified and no longer contain the 'IP' context key. \n2- The 'text' input configuration was changed for the 'extractIndicators' automation used in the 'Extract Indicators' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 920,
          "y": 1205
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "149":
    id: "149"
    taskid: b126cb15-e72c-4b73-8585-d7dd1a995834
    type: regular
    task:
      id: b126cb15-e72c-4b73-8585-d7dd1a995834
      version: -1
      name: Set Incident Fields To Context
      description: Add incident fields required for testing to the mock incident.
      script: Builtin|||setIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "150"
    scriptarguments:
      agentsid:
        simple: f8a2f58846b542579c12090652e79f3d
      alertsandrelatedinfo:
        simple: '[{"columnheader3":""},{},{}]'
      externalsystemid:
        simple: "63"
      type:
        simple: Malware Investigation and Response
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": -1010
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "150":
    id: "150"
    taskid: 837ed1d7-8847-42e3-8aae-58a611201e40
    type: playbook
    task:
      id: 837ed1d7-8847-42e3-8aae-58a611201e40
      version: -1
      name: Cortex XDR Malware - Incident Enrichment
      playbookName: Cortex XDR Malware - Incident Enrichment
      type: playbook
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "84"
    scriptarguments:
      IncidentID:
        complex:
          root: incident
          accessor: externalsystemid
    separatecontext: false
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 590,
          "y": -850
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "151":
    id: "151"
    taskid: 4f384f59-8318-4dd1-8c98-475e10ce4ea7
    type: title
    task:
      id: 4f384f59-8318-4dd1-8c98-475e10ce4ea7
      version: -1
      name: Check Context Data
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "63"
      - "67"
      - "112"
      - "39"
      - "64"
      - "69"
      - "278"
      - "65"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": 125
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "152":
    id: "152"
    taskid: 7bac4b5c-9141-4897-81db-cb2604f32666
    type: condition
    task:
      id: 7bac4b5c-9141-4897-81db-cb2604f32666
      version: -1
      name: Verify MD5
      description: |
        Verify that the ‘MD5’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "140"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              simple: incident.md5
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "153":
    id: "153"
    taskid: 7a8d12b8-5e75-4944-80f9-85f658eeeed4
    type: condition
    task:
      id: 7a8d12b8-5e75-4944-80f9-85f658eeeed4
      version: -1
      name: Verify Parent Process File Path
      description: |
        Verify that the ‘parentprocessfilepath’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "157"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              simple: incident.parentprocessfilepath
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1740,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "154":
    id: "154"
    taskid: ff6a4570-7179-4340-8231-7d7e8ee76f58
    type: condition
    task:
      id: ff6a4570-7179-4340-8231-7d7e8ee76f58
      version: -1
      name: Verify Process Name
      description: |
        Verify that the ‘processname’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "158"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              simple: incident.processname
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2140,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "155":
    id: "155"
    taskid: 7a23d8e8-bcc0-48cd-82ef-f7448a133b39
    type: condition
    task:
      id: 7a23d8e8-bcc0-48cd-82ef-f7448a133b39
      version: -1
      name: Verify Process Path
      description: |
        Verify that the ‘processpath’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "159"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              simple: incident.processpath
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2540,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "156":
    id: "156"
    taskid: aff5a6ef-be7d-46bf-8009-515f50ced877
    type: condition
    task:
      id: aff5a6ef-be7d-46bf-8009-515f50ced877
      version: -1
      name: Verify SHA256
      description: |
        Verify that the ‘SHA256’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "160"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              simple: incident.sha256
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2940,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "157":
    id: "157"
    taskid: 34fcc697-01ed-4c80-8857-e84e5c3f8476
    type: regular
    task:
      id: 34fcc697-01ed-4c80-8857-e84e5c3f8476
      version: -1
      name: Verify Incident Field Error - Parent Process File Path
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'parentprocessfilepath' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.Incident.alerts.causality_actor_process_image_path' context key. \n2- The 'parentprocessfilepath' input configuration was changed for the 'setIncident' automation used in the 'Set Process Details To Layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1740,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "158":
    id: "158"
    taskid: 2df53ae4-5fe4-450d-88ad-1690a841e070
    type: regular
    task:
      id: 2df53ae4-5fe4-450d-88ad-1690a841e070
      version: -1
      name: Verify Incident Field Error - Process Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'processname' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.Incident.alerts.actor_process_image_name' context key. \n2- The 'processname' input configuration was changed for the 'setIncident' automation used in the 'Set Process Details To Layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2140,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "159":
    id: "159"
    taskid: 4bb60141-f1b2-4bac-8259-6f1166b65841
    type: regular
    task:
      id: 4bb60141-f1b2-4bac-8259-6f1166b65841
      version: -1
      name: Verify Incident Field Error - Process Path
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'processpath' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.Incident.alerts.actor_process_image_path' context key. \n2- The 'processpath' input configuration was changed for the 'setIncident' automation used in the 'Set Process Details To Layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2540,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "160":
    id: "160"
    taskid: f45f68c9-85c7-473b-8bb0-320f0bec56dd
    type: regular
    task:
      id: f45f68c9-85c7-473b-8bb0-320f0bec56dd
      version: -1
      name: Verify Incident Field Error - SHA256
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'sha256' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.Incident.alerts.actor_process_image_sha256' context key. \n2- The 'sha256' input configuration was changed for the 'setIncident' automation used in the 'Set Process Details To Layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2940,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "161":
    id: "161"
    taskid: 2ba584bd-cf7f-43d8-8613-092234f768fc
    type: condition
    task:
      id: 2ba584bd-cf7f-43d8-8613-092234f768fc
      version: -1
      name: Verify Account Member Of
      description: |
        Verify that the ‘accountmemberof’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "168"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: incident
                accessor: accountmemberof
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3350,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "162":
    id: "162"
    taskid: 54a9b87c-6cb1-412c-8523-6c2c7dc0959d
    type: condition
    task:
      id: 54a9b87c-6cb1-412c-8523-6c2c7dc0959d
      version: -1
      name: Verify Account Name
      description: |
        Verify that the ‘accountname’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "169"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: incident
                accessor: accountname
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3750,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "163":
    id: "163"
    taskid: 347ebfb0-b78b-4dcf-8595-e86f7234e8a0
    type: condition
    task:
      id: 347ebfb0-b78b-4dcf-8595-e86f7234e8a0
      version: -1
      name: Verify Account Status
      description: |
        Verify that the ‘accountstatus’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "170"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: incident
                accessor: accountstatus
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4150,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "164":
    id: "164"
    taskid: 19fb08a4-41ff-453f-82e7-7a32dcd7f4c3
    type: condition
    task:
      id: 19fb08a4-41ff-453f-82e7-7a32dcd7f4c3
      version: -1
      name: Verify Employee Email
      description: |
        Verify that the ‘employeeemail’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "171"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: employeeemail
            iscontext: true
          right:
            value:
              complex:
                root: Account.Email
                accessor: Address
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4550,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "166":
    id: "166"
    taskid: 7e5b48e9-e593-4976-8e8a-7954bc540714
    type: condition
    task:
      id: 7e5b48e9-e593-4976-8e8a-7954bc540714
      version: -1
      name: Verify Manager Name
      description: |
        Verify that the ‘managername’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "173"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: incident
                accessor: managername
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4950,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "167":
    id: "167"
    taskid: 7ba556d8-c30e-43ae-8930-d9e130f94578
    type: condition
    task:
      id: 7ba556d8-c30e-43ae-8930-d9e130f94578
      version: -1
      name: Verify SAM Account Name
      description: |
        Verify that the ‘samaccountname’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "174"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: incident
                accessor: samaccountname
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5350,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "168":
    id: "168"
    taskid: 0ab399f7-cdf4-470a-8e8b-77469f31a69c
    type: regular
    task:
      id: 0ab399f7-cdf4-470a-8e8b-77469f31a69c
      version: -1
      name: Verify Incident Field Error - Account Member Of
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'accountmemberof' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'Account Enrichment - Generic v2.1' sub-playbook outputs have been modified and no longer contain the 'Account.Groups' context key. \n2- The 'accountmemberof' input configuration was changed for the 'setIncident' automation used in the 'Set Account information to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3350,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "169":
    id: "169"
    taskid: 32249abf-edf7-47d2-86b6-6f19bc713e15
    type: regular
    task:
      id: 32249abf-edf7-47d2-86b6-6f19bc713e15
      version: -1
      name: Verify Incident Field Error - Account Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'accountname' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'Account Enrichment - Generic v2.1' sub-playbook outputs have been modified and no longer contain the 'Account.DisplayName' context key. \n2- The 'accountname' input configuration was changed for the 'setIncident' automation used in the 'Set Account information to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3750,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "170":
    id: "170"
    taskid: 35268052-91ba-40c8-83ca-69e50f1ba47e
    type: regular
    task:
      id: 35268052-91ba-40c8-83ca-69e50f1ba47e
      version: -1
      name: Verify Incident Field Error - Account Status
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'accountstatus' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'Account Enrichment - Generic v2.1' sub-playbook outputs have been modified and no longer contain the 'Account.Status' context key. \n2- The 'accountstatus' input configuration was changed for the 'setIncident' automation used in the 'Set Account information to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4150,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "171":
    id: "171"
    taskid: 4c47a343-fa2b-4eff-8629-150f14808d3f
    type: regular
    task:
      id: 4c47a343-fa2b-4eff-8629-150f14808d3f
      version: -1
      name: Verify Incident Field Error - Employee Email
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'employeeemail' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'Account Enrichment - Generic v2.1' sub-playbook outputs have been modified and no longer contain the 'Account.Email' context key. \n2- The 'employeeemail' input configuration was changed for the 'setIncident' automation used in the 'Set Account information to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4550,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "173":
    id: "173"
    taskid: aa4e83a2-baab-4f0e-8432-8acb8cb7e57d
    type: regular
    task:
      id: aa4e83a2-baab-4f0e-8432-8acb8cb7e57d
      version: -1
      name: Verify Incident Field Error - Manager Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'managername' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'Account Enrichment - Generic v2.1' sub-playbook outputs have been modified and no longer contain the 'Account.Manager' context key. \n2- The 'managername' input configuration was changed for the 'setIncident' automation used in the 'Set Account information to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4960,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "174":
    id: "174"
    taskid: 2f0ad040-dd6d-4951-8937-76932b07e5c2
    type: regular
    task:
      id: 2f0ad040-dd6d-4951-8937-76932b07e5c2
      version: -1
      name: Verify Incident Field Error - SAM Account Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'samaccountname' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'Account Enrichment - Generic v2.1' sub-playbook outputs have been modified and no longer contain the 'Account.Username' context key. \n2- The 'samaccountname' input configuration was changed for the 'setIncident' automation used in the 'Set Account information to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5350,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "176":
    id: "176"
    taskid: 2be07f2b-c5ae-40b8-85fd-7f55bdd67873
    type: condition
    task:
      id: 2be07f2b-c5ae-40b8-85fd-7f55bdd67873
      version: -1
      name: Verify Device ID
      description: |
        Verify that the ‘deviceid’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "185"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              simple: incident.deviceid
            iscontext: true
          right:
            value:
              complex:
                root: Endpoint
                accessor: ID
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6160,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "177":
    id: "177"
    taskid: e2f532c4-a0b6-4569-8e15-03288277b2c2
    type: condition
    task:
      id: e2f532c4-a0b6-4569-8e15-03288277b2c2
      version: -1
      name: Verify Device Local IP
      description: |
        Verify that the ‘devicelocalip’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "188"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: incident.devicelocalip
            iscontext: true
          right:
            value:
              complex:
                root: Endpoint
                accessor: IPAddress
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6570,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "178":
    id: "178"
    taskid: 2ce26db2-166e-4f2f-888e-bf0b43b77b8b
    type: condition
    task:
      id: 2ce26db2-166e-4f2f-888e-bf0b43b77b8b
      version: -1
      name: Verify Device MAC Address
      description: |
        Verify that the ‘devicemacaddress’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "187"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: incident.devicemacaddress
            iscontext: true
          right:
            value:
              complex:
                root: Endpoint
                accessor: MACAddress
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6970,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "179":
    id: "179"
    taskid: 01613bc3-f6fa-4e82-8155-f3aca5aefcf8
    type: condition
    task:
      id: 01613bc3-f6fa-4e82-8155-f3aca5aefcf8
      version: -1
      name: Verify Device Name
      description: |
        Verify that the ‘devicename’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "186"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: incident.devicename
            iscontext: true
          right:
            value:
              complex:
                root: Endpoint
                accessor: Hostname
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 7370,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "180":
    id: "180"
    taskid: 3f7806ed-77f7-4aa6-8c3a-2800336f36b0
    type: condition
    task:
      id: 3f7806ed-77f7-4aa6-8c3a-2800336f36b0
      version: -1
      name: Verify Device OS Name
      description: |
        Verify that the ‘deviceosname’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "184"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: incident.deviceosname
            iscontext: true
          right:
            value:
              complex:
                root: Endpoint
                accessor: OS
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5760,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "182":
    id: "182"
    taskid: 3511a1b2-fd06-4375-87a4-af6be9ca684d
    type: condition
    task:
      id: 3511a1b2-fd06-4375-87a4-af6be9ca684d
      version: -1
      name: Verify Device Status
      description: |
        Verify that the ‘devicestatus’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "189"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: incident.devicestatus
            iscontext: true
          right:
            value:
              complex:
                root: Endpoint
                accessor: Status
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 8190,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "183":
    id: "183"
    taskid: c648bd59-a10f-4cff-8e8d-422821ed1b39
    type: condition
    task:
      id: c648bd59-a10f-4cff-8e8d-422821ed1b39
      version: -1
      name: Verify Isolated
      description: |
        Verify that the ‘isolated’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "190"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: incident.isolated
            iscontext: true
          right:
            value:
              complex:
                root: Endpoint
                accessor: IsIsolated
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 7790,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "184":
    id: "184"
    taskid: 23f83053-b84d-48e2-8e80-0a66978b96f9
    type: regular
    task:
      id: 23f83053-b84d-48e2-8e80-0a66978b96f9
      version: -1
      name: Verify Incident Field Error - Device OS Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'deviceosname' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.OS' context key. \n2- The 'deviceosname' input configuration was changed for the 'setIncident' automation used in the 'Set Endpoint information to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5760,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "185":
    id: "185"
    taskid: cb52b9f2-b3a2-4613-8cdb-7679fdf4240f
    type: regular
    task:
      id: cb52b9f2-b3a2-4613-8cdb-7679fdf4240f
      version: -1
      name: Verify Incident Field Error - Device ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'deviceid' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.ID' context key. \n2- The 'deviceid' input configuration was changed for the 'setIncident' automation used in the 'Set Endpoint information to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6160,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "186":
    id: "186"
    taskid: 90537443-b2dd-4588-8b7a-6daa6f558370
    type: regular
    task:
      id: 90537443-b2dd-4588-8b7a-6daa6f558370
      version: -1
      name: Verify Incident Field Error - Device Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'devicename' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.Hostname' context key. \n2- The 'devicename' input configuration was changed for the 'setIncident' automation used in the 'Set Endpoint information to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 7370,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "187":
    id: "187"
    taskid: 95762698-8c8d-4040-8735-3a2168195a06
    type: regular
    task:
      id: 95762698-8c8d-4040-8735-3a2168195a06
      version: -1
      name: Verify Incident Field Error - Device MAC Address
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'devicemacaddress' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.MACAddress' context key. \n2- The 'devicemacaddress' input configuration was changed for the 'setIncident' automation used in the 'Set Endpoint information to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6960,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "188":
    id: "188"
    taskid: 41a7b209-67db-4f09-8cba-91504a25f6ca
    type: regular
    task:
      id: 41a7b209-67db-4f09-8cba-91504a25f6ca
      version: -1
      name: Verify Incident Field Error - Device Local IP
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'devicelocalip' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.IPAddress' context key. \n2- The 'devicelocalip' input configuration was changed for the 'setIncident' automation used in the 'Set Endpoint information to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6560,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "189":
    id: "189"
    taskid: c1e061ad-ed33-4777-8975-f4386c282925
    type: regular
    task:
      id: c1e061ad-ed33-4777-8975-f4386c282925
      version: -1
      name: Verify Incident Field Error - Device Status
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'devicestatus' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.Status' context key. \n2- The 'devicestatus' input configuration was changed for the 'setIncident' automation used in the 'Set Endpoint information to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 8190,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "190":
    id: "190"
    taskid: 42c7488a-f690-4263-8598-7f12ac731f4d
    type: regular
    task:
      id: 42c7488a-f690-4263-8598-7f12ac731f4d
      version: -1
      name: Verify Incident Field Error - Isolated
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'isolated' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.IsIsolated' context key. \n2- The 'isolated' input configuration was changed for the 'setIncident' automation used in the 'Set Endpoint information to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 7790,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "198":
    id: "198"
    taskid: 1f196b2f-10c4-470f-8c1b-d82cb1ef58e3
    type: title
    task:
      id: 1f196b2f-10c4-470f-8c1b-d82cb1ef58e3
      version: -1
      name: Done verifying 'Account'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6120,
          "y": 630
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "199":
    id: "199"
    taskid: 64b1d4b2-7f1f-48a9-876b-382003968249
    type: condition
    task:
      id: 64b1d4b2-7f1f-48a9-876b-382003968249
      version: -1
      name: Verify Hostname
      description: Verify that the 'Endpoint.Hostname’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "125"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: Endpoint
                accessor: Hostname
            iscontext: true
          right:
            value:
              complex:
                root: PaloAltoNetworksXDR.Incident.alerts
                accessor: host_name
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4135,
          "y": 3370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "200":
    id: "200"
    taskid: 651fbb12-4b20-4c37-8e81-3064e5d58462
    type: condition
    task:
      id: 651fbb12-4b20-4c37-8e81-3064e5d58462
      version: -1
      name: Verify Is Isolated
      description: Verify that the 'Endpoint.IsIsolated’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "201"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Endpoint
                accessor: IsIsolated
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: isolated
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3735,
          "y": 3370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "201":
    id: "201"
    taskid: 369cc371-20ee-422b-85de-d9225ff265d7
    type: regular
    task:
      id: 369cc371-20ee-422b-85de-d9225ff265d7
      version: -1
      name: Verify Context Error  -  Is Isolated
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.IsIsolated’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.IsIsolated' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3735,
          "y": 3615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "202":
    id: "202"
    taskid: 6179aa51-654d-4dd8-8433-852f4409d70c
    type: condition
    task:
      id: 6179aa51-654d-4dd8-8433-852f4409d70c
      version: -1
      name: Verify Domain
      description: Verify that the 'Endpoint.Domain’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "209"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: Endpoint
                accessor: Domain
            iscontext: true
          right:
            value: {}
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3335,
          "y": 3370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "203":
    id: "203"
    taskid: 6abbaf9e-d0ac-4d27-8800-26219ce53c60
    type: condition
    task:
      id: 6abbaf9e-d0ac-4d27-8800-26219ce53c60
      version: -1
      name: Verify OS
      description: Verify that the 'Endpoint.OS’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "210"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: Endpoint
                accessor: OS
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: deviceosname
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2935,
          "y": 3370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "204":
    id: "204"
    taskid: 8faf0361-3e30-4f1b-82eb-66be0b7218f1
    type: condition
    task:
      id: 8faf0361-3e30-4f1b-82eb-66be0b7218f1
      version: -1
      name: Verify MAC Address
      description: Verify that the 'Endpoint.MACAddress’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "211"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Endpoint
                accessor: MACAddress
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: devicemacaddress
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2545,
          "y": 3370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "205":
    id: "205"
    taskid: e7deff63-1add-4556-8f4b-262a87c54aba
    type: condition
    task:
      id: e7deff63-1add-4556-8f4b-262a87c54aba
      version: -1
      name: Verify Vendor
      description: Verify that the 'Endpoint.Vendor’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "212"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: Endpoint
                accessor: Vendor
            iscontext: true
          right:
            value: {}
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2135,
          "y": 3370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "206":
    id: "206"
    taskid: 776f96b7-67f0-43c6-8f4f-cdba29b703fa
    type: condition
    task:
      id: 776f96b7-67f0-43c6-8f4f-cdba29b703fa
      version: -1
      name: Verify IP Address
      description: Verify that the 'Endpoint.IPAddress’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "213"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: inList
          left:
            value:
              complex:
                root: Endpoint
                accessor: IPAddress
            iscontext: true
          right:
            value:
              complex:
                root: PaloAltoNetworksXDR.Incident.alerts
                accessor: host_ip
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1735,
          "y": 3370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "207":
    id: "207"
    taskid: d5ac89cb-6e10-48cb-84b9-85ac31756b67
    type: condition
    task:
      id: d5ac89cb-6e10-48cb-84b9-85ac31756b67
      version: -1
      name: Verify Status
      description: Verify that the 'Endpoint.Status’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "214"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Endpoint
                accessor: Status
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: devicestatus
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1335,
          "y": 3370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "208":
    id: "208"
    taskid: bdf4a445-dd1a-4a74-8eaa-53fcac95ed54
    type: condition
    task:
      id: bdf4a445-dd1a-4a74-8eaa-53fcac95ed54
      version: -1
      name: Verify ID
      description: Verify that the 'Endpoint.ID’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "215"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Endpoint
                accessor: ID
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: deviceid
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 3370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "209":
    id: "209"
    taskid: 599f2589-c4b1-462e-89c5-1c3f5857d2ac
    type: regular
    task:
      id: 599f2589-c4b1-462e-89c5-1c3f5857d2ac
      version: -1
      name: Verify Context Error  -  Domain
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.Domain’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.Domain' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3335,
          "y": 3615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "210":
    id: "210"
    taskid: 5aed9fbd-8fe7-42e0-82c8-00bf533a31c2
    type: regular
    task:
      id: 5aed9fbd-8fe7-42e0-82c8-00bf533a31c2
      version: -1
      name: Verify Context Error  -  OS
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.OS’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.OS' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2925,
          "y": 3615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "211":
    id: "211"
    taskid: 385931c5-85a2-4a81-87c2-b937bcd03b0c
    type: regular
    task:
      id: 385931c5-85a2-4a81-87c2-b937bcd03b0c
      version: -1
      name: Verify Context Error  - MAC Address
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.MACAddress’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.MACAddress' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2525,
          "y": 3615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "212":
    id: "212"
    taskid: 3344f8b2-7ec6-48b1-897a-248ca114f81d
    type: regular
    task:
      id: 3344f8b2-7ec6-48b1-897a-248ca114f81d
      version: -1
      name: Verify Context Error  - Vendor
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.Vendor’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.Vendor' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2125,
          "y": 3615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "213":
    id: "213"
    taskid: 40834c4c-3669-470b-8c56-40317eb8d90a
    type: regular
    task:
      id: 40834c4c-3669-470b-8c56-40317eb8d90a
      version: -1
      name: Verify Context Error  - IP Address
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.IPAddress’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.IPAddress' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1725,
          "y": 3610
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "214":
    id: "214"
    taskid: ec9eb0f9-9481-4fc0-82e1-278b43ebd87d
    type: regular
    task:
      id: ec9eb0f9-9481-4fc0-82e1-278b43ebd87d
      version: -1
      name: Verify Context Error  - Status
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.Status’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.Status' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1335,
          "y": 3615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "215":
    id: "215"
    taskid: 441fa760-9073-4e66-8e91-657ca04313e0
    type: regular
    task:
      id: 441fa760-9073-4e66-8e91-657ca04313e0
      version: -1
      name: Verify Context Error  - ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.ID’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.ID' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 3615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "218":
    id: "218"
    taskid: 580384e5-f631-4d5f-8b0f-f3aee77fe801
    type: condition
    task:
      id: 580384e5-f631-4d5f-8b0f-f3aee77fe801
      version: -1
      name: Verify SHA265
      description: Verify that the 'File.SHA256’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "219"
      Verified:
      - "128"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: File
                accessor: SHA265
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: filesha256
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1335,
          "y": 2795
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "219":
    id: "219"
    taskid: c4f9f973-4ad1-4a41-8391-a30f65dca2e3
    type: regular
    task:
      id: c4f9f973-4ad1-4a41-8391-a30f65dca2e3
      version: -1
      name: Verify Context Error - SHA265
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'File.SHA256’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'File.SHA256' context key. \n2- The 'incident_id' input configuration was changed for the 'xdr-get-incident-extra-data' automation used in the 'Get Full Incident Details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1335,
          "y": 3015
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "220":
    id: "220"
    taskid: 6edc5841-b669-44f1-8cb0-e66bde3480b7
    type: condition
    task:
      id: 6edc5841-b669-44f1-8cb0-e66bde3480b7
      version: -1
      name: Verify Name
      description: Verify that the 'File.Name’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "221"
      Verified:
      - "128"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: File
                accessor: Name
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: filenames
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 2795
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "221":
    id: "221"
    taskid: 8841e4da-0ebd-42e6-837c-359593979dab
    type: regular
    task:
      id: 8841e4da-0ebd-42e6-837c-359593979dab
      version: -1
      name: Verify Context Error - Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'File.Name’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'File.Name' context key. \n2- The 'incident_id' input configuration was changed for the 'xdr-get-incident-extra-data' automation used in the 'Get Full Incident Details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 3015
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "255":
    id: "255"
    taskid: 11fc0d38-f4dd-4f80-874c-5a1c4158bfd4
    type: condition
    task:
      id: 11fc0d38-f4dd-4f80-874c-5a1c4158bfd4
      version: -1
      name: Verify Hostnames
      description: |
        Verify that the ‘hostnames’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "256"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: hostnames
            iscontext: true
          right:
            value:
              complex:
                root: PaloAltoNetworksXDR.Incident.alerts
                accessor: host_name
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 8590,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "256":
    id: "256"
    taskid: ce586d80-44fe-4047-8105-27cb57de3285
    type: regular
    task:
      id: ce586d80-44fe-4047-8105-27cb57de3285
      version: -1
      name: Verify Incident Field Error - Hostnames
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Hostnames' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.Incident.alerts.host_name' context key. \n2- The 'incident_id' input configuration was changed for the 'xdr-get-incident-extra-data' automation used in the 'Get Full Incident Details' task.\n3- The custom output mapping rule for the 'Hostnames' incident field configured within the 'Get Full Incident Details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 8590,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "257":
    id: "257"
    taskid: cfed5c52-0cbc-4374-88cb-20fc13876c1c
    type: condition
    task:
      id: cfed5c52-0cbc-4374-88cb-20fc13876c1c
      version: -1
      name: Verify Detected Users
      description: |
        Verify that the ‘detectedusers’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "258"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: incident
                accessor: detectedusers
            iscontext: true
          right:
            value: {}
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 8990,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "258":
    id: "258"
    taskid: 10e2bf98-48ab-4257-8f11-c3239dca6b6c
    type: regular
    task:
      id: 10e2bf98-48ab-4257-8f11-c3239dca6b6c
      version: -1
      name: Verify Incident Field Error - Detected Users
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'detectedusers' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.Incident.alerts.user_name' context key. \n2- The 'incident_id' input configuration was changed for the 'xdr-get-incident-extra-data' automation used in the 'Get Full Incident Details' task.\n3- The custom output mapping rule for the 'detectedusers' incident field configured within the 'Get Full Incident Details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 8990,
          "y": -95
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "265":
    id: "265"
    taskid: e335ce05-a4d7-483b-82c6-8b31bdc58705
    type: condition
    task:
      id: e335ce05-a4d7-483b-82c6-8b31bdc58705
      version: -1
      name: Verify Context - Name
      description: Verify that the 'Domain.Name’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "266"
      Verified:
      - "126"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: Domain
                accessor: Name
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 3920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "266":
    id: "266"
    taskid: 42f4c2e5-ffca-4493-847a-a3c5e8f302ed
    type: regular
    task:
      id: 42f4c2e5-ffca-4493-847a-a3c5e8f302ed
      version: -1
      name: Verify Context Error  - Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Domain.Name’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'extractIndicators' automation outputs have been modified and no longer contain the 'Domain' context key. \n2- The 'text' input configuration was changed for the 'extractIndicators' automation used in the 'Extract Indicators' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 4150
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "277":
    id: "277"
    taskid: d72efe7e-5a02-4dc9-8280-3dff60ca94cd
    type: title
    task:
      id: d72efe7e-5a02-4dc9-8280-3dff60ca94cd
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 9480,
          "y": 4920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "278":
    id: "278"
    taskid: dfb9dd20-8561-40fe-8b12-ee8002f1e6d3
    type: title
    task:
      id: dfb9dd20-8561-40fe-8b12-ee8002f1e6d3
      version: -1
      name: '''URL'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "290"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 4360
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "281":
    id: "281"
    taskid: 460dc4a2-9009-43e4-85d5-bb6a134f11f8
    type: title
    task:
      id: 460dc4a2-9009-43e4-85d5-bb6a134f11f8
      version: -1
      name: Done verifying 'URL'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6130,
          "y": 4685
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "290":
    id: "290"
    taskid: 8d7825a2-9f0e-4af2-899d-2476969bbbf9
    type: condition
    task:
      id: 8d7825a2-9f0e-4af2-899d-2476969bbbf9
      version: -1
      name: Verify Data
      description: Verify that the 'URL.Data’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "291"
      Verified:
      - "281"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: URL
                accessor: Data
            iscontext: true
          right:
            value:
              complex:
                root: ExtractedIndicators
                accessor: URL
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 4495
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "291":
    id: "291"
    taskid: de652497-306d-44f5-84d7-5deb1d622ae1
    type: regular
    task:
      id: de652497-306d-44f5-84d7-5deb1d622ae1
      version: -1
      name: Verify Context Error - Data
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'URL.Data’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'extractIndicators' automation outputs have been modified and no longer contain the 'URL' context key. \n2- The 'text' input configuration was changed for the 'extractIndicators' automation used in the 'Extract Indicators' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 4715
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "100_53_ Verified": 0.1,
      "101_53_ Verified": 0.1,
      "102_53_ Verified": 0.11,
      "103_53_ Verified": 0.1,
      "137_136_Verified": 0.1,
      "152_136_Verified": 0.1,
      "40_53_Verified": 0.1,
      "46_113_Verified": 0.1,
      "73_116_#default#": 0.7,
      "74_113_ Verified": 0.12,
      "75_113_ Verified": 0.1
    },
    "paper": {
      "dimensions": {
        "height": 6290,
        "width": 9270,
        "x": 590,
        "y": -1305
      }
    }
  }
inputs: []
outputs: []
fromversion: 6.5.0
