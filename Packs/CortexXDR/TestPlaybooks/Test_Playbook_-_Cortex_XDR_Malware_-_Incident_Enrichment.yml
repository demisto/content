id: Test Playbook - Cortex XDR Malware - Incident Enrichment
version: -1
name: Test Playbook - Cortex XDR Malware - Incident Enrichment
description: "This playbook tests the ‘Cortex XDR Malware - Incident Enrichment’ playbook which is part of the ‘Malware Investigation and Response’ pack.\nThe tests were constructed based on alert number 63 of the Cortex XDR development environment.\n\nFollowing are the tests conducted in the playbook:\n1- Confirm that incident fields were populated correctly by the custom output mapping rules and the 'setIncident' automation. \n2- Validate the enrichment of XDR incidents.\n3- Validate the enrichment of alerts and incident entities.\n3- Ensure that the context data was properly extracted.\n4. Check that the XDR alert information was correctly populated into the 'Alert' grid table of the Malware-Investigation and Response layout.\n5- Validate the outputs of the playbook."
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: a6c4714c-7165-451b-83e2-bcd97a297f76
    type: start
    task:
      id: a6c4714c-7165-451b-83e2-bcd97a297f76
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "32"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": -1305
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: 9fdab3f4-72a9-42a7-8463-21457e2f9f22
    type: regular
    task:
      id: 9fdab3f4-72a9-42a7-8463-21457e2f9f22
      version: -1
      name: Delete Context
      description: The task deletes all of the context data. Having a clean beginning to a test playbook ensures that a test can be sterile and that unrelated issues can be eliminated.
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "149"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": -1175
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: c8997671-8910-4b64-8093-39f31deae3d0
    type: title
    task:
      id: c8997671-8910-4b64-8093-39f31deae3d0
      version: -1
      name: '''ExtractedIndicators'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "102"
      - "40"
      - "103"
      - "101"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 2035
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: 3ade2a0c-3e7c-4936-8ab6-0f81942cdca4
    type: condition
    task:
      id: 3ade2a0c-3e7c-4936-8ab6-0f81942cdca4
      version: -1
      name: Verify Domain
      description: Verify that the ‘ExtractedIndicators.Domain’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "105"
      Verified:
      - "53"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: ExtractedIndicators
                accessor: Domain
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 2180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: e5cb699f-e1cf-4856-8925-5dbb3e009e67
    type: condition
    task:
      id: e5cb699f-e1cf-4856-8925-5dbb3e009e67
      version: -1
      name: Verify  Incident
      description: |
        Verify that the ‘PaloAltoNetworksXDR.Incident’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "117"
      Verified:
      - "113"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR
                accessor: Incident
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2260,
          "y": 1560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: 6cae16e4-75b3-4724-8762-331137e822e7
    type: title
    task:
      id: 6cae16e4-75b3-4724-8762-331137e822e7
      version: -1
      name: Done verifying 'ExtractedIndicators'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6120,
          "y": 2370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: 6eb5a92c-5bf3-4ca2-84cd-8df50c10a148
    type: title
    task:
      id: 6eb5a92c-5bf3-4ca2-84cd-8df50c10a148
      version: -1
      name: '''Account'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "79"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "64":
    id: "64"
    taskid: 7c8e43dd-8749-45d8-84d5-7012adf5e1d2
    type: title
    task:
      id: 7c8e43dd-8749-45d8-84d5-7012adf5e1d2
      version: -1
      name: '''File'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "218"
      - "220"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 2650
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "65":
    id: "65"
    taskid: 00d79e6e-74a1-4455-866e-fa9ee2b5a733
    type: title
    task:
      id: 00d79e6e-74a1-4455-866e-fa9ee2b5a733
      version: -1
      name: '''Endpoint'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "199"
      - "200"
      - "202"
      - "203"
      - "204"
      - "205"
      - "206"
      - "207"
      - "208"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 3225
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "67":
    id: "67"
    taskid: 7bcb1a14-c1d9-4310-842a-7cd37d00b5ba
    type: title
    task:
      id: 7bcb1a14-c1d9-4310-842a-7cd37d00b5ba
      version: -1
      name: '''IP'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "81"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 860
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "69":
    id: "69"
    taskid: 91d1cf54-f95f-4453-85dc-d61b48f4aca2
    type: title
    task:
      id: 91d1cf54-f95f-4453-85dc-d61b48f4aca2
      version: -1
      name: '''Domain'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "265"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 3790
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "73":
    id: "73"
    taskid: dc45d200-73c4-4180-8332-9a9012b43a5e
    type: condition
    task:
      id: dc45d200-73c4-4180-8332-9a9012b43a5e
      version: -1
      name: Verify Alerts
      description: Verify that the ‘PaloAltoNetworksXDR.Incident.Alerts’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "116"
      Verified:
      - "113"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.Incident
                accessor: alerts
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1820,
          "y": 1560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "74":
    id: "74"
    taskid: 7fd9b4c4-5e39-4384-8025-1d3e21cf5869
    type: condition
    task:
      id: 7fd9b4c4-5e39-4384-8025-1d3e21cf5869
      version: -1
      name: Verify Network Artifacts
      description: |
        Verify that the ‘PaloAltoNetworksXDR.Incident.network_artifacts’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "113"
      '#default#':
      - "115"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isExists
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.network_artifacts
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1370,
          "y": 1560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "75":
    id: "75"
    taskid: 1d198288-5b6a-42f3-8d21-1c068e03583f
    type: condition
    task:
      id: 1d198288-5b6a-42f3-8d21-1c068e03583f
      version: -1
      name: Verify File Artifacts
      description: |
        Verify that the ‘PaloAltoNetworksXDR.Incident.file_artifacts’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "113"
      '#default#':
      - "114"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.file_artifacts
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 1560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "79":
    id: "79"
    taskid: 742073dc-e15e-4a1e-80b0-0cbe37bf6111
    type: condition
    task:
      id: 742073dc-e15e-4a1e-80b0-0cbe37bf6111
      version: -1
      name: Verify Email Address
      description: Verify that the 'Account.Email.Address’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "144"
      Verified:
      - "198"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: Account.Email
                accessor: Address
            iscontext: true
          right:
            value:
              complex:
                root: PaloAltoNetworksXDR.Incident
                accessor: assigned_user_mail
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "81":
    id: "81"
    taskid: af1cfe60-763c-4063-8e99-f68a4c61a3ba
    type: condition
    task:
      id: af1cfe60-763c-4063-8e99-f68a4c61a3ba
      version: -1
      name: Verify IP Address
      description: Verify that the 'IP.Address’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "145"
      Verified:
      - "131"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: IP
                accessor: Address
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: detectedinternalips
            iscontext: true
        - operator: in
          left:
            value:
              complex:
                root: IP
                accessor: Address
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: sourceips
            iscontext: true
        - operator: in
          left:
            value:
              complex:
                root: IP
                accessor: Address
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: devicelocalip
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 990
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "84":
    id: "84"
    taskid: d6f16587-7bbd-40fd-8076-7750bb8ec84c
    type: title
    task:
      id: d6f16587-7bbd-40fd-8076-7750bb8ec84c
      version: -1
      name: Start Tests
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "132"
      - "151"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": -680
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "101":
    id: "101"
    taskid: c1a01bf7-8ad9-4352-8b6a-90f054899de4
    type: condition
    task:
      id: c1a01bf7-8ad9-4352-8b6a-90f054899de4
      version: -1
      name: Verify File
      description: Verify that the ‘ExtractedIndicators.File’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "53"
      '#default#':
      - "107"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: containsString
          left:
            value:
              complex:
                root: ExtractedIndicators
                accessor: File
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: filesha256
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2240,
          "y": 2180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "102":
    id: "102"
    taskid: 5531d0c7-1237-4ad2-8644-6f84a2a669b8
    type: condition
    task:
      id: 5531d0c7-1237-4ad2-8644-6f84a2a669b8
      version: -1
      name: Verify IP
      description: Verify that the ‘ExtractedIndicators.IP’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "53"
      '#default#':
      - "108"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: ExtractedIndicators
                accessor: IP
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: devicelocalip
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1350,
          "y": 2180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "103":
    id: "103"
    taskid: 0c74df02-a3f1-44cc-893a-758c112f900a
    type: condition
    task:
      id: 0c74df02-a3f1-44cc-893a-758c112f900a
      version: -1
      name: Verify URL
      description: Verify that the ‘ExtractedIndicators.URL’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "53"
      '#default#':
      - "109"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: ExtractedIndicators
                accessor: URL
            iscontext: true
          right:
            value: {}
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1800,
          "y": 2180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "105":
    id: "105"
    taskid: 96449f54-168e-4471-82e5-2aeebea838a4
    type: regular
    task:
      id: 96449f54-168e-4471-82e5-2aeebea838a4
      version: -1
      name: Verify Context Data Error - Domain
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Domain' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'extractIndicators' automation outputs have been modified and no longer contain the 'ExtractedIndicators.Domain' context key. \n2- The 'text' input configuration was changed for the 'extractIndicators' automation used in the 'Extract Indicators' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 2435
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "107":
    id: "107"
    taskid: 2b621145-99ed-442a-85f2-eb7669364cc8
    type: regular
    task:
      id: 2b621145-99ed-442a-85f2-eb7669364cc8
      version: -1
      name: Verify Context Data Error - File
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'File' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'extractIndicators' automation outputs have been modified and no longer contain the 'ExtractedIndicators.File' context key. \n2- The 'text' input configuration was changed for the 'extractIndicators' automation used in the 'Extract Indicators' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2240,
          "y": 2435
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "108":
    id: "108"
    taskid: 6c1e9ba1-0da2-46dc-8719-8fa44088a9e1
    type: regular
    task:
      id: 6c1e9ba1-0da2-46dc-8719-8fa44088a9e1
      version: -1
      name: Verify Context Data Error - IP
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'IP' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'extractIndicators' automation outputs have been modified and no longer contain the 'ExtractedIndicators.IP' context key. \n2- The 'text' input configuration was changed for the 'extractIndicators' automation used in the 'Extract Indicators' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1350,
          "y": 2435
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "109":
    id: "109"
    taskid: fe92fa63-82d1-487d-810d-4179b7d2ded6
    type: regular
    task:
      id: fe92fa63-82d1-487d-810d-4179b7d2ded6
      version: -1
      name: Verify Context Data Error - URL
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'URL' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'extractIndicators' automation outputs have been modified and no longer contain the 'ExtractedIndicators.URL' context key. \n2- The 'text' input configuration was changed for the 'extractIndicators' automation used in the 'Extract Indicators' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1800,
          "y": 2435
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "112":
    id: "112"
    taskid: 5923f732-1819-4f50-8b41-0088db0a8e16
    type: title
    task:
      id: 5923f732-1819-4f50-8b41-0088db0a8e16
      version: -1
      name: '''PaloAltoNetworksXDR'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "46"
      - "73"
      - "74"
      - "75"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 1410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "113":
    id: "113"
    taskid: aa50ba79-0cb2-4940-88ae-b02632efd95e
    type: title
    task:
      id: aa50ba79-0cb2-4940-88ae-b02632efd95e
      version: -1
      name: Done verifying 'PaloAltoNetworksXDR'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6120,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "114":
    id: "114"
    taskid: a38fd61a-f937-4745-8214-1cc104cb8d9e
    type: regular
    task:
      id: a38fd61a-f937-4745-8214-1cc104cb8d9e
      version: -1
      name: Verify Context Error - File Artifacts
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'PaloAltoNetworksXDR.Incident.file_artifacts' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.Incident.file_artifacts' context key. \n2- The 'incident_id' input configuration was changed for the 'xdr-get-incident-extra-data' automation used in the 'Get Full Incident Details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 1805
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "115":
    id: "115"
    taskid: 227f4b17-1aa7-4b83-8bb1-78b588a8572d
    type: regular
    task:
      id: 227f4b17-1aa7-4b83-8bb1-78b588a8572d
      version: -1
      name: Verify Context Error - Network Artifacts
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'PaloAltoNetworksXDR.Incident.network_artifacts' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.Incident.network_artifacts' context key. \n2- The 'incident_id' input configuration was changed for the 'xdr-get-incident-extra-data' automation used in the 'Get Full Incident Details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1370,
          "y": 1805
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "116":
    id: "116"
    taskid: 45eb7148-387f-4f2f-8755-5e9771049ed0
    type: regular
    task:
      id: 45eb7148-387f-4f2f-8755-5e9771049ed0
      version: -1
      name: Verify Context Data Error - Alerts
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'PaloAltoNetworksXDR.Incident.alerts' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.Incident.alerts' context key. \n2- The 'incident_id' input configuration was changed for the 'xdr-get-incident-extra-data' automation used in the 'Get Full Incident Details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1820,
          "y": 1805
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "117":
    id: "117"
    taskid: eeddd38e-bf5e-4e88-8f25-9caf1a37a0e2
    type: regular
    task:
      id: eeddd38e-bf5e-4e88-8f25-9caf1a37a0e2
      version: -1
      name: Verify Context Data Error - Incident
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'PaloAltoNetworksXDR.Incident' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.Incident' context key. \n2- The 'incident_id' input configuration was changed for the 'xdr-get-incident-extra-data' automation used in the 'Get Full Incident Details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2260,
          "y": 1805
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "125":
    id: "125"
    taskid: f1591573-fcba-4a37-8725-c57363f432e3
    type: regular
    task:
      id: f1591573-fcba-4a37-8725-c57363f432e3
      version: -1
      name: Verify Context Error  - Hostname
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.Hostname’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.Hostname' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task.\n3- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'Endpoint.Hostname' context key. \n4- The 'incident_id' input configuration was changed for the 'xdr-get-incident-extra-data' automation used in the 'Get Full Incident Details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4135,
          "y": 3615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "126":
    id: "126"
    taskid: 27af1765-f345-48a2-8b47-9a7795b015ee
    type: title
    task:
      id: 27af1765-f345-48a2-8b47-9a7795b015ee
      version: -1
      name: Done verifying 'Domain' context
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6130,
          "y": 4130
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "127":
    id: "127"
    taskid: 5b2a4dbb-5e98-4759-8cc0-29314a428d20
    type: title
    task:
      id: 5b2a4dbb-5e98-4759-8cc0-29314a428d20
      version: -1
      name: Done verifying 'Endpoint'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6130,
          "y": 3570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "128":
    id: "128"
    taskid: 47735765-3f60-46e5-8b3f-9d7428779efc
    type: title
    task:
      id: 47735765-3f60-46e5-8b3f-9d7428779efc
      version: -1
      name: Done verifying 'File'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6120,
          "y": 2980
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "131":
    id: "131"
    taskid: 2a6f408f-4b22-47d7-84f0-a6c1b8918059
    type: title
    task:
      id: 2a6f408f-4b22-47d7-84f0-a6c1b8918059
      version: -1
      name: Done verifying 'IP' context
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6120,
          "y": 1230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "132":
    id: "132"
    taskid: ddd100fd-5939-4e5c-8320-9775fb526181
    type: title
    task:
      id: ddd100fd-5939-4e5c-8320-9775fb526181
      version: -1
      name: Check Incident Fields
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "137"
      - "152"
      - "153"
      - "154"
      - "155"
      - "156"
      - "167"
      - "166"
      - "163"
      - "162"
      - "161"
      - "255"
      - "257"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": -540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "136":
    id: "136"
    taskid: 42eb75ed-92aa-41b5-8d53-0199e3d7f98e
    type: title
    task:
      id: 42eb75ed-92aa-41b5-8d53-0199e3d7f98e
      version: -1
      name: Done verifying Incident Fields
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6130,
          "y": -165
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "137":
    id: "137"
    taskid: 267d66de-68ef-45bd-8b2a-7733e8ac17c1
    type: condition
    task:
      id: 267d66de-68ef-45bd-8b2a-7733e8ac17c1
      version: -1
      name: Verify Alerts And Related Info
      description: |-
        Verify that the ‘alertsandrelatedinfo’ incident field was filled out correctly.
        These Incident Field are affecting the incident layouts (grid_id)
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "138"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: incident.alertsandrelatedinfo.alertname
            iscontext: true
          right:
            value:
              complex:
                root: PaloAltoNetworksXDR.Incident.alerts
                accessor: name
            iscontext: true
          ignorecase: true
      - - operator: containsGeneral
          left:
            value:
              simple: incident.alertsandrelatedinfo.hostname
            iscontext: true
          right:
            value:
              complex:
                root: PaloAltoNetworksXDR.Incident.alerts
                accessor: host_name
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "138":
    id: "138"
    taskid: 7a2717b7-ca1b-4ecf-8dd2-dfb0bd2f00bb
    type: regular
    task:
      id: 7a2717b7-ca1b-4ecf-8dd2-dfb0bd2f00bb
      version: -1
      name: Verify Incident Field Error - Alerts And Related Info
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'alertsandrelatedinfo' incident field was not set correctly. This may indicate that the following change has been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:
          1- The 'grid_id' input configuration was changed for the 'SetGridField' automation used in the 'Set Alerts Table Info in the Layout' task.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "140":
    id: "140"
    taskid: f945aad2-4569-42bb-8e21-3b187eb98062
    type: regular
    task:
      id: f945aad2-4569-42bb-8e21-3b187eb98062
      version: -1
      name: Verify Incident Field Error - MD5
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'MD5' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.Incident.alerts.actor_process_image_md5' context key. \n2- The 'MD5' input configuration was changed for the 'setIncident' automation used in the 'Set Process Details To Layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "144":
    id: "144"
    taskid: 6895efa2-5bfe-44e9-8608-7a9d97c2a2db
    type: regular
    task:
      id: 6895efa2-5bfe-44e9-8608-7a9d97c2a2db
      version: -1
      name: Verify Context Error - Email Address
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Account.Email.Address’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'Account Enrichment - Generic v2.1' sub-playbook outputs have been modified and no longer contain the 'Account.Email.Address' context key. \n2- The 'Username' input configuration was changed for the 'Account Enrichment - Generic v2.1' sub-playbook inputs."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 640
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "145":
    id: "145"
    taskid: e30a23bc-843e-40e0-8a63-5444f601ba45
    type: regular
    task:
      id: e30a23bc-843e-40e0-8a63-5444f601ba45
      version: -1
      name: Verify Context Error  - IP Address
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'IP.Address’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'extractIndicators' automation outputs have been modified and no longer contain the 'IP' context key. \n2- The 'text' input configuration was changed for the 'extractIndicators' automation used in the 'Extract Indicators' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 920,
          "y": 1200
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "149":
    id: "149"
    taskid: fa99937d-07fa-49db-8028-29be4dd84832
    type: regular
    task:
      id: fa99937d-07fa-49db-8028-29be4dd84832
      version: -1
      name: Set Incident Fields To Context
      description: Add incident fields required for testing to the mock incident.
      script: Builtin|||setIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "150"
    scriptarguments:
      agentsid:
        simple: aeec6a2cc92e46fab3b6f621722e9916
      alertsandrelatedinfo:
        simple: '[{"columnheader3":""},{},{}]'
      externalsystemid:
        simple: "84"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": -1010
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    fieldMapping:
    - incidentfield: Agents ID
      output:
        simple: aeec6a2cc92e46fab3b6f621722e9916
  "150":
    id: "150"
    taskid: 90b6f990-8a27-4cdd-8c9d-c6dcd9f12f93
    type: playbook
    task:
      id: 90b6f990-8a27-4cdd-8c9d-c6dcd9f12f93
      version: -1
      name: Cortex XDR Malware - Incident Enrichment
      playbookName: Cortex XDR Malware - Incident Enrichment
      type: playbook
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "84"
    scriptarguments:
      IncidentID:
        complex:
          root: incident
          accessor: externalsystemid
    separatecontext: false
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 590,
          "y": -850
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "151":
    id: "151"
    taskid: 3e4359e7-379c-416d-8eb8-2e39ad58ed34
    type: title
    task:
      id: 3e4359e7-379c-416d-8eb8-2e39ad58ed34
      version: -1
      name: Check Context Data
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "63"
      - "67"
      - "112"
      - "39"
      - "64"
      - "69"
      - "278"
      - "65"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": 125
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "152":
    id: "152"
    taskid: 76395ebd-ac4b-4b13-8b6f-1a59538d5acc
    type: condition
    task:
      id: 76395ebd-ac4b-4b13-8b6f-1a59538d5acc
      version: -1
      name: Verify MD5
      description: |
        Verify that the ‘MD5’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "140"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: incident.md5
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "153":
    id: "153"
    taskid: e255dfb4-a8c4-4113-8c26-4783552de815
    type: condition
    task:
      id: e255dfb4-a8c4-4113-8c26-4783552de815
      version: -1
      name: Verify Parent Process File Path
      description: |
        Verify that the ‘parentprocessfilepath’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "157"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: incident.parentprocessfilepath
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1740,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "154":
    id: "154"
    taskid: c5d0de69-f444-468d-89b4-cbe25f47c9dc
    type: condition
    task:
      id: c5d0de69-f444-468d-89b4-cbe25f47c9dc
      version: -1
      name: Verify Process Name
      description: |
        Verify that the ‘processname’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "158"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: incident.processname
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2140,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "155":
    id: "155"
    taskid: de8b9957-d80a-4c14-8679-e4cc1486c47d
    type: condition
    task:
      id: de8b9957-d80a-4c14-8679-e4cc1486c47d
      version: -1
      name: Verify Process Path
      description: |
        Verify that the ‘processpath’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "159"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: incident.processpath
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2540,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "156":
    id: "156"
    taskid: 411b276e-5407-45de-83de-d6c0fb582198
    type: condition
    task:
      id: 411b276e-5407-45de-83de-d6c0fb582198
      version: -1
      name: Verify SHA256
      description: |
        Verify that the ‘SHA256’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "160"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: incident.sha256
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2940,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "157":
    id: "157"
    taskid: d7a5e2d0-6e2c-4016-89a9-bd1ab0b8a741
    type: regular
    task:
      id: d7a5e2d0-6e2c-4016-89a9-bd1ab0b8a741
      version: -1
      name: Verify Incident Field Error - Parent Process File Path
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'parentprocessfilepath' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.Incident.alerts.causality_actor_process_image_path' context key. \n2- The 'parentprocessfilepath' input configuration was changed for the 'setIncident' automation used in the 'Set Process Details To Layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1740,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "158":
    id: "158"
    taskid: 9ffba8d3-e521-45f3-846e-7dee7a17d41b
    type: regular
    task:
      id: 9ffba8d3-e521-45f3-846e-7dee7a17d41b
      version: -1
      name: Verify Incident Field Error - Process Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'processname' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.Incident.alerts.actor_process_image_name' context key. \n2- The 'processname' input configuration was changed for the 'setIncident' automation used in the 'Set Process Details To Layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2140,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "159":
    id: "159"
    taskid: edc1ba6a-2af3-408a-8503-17a118c3a615
    type: regular
    task:
      id: edc1ba6a-2af3-408a-8503-17a118c3a615
      version: -1
      name: Verify Incident Field Error - Process Path
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'processpath' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.Incident.alerts.actor_process_image_path' context key. \n2- The 'processpath' input configuration was changed for the 'setIncident' automation used in the 'Set Process Details To Layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2540,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "160":
    id: "160"
    taskid: cab4db86-4702-4f52-8c05-c107c941fe53
    type: regular
    task:
      id: cab4db86-4702-4f52-8c05-c107c941fe53
      version: -1
      name: Verify Incident Field Error - SHA256
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'sha256' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.Incident.alerts.actor_process_image_sha256' context key. \n2- The 'sha256' input configuration was changed for the 'setIncident' automation used in the 'Set Process Details To Layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2940,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "161":
    id: "161"
    taskid: 48d35370-b125-4d5f-8b8a-29bf3a33317b
    type: condition
    task:
      id: 48d35370-b125-4d5f-8b8a-29bf3a33317b
      version: -1
      name: Verify Account Member Of
      description: |
        Verify that the ‘accountmemberof’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "168"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: incident
                accessor: accountmemberof
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3350,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "162":
    id: "162"
    taskid: 5f248e72-2e28-426f-8d3f-993f84dafe73
    type: condition
    task:
      id: 5f248e72-2e28-426f-8d3f-993f84dafe73
      version: -1
      name: Verify Account Name
      description: |
        Verify that the ‘accountname’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "169"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: incident
                accessor: accountname
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3755,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "163":
    id: "163"
    taskid: b3e71671-fe8a-4ac7-8d5d-32f1e34a66c1
    type: condition
    task:
      id: b3e71671-fe8a-4ac7-8d5d-32f1e34a66c1
      version: -1
      name: Verify Account Status
      description: |
        Verify that the ‘accountstatus’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "170"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: incident
                accessor: accountstatus
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4150,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "166":
    id: "166"
    taskid: c8a18239-538d-47b4-8126-4bd2ad1f8f49
    type: condition
    task:
      id: c8a18239-538d-47b4-8126-4bd2ad1f8f49
      version: -1
      name: Verify Manager Name
      description: |
        Verify that the ‘managername’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "173"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: incident
                accessor: managername
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4550,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "167":
    id: "167"
    taskid: 5a522415-68a9-480b-8b9d-c8e415a498cb
    type: condition
    task:
      id: 5a522415-68a9-480b-8b9d-c8e415a498cb
      version: -1
      name: Verify SAM Account Name
      description: |
        Verify that the ‘samaccountname’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "174"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: incident
                accessor: samaccountname
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4950,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "168":
    id: "168"
    taskid: 5e866a2b-4f43-4922-8f16-30f3a78c8b0e
    type: regular
    task:
      id: 5e866a2b-4f43-4922-8f16-30f3a78c8b0e
      version: -1
      name: Verify Incident Field Error - Account Member Of
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'accountmemberof' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'Account Enrichment - Generic v2.1' sub-playbook outputs have been modified and no longer contain the 'Account.Groups' context key. \n2- The 'accountmemberof' input configuration was changed for the 'setIncident' automation used in the 'Set Account information to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3350,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "169":
    id: "169"
    taskid: 981d12a4-2e19-4163-8453-5fdce1478f4b
    type: regular
    task:
      id: 981d12a4-2e19-4163-8453-5fdce1478f4b
      version: -1
      name: Verify Incident Field Error - Account Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'accountname' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'Account Enrichment - Generic v2.1' sub-playbook outputs have been modified and no longer contain the 'Account.DisplayName' context key. \n2- The 'accountname' input configuration was changed for the 'setIncident' automation used in the 'Set Account information to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3750,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "170":
    id: "170"
    taskid: bf7dfa4a-9872-4444-8c6b-767e15f88c9b
    type: regular
    task:
      id: bf7dfa4a-9872-4444-8c6b-767e15f88c9b
      version: -1
      name: Verify Incident Field Error - Account Status
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'accountstatus' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'Account Enrichment - Generic v2.1' sub-playbook outputs have been modified and no longer contain the 'Account.Status' context key. \n2- The 'accountstatus' input configuration was changed for the 'setIncident' automation used in the 'Set Account information to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4150,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "173":
    id: "173"
    taskid: 11e6ca3b-279d-4303-807d-66de99d9d0c9
    type: regular
    task:
      id: 11e6ca3b-279d-4303-807d-66de99d9d0c9
      version: -1
      name: Verify Incident Field Error - Manager Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'managername' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'Account Enrichment - Generic v2.1' sub-playbook outputs have been modified and no longer contain the 'Account.Manager' context key. \n2- The 'managername' input configuration was changed for the 'setIncident' automation used in the 'Set Account information to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4560,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "174":
    id: "174"
    taskid: 0d3e8311-f7c4-4336-8a81-75a90ced11a9
    type: regular
    task:
      id: 0d3e8311-f7c4-4336-8a81-75a90ced11a9
      version: -1
      name: Verify Incident Field Error - SAM Account Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'samaccountname' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'Account Enrichment - Generic v2.1' sub-playbook outputs have been modified and no longer contain the 'Account.Username' context key. \n2- The 'samaccountname' input configuration was changed for the 'setIncident' automation used in the 'Set Account information to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4950,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "198":
    id: "198"
    taskid: db46fa24-52e1-411d-8021-47dba9679036
    type: title
    task:
      id: db46fa24-52e1-411d-8021-47dba9679036
      version: -1
      name: Done verifying 'Account'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6120,
          "y": 630
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "199":
    id: "199"
    taskid: 700fa90e-c2b3-4a42-82d3-ae2a0f83b2b6
    type: condition
    task:
      id: 700fa90e-c2b3-4a42-82d3-ae2a0f83b2b6
      version: -1
      name: Verify Hostname
      description: Verify that the 'Endpoint.Hostname’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "125"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: Endpoint
                accessor: Hostname
            iscontext: true
          right:
            value:
              complex:
                root: PaloAltoNetworksXDR.Incident.alerts
                accessor: host_name
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4135,
          "y": 3370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "200":
    id: "200"
    taskid: 3ef0258c-0cd3-4636-8005-782c28ecd9f9
    type: condition
    task:
      id: 3ef0258c-0cd3-4636-8005-782c28ecd9f9
      version: -1
      name: Verify Is Isolated
      description: Verify that the 'Endpoint.IsIsolated’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "201"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: Endpoint
                accessor: IsIsolated
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: isolated
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3735,
          "y": 3370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "201":
    id: "201"
    taskid: a2ce2926-0079-4cc6-874f-120ba47aaf7e
    type: regular
    task:
      id: a2ce2926-0079-4cc6-874f-120ba47aaf7e
      version: -1
      name: Verify Context Error  -  Is Isolated
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.IsIsolated’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.IsIsolated' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3735,
          "y": 3615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "202":
    id: "202"
    taskid: 141701f2-4890-4adc-8875-52db74dc0846
    type: condition
    task:
      id: 141701f2-4890-4adc-8875-52db74dc0846
      version: -1
      name: Verify Domain
      description: Verify that the 'Endpoint.Domain’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "209"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: Endpoint
                accessor: Domain
            iscontext: true
          right:
            value: {}
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3335,
          "y": 3370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "203":
    id: "203"
    taskid: d279ebe7-7956-4057-8cd1-0fd46d14a927
    type: condition
    task:
      id: d279ebe7-7956-4057-8cd1-0fd46d14a927
      version: -1
      name: Verify OS
      description: Verify that the 'Endpoint.OS’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "210"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: Endpoint
                accessor: OS
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: deviceosname
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2935,
          "y": 3370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "204":
    id: "204"
    taskid: 880c3f6e-eb18-4c3d-82cc-df8709252ce6
    type: condition
    task:
      id: 880c3f6e-eb18-4c3d-82cc-df8709252ce6
      version: -1
      name: Verify MAC Address
      description: Verify that the 'Endpoint.MACAddress’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "211"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: Endpoint
                accessor: MACAddress
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: devicemacaddress
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2545,
          "y": 3370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "205":
    id: "205"
    taskid: b5f0bb49-38aa-47e8-89e3-f3de7f5d0742
    type: condition
    task:
      id: b5f0bb49-38aa-47e8-89e3-f3de7f5d0742
      version: -1
      name: Verify Vendor
      description: Verify that the 'Endpoint.Vendor’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "212"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: Endpoint
                accessor: Vendor
            iscontext: true
          right:
            value: {}
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2135,
          "y": 3370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "206":
    id: "206"
    taskid: da9f2b4f-fab6-4a50-8fe5-700c5e12a16a
    type: condition
    task:
      id: da9f2b4f-fab6-4a50-8fe5-700c5e12a16a
      version: -1
      name: Verify IP Address
      description: Verify that the 'Endpoint.IPAddress’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "213"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: Endpoint
                accessor: IPAddress
            iscontext: true
          right:
            value:
              complex:
                root: PaloAltoNetworksXDR.Incident.alerts
                accessor: host_ip
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1735,
          "y": 3370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "207":
    id: "207"
    taskid: b9c2a081-bdc7-4265-8af0-13cf6d11b1da
    type: condition
    task:
      id: b9c2a081-bdc7-4265-8af0-13cf6d11b1da
      version: -1
      name: Verify Status
      description: Verify that the 'Endpoint.Status’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "214"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: Endpoint
                accessor: Status
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: devicestatus
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1335,
          "y": 3370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "208":
    id: "208"
    taskid: 8c9a0786-eb14-4e33-87dc-abe54d371f94
    type: condition
    task:
      id: 8c9a0786-eb14-4e33-87dc-abe54d371f94
      version: -1
      name: Verify ID
      description: Verify that the 'Endpoint.ID’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "215"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: Endpoint
                accessor: ID
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: deviceid
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 3370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "209":
    id: "209"
    taskid: f766e300-9ec7-4ab1-87dd-fbbbf2ee2177
    type: regular
    task:
      id: f766e300-9ec7-4ab1-87dd-fbbbf2ee2177
      version: -1
      name: Verify Context Error  -  Domain
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.Domain’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.Domain' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3335,
          "y": 3615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "210":
    id: "210"
    taskid: fb71d61b-197d-472b-8aab-c4eb8be07c93
    type: regular
    task:
      id: fb71d61b-197d-472b-8aab-c4eb8be07c93
      version: -1
      name: Verify Context Error  -  OS
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.OS’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.OS' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2925,
          "y": 3615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "211":
    id: "211"
    taskid: 05e492a0-68cb-4453-8c57-8eb18ac9e9b4
    type: regular
    task:
      id: 05e492a0-68cb-4453-8c57-8eb18ac9e9b4
      version: -1
      name: Verify Context Error  - MAC Address
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.MACAddress’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.MACAddress' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2525,
          "y": 3615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "212":
    id: "212"
    taskid: 7e0dd2cf-4b60-487e-8983-9f791221aa00
    type: regular
    task:
      id: 7e0dd2cf-4b60-487e-8983-9f791221aa00
      version: -1
      name: Verify Context Error  - Vendor
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.Vendor’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.Vendor' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2125,
          "y": 3615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "213":
    id: "213"
    taskid: af55221a-ac35-44f6-8496-4c122eea8d62
    type: regular
    task:
      id: af55221a-ac35-44f6-8496-4c122eea8d62
      version: -1
      name: Verify Context Error  - IP Address
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.IPAddress’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.IPAddress' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1725,
          "y": 3610
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "214":
    id: "214"
    taskid: 46f42827-5f05-4b8f-86ab-23a8ed60625f
    type: regular
    task:
      id: 46f42827-5f05-4b8f-86ab-23a8ed60625f
      version: -1
      name: Verify Context Error  - Status
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.Status’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.Status' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1335,
          "y": 3615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "215":
    id: "215"
    taskid: 49121efe-6196-444c-82e8-5d920a964e4a
    type: regular
    task:
      id: 49121efe-6196-444c-82e8-5d920a964e4a
      version: -1
      name: Verify Context Error  - ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.ID’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.ID' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 3615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "218":
    id: "218"
    taskid: 4dea1620-de44-4393-8b43-1631143e0b36
    type: condition
    task:
      id: 4dea1620-de44-4393-8b43-1631143e0b36
      version: -1
      name: Verify SHA265
      description: Verify that the 'File.SHA256’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "219"
      Verified:
      - "128"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: File
                accessor: SHA256
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: filesha256
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1335,
          "y": 2795
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "219":
    id: "219"
    taskid: 13642c70-f6bc-4728-8cbf-ab683819ef58
    type: regular
    task:
      id: 13642c70-f6bc-4728-8cbf-ab683819ef58
      version: -1
      name: Verify Context Error - SHA265
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'File.SHA256’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'File.SHA256' context key. \n2- The 'incident_id' input configuration was changed for the 'xdr-get-incident-extra-data' automation used in the 'Get Full Incident Details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1335,
          "y": 3015
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "220":
    id: "220"
    taskid: 9f86fbac-9e98-4d56-80a3-81cc31c0c055
    type: condition
    task:
      id: 9f86fbac-9e98-4d56-80a3-81cc31c0c055
      version: -1
      name: Verify Name
      description: Verify that the 'File.Name’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "221"
      Verified:
      - "128"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: File
                accessor: Name
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: filenames
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 2795
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "221":
    id: "221"
    taskid: 3c5664b9-8856-46ed-850b-3f392e7ad1f8
    type: regular
    task:
      id: 3c5664b9-8856-46ed-850b-3f392e7ad1f8
      version: -1
      name: Verify Context Error - Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'File.Name’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'File.Name' context key. \n2- The 'incident_id' input configuration was changed for the 'xdr-get-incident-extra-data' automation used in the 'Get Full Incident Details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 3015
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "255":
    id: "255"
    taskid: 8fc16bdc-4e66-4380-8c02-0a7aa8ab63ef
    type: condition
    task:
      id: 8fc16bdc-4e66-4380-8c02-0a7aa8ab63ef
      version: -1
      name: Verify Hostnames
      description: |
        Verify that the ‘hostnames’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "256"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: hostnames
            iscontext: true
          right:
            value:
              complex:
                root: PaloAltoNetworksXDR.Incident.alerts
                accessor: host_name
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5360,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "256":
    id: "256"
    taskid: 067ec247-59bc-45af-890f-18e541e33b75
    type: regular
    task:
      id: 067ec247-59bc-45af-890f-18e541e33b75
      version: -1
      name: Verify Incident Field Error - Hostnames
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Hostnames' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.Incident.alerts.host_name' context key. \n2- The 'incident_id' input configuration was changed for the 'xdr-get-incident-extra-data' automation used in the 'Get Full Incident Details' task.\n3- The custom output mapping rule for the 'Hostnames' incident field configured within the 'Get Full Incident Details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5360,
          "y": -90
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "257":
    id: "257"
    taskid: 272a0e81-8ac7-4ea9-8da5-6b77ca72f5fb
    type: condition
    task:
      id: 272a0e81-8ac7-4ea9-8da5-6b77ca72f5fb
      version: -1
      name: Verify Detected Users
      description: |
        Verify that the ‘detectedusers’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "258"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: incident
                accessor: detectedusers
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5760,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "258":
    id: "258"
    taskid: 3e0237aa-035e-482d-87d5-365de912c33e
    type: regular
    task:
      id: 3e0237aa-035e-482d-87d5-365de912c33e
      version: -1
      name: Verify Incident Field Error - Detected Users
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'detectedusers' incident field was not set correctly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'xdr-get-incident-extra-data' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.Incident.alerts.user_name' context key. \n2- The 'incident_id' input configuration was changed for the 'xdr-get-incident-extra-data' automation used in the 'Get Full Incident Details' task.\n3- The custom output mapping rule for the 'detectedusers' incident field configured within the 'Get Full Incident Details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5760,
          "y": -85
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "265":
    id: "265"
    taskid: 5a26e90f-71d6-4cd3-891d-5e39fb2b1248
    type: condition
    task:
      id: 5a26e90f-71d6-4cd3-891d-5e39fb2b1248
      version: -1
      name: Verify Context - Name
      description: Verify that the 'Domain.Name’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "266"
      Verified:
      - "126"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Domain
                accessor: Name
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 3920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "266":
    id: "266"
    taskid: a0a4b664-4bc2-4bf4-8e1a-61e78a83b312
    type: regular
    task:
      id: a0a4b664-4bc2-4bf4-8e1a-61e78a83b312
      version: -1
      name: Verify Context Error  - Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Domain.Name’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'extractIndicators' automation outputs have been modified and no longer contain the 'Domain' context key. \n2- The 'text' input configuration was changed for the 'extractIndicators' automation used in the 'Extract Indicators' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 4150
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "277":
    id: "277"
    taskid: 819a49d9-83b8-49b8-8531-aa5eec456e53
    type: title
    task:
      id: 819a49d9-83b8-49b8-8531-aa5eec456e53
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6400,
          "y": 4830
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "278":
    id: "278"
    taskid: a6edcad8-2ef3-4ead-8e29-3c1e40c240ac
    type: title
    task:
      id: a6edcad8-2ef3-4ead-8e29-3c1e40c240ac
      version: -1
      name: '''URL'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "290"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 4360
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "281":
    id: "281"
    taskid: ed8dbe1b-7c32-4b64-8a64-5b93bd09832a
    type: title
    task:
      id: ed8dbe1b-7c32-4b64-8a64-5b93bd09832a
      version: -1
      name: Done verifying 'URL'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6130,
          "y": 4685
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "290":
    id: "290"
    taskid: 947d5c55-8204-4d01-80cb-95bfd9a0547e
    type: condition
    task:
      id: 947d5c55-8204-4d01-80cb-95bfd9a0547e
      version: -1
      name: Verify Data
      description: Verify that the 'URL.Data’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "291"
      Verified:
      - "281"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: URL
                accessor: Data
            iscontext: true
          right:
            value:
              complex:
                root: ExtractedIndicators
                accessor: URL
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 4495
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "291":
    id: "291"
    taskid: f713476f-9c90-4ee5-865d-a638a4b3bd49
    type: regular
    task:
      id: f713476f-9c90-4ee5-865d-a638a4b3bd49
      version: -1
      name: Verify Context Error - Data
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'URL.Data’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Incident Enrichment' playbook:\n1- The 'extractIndicators' automation outputs have been modified and no longer contain the 'URL' context key. \n2- The 'text' input configuration was changed for the 'extractIndicators' automation used in the 'Extract Indicators' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 4715
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "101_53_ Verified": 0.1,
      "102_53_ Verified": 0.11,
      "103_53_ Verified": 0.1,
      "137_136_Verified": 0.1,
      "152_136_Verified": 0.1,
      "40_53_Verified": 0.1,
      "46_113_Verified": 0.1,
      "73_116_#default#": 0.7,
      "74_113_ Verified": 0.12,
      "75_113_ Verified": 0.1
    },
    "paper": {
      "dimensions": {
        "height": 6200,
        "width": 6190,
        "x": 590,
        "y": -1305
      }
    }
  }
inputs: []
outputs: []
fromversion: 6.5.0