id: Test Playbook - Cortex XDR Malware - Investigation And Response
version: -1
name: Test Playbook - Cortex XDR Malware - Investigation And Response
description: "This playbook tests the 'Cortex XDR Malware - Investigation And Response' playbook which is part of the 'Malware Investigation and Response' pack.\n\nFollowing are the tests conducted in the playbook:\n1- Confirm that incident fields were populated correctly by the custom output mapping rules and the 'setIncident' automation. \n2- Ensure that the context data was properly extracted.\n5- Validate the outputs of the playbook."
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 88fab29e-cb56-4abc-8dac-413e6dc12943
    type: start
    task:
      id: 88fab29e-cb56-4abc-8dac-413e6dc12943
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "32"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 210,
          "y": -815
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: 18604a7a-3279-41ad-881e-b4d704e67bce
    type: regular
    task:
      id: 18604a7a-3279-41ad-881e-b4d704e67bce
      version: -1
      name: Delete Context
      description: The task deletes all of the context data. Having a clean beginning to a test playbook ensures that a test can be sterile and that unrelated issues can be eliminated.
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "252"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 210,
          "y": -685
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "84":
    id: "84"
    taskid: 7d4f9fa2-5036-430f-8413-36f2d0890038
    type: title
    task:
      id: 7d4f9fa2-5036-430f-8413-36f2d0890038
      version: -1
      name: Start Testing
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "283"
      - "259"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 210,
          "y": -200
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "202":
    id: "202"
    taskid: 735edae3-9c5e-46be-86f9-9bda3b728320
    type: title
    task:
      id: 735edae3-9c5e-46be-86f9-9bda3b728320
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6050,
          "y": 2220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "252":
    id: "252"
    taskid: 82c5864d-49e3-4b05-85c7-1111844d0d1f
    type: regular
    task:
      id: 82c5864d-49e3-4b05-85c7-1111844d0d1f
      version: -1
      name: Set Incident Fields To Context
      description: Add incident fields required for testing to the mock incident.
      script: Builtin|||setIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "310"
    scriptarguments:
      alertsandrelatedinfo:
        simple: '[{"columnheader3":""},{},{}]'
      deviceid:
        simple: aeec6a2cc92e46fab3b6f621722e9916
      externalsystemid:
        simple: "61"
      type:
        simple: Malware Investigation and Response
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 210,
          "y": -520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "259":
    id: "259"
    taskid: df687a07-7862-485d-8031-559bae0a316c
    type: title
    task:
      id: df687a07-7862-485d-8031-559bae0a316c
      version: -1
      name: Check Incident Fields
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "260"
      - "387"
      - "389"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 600,
          "y": -60
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "260":
    id: "260"
    taskid: 6e1472ac-aa05-4c08-87ca-7b156c6ae9c5
    type: condition
    task:
      id: 6e1472ac-aa05-4c08-87ca-7b156c6ae9c5
      version: -1
      name: Verify Tags
      description: Verify that the 'foundIndicators' tag was set to the incident 'tags' field.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "269"
      Verified:
      - "284"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: incident
                accessor: tags
            iscontext: true
          right:
            value:
              simple: foundIndicators
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 600,
          "y": 80
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "269":
    id: "269"
    taskid: 29a67334-3033-4d90-8ad0-2a010bcbbb35
    type: regular
    task:
      id: 29a67334-3033-4d90-8ad0-2a010bcbbb35
      version: -1
      name: Verify Incident Field Error - Tags
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'foundIndicators' tag was not set to the incident 'tags' field. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Investigation And Response' playbook:
          1- The 'tags' input configuration was changed for the 'setIncident' automation used in the 'Set Tag Suspicious Command-line' task.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 600,
          "y": 310
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "283":
    id: "283"
    taskid: ebe627b5-3750-4099-82e6-4a8ea713c7e4
    type: title
    task:
      id: ebe627b5-3750-4099-82e6-4a8ea713c7e4
      version: -1
      name: Check Context Data
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "371"
      - "337"
      - "286"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 210,
          "y": 405
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "284":
    id: "284"
    taskid: 6076d714-2b2a-4696-82e1-f4505a7b64d3
    type: title
    task:
      id: 6076d714-2b2a-4696-82e1-f4505a7b64d3
      version: -1
      name: Done verifying Incident fields
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "202"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5790,
          "y": 255
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "286":
    id: "286"
    taskid: 4d83b2ea-f7d6-4162-8b03-78de849ab900
    type: title
    task:
      id: 4d83b2ea-f7d6-4162-8b03-78de849ab900
      version: -1
      name: '''PaloAltoNetworksXDR.ScriptResult'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "300"
      - "311"
      - "313"
      - "315"
      - "317"
      - "319"
      - "321"
      - "323"
      - "325"
      - "327"
      - "329"
      - "333"
      - "335"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 610,
          "y": 1760
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "300":
    id: "300"
    taskid: 5ebed11c-6765-44ce-8b56-1682b08a35e7
    type: condition
    task:
      id: 5ebed11c-6765-44ce-8b56-1682b08a35e7
      version: -1
      name: Verify Action ID
      description: Verify that the 'PaloAltoNetworksXDR.ScriptResult.action_id’ context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "305"
      Verified:
      - "306"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.ScriptResult
                accessor: action_id
            iscontext: true
          right:
            value: {}
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 610,
          "y": 1905
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "305":
    id: "305"
    taskid: b99bff44-60e1-41cf-8b6c-2632aa37ec1f
    type: regular
    task:
      id: b99bff44-60e1-41cf-8b6c-2632aa37ec1f
      version: -1
      name: Verify Context Data Error  - Action ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'PaloAltoNetworksXDR.ScriptResult.action_id’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Investigation And Response' playbook:
          1- The 'Get Device's Process List' task failed.
          2- The 'xdr-script-run' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.ScriptResult.action_id' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 610,
          "y": 2125
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "306":
    id: "306"
    taskid: d413878f-2712-469a-80b5-0bb288d78cfe
    type: title
    task:
      id: d413878f-2712-469a-80b5-0bb288d78cfe
      version: -1
      name: Done Verifying 'PaloAltoNetworksXDR.ScriptResult' Context Data
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "202"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5790,
          "y": 2075
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "310":
    id: "310"
    taskid: 95d5e083-6261-411c-8403-137fa152d111
    type: playbook
    task:
      id: 95d5e083-6261-411c-8403-137fa152d111
      version: -1
      name: Cortex XDR Malware - Investigation And Response
      description: "This playbook is part of the 'Malware Investigation And Response' pack. For more information, refer to https://xsoar.pan.dev/docs/reference/packs/malware-investigation-and-response.\nThis playbook investigates Cortex XDR malware incidents. It uses:\n - Cortex XDR insights \n - Command Line Analysis \n - Dedup \n - Sandbox hash search and detonation \n - Cortex XDR enrichment \n - Incident Handling (True/False Positive)"
      playbookName: Cortex XDR Malware - Investigation And Response
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "84"
    scriptarguments:
      AdvancedHunting:
        simple: "False"
      AutoIsolation:
        simple: "False"
      AutoUnisolation:
        simple: "False"
      BenignTagName:
        simple: BenignTagName
      DedupCloseSimilar:
        simple: "0.9"
      DedupHandleSimilar:
        simple: Link
      DedupLimit:
        simple: "200"
      DedupMinimunIncidentSimilarity:
        simple: "0.2"
      DedupSimilarTextField:
        simple: agnetsid,users,agentsid,CMDline,Hostnames,filenames,filepaths
      DetonateFile:
        simple: "False"
      EnableClosureSteps:
        simple: "False"
      EnableDeduplication:
        simple: "False"
      MaliciousTagName:
        simple: MaliciousTagName
      RetrieveFile:
        simple: "False"
      RunAllHuntMitreTactics:
        simple: "False"
    separatecontext: false
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 210,
          "y": -360
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "311":
    id: "311"
    taskid: a83701ce-2064-46a8-8902-5f2f37b0a59c
    type: condition
    task:
      id: a83701ce-2064-46a8-8902-5f2f37b0a59c
      version: -1
      name: Verify Retrieved Files
      description: Verify that the 'PaloAltoNetworksXDR.ScriptResult.retrieved_files’ context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "312"
      Verified:
      - "306"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.ScriptResult.results
                accessor: retrieved_files
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1010,
          "y": 1905
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "312":
    id: "312"
    taskid: 71d264cd-f0b3-4845-8f80-3be3341a6f1c
    type: regular
    task:
      id: 71d264cd-f0b3-4845-8f80-3be3341a6f1c
      version: -1
      name: Verify Context Data Error - Retrieved Files
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'PaloAltoNetworksXDR.ScriptResult.retrieved_files’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Investigation And Response' playbook:
          1- The 'Get Device's Process List' task failed.
          2- The 'xdr-script-run' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.ScriptResult.retrieved_files' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1010,
          "y": 2125
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "313":
    id: "313"
    taskid: 87d74a2e-7f6c-41f6-83c9-e89356118520
    type: condition
    task:
      id: 87d74a2e-7f6c-41f6-83c9-e89356118520
      version: -1
      name: Verify Endpoint IP Address
      description: Verify that the 'PaloAltoNetworksXDR.ScriptResult.endpoint_ip_address’ context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "314"
      Verified:
      - "306"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.ScriptResult.results
                accessor: endpoint_ip_address
            iscontext: true
          right:
            value:
              simple: 192.168.1.143
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1410,
          "y": 1905
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "314":
    id: "314"
    taskid: e6ab0f9e-538c-48b2-800e-bec6400c5986
    type: regular
    task:
      id: e6ab0f9e-538c-48b2-800e-bec6400c5986
      version: -1
      name: Verify Context Data Error - Endpoint IP Address
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'PaloAltoNetworksXDR.ScriptResult.endpoint_ip_address’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Investigation And Response' playbook:
          1- The 'Get Device's Process List' task failed.
          2- The 'xdr-script-run' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.ScriptResult.endpoint_ip_address' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1410,
          "y": 2125
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "315":
    id: "315"
    taskid: 960f175c-3a77-46d2-8167-bda3dde3e2c5
    type: condition
    task:
      id: 960f175c-3a77-46d2-8167-bda3dde3e2c5
      version: -1
      name: Verify Endpoint Name
      description: Verify that the 'PaloAltoNetworksXDR.ScriptResult.endpoint_name’ context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "316"
      Verified:
      - "306"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.ScriptResult.results
                accessor: endpoint_name
            iscontext: true
          right:
            value:
              simple: WIN10X64
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1810,
          "y": 1905
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "316":
    id: "316"
    taskid: 0c44488c-14c2-45a7-82f4-bb32d9a543b8
    type: regular
    task:
      id: 0c44488c-14c2-45a7-82f4-bb32d9a543b8
      version: -1
      name: Verify Context Data Error - Endpoint Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'PaloAltoNetworksXDR.ScriptResult.endpoint_name’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Investigation And Response' playbook:
          1- The 'Get Device's Process List' task failed.
          2- The 'xdr-script-run' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.ScriptResult.endpoint_name' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1810,
          "y": 2125
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "317":
    id: "317"
    taskid: f95a4343-1e82-4f1a-8ee0-a9e3baf65c01
    type: condition
    task:
      id: f95a4343-1e82-4f1a-8ee0-a9e3baf65c01
      version: -1
      name: Verify Failed Files
      description: Verify that the 'PaloAltoNetworksXDR.ScriptResult.failed_files’ context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "318"
      Verified:
      - "306"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.ScriptResult.results
                accessor: failed_files
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2210,
          "y": 1905
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "318":
    id: "318"
    taskid: 80c21f74-08c1-4939-87ef-3891a555a1b3
    type: regular
    task:
      id: 80c21f74-08c1-4939-87ef-3891a555a1b3
      version: -1
      name: Verify Context Data Error - Failed Files
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'PaloAltoNetworksXDR.ScriptResult.failed_files' context key was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Investigation And Response' playbook:
          1- The 'Get Device's Process List' task failed.
          2- The 'xdr-script-run' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.ScriptResult.failed_files' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2210,
          "y": 2125
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "319":
    id: "319"
    taskid: 17d57900-e4b5-4535-8931-9f655e3b2a4f
    type: condition
    task:
      id: 17d57900-e4b5-4535-8931-9f655e3b2a4f
      version: -1
      name: Verify Endpoint Status
      description: Verify that the 'PaloAltoNetworksXDR.ScriptResult.endpoint_status’ context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "320"
      Verified:
      - "306"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.ScriptResult.results
                accessor: endpoint_status
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2620,
          "y": 1905
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "320":
    id: "320"
    taskid: a1885a85-3208-4ab8-88ce-1926b69fb0a3
    type: regular
    task:
      id: a1885a85-3208-4ab8-88ce-1926b69fb0a3
      version: -1
      name: Verify Context Data Error - Endpoint Status
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'PaloAltoNetworksXDR.ScriptResult.endpoint_status' context key was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Investigation And Response' playbook:
          1- The 'Get Device's Process List' task failed.
          2- The 'xdr-script-run' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.ScriptResult.endpoint_status' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2620,
          "y": 2125
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "321":
    id: "321"
    taskid: 66c9e31f-2b99-452e-8c99-3a2245929adb
    type: condition
    task:
      id: 66c9e31f-2b99-452e-8c99-3a2245929adb
      version: -1
      name: Verify Domain
      description: Verify that the 'PaloAltoNetworksXDR.ScriptResult.domain’ context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "322"
      Verified:
      - "306"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.ScriptResult.results
                accessor: domain
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3020,
          "y": 1905
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "322":
    id: "322"
    taskid: 2d088650-f46e-4ddd-8166-75c7a08e7645
    type: regular
    task:
      id: 2d088650-f46e-4ddd-8166-75c7a08e7645
      version: -1
      name: Verify Context Data Error - Domain
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'PaloAltoNetworksXDR.ScriptResult.domain' context key was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Investigation And Response' playbook:
          1- The 'Get Device's Process List' task failed.
          2- The 'xdr-script-run' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.ScriptResult.domain' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3020,
          "y": 2125
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "323":
    id: "323"
    taskid: 4ec569be-33eb-4e13-81bb-a2d35549e970
    type: condition
    task:
      id: 4ec569be-33eb-4e13-81bb-a2d35549e970
      version: -1
      name: Verify Endpoint ID
      description: Verify that the 'PaloAltoNetworksXDR.ScriptResult.endpoint_id’ context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "324"
      Verified:
      - "306"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.ScriptResult.results
                accessor: endpoint_id
            iscontext: true
          right:
            value:
              complex:
                root: incident
                accessor: deviceid
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3420,
          "y": 1905
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "324":
    id: "324"
    taskid: 9c4e1348-c821-40b7-8ab9-074315dc66be
    type: regular
    task:
      id: 9c4e1348-c821-40b7-8ab9-074315dc66be
      version: -1
      name: Verify Context Data Error - Endpoint ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'PaloAltoNetworksXDR.ScriptResult.endpoint_id' context key was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Investigation And Response' playbook:
          1- The 'Get Device's Process List' task failed.
          2- The 'xdr-script-run' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.ScriptResult.endpoint_id' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3420,
          "y": 2125
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "325":
    id: "325"
    taskid: 33cecfac-12cb-47e1-8417-77a255d40e1b
    type: condition
    task:
      id: 33cecfac-12cb-47e1-8417-77a255d40e1b
      version: -1
      name: Verify Execution Status
      description: Verify that the 'PaloAltoNetworksXDR.ScriptResult.execution_status’ context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "326"
      Verified:
      - "306"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.ScriptResult.results
                accessor: execution_status
            iscontext: true
          right:
            value:
              simple: COMPLETED_SUCCESSFULLY
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3820,
          "y": 1905
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "326":
    id: "326"
    taskid: 155a5533-112e-4ff3-80b5-af46fc3fcfe1
    type: regular
    task:
      id: 155a5533-112e-4ff3-80b5-af46fc3fcfe1
      version: -1
      name: Verify Context Data Error - Execution Status
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'PaloAltoNetworksXDR.ScriptResult.execution_status' context key was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Investigation And Response' playbook:
          1- The 'Get Device's Process List' task failed.
          2- The 'xdr-script-run' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.ScriptResult.execution_status' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3820,
          "y": 2125
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "327":
    id: "327"
    taskid: 95055c8c-44b9-4efa-80c4-0580f3957b98
    type: condition
    task:
      id: 95055c8c-44b9-4efa-80c4-0580f3957b98
      version: -1
      name: Verify Return Value
      description: Verify that the 'PaloAltoNetworksXDR.ScriptResult.return_value’ context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "328"
      Verified:
      - "306"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.ScriptResult.results
                accessor: _return_value
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4220,
          "y": 1905
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "328":
    id: "328"
    taskid: af88bd98-06d5-4e38-8cdf-efacd8ca8fcd
    type: regular
    task:
      id: af88bd98-06d5-4e38-8cdf-efacd8ca8fcd
      version: -1
      name: Verify Context Data Error - Return Value
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'PaloAltoNetworksXDR.ScriptResult.return_value' context key was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Investigation And Response' playbook:
          1- The 'Get Device's Process List' task failed.
          2- The 'xdr-script-run' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.ScriptResult.return_value' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4220,
          "y": 2125
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "329":
    id: "329"
    taskid: 6e28790b-a3c7-46cc-8f97-bf2680944004
    type: condition
    task:
      id: 6e28790b-a3c7-46cc-8f97-bf2680944004
      version: -1
      name: Verify Standard Output
      description: Verify that the 'PaloAltoNetworksXDR.ScriptResult.standard_output’ context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "330"
      Verified:
      - "306"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.ScriptResult.results
                accessor: standard_output
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4620,
          "y": 1905
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "330":
    id: "330"
    taskid: 52917334-4787-4dda-8b3e-953ffe9caad3
    type: regular
    task:
      id: 52917334-4787-4dda-8b3e-953ffe9caad3
      version: -1
      name: Verify Context Data Error - Standard Output
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'PaloAltoNetworksXDR.ScriptResult.standard_output' context key was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Investigation And Response' playbook:
          1- The 'Get Device's Process List' task failed.
          2- The 'xdr-script-run' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.ScriptResult.standard_output' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4620,
          "y": 2125
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "333":
    id: "333"
    taskid: 3247a14e-88ea-4d87-84e0-6121fc55fd8e
    type: condition
    task:
      id: 3247a14e-88ea-4d87-84e0-6121fc55fd8e
      version: -1
      name: Verify Command
      description: Verify that the 'PaloAltoNetworksXDR.ScriptResult.results.command’ context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "334"
      Verified:
      - "306"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.ScriptResult.results
                accessor: command
            iscontext: true
          right:
            value:
              simple: _return_value
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5010,
          "y": 1905
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "334":
    id: "334"
    taskid: edcb24f8-c48b-4fa9-8cc1-ee4e5b09f1ec
    type: regular
    task:
      id: edcb24f8-c48b-4fa9-8cc1-ee4e5b09f1ec
      version: -1
      name: Verify Context Data Error - Command
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'PaloAltoNetworksXDR.ScriptResult.results.command' context key was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Investigation And Response' playbook:
          1- The 'Get Device's Process List' task failed.
          2- The 'xdr-script-run' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.ScriptResult.results.command' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5010,
          "y": 2125
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "335":
    id: "335"
    taskid: 576d134d-a670-45e7-846d-478e1a380e40
    type: condition
    task:
      id: 576d134d-a670-45e7-846d-478e1a380e40
      version: -1
      name: Verify Command Output
      description: Verify that the 'PaloAltoNetworksXDR.ScriptResult.results.command_output’ context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "336"
      Verified:
      - "306"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.ScriptResult.results
                accessor: command_output
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5410,
          "y": 1905
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "336":
    id: "336"
    taskid: 5db01c4e-8712-4d5b-8cac-9dc5d5691273
    type: regular
    task:
      id: 5db01c4e-8712-4d5b-8cac-9dc5d5691273
      version: -1
      name: Verify Context Data Error - Command Output
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'PaloAltoNetworksXDR.ScriptResult.results.command_output' context key was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Investigation And Response' playbook:
          1- The 'Get Device's Process List' task failed.
          2- The 'xdr-script-run' automation outputs have been modified and no longer contain the 'PaloAltoNetworksXDR.ScriptResult.results.command_output' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5410,
          "y": 2125
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "337":
    id: "337"
    taskid: d446599c-bd50-4d16-87ea-f17f642c72e2
    type: title
    task:
      id: d446599c-bd50-4d16-87ea-f17f642c72e2
      version: -1
      name: '''InvestigationSummary'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "338"
      - "340"
      - "342"
      - "344"
      - "351"
      - "353"
      - "355"
      - "357"
      - "362"
      - "366"
      - "364"
      - "368"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 620,
          "y": 1150
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "338":
    id: "338"
    taskid: e5fd6fdc-c350-4cde-8c5d-1a6f4f68a690
    type: condition
    task:
      id: e5fd6fdc-c350-4cde-8c5d-1a6f4f68a690
      version: -1
      name: Verify Command and Control - Result
      description: Verify that the 'InvestigationSummary.EvidenceOfCommandAndControl.Result’ context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "339"
      Verified:
      - "370"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: InvestigationSummary.EvidenceOfCommandAndControl
                accessor: Result
            iscontext: true
          right:
            value: {}
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4970,
          "y": 1290
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "339":
    id: "339"
    taskid: e83cb4cb-b278-4cce-8cb2-f19e5afa8689
    type: regular
    task:
      id: e83cb4cb-b278-4cce-8cb2-f19e5afa8689
      version: -1
      name: Verify Context Data Error - Command And Control - Result
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'InvestigationSummary.EvidenceOfCommandAndControl.Result’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Investigation And Response' playbook:
          1- The 'Parse Finding from the sandboxes' task failed.
          2- The 'InvestigationSummaryParse' automation outputs have been modified and no longer contain the 'InvestigationSummary.EvidenceOfCommandAndControl.Result' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4970,
          "y": 1505
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "340":
    id: "340"
    taskid: c93366f3-d14f-45a7-8f3b-546bd441c8f3
    type: condition
    task:
      id: c93366f3-d14f-45a7-8f3b-546bd441c8f3
      version: -1
      name: Verify Command and Control - Tactic
      description: Verify that the 'InvestigationSummary.EvidenceOfCommandAndControl.Tactic' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "341"
      Verified:
      - "370"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: InvestigationSummary.EvidenceOfCommandAndControl
                accessor: Tactic
            iscontext: true
          right:
            value:
              simple: Command and Control
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4580,
          "y": 1290
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "341":
    id: "341"
    taskid: 823a0151-e745-4ae2-8574-d2a1f4ede6ea
    type: regular
    task:
      id: 823a0151-e745-4ae2-8574-d2a1f4ede6ea
      version: -1
      name: Verify Context Data Error - Command And Control - Tactic
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'InvestigationSummary.EvidenceOfCommandAndControl.Tactic’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Investigation And Response' playbook:
          1- The 'Parse Finding from the sandboxes' task failed.
          2- The 'InvestigationSummaryParse' automation outputs have been modified and no longer contain the 'InvestigationSummary.EvidenceOfCommandAndControl.Tactic' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4580,
          "y": 1505
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "342":
    id: "342"
    taskid: 46b2092e-3868-4eba-8baf-5758f56762ad
    type: condition
    task:
      id: 46b2092e-3868-4eba-8baf-5758f56762ad
      version: -1
      name: Verify Defense Evasion - Result
      description: Verify that the 'InvestigationSummary.EvidenceOfDefenseEvasion.Result' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "343"
      Verified:
      - "370"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: InvestigationSummary.EvidenceOfDefenseEvasion
                accessor: Result
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4180,
          "y": 1290
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "343":
    id: "343"
    taskid: e4670153-f985-4bd3-823e-d9be69cd2c54
    type: regular
    task:
      id: e4670153-f985-4bd3-823e-d9be69cd2c54
      version: -1
      name: Verify Context Data Error - Defense Evasion - Result
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'InvestigationSummary.EvidenceOfDefenseEvasion.Result’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Investigation And Response' playbook:
          1- The 'Parse Finding from the sandboxes' task failed.
          2- The 'InvestigationSummaryParse' automation outputs have been modified and no longer contain the 'InvestigationSummary.EvidenceOfDefenseEvasion.Result' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4180,
          "y": 1505
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "344":
    id: "344"
    taskid: e6fc5a84-dc28-4a72-88f5-25709d7bf57c
    type: condition
    task:
      id: e6fc5a84-dc28-4a72-88f5-25709d7bf57c
      version: -1
      name: Verify Defense Evasion - Tactic
      description: Verify that the 'InvestigationSummary.EvidenceOfDefenseEvasion.Tactic' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "345"
      Verified:
      - "370"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: InvestigationSummary.EvidenceOfDefenseEvasion
                accessor: Tactic
            iscontext: true
          right:
            value:
              simple: Defense Evasion
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3780,
          "y": 1290
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "345":
    id: "345"
    taskid: 0d00bea3-84cf-44e4-8b86-b946dfe713db
    type: regular
    task:
      id: 0d00bea3-84cf-44e4-8b86-b946dfe713db
      version: -1
      name: Verify Context Data Error - Defense Evasion - Tactic
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'InvestigationSummary.EvidenceOfDefenseEvasion.Tactic’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Investigation And Response' playbook:
          1- The 'Parse Finding from the sandboxes' task failed.
          2- The 'InvestigationSummaryParse' automation outputs have been modified and no longer contain the 'InvestigationSummary.EvidenceOfDefenseEvasion.Tactic' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3780,
          "y": 1505
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "351":
    id: "351"
    taskid: 4e68e05e-c422-46f5-8fe9-73810b4e6014
    type: condition
    task:
      id: 4e68e05e-c422-46f5-8fe9-73810b4e6014
      version: -1
      name: Verify Execution - Result
      description: Verify that the 'InvestigationSummary.EvidenceOfExecution.Result' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "352"
      Verified:
      - "370"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: InvestigationSummary.EvidenceOfExecution
                accessor: Result
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3390,
          "y": 1290
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "352":
    id: "352"
    taskid: 3177e7a4-f8cb-4445-88a4-3c543f2a4891
    type: regular
    task:
      id: 3177e7a4-f8cb-4445-88a4-3c543f2a4891
      version: -1
      name: Verify Context Data Error - Execution - Result
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'InvestigationSummary.EvidenceOfExecution.Result’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Investigation And Response' playbook:
          1- The 'Parse Finding from the sandboxes' task failed.
          2- The 'InvestigationSummaryParse' automation outputs have been modified and no longer contain the 'InvestigationSummary.EvidenceOfExecution.Result' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3390,
          "y": 1505
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "353":
    id: "353"
    taskid: 2c924c91-f10c-414f-83d4-a2e91cbef191
    type: condition
    task:
      id: 2c924c91-f10c-414f-83d4-a2e91cbef191
      version: -1
      name: Verify Execution - Tactic
      description: Verify that the 'InvestigationSummary.EvidenceOfExecution.Tactic' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "354"
      Verified:
      - "370"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: InvestigationSummary.EvidenceOfExecution
                accessor: Tactic
            iscontext: true
          right:
            value:
              simple: Execution
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3000,
          "y": 1290
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "354":
    id: "354"
    taskid: 43074e58-abf2-4afa-8154-64f216582754
    type: regular
    task:
      id: 43074e58-abf2-4afa-8154-64f216582754
      version: -1
      name: Verify Context Data Error - Execution  - Tactic
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'InvestigationSummary.EvidenceOfExecution.Tactic’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Investigation And Response' playbook:
          1- The 'Parse Finding from the sandboxes' task failed.
          2- The 'InvestigationSummaryParse' automation outputs have been modified and no longer contain the 'InvestigationSummary.EvidenceOfExecution.Tactic' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3000,
          "y": 1505
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "355":
    id: "355"
    taskid: d4b0fcc7-6b97-4c52-84b8-abd6f619e50c
    type: condition
    task:
      id: d4b0fcc7-6b97-4c52-84b8-abd6f619e50c
      version: -1
      name: Verify Lateral Movement - Result
      description: Verify that the 'InvestigationSummary.EvidenceOfLateralMovement.Result' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "356"
      Verified:
      - "370"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: InvestigationSummary.EvidenceOfLateralMovement
                accessor: Result
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2600,
          "y": 1290
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "356":
    id: "356"
    taskid: 1eb61ffb-87c8-4ebe-8c9c-3048ab35ef68
    type: regular
    task:
      id: 1eb61ffb-87c8-4ebe-8c9c-3048ab35ef68
      version: -1
      name: Verify Context Data Error - Lateral Movement - Result
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'InvestigationSummary.EvidenceOfLateralMovement.Result’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Investigation And Response' playbook:
          1- The 'Parse Finding from the sandboxes' task failed.
          2- The 'InvestigationSummaryParse' automation outputs have been modified and no longer contain the 'InvestigationSummary.EvidenceOfLateralMovement.Result' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2600,
          "y": 1505
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "357":
    id: "357"
    taskid: 94f124ec-d72c-4851-814b-8c59d1b75048
    type: condition
    task:
      id: 94f124ec-d72c-4851-814b-8c59d1b75048
      version: -1
      name: Verify Lateral Movement - Tactic
      description: Verify that the 'InvestigationSummary.EvidenceOfLateralMovement.Tactic' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "358"
      Verified:
      - "370"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: InvestigationSummary.EvidenceOfLateralMovement
                accessor: Tactic
            iscontext: true
          right:
            value:
              simple: Lateral Movement
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2200,
          "y": 1290
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "358":
    id: "358"
    taskid: 3fc9aead-db81-45dc-8311-1526df63ae45
    type: regular
    task:
      id: 3fc9aead-db81-45dc-8311-1526df63ae45
      version: -1
      name: Verify Context Data Error - Lateral Movement  - Tactic
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'InvestigationSummary.EvidenceOfLateralMovement.Tactic’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Investigation And Response' playbook:
          1- The 'Parse Finding from the sandboxes' task failed.
          2- The 'InvestigationSummaryParse' automation outputs have been modified and no longer contain the 'InvestigationSummary.EvidenceOfLateralMovement.Tactic' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2200,
          "y": 1505
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "362":
    id: "362"
    taskid: afa0123a-c985-445a-8ae7-63667792f0a7
    type: condition
    task:
      id: afa0123a-c985-445a-8ae7-63667792f0a7
      version: -1
      name: Verify Persistence - Result
      description: Verify that the 'InvestigationSummary.EvidenceOfPersistence.Result' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "363"
      Verified:
      - "370"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: InvestigationSummary.EvidenceOfPersistence
                accessor: Result
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1800,
          "y": 1290
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "363":
    id: "363"
    taskid: ee32e313-8b4c-4ff9-89fd-87774cc81865
    type: regular
    task:
      id: ee32e313-8b4c-4ff9-89fd-87774cc81865
      version: -1
      name: Verify Context Data Error - Persistence - Result
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'InvestigationSummary.EvidenceOfPersistence.Result’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Investigation And Response' playbook:
          1- The 'Parse Finding from the sandboxes' task failed.
          2- The 'InvestigationSummaryParse' automation outputs have been modified and no longer contain the 'InvestigationSummary.EvidenceOfPersistence.Result' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1800,
          "y": 1505
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "364":
    id: "364"
    taskid: e49e17ae-7105-4b22-87cd-3c34dd80cb12
    type: condition
    task:
      id: e49e17ae-7105-4b22-87cd-3c34dd80cb12
      version: -1
      name: Verify Persistence - Tactic
      description: Verify that the 'InvestigationSummary.EvidenceOfPersistence.Tactic' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "365"
      Verified:
      - "370"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: InvestigationSummary.EvidenceOfPersistence
                accessor: Tactic
            iscontext: true
          right:
            value:
              simple: Persistence
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1410,
          "y": 1290
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "365":
    id: "365"
    taskid: 62867a75-d886-4b85-80be-6bb2b0f65f4e
    type: regular
    task:
      id: 62867a75-d886-4b85-80be-6bb2b0f65f4e
      version: -1
      name: Verify Context Data Error - Persistence  - Tactic
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'InvestigationSummary.EvidenceOfPersistence.Tactic’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Investigation And Response' playbook:
          1- The 'Parse Finding from the sandboxes' task failed.
          2- The 'InvestigationSummaryParse' automation outputs have been modified and no longer contain the 'InvestigationSummary.EvidenceOfPersistence.Tactic' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1410,
          "y": 1505
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "366":
    id: "366"
    taskid: 8fcb2269-7409-432d-8286-72e310480609
    type: condition
    task:
      id: 8fcb2269-7409-432d-8286-72e310480609
      version: -1
      name: Verify Privilege Escalation - Result
      description: Verify that the 'InvestigationSummary.EvidenceOfPrivilegeEscalation.Result' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "367"
      Verified:
      - "370"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: InvestigationSummary.EvidenceOfPrivilegeEscalation
                accessor: Result
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1020,
          "y": 1290
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "367":
    id: "367"
    taskid: 0133a625-85fe-4874-822e-115adb14c40c
    type: regular
    task:
      id: 0133a625-85fe-4874-822e-115adb14c40c
      version: -1
      name: Verify Context Data Error - Privilege Escalation - Result
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'InvestigationSummary.EvidenceOfPrivilegeEscalation.Result’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Investigation And Response' playbook:
          1- The 'Parse Finding from the sandboxes' task failed.
          2- The 'InvestigationSummaryParse' automation outputs have been modified and no longer contain the 'InvestigationSummary.EvidenceOfPrivilegeEscalation.Result' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1020,
          "y": 1505
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "368":
    id: "368"
    taskid: 960ec289-642a-464f-8f14-6b28cbd46e79
    type: condition
    task:
      id: 960ec289-642a-464f-8f14-6b28cbd46e79
      version: -1
      name: Verify Privilege Escalation - Tactic
      description: Verify that the 'InvestigationSummary.EvidenceOfPrivilegeEscalation.Tactic' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "369"
      Verified:
      - "370"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: InvestigationSummary.EvidenceOfPrivilegeEscalation
                accessor: Tactic
            iscontext: true
          right:
            value:
              simple: Privilege Escalation
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 620,
          "y": 1290
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "369":
    id: "369"
    taskid: 8aeb95ea-b0d1-42b6-8955-5eda1c55e9e3
    type: regular
    task:
      id: 8aeb95ea-b0d1-42b6-8955-5eda1c55e9e3
      version: -1
      name: Verify Context Data Error - Privilege Escalation  - Tactic
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'InvestigationSummary.EvidenceOfPrivilegeEscalation.Tactic’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Investigation And Response' playbook:
          1- The 'Parse Finding from the sandboxes' task failed.
          2- The 'InvestigationSummaryParse' automation outputs have been modified and no longer contain the 'InvestigationSummary.EvidenceOfPrivilegeEscalation.Tactic' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 620,
          "y": 1505
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "370":
    id: "370"
    taskid: ef9e4624-2529-47f7-8db4-95dcfb15974b
    type: title
    task:
      id: ef9e4624-2529-47f7-8db4-95dcfb15974b
      version: -1
      name: Done Verifying 'InvestigationSummary' Context Data
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "202"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5790,
          "y": 1470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "371":
    id: "371"
    taskid: 4300db37-71cb-4155-89cc-8f511a713607
    type: title
    task:
      id: 4300db37-71cb-4155-89cc-8f511a713607
      version: -1
      name: '''InvestigationDetailedSummary'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "380"
      - "378"
      - "376"
      - "374"
      - "372"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 610,
          "y": 550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "372":
    id: "372"
    taskid: f800066f-2fc7-4fa6-8544-39f3d7d5661f
    type: condition
    task:
      id: f800066f-2fc7-4fa6-8544-39f3d7d5661f
      version: -1
      name: Verify Persistence - Boot or Logon Autostart Execution
      description: Verify that the 'InvestigationDetailedSummary.Persistence.Boot or Logon Autostart Execution' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "384"
      Verified:
      - "382"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: InvestigationDetailedSummary.Persistence
                accessor: Boot or Logon Autostart Execution
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2190,
          "y": 690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "374":
    id: "374"
    taskid: 7c19dadb-d35e-4f07-8fb8-cc8e5301578f
    type: condition
    task:
      id: 7c19dadb-d35e-4f07-8fb8-cc8e5301578f
      version: -1
      name: Verify Persistence - Boot or Logon Autostart Execution
      description: Verify that the 'InvestigationDetailedSummary.Persistence.Boot or Logon Autostart Execution' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "385"
      Verified:
      - "382"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: InvestigationDetailedSummary.Persistence
                accessor: Boot or Logon Autostart Execution
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1790,
          "y": 690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "376":
    id: "376"
    taskid: d50ab39f-4616-400c-8e3c-3452df4dd98d
    type: condition
    task:
      id: d50ab39f-4616-400c-8e3c-3452df4dd98d
      version: -1
      name: Verify Lateral Movement - Remote Services
      description: Verify that the 'InvestigationDetailedSummary.Lateral Movement.Remote Services' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "386"
      Verified:
      - "382"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: InvestigationDetailedSummary.Lateral Movement
                accessor: Remote Services
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1400,
          "y": 690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "378":
    id: "378"
    taskid: 691d3c5e-96b4-473b-83db-262990df9c8b
    type: condition
    task:
      id: 691d3c5e-96b4-473b-83db-262990df9c8b
      version: -1
      name: Verify Execution - Command and Scripting Interpreter
      description: Verify that the 'InvestigationDetailedSummary.Execution.Command and Scripting Interpreter' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "383"
      Verified:
      - "382"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: InvestigationDetailedSummary.Execution
                accessor: Command and Scripting Interpreter
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1010,
          "y": 690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "380":
    id: "380"
    taskid: d1286989-e84c-4608-885f-7a2ad5914031
    type: condition
    task:
      id: d1286989-e84c-4608-885f-7a2ad5914031
      version: -1
      name: Verify Defense Evasion - Indicator Removal on Host
      description: Verify that the 'InvestigationDetailedSummary.Defense Evasion.Indicator Removal on Host' context key was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "381"
      Verified:
      - "382"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: InvestigationDetailedSummary.Defense Evasion
                accessor: Indicator Removal on Host
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 610,
          "y": 690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "381":
    id: "381"
    taskid: c29a1322-34f8-494f-895b-d5be15da23f0
    type: regular
    task:
      id: c29a1322-34f8-494f-895b-d5be15da23f0
      version: -1
      name: Verify Context Data Error - Defense Evasion - Indicator Removal on Host
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'InvestigationDetailedSummary.Defense Evasion.Indicator Removal on Host’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Investigation And Response' playbook:
          1- The 'Parse Findings From the Sandbox' task failed.
          2- The 'InvestigationDetailedSummaryParse' automation outputs have been modified and no longer contain the 'InvestigationDetailedSummary.Defense Evasion.Indicator Removal on Host' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 610,
          "y": 905
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "382":
    id: "382"
    taskid: b74f0da7-ede8-402e-8f4a-bdf5296589ab
    type: title
    task:
      id: b74f0da7-ede8-402e-8f4a-bdf5296589ab
      version: -1
      name: Done Verifying 'InvestigationDetailedSummary' Context Data
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "202"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5790,
          "y": 890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "383":
    id: "383"
    taskid: 4c8a7bd6-f5cc-48b0-81ab-b7ae7c008fef
    type: regular
    task:
      id: 4c8a7bd6-f5cc-48b0-81ab-b7ae7c008fef
      version: -1
      name: Verify Context Data Error - Execution - Command and Scripting Interpreter
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'InvestigationDetailedSummary.Execution.Command and Scripting Interpreter’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Investigation And Response' playbook:
          1- The 'Parse Findings From the Sandbox' task failed.
          2- The 'InvestigationDetailedSummaryParse' automation outputs have been modified and no longer contain the 'InvestigationDetailedSummary.Execution.Command and Scripting Interpreter' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1010,
          "y": 905
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "384":
    id: "384"
    taskid: 6583ac12-bfe4-46e4-8404-b43154ce34ec
    type: regular
    task:
      id: 6583ac12-bfe4-46e4-8404-b43154ce34ec
      version: -1
      name: Verify Context Data Error - Persistence - Boot or Logon Autostart Execution
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'InvestigationDetailedSummary.Persistence.Boot or Logon Autostart Execution’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Investigation And Response' playbook:
          1- The 'Parse Findings From the Sandbox' task failed.
          2- The 'InvestigationDetailedSummaryParse' automation outputs have been modified and no longer contain the 'InvestigationDetailedSummary.Persistence.Boot or Logon Autostart Execution' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2190,
          "y": 905
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "385":
    id: "385"
    taskid: dd4407a4-95e4-4c2e-849d-3d87b2d320e2
    type: regular
    task:
      id: dd4407a4-95e4-4c2e-849d-3d87b2d320e2
      version: -1
      name: Verify Context Data Error - Persistence - Boot or Logon Autostart Execution
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'InvestigationDetailedSummary.Persistence.Boot or Logon Autostart Execution’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Investigation And Response' playbook:
          1- The 'Parse Findings From the Sandbox' task failed.
          2- The 'InvestigationDetailedSummaryParse' automation outputs have been modified and no longer contain the 'InvestigationDetailedSummary.Persistence.Boot or Logon Autostart Execution' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1790,
          "y": 905
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "386":
    id: "386"
    taskid: bb146d16-84f3-426f-8291-88d1993e7987
    type: regular
    task:
      id: bb146d16-84f3-426f-8291-88d1993e7987
      version: -1
      name: Verify Context Data Error - Lateral Movement - Remote Services
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'InvestigationDetailedSummary.Lateral Movement.Remote Services’ context key was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Investigation And Response' playbook:
          1- The 'Parse Findings From the Sandbox' task failed.
          2- The 'InvestigationDetailedSummaryParse' automation outputs have been modified and no longer contain the 'InvestigationDetailedSummary.Lateral Movement.Remote Services' context key.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1400,
          "y": 905
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "387":
    id: "387"
    taskid: d522a2e5-dda4-45f3-8465-4beaed405e84
    type: condition
    task:
      id: d522a2e5-dda4-45f3-8465-4beaed405e84
      version: -1
      name: Verify Malware Investigation Summary
      description: Verify that the 'malwareinvestigationsummary' incident field was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "388"
      Verified:
      - "284"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: incident
                accessor: malwareinvestigationsummary
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1000,
          "y": 80
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "388":
    id: "388"
    taskid: 67968387-a12e-42c9-8af0-dfa5edbb4548
    type: regular
    task:
      id: 67968387-a12e-42c9-8af0-dfa5edbb4548
      version: -1
      name: Verify Incident Field Error - Malware Investigation Summary
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'malwareinvestigationsummary’ incident field was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Investigation And Response' playbook:
          1- The 'Parse Finding from the sandboxes' task failed.
          2- The mapping rule used within the 'Parse Finding from the sandboxes' task was changed.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1000,
          "y": 310
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "389":
    id: "389"
    taskid: 08e69873-e8fc-447d-87cc-a2c67d353897
    type: condition
    task:
      id: 08e69873-e8fc-447d-87cc-a2c67d353897
      version: -1
      name: Verify Malware Detailed Investigation Summary
      description: Verify that the 'malwaredetailedinvestigationsummary' incident field was populated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "390"
      Verified:
      - "284"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: incident
                accessor: malwaredetailedinvestigationsummary
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1400,
          "y": 80
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "390":
    id: "390"
    taskid: 0faf5815-313e-415d-881e-6a5fe2908cf3
    type: regular
    task:
      id: 0faf5815-313e-415d-881e-6a5fe2908cf3
      version: -1
      name: Verify Incident Field Error - Malware Detailed Investigation Summary
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'malwaredetailedinvestigationsummary’ incident field was not populated. This may indicate that one or more of the following changes have been made to the 'Cortex XDR Malware - Investigation And Response' playbook:
          1- The 'Parse Finding from the sandboxes' task failed.
          2- The mapping rule used within the 'Parse Finding from the sandboxes' task was changed.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1400,
          "y": 310
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "300_306_Verified": 0.1,
      "311_306_Verified": 0.1,
      "313_306_Verified": 0.1,
      "315_306_Verified": 0.1,
      "317_306_Verified": 0.1,
      "319_306_Verified": 0.13,
      "321_306_Verified": 0.1,
      "323_306_Verified": 0.1,
      "325_306_Verified": 0.1,
      "327_306_Verified": 0.1,
      "329_306_Verified": 0.1,
      "333_306_Verified": 0.1,
      "335_306_Verified": 0.1,
      "338_370_Verified": 0.57,
      "340_341_#default#": 0.53,
      "340_370_Verified": 0.1,
      "342_370_Verified": 0.1,
      "344_370_Verified": 0.12,
      "351_370_Verified": 0.1,
      "353_370_Verified": 0.12,
      "355_370_Verified": 0.13,
      "357_370_Verified": 0.1,
      "362_370_Verified": 0.12,
      "364_370_Verified": 0.13,
      "366_370_Verified": 0.1,
      "368_370_Verified": 0.1,
      "372_382_Verified": 0.23,
      "374_382_Verified": 0.11,
      "376_382_Verified": 0.1,
      "378_382_Verified": 0.1,
      "380_382_Verified": 0.1
    },
    "paper": {
      "dimensions": {
        "height": 3100,
        "width": 6220,
        "x": 210,
        "y": -815
      }
    }
  }
inputs: []
outputs: []
fromversion: 6.5.0
