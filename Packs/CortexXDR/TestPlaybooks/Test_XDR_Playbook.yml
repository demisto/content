id: Test XDR Playbook
version: -1
vcShouldKeepItemLegacyProdMachine: false
name: Test XDR Playbook
description: Cortex XDR Test Playbook
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 86023169-0cb3-4e78-80c5-95618fe87d54
    type: start
    task:
      id: 86023169-0cb3-4e78-80c5-95618fe87d54
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
        - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 700f9a01-86f2-4a80-8d6f-f6db3bcec9b2
    type: regular
    task:
      id: 700f9a01-86f2-4a80-8d6f-f6db3bcec9b2
      version: -1
      name: DeleteContext
      description: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
        - "2"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: e93912db-85d8-484e-8a35-95b46edaa1ef
    type: regular
    task:
      id: e93912db-85d8-484e-8a35-95b46edaa1ef
      version: -1
      name: xdr-get-incidents
      description: xdr-get-incidents
      script: '|||xdr-get-incidents'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
        - "3"
    scriptarguments:
      gte_creation_time:
        simple: 2010-10-10T00:00:00
      gte_modification_time: {}
      incident_id_list: {}
      limit:
        simple: "3"
      lte_creation_time: {}
      lte_modification_time: {}
      page: {}
      since_creation_time: {}
      since_modification_time: {}
      sort_by_creation_time:
        simple: asc
      sort_by_modification_time: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 216d71b1-293c-4454-8673-3c3b85918132
    type: condition
    task:
      id: 216d71b1-293c-4454-8673-3c3b85918132
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
        - "4"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.Incident.incident_id
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.Incident.severity
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.Incident.xdr_url
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.Incident.status
                iscontext: true
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 097e896e-7d5f-4d5d-8762-99e4650a197c
    type: regular
    task:
      id: 097e896e-7d5f-4d5d-8762-99e4650a197c
      version: -1
      name: xdr-get-incident-extra-data
      description: xdr-get-incident-extra-data
      script: '|||xdr-get-incident-extra-data'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
        - "26"
    scriptarguments:
      alerts_limit: {}
      incident_id:
        simple: ${PaloAltoNetworksXDR.Incident.incident_id}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 19d31e05-4678-4c4c-8e0d-a99b31363d74
    type: regular
    task:
      id: 19d31e05-4678-4c4c-8e0d-a99b31363d74
      version: -1
      name: xdr-update-incident
      description: xdr-update-incident
      script: '|||xdr-update-incident'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
        - "27"
    scriptarguments:
      assigned_user_mail: {}
      assigned_user_pretty_name: {}
      incident_id:
        complex:
          root: PaloAltoNetworksXDR
          accessor: Incident.incident_id
          transformers:
            - operator: FirstArrayElement
      manual_severity:
        simple: HIGH
      resolve_comment: {}
      status:
        simple: UNDER_INVESTIGATION
      unassign_user: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: 32d6d159-aab7-435e-87ce-f08975205c13
    type: regular
    task:
      id: 32d6d159-aab7-435e-87ce-f08975205c13
      version: -1
      name: xdr-insert-parsed-alert
      description: xdr-insert-parsed-alert
      script: '|||xdr-insert-parsed-alert'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
        - "32"
    scriptarguments:
      alert_description:
        simple: This alert from content  TestXDRPlaybook description
      alert_name:
        simple: This alert from content  TestXDRPlaybook
      event_timestamp: {}
      local_ip:
        simple: 196.168.0.111
      local_port:
        simple: "2000"
      product:
        simple: SandBlast
      remote_ip:
        simple: 2.2.2.2
      remote_port:
        simple: "6000"
      severity:
        simple: High
      vendor:
        simple: Checkpoint
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: e89cd0c3-ddc0-4e14-81db-790f97d64577
    type: regular
    task:
      id: e89cd0c3-ddc0-4e14-81db-790f97d64577
      version: -1
      name: xdr-insert-cef-alerts
      description: xdr-insert-cef-alerts
      script: '|||xdr-insert-cef-alerts'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
        - "33"
    scriptarguments:
      cef_alerts:
        simple: ${cef_alerts}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: bdc9e8a5-c004-4bdb-839b-60abcfab7ea7
    type: regular
    task:
      id: bdc9e8a5-c004-4bdb-839b-60abcfab7ea7
      version: -1
      name: xdr-isolate-endpoint
      description: xdr-isolate-endpoint
      script: '|||xdr-isolate-endpoint'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
        - "36"
    scriptarguments:
      endpoint_id:
        simple: f8a2f58846b542579c12090652e79f3d
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: b424b792-dadc-4882-88e5-d7cb869cbe08
    type: regular
    task:
      id: b424b792-dadc-4882-88e5-d7cb869cbe08
      version: -1
      name: xdr-unisolate-endpoint
      description: xdr-unisolate-endpoint
      script: '|||xdr-unisolate-endpoint'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
        - "36"
    scriptarguments:
      endpoint_id:
        simple: f8a2f58846b542579c12090652e79f3d
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 4f59a60e-70d8-4d90-80ba-f2248b4e31ec
    type: regular
    task:
      id: 4f59a60e-70d8-4d90-80ba-f2248b4e31ec
      version: -1
      name: xdr-get-endpoints
      description: xdr-get-endpoints
      script: '|||xdr-get-endpoints'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
        - "12"
    scriptarguments:
      alias_name: {}
      dist_name: {}
      endpoint_id_list: {}
      first_seen_gte: {}
      first_seen_lte: {}
      group_name: {}
      hostname:
        simple: ip-172-31-15-237.eu-central-1.compute.internal
      ip_list: {}
      isolate: {}
      last_seen_gte: {}
      last_seen_lte: {}
      limit: {}
      page: {}
      platform: {}
      sort_by: {}
      sort_order: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3490
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: c46519c8-58c5-4ca9-855f-122af041dcc5
    type: condition
    task:
      id: c46519c8-58c5-4ca9-855f-122af041dcc5
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
        - "13"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.Endpoint.endpoint_id
                iscontext: true
          - - operator: isEqualString
              left:
                value:
                  simple: PaloAltoNetworksXDR.Endpoint.os_type
                iscontext: true
              right:
                value:
                  simple: AGENT_OS_LINUX
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.Endpoint.ip
                iscontext: true
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3665
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: fc6a6010-c4e9-45d5-8e6b-1e9507c6aaa4
    type: regular
    task:
      id: fc6a6010-c4e9-45d5-8e6b-1e9507c6aaa4
      version: -1
      name: xdr-get-distribution-versions
      description: xdr-get-distribution-versions
      script: '|||xdr-get-distribution-versions'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
        - "14"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3840
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 65a511eb-23c3-4a9c-8da8-2e2d516314a0
    type: condition
    task:
      id: 65a511eb-23c3-4a9c-8da8-2e2d516314a0
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
        - "15"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.DistributionVersions.windows
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.DistributionVersions.linux
                iscontext: true
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4015
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: dfdd051b-1c26-4d86-8e58-a4212f5e6133
    type: regular
    task:
      id: dfdd051b-1c26-4d86-8e58-a4212f5e6133
      version: -1
      name: xdr-create-distribution
      description: xdr-create-distribution
      script: '|||xdr-create-distribution'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
        - "16"
    scriptarguments:
      agent_version:
        complex:
          root: PaloAltoNetworksXDR
          accessor: DistributionVersions.linux
          transformers:
            - operator: FirstArrayElement
      description:
        simple: Created by TestXDRPlaybook
      name:
        simple: This is test distribution
      package_type:
        simple: standalone
      platform:
        simple: linux
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: 794b75cc-4b4c-4c3b-8fa7-452a1df2f50b
    type: condition
    task:
      id: 794b75cc-4b4c-4c3b-8fa7-452a1df2f50b
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
        - "19"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.Distribution.id
                iscontext: true
          - - operator: isExists
              left:
                value:
                  simple: PaloAltoNetworksXDR.Distribution.platform
                iscontext: true
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4365
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: 7672ffdc-c319-4055-8311-667e0c805461
    type: regular
    task:
      id: 7672ffdc-c319-4055-8311-667e0c805461
      version: -1
      name: xdr-get-distribution-url
      description: xdr-get-distribution-url
      script: '|||xdr-get-distribution-url'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
        - "18"
    scriptarguments:
      distribution_id:
        simple: 2c74c11b63074653aa01d575a82bf52a
      package_type:
        simple: sh
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: 6abedd19-cc23-4c10-8a21-cc0e2bc9e1ce
    type: condition
    task:
      id: 6abedd19-cc23-4c10-8a21-cc0e2bc9e1ce
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
        - "21"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.Distribution.url
                iscontext: true
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5065
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: 323ff5a5-6700-49f2-8843-1416452b1fc2
    type: regular
    task:
      id: 323ff5a5-6700-49f2-8843-1416452b1fc2
      version: -1
      name: xdr-get-create-distribution-status
      description: xdr-get-create-distribution-status
      script: '|||xdr-get-create-distribution-status'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
        - "20"
    scriptarguments:
      distribution_ids:
        simple: ${PaloAltoNetworksXDR.Distribution.id}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 88c6e88b-67e5-4b6d-808d-255e800274b6
    type: condition
    task:
      id: 88c6e88b-67e5-4b6d-808d-255e800274b6
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
        - "17"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: isEqualString
              left:
                value:
                  simple: PaloAltoNetworksXDR.Distribution.status
                iscontext: true
              right:
                value:
                  simple: Completed
            - operator: isEqualString
              left:
                value:
                  simple: PaloAltoNetworksXDR.Distribution.status
                iscontext: true
              right:
                value:
                  simple: In Progress
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4715
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: cbe6c4b5-d281-467f-85ed-e963eea8162b
    type: regular
    task:
      id: cbe6c4b5-d281-467f-85ed-e963eea8162b
      version: -1
      name: xdr-get-audit-management-logs
      description: xdr-get-audit-management-logs
      script: '|||xdr-get-audit-management-logs'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
        - "22"
    scriptarguments:
      email: {}
      limit:
        simple: "5"
      page: {}
      result: {}
      sort_by:
        simple: sub_type
      sort_order:
        simple: asc
      sub_type:
        simple: Authentication failed
      timestamp_gte:
        simple: "0"
      timestamp_lte: {}
      type: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5240
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 178a79b0-4a5c-4e24-8a07-8bd70d634505
    type: condition
    task:
      id: 178a79b0-4a5c-4e24-8a07-8bd70d634505
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
        - "23"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: containsGeneral
              left:
                value:
                  simple: PaloAltoNetworksXDR.AuditManagementLogs.AUDIT_ENTITY_SUBTYPE
                iscontext: true
              right:
                value:
                  simple: Authentication failed
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.AuditManagementLogs.AUDIT_ID
                iscontext: true
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5415
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: 1f3d7705-fed1-4db7-836d-b19cc2b18ebc
    type: regular
    task:
      id: 1f3d7705-fed1-4db7-836d-b19cc2b18ebc
      version: -1
      name: xdr-get-audit-agent-reports
      description: xdr-get-audit-agent-reports
      script: '|||xdr-get-audit-agent-reports'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
        - "24"
    scriptarguments:
      endpoint_ids: {}
      endpoint_names:
        simple: ip-172-31-15-237.eu-central-1.compute.internal
      limit:
        simple: "5"
      page: {}
      result:
        simple: Success
      retry-count:
        simple: "3"
      retry-interval:
        simple: "30"
      sort_by:
        simple: category
      sort_order:
        simple: desc
      sub_type: {}
      timestamp_gte:
        simple: "2019-10-10"
      timestamp_lte: {}
      type: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5590
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: 7e2b50fa-e194-4f01-8a5f-de26b3a89246
    type: condition
    task:
      id: 7e2b50fa-e194-4f01-8a5f-de26b3a89246
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
        - "37"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: containsGeneral
              left:
                value:
                  simple: PaloAltoNetworksXDR.AuditAgentReports.ENDPOINTNAME
                iscontext: true
              right:
                value:
                  simple: ip-172-31-15-237.eu-central-1.compute.internal
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.AuditAgentReports.ENDPOINTID
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: Endpoint.ID
                iscontext: true
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5765
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "25":
    id: "25"
    taskid: afbd4d4d-448e-44e1-8bd2-453e7261a844
    type: title
    task:
      id: afbd4d4d-448e-44e1-8bd2-453e7261a844
      version: -1
      name: Test Done
      description: Test Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 10140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: 95b25963-9e45-46b3-8936-6451d2a4a21e
    type: condition
    task:
      id: 95b25963-9e45-46b3-8936-6451d2a4a21e
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
        - "6"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.Incident.incident_id
                iscontext: true
          - - operator: isExists
              left:
                value:
                  simple: PaloAltoNetworksXDR.Incident.manual_severity
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.Incident.severity
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.Incident.xdr_url
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.Incident.status
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.Incident.alerts.alert_id
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.Incident.alerts.source
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.Incident.network_artifacts.network_remote_ip
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: File.SHA256
                iscontext: true
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: 67b67120-ee3d-4d6b-8991-85a94bc6716f
    type: regular
    task:
      id: 67b67120-ee3d-4d6b-8991-85a94bc6716f
      version: -1
      name: Save incident id
      description: Save incident id
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
        - "28"
    scriptarguments:
      append: {}
      key:
        simple: XDRIncidentID
      value:
        complex:
          root: PaloAltoNetworksXDR
          accessor: Incident.incident_id
          transformers:
            - operator: FirstArrayElement
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: fa5e2060-4f47-4597-89da-769cae7d1327
    type: regular
    task:
      id: fa5e2060-4f47-4597-89da-769cae7d1327
      version: -1
      name: DeleteContext
      description: DeleteContext
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
        - "29"
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key: {}
      keysToKeep:
        simple: XDRIncidentID
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: cd527ca7-3bf2-4178-8d04-a47982278d63
    type: regular
    task:
      id: cd527ca7-3bf2-4178-8d04-a47982278d63
      version: -1
      name: xdr-get-incidents
      description: xdr-get-incidents
      script: '|||xdr-get-incidents'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
        - "30"
    scriptarguments:
      gte_creation_time: {}
      gte_modification_time: {}
      incident_id_list:
        simple: ${XDRIncidentID}
      limit: {}
      lte_creation_time: {}
      lte_modification_time: {}
      page: {}
      since_creation_time: {}
      since_modification_time: {}
      sort_by_creation_time:
        simple: desc
      sort_by_modification_time: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: e1fde48c-6e86-4cde-8a56-39828695fe81
    type: condition
    task:
      id: e1fde48c-6e86-4cde-8a56-39828695fe81
      version: -1
      name: Verify updated values
      description: Verify updated values
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
        - "31"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: isEqualString
              left:
                value:
                  simple: PaloAltoNetworksXDR.Incident.severity
                iscontext: true
              right:
                value:
                  simple: high
          - - operator: isEqualString
              left:
                value:
                  simple: PaloAltoNetworksXDR.Incident.status
                iscontext: true
              right:
                value:
                  simple: under_investigation
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: 9b9030ee-7a64-410d-8079-f3ca171727d4
    type: regular
    task:
      id: 9b9030ee-7a64-410d-8079-f3ca171727d4
      version: -1
      name: xdr-update-incident
      description: xdr-update-incident
      script: '|||xdr-update-incident'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
        - "7"
    scriptarguments:
      assigned_user_mail: {}
      assigned_user_pretty_name: {}
      incident_id:
        simple: ${PaloAltoNetworksXDR.Incident.incident_id}
      manual_severity:
        simple: LOW
      resolve_comment: {}
      status:
        simple: NEW
      unassign_user: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: dcb30ae1-0a4d-4109-89c1-8f4b530ed725
    type: regular
    task:
      id: dcb30ae1-0a4d-4109-89c1-8f4b530ed725
      version: -1
      name: Set 2 CEF alerts to context
      description: Set 2 CEF alerts to context
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
        - "8"
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: cef_alerts
      value:
        simple: |-
          [
                      "CEF:0|Check Point|VPN-1 & FireWall-1|Check Point|Log|microsoft-ds|Unknown|act=AcceptdeviceDirection=0 rt=1569477512000 spt=56957 dpt=445 cs2Label=Rule Name cs2=ADPrimery layer_name=FW_Device_blackened Securitylayer_uuid=07693fc7-1a5c-4f31-8afe-77ae96c71b8c match_id=1806 parent_rule=0rule_action=Accept rule_uid=8e45f36b-d106-4d81-a1f0-9d1ed9a6be5c ifname=bond2logid=0 loguid={0x5d8c5388,0x61,0x29321fac,0xc0000022} origin=1.1.1.1originsicname=CN=DWdeviceBlackend,O=Blackend sequencenum=363 version=5dst=1.1.1.1 inzone=External outzone=Internal product=VPN-1 & FireWall-1 proto=6service_id=microsoft-ds src=1.1.1.1",
                      "CEF:0|Check Point|VPN-1 & FireWall-1|Check Point|Log|Log|Unknown|act=AcceptdeviceDirection=0 rt=1569477501000 spt=63088 dpt=5985 cs2Label=Rule Namelayer_name=FW_Device_blackened Securitylayer_uuid=07693fc7-1a5c-4f31-8afe-77ae96c71b8c match_id=8899 parent_rule=0rule_action=Accept rule_uid=ae987933-82c0-470f-ab1c-1ad552c82369conn_direction=Internal ifname=bond1.12 logid=0loguid={0x5d8c537d,0xbb,0x29321fac,0xc0000014} origin=1.1.1.1originsicname=CN=DWdeviceBlackend,O=Blackend sequencenum=899 version=5dst=1.1.1.1 product=VPN-1 & FireWall-1 proto=6 src=1.1.1.1"
                  ]
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: cbb0088f-38e5-4bd7-8f65-84f9053407a2
    type: regular
    task:
      id: cbb0088f-38e5-4bd7-8f65-84f9053407a2
      version: -1
      name: Get Endpoint f8a2f58846b542579c12090652e79f3d
      description: Gets a list of endpoints, according to the passed filters. Filtering
        by multiple fields will be concatenated using AND condition (OR is not supported).
        Maximum result set size is 100. Offset is the zero-based number of endpoint
        from the start of the result set (start by counting from 0).
      script: '|||xdr-get-endpoints'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
        - "34"
    scriptarguments:
      alias_name: {}
      dist_name: {}
      endpoint_id_list:
        simple: f8a2f58846b542579c12090652e79f3d
      first_seen_gte: {}
      first_seen_lte: {}
      group_name: {}
      hostname: {}
      ip_list: {}
      isolate: {}
      last_seen_gte: {}
      last_seen_lte: {}
      limit: {}
      page: {}
      platform: {}
      sort_by: {}
      sort_order: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: ab2acbfc-68e5-4859-8cef-51b4d32f3db2
    type: condition
    task:
      id: ab2acbfc-68e5-4859-8cef-51b4d32f3db2
      version: -1
      name: To isolate ?
      description: To isolate
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
        - "35"
      "yes":
        - "9"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: isEqualString
              left:
                value:
                  simple: PaloAltoNetworksXDR.Endpoint.is_isolated
                iscontext: true
              right:
                value:
                  simple: AGENT_UNISOLATED
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 2820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: e5562676-381c-4c7a-8c56-6b176a45d046
    type: condition
    task:
      id: e5562676-381c-4c7a-8c56-6b176a45d046
      version: -1
      name: To unisolate?
      description: To unisolate
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
        - "36"
      "yes":
        - "10"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: isEqualString
              left:
                value:
                  simple: PaloAltoNetworksXDR.Endpoint.is_isolated
                iscontext: true
              right:
                value:
                  simple: AGENT_ISOLATED
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 2995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: d9c49d4a-19d4-4e8c-8752-22e892285e0f
    type: title
    task:
      id: d9c49d4a-19d4-4e8c-8752-22e892285e0f
      version: -1
      name: Isolation done
      description: Isolation done
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
        - "11"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: d46c1698-82f1-4cbc-8b84-4f47fa73fe34
    type: regular
    task:
      id: d46c1698-82f1-4cbc-8b84-4f47fa73fe34
      version: -1
      name: xdr-get-endpoints
      description: Gets a list of endpoints, according to the passed filters. If there
        are no filters, all endpoints are returned. Filtering by multiple fields will
        be concatenated using AND condition (OR is not supported). Maximum result
        set size is 100. Offset is the zero-based number of endpoint from the start
        of the result set (start by counting from 0).
      script: '|||xdr-get-endpoints'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
        - "38"
    scriptarguments:
      alias_name: {}
      dist_name: {}
      endpoint_id_list: {}
      first_seen_gte: {}
      first_seen_lte: {}
      group_name: {}
      hostname: {}
      ip_list: {}
      isolate: {}
      last_seen_gte: {}
      last_seen_lte: {}
      limit: {}
      page: {}
      platform: {}
      sort_by: {}
      sort_order: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5940
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: 5a47ee9f-26a9-48fc-8ddd-6f66df8c2069
    type: condition
    task:
      id: 5a47ee9f-26a9-48fc-8ddd-6f66df8c2069
      version: -1
      name: Check the number of endpoints in context
      description: Check the number of endpoints in context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
        - "39"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: greaterThanOrEqual
              left:
                value:
                  complex:
                    root: PaloAltoNetworksXDR
                    accessor: Endpoint
                    transformers:
                      - operator: count
                iscontext: true
              right:
                value:
                  simple: "3"
    view: |-
      {
        "position": {
          "x": 480,
          "y": 6115
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: d6e3d890-7e8a-4eae-8952-a08ee1bcda15
    type: playbook
    task:
      id: d6e3d890-7e8a-4eae-8952-a08ee1bcda15
      version: -1
      name: Cortex XDR - quarantine file
      description: Cortex XDR - quarantine file
      playbookName: Cortex XDR - quarantine file
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
        - "40"
    scriptarguments:
      endpoint_id:
        simple: ea303670c76e4ad09600c8b346f7c804
      file_hash:
        simple: 55f8718109829bf506b09d8af615b9f107a266e19f7a311039d1035f180b22d4
      file_path:
        simple: /home/ec2-user/test_file.txt
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 480,
          "y": 6290
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: ab6bfbe4-febd-48b7-8da2-b1b907d00b7a
    type: regular
    task:
      id: ab6bfbe4-febd-48b7-8da2-b1b907d00b7a
      version: -1
      name: xdr-get-policy
      description: Gets the policy name for a specific endpoint.
      script: '|||xdr-get-policy'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
        - "41"
    scriptarguments:
      endpoint_id:
        complex:
          root: PaloAltoNetworksXDR.Endpoint
          accessor: endpoint_id
          transformers:
            - operator: FirstArrayElement
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 6465
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: 51e3260b-5db3-4e7f-85f6-e7d75661e2b5
    type: condition
    task:
      id: 51e3260b-5db3-4e7f-85f6-e7d75661e2b5
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
        - "42"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.Policy.policy_name
                iscontext: true
    view: |-
      {
        "position": {
          "x": 480,
          "y": 6640
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: d9cc423b-0b83-4722-8739-4af2ec2bba30
    type: regular
    task:
      id: d9cc423b-0b83-4722-8739-4af2ec2bba30
      version: -1
      name: xdr-get-endpoint-device-control-violations
      description: Gets a list of device control violations filtered by selected fields.
        You can retrieve up to 100 violations.
      script: '|||xdr-get-endpoint-device-control-violations'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
        - "43"
    scriptarguments:
      endpoint_ids: {}
      hostname: {}
      ip_list: {}
      product: {}
      product_id: {}
      serial: {}
      timestamp_gte: {}
      timestamp_lte: {}
      type: {}
      username: {}
      vendor: {}
      vendor_id: {}
      violation_id_list: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 6815
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: 443f083f-ea10-45c0-8014-ba53482d3800
    type: condition
    task:
      id: 443f083f-ea10-45c0-8014-ba53482d3800
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
        - "48"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.EndpointViolations
                iscontext: true
    view: |-
      {
        "position": {
          "x": 480,
          "y": 6990
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: 20240861-2c9f-4be1-83d0-e09c030f604d
    type: regular
    task:
      id: 20240861-2c9f-4be1-83d0-e09c030f604d
      version: -1
      name: xdr-get-scripts
      description: Gets a list of scripts available in the scripts library.
      script: '|||xdr-get-scripts'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
        - "49"
    scriptarguments:
      created_by: {}
      description: {}
      is_high_risk: {}
      limit: {}
      linux_supported: {}
      macos_supported: {}
      offset: {}
      script_name: {}
      windows_supported: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 7165
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: 2d718543-3c42-4fab-8f4f-3e790084049a
    type: condition
    task:
      id: 2d718543-3c42-4fab-8f4f-3e790084049a
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
        - "50"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: isNotEmpty
              left:
                value:
                  complex:
                    root: PaloAltoNetworksXDR.Scripts
                    accessor: script_uid
                    transformers:
                      - operator: FirstArrayElement
                iscontext: true
    view: |-
      {
        "position": {
          "x": 480,
          "y": 7340
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: 94e0e5c7-1317-4d5c-83d7-5416a5767221
    type: regular
    task:
      id: 94e0e5c7-1317-4d5c-83d7-5416a5767221
      version: -1
      name: xdr-get-script-metadata
      description: Gets the full definition of a specific script in the scripts library.
      script: '|||xdr-get-script-metadata'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
        - "51"
    scriptarguments:
      script_uid:
        complex:
          root: PaloAltoNetworksXDR.Scripts
          accessor: script_uid
          transformers:
            - operator: FirstArrayElement
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 7515
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: 229a807d-3057-4e10-8e9e-e3d7bf6f0579
    type: condition
    task:
      id: 229a807d-3057-4e10-8e9e-e3d7bf6f0579
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
        - "58"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.ScriptMetadata
                iscontext: true
    view: |-
      {
        "position": {
          "x": 480,
          "y": 7690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "58":
    id: "58"
    taskid: f093aad3-f833-45d6-868c-764ad3eb2ea3
    type: regular
    task:
      id: f093aad3-f833-45d6-868c-764ad3eb2ea3
      version: -1
      name: xdr-get-script-code
      description: Gets the code of a specific script in the script library.
      script: '|||xdr-get-script-code'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
        - "59"
    scriptarguments:
      script_uid:
        complex:
          root: PaloAltoNetworksXDR.Scripts
          accessor: script_uid
          transformers:
            - operator: FirstArrayElement
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 7865
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "59":
    id: "59"
    taskid: 0b6018a9-c8aa-4ae5-815e-04fb111a5a94
    type: condition
    task:
      id: 0b6018a9-c8aa-4ae5-815e-04fb111a5a94
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
        - "60"
        - "61"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.ScriptCode
                iscontext: true
    view: |-
      {
        "position": {
          "x": 480,
          "y": 8040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: acb47167-4974-4005-829f-6e22e6b8dbed
    type: playbook
    task:
      id: acb47167-4974-4005-829f-6e22e6b8dbed
      version: -1
      name: Cortex XDR - Retrieve File Playbook
      description: |-
        Retrieves files from selected endpoints. You can retrieve up to 20 files, from no more than 10 endpoints.
        Inputs for this playbook are:
        - A comma-separated list of endpoint IDs.
        - A comma-separated list of file paths for your operating system, either Windows, Linux, or Mac. At least one file path is required.
      playbookName: Cortex XDR - Retrieve File Playbook
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
        - "63"
    scriptarguments:
      endpoint_ids:
        simple: aeec6a2cc92e46fab3b6f621722e9916
      linux_file_paths: {}
      mac_file_paths: {}
      windows_file_paths:
        simple: C:\Program Files (x86)\Google\Chrome\Application\chrome.exe
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 8390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    id: "61"
    taskid: c67a4845-92f6-4352-8c04-180a1758e642
    type: regular
    task:
      id: c67a4845-92f6-4352-8c04-180a1758e642
      version: -1
      name: xdr-retrieve-files
      description: Retrieves files from selected endpoints. You can retrieve up to
        20 files, from no more than 10 endpoints. At least one endpoint ID and one
        file path are necessary in order to run the command. After running this command,
        you can use the xdr-action-status-get command with returned action_id, to
        check the action status.
      script: '|||xdr-retrieve-files'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
        - "62"
    scriptarguments:
      endpoint_ids:
        complex:
          root: PaloAltoNetworksXDR.Endpoint
          filters:
            - - operator: isEqualString
                left:
                  value:
                    simple: PaloAltoNetworksXDR.Endpoint.agent_status
                  iscontext: true
                right:
                  value:
                    simple: CONNECTED
            - - operator: isEqualString
                left:
                  value:
                    simple: PaloAltoNetworksXDR.Endpoint.agent_type
                  iscontext: true
                right:
                  value:
                    simple: Workstation
          accessor: endpoint_id
      linux_file_paths: {}
      mac_file_paths: {}
      windows_file_paths:
        simple: C:\Users\demisto\Desktop\demisto.txt
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 8215
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "62":
    id: "62"
    taskid: 94bb6ccf-1375-4c4e-8944-a37ce4023be5
    type: playbook
    task:
      id: 94bb6ccf-1375-4c4e-8944-a37ce4023be5
      version: -1
      name: Cortex XDR - Check Action Status
      description: Checks the action status of an action ID. \nEnter the action ID
        of the action whose status you want to know.
      playbookName: Cortex XDR - Check Action Status
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
        - "64"
    scriptarguments:
      action_id:
        simple: ${PaloAltoNetworksXDR.RetrievedFiles.action_id}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 8390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: be587bf1-c9b7-4634-8f6f-6c813e70becf
    type: condition
    task:
      id: be587bf1-c9b7-4634-8f6f-6c813e70becf
      version: -1
      name: Verify retrieve file
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
        - "65"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: isNotEmpty
              left:
                value:
                  simple: File.Name
                iscontext: true
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 8565
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "64":
    id: "64"
    taskid: 62f0fb59-a87c-467f-8362-7b4af2d8f3e4
    type: condition
    task:
      id: 62f0fb59-a87c-467f-8362-7b4af2d8f3e4
      version: -1
      name: Verify check action status
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
        - "65"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.GetActionStatus.status
                iscontext: true
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 8565
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "65":
    id: "65"
    taskid: f50ee2b0-01c0-4abc-808b-f3ff42edf3fd
    type: regular
    task:
      id: f50ee2b0-01c0-4abc-808b-f3ff42edf3fd
      version: -1
      name: Run Script
      description: Initiate a new endpoint script execution action using a script
        from the script library.
      script: '|||xdr-run-script'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
        - "66"
    scriptarguments:
      endpoint_ids:
        complex:
          root: PaloAltoNetworksXDR.Endpoint
          filters:
            - - operator: isEqualString
                left:
                  value:
                    simple: PaloAltoNetworksXDR.Endpoint.host_name
                  iscontext: true
                right:
                  value:
                    simple: WIN10X64
          accessor: endpoint_id
      parameters:
        simple: '{"commands_list":["echo hi"]}'
      script_uid:
        complex:
          root: PaloAltoNetworksXDR.Scripts
          filters:
            - - operator: isEqualString
                left:
                  value:
                    simple: PaloAltoNetworksXDR.Scripts.name
                  iscontext: true
                right:
                  value:
                    simple: execute_commands
          accessor: script_uid
      timeout: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 8740
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "66":
    id: "66"
    taskid: 3ea0b5c7-3485-463a-8d2e-5ab490bc01d7
    type: regular
    task:
      id: 3ea0b5c7-3485-463a-8d2e-5ab490bc01d7
      version: -1
      name: Get Script Execution Status
      description: Retrieve the status of a script execution action.
      script: '|||xdr-get-script-execution-status'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
        - "67"
    scriptarguments:
      action_id:
        simple: ${PaloAltoNetworksXDR.ScriptRun.action_id}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 8915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "67":
    id: "67"
    taskid: defe3d31-293c-4401-8e04-a6cbe2e803cb
    type: condition
    task:
      id: defe3d31-293c-4401-8e04-a6cbe2e803cb
      version: -1
      name: Verify Execution Status Is Pending
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
        - "68"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: isEqualString
              left:
                value:
                  simple: PaloAltoNetworksXDR.ScriptStatus.general_status
                iscontext: true
              right:
                value:
                  simple: PENDING
    view: |-
      {
        "position": {
          "x": 480,
          "y": 9090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "68":
    id: "68"
    taskid: 1d5814ba-e7d7-4d07-8e15-b5a23bd34d31
    type: regular
    task:
      id: 1d5814ba-e7d7-4d07-8e15-b5a23bd34d31
      version: -1
      name: Get Script Results
      description: Retrieve the results of a script execution action.
      script: '|||xdr-get-script-execution-results'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
        - "69"
    scriptarguments:
      action_id:
        simple: ${PaloAltoNetworksXDR.ScriptRun.action_id}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 9265
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "69":
    id: "69"
    taskid: f81c0f56-2f41-4f8b-8cc8-bed57d41f4ff
    type: condition
    task:
      id: f81c0f56-2f41-4f8b-8cc8-bed57d41f4ff
      version: -1
      name: Verify Execution Status Is Pending
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
        - "70"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: isEqualString
              left:
                value:
                  simple: PaloAltoNetworksXDR.ScriptResult.results.execution_status
                iscontext: true
              right:
                value:
                  simple: PENDING
    view: |-
      {
        "position": {
          "x": 480,
          "y": 9440
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "70":
    id: "70"
    taskid: 5ca23378-b822-40da-8d26-fc38db612472
    type: regular
    task:
      id: 5ca23378-b822-40da-8d26-fc38db612472
      version: -1
      name: Run snippet code script
      description: Initiate a new endpoint script execution action using provided
        snippet code.
      script: '|||xdr-run-snippet-code-script'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
        - "71"
    scriptarguments:
      endpoint_ids:
        complex:
          root: PaloAltoNetworksXDR.Endpoint
          filters:
            - - operator: isEqualString
                left:
                  value:
                    simple: PaloAltoNetworksXDR.Endpoint.host_name
                  iscontext: true
                right:
                  value:
                    simple: WIN10X64
          accessor: endpoint_id
      snippet_code:
        simple: print("hello world")
      timeout: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 9615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "71":
    id: "71"
    taskid: 7d165a7e-53a1-47d4-85cf-02aac82058d8
    type: regular
    task:
      id: 7d165a7e-53a1-47d4-85cf-02aac82058d8
      version: -1
      name: Run script execute commands
      description: Initiate a new endpoint script execution of shell commands.
      script: '|||xdr-run-script-execute-commands'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
        - "72"
    scriptarguments:
      commands:
        simple: tasklist
      endpoint_ids:
        complex:
          root: PaloAltoNetworksXDR.Endpoint
          filters:
            - - operator: isEqualString
                left:
                  value:
                    simple: PaloAltoNetworksXDR.Endpoint.host_name
                  iscontext: true
                right:
                  value:
                    simple: WIN10X64
          accessor: endpoint_id
      timeout:
        simple: "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 9790
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "72":
    id: "72"
    taskid: 78c60edb-03de-423a-865e-d030de4ea2e4
    type: regular
    task:
      id: 78c60edb-03de-423a-865e-d030de4ea2e4
      version: -1
      name: Run Script With Empty Params
      description: Initiate a new endpoint script execution action using a script
        from the script library.
      script: '|||xdr-run-script'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
        - "25"
    scriptarguments:
      endpoint_ids:
        complex:
          root: PaloAltoNetworksXDR.Endpoint
          filters:
            - - operator: isEqualString
                left:
                  value:
                    simple: PaloAltoNetworksXDR.Endpoint.host_name
                  iscontext: true
                right:
                  value:
                    simple: WIN10X64
          accessor: endpoint_id
      parameters:
        simple: ${inputs.parameters}
      script_uid:
        simple: dc5815bb786f4cc095671f3150717fc8
      timeout: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 9965
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 10155,
        "width": 922.5,
        "x": 50,
        "y": 50
      }
    }
  }
inputs:
  - key: parameters
    value: {}
    required: false
    description: ""
    playbookInputQuery: null
outputs: []
fromversion: 5.0.0