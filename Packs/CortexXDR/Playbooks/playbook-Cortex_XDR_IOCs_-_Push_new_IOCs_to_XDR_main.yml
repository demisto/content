id: Cortex XDR IOCs - Push new IOCs to XDR (main)
version: -1
name: Cortex XDR IOCs - Push new IOCs to XDR (main)
description: The playbook will "sync" IOCs into XDR by pushing new IOCs in and disabling expired IOCs.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 5681f201-b224-43f9-8af8-31939eb892ba
    type: start
    task:
      id: 5681f201-b224-43f9-8af8-31939eb892ba
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "4"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: ed493297-2c03-4460-8872-15507f4ab298
    type: regular
    task:
      id: ed493297-2c03-4460-8872-15507f4ab298
      version: -1
      name: Set Done Flag
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      key:
        simple: Done
      value:
        simple: "False"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: ffb7a6fc-6010-4c1f-864f-d3b3a9b09683
    type: title
    task:
      id: ffb7a6fc-6010-4c1f-864f-d3b3a9b09683
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: d7a43208-6964-43ca-8561-0ab354468d6a
    type: regular
    task:
      id: d7a43208-6964-43ca-8561-0ab354468d6a
      version: -1
      name: Reset Done Flag
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: Done
      value:
        simple: "False"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: e9284207-7a48-4542-8cd7-505134722980
    type: playbook
    task:
      id: e9284207-7a48-4542-8cd7-505134722980
      version: -1
      name: Cortex XDR IOCs - Push new IOCs to XDR
      playbookName: Cortex XDR IOCs - Push new IOCs to XDR
      type: playbook
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "6"
    separatecontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: 2965870e-e76a-46af-8963-410b5f24731e
    type: playbook
    task:
      id: 2965870e-e76a-46af-8963-410b5f24731e
      version: -1
      name: Cortex XDR IOCs - Disable expired IOCs in XDR
      playbookName: Cortex XDR IOCs - Disable expired IOCs in XDR
      type: playbook
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "5"
    separatecontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 910,
        "width": 380,
        "x": 50,
        "y": 50
      }
    }
  }
inputs:
- key: batch_size
  value:
    simple: "4000"
  required: false
  description: ""
  playbookInputQuery:
- key: query
  value:
    simple: reputation:Bad and (type:File or type:Domain or type:IP) and expirationStatus:active and -tags:xdr_pushed and -tags:xdr_not_processed
  required: true
  description: ""
  playbookInputQuery:
- key: query_expired
  value:
    simple: reputation:Bad and (type:File or type:Domain or type:IP) and expirationStatus:expired tags:xdr_pushed and -tags:xdr_disabled
  required: false
  description: ""
  playbookInputQuery:
outputs: []
tests:
- Test XDR Playbook general commands
- Test XDR Playbook
fromversion: 6.10.0
