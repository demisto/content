contentitemexportablefields:
  contentitemfields:
    propagationLabels:
    - all
id: Cortex XDR Partially Protected Endpoints
inputs: []
name: Cortex XDR Partially Protected Endpoints
outputs: []
quiet: true
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0318fe31-4f04-400a-867c-c431579559aa
      iscommand: false
      name: ""
      version: -1
      description: ''
    taskid: 0318fe31-4f04-400a-867c-c431579559aa
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      parse_result_file_to_context:
        simple: "true"
      query:
        simple: "dataset = endpoints\n| filter operational_status in (ENUM.UNPROTECTED, ENUM.PARTIALLY_PROTECTED )\n|fields endpoint_name,endpoint_type,endpoint_status,operational_status,operational_status_description  \n| filter (endpoint_status = CONNECTED) "
      query_name:
        simple: Operational Status
      time_frame:
        simple: 30 days
    separatecontext: false
    skipunavailable: false
    task:
      brand: Cortex XDR - XQL Query Engine
      description: |-
        Execute an XQL query and retrieve results of an executed XQL query API. The command will be executed every 10 seconds until results are retrieved or until a timeout error is raised.
        When more than 1000 results are retrieved, the command will return a compressed gzipped JSON format file,
        unless the argument 'parse_result_file_to_context' is set to true and then the results will be extracted to the context.
      id: 20da8529-74d7-44b8-8cef-93aefb33f1ad
      iscommand: true
      name: XQL Query for partially protected endpoints
      script: Cortex XDR - XQL Query Engine|||xdr-xql-generic-query
      type: regular
      version: -1
    taskid: 20da8529-74d7-44b8-8cef-93aefb33f1ad
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 195
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fa93749c-10a5-4f4b-82be-68a175de62dd
      iscommand: false
      name: Done
      type: title
      version: -1
      description: ''
    taskid: fa93749c-10a5-4f4b-82be-68a175de62dd
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 50,
          "y": 545
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      columns:
        simple: Endpoint Name,Endpoint Type, Connection Status, Protection Status
      context_path:
        simple: PaloAltoNetworksXQL.GenericQuery.results
      grid_id:
        simple: cortexxdrunprotectedendpoints
      keys:
        simple: endpoint_name,endpoint_type,endpoint_status,operational_status
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Creates a Grid table from items or key-value pairs.
      id: 1d784e40-f856-4e49-8dc6-b96005d609d4
      iscommand: false
      name: Set Grid
      scriptName: SetGridField
      type: regular
      version: -1
    taskid: 1d784e40-f856-4e49-8dc6-b96005d609d4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 370
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 560,
        "width": 380,
        "x": 50,
        "y": 50
      }
    }
  }
tests:
- No tests (auto formatted)
fromversion: 6.10.0
