category: Endpoint
commonfields:
  id: Cortex XDR - IR
  version: -1
configuration:
- display: Fetch incidents
  name: isFetch
  required: false
  type: 8
- display: Incident type
  name: incidentType
  required: false
  type: 13
- defaultvalue: None
  display: Incident Mirroring Direction
  hidden: false
  name: mirror_direction
  options:
  - None
  - Incoming
  - Outgoing
  - Both
  required: false
  type: 15
- display: Server URL (copy URL from XDR - click ? to see more info.)
  name: url
  required: true
  type: 0
- display: API Key ID
  name: apikey_id
  required: true
  type: 4
- display: API Key
  name: apikey
  required: true
  type: 4
- display: HTTP Timeout
  additionalinfo: The timeout of the HTTP requests sent to Cortex XDR API (in
    seconds).
  defaultvalue: 120
  name: timeout
  required: false
  type: 0
- defaultvalue: '10'
  display: Maximum number of incidents per fetch
  name: max_fetch
  required: false
  type: 0
  additionalinfo: The maximum number of incidents per fetch cannot exceed 100.
- defaultvalue: 3 days
  display: First fetch timestamp (<number> <time unit>, e.g., 12 hours, 7 days)
  name: fetch_time
  required: false
  type: 0
- defaultvalue: 'true'
  display: Fetch incident alerts and artifacts
  hidden: false
  name: extra_data
  required: false
  type: 8
- additionalinfo: For Cortex XSOAR version 6.0.0 and above. If selected, for every incident fetched
    from Cortex XDR to Cortex XSOAR, the incident owners will be synced. Note that once
    this value is changed and synchronized between the systems, additional changes
    will not be reflected. For example, if you change the owner in Cortex XSOAR, the
    new owner will also be changed in Cortex XDR. However, if you now change the owner
    back in Cortex XDR, this additional change will not be reflected in Cortex XSOAR. In addition,
    for this change to be reflected, the owners must exist in both Cortex XSOAR and
    Cortex XDR.
  display: Sync Incident Owners
  hidden: false
  name: sync_owners
  required: false
  type: 8
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: Cortex XDR is the world's first detection and response app that natively
  integrates network, endpoint, and cloud data to stop sophisticated attacks.
display: Palo Alto Networks Cortex XDR - Investigation and Response
name: Cortex XDR - IR
script:
  commands:
  - arguments:
    - default: false
      description: A date in the format 2019-12-31T23:59:00. Only incidents that were created on or before the specified date/time will be retrieved.
      isArray: false
      name: lte_creation_time
      required: false
      secret: false
    - default: false
      description: A date in the format 2019-12-31T23:59:00. Only incidents that were created on or after the specified date/time will be retrieved.
      isArray: false
      name: gte_creation_time
      required: false
      secret: false
    - default: false
      description: Filters returned incidents that were created on or before the specified date/time, in the format 2019-12-31T23:59:00.
      isArray: false
      name: lte_modification_time
      required: false
      secret: false
    - default: false
      description: Filters returned incidents that were modified on or after the specified date/time, in the format 2019-12-31T23:59:00.
      isArray: false
      name: gte_modification_time
      required: false
      secret: false
    - default: false
      description: An array or CSV string of incident IDs.
      isArray: true
      name: incident_id_list
      required: false
      secret: false
    - default: false
      description: Filters returned incidents that were created on or after the specified date/time range, for example, 1 month, 2 days, 1 hour, and so on.
      isArray: false
      name: since_creation_time
      required: false
      secret: false
    - default: false
      description: Filters returned incidents that were modified on or after the specified date/time range, for example, 1 month, 2 days, 1 hour, and so on.
      isArray: false
      name: since_modification_time
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Sorts returned incidents by the date/time that the incident was last modified ("asc" - ascending, "desc" - descending).
      isArray: false
      name: sort_by_modification_time
      predefined:
      - asc
      - desc
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Sorts returned incidents by the date/time that the incident was created ("asc" - ascending, "desc" - descending).
      isArray: false
      name: sort_by_creation_time
      predefined:
      - asc
      - desc
      required: false
      secret: false
    - default: false
      defaultValue: '0'
      description: Page number (for pagination). The default is 0 (the first page).
      isArray: false
      name: page
      required: false
      secret: false
    - default: false
      defaultValue: '100'
      description: Maximum number of incidents to return per page. The default and maximum is 100.
      isArray: false
      name: limit
      required: false
      secret: false
    deprecated: false
    description: |-
      Returns a list of incidents, which you can filter by a list of incident IDs (max. 100), the time the incident was last modified, and the time the incident was created.
      If you pass multiple filtering arguments, they will be concatenated using the AND condition. The OR condition is not supported.
    execution: false
    name: xdr-get-incidents
    outputs:
    - contextPath: PaloAltoNetworksXDR.Incident.incident_id
      description: Unique ID assigned to each returned incident.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.manual_severity
      description: Incident severity assigned by the user. This does not affect the calculated severity. Can be "low", "medium", "high"
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.manual_description
      description: Incident description provided by the user.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.assigned_user_mail
      description: Email address of the assigned user.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.high_severity_alert_count
      description: Number of alerts with the severity HIGH.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.host_count
      description: Number of hosts involved in the incident.
      type: number
    - contextPath: PaloAltoNetworksXDR.Incident.xdr_url
      description: A link to the incident view on XDR.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.assigned_user_pretty_name
      description: Full name of the user assigned to the incident.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.alert_count
      description: Total number of alerts in the incident.
      type: number
    - contextPath: PaloAltoNetworksXDR.Incident.med_severity_alert_count
      description: Number of alerts with the severity MEDIUM.
      type: number
    - contextPath: PaloAltoNetworksXDR.Incident.user_count
      description: Number of users involved in the incident.
      type: number
    - contextPath: PaloAltoNetworksXDR.Incident.severity
      description: |
        Calculated severity of the incident. Valid values are:
        "low","medium","high"
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.low_severity_alert_count
      description: Number of alerts with the severity LOW.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.status
      description: |
        Current status of the incident. Valid values are: "new","under_investigation","resolved_threat_handled","resolved_known_issue","resolved_duplicate","resolved_false_positive", or "resolved_other".
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.description
      description: Dynamic calculated description of the incident.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.resolve_comment
      description: Comments entered by the user when the incident was resolved.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.notes
      description: Comments entered by the user regarding the incident.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.creation_time
      description: Date and time the incident was created on XDR.
      type: date
    - contextPath: PaloAltoNetworksXDR.Incident.detection_time
      description: Date and time that the first alert occurred in the incident.
      type: date
    - contextPath: PaloAltoNetworksXDR.Incident.modification_time
      description: Date and time that the incident was last modified.
      type: date
  - arguments:
    - default: false
      description: The ID of the incident for which to get additional data.
      isArray: false
      name: incident_id
      required: true
      secret: false
    - default: false
      defaultValue: '1000'
      description: Maximum number of alerts to return. Default is 1,000.
      isArray: false
      name: alerts_limit
      required: false
      secret: false
    - default: false
      defaultValue: 'False'
      description: Return data only if the incident was changed since the last time
        it was mirrored in to XSOAR.  This flag should be used only from within a
        XDR incident.
      isArray: false
      name: return_only_updated_incident
      required: false
      secret: false
    deprecated: false
    description: Returns additional data for the specified incident, for example, related alerts, file artifacts, network artifacts, and so on.
    execution: false
    name: xdr-get-incident-extra-data
    outputs:
    - contextPath: PaloAltoNetworksXDR.Incident.incident_id
      description: Unique ID assigned to each returned incident.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.creation_time
      description: Date and time the incident was created on XDR.
      type: Date
    - contextPath: PaloAltoNetworksXDR.Incident.modification_time
      description: Date and time that the incident was last modified.
      type: Date
    - contextPath: PaloAltoNetworksXDR.Incident.detection_time
      description: Date and time that the first alert occurred in the incident.
      type: Date
    - contextPath: PaloAltoNetworksXDR.Incident.status
      description: |-
        Current status of the incident. Valid values are:
        "new","under_investigation","resolved_threat_handled","resolved_known_issue","resolved_duplicate","resolved_false_positive","resolved_other"
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.severity
      description: 'Calculated severity of the incident. Valid values are: "low","medium","high"'
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.description
      description: Dynamic calculated description of the incident.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.assigned_user_mail
      description: Email address of the assigned user.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.assigned_user_pretty_name
      description: Full name of the user assigned to the incident.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.alert_count
      description: Total number of alerts in the incident.
      type: Number
    - contextPath: PaloAltoNetworksXDR.Incident.low_severity_alert_count
      description: Number of alerts with the severity LOW.
      type: Number
    - contextPath: PaloAltoNetworksXDR.Incident.med_severity_alert_count
      description: Number of alerts with the severity MEDIUM.
      type: Number
    - contextPath: PaloAltoNetworksXDR.Incident.high_severity_alert_count
      description: Number of alerts with the severity HIGH.
      type: Number
    - contextPath: PaloAltoNetworksXDR.Incident.user_count
      description: Number of users involved in the incident.
      type: Number
    - contextPath: PaloAltoNetworksXDR.Incident.host_count
      description: Number of hosts involved in the incident
      type: Number
    - contextPath: PaloAltoNetworksXDR.Incident.notes
      description: Comments entered by the user regarding the incident.
      type: Unknown
    - contextPath: PaloAltoNetworksXDR.Incident.resolve_comment
      description: Comments entered by the user when the incident was resolved.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.manual_severity
      description: Incident severity assigned by the user. This does not affect the
        calculated severity of low, medium, or high.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.manual_description
      description: Incident description provided by the user.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.xdr_url
      description: A link to the incident view on XDR.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.starred
      description: Incident starred.
      type: Boolean
    - contextPath: PaloAltoNetworksXDR.Incident.alerts.alert_id
      description: Unique ID for each alert.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.alerts.detection_timestamp
      description: Date and time that the alert occurred.
      type: Date
    - contextPath: PaloAltoNetworksXDR.Incident.alerts.source
      description: Source of the alert. The product/vendor this alert came from.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.alerts.severity
      description: 'Severity of the alert.Valid values are: "low","medium","high"""'
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.alerts.name
      description: Calculated name of the alert.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.alerts.category
      description: Category of the alert, for example, Spyware Detected via Anti-Spyware profile.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.alerts.description
      description: Textual description of the alert.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.alerts.host_ip_list
      description: Host IP involved in the alert.
      type: Unknown
    - contextPath: PaloAltoNetworksXDR.Incident.alerts.host_name
      description: Host name involved in the alert.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.alerts.user_name
      description: User name involved with the alert.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.alerts.event_type
      description: 'Event type. Valid values are: "Process Execution","Network Event","File Event","Registry
        Event","Injection Event","Load Image Event","Windows Event Log"'
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.alerts.action
      description: 'The action that triggered the alert. Valid values are: "REPORTED", "BLOCKED", "POST_DETECTED",
        "SCANNED", "DOWNLOAD", "PROMPT_ALLOW", "PROMPT_BLOCK", "DETECTED", "BLOCKED_1",
        "BLOCKED_2", "BLOCKED_3", "BLOCKED_5", "BLOCKED_6", "BLOCKED_7", "BLOCKED_8",
        "BLOCKED_9", "BLOCKED_10", "BLOCKED_11", "BLOCKED_13", "BLOCKED_14", "BLOCKED_15",
        "BLOCKED_16", "BLOCKED_17", "BLOCKED_24", "BLOCKED_25", "DETECTED_0", "DETECTED_4",
        "DETECTED_18", "DETECTED_19", "DETECTED_20", "DETECTED_21", "DETECTED_22",
        "DETECTED_23"'
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.alerts.action_pretty
      description: 'The action that triggered the alert. Valid values are: "Detected (Reported)" "Prevented
        (Blocked)" "Detected (Post Detected)" "Detected (Scanned)" "Detected (Download)"
        "Detected (Prompt Allow)" "Prevented (Prompt Block)" "Detected" "Prevented
        (Denied The Session)" "Prevented (Dropped The Session)" "Prevented (Dropped
        The Session And Sent a TCP Reset)" "Prevented (Blocked The URL)" "Prevented
        (Blocked The IP)" "Prevented (Dropped The Packet)" "Prevented (Dropped All
        Packets)" "Prevented (Terminated The Session And Sent a TCP Reset To Both
        Sides Of The Connection)" "Prevented (Terminated The Session And Sent a TCP
        Reset To The Client)" "Prevented (Terminated The Session And Sent a TCP Reset
        To The Server)" "Prevented (Continue)" "Prevented (Block-Override)" "Prevented
        (Override-Lockout)" "Prevented (Override)" "Prevented (Random-Drop)" "Prevented
        (Silently Dropped The Session With An ICMP Unreachable Message To The Host
        Or Application)" "Prevented (Block)" "Detected (Allowed The Session)" "Detected
        (Raised An Alert)" "Detected (Syncookie Sent)" "Detected (Forward)" "Detected
        (Wildfire Upload Success)" "Detected (Wildfire Upload Failure)" "Detected
        (Wildfire Upload Skip)" "Detected (Sinkhole)"'
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.alerts.actor_process_image_name
      description: Image name.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.alerts.actor_process_command_line
      description: Command line.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.alerts.actor_process_signature_status
      description: 'Signature status. Valid values are: "Signed" "Invalid Signature" "Unsigned" "Revoked"
        "Signature Fail" "N/A" "Weak Hash".'
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.alerts.actor_process_signature_vendor
      description: Singature vendor name.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.alerts.causality_actor_process_image_name
      description: Image name.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.alerts.causality_actor_process_command_line
      description: Command line.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.alerts.causality_actor_process_signature_status
      description: 'Signature status. Valid values are: "Signed" "Invalid Signature" "Unsigned" "Revoked"
        "Signature Fail" "N/A" "Weak Hash"'
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.alerts.causality_actor_process_signature_vendor
      description: Signature vendor.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.alerts.causality_actor_causality_id
      description: Causality id.
      type: Unknown
    - contextPath: PaloAltoNetworksXDR.Incident.alerts.action_process_image_name
      description: Image name.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.alerts.action_process_image_command_line
      description: Command line.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.alerts.action_process_image_sha256
      description: Image SHA256.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.alerts.action_process_signature_status
      description: 'Signature status. Valid values are: "Signed" "Invalid Signature" "Unsigned" "Revoked"
        "Signature Fail" "N/A" "Weak Hash"'
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.alerts.action_process_signature_vendor
      description: Signature vendor name.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.alerts.action_file_path
      description: File path.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.alerts.action_file_md5
      description: File MD5.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.alerts.action_file_sha256
      description: File SHA256.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.alerts.action_registry_data
      description: Registry data.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.alerts.action_registry_full_key
      description: Registry full key.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.alerts.action_local_ip
      description: Local IP.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.alerts.action_local_port
      description: Local port.
      type: Number
    - contextPath: PaloAltoNetworksXDR.Incident.alerts.action_remote_ip
      description: Remote IP.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.alerts.action_remote_port
      description: Remote port.
      type: Number
    - contextPath: PaloAltoNetworksXDR.Incident.alerts.action_external_hostname
      description: External hostname.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.alerts.fw_app_id
      description: Firewall app id.
      type: Unknown
    - contextPath: PaloAltoNetworksXDR.Incident.alerts.is_whitelisted
      description: 'Is the alert whitelisted. Valid values are: "Yes" "No"'
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.alerts.starred
      description: Alert starred.
      type: Boolean
    - contextPath: PaloAltoNetworksXDR.Incident.network_artifacts.type
      description: Network artifact type.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.network_artifacts.network_remote_port
      description: The remote port related to the artifact.
      type: number
    - contextPath: PaloAltoNetworksXDR.Incident.network_artifacts.alert_count
      description: Number of alerts related to the artifact.
      type: number
    - contextPath: PaloAltoNetworksXDR.Incident.network_artifacts.network_remote_ip
      description: The remote IP related to the artifact.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.network_artifacts.is_manual
      description: Whether the artifact was created by the user (manually).
      type: boolean
    - contextPath: PaloAltoNetworksXDR.Incident.network_artifacts.network_domain
      description: The domain related to the artifact.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.network_artifacts.type
      description: 'The artifact type. Valid values are: "META", "GID", "CID", "HASH", "IP", "DOMAIN",
        "REGISTRY", "HOSTNAME"'
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.network_artifacts.network_country
      description: The country related to the artifact.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.file_artifacts.file_signature_status
      description: 'Digital signature status of the file. Valid values are: "SIGNATURE_UNAVAILABLE" "SIGNATURE_SIGNED"
        "SIGNATURE_INVALID" "SIGNATURE_UNSIGNED" "SIGNATURE_WEAK_HASH"'
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.file_artifacts.is_process
      description: Whether the file artifact is related to a process execution.
      type: boolean
    - contextPath: PaloAltoNetworksXDR.Incident.file_artifacts.file_name
      description: Name of the file.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.file_artifacts.file_wildfire_verdict
      description: 'The file verdict, calculated by Wildfire. Valid values are: "BENIGN" "MALWARE" "GRAYWARE"
        "PHISING" "UNKNOWN".'
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.file_artifacts.alert_count
      description: Number of alerts related to the artifact.
      type: number
    - contextPath: PaloAltoNetworksXDR.Incident.file_artifacts.is_malicious
      description: Whether the artifact is malicious, as decided by the Wildfire verdict.
      type: boolean
    - contextPath: PaloAltoNetworksXDR.Incident.file_artifacts.is_manual
      description: Whether the artifact was created by the user (manually).
      type: boolean
    - contextPath: PaloAltoNetworksXDR.Incident.file_artifacts.type
      description: 'The artifact type. Valid values are: "META" "GID" "CID" "HASH" "IP" "DOMAIN" "REGISTRY"
        "HOSTNAME"'
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.file_artifacts.file_sha256
      description: SHA-256 hash of the file.
      type: String
    - contextPath: PaloAltoNetworksXDR.Incident.file_artifacts.file_signature_vendor_name
      description: File signature vendor name.
      type: String
    - contextPath: Account.Username
      description: The username in the relevant system.
      type: String
    - contextPath: Endpoint.Hostname
      description: The hostname that is mapped to this endpoint.
      type: String
  - arguments:
    - default: false
      description: XDR incident ID. You can get the incident ID from the output of the 'xdr-get-incidents' command or the 'xdr-get-incident-extra-details' command.
      isArray: false
      name: incident_id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Severity to assign to the incident (LOW, MEDIUM, or HIGH).
      isArray: false
      name: manual_severity
      predefined:
      - HIGH
      - MEDIUM
      - LOW
      required: false
      secret: false
    - default: false
      description: Email address of the user to assign to the incident.
      isArray: false
      name: assigned_user_mail
      required: false
      secret: false
    - default: false
      description: Full name of the user assigned to the incident.
      isArray: false
      name: assigned_user_pretty_name
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: 'Status of the incident. Valid values are: NEW, UNDER_INVESTIGATION, RESOLVED_THREAT_HANDLED,
        RESOLVED_KNOWN_ISSUE, RESOLVED_DUPLICATE, RESOLVED_FALSE_POSITIVE, RESOLVED_OTHER.'
      isArray: false
      name: status
      predefined:
      - NEW
      - UNDER_INVESTIGATION
      - RESOLVED_THREAT_HANDLED
      - RESOLVED_KNOWN_ISSUE
      - RESOLVED_DUPLICATE
      - RESOLVED_FALSE_POSITIVE
      - RESOLVED_OTHER
      required: false
      secret: false
    - default: false
      description: Comment explaining why the incident was resolved. This should be set when the incident is resolved.
      isArray: false
      name: resolve_comment
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: If true, will remove all assigned users from the incident.
      isArray: false
      name: unassign_user
      predefined:
      - 'true'
      required: false
      secret: false
    deprecated: false
    description: Updates one or more fields of a specified incident. Missing fields
      will be ignored. To remove the assignment for an incident, pass a null value
      in the assignee email argument.
    execution: false
    name: xdr-update-incident
  - arguments:
    - default: false
      description: String value that defines the product.
      isArray: false
      name: product
      required: true
      secret: false
    - default: false
      description: String value that defines the product.
      isArray: false
      name: vendor
      required: true
      secret: false
    - default: false
      description: String value for the source IP address.
      isArray: false
      name: local_ip
      required: false
      secret: false
    - default: false
      description: Integer value for the source port.
      isArray: false
      name: local_port
      required: true
      secret: false
    - default: false
      description: |-
        String value of the destination IP
        address.
      isArray: false
      name: remote_ip
      required: true
      secret: false
    - default: false
      description: |-
        Integer value for the destination
        port.
      isArray: false
      name: remote_port
      required: true
      secret: false
    - default: false
      description: Integer value representing the epoch of the time the alert occurred
        in milliseconds, or a string value in date format 2019-10-23T10:00:00. If not
        set, the event time will be defined as now.
      isArray: false
      name: event_timestampt
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: |-
        String value of alert severity. Valid values are:
        Informational, Low, Medium, High, or Unknown
      isArray: false
      name: severity
      predefined:
      - Informational
      - Low
      - Medium
      - High
      - Unknown
      required: false
      secret: false
    - default: false
      description: String defining the alert name.
      isArray: false
      name: alert_name
      required: true
      secret: false
    - default: false
      description: String defining the alert description.
      isArray: false
      name: alert_description
      required: false
      secret: false
    deprecated: false
    description: |-
      Upload alert from external alert sources in Cortex XDR format. Cortex XDR displays alerts that are parsed
      successfully in related incidents and views. You can send 600 alerts per minute. Each request can contain a
      maximum of 60 alerts.
    execution: false
    name: xdr-insert-parsed-alert
  - arguments:
    - default: false
      description: List of alerts in CEF format.
      isArray: true
      name: cef_alerts
      required: true
      secret: false
    deprecated: false
    description: Upload alerts in CEF format from external alert sources. After you map CEF alert fields to Cortex XDR fields, Cortex XDR displays the alerts in related incidents and views. You can send 600 requests per minute. Each request can contain a maximum of 60 alerts.
    execution: false
    name: xdr-insert-cef-alerts
  - arguments:
    - default: false
      description: The endpoint ID (string) to isolate. You can retrieve the string from the xdr-get-endpoints command.
      isArray: false
      name: endpoint_id
      required: true
      secret: false
    deprecated: false
    description: Isolates the specified endpoint.
    execution: true
    name: xdr-isolate-endpoint
    outputs:
    - contextPath: PaloAltoNetworksXDR.Isolation.endpoint_id
      description: The endpoint ID.
      type: String
  - arguments:
    - default: false
      description: The endpoint ID (string) for which to reverse the isolation. You can retrieve it from the xdr-get-endpoints command.
      isArray: false
      name: endpoint_id
      required: true
      secret: false
    deprecated: false
    description: Reverses the isolation of an endpoint.
    execution: true
    name: xdr-unisolate-endpoint
    outputs:
    - contextPath: PaloAltoNetworksXDR.UnIsolation.endpoint_id
      description: Isolates the specified endpoint.
      type: String
  - arguments:
    - default: false
      description: A comma-separated list of endpoint IDs.
      isArray: true
      name: endpoint_id_list
      required: false
      secret: false
    - default: false
      description: "A comma-separated list of distribution package names or installation package names. \nExample: dist_name1,dist_name2"
      isArray: true
      name: dist_name
      required: false
      secret: false
    - default: false
      description: |-
        A comma-separated list of IP addresses.
        Example: 8.8.8.8,1.1.1.1
      isArray: true
      name: ip_list
      required: false
      secret: false
    - default: false
      description: |-
        The group name to which the agent belongs.
        Example: group_name1,group_name2
      isArray: true
      name: group_name
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: 'The endpoint platform. Valid values are\: "windows", "linux", "macos", or "android". '
      isArray: true
      name: platform
      predefined:
      - windows
      - linux
      - macos
      - android
      required: false
      secret: false
    - default: false
      description: |-
        A comma-separated list of alias names.
        Examples: alias_name1,alias_name2
      isArray: true
      name: alias_name
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: 'Specifies whether the endpoint was isolated or unisolated.'
      isArray: false
      name: isolate
      predefined:
      - isolated
      - unisolated
      required: false
      secret: false
    - default: false
      description: |-
        Hostname
        Example: hostname1,hostname2
      isArray: true
      name: hostname
      required: false
      secret: false
    - default: false
      description: |-
        All the agents that were first seen after {first_seen_gte}.
        Supported values:
        1579039377301 (time in milliseconds)
        "3 days" (relative date)
        "2019-10-21T23:45:00" (date)
      isArray: false
      name: first_seen_gte
      required: false
      secret: false
    - default: false
      description: |-
        All the agents that were first seen before {first_seen_lte}.
        Supported values:
        1579039377301 (time in milliseconds)
        "3 days" (relative date)
        "2019-10-21T23:45:00" (date)
      isArray: false
      name: first_seen_lte
      required: false
      secret: false
    - default: false
      description: |-
        All the agents that were last seen before {last_seen_gte}.
        Supported values:
        1579039377301 (time in milliseconds)
        "3 days" (relative date)
        "2019-10-21T23:45:00" (date)
      isArray: false
      name: last_seen_gte
      required: false
      secret: false
    - default: false
      description: |-
        All the agents that were last seen before {last_seen_lte}.
        Supported values:
        1579039377301 (time in milliseconds)
        "3 days" (relative date)
        "2019-10-21T23:45:00" (date)
      isArray: false
      name: last_seen_lte
      required: false
      secret: false
    - default: false
      defaultValue: '0'
      description: Page number (for pagination). The default is 0 (the first page).
      isArray: false
      name: page
      required: false
      secret: false
    - default: false
      defaultValue: '30'
      description: Maximum number of endpoints to return per page. The default and maximum is 30.
      isArray: false
      name: limit
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Specifies whether to sort endpoints by the first time or last time they were seen. Can be "first_seen" or "last_seen".
      isArray: false
      name: sort_by
      predefined:
      - first_seen
      - last_seen
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: asc
      description: The order by which to sort results. Can be "asc" (ascending) or "desc" ( descending). Default set to asc.
      isArray: false
      name: sort_order
      predefined:
      - asc
      - desc
      required: false
      secret: false
    deprecated: false
    description: Gets a list of endpoints, according to the passed filters. If there
      are no filters, all endpoints are returned. Filtering by multiple fields will
      be concatenated using AND condition (OR is not supported). Maximum result set
      size is 100. Offset is the zero-based number of endpoint from the start of the
      result set (start by counting from 0).
    execution: false
    name: xdr-get-endpoints
    outputs:
    - contextPath: PaloAltoNetworksXDR.Endpoint.endpoint_id
      description: The endpoint ID.
      type: String
    - contextPath: PaloAltoNetworksXDR.Endpoint.endpoint_name
      description: The endpoint name.
      type: String
    - contextPath: PaloAltoNetworksXDR.Endpoint.endpoint_type
      description: The endpoint type.
      type: String
    - contextPath: PaloAltoNetworksXDR.Endpoint.endpoint_status
      description: The status of the endpoint.
      type: String
    - contextPath: PaloAltoNetworksXDR.Endpoint.os_type
      description: The endpoint OS type.
      type: String
    - contextPath: PaloAltoNetworksXDR.Endpoint.ip
      description: A list of IP addresses.
      type: Unknown
    - contextPath: PaloAltoNetworksXDR.Endpoint.users
      description: A list of users.
      type: Unknown
    - contextPath: PaloAltoNetworksXDR.Endpoint.domain
      description: The endpoint domain.
      type: String
    - contextPath: PaloAltoNetworksXDR.Endpoint.alias
      description: The endpoint's aliases.
      type: String
    - contextPath: PaloAltoNetworksXDR.Endpoint.first_seen
      description: First seen date/time in Epoch (milliseconds).
      type: Unknown
    - contextPath: PaloAltoNetworksXDR.Endpoint.last_seen
      description: Last seen date/time in Epoch (milliseconds).
      type: Date
    - contextPath: PaloAltoNetworksXDR.Endpoint.content_version
      description: Content version.
      type: String
    - contextPath: PaloAltoNetworksXDR.Endpoint.installation_package
      description: Installation package.
      type: String
    - contextPath: PaloAltoNetworksXDR.Endpoint.active_directory
      description: Active directory.
      type: String
    - contextPath: PaloAltoNetworksXDR.Endpoint.install_date
      description: Install date in Epoch (milliseconds).
      type: Date
    - contextPath: PaloAltoNetworksXDR.Endpoint.endpoint_version
      description: Endpoint version.
      type: String
    - contextPath: PaloAltoNetworksXDR.Endpoint.is_isolated
      description: Whether the endpoint is isolated.
      type: String
    - contextPath: PaloAltoNetworksXDR.Endpoint.group_name
      description: The name of the group to which the endpoint belongs.
      type: String
    - contextPath: Endpoint.Hostname
      description: The hostname that is mapped to this endpoint.
      type: String
    - contextPath: Endpoint.ID
      description: The unique ID within the tool retrieving the endpoint.
      type: String
    - contextPath: Endpoint.IPAddress
      description: The IP address of the endpoint.
      type: String
    - contextPath: Endpoint.Domain
      description: The domain of the endpoint.
      type: String
    - contextPath: Endpoint.OS
      description: Endpoint OS.
      type: String
  - deprecated: false
    description: Gets a list of all the agent versions to use for creating a distribution list.
    execution: false
    name: xdr-get-distribution-versions
    outputs:
    - contextPath: PaloAltoNetworksXDR.DistributionVersions.windows
      description: A list of Windows agent versions.
      type: Unknown
    - contextPath: PaloAltoNetworksXDR.DistributionVersions.linux
      description: A list of Linux agent versions.
      type: Unknown
    - contextPath: PaloAltoNetworksXDR.DistributionVersions.macos
      description: A list of Mac agent versions.
      type: Unknown
  - arguments:
    - default: false
      description: A string representing the name of the installation package.
      isArray: false
      name: name
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: "String, valid values are:\n• windows \n• linux\n• macos \n• android"
      isArray: false
      name: platform
      predefined:
      - windows
      - linux
      - macos
      - android
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: |-
        A string representing the type of package to create.
        standalone - An installation for a new agent
        upgrade - An upgrade of an agent from ESM
      isArray: false
      name: package_type
      predefined:
      - standalone
      - upgrade
      required: true
      secret: false
    - default: false
      description: agent_version returned from xdr-get-distribution-versions. Not required for Android platfom
      isArray: false
      name: agent_version
      required: true
      secret: false
    - default: false
      description: Information about the package.
      isArray: false
      name: description
      required: false
      secret: false
    deprecated: false
    description: Creates an installation package. This is an asynchronous call that returns the distribution ID. This does not mean that the creation succeeded. To confirm that the package has been created, check the status of the distribution by running the Get Distribution Status API.
    execution: false
    name: xdr-create-distribution
    outputs:
    - contextPath: PaloAltoNetworksXDR.Distribution.id
      description: The installation package ID.
      type: String
    - contextPath: PaloAltoNetworksXDR.Distribution.name
      description: The name of the installation package.
      type: String
    - contextPath: PaloAltoNetworksXDR.Distribution.platform
      description: The installation OS.
      type: String
    - contextPath: PaloAltoNetworksXDR.Distribution.agent_version
      description: Agent version.
      type: String
    - contextPath: PaloAltoNetworksXDR.Distribution.description
      description: Information about the package.
      type: String
  - arguments:
    - default: false
      description: |-
        The ID of the installation package.
        Copy the distribution_id from the "id" field on Endpoints > Agent Installation page.
      isArray: false
      name: distribution_id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: |-
        The installation package type. Valid
        values are:
        • upgrade
        • sh - For Linux
        • rpm - For Linux
        • deb - For Linux
        • pkg - For Mac
        • x86 - For Windows
        • x64 - For Windows
      isArray: false
      name: package_type
      predefined:
      - upgrade
      - sh
      - rpm
      - deb
      - pkg
      - x86
      - x64
      required: true
      secret: false
    deprecated: false
    description: Gets the distribution URL for downloading the installation package.
    execution: false
    name: xdr-get-distribution-url
    outputs:
    - contextPath: PaloAltoNetworksXDR.Distribution.id
      description: Distribution ID.
      type: String
    - contextPath: PaloAltoNetworksXDR.Distribution.url
      description: URL for downloading the installation package.
      type: String
  - arguments:
    - default: false
      description: A comma-separated list of distribution IDs to get the status of.
      isArray: true
      name: distribution_ids
      required: true
      secret: false
    deprecated: false
    description: Gets the status of the installation package.
    execution: false
    name: xdr-get-create-distribution-status
    outputs:
    - contextPath: PaloAltoNetworksXDR.Distribution.id
      description: Distribution ID.
      type: String
    - contextPath: PaloAltoNetworksXDR.Distribution.status
      description: The status of installation package.
      type: String
  - arguments:
    - default: false
      description: User’s email address.
      isArray: false
      name: email
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: The audit log type.
      isArray: false
      name: type
      predefined:
      - REMOTE_TERMINAL
      - RULES
      - AUTH
      - RESPONSE
      - INCIDENT_MANAGEMENT
      - ENDPOINT_MANAGEMENT
      - ALERT_WHITELIST
      - PUBLIC_API
      - DISTRIBUTIONS
      - STARRED_INCIDENTS
      - POLICY_PROFILES
      - DEVICE_CONTROL_PROFILE
      - HOST_FIREWALL_PROFILE
      - POLICY_RULES
      - PROTECTION_POLICY
      - DEVICE_CONTROL_TEMP_EXCEPTIONS
      - DEVICE_CONTROL_GLOBAL_EXCEPTIONS
      - GLOBAL_EXCEPTIONS
      - MSSP
      - REPORTING
      - DASHBOARD
      - BROKER_VM
      required: false
      secret: false
    - default: false
      description: The audit log subtype.
      isArray: false
      name: sub_type
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Result type
      isArray: false
      name: result
      predefined:
      - SUCCESS
      - FAIL
      - PARTIAL
      required: false
      secret: false
    - default: false
      description: |-
        Return logs for which the timestamp is after 'log_time_after'.
        Supported values:
        1579039377301 (time in milliseconds)
        "3 days" (relative date)
        "2019-10-21T23:45:00" (date)
      isArray: false
      name: timestamp_gte
      required: false
      secret: false
    - default: false
      description: |-
        Return logs for which the timestamp is before the 'log_time_after'.
        Supported values:
        1579039377301 (time in milliseconds)
        "3 days" (relative date)
        "2019-10-21T23:45:00" (date)
      isArray: false
      name: timestamp_lte
      required: false
      secret: false
    - default: false
      defaultValue: '0'
      description: Page number (for pagination). The default is 0 (the first page).
      isArray: false
      name: page
      required: false
      secret: false
    - default: false
      defaultValue: '30'
      description: Maximum number of audit logs to return per page. The default and maximum is 30.
      isArray: false
      name: limit
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Specifies the field by which to sort the results. By default the sort is defined as creation-time and DESC. Can be "type", "sub_type", "result", or "timestamp".
      isArray: false
      name: sort_by
      predefined:
      - type
      - sub_type
      - result
      - timestamp
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: desc
      description: The sort order. Can be "asc" (ascending) or "desc" (descending). Default set to "desc".
      isArray: false
      name: sort_order
      predefined:
      - asc
      - desc
      required: false
      secret: false
    deprecated: false
    description: Gets management logs. You can filter by multiple fields, which will
      be concatenated using the AND condition (OR is not supported). Maximum result set
      size is 100. Offset is the zero-based number of management logs from the start
      of the result set (start by counting from 0).
    execution: false
    name: xdr-get-audit-management-logs
    outputs:
    - contextPath: PaloAltoNetworksXDR.AuditManagementLogs.AUDIT_ID
      description: Audit log ID.
      type: Number
    - contextPath: PaloAltoNetworksXDR.AuditManagementLogs.AUDIT_OWNER_NAME
      description: Audit owner name.
      type: String
    - contextPath: PaloAltoNetworksXDR.AuditManagementLogs.AUDIT_OWNER_EMAIL
      description: Audit owner email address.
      type: String
    - contextPath: PaloAltoNetworksXDR.AuditManagementLogs.AUDIT_ASSET_JSON
      description: Asset JSON.
      type: String
    - contextPath: PaloAltoNetworksXDR.AuditManagementLogs.AUDIT_ASSET_NAMES
      description: Audit asset names.
      type: String
    - contextPath: PaloAltoNetworksXDR.AuditManagementLogs.AUDIT_HOSTNAME
      description: Host name.
      type: String
    - contextPath: PaloAltoNetworksXDR.AuditManagementLogs.AUDIT_RESULT
      description: Audit result.
      type: String
    - contextPath: PaloAltoNetworksXDR.AuditManagementLogs.AUDIT_REASON
      description: Audit reason.
      type: String
    - contextPath: PaloAltoNetworksXDR.AuditManagementLogs.AUDIT_DESCRIPTION
      description: Description of the audit.
      type: String
    - contextPath: PaloAltoNetworksXDR.AuditManagementLogs.AUDIT_ENTITY
      description: Audit entity (e.g., AUTH, DISTRIBUTIONS).
      type: String
    - contextPath: PaloAltoNetworksXDR.AuditManagementLogs.AUDIT_ENTITY_SUBTYPE
      description: Entity subtype (e.g., Login, Create).
      type: String
    - contextPath: PaloAltoNetworksXDR.AuditManagementLogs.AUDIT_CASE_ID
      description: Audit case ID.
      type: Number
    - contextPath: PaloAltoNetworksXDR.AuditManagementLogs.AUDIT_INSERT_TIME
      description: Log's insert time.
      type: Date
  - arguments:
    - default: false
      description: A comma-separated list of endpoint IDs.
      isArray: true
      name: endpoint_ids
      required: false
      secret: false
    - default: false
      description: A comma-separated list of endpoint names.
      isArray: true
      name: endpoint_names
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: The report type. Can be "Installation", "Policy", "Action", "Agent Service", "Agent Modules", or "Agent Status".
      isArray: true
      name: type
      predefined:
      - Installation
      - Policy
      - Action
      - Agent Service
      - Agent Modules
      - Agent Status
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: The report subtype.
      isArray: true
      name: sub_type
      predefined:
      - Install
      - Uninstall
      - Upgrade
      - Local Configuration
      - Content Update
      - Policy Update
      - Process Exception
      - Hash Exception
      - Scan
      - File Retrieval
      - File Scan
      - Terminate Process
      - Isolate
      - Cancel Isolation
      - Payload Execution
      - Quarantine
      - Restore
      - Stop
      - Start
      - Module Initialization
      - Local Analysis Model
      - Local Analysis Feature Extraction
      - Fully Protected
      - OS Incompatible
      - Software Incompatible
      - Kernel Driver Initialization
      - Kernel Extension Initialization
      - Proxy Communication
      - Quota Exceeded
      - Minimal Content
      - Reboot Eequired
      - Missing Disc Access
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: The result type. Can be "Success" or "Fail". If not passed, returns all event reports.
      isArray: true
      name: result
      predefined:
      - Success
      - Fail
      required: false
      secret: false
    - default: false
      description: |-
        Return logs that their timestamp is greater than 'log_time_after'.
        Supported values:
        1579039377301 (time in milliseconds)
        "3 days" (relative date)
        "2019-10-21T23:45:00" (date)
      isArray: false
      name: timestamp_gte
      required: false
      secret: false
    - default: false
      description: |-
        Return logs for which the timestamp is before the 'timestamp_lte'.

        Supported values:
        1579039377301 (time in milliseconds)
        "3 days" (relative date)
        "2019-10-21T23:45:00" (date)
      isArray: false
      name: timestamp_lte
      required: false
      secret: false
    - default: false
      defaultValue: '0'
      description: Page number (for pagination). The default is 0 (the first page).
      isArray: false
      name: page
      required: false
      secret: false
    - default: false
      defaultValue: '30'
      description: The maximum number of reports to return. Default and maximum is 30.
      isArray: false
      name: limit
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: The field by which to sort results. Can be "type", "category", "trapsversion", "timestamp", or "domain").
      isArray: false
      name: sort_by
      predefined:
      - type
      - category
      - trapsversion
      - timestamp
      - domain
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: asc
      description: The sort order. Can be "asc" (ascending) or "desc" (descending). Default is "asc".
      isArray: false
      name: sort_order
      predefined:
      - asc
      - desc
      required: false
      secret: false
    deprecated: false
    description: Gets agent event reports. You can filter by multiple fields, which
      will be concatenated using the AND condition (OR is not supported). Maximum result
      set size is 100. Offset is the zero-based number of reports from the start of
      the result set (start by counting from 0).
    execution: false
    name: xdr-get-audit-agent-reports
    outputs:
    - contextPath: PaloAltoNetworksXDR.AuditAgentReports.ENDPOINTID
      description: Endpoint ID.
      type: String
    - contextPath: PaloAltoNetworksXDR.AuditAgentReports.ENDPOINTNAME
      description: Endpoint name.
      type: String
    - contextPath: PaloAltoNetworksXDR.AuditAgentReports.DOMAIN
      description: Agent domain.
      type: String
    - contextPath: PaloAltoNetworksXDR.AuditAgentReports.TRAPSVERSION
      description: Traps version.
      type: String
    - contextPath: PaloAltoNetworksXDR.AuditAgentReports.RECEIVEDTIME
      description: Received time in Epoch time.
      type: Date
    - contextPath: PaloAltoNetworksXDR.AuditAgentReports.TIMESTAMP
      description: Timestamp in Epoch time.
      type: Date
    - contextPath: PaloAltoNetworksXDR.AuditAgentReports.CATEGORY
      description: Report category (e.g., Audit).
      type: String
    - contextPath: PaloAltoNetworksXDR.AuditAgentReports.TYPE
      description: Report type (e.g., Action, Policy).
      type: String
    - contextPath: PaloAltoNetworksXDR.AuditAgentReports.SUBTYPE
      description: Report subtype (e.g., Fully Protected,Policy Update,Cancel Isolation).
      type: String
    - contextPath: PaloAltoNetworksXDR.AuditAgentReports.RESULT
      description: Report result.
      type: String
    - contextPath: PaloAltoNetworksXDR.AuditAgentReports.REASON
      description: Report reason.
      type: String
    - contextPath: PaloAltoNetworksXDR.AuditAgentReports.DESCRIPTION
      description: Agent report description.
      type: String
  - arguments:
    - default: false
      description: String that represents a list of hashed files you want to blacklist. Must be a valid SHA256 hash.
      isArray: true
      name: hash_list
      required: true
      secret: false
    - default: false
      description: String that represents additional information regarding the action.
      isArray: false
      name: comment
      required: false
      secret: false
    deprecated: false
    description: Blacklists requested files which have not already been blacklisted or whitelisted.
    execution: false
    name: xdr-blacklist-files
  - arguments:
    - default: false
      description: String that represents a list of hashed files you want to whitelist. Must be a valid SHA256 hash.
      isArray: true
      name: hash_list
      required: true
      secret: false
    - default: false
      description: String that represents additional information regarding the action.
      isArray: false
      name: comment
      required: false
      secret: false
    deprecated: false
    description: Whitelists requested files which have not already been blacklisted or whitelisted.
    execution: false
    name: xdr-whitelist-files
  - arguments:
    - default: false
      description: List of endpoint IDs.
      isArray: true
      name: endpoint_id_list
      required: true
      secret: false
    - default: false
      description: String that represents the path of the file you want to quarantine.
      isArray: false
      name: file_path
      required: true
      secret: false
    - default: false
      description: String that represents the file’s hash. Must be a valid SHA256 hash.
      isArray: false
      name: file_hash
      required: true
      secret: false
    deprecated: false
    description: Quarantines a file on selected endpoints. You can select up to 1000 endpoints.
    execution: false
    name: xdr-quarantine-files
  - arguments:
    - default: false
      description: String the represents the endpoint ID.
      isArray: false
      name: endpoint_id
      required: true
      secret: false
    - default: false
      description: String that represents the file hash. Must be a valid SHA256 hash.
      isArray: false
      name: file_hash
      required: true
      secret: false
    - default: false
      description: String that represents the file path.
      isArray: false
      name: file_path
      required: true
      secret: false
    deprecated: false
    description: Retrieves the quarantine status for a selected file.
    execution: false
    name: xdr-get-quarantine-status
  - arguments:
    - default: false
      description: String that represents the file in hash. Must be a valid SHA256 hash.
      isArray: false
      name: file_hash
      required: true
      secret: false
    - default: false
      description: String that represents the endpoint ID. If you do not enter a specific endpoint ID, the request will run restore on all endpoints which relate to the quarantined file you defined.
      isArray: false
      name: endpoint_id
      required: false
      secret: false
    deprecated: false
    description: Restores a quarantined file on requested endpoints.
    execution: false
    name: xdr-restore-file
  - arguments:
    - default: false
      description: List of endpoint IDs.
      isArray: false
      name: endpoint_id_list
      required: false
      secret: false
    - default: false
      description: Name of the distribution list.
      isArray: false
      name: dist_name
      required: false
      secret: false
    - default: false
      description: Integer in timestamp epoch milliseconds.
      isArray: false
      name: gte_first_seen
      required: false
      secret: false
    - default: false
      description: Integer in timestamp epoch milliseconds.
      isArray: false
      name: gte_last_seen
      required: false
      secret: false
    - default: false
      description: Integer in timestamp epoch milliseconds
      isArray: false
      name: lte_first_seen
      required: false
      secret: false
    - default: false
      description: Integer in timestamp epoch milliseconds
      isArray: false
      name: lte_last_seen
      required: false
      secret: false
    - default: false
      description: List of IP addresses.
      isArray: false
      name: ip_list
      required: false
      secret: false
    - default: false
      description: Name of the endpoint group.
      isArray: false
      name: group_name
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Type of operating system.
      isArray: false
      name: platform
      predefined:
      - windows
      - linux
      - macos
      - android
      required: false
      secret: false
    - default: false
      description: Endpoint alias name.
      isArray: false
      name: alias
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Whether an endpoint has been isolated. Can be "isolated" or "unisolated".
      isArray: false
      name: isolate
      predefined:
      - isolated
      - unisolated
      required: false
      secret: false
    - default: false
      description: Name of the host.
      isArray: false
      name: hostname
      required: false
      secret: false
    deprecated: false
    description: Runs a scan on a selected endpoint. To scan all endpoints, run this command with no filters.
    execution: true
    name: xdr-endpoint-scan
  - deprecated: false
    description: Get mapping fields from remote incident. Please note that this method
      will not update the current incident, it's here for debugging purposes.
    execution: false
    name: get-mapping-fields
  - arguments:
    - default: false
      description: The remote incident id
      isArray: false
      name: id
      required: true
      secret: false
    - default: false
      defaultValue: '0'
      description: UTC timestamp in seconds. The incident is only updated if it was
        modified after the last update time.
      isArray: false
      name: lastUpdate
      required: false
      secret: false
    deprecated: false
    description: Get remote data from a remote incident. Please note that this method
      will not update the current incident, it's here for debugging purposes.
    execution: false
    name: get-remote-data
  - arguments:
    - default: false
      description: Date string representing the local time.The incident is only returned
        if it was modified after the last update time.
      isArray: false
      name: lastUpdate
      required: false
      secret: false
    deprecated: false
    description: Get the list of incidents that were modified since the last update.
      Please note that this method is here for debugging purposes. get-modified-remote-data is used as part of a Mirroring feature, which is available since version 6.1.
    execution: false
    name: get-modified-remote-data
  - arguments:
    - description: The endpoint ID. Can be retrieved by running the xdr-get-endpoints
        command.
      name: endpoint_id
      required: true
    description: Gets the policy name for a specific endpoint.
    name: xdr-get-policy
    outputs:
    - contextPath: PaloAltoNetworksXDR.Policy
      description: The policy allocated with the endpoint.
      type: string
    - contextPath: PaloAltoNetworksXDR.Policy.policy_name
      description: Name of the policy allocated with the endpoint.
      type: string
    - contextPath: PaloAltoNetworksXDR.Policy.endpoint_id
      description: Endpoint ID.
      type: string
  - arguments:
    - description: A comma-separated list of the script names.
      isArray: true
      name: script_name
    - description: A comma-separated list of the script descriptions.
      isArray: true
      name: description
    - description: A comma-separated list of the users who created the script.
      isArray: true
      name: created_by
    - description: The maximum number of scripts returned to the War Room. Default is 50.
      name: limit
    - description: (Int) Offset in the data set. Default is 0.
      name: offset
    - auto: PREDEFINED
      description: Whether the script can be executed on a Windows operating system.
      name: windows_supported
      predefined:
      - "true"
      - "false"
    - auto: PREDEFINED
      description: Whether the script can be executed on a Linux operating system.
      name: linux_supported
      predefined:
      - "true"
      - "false"
    - auto: PREDEFINED
      description: Whether the script can be executed on a Mac operating system.
      name: macos_supported
      predefined:
      - "true"
      - "false"
    - auto: PREDEFINED
      description: Whether the script has a high-risk outcome.
      name: is_high_risk
      predefined:
      - "true"
      - "false"
    description: Gets a list of scripts available in the scripts library.
    name: xdr-get-scripts
    outputs:
    - contextPath: PaloAltoNetworksXDR.Scripts
      description: The scripts command results.
    - contextPath: PaloAltoNetworksXDR.Scripts.script_id
      description: Script ID.
    - contextPath: PaloAltoNetworksXDR.Scripts.name
      description: Name of the script.
      type: string
    - contextPath: PaloAltoNetworksXDR.Scripts.description
      description: Description of the script.
      type: string
    - contextPath: PaloAltoNetworksXDR.Scripts.modification_date
      description: Timestamp of when the script was last modified.
    - contextPath: PaloAltoNetworksXDR.Scripts.created_by
      description: Name of the user who created the script.
      type: string
    - contextPath: PaloAltoNetworksXDR.Scripts.windows_supported
      description: Whether the script can be executed on a Windows operating system.
      type: boolean
    - contextPath: PaloAltoNetworksXDR.Scripts.linux_supported
      description: Whether the script can be executed on a Linux operating system.
      type: boolean
    - contextPath: PaloAltoNetworksXDR.Scripts.macos_supported
      description: Whether the script can be executed on Mac operating system.
      type: boolean
    - contextPath: PaloAltoNetworksXDR.Scripts.is_high_risk
      description: Whether the script has a high-risk outcome.
      type: boolean
    - contextPath: PaloAltoNetworksXDR.Scripts.script_uid
      description: Globally Unique Identifier of the script, used to identify the script when
        executing.
      type: string
  - arguments:
    - description: Comma-separated list of endpoint IDs. You can retrieve the endpoint IDs from the xdr-get-endpoints command.
      name: endpoint_ids
      required: true
    description: Deletes selected endpoints in the Cortex XDR app. You can delete up
      to 1000 endpoints.
    name: xdr-delete-endpoints
  - arguments:
    - description: Comma-separated list of endpoint IDs. You can retrieve the endpoint IDs from the xdr-get-endpoints command.
      isArray: true
      name: endpoint_ids
    - auto: PREDEFINED
      description: 'Type of violation. Possible values are: "cd-rom", "disk drive", "floppy disk", and "portable device".'
      name: type
      predefined:
      - cd-rom
      - disk drive
      - floppy disk
      - portable device
    - description: 'Timestamp of the violation. Violations that are greater than or equal to this timestamp will be returned. Values can be in either ISO date format, relative time, or epoch timestamp. For example:  "2019-10-21T23:45:00" (ISO date format), "3 days ago" (relative time) 1579039377301 (epoch time).'
      name: timestamp_gte
    - description: 'Timestamp of the violation. Violations that are less than or equal to this timestamp will be returned. Values can be in either ISO date format, relative time, or epoch timestamp. For example:  "2019-10-21T23:45:00" (ISO date format), "3 days ago" (relative time) 1579039377301 (epoch time).'
      name: timestamp_lte
    - description: Comma-separated list of IP addresses.
      isArray: true
      name: ip_list
    - description: Name of the vendor.
      isArray: true
      name: vendor
    - description: Vendor ID.
      isArray: true
      name: vendor_id
    - description: Name of the product.
      isArray: true
      name: product
    - description: Product ID.
      isArray: true
      name: product_id
    - description: Serial number.
      isArray: true
      name: serial
    - description: Hostname.
      isArray: true
      name: hostname
    - description: Comma-separated list of violation IDs.
      isArray: true
      name: violation_id_list
    - description: Username.
      isArray: true
      name: username
    description: Gets a list of device control violations filtered by selected fields.
      You can retrieve up to 100 violations.
    name: xdr-get-endpoint-device-control-violations
    outputs:
    - contextPath: PaloAltoNetworksXDR.EndpointViolations
      description: Endpoint violations command results.
    - contextPath: PaloAltoNetworksXDR.EndpointViolations.violations
      description: A list of violations.
    - contextPath: PaloAltoNetworksXDR.EndpointViolations.violations.os_type
      description: Type of the operating system.
      type: string
    - contextPath: PaloAltoNetworksXDR.EndpointViolations.violations.hostname
      description: Hostname of the violation.
      type: string
    - contextPath: PaloAltoNetworksXDR.EndpointViolations.violations.username
      description: Username of the violation.
      type: string
    - contextPath: PaloAltoNetworksXDR.EndpointViolations.violations.ip
      description: IP address of the violation.
      type: string
    - contextPath: PaloAltoNetworksXDR.EndpointViolations.violations.timestamp
      description: Timestamp of the violation.
      type: number
    - contextPath: PaloAltoNetworksXDR.EndpointViolations.violations.violation_id
      description: Violation ID.
      type: number
    - contextPath: PaloAltoNetworksXDR.EndpointViolations.violations.type
      description: Type of violation.
      type: string
    - contextPath: PaloAltoNetworksXDR.EndpointViolations.violations.vendor_id
      description: Vendor ID of the violation.
      type: string
    - contextPath: PaloAltoNetworksXDR.EndpointViolations.violations.vendor
      description: Name of the vendor of the violation.
      type: string
    - contextPath: PaloAltoNetworksXDR.EndpointViolations.violations.product_id
      description: Product ID of the violation.
      type: string
    - contextPath: PaloAltoNetworksXDR.EndpointViolations.violations.product
      description: Name of the product of the violation.
      type: string
    - contextPath: PaloAltoNetworksXDR.EndpointViolations.violations.serial
      description: Serial number of the violation.
      type: string
    - contextPath: PaloAltoNetworksXDR.EndpointViolations.violations.endpoint_id
      description: Endpoint ID of the violation.
      type: string
  - arguments:
    - description: Comma-separated list of endpoint IDs.
      isArray: true
      name: endpoint_ids
      required: true
    - description: A comma-separated list of file paths on the Windows platform.
      isArray: true
      name: windows_file_paths
    - description:  A comma-separated list of file paths on the Linux platform.
      isArray: true
      name: linux_file_paths
    - description:  A comma-separated list of file paths on the Mac platform.
      isArray: true
      name: mac_file_paths
    description: Retrieves files from selected endpoints. You can retrieve up to 20
      files, from no more than 10 endpoints. At least one endpoint ID and one file
      path are necessary in order to run the command. After running this command,
      you can use the xdr-action-status-get command with returned action_id, to check the
      action status.
    name: xdr-retrieve-files
    outputs:
    - contextPath: PaloAltoNetworksXDR.RetrievedFiles.action_id
      description: ID of the action to retrieve files from selected endpoints.
      type: string
  - arguments:
    - description: Action ID retrieved from the xdr-retrieve-files command.
      isArray: true
      name: action_id
      required: true
    description: View the file retrieved by the xdr-retrieve-files command according to
      the action ID. Before running this command, you can use the xdr-action-status-get
      command to check if this action completed successfully.
    name: xdr-retrieve-file-details
    outputs:
    - contextPath: File
      description: The file details command results.
    - contextPath: File.Name
      description: The full file name (including the file extension).
      type: String
    - contextPath: File.EntryID
      description: The ID for locating the file in the War Room.
      type: String
    - contextPath: File.Size
      description: The size of the file in bytes.
      type: Number
    - contextPath: File.MD5
      description: The MD5 hash of the file.
      type: String
    - contextPath: File.SHA1
      description: The SHA1 hash of the file.
      type: String
    - contextPath: File.SHA256
      description: The SHA256 hash of the file.
      type: String
    - contextPath: File.SHA512
      description: The SHA512 hash of the file.
      type: String
    - contextPath: File.Extension
      description: 'The file extension. For example: "xls".'
      type: String
    - contextPath: File.Type
      description: The file type, as determined by libmagic (same as displayed in
        file entries).
      type: String
  - arguments:
    - description: Unique identifier of the script, returned by the xdr-get-scripts
        command.
      name: script_uid
      required: true
    description: Gets the full definition of a specific script in the scripts library.
    name: xdr-get-script-metadata
    outputs:
    - contextPath: PaloAltoNetworksXDR.ScriptMetadata
      description: The script metadata command results.
    - contextPath: PaloAltoNetworksXDR.ScriptMetadata.script_id
      description: Script ID.
      type: number
    - contextPath: PaloAltoNetworksXDR.ScriptMetadata.name
      description: Script name.
      type: string
    - contextPath: PaloAltoNetworksXDR.ScriptMetadata.description
      description: Script description.
      type: string
    - contextPath: PaloAltoNetworksXDR.ScriptMetadata.modification_date
      description: Timestamp of when the script was last modified.
      type: unknown
    - contextPath: PaloAltoNetworksXDR.ScriptMetadata.created_by
      description: Name of the user who created the script.
      type: string
    - contextPath: PaloAltoNetworksXDR.ScriptMetadata.is_high_risk
      description: Whether the script has a high-risk outcome.
      type: boolean
    - contextPath: PaloAltoNetworksXDR.ScriptMetadata.windows_supported
      description: Whether the script can be executed on a Windows operating system.
      type: boolean
    - contextPath: PaloAltoNetworksXDR.ScriptMetadata.linux_supported
      description: Whether the script can be executed on a Linux operating system.
      type: boolean
    - contextPath: PaloAltoNetworksXDR.ScriptMetadata.macos_supported
      description: Whether the script can be executed on a Mac operating system.
      type: boolean
    - contextPath: PaloAltoNetworksXDR.ScriptMetadata.entry_point
      description: Name of the entry point selected for the script. An empty string indicates  the script defined as just run.
      type: string
    - contextPath: PaloAltoNetworksXDR.ScriptMetadata.script_input
      description: Name and type for the specified entry point.
      type: string
    - contextPath: PaloAltoNetworksXDR.ScriptMetadata.script_output_type
      description: Type of the output.
      type: string
    - contextPath: PaloAltoNetworksXDR.ScriptMetadata.script_output_dictionary_definitions
      description: If the script_output_type is a dictionary, an array with
        friendly name, name, and type for each output.
  - arguments:
    - description: Unique identifier of the script, returned by the xdr-get-scripts
        command.
      name: script_uid
      required: true
    description: Gets the code of a specific script in the script library.
    name: xdr-get-script-code
    outputs:
    - contextPath: PaloAltoNetworksXDR.ScriptCode
      description: The script code command results.
    - contextPath: PaloAltoNetworksXDR.ScriptCode.code
      description: The code of a specific script in the script library.
      type: string
    - contextPath: PaloAltoNetworksXDR.ScriptCode.script_uid
      description: Unique identifier of the script.
      type: string
  - arguments:
    - description: The action ID of the selected request. After performing an action,
        you will receive an action ID.
      isArray: true
      name: action_id
      required: true
    description: Retrieves the status of the requested actions according to the action
      ID.
    name: xdr-action-status-get
    outputs:
    - contextPath: PaloAltoNetworksXDR.GetActionStatus
      description: The action status command results.
    - contextPath: PaloAltoNetworksXDR.GetActionStatus.endpoint_id
      description: Endpoint ID.
      type: string
    - contextPath: PaloAltoNetworksXDR.GetActionStatus.status
      description: The status of the specific endpoint ID.
      type: string
    - contextPath: PaloAltoNetworksXDR.GetActionStatus.action_id
      description: The specified action ID.
      type: number
  dockerimage: demisto/python3:3.8.6.13358
  feed: false
  isfetch: true
  ismappable: true
  isremotesyncin: true
  isremotesyncout: true
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  subtype: python3
  type: python
tests:
- Test XDR Playbook
fromversion: 5.0.0
defaultclassifier: Cortex XDR - IR
defaultmapperin: Cortex XDR - IR-mapper
defaultmapperout: Cortex XDR - IR-out-mapper
