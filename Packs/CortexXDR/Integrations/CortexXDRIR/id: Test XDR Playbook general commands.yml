id: Test XDR Playbook general commands
version: 25
vcShouldKeepItemLegacyProdMachine: false
name: Test XDR Playbook general commands
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: e9229ddb-97aa-44de-85f2-0f705d775846
    type: start
    task:
      id: e9229ddb-97aa-44de-85f2-0f705d775846
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      "#none#":
        - "59"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 272.5,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: e5b4e95f-2d88-4ae8-8a1e-2f46359554e3
    type: regular
    task:
      id: e5b4e95f-2d88-4ae8-8a1e-2f46359554e3
      version: -1
      name: DeleteContext
      description: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "2"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 272.5,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: 0a274730-1a1c-4288-8f0e-cbf202d6c447
    type: regular
    task:
      id: 0a274730-1a1c-4288-8f0e-cbf202d6c447
      version: -1
      name: xdr-get-incidents
      description: xdr-get-incidents
      script: "|||xdr-get-incidents"
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "3"
    scriptarguments:
      gte_creation_time:
        simple: 2010-10-10T00:00:00
      limit:
        simple: "3"
      sort_by_creation_time:
        simple: desc
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 272.5,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 9fa68e36-4105-4607-8400-bd1fcd16b44a
    type: condition
    task:
      id: 9fa68e36-4105-4607-8400-bd1fcd16b44a
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
        - "4"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.Incident.incident_id
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.Incident.severity
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.Incident.xdr_url
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.Incident.status
                iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 272.5,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 87b7502e-f619-49be-88bd-874e36da6013
    type: regular
    task:
      id: 87b7502e-f619-49be-88bd-874e36da6013
      version: -1
      name: xdr-get-incident-extra-data
      description: xdr-get-incident-extra-data
      script: "|||xdr-get-incident-extra-data"
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "5"
    scriptarguments:
      incident_id:
        simple: ${PaloAltoNetworksXDR.Incident.incident_id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 272.5,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 93a73591-9987-435a-8845-b402d1890c2b
    type: condition
    task:
      id: 93a73591-9987-435a-8845-b402d1890c2b
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
        - "6"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.Incident.incident_id
                iscontext: true
          - - operator: isExists
              left:
                value:
                  simple: PaloAltoNetworksXDR.Incident.manual_severity
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.Incident.severity
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.Incident.xdr_url
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.Incident.status
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.Incident.alerts.alert_id
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.Incident.alerts.source
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.Incident.network_artifacts.network_remote_ip
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: File.SHA256
                iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 272.5,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: b41b8cee-daf5-49e9-852f-a00441a37f15
    type: regular
    task:
      id: b41b8cee-daf5-49e9-852f-a00441a37f15
      version: -1
      name: xdr-update-incident
      description: xdr-update-incident
      script: "|||xdr-update-incident"
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "7"
    scriptarguments:
      incident_id:
        complex:
          root: PaloAltoNetworksXDR
          accessor: Incident.incident_id
          transformers:
            - operator: FirstArrayElement
      manual_severity:
        simple: HIGH
      status:
        simple: UNDER_INVESTIGATION
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 272.5,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: a3d4b484-1b0c-4cea-8361-5a5ca9e95508
    type: regular
    task:
      id: a3d4b484-1b0c-4cea-8361-5a5ca9e95508
      version: -1
      name: Save incident id
      description: Save incident id
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      "#none#":
        - "8"
    scriptarguments:
      key:
        simple: XDRIncidentID
      value:
        complex:
          root: PaloAltoNetworksXDR
          accessor: Incident.incident_id
          transformers:
            - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 272.5,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 7aee118a-ce38-4a7e-816f-6009e1f1419f
    type: regular
    task:
      id: 7aee118a-ce38-4a7e-816f-6009e1f1419f
      version: -1
      name: DeleteContext
      description: DeleteContext
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      "#none#":
        - "9"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: XDRIncidentID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 272.5,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: 71ffab84-1873-43ad-8c08-88ffbedeb398
    type: regular
    task:
      id: 71ffab84-1873-43ad-8c08-88ffbedeb398
      version: -1
      name: xdr-get-incidents
      description: xdr-get-incidents
      script: "|||xdr-get-incidents"
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "10"
    scriptarguments:
      incident_id_list:
        simple: ${XDRIncidentID}
      sort_by_creation_time:
        simple: desc
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 272.5,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: d9c9b1e8-2ce9-45c8-8954-411ef1b5c11b
    type: condition
    task:
      id: d9c9b1e8-2ce9-45c8-8954-411ef1b5c11b
      version: -1
      name: Verify updated values
      description: Verify updated values
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
        - "11"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: isEqualString
              left:
                value:
                  simple: PaloAltoNetworksXDR.Incident.severity
                iscontext: true
              right:
                value:
                  simple: high
          - - operator: isEqualString
              left:
                value:
                  simple: PaloAltoNetworksXDR.Incident.status
                iscontext: true
              right:
                value:
                  simple: under_investigation
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 272.5,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 5aae11aa-01fc-4e51-83bf-518710f78951
    type: regular
    task:
      id: 5aae11aa-01fc-4e51-83bf-518710f78951
      version: -1
      name: xdr-update-incident
      description: xdr-update-incident
      script: "|||xdr-update-incident"
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "12"
    scriptarguments:
      incident_id:
        simple: ${PaloAltoNetworksXDR.Incident.incident_id}
      manual_severity:
        simple: LOW
      status:
        simple: NEW
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 272.5,
          "y": 2820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: 230a2dae-cd87-4973-84e3-08c0e38e9860
    type: regular
    task:
      id: 230a2dae-cd87-4973-84e3-08c0e38e9860
      version: -1
      name: xdr-insert-parsed-alert
      description: xdr-insert-parsed-alert
      script: "|||xdr-insert-parsed-alert"
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "13"
    scriptarguments:
      alert_description:
        simple: This alert from content  TestXDRPlaybook description
      alert_name:
        simple: This alert from content  TestXDRPlaybook
      local_ip:
        simple: 196.168.0.111
      local_port:
        simple: "2000"
      product:
        simple: SandBlast
      remote_ip:
        simple: 2.2.2.2
      remote_port:
        simple: "6000"
      severity:
        simple: High
      vendor:
        simple: Checkpoint
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 272.5,
          "y": 2995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: 68f7bdf1-f2bc-4bab-89c3-65385650106c
    type: regular
    task:
      id: 68f7bdf1-f2bc-4bab-89c3-65385650106c
      version: -1
      name: Set 2 CEF alerts to context
      description: Set 2 CEF alerts to context
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      "#none#":
        - "14"
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: cef_alerts
      value:
        simple: |-
          [
                      "CEF:0|Check Point|VPN-1 & FireWall-1|Check Point|Log|microsoft-ds|Unknown|act=AcceptdeviceDirection=0 rt=1569477512000 spt=56957 dpt=445 cs2Label=Rule Name cs2=ADPrimery layer_name=FW_Device_blackened Securitylayer_uuid=07693fc7-1a5c-4f31-8afe-77ae96c71b8c match_id=1806 parent_rule=0rule_action=Accept rule_uid=8e45f36b-d106-4d81-a1f0-9d1ed9a6be5c ifname=bond2logid=0 loguid={0x5d8c5388,0x61,0x29321fac,0xc0000022} origin=1.1.1.1originsicname=CN=DWdeviceBlackend,O=Blackend sequencenum=363 version=5dst=1.1.1.1 inzone=External outzone=Internal product=VPN-1 & FireWall-1 proto=6service_id=microsoft-ds src=1.1.1.1",
                      "CEF:0|Check Point|VPN-1 & FireWall-1|Check Point|Log|Log|Unknown|act=AcceptdeviceDirection=0 rt=1569477501000 spt=63088 dpt=5985 cs2Label=Rule Namelayer_name=FW_Device_blackened Securitylayer_uuid=07693fc7-1a5c-4f31-8afe-77ae96c71b8c match_id=8899 parent_rule=0rule_action=Accept rule_uid=ae987933-82c0-470f-ab1c-1ad552c82369conn_direction=Internal ifname=bond1.12 logid=0loguid={0x5d8c537d,0xbb,0x29321fac,0xc0000014} origin=1.1.1.1originsicname=CN=DWdeviceBlackend,O=Blackend sequencenum=899 version=5dst=1.1.1.1 product=VPN-1 & FireWall-1 proto=6 src=1.1.1.1"
                  ]
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 272.5,
          "y": 3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 73f1a870-9ecc-4f02-8c9e-643c5e9b40dc
    type: regular
    task:
      id: 73f1a870-9ecc-4f02-8c9e-643c5e9b40dc
      version: -1
      name: xdr-insert-cef-alerts
      description: xdr-insert-cef-alerts
      script: "|||xdr-insert-cef-alerts"
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "15"
    scriptarguments:
      cef_alerts:
        simple: ${cef_alerts}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 272.5,
          "y": 3345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 1b030041-d045-43ec-8464-c94709bb6ef7
    type: regular
    task:
      id: 1b030041-d045-43ec-8464-c94709bb6ef7
      version: -1
      name: Get Endpoint f8a2f58846b542579c12090652e79f3d
      description:
        Gets a list of endpoints, according to the passed filters. Filtering
        by multiple fields will be concatenated using AND condition (OR is not supported).
        Maximum result set size is 100. Offset is the zero-based number of endpoint
        from the start of the result set (start by counting from 0).
      script: "|||xdr-get-endpoints"
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "16"
    scriptarguments:
      endpoint_id_list:
        simple: f8a2f58846b542579c12090652e79f3d
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 272.5,
          "y": 3520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: 1491d3d1-a740-4cab-8053-fedbc4aa8b7b
    type: condition
    task:
      id: 1491d3d1-a740-4cab-8053-fedbc4aa8b7b
      version: -1
      name: To isolate ?
      description: To isolate
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "#default#":
        - "17"
      "yes":
        - "19"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: isEqualString
              left:
                value:
                  simple: PaloAltoNetworksXDR.Endpoint.is_isolated
                iscontext: true
              right:
                value:
                  simple: AGENT_UNISOLATED
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 272.5,
          "y": 3695
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: 8c4bcb02-bb73-4a50-86ae-53f5626c6bb6
    type: condition
    task:
      id: 8c4bcb02-bb73-4a50-86ae-53f5626c6bb6
      version: -1
      name: To unisolate?
      description: To unisolate
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "#default#":
        - "22"
      "yes":
        - "18"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: isEqualString
              left:
                value:
                  simple: PaloAltoNetworksXDR.Endpoint.is_isolated
                iscontext: true
              right:
                value:
                  simple: AGENT_ISOLATED
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: 660ffb90-7029-4355-8580-226181dc0b80
    type: regular
    task:
      id: 660ffb90-7029-4355-8580-226181dc0b80
      version: -1
      name: xdr-unisolate-endpoint
      description: xdr-unisolate-endpoint
      script: "|||xdr-unisolate-endpoint"
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "22"
    scriptarguments:
      endpoint_id:
        simple: f8a2f58846b542579c12090652e79f3d
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 200,
          "y": 4045
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: 88da95a5-9bf0-4929-8052-37858d0c776a
    type: regular
    task:
      id: 88da95a5-9bf0-4929-8052-37858d0c776a
      version: -1
      name: xdr-isolate-endpoint
      description: xdr-isolate-endpoint
      script: "|||xdr-isolate-endpoint"
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "22"
    scriptarguments:
      endpoint_id:
        simple: f8a2f58846b542579c12090652e79f3d
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 630,
          "y": 4045
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 8631b00f-650d-4b03-84f4-eed1ccf550a7
    type: regular
    task:
      id: 8631b00f-650d-4b03-84f4-eed1ccf550a7
      version: -1
      name: xdr-get-endpoints
      description: xdr-get-endpoints
      script: "|||xdr-get-endpoints"
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "21"
    scriptarguments:
      hostname:
        simple: DESKTOP-S2455R8
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 232.5,
          "y": 4365
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: d92a668a-7843-471a-8c11-ae67bb02a358
    type: condition
    task:
      id: d92a668a-7843-471a-8c11-ae67bb02a358
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
        - "54"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.Endpoint.endpoint_id
                iscontext: true
          - - operator: containsGeneral
              left:
                value:
                  simple: PaloAltoNetworksXDR.Endpoint.os_type
                iscontext: true
              right:
                value:
                  simple: AGENT_OS_WINDOWS
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.Endpoint.ip
                iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 232.5,
          "y": 4540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 159a5f2c-d918-4831-85b5-af05ce1e84aa
    type: title
    task:
      id: 159a5f2c-d918-4831-85b5-af05ce1e84aa
      version: -1
      name: Isolation done
      description: Isolation done
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      "#none#":
        - "20"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 232.5,
          "y": 4220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: a228e31c-3d56-440d-8043-bfe2b410c87c
    type: title
    task:
      id: a228e31c-3d56-440d-8043-bfe2b410c87c
      version: -1
      name: Success!
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 200,
          "y": 9790
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: f339d8e2-04ab-4d83-838a-ad2336a29d61
    type: condition
    task:
      id: f339d8e2-04ab-4d83-838a-ad2336a29d61
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
        - "60"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.ScriptCode
                iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 200,
          "y": 8740
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: b59b209c-b9bb-4479-8d6a-bc1690084b5a
    type: regular
    task:
      id: b59b209c-b9bb-4479-8d6a-bc1690084b5a
      version: -1
      name: xdr-get-script-code
      description: Gets the code of a specific script in the script library.
      script: "|||xdr-get-script-code"
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "30"
    scriptarguments:
      script_uid:
        complex:
          root: PaloAltoNetworksXDR.Scripts
          accessor: script_uid
          transformers:
            - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 200,
          "y": 8565
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: 1a0c5d63-f53e-4d0d-89b6-294ac9977b40
    type: condition
    task:
      id: 1a0c5d63-f53e-4d0d-89b6-294ac9977b40
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
        - "31"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.ScriptMetadata
                iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 200,
          "y": 8390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: b9d7c46c-d832-4c2f-80dc-a08627f158d0
    type: regular
    task:
      id: b9d7c46c-d832-4c2f-80dc-a08627f158d0
      version: -1
      name: xdr-get-script-metadata
      description: Gets the full definition of a specific script in the scripts library.
      script: "|||xdr-get-script-metadata"
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "32"
    scriptarguments:
      script_uid:
        complex:
          root: PaloAltoNetworksXDR.Scripts
          accessor: script_uid
          transformers:
            - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 200,
          "y": 8215
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: af7d8210-378a-499d-8525-28bf30b699f1
    type: condition
    task:
      id: af7d8210-378a-499d-8525-28bf30b699f1
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
        - "33"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: isNotEmpty
              left:
                value:
                  complex:
                    root: PaloAltoNetworksXDR.Scripts
                    accessor: script_uid
                    transformers:
                      - operator: FirstArrayElement
                iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 200,
          "y": 8040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: e9985a61-c9d1-414f-843c-e050719df54c
    type: regular
    task:
      id: e9985a61-c9d1-414f-843c-e050719df54c
      version: -1
      name: xdr-get-scripts
      description: Gets a list of scripts available in the scripts library.
      script: "|||xdr-get-scripts"
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "34"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 200,
          "y": 7865
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: 4799ca70-04a6-4fe0-8c80-fc2b17da5982
    type: condition
    task:
      id: 4799ca70-04a6-4fe0-8c80-fc2b17da5982
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
        - "35"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.EndpointViolations
                iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 200,
          "y": 7690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: 61578a86-7968-4042-8c4e-63a732a8b35f
    type: regular
    task:
      id: 61578a86-7968-4042-8c4e-63a732a8b35f
      version: -1
      name: xdr-get-endpoint-device-control-violations
      description:
        Gets a list of device control violations filtered by selected fields.
        You can retrieve up to 100 violations.
      script: "|||xdr-get-endpoint-device-control-violations"
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "36"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 200,
          "y": 7515
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: 87e2bd42-d0b1-4e16-8d34-65c92cf4d8dd
    type: condition
    task:
      id: 87e2bd42-d0b1-4e16-8d34-65c92cf4d8dd
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
        - "37"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.Policy.policy_name
                iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 200,
          "y": 7340
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: f6a901cb-e1d8-45c0-826b-9e4c152df17a
    type: regular
    task:
      id: f6a901cb-e1d8-45c0-826b-9e4c152df17a
      version: -1
      name: xdr-get-policy
      description: Gets the policy name for a specific endpoint.
      script: "|||xdr-get-policy"
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "38"
    scriptarguments:
      endpoint_id:
        complex:
          root: PaloAltoNetworksXDR.Endpoint
          accessor: endpoint_id
          transformers:
            - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 200,
          "y": 7165
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: b330a074-f3b3-4043-8d8b-dccab887874d
    type: condition
    task:
      id: b330a074-f3b3-4043-8d8b-dccab887874d
      version: -1
      name: Check the number of endpoints in context
      description: Check the number of endpoints in context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
        - "39"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: greaterThanOrEqual
              left:
                value:
                  complex:
                    root: PaloAltoNetworksXDR
                    accessor: Endpoint
                    transformers:
                      - operator: count
                iscontext: true
              right:
                value:
                  simple: "3"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 200,
          "y": 6990
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: 66647700-41e4-41ca-8598-39f1bde505f3
    type: regular
    task:
      id: 66647700-41e4-41ca-8598-39f1bde505f3
      version: -1
      name: xdr-get-endpoints
      description:
        Gets a list of endpoints, according to the passed filters. If there
        are no filters, all endpoints are returned. Filtering by multiple fields will
        be concatenated using AND condition (OR is not supported). Maximum result
        set size is 100. Offset is the zero-based number of endpoint from the start
        of the result set (start by counting from 0).
      script: "|||xdr-get-endpoints"
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "41"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 200,
          "y": 6815
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: 4fa239cc-8d32-4263-8edb-1918021125cf
    type: condition
    task:
      id: 4fa239cc-8d32-4263-8edb-1918021125cf
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
        - "42"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: containsGeneral
              left:
                value:
                  simple: PaloAltoNetworksXDR.AuditAgentReports.ENDPOINTNAME
                iscontext: true
              right:
                value:
                  simple: ip-172-31-15-237.eu-central-1.compute.internal
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.AuditAgentReports.ENDPOINTID
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: Endpoint.ID
                iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 200,
          "y": 6640
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "44":
    id: "44"
    taskid: 0d7a7ae7-dd4f-46ca-83bb-ad0d3ef52731
    type: regular
    task:
      id: 0d7a7ae7-dd4f-46ca-83bb-ad0d3ef52731
      version: -1
      name: xdr-get-audit-agent-reports
      description: xdr-get-audit-agent-reports
      script: "|||xdr-get-audit-agent-reports"
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "43"
    scriptarguments:
      endpoint_names:
        simple: ip-172-31-15-237.eu-central-1.compute.internal
      limit:
        simple: "5"
      result:
        simple: Success
      retry-count:
        simple: "3"
      retry-interval:
        simple: "30"
      sort_by:
        simple: category
      sort_order:
        simple: desc
      timestamp_gte:
        simple: "2019-10-10"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 200,
          "y": 6465
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: ebef1122-4324-47bf-865b-b6a80097dd62
    type: condition
    task:
      id: ebef1122-4324-47bf-865b-b6a80097dd62
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
        - "44"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: containsGeneral
              left:
                value:
                  simple: PaloAltoNetworksXDR.AuditManagementLogs.AUDIT_ENTITY_SUBTYPE
                iscontext: true
              right:
                value:
                  simple: Authentication failed
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.AuditManagementLogs.AUDIT_ID
                iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 200,
          "y": 6290
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: 5e0f8921-ea07-4ed1-84c0-dabdbb94535d
    type: regular
    task:
      id: 5e0f8921-ea07-4ed1-84c0-dabdbb94535d
      version: -1
      name: xdr-get-audit-management-logs
      description: xdr-get-audit-management-logs
      script: "|||xdr-get-audit-management-logs"
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "45"
    scriptarguments:
      limit:
        simple: "5"
      sort_by:
        simple: sub_type
      sort_order:
        simple: asc
      sub_type:
        simple: Authentication failed
      timestamp_gte:
        simple: "0"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 200,
          "y": 6115
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: 3d18326c-d82e-4dc6-8d07-8e118e089f44
    type: condition
    task:
      id: 3d18326c-d82e-4dc6-8d07-8e118e089f44
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
        - "46"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.Distribution.url
                iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 200,
          "y": 5940
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: 4ebc4982-d018-43a9-82d5-e4118f810b0b
    type: regular
    task:
      id: 4ebc4982-d018-43a9-82d5-e4118f810b0b
      version: -1
      name: xdr-get-distribution-url
      description: xdr-get-distribution-url
      script: "|||xdr-get-distribution-url"
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "47"
    scriptarguments:
      distribution_id:
        simple: 2c74c11b63074653aa01d575a82bf52a
      package_type:
        simple: sh
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 227.5,
          "y": 5765
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: 794595c5-3905-47de-8cda-1c7074eb6ee8
    type: condition
    task:
      id: 794595c5-3905-47de-8cda-1c7074eb6ee8
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
        - "48"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: isEqualString
              left:
                value:
                  simple: PaloAltoNetworksXDR.Distribution.status
                iscontext: true
              right:
                value:
                  simple: Completed
            - operator: isEqualString
              left:
                value:
                  simple: PaloAltoNetworksXDR.Distribution.status
                iscontext: true
              right:
                value:
                  simple: In Progress
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 232.5,
          "y": 5590
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: c98d9125-b2a9-4fe9-8923-6829cf519577
    type: regular
    task:
      id: c98d9125-b2a9-4fe9-8923-6829cf519577
      version: -1
      name: xdr-get-create-distribution-status
      description: xdr-get-create-distribution-status
      script: "|||xdr-get-create-distribution-status"
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "49"
    scriptarguments:
      distribution_ids:
        simple: ${PaloAltoNetworksXDR.Distribution.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 232.5,
          "y": 5415
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: c256ac62-94ab-4c3b-88d2-90872869c92e
    type: condition
    task:
      id: c256ac62-94ab-4c3b-88d2-90872869c92e
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
        - "50"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.Distribution.id
                iscontext: true
          - - operator: isExists
              left:
                value:
                  simple: PaloAltoNetworksXDR.Distribution.platform
                iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 232.5,
          "y": 5240
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "52":
    id: "52"
    taskid: 519bdc36-1044-41df-8d56-fc916bcb9ae5
    type: regular
    task:
      id: 519bdc36-1044-41df-8d56-fc916bcb9ae5
      version: -1
      name: xdr-create-distribution
      description: xdr-create-distribution
      script: "|||xdr-create-distribution"
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "51"
    scriptarguments:
      agent_version:
        complex:
          root: PaloAltoNetworksXDR
          accessor: DistributionVersions.linux
          transformers:
            - operator: FirstArrayElement
      description:
        simple: Created by TestXDRPlaybook
      name:
        simple: This is test distribution
      package_type:
        simple: standalone
      platform:
        simple: linux
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 232.5,
          "y": 5065
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: c70c3ca1-cab1-4142-8cd2-be885fe326dc
    type: condition
    task:
      id: c70c3ca1-cab1-4142-8cd2-be885fe326dc
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
        - "52"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.DistributionVersions.windows
                iscontext: true
          - - operator: isNotEmpty
              left:
                value:
                  simple: PaloAltoNetworksXDR.DistributionVersions.linux
                iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 232.5,
          "y": 4890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "54":
    id: "54"
    taskid: 1b12128b-4946-4d18-8dc6-af66ded1b67c
    type: regular
    task:
      id: 1b12128b-4946-4d18-8dc6-af66ded1b67c
      version: -1
      name: xdr-get-distribution-versions
      description: xdr-get-distribution-versions
      script: "|||xdr-get-distribution-versions"
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "53"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 232.5,
          "y": 4715
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "55":
    id: "55"
    taskid: dd7af74c-1c87-4389-8896-6b83a1aed80a
    type: regular
    task:
      id: dd7af74c-1c87-4389-8896-6b83a1aed80a
      version: -1
      name: xdr-get-contributing-event
      description: Retrieves contributing events for a specific alert.
      script: "|||xdr-get-contributing-event"
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "56"
    scriptarguments:
      alert_ids:
        simple: "34159"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 272.5,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
    isoversize: false
    isautoswitchedtoquietmode: false
  "56":
    id: "56"
    taskid: e66b0549-fa6e-4835-84f0-611403264e5f
    type: condition
    task:
      id: e66b0549-fa6e-4835-84f0-611403264e5f
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
        - "57"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: isEqualString
              left:
                value:
                  complex:
                    root: PaloAltoNetworksXDR.ContributingEvent
                    accessor: alertID
                iscontext: true
              right:
                value:
                  simple: "34159"
          - - operator: hasLength
              left:
                value:
                  complex:
                    root: PaloAltoNetworksXDR.ContributingEvent
                    accessor: events
                iscontext: true
              right:
                value:
                  simple: "1"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 272.5,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "57":
    id: "57"
    taskid: 5c1c902b-3006-4122-8f8f-40f8e0fa55c1
    type: regular
    task:
      id: 5c1c902b-3006-4122-8f8f-40f8e0fa55c1
      version: -1
      name: xdr-replace-featured-field
      description:
        Replace the featured hosts\users\ips\active-directory_groups listed
        in your environment.
      script: "|||xdr-replace-featured-field"
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "58"
    scriptarguments:
      comments:
        simple: This is a test comment
      field_type:
        simple: ip_addresses
      values:
        simple: 1.1.1.1
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 272.5,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "58":
    id: "58"
    taskid: 125cdff7-3f4c-4f5f-8aeb-c4d14f4cd25d
    type: condition
    task:
      id: 125cdff7-3f4c-4f5f-8aeb-c4d14f4cd25d
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
        - "1"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: isEqualString
              left:
                value:
                  complex:
                    root: PaloAltoNetworksXDR.FeaturedField
                    accessor: fieldType
                iscontext: true
              right:
                value:
                  simple: ip_addresses
          - - operator: isEqualString
              left:
                value:
                  complex:
                    root: PaloAltoNetworksXDR.FeaturedField.fields
                    accessor: value
                iscontext: true
              right:
                value:
                  simple: 1.1.1.1
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 272.5,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "59":
    id: "59"
    taskid: 4153b605-3cd0-4d9b-874b-2b0de182887c
    type: regular
    task:
      id: 4153b605-3cd0-4d9b-874b-2b0de182887c
      version: -1
      name: DeleteContext
      description: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "55"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 272.5,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: 753cc713-56c2-45ad-8dd2-5a97b031b38b
    type: regular
    task:
      id: 753cc713-56c2-45ad-8dd2-5a97b031b38b
      version: -1
      name: Delete contect
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      "#none#":
        - "64"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 200,
          "y": 8915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    id: "61"
    taskid: b8f42973-ad07-4eed-8ef6-348ec18e6019
    type: regular
    task:
      id: b8f42973-ad07-4eed-8ef6-348ec18e6019
      version: -1
      name: Change alias name
      description:
        Gets a list of endpoints according to the passed filters, and changes
        their alias name. Filtering by multiple fields will be concatenated using
        AND condition (OR is not supported).
      script: "|||xdr-endpoint-alias-change"
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "65"
    scriptarguments:
      alias_name:
        complex:
          root: PaloAltoNetworksXDR.Endpoint
          accessor: alias
      new_alias_name:
        simple: Test
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 200,
          "y": 9265
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: c3e487be-5e0d-45ed-8764-a3f571f86540
    type: condition
    task:
      id: c3e487be-5e0d-45ed-8764-a3f571f86540
      version: -1
      name: Was the alias changed?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
        - "24"
    separatecontext: false
    conditions:
      - label: "yes"
        condition:
          - - operator: isEqualString
              left:
                value:
                  complex:
                    root: PaloAltoNetworksXDR.Endpoint
                    accessor: alias
                iscontext: true
              right:
                value:
                  simple: Test
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 200,
          "y": 9615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "64":
    id: "64"
    taskid: ac60412f-c39e-468c-8dab-c9a141294dcc
    type: regular
    task:
      id: ac60412f-c39e-468c-8dab-c9a141294dcc
      version: -1
      name: Get endpoints
      description:
        Gets a list of endpoints, according to the passed filters. If there
        are no filters, all endpoints are returned. Filtering by multiple fields will
        be concatenated using AND condition (OR is not supported). Maximum result
        set size is 100. Offset is the zero-based number of endpoint from the start
        of the result set (start by counting from 0).
      script: "|||xdr-get-endpoints"
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "61"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 200,
          "y": 9090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "65":
    id: "65"
    taskid: 451d7cf7-94df-4710-8c14-8259c7a35147
    type: regular
    task:
      id: 451d7cf7-94df-4710-8c14-8259c7a35147
      version: -1
      name: Get endpoints
      description:
        Gets a list of endpoints, according to the passed filters. If there
        are no filters, all endpoints are returned. Filtering by multiple fields will
        be concatenated using AND condition (OR is not supported). Maximum result
        set size is 100. Offset is the zero-based number of endpoint from the start
        of the result set (start by counting from 0).
      script: "|||xdr-get-endpoints"
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      "#none#":
        - "63"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 200,
          "y": 9440
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 9805,
        "width": 960,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
