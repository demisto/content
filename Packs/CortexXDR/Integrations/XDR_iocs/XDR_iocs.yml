commonfields:
  id: Cortex XDR - IOC
  version: -1
name: Cortex XDR - IOC
display: Cortex XDR - IOC
category: Data Enrichment & Threat Intelligence
description: Use the Cortex XDR - IOCs feed integration to sync indicators from Cortex
  XSOAR to Cortex XDR and back to Cortex XSOAR. Cortex XDR is the world's first detection
  and response app that natively integrates network, endpoint and cloud data to stop
  sophisticated attacks.
configuration:
- display: Server URL (e.g. https://example.net)
  name: url
  type: 0
  required: true
- display: API Key ID
  name: apikey_id
  type: 4
  required: true
- display: API Key
  name: apikey
  type: 4
  required: true
- display: Fetch indicators
  name: feed
  defaultvalue: "true"
  type: 8
  required: false
- display: Auto Sync
  name: autoSync
  defaultvalue: "true"
  type: 8
  required: false
  additionalinfo: When enabled, indicators will be synced from Cortex XSOAR to Cortex
    XDR. Disable if you prefer to use a playbook to sync indicators.
- display: Cortex XDR Severity
  name: severity
  type: 15
  required: true
  options:
  - info
  - low
  - medium
  - high
  additionalinfo: The default value to map the severity of each indicator that will
    be synced to Cortex XDR.
- display: Severity Mapping
  name: severityMap
  type: 12
  required: false
  additionalinfo: Map the severity of each indicator that will be synced to Cortex
    XDR.
- display: Tags
  name: feedTags
  defaultvalue: Cortex XDR
  type: 0
  required: false
  additionalinfo: Supports CSV values.
- display: Sync Query
  name: query
  defaultvalue: reputation:Bad and (type:File or type:Domain or type:IP)
  type: 0
  required: true
  additionalinfo: The query used to collect indicators to sync from Cortex XSOAR to
    Cortex XDR.
- display: Trust any certificate (not secure)
  name: insecure
  type: 8
  required: false
- display: Use system proxy settings
  name: proxy
  type: 8
  required: false
- display: Indicator Reputation
  name: feedReputation
  type: 18
  required: false
  options:
  - None
  - Good
  - Suspicious
  - Bad
  additionalinfo: Indicators from this integration instance will be marked with this
    reputation
- display: Source Reliability
  name: feedReliability
  defaultvalue: A - Completely reliable
  type: 15
  required: true
  options:
  - A - Completely reliable
  - B - Usually reliable
  - C - Fairly reliable
  - D - Not usually reliable
  - E - Unreliable
  - F - Reliability cannot be judged
  additionalinfo: Reliability of the source providing the intelligence data
- display: Traffic Light Protocol Color
  name: tlp_color
  type: 15
  required: false
  options:
  - RED
  - AMBER
  - GREEN
  - WHITE
  additionalinfo: The Traffic Light Protocol (TLP) designation to apply to indicators
    fetched from the feed
- display: ""
  name: feedExpirationPolicy
  type: 17
  required: false
  options:
  - never
  - interval
  - indicatorType
  - suddenDeath
- display: ""
  name: feedExpirationInterval
  type: 1
  required: false
- display: Incremental Feed
  name: feedIncremental
  defaultvalue: "true"
  type: 8
  required: false
  hidden: true
- display: Feed Fetch Interval
  name: feedFetchInterval
  defaultvalue: "1"
  type: 19
  required: false
- display: Bypass exclusion list
  name: feedBypassExclusionList
  type: 8
  required: false
  additionalinfo: When selected, the exclusion list is ignored for indicators from
    this feed. This means that if an indicator from this feed is on the exclusion
    list, the indicator might still be added to the system.
script:
  script: ''
  type: python
  commands:
  - name: xdr-iocs-sync
    arguments:
    - name: firstTime
      default: true
      auto: PREDEFINED
      predefined:
      - "true"
      - "false"
      description: |-
        For first sync, set to true.
        (do NOT run this twice!)
      defaultValue: "false"
    description: Sync your IOC with Cortex XDR and delete the old.
  - name: xdr-iocs-push
    arguments:
    - name: indicator
      description: IOCs to push. leave empty to push all recently modified IOCs.the
        indicators
      isArray: true
    description: Push modified IOCs to Cortex XDR.
  - name: xdr-iocs-enable
    arguments:
    - name: indicator
      required: true
      description: The indicator to enable.
      isArray: true
    description: Enables IOCs in the XDR server.
  - name: xdr-iocs-disable
    arguments:
    - name: indicator
      required: true
      description: The indicator to disable.
      isArray: true
    description: Disables IOCs in the XDR server.
  dockerimage: demisto/python3:3.9.6.22912
  feed: true
  runonce: false
  subtype: python3
fromversion: 5.5.0
tests:
- XDR_iocs_-_Test
