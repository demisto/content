id: Xpanse - Alert Self-Enrichment
version: -1
contentitemexportablefields:
  contentitemfields: {}
name: Xpanse - Alert Self-Enrichment
description: Enrichment on the alert itself using Cortex Xpanse APIs.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: daf92b34-22bf-4969-8ce1-3def20c61031
    type: start
    task:
      id: daf92b34-22bf-4969-8ce1-3def20c61031
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "11"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 460,
          "y": -400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: f58f0b25-ae83-4196-8202-f58c135ebf7f
    type: condition
    task:
      id: f58f0b25-ae83-4196-8202-f58c135ebf7f
      version: -1
      name: Is Cortex Xpanse enabled?
      description: Determines if the "Cortex Xpanse" integration instance is configured to continue with enrichment.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "38"
      "yes":
      - "128"
      - "129"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: modules
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: modules.brand
                      iscontext: true
                    right:
                      value:
                        simple: Cortex Xpanse
                - - operator: isEqualString
                    left:
                      value:
                        simple: modules.state
                      iscontext: true
                    right:
                      value:
                        simple: active
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 460,
          "y": -270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: d5ba9531-b2cc-4c22-82e1-64566bb8c6d6
    type: title
    task:
      id: d5ba9531-b2cc-4c22-82e1-64566bb8c6d6
      version: -1
      name: Complete
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 460,
          "y": 1840
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "88":
    id: "88"
    taskid: 41e5b734-11c8-45d6-83cd-dd04e1f3980b
    type: regular
    task:
      id: 41e5b734-11c8-45d6-83cd-dd04e1f3980b
      version: -1
      name: Search external service information
      description: Get service details according to the service ID.
      script: 'Cortex Xpanse|||asm-get-external-service'
      type: regular
      iscommand: true
      brand: "Cortex Xpanse"
    nexttasks:
      '#none#':
      - "90"
    scriptarguments:
      service_id:
        complex:
          accessor: xpanseserviceid
          root: incident
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 190,
          "y": 170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "89":
    id: "89"
    taskid: 0a3ff6f7-216d-4055-8169-e9e9c862f72a
    type: regular
    task:
      id: 0a3ff6f7-216d-4055-8169-e9e9c862f72a
      version: -1
      name: Search related Xpanse assets
      description: Get internet exposure asset details according to the asset ID.
      script: Cortex Xpanse|||asm-get-asset-internet-exposure
      type: regular
      iscommand: true
      brand: Cortex Xpanse
    nexttasks:
      '#none#':
      - "97"
    scriptarguments:
      asm_id:
        complex:
          accessor: xpanseassetids
          root: incident
          transformers:
          - args:
              chars:
                value:
                  simple: '[]'
            operator: StripChars
          - args:
              delimiter:
                value:
                  simple: ','
            operator: split
          - args:
              chars:
                value:
                  simple: '"'
            operator: StripChars
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1550,
          "y": 150
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "90":
    id: "90"
    taskid: 8758da78-9cc6-4587-8d75-422327f2f2bb
    type: condition
    task:
      id: 8758da78-9cc6-4587-8d75-422327f2f2bb
      version: -1
      name: Service exist?
      description: Determines if service information was passed back from the last command.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "38"
      "yes":
      - "112"
      - "98"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: ASM
                accessor: ExternalService
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 190,
          "y": 330
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "97":
    id: "97"
    taskid: 6dd5ee89-c445-4115-b4f7-d3400153f3ee
    type: condition
    task:
      id: 6dd5ee89-c445-4115-b4f7-d3400153f3ee
      version: -1
      name: Asset exists?
      description: Indicates whether asset information was returned by the last command.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "38"
      "yes":
      - "113"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1550,
          "y": 310
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: AssetInternetExposure
                root: ASM
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
  "98":
    continueonerrortype: ""
    id: "98"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "99"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: xpanseservicedetails
      keys:
        simple: field,value
      val1:
        simple: Service Name
      val2:
        complex:
          accessor: service_name
          root: ASM.ExternalService
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
            operator: SetIfEmpty
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Example of command:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: bb5c3806-9983-40ce-85d2-e224942d135b
      iscommand: false
      name: Set service information (Service Name)
      type: regular
      version: -1
      scriptName: GridFieldSetup
    taskid: bb5c3806-9983-40ce-85d2-e224942d135b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 190,
          "y": 510
        }
      }
  "99":
    continueonerrortype: ""
    id: "99"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "101"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: xpanseservicedetails
      keys:
        simple: field,value
      val1:
        simple: Is Active
      val2:
        complex:
          accessor: is_active
          root: ASM.ExternalService
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
            operator: SetIfEmpty
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Example of command:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: fdaef9a9-d071-4b8d-8361-2a77e159353f
      iscommand: false
      name: Set service information (Is Active)
      type: regular
      version: -1
      scriptName: GridFieldSetup
    taskid: fdaef9a9-d071-4b8d-8361-2a77e159353f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 190,
          "y": 680
        }
      }
  "100":
    continueonerrortype: ""
    id: "100"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "107"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: xpanseservicedetails
      keys:
        simple: field,value
      val1:
        simple: Potential CVEs
      val2:
        complex:
          accessor: externally_inferred_vulnerability_score
          root: ASM.ExternalService
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
            operator: SetIfEmpty
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Example of command:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: 667637a3-7289-42a3-88f8-38f9085aabe1
      iscommand: false
      name: Set service information (Potential CVEs)
      type: regular
      version: -1
      scriptName: GridFieldSetup
    taskid: 667637a3-7289-42a3-88f8-38f9085aabe1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 190,
          "y": 1010
        }
      }
  "101":
    continueonerrortype: ""
    id: "101"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "100"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: xpanseservicedetails
      keys:
        simple: field,value
      val1:
        simple: Active Classifications
      val2:
        complex:
          accessor: active_classifications
          root: ASM.ExternalService
          transformers:
          - args:
              separator:
                value:
                  simple: ', '
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Example of command:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: edcabcaa-be6e-45ec-86a5-add2df3e2734
      iscommand: false
      name: Set service information (Active Classifications)
      type: regular
      version: -1
      scriptName: GridFieldSetup
    taskid: edcabcaa-be6e-45ec-86a5-add2df3e2734
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 190,
          "y": 845
        }
      }
  "102":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: type
                root: ASM.AssetInternetExposure
          operator: isEqualString
          right:
            value:
              simple: Certificate
      label: "yes"
    continueonerrortype: ""
    id: "102"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "38"
      "yes":
      - "114"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determines if there is an asset of type certificate.
      id: e0856db5-4c44-4f19-89ee-84768af91985
      iscommand: false
      name: Is there a certificate asset?
      type: condition
      version: -1
    taskid: e0856db5-4c44-4f19-89ee-84768af91985
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 860,
          "y": 680
        }
      }
  "103":
    continueonerrortype: ""
    id: "103"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: xpansecertificateasset
      keys:
        simple: name,type,date_added,tags,explainers,subject,subject_alerternative_names,issuer,issuer_email,expires,algorithm
      val1:
        complex:
          accessor: name
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Certificate
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
            operator: SetIfEmpty
      val2:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Certificate
          root: ASM.AssetInternetExposure.type
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
            operator: SetIfEmpty
      val3:
        complex:
          accessor: created
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Certificate
          root: ASM.AssetInternetExposure
          transformers:
          - operator: SetIfEmpty
            args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: '0'
          - operator: TimeStampToDate
      val4:
        complex:
          accessor: tags
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Certificate
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              separator:
                value:
                  simple: ', '
            operator: join
      val5:
        complex:
          accessor: explainers
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Certificate
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              separator:
                value:
                  simple: ', '
            operator: join
      val6:
        complex:
          accessor: details.certificateDetails.subject
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Certificate
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
            operator: SetIfEmpty
      val7:
        complex:
          accessor: details.certificateDetails.subjectAlternativeNames
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Certificate
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
            operator: SetIfEmpty
      val8:
        complex:
          accessor: certificate_issuer
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Certificate
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
            operator: SetIfEmpty
      val9:
        complex:
          accessor: details.certificateDetails.issuerEmail
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Certificate
          root: ASM.AssetInternetExposure
          transformers:
          - operator: SetIfEmpty
            args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
      val10:
        complex:
          accessor: details.certificateDetails.validNotAfter
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Certificate
          root: ASM.AssetInternetExposure
          transformers:
          - operator: SetIfEmpty
            args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: '0'
          - operator: TimeStampToDate
      val11:
        complex:
          accessor: certificate_algorithm
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Certificate
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
            operator: SetIfEmpty
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Example of command:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: 14e9b355-fd87-4347-8ccb-eb714758de2f
      iscommand: false
      name: Set asset information (with time)
      type: regular
      version: -1
      scriptName: GridFieldSetup
    taskid: 14e9b355-fd87-4347-8ccb-eb714758de2f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 680,
          "y": 1050
        }
      }
  "104":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: type
                root: ASM.AssetInternetExposure
          operator: isEqualString
          right:
            value:
              simple: ResponsiveIP
      label: "yes"
    continueonerrortype: ""
    id: "104"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "38"
      "yes":
      - "130"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determines if there is an asset of type responsive IP.
      id: b0768e44-c968-4d69-8110-fd5cdf639a08
      iscommand: false
      name: Is there a responsive ip asset?
      type: condition
      version: -1
    taskid: b0768e44-c968-4d69-8110-fd5cdf639a08
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1550,
          "y": 680
        }
      }
  "105":
    continueonerrortype: ""
    id: "105"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: xpanseresponsiveipasset
      keys:
        simple: name,type,date_added,tags,explainers,ip_version,range,asn_number,asn_country
      val1:
        complex:
          accessor: name
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: ResponsiveIP
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
            operator: SetIfEmpty
      val2:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: ResponsiveIP
          root: ASM.AssetInternetExposure.type
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
            operator: SetIfEmpty
      val3:
        complex:
          accessor: created
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: ResponsiveIP
          root: ASM.AssetInternetExposure
          transformers:
          - operator: SetIfEmpty
            args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: '0'
          - operator: TimeStampToDate
      val4:
        complex:
          accessor: tags
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: ResponsiveIP
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              separator:
                value:
                  simple: ', '
            operator: join
      val5:
        complex:
          accessor: explainers
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              separator:
                value:
                  simple: ', '
            operator: join
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: ResponsiveIP
      val6:
        complex:
          accessor: IP_VERSION
          root: IPRangeData
          transformers:
          - operator: SetIfEmpty
            args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
      val7:
        complex:
          accessor: handle
          root: IPRangeData.DETAILS.networkRecords
          transformers:
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ', '
            operator: join
      val8:
        complex:
          accessor: ASN_HANDLES
          root: IPRangeData
          transformers:
          - args:
              separator:
                value:
                  simple: ', '
            operator: join
      val9:
        complex:
          accessor: ASN_COUNTRIES
          root: IPRangeData
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
            operator: SetIfEmpty
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Example of command:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: 38735e1d-d723-4098-b976-ed2e9bf2b409
      iscommand: false
      name: Set asset information (with time)
      type: regular
      version: -1
      scriptName: GridFieldSetup
    taskid: 38735e1d-d723-4098-b976-ed2e9bf2b409
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1390,\n    \"y\": 1450\n  }\n}"
  "107":
    continueonerrortype: ""
    id: "107"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "111"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: xpanseservicedetails
      keys:
        simple: field,value
      val1:
        simple: Confirmed Vulnerable CVEs
      val2:
        complex:
          accessor: confirmed_vulnerable_cve_ids
          root: ASM.ExternalService
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
            operator: SetIfEmpty
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Example of command:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: 8772970e-8dfc-43a2-83d8-96655ad71ec0
      iscommand: false
      name: Set service information (Confirmed Vulnerable CVEs)
      type: regular
      version: -1
      scriptName: GridFieldSetup
    taskid: 8772970e-8dfc-43a2-83d8-96655ad71ec0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 190,
          "y": 1170
        }
      }
  "108":
    continueonerror: true
    continueonerrortype: ""
    id: "108"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "109"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: xpanseservicedetails
      keys:
        simple: field,value
      val1:
        simple: First Observed
      val2:
        complex:
          accessor: first_observed
          root: ASM.ExternalService
          transformers:
          - operator: TimeStampToDate
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Example of command:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: 8802dbed-5fb6-4fb5-8857-e06df0702af4
      iscommand: false
      name: Set service information (First Observed)
      type: regular
      version: -1
      scriptName: GridFieldSetup
    taskid: 8802dbed-5fb6-4fb5-8857-e06df0702af4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 190,
          "y": 1510
        }
      }
  "109":
    continueonerror: true
    continueonerrortype: ""
    id: "109"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: xpanseservicedetails
      keys:
        simple: field,value
      val1:
        simple: Last Observed
      val2:
        complex:
          accessor: last_observed
          root: ASM.ExternalService
          transformers:
          - operator: TimeStampToDate
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Example of command:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: 8a838e32-b013-4f73-8d8c-f98c71a36f9e
      iscommand: false
      name: Set service information (Last Observed)
      type: regular
      version: -1
      scriptName: GridFieldSetup
    taskid: 8a838e32-b013-4f73-8d8c-f98c71a36f9e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 190,
          "y": 1670
        }
      }
  "111":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ASM.ExternalService.first_observed
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "111"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "38"
      "yes":
      - "108"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determines if there are time entries to add to the service grid field.
      id: 064f771f-dff0-4705-8fca-91b07804d0ed
      iscommand: false
      name: Are there time entries?
      type: condition
      version: -1
    taskid: 064f771f-dff0-4705-8fca-91b07804d0ed
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 190,
          "y": 1330
        }
      }
  "112":
    continueonerrortype: ""
    id: "112"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "99"
    note: false
    quietmode: 0
    scriptarguments:
      investigationID:
        simple: ${incident.investigationId}
      text:
        complex:
          accessor: ' confirmed_vulnerable_cve_ids'
          root: ASM.ExternalService
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
            operator: SetIfEmpty
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: aaeb28a6-25a5-4915-8a3a-5b425709617a
      iscommand: true
      name: Extract CVEs
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: aaeb28a6-25a5-4915-8a3a-5b425709617a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -230,
          "y": 510
        }
      }
  "113":
    continueonerrortype: ""
    id: "113"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "102"
      - "104"
      - "118"
      - "119"
    note: false
    quietmode: 0
    scriptarguments:
      investigationID:
        simple: ${incident.investigationId}
      text:
        complex:
          accessor: ' confirmed_vulnerable_cve_ids'
          root: ASM.ExternalService
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
            operator: SetIfEmpty
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.extract.indicators
      id: 718b677b-8e2f-4679-81c9-34af5702e041
      iscommand: true
      name: Extract CVEs
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 718b677b-8e2f-4679-81c9-34af5702e041
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1550,
          "y": 480
        }
      }
  "114":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: details.certificateDetails.validNotAfter
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: ASM.AssetInternetExposure.type
                    operator: isEqualString
                    right:
                      value:
                        simple: Certificate
                root: ASM.AssetInternetExposure
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "114"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "120"
      "yes":
      - "103"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determines if there are time entries to add to the asset grid field.
      id: e6a098c6-5cdc-4fdd-810d-b866d2d7da53
      iscommand: false
      name: Are there time entries?
      type: condition
      version: -1
    taskid: e6a098c6-5cdc-4fdd-810d-b866d2d7da53
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 860,
          "y": 845
        }
      }
  "118":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: type
                root: ASM.AssetInternetExposure
          operator: isEqualString
          right:
            value:
              simple: Domain
      label: "yes"
    continueonerrortype: ""
    id: "118"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "38"
      "yes":
      - "124"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determines if there is an asset of type domain.
      id: 551aaf77-07d5-4610-8f72-43949dba127f
      iscommand: false
      name: Is there a domain asset?
      type: condition
      version: -1
    taskid: 551aaf77-07d5-4610-8f72-43949dba127f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2230,
          "y": 690
        }
      }
  "119":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: type
                root: ASM.AssetInternetExposure
          operator: isEqualString
          right:
            value:
              simple: CloudIntegration
      label: "yes"
    continueonerrortype: ""
    id: "119"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "38"
      "yes":
      - "122"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determines if there is an asset of type cloud.
      id: 92d4b2f3-5493-456a-88a8-7d259da37241
      iscommand: false
      name: Is there a cloud asset?
      type: condition
      version: -1
    taskid: 92d4b2f3-5493-456a-88a8-7d259da37241
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2950,
          "y": 690
        }
      }
  "120":
    continueonerrortype: ""
    id: "120"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: xpansecertificateasset
      keys:
        simple: name,type,date_added,tags,explainers,subject,subject_alerternative_names,issuer,issuer_email,expires,algorithm
      val1:
        complex:
          accessor: name
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Certificate
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
            operator: SetIfEmpty
      val2:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Certificate
          root: ASM.AssetInternetExposure.type
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
            operator: SetIfEmpty
      val3:
        complex:
          accessor: created
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Certificate
          root: ASM.AssetInternetExposure
          transformers:
          - operator: SetIfEmpty
            args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: '0'
          - operator: TimeStampToDate
      val4:
        complex:
          accessor: tags
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Certificate
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              separator:
                value:
                  simple: ', '
            operator: join
      val5:
        complex:
          accessor: explainers
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Certificate
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              separator:
                value:
                  simple: ', '
            operator: join
      val6:
        complex:
          accessor: details.certificateDetails.subject
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Certificate
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
            operator: SetIfEmpty
      val7:
        complex:
          accessor: details.certificateDetails.subjectAlternativeNames
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Certificate
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
            operator: SetIfEmpty
      val8:
        complex:
          accessor: certificate_issuer
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Certificate
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
            operator: SetIfEmpty
      val9:
        complex:
          accessor: details.certificateDetails.issuerEmail
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Certificate
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
            operator: SetIfEmpty
      val10:
        simple: n/a
      val11:
        complex:
          accessor: certificate_algorithm
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Certificate
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
            operator: SetIfEmpty
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Example of command:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: 7e98aef7-ea93-4d3d-a1d7-f6971d9ad922
      iscommand: false
      name: Set asset information (without time)
      type: regular
      version: -1
      scriptName: GridFieldSetup
    taskid: 7e98aef7-ea93-4d3d-a1d7-f6971d9ad922
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1090,
          "y": 1050
        }
      }
  "121":
    continueonerrortype: ""
    id: "121"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: xpansedomainasset
      keys:
        simple: name,type,date_added,tags,explainers,registrar_name,registry_expiration,domain_status,registrant_name,registrant_org,registrant_email
      val1:
        complex:
          accessor: name
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Domain
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
            operator: SetIfEmpty
      val2:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Domain
          root: ASM.AssetInternetExposure.type
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
            operator: SetIfEmpty
      val3:
        complex:
          accessor: created
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Domain
          root: ASM.AssetInternetExposure
          transformers:
          - operator: SetIfEmpty
            args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: '0'
          - operator: TimeStampToDate
      val4:
        complex:
          accessor: tags
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Domain
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              separator:
                value:
                  simple: ', '
            operator: join
      val5:
        complex:
          accessor: explainers
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Domain
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              separator:
                value:
                  simple: ', '
            operator: join
      val6:
        complex:
          accessor: details.domainDetails.registrar.name
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Domain
          root: ASM.AssetInternetExposure
          transformers:
          - operator: SetIfEmpty
            args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
      val7:
        complex:
          accessor: details.domainDetails.registryExpiryDate
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Domain
          root: ASM.AssetInternetExposure
          transformers:
          - operator: SetIfEmpty
            args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: '0'
          - operator: TimeStampToDate
      val8:
        complex:
          accessor: details.domainDetails.domainStatuses
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Domain
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              separator:
                value:
                  simple: ', '
            operator: join
      val9:
        complex:
          accessor: details.domainDetails.registrant.name
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Domain
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
            operator: SetIfEmpty
      val10:
        complex:
          accessor: details.domainDetails.registrant.organization
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Domain
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
            operator: SetIfEmpty
      val11:
        complex:
          accessor: details.domainDetails.registrant.emailAddress
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Domain
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
            operator: SetIfEmpty
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Example of command:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: 6814daca-90b1-4ca2-8cce-24fd96b332a4
      iscommand: false
      name: Set asset information (with time)
      type: regular
      version: -1
      scriptName: GridFieldSetup
    taskid: 6814daca-90b1-4ca2-8cce-24fd96b332a4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2050,
          "y": 1060
        }
      }
  "122":
    continueonerrortype: ""
    id: "122"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: xpansecloudasset
      keys:
        simple: name,type,date_added,tags,explainers,externally_detected_providers,ips,domain
      val1:
        complex:
          accessor: name
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: CloudIntegration
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
            operator: SetIfEmpty
      val2:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: CloudIntegration
          root: ASM.AssetInternetExposure.type
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
            operator: SetIfEmpty
      val3:
        complex:
          accessor: created
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: CloudIntegration
          root: ASM.AssetInternetExposure
          transformers:
          - operator: SetIfEmpty
            args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: '0'
          - operator: TimeStampToDate
      val4:
        complex:
          accessor: tags
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: CloudIntegration
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              separator:
                value:
                  simple: ', '
            operator: join
      val5:
        complex:
          accessor: explainers
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: CloudIntegration
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              separator:
                value:
                  simple: ', '
            operator: join
      val6:
        complex:
          accessor: externally_detected_providers
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: CloudIntegration
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              separator:
                value:
                  simple: ', '
            operator: join
      val7:
        complex:
          accessor: ips
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: CloudIntegration
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              separator:
                value:
                  simple: ', '
            operator: join
      val8:
        complex:
          accessor: domain
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: CloudIntegration
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
            operator: SetIfEmpty
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Example of command:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: e74e7f95-57c4-4e95-9949-ea142bd3b9ae
      iscommand: false
      name: Set asset information (with time)
      type: regular
      version: -1
      scriptName: GridFieldSetup
    taskid: e74e7f95-57c4-4e95-9949-ea142bd3b9ae
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2950,
          "y": 1050
        }
      }
  "124":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: details.domainDetails.domainStatuses
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: ASM.AssetInternetExposure.type
                    operator: isEqualString
                    right:
                      value:
                        simple: Domain
                root: ASM.AssetInternetExposure
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "124"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "126"
      "yes":
      - "121"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determines if there are time entries to add to the asset grid field.
      id: 4b745d05-e52e-4c0f-8d97-2fcc071f4dec
      iscommand: false
      name: Are there time entries?
      type: condition
      version: -1
    taskid: 4b745d05-e52e-4c0f-8d97-2fcc071f4dec
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2230,
          "y": 885
        }
      }
  "126":
    continueonerrortype: ""
    id: "126"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: xpansedomainasset
      keys:
        simple: name,type,date_added,tags,explainers,registrar_name,registry_expiration,domain_status,registrant_name,registrant_org,registrant_email
      val1:
        complex:
          accessor: name
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Domain
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
            operator: SetIfEmpty
      val2:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Domain
          root: ASM.AssetInternetExposure.type
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
            operator: SetIfEmpty
      val3:
        complex:
          accessor: created
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Domain
          root: ASM.AssetInternetExposure
          transformers:
          - operator: SetIfEmpty
            args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: '0'
          - operator: TimeStampToDate
      val4:
        complex:
          accessor: tags
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Domain
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              separator:
                value:
                  simple: ', '
            operator: join
      val5:
        complex:
          accessor: explainers
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Domain
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              separator:
                value:
                  simple: ', '
            operator: join
      val6:
        complex:
          accessor: details.domainDetails.registrar.name
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Domain
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
            operator: SetIfEmpty
      val7:
        simple: n/a
      val8:
        complex:
          accessor: details.domainDetails.domainStatuses
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Domain
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              separator:
                value:
                  simple: ', '
            operator: join
      val9:
        complex:
          accessor: details.domainDetails.registrant.name
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Domain
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
            operator: SetIfEmpty
      val10:
        complex:
          accessor: details.domainDetails.registrant.organization
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Domain
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
            operator: SetIfEmpty
      val11:
        complex:
          accessor: details.domainDetails.registrant.emailAddress
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: Domain
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
            operator: SetIfEmpty
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Example of command:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: cd3caf87-1dc2-44e5-9063-3dca38edd7e8
      iscommand: false
      name: Set asset information (without time)
      type: regular
      version: -1
      scriptName: GridFieldSetup
    taskid: cd3caf87-1dc2-44e5-9063-3dca38edd7e8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2440,
          "y": 1060
        }
      }
  "128":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: xpanseassetids
                root: incident
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "128"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "38"
      "yes":
      - "89"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determines if there is an asset ID to enrich.
      id: 848e9d8a-635d-4081-b60a-bccf90e2f67c
      iscommand: false
      name: Is Xpanse Asset IDs defined?
      type: condition
      version: -1
    taskid: 848e9d8a-635d-4081-b60a-bccf90e2f67c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1550,
          "y": -15
        }
      }
  "129":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: xpanseserviceid
                root: incident
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "129"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "38"
      "yes":
      - "88"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determines if there is a service ID to enrich.
      id: 1e7f5704-542d-48b4-845c-351460a1cc69
      iscommand: false
      name: Is Xpanse Service ID defined?
      type: condition
      version: -1
    taskid: 1e7f5704-542d-48b4-845c-351460a1cc69
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 190,
          "y": -35
        }
      }
  "130":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: details.ip_ranges
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: ASM.AssetInternetExposure.type
                    operator: isEqualString
                    right:
                      value:
                        simple: ResponsiveIP
                root: ASM.AssetInternetExposure
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "130"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "131"
      "yes":
      - '132'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Indicates whether there are time entries available to add to the asset grid field.
      id: 1fe7257e-edeb-435f-9161-6ef2101e7725
      iscommand: false
      name: Are there ip_range entries?
      type: condition
      version: -1
    taskid: 1fe7257e-edeb-435f-9161-6ef2101e7725
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1550,
          "y": 860
        }
      }
  "131":
    continueonerrortype: ""
    id: "131"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: xpanseresponsiveipasset
      keys:
        simple: name,type,date_added,tags,explainers,ip_version,range,asn_number,asn_country
      val1:
        complex:
          accessor: name
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: ResponsiveIP
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
            operator: SetIfEmpty
      val2:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: ResponsiveIP
          root: ASM.AssetInternetExposure.type
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: n/a
            operator: SetIfEmpty
      val3:
        complex:
          accessor: created
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: ResponsiveIP
          root: ASM.AssetInternetExposure
          transformers:
          - operator: SetIfEmpty
            args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: '0'
          - operator: TimeStampToDate
      val4:
        complex:
          accessor: tags
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: ResponsiveIP
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              separator:
                value:
                  simple: ', '
            operator: join
      val5:
        complex:
          accessor: explainers
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ASM.AssetInternetExposure.type
              operator: isEqualString
              right:
                value:
                  simple: ResponsiveIP
          root: ASM.AssetInternetExposure
          transformers:
          - args:
              separator:
                value:
                  simple: ', '
            operator: join
      val6:
        simple: n/a
      val7:
        simple: n/a
      val8:
        simple: n/a
      val9:
        simple: n/a
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Example of command:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: 1dfb0fc2-7576-40d4-9763-79aa9da6d657
      iscommand: false
      name: Set asset information (with time)
      type: regular
      version: -1
      scriptName: GridFieldSetup
    taskid: 1dfb0fc2-7576-40d4-9763-79aa9da6d657
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1800,
          "y": 1180
        }
      }
  '132':
    id: '132'
    taskid: 6284c229-fd6c-4005-bc0f-4bce605135f7
    type: regular
    task:
      id: 6284c229-fd6c-4005-bc0f-4bce605135f7
      version: -1
      name: Store Responsive IP Address
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '133'
    scriptarguments:
      key:
        simple: ResponsiveIPAddress
      value:
        complex:
          root: ASM.AssetInternetExposure
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: ASM.AssetInternetExposure.type
                iscontext: true
              right:
                value:
                  simple: ResponsiveIP
          accessor: name
    separatecontext: false
    continueonerrortype: ''
    view: "{\n  \"position\": {\n    \"x\": 1390,\n    \"y\": 1180\n  }\n}"
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '133':
    id: '133'
    taskid: 3009de0b-7f1b-4f52-9122-3e07de2be510
    type: regular
    task:
      id: 3009de0b-7f1b-4f52-9122-3e07de2be510
      version: -1
      name: Store Temp IP Range Data
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '105'
    scriptarguments:
      key:
        simple: IPRangeData
      value:
        complex:
          root: ASM.AssetInternetExposure
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: ASM.AssetInternetExposure.type
                iscontext: true
              right:
                value:
                  simple: ResponsiveIP
          accessor: details.ip_ranges
          transformers:
          - operator: getField
            args:
              field:
                value:
                  simple: ResponsiveIPAddress
                iscontext: true
    separatecontext: false
    continueonerrortype: ''
    view: "{\n  \"position\": {\n    \"x\": 1390,\n    \"y\": 1310\n  }\n}"
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: "{\n  \"linkLabelsPosition\": {\n    \"102_38_#default#\": 0.17,\n    \"104_38_#default#\": 0.54,\n    \"111_38_#default#\": 0.33,\n    \"118_38_#default#\": 0.72,\n    \"119_38_#default#\": 0.1,\n    \"11_38_#default#\": 0.1,\n    \"128_38_#default#\": 0.2,\n    \"129_38_#default#\": 0.11,\n    \"130_131_#default#\": 0.29,\n    \"90_38_#default#\": 0.14,\n    \"97_38_#default#\": 0.14\n  },\n  \"paper\": {\n    \"dimensions\": {\n      \"height\": 2300,\n      \"width\": 3560,\n      \"x\": -230,\n      \"y\": -400\n    }\n  }\n}"
inputs: []
outputs: []
tests:
- No tests (auto formatted)
fromversion: 6.8.0
system: true
