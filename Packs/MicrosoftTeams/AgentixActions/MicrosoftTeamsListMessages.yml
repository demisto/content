commonfields:
  id: MicrosoftTeamsListMessages
  version: -1
name: MicrosoftTeamsListMessages
display: Microsoft Teams - List Messages
category: Messaging and Conferencing
tags:
  - Microsoft Teams
description: |-
  Lists messages from a Microsoft Teams chat or channel based on the provided chat ID or channel name.
  To retrieve the next page of results, use the value from the `MicrosoftTeams.MessagesListNextLink` output field as the `next_link` argument in the next execution.
args:
- name: conversation_id
  required: true
  description: |-
    The chat ID, group chat name (topic), oneOnOne member (Display name/mail/UPN), or channel name.
    Notes:
    - Supports all chars.
    - For chat, the client has to authenticate with Authorization Code Flow.
  type: string
  underlyingargname: conversation_id
- name: team_name
  description: The channel's team. Should be provided when specifying a channel name in the conversation_id argument.
  type: string
  underlyingargname: team_name
- name: limit
  description: The number of results to retrieve.
  type: number
  defaultvalue: 50
  underlyingargname: limit
- name: order_by
  description: |-
    Orders results by lastModifiedDateTime or createdDateTime in descending order.
    Options: lastModifiedDateTime, createdDateTime.
  type: string
  underlyingargname: order_by
- name: next_link
  description: The link for the next page of results.
  type: string
  underlyingargname: next_link
- description: Id of a message to retrieve its replies. Supported only for channels.
  name: message_id
  type: string
  underlyingargname: message_id
outputs:
- name: MicrosoftTeams.MessagesList.conversationId
  type: string
  description: The conversation's unique identifier.
  underlyingoutputcontextpath: MicrosoftTeams.MessagesList.conversationId
- name: MicrosoftTeams.MessagesList.messages.id
  type: string
  description: Unique ID of the message.
  underlyingoutputcontextpath: MicrosoftTeams.MessagesList.messages.id
- name: MicrosoftTeams.MessagesList.messages.replyToId
  type: string
  description: ID of the parent message or root message of the thread.
  underlyingoutputcontextpath: MicrosoftTeams.MessagesList.messages.replyToId
- name: MicrosoftTeams.MessagesList.messages.etag
  type: string
  description: Version number of the message.
  underlyingoutputcontextpath: MicrosoftTeams.MessagesList.messages.etag
- name: MicrosoftTeams.MessagesList.messages.messageType
  type: string
  description: The type of message.
  underlyingoutputcontextpath: MicrosoftTeams.MessagesList.messages.messageType
- name: MicrosoftTeams.MessagesList.messages.createdDateTime
  type: string
  description: Timestamp of when the message was created.
  underlyingoutputcontextpath: MicrosoftTeams.MessagesList.messages.createdDateTime
- name: MicrosoftTeams.MessagesList.messages.lastModifiedDateTime
  type: string
  description: Timestamp when the message is created (initial setting) or modified, including when a reaction is added or removed.
  underlyingoutputcontextpath: MicrosoftTeams.MessagesList.messages.lastModifiedDateTime
- name: MicrosoftTeams.MessagesList.messages.lastEditedDateTime
  type: string
  description: Timestamp when edits to the message were made. Triggers an "Edited" flag in the Teams UI. If no edits are made the value is null.
  underlyingoutputcontextpath: MicrosoftTeams.MessagesList.messages.lastEditedDateTime
- name: MicrosoftTeams.MessagesList.messages.deletedDateTime
  type: string
  description: Timestamp when the message was deleted, or null if not deleted.
  underlyingoutputcontextpath: MicrosoftTeams.MessagesList.messages.deletedDateTime
- name: MicrosoftTeams.MessagesList.messages.subject
  type: string
  description: The subject of the message, in plaintext.
  underlyingoutputcontextpath: MicrosoftTeams.MessagesList.messages.subject
- name: MicrosoftTeams.MessagesList.messages.summary
  type: string
  description: Summary text of the message that could be used for push notifications and summary views or fall back views.
  underlyingoutputcontextpath: MicrosoftTeams.MessagesList.messages.summary
- name: MicrosoftTeams.MessagesList.messages.chatId
  type: string
  description: If the message was sent in a chat, represents the identity of the chat.
  underlyingoutputcontextpath: MicrosoftTeams.MessagesList.messages.chatId
- name: MicrosoftTeams.MessagesList.messages.importance
  type: string
  description: The importance of the message.
  underlyingoutputcontextpath: MicrosoftTeams.MessagesList.messages.importance
- name: MicrosoftTeams.MessagesList.messages.locale
  type: string
  description: Locale of the message set by the client.
  underlyingoutputcontextpath: MicrosoftTeams.MessagesList.messages.locale
- name: MicrosoftTeams.MessagesList.messages.webUrl
  type: string
  description: Link to the message in Microsoft Teams.
  underlyingoutputcontextpath: MicrosoftTeams.MessagesList.messages.webUrl
- name: MicrosoftTeams.MessagesList.messages.channelIdentity
  type: string
  description: If the message was sent in a channel, represents the identity of the channel.
  underlyingoutputcontextpath: MicrosoftTeams.MessagesList.messages.channelIdentity
- name: MicrosoftTeams.MessagesList.messages.policyViolation
  type: string
  description: Defines the properties of a policy violation set by a data loss prevention (DLP) application.
  underlyingoutputcontextpath: MicrosoftTeams.MessagesList.messages.policyViolation
- name: MicrosoftTeams.MessagesList.messages.eventDetail
  type: string
  description: If present, represents details of an event that happened in a chat, a channel, or a team, for example, adding new members.
  underlyingoutputcontextpath: MicrosoftTeams.MessagesList.messages.eventDetail
- name: MicrosoftTeams.MessagesList.messages.from
  type: string
  description: Details of the sender of the message.
  underlyingoutputcontextpath: MicrosoftTeams.MessagesList.messages.from
- name: MicrosoftTeams.MessagesList.messages.body.content
  type: string
  description: The content of the message.
  underlyingoutputcontextpath: MicrosoftTeams.MessagesList.messages.body.content
- name: MicrosoftTeams.MessagesList.messages.body.contentType
  type: string
  description: Plaintext/HTML representation of the content of the message.
  underlyingoutputcontextpath: MicrosoftTeams.MessagesList.messages.body.contentType
- name: MicrosoftTeams.MessagesList.messages.attachments
  type: string
  description: References to attached objects like files, tabs, meetings, etc.
  underlyingoutputcontextpath: MicrosoftTeams.MessagesList.messages.attachments
- name: MicrosoftTeams.MessagesList.messages.attachments.content
  type: string
  description: The content of the attachments.
  underlyingoutputcontextpath: MicrosoftTeams.MessagesList.messages.attachments.content
- name: MicrosoftTeams.MessagesList.messages.mentions
  type: string
  description: List of entities mentioned in the message.
  underlyingoutputcontextpath: MicrosoftTeams.MessagesList.messages.mentions
- name: MicrosoftTeams.MessagesList.messages.reactions
  type: string
  description: Reactions for this message (for example, Like).
  underlyingoutputcontextpath: MicrosoftTeams.MessagesList.messages.reactions
- name: MicrosoftTeams.MessagesListNextLink
  type: string
  description: Used if an operation returns partial results. If a response contains a NextLink element, its value specifies a starting point to use for subsequent calls.
  underlyingoutputcontextpath: MicrosoftTeams.MessagesListNextLink
- name: MicrosoftTeams.MessagesListMetadata.returned_count
  type: number
  description: |-
    IMPORTANT: returned_count must always be part of the response displayed to the user. This field must be accompanied by its definition: The actual number of script results returned in this specific execution.
  underlyingoutputcontextpath: MicrosoftTeams.MessagesListMetadata.returned_count
- name: MicrosoftTeams.MessagesListMetadata.filtered_count
  type: number
  description: |-
    IMPORTANT: filtered_count must always be part of the response displayed to the user. This field must be accompanied by its definition: The total number of script results in the system that match the specified filter criteria.
  underlyingoutputcontextpath: MicrosoftTeams.MessagesListMetadata.filtered_count
underlyingcontentitem:
  id: Microsoft Teams
  name: Microsoft Teams
  type: command
  version: -1
  command: microsoft-teams-list-messages
requiresuserapproval: false
marketplaces:
- platform
