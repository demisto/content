category: Cloud Services
description: Cloud integrations are installed from the **Data Sources** page. To configure a cloud integration, go to Settings > Data Sources and click "Add Data Source", select AWS, then in Advanced Settings > Security Capabilities, enable "Automation".
display: Amazon Web Services
name: AWS
commonfields:
  id: AWS
  version: -1
configuration:
- display: Main Role
  name: role_name
  type: 0
  section: Connect
  required: false
  additionalinfo: Main role for authentication, for example 'PowerUserAccess'.
- display: Default AWS Account ID
  name: test_account_id
  type: 0
  section: Connect
  additionalinfo: AWS Account ID used for running integration test
- display: Role Session Name
  name: role_session_name
  type: 0
  defaultvalue: cortex-session
  section: Connect
  advanced: true
  additionalinfo: Role session name to be used for authentication
- display: Role Session Duration
  name: session_duration
  type: 0
  section: Connect
  advanced: true
  required: false
  additionalinfo: Max role session duration
- display: Default AWS Access Key ID
  name: access_key_id
  additionalinfo: "AWS access key ID used for authentication when role-based authentication is not available. Must be used together with 'Default AWS Secret Access Key'. If provided, these credentials provide backup authentication when role assumption fails."
  type: 0
  section: Connect
  advanced: true
  required: false
- display: Default AWS Secret Access Key
  name: secret_access_key
  additionalinfo: "AWS Secret Access Key used for authentication when role-based authentication is not available. Must be used together with 'Default AWS Access Key ID'. If provided, these credentials will be used as a fallback when role assumption fails."
  type: 9
  section: Connect
  advanced: true
  required: false
- display: Default AWS region.
  name: region
  type: 0
  section: Connect
  additionalinfo: "The AWS region to use for API requests when a region is not explicitly specified in a command. This serves as the default region for operations across all AWS service-specific commands."
- display: Timeout
  name: timeout
  type: 0
  section: Connect
  advanced: true
  required: false
  additionalinfo: "The time in seconds until a timeout exception is reached. You can specify just the read timeout (for example 60) or the read and connect timeouts separated by a comma (for example 60,10). Default is 60,10."
  defaultvalue: 60,10
- display: Retries
  additionalinfo: "The maximum number of retry attempts when connection or throttling errors are encountered. Set to 0 to disable retries. The default value is 5 and the limit is 10. Note: Increasing the number of retries will increase the execution time."
  name: retries
  type: 0
  section: Connect
  advanced: true
  required: false
  defaultvalue: 5
- display: PrivateLink service URL.
  name: endpoint_url
  type: 0
  section: Connect
  advanced: true
  required: false
- display: STS PrivateLink URL.
  name: sts_endpoint_url
  type: 0
  section: Connect
  advanced: true
  required: false
- display: AWS STS Regional Endpoints
  name: sts_regional_endpoint
  type: 15
  section: Connect
  advanced: true
  required: false
  additionalinfo: Sets the AWS_STS_REGIONAL_ENDPOINTS environment variable to specify the AWS STS endpoint resolution logic. By default, this option is set to “legacy” in AWS. Leave empty if the environment variable is already set using server configuration.
  options:
  - legacy
  - regional
- display: Role name for cross-organization account access
  name: access_role_name
  type: 0
  section: Connect
  advanced: true
  required: false
  additionalinfo: The role name used to access accounts in the organization. This role name must exist in the accounts provided in "AWS Organization accounts" and be assumable with the credentials provided.
- display: Use system proxy settings
  name: proxy
  type: 8
  section: Connect
  advanced: true
  required: false
- display: Trust any certificate (not secure)
  name: insecure
  type: 8
  section: Connect
  advanced: true
  required: false
script:
  commands:
  - name: aws-s3-public-access-block-update
    description: "Creates or modifies the PublicAccessBlock configuration for an Amazon S3 bucket."
    arguments:
    - description: The AWS account ID.
      name: account_id
      required: true
    - description: The AWS region.
      name: region
      required: true
      auto: PREDEFINED
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - af-south-1
      - ap-east-1
      - ap-south-2
      - ap-southeast-3
      - ap-southeast-5
      - ap-southeast-4
      - ap-south-1
      - ap-northeast-3
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-southeast-7
      - ap-northeast-1
      - ca-central-1
      - ca-west-1
      - eu-central-1
      - eu-west-1
      - eu-west-2
      - eu-south-1
      - eu-west-3
      - eu-south-2
      - eu-north-1
      - eu-central-2
      - il-central-1
      - mx-central-1
      - me-south-1
      - me-central-1
      - sa-east-1
    - description: The name of the Amazon S3 bucket.
      name: bucket
      required: true
    - description: Weather Amazon S3 should block public access control lists (ACLs) for this bucket and objects in this bucket.
      name: block_public_acls
      auto: PREDEFINED
      predefined:
      - 'true'
      - 'false'
    - description: Weather Amazon S3 should ignore public ACLs for this bucket and objects in this bucket.
      name: ignore_public_acls
      auto: PREDEFINED
      predefined:
      - 'true'
      - 'false'
    - description: Weather Amazon S3 should block public bucket policies for this bucket.
      name: block_public_policy
      auto: PREDEFINED
      predefined:
      - 'true'
      - 'false'
    - description: Weather Amazon S3 should restrict public bucket policies for this bucket.
      name: restrict_public_buckets
      auto: PREDEFINED
      predefined:
      - 'true'
      - 'false'

    
  - name: aws-s3-bucket-acl-put
    description: Sets the access control list (ACL) permissions for an existing Amazon S3 bucket. This command allows you to define who can access the bucket and what actions they can perform, using predefined ACLs. Since 2023, all new S3 buckets *block* ACLs by default for better security.
    arguments:
    - description: The AWS account ID.
      name: account_id
      required: true
    - name: region
      description: The AWS region.
      required: true
      auto: PREDEFINED
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - af-south-1
      - ap-east-1
      - ap-south-2
      - ap-southeast-3
      - ap-southeast-5
      - ap-southeast-4
      - ap-south-1
      - ap-northeast-3
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-southeast-7
      - ap-northeast-1
      - ca-central-1
      - ca-west-1
      - eu-central-1
      - eu-west-1
      - eu-west-2
      - eu-south-1
      - eu-west-3
      - eu-south-2
      - eu-north-1
      - eu-central-2
      - il-central-1
      - mx-central-1
      - me-south-1
      - me-central-1
      - sa-east-1

    - name: acl
      description: 'The canned ACL to apply to the bucket.'
      required: true
      auto: PREDEFINED
      predefined:
      - private
      - public-read
      - public-read-write
      - authenticated-read
    - name: bucket
      description: 'The bucket to which to apply the ACL.'
      required: true

  - name: aws-s3-bucket-logging-put
    description: Configure logging settings for an AWS S3 bucket, allowing to monitor access to the bucket through detailed access logs that are delivered to a designated target bucket.
    arguments:
    - description: The AWS account ID.
      name: account_id
      required: true
    - description: The AWS region.
      name: region
      required: true
      auto: PREDEFINED
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - af-south-1
      - ap-east-1
      - ap-south-2
      - ap-southeast-3
      - ap-southeast-5
      - ap-southeast-4
      - ap-south-1
      - ap-northeast-3
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-southeast-7
      - ap-northeast-1
      - ca-central-1
      - ca-west-1
      - eu-central-1
      - eu-west-1
      - eu-west-2
      - eu-south-1
      - eu-west-3
      - eu-south-2
      - eu-north-1
      - eu-central-2
      - il-central-1
      - mx-central-1
      - me-south-1
      - me-central-1
      - sa-east-1
    - description: 'The name of the bucket for which to set the logging parameters.'
      name: bucket
      required: true
    - description: 'The name of the bucket where server access logs should be delivered. If this is NOT provided, logging will be disabled.'
      name: target_bucket
      required: false
    - description: 'The prefix to be used for log object keys (e.g., "logs/"). Objects will be stored as: targetBucket/targetPrefix/sourceBucket/YYYY-MM-DD-HH-MM-SS-UniqueString.'
      name: target_prefix
      required: false
  - name: aws-s3-bucket-versioning-put
    description: Sets the versioning state of an existing bucket.
    arguments:
    - description: The AWS account ID.
      name: account_id
      required: true
    - description: The AWS region.
      name: region
      required: true
      auto: PREDEFINED
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - af-south-1
      - ap-east-1
      - ap-south-2
      - ap-southeast-3
      - ap-southeast-5
      - ap-southeast-4
      - ap-south-1
      - ap-northeast-3
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-southeast-7
      - ap-northeast-1
      - ca-central-1
      - ca-west-1
      - eu-central-1
      - eu-west-1
      - eu-west-2
      - eu-south-1
      - eu-west-3
      - eu-south-2
      - eu-north-1
      - eu-central-2
      - il-central-1
      - mx-central-1
      - me-south-1
      - me-central-1
      - sa-east-1
    - description: The name of the bucket for which to set the logging parameters.
      name: bucket
      required: true
    - description: Weather MFA delete is enabled in the bucket versioning configuration. This element is only returned if the bucket has been configured with MFA delete. If the bucket has never been so configured, this element is not returned.
      name: mfa_delete
      required: false
    - auto: PREDEFINED
      description: The versioning state of the bucket.
      name: status
      predefined:
      - 'Enabled'
      - 'Suspended'
      required: true
  - name: aws-s3-bucket-policy-put
    description: Applies an Amazon S3 bucket policy to an Outposts bucket.
    arguments:
    - name: account_id
      description: The AWS account ID.
      required: true
    - name: region
      description: The AWS region.
      required: true
      auto: PREDEFINED
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - af-south-1
      - ap-east-1
      - ap-south-2
      - ap-southeast-3
      - ap-southeast-5
      - ap-southeast-4
      - ap-south-1
      - ap-northeast-3
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-southeast-7
      - ap-northeast-1
      - ca-central-1
      - ca-west-1
      - eu-central-1
      - eu-west-1
      - eu-west-2
      - eu-south-1
      - eu-west-3
      - eu-south-2
      - eu-north-1
      - eu-central-2
      - il-central-1
      - mx-central-1
      - me-south-1
      - me-central-1
      - sa-east-1
    - name: bucket
      description: 'The name of the bucket to which the policy will be applied.'
      required: true
    - name: policy
      description: 'The bucket policy to apply as a JSON string.'
      required: true


  - name: aws-iam-account-password-policy-get
    description: Gets the AWS account password policy.
    arguments:
    - description: The AWS account ID.
      name: account_id
      required: true
    - description: The AWS region.
      name: region
      required: false
      auto: PREDEFINED
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - af-south-1
      - ap-east-1
      - ap-south-2
      - ap-southeast-3
      - ap-southeast-5
      - ap-southeast-4
      - ap-south-1
      - ap-northeast-3
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-southeast-7
      - ap-northeast-1
      - ca-central-1
      - ca-west-1
      - eu-central-1
      - eu-west-1
      - eu-west-2
      - eu-south-1
      - eu-west-3
      - eu-south-2
      - eu-north-1
      - eu-central-2
      - il-central-1
      - mx-central-1
      - me-south-1
      - me-central-1
      - sa-east-1

    outputs:
    - contextPath: AWS.IAM.PasswordPolicy.MinimumPasswordLength
      description: Minimum length to require for IAM user passwords.
      type: number
    - contextPath: AWS.IAM.PasswordPolicy.RequireSymbols
      description: Whether IAM user passwords must contain at least one of the symbols.
      type: boolean
    - contextPath: AWS.IAM.PasswordPolicy.RequireNumbers
      description: Whether IAM user passwords must contain at least one numeric character (0 to 9).
      type: boolean
    - contextPath: AWS.IAM.PasswordPolicy.RequireUppercaseCharacters
      description: Whether IAM user passwords must contain at least one uppercase character (A to Z).
      type: boolean
    - contextPath: AWS.IAM.PasswordPolicy.RequireLowercaseCharacters
      description: Whether IAM user passwords must contain at least one lowercase character (a to z).
      type: boolean
    - contextPath: AWS.IAM.PasswordPolicy.AllowUsersToChangePassword
      description: Whether IAM users are allowed to change their own password.
      type: boolean
    - contextPath: AWS.IAM.PasswordPolicy.ExpirePasswords
      description: Whether passwords in the account expire.
      type: boolean
    - contextPath: AWS.IAM.PasswordPolicy.MaxPasswordAge
      description: The number of days that an IAM user password is valid.
      type: number
    - contextPath: AWS.IAM.PasswordPolicy.PasswordReusePrevention
      description: The number of previous passwords that IAM users are prevented from reusing.
      type: number
    - contextPath: AWS.IAM.PasswordPolicy.HardExpiry
      description: Whether IAM users are prevented from setting a new password via the Amazon Web Services Management Console after their password has expired.
      type: boolean

  - name: aws-iam-account-password-policy-update
    description: Create or Update AWS account password policy.
    execution: true
    arguments:
    - description: The AWS account ID.
      name: account_id
      required: true
    - description: The minimum number of characters allowed in an IAM user password.
      name: minimum_password_length
    - auto: PREDEFINED
      description: Whether IAM user passwords must contain at least one of the non-alphanumeric characters.
      name: require_symbols
      predefined:
      - 'true'
      - 'false'
    - auto: PREDEFINED
      description: Whether IAM user passwords must contain at least one numeric character (0 to 9).
      name: require_numbers
      predefined:
      - 'true'
      - 'false'
    - auto: PREDEFINED
      description: Weather IAM user passwords must contain at least one uppercase character from the ISO basic Latin alphabet (A to Z). Can be "True" or "False".
      name: require_uppercase_characters
      predefined:
      - 'true'
      - 'false'
    - auto: PREDEFINED
      description: Weather IAM user passwords must contain at least one lowercase character from the ISO basic Latin alphabet (a to z). Can be "True" or "False".
      name: require_lowercase_characters
      predefined:
      - 'true'
      - 'false'
    - auto: PREDEFINED
      description: Allows all IAM users in your account to use the AWS Management Console to change their own passwords. Can be "True" or "False".
      name: allow_users_to_change_password
      predefined:
      - 'true'
      - 'false'
    - description: The number of days that an IAM user password is valid.
      name: max_password_age
    - description: The number of previous passwords that IAM users are prevented from reusing.
      name: password_reuse_prevention
    - auto: PREDEFINED
      description: Prevents IAM users from setting a new password after their password has expired. Can be "True" or "False".
      name: hard_expiry
      predefined:
      - 'true'
      - 'false'

  - name: aws-iam-role-policy-put
    description: Adds or updates an inline policy document that is embedded in the specified IAM role.
    arguments:
    - name: account_id
      description: The AWS account ID.
      required: true
    - name: region
      description: The AWS region.
      required: true
      auto: PREDEFINED
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - af-south-1
      - ap-east-1
      - ap-south-2
      - ap-southeast-3
      - ap-southeast-5
      - ap-southeast-4
      - ap-south-1
      - ap-northeast-3
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-southeast-7
      - ap-northeast-1
      - ca-central-1
      - ca-west-1
      - eu-central-1
      - eu-west-1
      - eu-west-2
      - eu-south-1
      - eu-west-3
      - eu-south-2
      - eu-north-1
      - eu-central-2
      - il-central-1
      - mx-central-1
      - me-south-1
      - me-central-1
      - sa-east-1

    - name: role_name
      description: 'The name of the role to associate the policy with. This parameter accepts a string of upper and lowercase letters and numbers, with no spaces. You can also include any of the following characters: _+=,.@-.'
      required: true
    - name: policy_name
      description: 'The name of the policy document. This parameter accepts a string of upper and lowercase letters and numbers, with no spaces. You can also include any of the following characters: _+=,.@-.'
      required: true
    - name: policy_document
      description: 'The policy document in JSON format. Must be a valid IAM policy document that defines the permissions for the role.'
      required: true

  - name: aws-iam-login-profile-delete
    description: Deletes the password for the specified IAM user, which terminates the user's ability to access AWS services through the AWS Management Console.
    arguments:
    - name: account_id
      description: The AWS account ID.
      required: true
    - name: region
      description: The AWS region.
      required: true
      auto: PREDEFINED
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - af-south-1
      - ap-east-1
      - ap-south-2
      - ap-southeast-3
      - ap-southeast-5
      - ap-southeast-4
      - ap-south-1
      - ap-northeast-3
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-southeast-7
      - ap-northeast-1
      - ca-central-1
      - ca-west-1
      - eu-central-1
      - eu-west-1
      - eu-west-2
      - eu-south-1
      - eu-west-3
      - eu-south-2
      - eu-north-1
      - eu-central-2
      - il-central-1
      - mx-central-1
      - me-south-1
      - me-central-1
      - sa-east-1
    - name: user_name
      description: The name of the user whose password you want to delete.
      required: true

  - name: aws-iam-user-policy-put
    description: Adds or updates an inline policy document that is embedded in the specified IAM user.
    arguments:
    - name: account_id
      description: The AWS account ID.
      required: true
    - name: region
      description: The AWS region.
      required: true
      auto: PREDEFINED
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - af-south-1
      - ap-east-1
      - ap-south-2
      - ap-southeast-3
      - ap-southeast-5
      - ap-southeast-4
      - ap-south-1
      - ap-northeast-3
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-southeast-7
      - ap-northeast-1
      - ca-central-1
      - ca-west-1
      - eu-central-1
      - eu-west-1
      - eu-west-2
      - eu-south-1
      - eu-west-3
      - eu-south-2
      - eu-north-1
      - eu-central-2
      - il-central-1
      - mx-central-1
      - me-south-1
      - me-central-1
      - sa-east-1
    - name: user_name
      description: The name of the user to associate the policy with.
      required: true
    - name: policy_name
      description: The name of the policy document.
      required: true
    - name: policy_document
      description: The policy document in JSON format. Must be a valid IAM policy document that defines the permissions for the user.
      required: true

  - name: aws-iam-role-from-instance-profile-remove
    description: Removes the specified IAM role from the specified EC2 instance profile.
    arguments:
    - name: account_id
      description: The AWS account ID.
      required: true
    - name: region
      description: The AWS region.
      required: true
      auto: PREDEFINED
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - af-south-1
      - ap-east-1
      - ap-south-2
      - ap-southeast-3
      - ap-southeast-5
      - ap-southeast-4
      - ap-south-1
      - ap-northeast-3
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-southeast-7
      - ap-northeast-1
      - ca-central-1
      - ca-west-1
      - eu-central-1
      - eu-west-1
      - eu-west-2
      - eu-south-1
      - eu-west-3
      - eu-south-2
      - eu-north-1
      - eu-central-2
      - il-central-1
      - mx-central-1
      - me-south-1
      - me-central-1
      - sa-east-1
    - name: instance_profile_name
      description: The name of the instance profile to update.
      required: true
    - name: role_name
      description: The name of the role to remove.
      required: false

  - name: aws-iam-access-key-update
    description: Changes the status of the specified access key from Active to Inactive, or vice versa. This operation can be used to disable a user's access key as part of a key rotation workflow.
    arguments:
    - name: account_id
      description: The AWS account ID.
      required: true
    - name: region
      description: The AWS region.
      required: true
      auto: PREDEFINED
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - af-south-1
      - ap-east-1
      - ap-south-2
      - ap-southeast-3
      - ap-southeast-5
      - ap-southeast-4
      - ap-south-1
      - ap-northeast-3
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-southeast-7
      - ap-northeast-1
      - ca-central-1
      - ca-west-1
      - eu-central-1
      - eu-west-1
      - eu-west-2
      - eu-south-1
      - eu-west-3
      - eu-south-2
      - eu-north-1
      - eu-central-2
      - il-central-1
      - mx-central-1
      - me-south-1
      - me-central-1
      - sa-east-1
    - name: access_key_id
      description: The access key ID of the secret access key you want to update.
      required: true
    - name: status
      description: The status you want to assign to the secret access key.
      required: true
      auto: PREDEFINED
      predefined:
      - 'Active'
      - 'Inactive'
    - name: user_name
      description: The name of the user whose key you want to update. If you do not specify a user name, IAM determines the user name implicitly based on the AWS access key ID signing the request.
      required: false

  - name: aws-eks-cluster-config-update
    description: 'Updates an Amazon EKS cluster configuration. Only a single type of update can (logging / resources_vpc_config) is allowed per call.'
    arguments:
    - name: account_id
      description: The AWS account ID.
      required: true
    - name: region
      description: The AWS region.
      required: true
      auto: PREDEFINED
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - af-south-1
      - ap-east-1
      - ap-south-2
      - ap-southeast-3
      - ap-southeast-5
      - ap-southeast-4
      - ap-south-1
      - ap-northeast-3
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-southeast-7
      - ap-northeast-1
      - ca-central-1
      - ca-west-1
      - eu-central-1
      - eu-west-1
      - eu-west-2
      - eu-south-1
      - eu-west-3
      - eu-south-2
      - eu-north-1
      - eu-central-2
      - il-central-1
      - mx-central-1
      - me-south-1
      - me-central-1
      - sa-east-1
    - name: cluster_name
      description: 'The name of the Amazon EKS cluster to update.'
      required: true
    - name: logging
      description: "Enable or disable exporting the Kubernetes control plane logs for your cluster to CloudWatch Logs. By default, cluster control plane logs aren’t exported to CloudWatch Logs. For example \"{'clusterLogging': [{'types': ['api', 'audit', 'authenticator', 'controllerManager', 'scheduler'], 'enabled': true}]}\"."
      required: false
    - name: resources_vpc_config
      description: "A JSON representation of the VPC configuration used by the cluster control plane. For example \"{'subnetIds': ['string'], 'securityGroupIds': ['string'], 'endpointPublicAccess': True, 'endpointPrivateAccess': True, 'publicAccessCidrs': ['string']}\"."
      required: false


  - name: aws-rds-db-cluster-modify
    description: Modifies settings for an Amazon RDS DB cluster. Allows you to update cluster settings such as port, master credentials, VPC security groups, deletion protection, and other configuration options.
    arguments:
    - name: account_id
      description: The AWS account ID.
      required: true
    - name: region
      description: The AWS region.
      required: true
      auto: PREDEFINED
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - af-south-1
      - ap-east-1
      - ap-south-2
      - ap-southeast-3
      - ap-southeast-5
      - ap-southeast-4
      - ap-south-1
      - ap-northeast-3
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-southeast-7
      - ap-northeast-1
      - ca-central-1
      - ca-west-1
      - eu-central-1
      - eu-west-1
      - eu-west-2
      - eu-south-1
      - eu-west-3
      - eu-south-2
      - eu-north-1
      - eu-central-2
      - il-central-1
      - mx-central-1
      - me-south-1
      - me-central-1
      - sa-east-1
    - name: db_cluster_identifier
      description: 'The DB cluster identifier for the modified cluster. This parameter is not case sensitive and is valid for Aurora DB and Multi-AZ DB cluster types. It must match the identifier of an existing DB cluster.'
      required: true
    - name: deletion_protection
      description: 'Weather the DB cluster has deletion protection enabled. The database can’t be deleted when deletion protection is enabled. By default, deletion protection isn’t enabled.'
      auto: PREDEFINED
      predefined:
      - 'true'
      - 'false'
    - name: enable_iam_database_authentication
      description: 'Weather to enable mapping of Amazon Web Services Identity and Access Management (IAM) accounts to database accounts. By default, mapping isn’t enabled.'
      auto: PREDEFINED
      predefined:
      - 'true'
      - 'false'
  - name: aws-rds-db-cluster-snapshot-attribute-modify
    description: Modifies the attributes associated with a DB cluster snapshot.
    arguments:
    - name: account_id
      description: The AWS account ID.
      required: true
    - name: region
      description: The AWS region.
      required: true
      auto: PREDEFINED
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - af-south-1
      - ap-east-1
      - ap-south-2
      - ap-southeast-3
      - ap-southeast-5
      - ap-southeast-4
      - ap-south-1
      - ap-northeast-3
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-southeast-7
      - ap-northeast-1
      - ca-central-1
      - ca-west-1
      - eu-central-1
      - eu-west-1
      - eu-west-2
      - eu-south-1
      - eu-west-3
      - eu-south-2
      - eu-north-1
      - eu-central-2
      - il-central-1
      - mx-central-1
      - me-south-1
      - me-central-1
      - sa-east-1
    - name: db_cluster_snapshot_identifier
      description: 'The identifier for the DB cluster snapshot to modify the attributes for.'
      required: true
    - name: attribute_name
      description: 'The name of the DB cluster snapshot attribute to modify.'
      required: true
    - name: values_to_remove
      description: 'A CSV list of DB cluster snapshot attributes to remove from the attribute specified by AttributeName. Default is all.'
      required: false
    - name: values_to_add
      description: 'A CSV list of DB cluster snapshot attributes to add to the attribute specified by AttributeName.'
      required: false

  - name: aws-rds-db-instance-modify
    description: "Modifies an Amazon RDS DB instance. Allows changing various settings of an existing DB instance, such as instance class, storage capacity, security groups, and other configuration parameters."
    arguments:
    - name: account_id
      description: The AWS account ID.
      required: true
    - name: region
      description: The AWS region.
      required: true
      auto: PREDEFINED
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - af-south-1
      - ap-east-1
      - ap-south-2
      - ap-southeast-3
      - ap-southeast-5
      - ap-southeast-4
      - ap-south-1
      - ap-northeast-3
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-southeast-7
      - ap-northeast-1
      - ca-central-1
      - ca-west-1
      - eu-central-1
      - eu-west-1
      - eu-west-2
      - eu-south-1
      - eu-west-3
      - eu-south-2
      - eu-north-1
      - eu-central-2
      - il-central-1
      - mx-central-1
      - me-south-1
      - me-central-1
      - sa-east-1
    - name: db_instance_identifier
      description: 'The identifier of DB instance to modify. This value is stored as a lowercase string.'
      required: true
    - name: publicly_accessible
      description: 'Weather the DB instance is publicly accessible.'
      required: false
      auto: PREDEFINED
      predefined:
      - 'true'
      - 'false'
    - name: apply_immediately
      description: 'Weather the modifications in this request and any pending modifications are asynchronously applied as soon as possible, regardless of the PreferredMaintenanceWindow setting for the DB instance. By default, this parameter is disabled. If this parameter is disabled, changes to the DB instance are applied during the next maintenance window. Some parameter changes can cause an outage and are applied on the next call to RebootDBInstance , or the next failure reboot.'
      required: false
      auto: PREDEFINED
      predefined:
      - 'true'
      - 'false'
    - name: copy_tags_to_snapshot
      description: 'Weather to copy all tags from the DB instance to snapshots of the DB instance. By default, tags aren’t copied.'
      required: false
      auto: PREDEFINED
      predefined:
      - 'true'
      - 'false'
    - name: backup_retention_period
      description: 'The number of days to retain automated backups. Setting this parameter to a positive number enables backups. Setting this parameter to 0 disables automated backups.'
      required: false
    - name: enable_iam_database_authentication
      description: 'Weather to enable mapping of Amazon Web Services Identity and Access Management (IAM) accounts to database accounts. By default, mapping isn’t enabled.'
      required: false
      auto: PREDEFINED
      predefined:
      - 'true'
      - 'false'
    - name: deletion_protection
      description: 'Weather the DB instance has deletion protection enabled. The database can’t be deleted when deletion protection is enabled. By default, deletion protection isn’t enabled. For more information, see Deleting a DB Instance.'
      required: false
      auto: PREDEFINED
      predefined:
      - 'true'
      - 'false'
    - name: auto_minor_version_upgrade
      description: 'Weather minor version upgrades are applied automatically to the DB instance during the maintenance window. An outage occurs when all the following conditions are met: The automatic upgrade is enabled for the maintenance window. A newer minor version is available. RDS has enabled automatic patching for the engine version. If any of the preceding conditions isn’t met, Amazon RDS applies the change as soon as possible and doesn’t cause an outage. For an RDS Custom DB instance, don’t enable this setting. Otherwise, the operation returns an error.'
      required: false
      auto: PREDEFINED
      predefined:
      - 'true'
      - 'false'
    - name: multi_az
      description: 'Weather the DB instance is a Multi-AZ deployment. Changing this parameter doesn’t result in an outage. The change is applied during the next maintenance window unless the ApplyImmediately parameter is enabled for this request. This setting doesn’t apply to RDS Custom DB instances.'
      required: false
      auto: PREDEFINED
      predefined:
      - 'true'
      - 'false'
  - name: aws-rds-db-snapshot-attribute-modify
    description: Adds or removes permission for the specified AWS account ID to restore the specified DB snapshot.
    arguments:
    - name: account_id
      description: The AWS account ID.
      required: true
    - name: region
      description: The AWS region.
      required: true
      auto: PREDEFINED
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - af-south-1
      - ap-east-1
      - ap-south-2
      - ap-southeast-3
      - ap-southeast-5
      - ap-southeast-4
      - ap-south-1
      - ap-northeast-3
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-southeast-7
      - ap-northeast-1
      - ca-central-1
      - ca-west-1
      - eu-central-1
      - eu-west-1
      - eu-west-2
      - eu-south-1
      - eu-west-3
      - eu-south-2
      - eu-north-1
      - eu-central-2
      - il-central-1
      - mx-central-1
      - me-south-1
      - me-central-1
      - sa-east-1
    - name: db_snapshot_identifier
      description: 'The identifier for the DB snapshot to modify the attributes for.'
      required: true
    - name: attribute_name
      description: 'The name of the DB snapshot attribute to modify.'
      required: true
    - name: values_to_add
      description: 'A list of DB snapshot attributes to add to the attribute specified by AttributeName.'
      required: false
      isArray: true
    - name: values_to_remove
      description: 'A list of DB snapshot attributes to remove from the attribute specified by AttributeName.'
      isArray: true
      required: false


  - name: aws-ec2-security-group-ingress-revoke
    description: 'Revokes one or more ingress rules in a security group.'
    arguments:
    - name: account_id
      description: The AWS account ID.
      required: true
    - name: region
      description: The AWS region.
      required: true
      auto: PREDEFINED
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - af-south-1
      - ap-east-1
      - ap-south-2
      - ap-southeast-3
      - ap-southeast-5
      - ap-southeast-4
      - ap-south-1
      - ap-northeast-3
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-southeast-7
      - ap-northeast-1
      - ca-central-1
      - ca-west-1
      - eu-central-1
      - eu-west-1
      - eu-west-2
      - eu-south-1
      - eu-west-3
      - eu-south-2
      - eu-north-1
      - eu-central-2
      - il-central-1
      - mx-central-1
      - me-south-1
      - me-central-1
      - sa-east-1

    - name: group_id
      description: 'The ID of the security group.'
      required: true
    - name: protocol
      description: 'The IP protocol: tcp, udp, icmp, or icmpv6. Use -1 to specify all protocols. When used with port and cidr arguments for simple rule revocation.'
      required: false
    - name: port
      description: 'For TCP or UDP: The range of ports to revoke (e.g., "80" or "80-443"). For ICMP: A single integer or range (type-code) representing the ICMP type and code. Use with protocol and cidr for simple rule revocation.'
      required: false
    - name: cidr
      description: 'The IPv4 address range in CIDR format (e.g., "0.0.0.0/0"). Use with protocol and port for simple rule revocation.'
      required: false
    - name: ip_permissions
      description: 'The sets of IP permissions to revoke, in JSON format. Use this for complex rule configurations or when revoking multiple rules. Cannot be used together with protocol/port/cidr arguments.'
      required: false
  - name: aws-ec2-security-group-ingress-authorize
    description: 'Adds the specified inbound (ingress) rules to a security group.'
    arguments:
    - name: account_id
      description: The AWS account ID.
      required: true
    - name: region
      description: The AWS region.
      required: true
      auto: PREDEFINED
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - af-south-1
      - ap-east-1
      - ap-south-2
      - ap-southeast-3
      - ap-southeast-5
      - ap-southeast-4
      - ap-south-1
      - ap-northeast-3
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-southeast-7
      - ap-northeast-1
      - ca-central-1
      - ca-west-1
      - eu-central-1
      - eu-west-1
      - eu-west-2
      - eu-south-1
      - eu-west-3
      - eu-south-2
      - eu-north-1
      - eu-central-2
      - il-central-1
      - mx-central-1
      - me-south-1
      - me-central-1
      - sa-east-1

    - name: group_id
      description: 'The ID of the security group.'
      required: true
    - name: protocol
      description: 'The IP protocol: tcp, udp, icmp, or icmpv6. Use -1 to specify all protocols. When used with port and cidr arguments for simple rule authorization.'
      required: false
    - name: port
      description: 'For TCP or UDP: The range of ports to authorize (e.g., "80" or "80-443"). For ICMP: A single integer or range (type-code) representing the ICMP type and code. Use with protocol and cidr for simple rule authorization.'
      required: false
    - name: cidr
      description: 'The IPv4 address range in CIDR format (e.g., "0.0.0.0/0"). Use with protocol and port for simple rule authorization.'
      required: false
    - name: ip_permissions
      description: 'The sets of IP permissions to authorize, in JSON format. Use this for complex rule configurations or when authorizing multiple rules. Cannot be used together with protocol/port/cidr arguments.'
      required: false
  - name: aws-ec2-security-group-egress-revoke
    description: 'Removes the specified outbound (egress) rules from the specified security group.'
    arguments:
    - name: account_id
      description: The AWS account ID.
      required: true
    - name: region
      description: The AWS region.
      required: true
      auto: PREDEFINED
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - af-south-1
      - ap-east-1
      - ap-south-2
      - ap-southeast-3
      - ap-southeast-5
      - ap-southeast-4
      - ap-south-1
      - ap-northeast-3
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-southeast-7
      - ap-northeast-1
      - ca-central-1
      - ca-west-1
      - eu-central-1
      - eu-west-1
      - eu-west-2
      - eu-south-1
      - eu-west-3
      - eu-south-2
      - eu-north-1
      - eu-central-2
      - il-central-1
      - mx-central-1
      - me-south-1
      - me-central-1
      - sa-east-1

    - name: group_id
      description: 'The ID of the security group.'
      required: true
    - name: protocol
      description: 'The IP protocol: tcp, udp, icmp, or icmpv6. Use -1 to specify all protocols. When used with port and cidr arguments for simple rule revocation.'
      required: false
    - name: port
      description: 'For TCP or UDP: The range of ports to revoke (e.g., "80" or "80-443"). For ICMP: A single integer or range (type-code) representing the ICMP type and code. Use with protocol and cidr for simple rule revocation.'
      required: false
    - name: cidr
      description: 'The IPv4 address range in CIDR format (e.g., "0.0.0.0/0"). Use with protocol and port for simple rule revocation.'
      required: false
    - name: ip_permissions
      description: 'The sets of IP permissions to revoke, in JSON format. Use this for complex rule configurations or when revoking multiple rules. Cannot be used together with protocol/port/cidr arguments.'
      required: false

  - name: aws-ec2-snapshot-attribute-modify
    description: 'Adds or removes permission settings for the specified snapshot. Note: snapshots encrypted with the AWS-managed default key (alias/aws/ebs) cannot be shared—use unencrypted snapshots or those encrypted with a customer-managed KMS key to allow permission modifications.'
    arguments:
    - name: account_id
      description: The AWS account ID.
      required: true
    - name: region
      description: The AWS region.
      required: true
      auto: PREDEFINED
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - af-south-1
      - ap-east-1
      - ap-south-2
      - ap-southeast-3
      - ap-southeast-5
      - ap-southeast-4
      - ap-south-1
      - ap-northeast-3
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-southeast-7
      - ap-northeast-1
      - ca-central-1
      - ca-west-1
      - eu-central-1
      - eu-west-1
      - eu-west-2
      - eu-south-1
      - eu-west-3
      - eu-south-2
      - eu-north-1
      - eu-central-2
      - il-central-1
      - mx-central-1
      - me-south-1
      - me-central-1
      - sa-east-1

    - name: snapshot_id
      description: 'The ID of the snapshot.'
      required: true
    - name: attribute
      description: 'The snapshot attribute to modify.'
      required: true
      auto: PREDEFINED
      defaultValue: 'createVolumePermission'
    - name: operation_type
      description: 'The operation to perform.'
      required: true
      auto: PREDEFINED
      predefined:
      - 'add'
      - 'remove'
    - name: user_ids
      isArray: true
      description: 'A comma-separated list of AWS user account IDs to add to or remove from the list of users permitted to create EBS volumes from the snapshot.'
      required: false
    - name: group
      description: 'The groups to add to or remove from the list of entities that have permission to create volumes from the snapshot.'
      required: false
      auto: PREDEFINED
      predefined:
      - 'all'

  - name: aws-ec2-instance-attribute-modify
    description: Modifies the specified attribute of the specified instance. You can specify only one attribute at a time.
    arguments:
    - name: account_id
      description: The AWS account ID.
      required: true
    - name: region
      description: The AWS region.
      required: true
      auto: PREDEFINED
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - af-south-1
      - ap-east-1
      - ap-south-2
      - ap-southeast-3
      - ap-southeast-5
      - ap-southeast-4
      - ap-south-1
      - ap-northeast-3
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-southeast-7
      - ap-northeast-1
      - ca-central-1
      - ca-west-1
      - eu-central-1
      - eu-west-1
      - eu-west-2
      - eu-south-1
      - eu-west-3
      - eu-south-2
      - eu-north-1
      - eu-central-2
      - il-central-1
      - mx-central-1
      - me-south-1
      - me-central-1
      - sa-east-1

    - name: instance_id
      description: 'The ID of the instance.'
      required: true
    - name: disable_api_stop
      description: Whether an instance is enabled for stop protection.
      predefined:
      - 'true'
      - 'false'
    - name: groups
      description: "A comma-separated list of security groups to replace the instance's current security groups. You must specify the ID of at least one security group, even if it’s just the default security group for the VPC."
    - name: attribute
      description: 'The name of the attribute to modify. Possible values: sourceDestCheck, groupSet, ebsOptimized, sriovNetSupport, enaSupport, enclaveOptions, disableApiStop.'
      predefined:
      - 'instanceType'
      - 'kernel'
      - 'ramdisk'
      - 'userData'
      - 'disableApiTermination'
      - 'instanceInitiatedShutdownBehavior'
      - 'rootDeviceName'
      - 'blockDeviceMapping'
      - 'productCodes'
      - 'sourceDestCheck'
      - 'groupSet'
      - 'ebsOptimized'
      - 'striovNetSupport'
      - 'enaSupport'
      - 'enclaveOptions'
      - 'disableApiStop'
    - name: value
      description: A new value for the attribute. Use only with the kernel, ramdisk, userData, disableApiTermination, or instanceInitiatedShutdownBehavior attribute.

  - name: aws-ec2-image-attribute-modify
    description: 'Modifies the specified attribute of the specified AMI.'
    arguments:
    - name: account_id
      description: The AWS account ID.
      required: true
    - name: region
      description: The AWS region.
      required: true
      auto: PREDEFINED
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - af-south-1
      - ap-east-1
      - ap-south-2
      - ap-southeast-3
      - ap-southeast-5
      - ap-southeast-4
      - ap-south-1
      - ap-northeast-3
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-southeast-7
      - ap-northeast-1
      - ca-central-1
      - ca-west-1
      - eu-central-1
      - eu-west-1
      - eu-west-2
      - eu-south-1
      - eu-west-3
      - eu-south-2
      - eu-north-1
      - eu-central-2
      - il-central-1
      - mx-central-1
      - me-south-1
      - me-central-1
      - sa-east-1

    - name: image_id
      description: 'The ID of the AMI.'
      required: true
    - name: attribute
      description: 'The AMI attribute to modify.'
      required: true
      auto: PREDEFINED
      predefined:
      - 'description'
      - 'launchPermission'
    - name: operation_type
      description: 'The operation to perform on the attribute.'
      required: false
      auto: PREDEFINED
      predefined:
      - 'add'
      - 'remove'
    - name: user_ids
      isArray: true
      description: 'The AWS account IDs to add to or remove from the list of users that have launch permissions for the AMI.'
      required: false
    - name: user_groups
      isArray: true
      description: 'The user groups to add to or remove from the list of user groups that have launch permissions for the AMI.'
      required: false
    - name: description
      description: 'A new description for the AMI.'
      required: false

  - name: aws-ec2-instance-metadata-options-modify
    description: Modify the EC2 instance metadata parameters on a running or stopped instance.
    arguments:
    - description: The AWS account ID.
      name: account_id
      required: true
    - description: The AWS region.
      name: region
      required: true
      auto: PREDEFINED
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - af-south-1
      - ap-east-1
      - ap-south-2
      - ap-southeast-3
      - ap-southeast-5
      - ap-southeast-4
      - ap-south-1
      - ap-northeast-3
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-southeast-7
      - ap-northeast-1
      - ca-central-1
      - ca-west-1
      - eu-central-1
      - eu-west-1
      - eu-west-2
      - eu-south-1
      - eu-west-3
      - eu-south-2
      - eu-north-1
      - eu-central-2
      - il-central-1
      - mx-central-1
      - me-south-1
      - me-central-1
      - sa-east-1
    - description: The ID of the instance.
      name: instance_id
      required: true
    - description: Whether IMDSv2 is required.
      auto: PREDEFINED
      name: http_tokens
      predefined:
      - 'optional'
      - 'required'
    - description: Enables or disables the HTTP metadata endpoint on your instances.
      name: http_endpoint
      auto: PREDEFINED
      predefined:
      - 'disabled'
      - 'enabled'


  - name: aws-cloudtrail-trail-update
    description: 'Updates trail settings that control what events you are logging, and how to handle log files. Changes to a trail do not require stopping the CloudTrail service. Use this action to designate an existing bucket for log delivery. If the existing bucket has previously been a target for CloudTrail log files, an IAM policy exists for the bucket. UpdateTrail must be called from the Region in which the trail was created; otherwise, an InvalidHomeRegionException is thrown.'
    arguments:
    - name: account_id
      description: The AWS account ID.
      required: true
    - name: region
      description: The AWS region.
      required: true
      auto: PREDEFINED
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - af-south-1
      - ap-east-1
      - ap-south-2
      - ap-southeast-3
      - ap-southeast-5
      - ap-southeast-4
      - ap-south-1
      - ap-northeast-3
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-southeast-7
      - ap-northeast-1
      - ca-central-1
      - ca-west-1
      - eu-central-1
      - eu-west-1
      - eu-west-2
      - eu-south-1
      - eu-west-3
      - eu-south-2
      - eu-north-1
      - eu-central-2
      - il-central-1
      - mx-central-1
      - me-south-1
      - me-central-1
      - sa-east-1
    - name: name
      description: The name of the trail or trail ARN.
      required: true
    - name: s3_bucket_name
      description: The name of the Amazon S3 bucket designated for publishing log files.
      required: false
    - name: s3_key_prefix
      description: The Amazon S3 key prefix that comes after the name of the bucket you have designated for log file delivery.
      required: false
    - name: sns_topic_name
      description: The name of the Amazon SNS topic defined for notification of log file delivery.
      required: false
    - name: include_global_service_events
      description: Weather the trail is publishing events from global services such as IAM to the log files.
      required: false
      auto: PREDEFINED
      predefined:
      - 'true'
      - 'false'
    - name: is_multi_region_trail
      description: Weather the trail applies only to the current region or to all regions. The default is false. If the trail exists only in the current region and this value is set to true, shadow trails (replications of the trail) will be created in the other regions. If the trail exists in all regions and this value is set to false, the trail will remain in the region where it was created, and its shadow trails in other regions will be deleted.
      required: false
      auto: PREDEFINED
      predefined:
      - 'true'
      - 'false'
    - name: enable_log_file_validation
      description: Weather log file validation is enabled. The default is false.
      required: false
      auto: PREDEFINED
      predefined:
      - 'true'
      - 'false'
    - name: cloud_watch_logs_log_group_arn
      description: Specifies a log group name using an Amazon Resource Name (ARN), a unique identifier that represents the log group to which CloudTrail logs will be delivered. Not required unless you specify CloudWatchLogsRoleArn.
      required: false
    - name: cloud_watch_logs_role_arn
      description: The role for the CloudWatch Logs endpoint to assume to write to a user's log group.
      required: false
    - name: kms_key_id
      description: The KMS key ID to use to encrypt the logs delivered by CloudTrail.
      required: false
    outputs:
    - contextPath: AWS.CloudTrail.Trail.TrailARN
      description: The Amazon Resource Name (ARN) of the trail.
      type: string
    - contextPath: AWS.CloudTrail.Trail.Name
      description: The name of the trail.
      type: string
    - contextPath: AWS.CloudTrail.Trail.S3BucketName
      description: The name of the Amazon S3 bucket into which CloudTrail delivers your trail files.
      type: string
    - contextPath: AWS.CloudTrail.Trail.S3KeyPrefix
      description: The Amazon S3 key prefix that comes after the name of the bucket you have designated for log file delivery.
      type: string
    - contextPath: AWS.CloudTrail.Trail.SnsTopicName
      description: The name of the Amazon SNS topic defined for notification of log file delivery.
      type: string
    - contextPath: AWS.CloudTrail.Trail.SnsTopicARN
      description: The Amazon Resource Name (ARN) of the Amazon SNS topic defined for notification of log file delivery.
      type: string
    - contextPath: AWS.CloudTrail.Trail.IncludeGlobalServiceEvents
      description: Set to True to include AWS API calls from AWS global services such as IAM.
      type: boolean
    - contextPath: AWS.CloudTrail.Trail.IsMultiRegionTrail
      description: Weather the trail exists only in one region or exists in all regions.
      type: boolean
    - contextPath: AWS.CloudTrail.Trail.HomeRegion
      description: The region in which the trail was created.
      type: string
    - contextPath: AWS.CloudTrail.Trail.LogFileValidationEnabled
      description: Weather log file validation is enabled.
      type: boolean
    - contextPath: AWS.CloudTrail.Trail.CloudWatchLogsLogGroupArn
      description: Amazon Resource Name (ARN), a unique identifier that represents the log group to which CloudTrail logs will be delivered.
      type: string
    - contextPath: AWS.CloudTrail.Trail.CloudWatchLogsRoleArn
      description: The role for the CloudWatch Logs endpoint to assume to write to a user's log group.
      type: string
    - contextPath: AWS.CloudTrail.Trail.KMSKeyId
      description: The KMS key ID that encrypts the logs delivered by CloudTrail.
      type: string
    - contextPath: AWS.CloudTrail.Trail.HasCustomEventSelectors
      description: Specifies if the trail has custom event selectors.
      type: boolean
    - contextPath: AWS.CloudTrail.Trail.HasInsightSelectors
      description: Weather a trail has insight selectors enabled.
      type: boolean
    - contextPath: AWS.CloudTrail.Trail.IsOrganizationTrail
      description: Weather the trail is an organization trail.
      type: boolean

  - name: aws-cloudtrail-logging-start
    description: Starts the recording of AWS API calls and log file delivery for a trail. For a trail that is enabled in all regions, this operation must be called from the region in which the trail was created. This operation cannot be called on the shadow trails (replicated trails in other regions) of a trail that is enabled in all regions.
    arguments:
    - name: account_id
      description: The AWS account ID.
      required: true
    - name: region
      description: The AWS region.
      required: true
      auto: PREDEFINED
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - af-south-1
      - ap-east-1
      - ap-south-2
      - ap-southeast-3
      - ap-southeast-5
      - ap-southeast-4
      - ap-south-1
      - ap-northeast-3
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-southeast-7
      - ap-northeast-1
      - ca-central-1
      - ca-west-1
      - eu-central-1
      - eu-west-1
      - eu-west-2
      - eu-south-1
      - eu-west-3
      - eu-south-2
      - eu-north-1
      - eu-central-2
      - il-central-1
      - mx-central-1
      - me-south-1
      - me-central-1
      - sa-east-1
    - name: name
      description: 'The name or the CloudTrail ARN of the trail for which CloudTrail logs Amazon Web Services API calls. e.g. arn:aws:cloudtrail:us-east-2:123456789012:trail/MyTrail.'
      required: true
  - name: aws-ec2-instances-describe
    description: "Describes specified instances or all instances."
    arguments:
    - name: account_id
      description: The AWS account ID.
      required: true
    - name: region
      description: The AWS region to query instances from. Must be a valid AWS region identifier.
      required: true
      auto: PREDEFINED
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - af-south-1
      - ap-east-1
      - ap-south-2
      - ap-southeast-3
      - ap-southeast-5
      - ap-southeast-4
      - ap-south-1
      - ap-northeast-3
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-southeast-7
      - ap-northeast-1
      - ca-central-1
      - ca-west-1
      - eu-central-1
      - eu-west-1
      - eu-west-2
      - eu-south-1
      - eu-west-3
      - eu-south-2
      - eu-north-1
      - eu-central-2
      - il-central-1
      - mx-central-1
      - me-south-1
      - me-central-1
      - sa-east-1
    - name: instance_ids
      description: "A comma-separated list of instance IDs to describe. If empty, returns all accessible instances in the specified region."
      required: false
      isArray: true
    - name: filters
      description: "One or more custom filters to apply separated by ';' (e.g., name=<name>,values=<values>).You can specify up to 50 filters and up to 200 values per filter in a single request."
      required: false
      isArray: true
    - name: next_token
      description: "Token for pagination when retrieving large result sets. Use the InstancesNextToken value from a previous response to continue listing instances."
      required: false
    - name: limit
      description: "Maximum number of instances to return in a single request. You cannot specify this parameter and the instance IDs parameter in the same request."
      required: false
      defaultValue: 50
    outputs:
    - contextPath: AWS.EC2.Instances.InstanceId
      description: The ID of the instance.
      type: string
    - contextPath: AWS.EC2.Instances.ImageId
      description: The ID of the AMI used to launch the instance.
      type: string
    - contextPath: AWS.EC2.Instances.State.Code
      description: The current state of the instance as a 16-bit unsigned integer.
      type: number
    - contextPath: AWS.EC2.Instances.State.Name
      description: The current state of the instance.
      type: string
    - contextPath: AWS.EC2.Instances.PrivateDnsName
      description: The private DNS hostname name assigned to the instance.
      type: string
    - contextPath: AWS.EC2.Instances.PrivateIpAddress
      description: The private IPv4 address assigned to the instance.
      type: string
    - contextPath: AWS.EC2.Instances.PublicDnsName
      description: The public DNS name assigned to the instance.
      type: string
    - contextPath: AWS.EC2.Instances.PublicIpAddress
      description: The public IPv4 address assigned to the instance.
      type: string
    - contextPath: AWS.EC2.Instances.InstanceType
      description: The instance type.
      type: string
    - contextPath: AWS.EC2.Instances.KeyName
      description: The name of the key pair used when the instance was launched.
      type: string
    - contextPath: AWS.EC2.Instances.LaunchTime
      description: The time the instance was launched.
      type: date
    - contextPath: AWS.EC2.Instances.Placement.AvailabilityZone
      description: The availability zone of the instance.
      type: string
    - contextPath: AWS.EC2.Instances.Placement.GroupName
      description: The name of the placement group the instance is in.
      type: string
    - contextPath: AWS.EC2.Instances.Placement.Tenancy
      description: The tenancy of the instance.
      type: string
    - contextPath: AWS.EC2.Instances.Platform
      description: The platform the instance uses. The value is Windows for Windows instances; otherwise, blank.
      type: string
    - contextPath: AWS.EC2.Instances.Monitoring.State
      description: Indicates whether detailed monitoring is enabled.
      type: string
    - contextPath: AWS.EC2.Instances.SubnetId
      description: The ID of the subnet in which the instance is running.
      type: string
    - contextPath: AWS.EC2.Instances.VpcId
      description: The ID of the VPC in which the instance is running.
      type: string
    - contextPath: AWS.EC2.Instances.Architecture
      description: The architecture of the image.
      type: string
    - contextPath: AWS.EC2.Instances.SecurityGroups.GroupName
      description: The name of the security group.
      type: string
    - contextPath: AWS.EC2.Instances.SecurityGroups.GroupId
      description: The ID of the security group.
      type: string
    - contextPath: AWS.EC2.Instances.Tags.Key
      description: The key of the tag.
      type: string
    - contextPath: AWS.EC2.Instances.Tags.Value
      description: The value of the tag.
      type: string
    - contextPath: AWS.EC2.InstancesNextToken
      description: Token to use for pagination in subsequent requests.
      type: string

  - name: aws-ec2-instances-start
    description: "Starts an Amazon EBS-backed instance that was previously stopped."
    execution: true
    arguments:
    - name: account_id
      description: The AWS account ID.
      required: true
    - name: region
      description: The AWS region where target instances are located.
      required: true
      auto: PREDEFINED
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - af-south-1
      - ap-east-1
      - ap-south-2
      - ap-southeast-3
      - ap-southeast-5
      - ap-southeast-4
      - ap-south-1
      - ap-northeast-3
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-southeast-7
      - ap-northeast-1
      - ca-central-1
      - ca-west-1
      - eu-central-1
      - eu-west-1
      - eu-west-2
      - eu-south-1
      - eu-west-3
      - eu-south-2
      - eu-north-1
      - eu-central-2
      - il-central-1
      - mx-central-1
      - me-south-1
      - me-central-1
      - sa-east-1
    - name: instance_ids
      description: "A comma-separated list of instance IDs to start, in i-xxxxxxxxx format. Must be in 'stopped' state and user must have permissions."
      required: true
      isArray: true

  - name: aws-ec2-instances-stop
    description: "Stops an Amazon EBS-backed instance."
    execution: true
    arguments:
    - name: account_id
      description: The AWS account ID.
      required: true
    - name: region
      description: The AWS region where target instances are located. Must be a valid AWS region identifier.
      required: true
      auto: PREDEFINED
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - af-south-1
      - ap-east-1
      - ap-south-2
      - ap-southeast-3
      - ap-southeast-5
      - ap-southeast-4
      - ap-south-1
      - ap-northeast-3
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-southeast-7
      - ap-northeast-1
      - ca-central-1
      - ca-west-1
      - eu-central-1
      - eu-west-1
      - eu-west-2
      - eu-south-1
      - eu-west-3
      - eu-south-2
      - eu-north-1
      - eu-central-2
      - il-central-1
      - mx-central-1
      - me-south-1
      - me-central-1
      - sa-east-1
    - name: instance_ids
      description: "A comma-separated list of instance IDs to stop. Must be in 'running' or 'pending' state. User must have stop permissions for each instance."
      required: true
      isArray: true
    - name: force
      description: "Force stop instances without graceful shutdown. Default: false. Use with caution, as it may cause data loss."
      required: false
      auto: PREDEFINED
      predefined:
      - 'true'
      - 'false'
      defaultValue: 'false'
    - name: hibernate
      description: "Hibernates the instance if the instance was enabled for hibernation at launch. Default: false. If the instance cannot hibernate successfully, a normal shutdown occurs."
      required: false
      auto: PREDEFINED
      predefined:
      - 'true'
      - 'false'
      defaultValue: 'false'
  - name: aws-ec2-instances-terminate
    description: "Shuts down specified instances. This operation is idempotent; you can terminate an instance multiple times without causing an error."
    execution: true
    arguments:
    - name: account_id
      description: The AWS account ID.
      required: true
    - name: region
      description: The AWS region where target instances are located. Must be a valid AWS region identifier.
      required: true
      auto: PREDEFINED
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - af-south-1
      - ap-east-1
      - ap-south-2
      - ap-southeast-3
      - ap-southeast-5
      - ap-southeast-4
      - ap-south-1
      - ap-northeast-3
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-southeast-7
      - ap-northeast-1
      - ca-central-1
      - ca-west-1
      - eu-central-1
      - eu-west-1
      - eu-west-2
      - eu-south-1
      - eu-west-3
      - eu-south-2
      - eu-north-1
      - eu-central-2
      - il-central-1
      - mx-central-1
      - me-south-1
      - me-central-1
      - sa-east-1
    - name: instance_ids
      description: "A comma-separated list of instance IDs to terminate. If you specify multiple instances and the request fails (for example, because of a single incorrect instance ID), none of the instances are terminated."
      required: true
      isArray: true
  - name: aws-ec2-instances-run
    description: Launches a specified number of instances using an AMI you have access to. You can save time by creating a launch template containing your parameters and using the template instead of entering the parameters each time. An instance is ready for you to use when it is in the running state. You can check the state of your instance using aws-ec2-instances-describe.
    execution: true
    arguments:
    - name: account_id
      description: The AWS account ID.
      required: true
    - name: region
      description: The AWS region where instances will be created. Must be a valid AWS region identifier.
      required: true
      auto: PREDEFINED
      predefined:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - af-south-1
      - ap-east-1
      - ap-south-2
      - ap-southeast-3
      - ap-southeast-5
      - ap-southeast-4
      - ap-south-1
      - ap-northeast-3
      - ap-northeast-2
      - ap-southeast-1
      - ap-southeast-2
      - ap-southeast-7
      - ap-northeast-1
      - ca-central-1
      - ca-west-1
      - eu-central-1
      - eu-west-1
      - eu-west-2
      - eu-south-1
      - eu-west-3
      - eu-south-2
      - eu-north-1
      - eu-central-2
      - il-central-1
      - mx-central-1
      - me-south-1
      - me-central-1
      - sa-east-1
    - name: count
      description: "The number of instances to launch. Must be greater than 0."
      required: true
      defaultValue: "1"
    - name: image_id
      description: "The ID of the AMI. An AMI ID is required to launch an instance and must be specified here or in a launch template."
      required: false
    - name: instance_type
      description: "The instance type, for example: t2.large, t3.medium, m5.xlarge."
      required: false
    - name: security_group_ids
      description: "A comma-separated list of security group IDs. Use this for VPC instances. If you don’t specify a security group ID, we use the default security group for the VPC."
      required: false
      isArray: true
    - name: security_groups_names
      description: "A comma-separated list of security group names. For a nondefault VPC, you must use security group IDs instead."
      required: false
      isArray: true
    - name: subnet_id
      description: "The ID of the subnet to launch the instance into. If you don't choose a subnet, we will use a default one from your default VPC. If you don't have a default VPC, you must specify a subnet ID yourself in the request."
      required: false
    - name: user_data
      description: "The user data to make available to the instance. This value will be base64 encoded automatically. Do not base64 encode this value prior to performing the operation."
      required: false
    - name: disable_api_termination
      description: "Indicates whether termination protection is enabled for the instance. The default is false, which means that you can terminate the instance using the Amazon EC2 console, command line tools, or API."
      required: false
      auto: PREDEFINED
      defaultValue: 'false'
      predefined:
      - 'true'
      - 'false'
    - name: iam_instance_profile_arn
      description: "The Amazon Resource Name (ARN) of the instance profile. Both iam_instance_profile_arn and iam_instance_profile_name are required if you would like to associate an instance profile."
      required: false
    - name: iam_instance_profile_name
      description: "The name of the instance profile. Both iam_instance_profile_arn and iam_instance_profile_name are required if you would like to associate an instance profile."
      required: false
    - name: key_name
      description: "The name of the key pair. Warning - If you do not specify a key pair, you can't connect to the instance unless you choose an AMI that is configured to allow users another way to log in."
      required: false
    - name: ebs_optimized
      description: "Indicates whether the instance is optimized for Amazon EBS I/O."
      required: false
      auto: PREDEFINED
      predefined:
      - 'true'
      - 'false'
    - name: device_name
      description: "The device name (for example, /dev/sdh or xvdh). If the argument is given, ebs arguments must also be specified."
      required: false
    - name: ebs_volume_size
      description: "The size of the volume, in GiBs. You must specify either an ebs_snapshot_id or an ebs_volume_size. If you specify a snapshot, the default is the snapshot size. You can specify a volume size that is equal to or larger than the snapshot size."
      required: false
    - name: ebs_volume_type
      description: "The volume type."
      required: false
      auto: PREDEFINED
      predefined:
      - gp2
      - gp3
      - io1
      - io2
      - st1
      - sc1
      - standard
    - name: ebs_iops
      description: "The number of I/O operations per second (IOPS). For gp3, io1, and io2 volumes, this represents the number of IOPS that are provisioned for the volume. For gp2 volumes, this represents the baseline performance of the volume and the rate at which the volume accumulates I/O credits for bursting. This parameter is required for io1 and io2 volumes. The default for gp3 volumes is 3,000 IOPS."
      required: false
    - name: ebs_delete_on_termination
      description: "Indicates whether the EBS volume is deleted on instance termination."
      required: false
      auto: PREDEFINED
      predefined:
      - 'true'
      - 'false'
    - name: ebs_kms_key_id
      description: "Identifier (key ID, key alias, ID ARN, or alias ARN) for a user-managed CMK under which the EBS volume is encrypted."
      required: false
    - name: ebs_snapshot_id
      description: "The ID of the snapshot."
      required: false
    - name: ebs_encrypted
      description: "Indicates whether the encryption state of an EBS volume is changed while being restored from a backing snapshot."
      required: false
      auto: PREDEFINED
      predefined:
      - 'true'
      - 'false'
    - name: launch_template_id
      description: "The ID of the launch template to use to launch the instances. Any parameters that you specify in the command override the same parameters in the launch template. You can specify either the name or ID of a launch template, but not both."
      required: false
    - name: launch_template_name
      description: "The name of the launch template to use to launch the instances. Any parameters that you specify in the command override the same parameters in the launch template. You can specify either the name or ID of a launch template, but not both."
      required: false
    - name: launch_template_version
      description: "The launch template version number, $Latest, or $Default."
      required: false
    - name: tags
      description: "One or more tags to apply to a resource when the resource is being created. separated by ';' (e.g., key=<name>,value=<value>)."
      required: false
    - name: host_id
      description: "The dedicated Host ID."
      required: false
    - name: enabled_monitoring
      description: "Indicates whether detailed monitoring is enabled. Otherwise, basic monitoring is enabled."
      required: false
      auto: PREDEFINED
      predefined:
      - 'true'
      - 'false'
      defaultValue: 'false'
    outputs:
    - contextPath: AWS.EC2.Instances.InstanceId
      description: The ID of the newly created instance.
      type: string
    - contextPath: AWS.EC2.Instances.ImageId
      description: The ID of the AMI used to launch the instance.
      type: string
    - contextPath: AWS.EC2.Instances.State.Code
      description: The current state of the instance as a 16-bit unsigned integer.
      type: number
    - contextPath: AWS.EC2.Instances.State.Name
      description: The current state of the instance.
      type: string
    - contextPath: AWS.EC2.Instances.PrivateDnsName
      description: The private DNS hostname name assigned to the instance.
      type: string
    - contextPath: AWS.EC2.Instances.PrivateIpAddress
      description: The private IPv4 address assigned to the instance.
      type: string
    - contextPath: AWS.EC2.Instances.PublicDnsName
      description: The public DNS name assigned to the instance.
      type: string
    - contextPath: AWS.EC2.Instances.PublicIpAddress
      description: The public IPv4 address assigned to the instance.
      type: string
    - contextPath: AWS.EC2.Instances.InstanceType
      description: The instance type.
      type: string
    - contextPath: AWS.EC2.Instances.KeyName
      description: The name of the key pair used when the instance was launched.
      type: string
    - contextPath: AWS.EC2.Instances.LaunchTime
      description: The time the instance was launched.
      type: date
    - contextPath: AWS.EC2.Instances.Placement.AvailabilityZone
      description: The availability zone of the instance.
      type: string
    - contextPath: AWS.EC2.Instances.Placement.GroupName
      description: The name of the placement group the instance is in.
      type: string
    - contextPath: AWS.EC2.Instances.Placement.Tenancy
      description: The tenancy of the instance.
      type: string
    - contextPath: AWS.EC2.Instances.Platform
      description: The platform the instance uses. The value is Windows for Windows instances; otherwise, blank.
      type: string
    - contextPath: AWS.EC2.Instances.Monitoring.State
      description: Indicates whether detailed monitoring is enabled.
      type: string
    - contextPath: AWS.EC2.Instances.SubnetId
      description: The ID of the subnet in which the instance is running.
      type: string
    - contextPath: AWS.EC2.Instances.VpcId
      description: The ID of the VPC in which the instance is running.
      type: string
    - contextPath: AWS.EC2.Instances.Architecture
      description: The architecture of the image.
      type: string
    - contextPath: AWS.EC2.Instances.BlockDeviceMappings.DeviceName
      description: The device name.
      type: string
    - contextPath: AWS.EC2.Instances.BlockDeviceMappings.Ebs
      description: Parameters used to automatically set up EBS volumes when the instance is launched.
      type: Dictionary
    - contextPath: AWS.EC2.Instances.SecurityGroups.GroupName
      description: The name of the security group.
      type: string
    - contextPath: AWS.EC2.Instances.SecurityGroups.GroupId
      description: The ID of the security group.
      type: string
    - contextPath: AWS.EC2.Instances.IamInstanceProfile.Arn
      description: The Amazon Resource Name (ARN) of the instance profile.
      type: string
    - contextPath: AWS.EC2.Instances.IamInstanceProfile.Id
      description: The ID of the instance profile.
      type: string
    - contextPath: AWS.EC2.Instances.Tags.Key
      description: The key of the tag.
      type: string
    - contextPath: AWS.EC2.Instances.Tags.Value
      description: The value of the tag.
      type: string
    - contextPath: AWS.EC2.Instances.EbsOptimized
      description: Indicates whether the instance is optimized for Amazon EBS I/O.
      type: boolean
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.NetworkInterfaceId
      description: The ID of the network interface.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.SubnetId
      description: The ID of the subnet associated with the network interface. Applies only if creating a network interface when launching an instance.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.VpcId
      description: The ID of the VPC.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.Description
      description: The description of the network interface. Applies only if creating a network interface when launching an instance.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.OwnerId
      description: The ID of the AWS account that owns the network interface.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.Status
      description: The status of the network interface.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.MacAddress
      description: The MAC address.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress
      description: The IPv4 address of the network interface within the subnet.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.PrivateDnsName
      description: The private DNS name.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.SourceDestCheck
      description: Indicates whether to validate network traffic to or from this network interface.
      type: boolean
    - contextPath: AWS.EC2.ReservationId
      description: The ID of the reservation.
      type: string
    - contextPath: AWS.EC2.OwnerId
      description: The ID of the AWS account that owns the reservation.
      type: string
    - contextPath: AWS.EC2.ResponseMetadata.RequestId
      description: The request ID for the run instances operation.
      type: string
    - contextPath: AWS.EC2.ResponseMetadata.HTTPStatusCode
      description: The HTTP status code of the response.
      type: number
  isfetch: false
  runonce: false
  script: '-'
  type: python
  subtype: python3
  dockerimage: demisto/boto3py3:1.0.0.3575453
fromversion: 5.5.0
tests:
- No test - No playbook part of this release.
sectionOrder:
- Connect
- Collect
isCloudProviderIntegration: true
