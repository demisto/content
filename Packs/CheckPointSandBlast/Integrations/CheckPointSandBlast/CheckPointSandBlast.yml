category: Forensics & Malware Analysis
commonfields:
  id: CheckPointSandBlast
  version: -1
configuration:
- display: Server URL
  name: url
  required: true
  type: 0
  additionalinfo: https://te.checkpoint.com
- displaypassword: Authorization - API Key
  name: credentials
  required: false
  type: 9
  hiddenusername: true
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: Upload files using polling, the service supports Microsoft Office files, as well as PDF, SWF, archives and executables. Active content will be cleaned from any documents that you upload (Microsoft Office and PDF files only). Query on existing IOCs, file status, analysis, reports. Download files from the database. Supports both appliance and cloud. Supported Threat Emulation versions are any R80x.
display: Check Point Threat Emulation (SandBlast)
name: CheckPointSandBlast
script:
  commands:
  - arguments:
    - description: Name of the file to query. Recommended to use, without it status will be "PARTIALLY_FOUND"
      isArray: false
      name: file_name
      required: false
    - description: "File hash to query, accepted digests are: md5, sha1 and sha256. Only md5 returns 'FOUND' status."
      isArray: false
      name: file_hash
      required: true
    - auto: PREDEFINED
      defaultValue: All
      description: 'Features to use on the file'
      isArray: true
      name: features
      predefined:
      - Threat Emulation
      - Anti-Virus
      - Threat Extraction
      - All
      required: false
    - auto: PREDEFINED
      defaultValue: xml, summary
      description: Comma separated list of supported report formats. Note - Requesting for PDF and summary reports simultaneously is not supported.
      isArray: true
      name: reports
      predefined:
      - pdf
      - xml
      - tar
      - summary
      required: false
    - auto: PREDEFINED
      defaultValue: pdf
      description: Threat extraction request method.
      isArray: false
      name: method
      predefined:
      - clean
      - pdf
      required: false
    - auto: PREDEFINED
      defaultValue: Linked Objects, Macros and Code, Sensitive Hyperlinks, PDF GoToR Actions, PDF Launch Actions, PDF URI Actions, PDF Sound Actions, PDF Movie Actions, PDF JavaScript Actions, PDF Submit Form Actions, Database Queries, Embedded Objects, Fast Save Data
      description: Comma separated list of fields to be cleaned in the file. Only relevant if method = clean.
      isArray: true
      name: extracted_parts
      predefined:
      - Linked Objects
      - Macros and Code
      - Sensitive Hyperlinks
      - PDF GoToR Actions
      - PDF Launch Actions
      - PDF URI Actions
      - PDF Sound Actions
      - PDF Movie Actions
      - PDF JavaScript Actions
      - PDF Submit Form Actions
      - Database Queries
      - Embedded Objects
      - Fast Save Data
      - Custom Properties
      - Statistic Properties
      - Summary Properties
      required: false
    deprecated: false
    description: Use the Query API to have a client application look for either the analysis report of a specific file on the Check Point Threat Prevention service databases or the status of a file, uploaded for analysis. It is recommended to add file_name.
    execution: false
    name: sandblast-query
    outputs:
    - contextPath: SandBlast.Query.Status
      description: Status of requested features.
      type: String
    - contextPath: SandBlast.Query.MD5
      description: The file's MD5.
      type: String
    - contextPath: SandBlast.Query.SHA1
      description: The file's SHA1.
      type: String
    - contextPath: SandBlast.Query.SHA256
      description: The file's SHA256.
      type: String
    - contextPath: SandBlast.Query.FileType
      description: File type can be different from the one sent in the query request (according to the type to identify).
      type: String
    - contextPath: SandBlast.Query.FileName
      description: Name of the file saved on Check Point databases.
      type: String
    - contextPath: SandBlast.Query.Features
      description: Features used.
      type: String
    - contextPath: SandBlast.Query.AntiVirus.SignatureName
      description: If the file is not detected by Anti-Virus, the signature name is empty.
      type: String
    - contextPath: SandBlast.Query.AntiVirus.MalwareFamily
      description: 'ID for malware family, if available: {0-}.'
      type: Number
    - contextPath: SandBlast.Query.AntiVirus.MalwareType
      description: 'ID for malware type, if available: {0-}.'
      type: Number
    - contextPath: SandBlast.Query.AntiVirus.Severity
      description: '0 for benign files. Minimum: 0 Maximum: 4'
      type: Number
    - contextPath: SandBlast.Query.AntiVirus.Confidence
      description: '0 for benign files. Minimum: 0 Maximum 5'
      type: Number
    - contextPath: SandBlast.Query.AntiVirus.Status
      description: Status of Anti-Virus on the requested file.
      type: String
    - contextPath: SandBlast.Query.ThreatExtraction.Method
      description: Method that was used.
      type: String
    - contextPath: SandBlast.Query.ThreatExtraction.ExtractResult
      description: CP_EXTRACT_RESULT_UNKNOWN (Default - returned if the POD did not receive an answer from the Threat Extraction engine in 60 seconds). CP_EXTRACT_RESULT_SUCCESS, CP_EXTRACT_RESULT_FAILURE, CP_EXTRACT_RESULT_TIMEOUT, CP_EXTRACT_RESULT_UNSUPPORTED_FILE, CP_EXTRACT_RESULT_NOT_SCRUBBED, CP_EXTRACT_RESULT_INTERNAL_ERROR, CP_EXTRACT_RESULT_DISK_LIMIT_REACHED, CP_EXTRACT_RESULT_ENCRYPTED_FILE, CP_EXTRACT_RESULT_DOCSEC_FILE, CP_EXTRACT_RESULT_OUT_OF_MEMORY
      type: String
    - contextPath: SandBlast.Query.ThreatExtraction.ExtractedFileDownloadId
      description: The download id of the extracted file, for download request. Only sent when extract_result = CP_EXTRACT_RESULT_SUCCESS
      type: String
    - contextPath: SandBlast.Query.ThreatExtraction.OutputFileName
      description: Clean file name.
      type: String
    - contextPath: SandBlast.Query.ThreatExtraction.Time
      description: Time for threat extraction completion.
      type: String
    - contextPath: SandBlast.Query.ThreatExtraction.ExtractContent
      description: Content of extracted file.
      type: String
    - contextPath: SandBlast.Query.ThreatExtraction.TexProduct
      description: True if the queried file is already a Sandblast-safe copy.
      type: Boolean
    - contextPath: SandBlast.Query.ThreatExtraction.Status
      description: Status of Threat Extraction on the requested file.
      type: String
    - contextPath: SandBlast.Upload.ThreatExtraction.ExtractionData.InputExtension
      description: Uploaded filename-extension as sent by the client.
      type: String
    - contextPath: SandBlast.Query.ThreatExtraction.ExtractionData.InputRealExtension
      description: Extension as resolved by Threat Extraction.
      type: String
    - contextPath: SandBlast.Query.ThreatExtraction.ExtractionData.Message
      description: Status message for scrub_result
      type: String
    - contextPath: SandBlast.Query.ThreatExtraction.ExtractionData.ProtectionName
      description: Potential malicious content extracted.
      type: String
    - contextPath: SandBlast.Query.ThreatExtraction.ExtractionData.ProtectionType
      description: 'Protection done for scrub_method: Conversion to PDF | Content Removal'
      type: String
    - contextPath: SandBlast.Query.ThreatExtraction.ExtractionData.ProtocolVersion
      description: Protocol used.
      type: String
    - contextPath: SandBlast.Query.ThreatExtraction.ExtractionData.RealExtension
      description: Real extension as resolved by Threat Extraction
      type: String
    - contextPath: SandBlast.Query.ThreatExtraction.ExtractionData.Risk
      description: Represents the risk of the part that was extracted from the document.
      type: Number
    - contextPath: SandBlast.Query.ThreatExtraction.ExtractionData.ScrubActivity
      description: Readable result from Threat Extraction.
      type: String
    - contextPath: SandBlast.Query.ThreatExtraction.ExtractionData.ScrubMethod
      description: Convert to PDF | Clean Document.
      type: String
    - contextPath: SandBlast.Query.ThreatExtraction.ExtractionData.ScrubResult
      description: Code result from Threat Extraction.
      type: Number
    - contextPath: SandBlast.Query.ThreatExtraction.ExtractionData.ScrubTime
      description: Threat Extraction process time.
      type: String
    - contextPath: SandBlast.Query.ThreatExtraction.ExtractionData.ScrubbedContent
      description: Content that was removed
      type: String
    - contextPath: SandBlast.Query.ThreatEmulation.Trust
      description: Rating of the threat data and its relevance to this instance. It is recommended to block threats with confidence medium and above.
      type: Number
    - contextPath: SandBlast.Query.ThreatEmulation.Score
      description: Threat Emulation score.
      type: Number
    - contextPath: SandBlast.Query.ThreatEmulation.CombinedVerdict
      description: Combined verdict of all the images. Benign reports are not supported for local gateways.
      type: String
    - contextPath: SandBlast.Query.ThreatEmulation.Severity
      description: Combined severity of threats found. In case threats are not found, this field is not given.
      type: Number
    - contextPath: SandBlast.Query.ThreatEmulation.Images
      description: Sand boxes used in Threat Emulation. Information about image types can be found in https://sc1.checkpoint.com/documents/TPAPI/CP_1.0_ThreatPreventionAPI_APIRefGuide/html_frameset.htm under "Query API" -> "Query Response Format" -> "Images Object Format".
      type: String
    - contextPath: SandBlast.Query.ThreatEmulation.Status
      description: Status of Threat Emulation on the requested file.
      type: String
  - arguments:
    - description: Interval in seconds between each poll.
      isArray: false
      name: interval_in_seconds
      required: false
      defaultValue: '60'
    - description: Time out in seconds till polling ends.
      isArray: false
      name: timeout_in_seconds
      required: false
      defaultValue: '600'
    - description: ID of the file to upload, which will be taken from the uploaded file to XSOAR.
      isArray: false
      name: file_id
      required: true
    - description: Rename the file to upload, if empty the uploaded file will keep its original name.
      isArray: false
      name: file_name
      required: false
    - auto: PREDEFINED
      defaultValue: All
      description: Features to use on the file.
      isArray: true
      name: features
      predefined:
      - Threat Emulation
      - Anti-Virus
      - Threat Extraction
      - All
      required: false
    - auto: PREDEFINED
      description: ID of available OS images. An image is an operating system configuration. Inputs must be of same length as image_revisions and will be paired according to position. Information about image types can be found in https://sc1.checkpoint.com/documents/TPAPI/CP_1.0_ThreatPreventionAPI_APIRefGuide/html_frameset.htm under "Query API" -> "Query Response Format" -> "Images Object Format".
      isArray: true
      name: image_ids
      predefined:
      - e50e99f3-5963-4573-af9e-e3f4750b55e2
      - 7e6fe36e-889e-4c25-8704-56378f0830df
      - 8d188031-1010-4466-828b-0cd13d4303ff
      - 5e5de275-a103-4f67-b55b-47532918fa59
      - 3ff3ddae-e7fd-4969-818c-d5f1a2be336d
      - 6c453c9b-20f7-471a-956c-3198a868dc92
      - 10b4a9c6-e414-425c-ae8b-fe4dd7b25244
      required: false
    - description: Revisions of available OS images. An image is an operating system configuration. Inputs must be of same length as image_ids and will be paired according to position.
      isArray: true
      name: image_revisions
      required: false
    - auto: PREDEFINED
      defaultValue: xml, summary
      description: Comma separated list of supported report formats. Note - Requesting for PDF and summary reports simultaneously is not supported.
      isArray: true
      name: reports
      predefined:
      - pdf
      - xml
      - tar
      - summary
      required: false
    - auto: PREDEFINED
      defaultValue: pdf
      description: Threat extraction request method.
      isArray: false
      name: method
      predefined:
      - clean
      - pdf
      required: false
    - auto: PREDEFINED
      defaultValue: Linked Objects, Macros and Code, Sensitive Hyperlinks, PDF GoToR Actions, PDF Launch Actions, PDF URI Actions, PDF Sound Actions, PDF Movie Actions, PDF JavaScript Actions, PDF Submit Form Actions, Database Queries, Embedded Objects, Fast Save Data
      description: Comma separated list of fields to be cleaned in the file. Only relevant if method = clean.
      isArray: true
      name: extracted_parts
      predefined:
      - Linked Objects
      - Macros and Code
      - Sensitive Hyperlinks
      - PDF GoToR Actions
      - PDF Launch Actions
      - PDF URI Actions
      - PDF Sound Actions
      - PDF Movie Actions
      - PDF JavaScript Actions
      - PDF Submit Form Actions
      - Database Queries
      - Embedded Objects
      - Fast Save Data
      - Custom Properties
      - Statistic Properties
      - Summary Properties
      required: false
    deprecated: false
    description: Use the Upload API to have a client application request that Check Point Threat Prevention modules scan and analyze a file. When you upload a file to the service, the file is encrypted. It is un-encrypted during analysis, and then deleted. This command uses polling with query. The stages of polling are 'UPLOAD_SUCCESS', 'PENDING' and ends with 'FOUND' or 'PARTIALLY_FOUND'. Once the command is done polling it will return analyzed information about the file.
    execution: false
    name: sandblast-upload
    polling: true
    outputs:
    - contextPath: SandBlast.Upload.Status
      description: Status of requested features.
      type: String
    - contextPath: SandBlast.Upload.MD5
      description: The file's MD5.
      type: String
    - contextPath: SandBlast.Upload.SHA1
      description: The file's SHA1.
      type: String
    - contextPath: SandBlast.Upload.SHA256
      description: The file's SHA256.
      type: String
    - contextPath: SandBlast.Upload.FileType
      description: File type can be different from the one sent in the upload request (according to the type to identify).
      type: String
    - contextPath: SandBlast.Upload.FileName
      description: Name of the file saved on Check Point databases.
      type: String
    - contextPath: SandBlast.Upload.Features
      description: Features used.
      type: String
    - contextPath: SandBlast.Upload.AntiVirus.SignatureName
      description: If the file is not detected by Anti-Virus, the signature name is empty.
      type: String
    - contextPath: SandBlast.Upload.AntiVirus.MalwareFamily
      description: 'ID for malware family, if available: {0-}.'
      type: Number
    - contextPath: SandBlast.Upload.AntiVirus.MalwareType
      description: 'ID for malware type, if available: {0-}.'
      type: Number
    - contextPath: SandBlast.Upload.AntiVirus.Severity
      description: '0 for benign files. Minimum: 0 Maximum: 4'
      type: Number
    - contextPath: SandBlast.Upload.AntiVirus.Confidence
      description: '0 for benign files. Minimum: 0 Maximum 5'
      type: Number
    - contextPath: SandBlast.Upload.AntiVirus.Status
      description: Status of Anti-Virus on the requested file.
      type: String
    - contextPath: SandBlast.Upload.ThreatExtraction.Method
      description: Method that was used.
      type: String
    - contextPath: SandBlast.Upload.ThreatExtraction.ExtractResult
      description: CP_EXTRACT_RESULT_UNKNOWN (Default - returned if the POD did not receive an answer from the Threat Extraction engine in 60 seconds). CP_EXTRACT_RESULT_SUCCESS, CP_EXTRACT_RESULT_FAILURE, CP_EXTRACT_RESULT_TIMEOUT, CP_EXTRACT_RESULT_UNSUPPORTED_FILE, CP_EXTRACT_RESULT_NOT_SCRUBBED, CP_EXTRACT_RESULT_INTERNAL_ERROR, CP_EXTRACT_RESULT_DISK_LIMIT_REACHED, CP_EXTRACT_RESULT_ENCRYPTED_FILE, CP_EXTRACT_RESULT_DOCSEC_FILE, CP_EXTRACT_RESULT_OUT_OF_MEMORY
      type: String
    - contextPath: SandBlast.Upload.ThreatExtraction.ExtractedFileDownloadId
      description: The download id of the extracted file, for download request. Only sent when extract_result = CP_EXTRACT_RESULT_SUCCESS
      type: String
    - contextPath: SandBlast.Upload.ThreatExtraction.OutputFileName
      description: Clean file name.
      type: String
    - contextPath: SandBlast.Upload.ThreatExtraction.Time
      description: Time for threat extraction completion.
      type: String
    - contextPath: SandBlast.Upload.ThreatExtraction.ExtractContent
      description: Content of extracted file.
      type: String
    - contextPath: SandBlast.Upload.ThreatExtraction.TexProduct
      description: True if the queried file is already a Sandblast-safe copy.
      type: Boolean
    - contextPath: SandBlast.Upload.ThreatExtraction.Status
      description: Status of Threat Extraction on the requested file.
      type: String
    - contextPath: SandBlast.Upload.ThreatExtraction.ExtractionData.InputExtension
      description: Uploaded filename-extension as sent by the client.
      type: String
    - contextPath: SandBlast.Upload.ThreatExtraction.ExtractionData.InputRealExtension
      description: Extension as resolved by Threat Extraction.
      type: String
    - contextPath: SandBlast.Upload.ThreatExtraction.ExtractionData.Message
      description: Status message for scrub_result
      type: String
    - contextPath: SandBlast.Upload.ThreatExtraction.ExtractionData.ProtectionName
      description: Potential malicious content extracted.
      type: String
    - contextPath: SandBlast.Upload.ThreatExtraction.ExtractionData.ProtectionType
      description: 'Protection done for scrub_method: Conversion to PDF | Content Removal'
      type: String
    - contextPath: SandBlast.Upload.ThreatExtraction.ExtractionData.ProtocolVersion
      description: Protocol used.
      type: String
    - contextPath: SandBlast.Upload.ThreatExtraction.ExtractionData.RealExtension
      description: Real extension as resolved by Threat Extraction
      type: String
    - contextPath: SandBlast.Upload.ThreatExtraction.ExtractionData.Risk
      description: Represents the risk of the part that was extracted from the document.
      type: Number
    - contextPath: SandBlast.Upload.ThreatExtraction.ExtractionData.ScrubActivity
      description: Readable result from Threat Extraction.
      type: String
    - contextPath: SandBlast.Upload.ThreatExtraction.ExtractionData.ScrubMethod
      description: Convert to PDF | Clean Document.
      type: String
    - contextPath: SandBlast.Upload.ThreatExtraction.ExtractionData.ScrubResult
      description: Code result from Threat Extraction.
      type: Number
    - contextPath: SandBlast.Upload.ThreatExtraction.ExtractionData.ScrubTime
      description: Threat Extraction process time.
      type: String
    - contextPath: SandBlast.Upload.ThreatExtraction.ExtractionData.ScrubbedContent
      description: Content that was removed
      type: String
    - contextPath: SandBlast.Upload.ThreatEmulation.Trust
      description: Rating of the threat data and its relevance to this instance. It is recommended to block threats with confidence medium and above.
      type: Number
    - contextPath: SandBlast.Upload.ThreatEmulation.Score
      description: Threat Emulation score.
      type: Number
    - contextPath: SandBlast.Upload.ThreatEmulation.CombinedVerdict
      description: Combined verdict of all the images. Benign reports are not supported for local gateways.
      type: String
    - contextPath: SandBlast.Upload.ThreatEmulation.Severity
      description: Combined severity of threats found. In case threats are not found, this field is not given.
      type: Number
    - contextPath: SandBlast.Upload.ThreatEmulation.Images
      description: Sand boxes used in Threat Emulation. Information about image types can be found in https://sc1.checkpoint.com/documents/TPAPI/CP_1.0_ThreatPreventionAPI_APIRefGuide/html_frameset.htm under "Query API" -> "Query Response Format" -> "Images Object Format".
      type: String
    - contextPath: SandBlast.Upload.ThreatEmulation.Status
      description: Status of Threat Emulation on the requested file.
      type: String
  - arguments:
    - description: ID of the file to download, which will be taken from "Extractedfiledownloadid" from "Threat Extraction" results.
      isArray: false
      name: file_id
      required: true
    deprecated: false
    description: Use the Download API to download a scanned file from the ThreatCloud according to the file ID.
    execution: false
    name: sandblast-download
    outputs:
    - contextPath: InfoFile.Name
      description: The name of the file.
      type: string
    - contextPath: InfoFile.EntryID
      description: The EntryID of the report
      type: string
    - contextPath: InfoFile.Size
      description: File Size
      type: number
    - contextPath: InfoFile.Type
      description: The file type.
      type: string
    - contextPath: InfoFile.Info
      description: Basic information of the file
      type: string
  - deprecated: false
    description: Use the Quote API to have a client application get the current license and quota status of the API Key that you use in the authorization of the other APIs. For cloud services only.
    execution: false
    name: sandblast-quota
    outputs:
    - contextPath: SandBlast.Quota.RemainQuotaHour
      description: Remaining quota hours.
      type: Number
    - contextPath: SandBlast.Quota.RemainQuotaMonth
      description: Remaining  quota months.
      type: Number
    - contextPath: SandBlast.Quota.AssignedQuotaHour
      description: Assigned  quota hours.
      type: Number
    - contextPath: SandBlast.Quota.AssignedQuotaMonth
      description: Assigned  quota months.
      type: Number
    - contextPath: SandBlast.Quota.HourlyQuotaNextReset
      description: Hourly quota next reset.
      type: String
    - contextPath: SandBlast.Quota.MonthlyQuotaNextReset
      description: Monthly quota next reset.
      type: String
    - contextPath: SandBlast.Quota.QuotaId
      description: Quota ID.
      type: String
    - contextPath: SandBlast.Quota.CloudMonthlyQuotaPeriodStart
      description: Cloud monthly quota period start.
      type: String
    - contextPath: SandBlast.Quota.CloudMonthlyQuotaUsageForThisGw
      description: Cloud monthly quota usage for this GW.
      type: Number
    - contextPath: SandBlast.Quota.CloudHourlyQuotaUsageForThisGw
      description: Cloud hourly quota usage for this GW.
      type: Number
    - contextPath: SandBlast.Quota.CloudMonthlyQuotaUsageForQuotaId
      description: Cloud monthly quota usage for QuotaID.
      type: Number
    - contextPath: SandBlast.Quota.CloudHourlyQuotaUsageForQuotaId
      description: Cloud hourly quota usage for QuotaID.
      type: Number
    - contextPath: SandBlast.Quota.MonthlyExceededQuota
      description: Monthly exceeded quota.
      type: Number
    - contextPath: SandBlast.Quota.HourlyExceededQuota
      description: Hourly exceeded quota.
      type: Number
    - contextPath: SandBlast.Quota.CloudQuotaMaxAllowToExceedPercentage
      description: Cloud quota max allowed to exceed percentage.
      type: Number
    - contextPath: SandBlast.Quota.PodTimeGmt
      description: Pod time GMT.
      type: String
    - contextPath: SandBlast.Quota.QuotaExpiration
      description: Quota expiration.
      type: String
    - contextPath: SandBlast.Quota.Action
      description: Quota action.
      type: String
  dockerimage: demisto/python3:3.10.5.31928
  feed: false
  isfetch: false
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  subtype: python3
  type: python
tests:
- No tests (auto formatted)
fromversion: 6.2.0
