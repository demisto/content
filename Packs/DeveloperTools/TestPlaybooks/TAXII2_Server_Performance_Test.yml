id: TAXII2 Server Performance Test
version: -1
vcShouldKeepItemLegacyProdMachine: false
name: TAXII2 Server Performance Test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: cd603bed-c6f9-4f27-8b43-83026bb7f831
    type: start
    task:
      id: cd603bed-c6f9-4f27-8b43-83026bb7f831
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 2f5059c6-115d-40db-8df1-ab2039258f2e
    type: regular
    task:
      id: 2f5059c6-115d-40db-8df1-ab2039258f2e
      version: -1
      name: Clear Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: 1f0b540e-cef5-4c30-8faa-c74a85418241
    type: title
    task:
      id: 1f0b540e-cef5-4c30-8faa-c74a85418241
      version: -1
      name: 10,000 Indicators
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "61"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 427f4a6f-a7d5-44b6-8a67-7e32c4c3be3e
    type: playbook
    task:
      id: 427f4a6f-a7d5-44b6-8a67-7e32c4c3be3e
      version: -1
      name: TAXII2 Performance Test - Concurrency
      playbookName: TAXII2 Performance Test - Concurrency
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      "n":
        simple: ${inputs.n}
      url:
        complex:
          root: ServerURL
          transformers:
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: threatintel/collections/
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: TAXIIServer.Collection.id
                iscontext: true
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: /objects/?limit=10000
      z:
        simple: ${inputs.z}
    separatecontext: false
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 9136f288-916e-4b86-8fa5-ed592a5f87f1
    type: playbook
    task:
      id: 9136f288-916e-4b86-8fa5-ed592a5f87f1
      version: -1
      name: TAXII2 Performance Test - Concurrency
      playbookName: TAXII2 Performance Test - Concurrency
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      url:
        complex:
          root: ServerURL
          transformers:
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: threatintel/collections/
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: TAXIIServer.Collection.id
                iscontext: true
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: /objects/?limit=50000
    separatecontext: false
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6935
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 0ebc5090-e80b-489e-8495-7b653356b281
    type: title
    task:
      id: 0ebc5090-e80b-489e-8495-7b653356b281
      version: -1
      name: 50,000 Indicators
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "38"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5215
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 4cb3dee5-788a-42dd-8299-1128ab1a079d
    type: title
    task:
      id: 4cb3dee5-788a-42dd-8299-1128ab1a079d
      version: -1
      name: 100,000 Indicators
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "48"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7460
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: 0bbe286d-228e-47b9-8fd4-5047604e4b0e
    type: playbook
    task:
      id: 0bbe286d-228e-47b9-8fd4-5047604e4b0e
      version: -1
      name: TAXII2 Performance Test - Concurrency
      playbookName: TAXII2 Performance Test - Concurrency
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      url:
        complex:
          root: ServerURL
          transformers:
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: threatintel/collections/
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: TAXIIServer.Collection.id
                iscontext: true
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: /objects/?limit=100000
    separatecontext: false
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: e343a521-be81-4c7a-8012-cb1c3b8b496d
    type: regular
    task:
      id: e343a521-be81-4c7a-8012-cb1c3b8b496d
      version: -1
      name: Set Small Outputs
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      key:
        simple: EDLHey.Small
      value:
        complex:
          root: HeyConcurrency
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4865
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: ba6d1029-39fb-49b5-89f0-c654866d4e3b
    type: regular
    task:
      id: ba6d1029-39fb-49b5-89f0-c654866d4e3b
      version: -1
      name: Clear HeyConcurrency Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: HeyConcurrency
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: 3615c5ac-22e6-4fb5-829e-89a408e3cc9c
    type: regular
    task:
      id: 3615c5ac-22e6-4fb5-829e-89a408e3cc9c
      version: -1
      name: Set Medium Outputs
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      key:
        simple: EDLHey.Medium
      value:
        simple: ${HeyConcurrency}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7110
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 1f4e4943-44e4-4d44-860b-7b12f8de05c9
    type: regular
    task:
      id: 1f4e4943-44e4-4d44-860b-7b12f8de05c9
      version: -1
      name: Clear HeyConcurrency Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: HeyConcurrency
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7285
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: 1123495a-200f-4f67-8fc7-885b502e6aa5
    type: regular
    task:
      id: 1123495a-200f-4f67-8fc7-885b502e6aa5
      version: -1
      name: Set Large Outputs
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "60"
    scriptarguments:
      key:
        simple: EDLHey.Large
      value:
        simple: ${HeyConcurrency}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9355
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 3fae1920-4bfc-49e2-870a-68b4162d6de8
    type: regular
    task:
      id: 3fae1920-4bfc-49e2-870a-68b4162d6de8
      version: -1
      name: Check IP Is Ready
      description: Returns, whether there're, are enough indicators in the system.
      scriptName: VerifyEnoughIndicators
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      query:
        simple: type:IP
      size:
        simple: ${inputs.iocs_in_xsoar}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 4ce02c35-7a88-4dce-8861-eb753b530390
    type: condition
    task:
      id: 4ce02c35-7a88-4dce-8861-eb753b530390
      version: -1
      name: Verify IP Is Ready
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "17"
      "yes":
      - "16"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isTrue
          left:
            value:
              simple: IndicatorsCheck.ConditionMet
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: ccca8790-864e-45d7-89af-28116b9d5669
    type: regular
    task:
      id: ccca8790-864e-45d7-89af-28116b9d5669
      version: -1
      name: Clear Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 885
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: a7838c25-73b5-46d7-83fc-d8c65be0c97a
    type: playbook
    task:
      id: a7838c25-73b5-46d7-83fc-d8c65be0c97a
      version: -1
      name: GenericPolling
      description: |-
        Use this playbook as a sub-playbook to block execution of the master playbook until a remote action is complete.
        This playbook implements polling by continuously running the command in Step \#2 until the operation completes.
        The remote action should have the following structure:

        1. Initiate the operation.
        2. Poll to check if the operation completed.
        3. (optional) Get the results of the operation.
      playbookName: GenericPolling
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      AdditionalPollingCommandArgNames:
        simple: size
      AdditionalPollingCommandArgValues:
        simple: ${inputs.iocs_in_xsoar}
      Ids:
        simple: type:IP
      Interval:
        simple: "1"
      PollingCommandArgName:
        simple: query
      PollingCommandName:
        simple: VerifyEnoughIndicators
      Timeout:
        simple: "10"
      dt:
        simple: IndicatorsCheck(val.ConditionMet !== true).Query
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: c2efbff9-21e8-4387-8110-2c2723329f10
    type: regular
    task:
      id: c2efbff9-21e8-4387-8110-2c2723329f10
      version: -1
      name: Check Domain Is Ready
      description: Returns, whether there're, are enough indicators in the system.
      scriptName: VerifyEnoughIndicators
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      query:
        simple: type:Domain
      size:
        simple: ${inputs.iocs_in_xsoar}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: 98947149-2db3-4d22-8e63-df4e6b0cc662
    type: condition
    task:
      id: 98947149-2db3-4d22-8e63-df4e6b0cc662
      version: -1
      name: Verify Domain Is Ready
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "21"
      "yes":
      - "20"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isTrue
          left:
            value:
              simple: IndicatorsCheck.ConditionMet
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 837122db-ac7f-45e7-863c-04ae627675de
    type: regular
    task:
      id: 837122db-ac7f-45e7-863c-04ae627675de
      version: -1
      name: Clear Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: 81e4b5ed-6cdf-4715-89af-cc3facda9c17
    type: playbook
    task:
      id: 81e4b5ed-6cdf-4715-89af-cc3facda9c17
      version: -1
      name: GenericPolling
      description: |-
        Use this playbook as a sub-playbook to block execution of the master playbook until a remote action is complete.
        This playbook implements polling by continuously running the command in Step \#2 until the operation completes.
        The remote action should have the following structure:

        1. Initiate the operation.
        2. Poll to check if the operation completed.
        3. (optional) Get the results of the operation.
      playbookName: GenericPolling
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      AdditionalPollingCommandArgNames:
        simple: size
      AdditionalPollingCommandArgValues:
        simple: ${inputs.iocs_in_xsoar}
      Ids:
        simple: type:Domain
      Interval:
        simple: "1"
      PollingCommandArgName:
        simple: query
      PollingCommandName:
        simple: VerifyEnoughIndicators
      Timeout:
        simple: "10"
      dt:
        simple: IndicatorsCheck(val.ConditionMet !== true).Query
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: d2180ff0-aa03-45a1-85a6-0fa982e24794
    type: regular
    task:
      id: d2180ff0-aa03-45a1-85a6-0fa982e24794
      version: -1
      name: Check URL Is Ready
      description: Returns, whether there're, are enough indicators in the system.
      scriptName: VerifyEnoughIndicators
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "24"
    scriptarguments:
      query:
        simple: type:URL
      size:
        simple: ${inputs.iocs_in_xsoar}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: b81cafbb-5b5c-4ad8-8d40-7748f2886daf
    type: regular
    task:
      id: b81cafbb-5b5c-4ad8-8d40-7748f2886daf
      version: -1
      name: Clear Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "28"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: 350b4390-92d7-496c-823a-67d5985ba800
    type: condition
    task:
      id: 350b4390-92d7-496c-823a-67d5985ba800
      version: -1
      name: Verify URL Is Ready
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "25"
      "yes":
      - "23"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isTrue
          left:
            value:
              simple: IndicatorsCheck.ConditionMet
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "25":
    id: "25"
    taskid: 282f5177-8cf2-4ed6-8a34-c17e009f4850
    type: playbook
    task:
      id: 282f5177-8cf2-4ed6-8a34-c17e009f4850
      version: -1
      name: GenericPolling
      description: |-
        Use this playbook as a sub-playbook to block execution of the master playbook until a remote action is complete.
        This playbook implements polling by continuously running the command in Step \#2 until the operation completes.
        The remote action should have the following structure:

        1. Initiate the operation.
        2. Poll to check if the operation completed.
        3. (optional) Get the results of the operation.
      playbookName: GenericPolling
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      AdditionalPollingCommandArgNames:
        simple: size
      AdditionalPollingCommandArgValues:
        simple: ${inputs.iocs_in_xsoar}
      Ids:
        simple: type:URL
      Interval:
        simple: "1"
      PollingCommandArgName:
        simple: query
      PollingCommandName:
        simple: VerifyEnoughIndicators
      Timeout:
        simple: "10"
      dt:
        simple: IndicatorsCheck(val.ConditionMet !== true).Query
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: cdd30184-abc9-47b2-8a5a-07ed7d7aaa1e
    type: regular
    task:
      id: cdd30184-abc9-47b2-8a5a-07ed7d7aaa1e
      version: -1
      name: Set URL
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      key:
        simple: ServerURL
      value:
        complex:
          root: ServerURL
          accessor: URL
          transformers:
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: /instance/execute/taxii2server/
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: 38277ffb-60a7-4bfe-88d6-b8356b3c86d7
    type: regular
    task:
      id: 38277ffb-60a7-4bfe-88d6-b8356b3c86d7
      version: -1
      name: Get Server URL
      description: Get the Server URL.
      scriptName: GetServerURL
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "27"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: dc963372-3942-43f0-87e2-2d88f8d314a2
    type: regular
    task:
      id: dc963372-3942-43f0-87e2-2d88f8d314a2
      version: -1
      name: Send URL Query
      description: Sends http request. Returns the response as json.
      scriptName: http
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      headers:
        simple: Accept:application/taxii+json
      method:
        simple: GET
      url:
        complex:
          root: ServerURL
          transformers:
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: threatintel/collections/
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: TAXIIServer.Collection.id
                iscontext: true
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: /objects/?limit=10000&match[type]=url
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3115
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: 3ca965c9-be26-4736-83b2-e8191d00c7fd
    type: condition
    task:
      id: 3ca965c9-be26-4736-83b2-e8191d00c7fd
      version: -1
      name: Assert Search Time OK
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "33"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: lessThanOrEqual
          left:
            value:
              complex:
                root: HttpRequest.Response.Headers
                accessor: X-Taxii2server-Query-Time-Secs
                transformers:
                - operator: round
            iscontext: true
          right:
            value:
              simple: "18"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3290
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: 018015db-908c-4087-885c-3769ea9b0483
    type: regular
    task:
      id: 018015db-908c-4087-885c-3769ea9b0483
      version: -1
      name: Send IP Query
      description: Sends http request. Returns the response as json.
      scriptName: http
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      headers:
        simple: Accept:application/taxii+json
      method:
        simple: GET
      url:
        complex:
          root: ServerURL
          transformers:
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: threatintel/collections/
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: TAXIIServer.Collection.id
                iscontext: true
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: /objects/?limit=10000&match[type]=ip
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3640
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: 25ee9bf6-f687-4bb4-8795-03c238818fec
    type: condition
    task:
      id: 25ee9bf6-f687-4bb4-8795-03c238818fec
      version: -1
      name: Assert Search Time OK
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "34"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: lessThanOrEqual
          left:
            value:
              complex:
                root: HttpRequest.Response.Headers
                accessor: X-Taxii2server-Query-Time-Secs
                transformers:
                - operator: round
            iscontext: true
          right:
            value:
              simple: "18"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3815
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: 1d1f55f2-c1c6-4712-8484-4f0efd3f23b7
    type: regular
    task:
      id: 1d1f55f2-c1c6-4712-8484-4f0efd3f23b7
      version: -1
      name: Clear Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: ${HttpRequest}
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3465
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: 6373a0d1-85be-4905-8f51-945b607d867c
    type: regular
    task:
      id: 6373a0d1-85be-4905-8f51-945b607d867c
      version: -1
      name: Clear Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "35"
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: ${HttpRequest}
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3990
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: b09015ed-04fe-4df3-878c-74c3d3dd5520
    type: regular
    task:
      id: b09015ed-04fe-4df3-878c-74c3d3dd5520
      version: -1
      name: Send Domain Query
      description: Sends http request. Returns the response as json.
      scriptName: http
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      headers:
        simple: Accept:application/taxii+json
      method:
        simple: GET
      url:
        complex:
          root: ServerURL
          transformers:
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: threatintel/collections/
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: TAXIIServer.Collection.id
                iscontext: true
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: /objects/?limit=10000&match[type]=domain-name
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4165
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: 0200298b-dff9-47b0-8a9f-e2b51790f6cb
    type: condition
    task:
      id: 0200298b-dff9-47b0-8a9f-e2b51790f6cb
      version: -1
      name: Assert Search Time OK
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "57"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: lessThanOrEqual
          left:
            value:
              complex:
                root: HttpRequest.Response.Headers
                accessor: X-Taxii2server-Query-Time-Secs
                transformers:
                - operator: round
            iscontext: true
          right:
            value:
              simple: "18"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4340
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: 85d84ae2-94c1-4533-8081-e6e722f2fd9e
    type: regular
    task:
      id: 85d84ae2-94c1-4533-8081-e6e722f2fd9e
      version: -1
      name: Send URL Query
      description: Sends http request. Returns the response as json.
      scriptName: http
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "39"
    scriptarguments:
      headers:
        simple: Accept:application/taxii+json
      method:
        simple: GET
      url:
        complex:
          root: ServerURL
          transformers:
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: threatintel/collections/
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: TAXIIServer.Collection.id
                iscontext: true
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: /objects/?limit=50000&match[type]=url
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5360
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: cc030986-2d75-4e05-8b19-82d8c9513ae8
    type: condition
    task:
      id: cc030986-2d75-4e05-8b19-82d8c9513ae8
      version: -1
      name: Assert Search Time OK
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "40"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: lessThanOrEqual
          left:
            value:
              complex:
                root: HttpRequest.Response.Headers
                accessor: X-Taxii2server-Query-Time-Secs
                transformers:
                - operator: round
            iscontext: true
          right:
            value:
              simple: "30"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5535
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: e3c51ee0-c14b-46c6-825e-0b1046b2693a
    type: regular
    task:
      id: e3c51ee0-c14b-46c6-825e-0b1046b2693a
      version: -1
      name: Clear Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "41"
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: ${HttpRequest}
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5710
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: 4e75f5f2-67be-4e7b-8c04-76e2bade989d
    type: regular
    task:
      id: 4e75f5f2-67be-4e7b-8c04-76e2bade989d
      version: -1
      name: Send IP Query
      description: Sends http request. Returns the response as json.
      scriptName: http
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "42"
    scriptarguments:
      headers:
        simple: Accept:application/taxii+json
      method:
        simple: GET
      url:
        complex:
          root: ServerURL
          transformers:
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: threatintel/collections/
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: TAXIIServer.Collection.id
                iscontext: true
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: /objects/?limit=50000&match[type]=ip
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5885
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: 7bc7a0a0-df72-465f-8df8-d3029412eeb9
    type: condition
    task:
      id: 7bc7a0a0-df72-465f-8df8-d3029412eeb9
      version: -1
      name: Assert Search Time OK
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "43"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: lessThanOrEqual
          left:
            value:
              complex:
                root: HttpRequest.Response.Headers
                accessor: X-Taxii2server-Query-Time-Secs
                transformers:
                - operator: round
            iscontext: true
          right:
            value:
              simple: "30"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6060
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: 72389367-a574-4e80-8ec9-220623b5c990
    type: regular
    task:
      id: 72389367-a574-4e80-8ec9-220623b5c990
      version: -1
      name: Clear Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "44"
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: ${HttpRequest}
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6235
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "44":
    id: "44"
    taskid: 029df56c-f3ed-4996-869e-dbfb55d41a26
    type: regular
    task:
      id: 029df56c-f3ed-4996-869e-dbfb55d41a26
      version: -1
      name: Send Domain Query
      description: Sends http request. Returns the response as json.
      scriptName: http
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "45"
    scriptarguments:
      headers:
        simple: Accept:application/taxii+json
      method:
        simple: GET
      url:
        complex:
          root: ServerURL
          transformers:
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: threatintel/collections/
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: TAXIIServer.Collection.id
                iscontext: true
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: /objects/?limit=50000&match[type]=domain-name
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: 279a25d8-679b-4c68-8f93-57b0f87f3f73
    type: condition
    task:
      id: 279a25d8-679b-4c68-8f93-57b0f87f3f73
      version: -1
      name: Assert Search Time OK
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "58"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: lessThanOrEqual
          left:
            value:
              complex:
                root: HttpRequest.Response.Headers
                accessor: X-Taxii2server-Query-Time-Secs
                transformers:
                - operator: round
            iscontext: true
          right:
            value:
              simple: "30"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6585
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: 5885567d-48a4-421c-8052-53c0bd9c845a
    type: regular
    task:
      id: 5885567d-48a4-421c-8052-53c0bd9c845a
      version: -1
      name: Send URL Query
      description: Sends http request. Returns the response as json.
      scriptName: http
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "49"
    scriptarguments:
      headers:
        simple: Accept:application/taxii+json
      method:
        simple: GET
      url:
        complex:
          root: ServerURL
          transformers:
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: threatintel/collections/
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: TAXIIServer.Collection.id
                iscontext: true
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: /objects/?limit=100000&match[type]=url
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7605
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: da32e3ed-c0c9-4256-89df-bcc6df50cdeb
    type: condition
    task:
      id: da32e3ed-c0c9-4256-89df-bcc6df50cdeb
      version: -1
      name: Assert Search Time OK
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "50"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: lessThanOrEqual
          left:
            value:
              complex:
                root: HttpRequest.Response.Headers
                accessor: X-Taxii2server-Query-Time-Secs
                transformers:
                - operator: round
            iscontext: true
          right:
            value:
              simple: "90"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7780
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: 50d7ffef-fb81-4664-8dc3-f877387ef07b
    type: regular
    task:
      id: 50d7ffef-fb81-4664-8dc3-f877387ef07b
      version: -1
      name: Clear Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "51"
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: ${HttpRequest}
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7955
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: 2d344e33-4e0a-4554-8f60-71314311144d
    type: regular
    task:
      id: 2d344e33-4e0a-4554-8f60-71314311144d
      version: -1
      name: Send IP Query
      description: Sends http request. Returns the response as json.
      scriptName: http
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "52"
    scriptarguments:
      headers:
        simple: Accept:application/taxii+json
      method:
        simple: GET
      url:
        complex:
          root: ServerURL
          transformers:
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: threatintel/collections/
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: TAXIIServer.Collection.id
                iscontext: true
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: /objects/?limit=100000&match[type]=ip
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8130
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "52":
    id: "52"
    taskid: 8f00d7af-273c-40b2-88a3-ab1b2dd360ca
    type: condition
    task:
      id: 8f00d7af-273c-40b2-88a3-ab1b2dd360ca
      version: -1
      name: Assert Search Time OK
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "53"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: lessThanOrEqual
          left:
            value:
              complex:
                root: HttpRequest.Response.Headers
                accessor: X-Taxii2server-Query-Time-Secs
                transformers:
                - operator: round
            iscontext: true
          right:
            value:
              simple: "90"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8305
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: b655cfc8-b2e0-4df4-8c83-ea060dd2d746
    type: regular
    task:
      id: b655cfc8-b2e0-4df4-8c83-ea060dd2d746
      version: -1
      name: Clear Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "54"
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: ${HttpRequest}
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8480
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "54":
    id: "54"
    taskid: 3ae9690c-2a6d-4607-80dc-e9bf58490de6
    type: regular
    task:
      id: 3ae9690c-2a6d-4607-80dc-e9bf58490de6
      version: -1
      name: Send Domain Query
      description: Sends http request. Returns the response as json.
      scriptName: http
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "55"
    scriptarguments:
      headers:
        simple: Accept:application/taxii+json
      method:
        simple: GET
      url:
        complex:
          root: ServerURL
          transformers:
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: threatintel/collections/
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: TAXIIServer.Collection.id
                iscontext: true
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: /objects/?limit=100000&match[type]=domain-name
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8655
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "55":
    id: "55"
    taskid: 475203a0-79ab-401b-8cef-0daf9efeb1b2
    type: condition
    task:
      id: 475203a0-79ab-401b-8cef-0daf9efeb1b2
      version: -1
      name: Assert Search Time OK
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "59"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: lessThanOrEqual
          left:
            value:
              complex:
                root: HttpRequest.Response.Headers
                accessor: X-Taxii2server-Query-Time-Secs
                transformers:
                - operator: round
            iscontext: true
          right:
            value:
              simple: "90"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8830
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "56":
    id: "56"
    taskid: 7d45d389-de47-4680-8351-349e59da125b
    type: title
    task:
      id: 7d45d389-de47-4680-8351-349e59da125b
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9705
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "57":
    id: "57"
    taskid: 974eb66b-f3ee-438b-8150-8196d5204687
    type: regular
    task:
      id: 974eb66b-f3ee-438b-8150-8196d5204687
      version: -1
      name: Clear Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: ${HttpRequest}
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4515
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "58":
    id: "58"
    taskid: bb1fe041-3e69-4bed-8787-26eabe40ad0b
    type: regular
    task:
      id: bb1fe041-3e69-4bed-8787-26eabe40ad0b
      version: -1
      name: Clear Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: ${HttpRequest}
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6760
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "59":
    id: "59"
    taskid: 45327fbd-6f64-4877-8462-ce3d744f2674
    type: regular
    task:
      id: 45327fbd-6f64-4877-8462-ce3d744f2674
      version: -1
      name: Clear Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: ${HttpRequest}
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9005
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: 4f088905-a0bd-490c-8d32-5ebd6a7f2c78
    type: regular
    task:
      id: 4f088905-a0bd-490c-8d32-5ebd6a7f2c78
      version: -1
      name: Clear HeyConcurrency Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "56"
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: HeyConcurrency
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9530
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    id: "61"
    taskid: c22b6109-8027-4413-833c-957ce796e110
    type: regular
    task:
      id: c22b6109-8027-4413-833c-957ce796e110
      version: -1
      name: taxii-server-list-collections
      description: Returns all the collections.
      script: TAXII2 Server|||taxii-server-list-collections
      type: regular
      iscommand: true
      brand: TAXII2 Server
    nexttasks:
      '#none#':
      - "29"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2950
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 9720,
        "width": 492.5,
        "x": 50,
        "y": 50
      }
    }
  }
inputs:
- key: edl_name
  value:
    simple: edl
  required: false
  description: EDL instance URL.
  playbookInputQuery: null
- key: z
  value: {}
  required: false
  description: Duration of application to send requests.
  playbookInputQuery: null
- key: "n"
  value: {}
  required: false
  description: The number of requests to run. Default is 200.
  playbookInputQuery: null
- key: iocs_in_xsoar
  value:
    simple: "100000"
  required: false
  description: Expected number of indicators in the system.
  playbookInputQuery: null
outputs: []
fromversion: 6.1.0
description: ''
