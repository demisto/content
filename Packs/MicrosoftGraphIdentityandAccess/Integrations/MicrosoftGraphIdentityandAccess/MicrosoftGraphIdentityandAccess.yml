category: Identity and Access Management
commonfields:
  id: MicrosoftGraphIdentityandAccess
  version: -1
configuration:
- defaultvalue: 597c0375-766f-4e6d-ad2a-f48117044ac5
  display: Application ID
  hidden: false
  name: app_id
  required: true
  type: 0
- defaultvalue: https://login.microsoftonline.com
  display: Azure AD endpoint
  hidden: false
  name: azure_ad_endpoint
  options:
  - https://login.microsoftonline.com
  - https://login.microsoftonline.us
  - https://login.microsoftonline.de
  - https://login.chinacloudapi.cn
  required: false
  type: 15
  additionalinfo: Azure AD endpoint associated with a national cloud.
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: Use the Azure Active Directory Identity And Access integration to manage
  roles and members.
display: Azure Active Directory Identity And Access
name: MicrosoftGraphIdentityandAccess
script:
  commands:
  - deprecated: false
    description: Run this command to start the authorization process and follow the
      instructions in the command results.
    execution: false
    name: msgraph-identity-auth-start
  - deprecated: false
    description: |-
      Run this command to complete the authorization process.
      Should be used after running the msgraph-identity-auth-start command.
    execution: false
    name: msgraph-identity-auth-complete
  - deprecated: false
    description: Run this command if for some reason you need to rerun the authentication
      process.
    execution: false
    name: msgraph-identity-auth-reset
  - deprecated: false
    description: Tests connectivity to Microsoft.
    execution: false
    name: msgraph-identity-auth-test
  - deprecated: false
    description: Lists the roles in the directory.
    execution: false
    name: msgraph-identity-directory-roles-list
    arguments:
    - name: limit
      default: false
      description: Maximum number of results to fetch.
      isArray: false
      required: false
      defaultValue: 10
      secret: false
    outputs:
    - contextPath: MSGraphIdentity.Role.deletedDateTime
      description: The time when a role was deleted. Displays only if a role was deleted.
      type: Date
    - contextPath: MSGraphIdentity.Role.description
      description: The description of the directory role.
      type: String
    - contextPath: MSGraphIdentity.Role.displayName
      description: The display name of the directory role.
      type: String
    - contextPath: MSGraphIdentity.Role.id
      description: The unique identifier of the directory role.
      type: String
    - contextPath: MSGraphIdentity.Role.roleTemplateId
      description: The ID of the directory role template on which the role is based.
      type: String
  - deprecated: false
    description: Activates a role by its template ID.
    execution: false
    name: msgraph-identity-directory-role-activate
    arguments:
    - name: role_template_id
      default: false
      description: ID of the role template to activate. Can be retrieved using the
        msgraph-identity-directory-roles-list command.
      isArray: false
      required: true
      secret: false
    outputs:
    - contextPath: MSGraphIdentity.Role.deletedDateTime
      description: The time when the role was deleted. Displays only if the role was
        deleted.
      type: Date
    - contextPath: MSGraphIdentity.Role.description
      description: The description of the directory role.
      type: String
    - contextPath: MSGraphIdentity.Role.displayName
      description: The display name of the directory role.
      type: String
    - contextPath: MSGraphIdentity.Role.id
      description: The unique identifier of the directory role.
      type: String
    - contextPath: MSGraphIdentity.Role.roleTemplateId
      description: The ID of the directory role template on which this role is based.
      type: String
  - deprecated: false
    description: Gets all members in a role ID.
    execution: false
    name: msgraph-identity-directory-role-members-list
    arguments:
    - name: role_id
      default: false
      description: The ID of the application for which to get its role members list.
        Can be retrieved using the msgraph-identity-directory-roles-list command.
      isArray: false
      required: true
      secret: false
    - name: limit
      default: false
      description: The maximum number of members to fetch.
      defaultValue: 10
      isArray: false
      required: false
      secret: false
    outputs:
    - contextPath: MSGraphIdentity.RoleMember.user_id
      description: The unique identifier of the user in the role.
      type: String
    - contextPath: MSGraphIdentity.RoleMember.role_id
      description: The unique identifier of the role specified in the input.
      type: String
  - deprecated: false
    description: Adds a user to a role.
    execution: false
    name: msgraph-identity-directory-role-member-add
    arguments:
    - name: role_id
      default: false
      description: The ID of the role to add the user to. Can be retrieved using the
        msgraph-identity-directory-roles-list command.
      isArray: false
      required: true
      secret: false
    - name: user_id
      default: false
      description: The ID of the user to add to the role. Can be retrieved using the
        msgraph-identity-directory-role-members-list command.
      isArray: false
      required: true
      secret: false
  - deprecated: false
    description: Removes a user from a role.
    execution: false
    name: msgraph-identity-directory-role-member-remove
    arguments:
    - name: role_id
      default: false
      description: ID of the role from which to remove the user. Can be retrieved
        using the msgraph-identity-directory-roles-list command.
      isArray: false
      required: true
      secret: false
    - name: user_id
      default: false
      description: ID of the user to remove from the role. Can be retrieved using
        the msgraph-identity-directory-role-members-list command.
      isArray: false
      required: true
      secret: false
  - deprecated: false
    description: Retrieve an ip named location by id.
    execution: false
    name: msgraph-identity-ip-named-locations-get
    arguments:
    - name: ip_id
      default: false
      description: The id of the named ip location to get from the api.
      isArray: false
      required: true
      secret: false
    outputs:
    - contextPath: MSGraph.conditionalAccess.namedIpLocations.time_created
      description: The time when an ip named location was created.
      type: Date
    - contextPath: MSGraph.conditionalAccess.namedIpLocations.time_modified
      description: The time when an ip named location was updated.
      type: Date
    - contextPath: MSGraph.conditionalAccess.namedIpLocations.display_name
      description: The display name of the ip named location.
      type: String
    - contextPath: MSGraph.conditionalAccess.namedIpLocations.id
      description: The unique identifier of the ip named location.
      type: String
    - contextPath: MSGraph.conditionalAccess.namedIpLocations.is_trusted
      description: Abollean that taled if the ip named location is a trusted source.
      type: String
    - contextPath: MSGraph.conditionalAccess.namedIpLocations.ip_ranges
      description: List of ip ranges for the ip named location
      type: Array
  - deprecated: false
    description: Retrieve all ip named locations.
    execution: false
    name: msgraph-identity-ip-named-locations-list
    arguments:
    - name: limit
      description: The limit for results we get from the api.
      isArray: false
      required: false
      secret: false
    - name: page
      description: The page to get the data from.
      isArray: false
      required: false
      secret: false
    - name: odata_query
      description: An odata query to send to the api.
      isArray: false
      required: false
      secret: false
    outputs:
    - contextPath: MSGraph.conditionalAccess.namedIpLocations.ip_named_locations
      description: List of ip named locations.
      type: Array
  - deprecated: false
    description: Delete an ip named location by id.
    execution: false
    name: msgraph-identity-ip-named-locations-delete
    arguments:
    - name: ip_id
      default: false
      description: The id of the named ip location to get from the api.
      isArray: false
      required: true
      secret: false
  - deprecated: false
    description: Create an ip named location.
    execution: false
    name: msgraph-identity-ip-named-locations-create
    arguments:
    - name: ips
      default: false
      description: A list of IP addresses to add to the named location, should be a string with the addresses separated by the delimiter ','.
      isArray: false
      required: false
      secret: false
    - name: is_trusted
      default: false
      description: Boolean that indicates if the ip can be trusted.
      isArray: false
      required: false
      secret: false
    - name: display_name
      default: false
      description: The disply name for the named ip location.
      isArray: false
      required: false
      secret: false
    outputs:
    - contextPath: MSGraph.conditionalAccess.namedIpLocations.time_created
      description: The time when an ip named location was created.
      type: Date
    - contextPath: MSGraph.conditionalAccess.namedIpLocations.time_modified
      description: The time when an ip named location was updated.
      type: Date
    - contextPath: MSGraph.conditionalAccess.namedIpLocations.display_name
      description: The display name of the ip named location.
      type: String
    - contextPath: MSGraph.conditionalAccess.namedIpLocations.id
      description: The unique identifier of the ip named location.
      type: String
    - contextPath: MSGraph.conditionalAccess.namedIpLocations.is_trusted
      description: Abollean that taled if the ip named location is a trusted source.
      type: String
    - contextPath: MSGraph.conditionalAccess.namedIpLocations.ip_ranges
      description: List of ip ranges for the ip named location
      type: Array
  - deprecated: false
    description: update an ip named location by id.
    execution: false
    name: msgraph-identity-ip-named-locations-update
    arguments:
    - name: ip_id
      default: false
      description: The id of the named ip location to get from the api.
      isArray: false
      required: true
      secret: false
    - name: ips
      default: false
      description: A list of ip addresses to ad to the named location, it should be a string with the addresses separated by the delimiter ','.
      isArray: false
      required: false
      secret: false
    - name: is_trusted
      default: false
      description: Boolean that indicates if the ip can be trusted.
      isArray: false
      required: false
      secret: false
    - name: display_name
      default: false
      description: The disply name for the named ip location.
      isArray: false
      required: false
      secret: false
  - deprecated: false
    description: Retrieve all the detected risks.
    execution: false
    name: msgraph-identity-protection-risks-list
    arguments:
    - name: limit
      description: The limit for results we get from the api.
      isArray: false
      required: false
      secret: false
    - name: page
      description: The page to get the data from.
      isArray: false
      required: false
      secret: false
    - name: odata_query
      description: An odata query to send to the api.
      isArray: false
      required: false
      secret: false
    outputs:
    - contextPath: MSGraph.identityProtection.risks
      description: List of risk detections.
      type: Array
  - deprecated: false
    description: Retrieve the risky users in active directory.
    execution: false
    name: msgraph-identity-protection-risky-user-list
    arguments:
    - name: limit
      description: The limit for results we get from the api.
      isArray: false
      required: false
      secret: false
    - name: page
      description: The page to get the data from.
      isArray: false
      required: false
      secret: false
    - name: odata_query
      description: An odata query to send to the api.
      isArray: false
      required: false
      secret: false
    outputs:
    - contextPath: MSGraph.identityProtection.riskyUsers
      description: List of risy users.
      type: Array
  - deprecated: false
    description: Retrieve the risky users history in active directory.
    execution: false
    name: msgraph-identity-protection-risky-user-history-list
    arguments:
    - name: limit
      description: The limit for results we get from the api.
      isArray: false
      required: false
      secret: false
    - name: page
      description: The page to get the data from.
      isArray: false
      required: false
      secret: false
    - name: odata_query
      description: An odata query to send to the api.
      isArray: false
      required: false
      secret: false
    - name: user_id
      description: The id of the user to get the history for.
      isArray: false
      required: true
      secret: false
    outputs:
    - contextPath: MSGraph.identityProtection.riskyUsersHistory
      description: List of risy users history.
      type: Array
  - deprecated: false
    description: Delete an ip named location by id.
    execution: false
    name: msgraph-identity-protection-risky-user-confirm-compromised
    arguments:
    - name: user_ids
      default: false
      description: The ids of the users to compromise seperated be commas.
      isArray: false
      required: true
      secret: false
  - deprecated: false
    description: Delete an ip named location by id.
    execution: false
    name: msgraph-identity-protection-risky-user-dismiss
    arguments:
    - name: user_ids
      default: false
      description: The ids of the users to dismiss seperated be commas.
      isArray: false
      required: true
      secret: false
  isfetch: false
  runonce: false
  script: '-'
  type: python
  subtype: python3
  dockerimage: demisto/crypto:1.0.0.28507
fromversion: 5.0.0
tests:
- Identity & Access test playbook
