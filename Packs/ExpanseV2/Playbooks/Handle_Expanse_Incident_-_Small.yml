description: Main playbook for Expanse Issues
id: Handle Expanse Incident - Small
inputs:
- description: Prefix for XSOAR related Expanse tags
  key: TagPrefix
  playbookInputQuery:
  required: false
  value:
    simple: xsoar-
- description: Write data to back Expanse? (True/False)
  key: WriteToExpanse
  playbookInputQuery:
  required: false
  value:
    simple: "False"
- description: Comma separated list of tags to be used to identify IP ranges attributed
    with low confidence
  key: IPRangeLowConfidenceTagList
  playbookInputQuery:
  required: false
  value:
    simple: low confidence
- description: Tag to be used for assets that do not belong to org
  key: FalsePositiveTag
  playbookInputQuery:
  required: false
  value:
    simple: xsoar-false-positive
name: Handle Expanse Incident - Small
outputs: []
starttaskid: "0"
tasks:
  "0":
    id: "0"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "163"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5fb18d11-4b25-4a7e-8e87-62289a1ffd12
      iscommand: false
      name: ""
      version: -1
      description: ''
    taskid: 5fb18d11-4b25-4a7e-8e87-62289a1ffd12
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 1440,
          "y": -2230
        }
      }
  "5":
    id: "5"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "122"
      - "65"
      - "173"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c96f7ce1-cde2-4c2c-8b78-77fe3442d9d2
      iscommand: false
      name: Set Up Context Variables
      type: title
      version: -1
      description: ''
    taskid: c96f7ce1-cde2-4c2c-8b78-77fe3442d9d2
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1440,
          "y": -1450
        }
      }
  "12":
    id: "12"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "159"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: ExpanseXSOARIssueTags
      stringify: {}
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: incident.expansetags
              operator: startWith
              right:
                iscontext: true
                value:
                  simple: inputs.TagPrefix
          root: incident.expansetags
          transformers:
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: d81eb367-026d-46df-8ff6-6cf1980f300b
      iscommand: false
      name: Extract XSOAR Incident Tags from Expanse
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: d81eb367-026d-46df-8ff6-6cf1980f300b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 907.5,
          "y": -1305
        }
      }
  "28":
    id: "28"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "141"
      - "169"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 65a64e38-0902-43e5-8cb3-8766819a49e9
      iscommand: false
      name: Enrichment
      type: title
      version: -1
      description: ''
    taskid: 65a64e38-0902-43e5-8cb3-8766819a49e9
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1440,
          "y": -960
        }
      }
  "29":
    id: "29"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "34"
      - "36"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f8f2b7bf-ff4d-46e6-8711-7aa5f9a353d1
      iscommand: false
      name: Validation
      type: title
      version: -1
      description: ''
    taskid: f8f2b7bf-ff4d-46e6-8711-7aa5f9a353d1
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1440,
          "y": -110
        }
      }
  "30":
    id: "30"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "166"
      - "172"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c35833ac-7799-4d5d-8500-2554aa56d039
      iscommand: false
      name: Remediation
      type: title
      version: -1
      description: ''
    taskid: c35833ac-7799-4d5d-8500-2554aa56d039
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1260,
          "y": 5610
        }
      }
  "34":
    id: "34"
    ignoreworker: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "62"
    note: false
    quietmode: 0
    scriptarguments:
      Asset:
        simple: ${incident.labels.assets[0]}
      Domain:
        simple: ${incident.expansedomain}
      IP:
        simple: ${incident.expanseip}
      InternalIPRange: {}
      Port:
        simple: ${incident.expanseport}
      Protocol:
        simple: ${incident.expanseprotocol}
      Provider:
        simple: ${incident.labels.providers[0].name}
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: "Given an Expanse Asset, Issue IP, Issue Provider, Issue Domain,\
        \ Issue Port and Issue Protocol hunts for internal activity on the detected\
        \ service. \nReturns a list of potential owner BUs, owner Users, Device and\
        \ Notes"
      id: 163bfc5a-c7b3-4d32-8a89-16eaa3fccca3
      iscommand: false
      name: Expanse Attribution Subplaybook
      playbookId: Expanse Attribution Subplaybook
      type: playbook
      version: -1
    taskid: 163bfc5a-c7b3-4d32-8a89-16eaa3fccca3
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 867.5,
          "y": 35
        }
      }
  "36":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: expanseprovider
                root: incident
          operator: isNotEqualString
          right:
            value:
              simple: On Prem
      label: "yes"
    id: "36"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "62"
      "yes":
      - "171"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether the asset is on prem or cloud.
      id: 6f366232-ece5-4101-8e6c-9a33dff0eb93
      iscommand: false
      name: Is Issue Related To Cloud Asset?
      type: condition
      version: -1
    taskid: 6f366232-ece5-4101-8e6c-9a33dff0eb93
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1440,
          "y": 45
        }
      }
  "40":
    id: "40"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "158"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: SuggestedShadowITAnswer
      stringify: {}
      value:
        simple: "Yes"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Set a value in context under the key you entered.
      id: 7bef20c3-dff0-41a2-8682-92d833853ecd
      iscommand: false
      name: Suggest possible Shadow IT
      script: Set
      type: regular
      version: -1
    taskid: 7bef20c3-dff0-41a2-8682-92d833853ecd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 960,
          "y": 2465
        }
      }
  "48":
    form:
      description: |-
        Playbook automatically collected details from different sources to help the identification of the owner of the asset. Please check the Evidence board for additional details that could help in your investigation.

        To continue your investigation, please decide:
        - the **Organization Unit** this asset belongs to. This will be used for notifications and remediations actions. If you don't know, you can select *Unknown*. If the asset doesn't belong to your organization, select *False Positive*. If the OU is not listed select *Add New* to add a new OU.
        - if the asset should be considered **Shadow IT**
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Select the Organization Unit owning this asset
        options: []
        optionsarg:
        - complex:
            accessor: ExpanseOrganizationUnitsToOwner
            root: lists
            transformers:
            - args:
                expression:
                  value:
                    simple: keys(@)
              operator: jmespath
        - simple: ❓Unknown
        - simple: ➕ Add New
        - simple: ❌ False Positive
        placeholder: ""
        readonly: false
        required: true
        tooltip: Select the Organization Unit owning this asset
        type: singleSelect
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "1"
        label: ""
        labelarg:
          complex:
            root: SuggestedShadowITAnswer
            transformers:
            - args:
                else:
                  value:
                    simple: Automatic analysis suggests that the asset is not Shadow
                      IT. Is the asset Shadow IT?
                equals:
                  value:
                    simple: "Yes"
                then:
                  value:
                    simple: Automatic analysis identified the asset as a possible
                      Shadow IT asset. Is the asset Shadow IT?
              operator: If-Then-Else
        options: []
        optionsarg:
        - simple: "No"
        - simple: ❓Undecided
        - simple: "Yes"
        placeholder: ""
        readonly: false
        required: true
        tooltip: Decide whether this a Shadow IT asset
        type: singleSelect
      sender: Your SOC team
      title: Analysis of Asset Attribution
      totalanswers: 0
    id: "48"
    ignoreworker: false
    message:
      bcc:
      body:
        complex:
          accessor: id
          root: incident
          transformers:
          - args:
              prefix:
                value:
                  simple: 'Input needed to help attribution in Expanse Issue  '
              suffix: {}
            operator: concat
      cc:
      format: ""
      methods: []
      subject:
        simple: '** not used **'
      timings:
        completeafterreplies: 1
        retriescount: 2
        retriesinterval: 360
      to:
        simple: Analyst
    nexttasks:
      '#none#':
      - "88"
      - "136"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Ask the user to perform attribution.
      id: d2ca58fc-cf95-4d39-8fb1-ed702064e724
      iscommand: false
      name: 'Ask: What Is The Organization Unit?'
      type: collection
      version: -1
    taskid: d2ca58fc-cf95-4d39-8fb1-ed702064e724
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 1247.5,
          "y": 3195
        }
      }
  "49":
    id: "49"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "93"
    note: false
    quietmode: 0
    scriptarguments:
      accountid: {}
      accountname: {}
      addLabels: {}
      agentid: {}
      app: {}
      appendMultiSelect: {}
      assetid: {}
      assigneduser: {}
      assignmentgroup: {}
      attachmentcount: {}
      attachmentextension: {}
      attachmenthash: {}
      attachmentid: {}
      attachmentname: {}
      attachmentsize: {}
      attachmenttype: {}
      blockedaction: {}
      bugtraq: {}
      caller: {}
      city: {}
      closeNotes: {}
      closeReason: {}
      cloudservice: {}
      commandline: {}
      costcenter: {}
      costcentercode: {}
      country: {}
      countryname: {}
      criticalassets: {}
      customFields: {}
      cve: {}
      cvss: {}
      dbotMirrorDirection: {}
      dbotMirrorId: {}
      dbotMirrorInstance: {}
      dbotMirrorTags: {}
      dbotprediction: {}
      dbotpredictionprobability: {}
      dbottextsuggestionhighlighted: {}
      deleteEmptyField: {}
      department: {}
      dest: {}
      desthostname: {}
      destinationhostname: {}
      destinationip: {}
      destinationnetwork: {}
      destinationport: {}
      destntdomain: {}
      destos: {}
      details: {}
      detectedexternalhosts: {}
      detectedexternalips: {}
      detectedinternalhosts: {}
      detectedinternalips: {}
      detectedusers: {}
      detectionendtime: {}
      detectionid: {}
      detectionupdatetime: {}
      detectionurl: {}
      deviceexternalip: {}
      devicehash: {}
      devicelocalip: {}
      devicemodel: {}
      devicename: {}
      displayname: {}
      duration: {}
      email: {}
      emailauthenticitycheck: {}
      emailbcc: {}
      emailbody: {}
      emailbodyformat: {}
      emailbodyhtml: {}
      emailcc: {}
      emailclassification: {}
      emailclientname: {}
      emailfrom: {}
      emailheaders: {}
      emailhtml: {}
      emailinreplyto: {}
      emailkeywords: {}
      emailmessageid: {}
      emailreceived: {}
      emailreplyto: {}
      emailreturnpath: {}
      emailsenderip: {}
      emailsize: {}
      emailsource: {}
      emailsubject: {}
      emailto: {}
      emailtocount: {}
      emailurlclicked: {}
      employeedisplayname: {}
      employeeemail: {}
      employeemanageremail: {}
      escalation: {}
      eventaction: {}
      eventid: {}
      eventtype: {}
      expanseactivitystatus: {}
      expanseasset: {}
      expanseassetorganizationunit:
        complex:
          accessor: "0"
          root: Analysis of Asset Attribution.Answers
          transformers:
          - operator: FirstArrayElement
      expanseassetowner: {}
      expanseassignee: {}
      expansebusinessunits: {}
      expansecategory: {}
      expansecertificate: {}
      expansecreated: {}
      expansedomain: {}
      expanseinitialevidence: {}
      expanseip: {}
      expanseissueid: {}
      expanseissuetype: {}
      expanselatestevidence: {}
      expansemodified: {}
      expanseport: {}
      expansepriority: {}
      expanseprogressstatus: {}
      expanseprotocol: {}
      expanseprovider: {}
      expanseshadowit: {}
      expansetags: {}
      externaladdresses: {}
      filehash: {}
      filename: {}
      filepath: {}
      filesize: {}
      firstname: {}
      firstseen: {}
      givenname: {}
      helloworldid: {}
      helloworldstatus: {}
      helloworldtype: {}
      hostname: {}
      id: {}
      incomingmirrorerror: {}
      infectedhosts: {}
      internaladdresses: {}
      investigationstage: {}
      isolated: {}
      jobcode: {}
      jobfamily: {}
      jobfunction: {}
      labels: {}
      lastmodifiedby: {}
      lastmodifiedon: {}
      lastname: {}
      lastseen: {}
      leadership: {}
      location: {}
      locationregion: {}
      logsource: {}
      macaddress: {}
      maliciousbehavior: {}
      malwarefamily: {}
      malwarename: {}
      manageremailaddress: {}
      managername: {}
      md5: {}
      mobiledevicemodel: {}
      mobilephone: {}
      name: {}
      occurred: {}
      os: {}
      osversion: {}
      outgoingmirrorerror: {}
      owner: {}
      parentprocessid: {}
      personalemail: {}
      phase: {}
      phishingsubtype: {}
      phonenumber: {}
      pid: {}
      policydeleted: {}
      policydescription: {}
      policydetails: {}
      policyid: {}
      policyrecommendation: {}
      policyremediable: {}
      policyseverity: {}
      policytype: {}
      prismacloudid: {}
      prismacloudreason: {}
      prismacloudrules: {}
      prismacloudstatus: {}
      prismacloudtime: {}
      protocol: {}
      protocols: {}
      quarantined: {}
      rating: {}
      region: {}
      regionid: {}
      replacePlaybook: {}
      reporteremailaddress: {}
      resourceapiname: {}
      resourcecloudtype: {}
      resourceid: {}
      resourcename: {}
      resourcetype: {}
      riskrating: {}
      riskscore: {}
      roles: {}
      rrn: {}
      samaccountname: {}
      severity: {}
      sha256: {}
      shadowitaccountowneremail: {}
      shadowitaccountownername: {}
      shadowitcloudaccountid: {}
      shadowitcloudaccounttype: {}
      signature: {}
      skuname: {}
      skutier: {}
      sla: {}
      slaField: {}
      sourcehostname: {}
      sourceip: {}
      sourcenetwork: {}
      sourceport: {}
      sourceusername: {}
      src: {}
      srchostname: {}
      srcntdomain: {}
      srcos: {}
      srcuser: {}
      state: {}
      streetaddress: {}
      subcategory: {}
      subscriptionassignedby: {}
      subscriptioncreatedby: {}
      subscriptioncreatedon: {}
      subscriptiondescription: {}
      subscriptionid: {}
      subscriptionname: {}
      subscriptiontype: {}
      subscriptionupdatedby: {}
      subscriptionupdatedon: {}
      subtype: {}
      surname: {}
      systemdefault: {}
      systems: {}
      targetfirewallversion: {}
      tenantname: {}
      terminatedaction: {}
      threatactor: {}
      ticketcloseddate: {}
      ticketnumber: {}
      ticketopeneddate: {}
      title: {}
      triggeredsecurityprofile: {}
      type: {}
      uniqueports: {}
      urlsslverification: {}
      user: {}
      useraccountcontrol: {}
      username: {}
      vendorid: {}
      vendorproduct: {}
      vpcid: {}
      vulnerabilitycategory: {}
      workphone: {}
      xdralertcount: {}
      xdralerts: {}
      xdrassigneduseremail: {}
      xdrassigneduserprettyname: {}
      xdrdescription: {}
      xdrdetectiontime: {}
      xdrfileartifacts: {}
      xdrhighseverityalertcount: {}
      xdrhostcount: {}
      xdrincidentid: {}
      xdrlowseverityalertcount: {}
      xdrmediumseverityalertcount: {}
      xdrnetworkartifacts: {}
      xdrnotes: {}
      xdrresolvecomment: {}
      xdrstatus: {}
      xdrstatusv2: {}
      xdrurl: {}
      xdrusercount: {}
      zipcode: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 0e6cc6ca-2117-4708-8d37-2aff00206feb
      iscommand: true
      name: Set Organization Unit
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 0e6cc6ca-2117-4708-8d37-2aff00206feb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1482.5,
          "y": 4050
        }
      }
  "59":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: ShadowITCondition.value
                    operator: isTrue
                root: ShadowITCondition
          operator: isNotEmpty
      label: Possible
    id: "59"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "40"
      Possible:
      - "133"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if the incident is a possible Shadow IT one.
      id: 4b4447a2-6770-466a-8781-34b4d52d8ee2
      iscommand: false
      name: Check for Possible Shadow IT?
      type: condition
      version: -1
    taskid: 4b4447a2-6770-466a-8781-34b4d52d8ee2
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1287.5,
          "y": 2230
        }
      }
  "62":
    id: "62"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "154"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ac9514d4-ba5b-427d-8b1c-99868d81faf5
      iscommand: false
      name: Shadow IT
      type: title
      version: -1
      description: ''
    taskid: ac9514d4-ba5b-427d-8b1c-99868d81faf5
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1287.5,
          "y": 1310
        }
      }
  "63":
    id: "63"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "68"
      - "69"
      - "70"
      - "108"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 61e0300c-b450-457c-87ac-a8967e3ac0e7
      iscommand: false
      name: Organization Unit
      type: title
      version: -1
      description: ''
    taskid: 61e0300c-b450-457c-87ac-a8967e3ac0e7
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1247.5,
          "y": 2875
        }
      }
  "65":
    id: "65"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: IPRangeLowConfidenceTag
      stringify: {}
      value:
        complex:
          root: inputs.IPRangeLowConfidenceTagList
          transformers:
          - args:
              delimiter:
                value:
                  simple: ','
            operator: splitAndTrim
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: cf78ff3e-9195-46e7-841c-28dbc86c2665
      iscommand: false
      name: Extract List of Low Confidence Discovery tags from PB Inputs
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: cf78ff3e-9195-46e7-841c-28dbc86c2665
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1440,
          "y": -1130
        }
      }
  "68":
    id: "68"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "48"
    note: false
    quietmode: 0
    scriptarguments:
      columns: {}
      data:
        complex:
          accessor: AttributionUser
          root: Expanse
          transformers:
          - args:
              applyIfEmpty:
                value:
                  simple: "true"
              defaultValue:
                value:
                  simple: '[]'
            operator: SetIfEmpty
      title:
        simple: List of Users who connected to the asset in the past 7 days
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Convert an array to a nice table display. Usually, from the context.
      id: 9e2147fa-7b5a-43f3-892a-902f5afe5a36
      iscommand: false
      name: Print Target Users suggestions
      script: ToTable
      tags:
      - ExpanseSuggestion
      type: regular
      version: -1
    taskid: 9e2147fa-7b5a-43f3-892a-902f5afe5a36
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1052.5,
          "y": 3020
        }
      }
  "69":
    id: "69"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "48"
    note: false
    quietmode: 0
    scriptarguments:
      columns: {}
      data:
        complex:
          accessor: AttributionIP
          root: Expanse
          transformers:
          - args:
              applyIfEmpty:
                value:
                  simple: "true"
              defaultValue:
                value:
                  simple: '[]'
            operator: SetIfEmpty
      title:
        simple: List of Source IP that connected to the asset in the past 7 days
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Convert an array to a nice table display. Usually, from the context.
      id: 2c6408ce-83d8-4a86-8bb1-9711620f5a03
      iscommand: false
      name: Print Target IP suggestions
      script: ToTable
      tags:
      - ExpanseSuggestion
      type: regular
      version: -1
    taskid: 2c6408ce-83d8-4a86-8bb1-9711620f5a03
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1492.5,
          "y": 3020
        }
      }
  "70":
    id: "70"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "48"
    note: false
    quietmode: 0
    scriptarguments:
      columns: {}
      data:
        complex:
          accessor: AttributionDevice
          root: Expanse
          transformers:
          - args:
              applyIfEmpty:
                value:
                  simple: "true"
              defaultValue:
                value:
                  simple: '[]'
            operator: SetIfEmpty
      title:
        simple: List of Devices that permitted traffic to asset in the past 7 days
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Convert an array to a nice table display. Usually, from the context.
      id: f03fe9a1-6abb-4458-89ea-92bbc55e6d66
      iscommand: false
      name: Print Target Devices suggestions
      script: ToTable
      tags:
      - ExpanseSuggestion
      type: regular
      version: -1
    taskid: f03fe9a1-6abb-4458-89ea-92bbc55e6d66
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1912.5,
          "y": 3020
        }
      }
  "75":
    id: "75"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "76"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c1108519-3c84-4662-8441-915d1dc2ba01
      iscommand: false
      name: Close Investigation
      type: title
      version: -1
      description: ''
    taskid: c1108519-3c84-4662-8441-915d1dc2ba01
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1247.5,
          "y": 6325
        }
      }
  "76":
    id: "76"
    ignoreworker: false
    nexttasks:
      ✅ Yes:
      - "77"
      ❌ No:
      - "78"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Ask the user whether to close the investigation.
      id: ca45eb59-71b5-42fb-800a-37c7c862e2b1
      iscommand: false
      name: Close Investigation?
      type: condition
      version: -1
    taskid: ca45eb59-71b5-42fb-800a-37c7c862e2b1
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1247.5,
          "y": 6590
        }
      }
  "77":
    id: "77"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "78"
    note: false
    quietmode: 0
    scriptarguments:
      assetid: {}
      closeNotes: {}
      closeReason: {}
      emailclassification: {}
      id: {}
      incomingmirrorerror: {}
      outgoingmirrorerror: {}
      phishingsubtype: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: dbe82a32-98ad-460d-8d7b-404dc47bab97
      iscommand: true
      name: Close Investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: dbe82a32-98ad-460d-8d7b-404dc47bab97
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1560,
          "y": 6840
        }
      }
  "78":
    id: "78"
    ignoreworker: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d256f1d7-dd3b-4f90-86c8-fc7b4f1c34ca
      iscommand: false
      name: All done
      type: title
      version: -1
      description: ''
    taskid: d256f1d7-dd3b-4f90-86c8-fc7b4f1c34ca
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1240,
          "y": 7090
        }
      }
  "88":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Analysis of Asset Attribution.Answers.0
          operator: containsString
          right:
            value:
              simple: Add New
      label: "yes"
    id: "88"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "49"
      "yes":
      - "89"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determine if a new OU has to be added.
      id: a34fb1c9-70f7-4840-8f54-5e24838f2781
      iscommand: false
      name: Should Add New OU?
      type: condition
      version: -1
    taskid: a34fb1c9-70f7-4840-8f54-5e24838f2781
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1482.5,
          "y": 3370
        }
      }
  "89":
    form:
      description: Specify thew Organization Unit name, name and email of the assets
        owner.
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Organization Unit Name
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: shortText
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "1"
        label: ""
        labelarg:
          simple: Expanse Tag
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: The tag to be used on Expanse to tag assets belonging to this Organization
          Unit
        type: shortText
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "2"
        label: ""
        labelarg:
          simple: Organization Unit Asset Owner Name
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: shortText
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "3"
        label: ""
        labelarg:
          simple: Organization Unit Asset Owner Email
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: shortText
      sender: Your SOC team
      title: Add New Organization Unit
      totalanswers: 0
    id: "89"
    ignoreworker: false
    message:
      bcc:
      body:
        simple: Add New OU
      cc:
      format: ""
      methods: []
      subject:
      timings:
        completeafterreplies: 1
        retriescount: 2
        retriesinterval: 360
      to:
    nexttasks:
      '#none#':
      - "90"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Collect new OU details from the user.
      id: 7811c754-fae1-4892-877e-a8d71b8fa7d9
      iscommand: false
      name: Add New OU
      type: collection
      version: -1
    taskid: 7811c754-fae1-4892-877e-a8d71b8fa7d9
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 1982.5,
          "y": 3545
        }
      }
  "90":
    id: "90"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "94"
    note: false
    quietmode: 0
    scriptarguments:
      allowDups: {}
      append:
        simple: "true"
      keyName:
        complex:
          accessor: "0"
          root: Add New Organization Unit.Answers
      listName:
        simple: ExpanseOrganizationUnitsToOwner
      value:
        complex:
          accessor: "2"
          root: Add New Organization Unit.Answers
          transformers:
          - args:
              prefix:
                value:
                  simple: '{"name": "'
              suffix:
                value:
                  simple: '", "email": "'
            operator: concat
          - args:
              prefix: {}
              suffix:
                iscontext: true
                value:
                  simple: Add New Organization Unit.Answers.3
            operator: concat
          - args:
              prefix: {}
              suffix:
                value:
                  simple: '"}'
            operator: concat
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Adds/Replaces a key in key/value store backed by an XSOAR list.
      id: 7d2cc45c-dbb6-4746-8b84-552f929473d1
      iscommand: false
      name: Save New Organization Unit to List
      script: AddKeyToList
      type: regular
      version: -1
    taskid: 7d2cc45c-dbb6-4746-8b84-552f929473d1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1982.5,
          "y": 3710
        }
      }
  "91":
    id: "91"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "93"
    note: false
    quietmode: 0
    scriptarguments:
      accountid: {}
      accountname: {}
      addLabels: {}
      agentid: {}
      app: {}
      appendMultiSelect: {}
      assetid: {}
      assigneduser: {}
      assignmentgroup: {}
      attachmentcount: {}
      attachmentextension: {}
      attachmenthash: {}
      attachmentid: {}
      attachmentname: {}
      attachmentsize: {}
      attachmenttype: {}
      blockedaction: {}
      bugtraq: {}
      caller: {}
      city: {}
      closeNotes: {}
      closeReason: {}
      cloudservice: {}
      commandline: {}
      costcenter: {}
      costcentercode: {}
      country: {}
      countryname: {}
      criticalassets: {}
      customFields: {}
      cve: {}
      cvss: {}
      dbotMirrorDirection: {}
      dbotMirrorId: {}
      dbotMirrorInstance: {}
      dbotMirrorTags: {}
      dbotprediction: {}
      dbotpredictionprobability: {}
      dbottextsuggestionhighlighted: {}
      deleteEmptyField: {}
      department: {}
      dest: {}
      desthostname: {}
      destinationhostname: {}
      destinationip: {}
      destinationnetwork: {}
      destinationport: {}
      destntdomain: {}
      destos: {}
      details: {}
      detectedexternalhosts: {}
      detectedexternalips: {}
      detectedinternalhosts: {}
      detectedinternalips: {}
      detectedusers: {}
      detectionendtime: {}
      detectionid: {}
      detectionupdatetime: {}
      detectionurl: {}
      deviceexternalip: {}
      devicehash: {}
      devicelocalip: {}
      devicemodel: {}
      devicename: {}
      displayname: {}
      duration: {}
      email: {}
      emailauthenticitycheck: {}
      emailbcc: {}
      emailbody: {}
      emailbodyformat: {}
      emailbodyhtml: {}
      emailcc: {}
      emailclassification: {}
      emailclientname: {}
      emailfrom: {}
      emailheaders: {}
      emailhtml: {}
      emailinreplyto: {}
      emailkeywords: {}
      emailmessageid: {}
      emailreceived: {}
      emailreplyto: {}
      emailreturnpath: {}
      emailsenderip: {}
      emailsize: {}
      emailsource: {}
      emailsubject: {}
      emailto: {}
      emailtocount: {}
      emailurlclicked: {}
      employeedisplayname: {}
      employeeemail: {}
      employeemanageremail: {}
      escalation: {}
      eventaction: {}
      eventid: {}
      eventtype: {}
      expanseactivitystatus: {}
      expanseasset: {}
      expanseassetorganizationunit:
        complex:
          accessor: "0"
          root: Add New Organization Unit.Answers
          transformers:
          - operator: FirstArrayElement
      expanseassetowner: {}
      expanseassignee: {}
      expansebusinessunits: {}
      expansecategory: {}
      expansecertificate: {}
      expansecreated: {}
      expansedomain: {}
      expanseinitialevidence: {}
      expanseip: {}
      expanseissueid: {}
      expanseissuetype: {}
      expanselatestevidence: {}
      expansemodified: {}
      expanseport: {}
      expansepriority: {}
      expanseprogressstatus: {}
      expanseprotocol: {}
      expanseprovider: {}
      expanseshadowit: {}
      expansetags: {}
      externaladdresses: {}
      filehash: {}
      filename: {}
      filepath: {}
      filesize: {}
      firstname: {}
      firstseen: {}
      givenname: {}
      helloworldid: {}
      helloworldstatus: {}
      helloworldtype: {}
      hostname: {}
      id: {}
      incomingmirrorerror: {}
      infectedhosts: {}
      internaladdresses: {}
      investigationstage: {}
      isolated: {}
      jobcode: {}
      jobfamily: {}
      jobfunction: {}
      labels: {}
      lastmodifiedby: {}
      lastmodifiedon: {}
      lastname: {}
      lastseen: {}
      leadership: {}
      location: {}
      locationregion: {}
      logsource: {}
      macaddress: {}
      maliciousbehavior: {}
      malwarefamily: {}
      malwarename: {}
      manageremailaddress: {}
      managername: {}
      md5: {}
      mobiledevicemodel: {}
      mobilephone: {}
      name: {}
      occurred: {}
      os: {}
      osversion: {}
      outgoingmirrorerror: {}
      owner: {}
      parentprocessid: {}
      personalemail: {}
      phase: {}
      phishingsubtype: {}
      phonenumber: {}
      pid: {}
      policydeleted: {}
      policydescription: {}
      policydetails: {}
      policyid: {}
      policyrecommendation: {}
      policyremediable: {}
      policyseverity: {}
      policytype: {}
      prismacloudid: {}
      prismacloudreason: {}
      prismacloudrules: {}
      prismacloudstatus: {}
      prismacloudtime: {}
      protocol: {}
      protocols: {}
      quarantined: {}
      rating: {}
      region: {}
      regionid: {}
      replacePlaybook: {}
      reporteremailaddress: {}
      resourceapiname: {}
      resourcecloudtype: {}
      resourceid: {}
      resourcename: {}
      resourcetype: {}
      riskrating: {}
      riskscore: {}
      roles: {}
      rrn: {}
      samaccountname: {}
      severity: {}
      sha256: {}
      signature: {}
      skuname: {}
      skutier: {}
      sla: {}
      slaField: {}
      sourcehostname: {}
      sourceip: {}
      sourcenetwork: {}
      sourceport: {}
      sourceusername: {}
      src: {}
      srchostname: {}
      srcntdomain: {}
      srcos: {}
      srcuser: {}
      state: {}
      streetaddress: {}
      subcategory: {}
      subscriptionassignedby: {}
      subscriptioncreatedby: {}
      subscriptioncreatedon: {}
      subscriptiondescription: {}
      subscriptionid: {}
      subscriptionname: {}
      subscriptiontype: {}
      subscriptionupdatedby: {}
      subscriptionupdatedon: {}
      subtype: {}
      surname: {}
      systemdefault: {}
      systems: {}
      targetfirewallversion: {}
      tenantname: {}
      terminatedaction: {}
      threatactor: {}
      ticketcloseddate: {}
      ticketnumber: {}
      ticketopeneddate: {}
      title: {}
      triggeredsecurityprofile: {}
      type: {}
      uniqueports: {}
      urlsslverification: {}
      user: {}
      useraccountcontrol: {}
      username: {}
      vendorid: {}
      vendorproduct: {}
      vpcid: {}
      vulnerabilitycategory: {}
      workphone: {}
      xdralertcount: {}
      xdralerts: {}
      xdrassigneduseremail: {}
      xdrassigneduserprettyname: {}
      xdrdescription: {}
      xdrdetectiontime: {}
      xdrfileartifacts: {}
      xdrhighseverityalertcount: {}
      xdrhostcount: {}
      xdrincidentid: {}
      xdrlowseverityalertcount: {}
      xdrmediumseverityalertcount: {}
      xdrnetworkartifacts: {}
      xdrnotes: {}
      xdrresolvecomment: {}
      xdrstatus: {}
      xdrstatusv2: {}
      xdrurl: {}
      xdrusercount: {}
      zipcode: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: d13ae202-264c-44b5-8b11-7a5b57aca0c2
      iscommand: true
      name: Set Organization Unit
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: d13ae202-264c-44b5-8b11-7a5b57aca0c2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1982.5,
          "y": 4050
        }
      }
  "93":
    id: "93"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "164"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5e3bdcc7-1409-4541-84c8-7d65eda74b7c
      iscommand: false
      name: Tag Assets
      type: title
      version: -1
      description: ''
    taskid: 5e3bdcc7-1409-4541-84c8-7d65eda74b7c
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1260,
          "y": 4280
        }
      }
  "94":
    id: "94"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "91"
    note: false
    quietmode: 0
    scriptarguments:
      allowDups: {}
      append:
        simple: "false"
      keyName:
        complex:
          accessor: "0"
          root: Add New Organization Unit.Answers
      listName:
        simple: ExpanseOrganizationUnitsToTag
      value:
        complex:
          accessor: "1"
          root: Add New Organization Unit.Answers
          transformers:
          - args:
              prefix:
                value:
                  simple: ou-
              suffix: {}
            operator: concat
          - args:
              prefix:
                iscontext: true
                value:
                  simple: inputs.TagPrefix
              suffix: {}
            operator: concat
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Adds/Replaces a key in key/value store backed by an XSOAR list.
      id: 801283c9-88a5-452c-8a80-ecad20e62ff3
      iscommand: false
      name: Save New Organization Tag to List
      script: AddKeyToList
      type: regular
      version: -1
    taskid: 801283c9-88a5-452c-8a80-ecad20e62ff3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1982.5,
          "y": 3885
        }
      }
  "95":
    id: "95"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "99"
    note: false
    quietmode: 0
    scriptarguments:
      description:
        simple: Created by XSOAR for Organization Unit tagging
      name:
        complex:
          root: AssetTag
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Create a new tag in Expanse.
      id: 97cbc574-76f0-4b18-8ea3-f40107c0c11f
      iscommand: true
      name: Create Tag in Expanse (if it doesn't exist already)
      script: '|||expanse-create-tag'
      type: regular
      version: -1
    taskid: 97cbc574-76f0-4b18-8ea3-f40107c0c11f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1862.5,
          "y": 5060
        }
      }
  "96":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: ExpanseOrganizationUnitsToTag
                root: lists
                transformers:
                - args:
                    field:
                      iscontext: true
                      value:
                        simple: incident.expanseassetorganizationunit
                  operator: getField
                - args:
                    applyIfEmpty: {}
                    defaultValue:
                      value:
                        simple: '**NoTag**'
                  operator: SetIfEmpty
          operator: isNotEqualString
          right:
            value:
              simple: '**NoTag**'
      label: known-ou
    - condition:
      - - left:
            iscontext: true
            value:
              simple: incident.expanseassetorganizationunit
          operator: containsString
          right:
            value:
              simple: False Positive
      label: false-positive
    id: "96"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "165"
      false-positive:
      - "104"
      known-ou:
      - "103"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Branch depending on the OU.
      id: 92df9a63-bbfd-4d97-8058-1dbe11b1d556
      iscommand: false
      name: Do We Have Tag To Use?
      type: condition
      version: -1
    taskid: 92df9a63-bbfd-4d97-8058-1dbe11b1d556
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1640,
          "y": 4650
        }
      }
  "99":
    continueonerror: true
    id: "99"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "174"
    note: false
    quietmode: 0
    scriptarguments:
      asset_id:
        complex:
          accessor: id
          root: incident.expanseasset
      asset_type:
        complex:
          accessor: assettype
          root: incident.expanseasset
      tagnames:
        complex:
          root: AssetTag
      tags: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Assign tags to Asset.
      id: 495b34ca-19fa-4415-884a-d1cf9792d68f
      iscommand: true
      name: Tag Assets on Expanse with AssetTag
      script: '|||expanse-assign-tags-to-asset'
      type: regular
      version: -1
    taskid: 495b34ca-19fa-4415-884a-d1cf9792d68f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1862.5,
          "y": 5215
        }
      }
  "103":
    id: "103"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "95"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: AssetTag
      stringify: {}
      value:
        complex:
          accessor: ExpanseOrganizationUnitsToTag
          root: lists
          transformers:
          - args:
              field:
                iscontext: true
                value:
                  simple: incident.expanseassetorganizationunit
            operator: getField
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 24257233-0c49-408e-8c86-65f9d20698e5
      iscommand: false
      name: Set AssetTag with Known OU Tag
      script: Set
      type: regular
      version: -1
    taskid: 24257233-0c49-408e-8c86-65f9d20698e5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1640,
          "y": 4880
        }
      }
  "104":
    id: "104"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "95"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: AssetTag
      stringify: {}
      value:
        simple: ${inputs.FalsePositiveTag}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 44be312d-5881-461f-889b-a968795f98e4
      iscommand: false
      name: Set AssetTag with False Positive Tag from Inputs
      script: Set
      type: regular
      version: -1
    taskid: 44be312d-5881-461f-889b-a968795f98e4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2087.5,
          "y": 4880
        }
      }
  "108":
    id: "108"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "48"
    note: false
    quietmode: 0
    scriptarguments:
      columns: {}
      data:
        complex:
          accessor: Attribution
          root: PrismaCloud
          transformers:
          - args:
              applyIfEmpty:
                value:
                  simple: "true"
              defaultValue:
                value:
                  simple: '[]'
            operator: SetIfEmpty
      title:
        simple: List of related assets discovered in Prisma Cloud
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Convert an array to a nice table display. Usually, from the context.
      id: b1db577f-cce1-431f-8140-8f6f276c1a62
      iscommand: false
      name: Print Prisma Cloud suggestions
      script: ToTable
      tags:
      - ExpanseSuggestion
      type: regular
      version: -1
    taskid: b1db577f-cce1-431f-8140-8f6f276c1a62
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 627.5,
          "y": 3020
        }
      }
  "122":
    id: "122"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "123"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: ExpanseAllAssetTags
      stringify: {}
      value:
        complex:
          accessor: tags
          root: incident.expanseasset
          transformers:
          - args:
              delimiter:
                value:
                  simple: \n
            operator: split
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: 98f0b01b-dab1-4627-889b-77a89a5efb8d
      iscommand: false
      name: Extract All Asset Tags from Expanse
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 98f0b01b-dab1-4627-889b-77a89a5efb8d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1950,
          "y": -1305
        }
      }
  "123":
    id: "123"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: ExpanseXSOARAssetTags
      stringify: {}
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ExpanseAllAssetTags
              operator: startWith
              right:
                iscontext: true
                value:
                  simple: inputs.TagPrefix
          root: ExpanseAllAssetTags
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: c29c4551-7f14-4550-80d7-17e329591906
      iscommand: false
      name: Extract only XSOAR-related Asset Tags
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: c29c4551-7f14-4550-80d7-17e329591906
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1950,
          "y": -1140
        }
      }
  "133":
    id: "133"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "158"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: SuggestedShadowITAnswer
      stringify: {}
      value:
        simple: "No"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Set a value in context under the key you entered.
      id: 30bf519d-0ab8-4d05-8603-af6abced645a
      iscommand: false
      name: Suggest No Shadow IT
      script: Set
      type: regular
      version: -1
    taskid: 30bf519d-0ab8-4d05-8603-af6abced645a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1667.5,
          "y": 2465
        }
      }
  "135":
    id: "135"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "93"
    note: false
    quietmode: 0
    scriptarguments:
      accountid: {}
      accountname: {}
      addLabels: {}
      agentid: {}
      app: {}
      appendMultiSelect: {}
      assetid: {}
      assigneduser: {}
      assignmentgroup: {}
      attachmentcount: {}
      attachmentextension: {}
      attachmenthash: {}
      attachmentid: {}
      attachmentname: {}
      attachmentsize: {}
      attachmenttype: {}
      blockedaction: {}
      bugtraq: {}
      caller: {}
      city: {}
      closeNotes: {}
      closeReason: {}
      cloudservice: {}
      commandline: {}
      costcenter: {}
      costcentercode: {}
      country: {}
      countryname: {}
      criticalassets: {}
      customFields: {}
      cve: {}
      cvss: {}
      dbotMirrorDirection: {}
      dbotMirrorId: {}
      dbotMirrorInstance: {}
      dbotMirrorTags: {}
      dbotprediction: {}
      dbotpredictionprobability: {}
      dbottextsuggestionhighlighted: {}
      deleteEmptyField: {}
      department: {}
      dest: {}
      desthostname: {}
      destinationhostname: {}
      destinationip: {}
      destinationnetwork: {}
      destinationport: {}
      destntdomain: {}
      destos: {}
      details: {}
      detectedexternalhosts: {}
      detectedexternalips: {}
      detectedinternalhosts: {}
      detectedinternalips: {}
      detectedusers: {}
      detectionendtime: {}
      detectionid: {}
      detectionupdatetime: {}
      detectionurl: {}
      deviceexternalip: {}
      devicehash: {}
      devicelocalip: {}
      devicemodel: {}
      devicename: {}
      displayname: {}
      duration: {}
      email: {}
      emailauthenticitycheck: {}
      emailbcc: {}
      emailbody: {}
      emailbodyformat: {}
      emailbodyhtml: {}
      emailcc: {}
      emailclassification: {}
      emailclientname: {}
      emailfrom: {}
      emailheaders: {}
      emailhtml: {}
      emailinreplyto: {}
      emailkeywords: {}
      emailmessageid: {}
      emailreceived: {}
      emailreplyto: {}
      emailreturnpath: {}
      emailsenderip: {}
      emailsize: {}
      emailsource: {}
      emailsubject: {}
      emailto: {}
      emailtocount: {}
      emailurlclicked: {}
      employeedisplayname: {}
      employeeemail: {}
      employeemanageremail: {}
      escalation: {}
      eventaction: {}
      eventid: {}
      eventtype: {}
      expanseactivitystatus: {}
      expanseasset: {}
      expanseassetorganizationunit: {}
      expanseassetowner: {}
      expanseassignee: {}
      expansebusinessunits: {}
      expansecategory: {}
      expansecertificate: {}
      expansecreated: {}
      expansedomain: {}
      expanseinitialevidence: {}
      expanseip: {}
      expanseissueid: {}
      expanseissuetype: {}
      expanselatestevidence: {}
      expansemodified: {}
      expanseport: {}
      expansepriority: {}
      expanseprogressstatus: {}
      expanseprotocol: {}
      expanseprovider: {}
      expanseshadowit:
        complex:
          accessor: "1"
          root: Analysis of Asset Attribution.Answers
          transformers:
          - args:
              else:
                value:
                  simple: "false"
              equals:
                value:
                  simple: "Yes"
              then:
                value:
                  simple: "true"
            operator: If-Then-Else
      expansetags: {}
      externaladdresses: {}
      filehash: {}
      filename: {}
      filepath: {}
      filesize: {}
      firstname: {}
      firstseen: {}
      givenname: {}
      helloworldid: {}
      helloworldstatus: {}
      helloworldtype: {}
      hostname: {}
      id: {}
      incomingmirrorerror: {}
      infectedhosts: {}
      internaladdresses: {}
      investigationstage: {}
      isolated: {}
      jobcode: {}
      jobfamily: {}
      jobfunction: {}
      labels: {}
      lastmodifiedby: {}
      lastmodifiedon: {}
      lastname: {}
      lastseen: {}
      leadership: {}
      location: {}
      locationregion: {}
      logsource: {}
      macaddress: {}
      maliciousbehavior: {}
      malwarefamily: {}
      malwarename: {}
      manageremailaddress: {}
      managername: {}
      md5: {}
      mobiledevicemodel: {}
      mobilephone: {}
      name: {}
      occurred: {}
      os: {}
      osversion: {}
      outgoingmirrorerror: {}
      owner: {}
      parentprocessid: {}
      personalemail: {}
      phase: {}
      phishingsubtype: {}
      phonenumber: {}
      pid: {}
      policydeleted: {}
      policydescription: {}
      policydetails: {}
      policyid: {}
      policyrecommendation: {}
      policyremediable: {}
      policyseverity: {}
      policytype: {}
      prismacloudid: {}
      prismacloudreason: {}
      prismacloudrules: {}
      prismacloudstatus: {}
      prismacloudtime: {}
      protocol: {}
      protocols: {}
      quarantined: {}
      rating: {}
      region: {}
      regionid: {}
      replacePlaybook: {}
      reporteremailaddress: {}
      resourceapiname: {}
      resourcecloudtype: {}
      resourceid: {}
      resourcename: {}
      resourcetype: {}
      riskrating: {}
      riskscore: {}
      roles: {}
      rrn: {}
      samaccountname: {}
      severity: {}
      sha256: {}
      shadowitaccountowneremail: {}
      shadowitaccountownername: {}
      shadowitbilledtocorp: {}
      shadowitcertificate: {}
      shadowitcloudaccountid: {}
      shadowitcloudaccounttype: {}
      shadowitfqdn: {}
      shadowitip: {}
      shadowitorganizationalunit: {}
      shadowitoucontactemail: {}
      shadowitoucontactname: {}
      shadowitport: {}
      shadowitprovider: {}
      shadowitrisk: {}
      shadowitsactionedservice: {}
      shadowitsource: {}
      shadowusersuggestions: {}
      signature: {}
      skuname: {}
      skutier: {}
      sla: {}
      slaField: {}
      sourcehostname: {}
      sourceip: {}
      sourcenetwork: {}
      sourceport: {}
      sourceusername: {}
      src: {}
      srchostname: {}
      srcntdomain: {}
      srcos: {}
      srcuser: {}
      state: {}
      streetaddress: {}
      subcategory: {}
      subscriptionassignedby: {}
      subscriptioncreatedby: {}
      subscriptioncreatedon: {}
      subscriptiondescription: {}
      subscriptionid: {}
      subscriptionname: {}
      subscriptiontype: {}
      subscriptionupdatedby: {}
      subscriptionupdatedon: {}
      subtype: {}
      surname: {}
      systemdefault: {}
      systems: {}
      targetfirewallversion: {}
      tenantname: {}
      terminatedaction: {}
      threatactor: {}
      ticketcloseddate: {}
      ticketnumber: {}
      ticketopeneddate: {}
      title: {}
      triggeredsecurityprofile: {}
      type: {}
      uniqueports: {}
      urlsslverification: {}
      user: {}
      useraccountcontrol: {}
      username: {}
      vendorid: {}
      vendorproduct: {}
      vpcid: {}
      vulnerabilitycategory: {}
      workphone: {}
      xdralertcount: {}
      xdralerts: {}
      xdrassigneduseremail: {}
      xdrassigneduserprettyname: {}
      xdrdescription: {}
      xdrdetectiontime: {}
      xdrfileartifacts: {}
      xdrhighseverityalertcount: {}
      xdrhostcount: {}
      xdrincidentid: {}
      xdrlowseverityalertcount: {}
      xdrmediumseverityalertcount: {}
      xdrnetworkartifacts: {}
      xdrnotes: {}
      xdrresolvecomment: {}
      xdrstatus: {}
      xdrstatusv2: {}
      xdrurl: {}
      xdrusercount: {}
      zipcode: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 93df1b7c-4fd8-4cf8-89ad-754ad6bf9372
      iscommand: true
      name: Set Shadow IT flag based on User response
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 93df1b7c-4fd8-4cf8-89ad-754ad6bf9372
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 800,
          "y": 3630
        }
      }
  "136":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: "1"
                root: Analysis of Asset Attribution.Answers
          operator: notContainsString
          right:
            value:
              simple: Undecided
      label: "yes"
    id: "136"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "93"
      "yes":
      - "135"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether user answered to the Shadow IT question.
      id: f0357630-f752-4bb9-8182-29c56d2c7fff
      iscommand: false
      name: Did User reply to the Shadow IT question?
      type: condition
      version: -1
    taskid: f0357630-f752-4bb9-8182-29c56d2c7fff
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1030,
          "y": 3370
        }
      }
  "141":
    evidencedata:
      customfields: {}
      description:
        simple: Issue Comments in Expanse
    id: "141"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "170"
    note: true
    quietmode: 0
    scriptarguments:
      created_after: {}
      issue_id:
        complex:
          accessor: expanseissueid
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Retrieve issue comments (subset of updates)
      id: 7b070511-5ae2-43fe-87c4-2a64c9eaf8c1
      iscommand: true
      name: Get Expanse Comments
      script: '|||expanse-get-issue-comments'
      type: regular
      version: -1
    taskid: 7b070511-5ae2-43fe-87c4-2a64c9eaf8c1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1082.5,
          "y": -590
        }
      }
  "151":
    id: "151"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "155"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: ShadowITCondition
      stringify: {}
      value:
        complex:
          accessor: Attribution
          root: PrismaCloud
          transformers:
          - operator: count
          - args:
              else:
                value:
                  simple: '{"condition":"Asset found on Prisma Cloud", "value":true}'
              equals:
                value:
                  simple: "0"
              then:
                value:
                  simple: '{"condition":"Asset found on Prisma Cloud", "value":false}'
            operator: If-Then-Else
          - operator: ParseJSON
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: 89d39bfe-f7dd-4983-845e-eadfa805ed83
      iscommand: false
      name: 'Set Shadow IT Condition variable: On Prisma Cloud?'
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 89d39bfe-f7dd-4983-845e-eadfa805ed83
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 702.5,
          "y": 1730
        }
      }
  "152":
    id: "152"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "155"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: ShadowITCondition
      stringify: {}
      value:
        complex:
          root: UNEXISTINGFIELD
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: '{"condition":"Asset is On Prem with high confidence", "value":true}'
            operator: SetIfEmpty
          - operator: ParseJSON
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: 7dc3a1c9-3389-448a-8e3c-ee241e1b8903
      iscommand: false
      name: 'Set Shadow IT Condition variable: On Prem high confidence to True'
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 7dc3a1c9-3389-448a-8e3c-ee241e1b8903
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1060,
          "y": 1900
        }
      }
  "153":
    id: "153"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "155"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: ShadowITCondition
      stringify: {}
      value:
        complex:
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: Expanse.AttributionDevice.exposing_service
              operator: isEqualString
              right:
                value:
                  simple: "true"
          root: Expanse.AttributionDevice
          transformers:
          - operator: count
          - args:
              else:
                value:
                  simple: '{"condition":"Found Firewall exposing service", "value":true}'
              equals:
                value:
                  simple: "0"
              then:
                value:
                  simple: '{"condition":"Found Firewall exposing service", "value":false}'
            operator: If-Then-Else
          - operator: ParseJSON
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: 2b8df499-de4f-4c96-870c-264147e19fd9
      iscommand: false
      name: 'Set Shadow IT Condition variable: any Firewall exposing service?'
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 2b8df499-de4f-4c96-870c-264147e19fd9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1912.5,
          "y": 1730
        }
      }
  "154":
    id: "154"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "151"
      - "153"
      - "156"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 89c2476e-3242-4267-81c2-b2df310b2cce
      iscommand: false
      name: Set up Shadow IT Condition Variables for report
      type: title
      version: -1
      description: ''
    taskid: 89c2476e-3242-4267-81c2-b2df310b2cce
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1287.5,
          "y": 1540
        }
      }
  "155":
    id: "155"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "59"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b27e5c28-9080-4dc7-8a40-056c7a7ce541
      iscommand: false
      name: Done Setting up Shadow IT Conditions for Report
      type: title
      version: -1
      description: ''
    taskid: b27e5c28-9080-4dc7-8a40-056c7a7ce541
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1287.5,
          "y": 2080
        }
      }
  "156":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expanseprovider
                root: incident
          operator: isEqualString
          right:
            value:
              simple: On Prem
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: ExpanseAllAssetTags
                    operator: inList
                    right:
                      iscontext: true
                      value:
                        simple: IPRangeLowConfidenceTag
                root: ExpanseAllAssetTags
                transformers:
                - operator: count
          operator: isEqualNumber
          right:
            value:
              simple: "0"
      label: "yes"
    id: "156"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "157"
      "yes":
      - "152"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether the asset is market as on prem with a high degree
        of confidence.
      id: c4d2e9d2-d53b-4940-81f2-19b341f47032
      iscommand: false
      name: On-prem with high confidence?
      type: condition
      version: -1
    taskid: c4d2e9d2-d53b-4940-81f2-19b341f47032
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1287.5,
          "y": 1720
        }
      }
  "157":
    id: "157"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "155"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: ShadowITCondition
      stringify: {}
      value:
        complex:
          root: UNEXISTINGFIELD
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: '{"condition":"Asset is On Prem with high confidence", "value":false}'
            operator: SetIfEmpty
          - operator: ParseJSON
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: a24f6b30-3e06-438a-89dd-6f5b229a0ad8
      iscommand: false
      name: 'Set Shadow IT Condition variable: On Prem high confidence to False'
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: a24f6b30-3e06-438a-89dd-6f5b229a0ad8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1507.5,
          "y": 1900
        }
      }
  "158":
    evidencedata:
      customfields: {}
      description:
        simple: Expanse Enrichment Information
    id: "158"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "63"
    note: true
    quietmode: 0
    scriptarguments:
      expanseassettags:
        complex:
          root: ExpanseAllAssetTags
      expansebusinessunits:
        complex:
          accessor: expansebusinessunits
          root: incident
      expansedevices:
        complex:
          accessor: AttributionDevice
          root: Expanse
      expanseips:
        complex:
          accessor: AttributionIP
          root: Expanse
      expanseissuetags:
        complex:
          accessor: expansetags
          root: incident
      expansetags:
        complex:
          root: ExpanseXSOAROUTags
      expanseusers:
        complex:
          accessor: AttributionUser
          root: Expanse
      fqdn:
        complex:
          accessor: expansedomain
          root: incident
      ip:
        complex:
          accessor: expanseip
          root: incident
      port:
        complex:
          accessor: expanseport
          root: incident
      prismacloudassets:
        complex:
          accessor: Attribution
          root: PrismaCloud
      provider:
        complex:
          accessor: expanseprovider
          root: incident
      region:
        complex:
          accessor: expanseregion
          root: incident
      service:
        complex:
          accessor: expanseservice
          root: incident
      shadowit:
        complex:
          root: ShadowITCondition
      shadowitreasons: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: 'Print '
      id: c4613a67-9393-4520-8686-0a1308629ec1
      iscommand: false
      name: Generate Report for Attribution
      script: ExpansePrintSuggestions
      type: regular
      version: -1
    taskid: c4613a67-9393-4520-8686-0a1308629ec1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1287.5,
          "y": 2640
        }
      }
  "159":
    id: "159"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      append: {}
      key:
        simple: ExpanseXSOAROUIssueTags
      stringify: {}
      value:
        complex:
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: ExpanseXSOARIssueTags
              operator: StringContainsArray
              right:
                value:
                  simple: -ou-
          root: ExpanseXSOARIssueTags
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: f101bfd6-a312-4518-8276-443422836c70
      iscommand: false
      name: 'Extract XSOAR Incident Tags related to OU Attribtion '
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: f101bfd6-a312-4518-8276-443422836c70
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 907.5,
          "y": -1130
        }
      }
  "161":
    id: "161"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "162"
    note: false
    quietmode: 0
    scriptarguments:
      issue_id:
        complex:
          accessor: expanseissueid
          root: incident
      update_type:
        simple: ProgressStatus
      value:
        simple: Investigating
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Update Expanse issue.
      id: 7cd3427f-0d74-4cca-8dc3-48a65dd8341a
      iscommand: true
      name: Set Progress Status to Investigating in Expanse issue
      script: '|||expanse-update-issue'
      type: regular
      version: -1
    taskid: 7cd3427f-0d74-4cca-8dc3-48a65dd8341a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1707.5,
          "y": -1880
        }
      }
  "162":
    id: "162"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      issue_id:
        complex:
          accessor: expanseissueid
          root: incident
      update_type:
        simple: Comment
      value:
        simple: This Issue is being investigated by the SOC through Cortex XSOAR
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Update Expanse issue.
      id: e2ac22f0-db7d-4365-824b-75fe20c526d4
      iscommand: true
      name: Add "Being investigated by XSOAR" comment to Expanse issue
      script: '|||expanse-update-issue'
      type: regular
      version: -1
    taskid: e2ac22f0-db7d-4365-824b-75fe20c526d4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1707.5,
          "y": -1710
        }
      }
  "163":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: WriteToExpanse
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    id: "163"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "161"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determine whether playbook should write data back to Expanse.
      id: f5eae4df-921c-4c22-809d-508ca19ac15d
      iscommand: false
      name: Are we writing to Expanse?
      type: condition
      version: -1
    taskid: f5eae4df-921c-4c22-809d-508ca19ac15d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1440,
          "y": -2080
        }
      }
  "164":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: WriteToExpanse
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    id: "164"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "165"
      "yes":
      - "96"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determine whether playbook should write data back to Expanse.
      id: 2bf47888-5e95-4252-8322-a3c4c6b36738
      iscommand: false
      name: Are we writing to Expanse?
      type: condition
      version: -1
    taskid: 2bf47888-5e95-4252-8322-a3c4c6b36738
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1260,
          "y": 4440
        }
      }
  "165":
    id: "165"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "30"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 68d2cf6d-6bb8-4047-8c11-05560d669f8d
      iscommand: false
      name: Done Tagging
      type: title
      version: -1
      description: ''
    taskid: 68d2cf6d-6bb8-4047-8c11-05560d669f8d
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1260,
          "y": 5460
        }
      }
  "166":
    id: "166"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "75"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Perform manual remediation
      id: fee13f3f-acc0-4f0b-842a-6a1061eba3ae
      iscommand: false
      name: Manual Remediation
      type: regular
      version: -1
    taskid: fee13f3f-acc0-4f0b-842a-6a1061eba3ae
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1247.5,
          "y": 5875
        }
      }
  "169":
    id: "169"
    ignoreworker: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "170"
    note: false
    quietmode: 0
    scriptarguments:
      Create Indicators:
        simple: "true"
      Expanse Assets:
        complex:
          accessor: expanseasset
          root: incident
      Expanse IP:
        complex:
          accessor: expanseip
          root: incident
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: Extracts and Enriches Expanse from Indicator Assets
      id: dbaea010-4ef0-4c97-8752-463ff217ae24
      iscommand: false
      name: Extract Expanse Indicators
      playbookId: Extract Expanse Indicators
      type: playbook
      version: -1
    taskid: dbaea010-4ef0-4c97-8752-463ff217ae24
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1720,
          "y": -580
        }
      }
  "170":
    id: "170"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e7cc28cd-190e-4289-8dc5-1f212772018f
      iscommand: false
      name: Done Enrichment
      type: title
      version: -1
      description: ''
    taskid: e7cc28cd-190e-4289-8dc5-1f212772018f
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1440,
          "y": -250
        }
      }
  "171":
    id: "171"
    ignoreworker: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "62"
    note: false
    quietmode: 0
    scriptarguments:
      AWSIndicatorTags:
        simple: AWS
      AzureIndicatorTags:
        simple: Azure
      FQDN:
        complex:
          accessor: expansedomain
          root: incident
      GCPIndicatorTags:
        simple: GCP
      IP:
        complex:
          accessor: expanseip
          root: incident
      Provider:
        complex:
          accessor: expanseprovider
          root: incident
      Update Incident:
        simple: "True"
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: 4e3e5bd2-a4e7-4bf9-8458-63d2f9a96bbb
      iscommand: false
      name: Find Cloud IP Address Region and Service
      playbookId: Find Cloud IP Address Region and Service
      type: playbook
      version: -1
      description: ''
    taskid: 4e3e5bd2-a4e7-4bf9-8458-63d2f9a96bbb
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1912.5,
          "y": 325
        }
      }
  "172":
    id: "172"
    ignoreworker: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "75"
    note: false
    quietmode: 0
    scriptarguments:
      Link Incidents:
        simple: "True"
      Prisma Cloud Attribution:
        complex:
          accessor: Attribution
          root: PrismaCloud
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: 287ae395-dcae-4ce7-85d9-1686a72ab7fb
      iscommand: false
      name: Prisma Cloud Correlate Alerts
      playbookId: Prisma Cloud Correlate Alerts
      type: playbook
      version: -1
      description: ''
    taskid: 287ae395-dcae-4ce7-85d9-1686a72ab7fb
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 740,
          "y": 5875
        }
      }
  "173":
    id: "173"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |
        Script to refresh tags and attribution reasons of assets inside Expanse Issue. The script should be used inside the Expanse Issue incident context.
      id: 5792bfc9-b571-49c2-8203-410fc70deedf
      iscommand: false
      name: Refresh Assets
      script: ExpanseRefreshIssueAssets
      type: regular
      version: -1
    taskid: 5792bfc9-b571-49c2-8203-410fc70deedf
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 907.5,
          "y": -1480
        }
      }
  "174":
    id: "174"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "165"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |
        Script to refresh tags and attribution reasons of assets inside Expanse Issue. The script should be used inside the Expanse Issue incident context.
      id: feca7621-4c41-491c-88e3-b3c7f97a1b2f
      iscommand: false
      name: Refresh Assets
      script: ExpanseRefreshIssueAssets
      type: regular
      version: -1
    taskid: feca7621-4c41-491c-88e3-b3c7f97a1b2f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1862.5,
          "y": 5380
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 9385,
        "width": 1840,
        "x": 627.5,
        "y": -2230
      }
    }
  }
fromversion: 6.0.0
tests:
- No tests (auto formatted)
