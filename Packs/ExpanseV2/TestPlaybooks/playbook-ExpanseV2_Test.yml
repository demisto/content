description: Test Playbook for Expanse V2
id: ExpanseV2 Test
name: ExpanseV2 Test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: db6599b1-3e59-46e4-8677-eed02abeff0d
    type: start
    task:
      id: db6599b1-3e59-46e4-8677-eed02abeff0d
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 497de4b0-e0da-4318-8439-d739e1699210
    type: regular
    task:
      id: 497de4b0-e0da-4318-8439-d739e1699210
      version: -1
      name: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: 68f6db58-20e0-46ef-8067-ee9a07f6e46d
    type: regular
    task:
      id: 68f6db58-20e0-46ef-8067-ee9a07f6e46d
      version: -1
      name: expanse-get-issues
      script: '|||expanse-get-issues'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      limit:
        simple: "1"
      provider:
        simple: Amazon Web Services
      sort:
        simple: -created
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: d78de052-e7c8-40e8-888a-77d34443407b
    type: condition
    task:
      id: d78de052-e7c8-40e8-888a-77d34443407b
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "49"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.activityStatus
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.assets.[0].assetKey
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.assets.[0].assetType
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.assets.[0].displayName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.assets.[0].id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.assigneeUsername
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.businessUnits.[0].id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.businessUnits.[0].name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.created
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.headline
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.helpText
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.initialEvidence
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.ip
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.issueType.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.issueType.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.latestEvidence
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.modified
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.portNumber
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.portProtocol
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.priority
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.progressStatus
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.providers.[0].id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.providers.[0].name
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 25701241-e243-4934-805c-294fe0215f70
    type: regular
    task:
      id: 25701241-e243-4934-805c-294fe0215f70
      version: -1
      name: expanse-get-issue-updates
      script: '|||expanse-get-issue-updates'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      created_after:
        complex:
          root: ExpanseCreationTime
      issue_id:
        complex:
          root: ExpanseIssueID
      limit:
        simple: "10"
      update_types:
        simple: Comment,ProgressStatus
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 10890976-fb37-4401-8ed6-2c2c5c8b0f30
    type: condition
    task:
      id: 10890976-fb37-4401-8ed6-2c2c5c8b0f30
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "6"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IssueUpdate.created
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IssueUpdate.id
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Expanse.IssueUpdate.issueId
            iscontext: true
          right:
            value:
              complex:
                root: ExpanseIssueID
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Expanse.IssueUpdate.updateType
            iscontext: true
          right:
            value:
              simple: ProgressStatus
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IssueUpdate.user.username
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Expanse.IssueUpdate.value
            iscontext: true
          right:
            value:
              simple: InProgress
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 48829e36-7f52-4f6b-8c6c-ce56ea3d1e18
    type: regular
    task:
      id: 48829e36-7f52-4f6b-8c6c-ce56ea3d1e18
      version: -1
      name: expanse-get-issue-comments
      script: '|||expanse-get-issue-comments'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      created_after:
        complex:
          root: ExpanseCreationTime
      issue_id:
        complex:
          root: ExpanseIssueID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: f2a30765-c178-4fd7-8040-435e8ec81e80
    type: condition
    task:
      id: f2a30765-c178-4fd7-8040-435e8ec81e80
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "52"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IssueComment.created
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IssueComment.id
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Expanse.IssueComment.issueId
            iscontext: true
          right:
            value:
              complex:
                root: ExpanseIssueID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IssueComment.updateType
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Expanse.IssueComment.value
            iscontext: true
          right:
            value:
              simple: XSOAR Test Playbook Comment
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: b1270498-0ff5-4160-8a79-255e9f8b1352
    type: regular
    task:
      id: b1270498-0ff5-4160-8a79-255e9f8b1352
      version: -1
      name: expanse-update-issue (Add Comment)
      script: '|||expanse-update-issue'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      issue_id:
        complex:
          root: ExpanseIssueID
      update_type:
        simple: Comment
      value:
        simple: XSOAR Test Playbook Comment
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: 4ffa9aa3-927e-4928-835d-ff2eeb72abdb
    type: condition
    task:
      id: 4ffa9aa3-927e-4928-835d-ff2eeb72abdb
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "50"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IssueUpdate.created
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IssueUpdate.id
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Expanse.IssueUpdate.issueId
            iscontext: true
          right:
            value:
              complex:
                root: ExpanseIssueID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IssueUpdate.updateType
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IssueUpdate.user.username
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IssueUpdate.value
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: bb542a09-bd34-4dce-849e-d5f908acdfe3
    type: regular
    task:
      id: bb542a09-bd34-4dce-849e-d5f908acdfe3
      version: -1
      name: expanse-get-issue
      script: '|||expanse-get-issue'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      issue_id:
        complex:
          root: ExpanseIssueID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: a6c96a34-71f4-4caf-8bf9-7355133e297c
    type: condition
    task:
      id: a6c96a34-71f4-4caf-8bf9-7355133e297c
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "53"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.activityStatus
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.assets.[0].assetKey
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.assets.[0].assetType
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.assets.[0].displayName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.assets.[0].id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.assigneeUsername
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.businessUnits.[0].id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.businessUnits.[0].name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.created
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.headline
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.helpText
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Expanse.Issue.id
            iscontext: true
          right:
            value:
              complex:
                root: ExpanseIssueID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.initialEvidence
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.ip
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.issueType.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.issueType.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.latestEvidence
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.modified
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.portNumber
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.portProtocol
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.priority
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Expanse.Issue.progressStatus
            iscontext: true
          right:
            value:
              simple: InProgress
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.providers.[0].id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.providers.[0].name
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: 3c1ae7dd-7eea-4c57-8c3b-8b927471de80
    type: regular
    task:
      id: 3c1ae7dd-7eea-4c57-8c3b-8b927471de80
      version: -1
      name: expanse-list-businessunits
      script: '|||expanse-list-businessunits'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      limit:
        simple: "5"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: ebd9759e-6b6a-413e-8076-d591f53ceb6b
    type: condition
    task:
      id: ebd9759e-6b6a-413e-8076-d591f53ceb6b
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "14"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.BusinessUnit.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.BusinessUnit.name
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 9d198ee1-062a-4a1a-8ffa-04991955ee28
    type: regular
    task:
      id: 9d198ee1-062a-4a1a-8ffa-04991955ee28
      version: -1
      name: expanse-list-providers
      script: '|||expanse-list-providers'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      limit:
        simple: "5"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3695
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 340de361-45d9-4630-8a79-79ee82ba232b
    type: condition
    task:
      id: 340de361-45d9-4630-8a79-79ee82ba232b
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "26"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Provider.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Provider.name
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: 365ad6a5-c6b6-4f78-8a2c-50212c8dcb85
    type: regular
    task:
      id: 365ad6a5-c6b6-4f78-8a2c-50212c8dcb85
      version: -1
      name: expanse-list-tags
      script: '|||expanse-list-tags'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      limit:
        simple: "100"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: 1fd09ec1-5ef4-41b5-877a-566d39564e4f
    type: condition
    task:
      id: 1fd09ec1-5ef4-41b5-877a-566d39564e4f
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "28"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Tag.[0].created
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Tag.[0].id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Tag.[0].modified
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Tag.[0].name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Tag.[0].tenantId
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4395
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: 07987d4d-9ba8-4905-82e6-00e7558b0516
    type: regular
    task:
      id: 07987d4d-9ba8-4905-82e6-00e7558b0516
      version: -1
      name: expanse-assign-tags-to-asset
      script: '|||expanse-assign-tags-to-asset'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      asset_id:
        complex:
          root: ExpanseIPRangeID
      asset_type:
        simple: IpRange
      tags:
        complex:
          root: Expanse.Tag
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: Expanse.Tag.name
                iscontext: true
              right:
                value:
                  simple: tagcreatedbyxsoar
          accessor: id
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6145
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: 2a0ec089-c530-471a-892e-ec5f9bf1275d
    type: regular
    task:
      id: 2a0ec089-c530-471a-892e-ec5f9bf1275d
      version: -1
      name: expanse-unassign-tags-from-asset
      script: '|||expanse-unassign-tags-from-asset'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      asset_id:
        complex:
          root: ExpanseIPRangeID
      asset_type:
        simple: IpRange
      tags:
        complex:
          root: Expanse.Tag
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: Expanse.Tag.name
                iscontext: true
              right:
                value:
                  simple: tagcreatedbyxsoar
          accessor: id
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: b2972a38-4976-47e6-84a4-e4bc075561b4
    type: regular
    task:
      id: b2972a38-4976-47e6-84a4-e4bc075561b4
      version: -1
      name: expanse-assign-tags-to-iprange
      script: '|||expanse-assign-tags-to-iprange'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "46"
    scriptarguments:
      asset_id:
        complex:
          root: ExpanseIPRangeID
      tag_names:
        simple: xsoar-test-pb-tag
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: c9da69b1-0b5c-4385-879a-2450505c27a0
    type: regular
    task:
      id: c9da69b1-0b5c-4385-879a-2450505c27a0
      version: -1
      name: expanse-unassign-tags-from-iprange
      script: '|||expanse-unassign-tags-from-iprange'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      asset_id:
        complex:
          root: ExpanseIPRangeID
      tag_names:
        simple: tagcreatedbyxsoar
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: c42f274f-d9cf-47b2-86d3-df132f7a97c6
    type: regular
    task:
      id: c42f274f-d9cf-47b2-86d3-df132f7a97c6
      version: -1
      name: expanse-assign-tags-to-certificate
      script: '|||expanse-assign-tags-to-certificate'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      asset_id:
        complex:
          root: ExpanseCertificateID
      tag_names:
        simple: xsoar-test-pb-tag
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: 5f80ee7a-8bea-4c5a-8b93-c16bde05453a
    type: regular
    task:
      id: 5f80ee7a-8bea-4c5a-8b93-c16bde05453a
      version: -1
      name: expanse-unassign-tags-from-certificate
      script: '|||expanse-unassign-tags-from-certificate'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      asset_id:
        complex:
          root: ExpanseCertificateID
      tag_names:
        simple: xsoar-test-pb-tag
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: a761ed62-9834-418c-8bc5-fb98bbe8011e
    type: regular
    task:
      id: a761ed62-9834-418c-8bc5-fb98bbe8011e
      version: -1
      name: expanse-assign-tags-to-domain
      script: '|||expanse-assign-tags-to-domain'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "42"
    scriptarguments:
      asset_id:
        complex:
          root: ExpanseDomainID
      tag_names:
        simple: xsoar-test-pb-tag
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "25":
    id: "25"
    taskid: a8d74fc8-1ef0-4241-887a-8232e6f7bb9e
    type: regular
    task:
      id: a8d74fc8-1ef0-4241-887a-8232e6f7bb9e
      version: -1
      name: expanse-unassign-tags-from-domain
      script: '|||expanse-unassign-tags-from-domain'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "66"
    scriptarguments:
      asset_id:
        complex:
          root: ExpanseDomainID
      tag_names:
        simple: xsoar-test-pb-tag
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: 58c364f9-15b5-421c-81c7-ba086ca15536
    type: regular
    task:
      id: 58c364f9-15b5-421c-81c7-ba086ca15536
      version: -1
      name: expanse-create-tag
      script: '|||expanse-create-tag'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      description:
        simple: XSOAR Test Playbook Tag
      name:
        simple: xsoar-test-pb-tag
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4045
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: f5b767d6-e6c3-4674-8385-095cd4b1de00
    type: regular
    task:
      id: f5b767d6-e6c3-4674-8385-095cd4b1de00
      version: -1
      name: expanse-get-iprange
      script: '|||expanse-get-iprange'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: 30275d96-e1c4-4a6c-8d0a-f4bd6a631d63
    type: condition
    task:
      id: 30275d96-e1c4-4a6c-8d0a-f4bd6a631d63
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "54"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.businessUnits.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.businessUnits.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.cidr
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.created
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.ipVersion
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.modified
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.rangeIntroduced
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.rangeSize
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.rangeType
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.responsiveIpCount
            iscontext: true
      - - operator: isEqualNumber
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "0"
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Vendor
            iscontext: true
          right:
            value:
              simple: ExpanseV2
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Type
            iscontext: true
          right:
            value:
              simple: cidr
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4745
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: fbf6874a-3eed-4c6d-8144-47460aec16c9
    type: regular
    task:
      id: fbf6874a-3eed-4c6d-8144-47460aec16c9
      version: -1
      name: expanse-get-domain
      script: '|||expanse-get-domain'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: 1e9a6a83-591f-434d-8260-28e32dc04442
    type: condition
    task:
      id: 1e9a6a83-591f-434d-8260-28e32dc04442
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "61"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.businessUnits.[0].id
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.businessUnits.[0].name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.businessUnits.[0].tenantId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.dateAdded
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.dnsResolutionStatus
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.domain
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.providers.[0].id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.providers.[0].name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.serviceStatus
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.sourceDomain
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.tenant.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.tenant.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.tenant.tenantId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.whois
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.Name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.CreationDate
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.ExpirationDate
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.NameServers
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
      - - operator: inList
          left:
            value:
              simple: DBotScore.[1].Type
            iscontext: true
          right:
            value:
              simple: domain,domainglob
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.[1].Vendor
            iscontext: true
          right:
            value:
              simple: ExpanseV2
      - - operator: isEqualNumber
          left:
            value:
              simple: DBotScore.[1].Score
            iscontext: true
          right:
            value:
              simple: "0"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: 927087f1-5d9d-4873-8c7f-6d4e7b6ecb14
    type: regular
    task:
      id: 927087f1-5d9d-4873-8c7f-6d4e7b6ecb14
      version: -1
      name: expanse-get-certificate
      script: '|||expanse-get-certificate'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "35"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6495
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: f7af4ee8-9dfa-4a4d-80ce-e7b07c757f01
    type: condition
    task:
      id: f7af4ee8-9dfa-4a4d-80ce-e7b07c757f01
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "57"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.businessUnits.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.businessUnits.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.businessUnits.tenantId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.issuer
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.md5Hash
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.pemSha1
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.pemSha256
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.publicKey
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.publicKeyAlgorithm
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.publicKeyBits
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.publicKeySpki
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.serialNumber
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.signatureAlgorithm
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.subject
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.validNotAfter
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.validNotBefore
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.version
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificateAdvertisementStatus
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.commonName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.dateAdded
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.properties
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.providers.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.providers.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.serviceStatus
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.tenant.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.tenant.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.tenant.tenantId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.Name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.SubjectDN
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.IssuerDN
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.SerialNumber
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.ValidityNotAfter
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.ValidityNotBefore
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.SHA256
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.SHA1
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.MD5
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.PublicKey.Algorithm
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.PublicKey.Length
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.SPKISHA256
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.Signature.Algorithm
            iscontext: true
      - - operator: isEqualNumber
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "0"
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Vendor
            iscontext: true
          right:
            value:
              simple: ExpanseV2
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Type
            iscontext: true
          right:
            value:
              simple: certificate
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: 8adf1099-4187-46c2-8488-88bd21b339e3
    type: regular
    task:
      id: 8adf1099-4187-46c2-8488-88bd21b339e3
      version: -1
      name: certificate
      script: '|||certificate'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "37"
    scriptarguments:
      certificate:
        complex:
          root: ExpanseCertificateMD5
      set_expanse_fields:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: 3c6c6a4f-f468-4e23-80c3-a7cfcc84ae13
    type: condition
    task:
      id: 3c6c6a4f-f468-4e23-80c3-a7cfcc84ae13
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "23"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.businessUnits.[0].id
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.businessUnits.[0].name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.businessUnits.[0].tenantId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.issuer
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.md5Hash
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.pemSha1
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.pemSha256
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.publicKey
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.publicKeyAlgorithm
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.publicKeyBits
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.publicKeySpki
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.serialNumber
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.signatureAlgorithm
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.subject
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.validNotAfter
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.validNotBefore
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.version
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificateAdvertisementStatus.[0]
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.commonName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.dateAdded
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Expanse.Certificate.id
            iscontext: true
          right:
            value:
              complex:
                root: ExpanseCertificateID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.properties
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.providers.[0].id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.providers.[0].name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.serviceStatus
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.tenant.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.tenant.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.tenant.tenantId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.Name.[0]
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.SubjectDN
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.IssuerDN
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.SerialNumber
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.ValidityNotAfter
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.ValidityNotBefore
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.SHA256
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.SHA1
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Certificate.MD5
            iscontext: true
          right:
            value:
              complex:
                root: ExpanseCertificateMD5
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.PublicKey.Algorithm
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.PublicKey.Length
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.SPKISHA256
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.Signature.Algorithm
            iscontext: true
      - - operator: isEqualNumber
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "0"
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Vendor
            iscontext: true
          right:
            value:
              simple: ExpanseV2
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
          right:
            value:
              complex:
                root: ExpanseCertificateSHA256
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Type
            iscontext: true
          right:
            value:
              simple: certificate
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: e19c1fd0-99a5-427a-8deb-e4c2079e8cbb
    type: regular
    task:
      id: e19c1fd0-99a5-427a-8deb-e4c2079e8cbb
      version: -1
      name: domain
      script: ExpanseV2|||domain
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "43"
    scriptarguments:
      domain:
        complex:
          root: ExpanseDomainName
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: 8e223c80-a248-4a7d-810a-bf6729310e8f
    type: condition
    task:
      id: 8e223c80-a248-4a7d-810a-bf6729310e8f
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "25"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.businessUnits.[0].id
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.businessUnits.[0].name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.businessUnits.[0].tenantId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.dateAdded
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.dnsResolutionStatus
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Expanse.Domain.domain
            iscontext: true
          right:
            value:
              complex:
                root: ExpanseDomainName
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Expanse.Domain.id
            iscontext: true
          right:
            value:
              complex:
                root: ExpanseDomainID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.providers.[0].id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.providers.[0].name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.serviceStatus
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.sourceDomain
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.tenant.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.tenant.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.tenant.tenantId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.whois
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Domain.Name
            iscontext: true
          right:
            value:
              complex:
                root: ExpanseDomainName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.CreationDate
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.ExpirationDate
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.NameServers
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
          right:
            value:
              complex:
                root: ExpanseDomainName
            iscontext: true
      - - operator: inList
          left:
            value:
              simple: DBotScore.Type
            iscontext: true
          right:
            value:
              simple: domain,domainglob
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Vendor
            iscontext: true
          right:
            value:
              simple: ExpanseV2
      - - operator: isEqualNumber
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "0"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: 4ec6cdce-b0b3-431f-8fec-f7dbe502f720
    type: regular
    task:
      id: 4ec6cdce-b0b3-431f-8fec-f7dbe502f720
      version: -1
      name: cidr
      script: '|||cidr'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "47"
    scriptarguments:
      cidr:
        complex:
          root: ExpanseIPRangeCIDR
      include:
        simple: severityCounts,annotations
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: 2708ec5f-ad7d-41f7-8a0f-a475f497dd45
    type: condition
    task:
      id: 2708ec5f-ad7d-41f7-8a0f-a475f497dd45
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "21"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.businessUnits.[0].id
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.businessUnits.[0].name
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Expanse.IPRange.cidr
            iscontext: true
          right:
            value:
              complex:
                root: ExpanseIPRangeCIDR
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.created
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.ipVersion
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.modified
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.rangeIntroduced
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.rangeSize
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.rangeType
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.responsiveIpCount
            iscontext: true
      - - operator: isEqualNumber
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "0"
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Vendor
            iscontext: true
          right:
            value:
              simple: ExpanseV2
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
          right:
            value:
              complex:
                root: ExpanseIPRangeCIDR
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Type.[0]
            iscontext: true
          right:
            value:
              simple: cidr
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5795
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: b2eaa140-497a-4862-89e1-c6425c99055d
    type: title
    task:
      id: b2eaa140-497a-4862-89e1-c6425c99055d
      version: -1
      name: Test Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 10345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: 6e347e22-01b6-4e02-834b-a814b593eb74
    type: regular
    task:
      id: 6e347e22-01b6-4e02-834b-a814b593eb74
      version: -1
      name: Save Expanse Issue Id to Context
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "65"
    scriptarguments:
      key:
        simple: ExpanseIssueID
      value:
        complex:
          root: Expanse.Issue
          accessor: id
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: 3581841b-b683-4b1c-8f13-af514ac91921
    type: regular
    task:
      id: 3581841b-b683-4b1c-8f13-af514ac91921
      version: -1
      name: expanse-update-issue (Change Progress Status)
      script: '|||expanse-update-issue'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      issue_id:
        complex:
          root: ExpanseIssueID
      update_type:
        simple: ProgressStatus
      value:
        simple: InProgress
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: 42a3c359-839e-4ad8-8d0d-094d1ca4f5f7
    type: regular
    task:
      id: 42a3c359-839e-4ad8-8d0d-094d1ca4f5f7
      version: -1
      name: Save Expanse Issue Progress Status to Context
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      key:
        simple: ExpanseIssueProgressStatus
      value:
        complex:
          root: Expanse.Issue
          accessor: progressStatus
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "52":
    id: "52"
    taskid: 40f9a7d2-2caa-46d7-8301-f24616746651
    type: regular
    task:
      id: 40f9a7d2-2caa-46d7-8301-f24616746651
      version: -1
      name: Delete Expanse Issue From Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: Expanse.Issue
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: ea43c7ea-8cdc-4bd8-8652-f2c5a25b844f
    type: regular
    task:
      id: ea43c7ea-8cdc-4bd8-8652-f2c5a25b844f
      version: -1
      name: expanse-update-issue (Reset Progress Status to Original Value)
      script: '|||expanse-update-issue'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      issue_id:
        complex:
          root: ExpanseIssueID
      update_type:
        simple: ProgressStatus
      value:
        complex:
          root: ExpanseIssueProgressStatus
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "54":
    id: "54"
    taskid: 6b805eff-fdc6-4e56-8a97-1bd2a800dff4
    type: regular
    task:
      id: 6b805eff-fdc6-4e56-8a97-1bd2a800dff4
      version: -1
      name: Save Expanse IP Range ID
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "56"
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: ExpanseIPRangeID
      value:
        complex:
          root: Expanse.IPRange
          accessor: id
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "55":
    id: "55"
    taskid: fd8c8d3f-dd6b-40d6-8d6d-1aaee7e046cc
    type: regular
    task:
      id: fd8c8d3f-dd6b-40d6-8d6d-1aaee7e046cc
      version: -1
      name: Delete Context (Except things to keep)
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: ExpanseIPRangeID,ExpanseIPRangeCIDR,Expanse.Tag,ExpanseIssueIP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "56":
    id: "56"
    taskid: de31cbc9-6020-4230-858c-3fd9880570b9
    type: regular
    task:
      id: de31cbc9-6020-4230-858c-3fd9880570b9
      version: -1
      name: Save Expanse IP Range CIDR
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "55"
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: ExpanseIPRangeCIDR
      value:
        complex:
          root: Expanse.IPRange
          accessor: cidr
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5095
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "57":
    id: "57"
    taskid: c7b91458-049c-4add-8734-a177422d36d4
    type: regular
    task:
      id: c7b91458-049c-4add-8734-a177422d36d4
      version: -1
      name: Save Expanse Certificate ID
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "58"
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: ExpanseCertificateID
      value:
        complex:
          root: Expanse.Certificate
          accessor: id
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6845
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "58":
    id: "58"
    taskid: 4d115c3d-91a6-4c74-80f3-8e26b186c7de
    type: regular
    task:
      id: 4d115c3d-91a6-4c74-80f3-8e26b186c7de
      version: -1
      name: Save Expanse Certificate MD5
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "60"
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: ExpanseCertificateMD5
      value:
        complex:
          root: Certificate
          accessor: MD5
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7020
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "59":
    id: "59"
    taskid: 3b3fef80-faf9-4884-8853-7f190ba54159
    type: regular
    task:
      id: 3b3fef80-faf9-4884-8853-7f190ba54159
      version: -1
      name: Delete Context (Except things to keep)
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: ExpanseCertificateID,ExpanseCertificateMD5,ExpanseCertificateSHA256,ExpanseIssueIP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: e5e3039f-e381-40c5-8d5f-963af0ec620e
    type: regular
    task:
      id: e5e3039f-e381-40c5-8d5f-963af0ec620e
      version: -1
      name: Save Expanse Certificate SHA256
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "59"
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: ExpanseCertificateSHA256
      value:
        complex:
          root: Certificate
          accessor: SHA256
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    id: "61"
    taskid: 5f4e8908-edf5-4278-8b33-ea3343c1fb33
    type: regular
    task:
      id: 5f4e8908-edf5-4278-8b33-ea3343c1fb33
      version: -1
      name: Save Expanse Domain ID
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "62"
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: ExpanseDomainID
      value:
        complex:
          root: Expanse.Domain
          accessor: id
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "62":
    id: "62"
    taskid: 7fa07b01-6003-4adb-80e9-8e34b76b2156
    type: regular
    task:
      id: 7fa07b01-6003-4adb-80e9-8e34b76b2156
      version: -1
      name: Save Expanse Domain Name
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "63"
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: ExpanseDomainName
      value:
        complex:
          root: Domain
          accessor: Name
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: 1994804e-9afe-494c-80a4-71082cf41993
    type: regular
    task:
      id: 1994804e-9afe-494c-80a4-71082cf41993
      version: -1
      name: Delete Context (Except things to keep)
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "24"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: ExpanseDomainID,ExpanseDomainName,ExpanseIssueIP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "64":
    id: "64"
    taskid: 62e59a9c-9120-4f77-8a36-ef08aa2c692d
    type: regular
    task:
      id: 62e59a9c-9120-4f77-8a36-ef08aa2c692d
      version: -1
      name: Save Expanse Issue IP to Context
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "51"
    scriptarguments:
      key:
        simple: ExpanseIssueIP
      value:
        complex:
          root: Expanse.Issue
          accessor: ip
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "65":
    id: "65"
    taskid: df64b11d-a57f-4b38-8ba8-627bc7ecf08b
    type: regular
    task:
      id: df64b11d-a57f-4b38-8ba8-627bc7ecf08b
      version: -1
      name: Save Expanse Creation Time To Context
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "64"
    scriptarguments:
      key:
        simple: ExpanseCreationTime
      value:
        complex:
          root: Expanse.Issue
          accessor: created
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "66":
    id: "66"
    taskid: 86302047-41f8-4f2e-8c36-e0c62830eca8
    type: regular
    task:
      id: 86302047-41f8-4f2e-8c36-e0c62830eca8
      version: -1
      name: expanse-get-domains-for-certificate
      description: Returns all domains which have been seen with the specified certificate.
      script: '|||expanse-get-domains-for-certificate'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "67"
    scriptarguments:
      common_name:
        simple: ${inputs.common_name}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "67":
    id: "67"
    taskid: be7d7607-6614-49f7-85b6-2c3c4d46d7a0
    type: regular
    task:
      id: be7d7607-6614-49f7-85b6-2c3c4d46d7a0
      version: -1
      name: expanse-get-cloud-resources
      description: Retrieve cloud resources from Expanse.
      script: ExpanseV2|||expanse-get-cloud-resources
      type: regular
      iscommand: true
      brand: ExpanseV2
    nexttasks:
      '#none#':
      - "68"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "68":
    id: "68"
    taskid: 468baed7-35f8-4f1a-89d4-0d66d00488ae
    type: condition
    task:
      id: 468baed7-35f8-4f1a-89d4-0d66d00488ae
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "48"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.CloudResource
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 10170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
system: true
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 10360,
        "width": 380,
        "x": 50,
        "y": 50
      }
    }
  }
inputs:
- key: ip
  value:
    simple: 12.2.248.97
  required: false
  description: 'IP address '
  playbookInputQuery: null
- key: common_name
  value:
    simple: api-dev.radioshack.com
  required: false
  description: A partial certificate common name
  playbookInputQuery: null
outputs: []
fromversion: 6.0.0
