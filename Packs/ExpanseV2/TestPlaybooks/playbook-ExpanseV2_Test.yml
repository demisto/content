id: ExpanseV2 Test
version: 5
vcShouldKeepItemLegacyProdMachine: false
name: ExpanseV2 Test
description: Test Playbook for Expanse V2
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 915ae09a-1625-4e32-8ce8-6adeaa50d91b
    type: start
    task:
      id: 915ae09a-1625-4e32-8ce8-6adeaa50d91b
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 16ee7b46-1498-4b51-8842-e7c736cc37b1
    type: regular
    task:
      id: 16ee7b46-1498-4b51-8842-e7c736cc37b1
      version: -1
      name: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: b2832f08-de6d-4eab-823c-330536fed4fc
    type: regular
    task:
      id: b2832f08-de6d-4eab-823c-330536fed4fc
      version: -1
      name: expanse-get-issues
      script: '|||expanse-get-issues'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      limit:
        simple: "1"
      provider:
        simple: Amazon Web Services
      sort:
        simple: -created
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 1c1e5637-aa9b-4e93-8d01-53fbac2525b9
    type: condition
    task:
      id: 1c1e5637-aa9b-4e93-8d01-53fbac2525b9
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "49"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.activityStatus
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.assets.[0].assetKey
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.assets.[0].assetType
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.assets.[0].displayName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.assets.[0].id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.assigneeUsername
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.businessUnits.[0].id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.businessUnits.[0].name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.created
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.headline
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.helpText
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.initialEvidence
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.ip
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.issueType.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.issueType.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.latestEvidence
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.modified
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.portNumber
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.portProtocol
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.priority
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.progressStatus
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.providers.[0].id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.providers.[0].name
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 70b61d95-7bfe-4687-80ca-6adb07b40d22
    type: regular
    task:
      id: 70b61d95-7bfe-4687-80ca-6adb07b40d22
      version: -1
      name: expanse-get-issue-updates
      script: '|||expanse-get-issue-updates'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      created_after:
        complex:
          root: ExpanseCreationTime
      issue_id:
        complex:
          root: ExpanseIssueID
      limit:
        simple: "10"
      update_types:
        simple: Comment,ProgressStatus
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 1f54eaf7-92d7-4816-8be1-f930e39ff7b4
    type: condition
    task:
      id: 1f54eaf7-92d7-4816-8be1-f930e39ff7b4
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "6"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IssueUpdate.created
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IssueUpdate.id
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Expanse.IssueUpdate.issueId
            iscontext: true
          right:
            value:
              complex:
                root: ExpanseIssueID
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Expanse.IssueUpdate.updateType
            iscontext: true
          right:
            value:
              simple: ProgressStatus
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IssueUpdate.user.username
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Expanse.IssueUpdate.value
            iscontext: true
          right:
            value:
              simple: InProgress
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 1ac52739-15a5-4d44-8b9b-b7f91e772eca
    type: regular
    task:
      id: 1ac52739-15a5-4d44-8b9b-b7f91e772eca
      version: -1
      name: expanse-get-issue-comments
      script: '|||expanse-get-issue-comments'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      created_after:
        complex:
          root: ExpanseCreationTime
      issue_id:
        complex:
          root: ExpanseIssueID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: e9058779-4d80-4747-8ee2-e32122d5252a
    type: condition
    task:
      id: e9058779-4d80-4747-8ee2-e32122d5252a
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "52"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IssueComment.created
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IssueComment.id
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Expanse.IssueComment.issueId
            iscontext: true
          right:
            value:
              complex:
                root: ExpanseIssueID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IssueComment.updateType
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Expanse.IssueComment.value
            iscontext: true
          right:
            value:
              simple: XSOAR Test Playbook Comment
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 8ed108ab-dfc1-427f-8c3b-a73e3b4801ab
    type: regular
    task:
      id: 8ed108ab-dfc1-427f-8c3b-a73e3b4801ab
      version: -1
      name: expanse-update-issue (Add Comment)
      script: '|||expanse-update-issue'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      issue_id:
        complex:
          root: ExpanseIssueID
      update_type:
        simple: Comment
      value:
        simple: XSOAR Test Playbook Comment
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: f7139e21-9160-4cc8-83dc-3a721a9ad604
    type: condition
    task:
      id: f7139e21-9160-4cc8-83dc-3a721a9ad604
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "50"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IssueUpdate.created
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IssueUpdate.id
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Expanse.IssueUpdate.issueId
            iscontext: true
          right:
            value:
              complex:
                root: ExpanseIssueID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IssueUpdate.updateType
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IssueUpdate.user.username
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IssueUpdate.value
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: 769c899b-598a-4b87-8f14-7d50a03652dd
    type: regular
    task:
      id: 769c899b-598a-4b87-8f14-7d50a03652dd
      version: -1
      name: expanse-get-issue
      script: '|||expanse-get-issue'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      issue_id:
        complex:
          root: ExpanseIssueID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 670d7479-423f-4cef-8217-b5e7f0172d08
    type: condition
    task:
      id: 670d7479-423f-4cef-8217-b5e7f0172d08
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "53"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.activityStatus
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.assets.[0].assetKey
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.assets.[0].assetType
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.assets.[0].displayName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.assets.[0].id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.assigneeUsername
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.businessUnits.[0].id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.businessUnits.[0].name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.created
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.headline
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.helpText
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Expanse.Issue.id
            iscontext: true
          right:
            value:
              complex:
                root: ExpanseIssueID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.initialEvidence
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.ip
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.issueType.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.issueType.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.latestEvidence
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.modified
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.portNumber
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.portProtocol
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.priority
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Expanse.Issue.progressStatus
            iscontext: true
          right:
            value:
              simple: InProgress
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.providers.[0].id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.providers.[0].name
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: eef9c6fb-f894-48c4-881a-027a60bb7994
    type: regular
    task:
      id: eef9c6fb-f894-48c4-881a-027a60bb7994
      version: -1
      name: expanse-list-businessunits
      script: '|||expanse-list-businessunits'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      limit:
        simple: "5"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: ab804fee-61a9-47e1-896d-7922aa2f47eb
    type: condition
    task:
      id: ab804fee-61a9-47e1-896d-7922aa2f47eb
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "14"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.BusinessUnit.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.BusinessUnit.name
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 656bcf85-dc84-47c3-810b-9a0b17f8f271
    type: regular
    task:
      id: 656bcf85-dc84-47c3-810b-9a0b17f8f271
      version: -1
      name: expanse-list-providers
      script: '|||expanse-list-providers'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      limit:
        simple: "5"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3695
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: b73e8842-aca3-4175-8919-11deaf0e673f
    type: condition
    task:
      id: b73e8842-aca3-4175-8919-11deaf0e673f
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "26"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Provider.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Provider.name
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: b449ca52-ffd1-4121-8f56-3e43527487ea
    type: regular
    task:
      id: b449ca52-ffd1-4121-8f56-3e43527487ea
      version: -1
      name: expanse-list-tags
      script: '|||expanse-list-tags'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      limit:
        simple: "100"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: a06837c3-0036-44f4-8ff6-1d0124481e52
    type: condition
    task:
      id: a06837c3-0036-44f4-8ff6-1d0124481e52
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "28"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Tag.[0].created
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Tag.[0].id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Tag.[0].modified
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Tag.[0].name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Tag.[0].tenantId
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4395
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: 50b2fda8-93ec-4f7e-8777-13bde8046ed7
    type: regular
    task:
      id: 50b2fda8-93ec-4f7e-8777-13bde8046ed7
      version: -1
      name: expanse-assign-tags-to-asset
      script: '|||expanse-assign-tags-to-asset'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      asset_id:
        complex:
          root: ExpanseIPRangeID
      asset_type:
        simple: IpRange
      tags:
        complex:
          root: Expanse.Tag
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: Expanse.Tag.name
                iscontext: true
              right:
                value:
                  simple: tagcreatedbyxsoar
          accessor: id
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6145
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: ccc16f8c-8185-466b-8ac3-c0346b2aef64
    type: regular
    task:
      id: ccc16f8c-8185-466b-8ac3-c0346b2aef64
      version: -1
      name: expanse-unassign-tags-from-asset
      script: '|||expanse-unassign-tags-from-asset'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      asset_id:
        complex:
          root: ExpanseIPRangeID
      asset_type:
        simple: IpRange
      tags:
        complex:
          root: Expanse.Tag
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: Expanse.Tag.name
                iscontext: true
              right:
                value:
                  simple: tagcreatedbyxsoar
          accessor: id
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: d4d41647-97cc-4be9-845d-55f91473504c
    type: regular
    task:
      id: d4d41647-97cc-4be9-845d-55f91473504c
      version: -1
      name: expanse-assign-tags-to-iprange
      script: '|||expanse-assign-tags-to-iprange'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "46"
    scriptarguments:
      asset_id:
        complex:
          root: ExpanseIPRangeID
      tag_names:
        simple: xsoar-test-pb-tag
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: 9d7e20d4-a8be-4769-85e5-a21525e6c9ba
    type: regular
    task:
      id: 9d7e20d4-a8be-4769-85e5-a21525e6c9ba
      version: -1
      name: expanse-unassign-tags-from-iprange
      script: '|||expanse-unassign-tags-from-iprange'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      asset_id:
        complex:
          root: ExpanseIPRangeID
      tag_names:
        simple: tagcreatedbyxsoar
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 91f2ebff-356b-4900-809b-e01581ffdb85
    type: regular
    task:
      id: 91f2ebff-356b-4900-809b-e01581ffdb85
      version: -1
      name: expanse-assign-tags-to-certificate
      script: '|||expanse-assign-tags-to-certificate'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      asset_id:
        complex:
          root: ExpanseCertificateID
      tag_names:
        simple: xsoar-test-pb-tag
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: 5bb0caed-fb6b-4bdb-84de-09527e65c71e
    type: regular
    task:
      id: 5bb0caed-fb6b-4bdb-84de-09527e65c71e
      version: -1
      name: expanse-unassign-tags-from-certificate
      script: '|||expanse-unassign-tags-from-certificate'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      asset_id:
        complex:
          root: ExpanseCertificateID
      tag_names:
        simple: xsoar-test-pb-tag
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: f344b4b5-32bb-41fc-884d-a3d12d69def9
    type: regular
    task:
      id: f344b4b5-32bb-41fc-884d-a3d12d69def9
      version: -1
      name: expanse-assign-tags-to-domain
      script: '|||expanse-assign-tags-to-domain'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "42"
    scriptarguments:
      asset_id:
        complex:
          root: ExpanseDomainID
      tag_names:
        simple: xsoar-test-pb-tag
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "25":
    id: "25"
    taskid: 0a44cb8e-61ba-4581-8608-09e63114f966
    type: regular
    task:
      id: 0a44cb8e-61ba-4581-8608-09e63114f966
      version: -1
      name: expanse-unassign-tags-from-domain
      script: '|||expanse-unassign-tags-from-domain'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "66"
    scriptarguments:
      asset_id:
        complex:
          root: ExpanseDomainID
      tag_names:
        simple: xsoar-test-pb-tag
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: a3287e43-4e78-4523-8c04-1ad488a20120
    type: regular
    task:
      id: a3287e43-4e78-4523-8c04-1ad488a20120
      version: -1
      name: expanse-create-tag
      script: '|||expanse-create-tag'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      description:
        simple: XSOAR Test Playbook Tag
      name:
        simple: xsoar-test-pb-tag
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4045
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: 8cc538fe-e4e2-4a0a-8244-52d5efb4bb0b
    type: regular
    task:
      id: 8cc538fe-e4e2-4a0a-8244-52d5efb4bb0b
      version: -1
      name: expanse-get-iprange
      script: '|||expanse-get-iprange'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: 82c8cee3-cf9b-46ff-844a-b1de54822ff2
    type: condition
    task:
      id: 82c8cee3-cf9b-46ff-844a-b1de54822ff2
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "54"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.businessUnits.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.businessUnits.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.cidr
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.created
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.ipVersion
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.modified
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.rangeIntroduced
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.rangeSize
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.rangeType
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.responsiveIpCount
            iscontext: true
      - - operator: isEqualNumber
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "0"
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Vendor
            iscontext: true
          right:
            value:
              simple: ExpanseV2
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Type
            iscontext: true
          right:
            value:
              simple: cidr
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4745
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: e5b2596b-132f-499d-8108-40716467cb4b
    type: regular
    task:
      id: e5b2596b-132f-499d-8108-40716467cb4b
      version: -1
      name: expanse-get-domain
      script: '|||expanse-get-domain'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: 4c96f799-4bca-4b7d-8770-391e3952e6fd
    type: condition
    task:
      id: 4c96f799-4bca-4b7d-8770-391e3952e6fd
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "61"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.businessUnits.[0].id
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.businessUnits.[0].name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.businessUnits.[0].tenantId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.dateAdded
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.dnsResolutionStatus
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.domain
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.providers.[0].id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.providers.[0].name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.serviceStatus
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.sourceDomain
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.tenant.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.tenant.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.tenant.tenantId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.whois
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.Name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.CreationDate
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.ExpirationDate
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.NameServers
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
      - - operator: inList
          left:
            value:
              simple: DBotScore.[1].Type
            iscontext: true
          right:
            value:
              simple: domain,domainglob
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.[1].Vendor
            iscontext: true
          right:
            value:
              simple: ExpanseV2
      - - operator: isEqualNumber
          left:
            value:
              simple: DBotScore.[1].Score
            iscontext: true
          right:
            value:
              simple: "0"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: cadd882a-6d46-403f-890f-c7aa3fcca719
    type: regular
    task:
      id: cadd882a-6d46-403f-890f-c7aa3fcca719
      version: -1
      name: expanse-get-certificate
      script: '|||expanse-get-certificate'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "35"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6495
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: 7695c358-2553-4b97-8b1f-7c73a6ca2db7
    type: condition
    task:
      id: 7695c358-2553-4b97-8b1f-7c73a6ca2db7
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "57"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.businessUnits.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.businessUnits.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.businessUnits.tenantId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.issuer
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.md5Hash
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.pemSha1
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.pemSha256
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.publicKey
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.publicKeyAlgorithm
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.publicKeyBits
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.publicKeySpki
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.serialNumber
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.signatureAlgorithm
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.subject
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.validNotAfter
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.validNotBefore
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.version
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificateAdvertisementStatus
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.commonName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.dateAdded
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.properties
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.providers.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.providers.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.serviceStatus
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.tenant.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.tenant.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.tenant.tenantId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.Name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.SubjectDN
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.IssuerDN
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.SerialNumber
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.ValidityNotAfter
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.ValidityNotBefore
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.SHA256
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.SHA1
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.MD5
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.PublicKey.Algorithm
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.PublicKey.Length
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.SPKISHA256
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.Signature.Algorithm
            iscontext: true
      - - operator: isEqualNumber
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "0"
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Vendor
            iscontext: true
          right:
            value:
              simple: ExpanseV2
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Type
            iscontext: true
          right:
            value:
              simple: certificate
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: a841d4cd-d4fe-41b6-8a9b-4383d2e93233
    type: regular
    task:
      id: a841d4cd-d4fe-41b6-8a9b-4383d2e93233
      version: -1
      name: certificate
      script: '|||certificate'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "37"
    scriptarguments:
      certificate:
        complex:
          root: ExpanseCertificateMD5
      set_expanse_fields:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: 6f9c43ea-d249-4a58-8f68-fe233941f7e5
    type: condition
    task:
      id: 6f9c43ea-d249-4a58-8f68-fe233941f7e5
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "23"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.businessUnits.[0].id
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.businessUnits.[0].name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.businessUnits.[0].tenantId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.issuer
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.md5Hash
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.pemSha1
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.pemSha256
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.publicKey
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.publicKeyAlgorithm
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.publicKeyBits
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.publicKeySpki
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.serialNumber
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.signatureAlgorithm
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.subject
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.validNotAfter
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.validNotBefore
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.version
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificateAdvertisementStatus.[0]
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.commonName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.dateAdded
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Expanse.Certificate.id
            iscontext: true
          right:
            value:
              complex:
                root: ExpanseCertificateID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.properties
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.providers.[0].id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.providers.[0].name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.serviceStatus
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.tenant.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.tenant.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.tenant.tenantId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.Name.[0]
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.SubjectDN
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.IssuerDN
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.SerialNumber
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.ValidityNotAfter
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.ValidityNotBefore
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.SHA256
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.SHA1
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Certificate.MD5
            iscontext: true
          right:
            value:
              complex:
                root: ExpanseCertificateMD5
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.PublicKey.Algorithm
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.PublicKey.Length
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.SPKISHA256
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.Signature.Algorithm
            iscontext: true
      - - operator: isEqualNumber
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "0"
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Vendor
            iscontext: true
          right:
            value:
              simple: ExpanseV2
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
          right:
            value:
              complex:
                root: ExpanseCertificateSHA256
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Type
            iscontext: true
          right:
            value:
              simple: certificate
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: 0420ee8a-364e-418e-8c1a-5dff859c8247
    type: regular
    task:
      id: 0420ee8a-364e-418e-8c1a-5dff859c8247
      version: -1
      name: domain
      script: ExpanseV2|||domain
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "43"
    scriptarguments:
      domain:
        complex:
          root: ExpanseDomainName
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: a35dbe91-b26c-4bb1-84fa-10ea13b413d6
    type: condition
    task:
      id: a35dbe91-b26c-4bb1-84fa-10ea13b413d6
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "25"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.businessUnits.[0].id
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.businessUnits.[0].name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.businessUnits.[0].tenantId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.dateAdded
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.dnsResolutionStatus
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Expanse.Domain.domain
            iscontext: true
          right:
            value:
              complex:
                root: ExpanseDomainName
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Expanse.Domain.id
            iscontext: true
          right:
            value:
              complex:
                root: ExpanseDomainID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.providers.[0].id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.providers.[0].name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.serviceStatus
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.sourceDomain
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.tenant.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.tenant.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.tenant.tenantId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.whois
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Domain.Name
            iscontext: true
          right:
            value:
              complex:
                root: ExpanseDomainName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.CreationDate
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.ExpirationDate
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.NameServers
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
          right:
            value:
              complex:
                root: ExpanseDomainName
            iscontext: true
      - - operator: inList
          left:
            value:
              simple: DBotScore.Type
            iscontext: true
          right:
            value:
              simple: domain,domainglob
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Vendor
            iscontext: true
          right:
            value:
              simple: ExpanseV2
      - - operator: isEqualNumber
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "0"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: 8e159fb0-d34f-40a9-830d-95c628cc7ee0
    type: regular
    task:
      id: 8e159fb0-d34f-40a9-830d-95c628cc7ee0
      version: -1
      name: cidr
      script: '|||cidr'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "47"
    scriptarguments:
      cidr:
        complex:
          root: ExpanseIPRangeCIDR
      include:
        simple: severityCounts,annotations
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: 66e0780c-1477-474b-8740-a4e31bd750f9
    type: condition
    task:
      id: 66e0780c-1477-474b-8740-a4e31bd750f9
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "21"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.businessUnits.[0].id
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.businessUnits.[0].name
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Expanse.IPRange.cidr
            iscontext: true
          right:
            value:
              complex:
                root: ExpanseIPRangeCIDR
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.created
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.ipVersion
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.modified
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.rangeIntroduced
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.rangeSize
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.rangeType
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.responsiveIpCount
            iscontext: true
      - - operator: isEqualNumber
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "0"
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Vendor
            iscontext: true
          right:
            value:
              simple: ExpanseV2
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
          right:
            value:
              complex:
                root: ExpanseIPRangeCIDR
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Type.[0]
            iscontext: true
          right:
            value:
              simple: cidr
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5795
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: 03351ce1-8993-4931-860d-fa515fc9598f
    type: title
    task:
      id: 03351ce1-8993-4931-860d-fa515fc9598f
      version: -1
      name: Test Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 10345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: 635f16a3-12cd-4385-87ae-60341e1fd77d
    type: regular
    task:
      id: 635f16a3-12cd-4385-87ae-60341e1fd77d
      version: -1
      name: Save Expanse Issue Id to Context
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "65"
    scriptarguments:
      key:
        simple: ExpanseIssueID
      value:
        complex:
          root: Expanse.Issue
          accessor: id
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: be0e8296-cd9b-4491-8e96-fa82f156bcd7
    type: regular
    task:
      id: be0e8296-cd9b-4491-8e96-fa82f156bcd7
      version: -1
      name: expanse-update-issue (Change Progress Status)
      script: '|||expanse-update-issue'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      issue_id:
        complex:
          root: ExpanseIssueID
      update_type:
        simple: ProgressStatus
      value:
        simple: InProgress
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: dd042c28-c76f-471d-8a48-2cd5654ae5ae
    type: regular
    task:
      id: dd042c28-c76f-471d-8a48-2cd5654ae5ae
      version: -1
      name: Save Expanse Issue Progress Status to Context
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      key:
        simple: ExpanseIssueProgressStatus
      value:
        complex:
          root: Expanse.Issue
          accessor: progressStatus
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "52":
    id: "52"
    taskid: d91924db-c316-4c31-8a9f-be1adf474290
    type: regular
    task:
      id: d91924db-c316-4c31-8a9f-be1adf474290
      version: -1
      name: Delete Expanse Issue From Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: Expanse.Issue
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: 4542bba7-0cb4-407e-8061-753c8029da08
    type: regular
    task:
      id: 4542bba7-0cb4-407e-8061-753c8029da08
      version: -1
      name: expanse-update-issue (Reset Progress Status to Original Value)
      script: '|||expanse-update-issue'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      issue_id:
        complex:
          root: ExpanseIssueID
      update_type:
        simple: ProgressStatus
      value:
        complex:
          root: ExpanseIssueProgressStatus
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "54":
    id: "54"
    taskid: 24152632-991e-4369-8f6c-edafb20cfe81
    type: regular
    task:
      id: 24152632-991e-4369-8f6c-edafb20cfe81
      version: -1
      name: Save Expanse IP Range ID
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "56"
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: ExpanseIPRangeID
      value:
        complex:
          root: Expanse.IPRange
          accessor: id
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "55":
    id: "55"
    taskid: dfd0388c-7c8d-41b9-8db4-284ae80e0c44
    type: regular
    task:
      id: dfd0388c-7c8d-41b9-8db4-284ae80e0c44
      version: -1
      name: Delete Context (Except things to keep)
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: ExpanseIPRangeID,ExpanseIPRangeCIDR,Expanse.Tag,ExpanseIssueIP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "56":
    id: "56"
    taskid: e468c888-1d02-46cc-8713-6fbad7b008af
    type: regular
    task:
      id: e468c888-1d02-46cc-8713-6fbad7b008af
      version: -1
      name: Save Expanse IP Range CIDR
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "55"
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: ExpanseIPRangeCIDR
      value:
        complex:
          root: Expanse.IPRange
          accessor: cidr
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5095
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "57":
    id: "57"
    taskid: 81ea09b6-5e82-4859-8562-8bf3c4319775
    type: regular
    task:
      id: 81ea09b6-5e82-4859-8562-8bf3c4319775
      version: -1
      name: Save Expanse Certificate ID
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "58"
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: ExpanseCertificateID
      value:
        complex:
          root: Expanse.Certificate
          accessor: id
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6845
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "58":
    id: "58"
    taskid: 5f4912d1-e201-484e-899d-0cc2a43242ad
    type: regular
    task:
      id: 5f4912d1-e201-484e-899d-0cc2a43242ad
      version: -1
      name: Save Expanse Certificate MD5
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "60"
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: ExpanseCertificateMD5
      value:
        complex:
          root: Certificate
          accessor: MD5
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7020
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "59":
    id: "59"
    taskid: 46f96eb9-9b47-4f46-8cc7-7e33d0656fef
    type: regular
    task:
      id: 46f96eb9-9b47-4f46-8cc7-7e33d0656fef
      version: -1
      name: Delete Context (Except things to keep)
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: ExpanseCertificateID,ExpanseCertificateMD5,ExpanseCertificateSHA256,ExpanseIssueIP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: 57a2ce1f-975b-4363-82b7-86fb1361a60d
    type: regular
    task:
      id: 57a2ce1f-975b-4363-82b7-86fb1361a60d
      version: -1
      name: Save Expanse Certificate SHA256
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "59"
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: ExpanseCertificateSHA256
      value:
        complex:
          root: Certificate
          accessor: SHA256
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    id: "61"
    taskid: b2e8a61c-d788-44cf-8669-04083c03bcd5
    type: regular
    task:
      id: b2e8a61c-d788-44cf-8669-04083c03bcd5
      version: -1
      name: Save Expanse Domain ID
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "62"
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: ExpanseDomainID
      value:
        complex:
          root: Expanse.Domain
          accessor: id
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "62":
    id: "62"
    taskid: 2af6635d-afbc-4918-8292-e5c9f11a05ab
    type: regular
    task:
      id: 2af6635d-afbc-4918-8292-e5c9f11a05ab
      version: -1
      name: Save Expanse Domain Name
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "63"
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: ExpanseDomainName
      value:
        complex:
          root: Domain
          accessor: Name
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: 73069df1-4574-4c32-842c-eff69a3d1de1
    type: regular
    task:
      id: 73069df1-4574-4c32-842c-eff69a3d1de1
      version: -1
      name: Delete Context (Except things to keep)
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "24"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: ExpanseDomainID,ExpanseDomainName,ExpanseIssueIP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "64":
    id: "64"
    taskid: 8b707253-6746-4ee9-86fc-74d04e611d0d
    type: regular
    task:
      id: 8b707253-6746-4ee9-86fc-74d04e611d0d
      version: -1
      name: Save Expanse Issue IP to Context
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "51"
    scriptarguments:
      key:
        simple: ExpanseIssueIP
      value:
        complex:
          root: Expanse.Issue
          accessor: ip
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "65":
    id: "65"
    taskid: 5712df21-1974-4030-8e71-56aab9179609
    type: regular
    task:
      id: 5712df21-1974-4030-8e71-56aab9179609
      version: -1
      name: Save Expanse Creation Time To Context
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "64"
    scriptarguments:
      key:
        simple: ExpanseCreationTime
      value:
        complex:
          root: Expanse.Issue
          accessor: created
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "66":
    id: "66"
    taskid: 76ede518-1c17-47b8-840e-e08e3df0042c
    type: regular
    task:
      id: 76ede518-1c17-47b8-840e-e08e3df0042c
      version: -1
      name: expanse-get-domains-for-certificate
      description: Returns all domains which have been seen with the specified certificate.
      script: '|||expanse-get-domains-for-certificate'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "67"
    scriptarguments:
      common_name:
        simple: ${inputs.common_name}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "67":
    id: "67"
    taskid: c28eca22-52cd-4e06-8009-b7d913c9572a
    type: regular
    task:
      id: c28eca22-52cd-4e06-8009-b7d913c9572a
      version: -1
      name: expanse-get-cloud-resources
      description: Retrieve cloud resources from Expanse.
      script: ExpanseV2|||expanse-get-cloud-resources
      type: regular
      iscommand: true
      brand: ExpanseV2
    nexttasks:
      '#none#':
      - "68"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "68":
    id: "68"
    taskid: 450d3b57-5bab-4c3c-8f2b-296682a3fc05
    type: condition
    task:
      id: 450d3b57-5bab-4c3c-8f2b-296682a3fc05
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "48"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.CloudResource
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 10170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 10360,
        "width": 380,
        "x": 50,
        "y": 50
      }
    }
  }
inputs:
- key: ip
  value:
    simple: 12.2.248.97
  required: false
  description: 'IP address '
  playbookInputQuery: null
- key: common_name
  value:
    simple: api-dev.radioshack.com
  required: false
  description: A partial certificate common name
  playbookInputQuery: null
outputs: []
fromversion: 6.0.0
