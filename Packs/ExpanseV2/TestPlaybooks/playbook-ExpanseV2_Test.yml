description: Test Playbook for Expanse V2
id: ExpanseV2 Test
name: ExpanseV2 Test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 83eb397f-7a62-4cad-8579-e38cea76660b
    type: start
    task:
      id: 83eb397f-7a62-4cad-8579-e38cea76660b
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: cedef0eb-8720-43d2-885c-8b7865ba1149
    type: regular
    task:
      id: cedef0eb-8720-43d2-885c-8b7865ba1149
      version: -1
      name: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: 1d1a32b8-f7fb-4a65-8633-482c6572aba0
    type: regular
    task:
      id: 1d1a32b8-f7fb-4a65-8633-482c6572aba0
      version: -1
      name: expanse-get-issues
      script: '|||expanse-get-issues'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      limit:
        simple: "1"
      provider:
        simple: Amazon Web Services
      sort:
        simple: -created
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: a64ff891-fbc1-42b1-8890-7c73f5455632
    type: condition
    task:
      id: a64ff891-fbc1-42b1-8890-7c73f5455632
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "49"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.activityStatus
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.assets.assetKey
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.assets.assetType
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.assets.displayName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.assets.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.assigneeUsername
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.businessUnits.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.businessUnits.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.category
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.created
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.headline
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.helpText
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.initialEvidence
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.ip
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.issueType.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.issueType.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.latestEvidence
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.modified
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.portNumber
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.portProtocol
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.priority
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.progressStatus
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.providers.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.providers.name
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: a80639f9-18e0-4e43-87b3-de483a78c780
    type: regular
    task:
      id: a80639f9-18e0-4e43-87b3-de483a78c780
      version: -1
      name: expanse-get-issue-updates
      script: '|||expanse-get-issue-updates'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      created_after:
        complex:
          root: ExpanseCreationTime
      issue_id:
        complex:
          root: ExpanseIssueID
      limit:
        simple: "10"
      update_types:
        simple: Comment,ProgressStatus
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 65a6d7bb-048f-40c7-8965-3da41febe3d0
    type: condition
    task:
      id: 65a6d7bb-048f-40c7-8965-3da41febe3d0
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "6"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IssueUpdate.created
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IssueUpdate.id
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Expanse.IssueUpdate.issueId
            iscontext: true
          right:
            value:
              complex:
                root: ExpanseIssueID
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Expanse.IssueUpdate.updateType
            iscontext: true
          right:
            value:
              simple: ProgressStatus
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IssueUpdate.user.username
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Expanse.IssueUpdate.value
            iscontext: true
          right:
            value:
              simple: InProgress
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 7dabb138-c429-46fd-819c-a991c70a5fd8
    type: regular
    task:
      id: 7dabb138-c429-46fd-819c-a991c70a5fd8
      version: -1
      name: expanse-get-issue-comments
      script: '|||expanse-get-issue-comments'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      created_after:
        complex:
          root: ExpanseCreationTime
      issue_id:
        complex:
          root: ExpanseIssueID
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: cba891a4-b3f7-46e3-838e-94aeae38a39d
    type: condition
    task:
      id: cba891a4-b3f7-46e3-838e-94aeae38a39d
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "52"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IssueComment.created
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IssueComment.id
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Expanse.IssueComment.issueId
            iscontext: true
          right:
            value:
              complex:
                root: ExpanseIssueID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IssueComment.updateType
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Expanse.IssueComment.value
            iscontext: true
          right:
            value:
              simple: XSOAR Test Playbook Comment
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 3e78f53e-aadc-4f21-8dfb-ebd353ecd33c
    type: regular
    task:
      id: 3e78f53e-aadc-4f21-8dfb-ebd353ecd33c
      version: -1
      name: expanse-update-issue (Add Comment)
      script: '|||expanse-update-issue'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      issue_id:
        complex:
          root: ExpanseIssueID
      update_type:
        simple: Comment
      value:
        simple: XSOAR Test Playbook Comment
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: 489e2d98-cf97-409d-899d-ecbe0755cf39
    type: condition
    task:
      id: 489e2d98-cf97-409d-899d-ecbe0755cf39
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "50"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IssueUpdate.created
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IssueUpdate.id
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Expanse.IssueUpdate.issueId
            iscontext: true
          right:
            value:
              complex:
                root: ExpanseIssueID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IssueUpdate.updateType
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IssueUpdate.user.username
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IssueUpdate.value
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: 27aaadf8-f030-4274-87ed-96d9fd4dd9eb
    type: regular
    task:
      id: 27aaadf8-f030-4274-87ed-96d9fd4dd9eb
      version: -1
      name: expanse-get-issue
      script: '|||expanse-get-issue'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      issue_id:
        complex:
          root: ExpanseIssueID
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 0955e4e6-cc0a-447c-8292-0f4f27c5b581
    type: condition
    task:
      id: 0955e4e6-cc0a-447c-8292-0f4f27c5b581
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "53"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.activityStatus
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.assets.assetKey
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.assets.assetType
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.assets.displayName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.assets.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.assigneeUsername
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.businessUnits.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.businessUnits.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.category
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.created
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.headline
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.helpText
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Expanse.Issue.id
            iscontext: true
          right:
            value:
              complex:
                root: ExpanseIssueID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.initialEvidence
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.ip
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.issueType.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.issueType.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.latestEvidence
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.modified
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.portNumber
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.portProtocol
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.priority
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Expanse.Issue.progressStatus
            iscontext: true
          right:
            value:
              simple: InProgress
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.providers.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Issue.providers.name
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: ec328201-2e3a-4115-874e-409416076fb4
    type: regular
    task:
      id: ec328201-2e3a-4115-874e-409416076fb4
      version: -1
      name: expanse-list-businessunits
      script: '|||expanse-list-businessunits'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      limit:
        simple: "5"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: 8014076c-7ede-4ec3-8796-91d6402ac0a5
    type: condition
    task:
      id: 8014076c-7ede-4ec3-8796-91d6402ac0a5
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "14"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.BusinessUnit.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.BusinessUnit.name
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 01eec71b-6815-4290-8f08-dd6badfd0c55
    type: regular
    task:
      id: 01eec71b-6815-4290-8f08-dd6badfd0c55
      version: -1
      name: expanse-list-providers
      script: '|||expanse-list-providers'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      limit:
        simple: "5"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3695
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 19a0cbdd-6a7d-44b1-822e-b022efcb8ebb
    type: condition
    task:
      id: 19a0cbdd-6a7d-44b1-822e-b022efcb8ebb
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "26"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Provider.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Provider.name
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: bf072057-90e2-4cb6-8a3d-4cd940d8499a
    type: regular
    task:
      id: bf072057-90e2-4cb6-8a3d-4cd940d8499a
      version: -1
      name: expanse-list-tags
      script: '|||expanse-list-tags'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      limit:
        simple: "100"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: 10b4b432-ec4c-48d3-8b8d-d9a67bf2887c
    type: condition
    task:
      id: 10b4b432-ec4c-48d3-8b8d-d9a67bf2887c
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "28"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Tag.created
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Tag.description
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Tag.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Tag.modified
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Expanse.Tag.name
            iscontext: true
          right:
            value:
              simple: xsoar-test-pb-tag
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Tag.tenantId
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4395
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: 95d6734c-6db4-4873-8ff2-9e1568985b91
    type: regular
    task:
      id: 95d6734c-6db4-4873-8ff2-9e1568985b91
      version: -1
      name: expanse-assign-tags-to-asset
      script: '|||expanse-assign-tags-to-asset'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      asset_id:
        complex:
          root: ExpanseIPRangeID
      asset_type:
        simple: IpRange
      tags:
        complex:
          root: Expanse.Tag
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: Expanse.Tag.name
                iscontext: true
              right:
                value:
                  simple: xsoar-test-pb-tag
          accessor: id
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6145
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: b48a2773-1643-44b0-8403-9976f9950255
    type: regular
    task:
      id: b48a2773-1643-44b0-8403-9976f9950255
      version: -1
      name: expanse-unassign-tags-from-asset
      script: '|||expanse-unassign-tags-from-asset'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      asset_id:
        complex:
          root: ExpanseIPRangeID
      asset_type:
        simple: IpRange
      tags:
        complex:
          root: Expanse.Tag
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: Expanse.Tag.name
                iscontext: true
              right:
                value:
                  simple: xsoar-test-pb-tag
          accessor: id
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: d4c7e130-e818-4e61-8ad7-9dc424152bc3
    type: regular
    task:
      id: d4c7e130-e818-4e61-8ad7-9dc424152bc3
      version: -1
      name: expanse-assign-tags-to-iprange
      script: '|||expanse-assign-tags-to-iprange'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "46"
    scriptarguments:
      asset_id:
        complex:
          root: ExpanseIPRangeID
      tag_names:
        simple: xsoar-test-pb-tag
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: 85d0f4b0-7cd8-444b-8f6e-52a6e43e324b
    type: regular
    task:
      id: 85d0f4b0-7cd8-444b-8f6e-52a6e43e324b
      version: -1
      name: expanse-unassign-tags-from-iprange
      script: '|||expanse-unassign-tags-from-iprange'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      asset_id:
        complex:
          root: ExpanseIPRangeID
      tag_names:
        simple: xsoar-test-pb-tag
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 88b4e930-19d9-4535-89c6-ac41ce98a762
    type: regular
    task:
      id: 88b4e930-19d9-4535-89c6-ac41ce98a762
      version: -1
      name: expanse-assign-tags-to-certificate
      script: '|||expanse-assign-tags-to-certificate'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      asset_id:
        complex:
          root: ExpanseCertificateID
      tag_names:
        simple: xsoar-test-pb-tag
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: e3398be9-d102-480e-88e1-d67cc72bcd84
    type: regular
    task:
      id: e3398be9-d102-480e-88e1-d67cc72bcd84
      version: -1
      name: expanse-unassign-tags-from-certificate
      script: '|||expanse-unassign-tags-from-certificate'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      asset_id:
        complex:
          root: ExpanseCertificateID
      tag_names:
        simple: xsoar-test-pb-tag
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: 8f379a15-ad7d-4525-8daa-66a3cf6ce341
    type: regular
    task:
      id: 8f379a15-ad7d-4525-8daa-66a3cf6ce341
      version: -1
      name: expanse-assign-tags-to-domain
      script: '|||expanse-assign-tags-to-domain'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "42"
    scriptarguments:
      asset_id:
        complex:
          root: ExpanseDomainID
      tag_names:
        simple: xsoar-test-pb-tag
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "25":
    id: "25"
    taskid: 635fb02b-2baf-4e3d-801f-d65ba3be707b
    type: regular
    task:
      id: 635fb02b-2baf-4e3d-801f-d65ba3be707b
      version: -1
      name: expanse-unassign-tags-from-domain
      script: '|||expanse-unassign-tags-from-domain'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "66"
    scriptarguments:
      asset_id:
        complex:
          root: ExpanseDomainID
      tag_names:
        simple: xsoar-test-pb-tag
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: 7524eb92-f174-460c-84ca-085c839fc69c
    type: regular
    task:
      id: 7524eb92-f174-460c-84ca-085c839fc69c
      version: -1
      name: expanse-create-tag
      script: '|||expanse-create-tag'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      description:
        simple: XSOAR Test Playbook Tag
      name:
        simple: xsoar-test-pb-tag
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4045
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: bc0b4045-f50e-430a-87d8-f65ba4df6ef7
    type: regular
    task:
      id: bc0b4045-f50e-430a-87d8-f65ba4df6ef7
      version: -1
      name: expanse-get-iprange
      script: '|||expanse-get-iprange'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: da8afea0-8462-498b-85cb-99a207e51da3
    type: condition
    task:
      id: da8afea0-8462-498b-85cb-99a207e51da3
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "54"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.businessUnits.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.businessUnits.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.cidr
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.created
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.ipVersion
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.modified
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.rangeIntroduced
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.rangeSize
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.rangeType
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.responsiveIpCount
            iscontext: true
      - - operator: isEqualNumber
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "0"
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Vendor
            iscontext: true
          right:
            value:
              simple: ExpanseV2
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Type
            iscontext: true
          right:
            value:
              simple: cidr
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4745
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: bc8f1b8f-187c-4eb2-8269-9e21f18cb373
    type: regular
    task:
      id: bc8f1b8f-187c-4eb2-8269-9e21f18cb373
      version: -1
      name: expanse-get-domain
      script: '|||expanse-get-domain'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: e127304a-ce49-48a8-89c6-1b5e332d0050
    type: condition
    task:
      id: e127304a-ce49-48a8-89c6-1b5e332d0050
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "61"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.businessUnits.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.businessUnits.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.businessUnits.tenantId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.dateAdded
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.dnsResolutionStatus
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.domain
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.firstObserved
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.lastObserved
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.lastSampledIp
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.providers.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.providers.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.serviceStatus
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.sourceDomain
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.tenant.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.tenant.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.tenant.tenantId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.whois
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.Name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.CreationDate
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.UpdatedDate
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.ExpirationDate
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.DomainStatus
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.NameServers
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.Organization
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
      - - operator: inList
          left:
            value:
              simple: DBotScore.Type
            iscontext: true
          right:
            value:
              simple: domain,domainglob
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Vendor
            iscontext: true
          right:
            value:
              simple: ExpanseV2
      - - operator: isEqualNumber
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "0"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: a8f23b47-35fa-436f-83a3-d0b4758998ce
    type: regular
    task:
      id: a8f23b47-35fa-436f-83a3-d0b4758998ce
      version: -1
      name: expanse-get-certificate
      script: '|||expanse-get-certificate'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "35"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6495
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: d005c15a-a1a3-49eb-8431-c9e30abbe71d
    type: condition
    task:
      id: d005c15a-a1a3-49eb-8431-c9e30abbe71d
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "57"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.businessUnits.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.businessUnits.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.businessUnits.tenantId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.issuer
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.md5Hash
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.pemSha1
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.pemSha256
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.publicKey
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.publicKeyAlgorithm
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.publicKeyBits
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.publicKeySpki
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.serialNumber
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.signatureAlgorithm
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.subject
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.validNotAfter
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.validNotBefore
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.version
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificateAdvertisementStatus
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.commonName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.dateAdded
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.properties
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.providers.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.providers.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.serviceStatus
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.tenant.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.tenant.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.tenant.tenantId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.Name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.SubjectDN
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.IssuerDN
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.SerialNumber
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.ValidityNotAfter
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.ValidityNotBefore
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.SHA256
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.SHA1
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.MD5
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.PublicKey.Algorithm
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.PublicKey.Length
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.SPKISHA256
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.Signature.Algorithm
            iscontext: true
      - - operator: isEqualNumber
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "0"
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Vendor
            iscontext: true
          right:
            value:
              simple: ExpanseV2
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Type
            iscontext: true
          right:
            value:
              simple: certificate
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: 63d05dd4-7586-4397-88fb-434964b78875
    type: regular
    task:
      id: 63d05dd4-7586-4397-88fb-434964b78875
      version: -1
      name: certificate
      script: '|||certificate'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "37"
    scriptarguments:
      certificate:
        complex:
          root: ExpanseCertificateMD5
      set_expanse_fields:
        simple: "false"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: a232f30c-d5db-46a2-8c45-73ef88baa777
    type: condition
    task:
      id: a232f30c-d5db-46a2-8c45-73ef88baa777
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "23"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.businessUnits.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.businessUnits.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.businessUnits.tenantId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.issuer
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.md5Hash
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.pemSha1
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.pemSha256
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.publicKey
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.publicKeyAlgorithm
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.publicKeyBits
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.publicKeySpki
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.serialNumber
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.signatureAlgorithm
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.subject
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.validNotAfter
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.validNotBefore
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificate.version
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.certificateAdvertisementStatus
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.commonName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.dateAdded
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Expanse.Certificate.id
            iscontext: true
          right:
            value:
              complex:
                root: ExpanseCertificateID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.properties
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.providers.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.providers.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.serviceStatus
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.tenant.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.tenant.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Certificate.tenant.tenantId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.Name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.SubjectDN
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.IssuerDN
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.SerialNumber
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.ValidityNotAfter
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.ValidityNotBefore
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.SHA256
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.SHA1
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Certificate.MD5
            iscontext: true
          right:
            value:
              complex:
                root: ExpanseCertificateMD5
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.PublicKey.Algorithm
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.PublicKey.Length
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.SPKISHA256
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Certificate.Signature.Algorithm
            iscontext: true
      - - operator: isEqualNumber
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "0"
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Vendor
            iscontext: true
          right:
            value:
              simple: ExpanseV2
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
          right:
            value:
              complex:
                root: ExpanseCertificateSHA256
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Type
            iscontext: true
          right:
            value:
              simple: certificate
      - - operator: isEqualString
          left:
            value:
              simple: Expanse.Certificate.annotations.tags.name
            iscontext: true
          right:
            value:
              simple: xsoar-test-pb-tag
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: 7416d60e-b91a-402e-8331-46bec4b18c54
    type: regular
    task:
      id: 7416d60e-b91a-402e-8331-46bec4b18c54
      version: -1
      name: domain
      script: ExpanseV2|||domain
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "43"
    scriptarguments:
      domain:
        complex:
          root: ExpanseDomainName
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: 262ca1c8-2353-4e80-8043-9dd7ccf5e46c
    type: condition
    task:
      id: 262ca1c8-2353-4e80-8043-9dd7ccf5e46c
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "25"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.businessUnits.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.businessUnits.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.businessUnits.tenantId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.dateAdded
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.dnsResolutionStatus
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Expanse.Domain.domain
            iscontext: true
          right:
            value:
              complex:
                root: ExpanseDomainName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.firstObserved
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Expanse.Domain.id
            iscontext: true
          right:
            value:
              complex:
                root: ExpanseDomainID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.lastObserved
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.lastSampledIp
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.providers.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.providers.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.serviceStatus
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.sourceDomain
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.tenant.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.tenant.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.tenant.tenantId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.Domain.whois
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Domain.Name
            iscontext: true
          right:
            value:
              complex:
                root: ExpanseDomainName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.CreationDate
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.UpdatedDate
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.ExpirationDate
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.DomainStatus
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.NameServers
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.Organization
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
          right:
            value:
              complex:
                root: ExpanseDomainName
            iscontext: true
      - - operator: inList
          left:
            value:
              simple: DBotScore.Type
            iscontext: true
          right:
            value:
              simple: domain,domainglob
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Vendor
            iscontext: true
          right:
            value:
              simple: ExpanseV2
      - - operator: isEqualNumber
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "0"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: 736c166d-a56d-4988-88ef-575deb94bec0
    type: regular
    task:
      id: 736c166d-a56d-4988-88ef-575deb94bec0
      version: -1
      name: cidr
      script: '|||cidr'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "47"
    scriptarguments:
      cidr:
        complex:
          root: ExpanseIPRangeCIDR
      include:
        simple: severityCounts,annotations
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: 666f2dce-8907-487c-8292-377630b70baa
    type: condition
    task:
      id: 666f2dce-8907-487c-8292-377630b70baa
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "21"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.businessUnits.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.businessUnits.name
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: Expanse.IPRange.cidr
            iscontext: true
          right:
            value:
              complex:
                root: ExpanseIPRangeCIDR
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.created
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.ipVersion
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.modified
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.rangeIntroduced
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.rangeSize
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.rangeType
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Expanse.IPRange.responsiveIpCount
            iscontext: true
      - - operator: isEqualNumber
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "0"
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Vendor
            iscontext: true
          right:
            value:
              simple: ExpanseV2
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
          right:
            value:
              complex:
                root: ExpanseIPRangeCIDR
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Type
            iscontext: true
          right:
            value:
              simple: cidr
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Expanse.IPRange.annotations.tags
                accessor: name
            iscontext: true
          right:
            value:
              simple: xsoar-test-pb-tag
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5795
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: 663e074d-ac58-4b02-885c-3707db02a5a6
    type: title
    task:
      id: 663e074d-ac58-4b02-885c-3707db02a5a6
      version: -1
      name: Test Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 10520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: ddc955fe-e670-4e2f-8865-ddfc418de92f
    type: regular
    task:
      id: ddc955fe-e670-4e2f-8865-ddfc418de92f
      version: -1
      name: Save Expanse Issue Id to Context
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "65"
    scriptarguments:
      key:
        simple: ExpanseIssueID
      value:
        complex:
          root: Expanse.Issue
          accessor: id
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: 8fcb327b-0cb7-4d5c-8a2d-68c1040ceea6
    type: regular
    task:
      id: 8fcb327b-0cb7-4d5c-8a2d-68c1040ceea6
      version: -1
      name: expanse-update-issue (Change Progress Status)
      script: '|||expanse-update-issue'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      issue_id:
        complex:
          root: ExpanseIssueID
      update_type:
        simple: ProgressStatus
      value:
        simple: InProgress
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: 84b86a02-b739-4c1c-82e8-9cc89bcda142
    type: regular
    task:
      id: 84b86a02-b739-4c1c-82e8-9cc89bcda142
      version: -1
      name: Save Expanse Issue Progress Status to Context
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      key:
        simple: ExpanseIssueProgressStatus
      value:
        complex:
          root: Expanse.Issue
          accessor: progressStatus
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "52":
    id: "52"
    taskid: 9950aebd-ae7f-4fc1-82d9-79e95be18434
    type: regular
    task:
      id: 9950aebd-ae7f-4fc1-82d9-79e95be18434
      version: -1
      name: Delete Expanse Issue From Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: Expanse.Issue
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: 43264a2a-3af3-457a-8dd1-96312790d8a9
    type: regular
    task:
      id: 43264a2a-3af3-457a-8dd1-96312790d8a9
      version: -1
      name: expanse-update-issue (Reset Progress Status to Original Value)
      script: '|||expanse-update-issue'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      issue_id:
        complex:
          root: ExpanseIssueID
      update_type:
        simple: ProgressStatus
      value:
        complex:
          root: ExpanseIssueProgressStatus
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "54":
    id: "54"
    taskid: ea45785f-1b47-43f0-8c9b-61eceecf5eb9
    type: regular
    task:
      id: ea45785f-1b47-43f0-8c9b-61eceecf5eb9
      version: -1
      name: Save Expanse IP Range ID
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "56"
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: ExpanseIPRangeID
      value:
        complex:
          root: Expanse.IPRange
          accessor: id
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "55":
    id: "55"
    taskid: 83631bd4-5ec9-477d-8aea-8499942783c4
    type: regular
    task:
      id: 83631bd4-5ec9-477d-8aea-8499942783c4
      version: -1
      name: Delete Context (Except things to keep)
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: ExpanseIPRangeID,ExpanseIPRangeCIDR,Expanse.Tag,ExpanseIssueIP
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "56":
    id: "56"
    taskid: fafce561-43d5-448e-8459-0e214ff0f93e
    type: regular
    task:
      id: fafce561-43d5-448e-8459-0e214ff0f93e
      version: -1
      name: Save Expanse IP Range CIDR
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "55"
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: ExpanseIPRangeCIDR
      value:
        complex:
          root: Expanse.IPRange
          accessor: cidr
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5095
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "57":
    id: "57"
    taskid: b0b75fe0-76de-4bf8-86bb-29f929f95d91
    type: regular
    task:
      id: b0b75fe0-76de-4bf8-86bb-29f929f95d91
      version: -1
      name: Save Expanse Certificate ID
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "58"
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: ExpanseCertificateID
      value:
        complex:
          root: Expanse.Certificate
          accessor: id
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6845
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "58":
    id: "58"
    taskid: 0b621b45-b3d1-4bf8-8360-73313ac779d5
    type: regular
    task:
      id: 0b621b45-b3d1-4bf8-8360-73313ac779d5
      version: -1
      name: Save Expanse Certificate MD5
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "60"
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: ExpanseCertificateMD5
      value:
        complex:
          root: Certificate
          accessor: MD5
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7020
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "59":
    id: "59"
    taskid: 117dfb37-2b6d-4412-87b3-6263f50d6922
    type: regular
    task:
      id: 117dfb37-2b6d-4412-87b3-6263f50d6922
      version: -1
      name: Delete Context (Except things to keep)
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: ExpanseCertificateID,ExpanseCertificateMD5,ExpanseCertificateSHA256,ExpanseIssueIP
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: c973ee7b-a36b-440f-8e92-43dc5edf61d6
    type: regular
    task:
      id: c973ee7b-a36b-440f-8e92-43dc5edf61d6
      version: -1
      name: Save Expanse Certificate SHA256
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "59"
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: ExpanseCertificateSHA256
      value:
        complex:
          root: Certificate
          accessor: SHA256
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    id: "61"
    taskid: 18ae6af3-d2ff-4861-8e3d-8c4a22883751
    type: regular
    task:
      id: 18ae6af3-d2ff-4861-8e3d-8c4a22883751
      version: -1
      name: Save Expanse Domain ID
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "62"
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: ExpanseDomainID
      value:
        complex:
          root: Expanse.Domain
          accessor: id
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "62":
    id: "62"
    taskid: a56323b8-f427-45c7-812a-b96750c5c291
    type: regular
    task:
      id: a56323b8-f427-45c7-812a-b96750c5c291
      version: -1
      name: Save Expanse Domain Name
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "63"
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: ExpanseDomainName
      value:
        complex:
          root: Domain
          accessor: Name
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: 78988199-59f1-4cea-896a-36f841d96c1d
    type: regular
    task:
      id: 78988199-59f1-4cea-896a-36f841d96c1d
      version: -1
      name: Delete Context (Except things to keep)
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "24"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: ExpanseDomainID,ExpanseDomainName,ExpanseIssueIP
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "64":
    id: "64"
    taskid: 403ab61f-e20c-4af3-8b05-67ac5c9427cb
    type: regular
    task:
      id: 403ab61f-e20c-4af3-8b05-67ac5c9427cb
      version: -1
      name: Save Expanse Issue IP to Context
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "51"
    scriptarguments:
      key:
        simple: ExpanseIssueIP
      value:
        complex:
          root: Expanse.Issue
          accessor: ip
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "65":
    id: "65"
    taskid: 3910b269-9930-4d33-8063-cf0c8172cdd8
    type: regular
    task:
      id: 3910b269-9930-4d33-8063-cf0c8172cdd8
      version: -1
      name: Save Expanse Creation Time To Context
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "64"
    scriptarguments:
      key:
        simple: ExpanseCreationTime
      value:
        complex:
          root: Expanse.Issue
          accessor: created
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "66":
    id: "66"
    taskid: 498ff51b-fdf3-4153-8e65-2e0d6bd2051c
    type: regular
    task:
      id: 498ff51b-fdf3-4153-8e65-2e0d6bd2051c
      version: -1
      name: expanse-get-domains-for-certificate
      description: Returns all domains which have been seen with the specified certificate.
      script: '|||expanse-get-domains-for-certificate'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "67"
    scriptarguments:
      common_name:
        simple: ${inputs.common_name}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "67":
    id: "67"
    taskid: a5d8f4a1-42ee-4b08-8222-21e3a8f2ff01
    type: condition
    task:
      id: a5d8f4a1-42ee-4b08-8222-21e3a8f2ff01
      version: -1
      name: Verify domains for certificate
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      scriptName: Exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "68"
    scriptarguments:
      value:
        simple: ${Expanse.IPDomains.TotalDomainCount}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "68":
    id: "68"
    taskid: d2319a81-c243-4c8f-8272-bbec2d818df8
    type: regular
    task:
      id: d2319a81-c243-4c8f-8272-bbec2d818df8
      version: -1
      name: expanse-get-exposures
      description: Returns exposure information about the ip.
      script: '|||expanse-get-exposures'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "69"
    scriptarguments:
      ip:
        simple: ${inputs.ip}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 10170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "69":
    id: "69"
    taskid: 95d405a9-b288-4509-88db-7ebfb1a1c713
    type: condition
    task:
      id: 95d405a9-b288-4509-88db-7ebfb1a1c713
      version: -1
      name: Verify exposures
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      scriptName: Exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "48"
    scriptarguments:
      value:
        simple: ${Expanse.Exposures.TotalExposureCount}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 10345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 10535,
        "width": 380,
        "x": 50,
        "y": 50
      }
    }
  }
inputs:
- key: ip
  value:
    simple: 12.2.248.97
  required: false
  description: 'IP address '
  playbookInputQuery: null
- key: common_name
  value:
    simple: circuitcity.com
  required: false
  description: A partial certificate common name
  playbookInputQuery: null
outputs: []
fromversion: 6.0.0
