id: AWS IAM Password Policies Misconfiguration - Remediate and Notify
version: -1
name: AWS IAM Password Policies Misconfiguration - Remediate and Notify
description: |-
  This playbook helps you fix cloud security misconfigurations related to your AWS IAM password policy. It also makes it easy to involve your team by creating tickets and sending notifications through your chosen services.
  You have the flexibility to fully automate the fix or include an analyst review and approval step before any changes are made. Ticketing and notifications are handled by a sub-playbook, which you need to set up with your preferred integrations. To get started, provide inputs to select your desired ticketing and notification channels. If you want an analyst to approve the fix, you need to provide their email address. The playbook will send them the issue details and wait for their decision before applying any changes.

  Caution: If you do not provide a reviewer email, the playbook will automatically apply the fix without an approval step.

  This playbook can fix the following misconfigurations:

  - AWS IAM password policy allows password reuse
  - AWS IAM password policy does not expire in 90 days
  - AWS IAM password policy does not have a lowercase character
  - AWS IAM password policy does not have a minimum of 14 characters
  - AWS IAM password policy does not have a number
  - AWS IAM password policy does not have a symbol
  - AWS IAM password policy does not have an uppercase character
  - AWS IAM password policy does not have password expiration period
  - AWS IAM Password policy is unsecure.
starttaskid: "0"
fromversion: 6.10.0
tasks:
  "0":
    id: "0"
    taskid: 28af5df3-deea-400f-84ac-11835bdf3cd6
    type: start
    task:
      id: 28af5df3-deea-400f-84ac-11835bdf3cd6
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "5"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2855,
          "y": -550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: d333d480-fbfe-474e-8756-0702a559461c
    type: condition
    task:
      id: d333d480-fbfe-474e-8756-0702a559461c
      version: -1
      name: Execute remediation
      description: Based on the issue ruleid, remediation command is executed.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      expiration period:
      - "24"
      expire in 90 days:
      - "18"
      minimum length:
      - "30"
      password reuse:
      - "16"
      policy unsecure:
      - "17"
      require lowercase:
      - "28"
      require numbers:
      - "21"
      require symbol:
      - "22"
      require uppercase:
      - "29"
    separatecontext: false
    conditions:
    - label: password reuse
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: a2107824-6ed5-4c67-9450-8b154bb1fd2b
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: a2107824-6ed5-4c67-9450-8b154bb1fd2b
    - label: policy unsecure
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: 1e0076af-0ccd-4f1c-bba5-ac92964a5e6b
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: 1e0076af-0ccd-4f1c-bba5-ac92964a5e6b
    - label: expire in 90 days
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: f53107a2-00b2-46fb-98a9-1f12262c7d44
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: f53107a2-00b2-46fb-98a9-1f12262c7d44
    - label: require lowercase
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: ef7c537b-72eb-42a7-bab7-cb2d22c76a0d
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: ef7c537b-72eb-42a7-bab7-cb2d22c76a0d
    - label: minimum length
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: 168bfaa0-8c1d-427e-bfa8-4d96d82e3d83
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: 168bfaa0-8c1d-427e-bfa8-4d96d82e3d83
    - label: require numbers
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: 9a5813af-17a3-4058-be13-588ea00b4bfa
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: 9a5813af-17a3-4058-be13-588ea00b4bfa
    - label: require symbol
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: fd4dae57-509e-4374-96d3-e136821fc3f3
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: fd4dae57-509e-4374-96d3-e136821fc3f3
    - label: require uppercase
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: 31626ca9-f659-4d25-9d88-fa32262bbba7
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: 31626ca9-f659-4d25-9d88-fa32262bbba7
    - label: expiration period
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: a8dcc272-0b02-4534-8627-cf70ddd264c5
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: a8dcc272-0b02-4534-8627-cf70ddd264c5
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 1000
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: e71f2742-c30b-4607-b497-997b8a5ecf30
    type: regular
    task:
      id: e71f2742-c30b-4607-b497-997b8a5ecf30
      version: -1
      name: Get Asset details
      description: Get asset information.
      script: Cortex Core - Platform|||core-get-asset-details
      type: regular
      iscommand: true
      brand: Cortex Core - Platform
    nexttasks:
      '#none#':
      - "39"
    scriptarguments:
      asset_id:
        simple: ${issue.asset_ids}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2855,
          "y": -380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: 83054a43-deed-46ae-80b0-0f5b8c0e5222
    type: title
    task:
      id: 83054a43-deed-46ae-80b0-0f5b8c0e5222
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2855,
          "y": 2010
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: ef8d7348-d069-4323-8df5-78bf05dbc91f
    type: condition
    task:
      id: ef8d7348-d069-4323-8df5-78bf05dbc91f
      version: -1
      name: Send email for review consent
      description: Check whether the values provided in arguments are equal. If either of the arguments are missing, no is returned.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      Approve:
      - "3"
      Reject:
      - "10"
    separatecontext: false
    sla:
      minutes: 0
      hours: 0
      days: 0
      weeks: 0
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3280,
          "y": 850
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to:
        simple: ${inputs.Reviewer email address}
      subject:
        simple: Detected Issue - ${issue.details}
      body:
        simple: "A cloud misconfiguration has been detected and requires your review.<br><br>\n<b>Issue ID</b>: ${issue.id}<br>\n<b>Issue Details</b>: ${issue.details}<br>\n<b>Resource</b>: ${Core.CoreAsset.xdm__asset__name}<br>\n<b>Cloud Provider</b>: ${Core.CoreAsset.xdm__asset__provider}<br>\n<b>Misconfiguration Type</b>: CSPM<br>\n<b>Severity Level</b>: ${issue.severity}<br>\n<b>Region</b>: ${Core.CoreAsset.xdm__asset__cloud__region}<br>\n<b>Issue URL</b>: ${demistoUrls.workPlan}<br><br>\nPlease select <b>Approve</b> to approve the recommended remediation in the issue work plan, or \n<b>Reject</b> to reject and handle it manually.<br><br>"
      methods:
      - email
      format: html
      bcc:
      cc:
      timings:
        retriescount: 0
        retriesinterval: 360
        completeafterreplies: 1
        completeafterv2: true
        completeaftersla: false
      replyOptions:
      - Approve
      - Reject
      defaultOption: Reject
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 8fe38c15-0dcd-45fc-82d3-6340578af5a7
    type: regular
    task:
      id: 8fe38c15-0dcd-45fc-82d3-6340578af5a7
      version: -1
      name: Update Issue details to War Room
      description: Prints text to war room (Markdown supported)
      scriptName: Print
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "40"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 1480
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: d26857bf-6b74-4f1a-8abf-b4b5c8a54681
    type: regular
    task:
      id: d26857bf-6b74-4f1a-8abf-b4b5c8a54681
      version: -1
      name: Remediate IAM password policy allows password reuse
      description: Create or Update AWS account password policy.
      script: AWS|||aws-iam-account-password-policy-update
      type: regular
      iscommand: true
      brand: AWS
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      account_id:
        simple: ${Core.CoreAsset.xdm__asset__realm}${Core.CoreAsset}
      password_reuse_prevention:
        simple: "5"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: 96c23db4-a8b2-4076-8f0a-cecf57b0c850
    type: regular
    task:
      id: 96c23db4-a8b2-4076-8f0a-cecf57b0c850
      version: -1
      name: Remediate AWS IAM Password policy is unsecure
      description: Create or Update AWS account password policy.
      script: AWS|||aws-iam-account-password-policy-update
      type: regular
      iscommand: true
      brand: AWS
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      account_id:
        simple: ${Core.CoreAsset.xdm__asset__realm}
      allow_users_to_change_password:
        simple: "true"
      hard_expiry:
        simple: "true"
      max_password_age:
        simple: "90"
      minimum_password_length:
        simple: "14"
      password_reuse_prevention:
        simple: "5"
      require_lowercase_characters:
        simple: "true"
      require_numbers:
        simple: "true"
      require_symbols:
        simple: "true"
      require_uppercase_characters:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: 2cea2199-4f30-476b-8e4d-bdc814d49821
    type: regular
    task:
      id: 2cea2199-4f30-476b-8e4d-bdc814d49821
      version: -1
      name: ' Remediate IAM password policy does not expire in 90 days'
      description: Create or Update AWS account password policy.
      script: AWS|||aws-iam-account-password-policy-update
      type: regular
      iscommand: true
      brand: AWS
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      account_id:
        simple: ${Core.CoreAsset.xdm__asset__realm}
      max_password_age:
        simple: "90"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 1300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: 7d5b3512-d058-42dc-84f1-a87fdd458169
    type: regular
    task:
      id: 7d5b3512-d058-42dc-84f1-a87fdd458169
      version: -1
      name: Remediate AWS IAM password policy does not have a number
      description: Create or Update AWS account password policy.
      script: AWS|||aws-iam-account-password-policy-update
      type: regular
      iscommand: true
      brand: AWS
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      account_id:
        simple: ${Core.CoreAsset.xdm__asset__realm}
      require_numbers:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 1db197f9-3f72-4731-880c-e574e076bbf0
    type: regular
    task:
      id: 1db197f9-3f72-4731-880c-e574e076bbf0
      version: -1
      name: Remediate AWS IAM password policy does not have a symbol
      description: Create or Update AWS account password policy.
      script: AWS|||aws-iam-account-password-policy-update
      type: regular
      iscommand: true
      brand: AWS
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      account_id:
        simple: ${Core.CoreAsset.xdm__asset__realm}
      require_symbols:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2200,
          "y": 1300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: 633319c4-20a3-460f-8a4f-c22995dd9f43
    type: regular
    task:
      id: 633319c4-20a3-460f-8a4f-c22995dd9f43
      version: -1
      name: Remediate AWS IAM password policy does not have password expiration period
      description: Create or Update AWS account password policy.
      script: AWS|||aws-iam-account-password-policy-update
      type: regular
      iscommand: true
      brand: AWS
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      account_id:
        simple: ${Core.CoreAsset.xdm__asset__realm}
      hard_expiry:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: 210e8c9a-6a99-4499-8cf2-a189311cdebe
    type: condition
    task:
      id: 210e8c9a-6a99-4499-8cf2-a189311cdebe
      version: -1
      name: Is remediation available?
      description: Check if remediation is available for the issue ruleid.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "No":
      - "10"
      "Yes":
      - "36"
    separatecontext: false
    conditions:
    - label: "Yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: a2107824-6ed5-4c67-9450-8b154bb1fd2b
        - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: 1e0076af-0ccd-4f1c-bba5-ac92964a5e6b
        - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: f53107a2-00b2-46fb-98a9-1f12262c7d44
        - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: ef7c537b-72eb-42a7-bab7-cb2d22c76a0d
        - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: 168bfaa0-8c1d-427e-bfa8-4d96d82e3d83
        - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: 9a5813af-17a3-4058-be13-588ea00b4bfa
        - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: fd4dae57-509e-4374-96d3-e136821fc3f3
        - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: 31626ca9-f659-4d25-9d88-fa32262bbba7
        - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: a8dcc272-0b02-4534-8627-cf70ddd264c5
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: a2107824-6ed5-4c67-9450-8b154bb1fd2b
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: 1e0076af-0ccd-4f1c-bba5-ac92964a5e6b
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: f53107a2-00b2-46fb-98a9-1f12262c7d44
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: ef7c537b-72eb-42a7-bab7-cb2d22c76a0d
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: 168bfaa0-8c1d-427e-bfa8-4d96d82e3d83
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: 9a5813af-17a3-4058-be13-588ea00b4bfa
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: fd4dae57-509e-4374-96d3-e136821fc3f3
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: 31626ca9-f659-4d25-9d88-fa32262bbba7
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: a8dcc272-0b02-4534-8627-cf70ddd264c5
    - label: "No"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: a2107824-6ed5-4c67-9450-8b154bb1fd2b
        - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: 1e0076af-0ccd-4f1c-bba5-ac92964a5e6b
        - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: f53107a2-00b2-46fb-98a9-1f12262c7d44
        - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: ef7c537b-72eb-42a7-bab7-cb2d22c76a0d
        - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: 168bfaa0-8c1d-427e-bfa8-4d96d82e3d83
        - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: 9a5813af-17a3-4058-be13-588ea00b4bfa
        - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: fd4dae57-509e-4374-96d3-e136821fc3f3
        - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: 31626ca9-f659-4d25-9d88-fa32262bbba7
        - operator: isEqualString
          left:
            value:
              simple: issue.ruleid
            iscontext: true
          right:
            value:
              simple: a8dcc272-0b02-4534-8627-cf70ddd264c5
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: a2107824-6ed5-4c67-9450-8b154bb1fd2b
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: 1e0076af-0ccd-4f1c-bba5-ac92964a5e6b
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: f53107a2-00b2-46fb-98a9-1f12262c7d44
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: ef7c537b-72eb-42a7-bab7-cb2d22c76a0d
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: 168bfaa0-8c1d-427e-bfa8-4d96d82e3d83
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: 9a5813af-17a3-4058-be13-588ea00b4bfa
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: fd4dae57-509e-4374-96d3-e136821fc3f3
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: 31626ca9-f659-4d25-9d88-fa32262bbba7
        - operator: isEqualString
          left:
            value:
              simple: issue.matching_service_rule_id
            iscontext: true
          right:
            value:
              simple: a8dcc272-0b02-4534-8627-cf70ddd264c5
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2855,
          "y": -30
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: 449bec16-cde5-4865-8fea-3aa20106162c
    type: regular
    task:
      id: 449bec16-cde5-4865-8fea-3aa20106162c
      version: -1
      name: Remediate AWS IAM password policy does not have a lowercase character
      description: Create or Update AWS account password policy.
      script: AWS|||aws-iam-account-password-policy-update
      type: regular
      iscommand: true
      brand: AWS
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      account_id:
        simple: ${Core.CoreAsset.xdm__asset__realm}
      require_lowercase_characters:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2630,
          "y": 1300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: d9f10b81-5cd2-4f23-8683-7bb360daa5dc
    type: regular
    task:
      id: d9f10b81-5cd2-4f23-8683-7bb360daa5dc
      version: -1
      name: Remediate AWS IAM password policy does not have a uppercase character
      description: Create or Update AWS account password policy.
      script: AWS|||aws-iam-account-password-policy-update
      type: regular
      iscommand: true
      brand: AWS
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      account_id:
        simple: ${Core.CoreAsset.xdm__asset__realm}
      require_uppercase_characters:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3060,
          "y": 1300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: e8f0bf04-ec9d-41e4-8823-0831d4cae96a
    type: regular
    task:
      id: e8f0bf04-ec9d-41e4-8823-0831d4cae96a
      version: -1
      name: Remediate AWS IAM password policy does not have a minimum of 14 characters
      description: Create or Update AWS account password policy.
      script: AWS|||aws-iam-account-password-policy-update
      type: regular
      iscommand: true
      brand: AWS
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      account_id:
        simple: ${Core.CoreAsset.xdm__asset__realm}
      minimum_password_length:
        simple: "14"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3490,
          "y": 1300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: cd745017-f3bd-4580-81c1-6d634640a5c8
    type: regular
    task:
      id: cd745017-f3bd-4580-81c1-6d634640a5c8
      version: -1
      name: Update Issue status to Resolved - Fixed
      description: commands.local.cmd.set.alert.status
      script: Builtin|||setIssueStatus
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      status:
        simple: Resolved - Fixed
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 1820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: 66830456-0e31-4b5f-8627-40887a8efe5a
    type: condition
    task:
      id: 66830456-0e31-4b5f-8627-40887a8efe5a
      version: -1
      name: Is reviewer assigned?
      description: Check if reviewer email address is provided in playbook inputs.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "No":
      - "3"
      "Yes":
      - "11"
    separatecontext: false
    conditions:
    - label: "Yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: inputs.Reviewer email address
            iscontext: true
    - label: "No"
      condition:
      - - operator: isEmpty
          left:
            value:
              simple: inputs.Reviewer email address
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2855,
          "y": 700
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: 3f17b4de-9f05-482f-8b19-0229ad973112
    type: condition
    task:
      id: 3f17b4de-9f05-482f-8b19-0229ad973112
      version: -1
      name: Is AWS integration available ?
      description: Returns 'yes' if integration brand is available. Otherwise returns 'no'.
      scriptName: IsIntegrationAvailable
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "no":
      - "41"
      "yes":
      - "35"
    scriptarguments:
      brandname:
        simple: AWS
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2855,
          "y": 180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: e4d8c275-3366-4007-8fa5-39ce85d41b88
    type: playbook
    task:
      id: e4d8c275-3366-4007-8fa5-39ce85d41b88
      version: -1
      name: Create Ticket and Notify
      description: 'This playbook automates the dispatching of issues through ServiceNow v2 or Jira v3 and notifies stakeholders via Slack v3, Microsoft Teams, and/or email. With this playbook you can choose to create or update a ticket using Jira or ServiceNow, notify other teams using Slack or Microsoft Teams, and/or by sending an Email. It gives you the flexibility to create a ticket only and skip the notification step, skip the creation of a ticket and notify only, or choose to create a ticket and notify stakeholders. The playbook checks for and requires existing Jira, ServiceNow, Slack, or Microsoft Teams integrations to perform the ticketing and notification actions. If none of these integrations are found in your account, then the playbook sends an email with the issue details to the selected issue owner. '
      playbookName: Create Ticket and Notify
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      Jira Project Key:
        simple: ${inputs.Jira project key}
      Notification email recipients:
        simple: ${inputs.Notification email recipients}
      Preferred notification platform:
        simple: ${inputs.Preferred notification platform}
      Preferred ticketing platform:
        simple: ${inputs.Preferred ticketing platform}
      Slack Channel Name:
        simple: ${inputs.Slack Channel Name}
      System Input - Asset details:
        simple: ${Core.CoreAsset}
      System Input - Issue State:
        simple: Create
      System Input -Jira Ticket ID:
        simple: ${Ticket.Id}
      System Input -ServiceNow Ticket ID:
        simple: ${ServiceNow.Ticket.ID}
      Teams Channel Name:
        simple: ${inputs.Teams Channel Name}
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 2855,
          "y": -210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: 7edfe514-d64f-4351-88f3-4309acfa4795
    type: playbook
    task:
      id: 7edfe514-d64f-4351-88f3-4309acfa4795
      version: -1
      name: Update Ticket and Notify
      description: 'This playbook automates the dispatching of issues through ServiceNow v2 or Jira v3 and notifies stakeholders via Slack v3, Microsoft Teams, and/or email. With this playbook you can choose to create or update a ticket using Jira or ServiceNow, notify other teams using Slack or Microsoft Teams, and/or by sending an Email. It gives you the flexibility to create a ticket only and skip the notification step, skip the creation of a ticket and notify only, or choose to create a ticket and notify stakeholders. The playbook checks for and requires existing Jira, ServiceNow, Slack, or Microsoft Teams integrations to perform the ticketing and notification actions. If none of these integrations are found in your account, then the playbook sends an email with the issue details to the selected issue owner. '
      playbookName: Create Ticket and Notify
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "33"
    scriptarguments:
      Jira Project Key:
        simple: ${inputs.Jira project key}
      Notification email recipients:
        simple: ${inputs.Notification email recipients}
      Preferred notification platform:
        simple: ${inputs.Preferred notification platform}
      Preferred ticketing platform:
        simple: ${inputs.Preferred ticketing platform}
      Slack Channel Name:
        simple: ${inputs.Slack Channel Name}
      System Input - Asset details:
        simple: ${Core.CoreAsset}
      System Input - Issue State:
        simple: Update
      System Input -Jira Ticket ID:
        simple: ${Ticket.Id}
      System Input -ServiceNow Ticket ID:
        simple: ${ServiceNow.Ticket.ID}
      Teams Channel Name:
        simple: ${inputs.Teams Channel Name}
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 1640
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: 9d83a628-4f97-49d5-8c22-dbb4db2b4b99
    type: condition
    task:
      id: 9d83a628-4f97-49d5-8c22-dbb4db2b4b99
      version: -1
      name: Confirm AWS Pack Integration
      description: Confirm if AWS dependency pack is installed and integrated.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "No":
      - "10"
      "Yes":
      - "42"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2410,
          "y": 330
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to:
      subject:
      body:
        simple: This playbook needs the AWS dependency pack to run remediation commands. Please reply 'Yes' to confirm it's integrated, or 'No' to end the playbook.
      methods: []
      format: ""
      bcc:
      cc:
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
        completeafterv2: true
        completeaftersla: false
      replyOptions:
      - "Yes"
      - "No"
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: e22cf102-4caa-4f65-8964-a4bbd7d133a5
    type: condition
    task:
      id: e22cf102-4caa-4f65-8964-a4bbd7d133a5
      version: -1
      name: Is AWS integration available ?
      description: Returns 'yes' if integration brand is available. Otherwise returns 'no'.
      scriptName: IsIntegrationAvailable
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "no":
      - "10"
      "yes":
      - "35"
    scriptarguments:
      brandname:
        simple: AWS
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2410,
          "y": 550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "11_10_Reject": 0.12,
      "11_3_Approve": 0.21,
      "27_10_No": 0.1,
      "27_36_Yes": 0.53,
      "35_11_Yes": 0.33,
      "35_3_No": 0.1,
      "3_21_require numbers": 0.84,
      "3_24_expiration period": 0.87,
      "3_29_require uppercase": 0.82,
      "3_30_minimum length": 0.85,
      "41_10_No": 0.11,
      "41_42_Yes": 0.53,
      "42_10_no": 0.1
    },
    "paper": {
      "dimensions": {
        "height": 2620,
        "width": 3820,
        "x": 50,
        "y": -550
      }
    }
  }
inputs:
- key: Preferred ticketing platform
  value: {}
  required: false
  description: |-
    Possible values:
    - Jira
    - ServiceNow
    - Both

    Note: If you leave this empty, no issue ticket will be generated, and the playbook will skip this step.
  playbookInputQuery:
- key: Preferred notification platform
  value: {}
  required: false
  description: |-
    Possible values:
    - Microsoft Teams
    - Slack

    Note: If you leave this blank, no notification message will be sent and the playbook will skip this step.
  playbookInputQuery:
- key: Notification email recipients
  value: {}
  required: false
  description: |-
    Provide the email address to send email notifications.

    Note: If you leave this blank, no email notification will be sent and the playbook will skip this step.
  playbookInputQuery:
- key: Reviewer email address
  value: {}
  required: false
  description: |-
    Provide the designated reviewer's email address to request approval for executing the remediation command.

    Note: If you leave this blank, no email notification will be sent for reviewer approval, and the playbook will skip directly to execute the remediation command.
  playbookInputQuery:
- key: Jira project key
  value: {}
  required: false
  description: Provide Jira project key where the issue will be created.
  playbookInputQuery:
- key: Teams Channel Name
  value: {}
  required: false
  description: Provide Microsoft Teams channel name to which to send messages.
  playbookInputQuery:
- key: Slack Channel Name
  value: {}
  required: false
  description: Provide Slack channel name to which to send messages.
  playbookInputQuery:
inputSections:
- inputs:
  - Preferred ticketing platform
  - Preferred notification platform
  - Notification email recipients
  - Reviewer email address
  - Jira project key
  - Teams Channel Name
  - Slack Channel Name
  name: General (Inputs group)
  description: Generic group for inputs
outputSections:
- outputs: []
  name: General (Outputs group)
  description: Generic group for outputs
outputs: []
tests:
- No tests (auto formatted)
