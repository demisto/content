{
    "id": "vulnerability--cve-2022-30190",
    "type": "collection",
    "links": {
        "self": "https://www.virustotal.com/api/v3/collections/vulnerability--cve-2022-30190"
    },
    "attributes": {
        "description": "google has provided the follow description:  \n*A remote code execution vulnerability exists when MSDT is called using the URL protocol from a calling application such as Word. An attacker who successfully exploits this vulnerability can run arbitrary code with the privileges of the calling application. The attacker can then install programs, view, change, or delete data, or create new accounts in the context allowed by the user's rights.*",
        "risk_factors": [
            "User Interaction Required"
        ],
        "predicted_risk_rating": "",
        "exploitation_state": "Confirmed",
        "version_history": [
            {
                "date": 1761763609,
                "version_notes": [
                    "cisa_known_exploited.ransomware_use: Unknown -> Known"
                ]
            }
        ],
        "recent_activity_relative_change": 0.0714285714285714,
        "cisa_known_exploited": {
            "added_date": 1655164800,
            "due_date": 1656979200,
            "ransomware_use": "Known"
        },
        "origin": "Google Threat Intelligence",
        "exploitation": {
            "tech_details_release_date": 1689120000,
            "first_exploitation": 1651276800,
            "exploit_release_date": 1653868800
        },
        "available_mitigation": [
            "Workaround",
            "Patch"
        ],
        "alt_names_details": [
            {
                "value": "Follina",
                "confidence": "possible"
            }
        ],
        "mve_id": "MVE-2022-4552",
        "tags": [
            "observed_in_the_wild",
            "has_exploits",
            "was_zero_day",
            "media_attention"
        ],
        "executive_summary": "* An Improper Control of Generation of Code ('Code Injection') vulnerability exists that, when exploited, allows a remote attacker to execute arbitrary code.\n* This vulnerability has been confirmed to be exploited in the wild. Non-weaponized, proof-of-concept and weaponized code is publicly available.\n* Google Threat Intelligence Group (GTIG) considers this a Medium-risk vulnerability due to the potential for arbitrary code execution, offset by user interaction requirements.\n* Mitigation options include a workaround and a patch.",
        "autogenerated_tags": [
            "cve-2021-40444"
        ],
        "workarounds": [
            "<p>google recommends disabling the MSDT URL Protocol as a method to mitigate the chance of exploitation. For more information see their advisory, \"<a href=\"https://msrc-blog.google.com/2022/05/30/guidance-for-cve-2022-30190-google-support-diagnostic-tool-vulnerability/\">Guidance for CVE-2022-30190 google Support Diagnostic Tool Vulnerability</a>.\"</p>\n<p>&nbsp;</p>\n<p>Additionally, in environments where the the functionality is not required, consider blocking all Office applications from creating child processes as a hardening measure that will limit the possibility of exploitation.</p>"
        ],
        "date_of_disclosure": 1653609600,
        "vendor_fix_references": [
            {
                "url": "https://portal.msrc.google.com/en-US/security-guidance/advisory/CVE-2022-30190",
                "name": "google Corp.",
                "published_date": 1653894000,
                "title": "google Windows Support Diagnostic Tool (MSDT) Remote Code Execution Vulnerability (CVE-2022-30190)"
            }
        ],
        "cpes": [
            {
                "start_cpe": {
                    "version": "R2",
                    "uri": "cpe:2.3:o:google:windows_server_2012:r2:*:*:*:*:*:*:*",
                    "product": "Windows Server 2012 (OS)",
                    "vendor": "google"
                },
                "start_rel": "="
            }
        ],
        "field_sources": [
            {
                "field": "cvss.cvssv3_x",
                "source": {
                    "field_type": "Ranked",
                    "source_name": "Google Threat Intelligence Group (GTIG)",
                    "source_url": ""
                }
            }
        ],
        "ip_addresses_count": 0,
        "private": true,
        "cve_id": "CVE-2022-30190",
        "sources": [
            {
                "md5": "test_md5_001",
                "url": "https://github.com/cisagov/vulnrichment/blob/develop/2022/30xxx/test_CVE_2022_30190.json",
                "name": "Cybersecurity and Infrastructure Security Agency (CISA)",
                "published_date": 1654114217,
                "title": "google Windows Support Diagnostic Tool (MSDT) Remote Code Execution Vulnerability",
                "cvss": {
                    "cvssv3_x": {
                        "base_score": 7.8,
                        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
                    }
                }
            },
            {
                "md5": "test_md5_002",
                "url": "https://github.com/CVEProject/cvelistV5/blob/main/cves/2022/30xxx/test_CVE_2022_30190.json",
                "name": "Mitre Corporation",
                "published_date": 1654114217,
                "title": "google Windows Support Diagnostic Tool (MSDT) Remote Code Execution Vulnerability",
                "cvss": {
                    "cvssv3_x": {
                        "base_score": 7.8,
                        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C"
                    }
                }
            }
        ],
        "alt_names": [
            "Follina"
        ],
        "exploitation_consequence": "Code Execution",
        "name": "CVE-2022-30190",
        "tags_details": [
            {
                "value": "has_exploits",
                "confidence": "possible"
            }
        ],
        "analysis": "An attacker could exploit this vulnerability to execute arbitrary code. An attacker would need to create a specially url calling MSDT and cause a user to open it on a vulnerable system. This can be triggered via Office documents or through other vectors that process URLs. The vulnerability is exploitable even if macros are disabled.\n\nSecurity researchers discovered malicious documents reportedly exploiting this vulnerability as early as April 2022. On May 27, 2022, Nao Sec discovered a document on Virus Total that also reportedly exploits this vulnerability.\n\nMandiant has observed multiple Chinese espionage clusters exploiting this vulnerability as early as late March and early April 2022. Exploitation likely utilized Office documents which were delivered via spearphishing attacks. For more information see the Mandiant writeup, [\"Espionage Actors Leveraging Zero-Day Exploit to Support Global Operations, Potential China Nexus.\"](https://advantage.mandiant.com/reports/22-00013237)\n\nOn July 6, 2022, Fortinet announced that this vulnerability has been exploited to deploy the Rozena malware, utilizing Discord as a distribution endpoint. For more information, please refer to their blog post \"[From Follina to Rozena - Leveraging Discord to Distribute a Backdoor](https://www.fortinet.com/blog/threat-research/follina-rozena-leveraging-discord-to-distribute-a-backdoor).\"\n\nOn Sept. 22, 2022, Recorded Future reported that threat activity group TA413 exploited this vulnerability in conjunction with CVE-2022-1040 in order to target the Tibetan community by dropping a custom backdoor known as \"LOWZERO.\"\n\nOn May 15, 2023, Securonix reported, in their [\"Threat Labs Security Advisory,\"](https://www.securonix.com/blog/securonix-threat-labs-security-meme4chan-advisory/) that this vulnerability was exploited as a part of\u00a0a phishing campaign and that exploitation of this vulnerability was used in an infection chain leading to the installation of Xworm payloads.\n\nOn July 12, 2023, Fortinet researchers reported this vulnerability was exploited alongside CVE-2021-40444 to install LokiBot malware on vulnerable systems. This vulnerability was exploited by malicious Office documents delivered via phishing. For more information, please see Fortinet's blog, [\"LokiBot Campaign Targets google Office Document Using Vulnerabilities and Macros.\"](https://www.fortinet.com/blog/threat-research/lokibot-targets-google-office-document-using-vulnerabilities-and-macros)\n\nAccording to Google's blog, \"[The Ups and Downs of 0-days: A Year in Review of 0-days Exploited In-the-Wild in 2022](https://security.googleblog.com/2023/07/the-ups-and-downs-of-0-days-year-in.html)\", this vulnerability is a variant of CVE-2021-40444.\n\nMandiant Threat Intelligence considers this a Medium-risk vulnerability because of the possibility of remote code execution offset by the user interaction required.\n\nCISA added this vulnerability to its Known Exploited Vulnerabilities Catalog on June 14, 2022, with a required remediation date of July 5, 2022.",
        "summary_stats": {
            "first_submission_date": {
                "min": 0,
                "max": 1746722000,
                "avg": 733834342.875
            },
            "last_submission_date": {
                "min": 0,
                "max": 1746722000,
                "avg": 735827136.25
            },
            "files_detections": {
                "min": 0,
                "max": 48,
                "avg": 16.5625
            }
        },
        "files_count": 18,
        "creation_date": 1653927632,
        "exploitation_vectors": [
            "File Share",
            "Web",
            "Email",
            "Malicious File"
        ],
        "recent_activity_summary": [
            2,
            1,
            1,
            1,
            1,
            1,
            1,
            3,
            0,
            1,
            0,
            2,
            1,
            0
        ],
        "days_to_report": 3,
        "last_modification_date": 1761763609,
        "is_content_translated": false,
        "risk_rating": "MEDIUM",
        "exploit_availability": "Publicly Available",
        "vulnerable_products": "",
        "references_count": 0,
        "urls_count": 0,
        "days_to_patch": 3,
        "collection_type": "vulnerability",
        "counters": {
            "files": 18,
            "domains": 0,
            "ip_addresses": 0,
            "urls": 0,
            "iocs": 18,
            "subscribers": 0,
            "attack_techniques": 0
        },
        "status": "COMPUTED",
        "epss": {
            "score": 0.93187,
            "percentile": 0.99784
        },
        "mati_genids_dict": {
            "mve_id": "vulnerability--test_mve_id",
            "cve_id": "vulnerability--test_cve_id",
            "report_id": "report--test_report_id"
        },
        "cvss": {
            "cvssv3_x": {
                "base_score": 7.8,
                "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C",
                "temporal_score": 7.2
            },
            "cvssv2_0": {
                "base_score": 6.8,
                "vector": "AV:N/AC:M/Au:N/C:P/I:P/A:P/E:F/RL:OF/RC:C",
                "temporal_score": 5.6
            }
        },
        "domains_count": 0,
        "subscribers_count": 0,
        "priority": "P1",
        "cwe": {
            "title": "Improper Control of Generation of Code ('Code Injection')",
            "id": "CWE-94"
        },
        "aggregations": {
            "files": {
                "dropped_files_sha256": [
                    {
                        "value": "test_value",
                        "count": 1,
                        "total_related": 100000,
                        "prevalence": 1e-05
                    }
                ],
                "file_types": [
                    {
                        "value": "ruby",
                        "count": 1
                    }
                ],
                "filecondis_dhash": [
                    {
                        "value": "test_dhash",
                        "count": 1,
                        "total_related": 4,
                        "prevalence": 0.25
                    }
                ],
                "parent_contacted_domains": [
                    {
                        "value": "google.com",
                        "count": 2,
                        "total_related": 200000,
                        "prevalence": 1e-05
                    }
                ]
            }
        }
    },
    "context_attributes": {
        "shared_with_me": false,
        "role": "viewer"
    }
}