id: QRadar_v3-test
version: 22
vcShouldKeepItemLegacyProdMachine: false
name: QRadar_v3-test
description: QRadar v3 test playbook. Tests commands of QRadar, validates outputs
  and expected behaviour.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 708c3d6d-0bd0-440d-8a89-e4d46c7af618
    type: start
    task:
      id: 708c3d6d-0bd0-440d-8a89-e4d46c7af618
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "78"
      - "79"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: caea0518-bbd5-4435-8eba-1188eb2a5e57
    type: regular
    task:
      id: caea0518-bbd5-4435-8eba-1188eb2a5e57
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: f07c7d3c-1a8b-4e40-8306-0a4498a7e655
    type: regular
    task:
      id: f07c7d3c-1a8b-4e40-8306-0a4498a7e655
      version: -1
      name: Offense List
      description: Gets offenses from QRadar.
      script: '|||qradar-offenses-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "75"
    scriptarguments:
      enrichment:
        simple: IPs
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 72e41abe-1309-422b-8718-e9c09bc02394
    type: condition
    task:
      id: 72e41abe-1309-422b-8718-e9c09bc02394
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "76"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: QRadar.Offense.Magnitude
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: QRadar.Offense.Credibility
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: QRadar.Offense.ID
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: QRadar.Offense.Rules.name
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: QRadar.Offense.OffenseType
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: QRadar.Offense.OffenseType
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: QRadar.Offense.Status
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 83893f6a-a9f0-4b5a-83c4-7c4346da9646
    type: title
    task:
      id: 83893f6a-a9f0-4b5a-83c4-7c4346da9646
      version: -1
      name: Test Playbook Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 11395
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: a266adfd-d87b-4ec6-8051-594656c6e874
    type: regular
    task:
      id: a266adfd-d87b-4ec6-8051-594656c6e874
      version: -1
      name: Update Offense
      description: Update an offense.
      script: '|||qradar-offense-update'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      follow_up:
        simple: "true"
      offense_id:
        simple: ${OffenseID}
      protected:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: d415a112-62cf-4d69-869e-fd332fe53beb
    type: condition
    task:
      id: d415a112-62cf-4d69-869e-fd332fe53beb
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "8"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isTrue
          left:
            value:
              simple: QRadar.Offense.Followup
            iscontext: true
          right:
            value: {}
      - - operator: isTrue
          left:
            value:
              simple: QRadar.Offense.Protected
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Offense.ID
            iscontext: true
          right:
            value:
              simple: OffenseID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: f47407fa-f19c-452c-8c40-15a29ddd7ca5
    type: regular
    task:
      id: f47407fa-f19c-452c-8c40-15a29ddd7ca5
      version: -1
      name: Create Note To Offense
      description: Retrieve a list of notes for an offense.
      script: '|||qradar-offense-note-create'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      note_text:
        simple: Note Regarding The Offense
      offense_id:
        simple: ${OffenseID}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: 387d9505-1a08-4e01-8e78-98cebdb28dd7
    type: condition
    task:
      id: 387d9505-1a08-4e01-8e78-98cebdb28dd7
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "10"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Note.CreatedBy
            iscontext: true
          right:
            value:
              simple: 'API_user: engadmin-M6IS5rhJ'
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Note.Text
            iscontext: true
          right:
            value:
              simple: Note Regarding The Offense
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: 7dd34ab2-e86b-4b9b-8a3b-a852af1af32a
    type: regular
    task:
      id: 7dd34ab2-e86b-4b9b-8a3b-a852af1af32a
      version: -1
      name: Note List
      description: Create a note on an offense.
      script: '|||qradar-offense-notes-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      note_id:
        simple: ${QRadar.Note.ID}
      offense_id:
        simple: ${OffenseID}
      range:
        simple: 0-1
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: b2755b9c-ef75-415f-83ee-bc56a5838d08
    type: condition
    task:
      id: b2755b9c-ef75-415f-83ee-bc56a5838d08
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "13"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Note.Text
            iscontext: true
          right:
            value:
              simple: Note Regarding The Offense
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: 1234b992-7c1f-4795-8ed0-624ed3d4ea95
    type: regular
    task:
      id: 1234b992-7c1f-4795-8ed0-624ed3d4ea95
      version: -1
      name: Get Closing Reasons List
      description: Retrieve a list of offense closing reasons.
      script: '|||qradar-closing-reasons'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      filter:
        simple: id <= 2
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 9e27e38a-3de0-49fc-80e9-5f666760a57f
    type: condition
    task:
      id: 9e27e38a-3de0-49fc-80e9-5f666760a57f
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "15"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: hasLength
          left:
            value:
              simple: QRadar.Offense.ClosingReasons.ID
            iscontext: true
          right:
            value:
              simple: "2"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.ClosingReasons.ID
            iscontext: true
          right:
            value:
              simple: "1"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.ClosingReasons.ID
            iscontext: true
          right:
            value:
              simple: "2"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.ClosingReasons.Name
            iscontext: true
          right:
            value:
              simple: False-Positive, Tuned
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.ClosingReasons.Name
            iscontext: true
          right:
            value:
              simple: Non-Issue
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 9843704c-f1e1-4e9e-83a0-04835718d81d
    type: regular
    task:
      id: 9843704c-f1e1-4e9e-83a0-04835718d81d
      version: -1
      name: Rules List
      description: Retrieves a list of rules.
      script: '|||qradar-rules-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      filter:
        simple: id between 100001 AND 100006
      range:
        simple: 0-5
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: f886e0c9-2ce5-4d7e-8479-868f5de9cd21
    type: condition
    task:
      id: f886e0c9-2ce5-4d7e-8479-868f5de9cd21
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "17"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.Name
            iscontext: true
          right:
            value:
              simple: Devices with High Event Rates
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.Owner
            iscontext: true
          right:
            value:
              simple: admin
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.CreationDate
            iscontext: true
          right:
            value:
              simple: "2007-08-09T14:38:27.862000+00:00"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.Origin
            iscontext: true
          right:
            value:
              simple: SYSTEM
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.Type
            iscontext: true
          right:
            value:
              simple: EVENT
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.ID
            iscontext: true
          right:
            value:
              simple: "100001"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.ID
            iscontext: true
          right:
            value:
              simple: "100003"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.ID
            iscontext: true
          right:
            value:
              simple: "100006"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: 68023ecb-7ce1-4bb5-8d45-20d1fbc597cb
    type: regular
    task:
      id: 68023ecb-7ce1-4bb5-8d45-20d1fbc597cb
      version: -1
      name: Group Rule List
      description: Retrieves a list of the rule groups.
      script: '|||qradar-rule-groups-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      range:
        simple: 0-0
      rule_group_id:
        simple: "125"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: 5d86f750-f57b-448e-8b09-2e7266f5c840
    type: condition
    task:
      id: 5d86f750-f57b-448e-8b09-2e7266f5c840
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "19"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RuleGroup.Owner
            iscontext: true
          right:
            value:
              simple: admin
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RuleGroup.ID
            iscontext: true
          right:
            value:
              simple: "125"
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RuleGroup.Name
            iscontext: true
          right:
            value:
              simple: Asset Reconciliation Exclusion
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RuleGroup.Type
            iscontext: true
          right:
            value:
              simple: RULE_GROUP
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: c991a8aa-ea91-4dfc-8251-b732a537f2fd
    type: regular
    task:
      id: c991a8aa-ea91-4dfc-8251-b732a537f2fd
      version: -1
      name: Assets List
      description: Retrieves assets list.
      script: '|||qradar-assets-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      asset_id:
        simple: "1007"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 478260da-4bb8-446a-8ef2-1a09141934d9
    type: condition
    task:
      id: 478260da-4bb8-446a-8ef2-1a09141934d9
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "21"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Asset.ID
            iscontext: true
          right:
            value:
              simple: "1007"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Asset.DomainID
            iscontext: true
          right:
            value:
              simple: "0"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: 0e77b4f3-59f8-4160-8eeb-9ec7dad59cbe
    type: regular
    task:
      id: 0e77b4f3-59f8-4160-8eeb-9ec7dad59cbe
      version: -1
      name: Create Reference Set
      description: Create a new reference set.
      script: '|||qradar-reference-set-create'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      element_type:
        simple: DATE
      ref_name:
        simple: Test-Reference-Name_2
      time_to_live:
        simple: 1 day
      timeout_type:
        simple: FIRST_SEEN
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3695
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 87ca6199-445a-492e-80ef-c86a996eb843
    type: condition
    task:
      id: 87ca6199-445a-492e-80ef-c86a996eb843
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "25"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Reference.TimeToLive
            iscontext: true
          right:
            value:
              simple: 0 years 0 mons 1 days 0 hours 0 mins 0.0 secs
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Reference.TimeoutType
            iscontext: true
          right:
            value:
              simple: FIRST_SEEN
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Reference.NumberOfElements
            iscontext: true
          right:
            value:
              simple: "0"
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Reference.Name
            iscontext: true
          right:
            value:
              simple: Test-Reference-Name_2
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Reference.ElementType
            iscontext: true
          right:
            value:
              simple: DATE
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: 69d8d223-d50c-40b7-88d6-17e831de36c3
    type: regular
    task:
      id: 69d8d223-d50c-40b7-88d6-17e831de36c3
      version: -1
      name: Get Reference Details
      description: Retrieve a list of reference sets.
      script: '|||qradar-reference-sets-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      ref_name:
        simple: Test-Reference-Name_2
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "25":
    id: "25"
    taskid: 85a358ae-f4d6-46bb-8ab5-ae8f74156d4e
    type: regular
    task:
      id: 85a358ae-f4d6-46bb-8ab5-ae8f74156d4e
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "60"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: OffenseID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4045
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: da1e46db-bca9-4677-8850-e396c9966436
    type: regular
    task:
      id: da1e46db-bca9-4677-8850-e396c9966436
      version: -1
      name: Add Value To Reference
      description: Add or update an element in a reference set.
      script: '|||qradar-reference-set-value-upsert'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "28"
    scriptarguments:
      date_value:
        simple: "True"
      ref_name:
        simple: Test-Reference-Name_2
      value:
        simple: "2020-12-12T12:12:12Z"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: 70129c24-49a5-409c-8162-54f4d25d119f
    type: condition
    task:
      id: 70129c24-49a5-409c-8162-54f4d25d119f
      version: -1
      name: Validate Outputs, With New Element Count
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "29"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Reference.NumberOfElements
            iscontext: true
          right:
            value:
              simple: "1"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Reference.Name
            iscontext: true
          right:
            value:
              simple: Test-Reference-Name_2
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Reference.Data.Value
            iscontext: true
          right:
            value:
              simple: "1607775132000"
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Reference.TimeoutType
            iscontext: true
          right:
            value:
              simple: FIRST_SEEN
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: 321b8bda-e432-4d47-8fa6-9b4c28527488
    type: regular
    task:
      id: 321b8bda-e432-4d47-8fa6-9b4c28527488
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: OffenseID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5095
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: 81680b62-9e39-4758-8eab-a1503178e2ee
    type: regular
    task:
      id: 81680b62-9e39-4758-8eab-a1503178e2ee
      version: -1
      name: Delete Reference Set Value
      description: Remove a value from a reference set.
      script: '|||qradar-reference-set-value-delete'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      date_value:
        simple: "True"
      ref_name:
        simple: Test-Reference-Name_2
      value:
        simple: "2020-12-12T12:12:12Z"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: 1a965565-3354-4afa-816b-8549ddbf6a6f
    type: regular
    task:
      id: 1a965565-3354-4afa-816b-8549ddbf6a6f
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: OffenseID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5795
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: b4601fd5-40ec-4e30-840d-bbf14747d3e8
    type: regular
    task:
      id: b4601fd5-40ec-4e30-840d-bbf14747d3e8
      version: -1
      name: Get Reference With The Deleted Value
      description: Retrieve a list of reference sets.
      script: '|||qradar-reference-sets-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      ref_name:
        simple: Test-Reference-Name_2
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: 6d3cea0a-704b-4481-885a-77dd39eb5279
    type: condition
    task:
      id: 6d3cea0a-704b-4481-885a-77dd39eb5279
      version: -1
      name: Validate Outputs, Validate Element Count Decreased
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "33"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Reference.NumberOfElements
            iscontext: true
          right:
            value:
              simple: "0"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 6145
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: f40c1660-a1c7-468d-867a-e2f669d1d09c
    type: regular
    task:
      id: f40c1660-a1c7-468d-867a-e2f669d1d09c
      version: -1
      name: Delete Reference Set
      description: Removes a reference set or purges its contents.
      script: '|||qradar-reference-set-delete'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      ref_name:
        simple: Test-Reference-Name_2
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 6320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: 59349a8f-189d-4d07-8ab7-69cde83658d1
    type: regular
    task:
      id: 59349a8f-189d-4d07-8ab7-69cde83658d1
      version: -1
      name: Get Domains List
      description: Gets the list of domains. You must have the System Administrator
        or Security Administrator permissions to call this endpoint if you are trying
        to retrieve the details of all domains. You can retrieve details of domains
        that are assigned to your Security Profile without having the System Administrator
        or Security Administrator permissions. If you do not have the System Administrator
        or Security Administrator permissions, then for each domain assigned to your
        security profile you can only view the values for the id and name fields.
        All other values return null.
      script: '|||qradar-domains-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "35"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 6495
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: c8913430-7db4-40b9-8d96-dd13d4b24ad7
    type: condition
    task:
      id: c8913430-7db4-40b9-8d96-dd13d4b24ad7
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "36"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Domains.ID
            iscontext: true
          right:
            value:
              simple: "0"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 6670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: 8a57d823-7bc9-4ebf-8c30-3269e2273db8
    type: regular
    task:
      id: 8a57d823-7bc9-4ebf-8c30-3269e2273db8
      version: -1
      name: Geolocations For IPs
      description: Retrieves the MaxMind geoip data for the given IP address.
      script: '|||qradar-geolocations-for-ip'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "37"
    scriptarguments:
      ip:
        simple: 1.2.3.4,1.2.3.5
      ips:
        simple: 1.2.3.4,1.2.3.5
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 6845
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: 78fec288-be4a-4d83-8d24-ec9ff51478ea
    type: condition
    task:
      id: 78fec288-be4a-4d83-8d24-ec9ff51478ea
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "38"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.IPAddress
            iscontext: true
          right:
            value:
              simple: 1.2.3.4
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.GeoForIP.IPAddress
            iscontext: true
          right:
            value:
              simple: 1.2.3.5
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.CityName
            iscontext: true
          right:
            value:
              simple: Mukilteo
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.ContinentName
            iscontext: true
          right:
            value:
              simple: NorthAmerica
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.LocationLongitude
            iscontext: true
          right:
            value:
              simple: "-122.3042"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.LocationTimezone
            iscontext: true
          right:
            value:
              simple: America/Los_Angeles
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.PhysicalCountryName
            iscontext: true
          right:
            value:
              simple: United States
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.PostalCode
            iscontext: true
          right:
            value:
              simple: "98275"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 7020
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: 1e983296-69f1-446c-8cfb-71f350214586
    type: regular
    task:
      id: 1e983296-69f1-446c-8cfb-71f350214586
      version: -1
      name: Sources List
      description: Retrieves a list of log sources.
      script: '|||qradar-log-sources-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "39"
    scriptarguments:
      filter:
        simple: id=112
      qrd_encryption_algorithm:
        simple: AES128
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 7195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: 86434683-d44a-4456-80b0-33b47893402e
    type: condition
    task:
      id: 86434683-d44a-4456-80b0-33b47893402e
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "40"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.LogSource.ID
            iscontext: true
          right:
            value:
              simple: "112"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.LogSource.Credibility
            iscontext: true
          right:
            value:
              simple: "5"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.LogSource.TypeID
            iscontext: true
          right:
            value:
              simple: "12"
      - - operator: isFalse
          left:
            value:
              simple: QRadar.LogSource.Gateway
            iscontext: true
      - - operator: isTrue
          left:
            value:
              simple: QRadar.LogSource.AutoDiscovered
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 7370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: 7502088c-f458-4cd0-8f4b-0e7a2dc4a61f
    type: regular
    task:
      id: 7502088c-f458-4cd0-8f4b-0e7a2dc4a61f
      version: -1
      name: Custom Properties
      description: Retrieves a list of event regex properties.
      script: '|||qradar-get-custom-properties'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "41"
    scriptarguments:
      filter:
        simple: id = 129 OR id = 212
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 7545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: b7129c7b-f404-4099-8380-2a613c813e8d
    type: condition
    task:
      id: b7129c7b-f404-4099-8380-2a613c813e8d
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "43"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Properties.name
            iscontext: true
          right:
            value:
              simple: Filename
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Properties.username
            iscontext: true
          right:
            value:
              simple: admin
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Properties.property_type
            iscontext: true
          right:
            value:
              simple: string
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 7720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: 06d608b7-05d0-403d-80bb-8198e331554d
    type: regular
    task:
      id: 06d608b7-05d0-403d-80bb-8198e331554d
      version: -1
      name: Get Saved Searches
      description: Retrieves a list of Ariel saved searches.
      script: '|||qradar-saved-searches-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "44"
    scriptarguments:
      range:
        simple: 0-1
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 7895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "44":
    id: "44"
    taskid: 3c5de55e-9eca-4c18-8c8d-5078ad672b1d
    type: regular
    task:
      id: 3c5de55e-9eca-4c18-8c8d-5078ad672b1d
      version: -1
      name: Get Search IDs
      description: Retrieves the list of Ariel searches IDs. Search status and results
        can be polled by sending search ID to 'qradar-search-status-get' and 'qradar-search-results-get'
        commands.
      script: '|||qradar-searches-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "45"
    scriptarguments:
      range:
        simple: 0-2
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 8070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: 6d2a5207-15bd-464e-80f5-d48a46861c45
    type: playbook
    task:
      id: 6d2a5207-15bd-464e-80f5-d48a46861c45
      version: -1
      name: QRadarFullSearch
      description: This playbook runs a QRadar query and return its results to the
        context.
      playbookName: QRadarFullSearch
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "46"
    scriptarguments:
      interval:
        simple: "1"
      query_expression:
        complex:
          root: OffenseID
          transformers:
          - operator: concat
            args:
              prefix:
                value:
                  simple: SELECT QIDNAME(qid), LOGSOURCENAME(logsourceid), CATEGORYNAME(highlevelcategory),
                    CATEGORYNAME(category), PROTOCOLNAME(protocolid), sourceip, sourceport,
                    destinationip, destinationport, QIDDESCRIPTION(qid), username,
                    PROTOCOLNAME(protocolid), RULENAME("creEventList"), sourcegeographiclocation,
                    sourceMAC, sourcev6, destinationgeographiclocation, destinationv6,
                    LOGSOURCETYPENAME(devicetype), credibility, severity, magnitude,
                    eventcount, eventDirection, postNatDestinationIP, postNatDestinationPort,
                    postNatSourceIP, postNatSourcePort, preNatDestinationPort, preNatSourceIP,
                    preNatSourcePort, UTF8(payload), starttime, devicetime  FROM events
                    WHERE INOFFENSE(
              suffix:
                value:
                  simple: )  limit 20 START 1605046453426
      timeout:
        simple: "600"
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 265,
          "y": 8245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: c2944665-02b5-4aa0-83e4-3821b3dcb9cd
    type: regular
    task:
      id: c2944665-02b5-4aa0-83e4-3821b3dcb9cd
      version: -1
      name: Get Source IPs
      description: Get Source IPs
      script: '|||qradar-ips-source-get'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "47"
    scriptarguments:
      range:
        simple: 0-0
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 8420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: 0b9d0328-4e38-41b9-8a7d-14be438e57ee
    type: condition
    task:
      id: 0b9d0328-4e38-41b9-8a7d-14be438e57ee
      version: -1
      name: Does Results Exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "48"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: QRadar.SourceIP.ID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 8595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: dfd9672d-b1f6-4f31-8532-b90747da4e27
    type: regular
    task:
      id: dfd9672d-b1f6-4f31-8532-b90747da4e27
      version: -1
      name: Get Local Destination IPs
      description: Get Source IPs
      script: '|||qradar-ips-local-destination-get'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "49"
    scriptarguments:
      range:
        simple: 0-0
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 8770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: 9899151b-1a89-4fe3-88db-3aab1498d5ae
    type: condition
    task:
      id: 9899151b-1a89-4fe3-88db-3aab1498d5ae
      version: -1
      name: Does Results Exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "63"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: QRadar.LocalDestinationIP.ID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 8945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "52":
    id: "52"
    taskid: 404fa1a7-9b19-4b17-8543-623574c8e0ae
    type: regular
    task:
      id: 404fa1a7-9b19-4b17-8543-623574c8e0ae
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "26"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: OffenseID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4745
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: 6699fecd-4615-4d26-8311-ff9635d3c87d
    type: regular
    task:
      id: 6699fecd-4615-4d26-8311-ff9635d3c87d
      version: -1
      name: 'create reference set with #'
      description: Creates a new reference set.
      script: '|||qradar-reference-set-create'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "61"
    scriptarguments:
      element_type:
        simple: IP
      ref_name:
        simple: '# testing name'
      time_to_live:
        simple: 1 day
      timeout_type:
        simple: FIRST_SEEN
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    id: "61"
    taskid: 711b6d38-02db-4bb5-8801-f44a198d7d6c
    type: regular
    task:
      id: 711b6d38-02db-4bb5-8801-f44a198d7d6c
      version: -1
      name: 'set value to reference set that contains #'
      description: Adds or updates an element in a reference set.
      script: '|||qradar-reference-set-value-upsert'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "62"
    scriptarguments:
      ref_name:
        simple: '# testing name'
      value:
        simple: 8.8.8.8
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4395
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "62":
    id: "62"
    taskid: 2d8923b9-291d-43e6-864a-ad6f5dbe853e
    type: regular
    task:
      id: 2d8923b9-291d-43e6-864a-ad6f5dbe853e
      version: -1
      name: 'delete reference set with #'
      description: Removes a reference set or purges its contents.
      script: '|||qradar-reference-set-delete'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "52"
    scriptarguments:
      ref_name:
        simple: '# testing name'
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: e114ee31-9ea5-4967-8c70-dce045124aad
    type: regular
    task:
      id: e114ee31-9ea5-4967-8c70-dce045124aad
      version: -1
      name: Get events with polling
      description: Polling command to search for events of a specific offense.
      script: '|||qradar-search-retrieve-events'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "64"
    scriptarguments:
      offense_id:
        simple: "194"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 9120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "64":
    id: "64"
    taskid: b89948e7-04de-4f18-8e55-e9e963fa0093
    type: condition
    task:
      id: b89948e7-04de-4f18-8e55-e9e963fa0093
      version: -1
      name: Validate polling
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "67"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: QRadar.SearchEvents.ID
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              simple: QRadar.SearchEvents.Events
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 9295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "65":
    id: "65"
    taskid: daf3b9d9-6144-4365-8caf-11aa597de22f
    type: regular
    task:
      id: daf3b9d9-6144-4365-8caf-11aa597de22f
      version: -1
      name: get events with polling custom query
      description: Polling command to search for events of a specific offense.
      script: '|||qradar-search-retrieve-events'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "66"
    scriptarguments:
      query_expression:
        simple: SELECT * FROM events WHERE INOFFENSE(194) limit 3 start 3600000
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 9645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "66":
    id: "66"
    taskid: abd03401-879f-4c3e-8c38-1338c995a5e6
    type: condition
    task:
      id: abd03401-879f-4c3e-8c38-1338c995a5e6
      version: -1
      name: Validate polling
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "68"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: QRadar.SearchEvents.ID
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              simple: QRadar.SearchEvents.Events
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 9820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "67":
    id: "67"
    taskid: 37ffdea8-a1b9-4d46-8ec7-99eea8446715
    type: regular
    task:
      id: 37ffdea8-a1b9-4d46-8ec7-99eea8446715
      version: -1
      name: Delete Context
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "65"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 9470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "68":
    id: "68"
    taskid: 08c0a19f-1036-4632-876e-c1ee2555cb21
    type: regular
    task:
      id: 08c0a19f-1036-4632-876e-c1ee2555cb21
      version: -1
      name: Delete Context
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "69"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 9995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "69":
    id: "69"
    taskid: 939487ee-9f0b-440f-89f1-9ac06aa3ea39
    type: regular
    task:
      id: 939487ee-9f0b-440f-89f1-9ac06aa3ea39
      version: -1
      name: Create Remote network cidrs
      description: Create remote network cidrs
      script: '|||qradar-remote-network-cidr-create'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "70"
    scriptarguments:
      cidrs:
        simple: 127.0.0.1/32
      description:
        simple: playbook-test
      group:
        simple: playbook-test-group
      name:
        simple: playbook-test
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 10170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "70":
    id: "70"
    taskid: bef64341-03d1-45f2-8f16-a63d3662707c
    type: regular
    task:
      id: bef64341-03d1-45f2-8f16-a63d3662707c
      version: -1
      name: Remote network cidrs List
      description: Retrieves the list of staged remote networks.
      script: '|||qradar-remote-network-cidr-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "71"
    scriptarguments:
      group:
        simple: playbook-test-group
      name:
        simple: playbook-test
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 10345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "71":
    id: "71"
    taskid: a2e6a768-d2f9-4083-8893-947eec54df79
    type: condition
    task:
      id: a2e6a768-d2f9-4083-8893-947eec54df79
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "80"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RemoteNetworkCIDR.name
            iscontext: true
          right:
            value:
              simple: playbook-test
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 10520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "72":
    id: "72"
    taskid: cd2ce60f-03ef-483e-812d-0adda63fefba
    type: regular
    task:
      id: cd2ce60f-03ef-483e-812d-0adda63fefba
      version: -1
      name: Update Remote network cidrs
      description: Updates an existing staged remote network.
      script: '|||qradar-remote-network-cidr-update'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "73"
    scriptarguments:
      cidrs:
        simple: 127.0.0.1/32,1.2.3.4/8
      description:
        simple: playbook-test-updated
      group:
        simple: playbook-test-group-updated
      id:
        simple: ${QRadar.RemoteNetworkCIDR.id}
      name:
        simple: playbook-test-updated
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 10870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "73":
    id: "73"
    taskid: bd49851e-55e8-43be-85d8-c135c9aabaa9
    type: condition
    task:
      id: bd49851e-55e8-43be-85d8-c135c9aabaa9
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "74"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RemoteNetworkCIDR.name
            iscontext: true
          right:
            value:
              simple: playbook-test-updated
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RemoteNetworkCIDR.group
            iscontext: true
          right:
            value:
              simple: playbook-test-group-updated
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RemoteNetworkCIDR.description
            iscontext: true
          right:
            value:
              simple: playbook-test-updated
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 11045
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "74":
    id: "74"
    taskid: 015be05d-4dbd-4ba6-83c7-c8b74ef7ec73
    type: regular
    task:
      id: 015be05d-4dbd-4ba6-83c7-c8b74ef7ec73
      version: -1
      name: Delete Remote network cidrs
      description: Deletes an existing staged remote network.
      script: '|||qradar-remote-network-cidr-delete'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      id:
        simple: ${QRadar.RemoteNetworkCIDR.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 11220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "75":
    id: "75"
    taskid: 1905b7c1-39ed-4bbd-8281-5749ce3a5eca
    type: regular
    task:
      id: 1905b7c1-39ed-4bbd-8281-5749ce3a5eca
      version: -1
      name: Write ID
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      key:
        simple: OffenseID
      value:
        complex:
          root: QRadar.Offense
          accessor: ID
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "76":
    id: "76"
    taskid: 53aba35b-12a8-46e6-8888-fe60559d29ca
    type: regular
    task:
      id: 53aba35b-12a8-46e6-8888-fe60559d29ca
      version: -1
      name: DeleteContext
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: OffenseID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "78":
    id: "78"
    taskid: 22214255-e956-4117-8770-bfaca4ab8539
    type: regular
    task:
      id: 22214255-e956-4117-8770-bfaca4ab8539
      version: -1
      name: Delete Reference Set
      description: Removes a reference set or purges its contents.
      script: '|||qradar-reference-set-delete'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    scriptarguments:
      ref_name:
        simple: Test-Reference-Name_2
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "79":
    id: "79"
    taskid: 7efce835-1e9c-4736-87ef-9dd49f0206da
    type: regular
    task:
      id: 7efce835-1e9c-4736-87ef-9dd49f0206da
      version: -1
      name: 'delete reference set with #'
      description: Removes a reference set or purges its contents.
      script: '|||qradar-reference-set-delete'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    scriptarguments:
      ref_name:
        simple: '# testing name'
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "80":
    id: "80"
    taskid: 0aecfe80-8d65-4d62-86f4-edf58e94f487
    type: regular
    task:
      id: 0aecfe80-8d65-4d62-86f4-edf58e94f487
      version: -1
      name: Delete Remote network cidrs
      description: Deletes an existing staged remote network.
      script: '|||qradar-remote-network-cidr-delete'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "72"
    scriptarguments:
      id:
        simple: ${QRadar.RemoteNetworkCIDR.id}
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 10695
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 11410,
        "width": 810,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
