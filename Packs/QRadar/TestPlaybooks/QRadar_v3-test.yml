id: QRadar_v3-test
version: -1
vcShouldKeepItemLegacyProdMachine: false
name: QRadar_v3-test
description: QRadar v3 test playbook. Tests commands of QRadar, validates outputs
  and expected behaviour.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: dcf401e1-c681-487d-8068-a9a8c5a706ec
    type: start
    task:
      id: dcf401e1-c681-487d-8068-a9a8c5a706ec
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "78"
      - "79"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: ccfe56db-9d49-4238-850f-cca21028e77a
    type: regular
    task:
      id: ccfe56db-9d49-4238-850f-cca21028e77a
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: 922ba9b9-1057-4840-81cf-8cbbc88ca9d2
    type: regular
    task:
      id: 922ba9b9-1057-4840-81cf-8cbbc88ca9d2
      version: -1
      name: Offense List
      description: Gets offenses from QRadar.
      script: '|||qradar-offenses-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "75"
    scriptarguments:
      enrichment:
        simple: IPs
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 94bb080d-8d73-452d-83f1-44e110ba7028
    type: condition
    task:
      id: 94bb080d-8d73-452d-83f1-44e110ba7028
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "76"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: QRadar.Offense.Magnitude
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: QRadar.Offense.Credibility
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: QRadar.Offense.ID
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: QRadar.Offense.Rules.name
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: QRadar.Offense.OffenseType
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: QRadar.Offense.OffenseType
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: QRadar.Offense.Status
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: ba5d2970-6a84-4489-8b5e-1e0b64590c4d
    type: title
    task:
      id: ba5d2970-6a84-4489-8b5e-1e0b64590c4d
      version: -1
      name: Test Playbook Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 16995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 490751dc-f8da-4453-8403-05666addb241
    type: regular
    task:
      id: 490751dc-f8da-4453-8403-05666addb241
      version: -1
      name: Update Offense
      description: Update an offense.
      script: '|||qradar-offense-update'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      follow_up:
        simple: "true"
      offense_id:
        simple: ${OffenseID}
      protected:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: d3ca6b40-7534-4d78-81f6-74522c3c588a
    type: condition
    task:
      id: d3ca6b40-7534-4d78-81f6-74522c3c588a
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "8"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isTrue
          left:
            value:
              simple: QRadar.Offense.Followup
            iscontext: true
          right:
            value: {}
      - - operator: isTrue
          left:
            value:
              simple: QRadar.Offense.Protected
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Offense.ID
            iscontext: true
          right:
            value:
              simple: OffenseID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: f9d55993-bc22-46c9-8d09-2ee99d0eb54a
    type: regular
    task:
      id: f9d55993-bc22-46c9-8d09-2ee99d0eb54a
      version: -1
      name: Create Note To Offense
      description: Retrieve a list of notes for an offense.
      script: '|||qradar-offense-note-create'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      note_text:
        simple: Note Regarding The Offense
      offense_id:
        simple: ${OffenseID}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: a3f1ab8e-2394-4d99-8944-7d9c252bc791
    type: condition
    task:
      id: a3f1ab8e-2394-4d99-8944-7d9c252bc791
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "10"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Note.CreatedBy
            iscontext: true
          right:
            value:
              simple: 'API_user: admin'
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Note.Text
            iscontext: true
          right:
            value:
              simple: Note Regarding The Offense
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: da5547f7-6a4d-4de8-8866-8ce1f4f7cd0b
    type: regular
    task:
      id: da5547f7-6a4d-4de8-8866-8ce1f4f7cd0b
      version: -1
      name: Note List
      description: Create a note on an offense.
      script: '|||qradar-offense-notes-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      note_id:
        simple: ${QRadar.Note.ID}
      offense_id:
        simple: ${OffenseID}
      range:
        simple: 0-1
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 5b8b3b5c-4a24-4209-85f6-ac86b13ad668
    type: condition
    task:
      id: 5b8b3b5c-4a24-4209-85f6-ac86b13ad668
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "13"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Note.Text
            iscontext: true
          right:
            value:
              simple: Note Regarding The Offense
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: cbe7c4f4-8d65-46c2-8d1b-f0aeeeaac3eb
    type: regular
    task:
      id: cbe7c4f4-8d65-46c2-8d1b-f0aeeeaac3eb
      version: -1
      name: Get Closing Reasons List
      description: Retrieve a list of offense closing reasons.
      script: '|||qradar-closing-reasons'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      filter:
        simple: id <= 2
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 96661558-f423-495f-848d-24b2f2b3823b
    type: condition
    task:
      id: 96661558-f423-495f-848d-24b2f2b3823b
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "15"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: hasLength
          left:
            value:
              simple: QRadar.Offense.ClosingReasons.ID
            iscontext: true
          right:
            value:
              simple: "2"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.ClosingReasons.ID
            iscontext: true
          right:
            value:
              simple: "1"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.ClosingReasons.ID
            iscontext: true
          right:
            value:
              simple: "2"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.ClosingReasons.Name
            iscontext: true
          right:
            value:
              simple: False-Positive, Tuned
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.ClosingReasons.Name
            iscontext: true
          right:
            value:
              simple: Non-Issue
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: bc0b61bb-d39e-4e7c-8dce-a494ccb449d9
    type: regular
    task:
      id: bc0b61bb-d39e-4e7c-8dce-a494ccb449d9
      version: -1
      name: Rules List
      description: Retrieves a list of rules.
      script: '|||qradar-rules-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      filter:
        simple: id between 100001 AND 100006
      range:
        simple: 0-5
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: 3e50a700-5b93-4385-8ef6-e8e04190c35b
    type: condition
    task:
      id: 3e50a700-5b93-4385-8ef6-e8e04190c35b
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "17"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.Name
            iscontext: true
          right:
            value:
              simple: Devices with High Event Rates
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.Owner
            iscontext: true
          right:
            value:
              simple: admin
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.CreationDate
            iscontext: true
          right:
            value:
              simple: "2007-08-09T14:38:27.862000+00:00"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.Origin
            iscontext: true
          right:
            value:
              simple: SYSTEM
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.Type
            iscontext: true
          right:
            value:
              simple: EVENT
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.ID
            iscontext: true
          right:
            value:
              simple: "100001"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.ID
            iscontext: true
          right:
            value:
              simple: "100003"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.ID
            iscontext: true
          right:
            value:
              simple: "100006"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: 91aedd2f-6872-4639-80ad-6e6e0c72ba80
    type: regular
    task:
      id: 91aedd2f-6872-4639-80ad-6e6e0c72ba80
      version: -1
      name: Group Rule List
      description: Retrieves a list of the rule groups.
      script: '|||qradar-rule-groups-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      range:
        simple: 0-0
      rule_group_id:
        simple: "125"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: 4dcf6e28-989c-48cd-8643-2240009079bb
    type: condition
    task:
      id: 4dcf6e28-989c-48cd-8643-2240009079bb
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "19"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RuleGroup.Owner
            iscontext: true
          right:
            value:
              simple: admin
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RuleGroup.ID
            iscontext: true
          right:
            value:
              simple: "125"
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RuleGroup.Name
            iscontext: true
          right:
            value:
              simple: Asset Reconciliation Exclusion
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RuleGroup.Type
            iscontext: true
          right:
            value:
              simple: RULE_GROUP
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: 42eaec7d-8d12-4e70-80fe-c305915b1c22
    type: regular
    task:
      id: 42eaec7d-8d12-4e70-80fe-c305915b1c22
      version: -1
      name: Assets List
      description: Retrieves assets list.
      script: '|||qradar-assets-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      asset_id:
        simple: "1003"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 9febebf0-875a-459a-8c3e-9284f43e8753
    type: condition
    task:
      id: 9febebf0-875a-459a-8c3e-9284f43e8753
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "21"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Asset.ID
            iscontext: true
          right:
            value:
              simple: "1003"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Asset.DomainID
            iscontext: true
          right:
            value:
              simple: "0"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: 1f8c7b9f-53aa-4b18-88ff-66fe2dd9d13d
    type: regular
    task:
      id: 1f8c7b9f-53aa-4b18-88ff-66fe2dd9d13d
      version: -1
      name: Create Reference Set
      description: Create a new reference set.
      script: '|||qradar-reference-set-create'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      element_type:
        simple: DATE
      ref_name:
        simple: Test-Reference-Name_2
      time_to_live:
        simple: 1 day
      timeout_type:
        simple: FIRST_SEEN
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3695
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 173fd206-6baf-48c8-8829-e2df0f5dda24
    type: condition
    task:
      id: 173fd206-6baf-48c8-8829-e2df0f5dda24
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "25"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Reference.TimeToLive
            iscontext: true
          right:
            value:
              simple: 0 years 0 mons 1 days 0 hours 0 mins 0.0 secs
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Reference.TimeoutType
            iscontext: true
          right:
            value:
              simple: FIRST_SEEN
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Reference.NumberOfElements
            iscontext: true
          right:
            value:
              simple: "0"
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Reference.Name
            iscontext: true
          right:
            value:
              simple: Test-Reference-Name_2
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Reference.ElementType
            iscontext: true
          right:
            value:
              simple: DATE
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: 8416ab44-e156-4e19-87fe-8b90028ee155
    type: regular
    task:
      id: 8416ab44-e156-4e19-87fe-8b90028ee155
      version: -1
      name: Get Reference Details
      description: Retrieve a list of reference sets.
      script: '|||qradar-reference-sets-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      ref_name:
        simple: Test-Reference-Name_2
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "25":
    id: "25"
    taskid: ee10b61f-30a6-4076-8418-d6fe06c48e70
    type: regular
    task:
      id: ee10b61f-30a6-4076-8418-d6fe06c48e70
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "60"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: OffenseID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4045
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: 2e343e70-89ff-4724-8318-ec2444641959
    type: regular
    task:
      id: 2e343e70-89ff-4724-8318-ec2444641959
      version: -1
      name: Add Value To Reference
      description: Add or update an element in a reference set.
      script: '|||qradar-reference-set-value-upsert'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "91"
    scriptarguments:
      date_value:
        simple: "True"
      ref_name:
        simple: Test-Reference-Name_2
      value:
        simple: "2020-12-12T12:12:12Z"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: ece328e8-a46f-4aac-8f00-43ae90abec88
    type: condition
    task:
      id: ece328e8-a46f-4aac-8f00-43ae90abec88
      version: -1
      name: Validate Outputs, With New Element Count
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "29"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Reference.NumberOfElements
            iscontext: true
          right:
            value:
              simple: "2"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Reference.Name
            iscontext: true
          right:
            value:
              simple: Test-Reference-Name_2
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Reference.Data.Value
            iscontext: true
          right:
            value:
              simple: "1607775132000"
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Reference.TimeoutType
            iscontext: true
          right:
            value:
              simple: FIRST_SEEN
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: 1406dab4-2992-44b6-863e-9d354191a9be
    type: regular
    task:
      id: 1406dab4-2992-44b6-863e-9d354191a9be
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: OffenseID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: 8434fd0f-2760-413c-8725-af384d3a0bad
    type: regular
    task:
      id: 8434fd0f-2760-413c-8725-af384d3a0bad
      version: -1
      name: Delete Reference Set Value
      description: Remove a value from a reference set.
      script: '|||qradar-reference-set-value-delete'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      date_value:
        simple: "True"
      ref_name:
        simple: Test-Reference-Name_2
      value:
        simple: "2020-12-12T12:12:12Z"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5795
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: 8245cfea-c12f-46e1-8880-04793b65fae6
    type: regular
    task:
      id: 8245cfea-c12f-46e1-8880-04793b65fae6
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: OffenseID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: dbf0a88a-5a96-41a1-8968-38a6120097f5
    type: regular
    task:
      id: dbf0a88a-5a96-41a1-8968-38a6120097f5
      version: -1
      name: Get Reference With The Deleted Value
      description: Retrieve a list of reference sets.
      script: '|||qradar-reference-sets-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      ref_name:
        simple: Test-Reference-Name_2
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 6145
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: 84f9f096-8310-4ba4-803c-d071214d0b48
    type: condition
    task:
      id: 84f9f096-8310-4ba4-803c-d071214d0b48
      version: -1
      name: Validate Outputs, Validate Element Count Decreased
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "33"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Reference.NumberOfElements
            iscontext: true
          right:
            value:
              simple: "1"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 6320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: 1d706ec1-04b7-42b3-8818-6b2ceeaf444c
    type: regular
    task:
      id: 1d706ec1-04b7-42b3-8818-6b2ceeaf444c
      version: -1
      name: Delete Reference Set
      description: Removes a reference set or purges its contents.
      script: '|||qradar-reference-set-delete'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      ref_name:
        simple: Test-Reference-Name_2
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 6495
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: 6b852922-b92d-47b8-8e34-efedff0c5b8c
    type: regular
    task:
      id: 6b852922-b92d-47b8-8e34-efedff0c5b8c
      version: -1
      name: Get Domains List
      description: Gets the list of domains. You must have the System Administrator
        or Security Administrator permissions to call this endpoint if you are trying
        to retrieve the details of all domains. You can retrieve details of domains
        that are assigned to your Security Profile without having the System Administrator
        or Security Administrator permissions. If you do not have the System Administrator
        or Security Administrator permissions, then for each domain assigned to your
        security profile you can only view the values for the id and name fields.
        All other values return null.
      script: '|||qradar-domains-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "35"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 6670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: 13263572-6663-4288-8d01-2c6c5cf1c9f5
    type: condition
    task:
      id: 13263572-6663-4288-8d01-2c6c5cf1c9f5
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "36"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Domains.ID
            iscontext: true
          right:
            value:
              simple: "0"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 6845
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: d6e89a3a-d57c-4004-891b-26472b53edf4
    type: regular
    task:
      id: d6e89a3a-d57c-4004-891b-26472b53edf4
      version: -1
      name: Geolocations For IPs
      description: Retrieves the MaxMind geoip data for the given IP address.
      script: '|||qradar-geolocations-for-ip'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "37"
    scriptarguments:
      ip:
        simple: 1.2.3.4,1.2.3.5
      ips:
        simple: 1.2.3.4,1.2.3.5
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 7020
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: 6798a0c9-9b5f-494b-83e8-55ffa463e8f0
    type: condition
    task:
      id: 6798a0c9-9b5f-494b-83e8-55ffa463e8f0
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "94"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.IPAddress
            iscontext: true
          right:
            value:
              simple: 1.2.3.4
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.GeoForIP.IPAddress
            iscontext: true
          right:
            value:
              simple: 1.2.3.5
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.CityName
            iscontext: true
          right:
            value:
              simple: Mukilteo
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.ContinentName
            iscontext: true
          right:
            value:
              simple: NorthAmerica
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.LocationLongitude
            iscontext: true
          right:
            value:
              simple: "-122.3042"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.LocationTimezone
            iscontext: true
          right:
            value:
              simple: America/Los_Angeles
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.PhysicalCountryName
            iscontext: true
          right:
            value:
              simple: United States
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.PostalCode
            iscontext: true
          right:
            value:
              simple: "98275"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 7195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: 94729494-a0d1-4353-8761-0c3812a719fb
    type: regular
    task:
      id: 94729494-a0d1-4353-8761-0c3812a719fb
      version: -1
      name: Sources List
      description: Retrieves a list of log sources.
      script: '|||qradar-log-sources-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "39"
    scriptarguments:
      id:
        simple: ${log_source_id}
      qrd_encryption_algorithm:
        simple: AES128
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 8245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: 38ac3f20-5a19-4cc3-885f-724dcf3615a7
    type: condition
    task:
      id: 38ac3f20-5a19-4cc3-885f-724dcf3615a7
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "40"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.LogSource.Name
            iscontext: true
          right:
            value:
              simple: test_create
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 8420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: de6538eb-9cdb-4b66-88f3-7390aefe5c9e
    type: regular
    task:
      id: de6538eb-9cdb-4b66-88f3-7390aefe5c9e
      version: -1
      name: Custom Properties
      description: Retrieves a list of event regex properties.
      script: '|||qradar-get-custom-properties'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "41"
    scriptarguments:
      filter:
        simple: id = 212
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 8595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: 291d15e1-753a-418c-843c-f70765e2ee3d
    type: condition
    task:
      id: 291d15e1-753a-418c-843c-f70765e2ee3d
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "43"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Properties.name
            iscontext: true
          right:
            value:
              simple: Function
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Properties.username
            iscontext: true
          right:
            value:
              simple: admin
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Properties.property_type
            iscontext: true
          right:
            value:
              simple: string
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 8770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: 4e708209-d182-4872-899b-2f77693a9eca
    type: regular
    task:
      id: 4e708209-d182-4872-899b-2f77693a9eca
      version: -1
      name: Get Saved Searches
      description: Retrieves a list of Ariel saved searches.
      script: '|||qradar-saved-searches-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "44"
    scriptarguments:
      range:
        simple: 0-1
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 8945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "44":
    id: "44"
    taskid: 5b2096d5-2466-4401-89f6-4dcf662e81bf
    type: regular
    task:
      id: 5b2096d5-2466-4401-89f6-4dcf662e81bf
      version: -1
      name: Get Search IDs
      description: Retrieves the list of Ariel searches IDs. Search status and results
        can be polled by sending search ID to 'qradar-search-status-get' and 'qradar-search-results-get'
        commands.
      script: '|||qradar-searches-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "45"
    scriptarguments:
      range:
        simple: 0-2
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 9120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: d689e706-f1b8-4a48-8031-dfaa01cb855c
    type: playbook
    task:
      id: d689e706-f1b8-4a48-8031-dfaa01cb855c
      version: -1
      name: QRadarFullSearch
      description: This playbook runs a QRadar query and return its results to the
        context.
      playbookName: QRadarFullSearch
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "46"
    scriptarguments:
      interval:
        simple: "1"
      query_expression:
        complex:
          root: OffenseID
          transformers:
          - operator: concat
            args:
              prefix:
                value:
                  simple: SELECT QIDNAME(qid), LOGSOURCENAME(logsourceid), CATEGORYNAME(highlevelcategory),
                    CATEGORYNAME(category), PROTOCOLNAME(protocolid), sourceip, sourceport,
                    destinationip, destinationport, QIDDESCRIPTION(qid), username,
                    PROTOCOLNAME(protocolid), RULENAME("creEventList"), sourcegeographiclocation,
                    sourceMAC, sourcev6, destinationgeographiclocation, destinationv6,
                    LOGSOURCETYPENAME(devicetype), credibility, severity, magnitude,
                    eventcount, eventDirection, postNatDestinationIP, postNatDestinationPort,
                    postNatSourceIP, postNatSourcePort, preNatDestinationPort, preNatSourceIP,
                    preNatSourcePort, UTF8(payload), starttime, devicetime  FROM events
                    WHERE INOFFENSE(
              suffix:
                value:
                  simple: )  limit 20 START 1605046453426
      timeout:
        simple: "600"
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 265,
          "y": 9295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: bdfa022b-f1c8-44f1-878b-6aaef2f6fbb9
    type: regular
    task:
      id: bdfa022b-f1c8-44f1-878b-6aaef2f6fbb9
      version: -1
      name: Get Source IPs
      description: Get Source IPs
      script: '|||qradar-ips-source-get'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "47"
    scriptarguments:
      range:
        simple: 0-0
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 9470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: b9098ddf-e486-4bf9-85d4-1bd159fe3267
    type: condition
    task:
      id: b9098ddf-e486-4bf9-85d4-1bd159fe3267
      version: -1
      name: Does Results Exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "48"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: QRadar.SourceIP.ID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 9645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: 7726361b-609f-4dd5-8d28-4a609c7e5484
    type: regular
    task:
      id: 7726361b-609f-4dd5-8d28-4a609c7e5484
      version: -1
      name: Get Local Destination IPs
      description: Get Source IPs
      script: '|||qradar-ips-local-destination-get'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "49"
    scriptarguments:
      range:
        simple: 0-0
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 9820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: 6901f61f-d5a6-4f48-8711-7cebf51683a6
    type: condition
    task:
      id: 6901f61f-d5a6-4f48-8711-7cebf51683a6
      version: -1
      name: Does Results Exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "63"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: QRadar.LocalDestinationIP.ID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 9995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "52":
    id: "52"
    taskid: f7c72cbc-9683-4f22-8423-6b49e65713b6
    type: regular
    task:
      id: f7c72cbc-9683-4f22-8423-6b49e65713b6
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "26"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: OffenseID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4745
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: 0ac69fb3-2c9e-4b5b-850b-5f38b853c695
    type: regular
    task:
      id: 0ac69fb3-2c9e-4b5b-850b-5f38b853c695
      version: -1
      name: 'create reference set with #'
      description: Creates a new reference set.
      script: '|||qradar-reference-set-create'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "61"
    scriptarguments:
      element_type:
        simple: IP
      ref_name:
        simple: '# testing name'
      time_to_live:
        simple: 1 day
      timeout_type:
        simple: FIRST_SEEN
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    id: "61"
    taskid: fc655484-1f3d-4773-8e11-62ae63c8957b
    type: regular
    task:
      id: fc655484-1f3d-4773-8e11-62ae63c8957b
      version: -1
      name: 'set value to reference set that contains #'
      description: Adds or updates an element in a reference set.
      script: '|||qradar-reference-set-value-upsert'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "62"
    scriptarguments:
      ref_name:
        simple: '# testing name'
      value:
        simple: 8.8.8.8
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4395
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "62":
    id: "62"
    taskid: c1b3820f-13f0-4e9e-8600-87b1fe0bc7f3
    type: regular
    task:
      id: c1b3820f-13f0-4e9e-8600-87b1fe0bc7f3
      version: -1
      name: 'delete reference set with #'
      description: Removes a reference set or purges its contents.
      script: '|||qradar-reference-set-delete'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "52"
    scriptarguments:
      ref_name:
        simple: '# testing name'
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: e48cf498-10c9-4fce-84fa-5d8c51ce1912
    type: regular
    task:
      id: e48cf498-10c9-4fce-84fa-5d8c51ce1912
      version: -1
      name: Get events with polling
      description: Polling command to search for events of a specific offense.
      script: '|||qradar-search-retrieve-events'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "64"
    scriptarguments:
      offense_id:
        simple: ${OffenseID}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 10170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "64":
    id: "64"
    taskid: f2cb419c-d841-49f0-8b15-96adc746182b
    type: condition
    task:
      id: f2cb419c-d841-49f0-8b15-96adc746182b
      version: -1
      name: Validate polling
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "67"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: QRadar.SearchEvents.ID
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              simple: QRadar.SearchEvents.Events
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 10345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "65":
    id: "65"
    taskid: 3792c71f-600c-41c7-88c2-c05b71a0900b
    type: regular
    task:
      id: 3792c71f-600c-41c7-88c2-c05b71a0900b
      version: -1
      name: get events with polling custom query
      description: Polling command to search for events of a specific offense.
      script: '|||qradar-search-retrieve-events'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "66"
    scriptarguments:
      query_expression:
        simple: SELECT * FROM events WHERE INOFFENSE(${OffenseID}) limit 3 start 3600000
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 10695
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "66":
    id: "66"
    taskid: 0657ce65-2067-4801-8a41-45d7043d6d00
    type: condition
    task:
      id: 0657ce65-2067-4801-8a41-45d7043d6d00
      version: -1
      name: Validate polling
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "68"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: QRadar.SearchEvents.ID
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              simple: QRadar.SearchEvents.Events
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 10870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "67":
    id: "67"
    taskid: 1a82a7af-0190-4ecf-85a2-5ce565b460ff
    type: regular
    task:
      id: 1a82a7af-0190-4ecf-85a2-5ce565b460ff
      version: -1
      name: Delete Context
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "65"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: OffenseID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 10520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "68":
    id: "68"
    taskid: 872ea25f-9313-4241-84c9-435ad8912c0d
    type: regular
    task:
      id: 872ea25f-9313-4241-84c9-435ad8912c0d
      version: -1
      name: Delete Context
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "81"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 11045
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "69":
    id: "69"
    taskid: 16627c11-0e0a-4996-86f4-b3db32fe935c
    type: regular
    task:
      id: 16627c11-0e0a-4996-86f4-b3db32fe935c
      version: -1
      name: Create Remote network cidrs
      description: Create remote network cidrs
      script: '|||qradar-remote-network-cidr-create'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "70"
    scriptarguments:
      cidrs:
        simple: 127.0.0.1/32
      description:
        simple: playbook-test
      group:
        simple: playbook-test-group
      name:
        simple: playbook-test
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 11920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "70":
    id: "70"
    taskid: 61072953-34fb-4ccc-8684-439212580105
    type: regular
    task:
      id: 61072953-34fb-4ccc-8684-439212580105
      version: -1
      name: Remote network cidrs List
      description: Retrieves the list of staged remote networks.
      script: '|||qradar-remote-network-cidr-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "71"
    scriptarguments:
      group:
        simple: playbook-test-group
      name:
        simple: playbook-test
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 12095
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "71":
    id: "71"
    taskid: 3a1b36f9-1334-48c1-8b7b-3750ad140526
    type: condition
    task:
      id: 3a1b36f9-1334-48c1-8b7b-3750ad140526
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "89"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RemoteNetworkCIDR.name
            iscontext: true
          right:
            value:
              simple: playbook-test
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 12270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "72":
    id: "72"
    taskid: 943d9791-bc6c-4949-8f88-49331a11c8dc
    type: regular
    task:
      id: 943d9791-bc6c-4949-8f88-49331a11c8dc
      version: -1
      name: Update Remote network cidrs
      description: Updates an existing staged remote network.
      script: '|||qradar-remote-network-cidr-update'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "73"
    scriptarguments:
      cidrs:
        simple: 127.0.0.1/32,1.2.3.4/8
      description:
        simple: playbook-test-updated
      group:
        simple: playbook-test-group-updated
      id:
        simple: ${CidrID}
      name:
        simple: playbook-test-updated
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 13495
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "73":
    id: "73"
    taskid: 1f9aac93-3bb6-44d4-8224-c5eb05329a05
    type: condition
    task:
      id: 1f9aac93-3bb6-44d4-8224-c5eb05329a05
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "74"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RemoteNetworkCIDR.name
            iscontext: true
          right:
            value:
              simple: playbook-test-updated
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RemoteNetworkCIDR.group
            iscontext: true
          right:
            value:
              simple: playbook-test-group-updated
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RemoteNetworkCIDR.description
            iscontext: true
          right:
            value:
              simple: playbook-test-updated
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 13670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "74":
    id: "74"
    taskid: 09654f17-4b64-4a63-8e2a-10e3850c30ad
    type: regular
    task:
      id: 09654f17-4b64-4a63-8e2a-10e3850c30ad
      version: -1
      name: Delete Remote network cidrs
      description: Deletes an existing staged remote network.
      script: '|||qradar-remote-network-cidr-delete'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "99"
    scriptarguments:
      id:
        simple: ${QRadar.RemoteNetworkCIDR.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 13845
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "75":
    id: "75"
    taskid: bb0f7bfa-2e94-4de8-885e-7fd41312b907
    type: regular
    task:
      id: bb0f7bfa-2e94-4de8-885e-7fd41312b907
      version: -1
      name: Write ID
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      key:
        simple: OffenseID
      value:
        complex:
          root: QRadar.Offense
          accessor: ID
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "76":
    id: "76"
    taskid: c5f3c704-eb53-4c0c-8073-7e87f99d0f4c
    type: regular
    task:
      id: c5f3c704-eb53-4c0c-8073-7e87f99d0f4c
      version: -1
      name: DeleteContext
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: OffenseID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "78":
    id: "78"
    taskid: 877bb36a-f6e3-466e-8c9e-f8029661c709
    type: regular
    task:
      id: 877bb36a-f6e3-466e-8c9e-f8029661c709
      version: -1
      name: Delete Reference Set
      description: Removes a reference set or purges its contents.
      script: '|||qradar-reference-set-delete'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    scriptarguments:
      ref_name:
        simple: Test-Reference-Name_2
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "79":
    id: "79"
    taskid: 5da77c8f-4105-45cc-8b14-f3bd98cb5bc5
    type: regular
    task:
      id: 5da77c8f-4105-45cc-8b14-f3bd98cb5bc5
      version: -1
      name: 'delete reference set with #'
      description: Removes a reference set or purges its contents.
      script: '|||qradar-reference-set-delete'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    scriptarguments:
      ref_name:
        simple: '# testing name'
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "81":
    id: "81"
    taskid: 16acdc38-33a6-4726-8152-261f01a3e86e
    type: regular
    task:
      id: 16acdc38-33a6-4726-8152-261f01a3e86e
      version: -1
      name: Find old cidr
      description: Retrieves the list of staged remote networks.
      script: '|||qradar-remote-network-cidr-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "82"
    scriptarguments:
      name:
        simple: playbook-test
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 11220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "82":
    id: "82"
    taskid: b4266d65-7cf9-4556-84a5-67c50fe17c44
    type: condition
    task:
      id: b4266d65-7cf9-4556-84a5-67c50fe17c44
      version: -1
      name: If Exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "69"
      "yes":
      - "83"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: QRadar.RemoteNetworkCIDR.id
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 11395
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "83":
    id: "83"
    taskid: b16a7026-8c55-4484-8b15-8f6d5e9e20b7
    type: regular
    task:
      id: b16a7026-8c55-4484-8b15-8f6d5e9e20b7
      version: -1
      name: Delete old cidr
      description: Deletes an existing staged remote network.
      script: '|||qradar-remote-network-cidr-delete'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "84"
    scriptarguments:
      id:
        simple: ${QRadar.RemoteNetworkCIDR.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 11570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "84":
    id: "84"
    taskid: bdf89562-a8d4-46b5-8697-d81d5ff41c15
    type: regular
    task:
      id: bdf89562-a8d4-46b5-8697-d81d5ff41c15
      version: -1
      name: Delete Context
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "69"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 11745
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "85":
    id: "85"
    taskid: 9ff5d312-e08a-40ac-8345-a2c3029024b9
    type: regular
    task:
      id: 9ff5d312-e08a-40ac-8345-a2c3029024b9
      version: -1
      name: Find old cidr
      description: Retrieves the list of staged remote networks.
      script: '|||qradar-remote-network-cidr-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "86"
    scriptarguments:
      name:
        simple: playbook-test-updated
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 12795
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "86":
    id: "86"
    taskid: 617e6fda-768f-4bac-8743-81e83302186f
    type: condition
    task:
      id: 617e6fda-768f-4bac-8743-81e83302186f
      version: -1
      name: If Exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "72"
      exists:
      - "87"
    separatecontext: false
    conditions:
    - label: exists
      condition:
      - - operator: isExists
          left:
            value:
              simple: QRadar.RemoteNetworkCIDR.id
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 12970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "87":
    id: "87"
    taskid: a994492a-9265-4d5e-863b-3ad5f6bf6602
    type: regular
    task:
      id: a994492a-9265-4d5e-863b-3ad5f6bf6602
      version: -1
      name: Delete old cidr
      description: Deletes an existing staged remote network.
      script: '|||qradar-remote-network-cidr-delete'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "88"
    scriptarguments:
      id:
        simple: ${QRadar.RemoteNetworkCIDR.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 13145
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "88":
    id: "88"
    taskid: 6fc21351-0e22-4966-88c7-34c2bdda99c6
    type: regular
    task:
      id: 6fc21351-0e22-4966-88c7-34c2bdda99c6
      version: -1
      name: Delete Context
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "72"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: CidrID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 13320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "89":
    id: "89"
    taskid: a161f76f-dd93-4f16-8e52-46bcf979047e
    type: regular
    task:
      id: a161f76f-dd93-4f16-8e52-46bcf979047e
      version: -1
      name: WriteID
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "90"
    scriptarguments:
      key:
        simple: CidrID
      value:
        simple: ${QRadar.RemoteNetworkCIDR.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 12445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "90":
    id: "90"
    taskid: 13eedbef-3638-4c01-842d-970f2f640d19
    type: regular
    task:
      id: 13eedbef-3638-4c01-842d-970f2f640d19
      version: -1
      name: DeleteContext
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "85"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: CidrID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 12620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "91":
    id: "91"
    taskid: 87016f78-6ae0-4af6-87d1-0423ccdafa00
    type: regular
    task:
      id: 87016f78-6ae0-4af6-87d1-0423ccdafa00
      version: -1
      name: Add Values To Reference
      description: Add or update an element in a reference set.
      script: '|||qradar-reference-set-value-upsert'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "28"
    scriptarguments:
      date_value:
        simple: "True"
      ref_name:
        simple: Test-Reference-Name_2
      value:
        simple: 2020-12-01T12:12:12Z,2020-12-01T12:12:12Z
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5095
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "92":
    id: "92"
    taskid: 7ec68569-fddb-431e-8a68-308f682100dd
    type: regular
    task:
      id: 7ec68569-fddb-431e-8a68-308f682100dd
      version: -1
      name: Create Log Source
      description: Creates a new log source
      script: QRadar v3|||qradar-log-source-create
      type: regular
      iscommand: true
      brand: QRadar v3
    nexttasks:
      '#none#':
      - "93"
    scriptarguments:
      name:
        simple: test_create
      protocol_parameters:
        simple: incomingPayloadEncoding=UTF-8,identifier=example.org
      protocol_type_id:
        simple: "0"
      target_event_collector_id:
        simple: "7"
      type_id:
        simple: "11"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 7545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "93":
    id: "93"
    taskid: 5f1163a1-2399-45a2-8363-f22c91a23c63
    type: condition
    task:
      id: 5f1163a1-2399-45a2-8363-f22c91a23c63
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "98"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.LogSource.Name
            iscontext: true
          right:
            value:
              simple: test_create
      - - operator: isEqualNumber
          left:
            value:
              simple: QRadar.LogSource.ProtocolTypeID
            iscontext: true
          right:
            value:
              simple: "0"
      - - operator: isEqualNumber
          left:
            value:
              simple: QRadar.LogSource.TypeID
            iscontext: true
          right:
            value:
              simple: "11"
      - - operator: isEqualNumber
          left:
            value:
              simple: QRadar.LogSource.TargetEventCollectorID
            iscontext: true
          right:
            value:
              simple: "7"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 7720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "94":
    id: "94"
    taskid: 9cd35661-6122-4550-84ba-4469b14783c4
    type: regular
    task:
      id: 9cd35661-6122-4550-84ba-4469b14783c4
      version: -1
      name: Delete Log Source
      description: Deletes a log source by id or name. One of the arguments must be
        provided.
      script: QRadar v3|||qradar-log-source-delete
      type: regular
      iscommand: true
      brand: QRadar v3
    nexttasks:
      '#none#':
      - "92"
    scriptarguments:
      name:
        simple: test_create
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 7370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "97":
    id: "97"
    taskid: 7b992d98-4485-40ee-8c22-3bca7342e613
    type: regular
    task:
      id: 7b992d98-4485-40ee-8c22-3bca7342e613
      version: -1
      name: Delete Context
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "38"
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: QRadar.LogSource
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 8070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "98":
    id: "98"
    taskid: f479c0e2-328d-44c9-880c-5ebeaec2ccc2
    type: regular
    task:
      id: f479c0e2-328d-44c9-880c-5ebeaec2ccc2
      version: -1
      name: Set ID
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "97"
    scriptarguments:
      key:
        simple: log_source_id
      value:
        simple: ${QRadar.LogSource.ID}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 7895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "99":
    id: "99"
    taskid: a3a0830d-20a2-4833-8920-02db8a671bf3
    type: regular
    task:
      id: a3a0830d-20a2-4833-8920-02db8a671bf3
      version: -1
      name: Delete Context
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "100"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 14020
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "100":
    id: "100"
    taskid: 4d577bcf-08e8-471b-866a-ba76c346dc50
    type: regular
    task:
      id: 4d577bcf-08e8-471b-866a-ba76c346dc50
      version: -1
      name: Read Event Collectors
      description: Retrieves a list of event collectors.
      script: QRadar v3|||qradar-event-collectors-list
      type: regular
      iscommand: true
      brand: QRadar v3
    nexttasks:
      '#none#':
      - "101"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 14195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "101":
    id: "101"
    taskid: 3e928c11-2eba-4b32-87b8-79a2d5529ae2
    type: condition
    task:
      id: 3e928c11-2eba-4b32-87b8-79a2d5529ae2
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "103"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: QRadar.EventCollector
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 14370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "103":
    id: "103"
    taskid: ef2be2ef-46fe-4a91-8200-953d7b8b90ec
    type: regular
    task:
      id: ef2be2ef-46fe-4a91-8200-953d7b8b90ec
      version: -1
      name: Read WinCollect Destinations
      description: "Retrieves a list of WinCollect destinations. \nIn order to get
        wincollect_internal_destination_ids - filter internal=true needs to be used\nIn
        order to get wincollect_external_destination_ids - filter internal=false needs
        to be used\n"
      script: QRadar v3|||qradar-wincollect-destinations-list
      type: regular
      iscommand: true
      brand: QRadar v3
    nexttasks:
      '#none#':
      - "104"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 14545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "104":
    id: "104"
    taskid: 69205e32-779c-4c0f-8bd2-517e3e6288e5
    type: condition
    task:
      id: 69205e32-779c-4c0f-8bd2-517e3e6288e5
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "105"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: QRadar.WinCollectDestination
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 14720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "105":
    id: "105"
    taskid: 5df5ae15-b8ea-4e74-8424-9801f295a12b
    type: regular
    task:
      id: 5df5ae15-b8ea-4e74-8424-9801f295a12b
      version: -1
      name: Read Disconnected Log Collectors
      description: Retrieves a list of disconnected log collectors.
      script: QRadar v3|||qradar-disconnected-log-collectors-list
      type: regular
      iscommand: true
      brand: QRadar v3
    nexttasks:
      '#none#':
      - "106"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 14895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "106":
    id: "106"
    taskid: a22c07dc-eb27-4a69-8ad9-092d51bb51e7
    type: condition
    task:
      id: a22c07dc-eb27-4a69-8ad9-092d51bb51e7
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "107"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: QRadar.DisconnectedLogCollector
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 15070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "107":
    id: "107"
    taskid: 2583a285-9b4f-4048-8181-f873befa006d
    type: regular
    task:
      id: 2583a285-9b4f-4048-8181-f873befa006d
      version: -1
      name: Read Log Source Types
      description: Retrieves a list of log sources types.
      script: QRadar v3|||qradar-log-source-types-list
      type: regular
      iscommand: true
      brand: QRadar v3
    nexttasks:
      '#none#':
      - "108"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 15245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "108":
    id: "108"
    taskid: 8ae4e70d-5b0e-46ed-8419-9a8e28287356
    type: condition
    task:
      id: 8ae4e70d-5b0e-46ed-8419-9a8e28287356
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "109"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: QRadar.LogSourceTypesList
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 15420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "109":
    id: "109"
    taskid: f3c571f5-f851-4810-8325-0149e04154fb
    type: regular
    task:
      id: f3c571f5-f851-4810-8325-0149e04154fb
      version: -1
      name: Read Protocol Types
      script: '|||qradar-log-source-protocol-types-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "110"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 15595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "110":
    id: "110"
    taskid: cd7fdbf5-1870-4283-8dd8-5726ea4b4418
    type: condition
    task:
      id: cd7fdbf5-1870-4283-8dd8-5726ea4b4418
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "111"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: QRadar.LogSourceProtocolType
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 15770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "111":
    id: "111"
    taskid: b37672af-27cd-456c-8fa0-a96648313f31
    type: regular
    task:
      id: b37672af-27cd-456c-8fa0-a96648313f31
      version: -1
      name: Read Log Source Extensions
      description: Retrieves a list of log source extensions.
      script: QRadar v3|||qradar-log-source-extensions-list
      type: regular
      iscommand: true
      brand: QRadar v3
    nexttasks:
      '#none#':
      - "112"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 15945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "112":
    id: "112"
    taskid: 6ff50c8f-378c-4772-898c-0ec4e322a834
    type: condition
    task:
      id: 6ff50c8f-378c-4772-898c-0ec4e322a834
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "113"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: QRadar.LogSourceExtension
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 16120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "113":
    id: "113"
    taskid: 42e7034b-6a13-49f4-85ee-cfe801395a7c
    type: regular
    task:
      id: 42e7034b-6a13-49f4-85ee-cfe801395a7c
      version: -1
      name: Read Log Source Languages
      description: Retrieves a list of log source languages.
      script: QRadar v3|||qradar-log-source-languages-list
      type: regular
      iscommand: true
      brand: QRadar v3
    nexttasks:
      '#none#':
      - "114"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 16295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "114":
    id: "114"
    taskid: 959ae494-359f-4c26-8794-a59e15fc1ee1
    type: condition
    task:
      id: 959ae494-359f-4c26-8794-a59e15fc1ee1
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "115"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: QRadar.LogSourceLanguage
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 16470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "115":
    id: "115"
    taskid: 62887873-1e2e-449c-8f50-2418db91698b
    type: regular
    task:
      id: 62887873-1e2e-449c-8f50-2418db91698b
      version: -1
      name: Read Log Source Groups
      description: Retrieves a list of log source languages.
      script: QRadar v3|||qradar-log-source-groups-list
      type: regular
      iscommand: true
      brand: QRadar v3
    nexttasks:
      '#none#':
      - "116"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 16645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "116":
    id: "116"
    taskid: 9c50d4c6-953c-40bd-8a34-79a74f18be1a
    type: condition
    task:
      id: 9c50d4c6-953c-40bd-8a34-79a74f18be1a
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "4"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: QRadar.LogSourceGroup
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 16820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "37_94_yes": 0.9,
      "39_40_yes": 0.52,
      "86_87_exists": 0.8
    },
    "paper": {
      "dimensions": {
        "height": 17010,
        "width": 810,
        "x": 50,
        "y": 50
      }
    }
  }
inputs:
- key: offense_id
  value:
    simple: "203"
  required: false
  description: The offense_id to search for.
  playbookInputQuery: null
outputs: []
fromversion: 5.0.0