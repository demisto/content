id: QRadar_v3-test
version: -1
fromversion: 5.0.0
name: QRadar_v3-test
description: QRadar v3 test playbook. Tests commands of QRadar, validates outputs and expected behaviour.
starttaskid: '0'
tasks:
  '0':
    id: '0'
    taskid: cb9960aa-75bf-43fd-84fe-1d5ac6dfb6ab
    type: start
    task:
      id: cb9960aa-75bf-43fd-84fe-1d5ac6dfb6ab
      version: -1
      name: ''
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '1'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '1':
    id: '1'
    taskid: 2a59fbbb-9295-44e9-84c7-12159c765356
    type: regular
    task:
      id: 2a59fbbb-9295-44e9-84c7-12159c765356
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '2'
    scriptarguments:
      all:
        simple: yes
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '2':
    id: '2'
    taskid: 9a6d4173-78df-407f-823e-188b37e3d4d0
    type: regular
    task:
      id: 9a6d4173-78df-407f-823e-188b37e3d4d0
      version: -1
      name: Offense List
      description: Gets offenses from QRadar.
      script: '|||qradar-offenses-list'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '3'
    scriptarguments:
      enrichment:
        simple: IPs
      filter:
        simple: id between 1 and 2
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '3':
    id: '3'
    taskid: 8cde41f2-f954-44c9-87c8-763ba4b36f64
    type: condition
    task:
      id: 8cde41f2-f954-44c9-87c8-763ba4b36f64
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      yes:
      - '6'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.Magnitude
            iscontext: true
          right:
            value:
              simple: '1'
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.Credibility
            iscontext: true
          right:
            value:
              simple: '2'
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.ID
            iscontext: true
          right:
            value:
              simple: '1'
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.Rules.name
            iscontext: true
          right:
            value:
              simple: Multiple Login Failures for Single Username
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.OffenseType
            iscontext: true
          right:
            value:
              simple: Username
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.OffenseType
            iscontext: true
          right:
            value:
              simple: Username
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.Status
            iscontext: true
          right:
            value:
              simple: CLOSED
    view: |-
      {
        "position": {
          "x": 50,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '4':
    id: '4'
    taskid: 1acbae73-fe96-406d-8eaf-2ea079079553
    type: title
    task:
      id: 1acbae73-fe96-406d-8eaf-2ea079079553
      version: -1
      name: Test Playbook Done
      type: title
      iscommand: false
      brand: ''
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 11045
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '5':
    id: '5'
    taskid: ca32b4c3-66cb-4a82-89fb-e0dbec81cb73
    type: regular
    task:
      id: ca32b4c3-66cb-4a82-89fb-e0dbec81cb73
      version: -1
      name: Update Offense
      description: Update an offense.
      script: '|||qradar-offense-update'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '7'
    scriptarguments:
      follow_up:
        simple: 'true'
      offense_id:
        simple: '1'
      protected:
        simple: 'true'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '6':
    id: '6'
    taskid: e0b8a08d-8aeb-4756-81bb-abc1191d0d98
    type: regular
    task:
      id: e0b8a08d-8aeb-4756-81bb-abc1191d0d98
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '5'
    scriptarguments:
      all:
        simple: yes
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '7':
    id: '7'
    taskid: 9e584595-d925-4500-8730-354eb0a6f658
    type: condition
    task:
      id: 9e584595-d925-4500-8730-354eb0a6f658
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      yes:
      - '8'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Offense.ID
            iscontext: true
          right:
            value:
              simple: '1'
      - - operator: isTrue
          left:
            value:
              simple: QRadar.Offense.Followup
            iscontext: true
      - - operator: isTrue
          left:
            value:
              simple: QRadar.Offense.Protected
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '8':
    id: '8'
    taskid: 7a1d8d8b-1af6-4c1a-81f7-167e19b03678
    type: regular
    task:
      id: 7a1d8d8b-1af6-4c1a-81f7-167e19b03678
      version: -1
      name: Create Note To Offense
      description: Retrieve a list of notes for an offense.
      script: '|||qradar-offense-note-create'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '9'
    scriptarguments:
      note_text:
        simple: Note Regarding The Offense
      offense_id:
        simple: '1'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '9':
    id: '9'
    taskid: 001ff168-a18a-4162-8e63-1f853c5bc5f7
    type: condition
    task:
      id: 001ff168-a18a-4162-8e63-1f853c5bc5f7
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      yes:
      - '12'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Note.CreatedBy
            iscontext: true
          right:
            value:
              simple: 'API_user: engadmin-M6IS5rhJ'
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Note.Text
            iscontext: true
          right:
            value:
              simple: Note Regarding The Offense
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '10':
    id: '10'
    taskid: 24ae2ec2-b584-4655-828d-42b9fdff434c
    type: regular
    task:
      id: 24ae2ec2-b584-4655-828d-42b9fdff434c
      version: -1
      name: Note List
      description: Create a note on an offense.
      script: '|||qradar-offense-notes-list'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '11'
    scriptarguments:
      offense_id:
        simple: '1'
      range:
        simple: 0-1
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '11':
    id: '11'
    taskid: dc8e1dba-24cd-4a2e-8317-62e9627d3f0b
    type: condition
    task:
      id: dc8e1dba-24cd-4a2e-8317-62e9627d3f0b
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      yes:
      - '13'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Note.CreatedBy
            iscontext: true
          right:
            value:
              simple: 'API_user: demistoadmin'
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Note.Text
            iscontext: true
          right:
            value:
              simple: Note Regarding The Offense
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '12':
    id: '12'
    taskid: 5ebf7c11-86bc-4210-895a-932bb3457105
    type: regular
    task:
      id: 5ebf7c11-86bc-4210-895a-932bb3457105
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '10'
    scriptarguments:
      all:
        simple: yes
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '13':
    id: '13'
    taskid: bf2d2195-7eda-40bc-8738-86d6701ec8e2
    type: regular
    task:
      id: bf2d2195-7eda-40bc-8738-86d6701ec8e2
      version: -1
      name: Get Closing Reasons List
      description: Retrieve a list of offense closing reasons.
      script: '|||qradar-closing-reasons'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '14'
    scriptarguments:
      filter:
        simple: id <= 2
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '14':
    id: '14'
    taskid: d02a3d84-6478-4fca-8927-47608bf9fc20
    type: condition
    task:
      id: d02a3d84-6478-4fca-8927-47608bf9fc20
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      yes:
      - '15'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: hasLength
          left:
            value:
              simple: QRadar.Offense.ClosingReasons.ID
            iscontext: true
          right:
            value:
              simple: '2'
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.ClosingReasons.ID
            iscontext: true
          right:
            value:
              simple: '1'
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.ClosingReasons.ID
            iscontext: true
          right:
            value:
              simple: '2'
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.ClosingReasons.Name
            iscontext: true
          right:
            value:
              simple: False-Positive, Tuned
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.ClosingReasons.Name
            iscontext: true
          right:
            value:
              simple: Non-Issue
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '15':
    id: '15'
    taskid: 2cd29850-8ddd-47b2-8198-c7764e8a35c4
    type: regular
    task:
      id: 2cd29850-8ddd-47b2-8198-c7764e8a35c4
      version: -1
      name: Rules List
      description: Retrieves a list of rules.
      script: '|||qradar-rules-list'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '16'
    scriptarguments:
      filter:
        simple: id between 100001 AND 100006
      range:
        simple: 0-5
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '16':
    id: '16'
    taskid: 2774a198-91ee-480a-8b01-6ab5fb6852be
    type: condition
    task:
      id: 2774a198-91ee-480a-8b01-6ab5fb6852be
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      yes:
      - '17'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.Name
            iscontext: true
          right:
            value:
              simple: Devices with High Event Rates
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.Owner
            iscontext: true
          right:
            value:
              simple: admin
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.CreationDate
            iscontext: true
          right:
            value:
              simple: '2007-08-09T14:38:27.862000+00:00'
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.Origin
            iscontext: true
          right:
            value:
              simple: SYSTEM
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.Type
            iscontext: true
          right:
            value:
              simple: EVENT
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.ID
            iscontext: true
          right:
            value:
              simple: '100001'
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.ID
            iscontext: true
          right:
            value:
              simple: '100003'
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.ID
            iscontext: true
          right:
            value:
              simple: '100006'
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '17':
    id: '17'
    taskid: ef360bae-e800-43ef-8d19-59f52ce63879
    type: regular
    task:
      id: ef360bae-e800-43ef-8d19-59f52ce63879
      version: -1
      name: Group Rule List
      description: Retrieves a list of the rule groups.
      script: '|||qradar-rule-groups-list'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '18'
    scriptarguments:
      range:
        simple: 0-0
      rule_group_id:
        simple: '125'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '18':
    id: '18'
    taskid: 8c33bf1d-f097-4698-84c1-8479508b5caa
    type: condition
    task:
      id: 8c33bf1d-f097-4698-84c1-8479508b5caa
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      yes:
      - '19'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RuleGroup.Owner
            iscontext: true
          right:
            value:
              simple: admin
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RuleGroup.ID
            iscontext: true
          right:
            value:
              simple: '125'
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RuleGroup.Name
            iscontext: true
          right:
            value:
              simple: Asset Reconciliation Exclusion
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RuleGroup.Type
            iscontext: true
          right:
            value:
              simple: RULE_GROUP
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '19':
    id: '19'
    taskid: 41d602e6-bb67-4539-87e5-e5eaf2fe4609
    type: regular
    task:
      id: 41d602e6-bb67-4539-87e5-e5eaf2fe4609
      version: -1
      name: Assets List
      description: Retrieves assets list.
      script: '|||qradar-assets-list'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '20'
    scriptarguments:
      asset_id:
        simple: '1007'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '20':
    id: '20'
    taskid: 5e8bf793-684a-420f-8416-88571394f5f0
    type: condition
    task:
      id: 5e8bf793-684a-420f-8416-88571394f5f0
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      yes:
      - '21'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Asset.ID
            iscontext: true
          right:
            value:
              simple: '1007'
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Asset.DomainID
            iscontext: true
          right:
            value:
              simple: '0'
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '21':
    id: '21'
    taskid: a1c0d91c-41ac-4549-80f7-9ea910fd2c63
    type: regular
    task:
      id: a1c0d91c-41ac-4549-80f7-9ea910fd2c63
      version: -1
      name: Create Reference Set
      description: Create a new reference set.
      script: '|||qradar-reference-set-create'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '22'
    scriptarguments:
      element_type:
        simple: DATE
      ref_name:
        simple: Test-Reference-Name_2
      time_to_live:
        simple: 1 day
      timeout_type:
        simple: FIRST_SEEN
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '22':
    id: '22'
    taskid: 072fd698-2a04-4edd-8a44-a2cfeeb92aff
    type: condition
    task:
      id: 072fd698-2a04-4edd-8a44-a2cfeeb92aff
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      yes:
      - '25'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Reference.TimeToLive
            iscontext: true
          right:
            value:
              simple: 0 years 0 mons 1 days 0 hours 0 mins 0.0 secs
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Reference.TimeoutType
            iscontext: true
          right:
            value:
              simple: FIRST_SEEN
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Reference.NumberOfElements
            iscontext: true
          right:
            value:
              simple: '0'
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Reference.Name
            iscontext: true
          right:
            value:
              simple: Test-Reference-Name_2
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Reference.ElementType
            iscontext: true
          right:
            value:
              simple: DATE
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3695
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '23':
    id: '23'
    taskid: 9b512ba4-9f5d-484e-88a7-068b2db7c2bf
    type: regular
    task:
      id: 9b512ba4-9f5d-484e-88a7-068b2db7c2bf
      version: -1
      name: Get Reference Details
      description: Retrieve a list of reference sets.
      script: '|||qradar-reference-sets-list'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '27'
    scriptarguments:
      ref_name:
        simple: Test-Reference-Name_2
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5095
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '25':
    id: '25'
    taskid: c213a102-879c-4e83-886d-c548733a0e83
    type: regular
    task:
      id: c213a102-879c-4e83-886d-c548733a0e83
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '60'
    scriptarguments:
      all:
        simple: yes
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '26':
    id: '26'
    taskid: 2d521fc3-86fd-4e18-83dc-a643dd0628ec
    type: regular
    task:
      id: 2d521fc3-86fd-4e18-83dc-a643dd0628ec
      version: -1
      name: Add Value To Reference
      description: Add or update an element in a reference set.
      script: '|||qradar-reference-set-value-upsert'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '28'
    scriptarguments:
      date_value:
        simple: 'True'
      ref_name:
        simple: Test-Reference-Name_2
      value:
        simple: '2020-12-12T12:12:12Z'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4745
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '27':
    id: '27'
    taskid: e75c5dd3-468e-4c06-87eb-a6cee65c006e
    type: condition
    task:
      id: e75c5dd3-468e-4c06-87eb-a6cee65c006e
      version: -1
      name: Validate Outputs, With New Element Count
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      yes:
      - '29'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Reference.NumberOfElements
            iscontext: true
          right:
            value:
              simple: '1'
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Reference.Name
            iscontext: true
          right:
            value:
              simple: Test-Reference-Name_2
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Reference.Data.Value
            iscontext: true
          right:
            value:
              simple: '1607775132000'
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Reference.TimeoutType
            iscontext: true
          right:
            value:
              simple: FIRST_SEEN
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '28':
    id: '28'
    taskid: 8df0106a-1d28-4916-8544-886643e59ed9
    type: regular
    task:
      id: 8df0106a-1d28-4916-8544-886643e59ed9
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '23'
    scriptarguments:
      all:
        simple: yes
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '29':
    id: '29'
    taskid: bbc4e670-cc0a-4b88-8787-9c1c7b076989
    type: regular
    task:
      id: bbc4e670-cc0a-4b88-8787-9c1c7b076989
      version: -1
      name: Delete Reference Set Value
      description: Remove a value from a reference set.
      script: '|||qradar-reference-set-value-delete'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '30'
    scriptarguments:
      date_value:
        simple: 'True'
      ref_name:
        simple: Test-Reference-Name_2
      value:
        simple: '2020-12-12T12:12:12Z'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '30':
    id: '30'
    taskid: 1df9807b-99eb-4fab-81d7-103586312587
    type: regular
    task:
      id: 1df9807b-99eb-4fab-81d7-103586312587
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '31'
    scriptarguments:
      all:
        simple: yes
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '31':
    id: '31'
    taskid: 30343abf-d40c-4ac4-8d43-285a044e3d41
    type: regular
    task:
      id: 30343abf-d40c-4ac4-8d43-285a044e3d41
      version: -1
      name: Get Reference With The Deleted Value
      description: Retrieve a list of reference sets.
      script: '|||qradar-reference-sets-list'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '32'
    scriptarguments:
      ref_name:
        simple: Test-Reference-Name_2
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5795
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '32':
    id: '32'
    taskid: 6e792615-c326-4901-8282-a995f4ba2472
    type: condition
    task:
      id: 6e792615-c326-4901-8282-a995f4ba2472
      version: -1
      name: Validate Outputs, Validate Element Count Decreased
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      yes:
      - '33'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Reference.NumberOfElements
            iscontext: true
          right:
            value:
              simple: '0'
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '33':
    id: '33'
    taskid: 7ab5ef2f-4ecb-4b9b-8149-8630f3a6c4b4
    type: regular
    task:
      id: 7ab5ef2f-4ecb-4b9b-8149-8630f3a6c4b4
      version: -1
      name: Delete Reference Set
      description: Removes a reference set or purges its contents.
      script: '|||qradar-reference-set-delete'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '34'
    scriptarguments:
      ref_name:
        simple: Test-Reference-Name_2
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6145
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '34':
    id: '34'
    taskid: 5ff0ad7f-5e14-4f23-8488-f66d1320bc97
    type: regular
    task:
      id: 5ff0ad7f-5e14-4f23-8488-f66d1320bc97
      version: -1
      name: Get Domains List
      description: Gets the list of domains. You must have the System Administrator or Security Administrator permissions to call this endpoint if you are trying to retrieve the details of all domains. You can retrieve details of domains that are assigned to your Security Profile without having the System Administrator or Security Administrator permissions. If you do not have the System Administrator or Security Administrator permissions, then for each domain assigned to your security profile you can only view the values for the id and name fields. All other values return null.
      script: '|||qradar-domains-list'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '35'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '35':
    id: '35'
    taskid: e7f269b4-2998-41d8-8c77-9d9ab0d5eaa5
    type: condition
    task:
      id: e7f269b4-2998-41d8-8c77-9d9ab0d5eaa5
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      yes:
      - '36'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Domains.ID
            iscontext: true
          right:
            value:
              simple: '0'
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6495
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '36':
    id: '36'
    taskid: c87ea6a1-a2d6-401a-8d13-4e0b743593b8
    type: regular
    task:
      id: c87ea6a1-a2d6-401a-8d13-4e0b743593b8
      version: -1
      name: Geolocations For IPs
      description: Retrieves the MaxMind geoip data for the given IP address.
      script: '|||qradar-geolocations-for-ip'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '37'
    scriptarguments:
      ip:
        simple: 1.2.3.4,1.2.3.5
      ips:
        simple: 1.2.3.4,1.2.3.5
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '37':
    id: '37'
    taskid: 518cce6e-ab03-4f8b-8e64-daa014ed572f
    type: condition
    task:
      id: 518cce6e-ab03-4f8b-8e64-daa014ed572f
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      yes:
      - '38'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.IPAddress
            iscontext: true
          right:
            value:
              simple: 1.2.3.4
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.GeoForIP.IPAddress
            iscontext: true
          right:
            value:
              simple: 1.2.3.5
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.CityName
            iscontext: true
          right:
            value:
              simple: Mukilteo
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.ContinentName
            iscontext: true
          right:
            value:
              simple: NorthAmerica
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.LocationLongitude
            iscontext: true
          right:
            value:
              simple: '-122.3042'
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.LocationTimezone
            iscontext: true
          right:
            value:
              simple: America/Los_Angeles
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.PhysicalCountryName
            iscontext: true
          right:
            value:
              simple: United States
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.PostalCode
            iscontext: true
          right:
            value:
              simple: '98275'
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6845
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '38':
    id: '38'
    taskid: f1d987d3-895f-4a4b-8ba3-5c3ac85ff63d
    type: regular
    task:
      id: f1d987d3-895f-4a4b-8ba3-5c3ac85ff63d
      version: -1
      name: Sources List
      description: Retrieves a list of log sources.
      script: '|||qradar-log-sources-list'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '39'
    scriptarguments:
      filter:
        simple: id=112
      qrd_encryption_algorithm:
        simple: AES128
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7020
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '39':
    id: '39'
    taskid: c9e67edd-47b1-4607-8ac3-30c4fbabfea5
    type: condition
    task:
      id: c9e67edd-47b1-4607-8ac3-30c4fbabfea5
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      yes:
      - '40'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.LogSource.ID
            iscontext: true
          right:
            value:
              simple: '112'
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.LogSource.Credibility
            iscontext: true
          right:
            value:
              simple: '5'
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.LogSource.TypeID
            iscontext: true
          right:
            value:
              simple: '12'
      - - operator: isFalse
          left:
            value:
              simple: QRadar.LogSource.Gateway
            iscontext: true
      - - operator: isTrue
          left:
            value:
              simple: QRadar.LogSource.AutoDiscovered
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '40':
    id: '40'
    taskid: 9aed153f-354c-4f42-838d-956464449ab3
    type: regular
    task:
      id: 9aed153f-354c-4f42-838d-956464449ab3
      version: -1
      name: Custom Properties
      description: Retrieves a list of event regex properties.
      script: '|||qradar-get-custom-properties'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '41'
    scriptarguments:
      filter:
        simple: id = 129 OR id = 212
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '41':
    id: '41'
    taskid: 9c472316-f6dc-4cae-8467-d10dcbacec25
    type: condition
    task:
      id: 9c472316-f6dc-4cae-8467-d10dcbacec25
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      yes:
      - '43'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Properties.name
            iscontext: true
          right:
            value:
              simple: Filename
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Properties.username
            iscontext: true
          right:
            value:
              simple: admin
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Properties.property_type
            iscontext: true
          right:
            value:
              simple: string
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '43':
    id: '43'
    taskid: 5001c536-9066-41fd-805f-0f8a787b7278
    type: regular
    task:
      id: 5001c536-9066-41fd-805f-0f8a787b7278
      version: -1
      name: Get Saved Searches
      description: Retrieves a list of Ariel saved searches.
      script: '|||qradar-saved-searches-list'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '44'
    scriptarguments:
      range:
        simple: 0-1
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '44':
    id: '44'
    taskid: 59d3d5d8-fd25-479f-8bdf-f185df69af66
    type: regular
    task:
      id: 59d3d5d8-fd25-479f-8bdf-f185df69af66
      version: -1
      name: Get Search IDs
      description: Retrieves the list of Ariel searches IDs. Search status and results can be polled by sending search ID to 'qradar-search-status-get' and 'qradar-search-results-get' commands.
      script: '|||qradar-searches-list'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '45'
    scriptarguments:
      range:
        simple: 0-2
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '45':
    id: '45'
    taskid: 25acdd44-e631-40db-896b-a6e2f95542f9
    type: playbook
    task:
      id: 25acdd44-e631-40db-896b-a6e2f95542f9
      version: -1
      name: QRadarFullSearch
      description: This playbook runs a QRadar query and return its results to the context.
      playbookName: QRadarFullSearch
      type: playbook
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '46'
    scriptarguments:
      interval:
        simple: '1'
      query_expression:
        simple: SELECT QIDNAME(qid), LOGSOURCENAME(logsourceid), CATEGORYNAME(highlevelcategory), CATEGORYNAME(category), PROTOCOLNAME(protocolid), sourceip, sourceport, destinationip, destinationport, QIDDESCRIPTION(qid), username, PROTOCOLNAME(protocolid), RULENAME("creEventList"), sourcegeographiclocation, sourceMAC, sourcev6, destinationgeographiclocation, destinationv6, LOGSOURCETYPENAME(devicetype), credibility, severity, magnitude, eventcount, eventDirection, postNatDestinationIP, postNatDestinationPort, postNatSourceIP, postNatSourcePort, preNatDestinationPort, preNatSourceIP, preNatSourcePort, UTF8(payload), starttime, devicetime  FROM events WHERE INOFFENSE(1)  limit 20 START 1605046453426
      timeout:
        simple: '600'
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ''
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '46':
    id: '46'
    taskid: 99a52538-6c7b-4d03-812d-885312d41eca
    type: regular
    task:
      id: 99a52538-6c7b-4d03-812d-885312d41eca
      version: -1
      name: Get Source IPs
      description: Get Source IPs
      script: '|||qradar-ips-source-get'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '47'
    scriptarguments:
      range:
        simple: 0-0
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '47':
    id: '47'
    taskid: f8bf4da3-ac9f-49e0-808e-8fb5dc570f66
    type: condition
    task:
      id: f8bf4da3-ac9f-49e0-808e-8fb5dc570f66
      version: -1
      name: Does Results Exists
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      yes:
      - '48'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: QRadar.SourceIP.ID
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '48':
    id: '48'
    taskid: 23999ddd-1f7c-4c2a-891c-3bbfe8822c40
    type: regular
    task:
      id: 23999ddd-1f7c-4c2a-891c-3bbfe8822c40
      version: -1
      name: Get Local Destination IPs
      description: Get Source IPs
      script: '|||qradar-ips-local-destination-get'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '49'
    scriptarguments:
      range:
        simple: 0-0
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '49':
    id: '49'
    taskid: 3a8ae52a-7b53-4195-8b33-6d595d3ad543
    type: condition
    task:
      id: 3a8ae52a-7b53-4195-8b33-6d595d3ad543
      version: -1
      name: Does Results Exists
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      yes:
      - '63'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: QRadar.LocalDestinationIP.ID
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '52':
    id: '52'
    taskid: ca7ce2fd-9446-45bc-86fd-2304455a1a0b
    type: regular
    task:
      id: ca7ce2fd-9446-45bc-86fd-2304455a1a0b
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '26'
    scriptarguments:
      all:
        simple: yes
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '60':
    id: '60'
    taskid: 50093311-6f1d-47ef-862c-2607da5a491f
    type: regular
    task:
      id: 50093311-6f1d-47ef-862c-2607da5a491f
      version: -1
      name: 'create reference set with #'
      description: Creates a new reference set.
      script: '|||qradar-reference-set-create'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '61'
    scriptarguments:
      element_type:
        simple: IP
      ref_name:
        simple: '# testing name'
      time_to_live:
        simple: 1 day
      timeout_type:
        simple: FIRST_SEEN
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4045
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '61':
    id: '61'
    taskid: e6761ba4-6116-4712-826f-87ccc79829c9
    type: regular
    task:
      id: e6761ba4-6116-4712-826f-87ccc79829c9
      version: -1
      name: 'set value to reference set that contains #'
      description: Adds or updates an element in a reference set.
      script: '|||qradar-reference-set-value-upsert'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '62'
    scriptarguments:
      ref_name:
        simple: '# testing name'
      value:
        simple: 8.8.8.8
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '62':
    id: '62'
    taskid: d7eedf4b-388d-4276-8f67-541aae92076d
    type: regular
    task:
      id: d7eedf4b-388d-4276-8f67-541aae92076d
      version: -1
      name: 'delete reference set with #'
      description: Removes a reference set or purges its contents.
      script: '|||qradar-reference-set-delete'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '52'
    scriptarguments:
      ref_name:
        simple: '# testing name'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4395
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '63':
    id: '63'
    taskid: cfe9cb61-d4ac-4520-8a56-e3c27e58a178
    type: regular
    task:
      id: cfe9cb61-d4ac-4520-8a56-e3c27e58a178
      version: -1
      name: Get events with polling
      description: Polling command to search for events of a specific offense.
      script: '|||qradar-search-retrieve-events'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '64'
    scriptarguments:
      offense_id:
        simple: '194'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '64':
    id: '64'
    taskid: a219be19-90f1-48ac-895a-7f7d736c8b76
    type: condition
    task:
      id: a219be19-90f1-48ac-895a-7f7d736c8b76
      version: -1
      name: Validate polling
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      yes:
      - '67'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: QRadar.SearchEvents.ID
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              simple: QRadar.SearchEvents.Events
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '65':
    id: '65'
    taskid: 5d7b7d5d-741b-438c-81e2-8ba8fe487fff
    type: regular
    task:
      id: 5d7b7d5d-741b-438c-81e2-8ba8fe487fff
      version: -1
      name: get events with polling custom query
      description: Polling command to search for events of a specific offense.
      script: '|||qradar-search-retrieve-events'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '66'
    scriptarguments:
      query_expression:
        simple: SELECT * FROM events WHERE INOFFENSE(194) limit 3 start 3600000
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '66':
    id: '66'
    taskid: ecab50b5-72c2-4e01-85ca-4738fa7af9fb
    type: condition
    task:
      id: ecab50b5-72c2-4e01-85ca-4738fa7af9fb
      version: -1
      name: Validate polling
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      yes:
      - '68'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: QRadar.SearchEvents.ID
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              simple: QRadar.SearchEvents.Events
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '67':
    id: '67'
    taskid: eca365ac-70f5-4773-8ca0-a5d1a98e2353
    type: regular
    task:
      id: eca365ac-70f5-4773-8ca0-a5d1a98e2353
      version: -1
      name: Delete Context
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '65'
    scriptarguments:
      all:
        simple: yes
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "68":
    id: "68"
    taskid: 83de3bc7-d642-4239-8a8c-8464cb7f69f8
    type: regular
    task:
      id: 83de3bc7-d642-4239-8a8c-8464cb7f69f8
      version: -1
      name: Delete Context
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "69"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "69":
    id: "69"
    taskid: 24ed78e2-9435-43d0-8464-79c258e65ab2
    type: regular
    task:
      id: 24ed78e2-9435-43d0-8464-79c258e65ab2
      version: -1
      name: Create Remote network cidrs
      description: Create remote network cidrs
      script: '|||qradar-remote-network-cidr-create'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "70"
    scriptarguments:
      cidrs:
        simple: 127.0.0.1/32
      description:
        simple: playbook-test
      group:
        simple: playbook-test-group
      name:
        simple: playbook-test
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "70":
    id: "70"
    taskid: a24df768-3af5-4080-80a9-0538bfabeed5
    type: regular
    task:
      id: a24df768-3af5-4080-80a9-0538bfabeed5
      version: -1
      name: Remote network cidrs List
      description: Retrieves the list of staged remote networks.
      script: '|||qradar-remote-network-cidr-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "71"
    scriptarguments:
      group:
        simple: playbook-test-group
      name:
        simple: playbook-test
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 10170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "71":
    id: "71"
    taskid: c4706deb-4823-4422-8459-e68f3a8557d9
    type: condition
    task:
      id: c4706deb-4823-4422-8459-e68f3a8557d9
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "72"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RemoteNetworkCIDR.name
            iscontext: true
          right:
            value:
              simple: playbook-test
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 10345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "72":
    id: "72"
    taskid: ebbdd2d7-e72a-4409-8157-a62bd7508d28
    type: regular
    task:
      id: ebbdd2d7-e72a-4409-8157-a62bd7508d28
      version: -1
      name: Update Remote network cidrs
      description: Updates an existing staged remote network.
      script: '|||qradar-remote-network-cidr-update'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "73"
    scriptarguments:
      cidrs:
        simple: 127.0.0.1/32,1.2.3.4/8
      description:
        simple: playbook-test-updated
      group:
        simple: playbook-test-group-updated
      id:
        simple: ${QRadar.RemoteNetworkCIDR.id}
      name:
        simple: playbook-test-updated
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 10520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "73":
    id: "73"
    taskid: e87160cc-365e-4553-8c7d-4bc467a24c44
    type: condition
    task:
      id: e87160cc-365e-4553-8c7d-4bc467a24c44
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "74"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RemoteNetworkCIDR.name
            iscontext: true
          right:
            value:
              simple: playbook-test-updated
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RemoteNetworkCIDR.group
            iscontext: true
          right:
            value:
              simple: playbook-test-group-updated
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RemoteNetworkCIDR.description
            iscontext: true
          right:
            value:
              simple: playbook-test-updated
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 10695
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "74":
    id: "74"
    taskid: a932c269-8176-433f-8adc-3a3e723e054a
    type: regular
    task:
      id: a932c269-8176-433f-8adc-3a3e723e054a
      version: -1
      name: Delete Remote network cidrs
      description: Deletes an existing staged remote network.
      script: '|||qradar-remote-network-cidr-delete'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      id:
        simple: ${QRadar.RemoteNetworkCIDR.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 10870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 11060,
        "width": 380,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
