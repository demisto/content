id: QRadar_v3-test
version: -1
name: QRadar_v3-test
description: QRadar v3 test playbook. Tests commands of QRadar, validates outputs and expected behaviour.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 719bc689-fc55-4293-867b-a496071a4a62
    type: start
    task:
      id: 719bc689-fc55-4293-867b-a496071a4a62
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "78"
      - "79"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: ffcc9925-d8a6-4cc8-83f4-25b7dee1bd0a
    type: regular
    task:
      id: ffcc9925-d8a6-4cc8-83f4-25b7dee1bd0a
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: bae46329-059b-4c23-80f1-6d5693d8e39d
    type: regular
    task:
      id: bae46329-059b-4c23-80f1-6d5693d8e39d
      version: -1
      name: Offense List
      description: Gets offenses from QRadar.
      script: '|||qradar-offenses-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "75"
    scriptarguments:
      enrichment:
        simple: IPs
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: acb1b2f3-a227-45ec-8c96-e02ce373d977
    type: condition
    task:
      id: acb1b2f3-a227-45ec-8c96-e02ce373d977
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "65"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: QRadar.Offense.Magnitude
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: QRadar.Offense.Credibility
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: QRadar.Offense.ID
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: QRadar.Offense.Rules.name
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: QRadar.Offense.OffenseType
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: QRadar.Offense.OffenseType
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: QRadar.Offense.Status
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 7e1cd761-cf7e-4a0f-873f-81b1b39011d8
    type: title
    task:
      id: 7e1cd761-cf7e-4a0f-873f-81b1b39011d8
      version: -1
      name: Test Playbook Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 12795
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 0a2c3e34-398f-4008-82d8-95fb32a7676a
    type: regular
    task:
      id: 0a2c3e34-398f-4008-82d8-95fb32a7676a
      version: -1
      name: Update Offense
      description: Update an offense.
      script: '|||qradar-offense-update'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      follow_up:
        simple: "true"
      offense_id:
        simple: ${OffenseID}
      protected:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: 6298fc72-ccf0-43eb-8acd-44ee1b22a559
    type: condition
    task:
      id: 6298fc72-ccf0-43eb-8acd-44ee1b22a559
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "8"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isTrue
          left:
            value:
              simple: QRadar.Offense.Followup
            iscontext: true
          right:
            value: {}
      - - operator: isTrue
          left:
            value:
              simple: QRadar.Offense.Protected
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Offense.ID
            iscontext: true
          right:
            value:
              simple: OffenseID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: e7b4bed3-863f-4f4a-872c-7c0855809e0c
    type: regular
    task:
      id: e7b4bed3-863f-4f4a-872c-7c0855809e0c
      version: -1
      name: Create Note To Offense
      description: Retrieve a list of notes for an offense.
      script: '|||qradar-offense-note-create'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      note_text:
        simple: Note Regarding The Offense
      offense_id:
        simple: ${OffenseID}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: 4eb48d1e-a77f-48a2-8f03-f1c2b27a69e3
    type: condition
    task:
      id: 4eb48d1e-a77f-48a2-8f03-f1c2b27a69e3
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "10"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Note.CreatedBy
            iscontext: true
          right:
            value:
              simple: 'API_user: admin'
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Note.Text
            iscontext: true
          right:
            value:
              simple: Note Regarding The Offense
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: 7e337e57-9706-43bd-8928-abe1f0bf504e
    type: regular
    task:
      id: 7e337e57-9706-43bd-8928-abe1f0bf504e
      version: -1
      name: Note List
      description: Create a note on an offense.
      script: '|||qradar-offense-notes-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      note_id:
        simple: ${QRadar.Note.ID}
      offense_id:
        simple: ${OffenseID}
      range:
        simple: 0-1
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 54b64eb2-9f9a-4349-8ffa-547ac73d4a87
    type: condition
    task:
      id: 54b64eb2-9f9a-4349-8ffa-547ac73d4a87
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "13"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Note.Text
            iscontext: true
          right:
            value:
              simple: Note Regarding The Offense
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: b9d7599c-4f33-4ec1-8ffb-df63f3ba67b4
    type: regular
    task:
      id: b9d7599c-4f33-4ec1-8ffb-df63f3ba67b4
      version: -1
      name: Get Closing Reasons List
      description: Retrieve a list of offense closing reasons.
      script: '|||qradar-closing-reasons'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      filter:
        simple: id <= 2
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 2b36d39a-cb33-4ad6-8a8d-fd773f424b31
    type: condition
    task:
      id: 2b36d39a-cb33-4ad6-8a8d-fd773f424b31
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "15"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: hasLength
          left:
            value:
              simple: QRadar.Offense.ClosingReasons.ID
            iscontext: true
          right:
            value:
              simple: "2"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.ClosingReasons.ID
            iscontext: true
          right:
            value:
              simple: "1"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.ClosingReasons.ID
            iscontext: true
          right:
            value:
              simple: "2"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.ClosingReasons.Name
            iscontext: true
          right:
            value:
              simple: False-Positive, Tuned
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.ClosingReasons.Name
            iscontext: true
          right:
            value:
              simple: Non-Issue
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 6af7c4d5-8f82-451a-8306-0a3b203d1d40
    type: regular
    task:
      id: 6af7c4d5-8f82-451a-8306-0a3b203d1d40
      version: -1
      name: Rules List
      description: Retrieves a list of rules.
      script: '|||qradar-rules-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      filter:
        simple: id between 100001 AND 100006
      range:
        simple: 0-5
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: 38aa7153-1256-4783-8979-1ff23d73a398
    type: condition
    task:
      id: 38aa7153-1256-4783-8979-1ff23d73a398
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "17"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.Name
            iscontext: true
          right:
            value:
              simple: Devices with High Event Rates
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.Owner
            iscontext: true
          right:
            value:
              simple: admin
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.CreationDate
            iscontext: true
          right:
            value:
              simple: "2007-08-09T14:38:27.862000+00:00"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.Origin
            iscontext: true
          right:
            value:
              simple: SYSTEM
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.Type
            iscontext: true
          right:
            value:
              simple: EVENT
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.ID
            iscontext: true
          right:
            value:
              simple: "100001"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.ID
            iscontext: true
          right:
            value:
              simple: "100003"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.ID
            iscontext: true
          right:
            value:
              simple: "100006"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: 12b55740-45fd-4d84-88e0-ddfe4149352d
    type: regular
    task:
      id: 12b55740-45fd-4d84-88e0-ddfe4149352d
      version: -1
      name: Group Rule List
      description: Retrieves a list of the rule groups.
      script: '|||qradar-rule-groups-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      range:
        simple: 0-0
      rule_group_id:
        simple: "125"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: 2681e4d2-b32b-4737-801d-c628eef7d316
    type: condition
    task:
      id: 2681e4d2-b32b-4737-801d-c628eef7d316
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "19"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RuleGroup.Owner
            iscontext: true
          right:
            value:
              simple: admin
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RuleGroup.ID
            iscontext: true
          right:
            value:
              simple: "125"
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RuleGroup.Name
            iscontext: true
          right:
            value:
              simple: Asset Reconciliation Exclusion
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RuleGroup.Type
            iscontext: true
          right:
            value:
              simple: RULE_GROUP
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: da4a1873-4ee6-45c8-82b2-9e6693d28b8e
    type: regular
    task:
      id: da4a1873-4ee6-45c8-82b2-9e6693d28b8e
      version: -1
      name: Assets List
      description: Retrieves assets list.
      script: '|||qradar-assets-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      asset_id:
        simple: "1003"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 24596580-9b2a-4951-8bb3-066e3fd15178
    type: condition
    task:
      id: 24596580-9b2a-4951-8bb3-066e3fd15178
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "21"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Asset.ID
            iscontext: true
          right:
            value:
              simple: "1003"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Asset.DomainID
            iscontext: true
          right:
            value:
              simple: "0"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3695
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: f245b0a0-5c98-4213-83ca-5e4d2052f711
    type: regular
    task:
      id: f245b0a0-5c98-4213-83ca-5e4d2052f711
      version: -1
      name: Create Reference Set
      description: Create a new reference set.
      script: '|||qradar-reference-set-create'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      element_type:
        simple: DATE
      ref_name:
        simple: Test-Reference-Name_2
      time_to_live:
        simple: 1 day
      timeout_type:
        simple: FIRST_SEEN
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 7504a24c-8588-410f-8750-4dbb536a1473
    type: condition
    task:
      id: 7504a24c-8588-410f-8750-4dbb536a1473
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "25"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Reference.TimeToLive
            iscontext: true
          right:
            value:
              simple: 0 years 0 mons 1 days 0 hours 0 mins 0.0 secs
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Reference.TimeoutType
            iscontext: true
          right:
            value:
              simple: FIRST_SEEN
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Reference.NumberOfElements
            iscontext: true
          right:
            value:
              simple: "0"
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Reference.Name
            iscontext: true
          right:
            value:
              simple: Test-Reference-Name_2
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Reference.ElementType
            iscontext: true
          right:
            value:
              simple: DATE
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4045
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: defbc33f-b7c8-4b10-8919-bb098259821e
    type: regular
    task:
      id: defbc33f-b7c8-4b10-8919-bb098259821e
      version: -1
      name: Get Reference Details
      description: Retrieve a list of reference sets.
      script: '|||qradar-reference-sets-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      ref_name:
        simple: Test-Reference-Name_2
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "25":
    id: "25"
    taskid: 69da809d-5cbe-4270-8aac-abecc99151a1
    type: regular
    task:
      id: 69da809d-5cbe-4270-8aac-abecc99151a1
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "60"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: OffenseID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: 77dc530e-1e4b-4a5b-8362-cc0fde5bb1f1
    type: regular
    task:
      id: 77dc530e-1e4b-4a5b-8362-cc0fde5bb1f1
      version: -1
      name: Add Value To Reference
      description: Add or update an element in a reference set.
      script: '|||qradar-reference-set-value-upsert'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "91"
    scriptarguments:
      date_value:
        simple: "True"
      ref_name:
        simple: Test-Reference-Name_2
      value:
        simple: "2020-12-12T12:12:12Z"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5095
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: 0cb8977c-178a-4d44-847c-61a7cf65a714
    type: condition
    task:
      id: 0cb8977c-178a-4d44-847c-61a7cf65a714
      version: -1
      name: Validate Outputs, With New Element Count
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "29"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Reference.NumberOfElements
            iscontext: true
          right:
            value:
              simple: "2"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Reference.Name
            iscontext: true
          right:
            value:
              simple: Test-Reference-Name_2
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Reference.Data.Value
            iscontext: true
          right:
            value:
              simple: "1607775132000"
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Reference.TimeoutType
            iscontext: true
          right:
            value:
              simple: FIRST_SEEN
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5795
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: 4cf5bc10-2477-49d4-8a1c-44a90d21c0b9
    type: regular
    task:
      id: 4cf5bc10-2477-49d4-8a1c-44a90d21c0b9
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: OffenseID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: 2c6423b7-4b50-45e3-86fc-2b3086142d7c
    type: regular
    task:
      id: 2c6423b7-4b50-45e3-86fc-2b3086142d7c
      version: -1
      name: Delete Reference Set Value
      description: Remove a value from a reference set.
      script: '|||qradar-reference-set-value-delete'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      date_value:
        simple: "True"
      ref_name:
        simple: Test-Reference-Name_2
      value:
        simple: "2020-12-12T12:12:12Z"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: ddcf9895-4b40-4d78-86df-3b4a2d26169a
    type: regular
    task:
      id: ddcf9895-4b40-4d78-86df-3b4a2d26169a
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: OffenseID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 6145
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: f6f7a4c4-f8de-466e-8638-d69924faee41
    type: regular
    task:
      id: f6f7a4c4-f8de-466e-8638-d69924faee41
      version: -1
      name: Get Reference With The Deleted Value
      description: Retrieve a list of reference sets.
      script: '|||qradar-reference-sets-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      ref_name:
        simple: Test-Reference-Name_2
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 6320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: e8c9fed6-a10f-451c-8bbe-eb4ab20172ad
    type: condition
    task:
      id: e8c9fed6-a10f-451c-8bbe-eb4ab20172ad
      version: -1
      name: Validate Outputs, Validate Element Count Decreased
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "33"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Reference.NumberOfElements
            iscontext: true
          right:
            value:
              simple: "1"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 6495
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: 8a7be1f2-20fb-4937-82d4-d97e5764d87e
    type: regular
    task:
      id: 8a7be1f2-20fb-4937-82d4-d97e5764d87e
      version: -1
      name: Delete Reference Set
      description: Removes a reference set or purges its contents.
      script: '|||qradar-reference-set-delete'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      ref_name:
        simple: Test-Reference-Name_2
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 6670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: a04680af-358a-49c2-8f81-7f57b259fb62
    type: regular
    task:
      id: a04680af-358a-49c2-8f81-7f57b259fb62
      version: -1
      name: Get Domains List
      description: Gets the list of domains. You must have the System Administrator or Security Administrator permissions to call this endpoint if you are trying to retrieve the details of all domains. You can retrieve details of domains that are assigned to your Security Profile without having the System Administrator or Security Administrator permissions. If you do not have the System Administrator or Security Administrator permissions, then for each domain assigned to your security profile you can only view the values for the id and name fields. All other values return null.
      script: '|||qradar-domains-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "35"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 6845
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: 6db6ef28-6334-4171-8e51-dfe7f1569ecc
    type: condition
    task:
      id: 6db6ef28-6334-4171-8e51-dfe7f1569ecc
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "36"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Domains.ID
            iscontext: true
          right:
            value:
              simple: "0"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 7020
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: 5b2c6621-6472-4ed1-8c12-2ecb67aebb4d
    type: regular
    task:
      id: 5b2c6621-6472-4ed1-8c12-2ecb67aebb4d
      version: -1
      name: Geolocations For IPs
      description: Retrieves the MaxMind geoip data for the given IP address.
      script: '|||qradar-geolocations-for-ip'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "37"
    scriptarguments:
      ip:
        simple: 1.2.3.4,1.2.3.5
      ips:
        simple: 1.2.3.4,1.2.3.5
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 7195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: 6dcd1544-8853-472c-89ff-e0a54e983a98
    type: condition
    task:
      id: 6dcd1544-8853-472c-89ff-e0a54e983a98
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "38"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.IPAddress
            iscontext: true
          right:
            value:
              simple: 1.2.3.4
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.GeoForIP.IPAddress
            iscontext: true
          right:
            value:
              simple: 1.2.3.5
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.CityName
            iscontext: true
          right:
            value:
              simple: Mukilteo
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.ContinentName
            iscontext: true
          right:
            value:
              simple: NorthAmerica
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.LocationLongitude
            iscontext: true
          right:
            value:
              simple: "-122.3042"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.LocationTimezone
            iscontext: true
          right:
            value:
              simple: America/Los_Angeles
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.PhysicalCountryName
            iscontext: true
          right:
            value:
              simple: United States
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.PostalCode
            iscontext: true
          right:
            value:
              simple: "98275"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 7370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: c4a09a0b-b9af-4470-89ef-fd12bea72e6b
    type: regular
    task:
      id: c4a09a0b-b9af-4470-89ef-fd12bea72e6b
      version: -1
      name: Sources List
      description: Retrieves a list of log sources.
      script: '|||qradar-log-sources-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "39"
    scriptarguments:
      filter:
        simple: id=68
      qrd_encryption_algorithm:
        simple: AES128
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 7545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: 451f124e-979f-4b6b-8bcc-bd15f21b5d0d
    type: condition
    task:
      id: 451f124e-979f-4b6b-8bcc-bd15f21b5d0d
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "40"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.LogSource.ID
            iscontext: true
          right:
            value:
              simple: "68"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.LogSource.Credibility
            iscontext: true
          right:
            value:
              simple: "10"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.LogSource.TypeID
            iscontext: true
          right:
            value:
              simple: "355"
      - - operator: isFalse
          left:
            value:
              simple: QRadar.LogSource.Gateway
            iscontext: true
      - - operator: isFalse
          left:
            value:
              simple: QRadar.LogSource.AutoDiscovered
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 7720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: 51f9a9ef-133d-491e-8bd2-fb3e1648f8eb
    type: regular
    task:
      id: 51f9a9ef-133d-491e-8bd2-fb3e1648f8eb
      version: -1
      name: Custom Properties
      description: Retrieves a list of event regex properties.
      script: '|||qradar-get-custom-properties'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "41"
    scriptarguments:
      filter:
        simple: id = 212
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 7895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: 3800ef6d-e061-448d-8f47-775f21ac00f2
    type: condition
    task:
      id: 3800ef6d-e061-448d-8f47-775f21ac00f2
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "43"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Properties.name
            iscontext: true
          right:
            value:
              simple: Function
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Properties.username
            iscontext: true
          right:
            value:
              simple: admin
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Properties.property_type
            iscontext: true
          right:
            value:
              simple: string
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 8070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: 88d4399d-64fa-43c8-84f2-ebe0b6e3f13f
    type: regular
    task:
      id: 88d4399d-64fa-43c8-84f2-ebe0b6e3f13f
      version: -1
      name: Get Saved Searches
      description: Retrieves a list of Ariel saved searches.
      script: '|||qradar-saved-searches-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "44"
    scriptarguments:
      range:
        simple: 0-1
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 8245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "44":
    id: "44"
    taskid: 7393c923-6007-4bc7-8879-49edede874af
    type: regular
    task:
      id: 7393c923-6007-4bc7-8879-49edede874af
      version: -1
      name: Get Search IDs
      description: Retrieves the list of Ariel searches IDs. Search status and results can be polled by sending search ID to 'qradar-search-status-get' and 'qradar-search-results-get' commands.
      script: '|||qradar-searches-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "45"
    scriptarguments:
      range:
        simple: 0-2
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 8420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: f9624038-63c9-46ef-8c80-ce254e79e9cb
    type: regular
    task:
      id: f9624038-63c9-46ef-8c80-ce254e79e9cb
      version: -1
      name: Get Source IPs
      description: Get Source IPs
      script: '|||qradar-ips-source-get'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "47"
    scriptarguments:
      range:
        simple: 0-0
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 8770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: c5a7b0b7-2524-40a3-8b1e-d057777c9855
    type: condition
    task:
      id: c5a7b0b7-2524-40a3-8b1e-d057777c9855
      version: -1
      name: Does Results Exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "48"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: QRadar.SourceIP.ID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 8945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: 7538bd6a-0e26-4f03-8bb6-4410d536a983
    type: regular
    task:
      id: 7538bd6a-0e26-4f03-8bb6-4410d536a983
      version: -1
      name: Get Local Destination IPs
      description: Get Source IPs
      script: '|||qradar-ips-local-destination-get'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "49"
    scriptarguments:
      range:
        simple: 0-0
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 9120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: 58b27563-daeb-4e4b-81a2-500c80f9a7dc
    type: condition
    task:
      id: 58b27563-daeb-4e4b-81a2-500c80f9a7dc
      version: -1
      name: Does Results Exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "63"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: QRadar.LocalDestinationIP.ID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 9295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "52":
    id: "52"
    taskid: 1a950542-bde6-4f5c-89c3-6f97a9db0e93
    type: regular
    task:
      id: 1a950542-bde6-4f5c-89c3-6f97a9db0e93
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "26"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: OffenseID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: c1ff48d6-9d07-4ee2-8509-b9cab14640d6
    type: regular
    task:
      id: c1ff48d6-9d07-4ee2-8509-b9cab14640d6
      version: -1
      name: 'create reference set with #'
      description: Creates a new reference set.
      script: '|||qradar-reference-set-create'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "61"
    scriptarguments:
      element_type:
        simple: IP
      ref_name:
        simple: '# testing name'
      time_to_live:
        simple: 1 day
      timeout_type:
        simple: FIRST_SEEN
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4395
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    id: "61"
    taskid: 065474b9-8a9c-4f31-8c60-cb060b7e7753
    type: regular
    task:
      id: 065474b9-8a9c-4f31-8c60-cb060b7e7753
      version: -1
      name: 'set value to reference set that contains #'
      description: Adds or updates an element in a reference set.
      script: '|||qradar-reference-set-value-upsert'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "62"
    scriptarguments:
      ref_name:
        simple: '# testing name'
      value:
        simple: 8.8.8.8
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "62":
    id: "62"
    taskid: 9cddea2c-0234-4b3e-815b-3aae11d74cbe
    type: regular
    task:
      id: 9cddea2c-0234-4b3e-815b-3aae11d74cbe
      version: -1
      name: 'delete reference set with #'
      description: Removes a reference set or purges its contents.
      script: '|||qradar-reference-set-delete'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "52"
    scriptarguments:
      ref_name:
        simple: '# testing name'
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4745
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: c667dbd9-b588-4cf4-84ab-1d36bd5dd943
    type: regular
    task:
      id: c667dbd9-b588-4cf4-84ab-1d36bd5dd943
      version: -1
      name: Get events with polling custom query
      description: Polling command to search for events of a specific offense.
      script: '|||qradar-search-retrieve-events'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "64"
    scriptarguments:
      query_expression:
        simple: SELECT * FROM events WHERE severity >= 5 limit 1
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 9470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "64":
    id: "64"
    taskid: 09024500-cd55-45cb-8eb6-49a8d5517f7e
    type: condition
    task:
      id: 09024500-cd55-45cb-8eb6-49a8d5517f7e
      version: -1
      name: Validate polling
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "68"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: QRadar.SearchEvents.ID
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              simple: QRadar.SearchEvents.Events
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 9645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "65":
    id: "65"
    taskid: 74f87781-7ee4-43fb-8fd3-85b5a4179ed5
    type: regular
    task:
      id: 74f87781-7ee4-43fb-8fd3-85b5a4179ed5
      version: -1
      name: Get offense with polling
      description: Polling command to search for events of a specific offense.
      script: '|||qradar-search-retrieve-events'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "76"
    scriptarguments:
      offense_id:
        simple: ${QRadar.Offense.[0].ID}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "68":
    id: "68"
    taskid: f21eb13e-9517-4541-82bd-9a5169a10870
    type: regular
    task:
      id: f21eb13e-9517-4541-82bd-9a5169a10870
      version: -1
      name: Delete Context
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "81"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 9820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "69":
    id: "69"
    taskid: 97c3f8a7-9a99-4a63-8c2e-31e166373e6f
    type: regular
    task:
      id: 97c3f8a7-9a99-4a63-8c2e-31e166373e6f
      version: -1
      name: Create Remote network cidrs
      description: Create remote network cidrs
      script: '|||qradar-remote-network-cidr-create'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "70"
    scriptarguments:
      cidrs:
        simple: 127.0.0.1/32
      description:
        simple: playbook-test
      group:
        simple: playbook-test-group
      name:
        simple: playbook-test
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 10695
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "70":
    id: "70"
    taskid: 3adda86c-9006-4709-8fe7-9d9f76dd2259
    type: regular
    task:
      id: 3adda86c-9006-4709-8fe7-9d9f76dd2259
      version: -1
      name: Remote network cidrs List
      description: Retrieves the list of staged remote networks.
      script: '|||qradar-remote-network-cidr-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "71"
    scriptarguments:
      group:
        simple: playbook-test-group
      name:
        simple: playbook-test
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 10870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "71":
    id: "71"
    taskid: 485b708f-a9a3-4a90-8bf6-e8f1312edb63
    type: condition
    task:
      id: 485b708f-a9a3-4a90-8bf6-e8f1312edb63
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "89"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RemoteNetworkCIDR.name
            iscontext: true
          right:
            value:
              simple: playbook-test
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 11045
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "72":
    id: "72"
    taskid: 7b1ffc12-4262-47b7-8cfe-47e260c0ff83
    type: regular
    task:
      id: 7b1ffc12-4262-47b7-8cfe-47e260c0ff83
      version: -1
      name: Update Remote network cidrs
      description: Updates an existing staged remote network.
      script: '|||qradar-remote-network-cidr-update'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "73"
    scriptarguments:
      cidrs:
        simple: 127.0.0.1/32,1.2.3.4/8
      description:
        simple: playbook-test-updated
      group:
        simple: playbook-test-group-updated
      id:
        simple: ${CidrID}
      name:
        simple: playbook-test-updated
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 12270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "73":
    id: "73"
    taskid: 9892abd5-d16f-4cfc-8082-baece298a9f3
    type: condition
    task:
      id: 9892abd5-d16f-4cfc-8082-baece298a9f3
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "74"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RemoteNetworkCIDR.name
            iscontext: true
          right:
            value:
              simple: playbook-test-updated
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RemoteNetworkCIDR.group
            iscontext: true
          right:
            value:
              simple: playbook-test-group-updated
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RemoteNetworkCIDR.description
            iscontext: true
          right:
            value:
              simple: playbook-test-updated
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 12445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "74":
    id: "74"
    taskid: 82ecdc43-e078-48ec-8b94-6f88ad263425
    type: regular
    task:
      id: 82ecdc43-e078-48ec-8b94-6f88ad263425
      version: -1
      name: Delete Remote network cidrs
      description: Deletes an existing staged remote network.
      script: '|||qradar-remote-network-cidr-delete'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      id:
        simple: ${QRadar.RemoteNetworkCIDR.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 12620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "75":
    id: "75"
    taskid: 55a0de06-3397-4c44-83de-30e221fb3207
    type: regular
    task:
      id: 55a0de06-3397-4c44-83de-30e221fb3207
      version: -1
      name: Write ID
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      key:
        simple: OffenseID
      value:
        complex:
          root: QRadar.Offense
          accessor: ID
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "76":
    id: "76"
    taskid: 4a3159e8-ca96-496b-8b4c-33646aa480d3
    type: regular
    task:
      id: 4a3159e8-ca96-496b-8b4c-33646aa480d3
      version: -1
      name: DeleteContext
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: OffenseID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "78":
    id: "78"
    taskid: e2b2b7ef-fa5d-4b43-85f8-f6089dc89f4d
    type: regular
    task:
      id: e2b2b7ef-fa5d-4b43-85f8-f6089dc89f4d
      version: -1
      name: Delete Reference Set
      description: Removes a reference set or purges its contents.
      script: '|||qradar-reference-set-delete'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    scriptarguments:
      ref_name:
        simple: Test-Reference-Name_2
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "79":
    id: "79"
    taskid: d4afc0b0-54d9-410e-8022-f49ad7dfdf58
    type: regular
    task:
      id: d4afc0b0-54d9-410e-8022-f49ad7dfdf58
      version: -1
      name: 'delete reference set with #'
      description: Removes a reference set or purges its contents.
      script: '|||qradar-reference-set-delete'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    scriptarguments:
      ref_name:
        simple: '# testing name'
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "81":
    id: "81"
    taskid: 574b2111-b45f-417f-8b6c-942dd7d55c48
    type: regular
    task:
      id: 574b2111-b45f-417f-8b6c-942dd7d55c48
      version: -1
      name: Find old cidr
      description: Retrieves the list of staged remote networks.
      script: '|||qradar-remote-network-cidr-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "82"
    scriptarguments:
      name:
        simple: playbook-test
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 9995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "82":
    id: "82"
    taskid: bc2fe767-0c68-48f5-8fc8-03297c0eeff3
    type: condition
    task:
      id: bc2fe767-0c68-48f5-8fc8-03297c0eeff3
      version: -1
      name: If Exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "69"
      "yes":
      - "83"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: QRadar.RemoteNetworkCIDR.id
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 10170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "83":
    id: "83"
    taskid: 69bffcc7-6288-478b-817d-cba5faf22965
    type: regular
    task:
      id: 69bffcc7-6288-478b-817d-cba5faf22965
      version: -1
      name: Delete old cidr
      description: Deletes an existing staged remote network.
      script: '|||qradar-remote-network-cidr-delete'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "84"
    scriptarguments:
      id:
        simple: ${QRadar.RemoteNetworkCIDR.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 10345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "84":
    id: "84"
    taskid: 48675951-93ee-444b-8523-9a08a117e48f
    type: regular
    task:
      id: 48675951-93ee-444b-8523-9a08a117e48f
      version: -1
      name: Delete Context
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "69"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 10520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "85":
    id: "85"
    taskid: 608e8d54-e135-4fab-85ea-ee14c52c8f87
    type: regular
    task:
      id: 608e8d54-e135-4fab-85ea-ee14c52c8f87
      version: -1
      name: Find old cidr
      description: Retrieves the list of staged remote networks.
      script: '|||qradar-remote-network-cidr-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "86"
    scriptarguments:
      name:
        simple: playbook-test-updated
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 11570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "86":
    id: "86"
    taskid: 49ac02b7-5dea-4673-88b7-dd37f16b2961
    type: condition
    task:
      id: 49ac02b7-5dea-4673-88b7-dd37f16b2961
      version: -1
      name: If Exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "72"
      exists:
      - "87"
    separatecontext: false
    conditions:
    - label: exists
      condition:
      - - operator: isExists
          left:
            value:
              simple: QRadar.RemoteNetworkCIDR.id
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 11745
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "87":
    id: "87"
    taskid: 1195f5f8-755e-43ca-89a8-ef81eb612bd3
    type: regular
    task:
      id: 1195f5f8-755e-43ca-89a8-ef81eb612bd3
      version: -1
      name: Delete old cidr
      description: Deletes an existing staged remote network.
      script: '|||qradar-remote-network-cidr-delete'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "88"
    scriptarguments:
      id:
        simple: ${QRadar.RemoteNetworkCIDR.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 11920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "88":
    id: "88"
    taskid: 34a7ca7c-079f-4522-895f-09f5f63c8952
    type: regular
    task:
      id: 34a7ca7c-079f-4522-895f-09f5f63c8952
      version: -1
      name: Delete Context
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "72"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: CidrID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 12095
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "89":
    id: "89"
    taskid: 895968fa-173f-43bb-80ac-f56c13746392
    type: regular
    task:
      id: 895968fa-173f-43bb-80ac-f56c13746392
      version: -1
      name: WriteID
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "90"
    scriptarguments:
      key:
        simple: CidrID
      value:
        simple: ${QRadar.RemoteNetworkCIDR.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 11220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "90":
    id: "90"
    taskid: 30b76136-423f-485a-81f6-bd41803c558b
    type: regular
    task:
      id: 30b76136-423f-485a-81f6-bd41803c558b
      version: -1
      name: DeleteContext
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "85"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: CidrID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 11395
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "91":
    id: "91"
    taskid: bbe01867-7c46-42ac-8409-209b5c257c41
    type: regular
    task:
      id: bbe01867-7c46-42ac-8409-209b5c257c41
      version: -1
      name: Add Values To Reference
      description: Add or update an element in a reference set.
      script: '|||qradar-reference-set-value-upsert'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "28"
    scriptarguments:
      date_value:
        simple: "True"
      ref_name:
        simple: Test-Reference-Name_2
      value:
        simple: 2020-12-01T12:12:12Z,2020-12-01T12:12:12Z
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: 1453c2a2-1d12-4e76-8390-0e278216be1c
    type: playbook
    task:
      id: 1453c2a2-1d12-4e76-8390-0e278216be1c
      version: -1
      name: QRadarFullSearch
      description: This playbook runs a QRadar query and return its results to the context.
      playbookName: QRadarFullSearch
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "46"
    scriptarguments:
      interval:
        simple: "1"
      query_expression:
        complex:
          root: OffenseID
          transformers:
          - operator: concat
            args:
              prefix:
                value:
                  simple: SELECT QIDNAME(qid), LOGSOURCENAME(logsourceid), CATEGORYNAME(highlevelcategory), CATEGORYNAME(category), PROTOCOLNAME(protocolid), sourceip, sourceport, destinationip, destinationport, QIDDESCRIPTION(qid), username, PROTOCOLNAME(protocolid), RULENAME("creEventList"), sourcegeographiclocation, sourceMAC, sourcev6, destinationgeographiclocation, destinationv6, LOGSOURCETYPENAME(devicetype), credibility, severity, magnitude, eventcount, eventDirection, postNatDestinationIP, postNatDestinationPort, postNatSourceIP, postNatSourcePort, preNatDestinationPort, preNatSourceIP, preNatSourcePort, UTF8(payload), starttime, devicetime  FROM events WHERE INOFFENSE(
              suffix:
                value:
                  simple: )  limit 20 START 1605046453426
      timeout:
        simple: "600"
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 265,
          "y": 8595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "86_87_exists": 0.8
    },
    "paper": {
      "dimensions": {
        "height": 12810,
        "width": 810,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
fromversion: 5.0.0
