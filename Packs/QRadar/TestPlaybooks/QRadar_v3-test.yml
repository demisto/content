id: QRadar_v3-test
version: -1
fromversion: 5.0.0
name: QRadar_v3-test
description: QRadar v3 test playbook. Tests commands of QRadar, validates outputs
  and expected behaviour.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 07bdb96f-aa75-4b5b-81b0-18fb994de565
    type: start
    task:
      id: 07bdb96f-aa75-4b5b-81b0-18fb994de565
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: c9d85821-69cf-4f1b-8de6-54ee7922bc02
    type: regular
    task:
      id: c9d85821-69cf-4f1b-8de6-54ee7922bc02
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: 72a14fa3-4a49-4cdb-87ae-afc67921d0de
    type: regular
    task:
      id: 72a14fa3-4a49-4cdb-87ae-afc67921d0de
      version: -1
      name: Offense List
      description: Gets offenses from QRadar.
      script: '|||qradar-offenses-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      enrichment:
        simple: IPs
      filter:
        simple: id between 1 and 2
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 332bbc3c-e6c2-4d16-8ef5-147988f94056
    type: condition
    task:
      id: 332bbc3c-e6c2-4d16-8ef5-147988f94056
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "6"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.Magnitude
            iscontext: true
          right:
            value:
              simple: "1"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.Credibility
            iscontext: true
          right:
            value:
              simple: "2"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.ID
            iscontext: true
          right:
            value:
              simple: "1"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.Rules.name
            iscontext: true
          right:
            value:
              simple: Multiple Login Failures for Single Username
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.OffenseType
            iscontext: true
          right:
            value:
              simple: Username
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.OffenseType
            iscontext: true
          right:
            value:
              simple: Username
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.Status
            iscontext: true
          right:
            value:
              simple: CLOSED
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 7c74e773-ad70-4098-8a8f-bba76f8b7c6a
    type: title
    task:
      id: 7c74e773-ad70-4098-8a8f-bba76f8b7c6a
      version: -1
      name: Test Playbook Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 11045
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 62c1eedf-8254-49ee-8329-9e8af1da328f
    type: regular
    task:
      id: 62c1eedf-8254-49ee-8329-9e8af1da328f
      version: -1
      name: Update Offense
      description: Update an offense.
      script: '|||qradar-offense-update'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      follow_up:
        simple: "true"
      offense_id:
        simple: "1"
      protected:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 0b9c596f-820c-469c-872f-a024899eea08
    type: regular
    task:
      id: 0b9c596f-820c-469c-872f-a024899eea08
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: 8f283194-2651-4d20-8d30-9146cf1394f0
    type: condition
    task:
      id: 8f283194-2651-4d20-8d30-9146cf1394f0
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "8"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Offense.ID
            iscontext: true
          right:
            value:
              simple: "1"
      - - operator: isTrue
          left:
            value:
              simple: QRadar.Offense.Followup
            iscontext: true
      - - operator: isTrue
          left:
            value:
              simple: QRadar.Offense.Protected
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 0bae31e2-cb51-4dd2-8801-8adbf13ea7c2
    type: regular
    task:
      id: 0bae31e2-cb51-4dd2-8801-8adbf13ea7c2
      version: -1
      name: Create Note To Offense
      description: Retrieve a list of notes for an offense.
      script: '|||qradar-offense-note-create'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      note_text:
        simple: Note Regarding The Offense
      offense_id:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: fe4bb3b0-bf1c-455c-8b1d-84fb8b416424
    type: condition
    task:
      id: fe4bb3b0-bf1c-455c-8b1d-84fb8b416424
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "12"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Note.CreatedBy
            iscontext: true
          right:
            value:
              simple: 'API_user: engadmin-M6IS5rhJ'
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Note.Text
            iscontext: true
          right:
            value:
              simple: Note Regarding The Offense
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: 0f135067-75ed-43a3-86ee-d2695c8e4d94
    type: regular
    task:
      id: 0f135067-75ed-43a3-86ee-d2695c8e4d94
      version: -1
      name: Note List
      description: Create a note on an offense.
      script: '|||qradar-offense-notes-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      offense_id:
        simple: "1"
      range:
        simple: 0-1
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: c5ddbc4f-c0cb-49ca-8c6e-28fbdb32abe5
    type: condition
    task:
      id: c5ddbc4f-c0cb-49ca-8c6e-28fbdb32abe5
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "13"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Note.CreatedBy
            iscontext: true
          right:
            value:
              simple: 'API_user: demistoadmin'
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Note.Text
            iscontext: true
          right:
            value:
              simple: Note Regarding The Offense
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: 768ecafd-a880-44b5-8a4f-2ddbdbc4a0af
    type: regular
    task:
      id: 768ecafd-a880-44b5-8a4f-2ddbdbc4a0af
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: 5de796d8-bf9e-4838-8fcc-246bd09ed8cd
    type: regular
    task:
      id: 5de796d8-bf9e-4838-8fcc-246bd09ed8cd
      version: -1
      name: Get Closing Reasons List
      description: Retrieve a list of offense closing reasons.
      script: '|||qradar-closing-reasons'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      filter:
        simple: id <= 2
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 8b4fc1c2-ba49-42a2-8972-2ebc3f332359
    type: condition
    task:
      id: 8b4fc1c2-ba49-42a2-8972-2ebc3f332359
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "15"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: hasLength
          left:
            value:
              simple: QRadar.Offense.ClosingReasons.ID
            iscontext: true
          right:
            value:
              simple: "2"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.ClosingReasons.ID
            iscontext: true
          right:
            value:
              simple: "1"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.ClosingReasons.ID
            iscontext: true
          right:
            value:
              simple: "2"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.ClosingReasons.Name
            iscontext: true
          right:
            value:
              simple: False-Positive, Tuned
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Offense.ClosingReasons.Name
            iscontext: true
          right:
            value:
              simple: Non-Issue
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 38237856-27df-4469-83f5-aff35728bb9e
    type: regular
    task:
      id: 38237856-27df-4469-83f5-aff35728bb9e
      version: -1
      name: Rules List
      description: Retrieves a list of rules.
      script: '|||qradar-rules-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      filter:
        simple: id between 100001 AND 100006
      range:
        simple: 0-5
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: 4178c5af-f29c-461f-8a49-b5c6f7ea0b35
    type: condition
    task:
      id: 4178c5af-f29c-461f-8a49-b5c6f7ea0b35
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "17"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.Name
            iscontext: true
          right:
            value:
              simple: Devices with High Event Rates
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.Owner
            iscontext: true
          right:
            value:
              simple: admin
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.CreationDate
            iscontext: true
          right:
            value:
              simple: "2007-08-09T14:38:27.862000+00:00"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.Origin
            iscontext: true
          right:
            value:
              simple: SYSTEM
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.Type
            iscontext: true
          right:
            value:
              simple: EVENT
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.ID
            iscontext: true
          right:
            value:
              simple: "100001"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.ID
            iscontext: true
          right:
            value:
              simple: "100003"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Rule.ID
            iscontext: true
          right:
            value:
              simple: "100006"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: beb47c24-2c8b-4eaa-8a78-40e6e272ef64
    type: regular
    task:
      id: beb47c24-2c8b-4eaa-8a78-40e6e272ef64
      version: -1
      name: Group Rule List
      description: Retrieves a list of the rule groups.
      script: '|||qradar-rule-groups-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      range:
        simple: 0-0
      rule_group_id:
        simple: "125"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: 9c01313d-95c6-445f-8cc9-0ba8a79eb647
    type: condition
    task:
      id: 9c01313d-95c6-445f-8cc9-0ba8a79eb647
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "19"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RuleGroup.Owner
            iscontext: true
          right:
            value:
              simple: admin
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RuleGroup.ID
            iscontext: true
          right:
            value:
              simple: "125"
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RuleGroup.Name
            iscontext: true
          right:
            value:
              simple: Asset Reconciliation Exclusion
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RuleGroup.Type
            iscontext: true
          right:
            value:
              simple: RULE_GROUP
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: de695651-d13a-4863-828f-d4f27567692f
    type: regular
    task:
      id: de695651-d13a-4863-828f-d4f27567692f
      version: -1
      name: Assets List
      description: Retrieves assets list.
      script: '|||qradar-assets-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      asset_id:
        simple: "1007"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 49ce4a7a-1003-4c6e-841b-b4ece43753e2
    type: condition
    task:
      id: 49ce4a7a-1003-4c6e-841b-b4ece43753e2
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "21"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Asset.ID
            iscontext: true
          right:
            value:
              simple: "1007"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Asset.DomainID
            iscontext: true
          right:
            value:
              simple: "0"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: 2508737c-178b-4e16-8911-2e51e82d0c5d
    type: regular
    task:
      id: 2508737c-178b-4e16-8911-2e51e82d0c5d
      version: -1
      name: Create Reference Set
      description: Create a new reference set.
      script: '|||qradar-reference-set-create'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      element_type:
        simple: DATE
      ref_name:
        simple: Test-Reference-${incident.autime}
      time_to_live:
        simple: 1 day
      timeout_type:
        simple: FIRST_SEEN
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 611d53dc-896a-4fb0-84d7-6e8b0f855af5
    type: condition
    task:
      id: 611d53dc-896a-4fb0-84d7-6e8b0f855af5
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "25"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Reference.TimeToLive
            iscontext: true
          right:
            value:
              simple: 0 years 0 mons 1 days 0 hours 0 mins 0.0 secs
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Reference.TimeoutType
            iscontext: true
          right:
            value:
              simple: FIRST_SEEN
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Reference.NumberOfElements
            iscontext: true
          right:
            value:
              simple: "0"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Reference.Name
            iscontext: true
          right:
            value:
              simple: Test-Reference
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Reference.ElementType
            iscontext: true
          right:
            value:
              simple: DATE
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3695
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: ca666849-51e2-4336-827f-8d3d291d27d2
    type: regular
    task:
      id: ca666849-51e2-4336-827f-8d3d291d27d2
      version: -1
      name: Get Reference Details
      description: Retrieve a list of reference sets.
      script: '|||qradar-reference-sets-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      ref_name:
        simple: Test-Reference-${incident.autime}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5095
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "25":
    id: "25"
    taskid: c1dc63f9-117f-42b8-8925-b7f6f49f4198
    type: regular
    task:
      id: c1dc63f9-117f-42b8-8925-b7f6f49f4198
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "60"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: 84444cfa-357f-4d5c-86fb-2adc5f42ec95
    type: regular
    task:
      id: 84444cfa-357f-4d5c-86fb-2adc5f42ec95
      version: -1
      name: Add Value To Reference
      description: Add or update an element in a reference set.
      script: '|||qradar-reference-set-value-upsert'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "28"
    scriptarguments:
      date_value:
        simple: "True"
      ref_name:
        simple: Test-Reference-${incident.autime}
      value:
        simple: "2020-12-12T12:12:12Z"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4745
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: 246fcf67-1e42-43c4-84ca-f1b8eb27e814
    type: condition
    task:
      id: 246fcf67-1e42-43c4-84ca-f1b8eb27e814
      version: -1
      name: Validate Outputs, With New Element Count
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "29"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Reference.NumberOfElements
            iscontext: true
          right:
            value:
              simple: "1"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Reference.Name
            iscontext: true
          right:
            value:
              simple: Test-Reference
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Reference.Data.Value
            iscontext: true
          right:
            value:
              simple: "1607775132000"
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.Reference.TimeoutType
            iscontext: true
          right:
            value:
              simple: FIRST_SEEN
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: d93a2389-354a-451b-8dc4-ecc0dc85ecac
    type: regular
    task:
      id: d93a2389-354a-451b-8dc4-ecc0dc85ecac
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: 397da81b-d0f6-4faf-8f4b-2ad5af03bb43
    type: regular
    task:
      id: 397da81b-d0f6-4faf-8f4b-2ad5af03bb43
      version: -1
      name: Delete Reference Set Value
      description: Remove a value from a reference set.
      script: '|||qradar-reference-set-value-delete'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      date_value:
        simple: "True"
      ref_name:
        simple: Test-Reference-${incident.autime}
      value:
        simple: "2020-12-12T12:12:12Z"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: 4efe01c2-9347-4d48-8860-5e1a6a344ef1
    type: regular
    task:
      id: 4efe01c2-9347-4d48-8860-5e1a6a344ef1
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: 1ea3a1ac-d0e3-4717-8f91-6564bfe1a5ce
    type: regular
    task:
      id: 1ea3a1ac-d0e3-4717-8f91-6564bfe1a5ce
      version: -1
      name: Get Reference With The Deleted Value
      description: Retrieve a list of reference sets.
      script: '|||qradar-reference-sets-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      ref_name:
        simple: Test-Reference-${incident.autime}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5795
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: 750a029e-929c-4004-80cf-55abd5590de2
    type: condition
    task:
      id: 750a029e-929c-4004-80cf-55abd5590de2
      version: -1
      name: Validate Outputs, Validate Element Count Decreased
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "33"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Reference.NumberOfElements
            iscontext: true
          right:
            value:
              simple: "0"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: 426d7a37-e750-45c1-8f64-c8e632b0a4ad
    type: regular
    task:
      id: 426d7a37-e750-45c1-8f64-c8e632b0a4ad
      version: -1
      name: Delete Reference Set
      description: Removes a reference set or purges its contents.
      script: '|||qradar-reference-set-delete'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      ref_name:
        simple: Test-Reference-${incident.autime}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6145
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: 86f40bcf-52d8-430d-851f-29b33b770ffe
    type: regular
    task:
      id: 86f40bcf-52d8-430d-851f-29b33b770ffe
      version: -1
      name: Get Domains List
      description: Gets the list of domains. You must have the System Administrator
        or Security Administrator permissions to call this endpoint if you are trying
        to retrieve the details of all domains. You can retrieve details of domains
        that are assigned to your Security Profile without having the System Administrator
        or Security Administrator permissions. If you do not have the System Administrator
        or Security Administrator permissions, then for each domain assigned to your
        security profile you can only view the values for the id and name fields.
        All other values return null.
      script: '|||qradar-domains-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "35"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: 502e1a20-0d93-49b0-81a1-324aca424ab9
    type: condition
    task:
      id: 502e1a20-0d93-49b0-81a1-324aca424ab9
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "36"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Domains.ID
            iscontext: true
          right:
            value:
              simple: "0"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6495
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: f143af2c-b02b-4461-8abd-2f011e389d68
    type: regular
    task:
      id: f143af2c-b02b-4461-8abd-2f011e389d68
      version: -1
      name: Geolocations For IPs
      description: Retrieves the MaxMind geoip data for the given IP address.
      script: '|||qradar-geolocations-for-ip'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "37"
    scriptarguments:
      ip:
        simple: 1.2.3.4,1.2.3.5
      ips:
        simple: 1.2.3.4,1.2.3.5
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: b1f08309-3816-42bc-8769-ee397624028e
    type: condition
    task:
      id: b1f08309-3816-42bc-8769-ee397624028e
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "38"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.IPAddress
            iscontext: true
          right:
            value:
              simple: 1.2.3.4
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.GeoForIP.IPAddress
            iscontext: true
          right:
            value:
              simple: 1.2.3.5
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.CityName
            iscontext: true
          right:
            value:
              simple: Mukilteo
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.ContinentName
            iscontext: true
          right:
            value:
              simple: NorthAmerica
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.LocationLongitude
            iscontext: true
          right:
            value:
              simple: "-122.3042"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.LocationTimezone
            iscontext: true
          right:
            value:
              simple: America/Los_Angeles
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.PhysicalCountryName
            iscontext: true
          right:
            value:
              simple: United States
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.GeoForIP.PostalCode
            iscontext: true
          right:
            value:
              simple: "98275"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6845
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: 37c89359-0fc7-44bc-8366-ede109963a23
    type: regular
    task:
      id: 37c89359-0fc7-44bc-8366-ede109963a23
      version: -1
      name: Sources List
      description: Retrieves a list of log sources.
      script: '|||qradar-log-sources-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "39"
    scriptarguments:
      filter:
        simple: id=112
      qrd_encryption_algorithm:
        simple: AES128
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7020
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: 0c7bc9ef-5280-4849-8df3-f456c48dff0e
    type: condition
    task:
      id: 0c7bc9ef-5280-4849-8df3-f456c48dff0e
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "40"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.LogSource.ID
            iscontext: true
          right:
            value:
              simple: "112"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.LogSource.Credibility
            iscontext: true
          right:
            value:
              simple: "5"
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.LogSource.TypeID
            iscontext: true
          right:
            value:
              simple: "12"
      - - operator: isFalse
          left:
            value:
              simple: QRadar.LogSource.Gateway
            iscontext: true
      - - operator: isTrue
          left:
            value:
              simple: QRadar.LogSource.AutoDiscovered
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: 1daee3c5-bc56-411f-8821-0b2b85cb7301
    type: regular
    task:
      id: 1daee3c5-bc56-411f-8821-0b2b85cb7301
      version: -1
      name: Custom Properties
      description: Retrieves a list of event regex properties.
      script: '|||qradar-get-custom-properties'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "41"
    scriptarguments:
      filter:
        simple: id = 129 OR id = 212
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: 4e17f4bc-bd21-435f-8c42-ce4a1b71e509
    type: condition
    task:
      id: 4e17f4bc-bd21-435f-8c42-ce4a1b71e509
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "43"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Properties.name
            iscontext: true
          right:
            value:
              simple: Filename
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Properties.username
            iscontext: true
          right:
            value:
              simple: admin
      - - operator: containsGeneral
          left:
            value:
              simple: QRadar.Properties.property_type
            iscontext: true
          right:
            value:
              simple: string
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: 89d91d84-8694-4238-8edd-bf8c5478c962
    type: regular
    task:
      id: 89d91d84-8694-4238-8edd-bf8c5478c962
      version: -1
      name: Get Saved Searches
      description: Retrieves a list of Ariel saved searches.
      script: '|||qradar-saved-searches-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "44"
    scriptarguments:
      range:
        simple: 0-1
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "44":
    id: "44"
    taskid: 52111b13-14df-4444-8e52-fc805aca933e
    type: regular
    task:
      id: 52111b13-14df-4444-8e52-fc805aca933e
      version: -1
      name: Get Search IDs
      description: Retrieves the list of Ariel searches IDs. Search status and results
        can be polled by sending search ID to 'qradar-search-status-get' and 'qradar-search-results-get'
        commands.
      script: '|||qradar-searches-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "45"
    scriptarguments:
      range:
        simple: 0-2
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: 2e1bd6c1-d5aa-406c-8759-4601089d4b9b
    type: playbook
    task:
      id: 2e1bd6c1-d5aa-406c-8759-4601089d4b9b
      version: -1
      name: QRadarFullSearch
      description: This playbook runs a QRadar query and return its results to the
        context.
      playbookName: QRadarFullSearch
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "46"
    scriptarguments:
      interval:
        simple: "1"
      query_expression:
        simple: SELECT QIDNAME(qid), LOGSOURCENAME(logsourceid), CATEGORYNAME(highlevelcategory),
          CATEGORYNAME(category), PROTOCOLNAME(protocolid), sourceip, sourceport,
          destinationip, destinationport, QIDDESCRIPTION(qid), username, PROTOCOLNAME(protocolid),
          RULENAME("creEventList"), sourcegeographiclocation, sourceMAC, sourcev6,
          destinationgeographiclocation, destinationv6, LOGSOURCETYPENAME(devicetype),
          credibility, severity, magnitude, eventcount, eventDirection, postNatDestinationIP,
          postNatDestinationPort, postNatSourceIP, postNatSourcePort, preNatDestinationPort,
          preNatSourceIP, preNatSourcePort, UTF8(payload), starttime, devicetime  FROM
          events WHERE INOFFENSE(1)  limit 20 START 1605046453426
      timeout:
        simple: "600"
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: 76d06dc3-6199-4779-8aad-241c3f745d92
    type: regular
    task:
      id: 76d06dc3-6199-4779-8aad-241c3f745d92
      version: -1
      name: Get Source IPs
      description: Get Source IPs
      script: '|||qradar-ips-source-get'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "47"
    scriptarguments:
      range:
        simple: 0-0
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: d43907b8-740e-4f7d-8ed5-48ec1c10a5f9
    type: condition
    task:
      id: d43907b8-740e-4f7d-8ed5-48ec1c10a5f9
      version: -1
      name: Does Results Exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "48"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: QRadar.SourceIP.ID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: ff1de672-865e-440a-8d89-0f96b32775a4
    type: regular
    task:
      id: ff1de672-865e-440a-8d89-0f96b32775a4
      version: -1
      name: Get Local Destination IPs
      description: Get Source IPs
      script: '|||qradar-ips-local-destination-get'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "49"
    scriptarguments:
      range:
        simple: 0-0
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: 8f2e3553-50e6-4fe0-8e1c-ccaff8981fed
    type: condition
    task:
      id: 8f2e3553-50e6-4fe0-8e1c-ccaff8981fed
      version: -1
      name: Does Results Exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "63"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: QRadar.LocalDestinationIP.ID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "52":
    id: "52"
    taskid: d9e59464-b34a-4770-8d64-f7629be8694a
    type: regular
    task:
      id: d9e59464-b34a-4770-8d64-f7629be8694a
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "26"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: 1fbd67bd-6ffc-4b9d-8f1e-da527451a9b8
    type: regular
    task:
      id: 1fbd67bd-6ffc-4b9d-8f1e-da527451a9b8
      version: -1
      name: 'create reference set with #'
      description: Creates a new reference set.
      script: '|||qradar-reference-set-create'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "61"
    scriptarguments:
      element_type:
        simple: IP
      ref_name:
        simple: '# testing name'
      time_to_live:
        simple: 1 day
      timeout_type:
        simple: FIRST_SEEN
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4045
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    id: "61"
    taskid: bbeba8f2-d39d-4dad-89f0-13a069bac786
    type: regular
    task:
      id: bbeba8f2-d39d-4dad-89f0-13a069bac786
      version: -1
      name: 'set value to reference set that contains #'
      description: Adds or updates an element in a reference set.
      script: '|||qradar-reference-set-value-upsert'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "62"
    scriptarguments:
      ref_name:
        simple: '# testing name'
      value:
        simple: 8.8.8.8
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "62":
    id: "62"
    taskid: 0900b189-fbea-4034-8b3a-3f0dadef3bf6
    type: regular
    task:
      id: 0900b189-fbea-4034-8b3a-3f0dadef3bf6
      version: -1
      name: 'delete reference set with #'
      description: Removes a reference set or purges its contents.
      script: '|||qradar-reference-set-delete'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "52"
    scriptarguments:
      ref_name:
        simple: '# testing name'
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4395
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: 3c5763cf-a150-4357-8f73-dbf04e06a214
    type: regular
    task:
      id: 3c5763cf-a150-4357-8f73-dbf04e06a214
      version: -1
      name: Get events with polling
      description: Polling command to search for events of a specific offense.
      script: '|||qradar-search-retrieve-events'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "64"
    scriptarguments:
      offense_id:
        simple: "194"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "64":
    id: "64"
    taskid: d72100ab-e261-4b2d-89c4-28a2c6d675b1
    type: condition
    task:
      id: d72100ab-e261-4b2d-89c4-28a2c6d675b1
      version: -1
      name: Validate polling
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "67"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: QRadar.SearchEvents.ID
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              simple: QRadar.SearchEvents.Events
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "65":
    id: "65"
    taskid: 71adb7ca-7748-499e-8258-776dd8458280
    type: regular
    task:
      id: 71adb7ca-7748-499e-8258-776dd8458280
      version: -1
      name: get events with polling custom query
      description: Polling command to search for events of a specific offense.
      script: '|||qradar-search-retrieve-events'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "66"
    scriptarguments:
      query_expression:
        simple: SELECT * FROM events WHERE INOFFENSE(194) limit 3 start 3600000
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "66":
    id: "66"
    taskid: 04aa6d7a-3336-4c43-8d6c-f25baad565a2
    type: condition
    task:
      id: 04aa6d7a-3336-4c43-8d6c-f25baad565a2
      version: -1
      name: Validate polling
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "68"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: QRadar.SearchEvents.ID
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              simple: QRadar.SearchEvents.Events
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "67":
    id: "67"
    taskid: fcd9102c-3659-42ed-8b63-35bdc27e30d8
    type: regular
    task:
      id: fcd9102c-3659-42ed-8b63-35bdc27e30d8
      version: -1
      name: Delete Context
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "65"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "68":
    id: "68"
    taskid: ddaf71fa-0c35-4a29-8f77-a8256bd05611
    type: regular
    task:
      id: ddaf71fa-0c35-4a29-8f77-a8256bd05611
      version: -1
      name: Delete Context
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "69"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "69":
    id: "69"
    taskid: 703de2c6-e3e8-42ac-8f89-e85aa43a76da
    type: regular
    task:
      id: 703de2c6-e3e8-42ac-8f89-e85aa43a76da
      version: -1
      name: Create Remote network cidrs
      description: Create remote network cidrs
      script: '|||qradar-remote-network-cidr-create'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "70"
    scriptarguments:
      cidrs:
        simple: 127.0.0.1/32
      description:
        simple: playbook-test
      group:
        simple: playbook-test-group
      name:
        simple: playbook-test
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "70":
    id: "70"
    taskid: f0d0cad2-9696-4ccc-88fb-c73688b93026
    type: regular
    task:
      id: f0d0cad2-9696-4ccc-88fb-c73688b93026
      version: -1
      name: Remote network cidrs List
      description: Retrieves the list of staged remote networks.
      script: '|||qradar-remote-network-cidr-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "71"
    scriptarguments:
      group:
        simple: playbook-test-group
      name:
        simple: playbook-test
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 10170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "71":
    id: "71"
    taskid: f7fe1e5d-8b96-4f8a-8425-eb495e96913a
    type: condition
    task:
      id: f7fe1e5d-8b96-4f8a-8425-eb495e96913a
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "72"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RemoteNetworkCIDR.name
            iscontext: true
          right:
            value:
              simple: playbook-test
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 10345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "72":
    id: "72"
    taskid: fac87fbe-81c6-4cf7-8ff5-3a2178bca025
    type: regular
    task:
      id: fac87fbe-81c6-4cf7-8ff5-3a2178bca025
      version: -1
      name: Update Remote network cidrs
      description: Updates an existing staged remote network.
      script: '|||qradar-remote-network-cidr-update'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "73"
    scriptarguments:
      cidrs:
        simple: 127.0.0.1/32,1.2.3.4/8
      description:
        simple: playbook-test-updated
      group:
        simple: playbook-test-group-updated
      id:
        simple: ${QRadar.RemoteNetworkCIDR.id}
      name:
        simple: playbook-test-updated
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 10520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "73":
    id: "73"
    taskid: b1d2f92f-c997-48c4-8b77-1365c57e5c0e
    type: condition
    task:
      id: b1d2f92f-c997-48c4-8b77-1365c57e5c0e
      version: -1
      name: Validate Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "74"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RemoteNetworkCIDR.name
            iscontext: true
          right:
            value:
              simple: playbook-test-updated
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RemoteNetworkCIDR.group
            iscontext: true
          right:
            value:
              simple: playbook-test-group-updated
      - - operator: isEqualString
          left:
            value:
              simple: QRadar.RemoteNetworkCIDR.description
            iscontext: true
          right:
            value:
              simple: playbook-test-updated
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 10695
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "74":
    id: "74"
    taskid: feb56d89-12b9-4baf-8f39-2b9085a1c17d
    type: regular
    task:
      id: feb56d89-12b9-4baf-8f39-2b9085a1c17d
      version: -1
      name: Delete Remote network cidrs
      description: Deletes an existing staged remote network.
      script: '|||qradar-remote-network-cidr-delete'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      id:
        simple: ${QRadar.RemoteNetworkCIDR.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 10870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 11060,
        "width": 380,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
