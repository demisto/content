args:
- description: The values of the first field to search. This can be a single value
    or a comma-separated list of values. For example admin1,admin2.
  isArray: true
  name: base_values_to_search
  required: true
- description: The field names of the first field to search. This can be a single
    value or a comma-separated list of values. For example admin1,admin2.
  isArray: true
  name: base_fields_to_search
- auto: PREDEFINED
  defaultValue: include
  description: The state of the first field to search, meaning whether the values
    in the field should be included or excluded.
  name: base_field_state
  predefined:
  - include
  - exclude
  required: true
- auto: PREDEFINED
  defaultValue: exact
  description: Whether the values of the second field should be an exact match or
    a partial match.
  name: base_field_match
  predefined:
  - exact
  - partial
  required: true
- defaultValue: DATEFORMAT(devicetime,'dd-MM-yyyy hh:mm'),LOGSOURCENAME(logsourceid),CATEGORYNAME(category),QIDNAME(qid),sourceip,destinationip,username
  description: The list of fields to select within the AQL query.
  name: select_fields
  required: true
- defaultValue: LAST 1 HOURS
  description: Time frame as used in AQL examples can be LAST 7 DAYS START '2019-09-25
    15:51' STOP '2019-09-25 17:51'. For more examples, view IBM's AQL documentation.
  name: time_frame
  required: true
- description: The values of the second field to search. This can be a single value
    or a comma-separated list of values. For example admin1,admin2.
  isArray: true
  name: first_additional_values
- description: The field names of the second field to search. This can be a single
    value or a comma-separated list of values. For example admin1,admin2.
  isArray: true
  name: first_additional_fields
- auto: PREDEFINED
  defaultValue: include
  description: The state of the second field to search, meaning whether the values
    in the field should be included or excluded.
  name: first_additional_field_state
  predefined:
  - include
  - exclude
  required: true
- auto: PREDEFINED
  defaultValue: exact
  description: Whether the values of the second field should be an exact match or
    a partial match.
  name: first_additional_field_match
  predefined:
  - exact
  - partial
  required: true
- description: The values of the third field to search. This can be a single value
    or a comma-separated list of values. For example admin1,admin2.
  name: second_additional_values
- description: The field names of the third field to search. This can be a single
    value or a comma-separated list of values. For example username,user.
  name: second_additional_fields
- auto: PREDEFINED
  defaultValue: include
  description: The state of the third field to search, meaning whether the values
    in the field should be included or excluded.
  name: second_additional_field_state
  predefined:
  - include
  - exclude
  required: true
- auto: PREDEFINED
  defaultValue: exact
  description: Whether the values of the third field should be an exact match or a
    partial match. When choosing exact, the AQL query will use the = operator. When
    choosing partial, the AQL query will use ILIKE and add '%%' to the values.
  name: second_additional_field_match
  predefined:
  - exact
  - partial
comment: Build QRadar AQL Query.
commonfields:
  id: QRadarCreateAQLQuery
  version: -1
dockerimage: demisto/python3:3.9.8.24399
fromversion: 6.0.0
name: QRadarCreateAQLQuery
outputs:
- contextPath: QRadarQuery
  description: The resultant AQL query based on the inputs.
  type: string
runas: DBotWeakRole
script:
- '8.1'
subtype: python3
tags:
- Utility
tests:
- No tests (auto formatted)
type: python
