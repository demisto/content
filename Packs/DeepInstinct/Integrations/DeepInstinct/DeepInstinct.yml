commonfields:
  id: Deep Instinct
  version: -1
name: Deep Instinct
display: Deep Instinct
category: Network Security
description: Deep Instinct
configuration:
- display: Base server URL
  name: base_url
  defaultvalue: "https://my-deep-instinct-path.deepinstinctweb.com"
  type: 0
  required: true
- display: API Key
  name: apikey
  defaultvalue: ""
  type: 4
  required: true
- display: Fetch incidents
  name: isFetch
  type: 8
  required: false
- display: Incident type
  name: incidentType
  type: 13
  required: false
- display: first event ID to fetch from
  name: first_fetch_id
  defaultvalue: "0"
  type: 0
  required: false
script:
  commands:
  - name: deepinstinct-get-device
    arguments:
    - name: device_id
      required: true
      description: The device ID.
    outputs:
    - contextPath: DeepInstinct.devices.ID
      description: Device ID.
      type: number
    - contextPath: DeepInstinct.devices.os
      description: Device OS.
      type: string
    - contextPath: DeepInstinct.devices.osv
      description: Device OS version.
      type: string
    - contextPath: DeepInstinct.devices.ip_address
      description: Device IP address.
      type: string
    - contextPath: DeepInstinct.devices.mac_address
      description: Device MAC address.
      type: string
    - contextPath: DeepInstinct.devices.hostname
      description: Device hostname.
      type: string
    - contextPath: DeepInstinct.devices.domain
      description: Device domain.
      type: string
    - contextPath: DeepInstinct.devices.scanned_files
      description: Number of device scanned files.
      type: number
    - contextPath: DeepInstinct.devices.tag
      description: Device tag.
      type: string
    - contextPath: DeepInstinct.devices.connectivity_status
      description: Device connectivity status.
      type: string
    - contextPath: DeepInstinct.devices.deployment_status
      description: Device deployment status.
      type: string
    - contextPath: DeepInstinct.devices.last_registration
      description: Device last registration datetime.
      type: string
    - contextPath: DeepInstinct.devices.last_contact
      description: Device last contact datetime.
      type: string
    - contextPath: DeepInstinct.devices.distinguished_name
      description: Device distinguished name.
      type: string
    - contextPath: DeepInstinct.devices.group_name
      description: Device group name.
      type: string
    - contextPath: DeepInstinct.devices.group_id
      description: Device group ID.
      type: number
    - contextPath: DeepInstinct.devices.policy_name
      description: Device policy name.
      type: string
    - contextPath: DeepInstinct.devices.policy_id
      description: Device policy ID.
      type: number
    - contextPath: DeepInstinct.devices.log_status
      description: Device log status.
      type: string
    - contextPath: DeepInstinct.devices.agent_version
      description: Device agent version.
      type: string
    - contextPath: DeepInstinct.devices.brain_version
      description: Device brain version.
      type: string
    - contextPath: DeepInstinct.devices.msp_name
      description: Device MSP name.
      type: string
    - contextPath: DeepInstinct.devices.msp_id
      description: Device MSP ID.
      type: number
    - contextPath: DeepInstinct.devices.tenant_name
      description: Device tenant name.
      type: string
    - contextPath: DeepInstinct.devices.tenant_id
      description: Device tenant ID.
      type: number
    description: Gets a specific device by device ID.
  - name: deepinstinct-get-events
    arguments:
    - name: first_event_id
      description: First event ID to get. Default is 0. The maximum number of events is 50.
      defaultValue: "0"
    outputs:
    - contextPath: DeepInstinct.Events.events.ID
      description: Event ID.
      type: number
    - contextPath: DeepInstinct.Events.events.device_id
      description: Event device ID.
      type: number
    - contextPath: DeepInstinct.Events.events.file_hash
      description: Event file hash.
      type: string
    - contextPath: DeepInstinct.Events.events.file_type
      description: Event file type.
      type: string
    - contextPath: DeepInstinct.Events.events.file_archive_hash
      description: Event file archive hash.
      type: string
    - contextPath: DeepInstinct.Events.events.path
      description: Event file path.
    - contextPath: DeepInstinct.Events.events.file_size
      description: Event file size.
      type: number
    - contextPath: DeepInstinct.Events.events.threat_severity
      description: Event threat severity.
      type: string
    - contextPath: DeepInstinct.Events.events.deep_classification
      description: Deep Instinct classification.
      type: string
    - contextPath: DeepInstinct.Events.events.file_status
      description: Event file status.
      type: string
    - contextPath: sandbox_statusDeepInstinct.Events.events.
      description: Event sandbox status.
      type: string
    - contextPath: DeepInstinct.Events.events.model
      description: Event model.
      type: string
    - contextPath: DeepInstinct.Events.events.type
      description: Event type.
      type: string
    - contextPath: DeepInstinct.Events.events.trigger
      description: Event trigger.
      type: string
    - contextPath: DeepInstinct.Events.events.action
      description: Event action.
      type: string
    - contextPath: DeepInstinct.Events.events.tenant_id
      description: Event tenant ID.
      type: number
    - contextPath: DeepInstinct.Events.events.msp_id
      description: Event MSP ID.
      type: number
    - contextPath: DeepInstinct.Events.events.status
      description: Event status.
      type: string
    - contextPath: DeepInstinct.Events.events.close_trigger
      description: Event close trigger.
      type: string
    - contextPath: DeepInstinct.Events.events.reoccurrence_count
      description: Event reoccurrence count.
      type: number
    description: Gets all events. The maximum number of events in response is 50. Use the first_event_id
      parameter to define first event ID to get.
  - name: deepinstinct-get-all-groups
    arguments: []
    outputs:
    - contextPath: DeepInstinct.Groups.ID
      description: Group id.
      type: number
    - contextPath: DeepInstinct.Groups.os
      description: Group operation system.
      type: string
    - contextPath: DeepInstinct.Groups.name
      description: Group name.
      type: string
    - contextPath: DeepInstinct.Groups.policy_id
      description: Group policy ID.
      type: number
    - contextPath: DeepInstinct.Groups.is_default_group
      description: True if group is a default group, false otherwise.
      type: boolean
    - contextPath: DeepInstinct.Groups.msp_name
      description: MSP name.
      type: string
    - contextPath: DeepInstinct.Groups.msp_id
      description: MSP ID.
      type: number
    description: get all groups
  - name: deepinstinct-get-all-policies
    arguments: []
    outputs:
    - contextPath: DeepInstinct.Policies.ID
      description: Policy ID.
      type: number
    - contextPath: DeepInstinct.Policies.name
      description: Policy name.
      type: string
    - contextPath: DeepInstinct.Policies.os
      description: Policy operating system.
      type: string
    - contextPath: DeepInstinct.Policies.is_default_policy
      description: True if policy is a default policy, false otherwise.
      type: boolean
    - contextPath: DeepInstinct.Policies.msp_id
      description: MSP ID.
      type: number
    - contextPath: DeepInstinct.Policies.msp_name
      description: msp name
      type: string
    description: Gets all policies.
  - name: deepinstinct-add-hash-to-blacklist
    arguments:
    - name: policy_id
      required: true
      description: policy ID
    - name: file_hash
      required: true
      description: File hash.
    - name: comment
      description: Optional, add comment to hash field.
      defaultValue: ''
    description: Adds a file hash to blacklist.
  - name: deepinstinct-add-hash-to-whitelist
    arguments:
    - name: policy_id
      required: true
      description: Policy ID.
    - name: file_hash
      required: true
      description: File hash.
    - name: comment
      description: Optional, add comment to hash field.
      defaultValue: ''
    description: Adds a file hash to the whitelist.
  - name: deepinstinct-remove-hash-from-blacklist
    arguments:
      - name: policy_id
        required: true
        description: policy ID
      - name: file_hash
        required: true
        description: File hash.
    description: Removes a file hash from the blacklist.
  - name: deepinstinct-remove-hash-from-whitelist
    arguments:
      - name: policy_id
        required: true
        description: Policy ID.
      - name: file_hash
        required: true
        description: File hash.
    description: Removes a file hash from the whitelist.
  - name: deepinstinct-add-devices-to-group
    arguments:
    - name: group_id
      required: true
      description: Froup ID.
    - name: device_ids
      required: true
      description: A comma-separated list of devices IDs.
      isArray: true
    description: Adds multiple devices to a group.
  - name: deepinstinct-remove-devices-from-group
    arguments:
    - name: group_id
      required: true
      description: Group ID from which to remove.
    - name: device_ids
      required: true
      description: A comma-separeted list of device IDs to remove.
      isArray: true
    description: Removes a list of devices from a group.
  - name: deepinstinct-delete-files-remotely
    arguments:
    - name: event_ids
      required: true
      description: A comma-separeted list of event IDs.
      isArray: true
    description: Deletes multiple files remotely.
  - name: deepinstinct-terminate-processes
    arguments:
    - name: event_ids
      required: true
      description: A comma-separeted list of event IDs.
      isArray: true
    description: Terminates a list of processes.
  - name: deepinstinct-close-events
    arguments:
    - name: event_ids
      required: true
      description: A comma-separeted list of event ID.
      isArray: true
    description: Closes a list of events.
  dockerimage: demisto/python3:3.7.4.2245
  isfetch: true
  runonce: false
  script: '-'
  type: python
  subtype: python3
