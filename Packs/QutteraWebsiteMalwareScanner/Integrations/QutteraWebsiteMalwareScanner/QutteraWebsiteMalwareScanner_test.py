import json


def test_quttera_start_scan(requests_mock):
    """test quttera-start-scan command
    """
    from QutteraWebsiteMalwareScanner import Client, scan_start_command

    mock_response = {
        "error": 200,
        "errorstr": "success"
    }
    requests_mock.get(
        "https://scannerapi.quttera.com/api/v3/xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx/url/scan/domain.test",
        json=mock_response
    )

    args = {
        "domain": "domain.test"
    }

    client = Client(
        base_url = "https://scannerapi.quttera.com/api/v3/xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
    )

    response = scan_start_command(client, args)

    assert response.output_key_field == 'QutteraWebsiteMalwareScanning.start'
    assert response.outputs = mock_response
