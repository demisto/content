commonfields:
  id: QutteraWebsiteMalwareScanner
  version: -1
name: QutteraWebsiteMalwareScanner
display: QutteraWebsiteMalwareScanner
category: Data Enrichment & Threat Intelligence
description: Quttera Website Malware Scanner.
detaileddescription: |-
  Interact with Quttera Website Malware Scanner
  API to perform real-time/on-demand recursive
  scan of a domain or URL,
  retrieve malware scan report and blacklisting information.
configuration:
- display: API Key
  name: apikey
  required: true
  type: 4
- display: Quttera Scanner URL
  name: base_url
  required: true
  defaultvalue: "https://scannerapi.quttera.com"
  type: 0
script:
  type: python
  subtype: python3
  dockerimage: demisto/python3:3.12.8.1983910
  script: ''
  commands:
  - name: quttera-scan-start
    arguments:
    - name: domain
      required: true
      default: true
      description: The name of the domain to scan.
    outputs:
    - contextPath: QutteraWebsiteMalwareScanning.Start.error
      description: 'HTTP response from the scanner.'
      type: Number
    - contextPath: QutteraWebsiteMalwareScanning.Start.errorstr
      description: 'Status of the scan request.'
      type: String
    description: Start to scan a given domain.
  - name: quttera-rescan-status
    arguments:
    - name: domain
      required: true
      default: true
      description: The name of the domain to retrieve its status.
    outputs:
    - contextPath: QutteraWebsiteMalwareScanning.Status.error
      description: Scan result request status.
      type: Number
    - contextPath: QutteraWebsiteMalwareScanning.Status.errorstr
      description: Scan result request description.
      type: String
    - contextPath: QutteraWebsiteMalwareScanning.Status.status.blacklisted
      description: Is the domain blacklisted.
      type: String
    - contextPath: QutteraWebsiteMalwareScanning.Status.status.files
      description: Amount of scanned files.
      type: Number
    - contextPath: QutteraWebsiteMalwareScanning.Status.status.scanner_result
      description: Scan result.
      type: String
    - contextPath: QutteraWebsiteMalwareScanning.Status.status.sensitivity
      description: Sensitivity.
      type: String
    - contextPath: QutteraWebsiteMalwareScanning.Status.status.state
      description: Is scanning done.
      type: String
    - contextPath: QutteraWebsiteMalwareScanning.Status.status.time
      description: Time.
      type: String
    - contextPath: QutteraWebsiteMalwareScanning.Status.status.url
      description: Scanned URL.
      type: String
    description: Retrieve status of submitted domain.
  - name: quttera-scan-report
    arguments:
    - name: domain
      required: true
      default: true
      description: The name of the domain to retrieve its report.
    outputs:
    - contextPath: QutteraWebsiteMalwareScanning.report.error
      description: Retrieving domain scan return code.
      type: Number
    - contextPath: QutteraWebsiteMalwareScanning.report.errorstr
      description: Retrieving domain scan report state.
      type: String
    - contextPath: QutteraWebsiteMalwareScanning.report.status
      description: Detailed domain scan report.
      type: Dict
    - contextPath: QutteraWebsiteMalwareScanning.report.status.blacklisted
      description: Is domain blacklisted.
      type: String
    - contextPath: QutteraWebsiteMalwareScanning.report.status.files
      description: How many files were scanned.
      type: Number
    - contextPath: QutteraWebsiteMalwareScanning.report.status.scanner_result
      description: Scanner result.
      type: String
    - contextPath: QutteraWebsiteMalwareScanning.report.status.sensitivity
      description: Domain sensitivity.
      type: String
    - contextPath: QutteraWebsiteMalwareScanning.report.status.state
      description: State of the domain.
      type: String
    - contextPath: QutteraWebsiteMalwareScanning.report.status.time
      description: Scan time.
      type: String
    - contextPath: QutteraWebsiteMalwareScanning.report.status.url
      description: Scanned URL.
      type: String
    description: Retrieve report of submitted domain.
  - name: quttera-report-malware
    arguments:
    - name: url
      required: true
      default: true
      description: URL to retrieve its blacklist and reputation.
    outputs:
    - contextPath: QutteraWebsiteMalwareScanning.report
      description: Retrieving url blacklist and reputation.
      type: Dict
    description: Retrieve url blacklist and reputation.
  - name: quttera-status-blacklist
    arguments:
    - name: domain
      required: true
      default: true
      description: The name of the domain to retrieve its blacklist and reputation.
    outputs:
    - contextPath: QutteraWebsiteMalwareScanning.report
      description: Retrieving domain blacklist and reputation.
      type: Dict
    description: Retrieve domain blacklist and reputation.
fromversion: 6.0.0
tests:
- No tests (auto formatted)
