[INGEST:vendor="juniper", product="srx", target_dataset="juniper_srx_raw", no_hit = keep]
alter tmp_event_time1 = arrayindex(regextract(_raw_log , "^(\w+\s+\d+\s+\d+\:\d+\:\d+)"),0)
    ,tmp_event_time2 = arrayindex(regextract(_raw_log , "\>\d+\s+(\d+\-\d+\-\d+T\d+\:\d+\:\d+)"),0)
| alter tmp_year = format_timestamp("%Y",_insert_time )
| alter tmp_event_time1 = parse_timestamp("%b %d %H:%M:%S %Y",concat(tmp_event_time1, " ", year)),
    event_time2 = parse_timestamp("%Y-%m-%dT%H:%M:%S",tmp_event_time2 )
| alter _time = coalesce(tmp_event_time1, tmp_event_time2)
| fields - tmp_event_time1, tmp_event_time2, tmp_year;