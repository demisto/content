id: Test_McAfeeNSMv2
version: -1
name: Test_McAfeeNSMv2
fromversion: 6.5.0
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: df542f17-7fcb-4af0-8860-e69b349ababa
    type: start
    task:
      id: df542f17-7fcb-4af0-8860-e69b349ababa
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 7a66de92-dfa3-4725-8278-64121ae1b0b4
    type: regular
    task:
      id: 7a66de92-dfa3-4725-8278-64121ae1b0b4
      version: -1
      name: Delete Context
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: fef51255-f418-41e1-8777-7aed118a8804
    type: regular
    task:
      id: fef51255-f418-41e1-8777-7aed118a8804
      version: -1
      name: Get alerts
      description: Get alerts
      script: '|||nsm-get-alerts'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "35"
    scriptarguments:
      domain_id:
        simple: "0"
      end_time:
        simple: 12/12/2022 00:00
      start_time:
        simple: 12/12/2010 00:00
      time_period:
        simple: CUSTOM
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 340d70bc-e62e-4999-8309-6053c94fcd88
    type: regular
    task:
      id: 340d70bc-e62e-4999-8309-6053c94fcd88
      version: -1
      name: Get attacks
      description: Get all available attack definitions in NSM
      script: '|||nsm-get-attacks'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      attack_id:
        simple: "0x00000100"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: ca0ab725-9f49-46c1-8011-fb0a3bd1bd6c
    type: condition
    task:
      id: ca0ab725-9f49-46c1-8011-fb0a3bd1bd6c
      version: -1
      name: Verify get attacks
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "5"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: NSM.Attacks.ID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 5e50ac7b-222e-4960-8ad4-2767cbfdd195
    type: regular
    task:
      id: 5e50ac7b-222e-4960-8ad4-2767cbfdd195
      version: -1
      name: Get domains
      description: Get all domains
      script: '|||nsm-get-domains'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 937b5e8f-6fcf-4db2-8df0-8ceaadd1555b
    type: condition
    task:
      id: 937b5e8f-6fcf-4db2-8df0-8ceaadd1555b
      version: -1
      name: Verify get domains
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "7"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: NSM.Domains.ID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: c93c23c9-b018-4511-87bb-58bd1a36e791
    type: regular
    task:
      id: c93c23c9-b018-4511-87bb-58bd1a36e791
      version: -1
      name: Get sensors
      description: get a sensor list of a given domain
      script: '|||nsm-get-sensors'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 02fef876-7755-45be-877b-65771ec9b85e
    type: condition
    task:
      id: 02fef876-7755-45be-877b-65771ec9b85e
      version: -1
      name: Verify get sensors
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "9"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: NSM.Sensors.ID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: f5322909-00f8-4598-885f-33aa815f4acd
    type: regular
    task:
      id: f5322909-00f8-4598-885f-33aa815f4acd
      version: -1
      name: Get ips policies
      description: Get IPS Policies in a domain
      script: '|||nsm-get-ips-policies'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      domain_id:
        simple: "0"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: ec83b30b-6a6a-48c0-87f2-d29a007ab0e0
    type: condition
    task:
      id: ec83b30b-6a6a-48c0-87f2-d29a007ab0e0
      version: -1
      name: Verify get ips policies
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
      - "36"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: NSM.IPSPolicies.ID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 9c93074b-f31d-4e33-81b5-12c4092db3df
    type: regular
    task:
      id: 9c93074b-f31d-4e33-81b5-12c4092db3df
      version: -1
      name: Get ips policy details
      description: Get the policy details for the specific IPS policy
      script: '|||nsm-get-ips-policy-details'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      policy_id:
        simple: ${ips_policy_id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: c3dd5c16-8491-4294-8385-4c47fab6b429
    type: condition
    task:
      id: c3dd5c16-8491-4294-8385-4c47fab6b429
      version: -1
      name: Verify get ips policy details
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "13"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: NSM.IPSPolicies.ID
            iscontext: true
          right:
            value:
              simple: ${ips_policy_id}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: f098f848-88f9-4848-83a6-3dc65e5856db
    type: regular
    task:
      id: f098f848-88f9-4848-83a6-3dc65e5856db
      version: -1
      name: Update alerts
      description: Update state or assignee of alerts
      script: '|||nsm-update-alerts'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "50"
    scriptarguments:
      end_time:
        simple: 12/12/2022 00:00
      new_state:
        simple: Unacknowledged
      start_time:
        simple: 12/12/2010 00:00
      state:
        simple: Acknowledged
      time_period:
        simple: CUSTOM
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 356eecea-e440-4085-87c7-90a274e13ee3
    type: title
    task:
      id: 356eecea-e440-4085-87c7-90a274e13ee3
      version: -1
      name: Finish
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 10170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 1d27a140-664b-4da2-8191-f19a1a04638b
    type: regular
    task:
      id: 1d27a140-664b-4da2-8191-f19a1a04638b
      version: -1
      name: List domain firewall policy
      description: Gets the list of Firewall Policies defined in a particular domain.
      script: '|||nsm-list-domain-firewall-policy'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      domain_id:
        simple: "0"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: 8eb9cfd9-52e4-44e8-8399-1b3643ac000a
    type: condition
    task:
      id: 8eb9cfd9-52e4-44e8-8399-1b3643ac000a
      version: -1
      name: Verify list domain firewall policy
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "38"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: NSM.Policy.policyId
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: bcfdfa46-8f24-4902-8130-e588f15a7cc7
    type: regular
    task:
      id: bcfdfa46-8f24-4902-8130-e588f15a7cc7
      version: -1
      name: Get firewall policy
      description: Gets the Firewall Policy details.
      script: '|||nsm-get-firewall-policy'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      policy_id:
        simple: ${firewall_policy_id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: f76a442e-f203-4139-8c6e-b5ebfc2cbc05
    type: condition
    task:
      id: f76a442e-f203-4139-8c6e-b5ebfc2cbc05
      version: -1
      name: Verify get firewall policy
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "51"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: NSM.Policy.FirewallPolicyId
            iscontext: true
          right:
            value:
              simple: ${firewall_policy_id}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4045
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: 7afb20b9-675c-4e45-8731-174516eb0131
    type: regular
    task:
      id: 7afb20b9-675c-4e45-8731-174516eb0131
      version: -1
      name: Create firewall policy
      description: Adds a new Firewall Policy and Access Rules. You have to provide
        at lease one of the source/destination object. If you provide one of the source/destination
        fields, you must provide the other one as well.
      script: '|||nsm-create-firewall-policy'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      description:
        simple: test
      direction:
        simple: Inbound
      domain:
        simple: "0"
      is_editable:
        simple: "yes"
      name:
        simple: demisto-policy
      policy_type:
        simple: Advanced
      response:
        simple: Scan
      rule_description:
        simple: test
      source_rule_object_id:
        complex:
          root: NSM.Rule
          accessor: ruleobjId
          transformers:
          - operator: FirstArrayElement
      source_rule_object_type:
        complex:
          root: NSM.Rule
          accessor: ruleobjType
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 7bd6d514-49ee-4aec-86ad-162067987c38
    type: regular
    task:
      id: 7bd6d514-49ee-4aec-86ad-162067987c38
      version: -1
      name: Update Firewall policy
      description: Updates the Firewall Policy details. If the argument is_overwrite=true
        than the new values of the provided addresses will replace the existing values
        else the addresses will be added to them. If you want to delete a rule than
        enter is_overwrite=true and the relevant rule_object_id=-1. If is_overwrite=true
        and there is no value in one of the rules (source or destination) their value
        will be as before. If is_overwrite=true than at least one of the rules (source
        or destination) must be provided.
      script: '|||nsm-update-firewall-policy'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      description:
        simple: hello updatingg
      destination_rule_object_id:
        complex:
          root: NSM.Rule
          accessor: ruleobjId
          transformers:
          - operator: FirstArrayElement
      destination_rule_object_type:
        complex:
          root: NSM.Rule
          accessor: ruleobjType
          transformers:
          - operator: FirstArrayElement
      is_overwrite:
        simple: "true"
      policy_id:
        simple: ${NSM.Policy.FirewallPolicyId}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 7f981108-3fc8-4af9-8d40-1a5142112d48
    type: regular
    task:
      id: 7f981108-3fc8-4af9-8d40-1a5142112d48
      version: -1
      name: Get updated Firewall policy
      description: Gets the Firewall Policy details.
      script: '|||nsm-get-firewall-policy'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      include_rule_objects:
        simple: "true"
      policy_id:
        simple: ${NSM.Policy.FirewallPolicyId}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5095
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: a4cecbe0-80d7-4be4-876d-51f8affb8fe6
    type: condition
    task:
      id: a4cecbe0-80d7-4be4-876d-51f8affb8fe6
      version: -1
      name: Verify updated firewall policy
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "24"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: NSM.Policy.Description
            iscontext: true
          right:
            value:
              simple: hello updatingg
      - - operator: isEqualString
          left:
            value:
              complex:
                root: NSM.Policy.MemberDetails.MemberRuleList.DestinationAddressObjectList
                accessor: RuleObjectId
                transformers:
                - operator: FirstArrayElement
            iscontext: true
          right:
            value:
              simple: ${rule_object_id}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: 8dee5772-6b77-49c3-823b-e3ad32cf14b0
    type: regular
    task:
      id: 8dee5772-6b77-49c3-823b-e3ad32cf14b0
      version: -1
      name: Delete firewall policy
      description: Deletes the specified Firewall Policy.
      script: '|||nsm-delete-firewall-policy'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "40"
    scriptarguments:
      policy_id:
        simple: ${NSM.Policy.FirewallPolicyId}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: b978b425-c44d-427e-8f76-318c28b27386
    type: condition
    task:
      id: b978b425-c44d-427e-8f76-318c28b27386
      version: -1
      name: Verify list domain rule object
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "39"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: NSM.Rule.ruleobjId
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: 47a3789c-547a-4ceb-80fd-9d622f546dfb
    type: regular
    task:
      id: 47a3789c-547a-4ceb-80fd-9d622f546dfb
      version: -1
      name: 'Create rule object '
      description: Adds a new Rule Object.
      script: '|||nsm-create-rule-object'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "28"
    scriptarguments:
      domain:
        simple: "0"
      from_address_ip_v.4:
        simple: 1.1.1.1
      name:
        simple: hello rule hello
      rule_object_type:
        simple: Range IP V.4
      to_address_ip_v.4:
        simple: 2.2.2.2
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: b7fa42cf-bb21-4906-82b9-fb01ae6b2a0a
    type: condition
    task:
      id: b7fa42cf-bb21-4906-82b9-fb01ae6b2a0a
      version: -1
      name: Verify create rule object
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "30"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: NSM.Rule.ruleobjId
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 6145
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: 77d5cc46-858f-42a1-8baf-3a80eedc13e3
    type: condition
    task:
      id: 77d5cc46-858f-42a1-8baf-3a80eedc13e3
      version: -1
      name: Verify create firewall policy
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "20"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: NSM.Policy.FirewallPolicyId
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4745
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: cbd89c6e-1ed1-434d-8ccd-f435489b60c2
    type: regular
    task:
      id: cbd89c6e-1ed1-434d-8ccd-f435489b60c2
      version: -1
      name: 'Delete rule object '
      description: Deletes a Rule Object.
      script: '|||nsm-delete-rule-object'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      rule_id:
        simple: ${NSM.Rule.ruleobjId}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 6320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: 8128469e-8462-4294-8025-5438f5cdeacc
    type: regular
    task:
      id: 8128469e-8462-4294-8025-5438f5cdeacc
      version: -1
      name: Update Rule object
      description: Updates a Rule Object.
      script: '|||nsm-update-rule-object'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      description:
        simple: updated
      domain:
        simple: "0"
      rule_id:
        simple: ${rule_object_id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 6495
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: bbe75ecd-c201-454e-88a1-aceed914cc4b
    type: regular
    task:
      id: bbe75ecd-c201-454e-88a1-aceed914cc4b
      version: -1
      name: Delete context Rule
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "33"
    scriptarguments:
      key:
        simple: NSM.Rule
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 6670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: bc2e4389-5a0e-4272-8bd2-d2546475d25a
    type: regular
    task:
      id: bc2e4389-5a0e-4272-8bd2-d2546475d25a
      version: -1
      name: Get updated rule object
      description: Gets the details of a Rule Object.
      script: '|||nsm-get-rule-object'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      rule_id:
        simple: ${rule_object_id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 6845
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: 56887898-132f-4b53-8b91-457dc8a7287f
    type: condition
    task:
      id: 56887898-132f-4b53-8b91-457dc8a7287f
      version: -1
      name: Verify update rule object
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "54"
      - "54"
      - "54"
      - "54"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: NSM.Rule.ruleobjId
            iscontext: true
          right:
            value:
              simple: ${rule_object_id}
      - - operator: isEqualString
          left:
            value:
              simple: NSM.Rule.description
            iscontext: true
          right:
            value:
              simple: updated
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 7020
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: b5b44147-a4b0-4a81-8872-f5ec01d16e6c
    type: condition
    task:
      id: b5b44147-a4b0-4a81-8872-f5ec01d16e6c
      version: -1
      name: Verify get alerts
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "3"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: NSM.Alerts.ID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: d6b595e4-49ec-4ad7-80d5-6839ee233488
    type: regular
    task:
      id: d6b595e4-49ec-4ad7-80d5-6839ee233488
      version: -1
      name: Set ips policy id
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      key:
        simple: ips_policy_id
      value:
        complex:
          root: NSM.IPSPolicies
          accessor: ID
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: 06cf3a94-a2eb-4e55-89eb-d4a64cc34bbb
    type: regular
    task:
      id: 06cf3a94-a2eb-4e55-89eb-d4a64cc34bbb
      version: -1
      name: Set firewall policy id
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      key:
        simple: firewall_policy_id
      value:
        complex:
          root: NSM.Policy
          accessor: policyId
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3695
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: 97608bf6-4162-4bbb-8864-c3e4c5196c00
    type: regular
    task:
      id: 97608bf6-4162-4bbb-8864-c3e4c5196c00
      version: -1
      name: Set rule object id
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      key:
        simple: rule_object_id
      value:
        complex:
          root: NSM.Rule
          accessor: ruleobjId
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: 21a145b5-a4c6-4a5e-8bc5-fec2bdd26169
    type: condition
    task:
      id: 21a145b5-a4c6-4a5e-8bc5-fec2bdd26169
      version: -1
      name: does rule object name exist
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "49"
      "yes":
      - "42"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: NSM.Rule.name
            iscontext: true
          right:
            value:
              simple: hello rule hello
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: 0421cee7-76c9-4a28-88e9-fa53bcfdcb6c
    type: regular
    task:
      id: 0421cee7-76c9-4a28-88e9-fa53bcfdcb6c
      version: -1
      name: Delete firewall policy
      description: Deletes the specified Firewall Policy.
      script: '|||nsm-delete-firewall-policy'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "40"
    scriptarguments:
      policy_id:
        complex:
          root: NSM.Policy
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: NSM.Policy.policyName
                iscontext: true
              right:
                value:
                  simple: demisto-policy
          accessor: policyId
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: d40ce75d-5e1b-45df-855d-c50307ed5e3b
    type: regular
    task:
      id: d40ce75d-5e1b-45df-855d-c50307ed5e3b
      version: -1
      name: Delete rule object
      description: Deletes a Rule Object.
      script: '|||nsm-delete-rule-object'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "53"
    scriptarguments:
      rule_id:
        complex:
          root: NSM.Rule
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: NSM.Rule.name
                iscontext: true
              right:
                value:
                  simple: hello rule hello
          accessor: ruleobjId
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5795
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: a400b767-b66a-4ad1-8fde-1e0388e3c2a0
    type: regular
    task:
      id: a400b767-b66a-4ad1-8fde-1e0388e3c2a0
      version: -1
      name: List domain rule object
      description: Updates the Firewall Policy details.
      script: '|||nsm-list-domain-rule-object'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "47"
    scriptarguments:
      domain_id:
        simple: "0"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6145
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: f9dddc90-3766-4461-89aa-0255b4bb2b0d
    type: regular
    task:
      id: f9dddc90-3766-4461-89aa-0255b4bb2b0d
      version: -1
      name: Set rule object id
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      key:
        simple: rule_object_id
      value:
        complex:
          root: NSM.Rule
          accessor: ruleobjId
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: a5b10f39-dd86-4205-8904-714e39598dad
    type: regular
    task:
      id: a5b10f39-dd86-4205-8904-714e39598dad
      version: -1
      name: Delete Context Policy
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      key:
        simple: NSM.Policy
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4395
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: f4049694-1849-47f9-8fdc-1d24320d26cb
    type: regular
    task:
      id: f4049694-1849-47f9-8fdc-1d24320d26cb
      version: -1
      name: Delete context Rule
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      key:
        simple: NSM.Rule
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5795
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: 383873ff-7c90-4996-8c51-1b7f0f06c8c8
    type: regular
    task:
      id: 383873ff-7c90-4996-8c51-1b7f0f06c8c8
      version: -1
      name: List domain rule object
      description: Updates the Firewall Policy details.
      script: '|||nsm-list-domain-rule-object'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "26"
    scriptarguments:
      domain_id:
        simple: "0"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: 88a0ec2d-2765-4a84-8f0f-d98506ad17b6
    type: condition
    task:
      id: 88a0ec2d-2765-4a84-8f0f-d98506ad17b6
      version: -1
      name: does firewall policy name exist
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "48"
      "yes":
      - "41"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: NSM.Policy.Name
            iscontext: true
          right:
            value:
              simple: demisto-policy
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: 7102935b-758a-4200-8eac-809441c5edbf
    type: regular
    task:
      id: 7102935b-758a-4200-8eac-809441c5edbf
      version: -1
      name: Delete context Rule
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "46"
    scriptarguments:
      key:
        simple: NSM.Rule
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "54":
    id: "54"
    taskid: 17bfd4c2-ef99-4ddc-8759-a3992a00e690
    type: regular
    task:
      id: 17bfd4c2-ef99-4ddc-8759-a3992a00e690
      version: -1
      name: List device interface
      description: List the interfaces related to a given device.
      script: '|||nsm-list-device-interface'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "55"
      - "55"
      - "55"
      - "55"
    scriptarguments:
      device_id:
        simple: "1003"
      domain_id:
        simple: "0"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 7195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "55":
    id: "55"
    taskid: 18ee2445-464e-4a72-87c3-4f4cbf0cae0d
    type: condition
    task:
      id: 18ee2445-464e-4a72-87c3-4f4cbf0cae0d
      version: -1
      name: Verify device interfaces were returned
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "56"
      - "56"
      - "56"
      - "56"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: NSM
                accessor: Interface
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 7370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "56":
    id: "56"
    taskid: 19b9ae67-4667-4dbb-8d44-0e695b06a37f
    type: regular
    task:
      id: 19b9ae67-4667-4dbb-8d44-0e695b06a37f
      version: -1
      name: List domain device
      description: List the devices related to a given domain.
      script: '|||nsm-list-domain-device'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "57"
      - "57"
      - "57"
      - "57"
    scriptarguments:
      domain_id:
        simple: "0"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 7545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "57":
    id: "57"
    taskid: ce5b34b9-1e73-4357-8586-d9f494bcb8f8
    type: condition
    task:
      id: ce5b34b9-1e73-4357-8586-d9f494bcb8f8
      version: -1
      name: Verify devices were returned
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "58"
      - "58"
      - "58"
      - "58"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: NSM
                accessor: Device
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 7720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "58":
    id: "58"
    taskid: 97d3c634-df01-41eb-87bb-e8233a33c519
    type: regular
    task:
      id: 97d3c634-df01-41eb-87bb-e8233a33c519
      version: -1
      name: List device policy
      description: List all the policies assigned to a domain or a specific device.
      script: '|||nsm-list-device-policy'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "59"
      - "59"
      - "59"
      - "59"
    scriptarguments:
      domain_id:
        simple: "0"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 7895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "59":
    id: "59"
    taskid: 3f8e0ad7-2de7-4841-810c-c872fe57be2d
    type: condition
    task:
      id: 3f8e0ad7-2de7-4841-810c-c872fe57be2d
      version: -1
      name: Verify device policies were returned
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "60"
      - "60"
      - "60"
      - "60"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: NSM
                accessor: DevicePolicy
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 8070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: d05a87f7-783d-4445-8632-1ee16287ac8c
    type: regular
    task:
      id: d05a87f7-783d-4445-8632-1ee16287ac8c
      version: -1
      name: List interface policy
      description: List all the policies assigned to all interfaces or a specific
        interface.
      script: '|||nsm-list-interface-policy'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "61"
      - "61"
      - "61"
      - "61"
    scriptarguments:
      domain_id:
        simple: "0"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 8245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    id: "61"
    taskid: 497fbb2d-64ac-452a-8ced-80aa5a83f57d
    type: condition
    task:
      id: 497fbb2d-64ac-452a-8ced-80aa5a83f57d
      version: -1
      name: Verify interface policies were returned
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "62"
      - "62"
      - "62"
      - "62"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: NSM
                accessor: InterfacePolicy
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 8420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "62":
    id: "62"
    taskid: fced9308-48a2-48de-8683-ccc7ca7a5d96
    type: regular
    task:
      id: fced9308-48a2-48de-8683-ccc7ca7a5d96
      version: -1
      name: Assign device policy
      description: Assign a policy to a specific device.
      script: '|||nsm-assign-device-policy'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
      - "63"
    scriptarguments:
      device_id:
        simple: "1003"
      domain_id:
        simple: "0"
      pre_firewall_policy_name:
        simple: Test
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 8595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: a73efd0a-6ab1-453d-872f-cdd1c5d7b770
    type: regular
    task:
      id: a73efd0a-6ab1-453d-872f-cdd1c5d7b770
      version: -1
      name: Get device configuration
      description: Provides configuration information of a given device.
      script: '|||nsm-get-device-configuration'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "64"
      - "64"
      - "64"
      - "64"
    scriptarguments:
      device_id:
        simple: "1003"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 8770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "64":
    id: "64"
    taskid: 561e5606-9a0b-4e38-8d05-84343a424c91
    type: condition
    task:
      id: 561e5606-9a0b-4e38-8d05-84343a424c91
      version: -1
      name: Was the policy assigned?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "65"
      - "65"
      - "65"
      - "65"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isTrue
          left:
            value:
              complex:
                root: NSM.DeviceConfiguration
                accessor: IsConfigurationChanged
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 8945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "65":
    id: "65"
    taskid: 0f3dc58c-a6d8-4806-89f1-3686140c56d5
    type: regular
    task:
      id: 0f3dc58c-a6d8-4806-89f1-3686140c56d5
      version: -1
      name: Deploy the pending change
      description: |-
        Deploy the pending changes.
         Note: In order to avoid extra run time, it is recommended to deploy only the changes that are pending.
        To get the pending changes, use the !nsm-get-device-configuration command.
      script: '|||nsm-deploy-device-configuration'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "66"
      - "66"
      - "66"
      - "66"
    scriptarguments:
      device_id:
        simple: "1003"
      push_configuration_signature_set:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 9120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "66":
    id: "66"
    taskid: f3fb499b-0c50-47cc-87a5-332bbb875dd8
    type: regular
    task:
      id: f3fb499b-0c50-47cc-87a5-332bbb875dd8
      version: -1
      name: Get device configuration
      description: Provides configuration information of a given device.
      script: '|||nsm-get-device-configuration'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "67"
      - "67"
      - "67"
      - "67"
    scriptarguments:
      device_id:
        simple: "1003"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 9295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "67":
    id: "67"
    taskid: cfe8bb82-234a-43be-83d6-f4abd5d691ab
    type: condition
    task:
      id: cfe8bb82-234a-43be-83d6-f4abd5d691ab
      version: -1
      name: Verify the pending changes are no longer pending
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "68"
      - "68"
      - "68"
      - "68"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isFalse
          left:
            value:
              complex:
                root: NSM.DeviceConfiguration
                accessor: IsConfigurationChanged
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 9470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "68":
    id: "68"
    taskid: ad8dd826-ba23-4496-843e-061f0809771f
    type: regular
    task:
      id: ad8dd826-ba23-4496-843e-061f0809771f
      version: -1
      name: Assign interface policy
      description: Assign a policy to a specific interface.
      script: '|||nsm-assign-interface-policy'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "69"
      - "69"
      - "69"
      - "69"
    scriptarguments:
      domain_id:
        simple: "0"
      interface_id:
        simple: "103"
      ips_policy_name:
        simple: testing
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 9645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "69":
    id: "69"
    taskid: 88f14545-d4a7-4740-8548-d577e334984e
    type: regular
    task:
      id: 88f14545-d4a7-4740-8548-d577e334984e
      version: -1
      name: Get device configuration
      description: Provides configuration information of a given device.
      script: '|||nsm-get-device-configuration'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "70"
      - "70"
      - "70"
      - "70"
    scriptarguments:
      device_id:
        simple: "1003"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 9820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "70":
    id: "70"
    taskid: 23cc2dbc-74b5-4b55-874b-e103d2d19c50
    type: condition
    task:
      id: 23cc2dbc-74b5-4b55-874b-e103d2d19c50
      version: -1
      name: Verify the policy was assigned
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "14"
      - "14"
      - "14"
      - "14"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isTrue
          left:
            value:
              complex:
                root: NSM.DeviceConfiguration
                accessor: IsConfigurationChanged
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 9995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 10185,
        "width": 810,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
description: A test playbook for McAfee NSM v2
