category: Network Security
commonfields:
  id: KnowBe4KMSAT
  version: -1
configuration:
- defaultvalue: https://us.api.knowbe4.com
  display: Your Reporting Server URL
  name: url
  required: true
  type: 0
  additionalinfo: URL of the Reporting API endpoint, only FQDN is required, e.g. https://us.api.knowbe4.com
- displaypassword: Reporting API Key
  additionalinfo: The Reporting API Key to use for connection
  name: apikey
  required: true
  hiddenusername: true
  type: 9
- defaultvalue: https://api.events.knowbe4.com
  display: Your User Events Server URL
  name: userEventsUrl
  required: true
  type: 0
  additionalinfo: URL of the User Events API endpoint, only FQDN is required, e.g. https://api.events.knowbe4.com
- displaypassword: User Events API Key
  additionalinfo: The User Events API Key to use for connection
  name: userEventsApiKey
  required: true
  hiddenusername: true
  type: 9
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: 'KnowBe4 KMSAT integration allows you to pull Risk Scores, Phishing Tests, Campaigns and Enrollments'
display: 'KnowBe4KMSAT'
name: KnowBe4KMSAT
script:
  commands:
  - arguments: []
    description: 'Returns KMSAT account information'
    execution: false
    name: get-account-info
    outputs:
    - contextPath: BaseIntegration.Output
      description: 'KMSAT Account Details'
      type: String
  - arguments: []
    description: 'Returns KMSAT Account Risk Score History.'
    execution: false
    name: get-account-risk-score-history
    outputs:
    - contextPath: BaseIntegration.Output
      description: 'List of Account risk_scores and associated date'
      type: String
  - arguments:
    - default: false
      description: Filter by Event Type
      isArray: false
      name: event_type
      required: false
      secret: false
    - default: false
      description: Filter by User
      isArray: false
      name: target_user
      required: false
      secret: false
    - default: false
      description: Filter by External ID 
      isArray: false
      name: external_id
      required: false
      secret: false
    - default: false
      description: Filter by Source
      isArray: false
      name: source
      required: false
      secret: false
    - default: false
      description: Filter by Occurred Date (YYYY-MM-DD)
      isArray: false
      name: occurred_date
      required: false
      secret: false
    - default: false
      description: Filter by Risk Level by entering a value from -10 (low risk) to 10 (high risk).
      isArray: false
      name: risk_level
      required: false
      secret: false
    - default: false
      description: Filter by Risk Decay Mode by entering a value of 0 or 1
      isArray: false
      name: risk_decay_mode
      required: false
      secret: false
    - default: false
      description: Filter by Risk Expire Date (YYYY-MM-DD)
      isArray: false
      name: risk_expire_date
      required: false
      secret: false
    - default: false
      description: Order returned events by ID, Event Type, or Occurred Date ("id", "event_type", "occurred_date")
      isArray: false
      name: order_by
      required: false
      secret: false
    - default: false
      description: Order returned events in ascending (asc) or descending (desc) order ("asc", "desc")
      isArray: false
      name: order_direction
      required: false
      secret: false
    description: 'Returns KMSAT User Events.'
    execution: false
    name: get-user-events
    outputs:
    - contextPath: BaseIntegration.Output
      description: 'List of User Events base upon filter'
      type: String
  isfetch: false
  runonce: false
  script: '-'
  type: python
  subtype: python3
  dockerimage: demisto/python3:3.10.9.42008
fromversion: 6.5.0
tests:
- No tests (auto formatted)
