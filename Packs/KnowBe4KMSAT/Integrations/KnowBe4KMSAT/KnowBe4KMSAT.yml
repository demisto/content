category: Network Security
commonfields:
  id: KnowBe4KMSAT
  version: -1
configuration:
  - defaultvalue: https://us.api.knowbe4.com
    display: Your Reporting Server URL
    name: url
    required: true
    type: 0
    additionalinfo: URL of the Reporting API endpoint, only FQDN is required, e.g. https://us.api.knowbe4.com
  - displaypassword: Reporting API Key
    additionalinfo: The Reporting API Key to use for connection
    name: apikey
    required: true
    hiddenusername: true
    type: 9
  - defaultvalue: https://api.events.knowbe4.com
    display: Your User Events Server URL
    name: userEventsUrl
    required: true
    type: 0
    additionalinfo: URL of the User Events API endpoint, only FQDN is required, e.g. https://api.events.knowbe4.com
  - displaypassword: User Events API Key
    additionalinfo: The User Events API Key to use for connection
    name: userEventsApiKey
    required: true
    hiddenusername: true
    type: 9
  - display: Trust any certificate (not secure)
    name: insecure
    required: false
    type: 8
  - display: Use system proxy settings
    name: proxy
    required: false
    type: 8
description: "KnowBe4 KMSAT integration allows you to pull Risk Scores, Phishing Tests, Campaigns and Enrollments"
display: "KnowBe4KMSAT"
name: KnowBe4KMSAT
script:
  commands:
    - name: kmsat-account-info-list
      arguments: []
      outputs:
        - contextPath: KMSAT.AccountInfo.name
          description: "Account Name"
          type: String
        - contextPath: KMSAT.AccountInfo.type
          description: "Account Type"
          type: String
        - contextPath: KMSAT.AccountInfo.domains
          description: "Account Domains"
          type: String
        - contextPath: KMSAT.AccountInfo.admins.id
          description: "Account Admin ID"
          type: Number
        - contextPath: KMSAT.AccountInfo.admins.first_name
          description: "Account Admin First Name"
          type: String
        - contextPath: KMSAT.AccountInfo.admins.last_name
          description: "Account Admin Last Name"
          type: String
        - contextPath: KMSAT.AccountInfo.admins.email
          description: "Account Admin Email"
          type: String
        - contextPath: KMSAT.AccountInfo.subscription_level
          description: "Account Subscription Level"
          type: String
        - contextPath: KMSAT.AccountInfo.subscription_end_date
          description: "Account Subscription End Date"
          type: Date
        - contextPath: KMSAT.AccountInfo.number_of_seats
          description: "Number of Seats"
          type: Number
        - contextPath: KMSAT.AccountInfo.current_risk_score
          description: "Account Risk Score"
          type: Number
      description: Returns KMSAT account information
    - name: kmsat-account-risk-score-history-list
      arguments:
        - name: page
          description: Page Number
        - name: per_page
          description: Per Page Amount
      outputs:
        - contextPath: KMSAT.AccountRiskScoreHistory.risk_score
          description: Account Risk score and associated date
          type: String
        - contextPath: KMSAT.AccountRiskScoreHistory.date
          description: Account Risk score history date
          type: String
      description: Returns KMSAT Account Risk Score History.
    - name: kmsat-groups-risk-score-history-list
      arguments:
        - name: group_id
          required: true
          description: Group ID
        - name: page
          description: Page Number
        - name: per_page
          description: Per Page Amount
      outputs:
        - contextPath: KMSAT.GroupsRiskScoreHistory.risk_score
          description: Groups Risk score and associated date
          type: String
        - contextPath: KMSAT.GroupsRiskScoreHistory.date
          description: Groups Risk score history date
          type: String
      description: Returns KMSAT Group Specific Risk Score History.
    - name: kmsat-users-risk-score-history-list
      arguments:
        - name: user_id
          required: true
          description: User ID
        - name: page
          description: Page Number
        - name: per_page
          description: Per Page Amount
      outputs:
        - contextPath: KMSAT.UsersRiskScoreHistory.risk_score
          description: Users Risk score and associated date
          type: Number
        - contextPath: KMSAT.UsersRiskScoreHistory.date
          description: Users Risk score history date
          type: Date
      description: Returns KMSAT User Specific Risk Score History
    - name: kmsat-phishing-security-tests-list
      arguments:
        - name: page
          description: Page Number
        - name: per_page
          description: Per Page Amount
      outputs:
        - contextPath: KMSAT.PhishingSecurity.campaign_id
          description: Phishing Security Campaign ID
          type: Number
        - contextPath: KMSAT.PhishingSecurity.pst_id
          description: Phishing Security PST ID
          type: Number
        - contextPath: KMSAT.PhishingSecurity.status
          description: Phishing Security Status
          type: String
        - contextPath: KMSAT.PhishingSecurity.name
          description: Phishing Security Name
          type: String
        - contextPath: KMSAT.PhishingSecurity.groups.group_id
          description: Phishing Security Group ID
          type: Number
        - contextPath: KMSAT.PhishingSecurity.groups.name
          description: Phishing Security Group Name
          type: String
        - contextPath: KMSAT.PhishingSecurity.phish_prone_percentage
          description: Phishing Security Phishing Prone Percent
          type: Number
        - contextPath: KMSAT.PhishingSecurity.started_at
          description: Phishing Security Started At Date
          type: String
        - contextPath: KMSAT.PhishingSecurity.duration
          description: Phishing Security Duration
          type: number
        - contextPath: KMSAT.PhishingSecurity.categories.category_id
          description: Phishing Security Category ID
          type: Number
        - contextPath: KMSAT.PhishingSecurity.categories.name
          description: Phishing Security Category Name
          type: String
        - contextPath: KMSAT.PhishingSecurity.template.id
          description: Phishing Security Template ID
          type: Number
        - contextPath: KMSAT.PhishingSecurity.template.name
          description: Phishing Security Template Name
          type: String
        - contextPath: KMSAT.PhishingSecurity.landing-page.id
          description: Phishing Security Landing Page ID
          type: Number
        - contextPath: KMSAT.PhishingSecurity.landing-page.name
          description: Phishing Security Landing Page Name
          type: String
        - contextPath: KMSAT.PhishingSecurity.scheduled_count
          description: Phishing Security Scheduled Count
          type: Number
        - contextPath: KMSAT.PhishingSecurity.delivered_count
          description: Phishing Security Delivered Count
          type: Number
        - contextPath: KMSAT.PhishingSecurity.opened_count
          description: Phishing Security Opened Count
          type: Number
        - contextPath: KMSAT.PhishingSecurity.clicked_count
          description: Phishing Security Clicked Count
          type: Number
        - contextPath: KMSAT.PhishingSecurity.replied_count
          description: Phishing Security Replied Count
          type: Number
        - contextPath: KMSAT.PhishingSecurity.attachment_open_count
          description: Phishing Security Attachment Open Count
          type: Number
        - contextPath: KMSAT.PhishingSecurity.macro_enabled_count
          description: Phishing Security Macro Enabled Count
          type: Number
        - contextPath: KMSAT.PhishingSecurity.data_entered_count
          description: Phishing Security Data Entered Count
          type: Number
        - contextPath: KMSAT.PhishingSecurity.qr_code_scanned_count
          description: Phishing Security QA Code Scanned Count
          type: Number
        - contextPath: KMSAT.PhishingSecurity.reported_count
          description: Phishing Security Reported Count
          type: Number
        - contextPath: KMSAT.PhishingSecurity.bounced_count
          description: Phishing Security Bounced Count
          type: Number
      description: Returns All Phishing Security Tests (PSTs)
    - name: kmsat-phishing-security-tests-recipients-list
      arguments:
        - name: pst_id
          required: true
          description: PST ID
        - name: page
          description: Page Number
        - name: per_page
          description: Per Page Amount
      outputs:
        - contextPath: KMSAT.PhishingSecurityPST.recipient_id
          description: Phishing Security Recipient ID
          type: Number
        - contextPath: KMSAT.PhishingSecurityPST.psd_id
          description: Phishing Security PST ID
          type: Number
        - contextPath: KMSAT.PhishingSecurityPST.user
          description: Phishing Security User
          type: String
        - contextPath: KMSAT.PhishingSecurityPST.template
          description: Phishing Security Template
          type: String
        - contextPath: KMSAT.PhishingSecurityPST.scheduled_at
          description: Phishing Security Scheduled At
          type: String
        - contextPath: KMSAT.PhishingSecurityPST.delivered_at
          description: Phishing Security Delivered At
          type: String
        - contextPath: KMSAT.PhishingSecurityPST.opened_at
          description: Phishing Security Opened At
          type: String
        - contextPath: KMSAT.PhishingSecurityPST.clicked_at
          description: Phishing Security Clicked At
          type: String
        - contextPath: KMSAT.PhishingSecurityPST.replied_at
          description: Phishing Security Replied At
          type: Date
        - contextPath: KMSAT.PhishingSecurityPST.attachment_opened_at
          description: Phishing Security Attachment Opened At
          type: Date
        - contextPath: KMSAT.PhishingSecurityPST.macro_enabled_at
          description: Phishing Security Macro Enabled At
        - contextPath: KMSAT.PhishingSecurityPST.data_entered_at
          description: Phishing Security Date Entered At
          type: Date
        - contextPath: KMSAT.PhishingSecurityPST.qr_code_scanned
          description: Phishing Security QR Scanned At
          type: Date
        - contextPath: KMSAT.PhishingSecurityPST.reported_at
          description: Phishing Security Reported At
        - contextPath: KMSAT.PhishingSecurityPST.bounced_at
          description: Phishing Security Bounced At
        - contextPath: KMSAT.PhishingSecurityPST.ip
          description: Phishing Security IP
          type: String
        - contextPath: KMSAT.PhishingSecurityPST.ip_location
          description: Phishing Security IP Location
          type: String
        - contextPath: KMSAT.PhishingSecurityPST.browser
          description: Phishing Security Browser
          type: String
        - contextPath: KMSAT.PhishingSecurityPST.browser_version
          description: Phishing Security Browser Security
          type: String
        - contextPath: KMSAT.PhishingSecurityPST.os
          description: Phishing Security OS
          type: String
      description: Returns a Specific Recipient's Results
    - name: kmsat-training-campaigns-list
      arguments:
        - name: page
          description: Page Number
        - name: per_page
          description: Per Page Amount
      outputs:
        - contextPath: KMSAT.TrainingCampaigns.campaign_id
          description: Training Campaigns Campaign ID
          type: Number
        - contextPath: KMSAT.TrainingCampaigns.name
          description: Training Campaigns Name
          type: String
        - contextPath: KMSAT.TrainingCampaigns.groups.group_id
          description: Training Campaigns Groups ID
          type: Number
        - contextPath: KMSAT.TrainingCampaigns.groups.name
          description: "raining Campaigns Groups Name"
          type: String
        - contextPath: KMSAT.TrainingCampaigns.status
          description: Training Campaigns Status
          type: String
        - contextPath: KMSAT.TrainingCampaigns.content.store_purchase_id
          description: Training Campaigns Store Purchase ID
          type: Number
        - contextPath: KMSAT.TrainingCampaigns.content.content_type
          description: Training Campaigns Content Type
          type: String
        - contextPath: KMSAT.TrainingCampaigns.content.name
          description: Training Campaigns Name
          type: String
        - contextPath: KMSAT.TrainingCampaigns.content.description
          description: Training Campaigns Description
          type: String
        - contextPath: KMSAT.TrainingCampaigns.content.type
          description: Training Campaigns Type
          type: String
        - contextPath: KMSAT.TrainingCampaigns.content.duration
          description: Training Campaigns Duration
          type: Number
        - contextPath: KMSAT.TrainingCampaigns.content.retired
          description: Training Campaigns Retired
          type: Boolean
        - contextPath: KMSAT.TrainingCampaigns.content.retirement_date
          description: Training Campaigns Retirement Date
          type: Unknown
        - contextPath: KMSAT.TrainingCampaigns.content.publish_date
          description: Training Campaigns Publish Date
          type: Date
        - contextPath: KMSAT.TrainingCampaigns.content.publisher
          description: Training Campaigns Publisher
          type: String
        - contextPath: KMSAT.TrainingCampaigns.content.purchase_date
          description: Training Campaigns Purchase Date
          type: Date
        - contextPath: KMSAT.TrainingCampaigns.content.policy_url
          description: Training Campaigns Policy URL
          type: String
        - contextPath: KMSAT.TrainingCampaigns.content.policy_id
          description: Training Campaigns Policy ID
          type: Number
        - contextPath: KMSAT.TrainingCampaigns.content.minimum_time
          description: Training Campaigns Minimum Time
          type: Number
        - contextPath: KMSAT.TrainingCampaigns.content.default_language
          description: Training Campaigns Default Language
          type: String
        - contextPath: KMSAT.TrainingCampaigns.content.published
          description: Training Campaigns Published
          type: Boolean
        - contextPath: KMSAT.TrainingCampaigns.duration_type
          description: Training Campaigns Duration Type
          type: String
        - contextPath: KMSAT.TrainingCampaigns.start_date
          description: Training Campaigns Start Date
          type: Date
        - contextPath: KMSAT.TrainingCampaigns.end_date
          description: Training Campaigns  End Date
          type: Date
        - contextPath: KMSAT.TrainingCampaigns.relative_duration
          description: Training Campaigns Relative Duration
          type: String
        - contextPath: KMSAT.TrainingCampaigns.auto_enroll
          description: Training Campaigns Auto Enroll
          type: Boolean
        - contextPath: KMSAT.TrainingCampaigns.allow_multiple_enrollments
          description: Training Campaigns Allow Multiple Enrollments
          type: Boolean
        - contextPath: KMSAT.TrainingCampaigns.completion_percentage
          description: Training Campaigns Completion Percentage
          type: Number
      description: Returns all Training Campaigns
    - name: kmsat-training-enrollments-list
      arguments:
        - name: page
          description: Page Number
        - name: per_page
          description: Per Page Amount
      outputs:
        - contextPath: KMSAT.TrainingEnrollments.enrollment_id
          description: Training Enrollments Enrollment ID
          type: Number
        - contextPath: KMSAT.TrainingEnrollments.content_type
          description: Training Enrollments Content Type
          type: String
        - contextPath: KMSAT.TrainingEnrollments.module_name
          description: Training Enrollments Module Name
          type: String
        - contextPath: KMSAT.TrainingEnrollments.user.id
          description: Training Enrollments User ID
          type: Number
        - contextPath: KMSAT.TrainingEnrollments.user.first_name
          description: Training Enrollments User First Name
          type: String
        - contextPath: KMSAT.TrainingEnrollments.user.last_name
          description: Training Enrollments Last Name
          type: String
        - contextPath: KMSAT.TrainingEnrollments.user.email
          description: Training Enrollments User Email
          type: String
        - contextPath: KMSAT.TrainingEnrollments.campaign_name
          description: Training Enrollments Campaign Name
          type: String
        - contextPath: KMSAT.TrainingEnrollments.enrollment_date
          description: Training Enrollments Enrollment Date
          type: Date
        - contextPath: KMSAT.TrainingEnrollments.start_date
          description: Training Enrollments Start Date
          type: Date
        - contextPath: KMSAT.TrainingEnrollments.completion_date
          description: Training Enrollments Completion Date
          type: Date
        - contextPath: KMSAT.TrainingEnrollments.status
          description: Training Enrollments Status
          type: String
        - contextPath: KMSAT.TrainingEnrollments.time_spent
          description: Training Enrollments Time Spent
          type: Number
        - contextPath: KMSAT.TrainingEnrollments.policy_acknowledged
          description: Training Enrollments Policy Acknowledged
          type: Boolean
      description: Returns all Training Enrollments
    - name: kmsat-user-events-list
      arguments:
        - name: event_type
          description: Filter by Event Type
        - name: target_user
          description: Filter by User
        - name: external_id
          description: Filter by External ID
        - name: source
          description: Filter by Source
        - name: occurred_date
          description: Filter by Occurred Date (YYYY-MM-DD)
        - name: risk_level
          description:
            Filter by Risk Level by entering a value from -10 (low risk) to
            10 (high risk).
          auto: PREDEFINED
          predefined:
            - "-10"
            - "-9"
            - "-8"
            - "-7"
            - "-6"
            - "-5"
            - "-4"
            - "-3"
            - "-2"
            - "-1"
            - "-0"
            - "1"
            - "2"
            - "3"
            - "4"
            - "5"
            - "6"
            - "7"
            - "8"
            - "9"
            - "10"
        - name: risk_decay_mode
          description: Filter by Risk Decay Mode by entering a value of 0 or 1
          auto: PREDEFINED
          predefined:
            - "0"
            - "1"
        - name: risk_expire_date
          description: Filter by Risk Expire Date (YYYY-MM-DD)
        - name: order_by
          description:
            Order returned events by ID, Event Type, or Occurred Date ("id",
            "event_type", "occurred_date")
        - name: order_direction
          description:
            Order returned events in ascending (asc) or descending (desc) order
            ("asc", "desc")
      outputs:
        - contextPath: KMSAT.UserEvents.id
          description: "Unique ID of the event"
          type: Number
        - contextPath: KMSAT.UserEvents.user.email
          description: "User email address"
          type: String
        - contextPath: KMSAT.UserEvents.user.id
          description: "User ID"
          type: Number
        - contextPath: KMSAT.UserEvents.user.archived
          description: "User Archived flag"
          type: Boolean
        - contextPath: KMSAT.UserEvents.external_id
          description: "External ID of the event"
          type: String
        - contextPath: KMSAT.UserEvents.source
          description: "Source of the event"
          type: String
        - contextPath: KMSAT.UserEvents.description
          description: "Description of the event"
          type: String
        - contextPath: KMSAT.UserEvents.occurred_date
          description: "When the event occurred"
          type: Date
        - contextPath: KMSAT.UserEvents.risk.level
          description: "Risk Level of the event"
          type: Number
        - contextPath: KMSAT.UserEvents.risk.factor
          description: "Risk Factor of the event"
          type: Number
        - contextPath: KMSAT.UserEvents.risk.decay_mode
          description: "The Risk Level Decay Mode"
          type: String
        - contextPath: KMSAT.UserEvents.risk.expire_date
          description: "Risk Expire Date"
          type: String
        - contextPath: KMSAT.UserEvents.event_type.id
          description: "Event Type ID"
          type: Number
        - contextPath: KMSAT.UserEvents.event_type.name
          description: "Event Type Name"
          type: String
      description: Returns KMSAT User Events.
    - name: kmsat-user-event-types-list
      arguments:
        - name: name
          description: Filter by name of the event type
      outputs:
        - contextPath: KMSAT.UserEventTypes.id
          description: "ID of the Event Type"
          type: Number
        - contextPath: KMSAT.UserEventTypes.account_id
          description: "Account ID"
          type: Number
        - contextPath: KMSAT.UserEventTypes.name
          description: "Name of the Event Type"
          type: String
        - contextPath: KMSAT.UserEventTypes.description
          description: "Description of Event Type"
          type: String
      description: Returns all KMSAT User Event Types
    - name: kmsat-user-event-create
      arguments:
        - name: target_user
          description: User's email address
          required: true
        - name: event_type
          description: If the event type does not already exist, the value entered here will be used to create a new event type.
          required: true
        - name: external_id
          description: Include a custom External ID.
        - name: source
          description: Include a custom Source
        - name: description
          description: Description of the Event
        - name: occurred_date
          description: (YYYY-MM-DD) If a date is not set, this field will default to the current time (UTC).
        - name: risk_level
          description: Assign a value from -10 (low risk) to 10 (high risk).
          auto: PREDEFINED
          predefined:
            - "-10"
            - "-9"
            - "-8"
            - "-7"
            - "-6"
            - "-5"
            - "-4"
            - "-3"
            - "-2"
            - "-1"
            - "-0"
            - "1"
            - "2"
            - "3"
            - "4"
            - "5"
            - "6"
            - "7"
            - "8"
            - "9"
            - "10"
        - name: risk_decay_mode
          auto: PREDEFINED
          description: Assign a value of 0 or 1.
          predefined:
            - "0"
            - "1"
        - name: risk_expire_date
          description: (YYYY-MM-DD) If a date is not set, this field will default to the occurred_date plus one (1) month.
      outputs:
        - contextPath: KMSAT.UserEventCreate.id
          description: "Unique ID of the event"
          type: Number
      description: Adds a User Event
    - name: kmsat-user-event-delete
      arguments:
        - name: id
          description: Event ID
          required: true
          default: false
          isArray: false
          secret: false
      description: Deletes User Event by Event ID
  isfetch: false
  runonce: false
  script: "-"
  type: python
  subtype: python3
  dockerimage: demisto/python3:3.10.9.44472
fromversion: 6.5.0
tests:
  - No tests (auto formatted)
