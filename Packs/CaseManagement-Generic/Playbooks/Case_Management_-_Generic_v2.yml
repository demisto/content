description: This playbook will extract and enrich indicators upon trigger, calculate Severity, and set SLAs and Timers.
id: Case Management - Generic v2
inputs:
- description: |-
    Determines whether to extract and enrich all indicators in the Incident.  This is run on all Incident fields.

    Set to "True" to enable extraction and enrichment.
  key: Enrich
  playbookInputQuery:
  required: false
  value:
    simple: 'True'
name: Case Management - Generic v2
outputs: []
starttaskid: '0'
tasks:
  '0':
    id: '0'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '24'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: a48d5514-a168-41c5-8798-809683bb68d8
      iscommand: false
      name: ''
      version: -1
      description: ''
    taskid: a48d5514-a168-41c5-8798-809683bb68d8
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 265,
          "y": 50
        }
      }
  '12':
    id: '12'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: d14fd353-5b17-4cd9-8630-973dde8c74e3
      iscommand: false
      name: 'Done '
      type: title
      version: -1
      description: ''
    taskid: d14fd353-5b17-4cd9-8630-973dde8c74e3
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1650
        }
      }
  '16':
    id: '16'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '12'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: "### Analyst Investigation\n\nPlease ensure to take the following actions:\n\n### Assign to yourself, or another Analyst\n- Click Assign to Me to assign this to yourself.\n- Select an Owner via the Owner field to assign or reassign to another Analyst.\n\n### Select Actions -> Close Incident to close this when completed. \n- Please ensure to capture the appropriate close reason, and closing notes/resolution as required.\n\n### Timers\n- Time to Assignment will stop when an Owner is assigned, and the Remediation SLA Timer will be started.\n- The Remediation SLA timers will not stop until the Incident is closed"
      id: 57d24284-885f-4c22-8bee-83d2f3b27936
      iscommand: false
      name: Manual - Analyst Investigation
      type: regular
      version: -1
    taskid: 57d24284-885f-4c22-8bee-83d2f3b27936
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1475
        }
      }
  '18':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: incident.owner
          operator: isNotEmpty
      label: yes
    id: '18'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - '22'
      yes:
      - '23'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Checks to see if there is an Owner assigned to this case.
      id: 5c6c0a82-2d81-498c-88a3-035199c898e1
      iscommand: false
      name: Is an Owner already assigned?
      type: condition
      version: -1
    taskid: 5c6c0a82-2d81-498c-88a3-035199c898e1
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1155
        }
      }
  '20':
    id: '20'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '28'
    note: false
    quietmode: 0
    separatecontext: true
    skipunavailable: false
    task:
      brand: ''
      id: f2b5f1f3-6ea5-4e73-847b-686b36646b22
      iscommand: false
      name: Calculate Severity - Standard
      playbookId: Calculate Severity - Standard
      type: playbook
      version: -1
      description: ''
    taskid: f2b5f1f3-6ea5-4e73-847b-686b36646b22
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 265,
          "y": 835
        }
      }
  '22':
    id: '22'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '16'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: 12992c48-d963-44a6-85ae-d23ce25a223a
      iscommand: false
      name: Start Time to Assignment Timer
      type: title
      version: -1
      description: ''
    taskid: 12992c48-d963-44a6-85ae-d23ce25a223a
    timertriggers:
    - action: start
      fieldname: timetoassignment
    type: title
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1330
        }
      }
  '23':
    id: '23'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '16'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: 3627deaf-6946-432c-8c2e-0add06bf2e8e
      iscommand: false
      name: Start Remediation SLA Timer
      type: title
      version: -1
      description: ''
    taskid: 3627deaf-6946-432c-8c2e-0add06bf2e8e
    timertriggers:
    - action: start
      fieldname: remediationsla
    type: title
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1330
        }
      }
  '24':
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.Enrich
          operator: isEqualString
          right:
            value:
              simple: 'True'
      label: yes
    id: '24'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - '27'
      yes:
      - '25'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Checks whether the Enrich playbook input is set to True.
      id: d8ec74d0-aa42-4e63-8fc7-4a8ef0dd756d
      iscommand: false
      name: Should indicators be extracted and enriched?
      type: condition
      version: -1
    taskid: d8ec74d0-aa42-4e63-8fc7-4a8ef0dd756d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 265,
          "y": 195
        }
      }
  '25':
    id: '25'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '26'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: 26700fc2-1de4-4b08-8125-a89a969cd1ee
      iscommand: false
      name: Enrich indicators
      type: title
      version: -1
      description: ''
    taskid: 26700fc2-1de4-4b08-8125-a89a969cd1ee
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 152.5,
          "y": 370
        }
      }
  '26':
    id: '26'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '27'
    note: false
    quietmode: 0
    reputationcalc: 2
    scriptarguments:
      text:
        complex:
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Extracts all indicators that match the regex for the indicator type, and enriches the repuration using the reputation command defined for the indicator type.
      id: 5ff4184b-c4ea-498a-8702-362b77826ae7
      iscommand: true
      name: Extract Indicators from Incident
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 5ff4184b-c4ea-498a-8702-362b77826ae7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 152.5,
          "y": 515
        }
      }
  '27':
    id: '27'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '20'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: 0ab8768c-20da-437c-87ca-ca6be6a4c160
      iscommand: false
      name: Calculate Severity
      type: title
      version: -1
      description: ''
    taskid: 0ab8768c-20da-437c-87ca-ca6be6a4c160
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 265,
          "y": 690
        }
      }
  '28':
    id: '28'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '18'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: cdf4cb29-9cd1-4b7d-81c9-74838ac541a1
      iscommand: false
      name: Start SLA Timers
      type: title
      version: -1
      description: ''
    taskid: cdf4cb29-9cd1-4b7d-81c9-74838ac541a1
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1010
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1665,
        "width": 810,
        "x": 50,
        "y": 50
      }
    }
  }
fromversion: 6.2.0
tests:
- No tests (auto formatted)
