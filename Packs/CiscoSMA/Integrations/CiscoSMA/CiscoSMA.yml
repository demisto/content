commonfields:
  id: CiscoSMA
  version: -1
name: CiscoSMA
display: CiscoSMA
category: Email
description: |-
  The Security Management Appliance (SMA) is used to centralize services from Email Security Appliances (ESAs) and Web Security Appliances (WSAs).
  This Integration utilizes the full capabilities of Cisco SMA.
configuration:
- display: Server URL
  name: base_url
  type: 0
  required: true
  additionalinfo: Base URL, e.g., https://XXX.eu.iphmx.com
- display: Username
  displaypassword: Password
  name: credentials
  type: 9
  required: true
  additionalinfo: Username and password for authentication.
- display: Maximum incidents per fetch
  name: max_fetch
  defaultvalue: "50"
  type: 0
  required: false
  additionalinfo: Default is 50. Maximum is 100.
- display: First fetch timestamp (<number> <time unit>, e.g., 12 hours, 7 days).
  name: first_fetch
  defaultvalue: 7 days
  type: 0
  required: false
  additionalinfo: |-
    Timestamp in ISO format or <number> <time unit>,
    e.g., 2022-01-01T00:00:00.000Z, 12 hours, 7 days, 3 months, now.
- display: Filter by
  name: filter_by
  type: 15
  required: false
  options:
  - from_address
  - to_address
  - subject
  additionalinfo: Message field by which to filter the results.
- display: Filter operator
  name: filter_operator
  type: 15
  required: false
  options:
  - contains
  - is
  - begins_with
  - ends_with
  - does_not_contain
  additionalinfo: Operator on the message field.
- display: Filter value
  name: filter_value
  type: 0
  required: false
  additionalinfo: The value to search for.
- display: Recipient filter operator
  name: recipient_filter_operator
  type: 15
  required: false
  options:
  - contains
  - is
  - begins_with
  - ends_with
  - does_not_contain
  additionalinfo: Recipient operator filter.
- display: Recipient filter value
  name: recipient_filter_value
  type: 0
  required: false
  additionalinfo: Recipient filter value to fetch by message field.
- display: Timeout
  name: timeout
  defaultvalue: "60"
  type: 0
  required: false
  additionalinfo: HTTP requests timeout in seconds. The default is 60 seconds.
- display: Use system proxy settings
  name: proxy
  defaultvalue: "false"
  type: 8
  required: false
- display: Trust any certificate (not secure)
  name: insecure
  defaultvalue: "false"
  type: 8
  required: false
- display: Incident type
  name: incidentType
  type: 13
  required: false
- display: Fetch incidents
  name: isFetch
  type: 8
  required: false
- display: Incidents Fetch Interval
  name: incidentFetchInterval
  defaultvalue: "1"
  type: 19
  required: false
script:
  script: ''
  type: python
  commands:
  - name: cisco-sma-spam-quarantine-message-search
    arguments:
    - name: start_date
      required: true
      description: |-
        Start date in ISO format or <number> <time unit>,
        e.g., 2022-01-01T00:00:00.000Z, 12 hours, 7 days, 3 months, now.
    - name: end_date
      required: true
      description: |-
        End date in ISO format or <number> <time unit>,
        e.g., 2022-01-01T00:00:00.000Z, 12 hours, 7 days, 3 months, now.
    - name: filter_by
      auto: PREDEFINED
      predefined:
      - from_address
      - to_address
      - subject
      description: Field by which to filter the results.
    - name: filter_operator
      auto: PREDEFINED
      predefined:
      - contains
      - is
      - begins_with
      - ends_with
      - does_not_contain
      description: Filter operator.
    - name: filter_value
      description: The value to search for. This is a user defined value, e.g., filterValue=abc.com.
    - name: recipient_filter_operator
      auto: PREDEFINED
      predefined:
      - contains
      - is
      - begins_with
      - ends_with
      - does_not_contain
      description: Recipient operator filter.
    - name: recipient_filter_value
      description: Recipient filter value.
    - name: order_by
      auto: PREDEFINED
      predefined:
      - from_address
      - date
      - subject
      - size
      description: How the results should be ordered.
    - name: order_dir
      auto: PREDEFINED
      predefined:
      - asc
      - desc
      description: Direction in which the results should be ordered.
    - name: page
      description: |-
        Page number of paginated results.
        Minimum value is 1.
    - name: page_size
      description: Number of results per page. Maximum value is 100.
    - name: limit
      description: The maximum number of records to retrieve.
      defaultValue: "50"
    - name: recipient_filter_by
      auto: PREDEFINED
      predefined:
      - contains
      - is
      - begins_with
      - ends_with
      - does_not_contain
      description: Recipient operator filter in Quarantined Messages Search
    - name: quarantines
      description: List of Quarantine Names to be in the Search Use only if you Specify
        Quarantine Type as 'pvo'
    - name: quarantine_type
      auto: PREDEFINED
      predefined:
      - spam
      - pvo
      description: Quarantine lists ('spam', 'pvo')
    - name: envelope_sender_filter_by
      auto: PREDEFINED
      predefined:
      - contains
      - starts_with
      - ends_with
      - matches_exactly
      - does_not_contain
      - does_not_start_with
      - does_not_end_with
      - does_not_match
      description: Sender operator filter in Quarantined Messages Search
    - name: envelope_sender_filter_value
      description: Sender filter value.
    - name: subject_filter_by
      auto: PREDEFINED
      predefined:
      - contains
      - starts_with
      - ends_with
      - matches_exactly
      - does_not_contain
      - does_not_start_with
      - does_not_end_with
      - does_not_match
      description: Subject operator filter in Quarantined Messages Search
    - name: subject_filter_value
      description: Subject filter value.
    - name: envelope_recipient_filter_by
      auto: PREDEFINED
      predefined:
      - contains
      - starts_with
      - ends_with
      - matches_exactly
      - does_not_contain
      - does_not_start_with
      - does_not_end_with
      - does_not_match
      description: Recipient operator filter in Quarantined Messages Search
    - name: envelope_recipient_filter_value
      description: Recipient filter value.
    outputs:
    - contextPath: CiscoSMA.SpamQuarantineMessage.esaMid
      description: Message Tracker ID.
      type: number
    - contextPath: CiscoSMA.SpamQuarantineMessage.recipient
      description: Message recipient.
      type: String
    - contextPath: CiscoSMA.SpamQuarantineMessage.subject
      description: Message subject.
      type: String
    - contextPath: CiscoSMA.SpamQuarantineMessage.date
      description: Message date.
      type: String
    - contextPath: CiscoSMA.SpamQuarantineMessage.sender
      description: Message sender.
      type: String
    - contextPath: CiscoSMA.SpamQuarantineMessage.size
      description: Message size.
      type: String
    - contextPath: CiscoSMA.SpamQuarantineMessage.mid
      description: Message ID.
      type: Number
    - contextPath: CiscoSMA.SpamQuarantineMessage.inQuarantines
      description: Quarantine Name.
      type: string
    description: Search messages in the spam quarantine.
  - name: cisco-sma-spam-quarantine-message-get
    arguments:
    - name: message_id
      required: true
      description: Message ID.
    - name: quarantine_type
      auto: PREDEFINED
      predefined:
      - spam
      - pvo
      description: Quarantine lists ('spam','pvo')
    outputs:
    - contextPath: CiscoSMA.SpamQuarantineMessage.envelopeRecipient
      description: Message recipient.
      type: String
    - contextPath: CiscoSMA.SpamQuarantineMessage.toAddress
      description: Message recipient.
      type: String
    - contextPath: CiscoSMA.SpamQuarantineMessage.messageBody
      description: Message body.
      type: String
    - contextPath: CiscoSMA.SpamQuarantineMessage.date
      description: Message date.
      type: String
    - contextPath: CiscoSMA.SpamQuarantineMessage.fromAddress
      description: Message sender.
      type: String
    - contextPath: CiscoSMA.SpamQuarantineMessage.subject
      description: Message subject.
      type: String
    - contextPath: CiscoSMA.SpamQuarantineMessage.mid
      description: Message ID.
      type: Number
    - contextPath: CiscoSMA.SpamQuarantineMessage.messagePartDetails
      description: Message Part Details
      type: string
    description: Get spam quarantine message.
  - name: cisco-sma-spam-quarantine-message-release
    arguments:
    - name: message_ids
      required: true
      description: Comma-separated list of message IDs.
      isArray: true
    - name: quarantine_type
      auto: PREDEFINED
      predefined:
      - spam
      - pvo
      description: Quarantine lists ('spam','pvo')
    - name: quarantine_name
      description: Quarantine Name to be released from - Use only if you Specify Quarantine
        Type as 'pvo'
    description: Release spam quarantined message.
  - name: cisco-sma-spam-quarantine-message-delete
    arguments:
    - name: message_ids
      required: true
      description: Comma-separated list of message IDs.
      isArray: true
    - name: quarantine_type
      auto: PREDEFINED
      predefined:
      - spam
      - pvo
      description: Quarantine lists ('spam','pvo')
    - name: quarantine_name
      description: Quarantine Name to be released from - Use only if you Specify Quarantine
        Type as 'pvo'
    description: Delete spam quarantined message.
  - name: cisco-sma-list-entry-get
    arguments:
    - name: entry_type
      required: true
      auto: PREDEFINED
      predefined:
      - blocklist
      - safelist
      description: List entry type.
    - name: page
      description: |-
        Page number of paginated results.
        Minimum value is 1.
    - name: page_size
      description: Number of results per page. Maximum value is 100.
    - name: limit
      description: The maximum number of records to retrieve.
      defaultValue: "50"
    - name: order_by
      auto: PREDEFINED
      predefined:
      - recipient
      - sender
      description: How the results should be ordered.
    - name: order_dir
      auto: PREDEFINED
      predefined:
      - asc
      - desc
      description: Direction in which the results should be ordered.
    - name: view_by
      auto: PREDEFINED
      predefined:
      - recipient
      - sender
      description: View results by.
      defaultValue: recipient
    - name: search
      description: |-
        Search for recipients or senders in blocklist/safelist with 'contains' operator.
        e.g., test@test.com, test.com
        This is only supported for the argument view_by=recipient.
    outputs:
    - contextPath: CiscoSMA.ListEntry.Blocklist.senderList
      description: Sender list.
      type: String
    - contextPath: CiscoSMA.ListEntry.Blocklist.recipientAddress
      description: Recipient address.
      type: String
    - contextPath: CiscoSMA.ListEntry.Blocklist.recipientList
      description: Recipient list.
      type: String
    - contextPath: CiscoSMA.ListEntry.Blocklist.senderAddress
      description: Sender address.
      type: String
    - contextPath: CiscoSMA.ListEntry.Safelist.senderList
      description: Sender list.
      type: String
    - contextPath: CiscoSMA.ListEntry.Safelist.recipientAddress
      description: Recipient address.
      type: String
    - contextPath: CiscoSMA.ListEntry.Safelist.recipientList
      description: Recipient list.
      type: String
    - contextPath: CiscoSMA.ListEntry.Safelist.senderAddress
      description: Sender address.
      type: String
    description: Get spam quarantine blocklist/safelist entry.
  - name: cisco-sma-list-entry-add
    arguments:
    - name: entry_type
      required: true
      auto: PREDEFINED
      predefined:
      - blocklist
      - safelist
      description: List entry type.
    - name: view_by
      auto: PREDEFINED
      predefined:
      - recipient
      - sender
      description: |-
        Add list entry by recipient/sender.
        When view_by = recipient: recipient_addresses and sender_list are mandatory.
        When view_by = sender: sender_addresses and recipient_list are mandatory.
      defaultValue: recipient
    - name: recipient_addresses
      description: A comma-separated list of recipients to add.
      isArray: true
    - name: sender_list
      description: A comma-separated list of senders to add.
      isArray: true
    - name: sender_addresses
      description: A comma-separated list of senders to add.
      isArray: true
    - name: recipient_list
      description: A comma-separated list of recipients to add.
      isArray: true
    description: Add spam quarantine blocklist/safelist entry.
  - name: cisco-sma-list-entry-append
    arguments:
    - name: entry_type
      required: true
      auto: PREDEFINED
      predefined:
      - blocklist
      - safelist
      description: List entry type.
    - name: view_by
      auto: PREDEFINED
      predefined:
      - recipient
      - sender
      description: |-
        Append list entry by recipient/sender.
        When view_by = recipient: recipient_addresses and sender_list are mandatory.
        When view_by = sender: sender_addresses and recipient_list are mandatory.
      defaultValue: recipient
    - name: recipient_list
      description: A comma-separated list of recipients to append.
      isArray: true
    - name: sender_list
      description: A comma-separated list of senders to append.
    - name: recipient_addresses
      description: A comma-separated list of recipients to append.
    - name: sender_addresses
      description: A comma-separated list of senders to append.
    description: Append spam quarantine blocklist/safelist entry.
  - name: cisco-sma-list-entry-edit
    arguments:
    - name: entry_type
      required: true
      auto: PREDEFINED
      predefined:
      - blocklist
      - safelist
      description: List entry type.
    - name: view_by
      auto: PREDEFINED
      predefined:
      - recipient
      - sender
      description: |-
        Edit list entry by recipient/sender.
        When view_by = recipient: recipient_addresses and sender_list are mandatory.
        When view_by = sender: sender_addresses and recipient_list are mandatory.
      defaultValue: recipient
    - name: recipient_list
      description: A comma-separated list of recipients to edit.
      isArray: true
    - name: sender_list
      description: A comma-separated list of senders to edit.
    - name: recipient_addresses
      description: A comma-separated list of recipients to edit.
    - name: sender_addresses
      description: A comma-separated list of senders to edit.
    description: Edit the spam quarantine blocklist/safelist entry. Using this command
      will override the existing value.
  - name: cisco-sma-list-entry-delete
    arguments:
    - name: entry_type
      required: true
      auto: PREDEFINED
      predefined:
      - blocklist
      - safelist
      description: List entry type.
    - name: view_by
      auto: PREDEFINED
      predefined:
      - recipient
      - sender
      description: |-
        Delete list entry by recipient/sender.
        When view_by = recipient: recipient_list is mandatory.
        When view_by = sender: sender_list is mandatory.
      defaultValue: recipient
    - name: recipient_list
      description: A comma-separated list of recipients to delete.
      isArray: true
    - name: sender_list
      description: A comma-separated list of senders to delete.
      isArray: true
    description: Delete a spam quarantine blocklist/safelist entry.
  - name: cisco-sma-message-search
    arguments:
    - name: start_date
      required: true
      description: |-
        Start date in ISO format or <number> <time unit>,
        e.g., 2022-01-01T00:00:00.000Z, 12 hours, 7 days, 3 months, now.
    - name: end_date
      required: true
      description: |-
        End date in ISO format or <number> <time unit>,
        e.g., 2022-01-01T00:00:00.000Z, 12 hours, 7 days, 3 months, now.
    - name: page
      description: |-
        Page number of paginated results.
        Minimum value is 1.
    - name: page_size
      description: Number of results per page. Maximum value is 100.
    - name: limit
      description: The maximum number of records to retrieve.
      defaultValue: "50"
    - name: sender_filter_operator
      auto: PREDEFINED
      predefined:
      - contains
      - is
      - begins_with
      description: Sender filter operator.
    - name: sender_filter_value
      description: Sender filter value.
    - name: recipient_filter_operator
      auto: PREDEFINED
      predefined:
      - contains
      - is
      - begins_with
      description: Recipient filter operator.
    - name: recipient_filter_value
      description: Recipient filter value.
    - name: subject_filter_operator
      auto: PREDEFINED
      predefined:
      - contains
      - is
      - begins_with
      description: Subject filter operator.
    - name: subject_filter_value
      description: Subject filter value.
    - name: attachment_name_operator
      auto: PREDEFINED
      predefined:
      - contains
      - is
      - begins_with
      description: Attachment name operator.
    - name: attachment_name_value
      description: Attachment name value.
    - name: cisco_host
      description: Cisco host.
      defaultValue: All_Hosts
    - name: file_sha_256
      description: |-
        SHA256 must be 64 characters long and can contain only "0-9" and "a-f" symbols.
        E.g., e0d123e5f316bef78bfdf5a008837577e0d123e5f316bef78bfdf5a008837577.
    - name: custom_query
      description: |-
        Custom query for cisco SMA's advanced filters.
        Syntax: <key>=<value>;<key>=<value>;<key>=<value>
        E.g.,  graymail=True;message_delivered=True.
    outputs:
    - contextPath: CiscoSMA.Message.hostName
      description: Email gateway hostname.
      type: String
    - contextPath: CiscoSMA.Message.friendly_from
      description: Friendly formatted sender email address.
      type: String
    - contextPath: CiscoSMA.Message.isCompleteData
      description: Is complete data pulled?.
      type: String
    - contextPath: CiscoSMA.Message.messageStatus
      description: Message delivery status.
      type: String
    - contextPath: CiscoSMA.Message.recipientMap
      description: Recipients list.
      type: String
    - contextPath: CiscoSMA.Message.senderIp
      description: Sender IP address.
      type: String
    - contextPath: CiscoSMA.Message.mailPolicy
      description: Matched mail policy.
      type: String
    - contextPath: CiscoSMA.Message.senderGroup
      description: Matched sender group.
      type: String
    - contextPath: CiscoSMA.Message.subject
      description: Subject of email message.
      type: String
    - contextPath: CiscoSMA.Message.dcid
      description: Delivery Connection ID.
      type: Number
    - contextPath: CiscoSMA.Message.mid
      description: Message ID.
      type: String
    - contextPath: CiscoSMA.Message.senderDomain
      description: Domain of email message sender.
      type: String
    - contextPath: CiscoSMA.Message.finalSubject
      description: Extended email subject.
      type: String
    - contextPath: CiscoSMA.Message.direction
      description: Message direction, incoming or outgoing.
      type: String
    - contextPath: CiscoSMA.Message.icid
      description: An Injection Connection ID (ICID) is a numerical identifier for
        an individual SMTP connection to the system.
      type: Number
    - contextPath: CiscoSMA.Message.replyTo
      description: Email message reply to.
      type: String
    - contextPath: CiscoSMA.Message.timestamp
      description: Time of email message.
      type: String
    - contextPath: CiscoSMA.Message.messageID
      description: Extended message ID.
      type: String
    - contextPath: CiscoSMA.Message.verdictChart
      description: Verdict visual chart ID.
      type: String
    - contextPath: CiscoSMA.Message.recipient
      description: Recipients email addresses list.
      type: String
    - contextPath: CiscoSMA.Message.sender
      description: Sender email address.
      type: String
    - contextPath: CiscoSMA.Message.serialNumber
      description: Cisco ESA email gateway serial number.
      type: String
    - contextPath: CiscoSMA.Message.allIcid
      description: ICIDs list.
      type: Number
    - contextPath: CiscoSMA.Message.sbrs
      description: Sender Base Reputation Scores.
      type: String
    description: Search tracking messages.
  - name: cisco-sma-message-details-get
    arguments:
    - name: serial_number
      required: true
      description: Email gateway serial number.
    - name: message_ids
      required: true
      description: Message ID list.
      isArray: true
    - name: injection_connection_id
      description: Injection connection ID.
    - name: delivery_connection_id
      description: Delivery connection ID.
    outputs:
    - contextPath: CiscoSMA.Message.sdrAge
      description: Sender Domain Reputation age.
      type: String
    - contextPath: CiscoSMA.Message.attachments
      description: Message attachments.
      type: String
    - contextPath: CiscoSMA.Message.hostName
      description: Email gateway hostname.
      type: String
    - contextPath: CiscoSMA.Message.direction
      description: Message direction, incoming or outgoing.
      type: String
    - contextPath: CiscoSMA.Message.isCompleteData
      description: Is complete data pulled?.
      type: Boolean
    - contextPath: CiscoSMA.Message.messageStatus
      description: Message delivery status.
      type: String
    - contextPath: CiscoSMA.Message.mailPolicy
      description: Matched mail policy.
      type: String
    - contextPath: CiscoSMA.Message.senderGroup
      description: Matched sender group.
      type: String
    - contextPath: CiscoSMA.Message.subject
      description: Email message subject.
      type: String
    - contextPath: CiscoSMA.Message.showSummaryTimeBox
      description: Whether to show the summary time box.
      type: Boolean
    - contextPath: CiscoSMA.Message.sdrCategory
      description: Sender Domain Reputation category.
      type: String
    - contextPath: CiscoSMA.Message.mid
      description: Message ID.
      type: String
    - contextPath: CiscoSMA.Message.sendingHostSummary.reverseDnsHostname
      description: Sending host reverse DNS hostname.
      type: String
    - contextPath: CiscoSMA.Message.sendingHostSummary.ipAddress
      description: Sending host IP address.
      type: String
    - contextPath: CiscoSMA.Message.sendingHostSummary.sbrsScore
      description: Sending host Sender Base Reputation scores.
      type: String
    - contextPath: CiscoSMA.Message.smtpAuthId
      description: SMTP auth ID.
      type: String
    - contextPath: CiscoSMA.Message.midHeader
      description: Message ID header.
      type: String
    - contextPath: CiscoSMA.Message.timestamp
      description: Email message time.
      type: String
    - contextPath: CiscoSMA.Message.showDLP
      description: Whether the DLP report is available.
      type: Boolean
    - contextPath: CiscoSMA.Message.messageSize
      description: Email message size.
      type: String
    - contextPath: CiscoSMA.Message.sdrThreatLevels
      description: Sender Domain Reputation threat levels.
      type: String
    - contextPath: CiscoSMA.Message.sdrReputation
      description: Sender Domain Reputation.
      type: String
    - contextPath: CiscoSMA.Message.showURL
      description: Whether the URL report is available.
      type: Boolean
    - contextPath: CiscoSMA.Message.recipient
      description: Message recipient email address.
      type: String
    - contextPath: CiscoSMA.Message.sender
      description: Message sender email address.
      type: String
    - contextPath: CiscoSMA.Message.showAMP
      description: Whether the AMP report is available.
      type: Boolean
    - contextPath: CiscoSMA.Message.summary.timestamp
      description: Event summary time.
      type: String
    - contextPath: CiscoSMA.Message.summary.description
      description: Event summary description.
      type: String
    - contextPath: CiscoSMA.Message.summary.lastEvent
      description: Whether the event summary is the last event.
      type: Boolean
    - contextPath: CiscoSMA.Message.allIcid
      description: ICIDs list.
      type: Number
    - contextPath: CiscoSMA.Message.headerFrom
      description: Email header from.
      type: String
    description: Get more details on the message.
  - name: cisco-sma-message-amp-details-get
    arguments:
    - name: serial_number
      required: true
      description: Email gateway serial number.
    - name: message_ids
      required: true
      description: Message ID list.
      isArray: true
    outputs:
    - contextPath: CiscoSMA.AMPDetail.sdrAge
      description: Sender Domain Reputation age.
      type: String
    - contextPath: CiscoSMA.AMPDetail.attachments
      description: Message attachments.
      type: String
    - contextPath: CiscoSMA.AMPDetail.hostName
      description: Email gateway hostname.
      type: String
    - contextPath: CiscoSMA.AMPDetail.direction
      description: Message direction, incoming or outgoing.
      type: String
    - contextPath: CiscoSMA.AMPDetail.messageStatus
      description: Message delivery status.
      type: String
    - contextPath: CiscoSMA.AMPDetail.senderGroup
      description: Matched sender group.
      type: String
    - contextPath: CiscoSMA.AMPDetail.subject
      description: Email message subject.
      type: String
    - contextPath: CiscoSMA.AMPDetail.sdrCategory
      description: Sender Domain Reputation category.
      type: String
    - contextPath: CiscoSMA.AMPDetail.mid
      description: Message ID.
      type: Number
    - contextPath: CiscoSMA.AMPDetail.ampDetails.timestamp
      description: AMP event summary details timestamp.
      type: String
    - contextPath: CiscoSMA.AMPDetail.ampDetails.description
      description: AMP event summary details description.
      type: String
    - contextPath: CiscoSMA.AMPDetail.ampDetails.lastEvent
      description: AMP event summary details last event.
      type: Boolean
    - contextPath: CiscoSMA.AMPDetail.smtpAuthId
      description: SMTP auth ID.
      type: String
    - contextPath: CiscoSMA.AMPDetail.midHeader
      description: Message ID header.
      type: String
    - contextPath: CiscoSMA.AMPDetail.timestamp
      description: Email message time.
      type: String
    - contextPath: CiscoSMA.AMPDetail.messageSize
      description: Email message size.
      type: String
    - contextPath: CiscoSMA.AMPDetail.sdrThreatLevels
      description: Sender Domain Reputation threat levels.
      type: String
    - contextPath: CiscoSMA.AMPDetail.sdrReputation
      description: Sender Domain Reputation.
      type: String
    - contextPath: CiscoSMA.AMPDetail.recipient
      description: Message recipient email address.
      type: String
    - contextPath: CiscoSMA.AMPDetail.sender
      description: Message sender email address.
      type: String
    - contextPath: CiscoSMA.AMPDetail.showAMPDetails
      description: Whether to show AMP details.
      type: Boolean
    - contextPath: CiscoSMA.AMPDetail.allIcid
      description: ICIDs list.
      type: Number
    - contextPath: CiscoSMA.AMPDetail.headerFrom
      description: Email header from.
      type: String
    description: Get message AMP summary details.
  - name: cisco-sma-message-dlp-details-get
    arguments:
    - name: serial_number
      required: true
      description: Email gateway serial number.
    - name: message_ids
      required: true
      description: Message ID list.
      isArray: true
    outputs:
    - contextPath: CiscoSMA.DLPDetail.direction
      description: Message direction, incoming or outgoing.
      type: String
    - contextPath: CiscoSMA.DLPDetail.smtpAuthId
      description: SMTP auth ID.
      type: String
    - contextPath: CiscoSMA.DLPDetail.sdrAge
      description: Sender Domain Reputation age.
      type: String
    - contextPath: CiscoSMA.DLPDetail.sender
      description: Message sender email address.
      type: String
    - contextPath: CiscoSMA.DLPDetail.midHeader
      description: Message ID header.
      type: String
    - contextPath: CiscoSMA.DLPDetail.timestamp
      description: Email message time.
      type: String
    - contextPath: CiscoSMA.DLPDetail.sdrCategory
      description: Sender Domain Reputation category.
      type: String
    - contextPath: CiscoSMA.DLPDetail.hostName
      description: Email gateway hostname.
      type: String
    - contextPath: CiscoSMA.DLPDetail.mid
      description: Message ID.
      type: Number
    - contextPath: CiscoSMA.DLPDetail.attachments
      description: Message attachments.
      type: String
    - contextPath: CiscoSMA.DLPDetail.messageSize
      description: Email message size.
      type: String
    - contextPath: CiscoSMA.DLPDetail.dlpDetails.violationSeverity
      description: DLP details violation severity.
      type: String
    - contextPath: CiscoSMA.DLPDetail.dlpDetails.dlpMatchedContent.messagePartMatch.classifier
      description: DLP matched content classifier.
      type: String
    - contextPath: CiscoSMA.DLPDetail.dlpDetails.dlpMatchedContent.messagePartMatch.classifierMatch
      description: DLP matched content classifier match.
      type: String
    - contextPath: CiscoSMA.DLPDetail.dlpDetails.dlpMatchedContent.messagePart
      description: DLP matched content message part.
      type: String
    - contextPath: CiscoSMA.DLPDetail.dlpDetails.mid
      description: DLP message ID.
      type: String
    - contextPath: CiscoSMA.DLPDetail.dlpDetails.riskFactor
      description: DLP risk factor.
      type: Number
    - contextPath: CiscoSMA.DLPDetail.dlpDetails.dlpPolicy
      description: DLP policy.
      type: String
    - contextPath: CiscoSMA.DLPDetail.sdrThreatLevels
      description: Sender Domain Reputation threat levels.
      type: String
    - contextPath: CiscoSMA.DLPDetail.sdrReputation
      description: Sender Domain Reputation.
      type: String
    - contextPath: CiscoSMA.DLPDetail.messageStatus
      description: Message delivery status.
      type: String
    - contextPath: CiscoSMA.DLPDetail.allIcid
      description: ICIDs list.
      type: Number
    - contextPath: CiscoSMA.DLPDetail.senderGroup
      description: Matched sender group.
      type: String
    - contextPath: CiscoSMA.DLPDetail.recipient
      description: Message recipient email address.
      type: String
    - contextPath: CiscoSMA.DLPDetail.subject
      description: Email message subject.
      type: String
    - contextPath: CiscoSMA.DLPDetail.headerFrom
      description: Email header from.
      type: String
    description: Get message DLP summary details.
  - name: cisco-sma-message-url-details-get
    arguments:
    - name: serial_number
      required: true
      description: Email gateway serial number.
    - name: message_ids
      required: true
      description: Message ID list.
      isArray: true
    outputs:
    - contextPath: CiscoSMA.URLDetail.sdrAge
      description: Sender Domain Reputation age.
      type: String
    - contextPath: CiscoSMA.URLDetail.attachments
      description: Message attachments.
      type: String
    - contextPath: CiscoSMA.URLDetail.showURLDetails
      description: Whether to show URL event details.
      type: Boolean
    - contextPath: CiscoSMA.URLDetail.urlDetails.timestamp
      description: URL event details timestamp.
      type: String
    - contextPath: CiscoSMA.URLDetail.urlDetails.description
      description: URL event details description.
      type: String
    - contextPath: CiscoSMA.URLDetail.hostName
      description: Email gateway hostname.
      type: String
    - contextPath: CiscoSMA.URLDetail.direction
      description: Message direction, incoming or outgoing.
      type: String
    - contextPath: CiscoSMA.URLDetail.messageStatus
      description: Message delivery status.
      type: String
    - contextPath: CiscoSMA.URLDetail.senderGroup
      description: Matched sender group.
      type: String
    - contextPath: CiscoSMA.URLDetail.subject
      description: Email message subject.
      type: String
    - contextPath: CiscoSMA.URLDetail.sdrCategory
      description: Sender Domain Reputation category.
      type: String
    - contextPath: CiscoSMA.URLDetail.mid
      description: Message ID.
      type: Number
    - contextPath: CiscoSMA.URLDetail.smtpAuthId
      description: SMTP auth ID.
      type: String
    - contextPath: CiscoSMA.URLDetail.midHeader
      description: Message ID header.
      type: String
    - contextPath: CiscoSMA.URLDetail.timestamp
      description: Email message time.
      type: String
    - contextPath: CiscoSMA.URLDetail.messageSize
      description: Email message size.
      type: String
    - contextPath: CiscoSMA.URLDetail.sdrThreatLevels
      description: Sender Domain Reputation threat levels.
      type: String
    - contextPath: CiscoSMA.URLDetail.sdrReputation
      description: Sender Domain Reputation.
      type: String
    - contextPath: CiscoSMA.URLDetail.recipient
      description: Message recipient Email address.
      type: String
    - contextPath: CiscoSMA.URLDetail.sender
      description: Message sender email address.
      type: String
    - contextPath: CiscoSMA.URLDetail.allIcid
      description: ICIDs list.
      type: Number
    - contextPath: CiscoSMA.URLDetail.headerFrom
      description: Email header from.
      type: String
    description: Get message URL summary details.
  - name: cisco-sma-report-get
    arguments:
    - name: report_type
      auto: PREDEFINED
      predefined:
      - mail_incoming_traffic_summary
      - reporting_system
      - mail_vof_threat_summary
      - mail_vof_specific_threat_summary
      - mail_amp_threat_summary
      description: Report Type.
      defaultValue: mail_incoming_traffic_summary
    - name: custom_report_type
      description: |-
        Custom report type.
        Specify this argument in order to get a report that does not exist in the report_type argument.
    - name: start_date
      required: true
      description: |-
        Start date in ISO format or <number> <time unit>,
        e.g., 2022-01-01T00:00:00.000Z, 12 hours, 7 days, 3 months, now.
    - name: end_date
      required: true
      description: |-
        End date in ISO format or <number> <time unit>,
        e.g., 2022-01-01T00:00:00.000Z, 12 hours, 7 days, 3 months, now.
    - name: device_group_name
      description: The device group name.
      defaultValue: Hosted_Cluster
    - name: device_name
      description: The device name.
    - name: order_by
      description: Specify the attribute by which to order the data in the response.
        For example, orderBy=total_clean_recipients.
    - name: order_dir
      auto: PREDEFINED
      predefined:
      - asc
      - desc
      description: The report order direction. Specify sort direction.
    - name: top
      description: Specify the number of records with the highest values to return.
    - name: filter_value
      description: The value to search for.
    - name: filter_by
      description: The filter field to use. Filter the data to be retrieved according
        to the filter property and value.
    - name: filter_operator
      auto: PREDEFINED
      predefined:
      - begins_with
      - is
      description: Filter the response data based on the value specified.
    outputs:
    - contextPath: CiscoSMA.Report.type
      description: Report type.
      type: String
    - contextPath: CiscoSMA.Report.resultSet
      description: Report results summary.
      type: Number
    description: |-
      Get statistics reports.
      Note that each report type is compatible with different arguments.
      Refer to the following link ("ESA Reporting" section in the file) in order to view the dedicated arguments for each report type.
      https://www.cisco.com/c/dam/en/us/td/docs/security/security_management/sma/sma12-0/AsyncOS-API-Addendum-GD_General_Deployment.xlsx.
  - name: cisco-sma-spam-quarantine-attachment-download
    arguments:
    - name: message_id
    - name: attachment_id
    description: Download Attachment from Quarantined Message in Policies, Virus and
      Outbreak
  - name: cisco-sma-spam-quarantine-message-send-copy
    arguments:
    - name: quarantine_name
    - name: message_id
    - name: recipients
    description: Sends a Copy of a quarantined message to recipients
  dockerimage: demisto/python3:3.12.8.3296088
  isfetch: true
  runonce: false
  subtype: python3
fromversion: "6.2.0"
tests:
- No tests (auto formatted)
