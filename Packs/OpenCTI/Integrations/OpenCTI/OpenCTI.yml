category: Data Enrichment & Threat Intelligence
commonfields:
  id: OpenCTI
  version: -1
configuration:
- display: Base URL
  hidden: false
  name: base_url
  required: true
  type: 0
- display: API Key
  hidden: false
  name: apikey
  required: true
  type: 4
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: Manages indicators from OpenCTI. Compatible with OpenCTI v4.* instances.
display: OpenCTI
name: OpenCTI
script:
  commands:
  - arguments:
    - default: false
      description: The maximum number of indicators to return per fetch. The default
        value is "50". Maximum value is "500".
      isArray: false
      name: limit
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: ALL
      description: 'The indicator types to fetch. Out of the box indicator types supported
        in XSOAR are: "Account", "Domain", "Email", "File", "Host", "IP", "IPv6", "Registry Key",
        and "URL". The default is "ALL".'
      isArray: true
      name: indicator_types
      predefined:
      - ALL
      - Account
      - Domain
      - Email
      - File
      - Host
      - IP
      - IPv6
      - Registry Key
      - URL
      required: false
      secret: false
    - default: false
      description: The last ID from the previous call from which to begin pagination for this call. You can find this value at OpenCTI.IndicatorsList.LastRunID context path.
      isArray: false
      name: last_run_id
      required: false
      secret: false
    deprecated: false
    description: Gets indicators from the feed.
    execution: false
    name: opencti-get-indicators
    outputs:
    - contextPath: OpenCTI.Indicators.IndicatorsList.type
      description: Indicator type.
      type: String
    - contextPath: OpenCTI.Indicators.IndicatorsList.value
      description: Indicator value.
      type: String
    - contextPath: OpenCTI.Indicators.IndicatorsList.id
      description: Indicator id.
      type: String
    - contextPath: OpenCTI.Indicators.IndicatorsList.rawJSON.createdBy
      description: The creator of indicator.
      type: Unknown
    - contextPath: OpenCTI.Indicators.IndicatorsList.rawJSON.score
      description: Indicator score.
      type: Number
    - contextPath: OpenCTI.Indicators.IndicatorsList.rawJSON.description
      description: Indicator Description.
      type: String
    - contextPath: OpenCTI.Indicators.IndicatorsList.rawJSON.objectLabel
      description: Indicator labels.
      type: Unknown
    - contextPath: OpenCTI.Indicators.IndicatorsList.rawJSON.objectMarking
      description: Indicator marking definitions.
      type: Unknown
    - contextPath: OpenCTI.Indicators.IndicatorsList.rawJSON.externalReferences
      description: Indicator external references.
      type: Unknown
    - contextPath: OpenCTI.Indicators.LastRunID
      description: the id of the last fetch to use pagination.
      type: String
  - arguments:
    - default: false
      description: Indicator ID.
      isArray: false
      name: id
      required: true
      secret: false
    deprecated: false
    description: Delete indicator.
    execution: false
    name: opencti-indicator-delete
  - arguments:
    - default: false
      description: Indicator ID.
      isArray: false
      name: id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Indicator field to update.
      isArray: false
      name: field
      predefined:
      - score
      - description
      required: true
      secret: false
    - default: false
      description: Value of the field to update.
      isArray: false
      name: value
      required: true
      secret: false
    deprecated: false
    description: Update indicator field. Available fields to update - score, description.
    execution: false
    name: opencti-indicator-field-update
    outputs:
    - contextPath: OpenCTI.Indicator.id
      description: Updated indicator id.
      type: String
  - arguments:
    - auto: PREDEFINED
      default: false
      description: 'The indicator type to create. Out of the box indicator types supported
        in XSOAR are: "Account", "Domain", "Email", "File-md5", "File-sha1",
        "File-sha256", "Host", "IP", "IPV6", "Registry Key",
        and "URL".'
      isArray: false
      name: type
      predefined:
      - Account
      - Domain
      - Email
      - File-MD5
      - File-SHA1
      - File-SHA256
      - Host
      - IP
      - IPv6
      - Registry Key
      - URL
      required: true
      secret: false
    - default: false
      description: Organization id. Use opencti-organization-list to find all organizations
        id at opencti, or use opencti-organization-create to create new organization
        id.
      isArray: false
      name: created_by
      required: false
      secret: false
    - default: false
      description: Indicator marking id. Use opencti-marking-definition-list to find all marking definitions
        id at opencti.
      isArray: false
      name: marking_id
      required: false
      secret: false
    - default: false
      description: Indicator label id. Use opencti-label-list to find all labels
        id at opencti, or use opencti-label-create to create new label.
      isArray: false
      name: label_id
      required: false
      secret: false
    - default: false
      description: External References URL. Use opencti-external-reference-create to create new external reference.
      isArray: false
      name: external_references_id
      required: false
      secret: false
    - default: false
      description: Indicator description.
      isArray: false
      name: description
      required: false
      secret: false
    - default: false
      description: Indicator score - number between 0 - 100. Default score value 50.
      isArray: false
      name: score
      required: false
      secret: false
    - default: false
      description: "Indicator value"
      isArray: false
      name: value
      required: false
      secret: false
    deprecated: false
    description: Create new indicator.
    execution: false
    name: opencti-indicator-create
    outputs:
    - contextPath: OpenCTI.Indicator.id
      description: New indicator id.
      type: String
    - contextPath: OpenCTI.Indicator.value
      description: New indicator value.
      type: String
      description: New indicator type.
      type: String
  - arguments:
    - default: false
      description: Indicator ID.
      isArray: false
      name: id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Indicator field to add.
      isArray: false
      name: field
      predefined:
      - marking
      - label
      required: true
      secret: false
    - default: false
      description: "Value of the field to add. Enter label id or marking id. Use opencti-label-list to find all labels id at opencti, or use opencti-label-create to create new label. Use opencti-marking-definition-list to find all marking definitions id at opencti"
      isArray: false
      name: value
      required: true
      secret: false
    deprecated: false
    description: Add field to indicator. Avalible fields to add - marking defenition,
      label.
    execution: false
    name: opencti-indicator-field-add
  - arguments:
    - default: false
      description: Indicator ID.
      isArray: false
      name: id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Indicator field to update.
      isArray: false
      name: field
      predefined:
      - marking
      - label
      required: true
      secret: false
    - default: false
      description: "Value of the field to remove. Enter label id or marking id. Use opencti-label-list to find all labels id at opencti or opencti-marking-definition-list to find all marking definitions id at opencti."
      isArray: false
      name: value
      required: true
      secret: false
    deprecated: false
    description: Remove field from indicator. Avalible fields to remove - marking
      defenition, label.
    execution: false
    name: opencti-indicator-field-remove
  - arguments:
    - default: false
      defaultValue: '50'
      description: The maximum number of organizations to return per fetch. The default
        value is "50". Maximum value is "200".
      isArray: false
      name: limit
      required: false
      secret: false
    - default: false
      description: The last ID from the previous call from which to begin pagination for this call. You can find this value at OpenCTI.Organizations.organizationsLastRun context path.
      isArray: false
      name: last_run_id
      required: false
      secret: false
    deprecated: false
    description: Get list of all organizations.
    execution: false
    name: opencti-organization-list
    outputs:
    - contextPath: OpenCTI.Organizations.OrganizationsList.id
      description: Organization id.
      type: String
    - contextPath: OpenCTI.Organizations.OrganizationsList.name
      description: Organization name.
      type: String
    - contextPath: OpenCTI.Organizations.organizationsLastRun
      description: the id of the last fetch to use pagination.
      type: String
  - arguments:
    - default: false
      description: Name of organization to create.
      isArray: false
      name: name
      required: true
      secret: false
    - default: false
      description: Description of the organization.
      isArray: false
      name: description
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Reliability of the organization.
      isArray: false
      name: reliability
      predefined:
      - A
      - B
      - C
      - D
      - E
      - F
      required: false
      secret: false
    deprecated: false
    description: Create organization.
    execution: false
    name: opencti-organization-create
    outputs:
    - contextPath: OpenCTI.Organization.id
      description: New organization id.
      type: String
  - arguments:
    - default: false
      defaultValue: '50'
      description: The maximum number of labels to return per fetch. The default
        value is "50".
      isArray: false
      name: limit
      required: false
      secret: false
    - default: false
      description: The last ID from the previous call from which to begin pagination for this call. You can find this value at OpenCTI.Labels.labelsLastRun context path.
      isArray: false
      name: last_run_id
      required: false
      secret: false
    deprecated: false
    description: Get list of all labels.
    execution: false
    name: opencti-label-list
    outputs:
    - contextPath: OpenCTI.Labels.LabelsList.id
      description: Label id.
      type: String
    - contextPath: OpenCTI.Labels.LabelsList.value
      description: Label name.
      type: String
    - contextPath: OpenCTI.Labels.labelsLastRun
      description: the id of the last fetch to use pagination.
      type: String
  - arguments:
    - default: false
      description: Name of label to create.
      isArray: false
      name: name
      required: true
      secret: false
    deprecated: false
    description: Create label.
    execution: false
    name: opencti-label-create
    outputs:
    - contextPath: OpenCTI.Label.id
      description: New label id.
      type: String
  - arguments:
    - default: false
      description: External References URL.
      isArray: false
      name: url
      required: true
      secret: false
    - default: false
      description: External References Source Name.
      isArray: false
      name: source_name
      required: true
      secret: false
    deprecated: false
    description: Create external reference.
    execution: false
    name: opencti-external-reference-create
    outputs:
    - contextPath: OpenCTI.externalReference.id
      description: New external reference id.
      type: String
  - arguments:
    - default: false
      defaultValue: '50'
      description: The maximum number of marking definitions to return per fetch. The default
        value is "50".
      isArray: false
      name: limit
      required: false
      secret: false
    - default: false
      description: The last ID from the previous call from which to begin pagination for this call. You can find this value at OpenCTI.MarkingDefinitions.markingsLastRun context path.
      isArray: false
      name: last_run_id
      required: false
      secret: false
    deprecated: false
    description: Get list of all marking definitions.
    execution: false
    name: opencti-marking-definition-list
    outputs:
    - contextPath: OpenCTI.MarkingDefinitions.MarkingDefinitionsList.id
      description: Label id.
      type: String
    - contextPath: OpenCTI.MarkingDefinitions.MarkingDefinitionsList.value
      description: Label name.
      type: String
    - contextPath: OpenCTI.MarkingDefinitions.markingsLastRun
      description: the id of the last fetch to use pagination.
      type: String
  dockerimage: demisto/opencti-v4:1.0.0.16772
  isfetch: false
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  subtype: python3
  type: python
tests:
- OpenCTI Test
fromversion: 5.5.0
