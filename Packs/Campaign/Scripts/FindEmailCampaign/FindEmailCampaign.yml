args:
- default: false
  defaultValue: type
  description: The name of the incident field where its type is stored. Default is
    "type". Change this arguement only in case you use a custom field for specifying
    incident type.
  isArray: false
  name: incidentTypeFieldName
  required: false
  secret: false
- default: false
  defaultValue: Phishing
  description: A comma-separatetd list of incident types by which to filter. The default
    is the current incident type. Specify "None" to ignore incident type from deduplication
    logic.
  isArray: false
  name: incidentTypes
  required: false
  secret: false
- default: false
  defaultValue: 14 days ago
  description: The start date by which to search for duplicated existing incidents.
    Date format is the same as in the incidents query page. For example, "3 days ago",
    ""2019-01-01T00:00:00 +0200").
  isArray: false
  name: existingIncidentsLookback
  required: false
  secret: false
- default: false
  description: Additional text by which to query incidents.
  isArray: false
  name: query
  required: false
  secret: false
- default: false
  defaultValue: '1000'
  description: The maximum number of incidents to fetch. The default value is 3000.
  isArray: false
  name: limit
  required: false
  secret: false
- auto: PREDEFINED
  default: false
  defaultValue: emailsubject
  description: The name of the field which contains the subject of the email.
  isArray: false
  name: emailSubject
  predefined:
  - Subject of the email.
  required: false
  secret: false
- default: false
  defaultValue: emailbody
  description: The name of the field which contains the body of the email.
  isArray: false
  name: emailBody
  predefined:
  - ''
  required: false
  secret: false
- default: false
  defaultValue: emailbodyhtml
  description: The name of the field which contains the the HTML body of the email.
  isArray: false
  name: emailBodyHTML
  required: false
  secret: false
- default: false
  defaultValue: emailfrom
  description: 'The name of the field which contains the email from value. '
  isArray: false
  name: emailFrom
  required: false
  secret: false
- auto: PREDEFINED
  default: false
  defaultValue: All
  description: Whether to compare the new incident to past closed or non closed incidents
    only. Default is "All".
  isArray: false
  name: statusScope
  predefined:
  - All
  - ClosedOnly
  - NonClosedOnly
  required: false
  secret: false
- default: false
  defaultValue: '0.8'
  description: Threshold to consider incident as similar, number between 0-1
  isArray: false
  name: threshold
  required: false
  secret: false
- default: false
  defaultValue: '30'
  description: The maximum number of incidents to display as part of the campaign.
    If a cmpaign detected with higher number of incidents, results will contain only
    this amount of incidents.
  isArray: false
  name: maxIncidentsToReturn
  required: false
  secret: false
- default: false
  defaultValue: '3'
  description: Minimum number of incidents to consider as cmpaign. Default is "3".
  isArray: false
  name: minIncidentsForCampaign
  required: false
  secret: false
- default: false
  defaultValue: '2'
  description: Minimum number of unique recipients at similar email incidents to consider
    as cmpaign. Default is "2".
  isArray: false
  name: minUniqueRecipients
  required: false
  secret: false
- default: false
  description: A comma-seperated list of fields. For example, can be "emailclassification,closereason".
    If provided and campagin is detected, these incidents fields will be displayed.
  isArray: false
  name: fieldsToDisplay
  predefined:
  - ''
  required: false
  secret: false
comment: Find a campaign of emails based on their textual similarity.
commonfields:
  id: FindEmailCampaign
  version: -1
enabled: false
name: FindEmailCampaign
outputs:
- contextPath: EmailCampaign.isCampaignFound
  description: Whether a campaign was found
  type: Boolean
- contextPath: EmailCampaign.involvedIncidentsCount
  description: The number of incidents involved in the campagin
  type: Number
- contextPath: EmailCampaign.incidents.id
  description: The IDs of the incidents involved in the campaign
  type: Unknown
- contextPath: EmailCampaign.incidents.similarity
  description: The textual similarity of the emails of the corresponding incidents
    ids with current incident.
  type: Unknown
- contextPath: EmailCampaign.incidents.emailfrom
  description: The email sender of the corresponding incidents ids
  type: Unknown
- contextPath: EmailCampaign.incidents.emailfromdomain
  description: The email sender's domain of the corresponding incidents ids
  type: Unknown
- contextPath: EmailCampaign.indicators.id
  description: The IDs of the mututal indicators of incidents invovled in the campaign
  type: Unknown
- contextPath: EmailCampaign.indicators.value
  description: The values of the mututal indicators of incidents invovled in the campaign
  type: Unknown
script: '-'
subtype: python3
system: false
tags:
- ml
- phishing
timeout: '0'
type: python
dockerimage: demisto/sklearn:1.0.0.17163
tests:
- No tests (auto formatted)
runonce: true
fromversion: 5.0.0
