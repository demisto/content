commonfields:
  id: Microsoft Endpoint Configuration Manager
  version: -1
name: Microsoft Endpoint Configuration Manager
display: Microsoft Endpoint Configuration Manager
category: IT Services
description: The configuration manager provides the overall Configuration Management
  (CM) infrastructure and environment to the product development team (formerly known
  as SCCM).
configuration:
- display: ECM Server URL (e.g., 192.168.64.128)
  name: ComputerName
  type: 0
  required: true
- display: Username (i.e., DOMAIN\username)
  name: credentials
  type: 9
  required: true
- display: ECM Site Code
  name: SiteCode
  type: 0
  required: true
  additionalinfo: To get the site code in the Configuration manager UI, go to Administration
    -> Site configuration -> Sites and look at the `Site Code` tab
script:
  script: ''
  type: powershell
  commands:
  - name: ms-ecm-user-last-log-on
    arguments:
    - name: device_name
      required: true
      description: Specifies the name of a device.
    outputs:
    - contextPath: MicrosoftECM.LastLogOnUser.IPAddresses
      description: The IPAddresses of the device
      type: string
    - contextPath: MicrosoftECM.LastLogOnUser.LastLogonTimestamp
      description: The date of the last login to the device
      type: date
    - contextPath: MicrosoftECM.LastLogOnUser.LastLogonUserName
      description: The name of the last user who logged in  to the device
      type: string
    - contextPath: MicrosoftECM.LastLogOnUser.DeviceName
      description: The name of the device
      type: string
    description: Gets the last user that logged on to a given device name
  - name: ms-ecm-collection-list
    arguments:
    - name: collection_type
      required: true
      auto: PREDEFINED
      predefined:
      - User
      - Device
      description: 'Specifies a type for the collection. Valid values are: User Device'
    - name: collection_id
      description: Specifies a collection ID. If you do not specify a collection,
        all collections in the hierarchy are returned (can be retrived via `!ms-ecm-collection-list
        collection_type="Device"`)
    - name: collection_name
      description: Specifies a collection name. If you do not specify a collection,
        all collections in the hierarchy are returned (can be retrived via `!ms-ecm-collection-list
        collection_type="Device"`)
    outputs:
    - contextPath: MicrosoftECM.Collections.Name
      description: The collection name
      type: string
    - contextPath: MicrosoftECM.Collections.ID
      description: Unique auto-generated ID containing eight characters.
      type: string
    - contextPath: MicrosoftECM.Collections.Type
      description: The type of the collection
      type: string
    - contextPath: MicrosoftECM.Collections.Comment
      description: General comment or note that documents the collection
      type: string
    - contextPath: MicrosoftECM.Collections.CurrentStatus
      description: Current status of the collection
      type: string
    - contextPath: MicrosoftECM.Collections.HasProvisionedMember
      description: true if this collection has provisioned members.
      type: boolean
    - contextPath: MicrosoftECM.Collections.IncludeExcludeCollectionsCount
      description: Count of collections that are included and excluded with this one.
      type: number
    - contextPath: MicrosoftECM.Collections.IsBuiltIn
      description: This value, when set to true, denotes that the collection is built
        in.
      type: boolean
    - contextPath: MicrosoftECM.Collections.IsReferenceCollection
      description: This value, when set to true, denotes that the collection is not
        limited by another collection.
      type: boolean
    - contextPath: MicrosoftECM.Collections.LastChangeTime
      description: Date and time of when the collection was last altered in any way.
      type: date
    - contextPath: MicrosoftECM.Collections.LastMemberChangeTime
      description: Date and time of when the collection membership was last altered.
      type: date
    - contextPath: MicrosoftECM.Collections.LastRefreshTime
      description: Date and time of when the collection membership was last refreshed.
      type: date
    - contextPath: MicrosoftECM.Collections.LimitToCollectionID
      description: The CollectionID of the collection to limit the query results to.
      type: string
    - contextPath: MicrosoftECM.Collections.LimitToCollectionName
      description: The Name of the collection to limit the query results to.
      type: string
    - contextPath: MicrosoftECM.Collections.LocalMemberCount
      description: Count of members visible at the local site.
      type: number
    - contextPath: MicrosoftECM.Collections.MemberClassName
      description: Class name having instances that are the members of the collection
      type: string
    - contextPath: MicrosoftECM.Collections.MemberCount
      description: A count of the collection members.
      type: number
    - contextPath: MicrosoftECM.Collections.UseCluster
      description: Specifies that this collection is a server group.
      type: boolean
    - contextPath: MicrosoftECM.Collections.CollectionRules
      description: Name of the defining membership criteria for the collection
      type: string
    description: Gets a Configuration Manager collection
  - name: ms-ecm-device-list
    arguments:
    - name: collection_id
      description: Specifies an ID for a device collection (can be retrived via `!ms-ecm-collection-list
        collection_type="Device"`)
    - name: collection_name
      description: Specifies the name of a device collection (can be retrived via
        `!ms-ecm-collection-list collection_type="Device"`)
    - name: limit
      description: Specifies the maximum number of devices to be returned, default
        value is 100.
    outputs:
    - contextPath: MicrosoftECM.DevicesList.Name
      description: The name of the device
      type: string
    - contextPath: MicrosoftECM.DevicesList.ResourceID
      description: Unique Configuration Manager-supplied ID for the resource.
      type: number
    description: Lists a Configuration Manager device
  - name: ms-ecm-script-list
    arguments:
    - name: author
      description: Specifies the author of the script (can be retrived via `!ms-ecm-script-list`)
    - name: script_name
      description: Specifies a script name (can be retrived via `!ms-ecm-script-list`)
    outputs:
    - contextPath: MicrosoftECM.Scripts.ApprovalState
      description: The approval state of the script
      type: string
    - contextPath: MicrosoftECM.Scripts.Approver
      description: The approver of the script
      type: string
    - contextPath: MicrosoftECM.Scripts.Author
      description: The author of the script
      type: string
    - contextPath: MicrosoftECM.Scripts.Comment
      description: A short comment about the script
      type: string
    - contextPath: MicrosoftECM.Scripts.LastUpdateTime
      description: The date of the last script upda
      type: date
    - contextPath: MicrosoftECM.Scripts.Parameterlist
      description: The parameter list of the script
      type: string
    - contextPath: MicrosoftECM.Scripts.Script
      description: The code of the script
      type: string
    - contextPath: MicrosoftECM.Scripts.ScriptGuid
      description: The unique identifier of the script
      type: string
    - contextPath: MicrosoftECM.Scripts.ScriptHash
      description: The hash of the script
      type: string
    - contextPath: MicrosoftECM.Scripts.ScriptHashAlgorithm
      description: The algorithm with which the script hash was generated
      type: string
    - contextPath: MicrosoftECM.Scripts.ScriptName
      description: The name of the script
      type: string
    - contextPath: MicrosoftECM.Scripts.ScriptType
      description: The type of the script
      type: string
    - contextPath: MicrosoftECM.Scripts.ScriptVersion
      description: The version of the script
      type: number
    description: Gets Configuration Manager PowerShell scripts
  - name: ms-ecm-script-create
    arguments:
    - name: script_file_entry_id
      description: The Entry ID of the script file
    - name: script_text
      description: The text of the string
    - name: script_name
      required: true
      description: The name of the script
    outputs:
    - contextPath: MicrosoftECM.Scripts.ApprovalState
      description: The approval state of the script
      type: string
    - contextPath: MicrosoftECM.Scripts.Approver
      description: The approver of the script
      type: string
    - contextPath: MicrosoftECM.Scripts.Author
      description: The author of the script
      type: string
    - contextPath: MicrosoftECM.Scripts.Comment
      description: A short comment about the script
      type: string
    - contextPath: MicrosoftECM.Scripts.LastUpdateTime
      description: The date of the last script upda
      type: date
    - contextPath: MicrosoftECM.Scripts.Parameterlist
      description: The parameter list of the script
      type: string
    - contextPath: MicrosoftECM.Scripts.Script
      description: The code of the script
      type: string
    - contextPath: MicrosoftECM.Scripts.ScriptGuid
      description: The unique identifier of the script
      type: string
    - contextPath: MicrosoftECM.Scripts.ScriptHash
      description: The hash of the script
      type: string
    - contextPath: MicrosoftECM.Scripts.ScriptHashAlgorithm
      description: The algorithm with which the script hash was generated
      type: string
    - contextPath: MicrosoftECM.Scripts.ScriptName
      description: The name of the script
      type: string
    - contextPath: MicrosoftECM.Scripts.ScriptType
      description: The type of the script
      type: string
    - contextPath: MicrosoftECM.Scripts.ScriptVersion
      description: The version of the script
      type: number
    description: create new powershell script
  - name: ms-ecm-script-invoke
    arguments:
    - name: script_guid
      required: true
      description: Specifies the script ID (can be retrived via `!ms-ecm-script-list`)
    - name: collection_id
      description: Specifies the collection ID (can be retrived via `!ms-ecm-collection-list
        collection_type="Device"`)
    - name: collection_name
      description: Specifies the collection name (can be retrived via `!ms-ecm-collection-list
        collection_type="Device"`)
    - name: device_name
      description: Specifies a device name in Configuration Manager
    - name: poll_results
      description: Whether to poll for the script invocation results or not
      auto: PREDEFINED
      predefined:
      - 'true'
      - 'false'
    - name: timeout
      required: false
      description: The timeout in seconds to poll for invocation results. Default
        is 30 seconds.
    outputs:
    - contextPath: MicrosoftECM.ScriptsInvocationResults.OperationId
      description: The script invocation operation ID
      type: number
    - contextPath: MicrosoftECM.ScriptsInvocationResults.CollectionId
      description: The collection ID of the device on which the script was invoked
        on
      type: string
    - contextPath: MicrosoftECM.ScriptsInvocationResults.CollectionName
      description: The collection Name of the device on which the script was invoked
        on
      type: string
    - contextPath: MicrosoftECM.ScriptsInvocationResults.DeviceName
      description: The name of the device on which the script was invoked on
      type: string
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ResourceId
      description: The resource ID of the device on which the script was invoked on
      type: number
    - contextPath: MicrosoftECM.ScriptsInvocationResults.LastUpdateTime
      description: The last time the Invocation result object was updated
      type: date
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ScriptExecutionState
      description: The state of the script invocation
      type: string
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ScriptExitCode
      description: The exit code of the script invocation
      type: number
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ScriptGuid
      description: 'The unique identifier of the script '
      type: string
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ScriptLastModifiedDate
      description: The date of the script's last modification
      type: date
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ScriptName
      description: The name of the script
      type: string
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ScriptOutput
      description: The output of the script invocation
      type: string
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ScriptOutputHash
      description: The hash of the output of the script invocation
      type: string
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ScriptVersion
      description: The version of the script when it was invoked
      type: number
    - contextPath: MicrosoftECM.ScriptsInvocationResults.TaskID
      description: The unique identifier of the invocation
      type: string
    description: Invokes a script in Configuration Manager
  - name: ms-ecm-script-approve
    arguments:
    - name: comment
      required: true
      description: Specifies a comment about the approval of the script
    - name: script_guid
      required: true
      description: Specifies the script ID (can be retrived via `!ms-ecm-script-list`)
    description: Approves a Configuration Manager PowerShell script
  - name: ms-ecm-device-collection-create
    arguments:
    - name: comment
      required: true
      description: Specifies a comment for the collection
    - name: collection_name
      required: true
      description: Specifies a name for the collection
    - name: limiting_collection_name
      required: true
      description: Specifies the name of a collection to use as a scope for this collection
        (can be retrived via `!ms-ecm-collection-list collection_type="Device"`)
    outputs:
    - contextPath: MicrosoftECM.Collections.Name
      description: The collection name
      type: string
    - contextPath: MicrosoftECM.Collections.ID
      description: Unique auto-generated ID containing eight characters.
      type: string
    - contextPath: MicrosoftECM.Collections.Type
      description: The type of the collection
      type: string
    - contextPath: MicrosoftECM.Collections.Comment
      description: General comment or note that documents the collection
      type: string
    - contextPath: MicrosoftECM.Collections.CurrentStatus
      description: Current status of the collection
      type: string
    - contextPath: MicrosoftECM.Collections.HasProvisionedMember
      description: true if this collection has provisioned members.
      type: boolean
    - contextPath: MicrosoftECM.Collections.IncludeExcludeCollectionsCount
      description: Count of collections that are included and excluded with this one.
      type: number
    - contextPath: MicrosoftECM.Collections.IsBuiltIn
      description: This value, when set to true, denotes that the collection is built
        in.
      type: boolean
    - contextPath: MicrosoftECM.Collections.IsReferenceCollection
      description: This value, when set to true, denotes that the collection is not
        limited by another collection.
      type: boolean
    - contextPath: MicrosoftECM.Collections.LastChangeTime
      description: Date and time of when the collection was last altered in any way.
      type: date
    - contextPath: MicrosoftECM.Collections.LastMemberChangeTime
      description: Date and time of when the collection membership was last altered.
      type: date
    - contextPath: MicrosoftECM.Collections.LastRefreshTime
      description: Date and time of when the collection membership was last refreshed.
      type: date
    - contextPath: MicrosoftECM.Collections.LimitToCollectionID
      description: The CollectionID of the collection to limit the query results to.
      type: string
    - contextPath: MicrosoftECM.Collections.LimitToCollectionName
      description: The Name of the collection to limit the query results to.
      type: string
    - contextPath: MicrosoftECM.Collections.LocalMemberCount
      description: Count of members visible at the local site.
      type: number
    - contextPath: MicrosoftECM.Collections.MemberClassName
      description: Class name having instances that are the members of the collection
      type: string
    - contextPath: MicrosoftECM.Collections.MemberCount
      description: A count of the collection members.
      type: number
    - contextPath: MicrosoftECM.Collections.UseCluster
      description: Specifies that this collection is a server group.
      type: boolean
    - contextPath: MicrosoftECM.Collections.CollectionRules
      description: Name of the defining membership criteria for the collection
      type: string
    description: Creates a Configuration Manager collection
  - name: ms-ecm-device-collection-members-add
    description: Adds a Direct Rule membership to a device collection
    arguments:
    - name: collection_id
      description: Specifies the ID of a device collection (can be retrived via `!ms-ecm-collection-list
        collection_type="Device"`)
    - name: collection_name
      description: Specifies the name of a device collection (can be retrived via
        `!ms-ecm-collection-list collection_type="Device"`)
    - name: device_resource_ids
      required: true
      description: A comma seperated list of devices resource IDs (can be retrived
        via `!ms-ecm-device-list`)
    outputs:
    - contextPath: MicrosoftECM.Collections.Name
      description: The collection name
      type: string
    - contextPath: MicrosoftECM.Collections.ID
      description: Unique auto-generated ID containing eight characters.
      type: string
    - contextPath: MicrosoftECM.Collections.Type
      description: The type of the collection
      type: string
    - contextPath: MicrosoftECM.Collections.Comment
      description: General comment or note that documents the collection
      type: string
    - contextPath: MicrosoftECM.Collections.CurrentStatus
      description: Current status of the collection
      type: string
    - contextPath: MicrosoftECM.Collections.HasProvisionedMember
      description: true if this collection has provisioned members.
      type: boolean
    - contextPath: MicrosoftECM.Collections.IncludeExcludeCollectionsCount
      description: Count of collections that are included and excluded with this one.
      type: number
    - contextPath: MicrosoftECM.Collections.IsBuiltIn
      description: This value, when set to true, denotes that the collection is built
        in.
      type: boolean
    - contextPath: MicrosoftECM.Collections.IsReferenceCollection
      description: This value, when set to true, denotes that the collection is not
        limited by another collection.
      type: boolean
    - contextPath: MicrosoftECM.Collections.LastChangeTime
      description: Date and time of when the collection was last altered in any way.
      type: date
    - contextPath: MicrosoftECM.Collections.LastMemberChangeTime
      description: Date and time of when the collection membership was last altered.
      type: date
    - contextPath: MicrosoftECM.Collections.LastRefreshTime
      description: Date and time of when the collection membership was last refreshed.
      type: date
    - contextPath: MicrosoftECM.Collections.LimitToCollectionID
      description: The CollectionID of the collection to limit the query results to.
      type: string
    - contextPath: MicrosoftECM.Collections.LimitToCollectionName
      description: The Name of the collection to limit the query results to.
      type: string
    - contextPath: MicrosoftECM.Collections.LocalMemberCount
      description: Count of members visible at the local site.
      type: number
    - contextPath: MicrosoftECM.Collections.MemberClassName
      description: Class name having instances that are the members of the collection
      type: string
    - contextPath: MicrosoftECM.Collections.MemberCount
      description: A count of the collection members.
      type: number
    - contextPath: MicrosoftECM.Collections.UseCluster
      description: A comma separated list of resource IDs  e.g 0001,0002
      type: boolean
    - contextPath: MicrosoftECM.Collections.CollectionRules
      description: Name of the defining membership criteria for the collection
      type: string
  - name: ms-ecm-device-collection-include
    arguments:
    - name: collection_id
      description: Specifies the ID of a device collection (can be retrived via `!ms-ecm-collection-list
        collection_type="Device"`)
    - name: collection_name
      description: Specifies the name of a device collection (can be retrived via
        `!ms-ecm-collection-list collection_type="Device"`)
    - name: include_collection_id
      description: Specifies the ID of a device collection to include in the membership
        rule (can be retrived via `!ms-ecm-collection-list collection_type="Device"`)
    - name: include_collection_name
      description: Specifies the name of a device collection to include in the membership
        rule (can be retrived via `!ms-ecm-collection-list collection_type="Device"`)
    outputs:
    - contextPath: MicrosoftECM.Collections.Name
      description: The collection name
      type: string
    - contextPath: MicrosoftECM.Collections.ID
      description: Unique auto-generated ID containing eight characters.
      type: string
    - contextPath: MicrosoftECM.Collections.Type
      description: The type of the collection
      type: string
    - contextPath: MicrosoftECM.Collections.Comment
      description: General comment or note that documents the collection
      type: string
    - contextPath: MicrosoftECM.Collections.CurrentStatus
      description: Current status of the collection
      type: string
    - contextPath: MicrosoftECM.Collections.HasProvisionedMember
      description: true if this collection has provisioned members.
      type: boolean
    - contextPath: MicrosoftECM.Collections.IncludeExcludeCollectionsCount
      description: Count of collections that are included and excluded with this one.
      type: number
    - contextPath: MicrosoftECM.Collections.IsBuiltIn
      description: This value, when set to true, denotes that the collection is built
        in.
      type: boolean
    - contextPath: MicrosoftECM.Collections.IsReferenceCollection
      description: This value, when set to true, denotes that the collection is not
        limited by another collection.
      type: boolean
    - contextPath: MicrosoftECM.Collections.LastChangeTime
      description: Date and time of when the collection was last altered in any way.
      type: date
    - contextPath: MicrosoftECM.Collections.LastMemberChangeTime
      description: Date and time of when the collection membership was last altered.
      type: date
    - contextPath: MicrosoftECM.Collections.LastRefreshTime
      description: Date and time of when the collection membership was last refreshed.
      type: date
    - contextPath: MicrosoftECM.Collections.LimitToCollectionID
      description: The CollectionID of the collection to limit the query results to.
      type: string
    - contextPath: MicrosoftECM.Collections.LimitToCollectionName
      description: The Name of the collection to limit the query results to.
      type: string
    - contextPath: MicrosoftECM.Collections.LocalMemberCount
      description: Count of members visible at the local site.
      type: number
    - contextPath: MicrosoftECM.Collections.MemberClassName
      description: Class name having instances that are the members of the collection
      type: string
    - contextPath: MicrosoftECM.Collections.MemberCount
      description: A count of the collection members.
      type: number
    - contextPath: MicrosoftECM.Collections.UseCluster
      description: A comma separated list of resource IDs  e.g 0001,0002
      type: boolean
    - contextPath: MicrosoftECM.Collections.CollectionRules
      description: Name of the defining membership criteria for the collection
      type: string
    description: Adds an Include Collections membership rule to a device collection
  - name: ms-ecm-device-collection-exclude
    arguments:
    - name: collection_id
      description: Specifies the ID of a device collection (can be retrived via `!ms-ecm-collection-list
        collection_type="Device"`)
    - name: collection_name
      description: Specifies the name of a device collection (can be retrived via
        `!ms-ecm-collection-list collection_type="Device"`)
    - name: exclude_collection_id
      description: Specifies the ID of a device collection to exclude from the membership
        rule (can be retrived via `!ms-ecm-collection-list collection_type="Device"`)
    - name: exclude_collection_name
      description: Specifies the name of a device collection to exclude from the membership
        rule (can be retrived via `!ms-ecm-collection-list collection_type="Device"`)
    outputs:
    - contextPath: MicrosoftECM.Collections.Name
      description: The collection name
      type: string
    - contextPath: MicrosoftECM.Collections.ID
      description: Unique auto-generated ID containing eight characters.
      type: string
    - contextPath: MicrosoftECM.Collections.Type
      description: The type of the collection
      type: string
    - contextPath: MicrosoftECM.Collections.Comment
      description: General comment or note that documents the collection
      type: string
    - contextPath: MicrosoftECM.Collections.CurrentStatus
      description: Current status of the collection
      type: string
    - contextPath: MicrosoftECM.Collections.HasProvisionedMember
      description: true if this collection has provisioned members.
      type: boolean
    - contextPath: MicrosoftECM.Collections.IncludeExcludeCollectionsCount
      description: Count of collections that are included and excluded with this one.
      type: number
    - contextPath: MicrosoftECM.Collections.IsBuiltIn
      description: This value, when set to true, denotes that the collection is built
        in.
      type: boolean
    - contextPath: MicrosoftECM.Collections.IsReferenceCollection
      description: This value, when set to true, denotes that the collection is not
        limited by another collection.
      type: boolean
    - contextPath: MicrosoftECM.Collections.LastChangeTime
      description: Date and time of when the collection was last altered in any way.
      type: date
    - contextPath: MicrosoftECM.Collections.LastMemberChangeTime
      description: Date and time of when the collection membership was last altered.
      type: date
    - contextPath: MicrosoftECM.Collections.LastRefreshTime
      description: Date and time of when the collection membership was last refreshed.
      type: date
    - contextPath: MicrosoftECM.Collections.LimitToCollectionID
      description: The CollectionID of the collection to limit the query results to.
      type: string
    - contextPath: MicrosoftECM.Collections.LimitToCollectionName
      description: The Name of the collection to limit the query results to.
      type: string
    - contextPath: MicrosoftECM.Collections.LocalMemberCount
      description: Count of members visible at the local site.
      type: number
    - contextPath: MicrosoftECM.Collections.MemberClassName
      description: Class name having instances that are the members of the collection
      type: string
    - contextPath: MicrosoftECM.Collections.MemberCount
      description: A count of the collection members.
      type: number
    - contextPath: MicrosoftECM.Collections.UseCluster
      description: A comma separated list of resource IDs  e.g 0001,0002
      type: boolean
    - contextPath: MicrosoftECM.Collections.CollectionRules
      description: Name of the defining membership criteria for the collection
      type: string
    description: Adds an exclude membership rule to one or more Configuration Manager
      device collections.
  - name: ms-ecm-device-collection-members-by-query-add
    arguments:
    - name: collection_id
      description: Specifies the ID of the device collection where the rule is applied
        (can be retrived via `!ms-ecm-collection-list collection_type="Device"`)
    - name: collection_name
      description: Specifies the name of the device collection where the rule is applied
        (can be retrived via `!ms-ecm-collection-list collection_type="Device"`)
    - name: query_expression
      required: true
      description: Specifies the query expression that Configuration Manager uses.
        For example "select SMS_R_SYSTEM.ResourceID,SMS_R_SYSTEM.ResourceType,SMS_R_SYSTEM.Name,SMS_R_SYSTEM.SMSUniqueIdentifier,SMS_R_SYSTEM.ResourceDomainORWorkgroup,SMS_R_SYSTEM.Client
        from SMS_R_System where (ClientType = 1) OR (SMS_R_System.AgentEdition0 =
        5)" to update the device collections
    - name: rule_name
      required: true
      description: Specifies the name for the rule
    outputs:
    - contextPath: MicrosoftECM.Collections.Name
      description: The collection name
      type: string
    - contextPath: MicrosoftECM.Collections.ID
      description: Unique auto-generated ID containing eight characters.
      type: string
    - contextPath: MicrosoftECM.Collections.Type
      description: The type of the collection
      type: string
    - contextPath: MicrosoftECM.Collections.Comment
      description: General comment or note that documents the collection
      type: string
    - contextPath: MicrosoftECM.Collections.CurrentStatus
      description: Current status of the collection
      type: string
    - contextPath: MicrosoftECM.Collections.HasProvisionedMember
      description: true if this collection has provisioned members.
      type: boolean
    - contextPath: MicrosoftECM.Collections.IncludeExcludeCollectionsCount
      description: Count of collections that are included and excluded with this one.
      type: number
    - contextPath: MicrosoftECM.Collections.IsBuiltIn
      description: This value, when set to true, denotes that the collection is built
        in.
      type: boolean
    - contextPath: MicrosoftECM.Collections.IsReferenceCollection
      description: This value, when set to true, denotes that the collection is not
        limited by another collection.
      type: boolean
    - contextPath: MicrosoftECM.Collections.LastChangeTime
      description: Date and time of when the collection was last altered in any way.
      type: date
    - contextPath: MicrosoftECM.Collections.LastMemberChangeTime
      description: Date and time of when the collection membership was last altered.
      type: date
    - contextPath: MicrosoftECM.Collections.LastRefreshTime
      description: Date and time of when the collection membership was last refreshed.
      type: date
    - contextPath: MicrosoftECM.Collections.LimitToCollectionID
      description: The CollectionID of the collection to limit the query results to.
      type: string
    - contextPath: MicrosoftECM.Collections.LimitToCollectionName
      description: The Name of the collection to limit the query results to.
      type: string
    - contextPath: MicrosoftECM.Collections.LocalMemberCount
      description: Count of members visible at the local site.
      type: number
    - contextPath: MicrosoftECM.Collections.MemberClassName
      description: Class name having instances that are the members of the collection
      type: string
    - contextPath: MicrosoftECM.Collections.MemberCount
      description: A count of the collection members.
      type: number
    - contextPath: MicrosoftECM.Collections.UseCluster
      description: A comma separated list of resource IDs e.g 0001,0002
      type: boolean
    - contextPath: MicrosoftECM.Collections.CollectionRules
      description: Name of the defining membership criteria for the collection
      type: string
    description: Adds a query membership rule to one or more Configuration Manager
      device collections
  - name: ms-ecm-service-start
    arguments:
    - name: service_name
      required: true
      description: The name of the service
    - name: device_name
      description: The device name to start the service in. (can be retrived via `!ms-ecm-device-list`)
    - name: collection_id
      description: The ID of the collection to start the service in. (can be retrived
        via `!ms-ecm-collection-list collection_type="Device"`)
    - name: collection_name
      description: The name of the collection to start the service in. (can be retrived
        via `!ms-ecm-collection-list collection_type="Device"`)
    - name: poll_results
      description: Whether to poll for the script invocation results or not
      auto: PREDEFINED
      predefined:
      - 'true'
      - 'false'
    - name: timeout
      required: false
      description: The timeout in seconds to poll for invocation results. Default
        is 30 seconds.
    outputs:
    - contextPath: MicrosoftECM.ScriptsInvocationResults.OperationId
      description: The script invocation operation ID
      type: number
    - contextPath: MicrosoftECM.ScriptsInvocationResults.CollectionId
      description: The collection ID of the device on which the script was invoked
        on
      type: string
    - contextPath: MicrosoftECM.ScriptsInvocationResults.CollectionName
      description: The collection Name of the device on which the script was invoked
        on
      type: string
    - contextPath: MicrosoftECM.ScriptsInvocationResults.DeviceName
      description: The name of the device on which the script was invoked on
      type: string
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ResourceId
      description: The resource ID of the device on which the script was invoked on
      type: number
    - contextPath: MicrosoftECM.ScriptsInvocationResults.LastUpdateTime
      description: The last time the Invocation result object was updated
      type: date
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ScriptExecutionState
      description: The state of the script invocation
      type: string
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ScriptExitCode
      description: The exit code of the script invocation
      type: number
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ScriptGuid
      description: 'The unique identifier of the script '
      type: string
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ScriptLastModifiedDate
      description: The date of the script's last modification
      type: date
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ScriptName
      description: The name of the script
      type: string
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ScriptOutput
      description: The output of the script invocation
      type: string
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ScriptOutputHash
      description: The hash of the output of the script invocation
      type: string
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ScriptVersion
      description: The version of the script when it was invoked
      type: number
    - contextPath: MicrosoftECM.ScriptsInvocationResults.TaskID
      description: The unique identifier of the invocation
      type: string
    description: Starts a service on a device or collection (Implemented by creating
      and invoking a script named `XSOAR StartService`)
  - name: ms-ecm-service-restart
    arguments:
    - name: service_name
      required: true
      description: The name of the service
    - name: device_name
      description: The device name to start the service in. (can be retrived via `!ms-ecm-device-list`)
    - name: collection_id
      description: The ID of the collection to start the service in. (can be retrived
        via `!ms-ecm-collection-list collection_type="Device"`)
    - name: collection_name
      description: The name of the collection to start the service in. (can be retrived
        via `!ms-ecm-collection-list collection_type="Device"`)
    - name: poll_results
      description: Whether to poll for the script invocation results or not
      auto: PREDEFINED
      predefined:
      - 'true'
      - 'false'
    - name: timeout
      required: false
      description: The timeout in seconds to poll for invocation results. Default
        is 30 seconds.
    outputs:
    - contextPath: MicrosoftECM.ScriptsInvocationResults.OperationId
      description: The script invocation operation ID
      type: number
    - contextPath: MicrosoftECM.ScriptsInvocationResults.CollectionId
      description: The collection ID of the device on which the script was invoked
        on
      type: string
    - contextPath: MicrosoftECM.ScriptsInvocationResults.CollectionName
      description: The collection Name of the device on which the script was invoked
        on
      type: string
    - contextPath: MicrosoftECM.ScriptsInvocationResults.DeviceName
      description: The name of the device on which the script was invoked on
      type: string
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ResourceId
      description: The resource ID of the device on which the script was invoked on
      type: number
    - contextPath: MicrosoftECM.ScriptsInvocationResults.LastUpdateTime
      description: The last time the Invocation result object was updated
      type: date
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ScriptExecutionState
      description: The state of the script invocation
      type: string
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ScriptExitCode
      description: The exit code of the script invocation
      type: number
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ScriptGuid
      description: 'The unique identifier of the script '
      type: string
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ScriptLastModifiedDate
      description: The date of the script's last modification
      type: date
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ScriptName
      description: The name of the script
      type: string
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ScriptOutput
      description: The output of the script invocation
      type: string
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ScriptOutputHash
      description: The hash of the output of the script invocation
      type: string
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ScriptVersion
      description: The version of the script when it was invoked
      type: number
    - contextPath: MicrosoftECM.ScriptsInvocationResults.TaskID
      description: The unique identifier of the invocation
      type: string
    description: Restarts a service on a device or collection (Implemented by creating
      and invoking a script named `XSOAR RestartService`)
  - name: ms-ecm-service-stop
    arguments:
    - name: service_name
      required: true
      description: The name of the service
    - name: device_name
      description: The device name to start the service in. (can be retrived via `!ms-ecm-device-list`)
    - name: collection_id
      description: The ID of the collection to start the service in. (can be retrived
        via `!ms-ecm-collection-list collection_type="Device"`)
    - name: collection_name
      description: The name of the collection to start the service in. (can be retrived
        via `!ms-ecm-collection-list collection_type="Device"`)
    - name: poll_results
      description: Whether to poll for the script invocation results or not
      auto: PREDEFINED
      predefined:
      - 'true'
      - 'false'
    - name: timeout
      required: false
      description: The timeout in seconds to poll for invocation results. Default
        is 30 seconds.
    outputs:
    - contextPath: MicrosoftECM.ScriptsInvocationResults.OperationId
      description: The script invocation operation ID
      type: number
    - contextPath: MicrosoftECM.ScriptsInvocationResults.CollectionId
      description: The collection ID of the device on which the script was invoked
        on
      type: string
    - contextPath: MicrosoftECM.ScriptsInvocationResults.CollectionName
      description: The collection Name of the device on which the script was invoked
        on
      type: string
    - contextPath: MicrosoftECM.ScriptsInvocationResults.DeviceName
      description: The name of the device on which the script was invoked on
      type: string
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ResourceId
      description: The resource ID of the device on which the script was invoked on
      type: number
    - contextPath: MicrosoftECM.ScriptsInvocationResults.LastUpdateTime
      description: The last time the Invocation result object was updated
      type: date
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ScriptExecutionState
      description: The state of the script invocation
      type: string
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ScriptExitCode
      description: The exit code of the script invocation
      type: number
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ScriptGuid
      description: 'The unique identifier of the script '
      type: string
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ScriptLastModifiedDate
      description: The date of the script's last modification
      type: date
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ScriptName
      description: The name of the script
      type: string
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ScriptOutput
      description: The output of the script invocation
      type: string
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ScriptOutputHash
      description: The hash of the output of the script invocation
      type: string
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ScriptVersion
      description: The version of the script when it was invoked
      type: number
    - contextPath: MicrosoftECM.ScriptsInvocationResults.TaskID
      description: The unique identifier of the invocation
      type: string
    description: Stops a service on a device or collection (Implemented by creating
      and invoking a script named `XSOAR StopService`)
  - name: ms-ecm-script-invocation-results
    description: Gets a script invocation results
    arguments:
    - name: operation_id
      required: true
      description: The script invocation operation ID
    - name: timeout
      required: false
      description: The timeout in seconds to poll for invocation results. Default
        is 30 seconds.
    outputs:
    - contextPath: MicrosoftECM.ScriptsInvocationResults.OperationId
      description: The script invocation operation ID
      type: number
    - contextPath: MicrosoftECM.ScriptsInvocationResults.CollectionId
      description: The collection ID of the device on which the script was invoked
        on
      type: string
    - contextPath: MicrosoftECM.ScriptsInvocationResults.CollectionName
      description: The collection Name of the device on which the script was invoked
        on
      type: string
    - contextPath: MicrosoftECM.ScriptsInvocationResults.DeviceName
      description: The name of the device on which the script was invoked on
      type: string
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ResourceId
      description: The resource ID of the device on which the script was invoked on
      type: number
    - contextPath: MicrosoftECM.ScriptsInvocationResults.LastUpdateTime
      description: The last time the Invocation result object was updated
      type: date
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ScriptExecutionState
      description: The state of the script invocation
      type: string
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ScriptExitCode
      description: The exit code of the script invocation
      type: number
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ScriptGuid
      description: 'The unique identifier of the script '
      type: string
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ScriptLastModifiedDate
      description: The date of the script's last modification
      type: date
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ScriptName
      description: The name of the script
      type: string
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ScriptOutput
      description: The output of the script invocation
      type: string
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ScriptOutputHash
      description: The hash of the output of the script invocation
      type: string
    - contextPath: MicrosoftECM.ScriptsInvocationResults.ScriptVersion
      description: The version of the script when it was invoked
      type: number
    - contextPath: MicrosoftECM.ScriptsInvocationResults.TaskID
      description: The unique identifier of the invocation
      type: string
  - name: ms-ecm-device-get-collection-member
    arguments:
    - name: device_names
      description: A comma separated list of device names, i.e `name1,name2,etc.`
      isArray: true
    - name: resource_ids
      description: A comma separated list of resource ids, i.e `ID1,ID2,etc.`
      isArray: true
    outputs:
    - contextPath: MicrosoftECM.DeviceCollectionMember.Name
      description: The name of the device
      type: string
    - contextPath: MicrosoftECM.DeviceCollectionMember.ClientVersion
      description: Version of the installed client software.
      type: string
    - contextPath: MicrosoftECM.DeviceCollectionMember.DeviceOS
      description: Device operating system.
      type: string
    - contextPath: MicrosoftECM.DeviceCollectionMember.ResourceID
      description: Unique Configuration Manager-supplied ID for the resource.
      type: number
    - contextPath: MicrosoftECM.DeviceCollectionMember.IsActive
      description: true if there has been a recent heartbeat from the client.
      type: boolean
    - contextPath: MicrosoftECM.DeviceCollectionMember.LastActiveTime
      description: Comes from Client Health. Represents the last reported time the
        client was active.
      type: date
    - contextPath: MicrosoftECM.DeviceCollectionMember.LastClientCheckTime
      description: Comes from Client Health. Represents the last reported health evaluation
        time.
      type: date
    - contextPath: MicrosoftECM.DeviceCollectionMember.LastDDR
      description: Last heartbeat timestamp from client DDR discovery.
      type: date
    - contextPath: MicrosoftECM.DeviceCollectionMember.LastHardwareScan
      description: Timestamp from the last hardware inventory scan.
      type: date
    - contextPath: MicrosoftECM.DeviceCollectionMember.LastPolicyRequest
      description: Timestamp of the last policy request for this client.
      type: date
    - contextPath: MicrosoftECM.DeviceCollectionMember.Domain
      description: Domain to which the resource belongs.
      type: string
    - contextPath: MicrosoftECM.DeviceCollectionMember.PrimaryUser
      description: The primary user of the device
      type: string
    - contextPath: MicrosoftECM.DeviceCollectionMember.Status
      description: Current status of the device.
      type: string
    - contextPath: MicrosoftECM.DeviceCollectionMember.MACAddress
      description: The MAC Address of the device.
      type: string
    - contextPath: MicrosoftECM.DeviceCollectionMember.IsVirtualMachine
      description: true if the client is a virtual machine.
      type: boolean
    - contextPath: MicrosoftECM.DeviceCollectionMember.IsDecommissioned
      description: true if the collection member is decommissioned.
      type: boolean
    - contextPath: MicrosoftECM.DeviceCollectionMember.IsClient
      description: true, if the client is a Configuration Manager client.
      type: boolean
    - contextPath: MicrosoftECM.DeviceCollectionMember.IsBlocked
      description: true if a system is blocked. Block/unblock is a manual action in
        the Admin Console UI that the administrator can invoke. By blocking a client,
        client communication with the server will be cut off.
      type: boolean
    - contextPath: MicrosoftECM.DeviceCollectionMember.ExchangeServer
      description: Name of the Exchange server for Exchange Active Sync (EAS).
      type: string
    - contextPath: MicrosoftECM.DeviceCollectionMember.DeviceThreatLevel
      description: The threat level of the device
      type: string
    - contextPath: MicrosoftECM.DeviceCollectionMember.CurrentLogonUser
      description: Current logged on user
      type: string
    - contextPath: MicrosoftECM.DeviceCollectionMember.LastLogonUser
      description: The last user who logged in to the device
      type: string
    - contextPath: MicrosoftECM.DeviceCollectionMember.DeviceOSBuild
      description: The OS build number of the device
      type: string
    - contextPath: MicrosoftECM.DeviceCollectionMember.ADLastLogonTime
      description: Last logon timestamp of the computer (discovered from Active Directory).
      type: date
    - contextPath: MicrosoftECM.DeviceCollectionMember.SiteCode
      description: Site code of the site that created the collection.
      type: string
    description: Gets a Configuration Manager device By querying the SMS_CM_RES_COLL_SMS00001
      class. You can use the `ms-ecm-device-get-resource` or `ms-ecm-device-get-collection-member`
      commands to change the query class. Depending upon your role-based access in
      the site, you may need to use one of these other commands.
  - name: ms-ecm-device-get-resource
    arguments:
    - name: device_names
      description: A comma separated list of device names, i.e `name1,name2,etc.`
      isArray: true
    - name: resource_ids
      description: A comma separated list of resource ids, i.e `ID1,ID2,etc.`
      isArray: true
    outputs:
    - contextPath: MicrosoftECM.DeviceResource.Name
      description: The name of the device
      type: string
    - contextPath: MicrosoftECM.DeviceResource.AgentName
      description: List of the names of discovery agents that found the resource.
      type: string
    - contextPath: MicrosoftECM.DeviceResource.ResourceId
      description: Configuration Manager-supplied ID that uniquely identifies a Configuration
        Manager client resource
      type: number
    - contextPath: MicrosoftECM.DeviceResource.ADSiteName
      description: The Active Directory site name that is assigned to the client.
      type: string
    - contextPath: MicrosoftECM.DeviceResource.AgentSite
      description: List of sites from which the discovery agents run.
      type: string
    - contextPath: MicrosoftECM.DeviceResource.AgentTime
      description: List of discovery dates and times.
      type: date
    - contextPath: MicrosoftECM.DeviceResource.CPUType
      description: The CPU type, for example, StrongARM. Currently, only device clients
        report this value.
      type: string
    - contextPath: MicrosoftECM.DeviceResource.DistinguishedName
      description: The distinguished name of the account.
      type: string
    - contextPath: MicrosoftECM.DeviceResource.FullDomainName
      description: The full name of the device's domain
      type: string
    - contextPath: MicrosoftECM.DeviceResource.IPAddresses
      description: List of the IP addresses that are associated with the resource.
        More than one address is listed if the resource has multiple network cards
        installed.
      type: string
    - contextPath: MicrosoftECM.DeviceResource.NetbiosName
      description: Name used by the NetBIOS protocol.
      type: string
    - contextPath: MicrosoftECM.DeviceResource.UserAccountControl
      description: User account control value retrieved from Active Directory.
      type: number
    - contextPath: MicrosoftECM.DeviceResource.LastLogonUserName
      description: Name of the last logged-on user at the time the discovery agent
        ran.
      type: date
    - contextPath: MicrosoftECM.DeviceResource.LastLogonUserDomain
      description: Domain used by the last logged-on user at the time the discovery
        agent ran.
      type: string
    - contextPath: MicrosoftECM.DeviceResource.LastLogonTimestamp
      description: The date of the last user logon.
      type: date
    - contextPath: MicrosoftECM.DeviceResource.OperatingSystemNameandVersion
      description: Free-form string that describes the operating system.
      type: string
    - contextPath: MicrosoftECM.DeviceResource.VirtualMachineHostName
      description: Virtual machine host name.
      type: string
    - contextPath: MicrosoftECM.DeviceResource.VirtualMachineType
      description: The type of the virtual machine
      type: string
    - contextPath: MicrosoftECM.DeviceResource.DNSForestGuid
      description: A unique identifier for the DNS forest
      type: string
    - contextPath: MicrosoftECM.DeviceResource.HardwareID
      description: An ID that uniquely describes the hardware on which the client
        is installed. This ID remains unchanged through re-imaging or through successive
        installations of the operating system or client. This differs from the Configuration
        Manager unique ID, which might change under these circumstances.
      type: string
    description: Gets a Configuration Manager device By querying the SMS_R_System
      class. You can use the `ms-ecm-device-get-resource` or `ms-ecm-device-get-collection-member`
      commands to change the query class. Depending upon your role-based access in
      the site, you may need to use one of these other commands.
  - name: ms-ecm-get-user-device-affinity
    arguments:
    - name: user_names
      description: A comma separated list of usernames with the form of "Domain\username"
        i.e "Domain\user1,Domain\user2",etc.."
      isArray: true
    - name: resource_ids
      description: A comma separated list of device resource ids, i.e `ID1,ID2,etc.`
    - name: device_names
      description: A comma separated list of device names, i.e `name1,name2,etc.`
      isArray: true
    outputs:
    - contextPath: MicrosoftECM.UserDeviceAffinity.DeviceName
      description: The name of the device.
      type: string
    - contextPath: MicrosoftECM.UserDeviceAffinity.UserName
      description: User name in domain\user format.
      type: string
    - contextPath: MicrosoftECM.UserDeviceAffinity.ResourceID
      description: The resource ID of the device.
      type: number
    - contextPath: MicrosoftECM.UserDeviceAffinity.IsActive
      description: TRUE if the relationship is active.
      type: boolean
    - contextPath: MicrosoftECM.UserDeviceAffinity.CreationTime
      description: The time when the relationship was created.
      type: date
    - contextPath: MicrosoftECM.UserDeviceAffinity.RelationshipResourceID
      description: The unique identifier for this relationship.
      type: number
    description: Get the relationships between a device and its primary users.
  dockerimage: demisto/powershell-ubuntu:7.0.3.12001
  runonce: false
fromversion: 5.5.0
