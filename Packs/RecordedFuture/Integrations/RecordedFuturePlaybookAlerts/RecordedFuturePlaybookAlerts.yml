commonfields:
  id: RecordedFuturePlaybookAlerts
  version: -1
name: RecordedFuturePlaybookAlerts
display: 'Recorded Future - Playbook Alerts'
category: Data Enrichment & Threat Intelligence
image:
description: 'Fetch & triage Recorded Future Playbook Alerts'
configuration:
- display: API URL (e.g., https://api.recordedfuture.com/gw/xsoar/) 
  name: server_url
  defaultvalue: https://api.recordedfuture.com/gw/xsoar/
  type: 0
  required: true
- display: API Token
  name: token
  defaultvalue: ""
  type: 4
  required: true
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
- display: Fetch incidents
  name: isFetch
  required: false
  type: 8
- display: 'First Incidient Fetch: Time Range'
  additionalinfo: 'Limit incidents to include in the first fetch by time range. Input format: "NN hours" or "NN days". E.g., input "5 days" to fetch all incidents created in the last 5 days.'
  defaultvalue: 24 hours
  name: first_fetch
  required: false
  type: 0
- display: 'Playbook Alerts: Fetched Categories'
  name: pa_categories
  required: false
  additionalinfo: 'Some listed Playbook alert Categories might be unavailable due to limitations in the current Recorded Future subscription'
  type: 16
  defaultvalue: All Available
  options:
    - All Available
    - Domain Abuse
    - Vulnerability
- display: Maximum number of incidents per fetch
  name: max_fetch
  defaultvalue: "50"
  required: false
  type: 0
- display: 'Playbook Alerts: Fetched Statuses'
  name: pa_statuses
  required: false
  type: 16
  defaultvalue: New
  options:
    - New
    - In Progress
    - Dismissed
    - Resolved
- display: 'Playbook Alerts: Fetched Priorities Threshold'
  name: pa_priorities
  required: false
  type: 15
  additionalinfo: 'Returns alerts with this selected priority or higher. High > Moderate > Informational'
  defaultvalue: Moderate
  options:
    - High
    - Moderate
    - Informational
script:
  script: '-'
  type: python
  subtype: python3
  dockerimage: demisto/python3:3.10.7.35188
  commands:
    - name: recordedfuture-playbook-alerts-details
      description: Get Playbook alert details by id.
      arguments:
        - name: alert_ids
          required: true
          description: Id of the playbook alert that should be fetched
        - name: detail_sections 
          required: false
          description: What evidence sections to include in the fetch, fetches all available if not specified
          auto: PREDEFINED
            - status
            - action
            - summary
            - log
            - domain_abuse-whois
            - domain_abuse-dns
      outputs: 
        - contextPath: RecordedFuture.PlaybookAlerts.playbook_alert_id
          description: Unique id of the playbook alert in Recorded Future
          type: string
        - contextPath: RecordedFuture.PlaybookAlerts.category
          description: Unique type of playbook_alert Recorded Future
          type: string
    - name: recordedfuture-playbook-alerts-update
      description: Update the status of one or multiple Playbook alerts
      arguments: 
        - name: alert_ids
          required: true
          description: Ids of the playbook alerts that will be updated
        - name: new_status
          required: true
          auto: PREDEFINED
          predefined:
            - new
            - in-progress
            - dismissed
            - resolved
      outputs:
        - contextPath: RecordedFuture.PlaybookAlerts.playbook_alert_id
          description: Unique id of the playbook alert in Recorded Future
          type: string
        - contextPath: RecordedFuture.PlaybookAlerts.current_status
          description: Current status of playbook alert in Recorded Future 
          type: string
        - contextPath: RecordedFuture.PlaybookAlerts.title
          description: Title of the playbook alert in Recorded Future
          type: string
        - contextPath: RecordedFuture.PlaybookAlerts.status_message
          description: Message describing the outcome of the update
          type: string

    - name: recordedfuture-playbook-alerts-search
      description: Search playbook alerts based on filters
      arguments: 
        - name: category
          required: false
          isArray: true
          description: filter what playbook alert categories that is wanted. (default = all available)
        - name: limit
          required: false
          description: Limits the number of alerts to fetch.
        - name: time_since_update
          required: false
          description: Time between now and e.g. "2 hours" or "7 days" ago
        - name: playbook_alert_status
          required: false
          isArray: true
          auto: PREDEFINED
          predefined:
            - new
            - in-progress
            - dismissed
            - resolved
          description: Filter what statuses are fetched, defaults to only new status if not specified.
        - name: priority
          required: false
          auto: PREDEFINED
          predefined:
            - high
            - moderate
            - informational
          description: Actions pritority assigned in Recorded Future
        - name: order_search_by
          required: false
          auto: PREDEFINED
          predefined:
            - updated
            - created
          description: Actions pritority assigned in Recorded Future
      outputs:
        - contextPath: RecordedFuture.PlaybookAlerts.playbook_alert_id
          description: Unique id of the playbook alert
          type: String
        - contextPath: RecordedFuture.PlaybookAlerts.category
          description: Playbook alert category 
          type: String
        - contextPath: RecordedFuture.PlaybookAlerts.priority
          description: Recommended Priority of the alert
          type: String
        - contextPath: RecordedFuture.PlaybookAlerts.status
          description: Current alert status in Recorded Future
          type: String
        - contextPath: RecordedFuture.PlaybookAlerts.title
          description: Title of the alert
          type: String
        - contextPath: RecordedFuture.PlaybookAlerts.updated
          description: Date of last update
          type: date
        - contextPath: RecordedFuture.PlaybookAlerts.created
          description: Date of creation
          type: date
        - contextPath: RecordedFuture.PlaybookAlerts.organization_id
          description: Organization uhash
          type: String
        - contextPath: RecordedFuture.PlaybookAlerts.organization_name
          description: Plaintext Organization name
          type: String
        - contextPath: RecordedFuture.PlaybookAlerts.assignee_id
          description: uhash of the assigned user
          type: String
        - contextPath: RecordedFuture.PlaybookAlerts.assignee_name
          description: name of the assigned user
        - contextPath: RecordedFuture.PlaybookAlerts.owner_id
          description: uhash of the enterprise that owns the alert
          type: String
        - contextPath: RecordedFuture.PlaybookAlerts.owner_name
          description: Name of the enterprise that owns the alert
          type: String
  isfetch: true
  runonce: false
fromversion: 5.5.0
tests:
- No tests (auto formatted)
