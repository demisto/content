commonfields:
  id: Kennav2
  version: -1
name: Kennav2
display: Kenna v2
category: Vulnerability Management
description: Use the Kenna v2 integration to search and update vulnerabilities, schedule
  a run connector, and manage tags and attributes.
configuration:
- display: Server URL (e.g.  https://api.kennasecurity.com)
  name: url
  defaultvalue: https://api.kennasecurity.com
  type: 0
  required: false
- display: Kenna API key
  name: key
  type: 4
  required: true
- display: Use system proxy settings
  name: proxy
  defaultvalue: "false"
  type: 8
  required: false
- display: Trust any certificate (not secure)
  name: insecure
  defaultvalue: "false"
  type: 8
description: Use the Kenna v2 integration to search and update vulnerabilities, schedule
  a run connector, and manage tags and attributes.
display: Kenna v2
name: Kennav2
script:
  script: ''
  type: python
  commands:
  - name: kenna-search-vulnerabilities
    arguments:
    - name: top-priority
      auto: PREDEFINED
      predefined:
      - "true"
      - "false"
      description: Whether to return vulnerabilities that Kenna deems a top priority
        to fix. Can be "true" or "false".
      isArray: true
    - name: min-score
      description: The minimum vulnerability score for which to return vulnerabilities.
    - name: status
      auto: PREDEFINED
      predefined:
      - open
      - closed
      - risk_accepted
      - false_positive
      required: false
      secret: false
    - default: false
      defaultValue: '500'
      description: The maximum number of vulnerabilities to return. The default value
        is 500.
      isArray: false
      name: limit
      required: false
      secret: false
    - auto: PREDEFINED
      default: true
      defaultValue: 'True'
      description: Whether to flush to context. Can be "True" or "False". The default
        value is "True".
      isArray: false
      name: to_context

      predefined:
      - "True"
      - "False"
      description: Whether to flush to context. Can be "True" or "False". The default
        value is "True".
      defaultValue: "True"
    - name: id
      description: The vulnerability ID for which to search.
      isArray: true
    outputs:
    - contextPath: Kenna.Vulnerabilities.AssetID
      description: The asset ID related to the vulnerability.
      type: Number
    - contextPath: Kenna.Vulnerabilities.Connectors.DefinitionName
      description: The connector definition name related to the vulnerability.
      type: String
    - contextPath: Kenna.Vulnerabilities.Connectors.ID
      description: The connector ID related to the vulnerability.
      type: Number
    - contextPath: Kenna.Vulnerabilities.Connectors.Name
      description: The connector name related to the vulnerability.
      type: String
    - contextPath: Kenna.Vulnerabilities.Connectors.Vendor
      description: The connector vendor related to the vulnerability.
      type: String
    - contextPath: Kenna.Vulnerabilities.CveID
      description: The CVE ID related to the vulnerability.
      type: String
    - contextPath: Kenna.Vulnerabilities.FixID
      description: The fix ID related to the vulnerability.
      type: String
    - contextPath: Kenna.Vulnerabilities.Patch
      description: Whether there is a patch related to the vulnerability.
      type: Boolean
    - contextPath: Kenna.Vulnerabilities.ScannerVulnerabilities.ExternalID
      description: The vulnerability scanner external ID.
      type: String
    - contextPath: Kenna.Vulnerabilities.ScannerVulnerabilities.Open
      description: Whether the vulnerability scanner is open.
      type: Boolean
    - contextPath: Kenna.Vulnerabilities.ScannerVulnerabilities.Port
      description: The vulnerability scanner port.
      type: Number
    - contextPath: Kenna.Vulnerabilities.Score
      description: The vulnerability score.
      type: Number
    - contextPath: Kenna.Vulnerabilities.ServiceTicket.DueDate
      description: The service ticket due date.
      type: Date
    - contextPath: Kenna.Vulnerabilities.ServiceTicket.ExternalIdentifier
      description: The service ticket external identifier.
      type: String
    - contextPath: Kenna.Vulnerabilities.ServiceTicket.Status
      description: The service ticket status.
      type: String
    - contextPath: Kenna.Vulnerabilities.ServiceTicket.TicketType
      description: The service ticket type.
      type: String
    - contextPath: Kenna.Vulnerabilities.Severity
      description: The vulnerability severity.
      type: Number
    - contextPath: Kenna.Vulnerabilities.Status
      description: The vulnerability status.
      type: String
    - contextPath: Kenna.Vulnerabilities.Threat
      description: The vulnerability threat.
      type: Number
    - contextPath: Kenna.Vulnerabilities.TopPriority
      description: The vulnerability priority.
      type: Number
    - contextPath: Kenna.Vulnerabilities.ID
      description: The vulnerability ID.
      type: Number
    description: Searches for vulnerabilities in Kenna.
  - name: kenna-run-connector
    arguments:
    - name: id
      required: true

      secret: false
    deprecated: false
    description: Executes a run of the specified connector. If file based, it will
      use the most recently uploaded data file.
    execution: true
  - name: kenna-search-fixes
    arguments:
    - name: id
      description: The vulnerability ID for which to search.
      isArray: true
      name: id
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Whether to return vulnerabilities that Kenna deems a top priority
        to fix. Can be "true" or "false".
      isArray: true
      name: top-priority
      predefined:
      - 'true'
      - 'false'
      required: false
      secret: false
    - default: false
      description: The minimum vulnerability score for which to return vulnerabilities.
      isArray: false
      name: min-score
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: The status of the vulnerability. Can be "open", "closed", "risk_accepted",
        or "false_positive".
      isArray: true
    - name: min-score
      description: The minimum vulnerability score for which to return vulnerabilities.
    - name: status
      auto: PREDEFINED
      predefined:
      - open
      - closed
      - risk_accepted
      - false_positive
      required: false
      secret: false
    - default: false
      defaultValue: '500'
      description: The maximum number of vulnerabilities to return. The default value
        is 500.
      isArray: false
      name: limit
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: 'True'
      description: Whether to flush to context. Can be "True" or "False". The default
        value is "True".
      isArray: false
      name: to_context
      predefined:
      - 'True'
      - 'False'
      required: false
      secret: false
    deprecated: false
    description: Filters fixes by a given set of vulnerability and asset parameters
      and returns the filtered fixes.
    execution: false
    name: kenna-search-fixes
    outputs:
    - contextPath: Kenna.Fixes.ID
      description: The fix ID.
      type: Number
    - contextPath: Kenna.Fixes.Title
      description: The fix title.
      type: String
    - contextPath: Kenna.Fixes.Assets.ID
      description: The asset ID related to the current fix.
      type: Number
    - contextPath: Kenna.Fixes.Assets.Locator
      description: The asset locator related to the current fix.
      type: String
    - contextPath: Kenna.Fixes.Assets.PrimaryLocator
      description: The asset primary locator related to the current fix.
      type: String
    - contextPath: Kenna.Fixes.Assets.DisplayLocator
      description: The asset display locator related to the current fix.
      type: String
    - contextPath: Kenna.Fixes.Vulnerabilities.ID
      description: The vulnerability ID related to the current fix.
      type: Number
    - contextPath: Kenna.Fixes.Vulnerabilities.ServiceTicketStatus
      description: The vulnerability service ticket status related to the current
        fix.
      type: String
    - contextPath: Kenna.Fixes.Vulnerabilities.ScannerIDs
      description: The vulnerability scanner IDs related to the current fix.
      type: Number
    - contextPath: Kenna.Fixes.CveID
      description: The CVE-ID list related to the current fix.
      type: String
    - contextPath: Kenna.Fixes.LastUpdatedAt
      description: The timestamp when the current fix was last updated.
      type: String
    - contextPath: Kenna.Fixes.Category
      description: The category of fix.
      type: String
    - contextPath: Kenna.Fixes.VulnerabilityCount
      description: The vulnerability count of the fix.
      type: Number
    - contextPath: Kenna.Fixes.MaxScore
      description: The maximum score of the fix.
      type: Number
    description: Filters fixes by a given set of vulnerability and asset parameters
      and returns the filtered fixes.
  - name: kenna-update-asset
    arguments:
    - name: id
      required: true
      description: The ID of the asset to update.
    - name: notes
      required: true
      description: Notes about the asset.
    description: Updates the attributes of a single asset.
  - name: kenna-update-vulnerability
    arguments:
    - name: id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: The status of the vulnerability. Can be "open", "closed", "risk_accepted",
        or "false_positive".
      isArray: false
      name: status
      predefined:
      - open
      - closed
      - risk_accepted
      - false_positive
      description: The status of the vulnerability. Can be "open", "closed", "risk_accepted",
        or "false_positive".
    - name: notes
      description: Notes about the vulnerability.
    description: Updates the attributes of a single vulnerability.
  - name: kenna-get-connectors
    arguments: []
    outputs:
    - contextPath: Kenna.ConnectorsList.ID
      description: The connector ID.
      type: Number
    - contextPath: Kenna.ConnectorsList.Name
      description: The connector name.
      type: String
    - contextPath: Kenna.ConnectorsList.Running
      description: The running connector.
      type: Boolean
    - contextPath: Kenna.ConnectorsList.Host
      description: The connector host.
      type: String
    description: Returns all connectors.
  - name: kenna-search-assets
    arguments:
    - name: id
      description: The asset ID to search for.
      isArray: true
    - name: hostname
      description: The hostname of the asset to search for.
      isArray: true
    - name: min-score
      description: The minimum vulnerability score for which to return vulnerabilities.
    - name: tags
      description: The tags by which to search.
      isArray: true
      name: tags
      required: false
      secret: false
    - default: false
      defaultValue: '500'
      description: The maximum number of vulnerabilities to return. The default value
        is 500.
      isArray: false
      name: limit
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: 'True'
      description: Whether to print output to context. Can be "True" or "False". The
        default value is "True".
      isArray: false
      name: to_context
      predefined:
      - "True"
      - "False"
      description: Whether to print output to context. Can be "True" or "False". The
        default value is "True".
      defaultValue: "True"
    outputs:
    - contextPath: Kenna.Assets.ID
      description: The asset ID.
      type: Number
    - contextPath: Kenna.Assets.Hostname
      description: The hostname of the asset.
      type: String
    - contextPath: Kenna.Assets.IpAddress
      description: The asset IP address.
      type: String
    - contextPath: Kenna.Assets.Score
      description: The asset risk score.
      type: Number
    - contextPath: Kenna.Assets.VulnerabilitiesCount
      description: The number of vulnerabilities associated with the asset.
      type: Number
    - contextPath: Kenna.Assets.OperatingSystem
      description: The asset operating system.
      type: String
    - contextPath: Kenna.Assets.Tags
      description: A list of the asset's tags.
      type: String
    - contextPath: Kenna.Assets.Fqdn
      description: The asset FQDN.
      type: String
    - contextPath: Kenna.Assets.Status
      description: The asset status.
      type: String
    - contextPath: Kenna.Assets.Owner
      description: The asset owner.
      type: String
    - contextPath: Kenna.Assets.Priority
      description: The asset priority.
      type: Number
    - contextPath: Kenna.Assets.Notes
      description: Notes of current asset.
      type: String
    - contextPath: Kenna.Assets.OperatingSystem
      description: Operating system of asset
      type: String
    description: Searches for assets.
  - name: kenna-get-asset-vulnerabilities
    arguments:
    - name: id
      required: true
      description: The asset ID for which to get vulnerabilities.
      isArray: true
      name: id
      required: true
      secret: false
    - default: false
      defaultValue: '500'
      description: The maximum number of vulnerabilities to return. The default value
        is 500.
      isArray: false
      name: limit
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: 'True'
      description: Whether to print output to context. Can be "True" or "False". The
        default value is "True".
      isArray: false
      name: to_context
      predefined:
      - "True"
      - "False"
      description: Whether to print output to context. Can be "True" or "False". The
        default value is "True".
      defaultValue: "True"
    outputs:
    - contextPath: Kenna.VulnerabilitiesOfAsset.AssetID
      description: The ID of the asset that this vulnerability is associated with.
      type: Number
    - contextPath: Kenna.VulnerabilitiesOfAsset.CveID
      description: 'The CVE ID of the vulnerability associated with the asset. '
      type: String
    - contextPath: Kenna.VulnerabilitiesOfAsset.ID
      description: 'The ID of the vulnerability associated withe the asset '
      type: Number
    - contextPath: Kenna.VulnerabilitiesOfAsset.Patch
      description: 'Whether there is a patch for the vulnerability associated with
        the asset. '
      type: Boolean
    - contextPath: Kenna.VulnerabilitiesOfAsset.Status
      description: 'The status of the vulnerability associated with the asset. '
      type: String
    - contextPath: Kenna.VulnerabilitiesOfAsset.TopPriority
      description: 'Whether the vulnerability associated with the asset is a top priority. '
      type: Boolean
    - contextPath: Kenna.VulnerabilitiesOfAsset.Score
      description: 'The score of the vulnerability associated with the asset. '
      type: Number
    description: Gets vulnerabilities of the specified asset.
  - name: kenna-add-tag
    arguments:
    - name: tag
      required: true
      description: A comma-separated list of tags to add to the asset.
      isArray: true
    - name: id
      required: true
      description: 'The asset ID to which to add the tag. '
    description: Adds a tag to the specified asset.
  - name: kenna-delete-tag
    arguments:
    - name: id
      required: true
      auto: PREDEFINED
      predefined:
      - ""
      description: The asset ID from which to delete the tag.
    - name: tag
      required: true
      description: The tag to delete.
    description: Deletes tags from the specified asset.
  - name: kenna-get-connector-runs
    arguments:
    - name: connector_id
      required: true
      description: Unique numerical ID of the connector
    outputs:
    - contextPath: Kenna.ConnectorRunsList.id
      description: Connector Run ID
    - contextPath: Kenna.ConnectorRunsList.start_time
      description: Connector Run Start Time
    - contextPath: Kenna.ConnectorRunsList.end_time
      description: Connector Run End Time
    - contextPath: Kenna.ConnectorRunsList.success
      description: Boolean value showing connector success
      type: boolean
    - contextPath: Kenna.ConnectorRunsList.total_payload_count
      description: Total connector payloads
    - contextPath: Kenna.ConnectorRunsList.processed_payload_count
      description: total payloads processed by connector
    - contextPath: Kenna.ConnectorRunsList.failed_payload_count
      description: Total failed payloads
    - contextPath: Kenna.ConnectorRunsList.processed_assets_count
      description: Count of processed assets
    - contextPath: Kenna.ConnectorRunsList.assets_with_tags_reset_count
      description: Count of assets with reset tags
    - contextPath: Kenna.ConnectorRunsList.processed_scanner_vuln_count
      description: Count of processed scanners with vulnerabilities
    - contextPath: Kenna.ConnectorRunsList.updated_scanner_vlun_count
      description: Count of updated scanners with vulnerabilities
    - contextPath: Kenna.ConnectorRunsList.created_scanner_vuln_count
      description: 'Count of created scanners with vulnerabilities '
    - contextPath: Kenna.ConnectorRunsList.closed_scanner_vuln_count
      description: 'Count of closed scanners with vulnerabilities '
    - contextPath: Kenna.ConnectorRunsList.autoclosed_scanner_vuln_count
      description: Count of auto-closed scanners with vulnerabilities
    - contextPath: Kenna.ConnectorRunsList.reopened_scanner_vuln_count
      description: 'Count of reopened scanners with vulnerabilities '
    - contextPath: Kenna.ConnectorRunsList.closed_vuln_count
      description: Count of closed vulnerabilities
    - contextPath: Kenna.ConnectorRunsList.autoclosed_vuln_count
      description: Count of auto-closed vulnerabilities
    - contextPath: Kenna.ConnectorRunsList.reopened_vuln_count
      description: Count of re-opened vulnerabilities
    description: Returns JSON data on all the runs of a given connector
  dockerimage: demisto/python3:3.8.6.14516
  runonce: false
  subtype: python3
fromversion: 5.0.0
tests:
- No tests (auto formatted)
