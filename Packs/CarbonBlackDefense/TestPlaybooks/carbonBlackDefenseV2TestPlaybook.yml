id: carbonBlackDefenseV2TestPlaybook
version: -1
name: carbonBlackDefenseV2TestPlaybook
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: df66c65e-dde5-4628-807c-72f42ee8adca
    type: start
    task:
      id: df66c65e-dde5-4628-807c-72f42ee8adca
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "1":
    id: "1"
    taskid: 2110b5da-4ad9-499b-8c59-10e9a69f5f40
    type: regular
    task:
      id: 2110b5da-4ad9-499b-8c59-10e9a69f5f40
      version: -1
      name: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "62"
      - "65"
      - "66"
      - "61"
      - "64"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "2":
    id: "2"
    taskid: 0353fa18-3f90-4e16-8347-7b78dde0700c
    type: regular
    task:
      id: 0353fa18-3f90-4e16-8347-7b78dde0700c
      version: -1
      name: cbd-get-alert-details
      script: '|||cbd-get-alert-details'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      alertId:
        complex:
          root: CarbonBlackDefense.Alert
          accessor: id
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 865
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "3":
    id: "3"
    taskid: c345ce4d-f9e8-4f43-82e4-c31c15847f67
    type: condition
    task:
      id: c345ce4d-f9e8-4f43-82e4-c31c15847f67
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "87"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: CarbonBlackDefense.Alert
                accessor: id
            iscontext: true
          right:
            value:
              complex:
                root: CarbonBlackDefense.Alert
                accessor: id
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "4":
    id: "4"
    taskid: ac4e12f6-6ae6-4ca4-81a1-6e051d9de5b4
    type: regular
    task:
      id: ac4e12f6-6ae6-4ca4-81a1-6e051d9de5b4
      version: -1
      name: cbd-device-search
      script: '|||cbd-device-search'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "52"
    scriptarguments:
      device_id: {}
      end_time: {}
      os: {}
      query: {}
      start_time: {}
      status: {}
      target_priority: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 515
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "9":
    id: "9"
    taskid: 60ff3192-c6c4-458d-809c-e34fdc59c8bd
    type: regular
    task:
      id: 60ff3192-c6c4-458d-809c-e34fdc59c8bd
      version: -1
      name: cbd-get-policies
      script: '|||cbd-get-policies'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "36"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "11":
    id: "11"
    taskid: e9342893-0ad4-4246-80ea-e5671c8091ae
    type: regular
    task:
      id: e9342893-0ad4-4246-80ea-e5671c8091ae
      version: -1
      name: cbd-get-policy
      script: '|||cbd-get-policy'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      policyId:
        complex:
          root: CarbonBlackDefense.Policy
          accessor: id
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 865
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "12":
    id: "12"
    taskid: 9cbac1c1-0206-40af-84ef-0123c19acd69
    type: condition
    task:
      id: 9cbac1c1-0206-40af-84ef-0123c19acd69
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "13"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: CarbonBlackDefense.Policy
                accessor: name
            iscontext: true
          right:
            value:
              simple: Demisto test1
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "13":
    id: "13"
    taskid: 7becbb87-52d4-4d40-8e2a-55588fe99e79
    type: regular
    task:
      id: 7becbb87-52d4-4d40-8e2a-55588fe99e79
      version: -1
      name: cbd-set-policy
      script: '|||cbd-set-policy'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "84"
    scriptarguments:
      keyValue:
        complex:
          root: CarbonBlackDefense.Policy
          accessor: id
          transformers:
          - operator: concat
            args:
              prefix:
                value:
                  simple: "{\n    \"policyInfo\": {\n        \"description\": \"A\
                    \ policy created for the test playbook for Demisto\",\n      \
                    \  \"name\": \"Demisto test1 after set policy\",\n        \"id\"\
                    : "
              suffix:
                value:
                  simple: |-
                    ,
                            "policy": {
                                "sensorSettings": [
                                    {
                                        "name": "SHOW_UI",
                                        "value": "false"
                                    }
                                ]
                            },
                            "priorityLevel": "LOW"
                        }
                    }
      policy:
        complex:
          root: CarbonBlackDefense.Policy
          accessor: id
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1215
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "14":
    id: "14"
    taskid: 448ca63f-eae6-4882-8ba7-8901bf1f22d6
    type: regular
    task:
      id: 448ca63f-eae6-4882-8ba7-8901bf1f22d6
      version: -1
      name: cbd-create-policy
      script: '|||cbd-create-policy'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "37"
    scriptarguments:
      description:
        simple: A policy created for the test playbook for Demisto
      name:
        simple: Demisto test1
      policy:
        simple: '{}'
      priorityLevel:
        simple: MEDIUM
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 515
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "16":
    id: "16"
    taskid: 905558a6-3c47-4711-8426-e2de1cb6ed4f
    type: regular
    task:
      id: 905558a6-3c47-4711-8426-e2de1cb6ed4f
      version: -1
      name: cbd-delete-policy
      script: '|||cbd-delete-policy'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      policyId:
        complex:
          root: CarbonBlackDefense.Policy
          accessor: id
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2440
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "17":
    id: "17"
    taskid: fa68553c-7a6e-43f5-838a-5fdccca83042
    type: regular
    task:
      id: fa68553c-7a6e-43f5-838a-5fdccca83042
      version: -1
      name: cbd-update-policy
      script: '|||cbd-update-policy'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "78"
    scriptarguments:
      description:
        simple: A policy created for the test playbook for Demisto
      id:
        complex:
          root: CarbonBlackDefense.Policy
          accessor: id
      name:
        simple: Demisto test1 after update policy
      policy:
        simple: '{"sensorSettings": [{"name": "SHOW_UI", "value": "false"}]}'
      priorityLevel:
        simple: MEDIUM
      priorityLevl:
        simple: MEDIUM
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1565
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "18":
    id: "18"
    taskid: 339c5fc1-3b47-42e8-8294-2fc98838ce76
    type: regular
    task:
      id: 339c5fc1-3b47-42e8-8294-2fc98838ce76
      version: -1
      name: cbd-add-rule-to-policy
      script: '|||cbd-add-rule-to-policy'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      action:
        simple: TERMINATE
      id:
        simple: "1"
      operation:
        simple: RANSOM
      policyId:
        complex:
          root: CarbonBlackDefense.Policy
          accessor: id
      required:
        simple: "true"
      type:
        simple: REPUTATION
      value:
        simple: COMPANY_BLACK_LIST
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "19":
    id: "19"
    taskid: f50d4928-c9a8-4a56-8290-8e6f486454eb
    type: regular
    task:
      id: f50d4928-c9a8-4a56-8290-8e6f486454eb
      version: -1
      name: cbd-update-rule-in-policy
      description: Update an existing rule with a new rule. Please note that system
        policies cannot be modified.
      script: '|||cbd-update-rule-in-policy'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      action:
        simple: TERMINATE
      id:
        complex:
          root: CarbonBlackDefense.Policy.policy.rules.[0]
          accessor: id
      operation:
        simple: RANSOM
      policyId:
        complex:
          root: CarbonBlackDefense.Policy
          accessor: id
      required:
        simple: "false"
      type:
        simple: REPUTATION
      value:
        simple: COMPANY_BLACK_LIST
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "20":
    id: "20"
    taskid: fd91b04e-1865-422f-8fb5-29e7fd718958
    type: regular
    task:
      id: fd91b04e-1865-422f-8fb5-29e7fd718958
      version: -1
      name: cbd-delete-rule-from-policy
      script: '|||cbd-delete-rule-from-policy'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      policyId:
        complex:
          root: CarbonBlackDefense.Policy
          accessor: id
      ruleId:
        complex:
          root: CarbonBlackDefense.Policy.policy.rules.[0]
          accessor: id
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2265
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "27":
    id: "27"
    taskid: 7dfc5523-274a-49d4-87fb-8d4b9473b177
    type: regular
    task:
      id: 7dfc5523-274a-49d4-87fb-8d4b9473b177
      version: -1
      name: cbd-device-quarantine
      script: '|||cbd-device-quarantine'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "79"
    scriptarguments:
      device_id:
        complex:
          root: inputs.our_sensor
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 865
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "29":
    id: "29"
    taskid: cb005a9d-f2fa-4f7a-832f-04df58dfe283
    type: regular
    task:
      id: cb005a9d-f2fa-4f7a-832f-04df58dfe283
      version: -1
      name: cbd-device-background-scan
      script: '|||cbd-device-background-scan'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      device_id:
        complex:
          root: inputs.our_sensor
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1215
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "30":
    id: "30"
    taskid: ec039f84-2ab5-4c99-8eac-f9734f95f281
    type: regular
    task:
      id: ec039f84-2ab5-4c99-8eac-f9734f95f281
      version: -1
      name: cbd-device-background-scan-stop
      script: '|||cbd-device-background-scan-stop'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      device_id:
        complex:
          root: inputs.our_sensor
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "31":
    id: "31"
    taskid: bb040f83-0288-4dab-856e-346bc6cc070a
    type: regular
    task:
      id: bb040f83-0288-4dab-856e-346bc6cc070a
      version: -1
      name: cbd-device-bypass
      script: '|||cbd-device-bypass'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      device_id:
        complex:
          root: inputs.our_sensor
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1565
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "32":
    id: "32"
    taskid: 3c89f508-b03c-4460-870f-4fc5d0aeb9e8
    type: regular
    task:
      id: 3c89f508-b03c-4460-870f-4fc5d0aeb9e8
      version: -1
      name: cbd-device-unbypass
      script: '|||cbd-device-unbypass'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "33"
    scriptarguments:
      device_id:
        complex:
          root: inputs.our_sensor
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1740
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "33":
    id: "33"
    taskid: 120c68b3-68de-472b-8696-ec4eef8784bc
    type: regular
    task:
      id: 120c68b3-68de-472b-8696-ec4eef8784bc
      version: -1
      name: cbd-device-policy-update
      script: '|||cbd-device-policy-update'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      device_id:
        complex:
          root: inputs.our_sensor
      policy_id:
        complex:
          root: inputs.default_policy
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "34":
    id: "34"
    taskid: 04fba87c-547f-4524-8859-8bbc6d3e05cb
    type: regular
    task:
      id: 04fba87c-547f-4524-8859-8bbc6d3e05cb
      version: -1
      name: cbd-device-update-sensor-version
      script: '|||cbd-device-update-sensor-version'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "35"
    scriptarguments:
      device_id:
        complex:
          root: inputs.our_sensor
      sensor_version:
        complex:
          root: inputs.sensor_version
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "35":
    id: "35"
    taskid: e812b0f5-be46-469a-81ee-7f92bbeb2181
    type: title
    task:
      id: e812b0f5-be46-469a-81ee-7f92bbeb2181
      version: -1
      name: Test Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2280
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "36":
    id: "36"
    taskid: 880a5792-3d5e-4ee8-8690-68fb51406724
    type: condition
    task:
      id: 880a5792-3d5e-4ee8-8690-68fb51406724
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "69"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CarbonBlackDefense.Policy
                accessor: id
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2790
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "37":
    id: "37"
    taskid: a9e485cc-b786-4a83-844d-df0745cfd894
    type: condition
    task:
      id: a9e485cc-b786-4a83-844d-df0745cfd894
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "11"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: greaterThan
          left:
            value:
              complex:
                root: CarbonBlackDefense.Policy
                accessor: id
            iscontext: true
          right:
            value:
              simple: "0"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "52":
    id: "52"
    taskid: d0f01b08-c781-432f-8b75-f41311a5da57
    type: condition
    task:
      id: d0f01b08-c781-432f-8b75-f41311a5da57
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "27"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CarbonBlackDefense.Device
                accessor: id
            iscontext: true
    view: |-
      {
        "position": {
          "x": 480,
          "y": 690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "61":
    id: "61"
    taskid: a1793455-30f7-4dde-8f10-67278fd8a730
    type: title
    task:
      id: a1793455-30f7-4dde-8f10-67278fd8a730
      version: -1
      name: Test policies commands
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "14"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "62":
    id: "62"
    taskid: 86051cb1-64d4-48d5-8142-d5c81bd7ba43
    type: title
    task:
      id: 86051cb1-64d4-48d5-8142-d5c81bd7ba43
      version: -1
      name: Test events commands
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "83"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "64":
    id: "64"
    taskid: fc241304-00e4-4eed-84c5-e7420eb5b1df
    type: title
    task:
      id: fc241304-00e4-4eed-84c5-e7420eb5b1df
      version: -1
      name: Test devices commands
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "4"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "65":
    id: "65"
    taskid: d20b314b-da03-4db7-8e51-74d5e9b04895
    type: title
    task:
      id: d20b314b-da03-4db7-8e51-74d5e9b04895
      version: -1
      name: Test alerts commands
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "81"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "66":
    id: "66"
    taskid: 1380ed7f-134c-42bd-8b27-364bd7972cb3
    type: title
    task:
      id: 1380ed7f-134c-42bd-8b27-364bd7972cb3
      version: -1
      name: Test processes commands
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "86"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "67":
    id: "67"
    taskid: 95d7caad-62c0-49cf-8a7a-d7923ec0845e
    type: title
    task:
      id: 95d7caad-62c0-49cf-8a7a-d7923ec0845e
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 705
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "68":
    id: "68"
    taskid: fffbca86-39d8-4cf1-863f-1cce9697bcce
    type: title
    task:
      id: fffbca86-39d8-4cf1-863f-1cce9697bcce
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "69":
    id: "69"
    taskid: e38561f6-223a-4619-8d75-209baad17639
    type: title
    task:
      id: e38561f6-223a-4619-8d75-209baad17639
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2965
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "70":
    id: "70"
    taskid: 95a49ce9-5339-4672-8cc7-792349b331a2
    type: title
    task:
      id: 95a49ce9-5339-4672-8cc7-792349b331a2
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "78":
    id: "78"
    taskid: 46accbf3-34f3-4002-8bfb-54b917c8d6f6
    type: condition
    task:
      id: 46accbf3-34f3-4002-8bfb-54b917c8d6f6
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "18"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: CarbonBlackDefense.Policy
                accessor: name
            iscontext: true
          right:
            value:
              simple: Demisto test1 after update policy
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1740
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "79":
    id: "79"
    taskid: fe5870a6-978b-46c6-8742-d7a6194a253a
    type: regular
    task:
      id: fe5870a6-978b-46c6-8742-d7a6194a253a
      version: -1
      name: cbd-device-unquarantine
      description: Unquarantine the device
      script: '|||cbd-device-unquarantine'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      device_id:
        complex:
          root: inputs.our_sensor
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "81":
    id: "81"
    taskid: 34871f68-c03e-4f6b-8593-dc97b21e0516
    type: regular
    task:
      id: 34871f68-c03e-4f6b-8593-dc97b21e0516
      version: -1
      name: cbd-alerts-search
      description: Alert search request. Multiple pathways support similar request
        body schemas. (CbAnalytics/devicecontrol/all)
      script: '|||cbd-alerts-search'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "82"
    scriptarguments:
      category: {}
      device_id:
        complex:
          root: inputs.our_sensor
      device_username: {}
      first_event_time: {}
      policy_id: {}
      process_sha256: {}
      query: {}
      reputation: {}
      rows:
        simple: "1"
      start: {}
      tag: {}
      type: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 515
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "82":
    id: "82"
    taskid: 5aa64158-7e3b-4e32-88bc-7ef18ff2d6ef
    type: condition
    task:
      id: 5aa64158-7e3b-4e32-88bc-7ef18ff2d6ef
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "2"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: CarbonBlackDefense.Alert
                accessor: id
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "83":
    id: "83"
    taskid: 1dd42e01-cc55-4105-8b80-642c99e9b464
    type: playbook
    task:
      id: 1dd42e01-cc55-4105-8b80-642c99e9b464
      version: -1
      name: Carbon Black Defense Find Events
      playbookName: Carbon Black Defense Find Events
      type: playbook
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "85"
    separatecontext: true
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 515
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "84":
    id: "84"
    taskid: fb813e0c-5e3b-4e7b-8b7c-c331bcb273d3
    type: condition
    task:
      id: fb813e0c-5e3b-4e7b-8b7c-c331bcb273d3
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "17"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: CarbonBlackDefense.Policy
                accessor: name
            iscontext: true
          right:
            value:
              simple: Demisto test1 after set policy
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "85":
    id: "85"
    taskid: 48f3927d-cea0-4999-80ea-fe790a706e44
    type: playbook
    task:
      id: 48f3927d-cea0-4999-80ea-fe790a706e44
      version: -1
      name: Carbon Black Defense Find Event Details
      playbookName: Carbon Black Defense Find Event Details
      type: playbook
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "68"
    separatecontext: true
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "86":
    id: "86"
    taskid: 2131df07-bc01-4a6e-87ab-74beb600fc37
    type: playbook
    task:
      id: 2131df07-bc01-4a6e-87ab-74beb600fc37
      version: -1
      name: Carbon Black Defense Find Processes
      playbookName: Carbon Black Defense Find Processes
      type: playbook
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "67"
    separatecontext: true
    view: |-
      {
        "position": {
          "x": 910,
          "y": 515
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "87":
    id: "87"
    taskid: 86c145e1-c916-4763-8c62-76b637d386d0
    type: title
    task:
      id: 86c145e1-c916-4763-8c62-76b637d386d0
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2980,
        "width": 2100,
        "x": 50,
        "y": 50
      }
    }
  }
inputs:
- key: our_sensor
  value:
    simple: "3925348"
  required: true
  description: ""
  playbookInputQuery:
- key: default_policy
  value:
    simple: "6525"
  required: true
  description: ""
  playbookInputQuery:
- key: sensor_version
  value:
    simple: '{ "OTHER": "1.2.3.4" }'
  required: true
  description: ""
  playbookInputQuery:
outputs: []
fromversion: 5.5.0
description: A test playbook of the Carbon Black v2 pack
