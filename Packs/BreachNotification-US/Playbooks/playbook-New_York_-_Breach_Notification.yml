id: New York - Breach Notification
version: -1
name: New York - Breach Notification
description: "This playbook helps an analyst determine if the breached data meets\
  \ the criteria for breach notification according to New York State law, and, if necessary,\
  \ follows through with the notification procedures. \n\nDISCLAIMER: Please consult\
  \ with your legal team before implementing this playbook.\n\n**Sources:** \nhttps://ag.ny.gov/internet/data-breach\n\
  https://www.dos.ny.gov/consumerprotection/pdf/infosecbreach03.pdf\nhttps://www.nysenate.gov/legislation/laws/GBS/899-AA"
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 7b3a65d0-fec2-4bc7-87da-c466d923d5ad
    type: start
    task:
      id: 7b3a65d0-fec2-4bc7-87da-c466d923d5ad
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "45"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 930,
          "y": -790
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "1":
    id: "1"
    taskid: 0832ce89-e35a-4fa4-8c09-c4f5ed8f472b
    type: collection
    task:
      id: 0832ce89-e35a-4fa4-8c09-c4f5ed8f472b
      version: -1
      name: Notify DPO of suspected data breach
      description: Notifies the Data Protection Officer of a suspected data breach.
      type: collection
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "66"
    reputationcalc: 1
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 300,
          "y": -80
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to:
        simple: ${incident.dpoemailaddress}
      subject:
        simple: Suspected Data Breach in your organization
      body:
        simple: "Hello,\nA suspected data breach has occurred in your organization\
          \ and requires your attention.\n\nData breach details:\n\nCompany: ${inputs.CompanyName}\n\
          State: ${incident.statewherethebreachtookplace}\nDate/Time: ${incident.datetimeofthebreach}\n\
          Affected data type: ${incident.affecteddata}\nApprox. # of affected data\
          \ subjects: ${incident.approximatenumberofaffecteddatasubjects}\nData encryption\
          \ status: ${incident.dataencryptionstatus}\nWhere data is hosted: ${incident.whereisdatahosted}\n\
          The suspected cause of the breach: ${incident.possiblecauseofthebreach}\n\
          If the cause is malicious, the specific reason might have been: ${incident.maliciouscauseifthecauseisamaliciousattack}.\n\
          \nRefer to the Senate or the Attorney General sites for more details about\
          \ the notification process: \nhttps://www.nysenate.gov/legislation/laws/GBS/899-AA\n\
          https://ag.ny.gov/internet/data-breach${incident.statewherethebreachtookplace}\n\
          \nPlease complete the following form to continue the data breach investigation.\
          \ \n"
      methods:
      - email
      format: ""
      bcc:
      cc:
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
      replyOptions:
      - "Yes"
      - "No"
    form:
      questions:
      - id: "0"
        label: ""
        labelarg:
          simple: In your assessment, does the breach involve the personal data of
            living individuals?
        required: true
        gridcolumns: []
        defaultrows: []
        type: singleSelect
        options:
        - "Yes"
        - "No"
        fieldassociated: ""
        placeholder: ""
        tooltip: If the answer is 'Yes', the breach will be documented. Please fill
          out the following questions.
        readonly: false
      - id: "1"
        label: ""
        labelarg:
          simple: How likely is it that the breach will result in a risk to individuals?
        required: true
        gridcolumns: []
        defaultrows: []
        type: singleSelect
        options:
        - Likely
        - Unlikely
        fieldassociated: ""
        placeholder: ""
        tooltip: Risk - The resulting risk of the impact of the breach on individuals.
          When assessing the risk to individuals as a result of a breach, the DPO
          should consider the specific circumstances of the breach, including the
          severity of the potential impact and the likelihood of this occurring. If
          the answer is 'Likely' to result in a risk to individuals, please fill out
          the next question, and the section regarding the information for the breach
          report.
        readonly: false
      - id: "2"
        label: ""
        labelarg:
          simple: Are you aware of the cause of the breach?
        required: true
        gridcolumns: []
        defaultrows: []
        type: multiSelect
        options:
        - ""
        - Malicious attack - internal
        - Malicious attack - external
        - Accident (system failure)
        - Negligence (human error)
        - Other
        fieldassociated: ""
        placeholder: ""
        tooltip: ""
        readonly: false
      - id: "3"
        label: ""
        labelarg:
          simple: If a result of a malicious attack, what caused the breach?
        required: true
        gridcolumns: []
        defaultrows: []
        type: multiSelect
        options:
        - ""
        - Unknown vulnerability
        - Cryptolockers
        - Fire reconnaissance
        - Phishing
        - Distributed denial of service
        - Malware
        - Social engineering
        - Blackmail
        - Other
        fieldassociated: ""
        placeholder: ""
        tooltip: ""
        readonly: false
      - id: "4"
        label: ""
        labelarg:
          simple: What is the likely impact of the breach?
        required: true
        gridcolumns: []
        defaultrows: []
        type: multiSelect
        options:
        - ""
        - Data publication
        - Data theft
        - Identity theft or fraud
        - Loss of data
        - Loss of confidentiality of personal data
        - Property damage
        - Direct financial loss
        - Business interruption
        - Liability issues
        - Damage to the reputation
        - Other
        fieldassociated: ""
        placeholder: ""
        tooltip: 'A data protection impact assessment (...) shall in particular be
          required in the case of: (a) a systematic and extensive evaluation of personal
          aspects relating to natural persons which is based on automated processing,
          including profiling, and on which decisions are based that produce legal
          effects concerning the natural person or similarly significantly affect
          the natural person; (b) processing on a large scale of special categories
          of data referred to in Article 9(1), or of personal data relating to criminal
          convictions and offences referred to in Article 10; or (c) a systematic
          monitoring of a publicly accessible area on a large scale. - GDPR Art. 35'
        readonly: false
      - id: "5"
        label: ""
        labelarg:
          simple: |-
            What measures have been taken to mitigate the adverse effects of the
            breach?
        required: false
        gridcolumns: []
        defaultrows: []
        type: longText
        options: []
        fieldassociated: ""
        placeholder: ""
        tooltip: (d) describe the measures taken or proposed to be taken by the DPO
          to address the personal data breach, including, where appropriate, measures
          to mitigate its possible adverse effects." - GDPR Art. 33
        readonly: false
      - id: "6"
        label: ""
        labelarg:
          simple: Country where business has its main establishment
        required: false
        gridcolumns: []
        defaultrows: []
        type: shortText
        options: []
        fieldassociated: ""
        placeholder: ""
        tooltip: ""
        readonly: false
      - id: "7"
        label: ""
        labelarg:
          simple: Additional information that is relevant to the case
        required: false
        gridcolumns: []
        defaultrows: []
        type: longText
        options: []
        fieldassociated: ""
        placeholder: ""
        tooltip: ""
        readonly: false
      - id: "8"
        label: ""
        labelarg:
          simple: Company Size - number of employees
        required: false
        gridcolumns: []
        defaultrows: []
        type: singleSelect
        options:
        - 1-9
        - 10-49
        - 50-249
        - 250 - 749
        - 750-1000
        - '> 1000'
        fieldassociated: ""
        placeholder: ""
        tooltip: ""
        readonly: false
      - id: "9"
        label: ""
        labelarg:
          simple: What the residents should do
        required: false
        gridcolumns: []
        defaultrows: []
        type: longText
        options: []
        fieldassociated: ""
        placeholder: ""
        tooltip: ""
        readonly: false
      title: Suspected PII data breach
      description: Suspected PII data breach was found in your organization
      sender: Your SOC team
      expired: false
      totalanswers: 0
  "2":
    id: "2"
    taskid: d74d4bdb-1e1b-4820-859c-45700ae405a4
    type: condition
    task:
      id: d74d4bdb-1e1b-4820-859c-45700ae405a4
      version: -1
      name: DPO confirmed the breach
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "47"
      "yes":
      - "46"
    separatecontext: false
    defaultassigneecomplex:
      simple: ${Suspected PII data breach.Answers.0}
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Suspected PII data breach
                accessor: Answers.0
            iscontext: true
          right:
            value:
              simple: "Yes"
    view: |-
      {
        "position": {
          "x": 300,
          "y": 290
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "9":
    id: "9"
    taskid: 76b75121-29a3-4a04-8c2a-9a7cd622616a
    type: title
    task:
      id: 76b75121-29a3-4a04-8c2a-9a7cd622616a
      version: -1
      name: Breach documentation process
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "15"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 530,
          "y": 1020
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "15":
    id: "15"
    taskid: 26c59205-51db-4d49-8f96-493adfb89b73
    type: regular
    task:
      id: 26c59205-51db-4d49-8f96-493adfb89b73
      version: -1
      name: Generate breach report
      description: |-
        A script that automatically generates an investigation summary report. The script can also be used
        in a post-processing workflow.
      scriptName: GenerateInvestigationSummaryReport
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      incidentId:
        simple: ${incident.id}
      name: {}
      type: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 530,
          "y": 1160
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "20":
    id: "20"
    taskid: bdf57866-a298-49ac-8c67-12501dc9658a
    type: title
    task:
      id: bdf57866-a298-49ac-8c67-12501dc9658a
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1180,
          "y": 2820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "25":
    id: "25"
    taskid: b99c1b07-7c3a-4efc-8633-4309a22a754d
    type: regular
    task:
      id: b99c1b07-7c3a-4efc-8633-4309a22a754d
      version: -1
      name: Upload and submit the report to New York attorney general
      description: |-
        The Information Security Breach and Notification Act requires that the state entity or business notify the Attorney General’s office, the NYS Department of State's Division of Consumer Protection and the NYS Office of Cyber Security & Critical Infrastructure Coordination of the timing, content and distribution of the notices and approximate number of affected persons.  Breached entities may provide notice online to all three entities through the Attorney Generals.
        Submit the report to https://formsnym.ag.ny.gov/OAGOnlineSubmissionForm/faces/OAGSBHome

        **Source: https://ag.ny.gov/internet/data-breach.
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "57"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 530,
          "y": 2155
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "29":
    id: "29"
    taskid: a4f642ac-3aa3-4c8c-8df1-c59e97d236e6
    type: title
    task:
      id: a4f642ac-3aa3-4c8c-8df1-c59e97d236e6
      version: -1
      name: DPO updates report
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "30"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 220,
          "y": 1690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "30":
    id: "30"
    taskid: e94a88d1-0b4c-41e5-8bfe-d8755ad39651
    type: regular
    task:
      id: e94a88d1-0b4c-41e5-8bfe-d8755ad39651
      version: -1
      name: Get new report from DPO
      description: manual task - ask user to send a new report
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "33"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 220,
          "y": 1830
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "33":
    id: "33"
    taskid: 2d16714a-625b-45b5-86fa-d258c42181e4
    type: title
    task:
      id: 2d16714a-625b-45b5-86fa-d258c42181e4
      version: -1
      name: Contact authorities
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "25"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 530,
          "y": 2010
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "36":
    id: "36"
    taskid: eeab4cf8-6f7c-4249-805b-323ec2bbf1ee
    type: regular
    task:
      id: eeab4cf8-6f7c-4249-805b-323ec2bbf1ee
      version: -1
      name: Send report for DPO approval
      script: '|||send-mail'
      type: regular
      iscommand: true
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "37"
    scriptarguments:
      attachCIDs: {}
      attachIDs:
        simple: ${Report.FileID}
      attachNames:
        simple: ${Report.Name}
      bcc: {}
      body:
        simple: This is the data breach report generated from Cortex XSOAR.
      cc: {}
      htmlBody: {}
      replyTo: {}
      subject:
        simple: Generated data breach report from Cortex XSOAR
      to:
        simple: ${incident.dpoemailaddress}
      transientFile: {}
      transientFileContent: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 530,
          "y": 1340
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "37":
    id: "37"
    taskid: 8242f2fd-eb00-4c3d-8700-16d214a6dd59
    type: condition
    task:
      id: 8242f2fd-eb00-4c3d-8700-16d214a6dd59
      version: -1
      name: Get DPO Approval for the report
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      "No":
      - "29"
      "Yes":
      - "33"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 530,
          "y": 1515
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to:
        simple: ${incident.dpoemailaddress}
      subject:
        simple: 'Data Breach report approval '
      body:
        simple: |-
          Hello,

          Please specify if you approve sending the data breach report to the Attorney General's office.

          To approve sending the data breach report generated from Cortex XSOAR, click Yes.

          To decline sending the data breach report generated from Cortex XSOAR, click No.
          If you decline to send the report, please generate a new report and forward it to your SOC team.
      methods:
      - email
      format: ""
      bcc:
      cc:
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
      replyOptions:
      - "Yes"
      - "No"
  "45":
    id: "45"
    taskid: 5517479d-fb34-4c7e-83a4-79d0cec27ed4
    type: condition
    task:
      id: 5517479d-fb34-4c7e-83a4-79d0cec27ed4
      version: -1
      name: Is PII compromised?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "47"
      "yes":
      - "68"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Analyst review
                filters:
                - - operator: isNotEmpty
                    left:
                      value:
                        simple: Analyst review.Answers.1
                      iscontext: true
                accessor: Answers.0
            iscontext: true
          right:
            value:
              simple: "True"
        - operator: isEqualString
          left:
            value:
              complex:
                root: incident
                accessor: financialinformationbreached
            iscontext: true
          right:
            value:
              simple: "True"
        - operator: isEqualString
          left:
            value:
              complex:
                root: incident
                accessor: accountinformationbreached
            iscontext: true
          right:
            value:
              simple: "True"
        - operator: isEqualString
          left:
            value:
              complex:
                root: incident
                accessor: uniquebiometricdatabreached
            iscontext: true
          right:
            value:
              simple: "True"
        - operator: isEqualString
          left:
            value:
              complex:
                root: incident
                accessor: uniqueidentificationnumberbreached
            iscontext: true
          right:
            value:
              simple: "True"
        - operator: isEqualString
          left:
            value:
              complex:
                root: incident
                accessor: otherpiidatabreached
            iscontext: true
          right:
            value:
              simple: "True"
    view: |-
      {
        "position": {
          "x": 930,
          "y": -630
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "46":
    id: "46"
    taskid: d7f34ae3-c314-4355-848b-1115601331f3
    type: title
    task:
      id: d7f34ae3-c314-4355-848b-1115601331f3
      version: -1
      name: PII Breach Notification required
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "53"
      - "55"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 300,
          "y": 520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "47":
    id: "47"
    taskid: bd37e415-6f39-447e-80cb-d0677162cb32
    type: title
    task:
      id: bd37e415-6f39-447e-80cb-d0677162cb32
      version: -1
      name: No breach has occurred
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "70"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 930,
          "y": 520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "49":
    id: "49"
    taskid: 8f5a60b3-db0e-470f-827a-78f31b4c67f0
    type: regular
    task:
      id: 8f5a60b3-db0e-470f-827a-78f31b4c67f0
      version: -1
      name: Analyst review
      description: |
        The breach does not contain New York resident information. Please review which state information the breach contains, and start measures according to the laws of that particular state.
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "69"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1380,
          "y": -80
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "51":
    id: "51"
    taskid: 55e6300e-b0fb-445d-8542-c01c0b5160fd
    type: condition
    task:
      id: 55e6300e-b0fb-445d-8542-c01c0b5160fd
      version: -1
      name: Does breach contain New York resident information?
      description: |-
        New York breach notification laws come into effect only if data of New York residents has been breached.
        If data of New York residents has been breached, continue the investigation.
        If not, decide on a further course of action.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "No":
      - "49"
      "Yes":
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 660,
          "y": -270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "53":
    id: "53"
    taskid: eeb76f8f-cd99-4247-84a3-8c5c86c726b2
    type: regular
    task:
      id: eeb76f8f-cd99-4247-84a3-8c5c86c726b2
      version: -1
      name: Notify management with the severity of data breach
      description: "Management to be included:\n•\tCISO\n•\tPrivacy officer\n•\tData\
        \ Protection Officer (DPO) \n•\tOrganization legal VP\n•\tMarketing VP\n•\t\
        Accounting VP\n•\tPublic relations VP\n•\tOrganization’s external legal adviser\n\
        This may change according to organizational policy."
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 530,
          "y": 670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "55":
    id: "55"
    taskid: 125fe20b-467c-4155-8750-af51d7fb1c2f
    type: condition
    task:
      id: 125fe20b-467c-4155-8750-af51d7fb1c2f
      version: -1
      name: Does law enforcement require delaying breach notification?
      description: |-
        According to New York law, breach notification may be delayed if a law enforcement agency determines that the notification will impede a criminal investigation.

        **Source: http://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CIV&sectionNum=1798.82.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "No":
      - "9"
      "Yes":
      - "56"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 90,
          "y": 670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "56":
    id: "56"
    taskid: 62782a7d-eb04-4266-8fb7-74417a257339
    type: regular
    task:
      id: 62782a7d-eb04-4266-8fb7-74417a257339
      version: -1
      name: Wait to hear back from law enforcement
      type: regular
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "9"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -130,
          "y": 840
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "57":
    id: "57"
    taskid: 81ee7ad8-0201-4c2a-8c00-7721dcfa4aba
    type: condition
    task:
      id: 81ee7ad8-0201-4c2a-8c00-7721dcfa4aba
      version: -1
      name: Checks number of affected data subjects
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      Less than 5000:
      - "20"
      More than 5000:
      - "71"
    separatecontext: false
    conditions:
    - label: More than 5000
      condition:
      - - operator: greaterThanOrEqual
          left:
            value:
              complex:
                root: incident
                filters:
                - - operator: isNotEmpty
                    left:
                      value:
                        simple: incident.approximatenumberofaffecteddatasubjects
                      iscontext: true
                accessor: approximatenumberofaffecteddatasubjects
            iscontext: true
          right:
            value:
              simple: "5000"
    - label: Less than 5000
      condition:
      - - operator: lessThan
          left:
            value:
              complex:
                root: incident
                filters:
                - - operator: isNotEmpty
                    left:
                      value:
                        simple: incident.approximatenumberofaffecteddatasubjects
                      iscontext: true
                accessor: approximatenumberofaffecteddatasubjects
            iscontext: true
          right:
            value:
              simple: "5000"
    view: |-
      {
        "position": {
          "x": 530,
          "y": 2330
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "66":
    id: "66"
    taskid: 55214d65-e142-4735-8b4c-6ed0f82765a9
    type: regular
    task:
      id: 55214d65-e142-4735-8b4c-6ed0f82765a9
      version: -1
      name: Update incident with DPO answers
      description: Collects the answers provided by the DPO in the Notify DPO of suspected data breach data collection task and adds them to the context.
      script: Builtin|||setIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      accountgroups: {}
      accountid: {}
      accountinformationbreached: {}
      accountname: {}
      activedirectoryaccountstatus: {}
      activedirectorydisplayname: {}
      activedirectorypasswordstatus: {}
      addLabels: {}
      affecteddata: {}
      affecteddatatype: {}
      affectedindividualscontactinformation:
        complex:
          root: Suspected PII data breach
          filters:
          - - operator: isNotEmpty
              left:
                value:
                  simple: Suspected PII data breach.Answers.1
                iscontext: true
          accessor: Answers.1
      agentid: {}
      app: {}
      approximatenumberofaffecteddatasubjects: {}
      assetid: {}
      associatedmaliciousdomains: {}
      attachmentcount: {}
      attachmentextension: {}
      attachmenthash: {}
      attachmentid: {}
      attachmentname: {}
      attachmentsize: {}
      attachmenttype: {}
      attackerhostisolated: {}
      attackeripblocked: {}
      attackerusername: {}
      blockedaction: {}
      bpareport: {}
      bugtraq: {}
      city: {}
      clarotyalertresolved: {}
      clarotyalerttype: {}
      clarotycategory: {}
      clarotynetworkid: {}
      clarotyrelatedassets: {}
      clarotyresourceid: {}
      clarotysiteid: {}
      closeNotes: {}
      closeReason: {}
      code42alerttype: {}
      code42fileevents: {}
      commandline: {}
      companyaddress:
        complex:
          root: inputs.CompanyAddress
      companycity:
        complex:
          root: inputs.CompanyCity
      companycountry:
        complex:
          root: inputs.CompanyCountry
      companyhasinsuranceforthebreach: {}
      companyname: {}
      companypostalcode: {}
      companypropertystatus: {}
      contactaddress: {}
      contactemailaddress: {}
      contactname:
        complex:
          root: inputs.ContactName
      contacttelephonenumber: {}
      coordinates: {}
      country: {}
      countrywherebusinesshasitsmainestablishment: {}
      countrywherethebreachtookplace: {}
      criticalassets: {}
      customFields: {}
      cve: {}
      cvss: {}
      cymulateimmediatethreatsattackid: {}
      cymulateimmediatethreatsfiletype: {}
      cymulateimmediatethreatsid: {}
      cymulateimmediatethreatsmitigations: {}
      cymulateimmediatethreatsmodule: {}
      cymulateimmediatethreatspayloadname: {}
      cymulateimmediatethreatsstatus: {}
      cymulateimmediatethreatsvector: {}
      dataencryptionstatus: {}
      datetimeofthebreach: {}
      dbotprediction: {}
      dbotpredictionprobability: {}
      dbottextsuggestionhighlighted: {}
      deleteEmptyField: {}
      dest: {}
      desthostname: {}
      destinationip: {}
      destinationports: {}
      destntdomain: {}
      destos: {}
      details: {}
      detectionendtime: {}
      detectionid: {}
      detectionticketed: {}
      detectionupdatetime: {}
      detectionurl: {}
      devicegsuiteaccountstatus: {}
      devicename: {}
      dpoemailaddress: {}
      duoaccountstatus: {}
      duration: {}
      email: {}
      emailaddress: {}
      emailauthenticitycheck: {}
      emailautoreply: {}
      emailbcc: {}
      emailbody: {}
      emailbodyformat: {}
      emailbodyhtml: {}
      emailcc: {}
      emailclassification: {}
      emailclientname: {}
      emailfrom: {}
      emailheaders: {}
      emailheaders2: {}
      emailhtml: {}
      emailinreplyto: {}
      emailkeywords: {}
      emailmessageid: {}
      emailreceived: {}
      emailreplyto: {}
      emailreturnpath: {}
      emailsenderip: {}
      emailsize: {}
      emailsource: {}
      emailsubject: {}
      emailto: {}
      emailtocount: {}
      emailurlclicked: {}
      employeedisplayname: {}
      employeeemail: {}
      employeemanageremail: {}
      exactlywhathappenedandatwhattimes: {}
      exfiltratedfiles: {}
      expanseexposuretype: {}
      expanserawjsonevent: {}
      expanseseverity: {}
      extrahopapplianceid: {}
      extrahophostname: {}
      filehash: {}
      filehashblocked: {}
      filename: {}
      filepath: {}
      filesize: {}
      financialinformationbreached: {}
      firstseen: {}
      globaldirectoryvisibility: {}
      googleaccountstatus: {}
      googleadminrolesstatus: {}
      googledisplayname: {}
      googledrivestatus: {}
      googlemailstatus: {}
      googlepasswordstatus: {}
      grid: {}
      healthinsurancebreached: {}
      helloworldid: {}
      helloworldstatus: {}
      helloworldtype: {}
      hostname: {}
      howcouldinformationsharingwithotherorganizationshavebeenimproved: {}
      howwastheincidentcontainedanderadicated: {}
      howwelldidstaffandmanagementperformindealingwiththeincidentwerethedocumentedproceduresfollowedweretheyadequate: {}
      id: {}
      illusionblackattackerid: {}
      illusionblackattacktype: {}
      illusionblackdecoyid: {}
      illusionblackevents: {}
      illusionblackthreatparse: {}
      indenideviceid: {}
      indeniissueid: {}
      infectedhostnames: {}
      infectedhosts: {}
      investigationstage: {}
      isolated: {}
      isthedatasubjecttodpia: {}
      labels: {}
      lastmodifiedby: {}
      lastmodifiedon: {}
      lastseen: {}
      likelyimpact: {}
      loginattemptcount: {}
      macaddress: {}
      mailboxdelegation: {}
      maliciousbehavior: {}
      maliciouscauseifthecauseisamaliciousattack:
        complex:
          root: Suspected PII data breach
          accessor: Answers.3
      maliciousdomainsblocked: {}
      malwarefamily: {}
      manageremail: {}
      markdowntest: {}
      measurestomitigate:
        complex:
          root: Suspected PII data breach
          filters:
          - - operator: isNotEmpty
              left:
                value:
                  simple: Suspected PII data breach.Answers.5
                iscontext: true
          accessor: Answers.5
      medicalinformationbreached: {}
      name: {}
      niststage: {}
      numberofports: {}
      numberofuniqueports: {}
      occurred: {}
      offboardingdate: {}
      offboardingstage: {}
      oktaaccountstatus: {}
      otherpiidatabreached: {}
      owner: {}
      parentprocessid: {}
      participants: {}
      passwordexpirationstatus: {}
      penteraoperationdetails: {}
      phase: {}
      phishingsubtype: {}
      pid: {}
      policydeleted: {}
      policydescription: {}
      policydetails: {}
      policyid: {}
      policyrecommendation: {}
      policyremediable: {}
      policyseverity: {}
      policytype: {}
      portsblocked: {}
      portscantimestamp: {}
      possiblecauseofthebreach:
        complex:
          root: Suspected PII data breach
          accessor: Answers.2
      postalcode: {}
      previouscoordinates: {}
      previouscountry: {}
      previoussignindatetime: {}
      previoussourceip: {}
      prismacloudcomputeactivitytype: {}
      prismacloudcomputeappid: {}
      prismacloudcomputecategory: {}
      prismacloudcomputecollections: {}
      prismacloudcomputecommand: {}
      prismacloudcomputecontainer: {}
      prismacloudcomputecredentialid: {}
      prismacloudcomputedistribution: {}
      prismacloudcomputeerror: {}
      prismacloudcomputeforensic: {}
      prismacloudcomputefqdn: {}
      prismacloudcomputefunction: {}
      prismacloudcomputehost: {}
      prismacloudcomputeimage: {}
      prismacloudcomputeinteractive: {}
      prismacloudcomputekubernetesresource: {}
      prismacloudcomputelabels: {}
      prismacloudcomputeline: {}
      prismacloudcomputelogfile: {}
      prismacloudcomputemarkdown: {}
      prismacloudcomputemessage: {}
      prismacloudcomputeproject: {}
      prismacloudcomputeprotected: {}
      prismacloudcomputeprovider: {}
      prismacloudcomputerawalertjson: {}
      prismacloudcomputeregion: {}
      prismacloudcomputeregistry: {}
      prismacloudcomputerule: {}
      prismacloudcomputeruntime: {}
      prismacloudcomputeservice: {}
      prismacloudcomputeservicetype: {}
      prismacloudcomputetotal: {}
      prismacloudcomputetype: {}
      prismacloudcomputeuser: {}
      prismacloudid: {}
      prismacloudreason: {}
      prismacloudrules: {}
      prismacloudstatus: {}
      prismacloudtime: {}
      rating: {}
      rawparticipants: {}
      region: {}
      regionid: {}
      replacePlaybook: {}
      reporteremailaddress: {}
      residentnotificationoption: {}
      residentsemailaddress: {}
      resourceapiname: {}
      resourcecloudtype: {}
      resourceid: {}
      resourcename: {}
      resourcetype: {}
      riskrating: {}
      riskscore: {}
      roles: {}
      rrn: {}
      samaccountname: {}
      sansstage: {}
      scansourcetype: {}
      sectorofaffectedparty: {}
      severity: {}
      signature: {}
      signindatetime: {}
      sixgillalertid: {}
      sixgillcontent: {}
      sixgillthreatlevel: {}
      sixgillthreattype: {}
      sizenumberofemployees: {}
      sizeturnover: {}
      skuname: {}
      skutier: {}
      sla: {}
      slaField: {}
      sourcehostname: {}
      sourceip: {}
      sourceusername: {}
      src: {}
      srchostname: {}
      srcntdomain: {}
      srcos: {}
      srcuser: {}
      statewherethebreachtookplace: {}
      subscriptionassignedby: {}
      subscriptioncreatedby: {}
      subscriptioncreatedon: {}
      subscriptiondescription: {}
      subscriptionid: {}
      subscriptionname: {}
      subscriptiontype: {}
      subscriptionupdatedby: {}
      subscriptionupdatedon: {}
      subtype: {}
      successfullogin: {}
      suggestionsanddiscussionofhowtoimprovetheteam: {}
      systemdefault: {}
      systems: {}
      targetfirewallversion: {}
      telephoneno: {}
      terminatedaction: {}
      threatactor: {}
      trapsid: {}
      travelmaplink: {}
      triggeredsecurityprofile: {}
      type: {}
      uniquebiometricdatabreached: {}
      uniqueidentificationnumberbreached: {}
      urlsslverification: {}
      user: {}
      useraccountcontrol: {}
      userdisabledstatus: {}
      username: {}
      vendorid: {}
      vendorproduct: {}
      vpcid: {}
      vulnerabilitycategory: {}
      wereanystepsoractionstakenthatmighthaveinhibitedtherecovery: {}
      whatadditionaltoolsorresourcesareneededtodetectanalyzeandmitigatefutureincidents: {}
      whataretheareasthatneedimprovement: {}
      whatcorrectiveactionscanpreventsimilarincidentsinthefuture: {}
      whatinformationwasneededsooner: {}
      whatprecursorsorindicatorsshouldbewatchedforinthefuturetodetectsimilarincidents: {}
      whatwasthescopeoftheincident: {}
      whatwastheworkperformedduringrecovery: {}
      whatweretheareaswherethecirtteamswereeffective: {}
      whatwouldthestaffandmanagementdodifferentlythenexttimeasimilarincidentoccurs: {}
      whenwastheproblemfirstdetectedandbywhom: {}
      whereisdatahosted: {}
      xdralertcount: {}
      xdralerts: {}
      xdrassigneduseremail: {}
      xdrassigneduserprettyname: {}
      xdrdescription: {}
      xdrdetectiontime: {}
      xdrfileartifacts: {}
      xdrhighseverityalertcount: {}
      xdrhostcount: {}
      xdrincidentid: {}
      xdrlowseverityalertcount: {}
      xdrmediumseverityalertcount: {}
      xdrnetworkartifacts: {}
      xdrnotes: {}
      xdrresolvecomment: {}
      xdrstatus: {}
      xdrurl: {}
      xdrusercount: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 300,
          "y": 100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    fieldMapping:
    - incidentfield: Contact Email address
      output:
        simple: ${inputs.ContactEmailAddress}
    - incidentfield: Contact Telephone number
      output:
        simple: ${inputs.ContactTelNumber}
    - incidentfield: Contact Name
      output:
        simple: ${inputs.ContactName}
    - incidentfield: Company Name
      output:
        simple: ${inputs.CompanyName}
    - incidentfield: Company Address
      output:
        simple: ${inputs.CompanyAddress}
  "68":
    id: "68"
    taskid: 844dab16-a1d0-4cf4-82be-f27373b410a3
    type: regular
    task:
      id: 844dab16-a1d0-4cf4-82be-f27373b410a3
      version: -1
      name: Set PII compromised flag
      description: Store the fact that PII was compromised.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "51"
    scriptarguments:
      append: {}
      key:
        simple: PIICompromised
      stringify: {}
      value:
        simple: "True"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 660,
          "y": -450
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "69":
    id: "69"
    taskid: 9873def7-32af-40d7-85ea-fbecc0bb29e6
    type: title
    task:
      id: 9873def7-32af-40d7-85ea-fbecc0bb29e6
      version: -1
      name: Breach does not contain New York residents
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "70"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1380,
          "y": 520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "70":
    id: "70"
    taskid: 3e7fb49f-465c-4f72-8ff0-8fcc551b80da
    type: regular
    task:
      id: 3e7fb49f-465c-4f72-8ff0-8fcc551b80da
      version: -1
      name: Set PII wasn't compromised flag
      description: Store the fact that PII was not compromised.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: PIICompromised
      stringify: {}
      value:
        simple: "False"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1170,
          "y": 680
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "71":
    id: "71"
    taskid: 040c7bb9-ebf3-48b2-80a8-56c4ca600601
    type: title
    task:
      id: 040c7bb9-ebf3-48b2-80a8-56c4ca600601
      version: -1
      name: Report consumer reporting agencies
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "72"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 150,
          "y": 2500
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "72":
    id: "72"
    taskid: d2181042-24d9-4e06-87c0-def2185c8367
    type: regular
    task:
      id: d2181042-24d9-4e06-87c0-def2185c8367
      version: -1
      name: Send report to consumer reporting agencies
      description: |-
        If more than 5,000 New York residents are to be notified, consumer reporting agencies must be notified too. The contact information for the three nationwide consumer reporting agencies is as follows:

        - EQUIFAX
        Equifax:
        Consumer Fraud Division
        P.O. Box 740256
        Atlanta, GA 30374
        800-525-6285
        security.dataadministration@equifax.com
        - EXPERIAN
        Consumer Fraud Assistance
        P.O. Box 9556
        Allen, TX 75013
        888-397-3742
        businessrecordsvictimassistance@experian.com
        - TRANSUNION
        Fraud Victim Assistance Department
        P.O. Box 2000 Chester, PA 19016-2000
        Phone: 800-680-7289
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 150,
          "y": 2630
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
view: |-
  {
    "linkLabelsPosition": {
      "2_46_yes": 0.57,
      "2_47_#default#": 0.12,
      "37_29_No": 0.33,
      "37_33_Yes": 0.24,
      "45_47_#default#": 0.11,
      "45_68_yes": 0.43,
      "51_1_Yes": 0.26,
      "51_49_No": 0.14,
      "55_56_Yes": 0.35,
      "55_9_No": 0.18,
      "57_20_Less than 5000": 0.16,
      "57_71_More than 5000": 0.43
    },
    "paper": {
      "dimensions": {
        "height": 3675,
        "width": 1890,
        "x": -130,
        "y": -790
      }
    }
  }
inputs:
- key: ContactName
  value: {}
  required: false
  description: In case of a breach, the contact details to send to the Attorney General
    and the affected residents.
- key: ContactEmailAddress
  value: {}
  required: false
  description: In case of a breach, the contact details to send to the Attorney General
    and the affected residents.
- key: ContactTelNumber
  value: {}
  required: false
  description: In case of a breach, the contact details to send to the Attorney General
    and the affected residents.
- key: CompanyName
  value: {}
  required: false
  description: ""
- key: CompanyAddress
  value: {}
  required: false
  description: In case of a breach, the company details to display in the breach report.
- key: CompanyCity
  value: {}
  required: false
  description: In case of a breach, the company details to display in the breach report.
- key: CompanyCountry
  value: {}
  required: false
  description: In case of a breach, the company details to display in the breach report.
outputs:
- contextPath: PIICompromised
  description: Set a flag indicating that PII has been compromised.
  type: boolean
- contextPath: HealthInsuranceBreached
  description: Set a flag indicating that the breach contains PII of health insurance
    information.
  type: unknown
- contextPath: MedicalInformationBreached
  description: Set a flag indicating that the breach contains PII of medical information.
  type: unknown
- contextPath: FinancialInformationBreached
  description: Set a flag indicating that the breach contains PII of financial information.
  type: unknown
- contextPath: AccountInformationBreached
  description: Set a flag indicating that the breach contains PII of account information.
  type: unknown
- contextPath: UniqueIdentificationNumberBreached
  description: Set a flag indicating that the breach contains PII of unique identification
    number.
  type: unknown
- contextPath: UniqueBiometricDataBreached
  description: Set a flag indicating that the breach contains PII of unique biometric
    data.
  type: unknown
- contextPath: Analyst review.Answers.1
  description: Explain, in your words, the incident origin, what you have checked,
    and any information related to this incident.
  type: longText
tests:
- No test
fromversion: 5.0.0
