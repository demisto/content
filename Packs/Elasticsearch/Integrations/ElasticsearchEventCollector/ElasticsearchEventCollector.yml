category: Database
sectionorder:
- Connect
- Collect
commonfields:
  id: ElasticsearchEventCollector
  version: -1
configuration:
- display: Server URL
  name: url
  required: true
  type: 0
  additionalinfo: The Elasticsearch server to which the integration connects. Ensure that the URL includes the correct Elasticsearch port. The default port for Elasticsearch v7 and below is 9200. Use the Server URL for on-premises deployments.
  section: Connect
- display: Authorization type
  defaultvalue: Basic auth
  additionalinfo: |-
    Select the authentication type and enter the appropriate credentials:
    - Basic Auth: Enter Username and Password.
    - Bearer Auth: Enter Username and Password.
    - API Key Auth: Enter the API Key ID and API Key.
  name: auth_type
  options:
  - Basic auth
  - Bearer auth
  - API key auth
  type: 15
  section: Connect
  required: true
- additionalinfo: Use for API key auth
  display: API key ID
  displaypassword: API Key
  name: api_key_auth_credentials
  type: 9
  section: Connect
  required: false
- additionalinfo: Use for Basic auth. Optionally you can use Username as an API key ID and Password as an API key for API Key auth.
  display: Username
  name: credentials
  type: 9
  section: Connect
  required: false
- display: Trust any certificate (not secure)
  name: insecure
  type: 8
  section: Connect
  advanced: true
  required: false
- display: Use system proxy settings
  name: proxy
  type: 8
  section: Connect
  advanced: true
  required: false
- defaultvalue: Elasticsearch
  additionalinfo: In some hosted ElasticSearch environments, the standard ElasticSearch client is not supported. If you encounter any related client issues, please consider using the OpenSearch client type.
  display: Client type
  name: client_type
  options:
  - Elasticsearch
  - OpenSearch
  - Elasticsearch_v8
  - Elasticsearch_v9
  type: 15
  section: Connect
  advanced: true
  required: false
- display: Index to fetch incidents from
  name: fetch_index
  type: 0
  section: Collect
  required: false
  additionalinfo: CSV
- display: Query String
  name: fetch_query
  type: 0
  additionalinfo: |-
    Query string uses the Lucene syntax.
    For more information about the Lucene syntax, see the link in the help section.
    The query will be used when fetching incidents. Index time field will be used as a filter in the query.
  section: Collect
  required: false
- display: Index time field
  name: fetch_time_field
  type: 0
  section: Collect
  required: false
  additionalinfo: The time field used for sorting and limiting results. If using a nested field, separate field names with dot notation.
- display: Raw Query
  name: raw_query
  type: 12
  additionalinfo: |-
    Raw Query allows raw DSL queries and will override the 'Query String' Lucene syntax string.
    Results will not be filtered or sorted. Use additional parameters in the raw query for these purposes.
    For more information see the link in the help section.
  section: Collect
  advanced: true
  required: false
- display: Time field type
  defaultvalue: 'Simple-Date'
  name: time_method
  type: 15
  options:
  - Simple-Date
  - Timestamp-Seconds
  - Timestamp-Milliseconds
  section: Collect
  advanced: true
  required: false
  additionalinfo: For more information see the explanation in the help section.
- defaultvalue: 'true'
  display: Map JSON fields into labels
  name: map_labels
  type: 8
  section: Collect
  advanced: true
  required: false
- defaultvalue: '50'
  display: The maximum number of results per fetch
  name: fetch_size
  type: 0
  section: Collect
  required: false
- display: Request timeout (in seconds).
  name: timeout
  type: 0
  defaultvalue: '60'
  section: Connect
  advanced: true
  required: false
- display: Fetch events
  name: isFetchEvents
  type: 8
  section: Collect
  required: false
description: "Search for and analyze data in real time. \n Supports version 6 and later."
display: Elasticsearch Event Collector
name: ElasticsearchEventCollector
script:
  commands:
  - arguments:
    - name: start_time
      description: Start time for fetching events. Supports ISO format ("2023-01-01T23:59:59") or natural language ("2 hours ago", "now").
      required: true
    - name: end_time
      description: End time for fetching events. Supports ISO format ("2023-01-01T23:59:59") or natural language ("2 hours ago", "now").
      required: false
    - name: time_method 
      auto: PREDEFINED
      defaultValue: 'Simple-Date'
      predefined:
      - Simple-Date
      - Timestamp-Seconds
      - Timestamp-Milliseconds
      required: true
      description: For more information see the explanation in the help section.
    - name: fetch_size
      defaultValue: '10'
      description: The maximum number of results per fetch.
      required: false
    - name: fetch_index
      required: false
      description: CSV.
    - name: fetch_time_field      
      required: true
      description: The time field used for sorting and limiting results. If using a nested field, separate field names with dot notation.
    - name: fetch_query
      description: Query string uses the Lucene syntax.
      required: false
    - name: raw_query
      type: 12
      description: Raw Query allows raw DSL queries and will override the 'Query String' Lucene syntax string.
      required: false
    description: This command is used for developing/ debugging and is to be used with caution, as it can cause the API request limit to be exceeded.
    name: es-get-events
  dockerimage: demisto/elasticsearch:1.0.0.5954979
  isfetchevents: true
  runonce: false
  script: '-'
  subtype: python3
  type: python
marketplaces:
- marketplacev2
- platform
fromversion: 8.4.0
tests:
- No tests (auto formatted)
