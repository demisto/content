category: Endpoint
commonfields:
  id: Microsoft Defender Advanced Threat Protection
  version: -1
configuration:
- defaultvalue: https://api.securitycenter.windows.com
  display: Host URL (e.g. https://api.securitycenter.windows.com)
  name: url
  required: true
  type: 0
- display: ID (received from the admin consent - see Detailed Instructions (?) section)
  name: auth_id
  required: true
  type: 4
- display: Token (received from the admin consent - see Detailed Instructions (?)
    section)
  name: tenant_id
  required: true
  type: 4
- display: Key (received from the admin consent - see Detailed Instructions (?) section)
  name: enc_key
  required: true
  type: 4
- display: Fetch incidents
  name: isFetch
  required: false
  type: 8
- display: Incident type
  name: incidentType
  required: false
  type: 13
- defaultvalue: New
  display: 'Status to filter out alerts for fetching as incidents. The property values
    are: New,InProgress,Resolved (Comma separated values supported, e.g. New,Resolved)'
  name: fetch_status
  options:
  - New
  - InProgress
  - Resolved
  required: false
  type: 16
- defaultvalue: Informational,Low,Medium,High
  display: 'Severity to filter out alerts for fetching as incidents. The property
    values are: Informational,Low,Medium,High (Comma separated values supported, e.g.
    Medium,High)'
  name: fetch_severity
  options:
  - Informational
  - Low
  - Medium
  - High
  required: false
  type: 16
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
- display: Use a self-deployed Azure Application
  name: self_deployed
  required: false
  type: 8
- defaultvalue: 3 days
  display: First fetch timestamp (<number> <time unit>, e.g., 12 hours, 7 days)
  hidden: false
  name: first_fetch_timestamp
  required: false
  type: 0
description: Microsoft Defender Advanced Threat Protection (ATP) is a unified platform
  for preventative protection, post-breach detection, automated investigation, and
  response.
display: Microsoft Defender Advanced Threat Protection
name: Microsoft Defender Advanced Threat Protection
script:
  commands:
  - arguments:
    - default: true
      description: Machine ID to be used for isolation. e.g. 0a3250e0693a109f1affc9217be9459028aa8426
      isArray: false
      name: machine_id
      required: true
      secret: false
    - default: false
      description: A comment to associate with the action.
      isArray: false
      name: comment
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Full isolation or Selective isolation (Restrict only limited set
        of applications from accessing the network)
      isArray: false
      name: isolation_type
      predefined:
      - Full
      - Selective
      required: true
      secret: false
    deprecated: false
    description: Isolates a machine from accessing external networks.
    execution: true
    name: microsoft-atp-isolate-machine
    outputs:
    - contextPath: MicrosoftATP.MachineAction.ID
      description: The machine action ID
      type: String
    - contextPath: MicrosoftATP.MachineAction.Type
      description: Type of the machine action
      type: String
    - contextPath: MicrosoftATP.MachineAction.Scope
      description: Scope of the action
      type: Unknown
    - contextPath: MicrosoftATP.MachineAction.Requestor
      description: The ID of the user that executed the action
      type: String
    - contextPath: MicrosoftATP.MachineAction.RequestorComment
      description: Comment that was written when issuing the action
      type: String
    - contextPath: MicrosoftATP.MachineAction.Status
      description: The current status of the command
      type: String
    - contextPath: MicrosoftATP.MachineAction.MachineID
      description: The machine ID on which the action was executed
      type: String
    - contextPath: MicrosoftATP.MachineAction.ComputerDNSName
      description: The machine DNS name on which the action was executed
      type: String
    - contextPath: MicrosoftATP.MachineAction.CreationDateTimeUtc
      description: The date and time when the action was created.
      type: Date
    - contextPath: MicrosoftATP.MachineAction.LastUpdateTimeUtc
      description: The last date and time when the action status was updated.
      type: Date
    - contextPath: MicrosoftATP.MachineAction.RelatedFileInfo.FileIdentifier
      description: The file identifier
      type: String
    - contextPath: MicrosoftATP.MachineAction.RelatedFileInfo.FileIdentifierType
      description: 'The type of the file identifier with the possible values: "SHA1"
        ,"SHA256" and "MD5".'
      type: String
  - arguments:
    - default: false
      description: Machine ID to be used to stop the isolation. e.g. 0a3250e0693a109f1affc9217be9459028aa8426
      isArray: false
      name: machine_id
      required: true
      secret: false
    - default: false
      description: Comment to associate with the action.
      isArray: false
      name: comment
      required: true
      secret: false
    deprecated: false
    description: Undo an isolation of a machine.
    execution: false
    name: microsoft-atp-unisolate-machine
    outputs:
    - contextPath: MicrosoftATP.MachineAction.ID
      description: The machine action ID
      type: String
    - contextPath: MicrosoftATP.MachineAction.Type
      description: Type of the action
      type: String
    - contextPath: MicrosoftATP.MachineAction.Scope
      description: Scope of the action
      type: Unknown
    - contextPath: MicrosoftATP.MachineAction.Requestor
      description: The ID of the user that executed the action
      type: String
    - contextPath: MicrosoftATP.MachineAction.RequestorComment
      description: The comment that was written when issuing the action
      type: String
    - contextPath: MicrosoftATP.MachineAction.Status
      description: The current status of the command
      type: String
    - contextPath: MicrosoftATP.MachineAction.MachineID
      description: The machine ID on which the action was executed
      type: String
    - contextPath: MicrosoftATP.MachineAction.ComputerDNSName
      description: The machine DNS name on which the action was executed
      type: String
    - contextPath: MicrosoftATP.MachineAction.CreationDateTimeUtc
      description: The date and time when the action was created
      type: Date
    - contextPath: MicrosoftATP.MachineAction.LastUpdateTimeUtc
      description: The last date and time when the action status was updated
      type: Date
    - contextPath: MicrosoftATP.MachineAction.RelatedFileInfo.FileIdentifier
      description: The fileIdentifier
      type: String
    - contextPath: MicrosoftATP.MachineAction.RelatedFileInfo.FileIdentifierType
      description: 'The type of the file identifier with the possible values: "SHA1"
        ,"SHA256" and "MD5"'
      type: String
  - arguments:
    - default: false
      description: The computer DNS name.
      isArray: false
      name: hostname
      required: false
      secret: false
    - default: false
      description: The last machine IP to access the internet.
      isArray: false
      name: ip
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: The machine risk score.
      isArray: false
      name: risk_score
      predefined:
      - Low
      - Medium
      - High
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: The machine health status.
      isArray: false
      name: health_status
      predefined:
      - Active
      - Inactive
      required: false
      secret: false
    - default: false
      description: The machine's OS platform. Only a single platform can be added.
      isArray: false
      name: os_platform
      required: false
      secret: false
    deprecated: false
    description: Retrieves a collection of machines that have communicated with WDATP
      cloud on the last 30 days.
    execution: false
    name: microsoft-atp-get-machines
    outputs:
    - contextPath: MicrosoftATP.Machine.ID
      description: The machine ID
      type: String
    - contextPath: MicrosoftATP.Machine.ComputerDNSName
      description: The machine DNS name
      type: String
    - contextPath: MicrosoftATP.Machine.FirstSeen
      description: The first date and time where the machine was observed by Microsoft
        Defender ATP
      type: Date
    - contextPath: MicrosoftATP.Machine.LastSeen
      description: The last date and time where the machine was observed by Microsoft
        Defender ATP
      type: Date
    - contextPath: MicrosoftATP.Machine.OSPlatform
      description: The operating system platform
      type: String
    - contextPath: MicrosoftATP.Machine.OSVersion
      description: The operating system Version
      type: String
    - contextPath: MicrosoftATP.Machine.OSProcessor
      description: The operating system processor
      type: String
    - contextPath: MicrosoftATP.Machine.LastIPAddress
      description: The last IP on the machine
      type: String
    - contextPath: MicrosoftATP.Machine.LastExternalIPAddress
      description: The last machine IP to access the internet
      type: String
    - contextPath: MicrosoftATP.Machine.OSBuild
      description: The operating system build number
      type: Number
    - contextPath: MicrosoftATP.Machine.HealthStatus
      description: The machine health status
      type: String
    - contextPath: MicrosoftATP.Machine.RBACGroupID
      description: The machine RBAC group ID
      type: Number
    - contextPath: MicrosoftATP.Machine.RBACGroupName
      description: The machine RBAC group Name
      type: String
    - contextPath: MicrosoftATP.Machine.RiskScore
      description: The machine risk score
      type: String
    - contextPath: MicrosoftATP.Machine.ExposureLevel
      description: The machine exposure score
      type: String
    - contextPath: MicrosoftATP.Machine.IsAADJoined
      description: True if machine is AAD joined, False otherwise
      type: Boolean
    - contextPath: MicrosoftATP.Machine.AADDeviceID
      description: The AAD Device ID
      type: String
    - contextPath: MicrosoftATP.Machine.MachineTags
      description: Set of machine tags
      type: String
  - arguments:
    - default: false
      description: File SHA1 hash to get the related machines
      isArray: false
      name: file_hash
      required: true
      secret: false
    deprecated: false
    description: Get a collection of machines related to a given file SHA1 hash.
    execution: false
    name: microsoft-atp-get-file-related-machines
    outputs:
    - contextPath: MicrosoftATP.FileMachine.Machines.ID
      description: The machine ID
      type: String
    - contextPath: MicrosoftATP.FileMachine.Machines.ComputerDNSName
      description: The machine DNS name
      type: String
    - contextPath: MicrosoftATP.FileMachine.Machines.FirstSeen
      description: The first date and time where the machine was observed by Microsoft
        Defender ATP
      type: Date
    - contextPath: MicrosoftATP.FileMachine.Machines.LastSeen
      description: The last date and time where the machine was observed by Microsoft
        Defender ATP
      type: Date
    - contextPath: MicrosoftATP.FileMachine.Machines.OSPlatform
      description: The operating system platform
      type: String
    - contextPath: MicrosoftATP.FileMachine.Machines.OSVersion
      description: The operating system Version
      type: String
    - contextPath: MicrosoftATP.Machine.OSProcessor
      description: The operating system processor
      type: String
    - contextPath: MicrosoftATP.FileMachine.Machines.OSBuild
      description: Operating system build number
      type: Number
    - contextPath: MicrosoftATP.FileMachine.Machines.LastIPAddress
      description: The last IP on the machine
      type: String
    - contextPath: MicrosoftATP.FileMachine.Machines.LastExternalIPAddress
      description: The last machine IP to access the internet
      type: String
    - contextPath: MicrosoftATP.FileMachine.Machines.HelathStatus
      description: The machine health status
      type: String
    - contextPath: MicrosoftATP.FileMachine.Machines.RBACGroupID
      description: The machine RBAC group ID
      type: Number
    - contextPath: MicrosoftATP.FileMachine.Machines.RBACGroupName
      description: The machine RBAC group Name
      type: String
    - contextPath: MicrosoftATP.FileMachine.Machines.RiskScore
      description: The machine risk score
      type: String
    - contextPath: MicrosoftATP.FileMachine.Machines.ExposureLevel
      description: The machine exposure score
      type: String
    - contextPath: MicrosoftATP.FileMachine.Machines.IsAADJoined
      description: True if machine is AAD joined, False otherwise
      type: Boolean
    - contextPath: MicrosoftATP.FileMachine.Machines.AADDeviceID
      description: The AAD Device ID
      type: string
    - contextPath: MicrosoftATP.FileMachine.Machines.MachineTags
      description: Set of machine tags
      type: String
    - contextPath: MicrosoftATP.FileMachine.File
      description: The machine related file hash
      type: String
  - arguments:
    - default: true
      description: Machine id to be used for getting the machine details, e.g. 0a3250e0693a109f1affc9217be9459028aa8426
      isArray: false
      name: machine_id
      required: true
      secret: false
    deprecated: false
    description: Get a machine details by its identity.
    execution: false
    name: microsoft-atp-get-machine-details
    outputs:
    - contextPath: MicrosoftATP.Machine.ID
      description: The machine ID
      type: String
    - contextPath: MicrosoftATP.Machine.ComputerDNSName
      description: The machine DNS name
      type: String
    - contextPath: MicrosoftATP.Machine.FirstSeen
      description: The first date and time where the machine was observed by Microsoft
        Defender ATP
      type: Date
    - contextPath: MicrosoftATP.Machine.LastSeen
      description: The last date and time where the machine was observed by Microsoft
        Defender ATP
      type: Date
    - contextPath: MicrosoftATP.Machine.OSPlatform
      description: The operating system platform
      type: String
    - contextPath: MicrosoftATP.Machine.OSVersion
      description: The operating system Version
      type: String
    - contextPath: MicrosoftATP.Machine.OSProcessor
      description: The operating system processor
      type: String
    - contextPath: MicrosoftATP.Machine.LastIPAddress
      description: The last IP on the machine
      type: String
    - contextPath: MicrosoftATP.Machine.LastExternalIPAddress
      description: The last machine IP to access the internet
      type: String
    - contextPath: MicrosoftATP.Machine.OSBuild
      description: The operating system build number
      type: Number
    - contextPath: MicrosoftATP.Machine.HealthStatus
      description: The machine health status
      type: String
    - contextPath: MicrosoftATP.Machine.RBACGroupID
      description: The machine RBAC group ID
      type: Number
    - contextPath: MicrosoftATP.Machine.RBACGroupName
      description: The machine RBAC group Name
      type: String
    - contextPath: MicrosoftATP.Machine.RiskScore
      description: The machine risk score
      type: String
    - contextPath: MicrosoftATP.Machine.ExposureLevel
      description: The machine exposure level
      type: String
    - contextPath: MicrosoftATP.Machine.IsAADJoined
      description: True if machine is AAD joined, False otherwise
      type: Boolean
    - contextPath: MicrosoftATP.Machine.AADDeviceID
      description: The AAD Device ID
      type: String
    - contextPath: MicrosoftATP.Machine.MachineTags
      description: Set of machine tags
      type: String
  - arguments:
    - default: false
      description: The machine ID to run the scan on.
      isArray: false
      name: machine_id
      required: true
      secret: false
    - default: false
      description: A comment to associate with the action.
      isArray: false
      name: comment
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Defines the type of the scan.
      isArray: false
      name: scan_type
      predefined:
      - Quick
      - Full
      required: true
      secret: false
    deprecated: false
    description: Initiate a Microsoft Defender Antivirus scan on a machine.
    execution: false
    name: microsoft-atp-run-antivirus-scan
    outputs:
    - contextPath: MicrosoftATP.MachineAction.ID
      description: The machine action ID
      type: String
    - contextPath: MicrosoftATP.MachineAction.Type
      description: The type of the action
      type: String
    - contextPath: MicrosoftATP.MachineAction.Scope
      description: The scope of the action
      type: Unknown
    - contextPath: MicrosoftATP.MachineAction.Requestor
      description: The ID of the user that executed the action
      type: String
    - contextPath: MicrosoftATP.MachineAction.RequestorComment
      description: The comment that was written when issuing the action
      type: String
    - contextPath: MicrosoftATP.MachineAction.Status
      description: The current status of the command
      type: String
    - contextPath: MicrosoftATP.MachineAction.MachineID
      description: The machine ID on which the action was executed
      type: String
    - contextPath: MicrosoftATP.MachineAction.ComputerDNSName
      description: The machine DNS name on which the action was executed
      type: String
    - contextPath: MicrosoftATP.MachineAction.CreationDateTimeUtc
      description: The date and time when the action was created
      type: Date
    - contextPath: MicrosoftATP.MachineAction.LastUpdateTimeUtc
      description: The last date and time when the action status was updated
      type: Date
    - contextPath: MicrosoftATP.MachineAction.RelatedFileInfo.FileIdentifier
      description: The file identifier
      type: String
    - contextPath: MicrosoftATP.MachineAction.RelatedFileInfo.FileIdentifierType
      description: 'The type of the file identifier with the possible values: "SHA1"
        ,"SHA256" and "MD5"'
      type: String
  - arguments:
    - auto: PREDEFINED
      default: false
      description: Alert severity.
      isArray: false
      name: severity
      predefined:
      - High
      - Medium
      - Low
      - Informational
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Alert status.
      isArray: false
      name: status
      predefined:
      - New
      - InProgress
      - Resolved
      required: false
      secret: false
    - default: false
      description: Alert category, only one can be added.
      isArray: false
      name: category
      required: false
      secret: false
    deprecated: false
    description: Get a list of alerts present on the system. Filtering can be done
      only on a single argument.
    execution: false
    name: microsoft-atp-list-alerts
    outputs:
    - contextPath: MicrosoftATP.Alert.ID
      description: The alert ID
      type: String
    - contextPath: MicrosoftATP.Alert.IncidentID
      description: The Incident ID of the Alert
      type: Number
    - contextPath: MicrosoftATP.Alert.InvestigationID
      description: The Investigation ID related to the Alert
      type: Number
    - contextPath: MicrosoftATP.Alert.InvestigationState
      description: The current state of the Investigation
      type: String
    - contextPath: MicrosoftATP.Alert.AssignedTo
      description: The owner of the alert
      type: String
    - contextPath: MicrosoftATP.Alert.Severity
      description: The severity of the alert
      type: String
    - contextPath: MicrosoftATP.Alert.Status
      description: The current status of the alert
      type: String
    - contextPath: MicrosoftATP.Alert.Classification
      description: The alert Classification
      type: String
    - contextPath: MicrosoftATP.Alert.Determination
      description: The determination of the alert
      type: String
    - contextPath: MicrosoftATP.Alert.DetectionSource
      description: The detection source
      type: String
    - contextPath: MicrosoftATP.Alert.Category
      description: The category of the alert
      type: String
    - contextPath: MicrosoftATP.Alert.ThreatFamilyName
      description: The threat family
      type: String
    - contextPath: MicrosoftATP.Alert.Title
      description: The alert title
      type: String
    - contextPath: MicrosoftATP.Alert.Description
      description: The alert description
      type: String
    - contextPath: MicrosoftATP.Alert.AlertCreationTime
      description: The date and time the alert was created
      type: Date
    - contextPath: MicrosoftATP.Alert.FirstEventTime
      description: The first event time that triggered the alert on that machine
      type: Date
    - contextPath: MicrosoftATP.Alert.LastEventTime
      description: The last event time that triggered the alert on that machine
      type: Date
    - contextPath: MicrosoftATP.Alert.LastUpdateTime
      description: The first event time that triggered the alert on that machine
      type: Date
    - contextPath: MicrosoftATP.Alert.ResolvedTime
      description: The date and time in which the status of the alert was changed
        to 'Resolved'
      type: Date
    - contextPath: MicrosoftATP.Alert.MachineID
      description: The machine ID that is associated with the alert
      type: String
    - contextPath: MicrosoftATP.Alert.ComputerDNSName
      description: The machine DNS name
      type: String
    - contextPath: MicrosoftATP.Alert.AADTenantID
      description: The AAD tenant ID
      type: String
    - contextPath: MicrosoftATP.Alert.Comments.Comment
      description: The alert comment string
      type: String
    - contextPath: MicrosoftATP.Alert.Comments.CreatedBy
      description: The alert comment created by string
      type: String
    - contextPath: MicrosoftATP.Alert.Comments.CreatedTime
      description: The alert comment create time date
      type: Date
  - arguments:
    - default: false
      description: Alert ID to update.
      isArray: false
      name: alert_id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Alert status to update.
      isArray: false
      name: status
      predefined:
      - New
      - InProgress
      - Resolved
      required: false
      secret: false
    - default: false
      description: Owner of the alert.
      isArray: false
      name: assigned_to
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Specifies the specification of the alert.
      isArray: false
      name: classification
      predefined:
      - Unknown
      - FalsePositive
      - TruePositive
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Specifies the determination of the alert.
      isArray: false
      name: determination
      predefined:
      - NotAvailable
      - Apt
      - Malware
      - SecurityPersonnel
      - SecurityTesting
      - UnwantedSoftware
      - Other
      required: false
      secret: false
    - default: false
      description: Comment to be added to the alert.
      isArray: false
      name: comment
      required: false
      secret: false
    deprecated: false
    description: Update the properties of an alert entity.
    execution: false
    name: microsoft-atp-update-alert
    outputs:
    - contextPath: MicrosoftATP.Alert.ID
      description: The alert ID
      type: String
    - contextPath: MicrosoftATP.Alert.IncidentID
      description: The Incident ID of the alert
      type: Number
    - contextPath: MicrosoftATP.Alert.InvestigationID
      description: The Investigation ID related to the alert
      type: Number
    - contextPath: MicrosoftATP.Alert.InvestigationState
      description: The current state of the Investigation
      type: String
    - contextPath: MicrosoftATP.Alert.AssignedTo
      description: The owner of the alert
      type: String
    - contextPath: MicrosoftATP.Alert.Severity
      description: The severity of the alert
      type: String
    - contextPath: MicrosoftATP.Alert.Status
      description: The current status of the alert
      type: String
    - contextPath: MicrosoftATP.Alert.Classification
      description: The alert classification
      type: String
    - contextPath: MicrosoftATP.Alert.Determination
      description: The determination of the alert
      type: String
    - contextPath: MicrosoftATP.Alert.DetectionSource
      description: The detection source
      type: String
    - contextPath: MicrosoftATP.Alert.Category
      description: The category of the alert
      type: String
    - contextPath: MicrosoftATP.Alert.ThreatFamilyName
      description: The threat family
      type: String
    - contextPath: MicrosoftATP.Alert.Title
      description: The alert title
      type: String
    - contextPath: MicrosoftATP.Alert.Description
      description: The alert description
      type: String
    - contextPath: MicrosoftATP.Alert.AlertCreationTime
      description: The date and time the alert was created
      type: Date
    - contextPath: MicrosoftATP.Alert.FirstEventTime
      description: The first event time that triggered the alert on that machine
      type: Date
    - contextPath: MicrosoftATP.Alert.LastEventTime
      description: The last event time that triggered the alert on that machine
      type: Date
    - contextPath: MicrosoftATP.Alert.LastUpdateTime
      description: The first event time that triggered the alert on that machine
      type: Date
    - contextPath: MicrosoftATP.Alert.ResolvedTime
      description: The date and time in which the status of the alert was changed
        to 'Resolved'
      type: Date
    - contextPath: MicrosoftATP.Alert.MachineID
      description: The mahine ID that is associated with the alert
      type: String
    - contextPath: MicrosoftATP.Alert.ComputerDNSName
      description: The machine DNS name
      type: String
    - contextPath: MicrosoftATP.Alert.AADTenantID
      description: The AAD tenant ID
      type: String
    - contextPath: MicrosoftATP.Alert.Comments.Comment
      description: The alert comment string
      type: String
    - contextPath: MicrosoftATP.Alert.Comments.CreatedBy
      description: The alert comment created by string
      type: String
    - contextPath: MicrosoftATP.Alert.Comments.CreatedTime
      description: The alert comment create time date
      type: Date
  - arguments:
    - default: true
      description: The query to run.
      isArray: false
      name: query
      required: true
      secret: false
    deprecated: false
    description: 'Allows you to run programmatic queries like in Microsoft Defender
      ATP Portal (https://securitycenter.windows.com/hunting). Limitations: You can
      only run a query on data from the last 30 days, The results will include a maximum
      of 10,000 rows, The number of executions is limited (up to 15 calls per minute,
      15 minutes of running time every hour and 4 hours of running time a day).'
    execution: false
    name: microsoft-atp-advanced-hunting
    outputs:
    - contextPath: MicrosoftATP.Hunt.Result
      description: The query results.
      type: String
  - arguments:
    - default: false
      description: Id of the machine on which the event was identified.
      isArray: false
      name: machine_id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Severity of the alert.
      isArray: false
      name: severity
      predefined:
      - Low
      - Medium
      - High
      required: true
      secret: false
    - default: false
      description: Title for the alert.
      isArray: false
      name: title
      required: true
      secret: false
    - default: false
      description: Description of the alert.
      isArray: false
      name: description
      required: true
      secret: false
    - default: false
      description: Action that is recommended to be taken by security officer when
        analyzing the alert.
      isArray: false
      name: recommended_action
      required: true
      secret: false
    - default: false
      description: The time of the event, as obtained from the advanced query.
      isArray: false
      name: event_time
      required: true
      secret: false
    - default: false
      description: The reportId, as obtained from the advanced query.
      isArray: false
      name: report_id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: None
      description: Category of the alert.
      isArray: false
      name: category
      predefined:
      - None
      - SuspiciousActivity
      - Malware
      - CredentialTheft
      - Exploit
      - WebExploit
      - DocumentExploit
      - PrivilegeEscalation
      - Persistence
      - RemoteAccessTool
      - CommandAndControl
      - SuspiciousNetworkTraffic
      - Ransomware
      - MalwareDownload
      - Reconnaissance
      - WebFingerprinting
      - Weaponization
      - Delivery
      - SocialEngineering
      - CredentialStealing
      - Installation
      - Backdoor
      - Trojan
      - TrojanDownloader
      - LateralMovement
      - ExplorationEnumeration
      - NetworkPropagation
      - Exfiltration
      - NotApplicable
      - EnterprisePolicy
      - General
      required: true
      secret: false
    deprecated: false
    description: Create a new alert entity using event data, as obtained from the
      Advanced Hunting.
    execution: false
    name: microsoft-atp-create-alert
    outputs:
    - contextPath: MicrosoftATP.Alert.ID
      description: The alert ID
      type: String
    - contextPath: MicrosoftATP.Alert.IncidentID
      description: The Incident ID of the alert
      type: Number
    - contextPath: MicrosoftATP.Alert.InvestigationID
      description: The Investigation ID related to the alert
      type: Number
    - contextPath: MicrosoftATP.Alert.InvestigationState
      description: The current state of the Investigation
      type: String
    - contextPath: MicrosoftATP.Alert.AssignedTo
      description: The owner of the alert
      type: String
    - contextPath: MicrosoftATP.Alert.Severity
      description: The severity of the alert
      type: String
    - contextPath: MicrosoftATP.Alert.Status
      description: The current status of the alert
      type: String
    - contextPath: MicrosoftATP.Alert.Classification
      description: The alert Classification
      type: String
    - contextPath: MicrosoftATP.Alert.Determination
      description: The determination of the alert
      type: String
    - contextPath: MicrosoftATP.Alert.DetectionSource
      description: The detection source
      type: String
    - contextPath: MicrosoftATP.Alert.Category
      description: The category of the alert
      type: String
    - contextPath: MicrosoftATP.Alert.ThreatFamilyName
      description: The threat family
      type: String
    - contextPath: MicrosoftATP.Alert.Title
      description: The alert title
      type: String
    - contextPath: MicrosoftATP.Alert.Description
      description: The alert description
      type: String
    - contextPath: MicrosoftATP.Alert.AlertCreationTime
      description: The date and time the alert was created
      type: Date
    - contextPath: MicrosoftATP.Alert.FirstEventTime
      description: The first event time that triggered the alert on that machine
      type: Date
    - contextPath: MicrosoftATP.Alert.LastEventTime
      description: The last event time that triggered the alert on that machine
      type: Date
    - contextPath: MicrosoftATP.Alert.LastUpdateTime
      description: The first event time that triggered the alert on that machine
      type: Date
    - contextPath: MicrosoftATP.Alert.ResolvedTime
      description: The date and time in which the status of the alert was changed
        to 'Resolved'
      type: Date
    - contextPath: MicrosoftATP.Alert.MachineID
      description: The mahine ID that is associated with the alert
      type: String
    - contextPath: MicrosoftATP.Alert.ComputerDNSName
      description: The machine DNS name
      type: String
    - contextPath: MicrosoftATP.Alert.AADTenantID
      description: The AAD tenant ID
      type: String
    - contextPath: MicrosoftATP.Alert.Comments.Comment
      description: The alert Comment string
      type: String
    - contextPath: MicrosoftATP.Alert.Comments.CreatedBy
      description: The alert comment created by string
      type: String
    - contextPath: MicrosoftATP.Alert.Comments.CreatedTime
      description: The alert comment create time date
      type: Date
  - arguments:
    - default: false
      description: ID of the alert.
      isArray: false
      name: id
      required: true
      secret: false
    deprecated: false
    description: Retrieves the user associated to a specific alert.
    execution: false
    name: microsoft-atp-get-alert-related-user
    outputs:
    - contextPath: MicrosoftATP.AlertUser.User.ID
      description: The user ID
      type: String
    - contextPath: MicrosoftATP.AlertUser.User.AccountName
      description: The account name
      type: String
    - contextPath: MicrosoftATP.AlertUser.User.AccountDomain
      description: The account domain
      type: String
    - contextPath: MicrosoftATP.AlertUser.User.AccountSID
      description: The account SID
      type: String
    - contextPath: MicrosoftATP.AlertUser.User.FirstSeen
      description: The user first seen date time
      type: Date
    - contextPath: MicrosoftATP.AlertUser.User.LastSeen
      description: The user last seen date time
      type: Date
    - contextPath: MicrosoftATP.AlertUser.User.MostPrevalentMachineID
      description: The most prevelent machine ID
      type: String
    - contextPath: MicrosoftATP.AlertUser.User.LeastPrevalentMachineID
      description: The least prevelent machine ID
      type: String
    - contextPath: MicrosoftATP.AlertUser.User.LogonTypes
      description: The user logon types
      type: String
    - contextPath: MicrosoftATP.AlertUser.User.LogonCount
      description: The count of user logon
      type: Number
    - contextPath: MicrosoftATP.AlertUser.User.DomainAdmin
      description: True if domain admin, False otherwise
      type: Number
    - contextPath: MicrosoftATP.AlertUser.User.NetworkUser
      description: True if domain admin, False otherwise
      type: Number
    - contextPath: MicrosoftATP.AlertUser.AlertID
      description: The alert ID
      type: String
  - arguments:
    - default: false
      description: ID of the alert.
      isArray: false
      name: id
      required: true
      secret: false
    - default: false
      defaultValue: '50'
      description: The limit of files to display
      isArray: false
      name: limit
      required: false
      secret: false
    - default: false
      defaultValue: '0'
      description: The page from which to get the related files
      isArray: false
      name: offset
      required: false
      secret: false
    deprecated: false
    description: Retrieves the files associated to a specific alert.
    execution: false
    name: microsoft-atp-get-alert-related-files
    outputs:
    - contextPath: MicrosoftATP.AlertFile.Files.FilePublisher
      description: The file's publisher
      type: String
    - contextPath: MicrosoftATP.AlertFile.Files.Size
      description: The size of the file
      type: Number
    - contextPath: MicrosoftATP.AlertFile.Files.GlobalLastObserved
      description: The last time the file was observed
      type: Date
    - contextPath: MicrosoftATP.AlertFile.Files.Sha1
      description: The SHA1 hash of the file
      type: String
    - contextPath: MicrosoftATP.AlertFile.Files.IsValidCertificate
      description: Was signing certificate successfully verified by Microsoft Defender
        ATP agent.
      type: Number
    - contextPath: MicrosoftATP.AlertFile.Files.Sha256
      description: The SHA256 hash of the file
      type: String
    - contextPath: MicrosoftATP.AlertFile.Files.Signer
      description: The file signer
      type: String
    - contextPath: MicrosoftATP.AlertFile.Files.GlobalPrevalence
      description: The file prevalence across organization
      type: Number
    - contextPath: MicrosoftATP.AlertFile.Files.DeterminationValue
      description: The file determination value
      type: String
    - contextPath: MicrosoftATP.AlertFile.Files.GlobalFirstObserved
      description: The first time the file was observed
      type: Date
    - contextPath: MicrosoftATP.AlertFile.Files.FileType
      description: The type of the file
      type: String
    - contextPath: MicrosoftATP.AlertFile.Files.SignerHash
      description: The hash of the signing certificate
      type: String
    - contextPath: MicrosoftATP.AlertFile.Files.Issuer
      description: The file issuer
      type: String
    - contextPath: MicrosoftATP.AlertFile.Files.IsPeFile
      description: True if the file is portable executable, False otherwise
      type: Number
    - contextPath: MicrosoftATP.AlertFile.Files.DeterminationType
      description: The file determination type
      type: String
    - contextPath: MicrosoftATP.AlertFile.Files.FileProductName
      description: The file product name
      type: Unknown
    - contextPath: MicrosoftATP.AlertFile.Files.Md5
      description: The MD5 hash of the file
      type: String
  - arguments:
    - default: false
      description: ID of the alert.
      isArray: false
      name: id
      required: true
      secret: false
    - default: false
      defaultValue: '50'
      description: The limit of IPs to display.
      isArray: false
      name: limit
      required: false
      secret: false
    - default: false
      defaultValue: '0'
      description: The page from which to get the related IPs.
      isArray: false
      name: offset
      required: false
      secret: false
    deprecated: false
    description: Retrieves the IPs associated to a specific alert.
    execution: false
    name: microsoft-atp-get-alert-related-ips
    outputs:
    - contextPath: MicrosoftATP.AlertIP.IPs.IpAddress
      description: The address of the IP
      type: String
    - contextPath: MicrosoftATP.AlertIP.AlertID
      description: The alert ID
      type: String
  - arguments:
    - default: false
      description: ID of the alert.
      isArray: false
      name: id
      required: true
      secret: false
    - default: false
      defaultValue: '50'
      description: The limit of domains to display.
      isArray: false
      name: limit
      required: false
      secret: false
    - default: false
      defaultValue: '0'
      description: The page from which to get the related domains.
      isArray: false
      name: offset
      required: false
      secret: false
    deprecated: false
    description: Retrieves the domains associated to a specific alert.
    execution: false
    name: microsoft-atp-get-alert-related-domains
    outputs:
    - contextPath: MicrosoftATP.AlertDomain.Domains.Domain
      description: The domain address
      type: String
    - contextPath: MicrosoftATP.AlertDomain.AlertID
      description: The alert ID
      type: Unknown
  - arguments:
    - default: false
      description: ID of the action.
      isArray: false
      name: id
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: The machine action status.
      isArray: false
      name: status
      predefined:
      - Pending
      - InProgress
      - Succeeded
      - Failed
      - TimeOut
      - ' Cancelled'
      required: false
      secret: false
    - default: false
      description: The machine ID on which the action was executed, only one can be
        added.
      isArray: false
      name: machine_id
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: The machine action type.
      isArray: false
      name: type
      predefined:
      - RunAntiVirusScan
      - Offboard
      - CollectInvestigationPackage
      - Isolate
      - Unisolate
      - StopAndQuarantineFile
      - RestrictCodeExecution
      - UnrestrictCodeExecution
      required: false
      secret: false
    - default: false
      description: The ID of the user that executed the action, only one can be added.
      isArray: false
      name: requestor
      required: false
      secret: false
    deprecated: false
    description: |-
      Return the machine's actions. If you set an action id it will return the info on the specific action.
      Filtering can be done only on one argument.
    execution: false
    name: microsoft-atp-list-machine-actions-details
    outputs:
    - contextPath: MicrosoftATP.MachineAction.ID
      description: The machine action ID
      type: String
    - contextPath: MicrosoftATP.MachineAction.Type
      description: The type of the action
      type: String
    - contextPath: MicrosoftATP.MachineAction.Scope
      description: The scope of the action
      type: String
    - contextPath: MicrosoftATP.MachineAction.Requestor
      description: The ID of the user that executed the action
      type: String
    - contextPath: MicrosoftATP.MachineAction.RequestorComment
      description: The comment that was written when issuing the action
      type: String
    - contextPath: MicrosoftATP.MachineAction.Status
      description: The current status of the command
      type: String
    - contextPath: MicrosoftATP.MachineAction.MachineID
      description: The machine ID on which the action was executed
      type: String
    - contextPath: MicrosoftATP.MachineAction.ComputerDNSName
      description: The machine DNS name on which the action was executed
      type: String
    - contextPath: MicrosoftATP.MachineAction.CreationDateTimeUtc
      description: The date and time when the action was created
      type: Date
    - contextPath: MicrosoftATP.MachineAction.LastUpdateTimeUtc
      description: The last date and time when the action status was updated
      type: Date
    - contextPath: MicrosoftATP.MachineAction.RelatedFileInfo.FileIdentifier
      description: The file identifier
      type: String
    - contextPath: MicrosoftATP.MachineAction.RelatedFileInfo.FileIdentifierType
      description: 'The type of the file identifier with the possible values: "SHA1"
        ,"SHA256" and "MD5"'
      type: String
  - arguments:
    - default: false
      description: The machine ID.
      isArray: false
      name: machine_id
      required: true
      secret: false
    - default: false
      description: Comment to associate with the action.
      isArray: false
      name: comment
      required: true
      secret: false
    deprecated: false
    description: Collect an investigation package from a machine.
    execution: false
    name: microsoft-atp-collect-investigation-package
    outputs:
    - contextPath: MicrosoftATP.MachineAction.ID
      description: The machine action ID
      type: String
    - contextPath: MicrosoftATP.MachineAction.Type
      description: The type of the action
      type: String
    - contextPath: MicrosoftATP.MachineAction.Scope
      description: The scope of the action
      type: String
    - contextPath: MicrosoftATP.MachineAction.Requestor
      description: The ID of the user that executed the action.
      type: String
    - contextPath: MicrosoftATP.MachineAction.RequestorComment
      description: The comment that was written when issuing the action.
      type: String
    - contextPath: MicrosoftATP.MachineAction.Status
      description: The current status of the command
      type: String
    - contextPath: MicrosoftATP.MachineAction.MachineID
      description: The machine ID on which the action was executed.
      type: String
    - contextPath: MicrosoftATP.MachineAction.ComputerDNSName
      description: The machine DNS name on which the action was executed
      type: String
    - contextPath: MicrosoftATP.MachineAction.CreationDateTimeUtc
      description: The date and time when the action was created
      type: Date
    - contextPath: MicrosoftATP.MachineAction.LastUpdateTimeUtc
      description: The last date and time when the action status was updated
      type: Date
    - contextPath: MicrosoftATP.MachineAction.RelatedFileInfo.FileIdentifier
      description: The file identifier
      type: String
    - contextPath: MicrosoftATP.MachineAction.RelatedFileInfo.FileIdentifierType
      description: 'The type of the file identifier with the possible values: "SHA1"
        ,"SHA256" and "MD5"'
      type: String
  - arguments:
    - default: false
      description: machine action ID.
      isArray: false
      name: action_id
      required: true
      secret: false
    deprecated: false
    description: Get a URI that allows downloading an investigation package.
    execution: false
    name: microsoft-atp-get-investigation-package-sas-uri
    outputs:
    - contextPath: MicrosoftATP.InvestigationURI.Link
      description: The investigation package URI
      type: String
  - arguments:
    - default: false
      description: The machine ID.
      isArray: false
      name: machine_id
      required: true
      secret: false
    - default: false
      description: Comment to associate with the action.
      isArray: false
      name: comment
      required: false
      secret: false
    deprecated: false
    description: Restrict the execution of all applications on the machine except a predefined
      set.
    execution: false
    name: microsoft-atp-restrict-app-execution
    outputs:
    - contextPath: MicrosoftATP.MachineAction.ID
      description: The machine action ID
      type: String
    - contextPath: MicrosoftATP.MachineAction.Type
      description: The type of the action
      type: String
    - contextPath: MicrosoftATP.MachineAction.Scope
      description: The scope of the action
      type: String
    - contextPath: MicrosoftATP.MachineAction.Requestor
      description: The ID of the user that executed the action
      type: String
    - contextPath: MicrosoftATP.MachineAction.RequestorComment
      description: The comment that was written when issuing the action
      type: String
    - contextPath: MicrosoftATP.MachineAction.Status
      description: The current status of the command
      type: String
    - contextPath: MicrosoftATP.MachineAction.MachineID
      description: The machine ID on which the action was executed
      type: String
    - contextPath: MicrosoftATP.MachineAction.ComputerDNSName
      description: The machine DNS name on which the action was executed
      type: String
    - contextPath: MicrosoftATP.MachineAction.CreationDateTimeUtc
      description: The date and time when the action was created
      type: Date
    - contextPath: MicrosoftATP.MachineAction.LastUpdateTimeUtc
      description: The last date and time when the action status was updated
      type: Date
    - contextPath: MicrosoftATP.MachineAction.RelatedFileInfo.FileIdentifier
      description: The file identifier
      type: String
    - contextPath: MicrosoftATP.MachineAction.RelatedFileInfo.FileIdentifierType
      description: 'The type of the file identifier with the possible values: "SHA1"
        ,"SHA256" and "MD5"'
      type: String
  - arguments:
    - default: false
      description: The machine ID.
      isArray: false
      name: machine_id
      required: true
      secret: false
    - default: false
      description: Comment to associate with the action.
      isArray: false
      name: comment
      required: true
      secret: false
    deprecated: false
    description: Enable the execution of any application on the machine.
    execution: false
    name: microsoft-atp-remove-app-restriction
    outputs:
    - contextPath: MicrosoftATP.MachineAction.ID
      description: The machine action ID
      type: String
    - contextPath: MicrosoftATP.MachineAction.Type
      description: The type of the action
      type: String
    - contextPath: MicrosoftATP.MachineAction.Scope
      description: The scope of the action
      type: String
    - contextPath: MicrosoftATP.MachineAction.Requestor
      description: The ID of the user that executed the action
      type: String
    - contextPath: MicrosoftATP.MachineAction.RequestorComment
      description: The comment that was written when issuing the action
      type: String
    - contextPath: MicrosoftATP.MachineAction.Status
      description: The current status of the command
      type: String
    - contextPath: MicrosoftATP.MachineAction.MachineID
      description: The machine ID on which the action was executed
      type: String
    - contextPath: MicrosoftATP.MachineAction.ComputerDNSName
      description: The machine DNS name on which the action was executed
      type: String
    - contextPath: MicrosoftATP.MachineAction.CreationDateTimeUtc
      description: The date and time when the action was created
      type: Date
    - contextPath: MicrosoftATP.MachineAction.LastUpdateTimeUtc
      description: The last date and time when the action status was updated
      type: Date
    - contextPath: MicrosoftATP.MachineAction.RelatedFileInfo.FileIdentifier
      description: The file identifier
      type: String
    - contextPath: MicrosoftATP.MachineAction.RelatedFileInfo.FileIdentifierType
      description: 'The type of the file identifier with the possible values: "SHA1"
        ,"SHA256" and "MD5"'
      type: String
  - arguments:
    - default: false
      description: The machine ID.
      isArray: false
      name: machine_id
      required: true
      secret: false
    - default: false
      description: The file SHA1 hash to stop and quarantine on the machine.
      isArray: false
      name: file_hash
      required: true
      secret: false
    - default: false
      description: Comment to associate with the action.
      isArray: false
      name: comment
      required: true
      secret: false
    deprecated: false
    description: Stop the execution of a file on a machine and delete it.
    execution: false
    name: microsoft-atp-stop-and-quarantine-file
    outputs:
    - contextPath: MicrosoftATP.MachineAction.ID
      description: The machine action ID
      type: String
    - contextPath: MicrosoftATP.MachineAction.Type
      description: The type of the action
      type: String
    - contextPath: MicrosoftATP.MachineAction.Scope
      description: The scope of the action
      type: String
    - contextPath: MicrosoftATP.MachineAction.Requestor
      description: The ID of the user that executed the action
      type: String
    - contextPath: MicrosoftATP.MachineAction.RequestorComment
      description: The comment that was written when issuing the action
      type: String
    - contextPath: MicrosoftATP.MachineAction.Status
      description: The current status of the command
      type: String
    - contextPath: MicrosoftATP.MachineAction.MachineID
      description: The machine ID on which the action was executed
      type: String
    - contextPath: MicrosoftATP.MachineAction.ComputerDNSName
      description: The machine DNS name on which the action was executed
      type: String
    - contextPath: MicrosoftATP.MachineAction.CreationDateTimeUtc
      description: The date and time when the action was created
      type: Date
    - contextPath: MicrosoftATP.MachineAction.LastUpdateTimeUtc
      description: The last date and time when the action status was updated
      type: Date
    - contextPath: MicrosoftATP.MachineAction.RelatedFileInfo.FileIdentifier
      description: The file identifier
      type: String
    - contextPath: MicrosoftATP.MachineAction.RelatedFileInfo.FileIdentifierType
      description: 'The type of the file identifier with the possible values: "SHA1"
        ,"SHA256" and "MD5"'
      type: String
  - arguments:
    - default: false
      description: ID can be the investigation ID or the investigation triggering
        alert ID.
      isArray: false
      name: id
      required: false
      secret: false
    - default: false
      defaultValue: '50'
      description: The limit of investigations to display.
      isArray: false
      name: limit
      required: false
      secret: false
    - default: false
      defaultValue: '0'
      description: The page from which to get the investigations.
      isArray: false
      name: offset
      predefined:
      - ''
      required: false
      secret: false
    deprecated: false
    description: Retrieves a collection of investigations or retrieves specific investigation
      by its ID.
    execution: false
    name: microsoft-atp-list-investigations
    outputs:
    - contextPath: MicrosoftATP.Investigation.ID
      description: The investigation ID
      type: String
    - contextPath: MicrosoftATP.Investigation.StartTime
      description: The date and time when the investigation was created
      type: Date
    - contextPath: MicrosoftATP.Investigation.EndTime
      description: The date and time when the investigation was completed
      type: Date
    - contextPath: MicrosoftATP.Investigation.State
      description: The investigation state
      type: String
    - contextPath: MicrosoftATP.Investigation.CancelledBy
      description: The ID of the user/application that cancelled that investigation
      type: Unknown
    - contextPath: MicrosoftATP.Investigation.StatusDetails
      description: The details about the investigation state
      type: Unknown
    - contextPath: MicrosoftATP.Investigation.MachineID
      description: The machine ID on which the investigation is executed
      type: String
    - contextPath: MicrosoftATP.Investigation.ComputerDNSName
      description: The machine DNS name on which the investigation is executed
      type: String
    - contextPath: MicrosoftATP.Investigation.TriggeringAlertID
      description: The alert ID that triggered the investigation
      type: String
  - arguments:
    - default: false
      description: The machine's ID.
      isArray: false
      name: machine_id
      required: true
      secret: false
    - default: false
      description: Comment to associate with the action.
      isArray: false
      name: comment
      required: true
      secret: false
    deprecated: false
    description: Start an automated investigation on a machine.
    execution: false
    name: microsoft-atp-start-investigation
    outputs:
    - contextPath: MicrosoftATP.Investigation.ID
      description: The investigation ID
      type: String
    - contextPath: MicrosoftATP.Investigation.StartTime
      description: The date and time when the investigation was created
      type: Date
    - contextPath: MicrosoftATP.Investigation.EndTime
      description: The date and time when the investigation was completed
      type: Date
    - contextPath: MicrosoftATP.Investigation.State
      description: The investigation state
      type: String
    - contextPath: MicrosoftATP.Investigation.CancelledBy
      description: The ID of the user/application that cancelled that investigation
      type: Unknown
    - contextPath: MicrosoftATP.Investigation.StatusDetails
      description: The details about the investigation state
      type: Unknown
    - contextPath: MicrosoftATP.Investigation.MachineID
      description: The machine ID on which the investigation is executed
      type: String
    - contextPath: MicrosoftATP.Investigation.ComputerDNSName
      description: The machine DNS name on which the investigation is executed
      type: String
    - contextPath: MicrosoftATP.Investigation.TriggeringAlertID
      description: The alert ID that triggered the investigation
      type: String
  - arguments:
    - default: false
      description: The domain address
      isArray: false
      name: domain
      required: true
      secret: false
    deprecated: false
    description: Retrieves the statistics on the given domain.
    execution: false
    name: microsoft-atp-get-domain-statistics
    outputs:
    - contextPath: MicrosoftATP.DomainStatistics.Statistics.Host
      description: The domain host
      type: String
    - contextPath: MicrosoftATP.DomainStatistics.Statistics.OrgPrevalence
      description: The prevalnce of the domain in the organizetion
      type: String
    - contextPath: MicrosoftATP.DomainStatistics.Statistics.OrgFirstSeen
      description: The first date and time the domain was in the organizetion
      type: Date
    - contextPath: MicrosoftATP.DomainStatistics.Statistics.OrgLastSeen
      description: The last date and time the domain was in the organizetion
      type: Date
  - arguments:
    - default: false
      description: The domain address.
      isArray: false
      name: domain
      required: true
      secret: false
    deprecated: false
    description: Retrieves a collection of alerts related to a given domain address.
    execution: false
    name: microsoft-atp-get-domain-alerts
    outputs:
    - contextPath: MicrosoftATP.DomainAlert.Domain
      description: The domain address
      type: String
    - contextPath: MicrosoftATP.DomainAlert.Alerts.ID
      description: The alert ID
      type: String
    - contextPath: MicrosoftATP.DomainAlert.Alerts.IncidentID
      description: The incident ID of the alert
      type: Number
    - contextPath: MicrosoftATP.DomainAlert.Alerts.InvestigationID
      description: The investigation ID related to the alert
      type: Number
    - contextPath: MicrosoftATP.DomainAlert.Alerts.InvestigationState
      description: The current state of the investigation
      type: String
    - contextPath: MicrosoftATP.DomainAlert.Alerts.AssignedTo
      description: The owner of the alert
      type: String
    - contextPath: MicrosoftATP.DomainAlert.Alerts.Severity
      description: The severity of the alert
      type: String
    - contextPath: MicrosoftATP.DomainAlert.Alerts.Status
      description: The current status of the alert
      type: String
    - contextPath: MicrosoftATP.DomainAlert.Alerts.Classification
      description: The alert classification
      type: String
    - contextPath: MicrosoftATP.DomainAlert.Alerts.Determination
      description: The determination of the alert
      type: String
    - contextPath: MicrosoftATP.DomainAlert.Alerts.DetectionSource
      description: The detection source
      type: String
    - contextPath: MicrosoftATP.DomainAlert.Alerts.Category
      description: The category of the alert
      type: String
    - contextPath: MicrosoftATP.DomainAlert.Alerts.ThreatFamilyName
      description: The threat family name
      type: String
    - contextPath: MicrosoftATP.DomainAlert.Alerts.Title
      description: The alert title
      type: String
    - contextPath: MicrosoftATP.DomainAlert.Alerts.Description
      description: The alert description
      type: String
    - contextPath: MicrosoftATP.DomainAlert.Alerts.AlertCreationTime
      description: The date and time the alert was created
      type: Date
    - contextPath: MicrosoftATP.DomainAlert.Alerts.FirstEventTime
      description: The first event time that triggered the alert on that machine
      type: Date
    - contextPath: MicrosoftATP.DomainAlert.Alerts.LastEventTime
      description: The last event time that triggered the alert on that machine
      type: Date
    - contextPath: MicrosoftATP.DomainAlert.Alerts.LastUpdateTime
      description: The first event time that triggered the alert on that machine
      type: Date
    - contextPath: MicrosoftATP.DomainAlert.Alerts.ResolvedTime
      description: The date and time in which the status of the alert was changed
        to 'Resolved'
      type: Date
    - contextPath: MicrosoftATP.DomainAlert.Alerts.MachineID
      description: The mahine ID that is associated with the alert
      type: String
    - contextPath: MicrosoftATP.DomainAlert.Alerts.ComputerDNSName
      description: The machine DNS name
      type: String
    - contextPath: MicrosoftATP.DomainAlert.Alerts.AADTenantID
      description: The AAD tenant ID
      type: String
    - contextPath: MicrosoftATP.DomainAlert.Alerts.Comments.Comment
      description: The alert comment string
      type: String
    - contextPath: MicrosoftATP.DomainAlert.Alerts.Comments.CreatedBy
      description: The alert comment created by string
      type: String
    - contextPath: MicrosoftATP.DomainAlert.Alerts.Comments.CreatedTime
      description: The alert comment create time date
      type: Date
  - arguments:
    - default: false
      description: The domain address
      isArray: false
      name: domain
      required: true
      secret: false
    deprecated: false
    description: Retrieves a collection of machines that have communicated to or from
      a given domain address.
    execution: false
    name: microsoft-atp-get-domain-machines
    outputs:
    - contextPath: MicrosoftATP.DomainMachine.Domain
      description: The domain address
      type: String
    - contextPath: MicrosoftATP.DomainMachine.Machines.ID
      description: The machine ID
      type: String
    - contextPath: MicrosoftATP.DomainMachine.Machines.ComputerDNSName
      description: The machine DNS name
      type: String
    - contextPath: MicrosoftATP.DomainMachine.Machines.FirstSeen
      description: The first date and time where the machine was observed by Microsoft
        Defender ATP
      type: Date
    - contextPath: MicrosoftATP.DomainMachine.Machines.LastSeen
      description: The last date and time where the machine was observed by Microsoft
        Defender ATP
      type: Date
    - contextPath: MicrosoftATP.DomainMachine.Machines.OSPlatform
      description: The operating system platform
      type: String
    - contextPath: MicrosoftATP.DomainMachine.Machines.OSVersion
      description: The operating system Version
      type: String
    - contextPath: MicrosoftATP.DomainMachine.Machines.OSProcessor
      description: The operating system processor
      type: String
    - contextPath: MicrosoftATP.DomainMachine.Machines.LastIPAddress
      description: The last IP on the machine
      type: String
    - contextPath: MicrosoftATP.DomainMachine.Machines.LastExternalIPAddress
      description: The last IP through which the machine accessed the internet
      type: String
    - contextPath: MicrosoftATP.DomainMachine.Machines.OSBuild
      description: The operating system build number
      type: Number
    - contextPath: MicrosoftATP.DomainMachine.Machines.HealthStatus
      description: The machine health status
      type: String
    - contextPath: MicrosoftATP.DomainMachine.Machines.RBACGroupID
      description: The machine RBAC group ID
      type: Number
    - contextPath: MicrosoftATP.DomainMachine.Machines.RBACGroupName
      description: The machine RBAC group Name
      type: String
    - contextPath: MicrosoftATP.DomainMachine.Machines.RiskScore
      description: The machine risk score
      type: String
    - contextPath: MicrosoftATP.DomainMachine.Machines.ExposureLevel
      description: The machine exposure level
      type: String
    - contextPath: MicrosoftATP.DomainMachine.Machines.IsAADJoined
      description: True if machine is AAD joined, False otherwise
      type: Boolean
    - contextPath: MicrosoftATP.DomainMachine.Machines.AADDeviceID
      description: The AAD Device ID
      type: String
    - contextPath: MicrosoftATP.DomainMachine.Machines.MachineTags
      description: Set of machine tags
      type: String
  - arguments:
    - default: false
      description: File SHA1 hash to get statistics on.
      isArray: false
      name: file_hash
      required: true
      secret: false
    deprecated: false
    description: Retrieves the statistics for the given file.
    execution: false
    name: microsoft-atp-get-file-statistics
    outputs:
    - contextPath: MicrosoftATP.FileStatistics.Sha1
      description: The file SHA1 hash
      type: String
    - contextPath: MicrosoftATP.FileStatistics.Statistics.OrgPrevalence
      description: The prevalnce of the file in the organizetion
      type: String
    - contextPath: MicrosoftATP.FileStatistics.Statistics.OrgFirstSeen
      description: The first date and time the file was in the organizetion
      type: Date
    - contextPath: MicrosoftATP.FileStatistics.Statistics.OrgLastSeen
      description: The last date and time the file was in the organizetion
      type: Date
    - contextPath: MicrosoftATP.FileStatistics.Statistics.GlobalPrevalence
      description: The global prevalnce of the file
      type: String
    - contextPath: MicrosoftATP.FileStatistics.Statistics.GlobalFirstObserved
      description: The global first observetion date and time of the file
      type: Date
    - contextPath: MicrosoftATP.FileStatistics.Statistics.GlobalLastObserved
      description: The global last observetion date and time of the file
      type: Date
    - contextPath: MicrosoftATP.FileStatistics.Statistics.TopFileNames
      description: The file's top names
      type: String
  - arguments:
    - default: false
      description: File SHA1 hash to get statistics on.
      isArray: false
      name: file_hash
      required: true
      secret: false
    deprecated: false
    description: Retrieves a collection of alerts related to a given file hash.
    execution: false
    name: microsoft-atp-get-file-alerts
    outputs:
    - contextPath: MicrosoftATP.FileAlert.Sha1
      description: The file SHA1 hash
      type: String
    - contextPath: MicrosoftATP.FileAlert.Alerts.ID
      description: The alert ID
      type: String
    - contextPath: MicrosoftATP.FileAlert.Alerts.IncidentID
      description: The Incident ID of the Alert
      type: Number
    - contextPath: MicrosoftATP.FileAlert.Alerts.InvestigationID
      description: The Investigation ID related to the Alert
      type: Number
    - contextPath: MicrosoftATP.FileAlert.Alerts.InvestigationState
      description: The current state of the Investigation
      type: String
    - contextPath: MicrosoftATP.FileAlert.Alerts.AssignedTo
      description: The owner of the alert
      type: String
    - contextPath: MicrosoftATP.FileAlert.Alerts.Severity
      description: The severity of the alert
      type: String
    - contextPath: MicrosoftATP.FileAlert.Alerts.Status
      description: The current status of the alert
      type: String
    - contextPath: MicrosoftATP.FileAlert.Alerts.Classification
      description: The alert Classification
      type: String
    - contextPath: MicrosoftATP.FileAlert.Alerts.Determination
      description: The determination of the alert
      type: String
    - contextPath: MicrosoftATP.FileAlert.Alerts.DetectionSource
      description: The detection source
      type: String
    - contextPath: MicrosoftATP.FileAlert.Alerts.Category
      description: The category of the alert
      type: String
    - contextPath: MicrosoftATP.FileAlert.Alerts.ThreatFamilyName
      description: The threat family name
      type: String
    - contextPath: MicrosoftATP.FileAlert.Alerts.Title
      description: The alert title
      type: String
    - contextPath: MicrosoftATP.FileAlert.Alerts.Description
      description: The alert description
      type: String
    - contextPath: MicrosoftATP.FileAlert.Alerts.AlertCreationTime
      description: The date and time the alert was created
      type: Date
    - contextPath: MicrosoftATP.FileAlert.Alerts.FirstEventTime
      description: The first event time that triggered the alert on that machine
      type: Date
    - contextPath: MicrosoftATP.FileAlert.Alerts.LastEventTime
      description: The last event time that triggered the alert on that machine
      type: Date
    - contextPath: MicrosoftATP.FileAlert.Alerts.LastUpdateTime
      description: The first event time that triggered the alert on that machine
      type: Date
    - contextPath: MicrosoftATP.FileAlert.Alerts.ResolvedTime
      description: The date and time in which the status of the alert was changed
        to 'Resolved'
      type: Date
    - contextPath: MicrosoftATP.FileAlert.Alerts.MachineID
      description: The mahine ID that is associated with the alert
      type: String
    - contextPath: MicrosoftATP.FileAlert.Alerts.ComputerDNSName
      description: The machine DNS name
      type: String
    - contextPath: MicrosoftATP.FileAlert.Alerts.AADTenantID
      description: The AAD tenant ID
      type: String
    - contextPath: MicrosoftATP.FileAlert.Alerts.Comments.Comment
      description: The alert comment string
      type: String
    - contextPath: MicrosoftATP.FileAlert.Alerts.Comments.CreatedBy
      description: The alert comment created by string
      type: String
    - contextPath: MicrosoftATP.FileAlert.Alerts.Comments.CreatedTime
      description: The alert comment create time date
      type: Date
  - arguments:
    - default: false
      description: The IP address.
      isArray: false
      name: ip
      required: true
      secret: false
    deprecated: false
    description: Retrieves the statistics for the given IP.
    execution: false
    name: microsoft-atp-get-ip-statistics
    outputs:
    - contextPath: MicrosoftATP.IPStatistics.Statistics.IPAddress
      description: The IP address
      type: String
    - contextPath: MicrosoftATP.IPStatistics.Statistics.OrgPrevalence
      description: The prevalnce of the IP on the organizetion
      type: String
    - contextPath: MicrosoftATP.IPStatistics.Statistics.OrgFirstSeen
      description: The first date and time the IP was in the organizetion
      type: Date
    - contextPath: MicrosoftATP.IPStatistics.Statistics.OrgLastSeen
      description: The last date and time the IP was in the organizetion
      type: Date
  - arguments:
    - default: false
      description: The Ip address.
      isArray: false
      name: ip
      required: true
      secret: false
    deprecated: false
    description: Retrieves a collection of alerts related to a given IP address.
    execution: false
    name: microsoft-atp-get-ip-alerts
    outputs:
    - contextPath: MicrosoftATP.IPAlert.IPAddress
      description: The IP address
      type: String
    - contextPath: MicrosoftATP.IPAlert.Alerts.ID
      description: The alert ID
      type: String
    - contextPath: MicrosoftATP.IPAlert.Alerts.IncidentID
      description: The incident ID of the alert
      type: Number
    - contextPath: MicrosoftATP.IPAlert.Alerts.InvestigationID
      description: The investigation ID related to the alert
      type: Number
    - contextPath: MicrosoftATP.IPAlert.Alerts.InvestigationState
      description: The current state of the investigation
      type: String
    - contextPath: MicrosoftATP.IPAlert.Alerts.AssignedTo
      description: The owner of the alert
      type: String
    - contextPath: MicrosoftATP.IPAlert.Alerts.Severity
      description: The severity of the alert
      type: String
    - contextPath: MicrosoftATP.IPAlert.Alerts.Status
      description: The current status of the alert
      type: String
    - contextPath: MicrosoftATP.IPAlert.Alerts.Classification
      description: The alert classification
      type: String
    - contextPath: MicrosoftATP.IPAlert.Alerts.Determination
      description: The determination of the alert
      type: String
    - contextPath: MicrosoftATP.IPAlert.Alerts.DetectionSource
      description: The detection source
      type: String
    - contextPath: MicrosoftATP.IPAlert.Alerts.Category
      description: The category of the alert
      type: String
    - contextPath: MicrosoftATP.IPAlert.Alerts.ThreatFamilyName
      description: The threat family name
      type: String
    - contextPath: MicrosoftATP.IPAlert.Alerts.Title
      description: The alert title
      type: String
    - contextPath: MicrosoftATP.IPAlert.Alerts.Description
      description: The alert description
      type: String
    - contextPath: MicrosoftATP.IPAlert.Alerts.AlertCreationTime
      description: The date and time the alert was created
      type: Date
    - contextPath: MicrosoftATP.IPAlert.Alerts.FirstEventTime
      description: The first event time that triggered the alert on that machine
      type: Date
    - contextPath: MicrosoftATP.IPAlert.Alerts.LastEventTime
      description: The last event time that triggered the alert on that machine
      type: Date
    - contextPath: MicrosoftATP.IPAlert.Alerts.LastUpdateTime
      description: The first event time that triggered the alert on that machine
      type: Date
    - contextPath: MicrosoftATP.IPAlert.Alerts.ResolvedTime
      description: The date and time in which the status of the alert was changed
        to 'Resolved'
      type: Date
    - contextPath: MicrosoftATP.IPAlert.Alerts.MachineID
      description: The machine ID that is associated with the alert
      type: String
    - contextPath: MicrosoftATP.IPAlert.Alerts.ComputerDNSName
      description: The machine DNS name
      type: String
    - contextPath: MicrosoftATP.IPAlert.Alerts.AADTenantID
      description: The AAD tenant ID
      type: String
    - contextPath: MicrosoftATP.IPAlert.Alerts.Comments.Comment
      description: The alert comment string
      type: String
    - contextPath: MicrosoftATP.IPAlert.Alerts.Comments.CreatedBy
      description: The alert comment created by string
      type: String
    - contextPath: MicrosoftATP.IPAlert.Alerts.Comments.CreatedTime
      description: The alert comment create time date
      type: Date
  - arguments:
    - default: false
      description: |-
        The user ID.  Note that the ID is not the full UPN, but only the user name.
         (e.g., to retrieve alerts for user1@test.com use user1)
      isArray: false
      name: username
      required: true
      secret: false
    deprecated: false
    description: Retrieves a collection of alerts related to a given user ID.
    execution: false
    name: microsoft-atp-get-user-alerts
    outputs:
    - contextPath: MicrosoftATP.UserAlert.Username
      description: The user name
      type: String
    - contextPath: MicrosoftATP.UserAlert.Alerts.ID
      description: The alert ID
      type: String
    - contextPath: MicrosoftATP.UserAlert.Alerts.IncidentID
      description: The incident ID of the alert
      type: Number
    - contextPath: MicrosoftATP.UserAlert.Alerts.InvestigationID
      description: The investigation ID related to the alert
      type: Number
    - contextPath: MicrosoftATP.UserAlert.Alerts.InvestigationState
      description: The current state of the investigation
      type: String
    - contextPath: MicrosoftATP.UserAlert.Alerts.AssignedTo
      description: The owner of the alert
      type: String
    - contextPath: MicrosoftATP.UserAlert.Alerts.Severity
      description: The severity of the alert
      type: String
    - contextPath: MicrosoftATP.UserAlert.Alerts.Status
      description: The current status of the alert
      type: String
    - contextPath: MicrosoftATP.UserAlert.Alerts.Classification
      description: The alert classification
      type: String
    - contextPath: MicrosoftATP.UserAlert.Alerts.Determination
      description: The determination of the alert
      type: String
    - contextPath: MicrosoftATP.UserAlert.Alerts.DetectionSource
      description: The detection source
      type: String
    - contextPath: MicrosoftATP.UserAlert.Alerts.Category
      description: The category of the alert
      type: String
    - contextPath: MicrosoftATP.UserAlert.Alerts.ThreatFamilyName
      description: The threat family name
      type: String
    - contextPath: MicrosoftATP.UserAlert.Alerts.Title
      description: The alert title
      type: String
    - contextPath: MicrosoftATP.UserAlert.Alerts.Description
      description: The alert description
      type: String
    - contextPath: MicrosoftATP.UserAlert.Alerts.AlertCreationTime
      description: The date and time the alert was created
      type: Date
    - contextPath: MicrosoftATP.UserAlert.Alerts.FirstEventTime
      description: The first event time that triggered the alert on that machine
      type: Date
    - contextPath: MicrosoftATP.UserAlert.Alerts.LastEventTime
      description: The last event time that triggered the alert on that machine
      type: Date
    - contextPath: MicrosoftATP.UserAlert.Alerts.LastUpdateTime
      description: The first event time that triggered the alert on that machine
      type: Date
    - contextPath: MicrosoftATP.UserAlert.Alerts.ResolvedTime
      description: The date and time in which the status of the alert was changed
        to 'Resolved'
      type: Date
    - contextPath: MicrosoftATP.UserAlert.Alerts.MachineID
      description: The mahine ID that is associated with the alert
      type: String
    - contextPath: MicrosoftATP.UserAlert.Alerts.ComputerDNSName
      description: The machine DNS name
      type: String
    - contextPath: MicrosoftATP.UserAlert.Alerts.AADTenantID
      description: The AAD tenant ID
      type: String
    - contextPath: MicrosoftATP.UserAlert.Alerts.Comments.Comment
      description: The alert comment string
      type: String
    - contextPath: MicrosoftATP.UserAlert.Alerts.Comments.CreatedBy
      description: The alert comment created by string
      type: String
    - contextPath: MicrosoftATP.UserAlert.Alerts.Comments.CreatedTime
      description: The alert comment create time date
      type: Date
  - arguments:
    - default: false
      description: |-
        The user ID.  Note that the id is not the full UPN, but only the user name.
        (e.g., to retrieve machines for user1@test.com use user1)
      isArray: false
      name: username
      required: true
      secret: false
    deprecated: false
    description: Retrieves a collection of machines related to a given user ID.
    execution: false
    name: microsoft-atp-get-user-machines
    outputs:
    - contextPath: MicrosoftATP.UserMachine.Username
      description: The user name
      type: String
    - contextPath: MicrosoftATP.UserMachine.Machines.ID
      description: The machine ID
      type: String
    - contextPath: MicrosoftATP.UserMachine.Machines.ComputerDNSName
      description: The machine DNS name
      type: String
    - contextPath: MicrosoftATP.UserMachine.Machines.FirstSeen
      description: The first date and time where the machine was observed by Microsoft
        Defender ATP
      type: Date
    - contextPath: MicrosoftATP.UserMachine.Machines.LastSeen
      description: The last date and time where the machine was observed by Microsoft
        Defender ATP
      type: Date
    - contextPath: MicrosoftATP.UserMachine.Machines.OSPlatform
      description: The operating system platform
      type: String
    - contextPath: MicrosoftATP.UserMachine.Machines.OSVersion
      description: The operating system Version
      type: String
    - contextPath: MicrosoftATP.UserMachine.Machines.OSProcessor
      description: The operating system processor
      type: String
    - contextPath: MicrosoftATP.v.Machines.LastIPAddress
      description: The last IP on the machine
      type: String
    - contextPath: MicrosoftATP.UserMachine.Machines.LastExternalIPAddress
      description: The last IP through which the machine accessed the internet
      type: String
    - contextPath: MicrosoftATP.UserMachine.Machines.OSBuild
      description: The operating system build number
      type: Number
    - contextPath: MicrosoftATP.UserMachine.Machines.HealthStatus
      description: The machine health status
      type: String
    - contextPath: MicrosoftATP.UserMachine.Machines.RBACGroupID
      description: The machine RBAC group ID
      type: Number
    - contextPath: MicrosoftATP.UserMachine.Machines.RBACGroupName
      description: The machine RBAC group Name
      type: String
    - contextPath: MicrosoftATP.UserMachine.Machines.RiskScore
      description: The machine risk score
      type: String
    - contextPath: MicrosoftATP.UserMachine.Machines.ExposureLevel
      description: The machine exposure level
      type: String
    - contextPath: MicrosoftATP.UserMachine.Machines.IsAADJoined
      description: True if machine is AAD joined, False otherwise
      type: Boolean
    - contextPath: MicrosoftATP.UserMachine.Machines.AADDeviceID
      description: The AAD device ID
      type: String
    - contextPath: MicrosoftATP.UserMachine.Machines.MachineTags
      description: Set of machine tags
      type: String
  - arguments:
    - default: false
      description: The machine ID.
      isArray: false
      name: machine_id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: The action to use for the tag.
      isArray: false
      name: action
      predefined:
      - Add
      - Remove
      required: true
      secret: false
    - default: false
      description: The tag name.
      isArray: false
      name: tag
      required: true
      secret: false
    deprecated: false
    description: Adds or removes a tag on a specific Machine.
    execution: false
    name: microsoft-atp-add-remove-machine-tag
    outputs:
    - contextPath: MicrosoftATP.Machine.ID
      description: The machine ID
      type: String
    - contextPath: MicrosoftATP.Machine.ComputerDNSName
      description: The machine DNS name
      type: String
    - contextPath: MicrosoftATP.Machine.FirstSeen
      description: The first date and time where the machine was observed by Microsoft
        Defender ATP
      type: Date
    - contextPath: MicrosoftATP.Machine.LastSeen
      description: The last date and time where the machine was observed by Microsoft
        Defender ATP
      type: Date
    - contextPath: MicrosoftATP.Machine.OSPlatform
      description: The operating system platform
      type: String
    - contextPath: MicrosoftATP.Machine.OSVersion
      description: The operating system Version
      type: String
    - contextPath: MicrosoftATP.Machine.OSProcessor
      description: The operating system processor
      type: String
    - contextPath: MicrosoftATP.Machine.LastIPAddress
      description: The last IP on the machine
      type: String
    - contextPath: MicrosoftATP.Machine.LastExternalIPAddress
      description: The last IP through which the machine accessed the internet
      type: String
    - contextPath: MicrosoftATP.Machine.OSBuild
      description: The operating system build number
      type: Number
    - contextPath: MicrosoftATP.Machine.HealthStatus
      description: The machine health status
      type: String
    - contextPath: MicrosoftATP.Machine.RBACGroupID
      description: The machine RBAC group ID
      type: Number
    - contextPath: MicrosoftATP.Machine.RBACGroupName
      description: The machine RBAC group Name
      type: String
    - contextPath: MicrosoftATP.Machine.RiskScore
      description: The machine risk score
      type: String
    - contextPath: MicrosoftATP.Machine.ExposureLevel
      description: The machine exposure level
      type: String
    - contextPath: MicrosoftATP.Machine.IsAADJoined
      description: True if machine is AAD joined, False otherwise
      type: Boolean
    - contextPath: MicrosoftATP.Machine.AADDeviceID
      description: The AAD device ID
      type: String
    - contextPath: MicrosoftATP.Machine.MachineTags
      description: Set of machine tags
      type: String
  dockerimage: demisto/crypto:1.0.0.303
  feed: false
  isfetch: true
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  subtype: python3
  type: python
