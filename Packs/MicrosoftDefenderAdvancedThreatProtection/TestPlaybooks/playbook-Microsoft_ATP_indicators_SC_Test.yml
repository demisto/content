id: Microsoft Defender - ATP - Indicators SC Test
version: -1
name: Microsoft Defender - ATP - Indicators SC Test
starttaskid: '0'
tasks:
  '0':
    id: '0'
    taskid: 74728bab-1388-4155-82e6-5c9b0547b0df
    type: start
    task:
      id: 74728bab-1388-4155-82e6-5c9b0547b0df
      version: -1
      name: ''
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '20'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  '2':
    id: '2'
    taskid: 49bfa403-6d0a-4c21-8544-5b8a1e2acf0d
    type: regular
    task:
      id: 49bfa403-6d0a-4c21-8544-5b8a1e2acf0d
      version: -1
      name: Get indicators by ID
      description: Gets an indicator by its ID.
      script: '|||microsoft-atp-sc-indicator-get-by-id'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '13'
    scriptarguments:
      indicator_id:
        complex:
          root: MicrosoftATP.Indicators
          accessor: id
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1710
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  '6':
    id: '6'
    taskid: 7c23ecd0-20ab-44e0-86c5-4020a5695141
    type: regular
    task:
      id: 7c23ecd0-20ab-44e0-86c5-4020a5695141
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '8'
    scriptarguments:
      all:
        simple: yes
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 340
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  '8':
    id: '8'
    taskid: 7782e271-502c-4686-891c-aca8097162ce
    type: regular
    task:
      id: 7782e271-502c-4686-891c-aca8097162ce
      version: -1
      name: List indicators
      description: Lists all indicators by the ID that the system creates when the indicator is ingested.
      script: '|||microsoft-atp-sc-indicator-list'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '9'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 515
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  '9':
    id: '9'
    taskid: 9fb19dbf-cfb3-480a-84c1-ac40f68c75f3
    type: condition
    task:
      id: 9fb19dbf-cfb3-480a-84c1-ac40f68c75f3
      version: -1
      name: Check number of indicators
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      yes:
      - '19'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: greaterThanOrEqual
          left:
            value:
              complex:
                root: MicrosoftATP
                accessor: Indicators
                transformers:
                - operator: count
            iscontext: true
          right:
            value:
              simple: '0'
    view: |-
      {
        "position": {
          "x": 50,
          "y": 690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  '12':
    id: '12'
    taskid: c435a24b-1363-40a9-86ff-607feb780f64
    type: title
    task:
      id: c435a24b-1363-40a9-86ff-607feb780f64
      version: -1
      name: Continue the test
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '26'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  '13':
    id: '13'
    taskid: 6a4d0d6b-f9b1-46e9-8f30-9e6570fb7ddf
    type: regular
    task:
      id: 6a4d0d6b-f9b1-46e9-8f30-9e6570fb7ddf
      version: -1
      name: Update indicators description and severity
      description: Updates the specified indicator.
      script: '|||microsoft-atp-sc-indicator-update'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '31'
    scriptarguments:
      action:
        simple: Allowed
      expiration_time:
        simple: 1 day
      indicator_description:
        simple: newDescription
      indicator_title:
        simple: newTitle
      indicator_type:
        simple: IpAddress
      indicator_value:
        simple: 3.5.6.7
      severity:
        simple: Low
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1885
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  '17':
    id: '17'
    taskid: 36e7df25-9d64-402e-8104-019a301bea73
    type: title
    task:
      id: 36e7df25-9d64-402e-8104-019a301bea73
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ''
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3635
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  '19':
    id: '19'
    taskid: c74ad432-846a-4994-85d8-ee34e8c6e434
    type: regular
    task:
      id: c74ad432-846a-4994-85d8-ee34e8c6e434
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '12'
    scriptarguments:
      all:
        simple: yes
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 865
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  '20':
    id: '20'
    taskid: 1563457f-9f74-4c01-86d7-e17c251c4724
    type: title
    task:
      id: 1563457f-9f74-4c01-86d7-e17c251c4724
      version: -1
      name: Setup
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '6'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  '26':
    id: '26'
    taskid: 5883b50c-d1d2-4b9c-8346-e90719e2dd0f
    type: regular
    task:
      id: 5883b50c-d1d2-4b9c-8346-e90719e2dd0f
      version: -1
      name: microsoft-atp-sc-indicator-create
      description: Creates a new indicator.
      script: '|||microsoft-atp-sc-indicator-create'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '27'
    scriptarguments:
      action:
        simple: Allowed
      expiration_time:
        simple: 1 day
      indicator_description:
        simple: testPlaybook
      indicator_title:
        simple: test-title
      indicator_type:
        simple: IpAddress
      indicator_value:
        simple: 3.5.6.7
      severity:
        simple: Informational
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1185
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  '27':
    id: '27'
    taskid: f1158924-15e0-45db-81f2-f785d60ea072
    type: condition
    task:
      id: f1158924-15e0-45db-81f2-f785d60ea072
      version: -1
      name: Check the indicators returned with the High severity
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      yes:
      - '32'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: ${MicrosoftATP.Indicators.severity}
            iscontext: true
          right:
            value:
              simple: Informational
      - - operator: isNotEmpty
          left:
            value:
              simple: ${MicrosoftATP.Indicators.id}
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: ${MicrosoftATP.Indicators.description}
            iscontext: true
          right:
            value:
              simple: testPlaybook
      - - operator: isEqualString
          left:
            value:
              simple: ${MicrosoftATP.Indicators.title}
            iscontext: true
          right:
            value:
              simple: test-title
      - - operator: isEqualString
          left:
            value:
              simple: ${MicrosoftATP.Indicators.action}
            iscontext: true
          right:
            value:
              simple: Allowed
      - - operator: isEqualString
          left:
            value:
              simple: ${MicrosoftATP.Indicators.indicatorType}
            iscontext: true
          right:
            value:
              simple: IpAddress
      - - operator: isEqualString
          left:
            value:
              simple: ${MicrosoftATP.Indicators.indicatorValue}
            iscontext: true
          right:
            value:
              simple: 3.5.6.7
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1360
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  '28':
    id: '28'
    taskid: 291173f8-5980-4ab3-8665-45e7a632ccea
    type: regular
    task:
      id: 291173f8-5980-4ab3-8665-45e7a632ccea
      version: -1
      name: Get indicators by ID
      description: Gets an indicator by its ID.
      script: '|||microsoft-atp-sc-indicator-get-by-id'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '29'
    scriptarguments:
      indicator_id:
        complex:
          root: MicrosoftATP.Indicators
          accessor: id
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2235
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  '29':
    id: '29'
    taskid: ffa26205-c712-402e-8cd0-b40e92d0b95f
    type: condition
    task:
      id: ffa26205-c712-402e-8cd0-b40e92d0b95f
      version: -1
      name: Check the indicators returned with the Low severity and updated fields
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      yes:
      - "37"
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: ${MicrosoftATP.Indicators.severity}
            iscontext: true
          right:
            value:
              simple: Low
      - - operator: isNotEmpty
          left:
            value:
              simple: ${MicrosoftATP.Indicators.id}
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: ${MicrosoftATP.Indicators.description}
            iscontext: true
          right:
            value:
              simple: newDescription
      - - operator: isEqualString
          left:
            value:
              simple: ${MicrosoftATP.Indicators.title}
            iscontext: true
          right:
            value:
              simple: newTitle
      - - operator: isEqualString
          left:
            value:
              simple: ${MicrosoftATP.Indicators.action}
            iscontext: true
          right:
            value:
              simple: Allowed
      - - operator: isEqualString
          left:
            value:
              simple: ${MicrosoftATP.Indicators.indicatorType}
            iscontext: true
          right:
            value:
              simple: IpAddress
      - - operator: isEqualString
          left:
            value:
              simple: ${MicrosoftATP.Indicators.indicatorValue}
            iscontext: true
          right:
            value:
              simple: 3.5.6.7
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  '30':
    id: '30'
    taskid: 3171a852-63fa-4881-8398-cc7c5604e7c1
    type: regular
    task:
      id: 3171a852-63fa-4881-8398-cc7c5604e7c1
      version: -1
      name: Delete Indicator
      description: Deletes the specified indicator.
      script: '|||microsoft-atp-sc-indicator-delete'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - "33"
    scriptarguments:
      indicator_id:
        simple: ${MicrosoftATP.Indicators.id}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2760
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  '31':
    id: '31'
    taskid: 6508a62b-a764-43d5-8164-faa1a52814b1
    type: regular
    task:
      id: 6508a62b-a764-43d5-8164-faa1a52814b1
      version: -1
      name: sleep
      description: Sleep for X seconds
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '28'
    scriptarguments:
      seconds:
        simple: '5'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2060
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  '32':
    id: '32'
    taskid: b3be386c-abcf-426b-8813-9525d80214b6
    type: regular
    task:
      id: b3be386c-abcf-426b-8813-9525d80214b6
      version: -1
      name: sleep
      description: Sleep for X seconds
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '2'
    scriptarguments:
      seconds:
        simple: '5'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1535
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "33":
    id: "33"
    taskid: 953c4289-454d-498a-892f-cbcae5add4ea
    type: regular
    task:
      id: 953c4289-454d-498a-892f-cbcae5add4ea
      version: -1
      name: Set
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      key:
        simple: Indicators_id
      value:
        simple: ${MicrosoftATP.Indicators.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2935
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: ef714b52-677b-46ec-81cb-3fa95bad8768
    type: regular
    task:
      id: ef714b52-677b-46ec-81cb-3fa95bad8768
      version: -1
      name: Delete context
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "35"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: Indicators_id
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3110
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: 96a48a61-33b2-42b1-8112-e403189f186e
    type: regular
    task:
      id: 96a48a61-33b2-42b1-8112-e403189f186e
      version: -1
      name: Get indicators list
      description: Lists all indicators by the ID that the system creates when the indicator is ingested.
      script: '|||microsoft-atp-sc-indicator-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      indicator_value:
        simple: 3.5.6.7
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3285
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: f0ed0ed9-c80f-465a-8701-b494ff55c09f
    type: condition
    task:
      id: f0ed0ed9-c80f-465a-8701-b494ff55c09f
      version: -1
      name: indicator not in the list
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "17"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEmpty
          left:
            value:
              simple: MicrosoftATP.Indicators.value
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3460
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: 293aa809-765b-43ff-88e1-1dab193773e4
    type: regular
    task:
      id: 293aa809-765b-43ff-88e1-1dab193773e4
      version: -1
      name: sleep
      description: Sleep for X seconds
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      seconds:
        simple: "5"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2585
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 3650,
        "width": 380,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
fromversion: 5.0.0
description: Test all the indicators command which use the security center api.
