id: Test Playbook - MDE Malware - Incident Enrichment
version: -1
name: Test Playbook - MDE Malware - Incident Enrichment
description: "This playbook tests the ‘MDE Malware - Incident Enrichment’ playbook which is part of the ‘Malware Investigation and Response’ pack.\n\nThe following tests are conducted in the playbook:\n1- Confirm that incident fields were populated correctly by the custom output mapping rules and the 'setIncident' automation. \n2- Validate the enrichment of MDE alerts.\n3- Validate the enrichment of alerts and incident entities.\n3- Ensure that the context data was properly extracted.\n4. Check that the MDE alert information was correctly populated into the 'Alert' grid table of the Malware-Investigation and Response layout."
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: b4aa59cb-f8c6-4062-85aa-170a633cec49
    type: start
    task:
      id: b4aa59cb-f8c6-4062-85aa-170a633cec49
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "32"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": -1655
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: dd7a1dfc-3cc1-4119-812f-39e37f314748
    type: regular
    task:
      id: dd7a1dfc-3cc1-4119-812f-39e37f314748
      version: -1
      name: Delete Context
      description: The task deletes all of the context data. Having a clean beginning to a test playbook ensures that a test can be sterile and that unrelated issues can be eliminated.
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "293"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": -1525
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: 2b46f9ea-51bb-4ad7-8951-cd25beec329b
    type: title
    task:
      id: 2b46f9ea-51bb-4ad7-8951-cd25beec329b
      version: -1
      name: '''Extracted Indicators'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "79"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "64":
    id: "64"
    taskid: 1b89d0d7-6ece-41a0-84ba-f3bffb96ba3e
    type: title
    task:
      id: 1b89d0d7-6ece-41a0-84ba-f3bffb96ba3e
      version: -1
      name: '''File'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "457"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 2110
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "65":
    id: "65"
    taskid: febc97aa-0e51-43e3-8db2-b2e2b60cbab9
    type: title
    task:
      id: febc97aa-0e51-43e3-8db2-b2e2b60cbab9
      version: -1
      name: '''Endpoint'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "199"
      - "203"
      - "204"
      - "205"
      - "206"
      - "207"
      - "208"
      - "367"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 2835
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "67":
    id: "67"
    taskid: 45b55d8a-b432-4563-80c2-81d9d7062a48
    type: title
    task:
      id: 45b55d8a-b432-4563-80c2-81d9d7062a48
      version: -1
      name: '''Account'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "460"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 830
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "69":
    id: "69"
    taskid: 4885714b-4abb-447f-853a-f1aec8854d8e
    type: title
    task:
      id: 4885714b-4abb-447f-853a-f1aec8854d8e
      version: -1
      name: '''DBotScore'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "472"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 3400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "75":
    id: "75"
    taskid: 358d268a-0ffb-431b-85b9-90fde408b682
    type: condition
    task:
      id: 358d268a-0ffb-431b-85b9-90fde408b682
      version: -1
      name: Verify Alert ID
      description: |
        Verify that the ‘MicrosoftATP.Alert.ID’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "113"
      '#default#':
      - "114"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: ID
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: ID
                transformers:
                - operator: FirstArrayElement
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 1670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "78":
    id: "78"
    taskid: 2b4f888d-93d9-4bb7-8670-27467a68e2f8
    type: condition
    task:
      id: 2b4f888d-93d9-4bb7-8670-27467a68e2f8
      version: -1
      name: Verify MD5
      description: Verify that the 'File.MD5’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "142"
      Verified:
      - "128"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: File
                accessor: MD5
            iscontext: true
          right:
            value: {}
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1735,
          "y": 2415
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "79":
    id: "79"
    taskid: c25f4b10-3919-443b-8211-a634592e29cc
    type: condition
    task:
      id: c25f4b10-3919-443b-8211-a634592e29cc
      version: -1
      name: Verify Extracted Indicators
      description: Verify that the 'ExtractedIndicators’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "144"
      Verified:
      - "198"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: ExtractedIndicators
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "84":
    id: "84"
    taskid: 56ca6327-881e-440e-809e-6330a8becd4a
    type: title
    task:
      id: 56ca6327-881e-440e-809e-6330a8becd4a
      version: -1
      name: Start Tests
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "132"
      - "151"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": -690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "112":
    id: "112"
    taskid: dd7ac629-0990-4a07-847f-7191fdc73593
    type: title
    task:
      id: dd7ac629-0990-4a07-847f-7191fdc73593
      version: -1
      name: '''MicrosoftATP.Alert'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "75"
      - "294"
      - "296"
      - "300"
      - "310"
      - "316"
      - "320"
      - "324"
      - "328"
      - "334"
      - "336"
      - "338"
      - "346"
      - "348"
      - "473"
      - "475"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 1520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "113":
    id: "113"
    taskid: 398e5e7c-d0a9-40d7-8cfc-fd5e18891bc8
    type: title
    task:
      id: 398e5e7c-d0a9-40d7-8cfc-fd5e18891bc8
      version: -1
      name: Done verifying 'MicrosoftATP.Alert'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 7165,
          "y": 1870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "114":
    id: "114"
    taskid: bb9ec25a-a719-49c2-8e5b-127204004f7f
    type: regular
    task:
      id: bb9ec25a-a719-49c2-8e5b-127204004f7f
      version: -1
      name: Verify Context Error - Alert ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'MicrosoftATP.Alert.ID' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.ID' context key. \n2- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "125":
    id: "125"
    taskid: 45b9478a-38f8-4d6c-894d-981d668b89d6
    type: regular
    task:
      id: 45b9478a-38f8-4d6c-894d-981d668b89d6
      version: -1
      name: Verify Context Error  - Hostname
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.Hostname’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.Hostname' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task.\n3- The 'devicename' input configuration was changed for the 'setIncident' automation used in the 'Set Endpoint information to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3320,
          "y": 3225
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "126":
    id: "126"
    taskid: 4754de33-6470-4441-8400-061a6d2e16c1
    type: title
    task:
      id: 4754de33-6470-4441-8400-061a6d2e16c1
      version: -1
      name: Done verifying 'DBotScore' context
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2500,
          "y": 3885
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "127":
    id: "127"
    taskid: b4277cd5-15a4-4ada-8aed-846cfc7b3df3
    type: title
    task:
      id: b4277cd5-15a4-4ada-8aed-846cfc7b3df3
      version: -1
      name: Done verifying 'Endpoint'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4130,
          "y": 3180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "128":
    id: "128"
    taskid: a3435387-8a80-46c8-81f3-11bea647803c
    type: title
    task:
      id: a3435387-8a80-46c8-81f3-11bea647803c
      version: -1
      name: Done verifying 'File'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2925,
          "y": 2605
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "131":
    id: "131"
    taskid: a9ccc409-8d5b-47cb-8100-3cda841eab73
    type: title
    task:
      id: a9ccc409-8d5b-47cb-8100-3cda841eab73
      version: -1
      name: Done verifying 'Account' context
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3325,
          "y": 1320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "132":
    id: "132"
    taskid: bf3614bb-e04e-4520-813d-6dbc718cb1d6
    type: title
    task:
      id: bf3614bb-e04e-4520-813d-6dbc718cb1d6
      version: -1
      name: Check Incident Fields
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "137"
      - "372"
      - "375"
      - "378"
      - "381"
      - "384"
      - "387"
      - "390"
      - "393"
      - "396"
      - "399"
      - "402"
      - "405"
      - "408"
      - "411"
      - "414"
      - "417"
      - "420"
      - "423"
      - "426"
      - "429"
      - "432"
      - "435"
      - "438"
      - "447"
      - "450"
      - "453"
      - "456"
      - "439"
      - "442"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": -550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "136":
    id: "136"
    taskid: accb53f8-cd33-4066-8023-e96af3889ebe
    type: title
    task:
      id: accb53f8-cd33-4066-8023-e96af3889ebe
      version: -1
      name: Done verifying Incident Fields
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 12740,
          "y": -50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "137":
    id: "137"
    taskid: 4d96b7d9-57ec-4ac3-84e0-a983b8dcd329
    type: condition
    task:
      id: 4d96b7d9-57ec-4ac3-84e0-a983b8dcd329
      version: -1
      name: Verify Alerts And Related Info
      description: |-
        Verify that the ‘alertsandrelatedinfo’ incident field was filled out correctly.
        These Incident Field are affecting the incident layouts (grid_id).
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "138"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: incident.alertsandrelatedinfo.alertname
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: AlertName
            iscontext: true
          ignorecase: true
      - - operator: containsGeneral
          left:
            value:
              simple: incident.alertsandrelatedinfo.hostname
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: device_name
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "138":
    id: "138"
    taskid: 6b1289cf-7663-4123-8120-17e3be3d238e
    type: regular
    task:
      id: 6b1289cf-7663-4123-8120-17e3be3d238e
      version: -1
      name: Verify Incident Field Error - Alerts And Related Info
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'alertsandrelatedinfo' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:
          1- The 'grid_id' input configuration was changed for the 'SetGridField' automation used in the 'Set Alerts Table Info in the Layout' task.
          2- The 'columns' input configuration was changed for the 'SetGridField' automation used in the 'Set Alerts Table Info in the Layout' task.
          3- The 'context_path' input configuration was changed for the 'SetGridField' automation used in the 'Set Alerts Table Info in the Layout' task.
          4- The 'keys' input configuration was changed for the 'SetGridField' automation used in the 'Set Alerts Table Info in the Layout' task.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "142":
    id: "142"
    taskid: 12b6c91c-c9f4-4a94-8de8-437bb0a49369
    type: regular
    task:
      id: 12b6c91c-c9f4-4a94-8de8-437bb0a49369
      version: -1
      name: Verify Context Error - MD5
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'File.MD5’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'MDE Malware - Incident Enrichment' playbook:\n1- The 'file' automation outputs have been modified and no longer contain the 'File.MD5' context key. \n2- The 'file' input configuration was changed for the 'file' automation used in the 'Hash Enrichment' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1735,
          "y": 2635
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "144":
    id: "144"
    taskid: 16025a92-bee4-478d-8fd6-50f13d332be9
    type: regular
    task:
      id: 16025a92-bee4-478d-8fd6-50f13d332be9
      version: -1
      name: Verify Context Error - Extracted Indicators
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'ExtractedIndicators' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:
          1- The 'text' input configuration was changed for the 'extractIndicators' automation used in the 'Extract Indicators' task.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 640
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "149":
    id: "149"
    taskid: 88b21cff-b81d-41fb-8a83-28bb7f3435f0
    type: regular
    task:
      id: 88b21cff-b81d-41fb-8a83-28bb7f3435f0
      version: -1
      name: Set Incident Fields To Context
      description: Add incident fields required for testing to the mock incident.
      script: Builtin|||setIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "292"
    scriptarguments:
      alertname:
        complex:
          root: MicrosoftATP.Alert
          accessor: Title
          transformers:
          - operator: FirstArrayElement
          filters:
          - - operator: isNotEmpty
              left:
                value:
                  simple: MicrosoftATP.Alert.Evidence
                iscontext: true
      alertsandrelatedinfo:
        simple: '[{"columnheader3":""},{},{}]'
      externalendtime:
        complex:
          root: MicrosoftATP.Alert
          accessor: LastUpdateTime
          filters:
          - - operator: isNotEmpty
              left:
                value:
                  simple: MicrosoftATP.Alert.Evidence
                iscontext: true
      externalstarttime:
        complex:
          root: MicrosoftATP.Alert
          accessor: FirstEventTime
          filters:
          - - operator: isNotEmpty
              left:
                value:
                  simple: MicrosoftATP.Alert.Evidence
                iscontext: true
      externalsystemid:
        complex:
          root: MDE.Alert.value
          accessor: id
          transformers:
          - operator: FirstArrayElement
      type:
        simple: Malware Investigation and Response
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": -1010
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "151":
    id: "151"
    taskid: 0cfdf738-9b46-4f88-863e-80420a5f3c72
    type: title
    task:
      id: 0cfdf738-9b46-4f88-863e-80420a5f3c72
      version: -1
      name: Check Context Data
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "63"
      - "67"
      - "112"
      - "64"
      - "69"
      - "65"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": 125
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "198":
    id: "198"
    taskid: 67e35ae5-7a87-4a84-8cdd-6cac9f6d700f
    type: title
    task:
      id: 67e35ae5-7a87-4a84-8cdd-6cac9f6d700f
      version: -1
      name: Done verifying 'Extracted Indicators'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1315,
          "y": 600
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "199":
    id: "199"
    taskid: 3f8f6a19-c092-41c0-8bd2-6f7316e42baf
    type: condition
    task:
      id: 3f8f6a19-c092-41c0-8bd2-6f7316e42baf
      version: -1
      name: Verify Hostname
      description: Verify that the 'Endpoint.Hostname’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "125"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: devicename
            iscontext: true
          right:
            value:
              complex:
                root: Endpoint
                accessor: Hostname
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3325,
          "y": 2980
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "203":
    id: "203"
    taskid: fc5686ff-cc49-4a7c-85b7-e46829cb2d25
    type: condition
    task:
      id: fc5686ff-cc49-4a7c-85b7-e46829cb2d25
      version: -1
      name: Verify OS
      description: Verify that the 'Endpoint.OS’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "210"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: deviceosname
            iscontext: true
          right:
            value:
              complex:
                root: Endpoint
                accessor: OS
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2935,
          "y": 2980
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "204":
    id: "204"
    taskid: 16bba2bf-e5e1-4774-8111-109586befe92
    type: condition
    task:
      id: 16bba2bf-e5e1-4774-8111-109586befe92
      version: -1
      name: Verify MAC Address
      description: Verify that the 'Endpoint.MACAddress’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "211"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: devicemacaddress
            iscontext: true
          right:
            value:
              complex:
                root: Endpoint
                accessor: MACAddress
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2545,
          "y": 2980
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "205":
    id: "205"
    taskid: 24b5f09b-723b-4c34-84f4-c31f49598b19
    type: condition
    task:
      id: 24b5f09b-723b-4c34-84f4-c31f49598b19
      version: -1
      name: Verify Vendor
      description: Verify that the 'Endpoint.Vendor’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "212"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: Endpoint
                accessor: Vendor
            iscontext: true
          right:
            value: {}
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2135,
          "y": 2980
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "206":
    id: "206"
    taskid: 153da2e2-ec90-4891-8a60-ef2eb3136432
    type: condition
    task:
      id: 153da2e2-ec90-4891-8a60-ef2eb3136432
      version: -1
      name: Verify IP Address
      description: Verify that the 'Endpoint.IPAddress’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "213"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: devicelocalip
            iscontext: true
          right:
            value:
              complex:
                root: Endpoint
                accessor: IPAddress
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1735,
          "y": 2980
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "207":
    id: "207"
    taskid: 8982458e-3e06-4974-805b-e5d1dea9c7d2
    type: condition
    task:
      id: 8982458e-3e06-4974-805b-e5d1dea9c7d2
      version: -1
      name: Verify Status
      description: Verify that the 'Endpoint.Status’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "214"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: devicestatus
            iscontext: true
          right:
            value:
              complex:
                root: Endpoint
                accessor: Status
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 2980
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "208":
    id: "208"
    taskid: 10254cff-a7ae-4f7a-8a9b-b591ef1ea554
    type: condition
    task:
      id: 10254cff-a7ae-4f7a-8a9b-b591ef1ea554
      version: -1
      name: Verify Endpoint ID
      description: Verify that the 'Endpoint.ID’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "215"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: deviceid
            iscontext: true
          right:
            value:
              complex:
                root: Endpoint
                accessor: ID
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 2980
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "210":
    id: "210"
    taskid: 8537a82a-7258-4dc4-833b-9d51a011e0fb
    type: regular
    task:
      id: 8537a82a-7258-4dc4-833b-9d51a011e0fb
      version: -1
      name: Verify Context Error  -  OS
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.OS’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.OS' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task.\n3- The 'deviceosname' input configuration was changed for the 'setIncident' automation used in the 'Set Endpoint information to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2925,
          "y": 3225
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "211":
    id: "211"
    taskid: 7de6a94f-0a12-41ae-8803-e6eb5c5c9d53
    type: regular
    task:
      id: 7de6a94f-0a12-41ae-8803-e6eb5c5c9d53
      version: -1
      name: Verify Context Error  - MAC Address
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.MACAddress’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.MACAddress' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task.\n3- The 'devicemacaddress' input configuration was changed for the 'setIncident' automation used in the 'Set Endpoint information to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2525,
          "y": 3225
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "212":
    id: "212"
    taskid: e3ad3fac-3557-42bb-8faa-5855702c9631
    type: regular
    task:
      id: e3ad3fac-3557-42bb-8faa-5855702c9631
      version: -1
      name: Verify Context Error  - Vendor
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.Vendor’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.Vendor' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2120,
          "y": 3225
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "213":
    id: "213"
    taskid: 78237af5-12e9-479a-8683-922bf53363c7
    type: regular
    task:
      id: 78237af5-12e9-479a-8683-922bf53363c7
      version: -1
      name: Verify Context Error  - IP Address
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.IPAddress’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.IPAddress' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task.\n3- The 'devicelocalip' input configuration was changed for the 'setIncident' automation used in the 'Set Endpoint information to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1735,
          "y": 3225
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "214":
    id: "214"
    taskid: c59bb83e-826d-4aa7-8099-493bc07aef8f
    type: regular
    task:
      id: c59bb83e-826d-4aa7-8099-493bc07aef8f
      version: -1
      name: Verify Context Error  - Status
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.Status’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.Status' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task.\n3- The 'devicestatus' input configuration was changed for the 'setIncident' automation used in the 'Set Endpoint information to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1335,
          "y": 3225
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "215":
    id: "215"
    taskid: 06780a48-5d72-4ba6-8ba0-9bd07ac3245d
    type: regular
    task:
      id: 06780a48-5d72-4ba6-8ba0-9bd07ac3245d
      version: -1
      name: Verify Context Error  - Endpoint ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.ID’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.ID' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task.\n3- The 'deviceid' input configuration was changed for the 'setIncident' automation used in the 'Set Endpoint information to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 3225
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "218":
    id: "218"
    taskid: 59afe935-ddef-434e-8f4c-0b085001eedf
    type: condition
    task:
      id: 59afe935-ddef-434e-8f4c-0b085001eedf
      version: -1
      name: Verify SHA265
      description: Verify that the 'File.SHA256’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "219"
      Verified:
      - "128"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: File
                accessor: SHA265
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1335,
          "y": 2415
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "219":
    id: "219"
    taskid: 05a6f22d-bc21-4948-8494-e7b05c7751df
    type: regular
    task:
      id: 05a6f22d-bc21-4948-8494-e7b05c7751df
      version: -1
      name: Verify Context Error - SHA265
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'File.SHA256’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'MDE Malware - Incident Enrichment' playbook:\n1- The 'file' automation outputs have been modified and no longer contain the 'File.SHA256' context key. \n2- The 'file' input configuration was changed for the 'file' automation used in the 'Hash Enrichment' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 2635
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "220":
    id: "220"
    taskid: 2c673497-86b8-469e-8c0c-7e1e52f085bb
    type: condition
    task:
      id: 2c673497-86b8-469e-8c0c-7e1e52f085bb
      version: -1
      name: Verify Name
      description: Verify that the 'File.Name’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "221"
      Verified:
      - "128"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: File
                accessor: Name
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 2415
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "221":
    id: "221"
    taskid: 8dcc07e6-6d69-4ae2-8091-ed69eab7f19f
    type: regular
    task:
      id: 8dcc07e6-6d69-4ae2-8091-ed69eab7f19f
      version: -1
      name: Verify Context Error - Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'File.Name’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'MDE Malware - Incident Enrichment' playbook:\n1- The 'file' automation outputs have been modified and no longer contain the 'File.Name' context key. \n2- The 'file' input configuration was changed for the 'file' automation used in the 'Hash Enrichment' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 2635
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "265":
    id: "265"
    taskid: 386110e7-f22a-49f0-86ae-cb5fe23db6ee
    type: condition
    task:
      id: 386110e7-f22a-49f0-86ae-cb5fe23db6ee
      version: -1
      name: Verify Context - Indicator
      description: Verify that the 'DBotScore.Indicator’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "266"
      Verified:
      - "126"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: DBotScore
                accessor: Indicator
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 3700
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "266":
    id: "266"
    taskid: 0c8285b8-ef72-418b-8625-113158fe38ca
    type: regular
    task:
      id: 0c8285b8-ef72-418b-8625-113158fe38ca
      version: -1
      name: Verify Context Error  - Indicator
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'DBotScore.Indicator’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'file' automation outputs have been modified and no longer contain the 'DBotScore.Indicator' context key. \n2- The 'file' input configuration was changed for the 'file' automation used in the 'Hash Enrichment' task.\n3- The 'file' input configuration was changed for the 'file' automation used in the 'Hash Enrichment' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 3930
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "277":
    id: "277"
    taskid: e9470f9c-6b89-44cd-8e0e-e0c01d0799bc
    type: title
    task:
      id: e9470f9c-6b89-44cd-8e0e-e0c01d0799bc
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 12810,
          "y": 4230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "292":
    id: "292"
    taskid: dc595628-9aac-40d0-8f54-cba62f5f6574
    type: playbook
    task:
      id: dc595628-9aac-40d0-8f54-cba62f5f6574
      version: -1
      name: MDE Malware - Incident Enrichment
      description: |-
        This playbook is part of the 'Malware Investigation And Response' pack. For more information, refer to https://xsoar.pan.dev/docs/reference/packs/malware-investigation-and-response.
        This playbook enriches Microsoft Defender For Endpoint alerts. The enrichment is done on the involved endpoint and Mitre technique ID information, and it sets the 'Malware-Investigation and Response' layout.
      playbookName: MDE Malware - Incident Enrichment
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "84"
    scriptarguments:
      AlertID:
        simple: ${incident.externalsystemid}
      DidAlertOriginateFromSIEM:
        simple: "No"
    separatecontext: false
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 590,
          "y": -850
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "293":
    id: "293"
    taskid: c172aa32-268e-4d71-8367-8328dba12cf3
    type: regular
    task:
      id: c172aa32-268e-4d71-8367-8328dba12cf3
      version: -1
      name: Get MDE Available Alerts
      description: Gets a list of alerts present on the system. Filtering can be done only on a single argument.
      script: '|||microsoft-atp-list-alerts'
      type: regular
      iscommand: true
      brand: Microsoft Defender Advanced Threat Protection
    nexttasks:
      '#none#':
      - "370"
    scriptarguments:
      extend-context:
        simple: MDE.Alert=
      ignore-outputs:
        simple: "true"
      limit:
        simple: "60"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": -1360
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "294":
    id: "294"
    taskid: 0737660c-e074-4ab4-8abe-16747f8f19b4
    type: condition
    task:
      id: 0737660c-e074-4ab4-8abe-16747f8f19b4
      version: -1
      name: Verify Incident ID
      description: |
        Verify that the ‘MicrosoftATP.Alert.IncidentID’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "113"
      '#default#':
      - "295"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: IncidentID
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1320,
          "y": 1670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "295":
    id: "295"
    taskid: 78612422-2192-4539-8c58-3c6dc1bc8107
    type: regular
    task:
      id: 78612422-2192-4539-8c58-3c6dc1bc8107
      version: -1
      name: Verify Context Error - Incident ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'MicrosoftATP.Alert.IncidentID' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.IncidentID' context key. \n2- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1320,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "296":
    id: "296"
    taskid: 62f820b2-50a7-487e-802f-1519aca5a12c
    type: condition
    task:
      id: 62f820b2-50a7-487e-802f-1519aca5a12c
      version: -1
      name: Verify Investigation ID
      description: |
        Verify that the ‘MicrosoftATP.Alert.InvestigationID’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "113"
      '#default#':
      - "297"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: InvestigationID
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1710,
          "y": 1670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "297":
    id: "297"
    taskid: 1ab6ac80-2307-4ef1-864d-e1ec86ab95bf
    type: regular
    task:
      id: 1ab6ac80-2307-4ef1-864d-e1ec86ab95bf
      version: -1
      name: Verify Context Error - Investigation ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'MicrosoftATP.Alert.InvestigationID' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.InvestigationID' context key. \n2- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1710,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "300":
    id: "300"
    taskid: 3e36d6bd-8eeb-42e5-896b-cbb186eaa454
    type: condition
    task:
      id: 3e36d6bd-8eeb-42e5-896b-cbb186eaa454
      version: -1
      name: Verify Assigned To
      description: |
        Verify that the ‘MicrosoftATP.Alert.AssignedTo’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "113"
      '#default#':
      - "301"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: AssignedTo
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2100,
          "y": 1670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "301":
    id: "301"
    taskid: 63cf012a-421f-49af-80ca-d46929b9f45f
    type: regular
    task:
      id: 63cf012a-421f-49af-80ca-d46929b9f45f
      version: -1
      name: Verify Context Error - Assigned To
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'MicrosoftATP.Alert.AssignedTo' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.AssignedTo' context key. \n2- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2100,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "310":
    id: "310"
    taskid: d3cfb55c-829c-425c-84bb-e7fa172c1b03
    type: condition
    task:
      id: d3cfb55c-829c-425c-84bb-e7fa172c1b03
      version: -1
      name: Verify Detection Source
      description: |
        Verify that the ‘MicrosoftATP.Alert.DetectionSource’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "113"
      '#default#':
      - "311"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: DetectionSource
            iscontext: true
          right:
            value: {}
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3265,
          "y": 1670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "311":
    id: "311"
    taskid: 25e7a58a-da3a-4a62-82b7-53c39e6ffbdf
    type: regular
    task:
      id: 25e7a58a-da3a-4a62-82b7-53c39e6ffbdf
      version: -1
      name: Verify Context Error - Detection Source
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'MicrosoftATP.Alert.DetectionSource' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.DetectionSource' context key. \n2- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3265,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "316":
    id: "316"
    taskid: 3c208ce6-ab46-4ec1-869d-e9e79cbd0a02
    type: condition
    task:
      id: 3c208ce6-ab46-4ec1-869d-e9e79cbd0a02
      version: -1
      name: Verify Title
      description: |
        Verify that the ‘MicrosoftATP.Alert.Title’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "113"
      '#default#':
      - "317"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: Title
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3655,
          "y": 1670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "317":
    id: "317"
    taskid: a0cc6ee2-f911-42ec-8efc-41ffe302e9b8
    type: regular
    task:
      id: a0cc6ee2-f911-42ec-8efc-41ffe302e9b8
      version: -1
      name: Verify Context Error - Title
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'MicrosoftATP.Alert.Title' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.Title' context key. \n2- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3655,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "320":
    id: "320"
    taskid: 2e5e8dfc-9742-4443-8710-330b41383c44
    type: condition
    task:
      id: 2e5e8dfc-9742-4443-8710-330b41383c44
      version: -1
      name: Verify Alert Creation Time
      description: |
        Verify that the ‘MicrosoftATP.Alert.AlertCreationTime’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "113"
      '#default#':
      - "321"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: AlertCreationTime
            iscontext: true
          right:
            value: {}
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4045,
          "y": 1670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "321":
    id: "321"
    taskid: 7bbf8faa-344d-4f49-8579-a7d2455ab216
    type: regular
    task:
      id: 7bbf8faa-344d-4f49-8579-a7d2455ab216
      version: -1
      name: Verify Context Error - Alert Creation Time
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'MicrosoftATP.Alert.AlertCreationTime' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.AlertCreationTime' context key. \n2- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4045,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "324":
    id: "324"
    taskid: 84ae11ac-bb4d-4fa4-886c-bb937525ef17
    type: condition
    task:
      id: 84ae11ac-bb4d-4fa4-886c-bb937525ef17
      version: -1
      name: Verify Last Event Time
      description: |
        Verify that the ‘MicrosoftATP.Alert.LastEventTime’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "113"
      '#default#':
      - "325"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: LastEventTime
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4435,
          "y": 1670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "325":
    id: "325"
    taskid: 3809f690-eed4-45f4-8bf3-99c46c14325e
    type: regular
    task:
      id: 3809f690-eed4-45f4-8bf3-99c46c14325e
      version: -1
      name: Verify Context Error - Last Event Time
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'MicrosoftATP.Alert.LastEventTime' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.LastEventTime' context key. \n2- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4435,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "328":
    id: "328"
    taskid: 4f0bf939-d5ea-4a15-8907-dbdb8c3fb027
    type: condition
    task:
      id: 4f0bf939-d5ea-4a15-8907-dbdb8c3fb027
      version: -1
      name: Verify Resolved Time
      description: |
        Verify that the ‘MicrosoftATP.Alert.ResolvedTime’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "113"
      '#default#':
      - "329"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: ResolvedTime
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4825,
          "y": 1670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "329":
    id: "329"
    taskid: 83c4b30f-f8bd-4c4e-8f00-3638db87ebd8
    type: regular
    task:
      id: 83c4b30f-f8bd-4c4e-8f00-3638db87ebd8
      version: -1
      name: Verify Context Error - Resolved Time
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'MicrosoftATP.Alert.ResolvedTime' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.ResolvedTime' context key. \n2- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4825,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "334":
    id: "334"
    taskid: 512d8d17-06aa-4fad-879a-7aab6e553394
    type: condition
    task:
      id: 512d8d17-06aa-4fad-879a-7aab6e553394
      version: -1
      name: Verify AAD Tenant ID
      description: |
        Verify that the ‘MicrosoftATP.Alert.AADTenantID’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "113"
      '#default#':
      - "335"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: AADTenantID
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5215,
          "y": 1670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "335":
    id: "335"
    taskid: c2bca970-e070-4b44-854b-af815dc2bea5
    type: regular
    task:
      id: c2bca970-e070-4b44-854b-af815dc2bea5
      version: -1
      name: Verify Context Error - AAD Tenant ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'MicrosoftATP.Alert.AADTenantID' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.AADTenantID' context key. \n2- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5215,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "336":
    id: "336"
    taskid: 69a6890e-5c80-40a6-885a-76efd7dbd543
    type: condition
    task:
      id: 69a6890e-5c80-40a6-885a-76efd7dbd543
      version: -1
      name: Verify Evidence
      description: |
        Verify that the ‘MicrosoftATP.Alert.Evidence’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "113"
      '#default#':
      - "337"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: Evidence
            iscontext: true
          right:
            value: {}
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5605,
          "y": 1670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "337":
    id: "337"
    taskid: 3b3beacc-db70-4a25-8a42-dcf4ef16e370
    type: regular
    task:
      id: 3b3beacc-db70-4a25-8a42-dcf4ef16e370
      version: -1
      name: Verify Context Error - Evidence
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'MicrosoftATP.Alert.Evidence' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.Evidence' context key. \n2- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5605,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "338":
    id: "338"
    taskid: 4aceb4bd-fe8e-4963-8a96-b6c9314d48da
    type: condition
    task:
      id: 4aceb4bd-fe8e-4963-8a96-b6c9314d48da
      version: -1
      name: Verify Detector ID
      description: |
        Verify that the ‘MicrosoftATP.Alert.DetectorID’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "113"
      '#default#':
      - "339"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: DetectorID
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5995,
          "y": 1670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "339":
    id: "339"
    taskid: 4b46d40b-80d0-448b-80b2-2c6de1b01aa4
    type: regular
    task:
      id: 4b46d40b-80d0-448b-80b2-2c6de1b01aa4
      version: -1
      name: Verify Context Error - Detector ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'MicrosoftATP.Alert.DetectorID' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.DetectorID' context key. \n2- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5995,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "346":
    id: "346"
    taskid: 721f8fc9-db15-467a-8c0a-fea9a827c72f
    type: condition
    task:
      id: 721f8fc9-db15-467a-8c0a-fea9a827c72f
      version: -1
      name: Verify RBAC Group Name
      description: |
        Verify that the ‘MicrosoftATP.Alert.RBACGroupName’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "113"
      '#default#':
      - "347"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: RBACGroupName
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6395,
          "y": 1670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "347":
    id: "347"
    taskid: a5e5cd28-1738-4fd0-84b9-d9777cfbfb54
    type: regular
    task:
      id: a5e5cd28-1738-4fd0-84b9-d9777cfbfb54
      version: -1
      name: Verify Context Error - RBAC Group Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'MicrosoftATP.Alert.RBACGroupName' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.RBACGroupName' context key. \n2- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6395,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "348":
    id: "348"
    taskid: 38377b78-a8c8-40f5-8023-8b6dccd26b31
    type: condition
    task:
      id: 38377b78-a8c8-40f5-8023-8b6dccd26b31
      version: -1
      name: Verify Comments
      description: |
        Verify that the ‘MicrosoftATP.Alert.Comments.’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "113"
      '#default#':
      - "349"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: Comments
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6785,
          "y": 1670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "349":
    id: "349"
    taskid: 9aef62ae-c0b1-4000-8eab-78f4a4c8473b
    type: regular
    task:
      id: 9aef62ae-c0b1-4000-8eab-78f4a4c8473b
      version: -1
      name: Verify Context Error - Comments
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'MicrosoftATP.Alert.Comments' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.Comments' context key. \n2- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6785,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "354":
    id: "354"
    taskid: f07d1035-355c-4484-8a58-9e4416a4f71c
    type: condition
    task:
      id: f07d1035-355c-4484-8a58-9e4416a4f71c
      version: -1
      name: Verify SHA1
      description: Verify that the 'File.SHA1’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "355"
      Verified:
      - "128"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: File
                accessor: SHA1
            iscontext: true
          right:
            value: {}
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2125,
          "y": 2415
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "355":
    id: "355"
    taskid: 7cb086c4-f063-46bf-8849-ac2b7ae50e48
    type: regular
    task:
      id: 7cb086c4-f063-46bf-8849-ac2b7ae50e48
      version: -1
      name: Verify Context Error - SHA1
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'File.SHA1’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'MDE Malware - Incident Enrichment' playbook:\n1- The 'file' automation outputs have been modified and no longer contain the 'File.SHA1' context key. \n2- The 'file' input configuration was changed for the 'file' automation used in the 'Hash Enrichment' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2125,
          "y": 2635
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "356":
    id: "356"
    taskid: a2b6a393-6953-4ce9-8c75-aa9baac160c0
    type: condition
    task:
      id: a2b6a393-6953-4ce9-8c75-aa9baac160c0
      version: -1
      name: Verify Tags
      description: Verify that the 'File.Tags’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "357"
      Verified:
      - "128"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: Tags
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2520,
          "y": 2415
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "357":
    id: "357"
    taskid: e2dc32bc-4e4a-4dcd-8f0e-aed922545778
    type: regular
    task:
      id: e2dc32bc-4e4a-4dcd-8f0e-aed922545778
      version: -1
      name: Verify Context Error - Tags
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'File.Tags’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'MDE Malware - Incident Enrichment' playbook:\n1- The 'file' automation outputs have been modified and no longer contain the 'File.Tags' context key. \n2- The 'file' input configuration was changed for the 'file' automation used in the 'Hash Enrichment' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2515,
          "y": 2635
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "358":
    id: "358"
    taskid: 1ae2a67f-34bd-4627-8785-77c19f9c9b4e
    type: condition
    task:
      id: 1ae2a67f-34bd-4627-8785-77c19f9c9b4e
      version: -1
      name: Verify Context - Score
      description: Verify that the 'DBotScore.Score’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "359"
      Verified:
      - "126"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: DBotScore
                accessor: Score
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1325,
          "y": 3700
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "359":
    id: "359"
    taskid: 187db078-554c-42cb-857a-306382b6d783
    type: regular
    task:
      id: 187db078-554c-42cb-857a-306382b6d783
      version: -1
      name: Verify Context Error  - Score
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'DBotScore.Score’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'file' automation outputs have been modified and no longer contain the 'DBotScore.Score' context key. \n2- The 'file' input configuration was changed for the 'file' automation used in the 'Hash Enrichment' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1325,
          "y": 3930
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "360":
    id: "360"
    taskid: fc159fc3-8597-4604-8c53-2faae21c56bd
    type: condition
    task:
      id: fc159fc3-8597-4604-8c53-2faae21c56bd
      version: -1
      name: Verify Context - Type
      description: Verify that the 'DBotScore.Type’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "361"
      Verified:
      - "126"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: DBotScore
                accessor: Type
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1725,
          "y": 3700
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "361":
    id: "361"
    taskid: d6c9117f-8759-42e7-87a0-cefa9c3dc1fd
    type: regular
    task:
      id: d6c9117f-8759-42e7-87a0-cefa9c3dc1fd
      version: -1
      name: Verify Context Error  - Type
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'DBotScore.Type’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'file' automation outputs have been modified and no longer contain the 'DBotScore.Type' context key. \n2- The 'file' input configuration was changed for the 'file' automation used in the 'Hash Enrichment' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1725,
          "y": 3930
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "362":
    id: "362"
    taskid: c1978737-28d4-40fb-8314-ce5dc532e868
    type: condition
    task:
      id: c1978737-28d4-40fb-8314-ce5dc532e868
      version: -1
      name: Verify Context - Vendor
      description: Verify that the 'DBotScore.Vendor’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "363"
      Verified:
      - "126"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: DBotScore
                accessor: Vendor
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2115,
          "y": 3700
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "363":
    id: "363"
    taskid: 3376335d-10c0-47c7-8e35-5b616fd58b5e
    type: regular
    task:
      id: 3376335d-10c0-47c7-8e35-5b616fd58b5e
      version: -1
      name: Verify Context Error  - Vendor
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'DBotScore.Vendor’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'file' automation outputs have been modified and no longer contain the 'DBotScore.Vendor' context key. \n2- The 'file' input configuration was changed for the 'file' automation used in the 'Hash Enrichment' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2115,
          "y": 3930
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "366":
    id: "366"
    taskid: d782e804-2179-4039-8115-4656bf8d612c
    type: regular
    task:
      id: d782e804-2179-4039-8115-4656bf8d612c
      version: -1
      name: Verify Context Error  - OS Version
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.OSVersion’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.OSVersion' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task.\n3- The 'deviceosversion' input configuration was changed for the 'setIncident' automation used in the 'Set Endpoint information to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3725,
          "y": 3225
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "367":
    id: "367"
    taskid: bd76cf15-4d4a-4c76-8e64-35a968723787
    type: condition
    task:
      id: bd76cf15-4d4a-4c76-8e64-35a968723787
      version: -1
      name: Verify OS Version
      description: Verify that the 'Endpoint.OSVersion’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "366"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: deviceosversion
            iscontext: true
          right:
            value:
              complex:
                root: Endpoint
                accessor: OSVersion
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3730,
          "y": 2980
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "368":
    id: "368"
    taskid: 9b1e0eda-a26e-4c8c-8423-5e583f1e5375
    type: condition
    task:
      id: 9b1e0eda-a26e-4c8c-8423-5e583f1e5375
      version: -1
      name: Verify URLs
      description: Verify that the ‘ URLs’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "369"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: urls
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: url
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2100,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "369":
    id: "369"
    taskid: 23e27301-f47c-431c-8620-a9ec75ab7166
    type: regular
    task:
      id: 23e27301-f47c-431c-8620-a9ec75ab7166
      version: -1
      name: Verify Incident Field Error - URLs
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'URLs' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'URLs' incident field configured within the 'Get full alert details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2100,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "370":
    id: "370"
    taskid: f0d5274d-87c0-444c-836d-72605d7e384a
    type: condition
    task:
      id: f0d5274d-87c0-444c-836d-72605d7e384a
      version: -1
      name: Check Microsoft Defender ATP Available Alerts
      description: Checks if there are available alerts for testing processes.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "371"
      "yes":
      - "149"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MDE.Alert.value
                accessor: id
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: Evidence
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": -1200
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "371":
    id: "371"
    taskid: b4965151-45ef-4cd6-8acc-147c4b642c16
    type: title
    task:
      id: b4965151-45ef-4cd6-8acc-147c4b642c16
      version: -1
      name: Tests cannot be performed
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1020,
          "y": -1030
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "372":
    id: "372"
    taskid: 2947bc1d-dfa1-478a-8f6b-dc688ae7f02f
    type: condition
    task:
      id: 2947bc1d-dfa1-478a-8f6b-dc688ae7f02f
      version: -1
      name: Determine If There Is a URL Within The Alert
      description: 'Checks for ''url'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "368"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: url
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2100,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "373":
    id: "373"
    taskid: a2cd9f4e-6d97-491a-8cd7-9d124475095c
    type: condition
    task:
      id: a2cd9f4e-6d97-491a-8cd7-9d124475095c
      version: -1
      name: Verify Users
      description: Verify that the ‘users’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "374"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: users
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: accountName
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2495,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "374":
    id: "374"
    taskid: 06985c19-ac58-44ba-8f70-a7eaada06b9a
    type: regular
    task:
      id: 06985c19-ac58-44ba-8f70-a7eaada06b9a
      version: -1
      name: Verify Incident Field Error - Users
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'users' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'users' incident field configured within the 'Get full alert details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2490,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "375":
    id: "375"
    taskid: 92598df3-8879-4efe-8e0d-2b806e22da67
    type: condition
    task:
      id: 92598df3-8879-4efe-8e0d-2b806e22da67
      version: -1
      name: Determine If There Is An Account Name Within The Alert
      description: 'Checks for ''accountname'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "373"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: accountName
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2490,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "376":
    id: "376"
    taskid: 98b224ea-6517-4516-85b3-06ccf19601d9
    type: condition
    task:
      id: 98b224ea-6517-4516-85b3-06ccf19601d9
      version: -1
      name: Verify User SID
      description: Verify that the ‘usersid’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "377"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: usersid
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: userSid
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2885,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "377":
    id: "377"
    taskid: 738c797d-20e2-45ed-8bb9-7c42ac3c87b1
    type: regular
    task:
      id: 738c797d-20e2-45ed-8bb9-7c42ac3c87b1
      version: -1
      name: Verify Incident Field Error - User SID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'usersid' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'usersid' incident field configured within the 'Get full alert details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2880,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "378":
    id: "378"
    taskid: 50012e30-8885-4369-8156-09f0e42cd595
    type: condition
    task:
      id: 50012e30-8885-4369-8156-09f0e42cd595
      version: -1
      name: Determine If There Is A User SID Within The Alert
      description: 'Checks for ''userSid'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "376"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: userSid
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2880,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "379":
    id: "379"
    taskid: 1167e3ed-2c98-4735-891d-f057405d3c6e
    type: condition
    task:
      id: 1167e3ed-2c98-4735-891d-f057405d3c6e
      version: -1
      name: Verify CMD line
      description: Verify that the ‘cmdline’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "380"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: cmdline
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: processCommandLine
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3275,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "380":
    id: "380"
    taskid: 70fa3d8b-d79e-4db3-8e40-a71aea525ee5
    type: regular
    task:
      id: 70fa3d8b-d79e-4db3-8e40-a71aea525ee5
      version: -1
      name: Verify Incident Field Error - CMD line
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'cmdline' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'cmdline' incident field configured within the 'Get full alert details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3270,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "381":
    id: "381"
    taskid: 762bbc6d-c4f6-442b-89dc-2d7fd7612892
    type: condition
    task:
      id: 762bbc6d-c4f6-442b-89dc-2d7fd7612892
      version: -1
      name: Determine If There Is A Process Command Line Within The Alert
      description: 'Checks for ''processCommandLine'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "379"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: processCommandLine
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3270,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "382":
    id: "382"
    taskid: 95104252-e0cb-4ab8-8292-c32f3cb8e25c
    type: condition
    task:
      id: 95104252-e0cb-4ab8-8292-c32f3cb8e25c
      version: -1
      name: Verify Detected IPs
      description: Verify that the ‘detectedips’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "383"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: detectedips
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: ipAddress
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3665,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "383":
    id: "383"
    taskid: 44596008-8824-4684-8c31-aa763f1eedb5
    type: regular
    task:
      id: 44596008-8824-4684-8c31-aa763f1eedb5
      version: -1
      name: Verify Incident Field Error - Detected IPs
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'detectedips' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'detectedips' incident field configured within the 'Get full alert details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3660,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "384":
    id: "384"
    taskid: 58e6c9fb-579b-4a5c-8c0d-d8e3b9209269
    type: condition
    task:
      id: 58e6c9fb-579b-4a5c-8c0d-d8e3b9209269
      version: -1
      name: Determine If There Is An IP Address Within The Alert
      description: 'Checks for ''ipAddress'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "382"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: ipAddress
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3660,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "385":
    id: "385"
    taskid: 6091f949-5d55-4936-81b0-64a206a762ce
    type: condition
    task:
      id: 6091f949-5d55-4936-81b0-64a206a762ce
      version: -1
      name: Verify Domain Name
      description: Verify that the ‘domainname’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "386"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: domainname
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: domainName
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4055,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "386":
    id: "386"
    taskid: a373cfca-2f6a-43f4-8e41-3b801139a448
    type: regular
    task:
      id: a373cfca-2f6a-43f4-8e41-3b801139a448
      version: -1
      name: Verify Incident Field Error - Domain Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'domainname' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'domainname' incident field configured within the 'Get full alert details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4050,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "387":
    id: "387"
    taskid: 64e4b0c5-3ca3-48a9-86e3-11174830981e
    type: condition
    task:
      id: 64e4b0c5-3ca3-48a9-86e3-11174830981e
      version: -1
      name: Determine If There Is A Domain Name Within The Alert
      description: 'Checks for ''domainName'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "385"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: domainName
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4050,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "388":
    id: "388"
    taskid: d2be19eb-3b65-4af9-8d5e-cb798cdd3372
    type: condition
    task:
      id: d2be19eb-3b65-4af9-8d5e-cb798cdd3372
      version: -1
      name: Verify File Names
      description: Verify that the ‘filenames’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "389"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: filenames
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: fileName
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4445,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "389":
    id: "389"
    taskid: df6ed5f4-bbe4-4c84-81a1-c84aecbba0b5
    type: regular
    task:
      id: df6ed5f4-bbe4-4c84-81a1-c84aecbba0b5
      version: -1
      name: Verify Incident Field Error - File Names
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'filenames' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'filenames' incident field configured within the 'Get full alert details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4440,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "390":
    id: "390"
    taskid: 1ef41422-b5b7-4e34-881d-d368986b273a
    type: condition
    task:
      id: 1ef41422-b5b7-4e34-881d-d368986b273a
      version: -1
      name: Determine If There Is A File Name Within The Alert
      description: 'Checks for ''fileName'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "388"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: fileName
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4440,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "391":
    id: "391"
    taskid: 9c308ba8-417b-4500-88b7-2d748e5b3b06
    type: condition
    task:
      id: 9c308ba8-417b-4500-88b7-2d748e5b3b06
      version: -1
      name: Verify File Paths
      description: Verify that the ‘filepaths’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "392"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: filepaths
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: filePath
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4845,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "392":
    id: "392"
    taskid: dd1eac04-e42f-4cf2-807f-580fb5e91242
    type: regular
    task:
      id: dd1eac04-e42f-4cf2-807f-580fb5e91242
      version: -1
      name: Verify Incident Field Error - File Paths
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'filepaths' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'filepaths' incident field configured within the 'Get full alert details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4840,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "393":
    id: "393"
    taskid: 54025575-8181-402e-8217-62c0a3175bba
    type: condition
    task:
      id: 54025575-8181-402e-8217-62c0a3175bba
      version: -1
      name: Determine If There Is A File Path Within The Alert
      description: 'Checks for ''filePath'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "391"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: filePath
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4840,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "394":
    id: "394"
    taskid: a7b753b7-7b11-43e5-819c-6e17a6cafcee
    type: condition
    task:
      id: a7b753b7-7b11-43e5-819c-6e17a6cafcee
      version: -1
      name: Verify File SHA1
      description: Verify that the ‘filesha1’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "395"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: filesha1
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: sha1
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5230,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "395":
    id: "395"
    taskid: 0d64d83e-bf13-4993-8221-9304f757dac9
    type: regular
    task:
      id: 0d64d83e-bf13-4993-8221-9304f757dac9
      version: -1
      name: Verify Incident Field Error - File SHA1
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'filesha1' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'filesha1' incident field configured within the 'Get full alert details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5230,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "396":
    id: "396"
    taskid: ecf2af36-c705-4512-8d7a-86906f324629
    type: condition
    task:
      id: ecf2af36-c705-4512-8d7a-86906f324629
      version: -1
      name: Determine If There Is A File SHA1 Within The Alert
      description: 'Checks for ''sha1'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "394"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: sha1
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5230,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "397":
    id: "397"
    taskid: a05583d2-cb38-4f66-8b69-4709c9445749
    type: condition
    task:
      id: a05583d2-cb38-4f66-8b69-4709c9445749
      version: -1
      name: Verify File SHA256
      description: Verify that the ‘filesha256’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "398"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: filesha256
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: sha256
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5630,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "398":
    id: "398"
    taskid: a153b04e-b9c0-4440-8326-e46fbf8cc102
    type: regular
    task:
      id: a153b04e-b9c0-4440-8326-e46fbf8cc102
      version: -1
      name: Verify Incident Field Error - File SHA256
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'filesha256' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'filesha256' incident field configured within the 'Get full alert details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5630,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "399":
    id: "399"
    taskid: a47eda82-0c16-4fc9-8faa-24aa07aaf649
    type: condition
    task:
      id: a47eda82-0c16-4fc9-8faa-24aa07aaf649
      version: -1
      name: Determine If There Is A File SHA256 Within The Alert
      description: 'Checks for ''sha256'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "397"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: sha256
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5630,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "400":
    id: "400"
    taskid: 9386ef6d-598c-47c4-8f48-f4f4a6390768
    type: condition
    task:
      id: 9386ef6d-598c-47c4-8f48-f4f4a6390768
      version: -1
      name: Verify Microsoft Defender for Endpoint Evidence Type
      description: Verify that the ‘microsoftdefenderforendpointevidencetype’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "401"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: microsoftdefenderforendpointevidencetype
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: entityType
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6030,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "401":
    id: "401"
    taskid: 3428d361-a1a6-4c33-84e4-f53d61d6b866
    type: regular
    task:
      id: 3428d361-a1a6-4c33-84e4-f53d61d6b866
      version: -1
      name: Verify Incident Field Error - Microsoft Defender for Endpoint Evidence Type
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'microsoftdefenderforendpointevidencetype' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'microsoftdefenderforendpointevidencetype' incident field configured within the 'Get full alert details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6030,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "402":
    id: "402"
    taskid: 1c581d22-4110-4fd2-8acb-220ee36be844
    type: condition
    task:
      id: 1c581d22-4110-4fd2-8acb-220ee36be844
      version: -1
      name: Determine If There Is An Entity Type Within The Alert
      description: 'Checks for ''entityType'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "400"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: entityType
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6030,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "403":
    id: "403"
    taskid: c8fc2519-a2bc-4cb7-8e3e-4d8388a88c1c
    type: condition
    task:
      id: c8fc2519-a2bc-4cb7-8e3e-4d8388a88c1c
      version: -1
      name: Verify Parent Process
      description: Verify that the ‘parentprocessfilepath’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "404"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: parentprocessfilepath
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: parentProcessFileName
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6420,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "404":
    id: "404"
    taskid: c7b05bce-38a3-447d-8d69-325505fc75b2
    type: regular
    task:
      id: c7b05bce-38a3-447d-8d69-325505fc75b2
      version: -1
      name: Verify Incident Field Error - Parent Process
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'parentprocessfilepath' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'parentprocessfilepath' incident field configured within the 'Get full alert details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6420,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "405":
    id: "405"
    taskid: 67ec74a3-a7aa-4287-8d26-9069585a7341
    type: condition
    task:
      id: 67ec74a3-a7aa-4287-8d26-9069585a7341
      version: -1
      name: Determine If There Is A Parent Process File Name Within The Alert
      description: 'Checks for ''parentProcessFileName'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "403"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: parentProcessFileName
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6420,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "406":
    id: "406"
    taskid: 113d5d20-2c41-4dec-86ce-81f8d00ab4b3
    type: condition
    task:
      id: 113d5d20-2c41-4dec-86ce-81f8d00ab4b3
      version: -1
      name: Verify Parent Process ID
      description: Verify that the ‘parentprocessid’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "407"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: parentprocessid
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: parentProcessId
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6820,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "407":
    id: "407"
    taskid: 95474b6d-7106-41c3-847a-b2d5bd59a631
    type: regular
    task:
      id: 95474b6d-7106-41c3-847a-b2d5bd59a631
      version: -1
      name: Verify Incident Field Error - Parent Process ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'parentprocessid' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'parentprocessid' incident field configured within the 'Get full alert details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6820,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "408":
    id: "408"
    taskid: d53ee877-e877-4e7f-8d77-8abf5a599126
    type: condition
    task:
      id: d53ee877-e877-4e7f-8d77-8abf5a599126
      version: -1
      name: Determine If There Is A Parent Process ID Within The Alert
      description: 'Checks for ''parentProcessId'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "406"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: parentProcessId
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6820,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "409":
    id: "409"
    taskid: 7b735bb6-0368-4b9d-8069-b7181cd38f45
    type: condition
    task:
      id: 7b735bb6-0368-4b9d-8069-b7181cd38f45
      version: -1
      name: Verify Process ID
      description: Verify that the ‘processid’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "410"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: processid
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: processId
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 7220,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "410":
    id: "410"
    taskid: 2a6f64a1-3a72-4cc7-80c6-bc426789c376
    type: regular
    task:
      id: 2a6f64a1-3a72-4cc7-80c6-bc426789c376
      version: -1
      name: Verify Incident Field Error - Process ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'processid' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'processid' incident field configured within the 'Get full alert details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 7220,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "411":
    id: "411"
    taskid: f5dc7a6e-48ee-4654-83ef-9b73feb5645a
    type: condition
    task:
      id: f5dc7a6e-48ee-4654-83ef-9b73feb5645a
      version: -1
      name: Determine If There Is A Process ID Within The Alert
      description: 'Checks for ''processId'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "409"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: processId
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 7220,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "412":
    id: "412"
    taskid: 62a102b8-09d3-4d1b-8bae-cf9d1eeca60c
    type: condition
    task:
      id: 62a102b8-09d3-4d1b-8bae-cf9d1eeca60c
      version: -1
      name: Verify Registry Key
      description: Verify that the ‘registrykey’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "413"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: registrykey
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: registryKey
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 7610,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "413":
    id: "413"
    taskid: 8ba6228d-639e-4e2c-8815-927f23e91ba5
    type: regular
    task:
      id: 8ba6228d-639e-4e2c-8815-927f23e91ba5
      version: -1
      name: Verify Incident Field Error - Registry Key
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'registrykey' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'registrykey' incident field configured within the 'Get full alert details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 7610,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "414":
    id: "414"
    taskid: 1e9a81c2-4cd2-4d1f-8029-d8059b0aa160
    type: condition
    task:
      id: 1e9a81c2-4cd2-4d1f-8029-d8059b0aa160
      version: -1
      name: Determine If There Is A Registry Key Within The Alert
      description: 'Checks for ''registryKey'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "412"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: registryKey
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 7610,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "415":
    id: "415"
    taskid: b8f7970c-f553-4707-855b-a781622458b4
    type: condition
    task:
      id: b8f7970c-f553-4707-855b-a781622458b4
      version: -1
      name: Verify Registry Value
      description: Verify that the ‘registryvalue’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "416"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: registryvalue
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: registryValue
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 8010,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "416":
    id: "416"
    taskid: 019bef83-c234-454a-82e8-e702010839bb
    type: regular
    task:
      id: 019bef83-c234-454a-82e8-e702010839bb
      version: -1
      name: Verify Incident Field Error - Registry Value
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'registryvalue' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'registryvalue' incident field configured within the 'Get full alert details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 8010,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "417":
    id: "417"
    taskid: 2eb741ae-9459-4962-837f-85d0c57bf31f
    type: condition
    task:
      id: 2eb741ae-9459-4962-837f-85d0c57bf31f
      version: -1
      name: Determine If There Is A Registry Value Within The Alert
      description: 'Checks for ''registryValue'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "415"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: registryValue
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 8010,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "418":
    id: "418"
    taskid: 59c7ea20-b856-4459-8d3c-1458dd520871
    type: condition
    task:
      id: 59c7ea20-b856-4459-8d3c-1458dd520871
      version: -1
      name: Verify Registry Value Type
      description: Verify that the ‘registryvaluetype’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "419"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: registryvaluetype
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: registryValueType
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 8410,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "419":
    id: "419"
    taskid: bb06f87b-07b6-43b6-8a2f-d8369c34eee5
    type: regular
    task:
      id: bb06f87b-07b6-43b6-8a2f-d8369c34eee5
      version: -1
      name: Verify Incident Field Error - Registry Value Type
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'registryvaluetype' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'registryvaluetype' incident field configured within the 'Get full alert details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 8410,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "420":
    id: "420"
    taskid: 891a5b63-2135-4425-8f98-74edc44ea25d
    type: condition
    task:
      id: 891a5b63-2135-4425-8f98-74edc44ea25d
      version: -1
      name: Determine If There Is A Registry Value Type Within The Alert
      description: 'Checks for ''registryValueType'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "418"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: registryValueType
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 8410,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "421":
    id: "421"
    taskid: 23889061-490d-4c79-82e8-32ea81458bf9
    type: condition
    task:
      id: 23889061-490d-4c79-82e8-32ea81458bf9
      version: -1
      name: Verify Investigation Stage
      description: Verify that the ‘investigationstage’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "422"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: incident
                accessor: investigationstage
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: InvestigationState
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 8800,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "422":
    id: "422"
    taskid: 2f6b71de-3c20-4362-838d-aaeb0628a61e
    type: regular
    task:
      id: 2f6b71de-3c20-4362-838d-aaeb0628a61e
      version: -1
      name: Verify Incident Field Error - Investigation Stage
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'investigationstage' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'investigationstage' incident field configured within the 'Get full alert details' task was changed.\n2- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.InvestigationState' context key. \n3- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 8800,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "423":
    id: "423"
    taskid: bef7ecbf-1438-41a5-8da8-cb94e9ac4f95
    type: condition
    task:
      id: bef7ecbf-1438-41a5-8da8-cb94e9ac4f95
      version: -1
      name: Determine If There Is An Investigation State Within The Alert
      description: 'Checks for ''InvestigationState'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "421"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: InvestigationState
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 8800,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "424":
    id: "424"
    taskid: 321a2d1e-4c74-4956-8a27-156440bae9b6
    type: condition
    task:
      id: 321a2d1e-4c74-4956-8a27-156440bae9b6
      version: -1
      name: Verify Agents ID
      description: Verify that the ‘agentsid’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "425"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: agentsid
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: MachineID
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 9200,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "425":
    id: "425"
    taskid: 529955ef-dfbc-4885-8187-e6a5ec1aee47
    type: regular
    task:
      id: 529955ef-dfbc-4885-8187-e6a5ec1aee47
      version: -1
      name: Verify Incident Field Error - Agents ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'agentsid' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'agentsid' incident field configured within the 'Get full alert details' task was changed. \n2- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.MachineID' context key. \n3- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 9200,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "426":
    id: "426"
    taskid: 32cacc92-32ba-475c-8ddd-38e44b5c48a7
    type: condition
    task:
      id: 32cacc92-32ba-475c-8ddd-38e44b5c48a7
      version: -1
      name: Determine If There Is A Machine ID Within The Alert
      description: 'Checks for ''MachineID'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "424"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: MachineID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 9200,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "427":
    id: "427"
    taskid: c2d64180-b075-4b56-83e6-a9bb811babe0
    type: condition
    task:
      id: c2d64180-b075-4b56-83e6-a9bb811babe0
      version: -1
      name: Verify MITRE Technique ID
      description: Verify that the ‘mitretechniqueid’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "428"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: mitretechniqueid
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: MitreTechniques
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 9600,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "428":
    id: "428"
    taskid: c1e53323-8f98-40cd-8f7d-ff4960b79f52
    type: regular
    task:
      id: c1e53323-8f98-40cd-8f7d-ff4960b79f52
      version: -1
      name: Verify Incident Field Error - MITRE Technique ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'mitretechniqueid' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'mitretechniqueid' incident field configured within the 'Get full alert details' task was changed.\n2- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.MitreTechniques' context key. \n3- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 9600,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "429":
    id: "429"
    taskid: 726a5985-607a-4af4-8558-f5429cf51420
    type: condition
    task:
      id: 726a5985-607a-4af4-8558-f5429cf51420
      version: -1
      name: Determine If There Is A Mitre Techniques Within The Alert
      description: 'Checks for ''MitreTechniques'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "427"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: MitreTechniques
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 9600,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "430":
    id: "430"
    taskid: 47747b7a-cb29-4372-809e-5065258e763b
    type: condition
    task:
      id: 47747b7a-cb29-4372-809e-5065258e763b
      version: -1
      name: Verify Process CMD
      description: Verify that the ‘processcmd’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "431"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: processcmd
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: processCommandLine
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 9990,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "431":
    id: "431"
    taskid: f935253b-d065-4760-86cf-4815ce59ba40
    type: regular
    task:
      id: f935253b-d065-4760-86cf-4815ce59ba40
      version: -1
      name: Verify Incident Field Error - Process CMD
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'processcmd' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'processcmd' incident field configured within the 'Get full alert details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 9990,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "432":
    id: "432"
    taskid: b4d6315b-4fd8-43d6-8dcb-9c327af91c87
    type: condition
    task:
      id: b4d6315b-4fd8-43d6-8dcb-9c327af91c87
      version: -1
      name: Determine If There Is A Process Command Line Within The Alert
      description: 'Checks for ''processCommandLine'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "430"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: processCommandLine
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 9990,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "433":
    id: "433"
    taskid: de1732e1-12c5-46c9-840c-5f99341906e9
    type: condition
    task:
      id: de1732e1-12c5-46c9-840c-5f99341906e9
      version: -1
      name: Verify Process SHA256
      description: Verify that the ‘processsha256’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "434"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: processsha256
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: sha256
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 10380,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "434":
    id: "434"
    taskid: 3c1dc1ec-2dd1-4b86-8d5f-a88899cc748c
    type: regular
    task:
      id: 3c1dc1ec-2dd1-4b86-8d5f-a88899cc748c
      version: -1
      name: Verify Incident Field Error - Process SHA256
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'processsha256' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'processsha256' incident field configured within the 'Get full alert details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 10380,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "435":
    id: "435"
    taskid: c8ddbe0b-fc0c-4f67-8b66-3dd6aacbbcda
    type: condition
    task:
      id: c8ddbe0b-fc0c-4f67-8b66-3dd6aacbbcda
      version: -1
      name: Determine If There Is A File SHA256 Within The Alert
      description: 'Checks for ''sha256'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "433"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: sha256
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 10380,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "436":
    id: "436"
    taskid: 94a08521-90fe-4734-8e11-36e2e56e9d6d
    type: condition
    task:
      id: 94a08521-90fe-4734-8e11-36e2e56e9d6d
      version: -1
      name: Verify External Severity
      description: Verify that the ‘externalseverity’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "437"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: externalseverity
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: Severity
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 10770,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "437":
    id: "437"
    taskid: e1d11466-ee88-473f-821d-8837ccfd82e5
    type: regular
    task:
      id: e1d11466-ee88-473f-821d-8837ccfd82e5
      version: -1
      name: Verify Incident Field Error - External Severity
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'externalseverity' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'externalseverity' incident field configured within the 'Get full alert details' task was changed.\n2- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.Severity' context key. \n3- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 10770,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "438":
    id: "438"
    taskid: 0adbaf1e-96d9-42a4-8774-375369f510ec
    type: condition
    task:
      id: 0adbaf1e-96d9-42a4-8774-375369f510ec
      version: -1
      name: Determine If There Is A Severity Within The Alert
      description: 'Checks for ''Severity'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "436"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: Severity
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 10770,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "439":
    id: "439"
    taskid: e747876d-9282-487d-8f90-3c250c2207fd
    type: condition
    task:
      id: e747876d-9282-487d-8f90-3c250c2207fd
      version: -1
      name: Verify External End Time
      description: Verify that the ‘externalendtime’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "440"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: incident
                accessor: externalendtime
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1320,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "440":
    id: "440"
    taskid: 859b84d1-87ba-4cd1-8804-476fb8399d3f
    type: regular
    task:
      id: 859b84d1-87ba-4cd1-8804-476fb8399d3f
      version: -1
      name: Verify Incident Field Error - External End Time
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'externalendtime' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'externalendtime' incident field configured within the 'Get full alert details' task was changed.\n2- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.LastUpdateTime' context key. \n3- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1320,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "442":
    id: "442"
    taskid: c50dc719-2744-4817-8695-c60bb049c79e
    type: condition
    task:
      id: c50dc719-2744-4817-8695-c60bb049c79e
      version: -1
      name: Verify External Start Time
      description: Verify that the ‘externalstarttime’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "443"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: incident
                accessor: externalstarttime
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1710,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "443":
    id: "443"
    taskid: 6a7a1b9d-f096-4a97-8a0f-9a5bd4328b8d
    type: regular
    task:
      id: 6a7a1b9d-f096-4a97-8a0f-9a5bd4328b8d
      version: -1
      name: Verify Incident Field Error - External Start Time
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'externalstarttime' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'externalstarttime' incident field configured within the 'Get full alert details' task was changed. \n2- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.FirstEventTime' context key. \n3- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1710,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "445":
    id: "445"
    taskid: 15db14b3-a273-47f3-811b-45802dcb2744
    type: condition
    task:
      id: 15db14b3-a273-47f3-811b-45802dcb2744
      version: -1
      name: Verify External Status
      description: Verify that the ‘externalstatus’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "446"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: externalstatus
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: Status
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 11160,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "446":
    id: "446"
    taskid: 84bb7387-0305-474e-83da-1d5c6574a9bf
    type: regular
    task:
      id: 84bb7387-0305-474e-83da-1d5c6574a9bf
      version: -1
      name: Verify Incident Field Error - External Status
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'externalstatus' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'externalstatus' incident field configured within the 'Get full alert details' task was changed.\n2- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.Status' context key. \n3- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 11160,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "447":
    id: "447"
    taskid: cf5a6466-f884-40cd-8a46-578caecd13a8
    type: condition
    task:
      id: cf5a6466-f884-40cd-8a46-578caecd13a8
      version: -1
      name: Determine If There Is An Alert Status Within The Alert
      description: 'Checks for ''Status'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "445"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: Status
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 11160,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "448":
    id: "448"
    taskid: 09a436be-c3d9-49a8-86e3-d9a382fe1bef
    type: condition
    task:
      id: 09a436be-c3d9-49a8-86e3-d9a382fe1bef
      version: -1
      name: Verify Hostnames
      description: Verify that the ‘hostnames’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "449"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: hostnames
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: ComputerDNSName
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 11550,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "449":
    id: "449"
    taskid: 8dd6a967-ad91-4160-8f11-f07ddb7482ba
    type: regular
    task:
      id: 8dd6a967-ad91-4160-8f11-f07ddb7482ba
      version: -1
      name: Verify Incident Field Error - Hostnames
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'hostnames' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'hostnames' incident field configured within the 'Get full alert details' task was changed. \n2- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.ComputerDNSName' context key. \n3- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 11550,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "450":
    id: "450"
    taskid: 3569cf02-4d70-4df6-894c-1f42e0a66705
    type: condition
    task:
      id: 3569cf02-4d70-4df6-894c-1f42e0a66705
      version: -1
      name: Determine If There Is A Computer DNS Name Within The Alert
      description: 'Checks for ''ComputerDNSName'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "448"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: ComputerDNSName
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 11550,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "451":
    id: "451"
    taskid: fd973ad0-8894-455e-8a05-a88b5b1bdb40
    type: condition
    task:
      id: fd973ad0-8894-455e-8a05-a88b5b1bdb40
      version: -1
      name: Verify External Category Name
      description: Verify that the ‘categoryname’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "452"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: externalcategoryname
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: Category
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 11950,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "452":
    id: "452"
    taskid: b6b2489d-03b0-4def-8d1a-d0c26e1cfcf3
    type: regular
    task:
      id: b6b2489d-03b0-4def-8d1a-d0c26e1cfcf3
      version: -1
      name: Verify Incident Field Error - External Category Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'externalcategoryname' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'externalcategoryname' incident field configured within the 'Get full alert details' task was changed. \n2- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.Category' context key. \n3- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 11950,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "453":
    id: "453"
    taskid: 28ea5230-f12b-4e34-85b7-7b87cc84aefb
    type: condition
    task:
      id: 28ea5230-f12b-4e34-85b7-7b87cc84aefb
      version: -1
      name: Determine If There Is An Alert Category Within The Alert
      description: 'Checks for ''Category'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "451"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: Category
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 11950,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "454":
    id: "454"
    taskid: 3f2d5f75-334c-4c25-8aff-e19dd3250544
    type: condition
    task:
      id: 3f2d5f75-334c-4c25-8aff-e19dd3250544
      version: -1
      name: Verify Description
      description: Verify that the ‘description’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "455"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: inList
          left:
            value:
              complex:
                root: incident
                accessor: description
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: Description
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 12350,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "455":
    id: "455"
    taskid: c84fb238-db0f-4a6a-8f9e-365805d751d1
    type: regular
    task:
      id: c84fb238-db0f-4a6a-8f9e-365805d751d1
      version: -1
      name: Verify Incident Field Error - Description
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'description' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'description' incident field configured within the 'Get full alert details' task was changed. \n2- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.Description' context key. \n3- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 12350,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "456":
    id: "456"
    taskid: f020df97-9cd6-4551-866b-c3a9ac808358
    type: condition
    task:
      id: f020df97-9cd6-4551-866b-c3a9ac808358
      version: -1
      name: Determine If There Is An Alert Description Within The Alert
      description: 'Checks for ''Description'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "454"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: Description
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 12350,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "457":
    id: "457"
    taskid: 8848a081-3608-4d96-81c3-57544ad9da6b
    type: condition
    task:
      id: 8848a081-3608-4d96-81c3-57544ad9da6b
      version: -1
      name: Determine If There Is A File SHA1
      description: 'Checks for ''filesha1'' within the incident fields before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "128"
      "yes":
      - "220"
      - "218"
      - "78"
      - "354"
      - "356"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: incident
                accessor: filesha1
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 2240
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "458":
    id: "458"
    taskid: 9216f7d2-50b1-402c-8470-6f565d41e3da
    type: condition
    task:
      id: 9216f7d2-50b1-402c-8470-6f565d41e3da
      version: -1
      name: Verify Groups
      description: |
        Verify that the ‘Account.Groups’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "459"
      Verified:
      - "131"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: Account
                accessor: Groups
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 1140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "459":
    id: "459"
    taskid: c45ba398-f85a-4b65-80e0-b0f7106ce6be
    type: regular
    task:
      id: c45ba398-f85a-4b65-80e0-b0f7106ce6be
      version: -1
      name: Verify Context Error - Groups
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Account.Groups' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'Account Enrichment - Generic v2.1' sub-playbook outputs have been modified and no longer contain the 'Account.Groups' context key. \n2- The 'Username' input configuration was changed for the 'Account Enrichment - Generic v2.1' sub-playbook."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 1320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "460":
    id: "460"
    taskid: f16ce430-585a-48dc-8dea-51db25f1f6a2
    type: condition
    task:
      id: f16ce430-585a-48dc-8dea-51db25f1f6a2
      version: -1
      name: Determine If There Is An Account Context Data
      description: 'Checks for ''Account'' within the context data before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "131"
      "yes":
      - "458"
      - "461"
      - "463"
      - "465"
      - "467"
      - "469"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Account
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 960
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "461":
    id: "461"
    taskid: 3b8b7db7-b5bc-4bb9-855e-f6473b404d10
    type: condition
    task:
      id: 3b8b7db7-b5bc-4bb9-855e-f6473b404d10
      version: -1
      name: Verify Display Name
      description: |
        Verify that the ‘Account.DisplayName’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "462"
      Verified:
      - "131"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: Account
                accessor: DisplayName
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1330,
          "y": 1140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "462":
    id: "462"
    taskid: f1460fa4-cea0-409f-8381-944d2a7dd688
    type: regular
    task:
      id: f1460fa4-cea0-409f-8381-944d2a7dd688
      version: -1
      name: Verify Context Error - Display Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Account.DisplayName' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'Account Enrichment - Generic v2.1' sub-playbook outputs have been modified and no longer contain the 'Account.DisplayName' context key. \n2- The 'Username' input configuration was changed for the 'Account Enrichment - Generic v2.1' sub-playbook."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1330,
          "y": 1320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "463":
    id: "463"
    taskid: ba7383d0-896c-4de6-8151-016b37a66ed6
    type: condition
    task:
      id: ba7383d0-896c-4de6-8151-016b37a66ed6
      version: -1
      name: Verify Status
      description: |
        Verify that the ‘Account.Status’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "464"
      Verified:
      - "131"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: Account
                accessor: Status
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1730,
          "y": 1140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "464":
    id: "464"
    taskid: 7962bf0a-9fd2-403d-8507-c6396d4416d8
    type: regular
    task:
      id: 7962bf0a-9fd2-403d-8507-c6396d4416d8
      version: -1
      name: Verify Context Error - Status
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Account.Status' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'Account Enrichment - Generic v2.1' sub-playbook outputs have been modified and no longer contain the 'Account.Status' context key. \n2- The 'Username' input configuration was changed for the 'Account Enrichment - Generic v2.1' sub-playbook."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1730,
          "y": 1320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "465":
    id: "465"
    taskid: 3a34670f-44d4-4429-806c-d21d92545683
    type: condition
    task:
      id: 3a34670f-44d4-4429-806c-d21d92545683
      version: -1
      name: Verify Email
      description: |
        Verify that the ‘Account.Email’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "466"
      Verified:
      - "131"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: Account
                accessor: Email
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2120,
          "y": 1140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "466":
    id: "466"
    taskid: 12db4544-0e6a-44f6-8848-a54d0408e297
    type: regular
    task:
      id: 12db4544-0e6a-44f6-8848-a54d0408e297
      version: -1
      name: Verify Context Error - Email
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Account.Email' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'Account Enrichment - Generic v2.1' sub-playbook outputs have been modified and no longer contain the 'Account.Email' context key. \n2- The 'Username' input configuration was changed for the 'Account Enrichment - Generic v2.1' sub-playbook."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2120,
          "y": 1320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "467":
    id: "467"
    taskid: 4a93b493-c530-4818-8a7c-3cfe4aea7ea4
    type: condition
    task:
      id: 4a93b493-c530-4818-8a7c-3cfe4aea7ea4
      version: -1
      name: Verify Manager
      description: |
        Verify that the ‘Account.Manager’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "468"
      Verified:
      - "131"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: Account
                accessor: Manager
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2520,
          "y": 1140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "468":
    id: "468"
    taskid: 98a74609-48a8-4654-88c2-7c2311a5a821
    type: regular
    task:
      id: 98a74609-48a8-4654-88c2-7c2311a5a821
      version: -1
      name: Verify Context Error - Manager
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Account.Manager' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'Account Enrichment - Generic v2.1' sub-playbook outputs have been modified and no longer contain the 'Account.Manager' context key. \n2- The 'Username' input configuration was changed for the 'Account Enrichment - Generic v2.1' sub-playbook."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2520,
          "y": 1320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "469":
    id: "469"
    taskid: 5d5d36a7-2e54-4707-8fac-5e28e0da0052
    type: condition
    task:
      id: 5d5d36a7-2e54-4707-8fac-5e28e0da0052
      version: -1
      name: Verify Username
      description: |
        Verify that the ‘Account.Username’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "470"
      Verified:
      - "131"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: Account
                accessor: Username
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2910,
          "y": 1140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "470":
    id: "470"
    taskid: 106da1bc-2c97-416a-8d5b-7e73b9abf733
    type: regular
    task:
      id: 106da1bc-2c97-416a-8d5b-7e73b9abf733
      version: -1
      name: Verify Context Error - Username
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Account.Username' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'Account Enrichment - Generic v2.1' sub-playbook outputs have been modified and no longer contain the 'Account.Username' context key. \n2- The 'Username' input configuration was changed for the 'Account Enrichment - Generic v2.1' sub-playbook."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2910,
          "y": 1320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "472":
    id: "472"
    taskid: 86557504-d9d7-4674-8c3e-95604e5e77a1
    type: condition
    task:
      id: 86557504-d9d7-4674-8c3e-95604e5e77a1
      version: -1
      name: Determine If There Is A File SHA1
      description: 'Checks for ''filesha1'' within the incident fields before testing the related context data.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "126"
      "yes":
      - "265"
      - "358"
      - "360"
      - "362"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: incident
                accessor: filesha1
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 3530
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "473":
    id: "473"
    taskid: b35348dd-d679-4e12-81a3-7547bfd9e6ca
    type: condition
    task:
      id: b35348dd-d679-4e12-81a3-7547bfd9e6ca
      version: -1
      name: Verify Last Update Time
      description: Verify that the ‘MicrosoftATP.Alert.LastUpdateTime’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "474"
      Verified:
      - "113"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: LastUpdateTime
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2490,
          "y": 1670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "474":
    id: "474"
    taskid: 134a75c8-2f2f-4c52-8d8f-897256599f23
    type: regular
    task:
      id: 134a75c8-2f2f-4c52-8d8f-897256599f23
      version: -1
      name: Verify Context Error - Last Update Time
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'MicrosoftATP.Alert.LastUpdateTime' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.LastUpdateTime' context key. \n2- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2495,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "475":
    id: "475"
    taskid: 90edfe04-8036-45fb-84aa-a06107dec6b8
    type: condition
    task:
      id: 90edfe04-8036-45fb-84aa-a06107dec6b8
      version: -1
      name: Verify First Event Time
      description: |
        Verify that the ‘MicrosoftATP.Alert.FirstEventTime’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "476"
      Verified:
      - "113"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: FirstEventTime
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2880,
          "y": 1670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "476":
    id: "476"
    taskid: e76e58f6-0210-46ac-8e84-ab17646dd2dd
    type: regular
    task:
      id: e76e58f6-0210-46ac-8e84-ab17646dd2dd
      version: -1
      name: Verify Context Error - First Event Time
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'MicrosoftATP.Alert.FirstEventTime' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.FirstEventTime' context key. \n2- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2880,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "137_136_Verified": 0.1,
      "370_149_yes": 0.48,
      "372_136_#default#": 0.1,
      "372_368_yes": 0.5,
      "457_128_#default#": 0.72,
      "460_458_yes": 0.66,
      "75_113_ Verified": 0.1
    },
    "paper": {
      "dimensions": {
        "height": 5950,
        "width": 12600,
        "x": 590,
        "y": -1655
      }
    }
  }
inputs: []
outputs: []
fromversion: 6.5.0
