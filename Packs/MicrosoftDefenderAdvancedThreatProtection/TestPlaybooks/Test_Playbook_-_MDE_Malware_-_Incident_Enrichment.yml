id: Test Playbook - MDE Malware - Incident Enrichment
version: -1
name: Test Playbook - MDE Malware - Incident Enrichment
description: "This playbook tests the ‘MDE Malware - Incident Enrichment’ playbook which is part of the ‘Malware Investigation and Response’ pack.\n\nThe following tests are conducted in the playbook:\n1- Confirm that incident fields were populated correctly by the custom output mapping rules and the 'setIncident' automation. \n2- Validate the enrichment of MDE alerts.\n3- Validate the enrichment of alerts and incident entities.\n3- Ensure that the context data was properly extracted.\n4. Check that the MDE alert information was correctly populated into the 'Alert' grid table of the Malware-Investigation and Response layout."
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 013429d7-3936-46ee-84e7-8bde603ee347
    type: start
    task:
      id: 013429d7-3936-46ee-84e7-8bde603ee347
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "32"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": -1655
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: 3dfabe21-4c6a-4b9b-8bc9-75b24ed33174
    type: regular
    task:
      id: 3dfabe21-4c6a-4b9b-8bc9-75b24ed33174
      version: -1
      name: Delete Context
      description: The task deletes all of the context data. Having a clean beginning to a test playbook ensures that a test can be sterile and that unrelated issues can be eliminated.
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "293"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": -1525
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: 10155eeb-6cbb-45d3-8b72-b8779fc2c2a4
    type: title
    task:
      id: 10155eeb-6cbb-45d3-8b72-b8779fc2c2a4
      version: -1
      name: '''Extracted Indicators'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "79"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "64":
    id: "64"
    taskid: 58b01f66-fc78-4774-82bc-2fbd599f728c
    type: title
    task:
      id: 58b01f66-fc78-4774-82bc-2fbd599f728c
      version: -1
      name: '''File'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "457"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 2110
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "65":
    id: "65"
    taskid: 740f700f-9e29-4470-8b64-9050bcd3c92d
    type: title
    task:
      id: 740f700f-9e29-4470-8b64-9050bcd3c92d
      version: -1
      name: '''Endpoint'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "199"
      - "203"
      - "204"
      - "205"
      - "206"
      - "207"
      - "208"
      - "367"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 2835
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "67":
    id: "67"
    taskid: 998f7f87-bce6-4430-8806-7049ae57367e
    type: title
    task:
      id: 998f7f87-bce6-4430-8806-7049ae57367e
      version: -1
      name: '''Account'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "460"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 830
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "69":
    id: "69"
    taskid: 9d2201ce-9e84-43d8-889e-9aad98f844e5
    type: title
    task:
      id: 9d2201ce-9e84-43d8-889e-9aad98f844e5
      version: -1
      name: '''DBotScore'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "472"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 3400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "75":
    id: "75"
    taskid: b54ca8b7-d059-49aa-8344-7a0e2468bebe
    type: condition
    task:
      id: b54ca8b7-d059-49aa-8344-7a0e2468bebe
      version: -1
      name: Verify Alert ID
      description: |
        Verify that the ‘MicrosoftATP.Alert.ID’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "113"
      '#default#':
      - "114"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: ID
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: ID
                transformers:
                - operator: FirstArrayElement
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 1670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "78":
    id: "78"
    taskid: 2606d53c-6342-4a76-8d5f-bcd164f031c2
    type: condition
    task:
      id: 2606d53c-6342-4a76-8d5f-bcd164f031c2
      version: -1
      name: Verify MD5
      description: Verify that the 'File.MD5’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "142"
      Verified:
      - "128"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: File
                accessor: MD5
            iscontext: true
          right:
            value: {}
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1735,
          "y": 2415
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "79":
    id: "79"
    taskid: e4bc309f-4972-4b90-84b8-7b057156e771
    type: condition
    task:
      id: e4bc309f-4972-4b90-84b8-7b057156e771
      version: -1
      name: Verify Extracted Indicators
      description: Verify that the 'ExtractedIndicators’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "144"
      Verified:
      - "198"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: ExtractedIndicators
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "84":
    id: "84"
    taskid: b95b1401-1d3a-4acb-81a3-dd61283eaef2
    type: title
    task:
      id: b95b1401-1d3a-4acb-81a3-dd61283eaef2
      version: -1
      name: Start Tests
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "132"
      - "151"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": -690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "112":
    id: "112"
    taskid: a155b81b-0361-41cb-8bc0-52298d9e674f
    type: title
    task:
      id: a155b81b-0361-41cb-8bc0-52298d9e674f
      version: -1
      name: '''MicrosoftATP.Alert'' Context Data'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "75"
      - "294"
      - "296"
      - "300"
      - "310"
      - "316"
      - "320"
      - "324"
      - "328"
      - "334"
      - "338"
      - "346"
      - "348"
      - "473"
      - "475"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 1520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "113":
    id: "113"
    taskid: c3f7d4a3-16cc-49d0-8da1-44cbc70ca218
    type: title
    task:
      id: c3f7d4a3-16cc-49d0-8da1-44cbc70ca218
      version: -1
      name: Done verifying 'MicrosoftATP.Alert'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6775,
          "y": 1870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "114":
    id: "114"
    taskid: cd57ec44-cd03-42ed-89bb-dfa835a8d5d1
    type: regular
    task:
      id: cd57ec44-cd03-42ed-89bb-dfa835a8d5d1
      version: -1
      name: Verify Context Error - Alert ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'MicrosoftATP.Alert.ID' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.ID' context key. \n2- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "125":
    id: "125"
    taskid: 3690a469-2e4f-417c-8928-feba7a9b41b3
    type: regular
    task:
      id: 3690a469-2e4f-417c-8928-feba7a9b41b3
      version: -1
      name: Verify Context Error  - Hostname
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.Hostname’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.Hostname' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task.\n3- The 'devicename' input configuration was changed for the 'setIncident' automation used in the 'Set Endpoint information to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3320,
          "y": 3225
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "126":
    id: "126"
    taskid: d10c55ba-dafd-49f3-8c8b-547f706ab3c2
    type: title
    task:
      id: d10c55ba-dafd-49f3-8c8b-547f706ab3c2
      version: -1
      name: Done verifying 'DBotScore' context
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2500,
          "y": 3885
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "127":
    id: "127"
    taskid: 350a7c8b-3d11-4285-82a4-119ffc65a578
    type: title
    task:
      id: 350a7c8b-3d11-4285-82a4-119ffc65a578
      version: -1
      name: Done verifying 'Endpoint'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4130,
          "y": 3180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "128":
    id: "128"
    taskid: ad2058f6-a646-406a-8a98-3dd87878bad9
    type: title
    task:
      id: ad2058f6-a646-406a-8a98-3dd87878bad9
      version: -1
      name: Done verifying 'File'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2925,
          "y": 2605
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "131":
    id: "131"
    taskid: f3b857ab-7ed6-4880-8bbd-f94678b33420
    type: title
    task:
      id: f3b857ab-7ed6-4880-8bbd-f94678b33420
      version: -1
      name: Done verifying 'Account' context
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3325,
          "y": 1320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "132":
    id: "132"
    taskid: b43bd51b-da7c-4207-855a-6dc18cf18724
    type: title
    task:
      id: b43bd51b-da7c-4207-855a-6dc18cf18724
      version: -1
      name: Check Incident Fields
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "137"
      - "372"
      - "375"
      - "378"
      - "381"
      - "384"
      - "387"
      - "390"
      - "393"
      - "396"
      - "399"
      - "402"
      - "405"
      - "408"
      - "411"
      - "414"
      - "417"
      - "420"
      - "423"
      - "426"
      - "429"
      - "432"
      - "435"
      - "438"
      - "447"
      - "450"
      - "453"
      - "456"
      - "439"
      - "442"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": -550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "136":
    id: "136"
    taskid: 175d5754-2a17-4d4f-8623-f762b055f3c6
    type: title
    task:
      id: 175d5754-2a17-4d4f-8623-f762b055f3c6
      version: -1
      name: Done verifying Incident Fields
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 12740,
          "y": -50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "137":
    id: "137"
    taskid: 0cc245c9-de56-42f3-85c0-8cbe004601d9
    type: condition
    task:
      id: 0cc245c9-de56-42f3-85c0-8cbe004601d9
      version: -1
      name: Verify Alerts And Related Info
      description: |-
        Verify that the ‘alertsandrelatedinfo’ incident field was filled out correctly.
        These Incident Field are affecting the incident layouts (grid_id).
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "138"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: incident.alertsandrelatedinfo.alertname
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: AlertName
            iscontext: true
          ignorecase: true
      - - operator: containsGeneral
          left:
            value:
              simple: incident.alertsandrelatedinfo.hostname
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: device_name
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "138":
    id: "138"
    taskid: af8f6455-04a8-4d11-8c0c-955d49bdd37e
    type: regular
    task:
      id: af8f6455-04a8-4d11-8c0c-955d49bdd37e
      version: -1
      name: Verify Incident Field Error - Alerts And Related Info
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'alertsandrelatedinfo' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:
          1- The 'grid_id' input configuration was changed for the 'SetGridField' automation used in the 'Set Alerts Table Info in the Layout' task.
          2- The 'columns' input configuration was changed for the 'SetGridField' automation used in the 'Set Alerts Table Info in the Layout' task.
          3- The 'context_path' input configuration was changed for the 'SetGridField' automation used in the 'Set Alerts Table Info in the Layout' task.
          4- The 'keys' input configuration was changed for the 'SetGridField' automation used in the 'Set Alerts Table Info in the Layout' task.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "142":
    id: "142"
    taskid: 481f831a-b3eb-4d3b-8d5b-7bb702c3add8
    type: regular
    task:
      id: 481f831a-b3eb-4d3b-8d5b-7bb702c3add8
      version: -1
      name: Verify Context Error - MD5
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'File.MD5’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'MDE Malware - Incident Enrichment' playbook:\n1- The 'file' automation outputs have been modified and no longer contain the 'File.MD5' context key. \n2- The 'file' input configuration was changed for the 'file' automation used in the 'Hash Enrichment' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1735,
          "y": 2635
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "144":
    id: "144"
    taskid: 92d71e7d-73a4-466b-8af0-8db47f42c306
    type: regular
    task:
      id: 92d71e7d-73a4-466b-8af0-8db47f42c306
      version: -1
      name: Verify Context Error - Extracted Indicators
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: |-
          The 'ExtractedIndicators' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:
          1- The 'text' input configuration was changed for the 'extractIndicators' automation used in the 'Extract Indicators' task.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 640
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "149":
    id: "149"
    taskid: e3652501-3950-48a7-861a-61ef39555c37
    type: regular
    task:
      id: e3652501-3950-48a7-861a-61ef39555c37
      version: -1
      name: Set Incident Fields To Context
      description: Add incident fields required for testing to the mock incident.
      script: Builtin|||setIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "292"
    scriptarguments:
      alertname:
        complex:
          root: MicrosoftATP.Alert
          accessor: Title
          transformers:
          - operator: FirstArrayElement
      alertsandrelatedinfo:
        simple: '[{"columnheader3":""},{},{}]'
      externalendtime:
        complex:
          root: MicrosoftATP.Alert
          accessor: LastUpdateTime
      externalstarttime:
        complex:
          root: MicrosoftATP.Alert
          accessor: FirstEventTime
      externalsystemid:
        complex:
          root: MDE.Alert.value
          accessor: id
          transformers:
          - operator: FirstArrayElement
      type:
        simple: Malware Investigation and Response
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": -1010
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "151":
    id: "151"
    taskid: ebd5bf70-875f-4c53-8d1a-55e3e485fd75
    type: title
    task:
      id: ebd5bf70-875f-4c53-8d1a-55e3e485fd75
      version: -1
      name: Check Context Data
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "63"
      - "67"
      - "112"
      - "64"
      - "69"
      - "65"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": 125
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "198":
    id: "198"
    taskid: f90cb9ef-0e6f-429b-84f5-a519e17c4a01
    type: title
    task:
      id: f90cb9ef-0e6f-429b-84f5-a519e17c4a01
      version: -1
      name: Done verifying 'Extracted Indicators'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1315,
          "y": 600
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "199":
    id: "199"
    taskid: 9afa33a2-13da-49be-8ad0-74254ad3f1da
    type: condition
    task:
      id: 9afa33a2-13da-49be-8ad0-74254ad3f1da
      version: -1
      name: Verify Hostname
      description: Verify that the 'Endpoint.Hostname’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "125"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: devicename
            iscontext: true
          right:
            value:
              complex:
                root: Endpoint
                accessor: Hostname
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3325,
          "y": 2980
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "203":
    id: "203"
    taskid: b4e84093-29a7-48af-8457-16afd9cb26c2
    type: condition
    task:
      id: b4e84093-29a7-48af-8457-16afd9cb26c2
      version: -1
      name: Verify OS
      description: Verify that the 'Endpoint.OS’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "210"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: deviceosname
            iscontext: true
          right:
            value:
              complex:
                root: Endpoint
                accessor: OS
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2935,
          "y": 2980
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "204":
    id: "204"
    taskid: 6dbdef56-6479-4fc4-8bb3-b0d7b6062a9b
    type: condition
    task:
      id: 6dbdef56-6479-4fc4-8bb3-b0d7b6062a9b
      version: -1
      name: Verify MAC Address
      description: Verify that the 'Endpoint.MACAddress’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "211"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: devicemacaddress
            iscontext: true
          right:
            value:
              complex:
                root: Endpoint
                accessor: MACAddress
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2545,
          "y": 2980
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "205":
    id: "205"
    taskid: dc0df08d-18be-4405-82d2-7fca5fd93afa
    type: condition
    task:
      id: dc0df08d-18be-4405-82d2-7fca5fd93afa
      version: -1
      name: Verify Vendor
      description: Verify that the 'Endpoint.Vendor’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "212"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: Endpoint
                accessor: Vendor
            iscontext: true
          right:
            value: {}
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2135,
          "y": 2980
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "206":
    id: "206"
    taskid: bade94aa-7975-4e58-83f4-be1f9502de20
    type: condition
    task:
      id: bade94aa-7975-4e58-83f4-be1f9502de20
      version: -1
      name: Verify IP Address
      description: Verify that the 'Endpoint.IPAddress’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "213"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: devicelocalip
            iscontext: true
          right:
            value:
              complex:
                root: Endpoint
                accessor: IPAddress
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1735,
          "y": 2980
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "207":
    id: "207"
    taskid: 0387beae-4986-421e-8367-9a3234bfd9ee
    type: condition
    task:
      id: 0387beae-4986-421e-8367-9a3234bfd9ee
      version: -1
      name: Verify Status
      description: Verify that the 'Endpoint.Status’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "214"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: devicestatus
            iscontext: true
          right:
            value:
              complex:
                root: Endpoint
                accessor: Status
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 2980
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "208":
    id: "208"
    taskid: 96190cdc-6357-4706-827d-8d6809174b22
    type: condition
    task:
      id: 96190cdc-6357-4706-827d-8d6809174b22
      version: -1
      name: Verify Endpoint ID
      description: Verify that the 'Endpoint.ID’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "215"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: deviceid
            iscontext: true
          right:
            value:
              complex:
                root: Endpoint
                accessor: ID
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 2980
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "210":
    id: "210"
    taskid: 9cffce49-b37e-448a-8fc4-190aa3bb5467
    type: regular
    task:
      id: 9cffce49-b37e-448a-8fc4-190aa3bb5467
      version: -1
      name: Verify Context Error  -  OS
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.OS’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.OS' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task.\n3- The 'deviceosname' input configuration was changed for the 'setIncident' automation used in the 'Set Endpoint information to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2925,
          "y": 3225
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "211":
    id: "211"
    taskid: e1dafdb8-1399-4db2-853b-bed52f93e05c
    type: regular
    task:
      id: e1dafdb8-1399-4db2-853b-bed52f93e05c
      version: -1
      name: Verify Context Error  - MAC Address
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.MACAddress’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.MACAddress' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task.\n3- The 'devicemacaddress' input configuration was changed for the 'setIncident' automation used in the 'Set Endpoint information to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2525,
          "y": 3225
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "212":
    id: "212"
    taskid: 4f6860c7-a0de-43e3-864f-79fa4198da5c
    type: regular
    task:
      id: 4f6860c7-a0de-43e3-864f-79fa4198da5c
      version: -1
      name: Verify Context Error  - Vendor
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.Vendor’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.Vendor' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2120,
          "y": 3225
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "213":
    id: "213"
    taskid: 48bdede7-be63-4016-8e52-90374155c263
    type: regular
    task:
      id: 48bdede7-be63-4016-8e52-90374155c263
      version: -1
      name: Verify Context Error  - IP Address
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.IPAddress’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.IPAddress' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task.\n3- The 'devicelocalip' input configuration was changed for the 'setIncident' automation used in the 'Set Endpoint information to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1735,
          "y": 3225
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "214":
    id: "214"
    taskid: e7bd0341-73c5-4478-8515-f4e1a9e813f9
    type: regular
    task:
      id: e7bd0341-73c5-4478-8515-f4e1a9e813f9
      version: -1
      name: Verify Context Error  - Status
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.Status’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.Status' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task.\n3- The 'devicestatus' input configuration was changed for the 'setIncident' automation used in the 'Set Endpoint information to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1335,
          "y": 3225
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "215":
    id: "215"
    taskid: cc4c96e8-9cf9-47ae-8174-e5a793eb347d
    type: regular
    task:
      id: cc4c96e8-9cf9-47ae-8174-e5a793eb347d
      version: -1
      name: Verify Context Error  - Endpoint ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.ID’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.ID' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task.\n3- The 'deviceid' input configuration was changed for the 'setIncident' automation used in the 'Set Endpoint information to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 3225
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "218":
    id: "218"
    taskid: 9f948b2f-4612-4aaf-8414-643896b55b3b
    type: condition
    task:
      id: 9f948b2f-4612-4aaf-8414-643896b55b3b
      version: -1
      name: Verify SHA265
      description: Verify that the 'File.SHA256’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "219"
      Verified:
      - "128"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: File
                accessor: SHA265
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1335,
          "y": 2415
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "219":
    id: "219"
    taskid: fbb28032-6203-4405-8ee2-5673f1dcd9b3
    type: regular
    task:
      id: fbb28032-6203-4405-8ee2-5673f1dcd9b3
      version: -1
      name: Verify Context Error - SHA265
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'File.SHA256’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'MDE Malware - Incident Enrichment' playbook:\n1- The 'file' automation outputs have been modified and no longer contain the 'File.SHA256' context key. \n2- The 'file' input configuration was changed for the 'file' automation used in the 'Hash Enrichment' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 2635
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "220":
    id: "220"
    taskid: c1df017b-b907-4a04-86e3-982769fde331
    type: condition
    task:
      id: c1df017b-b907-4a04-86e3-982769fde331
      version: -1
      name: Verify Name
      description: Verify that the 'File.Name’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "221"
      Verified:
      - "128"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: File
                accessor: Name
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 2415
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "221":
    id: "221"
    taskid: 89c010a8-7a8a-4c31-8b35-e233c7daa56a
    type: regular
    task:
      id: 89c010a8-7a8a-4c31-8b35-e233c7daa56a
      version: -1
      name: Verify Context Error - Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'File.Name’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'MDE Malware - Incident Enrichment' playbook:\n1- The 'file' automation outputs have been modified and no longer contain the 'File.Name' context key. \n2- The 'file' input configuration was changed for the 'file' automation used in the 'Hash Enrichment' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 2635
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "265":
    id: "265"
    taskid: e18d22f4-f46c-4906-8304-ace0a0784a6d
    type: condition
    task:
      id: e18d22f4-f46c-4906-8304-ace0a0784a6d
      version: -1
      name: Verify Context - Indicator
      description: Verify that the 'DBotScore.Indicator’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "266"
      Verified:
      - "126"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: DBotScore
                accessor: Indicator
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 3700
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "266":
    id: "266"
    taskid: 953d8521-5d09-412e-867c-84f5b2f98f52
    type: regular
    task:
      id: 953d8521-5d09-412e-867c-84f5b2f98f52
      version: -1
      name: Verify Context Error  - Indicator
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'DBotScore.Indicator’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'file' automation outputs have been modified and no longer contain the 'DBotScore.Indicator' context key. \n2- The 'file' input configuration was changed for the 'file' automation used in the 'Hash Enrichment' task.\n3- The 'file' input configuration was changed for the 'file' automation used in the 'Hash Enrichment' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 3930
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "277":
    id: "277"
    taskid: 890056bc-84c7-41f9-8ff5-26350d2aebea
    type: title
    task:
      id: 890056bc-84c7-41f9-8ff5-26350d2aebea
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 12810,
          "y": 4230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "292":
    id: "292"
    taskid: 5dd6672f-086e-4e22-8482-e5d8a9c019d0
    type: playbook
    task:
      id: 5dd6672f-086e-4e22-8482-e5d8a9c019d0
      version: -1
      name: MDE Malware - Incident Enrichment
      description: |-
        This playbook is part of the 'Malware Investigation And Response' pack. For more information, refer to https://xsoar.pan.dev/docs/reference/packs/malware-investigation-and-response.
        This playbook enriches Microsoft Defender For Endpoint alerts. The enrichment is done on the involved endpoint and Mitre technique ID information, and it sets the 'Malware-Investigation and Response' layout.
      playbookName: MDE Malware - Incident Enrichment
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "84"
    scriptarguments:
      AlertID:
        simple: ${incident.externalsystemid}
      DidAlertOriginateFromSIEM:
        simple: "No"
    separatecontext: false
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 590,
          "y": -850
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "293":
    id: "293"
    taskid: 087b505e-bc66-4e10-891a-813e41ca5ba7
    type: regular
    task:
      id: 087b505e-bc66-4e10-891a-813e41ca5ba7
      version: -1
      name: Get MDE Available Alerts
      description: Gets a list of alerts present on the system. Filtering can be done only on a single argument.
      script: 'Microsoft Defender Advanced Threat Protection|||microsoft-atp-list-alerts'
      type: regular
      iscommand: true
      brand: Microsoft Defender Advanced Threat Protection
    nexttasks:
      '#none#':
      - "370"
    scriptarguments:
      extend-context:
        simple: MDE.Alert=
      ignore-outputs:
        simple: "true"
      limit:
        simple: "2"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": -1360
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "294":
    id: "294"
    taskid: bda7d91d-9ffb-414c-8679-cbd0a0a6d6c7
    type: condition
    task:
      id: bda7d91d-9ffb-414c-8679-cbd0a0a6d6c7
      version: -1
      name: Verify Incident ID
      description: |
        Verify that the ‘MicrosoftATP.Alert.IncidentID’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "113"
      '#default#':
      - "295"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: IncidentID
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1320,
          "y": 1670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "295":
    id: "295"
    taskid: b4c80e66-28fa-408d-867e-597730e39978
    type: regular
    task:
      id: b4c80e66-28fa-408d-867e-597730e39978
      version: -1
      name: Verify Context Error - Incident ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'MicrosoftATP.Alert.IncidentID' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.IncidentID' context key. \n2- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1320,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "296":
    id: "296"
    taskid: 6d8ac998-a127-459f-84ca-2c3de9a4a6a3
    type: condition
    task:
      id: 6d8ac998-a127-459f-84ca-2c3de9a4a6a3
      version: -1
      name: Verify Investigation ID
      description: |
        Verify that the ‘MicrosoftATP.Alert.InvestigationID’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "113"
      '#default#':
      - "297"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: InvestigationID
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1710,
          "y": 1670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "297":
    id: "297"
    taskid: 362e3b60-db7a-4922-8c9f-05de87d91039
    type: regular
    task:
      id: 362e3b60-db7a-4922-8c9f-05de87d91039
      version: -1
      name: Verify Context Error - Investigation ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'MicrosoftATP.Alert.InvestigationID' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.InvestigationID' context key. \n2- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1710,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "300":
    id: "300"
    taskid: 022f5a07-0430-489b-8a3d-52c2233322a9
    type: condition
    task:
      id: 022f5a07-0430-489b-8a3d-52c2233322a9
      version: -1
      name: Verify Assigned To
      description: |
        Verify that the ‘MicrosoftATP.Alert.AssignedTo’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "113"
      '#default#':
      - "301"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: AssignedTo
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2100,
          "y": 1670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "301":
    id: "301"
    taskid: fd3e321b-d7e3-40e8-8cb6-4fd94f7f1d9e
    type: regular
    task:
      id: fd3e321b-d7e3-40e8-8cb6-4fd94f7f1d9e
      version: -1
      name: Verify Context Error - Assigned To
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'MicrosoftATP.Alert.AssignedTo' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.AssignedTo' context key. \n2- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2100,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "310":
    id: "310"
    taskid: 56cbb0c4-9870-4913-8511-fe34f773b155
    type: condition
    task:
      id: 56cbb0c4-9870-4913-8511-fe34f773b155
      version: -1
      name: Verify Detection Source
      description: |
        Verify that the ‘MicrosoftATP.Alert.DetectionSource’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "113"
      '#default#':
      - "311"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: DetectionSource
            iscontext: true
          right:
            value: {}
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3265,
          "y": 1670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "311":
    id: "311"
    taskid: 2cd2c171-0901-4884-8d5a-25a822e0baab
    type: regular
    task:
      id: 2cd2c171-0901-4884-8d5a-25a822e0baab
      version: -1
      name: Verify Context Error - Detection Source
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'MicrosoftATP.Alert.DetectionSource' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.DetectionSource' context key. \n2- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3265,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "316":
    id: "316"
    taskid: efeed853-39b8-4ef0-8572-d7bebed40fac
    type: condition
    task:
      id: efeed853-39b8-4ef0-8572-d7bebed40fac
      version: -1
      name: Verify Title
      description: |
        Verify that the ‘MicrosoftATP.Alert.Title’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "113"
      '#default#':
      - "317"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: Title
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3655,
          "y": 1670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "317":
    id: "317"
    taskid: b306f21f-d2ed-4e8f-8498-5a352db5059e
    type: regular
    task:
      id: b306f21f-d2ed-4e8f-8498-5a352db5059e
      version: -1
      name: Verify Context Error - Title
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'MicrosoftATP.Alert.Title' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.Title' context key. \n2- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3655,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "320":
    id: "320"
    taskid: b1648497-8065-4084-820d-ad31a2083828
    type: condition
    task:
      id: b1648497-8065-4084-820d-ad31a2083828
      version: -1
      name: Verify Alert Creation Time
      description: |
        Verify that the ‘MicrosoftATP.Alert.AlertCreationTime’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "113"
      '#default#':
      - "321"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: AlertCreationTime
            iscontext: true
          right:
            value: {}
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4045,
          "y": 1670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "321":
    id: "321"
    taskid: feb7689a-4474-40ee-8959-220991010fe6
    type: regular
    task:
      id: feb7689a-4474-40ee-8959-220991010fe6
      version: -1
      name: Verify Context Error - Alert Creation Time
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'MicrosoftATP.Alert.AlertCreationTime' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.AlertCreationTime' context key. \n2- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4045,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "324":
    id: "324"
    taskid: ec1ecf8d-5598-44e1-83b1-5cb2022c619d
    type: condition
    task:
      id: ec1ecf8d-5598-44e1-83b1-5cb2022c619d
      version: -1
      name: Verify Last Event Time
      description: |
        Verify that the ‘MicrosoftATP.Alert.LastEventTime’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "113"
      '#default#':
      - "325"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: LastEventTime
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4435,
          "y": 1670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "325":
    id: "325"
    taskid: 42e5760c-7259-481e-8773-a32c7d32d8a0
    type: regular
    task:
      id: 42e5760c-7259-481e-8773-a32c7d32d8a0
      version: -1
      name: Verify Context Error - Last Event Time
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'MicrosoftATP.Alert.LastEventTime' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.LastEventTime' context key. \n2- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4435,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "328":
    id: "328"
    taskid: 0bc7e3e4-7f6d-43d2-83a2-087378109866
    type: condition
    task:
      id: 0bc7e3e4-7f6d-43d2-83a2-087378109866
      version: -1
      name: Verify Resolved Time
      description: |
        Verify that the ‘MicrosoftATP.Alert.ResolvedTime’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "113"
      '#default#':
      - "329"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: ResolvedTime
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4825,
          "y": 1670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "329":
    id: "329"
    taskid: 4cb834ae-275d-4c44-8407-df87d194c0ec
    type: regular
    task:
      id: 4cb834ae-275d-4c44-8407-df87d194c0ec
      version: -1
      name: Verify Context Error - Resolved Time
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'MicrosoftATP.Alert.ResolvedTime' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.ResolvedTime' context key. \n2- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4825,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "334":
    id: "334"
    taskid: 87f1e3c4-373c-4544-8521-8c749cd73dd1
    type: condition
    task:
      id: 87f1e3c4-373c-4544-8521-8c749cd73dd1
      version: -1
      name: Verify AAD Tenant ID
      description: |
        Verify that the ‘MicrosoftATP.Alert.AADTenantID’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "113"
      '#default#':
      - "335"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: AADTenantID
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5215,
          "y": 1670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "335":
    id: "335"
    taskid: 328b1318-65cf-43bb-8894-1c8f9a0c1eb7
    type: regular
    task:
      id: 328b1318-65cf-43bb-8894-1c8f9a0c1eb7
      version: -1
      name: Verify Context Error - AAD Tenant ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'MicrosoftATP.Alert.AADTenantID' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.AADTenantID' context key. \n2- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5215,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "338":
    id: "338"
    taskid: fb803d08-d61c-430f-808c-3f5d05a5ea90
    type: condition
    task:
      id: fb803d08-d61c-430f-808c-3f5d05a5ea90
      version: -1
      name: Verify Detector ID
      description: |
        Verify that the ‘MicrosoftATP.Alert.DetectorID’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "113"
      '#default#':
      - "339"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: DetectorID
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5605,
          "y": 1670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "339":
    id: "339"
    taskid: bdc01d0d-ed95-4fcf-89a4-6ea508677aa4
    type: regular
    task:
      id: bdc01d0d-ed95-4fcf-89a4-6ea508677aa4
      version: -1
      name: Verify Context Error - Detector ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'MicrosoftATP.Alert.DetectorID' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.DetectorID' context key. \n2- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5605,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "346":
    id: "346"
    taskid: 81dc6b9a-46cf-46d4-865d-c00f883158d0
    type: condition
    task:
      id: 81dc6b9a-46cf-46d4-865d-c00f883158d0
      version: -1
      name: Verify RBAC Group Name
      description: |
        Verify that the ‘MicrosoftATP.Alert.RBACGroupName’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "113"
      '#default#':
      - "347"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: RBACGroupName
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6005,
          "y": 1670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "347":
    id: "347"
    taskid: e097d6fa-ffad-4bd1-8d0b-ec7276ca7760
    type: regular
    task:
      id: e097d6fa-ffad-4bd1-8d0b-ec7276ca7760
      version: -1
      name: Verify Context Error - RBAC Group Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'MicrosoftATP.Alert.RBACGroupName' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.RBACGroupName' context key. \n2- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6005,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "348":
    id: "348"
    taskid: 5fbeebe7-0579-493a-8953-86df879846d7
    type: condition
    task:
      id: 5fbeebe7-0579-493a-8953-86df879846d7
      version: -1
      name: Verify Comments
      description: |
        Verify that the ‘MicrosoftATP.Alert.Comments.’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      ' Verified':
      - "113"
      '#default#':
      - "349"
    separatecontext: false
    conditions:
    - label: ' Verified'
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: Comments
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6395,
          "y": 1670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "349":
    id: "349"
    taskid: efb8eb32-9756-40c1-8e80-5afc7ac055de
    type: regular
    task:
      id: efb8eb32-9756-40c1-8e80-5afc7ac055de
      version: -1
      name: Verify Context Error - Comments
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'MicrosoftATP.Alert.Comments' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.Comments' context key. \n2- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6395,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "354":
    id: "354"
    taskid: fbcf6a66-84e0-4c46-86d8-ce1c6c9f7eb1
    type: condition
    task:
      id: fbcf6a66-84e0-4c46-86d8-ce1c6c9f7eb1
      version: -1
      name: Verify SHA1
      description: Verify that the 'File.SHA1’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "355"
      Verified:
      - "128"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: File
                accessor: SHA1
            iscontext: true
          right:
            value: {}
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2125,
          "y": 2415
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "355":
    id: "355"
    taskid: cd502d9b-c614-4f9f-810c-d0832924ab45
    type: regular
    task:
      id: cd502d9b-c614-4f9f-810c-d0832924ab45
      version: -1
      name: Verify Context Error - SHA1
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'File.SHA1’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'MDE Malware - Incident Enrichment' playbook:\n1- The 'file' automation outputs have been modified and no longer contain the 'File.SHA1' context key. \n2- The 'file' input configuration was changed for the 'file' automation used in the 'Hash Enrichment' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2125,
          "y": 2635
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "356":
    id: "356"
    taskid: c9afbfca-a3c7-4a45-86b2-0a2c41a1d793
    type: condition
    task:
      id: c9afbfca-a3c7-4a45-86b2-0a2c41a1d793
      version: -1
      name: Verify Tags
      description: Verify that the 'File.Tags’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "357"
      Verified:
      - "128"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: Tags
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2520,
          "y": 2415
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "357":
    id: "357"
    taskid: 80108ad8-1e7d-4f0a-8e5c-2ca565ee36ed
    type: regular
    task:
      id: 80108ad8-1e7d-4f0a-8e5c-2ca565ee36ed
      version: -1
      name: Verify Context Error - Tags
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'File.Tags’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'MDE Malware - Incident Enrichment' playbook:\n1- The 'file' automation outputs have been modified and no longer contain the 'File.Tags' context key. \n2- The 'file' input configuration was changed for the 'file' automation used in the 'Hash Enrichment' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2515,
          "y": 2635
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "358":
    id: "358"
    taskid: 425fe40a-9387-45d3-820a-42b33a81e754
    type: condition
    task:
      id: 425fe40a-9387-45d3-820a-42b33a81e754
      version: -1
      name: Verify Context - Score
      description: Verify that the 'DBotScore.Score’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "359"
      Verified:
      - "126"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: DBotScore
                accessor: Score
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1325,
          "y": 3700
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "359":
    id: "359"
    taskid: deaf0ff3-6e6f-4621-85de-fbfb394a3f38
    type: regular
    task:
      id: deaf0ff3-6e6f-4621-85de-fbfb394a3f38
      version: -1
      name: Verify Context Error  - Score
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'DBotScore.Score’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'file' automation outputs have been modified and no longer contain the 'DBotScore.Score' context key. \n2- The 'file' input configuration was changed for the 'file' automation used in the 'Hash Enrichment' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1325,
          "y": 3930
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "360":
    id: "360"
    taskid: 13aa86e7-1d2b-4422-8873-73c8210eb449
    type: condition
    task:
      id: 13aa86e7-1d2b-4422-8873-73c8210eb449
      version: -1
      name: Verify Context - Type
      description: Verify that the 'DBotScore.Type’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "361"
      Verified:
      - "126"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: DBotScore
                accessor: Type
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1725,
          "y": 3700
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "361":
    id: "361"
    taskid: 3ed4b6fd-689e-449a-8baf-e3bfef31beaf
    type: regular
    task:
      id: 3ed4b6fd-689e-449a-8baf-e3bfef31beaf
      version: -1
      name: Verify Context Error  - Type
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'DBotScore.Type’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'file' automation outputs have been modified and no longer contain the 'DBotScore.Type' context key. \n2- The 'file' input configuration was changed for the 'file' automation used in the 'Hash Enrichment' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1725,
          "y": 3930
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "362":
    id: "362"
    taskid: d870485f-a521-480a-8280-5c29bdd787d2
    type: condition
    task:
      id: d870485f-a521-480a-8280-5c29bdd787d2
      version: -1
      name: Verify Context - Vendor
      description: Verify that the 'DBotScore.Vendor’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "363"
      Verified:
      - "126"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: DBotScore
                accessor: Vendor
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2115,
          "y": 3700
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "363":
    id: "363"
    taskid: 315be163-c10e-4e0a-8102-094d0d79816a
    type: regular
    task:
      id: 315be163-c10e-4e0a-8102-094d0d79816a
      version: -1
      name: Verify Context Error  - Vendor
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'DBotScore.Vendor’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'file' automation outputs have been modified and no longer contain the 'DBotScore.Vendor' context key. \n2- The 'file' input configuration was changed for the 'file' automation used in the 'Hash Enrichment' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2115,
          "y": 3930
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "366":
    id: "366"
    taskid: 4e92c702-2799-4aa0-82b3-16b1dd6cdb86
    type: regular
    task:
      id: 4e92c702-2799-4aa0-82b3-16b1dd6cdb86
      version: -1
      name: Verify Context Error  - OS Version
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Endpoint.OSVersion’ context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'endpoint' automation outputs have been modified and no longer contain the 'Endpoint.OSVersion' context key. \n2- The 'id' input configuration was changed for the 'endpoint' automation used in the 'Enrich endpoint details' task.\n3- The 'deviceosversion' input configuration was changed for the 'setIncident' automation used in the 'Set Endpoint information to layout' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3725,
          "y": 3225
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "367":
    id: "367"
    taskid: d1be6c8d-1d0b-4a45-82cf-b291b8657811
    type: condition
    task:
      id: d1be6c8d-1d0b-4a45-82cf-b291b8657811
      version: -1
      name: Verify OS Version
      description: Verify that the 'Endpoint.OSVersion’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "366"
      Verified:
      - "127"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: deviceosversion
            iscontext: true
          right:
            value:
              complex:
                root: Endpoint
                accessor: OSVersion
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3730,
          "y": 2980
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "368":
    id: "368"
    taskid: 0d4f71b4-916d-4378-8bd6-11b3cd475833
    type: condition
    task:
      id: 0d4f71b4-916d-4378-8bd6-11b3cd475833
      version: -1
      name: Verify URLs
      description: Verify that the ‘ URLs’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "369"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: urls
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: url
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2100,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "369":
    id: "369"
    taskid: c9054145-7e53-4c77-84c2-b39acdca7122
    type: regular
    task:
      id: c9054145-7e53-4c77-84c2-b39acdca7122
      version: -1
      name: Verify Incident Field Error - URLs
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'URLs' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'URLs' incident field configured within the 'Get full alert details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2100,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "370":
    id: "370"
    taskid: b510620c-3058-43b6-8e4b-33bc4dfb0298
    type: condition
    task:
      id: b510620c-3058-43b6-8e4b-33bc4dfb0298
      version: -1
      name: Check Microsoft Defender ATP Available Alerts
      description: Checks if there are available alerts for testing processes.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "371"
      "yes":
      - "149"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MDE.Alert.value
                accessor: id
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 590,
          "y": -1200
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "371":
    id: "371"
    taskid: 21ca33ee-9c0c-42de-82c2-f3c76ba74878
    type: title
    task:
      id: 21ca33ee-9c0c-42de-82c2-f3c76ba74878
      version: -1
      name: Tests cannot be performed
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "277"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1020,
          "y": -1030
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "372":
    id: "372"
    taskid: a449d791-23ad-4d00-8bd3-5619bd9495a5
    type: condition
    task:
      id: a449d791-23ad-4d00-8bd3-5619bd9495a5
      version: -1
      name: Determine If There Is a URL Within The Alert
      description: 'Checks for ''url'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "368"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: url
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2100,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "373":
    id: "373"
    taskid: 987024f2-1c78-4a1d-8fbd-235be26c0535
    type: condition
    task:
      id: 987024f2-1c78-4a1d-8fbd-235be26c0535
      version: -1
      name: Verify Users
      description: Verify that the ‘users’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "374"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: users
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: accountName
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2495,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "374":
    id: "374"
    taskid: daed1918-6e04-4477-8897-d79f60825d06
    type: regular
    task:
      id: daed1918-6e04-4477-8897-d79f60825d06
      version: -1
      name: Verify Incident Field Error - Users
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'users' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'users' incident field configured within the 'Get full alert details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2490,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "375":
    id: "375"
    taskid: 6c02e15b-c62d-4975-8d82-c08f335731da
    type: condition
    task:
      id: 6c02e15b-c62d-4975-8d82-c08f335731da
      version: -1
      name: Determine If There Is An Account Name Within The Alert
      description: 'Checks for ''accountname'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "373"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: accountName
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2490,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "376":
    id: "376"
    taskid: 8c3796ef-c401-4b61-84ff-edf9ba67f54e
    type: condition
    task:
      id: 8c3796ef-c401-4b61-84ff-edf9ba67f54e
      version: -1
      name: Verify User SID
      description: Verify that the ‘usersid’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "377"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: usersid
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: userSid
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2885,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "377":
    id: "377"
    taskid: 6fb054d7-04f8-4c07-8a1b-4058bd2f5a57
    type: regular
    task:
      id: 6fb054d7-04f8-4c07-8a1b-4058bd2f5a57
      version: -1
      name: Verify Incident Field Error - User SID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'usersid' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'usersid' incident field configured within the 'Get full alert details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2880,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "378":
    id: "378"
    taskid: 4c726d47-5b37-448c-8b8c-97f1603e1abb
    type: condition
    task:
      id: 4c726d47-5b37-448c-8b8c-97f1603e1abb
      version: -1
      name: Determine If There Is A User SID Within The Alert
      description: 'Checks for ''userSid'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "376"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: userSid
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2880,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "379":
    id: "379"
    taskid: f33750e5-4171-48c1-8855-cd96d60d7f8f
    type: condition
    task:
      id: f33750e5-4171-48c1-8855-cd96d60d7f8f
      version: -1
      name: Verify CMD line
      description: Verify that the ‘cmdline’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "380"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: cmdline
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: processCommandLine
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3275,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "380":
    id: "380"
    taskid: 768880d0-c71b-4246-8797-d7c87edffc5b
    type: regular
    task:
      id: 768880d0-c71b-4246-8797-d7c87edffc5b
      version: -1
      name: Verify Incident Field Error - CMD line
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'cmdline' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'cmdline' incident field configured within the 'Get full alert details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3270,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "381":
    id: "381"
    taskid: 7393c8c6-02b9-4d53-8915-0bc029b1cee3
    type: condition
    task:
      id: 7393c8c6-02b9-4d53-8915-0bc029b1cee3
      version: -1
      name: Determine If There Is A Process Command Line Within The Alert
      description: 'Checks for ''processCommandLine'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "379"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: processCommandLine
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3270,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "382":
    id: "382"
    taskid: 18a54072-3b3a-4384-822c-57044b85d1cc
    type: condition
    task:
      id: 18a54072-3b3a-4384-822c-57044b85d1cc
      version: -1
      name: Verify Detected IPs
      description: Verify that the ‘detectedips’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "383"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: detectedips
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: ipAddress
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3665,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "383":
    id: "383"
    taskid: 059af25e-e4c4-44b8-81e8-cd354df095b2
    type: regular
    task:
      id: 059af25e-e4c4-44b8-81e8-cd354df095b2
      version: -1
      name: Verify Incident Field Error - Detected IPs
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'detectedips' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'detectedips' incident field configured within the 'Get full alert details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3660,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "384":
    id: "384"
    taskid: ae4bba4c-516a-4a6f-8fff-611c9772f844
    type: condition
    task:
      id: ae4bba4c-516a-4a6f-8fff-611c9772f844
      version: -1
      name: Determine If There Is An IP Address Within The Alert
      description: 'Checks for ''ipAddress'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "382"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: ipAddress
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3660,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "385":
    id: "385"
    taskid: 902a98e9-5eb9-4188-840b-8a03e6d5c24b
    type: condition
    task:
      id: 902a98e9-5eb9-4188-840b-8a03e6d5c24b
      version: -1
      name: Verify Domain Name
      description: Verify that the ‘domainname’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "386"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: domainname
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: domainName
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4055,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "386":
    id: "386"
    taskid: 6541cfe9-e255-4ae7-81cd-2c7c4e9b8423
    type: regular
    task:
      id: 6541cfe9-e255-4ae7-81cd-2c7c4e9b8423
      version: -1
      name: Verify Incident Field Error - Domain Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'domainname' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'domainname' incident field configured within the 'Get full alert details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4050,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "387":
    id: "387"
    taskid: 36a6f947-0276-416c-86d3-44ebca94b7f7
    type: condition
    task:
      id: 36a6f947-0276-416c-86d3-44ebca94b7f7
      version: -1
      name: Determine If There Is A Domain Name Within The Alert
      description: 'Checks for ''domainName'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "385"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: domainName
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4050,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "388":
    id: "388"
    taskid: a1a0a6ff-eae5-41b4-88f3-d138d772d922
    type: condition
    task:
      id: a1a0a6ff-eae5-41b4-88f3-d138d772d922
      version: -1
      name: Verify File Names
      description: Verify that the ‘filenames’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "389"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: filenames
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: fileName
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4445,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "389":
    id: "389"
    taskid: 5fd329fe-0e50-4943-8dea-78e8e1420dd1
    type: regular
    task:
      id: 5fd329fe-0e50-4943-8dea-78e8e1420dd1
      version: -1
      name: Verify Incident Field Error - File Names
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'filenames' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'filenames' incident field configured within the 'Get full alert details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4440,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "390":
    id: "390"
    taskid: c5d890f8-79eb-4f30-8a23-83e7c4444d62
    type: condition
    task:
      id: c5d890f8-79eb-4f30-8a23-83e7c4444d62
      version: -1
      name: Determine If There Is A File Name Within The Alert
      description: 'Checks for ''fileName'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "388"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: fileName
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4440,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "391":
    id: "391"
    taskid: 2cba69d8-3de7-475f-8afc-7ede29909efc
    type: condition
    task:
      id: 2cba69d8-3de7-475f-8afc-7ede29909efc
      version: -1
      name: Verify File Paths
      description: Verify that the ‘filepaths’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "392"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: filepaths
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: filePath
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4845,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "392":
    id: "392"
    taskid: c79b6bd9-161f-4de7-8b38-9cbb9f7de091
    type: regular
    task:
      id: c79b6bd9-161f-4de7-8b38-9cbb9f7de091
      version: -1
      name: Verify Incident Field Error - File Paths
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'filepaths' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'filepaths' incident field configured within the 'Get full alert details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4840,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "393":
    id: "393"
    taskid: cb7ee93b-cbc6-4b49-862c-c99d577f0330
    type: condition
    task:
      id: cb7ee93b-cbc6-4b49-862c-c99d577f0330
      version: -1
      name: Determine If There Is A File Path Within The Alert
      description: 'Checks for ''filePath'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "391"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: filePath
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4840,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "394":
    id: "394"
    taskid: 502ea821-dbb3-41d4-8989-5da2ccd088b6
    type: condition
    task:
      id: 502ea821-dbb3-41d4-8989-5da2ccd088b6
      version: -1
      name: Verify File SHA1
      description: Verify that the ‘filesha1’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "395"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: filesha1
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: sha1
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5230,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "395":
    id: "395"
    taskid: 0f1756b0-0817-4d5f-8d60-c012be8fc1f4
    type: regular
    task:
      id: 0f1756b0-0817-4d5f-8d60-c012be8fc1f4
      version: -1
      name: Verify Incident Field Error - File SHA1
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'filesha1' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'filesha1' incident field configured within the 'Get full alert details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5230,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "396":
    id: "396"
    taskid: b828e2e5-2289-4175-8940-71bc2448c9b6
    type: condition
    task:
      id: b828e2e5-2289-4175-8940-71bc2448c9b6
      version: -1
      name: Determine If There Is A File SHA1 Within The Alert
      description: 'Checks for ''sha1'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "394"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: sha1
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5230,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "397":
    id: "397"
    taskid: d3a467db-1575-4490-85d0-d783c3c48024
    type: condition
    task:
      id: d3a467db-1575-4490-85d0-d783c3c48024
      version: -1
      name: Verify File SHA256
      description: Verify that the ‘filesha256’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "398"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: filesha256
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: sha256
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5630,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "398":
    id: "398"
    taskid: bbb3f936-c75c-42b3-8077-ef9a2be78953
    type: regular
    task:
      id: bbb3f936-c75c-42b3-8077-ef9a2be78953
      version: -1
      name: Verify Incident Field Error - File SHA256
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'filesha256' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'filesha256' incident field configured within the 'Get full alert details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5630,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "399":
    id: "399"
    taskid: 1b4843fd-5aca-497e-8e31-0fb3b1c19104
    type: condition
    task:
      id: 1b4843fd-5aca-497e-8e31-0fb3b1c19104
      version: -1
      name: Determine If There Is A File SHA256 Within The Alert
      description: 'Checks for ''sha256'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "397"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: sha256
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 5630,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "400":
    id: "400"
    taskid: 29f4956b-3ff0-49d4-8895-bd4b98cc5dff
    type: condition
    task:
      id: 29f4956b-3ff0-49d4-8895-bd4b98cc5dff
      version: -1
      name: Verify Microsoft Defender for Endpoint Evidence Type
      description: Verify that the ‘microsoftdefenderforendpointevidencetype’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "401"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: microsoftdefenderforendpointevidencetype
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: entityType
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6030,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "401":
    id: "401"
    taskid: 10a08572-057f-4a4a-8f26-18fd8a77a0d9
    type: regular
    task:
      id: 10a08572-057f-4a4a-8f26-18fd8a77a0d9
      version: -1
      name: Verify Incident Field Error - Microsoft Defender for Endpoint Evidence Type
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'microsoftdefenderforendpointevidencetype' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'microsoftdefenderforendpointevidencetype' incident field configured within the 'Get full alert details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6030,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "402":
    id: "402"
    taskid: 230f930b-9803-47d6-803b-5b8756c23ae5
    type: condition
    task:
      id: 230f930b-9803-47d6-803b-5b8756c23ae5
      version: -1
      name: Determine If There Is An Entity Type Within The Alert
      description: 'Checks for ''entityType'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "400"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: entityType
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6030,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "403":
    id: "403"
    taskid: e0c101d6-c099-4283-8644-db7bf4a27889
    type: condition
    task:
      id: e0c101d6-c099-4283-8644-db7bf4a27889
      version: -1
      name: Verify Parent Process
      description: Verify that the ‘parentprocessfilepath’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "404"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: parentprocessfilepath
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: parentProcessFileName
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6420,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "404":
    id: "404"
    taskid: 2c4eff34-51b3-4fcd-8feb-f812a234ef8c
    type: regular
    task:
      id: 2c4eff34-51b3-4fcd-8feb-f812a234ef8c
      version: -1
      name: Verify Incident Field Error - Parent Process
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'parentprocessfilepath' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'parentprocessfilepath' incident field configured within the 'Get full alert details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6420,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "405":
    id: "405"
    taskid: a992fd61-f309-4d64-86fb-81275910a31b
    type: condition
    task:
      id: a992fd61-f309-4d64-86fb-81275910a31b
      version: -1
      name: Determine If There Is A Parent Process File Name Within The Alert
      description: 'Checks for ''parentProcessFileName'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "403"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: parentProcessFileName
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6420,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "406":
    id: "406"
    taskid: 95efc373-1536-4d81-8fa0-f859458d2c6c
    type: condition
    task:
      id: 95efc373-1536-4d81-8fa0-f859458d2c6c
      version: -1
      name: Verify Parent Process ID
      description: Verify that the ‘parentprocessid’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "407"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: parentprocessid
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: parentProcessId
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6820,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "407":
    id: "407"
    taskid: 7cdd0d92-4088-452a-87f2-833a0af8e48a
    type: regular
    task:
      id: 7cdd0d92-4088-452a-87f2-833a0af8e48a
      version: -1
      name: Verify Incident Field Error - Parent Process ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'parentprocessid' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'parentprocessid' incident field configured within the 'Get full alert details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6820,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "408":
    id: "408"
    taskid: e5b681bb-0e5f-4ea0-8604-d366d302f91c
    type: condition
    task:
      id: e5b681bb-0e5f-4ea0-8604-d366d302f91c
      version: -1
      name: Determine If There Is A Parent Process ID Within The Alert
      description: 'Checks for ''parentProcessId'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "406"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: parentProcessId
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 6820,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "409":
    id: "409"
    taskid: c035e274-f183-4207-8d43-741038c40ccf
    type: condition
    task:
      id: c035e274-f183-4207-8d43-741038c40ccf
      version: -1
      name: Verify Process ID
      description: Verify that the ‘processid’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "410"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: processid
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: processId
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 7220,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "410":
    id: "410"
    taskid: 33e83b4e-ee1e-483c-8e76-da11d6b7dab1
    type: regular
    task:
      id: 33e83b4e-ee1e-483c-8e76-da11d6b7dab1
      version: -1
      name: Verify Incident Field Error - Process ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'processid' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'processid' incident field configured within the 'Get full alert details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 7220,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "411":
    id: "411"
    taskid: e6a006bf-0b7d-4f7c-8b13-da1d0edea88a
    type: condition
    task:
      id: e6a006bf-0b7d-4f7c-8b13-da1d0edea88a
      version: -1
      name: Determine If There Is A Process ID Within The Alert
      description: 'Checks for ''processId'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "409"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: processId
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 7220,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "412":
    id: "412"
    taskid: c71cb846-7879-49b0-885b-d68188761010
    type: condition
    task:
      id: c71cb846-7879-49b0-885b-d68188761010
      version: -1
      name: Verify Registry Key
      description: Verify that the ‘registrykey’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "413"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: registrykey
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: registryKey
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 7610,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "413":
    id: "413"
    taskid: 08a27b87-70b5-4a92-83ab-a2a0a7e94635
    type: regular
    task:
      id: 08a27b87-70b5-4a92-83ab-a2a0a7e94635
      version: -1
      name: Verify Incident Field Error - Registry Key
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'registrykey' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'registrykey' incident field configured within the 'Get full alert details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 7610,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "414":
    id: "414"
    taskid: 22975e5c-7616-4a7d-8d70-e1513f50b1c4
    type: condition
    task:
      id: 22975e5c-7616-4a7d-8d70-e1513f50b1c4
      version: -1
      name: Determine If There Is A Registry Key Within The Alert
      description: 'Checks for ''registryKey'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "412"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: registryKey
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 7610,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "415":
    id: "415"
    taskid: 6cf83fab-7d5c-4cd3-8e60-af6b6075516a
    type: condition
    task:
      id: 6cf83fab-7d5c-4cd3-8e60-af6b6075516a
      version: -1
      name: Verify Registry Value
      description: Verify that the ‘registryvalue’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "416"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: registryvalue
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: registryValue
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 8010,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "416":
    id: "416"
    taskid: 7d6ef905-f144-4e40-8523-7a7c3641972c
    type: regular
    task:
      id: 7d6ef905-f144-4e40-8523-7a7c3641972c
      version: -1
      name: Verify Incident Field Error - Registry Value
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'registryvalue' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'registryvalue' incident field configured within the 'Get full alert details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 8010,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "417":
    id: "417"
    taskid: f2fdbc67-c2a5-4a4b-824f-38e5b089a5f1
    type: condition
    task:
      id: f2fdbc67-c2a5-4a4b-824f-38e5b089a5f1
      version: -1
      name: Determine If There Is A Registry Value Within The Alert
      description: 'Checks for ''registryValue'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "415"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: registryValue
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 8010,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "418":
    id: "418"
    taskid: fb3a67e4-9e74-4ac7-843c-1600ec82ba80
    type: condition
    task:
      id: fb3a67e4-9e74-4ac7-843c-1600ec82ba80
      version: -1
      name: Verify Registry Value Type
      description: Verify that the ‘registryvaluetype’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "419"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: registryvaluetype
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: registryValueType
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 8410,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "419":
    id: "419"
    taskid: a96f1a58-649c-4aa9-8643-28b920fa055c
    type: regular
    task:
      id: a96f1a58-649c-4aa9-8643-28b920fa055c
      version: -1
      name: Verify Incident Field Error - Registry Value Type
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'registryvaluetype' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'registryvaluetype' incident field configured within the 'Get full alert details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 8410,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "420":
    id: "420"
    taskid: 12c28c4f-6b61-4c82-8438-e1184f1f53ec
    type: condition
    task:
      id: 12c28c4f-6b61-4c82-8438-e1184f1f53ec
      version: -1
      name: Determine If There Is A Registry Value Type Within The Alert
      description: 'Checks for ''registryValueType'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "418"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: registryValueType
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 8410,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "421":
    id: "421"
    taskid: cae082de-97f7-4541-886d-886e47364f31
    type: condition
    task:
      id: cae082de-97f7-4541-886d-886e47364f31
      version: -1
      name: Verify Investigation Stage
      description: Verify that the ‘investigationstage’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "422"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: in
          left:
            value:
              complex:
                root: incident
                accessor: investigationstage
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: InvestigationState
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 8800,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "422":
    id: "422"
    taskid: d90eb416-78a8-4061-8b91-c6faea3ca20d
    type: regular
    task:
      id: d90eb416-78a8-4061-8b91-c6faea3ca20d
      version: -1
      name: Verify Incident Field Error - Investigation Stage
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'investigationstage' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'investigationstage' incident field configured within the 'Get full alert details' task was changed.\n2- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.InvestigationState' context key. \n3- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 8800,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "423":
    id: "423"
    taskid: e2b75c70-9fe4-49cb-8975-a20e9dd5f05d
    type: condition
    task:
      id: e2b75c70-9fe4-49cb-8975-a20e9dd5f05d
      version: -1
      name: Determine If There Is An Investigation State Within The Alert
      description: 'Checks for ''InvestigationState'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "421"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: InvestigationState
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 8800,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "424":
    id: "424"
    taskid: 3814b071-2e4d-45ff-8fe9-6d9e9c13f7cb
    type: condition
    task:
      id: 3814b071-2e4d-45ff-8fe9-6d9e9c13f7cb
      version: -1
      name: Verify Agents ID
      description: Verify that the ‘agentsid’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "425"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: agentsid
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: MachineID
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 9200,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "425":
    id: "425"
    taskid: 5d183853-7e51-4076-816c-835a413cac92
    type: regular
    task:
      id: 5d183853-7e51-4076-816c-835a413cac92
      version: -1
      name: Verify Incident Field Error - Agents ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'agentsid' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'agentsid' incident field configured within the 'Get full alert details' task was changed. \n2- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.MachineID' context key. \n3- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 9200,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "426":
    id: "426"
    taskid: a8238cee-f434-4044-8c60-06e157ba0b69
    type: condition
    task:
      id: a8238cee-f434-4044-8c60-06e157ba0b69
      version: -1
      name: Determine If There Is A Machine ID Within The Alert
      description: 'Checks for ''MachineID'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "424"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: MachineID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 9200,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "427":
    id: "427"
    taskid: 7862494d-0634-4296-8aa3-9ad7f6a13114
    type: condition
    task:
      id: 7862494d-0634-4296-8aa3-9ad7f6a13114
      version: -1
      name: Verify MITRE Technique ID
      description: Verify that the ‘mitretechniqueid’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "428"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: mitretechniqueid
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: MitreTechniques
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 9600,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "428":
    id: "428"
    taskid: c9f97835-1846-4cb2-84ad-ede3363eaef2
    type: regular
    task:
      id: c9f97835-1846-4cb2-84ad-ede3363eaef2
      version: -1
      name: Verify Incident Field Error - MITRE Technique ID
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'mitretechniqueid' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'mitretechniqueid' incident field configured within the 'Get full alert details' task was changed.\n2- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.MitreTechniques' context key. \n3- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 9600,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "429":
    id: "429"
    taskid: a276021e-bda4-4993-89f7-a191e5b7ade9
    type: condition
    task:
      id: a276021e-bda4-4993-89f7-a191e5b7ade9
      version: -1
      name: Determine If There Is A Mitre Techniques Within The Alert
      description: 'Checks for ''MitreTechniques'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "427"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: MitreTechniques
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 9600,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "430":
    id: "430"
    taskid: 778e64fa-deb0-44e3-8618-cf225131e4db
    type: condition
    task:
      id: 778e64fa-deb0-44e3-8618-cf225131e4db
      version: -1
      name: Verify Process CMD
      description: Verify that the ‘processcmd’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "431"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: processcmd
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: processCommandLine
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 9990,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "431":
    id: "431"
    taskid: 62001106-2777-4251-8e7a-b18a1fb111a6
    type: regular
    task:
      id: 62001106-2777-4251-8e7a-b18a1fb111a6
      version: -1
      name: Verify Incident Field Error - Process CMD
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'processcmd' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'processcmd' incident field configured within the 'Get full alert details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 9990,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "432":
    id: "432"
    taskid: 37b173a4-efe5-40d1-861d-1d00415a0aa6
    type: condition
    task:
      id: 37b173a4-efe5-40d1-861d-1d00415a0aa6
      version: -1
      name: Determine If There Is A Process Command Line Within The Alert
      description: 'Checks for ''processCommandLine'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "430"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: processCommandLine
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 9990,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "433":
    id: "433"
    taskid: 78d50ea2-e58d-4be3-8e18-200ebb247fd1
    type: condition
    task:
      id: 78d50ea2-e58d-4be3-8e18-200ebb247fd1
      version: -1
      name: Verify Process SHA256
      description: Verify that the ‘processsha256’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "434"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: processsha256
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: sha256
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 10380,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "434":
    id: "434"
    taskid: 7a37e232-d4d1-49bf-8ef1-b3b514730a57
    type: regular
    task:
      id: 7a37e232-d4d1-49bf-8ef1-b3b514730a57
      version: -1
      name: Verify Incident Field Error - Process SHA256
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'processsha256' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'processsha256' incident field configured within the 'Get full alert details' task was changed. "
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 10380,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "435":
    id: "435"
    taskid: a76820ea-d490-44c8-897c-b0d3bba35cee
    type: condition
    task:
      id: a76820ea-d490-44c8-897c-b0d3bba35cee
      version: -1
      name: Determine If There Is A File SHA256 Within The Alert
      description: 'Checks for ''sha256'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "433"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert.Evidence
                accessor: sha256
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 10380,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "436":
    id: "436"
    taskid: 6bf7e772-e28f-489c-8c47-5a83069aa4f1
    type: condition
    task:
      id: 6bf7e772-e28f-489c-8c47-5a83069aa4f1
      version: -1
      name: Verify External Severity
      description: Verify that the ‘externalseverity’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "437"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: externalseverity
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: Severity
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 10770,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "437":
    id: "437"
    taskid: 53348caf-e16f-416c-8fe3-6e3421850885
    type: regular
    task:
      id: 53348caf-e16f-416c-8fe3-6e3421850885
      version: -1
      name: Verify Incident Field Error - External Severity
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'externalseverity' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'externalseverity' incident field configured within the 'Get full alert details' task was changed.\n2- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.Severity' context key. \n3- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 10770,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "438":
    id: "438"
    taskid: 82535030-1c9c-45c9-8b3c-44dac2e7158c
    type: condition
    task:
      id: 82535030-1c9c-45c9-8b3c-44dac2e7158c
      version: -1
      name: Determine If There Is A Severity Within The Alert
      description: 'Checks for ''Severity'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "436"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: Severity
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 10770,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "439":
    id: "439"
    taskid: 8137c180-0e4a-4ae3-8a3e-08cb43dface0
    type: condition
    task:
      id: 8137c180-0e4a-4ae3-8a3e-08cb43dface0
      version: -1
      name: Verify External End Time
      description: Verify that the ‘externalendtime’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "440"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: incident
                accessor: externalendtime
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1320,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "440":
    id: "440"
    taskid: b0a6208d-6789-47c7-8a67-791c0ba3f106
    type: regular
    task:
      id: b0a6208d-6789-47c7-8a67-791c0ba3f106
      version: -1
      name: Verify Incident Field Error - External End Time
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'externalendtime' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'externalendtime' incident field configured within the 'Get full alert details' task was changed.\n2- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.LastUpdateTime' context key. \n3- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1320,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "442":
    id: "442"
    taskid: a8f997c3-5931-4de6-835e-30f8923e43d6
    type: condition
    task:
      id: a8f997c3-5931-4de6-835e-30f8923e43d6
      version: -1
      name: Verify External Start Time
      description: Verify that the ‘externalstarttime’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "443"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: incident
                accessor: externalstarttime
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1710,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "443":
    id: "443"
    taskid: 9f6f99a3-23fc-4283-8830-109ae4cb4d02
    type: regular
    task:
      id: 9f6f99a3-23fc-4283-8830-109ae4cb4d02
      version: -1
      name: Verify Incident Field Error - External Start Time
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'externalstarttime' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'externalstarttime' incident field configured within the 'Get full alert details' task was changed. \n2- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.FirstEventTime' context key. \n3- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1710,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "445":
    id: "445"
    taskid: f67a2493-587a-4c24-86dd-f6b6d7cc2402
    type: condition
    task:
      id: f67a2493-587a-4c24-86dd-f6b6d7cc2402
      version: -1
      name: Verify External Status
      description: Verify that the ‘externalstatus’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "446"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: externalstatus
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: Status
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 11160,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "446":
    id: "446"
    taskid: 772fcf2d-7d24-49df-8c3b-9f9fce5af277
    type: regular
    task:
      id: 772fcf2d-7d24-49df-8c3b-9f9fce5af277
      version: -1
      name: Verify Incident Field Error - External Status
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'externalstatus' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'externalstatus' incident field configured within the 'Get full alert details' task was changed.\n2- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.Status' context key. \n3- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 11160,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "447":
    id: "447"
    taskid: ed52ff04-90f7-4ce9-8912-b951d836c42b
    type: condition
    task:
      id: ed52ff04-90f7-4ce9-8912-b951d836c42b
      version: -1
      name: Determine If There Is An Alert Status Within The Alert
      description: 'Checks for ''Status'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "445"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: Status
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 11160,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "448":
    id: "448"
    taskid: 5fe2eb01-b048-4616-817d-45dec1244a1b
    type: condition
    task:
      id: 5fe2eb01-b048-4616-817d-45dec1244a1b
      version: -1
      name: Verify Hostnames
      description: Verify that the ‘hostnames’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "449"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: hostnames
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: ComputerDNSName
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 11550,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "449":
    id: "449"
    taskid: 650eab08-258b-42bd-871d-93efc2fcefd0
    type: regular
    task:
      id: 650eab08-258b-42bd-871d-93efc2fcefd0
      version: -1
      name: Verify Incident Field Error - Hostnames
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'hostnames' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'hostnames' incident field configured within the 'Get full alert details' task was changed. \n2- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.ComputerDNSName' context key. \n3- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 11550,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "450":
    id: "450"
    taskid: 1f908989-c01d-40f5-843b-ad0e78dd33fc
    type: condition
    task:
      id: 1f908989-c01d-40f5-843b-ad0e78dd33fc
      version: -1
      name: Determine If There Is A Computer DNS Name Within The Alert
      description: 'Checks for ''ComputerDNSName'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "448"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: ComputerDNSName
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 11550,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "451":
    id: "451"
    taskid: 15edf85b-457d-4195-83e0-6a7e00e3e2e4
    type: condition
    task:
      id: 15edf85b-457d-4195-83e0-6a7e00e3e2e4
      version: -1
      name: Verify External Category Name
      description: Verify that the ‘categoryname’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "452"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: incident
                accessor: externalcategoryname
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: Category
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 11950,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "452":
    id: "452"
    taskid: 8e1845f0-953d-43dd-883e-e6f6a3c97cd7
    type: regular
    task:
      id: 8e1845f0-953d-43dd-883e-e6f6a3c97cd7
      version: -1
      name: Verify Incident Field Error - External Category Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'externalcategoryname' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'externalcategoryname' incident field configured within the 'Get full alert details' task was changed. \n2- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.Category' context key. \n3- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 11950,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "453":
    id: "453"
    taskid: 8512b492-8787-4d63-85bb-e087c1b60a0d
    type: condition
    task:
      id: 8512b492-8787-4d63-85bb-e087c1b60a0d
      version: -1
      name: Determine If There Is An Alert Category Within The Alert
      description: 'Checks for ''Category'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "451"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: Category
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 11950,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "454":
    id: "454"
    taskid: 9708f5aa-042c-4567-8c63-b2d2922239de
    type: condition
    task:
      id: 9708f5aa-042c-4567-8c63-b2d2922239de
      version: -1
      name: Verify Description
      description: Verify that the ‘description’ incident field was filled out correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "455"
      Verified:
      - "136"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: inList
          left:
            value:
              complex:
                root: incident
                accessor: description
            iscontext: true
          right:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: Description
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 12350,
          "y": -220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "455":
    id: "455"
    taskid: 08dfca11-06b5-4fe1-8118-8e0d6a4f70c6
    type: regular
    task:
      id: 08dfca11-06b5-4fe1-8118-8e0d6a4f70c6
      version: -1
      name: Verify Incident Field Error - Description
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'description' incident field was not set correctly. This may indicate that the following change has been made to the 'MDE Malware - Incident Enrichment' playbook:\n1-  The custom output mapping rule for the 'description' incident field configured within the 'Get full alert details' task was changed. \n2- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.Description' context key. \n3- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 12350,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "456":
    id: "456"
    taskid: 1d64d772-3d87-4012-8503-45b267423c82
    type: condition
    task:
      id: 1d64d772-3d87-4012-8503-45b267423c82
      version: -1
      name: Determine If There Is An Alert Description Within The Alert
      description: 'Checks for ''Description'' within the alert before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "136"
      "yes":
      - "454"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: Description
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 12350,
          "y": -410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "457":
    id: "457"
    taskid: 6f8cb83c-aaae-4a69-8af3-f118941ce668
    type: condition
    task:
      id: 6f8cb83c-aaae-4a69-8af3-f118941ce668
      version: -1
      name: Determine If There Is A File SHA1
      description: 'Checks for ''filesha1'' within the incident fields before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "128"
      "yes":
      - "220"
      - "218"
      - "78"
      - "354"
      - "356"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: incident
                accessor: filesha1
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 2240
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "458":
    id: "458"
    taskid: eebde314-47d4-4e7e-8c21-c01c3a8539cd
    type: condition
    task:
      id: eebde314-47d4-4e7e-8c21-c01c3a8539cd
      version: -1
      name: Verify Groups
      description: |
        Verify that the ‘Account.Groups’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "459"
      Verified:
      - "131"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: Account
                accessor: Groups
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 1140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "459":
    id: "459"
    taskid: 7bcc89a4-f448-400f-8f0d-1e160ba0bbe1
    type: regular
    task:
      id: 7bcc89a4-f448-400f-8f0d-1e160ba0bbe1
      version: -1
      name: Verify Context Error - Groups
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Account.Groups' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'Account Enrichment - Generic v2.1' sub-playbook outputs have been modified and no longer contain the 'Account.Groups' context key. \n2- The 'Username' input configuration was changed for the 'Account Enrichment - Generic v2.1' sub-playbook."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 1320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "460":
    id: "460"
    taskid: 67b318e1-f140-472a-812f-989606d96e15
    type: condition
    task:
      id: 67b318e1-f140-472a-812f-989606d96e15
      version: -1
      name: Determine If There Is An Account Context Data
      description: 'Checks for ''Account'' within the context data before testing the related incident field.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "131"
      "yes":
      - "458"
      - "461"
      - "463"
      - "465"
      - "467"
      - "469"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Account
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 960
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "461":
    id: "461"
    taskid: fb89c9c1-2f12-4c18-880f-5dede90e2de4
    type: condition
    task:
      id: fb89c9c1-2f12-4c18-880f-5dede90e2de4
      version: -1
      name: Verify Display Name
      description: |
        Verify that the ‘Account.DisplayName’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "462"
      Verified:
      - "131"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: Account
                accessor: DisplayName
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1330,
          "y": 1140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "462":
    id: "462"
    taskid: 6e1cc253-98fa-4bfd-8937-732809d188cc
    type: regular
    task:
      id: 6e1cc253-98fa-4bfd-8937-732809d188cc
      version: -1
      name: Verify Context Error - Display Name
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Account.DisplayName' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'Account Enrichment - Generic v2.1' sub-playbook outputs have been modified and no longer contain the 'Account.DisplayName' context key. \n2- The 'Username' input configuration was changed for the 'Account Enrichment - Generic v2.1' sub-playbook."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1330,
          "y": 1320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "463":
    id: "463"
    taskid: c8f819d0-13cc-4666-8bb8-5e95185692f3
    type: condition
    task:
      id: c8f819d0-13cc-4666-8bb8-5e95185692f3
      version: -1
      name: Verify Status
      description: |
        Verify that the ‘Account.Status’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "464"
      Verified:
      - "131"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: Account
                accessor: Status
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1730,
          "y": 1140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "464":
    id: "464"
    taskid: 8b89593c-f008-494b-8ab9-bb7a930cdcf1
    type: regular
    task:
      id: 8b89593c-f008-494b-8ab9-bb7a930cdcf1
      version: -1
      name: Verify Context Error - Status
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Account.Status' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'Account Enrichment - Generic v2.1' sub-playbook outputs have been modified and no longer contain the 'Account.Status' context key. \n2- The 'Username' input configuration was changed for the 'Account Enrichment - Generic v2.1' sub-playbook."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1730,
          "y": 1320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "465":
    id: "465"
    taskid: db044309-0cca-4ba6-87d6-1b59f4a6bdf6
    type: condition
    task:
      id: db044309-0cca-4ba6-87d6-1b59f4a6bdf6
      version: -1
      name: Verify Email
      description: |
        Verify that the ‘Account.Email’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "466"
      Verified:
      - "131"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: Account
                accessor: Email
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2120,
          "y": 1140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "466":
    id: "466"
    taskid: 1d550b17-8a33-42e8-826b-6d669744e7ea
    type: regular
    task:
      id: 1d550b17-8a33-42e8-826b-6d669744e7ea
      version: -1
      name: Verify Context Error - Email
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Account.Email' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'Account Enrichment - Generic v2.1' sub-playbook outputs have been modified and no longer contain the 'Account.Email' context key. \n2- The 'Username' input configuration was changed for the 'Account Enrichment - Generic v2.1' sub-playbook."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2120,
          "y": 1320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "467":
    id: "467"
    taskid: 7da179cb-dbfe-484a-8d90-c1f342511468
    type: condition
    task:
      id: 7da179cb-dbfe-484a-8d90-c1f342511468
      version: -1
      name: Verify Manager
      description: |
        Verify that the ‘Account.Manager’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "468"
      Verified:
      - "131"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: Account
                accessor: Manager
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2520,
          "y": 1140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "468":
    id: "468"
    taskid: 47e5f51e-0f04-43e0-8a97-07730dc6b4e1
    type: regular
    task:
      id: 47e5f51e-0f04-43e0-8a97-07730dc6b4e1
      version: -1
      name: Verify Context Error - Manager
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Account.Manager' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'Account Enrichment - Generic v2.1' sub-playbook outputs have been modified and no longer contain the 'Account.Manager' context key. \n2- The 'Username' input configuration was changed for the 'Account Enrichment - Generic v2.1' sub-playbook."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2520,
          "y": 1320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "469":
    id: "469"
    taskid: f7a4a604-cc23-4636-8e37-04966af1b4c4
    type: condition
    task:
      id: f7a4a604-cc23-4636-8e37-04966af1b4c4
      version: -1
      name: Verify Username
      description: |
        Verify that the ‘Account.Username’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "470"
      Verified:
      - "131"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: Account
                accessor: Username
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2910,
          "y": 1140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "470":
    id: "470"
    taskid: 94cc6a78-3aec-4a69-83f6-bbe8342618bc
    type: regular
    task:
      id: 94cc6a78-3aec-4a69-83f6-bbe8342618bc
      version: -1
      name: Verify Context Error - Username
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'Account.Username' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'Account Enrichment - Generic v2.1' sub-playbook outputs have been modified and no longer contain the 'Account.Username' context key. \n2- The 'Username' input configuration was changed for the 'Account Enrichment - Generic v2.1' sub-playbook."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2910,
          "y": 1320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "472":
    id: "472"
    taskid: 035976ee-511d-4037-8cc9-efb8ec8d1cc5
    type: condition
    task:
      id: 035976ee-511d-4037-8cc9-efb8ec8d1cc5
      version: -1
      name: Determine If There Is A File SHA1
      description: 'Checks for ''filesha1'' within the incident fields before testing the related context data.  '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "126"
      "yes":
      - "265"
      - "358"
      - "360"
      - "362"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: incident
                accessor: filesha1
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 935,
          "y": 3530
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "473":
    id: "473"
    taskid: 12000783-30ee-4a6d-8cf0-e349b9edc50e
    type: condition
    task:
      id: 12000783-30ee-4a6d-8cf0-e349b9edc50e
      version: -1
      name: Verify Last Update Time
      description: Verify that the ‘MicrosoftATP.Alert.LastUpdateTime’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "474"
      Verified:
      - "113"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: LastUpdateTime
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2490,
          "y": 1670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "474":
    id: "474"
    taskid: af45645e-2085-46f2-81ba-46f6437b2a6d
    type: regular
    task:
      id: af45645e-2085-46f2-81ba-46f6437b2a6d
      version: -1
      name: Verify Context Error - Last Update Time
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'MicrosoftATP.Alert.LastUpdateTime' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.LastUpdateTime' context key. \n2- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2495,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "475":
    id: "475"
    taskid: 938ef6bf-c5b5-430b-8f7c-bc1a5f5b6cc0
    type: condition
    task:
      id: 938ef6bf-c5b5-430b-8f7c-bc1a5f5b6cc0
      version: -1
      name: Verify First Event Time
      description: |
        Verify that the ‘MicrosoftATP.Alert.FirstEventTime’ context key was extracted correctly.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "476"
      Verified:
      - "113"
    separatecontext: false
    conditions:
    - label: Verified
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: MicrosoftATP.Alert
                accessor: FirstEventTime
            iscontext: true
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2880,
          "y": 1670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "476":
    id: "476"
    taskid: 415297fb-dd38-4a1c-826f-ea72065a566c
    type: regular
    task:
      id: 415297fb-dd38-4a1c-826f-ea72065a566c
      version: -1
      name: Verify Context Error - First Event Time
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: "The 'MicrosoftATP.Alert.FirstEventTime' context key not extracted properly. This may indicate that one or more of the following changes have been made to the 'Test Playbook - MDE Malware - Incident Enrichment' playbook:\n1- The 'microsoft-atp-get-alert-by-id' automation outputs have been modified and no longer contain the 'MicrosoftATP.Alert.FirstEventTime' context key. \n2- The 'alert_ids' input configuration was changed for the 'microsoft-atp-get-alert-by-id' automation used in the 'Get full alert details' task."
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2880,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "137_136_Verified": 0.1,
      "370_149_yes": 0.48,
      "372_136_#default#": 0.1,
      "372_368_yes": 0.5,
      "457_128_#default#": 0.72,
      "460_458_yes": 0.66,
      "75_113_ Verified": 0.1
    },
    "paper": {
      "dimensions": {
        "height": 5950,
        "width": 12600,
        "x": 590,
        "y": -1655
      }
    }
  }
inputs: []
outputs: []
fromversion: 6.5.0
