id: Microsoft Defender Advanced Threat Protection - Test
version: -1
vcShouldKeepItemLegacyProdMachine: false
name: Microsoft Defender Advanced Threat Protection - Test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 87de7076-dc52-4ffd-8d3e-d7f95ed3900f
    type: start
    task:
      id: 87de7076-dc52-4ffd-8d3e-d7f95ed3900f
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "27"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1985,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: af1205b9-93a8-40a5-8aeb-f8cb8ca00b98
    type: regular
    task:
      id: af1205b9-93a8-40a5-8aeb-f8cb8ca00b98
      version: -1
      name: Get ATP list alerts
      script: '|||microsoft-atp-list-alerts'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "25"
      - "52"
    scriptarguments:
      retry-count:
        simple: "3"
      severity:
        simple: Informational
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 64891cf0-ecc3-4431-8d80-faa13e09a214
    type: condition
    task:
      id: 64891cf0-ecc3-4431-8d80-faa13e09a214
      version: -1
      name: Assert an alert was fetched
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "20"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: MicrosoftATP
                accessor: Alert.ID
                transformers:
                - operator: atIndex
                  args:
                    index:
                      value:
                        simple: "0"
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 15a74483-adfc-47f5-805d-4e2a82d8a444
    type: title
    task:
      id: 15a74483-adfc-47f5-805d-4e2a82d8a444
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1550,
          "y": 3770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 63c4b724-bbe3-472b-8cc6-1f52f713298e
    type: regular
    task:
      id: 63c4b724-bbe3-472b-8cc6-1f52f713298e
      version: -1
      name: Get machines by health status
      description: Retrieves a collection of machines that have communicated with
        WDATP cloud on the last 30 days
      script: '|||microsoft-atp-get-machines'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "46"
      - "2"
    scriptarguments:
      health_status:
        simple: Active
      retry-count:
        simple: "3"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: 75b8dd3c-b8da-4240-863c-d00cb3105eec
    type: regular
    task:
      id: 75b8dd3c-b8da-4240-863c-d00cb3105eec
      version: -1
      name: Create alert with time as name
      script: '|||microsoft-atp-create-alert'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "43"
    scriptarguments:
      category:
        simple: None
      description:
        simple: Created for test
      event_time:
        complex:
          root: MicrosoftATP
          accessor: Hunt.Result
          transformers:
          - operator: getField
            args:
              field:
                value:
                  simple: Timestamp
      execution-timeout:
        simple: "10"
      machine_id:
        complex:
          root: MicrosoftATP
          accessor: Hunt.Result.DeviceId
          transformers:
          - operator: atIndex
            args:
              index:
                value:
                  simple: "0"
      recommended_action:
        simple: test alert
      report_id:
        complex:
          root: MicrosoftATP
          accessor: Hunt.Result
          transformers:
          - operator: getField
            args:
              field:
                value:
                  simple: ReportId
      retry-count:
        simple: "3"
      severity:
        simple: Medium
      title:
        simple: test alert
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: 0bac3e9e-5986-4788-8726-8b7080e0d710
    type: condition
    task:
      id: 0bac3e9e-5986-4788-8726-8b7080e0d710
      version: -1
      name: Assert alert created
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "8"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: MicrosoftATP
                accessor: Alert.ID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 4416e80e-b95b-4595-81ae-09d0fa2673ee
    type: regular
    task:
      id: 4416e80e-b95b-4595-81ae-09d0fa2673ee
      version: -1
      name: Advance query
      script: '|||microsoft-atp-advanced-hunting'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "21"
    scriptarguments:
      query:
        simple: DeviceLogonEvents | take 1 | project DeviceId, ReportId, tostring(Timestamp)
      retry-count:
        simple: "3"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: 515022cd-9cd5-443e-874e-d73347ae3af8
    type: condition
    task:
      id: 515022cd-9cd5-443e-874e-d73347ae3af8
      version: -1
      name: Assert query results
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "18"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: MicrosoftATP
                accessor: Hunt.Result.ReportId
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: 6dbdf059-d021-4f11-8ec9-8b8b2d3c9b6d
    type: regular
    task:
      id: 6dbdf059-d021-4f11-8ec9-8b8b2d3c9b6d
      version: -1
      name: Get machine related to domain
      description: Retrieves a collection of machines that have communicated to or
        from a given domain address.
      script: '|||microsoft-atp-get-domain-machines'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "15"
      - "28"
      - "26"
      - "29"
      - "44"
      - "50"
    scriptarguments:
      domain:
        simple: microsoft.com
      retry-count:
        simple: "3"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1985,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "25":
    id: "25"
    taskid: 17a6af7d-01f6-44de-8f87-485bfbb305b5
    type: regular
    task:
      id: 17a6af7d-01f6-44de-8f87-485bfbb305b5
      version: -1
      name: Get alert related files
      description: Retrieves the files associated to a specific alert.
      script: '|||microsoft-atp-get-alert-related-files'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      id:
        complex:
          root: MicrosoftATP.Alert
          accessor: ID
          transformers:
          - operator: atIndex
            args:
              index:
                value:
                  simple: "0"
      limit:
        simple: "10"
      retry-count:
        simple: "3"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: 370ec8bf-49d1-4375-8dde-d5a1c06402b7
    type: regular
    task:
      id: 370ec8bf-49d1-4375-8dde-d5a1c06402b7
      version: -1
      name: Get domain related alerts
      description: Retrieves a collection of alerts related to a given domain address.
      script: '|||microsoft-atp-get-domain-alerts'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      domain:
        simple: ${MicrosoftATP.DomainMachine.Domain}
      retry-count:
        simple: "3"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: c1580023-9965-4d89-89b7-c5d767197b00
    type: regular
    task:
      id: c1580023-9965-4d89-89b7-c5d767197b00
      version: -1
      name: Delete context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "24"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1985,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: 39660f84-cd1b-4be3-8864-b1d326de9dcd
    type: regular
    task:
      id: 39660f84-cd1b-4be3-8864-b1d326de9dcd
      version: -1
      name: Get domain statistics
      description: Retrieves the statistics on the given domain.
      script: '|||microsoft-atp-get-domain-statistics'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      domain:
        simple: ${MicrosoftATP.DomainMachine.Domain}
      retry-count:
        simple: "3"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: 7a167819-616f-4888-8e30-a32d34ba3f00
    type: regular
    task:
      id: 7a167819-616f-4888-8e30-a32d34ba3f00
      version: -1
      name: Get machine action data
      description: Return the machine's actions. If you set an action id it will return
        the info on the specific action
      script: '|||microsoft-atp-list-machine-actions-details'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "38"
    scriptarguments:
      machine_id:
        complex:
          root: MicrosoftATP.DomainMachine.Machines
          accessor: ID
          transformers:
          - operator: atIndex
            args:
              index:
                value:
                  simple: "0"
      retry-count:
        simple: "3"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2200,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: ce7614db-0028-41aa-85a1-433c57df84f7
    type: regular
    task:
      id: ce7614db-0028-41aa-85a1-433c57df84f7
      version: -1
      name: Get file statistics
      description: Retrieves the statistics for the given file.
      script: '|||microsoft-atp-get-file-statistics'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "35"
    scriptarguments:
      file_hash:
        simple: E2101519714F8A4056A9DE18443BC6E8A1F1B977
      retry-count:
        simple: "3"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: aea68c0a-1566-4674-8a69-f01948fdeee7
    type: regular
    task:
      id: aea68c0a-1566-4674-8a69-f01948fdeee7
      version: -1
      name: Get ip statistics
      description: Retrieves the statistics for the given IP.
      script: '|||microsoft-atp-get-ip-statistics'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      ip:
        simple: 8.8.8.8
      retry-count:
        simple: "3"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: 642be99f-bea8-4287-85b6-a36ea96e6454
    type: regular
    task:
      id: 642be99f-bea8-4287-85b6-a36ea96e6454
      version: -1
      name: Get user alerts
      description: Retrieves a collection of alerts related to a given user ID.
      script: '|||microsoft-atp-get-user-alerts'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "37"
    scriptarguments:
      retry-count:
        simple: "3"
      username:
        simple: demisto
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: 96f0b243-11ac-4414-8b82-83711ff77780
    type: regular
    task:
      id: 96f0b243-11ac-4414-8b82-83711ff77780
      version: -1
      name: Get user machines
      description: Retrieves a collection of machines related to a given user ID.
      script: '|||microsoft-atp-get-user-machines'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      retry-count:
        simple: "3"
      username:
        simple: demisto
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: 819cff65-9792-4c29-85e2-bcac7317ce4c
    type: regular
    task:
      id: 819cff65-9792-4c29-85e2-bcac7317ce4c
      version: -1
      name: Add machine tag
      description: Adds or remove tag to a specific Machine.
      script: '|||microsoft-atp-add-remove-machine-tag'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "39"
    scriptarguments:
      action:
        simple: Add
      machine_id:
        complex:
          root: MicrosoftATP.DomainMachine.Machines
          accessor: ID
          transformers:
          - operator: atIndex
            args:
              index:
                value:
                  simple: "0"
      retry-count:
        simple: "3"
      tag:
        simple: testing
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2200,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: 82df2f82-3f1c-4607-80c4-cbb6ca40bb56
    type: regular
    task:
      id: 82df2f82-3f1c-4607-80c4-cbb6ca40bb56
      version: -1
      name: Remove machine tag
      description: Adds or remove tag to a specific Machine.
      script: '|||microsoft-atp-add-remove-machine-tag'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      action:
        simple: Remove
      machine_id:
        simple: ${MicrosoftATP.Machine.ID}
      retry-count:
        simple: "3"
      tag:
        simple: testing
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2200,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: 3df9243f-3de7-4237-8160-34addb255701
    type: regular
    task:
      id: 3df9243f-3de7-4237-8160-34addb255701
      version: -1
      name: update alert
      description: Update the properties of an alert entity
      script: '|||microsoft-atp-update-alert'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      alert_id:
        complex:
          root: MicrosoftATP
          accessor: Alert.ID
          transformers:
          - operator: atIndex
            args:
              index:
                value:
                  simple: "0"
      classification:
        simple: Unknown
      comment:
        simple: testing
      retry-count:
        simple: "3"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "44":
    id: "44"
    taskid: 2d62ff5b-c801-4d1e-8eb4-c480c5bdfc07
    type: regular
    task:
      id: 2d62ff5b-c801-4d1e-8eb4-c480c5bdfc07
      version: -1
      name: Start Investigation
      description: Start an automated investigation on a machine.
      script: '|||microsoft-atp-start-investigation'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "45"
    scriptarguments:
      comment:
        simple: testing
      machine_id:
        complex:
          root: MicrosoftATP.DomainMachine.Machines
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: MicrosoftATP.DomainMachine.Machines.OSPlatform
                iscontext: true
              right:
                value:
                  simple: Windows10
          accessor: ID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2630,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: c948239f-030d-41aa-843b-a3c1b2dc6d16
    type: regular
    task:
      id: c948239f-030d-41aa-843b-a3c1b2dc6d16
      version: -1
      name: List investigations
      description: Retrieves a collection of investigations or retrieves a specific
        investigation by its ID.
      script: '|||microsoft-atp-list-investigations'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      limit:
        simple: "5"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2630,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: 20d309e4-70b1-409c-8ae2-889f737c9ac1
    type: regular
    task:
      id: 20d309e4-70b1-409c-8ae2-889f737c9ac1
      version: -1
      name: endpoint command
      description: Gets machines that have communicated with Microsoft Defender for
        Endpoint cloud. At least one of the following arguments is required ip, hostanme
        ot id. Otherwise, an error appears.
      script: Microsoft Defender Advanced Threat Protection|||endpoint
      type: regular
      iscommand: true
      brand: Microsoft Defender Advanced Threat Protection
    nexttasks:
      '#none#':
      - "47"
    scriptarguments:
      hostname:
        simple: ${MicrosoftATP.Machine.ComputerDNSName}
      id:
        simple: ${MicrosoftATP.Machine.ID}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: 088262e2-4447-402d-86ad-70dc61052c13
    type: condition
    task:
      id: 088262e2-4447-402d-86ad-70dc61052c13
      version: -1
      name: verify endpoint ID
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, no is returned.
      scriptName: AreValuesEqual
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "48"
    scriptarguments:
      left:
        simple: ${Endpoint.ID}
      right:
        simple: ${MicrosoftATP.Machine.ID}
    results:
    - AreValuesEqual
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: 22c628f2-286e-4d72-8a09-5b31736f2634
    type: condition
    task:
      id: 22c628f2-286e-4d72-8a09-5b31736f2634
      version: -1
      name: verify endpoint hostname
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, no is returned.
      scriptName: AreValuesEqual
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "49"
    scriptarguments:
      left:
        simple: ${Endpoint.Hostname}
      right:
        simple: ${MicrosoftATP.Machine.ComputerDNSName}
    results:
    - AreValuesEqual
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: 435fda0e-f77f-468b-8d43-cdbc49bb43c1
    type: condition
    task:
      id: 435fda0e-f77f-468b-8d43-cdbc49bb43c1
      version: -1
      name: verify endpoint vendor
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, no is returned.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "8"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: ${Endpoint.Vendor}
            iscontext: true
          right:
            value:
              simple: Microsoft Defender ATP
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: 221c4d98-f3cd-471d-8020-b8b112f86ba3
    type: regular
    task:
      id: 221c4d98-f3cd-471d-8020-b8b112f86ba3
      version: -1
      name: Ge file info
      description: Retrieves file info by a file hash (Sha1 or Sha256).
      script: '|||microsoft-atp-get-file-info'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "51"
    scriptarguments:
      hash:
        simple: 3395856ce81f2b7382dee72602f798b642f14140,db79e9e669c42b5ac46fc6d6b590ca990687958b
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3060,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: e44de7eb-1210-4033-8b9d-16a727bc2ada
    type: regular
    task:
      id: e44de7eb-1210-4033-8b9d-16a727bc2ada
      version: -1
      name: Get machine by vulnerability
      description: Retrieves a list of machines affected by a vulnerability.
      script: '|||microsoft-atp-list-machines-by-vulnerability'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "55"
    scriptarguments:
      cve_id:
        simple: CVE-2021-32810,CVE-2020-12321
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3060,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "52":
    id: "52"
    taskid: c88ac41f-8109-42b7-8264-65c248724876
    type: regular
    task:
      id: c88ac41f-8109-42b7-8264-65c248724876
      version: -1
      name: Get machine related alerts
      description: Retrieves all Alerts related to a specific device.
      script: '|||microsoft-atp-get-machine-alerts'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "53"
    scriptarguments:
      machine_id:
        complex:
          root: MicrosoftATP.Machine
          accessor: ID
          transformers:
          - operator: atIndex
            args:
              index:
                value:
                  simple: "0"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: d164434f-8c7c-4a01-83f3-89e5a9be9004
    type: condition
    task:
      id: d164434f-8c7c-4a01-83f3-89e5a9be9004
      version: -1
      name: Assert related alerts
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "54"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: MicrosoftATP.Machine.ID
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "54":
    id: "54"
    taskid: 7a3a2a31-2799-445f-8287-357d0be41177
    type: regular
    task:
      id: 7a3a2a31-2799-445f-8287-357d0be41177
      version: -1
      name: Get machine logged on users
      description: Retrieves a collection of logged on users on a specific device.
      script: '|||microsoft-atp-get-machine-users'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      machine_id:
        complex:
          root: MicrosoftATP.Machine.ID
          filters:
          - - operator: startWith
              left:
                value:
                  simple: MicrosoftATP.Machine.ID
                iscontext: true
              right:
                value:
                  simple: "489903"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "55":
    id: "55"
    taskid: 3e3e1990-1072-43cd-8361-f138c964c6ef
    type: regular
    task:
      id: 3e3e1990-1072-43cd-8361-f138c964c6ef
      version: -1
      name: Get list vulnerabilities by machine
      description: Retrieves a list of all the vulnerabilities affecting the organization
        per machine.
      script: '|||microsoft-atp-list-vulnerabilities-by-machine'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "56"
    scriptarguments:
      cve_id:
        simple: ${MicrosoftATP.CveMachine.CVE}
      machine_id:
        simple: ${MicrosoftATP.CveMachine.ID}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3060,
          "y": 2110
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "56":
    id: "56"
    taskid: 72cd3ef2-d54c-4731-80a6-dd610d84eb74
    type: condition
    task:
      id: 72cd3ef2-d54c-4731-80a6-dd610d84eb74
      version: -1
      name: Verify vulnerabilities
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, no is returned.
      scriptName: AreValuesEqual
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "57"
    scriptarguments:
      left:
        complex:
          root: MicrosoftATP.CveMachine
          accessor: CVE
          transformers:
          - operator: atIndex
            args:
              index:
                value:
                  simple: "0"
      right:
        complex:
          root: MicrosoftATP.MachineCVE
          accessor: cveId
          transformers:
          - operator: atIndex
            args:
              index:
                value:
                  simple: "0"
    results:
    - AreValuesEqual
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3060,
          "y": 2270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "57":
    id: "57"
    taskid: f5742446-9b6e-40ff-85f2-1302628b04f2
    type: regular
    task:
      id: f5742446-9b6e-40ff-85f2-1302628b04f2
      version: -1
      name: Get list vulnerabilities
      description: Retrieves a list of all vulnerabilities.
      script: '|||microsoft-atp-list-vulnerabilities'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "58"
    scriptarguments:
      id:
        simple: ${MicrosoftATP.MachineCVE.cveId}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3060,
          "y": 2430
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "58":
    id: "58"
    taskid: ca3fb6a2-07dc-4d02-81b5-7141fac3b641
    type: condition
    task:
      id: ca3fb6a2-07dc-4d02-81b5-7141fac3b641
      version: -1
      name: Verify vulnerabilities
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, no is returned.
      scriptName: AreValuesEqual
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "59"
    scriptarguments:
      left:
        simple: ${MicrosoftATP.Vulnerability.id}
      right:
        simple: ${MicrosoftATP.MachineCVE.cveId}
    results:
    - AreValuesEqual
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3060,
          "y": 2580
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "59":
    id: "59"
    taskid: 70a403b3-c926-4e85-82dd-d3e1df5db584
    type: regular
    task:
      id: 70a403b3-c926-4e85-82dd-d3e1df5db584
      version: -1
      name: Get list software
      description: Retrieves the organization software inventory.
      script: '|||microsoft-atp-list-software'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "60"
    scriptarguments:
      id:
        simple: microsoft-_-powershell_6-x64
      vendor:
        simple: microsoft
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3060,
          "y": 2755
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: 6c760bf5-29b3-43c2-8f12-c80334eb0255
    type: condition
    task:
      id: 6c760bf5-29b3-43c2-8f12-c80334eb0255
      version: -1
      name: Verify software list
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, no is returned.
      scriptName: AreValuesEqual
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "61"
    scriptarguments:
      left:
        simple: ${MicrosoftATP.Software.id}
      right:
        simple: microsoft-_-powershell_6-x64
    results:
    - AreValuesEqual
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3060,
          "y": 2930
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    id: "61"
    taskid: 08148a20-4524-4620-8f91-cb276f2fcaa8
    type: regular
    task:
      id: 08148a20-4524-4620-8f91-cb276f2fcaa8
      version: -1
      name: Get list vulnerabilities by software
      description: Retrieves a list of all the vulnerabilities affecting the organization
        per software.
      script: '|||microsoft-atp-list-vulnerabilities-by-software'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "62"
    scriptarguments:
      id:
        simple: microsoft-_-powershell_6-x64
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3060,
          "y": 3110
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "62":
    id: "62"
    taskid: 6ca582b0-e2d5-4dec-8054-d9a480b3fc5b
    type: condition
    task:
      id: 6ca582b0-e2d5-4dec-8054-d9a480b3fc5b
      version: -1
      name: Verify vulnerabilities
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "63"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEmpty
          left:
            value:
              simple: MicrosoftATP.SoftwareCVE.id
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3060,
          "y": 3280
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: b292d556-79f4-46ae-8ae7-e189111cc130
    type: regular
    task:
      id: b292d556-79f4-46ae-8ae7-e189111cc130
      version: -1
      name: Get list machines by software
      description: Retrieve a list of device references that has this software installed.
      script: '|||microsoft-atp-list-machines-by-software'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "64"
    scriptarguments:
      id:
        simple: microsoft-_-defender_for_endpoint
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3060,
          "y": 3460
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "64":
    id: "64"
    taskid: afdc1f3e-f6f0-45c6-8532-81d6ef104f64
    type: condition
    task:
      id: afdc1f3e-f6f0-45c6-8532-81d6ef104f64
      version: -1
      name: Verify list machines by software
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, no is returned.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "8"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MicrosoftATP.SoftwareMachine.id
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3060,
          "y": 3620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 3785,
        "width": 3390,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
fromversion: 6.2.0
description: ''
