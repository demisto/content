[INGEST:vendor="trellix", product="epo", target_dataset="trellix_epo_raw" , no_hit=keep]
| alter DetectedUTC = arrayindex(regextract(_raw_log,"DetectedUTC\>(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})\<\/DetectedUTC"),0)
| alter _time = parse_timestamp("%FT%T", DetectedUTC)
| alter tmp_get_xml_keys = rtrim(arraystring(arraymap(regextract(_raw_log,"(\<[^\/\>][a-zA-Z]+\>)+"),concat("(?P", "@element", "[^|]+)?\|")),""),"\|")
| alter tmp_get_xml_values = replex(replex(replex(arraystring(regextract(_raw_log,"(\<[^\/\>][a-zA-Z]+\>?[^\<]+<)\/"),"|"),"\<[^>|]+",""),"><","null"),">([^<]+)<","\1")
| alter parsed_fields = if(tmp_get_xml_values = null or tmp_get_xml_values ~= "^\s*$", null, regexcapture(tmp_get_xml_values, tmp_get_keys))
| fields -tmp_*;