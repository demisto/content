id: Superna Zero Trust User Lockout
version: -1
name: Superna Zero Trust User Lockout
fromversion: 8.9.0
description: 'Locks out a user from NAS storage access in response to Zero Trust incidents. Extracts the source username from the incident and executes lockout via Superna Zero Trust integration.'
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 8282f383-8434-46f4-8fdc-91b711d30d61
    type: start
    task:
      id: 8282f383-8434-46f4-8fdc-91b711d30d61
      version: -1
      name: ""
      description: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 470,
          "y": -170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: c9d8e7f6-a5b4-4c3d-9e8f-7a6b5c4d3e2f
    type: condition
    task:
      id: c9d8e7f6-a5b4-4c3d-9e8f-7a6b5c4d3e2f
      version: -1
      name: Is Superna Zero Trust integration enabled?
      description: Verify that the Superna Zero Trust integration is available before executing playbook
      scriptName: IsIntegrationAvailable
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "5"
    scriptarguments:
      brandname:
        simple: SupernaZeroTrust
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 470,
          "y": -50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 1522802c-11ea-4a49-8de3-22e0b71bba99
    type: regular
    task:
      id: 1522802c-11ea-4a49-8de3-22e0b71bba99
      version: -1
      name: Superna Zero Trust Lockout User
      description: Lock out a user from NAS storage access
      script: SupernaZeroTrust|||superna-zt-lockout-user
      type: regular
      iscommand: true
      brand: SupernaZeroTrust
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      username:
        simple: ${inputs.username}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 460,
          "y": 250
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 9aa29e1f-1021-47f3-8e86-6b9f12c99735
    type: title
    task:
      id: 9aa29e1f-1021-47f3-8e86-6b9f12c99735
      version: -1
      name: Done
      type: title
      description: ""
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 460,
          "y": 500
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 8e672319-aa07-41c9-8c54-273050485749
    type: regular
    task:
      id: 8e672319-aa07-41c9-8c54-273050485749
      version: -1
      name: print inputs to API task
      description: Prints text to war room (Markdown supported)
      scriptName: Print
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    scriptarguments:
      value:
        simple: Locking out user ${inputs.username}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 470,
          "y": 80
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 735,
        "width": 390,
        "x": 460,
        "y": -170
      }
    }
  }
inputs:
- key: username
  value:
    complex:
      root: incident
      accessor: sourceusername
  required: false
  description: The source user name is populated by Superna Zero trust webhook integration
  playbookInputQuery:
outputs: []
quiet: false
tests:
- No tests (auto formatted)
