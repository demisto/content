id: Superna Zero Trust Request User Storage Lockout
version: -1
name: Superna Zero Trust Request User Storage Lockout
fromversion: 8.9.0
description: Offers an input question to accept the userID that should be locked out of storage. This playbook can be run by any Secops workflow where the threat to data is increased and a proactive step to ensure no data can be destroyed or it can be used as step in a workflow when employees are leaving the company or have been terminated.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 8282f383-8434-46f4-8fdc-91b711d30d61
    type: start
    task:
      id: 8282f383-8434-46f4-8fdc-91b711d30d61
      version: -1
      name: ""
      description: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 470,
          "y": -170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: f1e2d3c4-b5a6-4978-8e9f-0a1b2c3d4e5f
    type: condition
    task:
      id: f1e2d3c4-b5a6-4978-8e9f-0a1b2c3d4e5f
      version: -1
      name: Is Superna Zero Trust integration enabled?
      description: Verify that the Superna Zero Trust integration is available before executing playbook
      scriptName: IsIntegrationAvailable
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "6"
    scriptarguments:
      brandname:
        simple: SupernaZeroTrust
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 470,
          "y": -50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 9aa29e1f-1021-47f3-8e86-6b9f12c99735
    type: title
    task:
      id: 9aa29e1f-1021-47f3-8e86-6b9f12c99735
      version: -1
      name: Done
      description: ""
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 470,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 2dc05c22-94ce-4f5d-80a7-76976eab1a80
    type: collection
    task:
      id: 2dc05c22-94ce-4f5d-80a7-76976eab1a80
      version: -1
      name: Prompt for userid
      description: ""
      type: collection
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 470,
          "y": 70
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to:
      subject:
      body:
      methods: []
      format: ""
      bcc:
      cc:
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
        completeafterv2: true
        completeaftersla: false
    form:
      questions:
      - id: "0"
        label: ""
        labelarg:
          simple: 'Enter user ID in AD format domain\userID '
        required: true
        gridcolumns: []
        defaultrows: []
        type: shortText
        options: []
        optionsarg: []
        fieldassociated: ""
        placeholder: example corp\username
        tooltip: ""
        readonly: false
      title: User NAS lock out request
      description: This workflow allows secOPS to request a user is locked out of NAS storage as a precaution and support SMB share auto permission detection to deny the specific user access to storage until the security threat can be resolve.
      sender: ""
      expired: false
      totalanswers: 0
    skipunavailable: false
    quietmode: 2
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: c8ff4cc9-8cdd-4759-8d9d-e267f8554456
    type: regular
    task:
      id: c8ff4cc9-8cdd-4759-8d9d-e267f8554456
      version: -1
      name: url encode userid
      description: 'Encodes a URL string by replacing special characters in the string using the %xx escape. For example: https://example.com converts to https:%2F%2Fexample.com.'
      scriptName: URLEncode
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      value:
        simple: ${User NAS lock out request.Answers.0}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 470,
          "y": 250
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 3e4d9d94-3b66-4288-8210-8446ba586009
    type: regular
    task:
      id: 3e4d9d94-3b66-4288-8210-8446ba586009
      version: -1
      name: Superna Zero Trust Lockout User
      description: Lock out a user from NAS storage access
      script: SupernaZeroTrust|||superna-zt-lockout-user
      type: regular
      iscommand: true
      brand: SupernaZeroTrust
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      username:
        simple: ${User NAS lock out request.Answers.0}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 470,
          "y": 470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 955,
        "width": 380,
        "x": 470,
        "y": -170
      }
    }
  }
inputs: []
outputs: []
quiet: false
tests:
- No tests (auto formatted)
