category: Utilities
commonfields:
  id: SecurityTrails
  version: -1
configuration:
- display: API Key
  name: apikey
  required: true
  type: 4
- display: Timeout
  name: timeout
  defaultvalue: 10
  type: 3
  additionalinfo: Some commands can take a while to return. Extending the timeout can avoid timeout issues.
- display: Trust any certificate (not secure)
  name: insecure
  type: 8
- display: Use system proxy settings
  name: proxy
  type: 8
- additionalinfo: Reliability of the source providing the intelligence data.
  defaultvalue: B - Usually reliable
  display: Source Reliability
  name: integrationReliability
  options:
  - A+ - 3rd party enrichment
  - A - Completely reliable
  - B - Usually reliable
  - C - Fairly reliable
  - D - Not usually reliable
  - E - Unreliable
  - F - Reliability cannot be judged
  type: 15
- defaultvalue: indicatorType
  name: feedExpirationPolicy
  display: ''
  options:
  - never
  - interval
  - indicatorType
  - suddenDeath
  type: 17
- defaultvalue: '20160'
  name: feedExpirationInterval
  display: ''
  type: 1
description: This integration provides API access to the SecurityTrails platform.
display: SecurityTrails
name: SecurityTrails
script:
  commands:
  - arguments:
    - description: The hostname
      name: hostname
      required: true
    - auto: PREDEFINED
      defaultValue: "true"
      description: Only return children subdomains
      name: children_only
      predefined:
      - "true"
      - "false"
    description: Returns child and sibling subdomains for a given hostname.
    name: securitytrails-get-subdomains
    outputs:
    - contextPath: SecurityTrails.Domain.name
      description: Hostname
      type: string
    - contextPath: SecurityTrails.Domain.subdomains
      description: Subdomains
    - contextPath: Domain.Name
      description: Domain name
      type: string
    - contextPath: Domain.Subdomains
      description: Subdomains
      type: string
    - contextPath: SecurityTrails.Domain.subdomain_count
      description: Subdomain Count
      type: number
  - arguments:
    - description: The hostname
      name: hostname
      required: true
    description: Returns the current data about the given hostname. In addition to the current data, you also get the current statistics associated with a particular record. For example, for a records you'll get how many other hostnames have the same IP.
    name: securitytrails-get-domain-details
    outputs:
    - contextPath: SecurityTrails.Domain.name
      description: Domain name
      type: string
    - contextPath: SecurityTrails.Domain.alexa_rank
      description: Alexa rank
      type: number
    - contextPath: SecurityTrails.Domain.apex_domain
      description: Apex domain
      type: string
    - contextPath: SecurityTrails.Domain.current_dns
      description: Current DNS records
    - contextPath: SecurityTrails.Domain.subdomain_count
      description: Subdomain count
      type: number
    - contextPath: Domain.Name
      description: Domain name
      type: string
    - contextPath: Domain.NameServers
      description: Name servers
      type: string
  - arguments:
    - description: Hostname
      name: hostname
      required: true
    description: Returns tags for a given hostname
    name: securitytrails-get-tags
    outputs:
    - contextPath: SecurityTrails.Domain.name
      description: Domain name
      type: string
    - contextPath: SecurityTrails.Domain.tags
      description: Domain tags
    - contextPath: Domain.Name
      description: Domain name
      type: string
    - contextPath: Domain.Tags
      description: Domain tags
      type: string
  - arguments:
    - description: Domain
      name: domain
      description: Provides data enrichment for domains.
      outputs:
        - contextPath: Domain.Name
          description: 'The domain name, for example: "google.com".'
          type: String
        - contextPath: Domain.DNS
          description: A list of IP objects resolved by DNS.
          type: String
        - contextPath: Domain.DomainStatus
          description: The status of the domain.
          type: Datte
        - contextPath: Domain.NameServers
          description: (List<String>) Name servers of the domain.
          type: Unknown
        - contextPath: Domain.Organization
          description: The organization of the domain.
          type: String
        - contextPath: Domain.Subdomains
          description: (List<String>) Subdomains of the domain.
          type: Unknown
        - contextPath: Domain.Admin.Country
          description: The country of the domain administrator.
          type: String
        - contextPath: Domain.Admin.Email
          description: The email address of the domain administrator.
          type: String
        - contextPath: Domain.Admin.Name
          description: The name of the domain administrator.
          type: String
        - contextPath: Domain.Admin.Phone
          description: The phone number of the domain administrator.
          type: String
        - contextPath: Domain.Registrant.Country
          description: The country of the registrant.
          type: String
        - contextPath: Domain.Registrant.Email
          description: The email address of the registrant.
          type: String
        - contextPath: Domain.Registrant.Name
          description: The name of the registrant.
          type: String
        - contextPath: Domain.Registrant.Phone
          description: The phone number for receiving abuse reports.
          type: String
        - contextPath: Domain.Tags
          description: (List) Tags of the domain.
          type: Unknown
        - contextPath: Domain.WHOIS.DomainStatus
          description: The status of the domain.
          type: String
        - contextPath: Domain.WHOIS.NameServers
          description: (List<String>) Name servers of the domain.
          type: String
        - contextPath: Domain.WHOIS.CreationDate
          description: The date that the domain was created.
          type: Date
        - contextPath: Domain.WHOIS.UpdatedDate
          description: The date that the domain was last updated.
          type: Date
        - contextPath: Domain.WHOIS.ExpirationDate
          description: The expiration date of the domain.
          type: Date
        - contextPath: Domain.WHOIS.Registrant.Name
          description: The name of the registrant.
          type: String
        - contextPath: Domain.WHOIS.Registrant.Email
          description: The email address of the registrant.
          type: String
        - contextPath: Domain.WHOIS.Registrant.Phone
          description: The phone number of the registrant.
          type: String
        - contextPath: Domain.WHOIS.Registrar.Name
          description: "The name of the registrar, for example: `GoDaddy`"
          type: String
        - contextPath: Domain.WHOIS.Registrar.Email
          description: The email address of the contact.
          type: String
        - contextPath: Domain.WHOIS.Registrar.Phone
          description: The phone number of contact.
          type: String
        - contextPath: Domain.WHOIS.Admin.Name
          description: The name of the domain administrator.
          type: String
        - contextPath: Domain.WHOIS.Admin.Email
          description: The email address of the domain administrator.
          type: String
        - contextPath: Domain.WHOIS.Admin.Phone
          description: The phone number of the domain administrator.
          type: String
        - contextPath: DBotScore.Indicator
          description: The indicator that was tested.
          type: String
        - contextPath: DBotScore.Type
          description: The indicator type.
          type: String
        - contextPath: DBotScore.Vendor
          description: The vendor used to calculate the score.
          type: String
        - contextPath: DBotScore.Score
          description: The actual score.
          type: Number
    - arguments:
        - name: sql
          description: 'The SQL query to execute (example: SELECT attribute FROM table
            WHERE condition = "value")'
          required: true
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: timeout
          description: Read timeout for calls (default is 20 seconds)
          required: false
          isArray: false
          defaultValue: "20"
          predefined:
            - ""
      name: securitytrails-sql-query
      description: "Queries the SecurityTrails SQL endpoint. The SecurityTrails SQL
        API provides a powerful SQL-like query interface to data via certain API
        endpoints. For a full reference of properties and operators please check
        the following link: https://securitytrails.com/reference/sql"
      deprecated: false
      outputs:
        - contextPath: Securitytrails.SQL.total
          description: The total number of hits discovered
          type: Number
        - contextPath: Securitytrails.SQL.records
          description: The records returned
          type: Unknown
        - contextPath: Securitytrails.SQL.id
          description: The ID to use for further GET calls to retrieve more results
          type: String
        - contextPath: Securitytrails.SQL.query
          description: The original query used
          type: String
        - contextPath: Securitytrails.SQL.pages
          description: The total number of pages that would need to be called to retrieve
            the rest of the results
          type: Number
    - arguments:
        - name: id
          description: The ID to use to retrieve the next page of results
          required: true
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: timeout
          description: Read timeout for calls (default is 20 seconds)
          required: false
          isArray: false
          defaultValue: "20"
          predefined:
            - ""
      name: securitytrails-sql-get-next
      description: Retrieves the next page of results returned from a SQL query where
        the results exceeded the last page.
      deprecated: false
      outputs:
        - contextPath: Securitytrails.SQL.total
          description: The total number of hits discovered
          type: number
        - contextPath: Securitytrails.SQL.records
          description: The records returned
        - contextPath: Securitytrails.SQL.id
          description: The ID to use for further GET calls to retrieve more results
          type: string
        - contextPath: Securitytrails.SQL.query
          description: The original query used
          type: string
  dockerimage: demisto/python3:3.10.12.63474
  runonce: false
  script: ''
  subtype: python3
  type: python
fromversion: 6.0.0
tests:
- No tests (auto formatted)
