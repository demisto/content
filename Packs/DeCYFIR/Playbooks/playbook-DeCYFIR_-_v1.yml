id: DeCYFIR - v1
version: -1
name: DeCYFIR - v1
starttaskid: '0'
tasks:
  '0':
    id: '0'
    taskid: b7a09b64-2308-4487-8e79-50cde7b38fb2
    type: start
    task:
      id: b7a09b64-2308-4487-8e79-50cde7b38fb2
      version: -1
      name: ''
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '18'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1610,
          "y": -50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '2':
    id: '2'
    taskid: 65599e92-12ae-43d5-8515-81af93e2f32c
    type: condition
    task:
      id: 65599e92-12ae-43d5-8515-81af93e2f32c
      version: -1
      name: Check  DeCYFIR Categories
      type: condition
      iscommand: false
      brand: ''
      description: Check  DeCYFIR Categories
    nexttasks:
      AS:
      - '3'
      DR-DB_WB:
      - '16'
      DR-IMP_INF:
      - '4'
      DR-SO_PE:
      - '6'
    separatecontext: false
    conditions:
    - label: AS
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: incident.category
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: incident.category
                      iscontext: true
                    right:
                      value:
                        simple: Attack Surface
            iscontext: true
          right:
            value:
              simple: incident.category
            iscontext: true
    - label: DR-IMP_INF
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: incident.category
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: incident.category
                      iscontext: true
                    right:
                      value:
                        simple: Impersonation & Infringement
            iscontext: true
          right:
            value:
              simple: incident.category
            iscontext: true
    - label: DR-DB_WB
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: incident.category
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: incident.category
                      iscontext: true
                    right:
                      value:
                        simple: Data Breach & Web Monitoring
            iscontext: true
          right:
            value:
              simple: incident.category
            iscontext: true
    - label: DR-SO_PE
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: incident.category
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: incident.category
                      iscontext: true
                    right:
                      value:
                        simple: Social & Public Exposure
            iscontext: true
          right:
            value:
              simple: incident.category
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1570,
          "y": 460
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '3':
    id: '3'
    taskid: 0ce8f781-1692-492c-8ec6-d33b79d3d4af
    type: regular
    task:
      id: 0ce8f781-1692-492c-8ec6-d33b79d3d4af
      version: -1
      name: Extract Indicators from Attack Surface
      description: Extract all indicators according to server indicators configuration
      script: Builtin|||extractIndicators
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - '7'
    scriptarguments:
      text:
        simple: ${incident}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1142.5,
          "y": 645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '4':
    id: '4'
    taskid: 77aac983-1ee7-4d02-8f6f-f23427d533b9
    type: playbook
    task:
      id: 77aac983-1ee7-4d02-8f6f-f23427d533b9
      version: -1
      name: Default
      description: This playbook executes when no other playbook is associated with an incident. It enriches indicators in an incident using one or more integrations.
      playbookName: Default
      type: playbook
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '17'
    scriptarguments:
      Enrich:
        simple: 'True'
      OnCall:
        simple: 'false'
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ''
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 2135,
          "y": 1090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '6':
    id: '6'
    taskid: 14dd6c08-e662-4c90-87de-94179c6348b3
    type: playbook
    task:
      id: 14dd6c08-e662-4c90-87de-94179c6348b3
      version: -1
      name: Default
      description: This playbook executes when no other playbook is associated with an incident. It enriches indicators in an incident using one or more integrations.
      playbookName: Default
      type: playbook
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '17'
    scriptarguments:
      Enrich:
        simple: 'True'
      OnCall:
        simple: 'false'
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ''
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 2350,
          "y": 960
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '7':
    id: '7'
    taskid: 1a4a194e-4cc8-405c-849d-10ceb36d225e
    type: playbook
    task:
      id: 1a4a194e-4cc8-405c-849d-10ceb36d225e
      version: -1
      name: Entity Enrichment - Generic v3
      description: Enrich entities using one or more integrations.
      playbookName: Entity Enrichment - Generic v3
      type: playbook
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '14'
      - '20'
      - '21'
      - '22'
      - '24'
    scriptarguments:
      CVE:
        complex:
          root: CVE
          accessor: ID
      Domain:
        complex:
          root: Domain
          accessor: Name
          transformers:
          - operator: uniq
      Email:
        complex:
          root: Account
          accessor: Email.Address
          transformers:
          - operator: uniq
      Hostname:
        complex:
          root: Endpoint
          accessor: Hostname
          transformers:
          - operator: uniq
      IP:
        complex:
          root: IP
          accessor: Address
          transformers:
          - operator: uniq
      MD5:
        complex:
          root: File
          accessor: MD5
          transformers:
          - operator: uniq
      ResolveIP:
        simple: 'False'
      SHA1:
        complex:
          root: File
          accessor: SHA1
          transformers:
          - operator: uniq
      SHA256:
        complex:
          root: File
          accessor: SHA256
          transformers:
          - operator: uniq
      URL:
        complex:
          root: URL
          accessor: Data
          transformers:
          - operator: uniq
      Username:
        complex:
          root: Account
          accessor: Username
          transformers:
          - operator: uniq
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ''
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 1570,
          "y": 900
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '9':
    id: '9'
    taskid: e436f133-2c18-4817-8a6b-fe478e1e058c
    type: regular
    task:
      id: e436f133-2c18-4817-8a6b-fe478e1e058c
      version: -1
      name: DomainReputation
      description: A context script for Domain entities
      scriptName: DomainReputation
      type: regular
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '15'
    scriptarguments:
      domain:
        simple: ${Domain.Name}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 290,
          "y": 1340
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '11':
    id: '11'
    taskid: 9d087919-f6f2-479b-80ea-5d49b3bdf309
    type: regular
    task:
      id: 9d087919-f6f2-479b-80ea-5d49b3bdf309
      version: -1
      name: IPReputation
      description: A context script for IP entities
      scriptName: IPReputation
      type: regular
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '15'
    scriptarguments:
      ip:
        simple: ${IP.Address}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 820,
          "y": 1330
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '13':
    id: '13'
    taskid: 8b801953-de57-4613-88d9-1e5cc3c1bc99
    type: regular
    task:
      id: 8b801953-de57-4613-88d9-1e5cc3c1bc99
      version: -1
      name: URLReputation
      description: A context script for URL entities
      scriptName: URLReputation
      type: regular
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '15'
    scriptarguments:
      url:
        simple: ${URL.Data}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1330,
          "y": 1320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '14':
    id: '14'
    taskid: 82289db8-e07e-4046-835a-1d6662baeb2a
    type: playbook
    task:
      id: 82289db8-e07e-4046-835a-1d6662baeb2a
      version: -1
      name: CVE Enrichment - Generic v2
      description: |-
        This playbook performs CVE Enrichment using the following integrations:
        - VulnDB
        - CVE Search
        - IBM X-Force Exchange
      playbookName: CVE Enrichment - Generic v2
      type: playbook
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '15'
    separatecontext: true
    view: |-
      {
        "position": {
          "x": 30,
          "y": 1090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '15':
    id: '15'
    taskid: 42d41f58-1ceb-4da8-88f2-532fbad76636
    type: regular
    task:
      id: 42d41f58-1ceb-4da8-88f2-532fbad76636
      version: -1
      name: GenerateSummaryReports
      description: Generate report summaries for the passed incidents.
      scriptName: GenerateSummaryReports
      type: regular
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '17'
    scriptarguments:
      ids:
        simple: ${incident.id}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 290,
          "y": 1545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '16':
    id: '16'
    taskid: 74502606-5abb-4c76-8a3c-530894d3b0f1
    type: regular
    task:
      id: 74502606-5abb-4c76-8a3c-530894d3b0f1
      version: -1
      name: Extract Indicators From Data Breach & Web Monitoring (DR)
      description: Extract all indicators according to server indicators configuration
      script: Builtin|||extractIndicators
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - '7'
    scriptarguments:
      text:
        simple: ${incident}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1570,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '17':
    id: '17'
    taskid: 165258bc-238e-46eb-86d0-cc48d450971a
    type: title
    task:
      id: 165258bc-238e-46eb-86d0-cc48d450971a
      version: -1
      name: DONE
      type: title
      iscommand: false
      brand: ''
      description: Task Completed.
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1570,
          "y": 1790
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '18':
    id: '18'
    taskid: e850ec86-253b-4179-8918-2560b268a516
    type: condition
    task:
      id: e850ec86-253b-4179-8918-2560b268a516
      version: -1
      name: Check severity Critical & High
      type: condition
      iscommand: false
      brand: ''
      description: Checking severity Critical & High
    nexttasks:
      '#default#':
      - '2'
      yes:
      - '19'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: incident.severity
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: incident.severity
                      iscontext: true
                    right:
                      value:
                        simple: '4'
                  - operator: isEqualString
                    left:
                      value:
                        simple: incident.severity
                      iscontext: true
                    right:
                      value:
                        simple: '3'
            iscontext: true
          right:
            value:
              simple: incident.severity
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1610,
          "y": 85
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '19':
    id: '19'
    taskid: b33e0291-d6ce-47bb-8543-997695f9fa68
    type: regular
    task:
      id: b33e0291-d6ce-47bb-8543-997695f9fa68
      version: -1
      name: AssignAnalystToIncident
      description: |-
        Assign analyst to incident.
        By default,  the analyst is picked randomly from the available users, according to the provided roles (if no roles provided, will fetch all users).
        Otherwise, the analyst will be picked according to the 'assignBy' arguments.
        machine-learning: DBot will calculated and decide who is the best analyst for the job.
        top-user: The user that is most commonly owns this type of incident
        less-busy-user: The less busy analyst will be picked to be the incident owner.
        online: The analyst is picked randomly from all online analysts, according to the provided roles (if no roles provided, will fetch all users).
        current: The user that executed the command
      scriptName: AssignAnalystToIncident
      type: regular
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '2'
    scriptarguments:
      assignBy:
        simple: random
      onCall:
        simple: 'false'
      roles:
        simple: Analyst
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1330,
          "y": 280
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '20':
    id: '20'
    taskid: 5cff5d34-450d-4f44-814f-88f07d31562c
    type: condition
    task:
      id: 5cff5d34-450d-4f44-814f-88f07d31562c
      version: -1
      name: Does Domain data exist?
      type: condition
      iscommand: false
      brand: ''
      description: Checking the domain value is exists or not
    nexttasks:
      '#default#':
      - '17'
      yes:
      - '9'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: isExists
          left:
            value:
              simple: Domain
            iscontext: true
    view: |-
      {
        "position": {
          "x": 477.5,
          "y": 1090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '21':
    id: '21'
    taskid: cf237b46-a36b-4c1e-8d0f-99bc9aa80713
    type: condition
    task:
      id: cf237b46-a36b-4c1e-8d0f-99bc9aa80713
      version: -1
      name: Does IP data exist?
      type: condition
      iscommand: false
      brand: ''
      description: Does IP data exist or not
    nexttasks:
      '#default#':
      - '17'
      yes:
      - '11'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: isExists
          left:
            value:
              simple: IP
            iscontext: true
    view: |-
      {
        "position": {
          "x": 917.5,
          "y": 1090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '22':
    id: '22'
    taskid: 0ebb92f8-97e0-4dd7-8e65-c428499dd69a
    type: condition
    task:
      id: 0ebb92f8-97e0-4dd7-8e65-c428499dd69a
      version: -1
      name: Does URL data exist?
      type: condition
      iscommand: false
      brand: ''
      description: Does URL data exist or not
    nexttasks:
      '#default#':
      - '17'
      yes:
      - '13'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: isExists
          left:
            value:
              simple: URL
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1330,
          "y": 1090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '23':
    id: '23'
    taskid: 375726a0-fcd2-4d04-8f9b-1d4d61c1adb2
    type: regular
    task:
      id: 375726a0-fcd2-4d04-8f9b-1d4d61c1adb2
      version: -1
      name: FileReputation
      description: A context script for hash entities
      scriptName: FileReputation
      type: regular
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '15'
    scriptarguments:
      file:
        simple: ${File.Malicious}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1800,
          "y": 1320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '24':
    id: '24'
    taskid: 1cc2df46-206b-4e1c-864d-f5e30c96f443
    type: condition
    task:
      id: 1cc2df46-206b-4e1c-864d-f5e30c96f443
      version: -1
      name: Does any File Malicious data exist?
      type: condition
      iscommand: false
      brand: ''
      description: Does any File Malicious data exist or not
    nexttasks:
      '#default#':
      - '17'
      yes:
      - '23'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: isExists
          left:
            value:
              simple: File.Malicious
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1740,
          "y": 1090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "18_19_yes": 0.54,
      "18_2_#default#": 0.56,
      "20_17_#default#": 0.1,
      "20_9_yes": 0.57,
      "21_11_yes": 0.7,
      "21_17_#default#": 0.11,
      "22_13_yes": 0.59,
      "22_17_#default#": 0.15,
      "24_17_#default#": 0.11,
      "24_23_yes": 0.51,
      "2_16_DR-DB_WB": 0.61,
      "2_3_AS": 0.52,
      "2_4_DR-IMP_INF": 0.82,
      "2_6_DR-SO_PE": 0.9
    },
    "paper": {
      "dimensions": {
        "height": 1905,
        "width": 2700,
        "x": 30,
        "y": -50
      }
    }
  }
inputs: []
outputs: []
quiet: true
tests:
- No tests (auto formatted)
fromversion: 6.2.0
description: DeCYFIR API's provides External Threat Landscape Management insights.
