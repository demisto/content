commonfields:
  id: XMCyber
  version: -1
name: XMCyber
display: XM Cyber
category: Data Enrichment & Threat Intelligence
description: Simulates attack vectors to critical assets
fromversion: 5.0.0
tests:
- No tests
configuration:
- display: API Key
  name: apikey
  defaultvalue: ""
  type: 0
  required: true
- display: URL
  name: url
  defaultvalue: ""
  type: 0
  required: true
- display: Use system proxy settings
  name: proxy
  defaultvalue: ""
  type: 8
  required: false
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
script:
  commands:
  - name: xmcyber-compromising-techniques-list
    description: List compromising techniques to an entity
    arguments:
      - name: time_id
        default: false
        description: time_id for example timeAgo_days_7
        isArray: false
        required: false
        secret: false
    outputs:
      - contextPath: XMCyber.compromisingTechniques.name
        description: Compromising Techinique Name
        type: String
      - contextPath: XMCyber.compromisingTechniques.percent
        description: Percent of Vectors
        type: Number

  - name: xmcyber-is-version-supported
    description: Check if current XM version supports Demisto integration
    outputs:
      - contextPath: XMCyber.IsVersion.valid
        description: 'Flag that indicates if the version is valid'
        type: Boolean
    
  - name: xmcyber-get-version
    description: Get current xm version
    outputs:
      - contextPath: XMCyber.Version.system
        description: 'Get current system version'
        type: String
    
  - name: ip
    description: Return data on Entity by IP from XM Cyber
    arguments:
      - name: ip
        default: true
        description: List of IPs.
        isArray: true
        required: false
    outputs:
      - contextPath: entity_id
        description: 'XMCyber Entity ID'
        type: String
      - contextPath: name
        description: Entity Name
        type: String
      - contextPath: is_asset
        description: Is Entity a Critical Asset
        type: Boolean
      - contextPath: is_choke_point
        description: Is Entity a Choke Point to Critical Assets
        type: Boolean
      - contextPath: affected_assets.value
        description: Number of affected critical assets
        type: Number
      - contextPath: affected_assets.level
        description: None, Low, Medium, or High
        type: String
      - contextPath: ip
        description: The actual IP
        type: String
      - contextPath: DBotScore.Indicator
        description: The indicator that was tested.
        type: String
      - contextPath: DBotScore.Score
        description: The actual score.
        type: Number
      - contextPath: DBotScore.Type
        description: The indicator type.
        type: String
      - contextPath: DBotScore.Vendor
        description: The vendor used to calculate the score.
        type: String
      - contextPath: IP.Address
        description: IP address.
        type: String
      - contextPath: IP.Malicious.Vendor
        description: The vendor reporting the IP address as malicious.
        type: String
      - contextPath: IP.Malicious.Description
        description: A description explaining why the IP address was reported as malicious.
        type: String
      - contextPath: IP.ASN
        description: The autonomous system name for the IP address.
        type: String
  
  - name: hostname
    description: Return data on Entity by hostname from XM Cyber
    arguments:
      - name: hostname
        default: true
        description: List of hostnames.
        isArray: true
        required: false
    outputs:
      - contextPath: entity_id
        description: 'XMCyber Entity ID'
        type: String
      - contextPath: name
        description: Entity Name
        type: String
      - contextPath: is_asset
        description: Is Entity a Critical Asset
        type: Boolean
      - contextPath: is_choke_point
        description: Is Entity a Choke Point to Critical Assets
        type: Boolean
      - contextPath: affected_assets.value
        description: Number of affected critical assets
        type: Number
      - contextPath: affected_assets.level
        description: None, Low, Medium, or High
        type: String
      - contextPath: Host.Domain
        description: The domain of the host.
        type: String
      - contextPath: Host.Hostname
        description: The name of the host.
        type: String
      - contextPath: Host.BIOVersion
        description: The BIOS version of the host.
        type: String
      - contextPath: Host.ID
        description: The unique ID within the tool retrieving the host.
        type: String
      - contextPath: Host.DHCPServer
        description: The DHCP server.
        type: String
      - contextPath: Host.IP
        description: The IP address of the host.
        type: String
      - contextPath: Host.MACAddress
        description: The MAC address of the host.
        type: String
      - contextPath: Host.Memory
        description: Memory on the host.
        type: String
      - contextPath: Host.Model
        description: The model of the host.
        type: String
      - contextPath: Host.OS
        description: Host OS.
        type: String
      - contextPath: Host.OSVersion
        description: The OS version of the host.
        type: String
      - contextPath: Host.Processor
        description: The processor of the host.
        type: String
      - contextPath: Host.Processors
        description: The number of processors that the host is using.
        type: Number

  dockerimage: demisto/python3:3.8.6.12176
  isfetch: false
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  subtype: python3
  type: python