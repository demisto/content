commonfields:
  id: XMCyber
  version: -1
name: XMCyber
display: XM Cyber
category: Data Enrichment & Threat Intelligence
description: XMCyber continuously finds attack vectors to critical assets. This integration fetches events (incidents) on changes in the overall risk score, risk to assets, or impacting attack techniques. Additionally incidents are enriched with incoming attack vectors to the incident's endpoints, and critical assets at risk form the incident.
fromversion: 6.0.0
tests:
- No tests
configuration:
- display: API Key
  name: apikey
  defaultvalue: ""
  type: 8
  required: false
- display: URL
  name: url
  defaultvalue: ""
  type: 0
  required: true
- display: Use system proxy settings
  name: proxy
  defaultvalue: ""
  type: 8
  required: false
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Fetch incidents
  name: isFetch
  required: false
  type: 8
- display: Incident type
  name: incidentType
  required: false
  type: 13
- defaultvalue: '30'
  display: Maximum number of incidents per fetch
  name: max_fetch
  required: false
  type: 0
- defaultvalue: ''
  display: First fetch
  name: first_fetch
  required: false
  type: 0

script:
  commands:
  - name: xmcyber-affected-critical-assets-list
    description: List critical assets at risk from an entity and the complexity of the attack
    arguments:
      - name: timeId
        default: false
        description: The relevant period of time. The optiosn are timeAgo_days_7 (past 7 days) timeAgo_days_14 timeAgo_days_30 or monthly_YYYY_MM for a given year and month
        isArray: false
        required: false
        secret: false
      - name: entityId
        default: false
        description: Entity ID
        isArray: true
        required: true
        secret: false
    outputs:
      - contextPath: XMCyber.entityId
        description: XMCyber Entity ID
        type: String
      - contextPath: XMCyber.criticalAssetsAtRiskList.name
        description: Compromising Techinique Name
        type: String
      - contextPath: XMCyber.criticalAssetsAtRiskList.average
        description: Average attack complexity
        type: Number
      - contextPath: XMCyber.criticalAssetsAtRiskList.minimum
        description: Minimum attack complexity
        type: Number

  - name: xmcyber-affected-entities-list
    description: List all entities at risk from an entity and the complexity of the attack
    arguments:
      - name: timeId
        default: false
        description: The relevant period of time. The optiosn are timeAgo_days_7 (past 7 days) timeAgo_days_14 timeAgo_days_30 or monthly_YYYY_MM for a given year and month
        isArray: false
        required: false
        secret: false
      - name: entityId
        default: false
        description: Entity ID
        isArray: true
        required: true
        secret: false
    outputs:
      - contextPath: XMCyber.entityId
        description: XMCyber Entity ID
        type: String
      - contextPath: XMCyber.entitiesAtRiskList.name
        description: Compromising Techinique Name
        type: String
      - contextPath: XMCyber.entitiesAtRiskList.technique
        description: The attack technique which compromised the entity
        type: String

  - name: xmcyber-version-supported
    description: Check if current XM version supports Demisto integration
    outputs:
      - contextPath: XMCyber.IsVersion.valid
        description: Flag that indicates if the version is valid
        type: Boolean
    
  - name: xmcyber-version-get
    description: Get current xm version
    outputs:
      - contextPath: XMCyber.Version.system
        description: 'Get current system version'
        type: String
    
  - name: ip
    description: Return data on Entity by IP from XM Cyber
    arguments:
      - name: ip
        default: true
        description: List of IPs.
        isArray: true
        required: false
    outputs:
      - contextPath: XMCyber.entityId
        description: XMCyber Entity ID
        type: String
      - contextPath: XMCyber.name
        description: Entity Name
        type: String
      - contextPath: XMCyber.isAsset
        description: Is Entity a Critical Asset
        type: Boolean
      - contextPath: XMCyber.affectedEntities
        description: Number of unique entities at risk from this entity
        type: Number
      - contextPath: XMCyber.averageComplexity
        description: Average complexity to compromise this entity
        type: Number
      - contextPath: XMCyber.criticalAssetsAtRisk
        description: Number of unique critical assets at risk from this entity
        type: Number
      - contextPath: XMCyber.averageComplexityLevel
        description: Level of the average complexity to compromise this entity
        type: String
      - contextPath: XMCyber.compromisingTechniques.name
        description: Technique compromising this entity
        type: String
      - contextPath: XMCyber.compromisingTechniques.count
        description: Number of vectors with this technique compromising this entity
        type: Number
      - contextPath: XMCyber.entityType
        description: Entity Type
        type: String
      - contextPath: XMCyber.entityReport
        description: Link to the Entity Report
        type: String
      - contextPath: DBotScore.Indicator
        description: The indicator that was tested.
        type: String
      - contextPath: DBotScore.Score
        description: The actual score.
        type: Number
      - contextPath: DBotScore.Type
        description: The indicator type.
        type: String
      - contextPath: DBotScore.Vendor
        description: The vendor used to calculate the score.
        type: String
      - contextPath: IP.Address
        description: IP address.
        type: String

  - name: xmcyber-entity-get
    description: Return data on Entity by IP or Hostname from XM Cyber
    arguments:
      - name: ip
        default: true
        description: List of IPs
        isArray: true
        required: false
      - name: name
        default: true
        description: List of entity names (i.e. hostname, cloud instance, user)
        isArray: true
        required: false
      - name: entityId
        description: List of XMCyber Entity IDs
        isArray: true
        required: false
        default: true
    outputs:
      - contextPath: XMCyber.entityId
        description: XMCyber Entity ID
        type: String
      - contextPath: XMCyber.name
        description: Entity Name
        type: String
      - contextPath: XMCyber.isAsset
        description: Is Entity a Critical Asset
        type: Boolean
      - contextPath: XMCyber.affectedEntities
        description: Number of unique entities at risk from this entity
        type: Number
      - contextPath: XMCyber.averageComplexity
        description: Average complexity to compromise this entity
        type: Number
      - contextPath: XMCyber.criticalAssetsAtRisk
        description: Number of unique critical assets at risk from this entity
        type: Number
      - contextPath: XMCyber.averageComplexityLevel
        description: Level of the average complexity to compromise this entity
        type: String
      - contextPath: XMCyber.compromisingTechniques.name
        description: Technique compromising this entity
        type: String
      - contextPath: XMCyber.compromisingTechniques.count
        description: Number of vectors with this technique compromising this entity
        type: Number
      - contextPath: XMCyber.entityType
        description: Entity Type
        type: String
      - contextPath: XMCyber.entityReport
        description: Link to the Entity Report
        type: String
  
  - name: hostname
    description: Return data on Entity by hostname from XM Cyber
    arguments:
      - name: hostname
        default: true
        description: List of hostnames.
        isArray: true
        required: false
    outputs:
      - contextPath: entityId
        description: XMCyber Entity ID
        type: String
      - contextPath: name
        description: Entity Name
        type: String
      - contextPath: isAsset
        description: Is Entity a Critical Asset
        type: Boolean
      - contextPath: affectedEntities
        description: Number of unique entities at risk from this entity
        type: Number
      - contextPath: averageComplexity
        description: Average complexity to compromise this entity
        type: Number
      - contextPath: criticalAssetsAtRisk
        description: Number of unique critical assets at risk from this entity
        type: Number
      - contextPath: averageComplexityLevel
        description: Level of the average complexity to compromise this entity
        type: String
      - contextPath: compromisingTechniques.name
        description: Technique compromising this entity
        type: String
      - contextPath: compromisingTechniques.count
        description: Number of vectors with this technique compromising this entity
        type: Number
      - contextPath: entityType
        description: Entity Type
        type: String
      - contextPath: entityReport
        description: Link to the Entity Report
        type: String
      - contextPath: Host.Hostname
        description: The name of the host.
        type: String
      - contextPath: Host.ID
        description: The unique ID within the tool retrieving the host.
        type: String
      - contextPath: Host.IP
        description: The IP address of the host.
        type: String

  dockerimage: demisto/python3:3.8.6.12176
  isfetch: true
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  subtype: python3
  type: python