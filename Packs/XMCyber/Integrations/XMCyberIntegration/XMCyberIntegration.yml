commonfields:
  id: XMCyber
  version: -1
name: XMCyber
display: XM Cyber
category: Data Enrichment & Threat Intelligence
description: Simulates attack vectors to critical assets
fromversion: 5.0.0
tests:
- No tests
configuration:
- display: API Key
  name: apikey
  defaultvalue: ""
  type: 0
  required: true
- display: URL
  name: url
  defaultvalue: ""
  type: 0
  required: true
- display: Use system proxy settings
  name: proxy
  defaultvalue: ""
  type: 8
  required: false
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Fetch incidents
  name: isFetch
  required: false
  type: 8
- display: Incident type
  name: incidentType
  required: false
  type: 13
- defaultvalue: '30'
  display: Maximum number of incidents per fetch
  name: max_fetch
  required: false
  type: 0
- defaultvalue: ''
  display: First fetch
  name: first_fetch
  required: false
  type: 0

script:
  commands:
  - name: xmcyber-affected-critical-assets-list
    description: List critical assets at risk from an entity and the complexity of the attack
    arguments:
      - name: timeId
        default: false
        description: timeId for example timeAgo_days_7
        isArray: false
        required: false
        secret: false
      - name: entityId
        default: false
        description: Entity ID
        isArray: false
        required: true
        secret: false
    outputs:
      - contextPath: entityId
        description: XMCyber Entity ID
        type: String
      - contextPath: XMCyber.criticalAssetsAtRiskList.name
        description: Compromising Techinique Name
        type: String
      - contextPath: XMCyber.criticalAssetsAtRiskList.average
        description: Average attack complexity
        type: Number
      - contextPath: XMCyber.criticalAssetsAtRiskList.minimum
        description: Minimum attack complexity
        type: Number

  - name: xmcyber-affected-entities-list
    description: List all entities at risk from an entity and the complexity of the attack
    arguments:
      - name: timeId
        default: false
        description: timeId for example timeAgo_days_7
        isArray: false
        required: false
        secret: false
      - name: entityId
        default: false
        description: Entity ID
        isArray: false
        required: true
        secret: false
    outputs:
      - contextPath: entityId
        description: XMCyber Entity ID
        type: String
      - contextPath: XMCyber.entitiesAtRiskList.name
        description: Compromising Techinique Name
        type: String
      - contextPath: XMCyber.entitiesAtRiskList.technique
        description: The attack technique which compromised the entity
        type: String

  - name: xmcyber-is-version-supported
    description: Check if current XM version supports Demisto integration
    outputs:
      - contextPath: XMCyber.IsVersion.valid
        description: Flag that indicates if the version is valid
        type: Boolean
    
  - name: xmcyber-get-version
    description: Get current xm version
    outputs:
      - contextPath: XMCyber.Version.system
        description: 'Get current system version'
        type: String
    
  - name: ip
    description: Return data on Entity by IP from XM Cyber
    arguments:
      - name: ip
        default: true
        description: List of IPs.
        isArray: true
        required: false
    outputs:
      - contextPath: entityId
        description: XMCyber Entity ID
        type: String
      - contextPath: name
        description: Entity Name
        type: String
      - contextPath: isAsset
        description: Is Entity a Critical Asset
        type: Boolean
      - contextPath: affectedEntities
        description: Number of unique entities at risk from this entity
        type: Number
      - contextPath: averageComplexity
        description: Average complexity to compromise this entity
        type: Number
      - contextPath: criticalAssetsAtRisk
        description: Number of unique critical assets at risk from this entity
        type: Number
      - contextPath: averageComplexityLevel
        description: Level of the average complexity to compromise this entity
        type: String
      - contextPath: compromisingTechniques.name
        description: Technique compromising this entity
        type: String
      - contextPath: compromisingTechniques.count
        description: Number of vectors with this technique compromising this entity
        type: Number
      - contextPath: entityType
        description: Entity Type
        type: String
      - contextPath: entityReport
        description: Link to the Entity Report
        type: String
      - contextPath: DBotScore.Indicator
        description: The indicator that was tested.
        type: String
      - contextPath: DBotScore.Score
        description: The actual score.
        type: Number
      - contextPath: DBotScore.Type
        description: The indicator type.
        type: String
      - contextPath: DBotScore.Vendor
        description: The vendor used to calculate the score.
        type: String
      - contextPath: IP.Address
        description: IP address.
        type: String
      - contextPath: IP.Malicious.Vendor
        description: The vendor reporting the IP address as malicious.
        type: String
      - contextPath: IP.Malicious.Description
        description: A description explaining why the IP address was reported as malicious.
        type: String
      - contextPath: IP.ASN
        description: The autonomous system name for the IP address.
        type: String

  - name: xmcyber-entity-get
    description: Return data on Entity by IP or Hostname from XM Cyber
    arguments:
      - name: ip
        default: true
        description: List of IPs
        isArray: true
        required: false
      - name: hostname
        default: true
        description: List of hostnames
        isArray: true
        required: false
      - name: entityId
        description: List of XMCyber Entity IDs
        isArray: true
        required: false
        default: true
    outputs:
      - contextPath: entityId
        description: XMCyber Entity ID
        type: String
      - contextPath: name
        description: Entity Name
        type: String
      - contextPath: isAsset
        description: Is Entity a Critical Asset
        type: Boolean
      - contextPath: affectedEntities
        description: Number of unique entities at risk from this entity
        type: Number
      - contextPath: averageComplexity
        description: Average complexity to compromise this entity
        type: Number
      - contextPath: criticalAssetsAtRisk
        description: Number of unique critical assets at risk from this entity
        type: Number
      - contextPath: averageComplexityLevel
        description: Level of the average complexity to compromise this entity
        type: String
      - contextPath: compromisingTechniques.name
        description: Technique compromising this entity
        type: String
      - contextPath: compromisingTechniques.count
        description: Number of vectors with this technique compromising this entity
        type: Number
      - contextPath: entityType
        description: Entity Type
        type: String
      - contextPath: entityReport
        description: Link to the Entity Report
        type: String
  
  - name: hostname
    description: Return data on Entity by hostname from XM Cyber
    arguments:
      - name: hostname
        default: true
        description: List of hostnames.
        isArray: true
        required: false
    outputs:
      - contextPath: entityId
        description: XMCyber Entity ID
        type: String
      - contextPath: name
        description: Entity Name
        type: String
      - contextPath: isAsset
        description: Is Entity a Critical Asset
        type: Boolean
      - contextPath: affectedEntities
        description: Number of unique entities at risk from this entity
        type: Number
      - contextPath: averageComplexity
        description: Average complexity to compromise this entity
        type: Number
      - contextPath: criticalAssetsAtRisk
        description: Number of unique critical assets at risk from this entity
        type: Number
      - contextPath: averageComplexityLevel
        description: Level of the average complexity to compromise this entity
        type: String
      - contextPath: compromisingTechniques.name
        description: Technique compromising this entity
        type: String
      - contextPath: compromisingTechniques.count
        description: Number of vectors with this technique compromising this entity
        type: Number
      - contextPath: entityType
        description: Entity Type
        type: String
      - contextPath: entityReport
        description: Link to the Entity Report
        type: String
      - contextPath: Host.Domain
        description: The domain of the host.
        type: String
      - contextPath: Host.Hostname
        description: The name of the host.
        type: String
      - contextPath: Host.BIOVersion
        description: The BIOS version of the host.
        type: String
      - contextPath: Host.ID
        description: The unique ID within the tool retrieving the host.
        type: String
      - contextPath: Host.DHCPServer
        description: The DHCP server.
        type: String
      - contextPath: Host.IP
        description: The IP address of the host.
        type: String
      - contextPath: Host.MACAddress
        description: The MAC address of the host.
        type: String
      - contextPath: Host.Memory
        description: Memory on the host.
        type: String
      - contextPath: Host.Model
        description: The model of the host.
        type: String
      - contextPath: Host.OS
        description: Host OS.
        type: String
      - contextPath: Host.OSVersion
        description: The OS version of the host.
        type: String
      - contextPath: Host.Processor
        description: The processor of the host.
        type: String
      - contextPath: Host.Processors
        description: The number of processors that the host is using.
        type: Number

  dockerimage: demisto/python3:3.8.6.12176
  isfetch: true
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  subtype: python3
  type: python