id: XM Cyber Endpoint Enrichment
version: -1
fromversion: 6.0.0
starttaskid: "0"
name: XM Cyber Endpoint Enrichment
description: Given inputs of IP address or hostnames the playbook will enrich with
  affected assets, entities, etc
tasks:
  "0":
    id: "0"
    taskid: 7cfa3cf6-82b0-452f-8c52-85355d20008a
    type: start
    task:
      id: 7cfa3cf6-82b0-452f-8c52-85355d20008a
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: Start
    nexttasks:
      '#none#':
      - "10"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "3":
    id: "3"
    taskid: ed6e2d6c-2eac-4e07-8a0d-8412d8700a52
    type: title
    task:
      id: ed6e2d6c-2eac-4e07-8a0d-8412d8700a52
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: Done
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "4":
    id: "4"
    taskid: 159f570f-f2f2-4d30-8d99-0fa8d8ebca0e
    type: condition
    task:
      id: 159f570f-f2f2-4d30-8d99-0fa8d8ebca0e
      version: -1
      name: Was entity found?
      description: Check if there was any machine match to the hostname
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "5"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: '{XMCyber.entityId}'
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "5":
    id: "5"
    taskid: bcb8073f-ac87-4a81-8d0a-50544a17f11e
    type: regular
    task:
      id: bcb8073f-ac87-4a81-8d0a-50544a17f11e
      version: -1
      name: Get affected critical assets from XM Cyber
      description: List critical assets at risk from an entity and the complexity
        of the attack
      script: '|||xmcyber-affected-critical-assets-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      entityId:
        simple: ${XMCyber.entityId}
      timeId: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "6":
    id: "6"
    taskid: 1c398b62-f321-416a-8d3b-7ae07f0bc837
    type: regular
    task:
      id: 1c398b62-f321-416a-8d3b-7ae07f0bc837
      version: -1
      name: Get Entity ID
      description: Return data on Entity by IP or Hostname from XM Cyber
      script: XMCyber|||xmcyber-entity-get
      type: regular
      iscommand: true
      brand: XMCyber
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      hostname:
        simple: ${inputs.Hostname}
      ip:
        simple: ${inputs.IPAddress}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "7":
    id: "7"
    taskid: b4086ccc-85e5-4cbc-870d-a846e2bcca7f
    type: regular
    task:
      id: b4086ccc-85e5-4cbc-870d-a846e2bcca7f
      version: -1
      name: Get affected entities from XM Cyber
      description: List all entities at risk from an entity and the complexity of
        the attack
      script: '|||xmcyber-affected-entities-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      entityId:
        simple: ${XMCyber.entityId}
      timeId: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "8":
    id: "8"
    taskid: d3341426-7a69-45d7-8e0c-24f6ffc4f97b
    type: regular
    task:
      id: d3341426-7a69-45d7-8e0c-24f6ffc4f97b
      version: -1
      name: Map to Fields
      description: Maps the XM Cyber context to fields
      scriptName: xmcyber-map
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "9":
    id: "9"
    taskid: 54d5097f-8526-40d2-859c-7958d298e9cf
    type: regular
    task:
      id: 54d5097f-8526-40d2-859c-7958d298e9cf
      version: -1
      name: Map Fields and Context
      description: Maps the XM Cyber context to fields
      scriptName: xmcyber-map
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "10":
    id: "10"
    taskid: 04a2a6b7-6ff3-4990-8713-d85f407b95fc
    type: regular
    task:
      id: 04a2a6b7-6ff3-4990-8713-d85f407b95fc
      version: -1
      name: Is XM Cyber Valid?
      description: Check if current XM version supports Demisto integration
      script: XMCyber|||xmcyber-is-version-supported
      type: regular
      iscommand: true
      brand: XMCyber
    nexttasks:
      '#none#':
      - "11"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "11":
    id: "11"
    taskid: 3ae69d70-3cc5-4e2d-85d6-e2ff1fbc5e4d
    type: condition
    task:
      id: 3ae69d70-3cc5-4e2d-85d6-e2ff1fbc5e4d
      version: -1
      name: Is Valid
      description: Check if a given value is true. Will return 'no' otherwise
      scriptName: IsTrue
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "no":
      - "3"
      "yes":
      - "9"
    scriptarguments:
      value:
        simple: ${XMCyber.IsVersion.valid}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
view: |-
  {
    "linkLabelsPosition": {
      "11_9_yes": 0.11
    },
    "paper": {
      "dimensions": {
        "height": 1610,
        "width": 492.5,
        "x": 50,
        "y": 50
      }
    }
  }
inputs:
- key: Hostname
  value:
    simple: ${Endpoint.Hostname}
  required: false
  description: The hostname to enrich
  playbookInputQuery: null
- key: IPAddress
  value:
    simple: ${Endpoint.IPAddress}
  required: false
  description: ""
  playbookInputQuery: null
outputs:
- contextPath: Endpoint.ID
  description: Unique ID of the endpoint in FalconHost
  type: string
- contextPath: Endpoint.IPAddress
  description: IPAddress of the endpoint
  type: string
- contextPath: Endpoint.Domain
  description: Domain of the endpoint
  type: string
- contextPath: Endpoint.MACAddress
  description: MACAddress of the endpoint
  type: string
- contextPath: Endpoint.OS
  description: OS of the endpoint
  type: string
- contextPath: Endpoint.OSVersion
  description: OSVersion of the endpoint
  type: string
- contextPath: Endpoint.BIOSVersion
  description: BIOSVersion of the endpoint
  type: string
- contextPath: Endpoint.HostName
  description: The host of the endpoint
  type: string
sourceplaybookid: crowdstrike_endpoint_enrichment
tests:
 -  No tests