id: GmailTest
version: -1
name: GmailTest
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 8858dbfc-ac58-4535-8156-ca570ad2bf2b
    type: start
    task:
      id: 8858dbfc-ac58-4535-8156-ca570ad2bf2b
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1565,
          "y": -570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "1":
    id: "1"
    taskid: 78445166-d957-490f-8faa-a9f64e503ff6
    type: regular
    task:
      id: 78445166-d957-490f-8faa-a9f64e503ff6
      version: -1
      name: Start clean
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1565,
          "y": -405
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "2":
    id: "2"
    taskid: d34da4f4-8c64-4ab1-84f1-9d0b4cff9ce8
    type: regular
    task:
      id: d34da4f4-8c64-4ab1-84f1-9d0b4cff9ce8
      version: -1
      name: List all users
      script: '|||gmail-list-users'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      custom-field-mask: {}
      customer: {}
      domain: {}
      event: {}
      max-results: {}
      projection: {}
      query: {}
      show-deleted: {}
      sort-order: {}
      token: {}
      view-type-public-domain: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1565,
          "y": -235
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "3":
    id: "3"
    taskid: 08573238-dec7-47fa-8095-9dd80ce58a15
    type: regular
    task:
      id: 08573238-dec7-47fa-8095-9dd80ce58a15
      version: -1
      name: Get specific user
      script: '|||gmail-get-user'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "58"
    scriptarguments:
      custom-field-mask: {}
      projection: {}
      user-id:
        complex:
          root: Account
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: Account.UserName
                iscontext: true
              right:
                value:
                  simple: test
          transformers:
          - operator: getField
            args:
              field:
                value:
                  simple: Email
          - operator: getField
            args:
              field:
                value:
                  simple: Address
      view-type-public-domain: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1565,
          "y": -50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "5":
    id: "5"
    taskid: c5342233-98e9-45da-8cf6-eafc3d589fa5
    type: regular
    task:
      id: c5342233-98e9-45da-8cf6-eafc3d589fa5
      version: -1
      name: Create new user
      script: '|||gmail-create-user'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "21"
    scriptarguments:
      email:
        simple: JohnS@demistodev.com
      family-name:
        simple: Smith
      first-name:
        simple: John
      password:
        simple: johnpass1!
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1565,
          "y": 845
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "6":
    id: "6"
    taskid: 21549ed7-ce58-428c-8dcb-9b20f8100b35
    type: regular
    task:
      id: 21549ed7-ce58-428c-8dcb-9b20f8100b35
      version: -1
      name: Delete User
      script: '|||gmail-delete-user'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "13"
      - "26"
      - "7"
    scriptarguments:
      user-id:
        complex:
          root: Account
          filters:
          - - operator: startWith
              left:
                value:
                  simple: Account.Email.Address
                iscontext: true
              right:
                value:
                  simple: JohnS
          transformers:
          - operator: getField
            args:
              field:
                value:
                  simple: Email
          - operator: getField
            args:
              field:
                value:
                  simple: Address
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1565,
          "y": 1390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "7":
    id: "7"
    taskid: f844be4b-6eb4-449d-8914-e82bade4c44a
    type: title
    task:
      id: f844be4b-6eb4-449d-8914-e82bade4c44a
      version: -1
      name: Gmail Commands
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "9"
      - "16"
      - "18"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 705,
          "y": 1755
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "9":
    id: "9"
    taskid: fe1dd425-d68e-4f7a-89ab-ff3dc0f9c5ce
    type: regular
    task:
      id: fe1dd425-d68e-4f7a-89ab-ff3dc0f9c5ce
      version: -1
      name: Search emails with attachments
      script: '|||gmail-search'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "10"
      - "14"
    scriptarguments:
      after: {}
      before: {}
      fields: {}
      filename: {}
      from: {}
      has-attachments:
        simple: "True"
      in: {}
      include-spam-trash: {}
      label: {}
      labels-ids: {}
      max-results:
        simple: "10"
      page-token: {}
      query: {}
      subject: {}
      to: {}
      user-id:
        simple: admin@demistodev.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 60,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "10":
    id: "10"
    taskid: 51358cb9-e82d-4b5f-813a-e6283bf571a5
    type: regular
    task:
      id: 51358cb9-e82d-4b5f-813a-e6283bf571a5
      version: -1
      name: Get mail with attachment
      script: '|||gmail-get-attachments'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "48"
    scriptarguments:
      message-id:
        complex:
          root: Gmail
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: Gmail.Mailbox
                iscontext: true
              right:
                value:
                  simple: admin@demistodev.com
          - - operator: isNotEmpty
              left:
                value:
                  simple: Gmail.Attachments
                iscontext: true
          transformers:
          - operator: FirstArrayElement
          - operator: getField
            args:
              field:
                value:
                  simple: ID
      user-id:
        simple: admin@demistodev.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "13":
    id: "13"
    taskid: e8506e40-2120-43ab-84ef-b79b14c6896b
    type: regular
    task:
      id: e8506e40-2120-43ab-84ef-b79b14c6896b
      version: -1
      name: Get Tokens
      script: '|||gmail-get-tokens-for-user'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      user-id:
        simple: admin@demistodev.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1565
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "14":
    id: "14"
    taskid: dfb77785-43ef-4362-8c52-ba6e88976003
    type: regular
    task:
      id: dfb77785-43ef-4362-8c52-ba6e88976003
      version: -1
      name: Get Email data
      script: '|||gmail-get-mail'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "48"
    scriptarguments:
      format: {}
      message-id:
        complex:
          root: Gmail
          filters:
          - - operator: isNotEmpty
              left:
                value:
                  simple: Gmail.Attachments
                iscontext: true
          - - operator: isEqualString
              left:
                value:
                  simple: Gmail.Mailbox
                iscontext: true
              right:
                value:
                  simple: admin@demistodev.com
          transformers:
          - operator: FirstArrayElement
          - operator: getField
            args:
              field:
                value:
                  simple: ID
      user-id:
        simple: admin@demistodev.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "16":
    id: "16"
    taskid: cda98c11-4f86-46d3-81e7-cba3ae94f1d5
    type: regular
    task:
      id: cda98c11-4f86-46d3-81e7-cba3ae94f1d5
      version: -1
      name: Search all mailboxes
      script: '|||gmail-search-all-mailboxes'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      after:
        simple: 2018/1/20
      before:
        simple: 2018/1/30
      fields: {}
      filename: {}
      from: {}
      has-attachments: {}
      in: {}
      include-spam-trash: {}
      label: {}
      labels-ids: {}
      max-results:
        simple: "2"
      page-token: {}
      query: {}
      subject: {}
      to: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 920,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "17":
    id: "17"
    taskid: 77da4302-cfca-491a-868c-4f4f09b3c4ad
    type: regular
    task:
      id: 77da4302-cfca-491a-868c-4f4f09b3c4ad
      version: -1
      name: Get Thread
      script: '|||gmail-get-thread'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "48"
    scriptarguments:
      format: {}
      thread-id:
        complex:
          root: Gmail
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: Gmail.Mailbox
                iscontext: true
              right:
                value:
                  simple: admin@demistodev.com
          transformers:
          - operator: getField
            args:
              field:
                value:
                  simple: ThreadId
          - operator: uniq
      user-id:
        simple: admin@demistodev.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 920,
          "y": 2090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "18":
    id: "18"
    taskid: 053b89d3-7611-4f8f-83a3-1ef1d09a3fef
    type: regular
    task:
      id: 053b89d3-7611-4f8f-83a3-1ef1d09a3fef
      version: -1
      name: Search in mailbox
      script: '|||gmail-search'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      after: {}
      before: {}
      fields: {}
      filename: {}
      from: {}
      has-attachments: {}
      in:
        simple: INBOX
      include-spam-trash: {}
      labels-ids: {}
      max-results:
        simple: "1"
      page-token: {}
      query: {}
      subject: {}
      to: {}
      user-id:
        simple: shai@demistodev.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1350,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "19":
    id: "19"
    taskid: 8f1c5ce7-2870-4a5c-8b11-7baf168f21f3
    type: regular
    task:
      id: 8f1c5ce7-2870-4a5c-8b11-7baf168f21f3
      version: -1
      name: Move mail to other folder
      script: '|||gmail-move-mail'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      add-labels:
        simple: CATEGORY_SOCIAL
      message-id:
        complex:
          root: Gmail
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: Gmail.Mailbox
                iscontext: true
              right:
                value:
                  simple: shai@demistodev.com
          transformers:
          - operator: getField
            args:
              field:
                value:
                  simple: ID
      remove-labels:
        simple: INBOX
      user-id:
        simple: shai@demistodev.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1350,
          "y": 2090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "20":
    id: "20"
    taskid: 45c5c024-a209-4ecc-8159-d3d23eb13a79
    type: regular
    task:
      id: 45c5c024-a209-4ecc-8159-d3d23eb13a79
      version: -1
      name: Move back to inbox
      script: '|||gmail-move-mail'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "48"
    scriptarguments:
      add-labels:
        simple: INBOX
      message-id:
        complex:
          root: Gmail
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: Gmail.Mailbox
                iscontext: true
              right:
                value:
                  simple: shai@demistodev.com
          transformers:
          - operator: getField
            args:
              field:
                value:
                  simple: ID
      remove-labels:
        simple: CATEGORY_SOCIAL
      user-id:
        simple: shai@demistodev.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1350,
          "y": 2265
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "21":
    id: "21"
    taskid: 7334cd8d-4f6c-4c03-8651-edae2655f1cf
    type: regular
    task:
      id: 7334cd8d-4f6c-4c03-8651-edae2655f1cf
      version: -1
      name: block the admin
      script: '|||gmail-add-delete-filter'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      email-address:
        complex:
          root: Account
          filters:
          - - operator: startWith
              left:
                value:
                  simple: Account.Email.Address
                iscontext: true
              right:
                value:
                  simple: JohnS
          transformers:
          - operator: getField
            args:
              field:
                value:
                  simple: Email
          - operator: getField
            args:
              field:
                value:
                  simple: Address
      user-id:
        simple: me
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1565,
          "y": 1040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "22":
    id: "22"
    taskid: c22f8613-a5cd-48f0-8f48-97b2d24af07e
    type: title
    task:
      id: c22f8613-a5cd-48f0-8f48-97b2d24af07e
      version: -1
      name: Check all mailboxes
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "16"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1755
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "23":
    id: "23"
    taskid: 05f67475-c889-4ea5-881f-4d73305a021a
    type: regular
    task:
      id: 05f67475-c889-4ea5-881f-4d73305a021a
      version: -1
      name: Remove the block
      script: '|||gmail-remove-filter'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      filter_ids:
        complex:
          root: GmailFilter
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: GmailFilter.Mailbox
                iscontext: true
              right:
                value:
                  simple: admin@demistodev.com
          transformers:
          - operator: getField
            args:
              field:
                value:
                  simple: ID
      mailbox:
        complex:
          root: Gmail
          accessor: Filter.Mailbox
      user-id:
        simple: me
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1565,
          "y": 1215
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "25":
    id: "25"
    taskid: f1ec3cc4-184e-409e-8ff7-0565c6f450ae
    type: regular
    task:
      id: f1ec3cc4-184e-409e-8ff7-0565c6f450ae
      version: -1
      name: List mailbox filters
      script: '|||gmail-list-filters'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      address: {}
      limit:
        simple: "5"
      user-id:
        simple: test@demistodev.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1780,
          "y": 1740
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "26":
    id: "26"
    taskid: 8dbcd805-c0e2-41fd-82ec-e5c30a0dd04e
    type: regular
    task:
      id: 8dbcd805-c0e2-41fd-82ec-e5c30a0dd04e
      version: -1
      name: Delete filters from context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "25"
    scriptarguments:
      all: {}
      index: {}
      key:
        simple: GmailFilter
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1780,
          "y": 1565
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "27":
    id: "27"
    taskid: c3d62901-150c-467f-8ae1-cbfdacc0a803
    type: condition
    task:
      id: c3d62901-150c-467f-8ae1-cbfdacc0a803
      version: -1
      name: Verify Filters
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "28"
      "yes":
      - "48"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: GmailFilter
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: Gmail.Filter
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1780,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "28":
    id: "28"
    taskid: c1ae2592-fac2-4711-86f3-684282bbc5d4
    type: regular
    task:
      id: c1ae2592-fac2-4711-86f3-684282bbc5d4
      version: -1
      name: Print Error
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: No filters were found in test@demistodev.com mailbox
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1780,
          "y": 2090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "29":
    id: "29"
    taskid: 29588ed7-ca80-45ba-8f03-85253fdc8748
    type: title
    task:
      id: 29588ed7-ca80-45ba-8f03-85253fdc8748
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 850,
          "y": 6320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "30":
    id: "30"
    taskid: 9cd57c66-f082-458a-8c93-e0863e816b17
    type: regular
    task:
      id: 9cd57c66-f082-458a-8c93-e0863e816b17
      version: -1
      name: gmail-create-user
      description: Creates a user.
      script: '|||gmail-create-user'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      email:
        simple: user_to_delete@demistodev.com
      family-name:
        simple: Second
      first-name:
        simple: First
      password:
        simple: ${NEW_PASSWORD}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 850,
          "y": 2615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "31":
    id: "31"
    taskid: 11122077-a766-4575-8a16-73cdbbe3a4a5
    type: regular
    task:
      id: 11122077-a766-4575-8a16-73cdbbe3a4a5
      version: -1
      name: gmail-hide-user-in-directory
      description: Hide a user in the Global Directory
      script: '|||gmail-hide-user-in-directory'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      user-id:
        simple: user_to_delete@demistodev.com
      visible-globally:
        simple: "False"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 850,
          "y": 2765
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "32":
    id: "32"
    taskid: 5d9c5898-7a8a-4e7d-8894-40ebe4dbc3f4
    type: condition
    task:
      id: 5d9c5898-7a8a-4e7d-8894-40ebe4dbc3f4
      version: -1
      name: Verify User creation and visbility
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "47"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Account.Email.Address
            iscontext: true
          right:
            value:
              simple: user_to_delete@demistodev.com
      - - operator: isFalse
          left:
            value:
              simple: Account.VisibleInDirectory
            iscontext: true
    view: |-
      {
        "position": {
          "x": 860,
          "y": 2900
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "33":
    id: "33"
    taskid: bb354cc7-1dda-4f1b-8a4f-f8499b77d54f
    type: regular
    task:
      id: bb354cc7-1dda-4f1b-8a4f-f8499b77d54f
      version: -1
      name: gmail-delete-user
      description: Delete a User
      script: '|||gmail-delete-user'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      user-id:
        simple: user_to_delete@demistodev.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 860,
          "y": 3300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "34":
    id: "34"
    taskid: bb20e7cd-bf66-461a-832f-533727cb18ff
    type: regular
    task:
      id: bb20e7cd-bf66-461a-832f-533727cb18ff
      version: -1
      name: gmail-get-autoreply
      description: Get the auto-reply message set for the user-account
      script: '|||gmail-get-autoreply'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "35"
    scriptarguments:
      user-id:
        simple: admin@demistodev.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 850,
          "y": 3560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "35":
    id: "35"
    taskid: 598b83a2-2dd8-4af7-8e20-71cdcf57e1cb
    type: regular
    task:
      id: 598b83a2-2dd8-4af7-8e20-71cdcf57e1cb
      version: -1
      name: gmail-set-autoreply
      description: 'Set auto-reply for the user. Note: if body is not set, the current
        body will be deleted'
      script: '|||gmail-set-autoreply'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      enable-autoReply:
        simple: "true"
      response-body:
        simple: body_test
      response-subject:
        simple: subject_test
      user-id:
        simple: admin@demistodev.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 850,
          "y": 3740
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "36":
    id: "36"
    taskid: 34ceae12-92b0-4e24-8dfe-2bc88768e54a
    type: regular
    task:
      id: 34ceae12-92b0-4e24-8dfe-2bc88768e54a
      version: -1
      name: gmail-get-autoreply
      description: Get the auto-reply message set for the user-account
      script: '|||gmail-get-autoreply'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "37"
    scriptarguments:
      user-id:
        simple: admin@demistodev.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 850,
          "y": 3900
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "37":
    id: "37"
    taskid: ec64becd-0858-47c1-8921-247710564b52
    type: condition
    task:
      id: ec64becd-0858-47c1-8921-247710564b52
      version: -1
      name: Verify Autoreply
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "38"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsString
          left:
            value:
              simple: Account.Gmail.AutoReply.ResponseSubject
            iscontext: true
          right:
            value:
              simple: subject_test
      - - operator: containsString
          left:
            value:
              simple: Account.Gmail.AutoReply.ResponseBody
            iscontext: true
          right:
            value:
              simple: body_test
    view: |-
      {
        "position": {
          "x": 850,
          "y": 4070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "38":
    id: "38"
    taskid: 1c811fb8-53c8-4514-89d1-53897a1ab072
    type: regular
    task:
      id: 1c811fb8-53c8-4514-89d1-53897a1ab072
      version: -1
      name: gmail-set-autoreply - reset to original autoreply
      description: 'Set auto-reply for the user. Note: if body is not set, the current
        body will be deleted'
      script: '|||gmail-set-autoreply'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "50"
    scriptarguments:
      enable-autoReply:
        simple: "false"
      response-body:
        simple: ${Account.Gmail.AutoReply.ResponseBody}
      response-subject:
        simple: ${Account.Gmail.AutoReply.ResponseSubject}
      user-id:
        simple: admin@demistodev.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 850,
          "y": 4300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "40":
    id: "40"
    taskid: 322aca7e-f2e2-45c8-8e5d-1528f43384c7
    type: regular
    task:
      id: 322aca7e-f2e2-45c8-8e5d-1528f43384c7
      version: -1
      name: gmail-get-mail
      description: Gets the specified message.
      script: '|||gmail-get-mail'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "41"
    scriptarguments:
      format: {}
      message-id:
        simple: ${Gmail.SentMail.ID}
      user-id:
        simple: shai@demistodev.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 850,
          "y": 4720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "41":
    id: "41"
    taskid: 8aa92a25-7a76-42fb-8d83-0c19d7b62f79
    type: condition
    task:
      id: 8aa92a25-7a76-42fb-8d83-0c19d7b62f79
      version: -1
      name: Verify sent mail
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "45"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsString
          left:
            value:
              simple: Gmail.To
            iscontext: true
          right:
            value:
              simple: admin@demistodev.com
      - - operator: containsString
          left:
            value:
              simple: Gmail.From
            iscontext: true
          right:
            value:
              simple: shai@demistodev.com
      - - operator: isEqualString
          left:
            value:
              simple: Gmail.Subject
            iscontext: true
          right:
            value:
              simple: this is a test
      - - operator: isEqualString
          left:
            value:
              simple: Gmail.Body
            iscontext: true
          right:
            value:
              simple: bla bla bla
    view: |-
      {
        "position": {
          "x": 850,
          "y": 4910
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "43":
    id: "43"
    taskid: a62b6276-ef7b-42cc-8e91-f9fbbd621639
    type: regular
    task:
      id: a62b6276-ef7b-42cc-8e91-f9fbbd621639
      version: -1
      name: gmail-delegate-user-mailbox
      description: Adds a delegate to the mailbox, without sending any verification
        email. The delegate user must be a member of the same G Suite organization
        as the delegator user.  Note that a delegate user must be referred to by their
        primary email address, and not an email alias.
      script: '|||gmail-delegate-user-mailbox'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "49"
    scriptarguments:
      delegate-email:
        simple: shai@demistodev.com
      user-id:
        simple: admin@demistodev.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 850,
          "y": 5340
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "45":
    id: "45"
    taskid: 6a9bad5c-b15c-4efa-8979-67c20b0d216b
    type: regular
    task:
      id: 6a9bad5c-b15c-4efa-8979-67c20b0d216b
      version: -1
      name: gmail-delete-mail
      description: Delete a mail in the user's mailbox.
      script: '|||gmail-delete-mail'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "43"
    scriptarguments:
      message-id:
        complex:
          root: Gmail
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: Gmail.Subject
                iscontext: true
              right:
                value:
                  simple: this is a test
          transformers:
          - operator: getField
            args:
              field:
                value:
                  simple: ID
      permanent: {}
      user-id:
        simple: shai@demistodev.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 850,
          "y": 5140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "47":
    id: "47"
    taskid: 6a130a75-bd6a-441d-8355-4a56eee69dfb
    type: regular
    task:
      id: 6a130a75-bd6a-441d-8355-4a56eee69dfb
      version: -1
      name: gmail-set-password
      description: Set password for the user
      script: '|||gmail-set-password'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "33"
    scriptarguments:
      password:
        simple: ${NEW_PASSWORD}
      user-id:
        simple: user_to_delete@demistodev.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 860,
          "y": 3130
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "48":
    id: "48"
    taskid: 1d4ceff5-8696-4ce7-8561-c132062fad77
    type: regular
    task:
      id: 1d4ceff5-8696-4ce7-8561-c132062fad77
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "51"
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 830,
          "y": 2265
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "49":
    id: "49"
    taskid: e3237926-4eeb-4f68-8c76-bf5c650e7cff
    type: regular
    task:
      id: e3237926-4eeb-4f68-8c76-bf5c650e7cff
      version: -1
      name: gmail-remove-delegated-mailbox
      description: Removes a delegate from the mailbox, without sending any verification
        email. The delegate user must be a member of the same G Suite organization
        as the delegator user.  Note that a delegate user must be referred to by their
        primary email address, and not an email alias.
      script: '|||gmail-remove-delegated-mailbox'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "62"
    scriptarguments:
      removed-mail:
        simple: shai@demistodev.com
      user-id:
        simple: admin@demistodev.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 850,
          "y": 5520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "50":
    id: "50"
    taskid: 63119729-987f-481e-8988-7bc5b93e3a4f
    type: regular
    task:
      id: 63119729-987f-481e-8988-7bc5b93e3a4f
      version: -1
      name: send-mail
      description: Send an email
      script: '|||send-mail'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "40"
    scriptarguments:
      additionalHeader: {}
      attachCIDs: {}
      attachIDs: {}
      attachNames: {}
      bcc: {}
      body:
        simple: bla bla bla
      cc: {}
      from:
        simple: shai@demistodev.com
      htmlBody: {}
      replyTo: {}
      subject:
        simple: this is a test
      templateParams: {}
      to:
        simple: admin@demistodev.com
      transientFile: {}
      transientFileCID: {}
      transientFileContent: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 850,
          "y": 4500
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "51":
    id: "51"
    taskid: 33a2d026-0b0b-41ca-81a5-83afb2d94f2a
    type: regular
    task:
      id: 33a2d026-0b0b-41ca-81a5-83afb2d94f2a
      version: -1
      name: GeneratePassword
      description: "This function generates a password and allows various parameters\
        \ to customize the properties of the password depending on the use case (e.g.\
        \ password complexity requirements).  The default behavior is to generate\
        \ a password of  *random length* including all four character classes (upper,\
        \ lower, digits, symbols) with at least five and at most ten characters per\
        \ class. \n\nThe min_* values all default to 0. This means that if the command\
        \ is executed in this way:\n!GeneratePassword max_lcase=10\nIt is possible\
        \ that a password of length zero could be generated. It is therefore recommended\
        \ to always include a min_* parameter that matches. \n\nThe debug parameter\
        \ will print certain properties of the command into the WarRoom for easy diagnostics."
      scriptName: GeneratePassword
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "55"
    scriptarguments:
      debug: {}
      max_digits: {}
      max_lcase: {}
      max_symbols: {}
      max_ucase: {}
      min_digits:
        simple: "2"
      min_lcase:
        simple: "2"
      min_symbols:
        simple: "2"
      min_ucase:
        simple: "2"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 840,
          "y": 2420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "55":
    id: "55"
    taskid: f90c5ae4-1109-413d-8e42-31d4ff556e29
    type: regular
    task:
      id: f90c5ae4-1109-413d-8e42-31d4ff556e29
      version: -1
      name: check for user's existence
      description: Gets information for a specified user.
      script: '|||gmail-get-user'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "56"
    scriptarguments:
      custom-field-mask: {}
      projection: {}
      user-id:
        simple: user_to_delete@demistodev.com
      view-type-public-domain: {}
    continueonerror: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1380,
          "y": 2500
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "56":
    id: "56"
    taskid: 2acfc505-c519-4f25-83ca-9187cb227038
    type: condition
    task:
      id: 2acfc505-c519-4f25-83ca-9187cb227038
      version: -1
      name: Check user's existence
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "30"
      "yes":
      - "57"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Account.Gmail.Address
            iscontext: true
          right:
            value:
              simple: user_to_delete@demistodev.com
    view: |-
      {
        "position": {
          "x": 1380,
          "y": 2680
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "57":
    id: "57"
    taskid: 79e43c02-be6c-47e8-8ec7-ac22bbcbe7b8
    type: regular
    task:
      id: 79e43c02-be6c-47e8-8ec7-ac22bbcbe7b8
      version: -1
      name: gmail-delete-user
      description: Deletes a Gmail user.
      script: '|||gmail-delete-user'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      user-id:
        simple: user_to_delete@demistodev.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1380,
          "y": 2900
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "58":
    id: "58"
    taskid: 9943b8c9-2ee9-41cf-8416-5a299b85edbf
    type: regular
    task:
      id: 9943b8c9-2ee9-41cf-8416-5a299b85edbf
      version: -1
      name: Get User Role
      description: Retrieves a list of all Google roles for a specified user.
      script: Gmail|||gmail-get-user-roles
      type: regular
      iscommand: true
      brand: Gmail
    nexttasks:
      '#none#':
      - "59"
    scriptarguments:
      user-id:
        complex:
          root: Account
          accessor: ID
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1565,
          "y": 130
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "59":
    id: "59"
    taskid: c322b433-8319-4a09-8d62-7d7d9fe82102
    type: condition
    task:
      id: c322b433-8319-4a09-8d62-7d7d9fe82102
      version: -1
      name: Verify User Role Context Output
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "60"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: Gmail
                accessor: Role.RoleAssignmentId
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: Gmail
                accessor: Role.ScopeType
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: Gmail
                accessor: Role.Kind
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: Gmail
                accessor: Role.OrgUnitId
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: Gmail
                accessor: Role.ID
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: Gmail
                accessor: Role.AssignedTo
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1565,
          "y": 295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "60":
    id: "60"
    taskid: 49a23200-2e6f-4e13-8bdf-48b4d4ea51d6
    type: regular
    task:
      id: 49a23200-2e6f-4e13-8bdf-48b4d4ea51d6
      version: -1
      name: Get Role
      description: gmail get role
      script: '|||gmail-get-role'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "61"
    scriptarguments:
      customer-id: {}
      role-id:
        complex:
          root: Gmail
          accessor: Role.[0].ID
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1565,
          "y": 480
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "61":
    id: "61"
    taskid: efc43e58-2d6e-48e4-8324-c6b53fea4ca4
    type: condition
    task:
      id: efc43e58-2d6e-48e4-8324-c6b53fea4ca4
      version: -1
      name: Verify Get Role Context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "5"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: Gmail
                accessor: Role.ETag
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: Gmail
                accessor: Role.IsSuperAdminRole
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: Gmail
                accessor: Role.IsSystemRole
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: Gmail
                accessor: Role.Kind
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: Gmail
                accessor: Role.Description
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: Gmail
                accessor: Role.ID
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: Gmail
                accessor: Role.Name
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: Gmail
                accessor: Role.Privilege.ServiceID
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: Gmail
                accessor: Role.Privilege.Name
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1565,
          "y": 650
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "62":
    id: "62"
    taskid: 18731ab8-8475-4363-86ce-5bf8f9bda67b
    type: regular
    task:
      id: 18731ab8-8475-4363-86ce-5bf8f9bda67b
      version: -1
      name: gmail-forwarding-address-add
      description: Creates a forwarding address. If ownership verification is required,
        a message will be sent to the recipient and the resource's verification status
        will be set to pending; otherwise, the resource will be created with verification
        status set to accepted. This method is only available to service account clients
        that have been delegated domain-wide authority.
      script: '|||gmail-forwarding-address-add'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "63"
    scriptarguments:
      forwarding_email:
        simple: deval@nimbledata.io
      user_id:
        simple: paulomi@nimbledata.io
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 850,
          "y": 5690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "63":
    id: "63"
    taskid: 6429b293-bc0d-4d7f-8980-b051fb7dafd5
    type: condition
    task:
      id: 6429b293-bc0d-4d7f-8980-b051fb7dafd5
      version: -1
      name: Verify outputs
      description: |-
        Creates a custom "from" send-as alias. If an SMTP MSA is specified, Gmail will attempt to connect to the SMTP service to validate the configuration before creating the alias. If ownership verification is required for the alias, a message will be sent to the email address and the resource's verification status will be set to pending; otherwise, the resource will be created with verification status set to accepted. If a signature is provided, Gmail will sanitize the HTML before saving it with the alias.

        This command is only available to service account clients that have been delegated domain-wide authority.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "64"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Gmail.ForwardingAddress
                accessor: userId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Gmail.ForwardingAddress
                accessor: forwardingEmail
            iscontext: true
    view: |-
      {
        "position": {
          "x": 850,
          "y": 5850
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "64":
    id: "64"
    taskid: d053626f-f3eb-41f9-83ea-0ffd695d3cb4
    type: regular
    task:
      id: d053626f-f3eb-41f9-83ea-0ffd695d3cb4
      version: -1
      name: gmail-send-as-add
      description: |-
        Creates a custom "from" send-as alias. If an SMTP MSA is specified, Gmail will attempt to connect to the SMTP service to validate the configuration before creating the alias. If ownership verification is required for the alias, a message will be sent to the email address and the resource's verification status will be set to pending; otherwise, the resource will be created with verification status set to accepted. If a signature is provided, Gmail will sanitize the HTML before saving it with the alias.

        This command is only available to service account clients that have been delegated domain-wide authority.
      script: '|||gmail-send-as-add'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "65"
    scriptarguments:
      display_name: {}
      is_default: {}
      reply_to_address: {}
      send_as_email:
        simple: deval@nimbledata.io
      signature: {}
      smtp_host: {}
      smtp_password: {}
      smtp_port: {}
      smtp_securitymode: {}
      smtp_username: {}
      treat_as_alias: {}
      user_id:
        simple: paulomi@nimbledata.io
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 850,
          "y": 5990
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "65":
    id: "65"
    taskid: 9b1dbe26-fbb1-41fc-8d9d-a720cbb017f1
    type: condition
    task:
      id: 9b1dbe26-fbb1-41fc-8d9d-a720cbb017f1
      version: -1
      name: Verify outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "29"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Gmail.SendAs
                accessor: userId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Gmail.SendAs
                accessor: sendAsEmail
            iscontext: true
    view: |-
      {
        "position": {
          "x": 850,
          "y": 6160
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
view: |-
  {
    "linkLabelsPosition": {
      "56_30_#default#": 0.42
    },
    "paper": {
      "dimensions": {
        "height": 6955,
        "width": 2110,
        "x": 50,
        "y": -570
      }
    }
  }
inputs: []
outputs: []
fromversion: 5.0.0
description: ''
