commonfields:
  id: Bitglass
  version: -1
name: Bitglass
display: Bitglass
category: Analytics & SIEM
description: The app pulls cloudaudit and access Bitglass log data filtered down to
  the specified DLP patterns. It also provides actions for access to Bitglass REST
  APIs for group and user manipulation.
configuration:
- display: Use system proxy settings
  name: proxy
  defaultvalue: "false"
  type: 8
  required: false
- display: Trust any certificate (not secure)
  name: insecure
  defaultvalue: ""
  type: 8
  required: false
- display: OAuth 2 Authentication Token
  name: auth_token
  type: 4
  required: true
  additionalinfo: The OAuth 2 authentication token for the Bitglass API
- display: Fetch incidents
  name: isFetch
  type: 8
  required: false
- display: Incident type
  name: incidentType
  type: 13
  required: false
- display: Bitglass API URL
  name: api_url
  type: 0
  required: true
  additionalinfo: The URL for the Bitglass API to retrieve the log events
- display: Proxy settings for Bitglass API
  name: proxies
  type: 4
  required: false
  additionalinfo: https=https://usr:pswd@1.2.3.4:999
- display: 'Pull Bitglass Access logs :'
  name: enable_access
  defaultvalue: "true"
  type: 8
  required: false
  additionalinfo: Turn on the retrieval of the Access log type events as incidents
- display: DLP Pattern for Access
  name: filter_access
  defaultvalue: Malware.*|PCI.*
  type: 0
  required: false
  additionalinfo: Filter the Access log type events down to the pattern
- display: 'Pull Bitglass CloudAudit logs :'
  name: enable_cloudaudit
  defaultvalue: "true"
  type: 8
  required: false
  additionalinfo: Turn on the retrieval of the CloudAudit log type events as incidents
- display: DLP Pattern for CloudAudit
  name: filter_cloudaudit
  defaultvalue: ^PCI.*
  type: 0
  required: false
  additionalinfo: Filter the CloudAudit log type events down to the pattern
- display: Incidents Fetch Interval
  name: incidentFetchInterval
  defaultvalue: "5"
  type: 19
  required: false
- display: Long running instance
  name: longRunning
  type: 8
  required: false
- display: Reset tag
  name: reset_tag
  type: 0
  required: false
  additionalinfo: Type in a different tag to retrieve anew all incidents starting
    from 30 days ago up to now
- display: First fetch time
  name: first_fetch
  defaultvalue: 3 days
  type: 0
  required: false
- display: Maximum number of incidents per fetch
  name: max_fetch
  defaultvalue: '100'
  type: 0
  required: false
script:
  script: ''
  type: python
  commands:
  - name: bitglass-filter-by-dlp-pattern
    arguments:
    - name: bg_match_expression
      required: true
      description: Python regex expression to match the patterns
      defaultValue: Malware.*
    - name: bg_log_event
      required: true
      description: XSOAR Event ID###
      defaultValue: artifact:*.id
    outputs:
    - contextPath: Bitglass.user_name
      description: Offending user name
      type: string
    description: Filter log events by DLP pattern
  - name: bitglass-create-update-group
    arguments:
    - name: bg_group_name
      required: true
      description: Name of the group to create or update
      defaultValue: RiskyUsers
    - name: bg_new_group_name
      description: New name of the group to rename to
      defaultValue: RiskyUsers
    description: Create or update a group
  - name: bitglass-delete-group
    arguments:
    - name: bg_group_name
      required: true
      description: Name of the group to delete
      defaultValue: RiskyUsers
    description: Delete a group
    execution: true
  - name: bitglass-add-user-to-group
    arguments:
    - name: bg_group_name
      required: true
      description: Name of the group to add the risky user to
      defaultValue: RiskyUsers
    - name: bg_user_name
      required: true
      description: User name to add
      defaultValue: ${Bitglass.user_name}
    description: Add risky user to a group
  - name: bitglass-remove-user-from-group
    arguments:
    - name: bg_group_name
      required: true
      description: Name of the group to add the risky user to
      defaultValue: RiskyUsers
    - name: bg_user_name
      required: true
      description: User name to remove
      defaultValue: ${Bitglass.user_name}
    description: Remove risky user from a group
    execution: true
  - name: bitglass-create-update-user
    arguments:
    - name: bg_user_name
      required: true
      description: Email of the user to create or update
    - name: bg_first_name
      description: First name
    - name: bg_last_name
      description: Last name
    - name: bg_secondary_email
      description: Secondary email
    - name: bg_netbios_domain
      description: NetBIOS domain
    - name: bg_sam_account_name
      description: SAM account domain
    - name: bg_user_principal_name
      description: User principal name
    - name: bg_object_guid
      description: Object GUID
    - name: bg_country_code
      description: Country code
    - name: bg_mobile_number
      description: Mobile number
    - name: bg_admin_role
      description: Admin role
    - name: bg_group_membership
      description: Place the user under the group
    description: Create or update user
  - name: bitglass-deactivate-user
    arguments:
    - name: bg_user_name
      required: true
      description: Email of the user to deactivate
    description: Deactivate user
  - name: bitglass-reactivate-user
    arguments:
    - name: bg_user_name
      required: true
      description: Email of the user to reactivate
    description: Reactivate user
    execution: true
  dockerimage: demisto/python3:3.10.1.25933
  isfetch: true
  runonce: false
  longRunning: true
  subtype: python3
fromversion: 6.0.0
tests:
- No tests (auto formatted)
