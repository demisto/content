contentitemexportablefields:
  contentitemfields:
    propagationLabels:
    - all
description: Retrieves all the details of the PAN-OS Platform and topology.
id: PAN-OS Network Operations - Platform Management
inputs:
- description: If set, completes the given task in the parent playbook. Used to ensure
    that the parent does not continue until this incident is finished processing.
  key: close_task_id
  playbookInputQuery:
  required: false
  value: {}
- description: Incident that initiated this subplaybook, if any.
  key: parent_incident_id
  playbookInputQuery:
  required: false
  value: {}
name: PAN-OS Network Operations - Platform Management
outputs:
- contextPath: PANOS.ShowSystemInfo.Result
  description: PANOS System Information
  type: unknown
- contextPath: PANOS.ShowArp.Result
  description: PANOS ARP Table Details
  type: unknown
- contextPath: PANOS.ShowRouteSummary.Summary
  description: PANOS Route table summary
  type: unknown
- contextPath: PANOS.ShowCounters.Result
  description: PANOS Global counters
  type: unknown
starttaskid: '0'
tasks:
  '0':
    id: '0'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '13'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: 189f9564-d042-4ca5-8c29-5fa35b518c3c
      iscommand: false
      name: ''
      version: -1
      description: ''
    taskid: 189f9564-d042-4ca5-8c29-5fa35b518c3c
    timertriggers: []
    type: start
    view: "{\n  \"position\": {\n    \"x\": 490,\n    \"y\": -380\n  }\n}"
  '1':
    fieldMapping:
    - incidentfield: PAN-OS System Info
      output:
        complex:
          accessor: Summary
          root: PANOS.ShowSystemInfo
          transformers:
          - operator: ConvertKeysToTableFieldFormat
    - incidentfield: PAN-OS System Info Result
      output:
        complex:
          accessor: Result
          root: PANOS.ShowSystemInfo
          transformers:
          - operator: ConvertKeysToTableFieldFormat
    id: '1'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '14'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Gets information from all PAN-OS systems in the topology.
      id: ee11dba7-888a-437c-813b-66089ffdafbc
      iscommand: true
      name: Get System Information
      script: '|||pan-os-platform-get-system-info'
      type: regular
      version: -1
    taskid: ee11dba7-888a-437c-813b-66089ffdafbc
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 10,\n    \"y\": 230\n  }\n}"
  '2':
    id: '2'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '1'
      - '3'
      - '5'
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: yes
      keysToKeep:
        simple: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Delete field from context
      id: d67186a2-3d59-4de4-8018-7b662453a2a7
      iscommand: false
      name: Delete Context
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: d67186a2-3d59-4de4-8018-7b662453a2a7
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 490,\n    \"y\": 60\n  }\n}"
  '3':
    fieldMapping:
    - incidentfield: PAN-OS ARP Summary
      output:
        simple: ${PANOS.ShowArp.Summary}
    - incidentfield: PAN-OS ARP Table Result
      output:
        simple: ${PANOS.ShowArp.Result}
    id: '3'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '14'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Gets all arp tables from all firewalls in the topology.
      id: 98142cd5-1890-49bb-8c5c-fe8de9ae18b1
      iscommand: true
      name: Get ARP Summary
      script: '|||pan-os-platform-get-arp-tables'
      type: regular
      version: -1
    taskid: 98142cd5-1890-49bb-8c5c-fe8de9ae18b1
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 490,\n    \"y\": 230\n  }\n}"
  '4':
    fieldMapping:
    - incidentfield: PAN-OS Route Summary
      output:
        simple: ${PANOS.ShowRouteSummary.Summary}
    id: '4'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '6'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Pulls all route summary information from the topology
      id: e0b17bad-6f0a-4b35-8c20-48f6a2b2e3c5
      iscommand: true
      name: Get Route Summary
      script: '|||pan-os-platform-get-route-summary'
      type: regular
      version: -1
    taskid: e0b17bad-6f0a-4b35-8c20-48f6a2b2e3c5
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 80,\n    \"y\": 580\n  }\n}"
  '5':
    fieldMapping:
    - incidentfield: PAN-OS Network Operations - Global Counters
      output:
        simple: ${PANOS.ShowCounters.Summary}
    - incidentfield: PAN-OS Network Operations - Global Counters Result
      output:
        simple: ${PANOS.ShowCounters.Result}
    id: '5'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '14'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Gets global counter information from all the PAN-OS firewalls in
        the topology
      id: 4ebd83b0-7f21-441d-8b80-f6c1e5efb72d
      iscommand: true
      name: Get Global Counters
      script: '|||pan-os-platform-get-global-counters'
      type: regular
      version: -1
    taskid: 4ebd83b0-7f21-441d-8b80-f6c1e5efb72d
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 910,\n    \"y\": 230\n  }\n}"
  '6':
    id: '6'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '9'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: 343a46ad-0b31-49b1-86b4-33d1bcc57d14
      iscommand: false
      name: Finish Information Gathering
      type: title
      version: -1
      description: ''
    taskid: 343a46ad-0b31-49b1-86b4-33d1bcc57d14
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 490,\n    \"y\": 760\n  }\n}"
  '7':
    fieldMapping:
    - incidentfield: PAN-OS Routes
      output:
        complex:
          accessor: Summary
          root: PANOS.ShowRoute
          transformers:
          - operator: ConvertKeysToTableFieldFormat
    - incidentfield: PAN-OS Routes Result
      output:
        complex:
          accessor: Result
          root: PANOS.ShowRoute
          transformers:
          - operator: ConvertKeysToTableFieldFormat
    id: '7'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '6'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Pulls all route summary information from the topology
      id: df5f0fb2-dbcd-46ed-85fa-d4dbfd96dc25
      iscommand: true
      name: Get All Routes
      script: '|||pan-os-platform-get-routes'
      type: regular
      version: -1
    taskid: df5f0fb2-dbcd-46ed-85fa-d4dbfd96dc25
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 490,\n    \"y\": 580\n  }\n}"
  '9':
    id: '9'
    ignoreworker: false
    loop:
      exitCondition: ''
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - '10'
    note: false
    quietmode: 0
    separatecontext: true
    skipunavailable: false
    task:
      brand: ''
      id: 4a41ca36-016d-47f9-856c-f861bbeac026
      iscommand: false
      name: PAN-OS Network Operations - Incident Callback
      playbookId: PAN-OS Network Operations - Incident Callback
      type: playbook
      version: -1
      description: ''
    taskid: 4a41ca36-016d-47f9-856c-f861bbeac026
    timertriggers: []
    type: playbook
    view: "{\n  \"position\": {\n    \"x\": 490,\n    \"y\": 880\n  }\n}"
  '10':
    id: '10'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '15'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: 7c19ce94-38cd-4359-8b1b-31282b9e9180
      iscommand: false
      name: Create Device Specific Incidents
      type: title
      version: -1
      description: ''
    taskid: 7c19ce94-38cd-4359-8b1b-31282b9e9180
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 490,\n    \"y\": 1040\n  }\n}"
  '11':
    continueonerror: true
    id: '11'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '2'
    note: false
    quietmode: 0
    scriptarguments:
      panosnetworkoperationsincidentdescription:
        simple: "<h4>PAN-OS System/Platform Information</h4>\nThis incident type collects\
          \ runtime information from the PAN-OS platforms in the environment, including\
          \ tabular information like routing and arp information.\n\nVarious actions\
          \ can be taken on the environment using the buttons within this incident\
          \ layout, which will spawn and link additional incidents to this one."
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: b6d69a09-efec-445c-849b-0389d7d72f31
      iscommand: true
      name: Set Incident Type HTML
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: b6d69a09-efec-445c-849b-0389d7d72f31
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 490,\n    \"y\": -90\n  }\n}"
  '12':
    fieldMapping:
    - incidentfield: PAN-OS BGP Peers
      output:
        complex:
          accessor: Summary
          root: PANOS.ShowBGPPeers
          transformers:
          - operator: ConvertKeysToTableFieldFormat
    - incidentfield: PAN-OS Network Operations - BGP Peers Result
      output:
        complex:
          accessor: Result
          root: PANOS.ShowBGPPeers
          transformers:
          - operator: ConvertKeysToTableFieldFormat
    id: '12'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '6'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Retrieves all BGP peer information from the PAN-OS firewalls in
        the topology.
      id: d309268c-bf34-46ea-852d-a59069924533
      iscommand: true
      name: Get BGP Peers
      script: '|||pan-os-platform-get-bgp-peers'
      type: regular
      version: -1
    taskid: d309268c-bf34-46ea-852d-a59069924533
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 910,\n    \"y\": 580\n  }\n}"
  '13':
    id: '13'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '11'
    note: false
    quietmode: 0
    scriptarguments:
      seconds:
        simple: '5'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Sleep for X seconds
      id: 919ce07a-cc38-4f04-8eef-c66946296271
      iscommand: false
      name: Sleep to ensure everything is caught up
      scriptName: Sleep
      type: regular
      version: -1
    taskid: 919ce07a-cc38-4f04-8eef-c66946296271
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 490,\n    \"y\": -250\n  }\n}"
  '14':
    id: '14'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '4'
      - '7'
      - '12'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: 7542315f-885f-473e-822d-8669dbdcf64e
      iscommand: false
      name: Get More data...
      type: title
      version: -1
      description: ''
    taskid: 7542315f-885f-473e-822d-8669dbdcf64e
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 490,\n    \"y\": 410\n  }\n}"
  '15':
    id: '15'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '16'
    note: false
    quietmode: 0
    scriptarguments:
      target:
        simple: ${PANOS.ShowSystemInfo.Summary.hostid}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      id: 7e1a5a36-ed8b-4227-85ed-66926c53124e
      iscommand: false
      name: Create Or Update Incidents
      scriptName: CreateOrUpdateDeviceIncident
      type: regular
      version: -1
    taskid: 7e1a5a36-ed8b-4227-85ed-66926c53124e
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 490,\n    \"y\": 1170\n  }\n}"
  '16':
    id: '16'
    ignoreworker: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: ccb39552-7818-4906-8cdd-b2053d532f6c
      iscommand: false
      name: Finish
      type: title
      version: -1
      description: ''
    taskid: ccb39552-7818-4906-8cdd-b2053d532f6c
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 490,\n    \"y\": 1330\n  }\n}"
version: -1
view: "{\n  \"linkLabelsPosition\": {},\n  \"paper\": {\n    \"dimensions\": {\n \
  \     \"height\": 1775,\n      \"width\": 1280,\n      \"x\": 10,\n      \"y\":\
  \ -380\n    }\n  }\n}"
tests:
- No tests (auto formatted)
fromversion: 6.2.0
