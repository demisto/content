id: FireEyeHX_v2
version: -1
name: FireEyeHX_v2
description: FireEye HX V2 Test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 1b6eb885-810d-4286-898a-691282baf43c
    type: start
    task:
      id: 1b6eb885-810d-4286-898a-691282baf43c
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 65
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 9db4e888-8632-4a1f-8366-eda3d69a7882
    type: regular
    task:
      id: 9db4e888-8632-4a1f-8366-eda3d69a7882
      version: -1
      name: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 225
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: bb5b33ea-f160-4fc3-835d-012d9dbd5573
    type: regular
    task:
      id: bb5b33ea-f160-4fc3-835d-012d9dbd5573
      version: -1
      name: fireeye-hx-get-host-information
      description: Get information on a host associated with an agent.
      script: FireEyeHX v2|||fireeye-hx-get-host-information
      type: regular
      iscommand: true
      brand: FireEyeHX v2
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      agentId:
        simple: Hqb2ns3oui1fpzg0BxI1Ch
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 51c7cabd-f700-4fcd-8937-6e14ec8ea50c
    type: condition
    task:
      id: 51c7cabd-f700-4fcd-8937-6e14ec8ea50c
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "4"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: FireEyeHX.Hosts._id
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: FireEyeHX.Hosts.agent_version
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: FireEyeHX.Hosts.excluded_from_containment
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: FireEyeHX.Hosts.containment_missing_software
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: FireEyeHX.Hosts.containment_queued
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: FireEyeHX.Hosts.containment_state
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: FireEyeHX.Hosts.stats.alerting_conditions
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: FireEyeHX.Hosts.stats.alerts
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: FireEyeHX.Hosts.stats.exploit_blocks
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: FireEyeHX.Hosts.stats.malware_alerts
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: FireEyeHX.Hosts.hostname
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: FireEyeHX.Hosts.domain
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: FireEyeHX.Hosts.timezone
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: FireEyeHX.Hosts.primary_ip_address
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: FireEyeHX.Hosts.last_poll_timestamp
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: FireEyeHX.Hosts.initial_agent_checkin
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: FireEyeHX.Hosts.last_alert_timestamp
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: FireEyeHX.Hosts.os.product_name
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: FireEyeHX.Hosts.os.bitness
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: FireEyeHX.Hosts.os.platform
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: FireEyeHX.Hosts.primary_mac
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 575
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 07cc5759-a2bb-4f35-8eee-370e9b59c5a5
    type: regular
    task:
      id: 07cc5759-a2bb-4f35-8eee-370e9b59c5a5
      version: -1
      name: fireeye-hx-get-all-hosts-information
      description: Get information on all hosts.
      script: FireEyeHX v2|||fireeye-hx-get-all-hosts-information
      type: regular
      iscommand: true
      brand: FireEyeHX v2
    nexttasks:
      '#none#':
      - "5"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: c919e094-f3d0-4ec1-8c2c-bd2c283189a9
    type: condition
    task:
      id: c919e094-f3d0-4ec1-8c2c-bd2c283189a9
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "6"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Hosts._id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Hosts.agent_version
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Hosts.containment_state
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Hosts.hostname
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Hosts.domain
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Hosts.primary_ip_address
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Hosts.last_poll_timestamp
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Hosts.os.platform
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 925
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: eab33e13-b515-409c-8687-de67e9dc540e
    type: regular
    task:
      id: eab33e13-b515-409c-8687-de67e9dc540e
      version: -1
      name: fireeye-hx-host-containment
      description: Apply containment for a specific host, so that it no longer has
        access to other systems, If the user does not have the necessary permissions,
        the command will not approve the request, The permissions necessary to approve
        the request are api_admin role.
      script: FireEyeHX v2|||fireeye-hx-host-containment
      type: regular
      iscommand: true
      brand: FireEyeHX v2
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      agentId:
        simple: Hqb2ns3oui1fpzg0BxI1Ch
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: 8d134580-a14b-4166-8134-61424deff5d8
    type: condition
    task:
      id: 8d134580-a14b-4166-8134-61424deff5d8
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "8"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Hosts._id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Hosts.agent_version
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Hosts.containment_state
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Hosts.hostname
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Hosts.domain
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Hosts.primary_ip_address
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Hosts.last_poll_timestamp
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Hosts.os.platform
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Hosts.primary_mac
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1275
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 470dd021-f5c1-451f-8e4d-3f9ae87d0f90
    type: regular
    task:
      id: 470dd021-f5c1-451f-8e4d-3f9ae87d0f90
      version: -1
      name: fireeye-hx-cancel-containment
      description: Release a specific host from containment.
      script: FireEyeHX v2|||fireeye-hx-cancel-containment
      type: regular
      iscommand: true
      brand: FireEyeHX v2
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      agentId:
        simple: Hqb2ns3oui1fpzg0BxI1Ch
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1450
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: a1fdae89-87a3-40e2-85b5-47f4de939933
    type: regular
    task:
      id: a1fdae89-87a3-40e2-85b5-47f4de939933
      version: -1
      name: fireeye-hx-initiate-data-acquisition
      description: Initiate a data acquisition process to gather artifacts from the
        system disk and memory.
      script: FireEyeHX v2|||fireeye-hx-initiate-data-acquisition
      type: regular
      iscommand: true
      brand: FireEyeHX v2
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      defaultSystemScript:
        simple: win
      hostName:
        simple: WIN10X64
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 6700
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: eac210dc-e807-44cb-8bce-fda12d9da5f5
    type: condition
    task:
      id: eac210dc-e807-44cb-8bce-fda12d9da5f5
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "39"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Acquisitions.Data._id
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Acquisitions.Data.state
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Acquisitions.Data.host._id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Acquisitions.Data.host.hostname
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Acquisitions.Data.instance
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 6875
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: 26981183-6adc-4a93-8741-664e14821b8d
    type: regular
    task:
      id: 26981183-6adc-4a93-8741-664e14821b8d
      version: -1
      name: fireeye-hx-get-host-set-information
      description: Get a list of all host sets known to your HX Series appliance.
      script: FireEyeHX v2|||fireeye-hx-get-host-set-information
      type: regular
      iscommand: true
      brand: FireEyeHX v2
    nexttasks:
      '#none#':
      - "13"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1625
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: ceeb25fe-6a34-4a07-8db6-486458cceb26
    type: condition
    task:
      id: ceeb25fe-6a34-4a07-8db6-486458cceb26
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "14"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.HostSets._id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.HostSets._revision
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.HostSets.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.HostSets.type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.HostSets.url
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1800
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: eb00f0b5-5973-4f5d-8c2e-ad3848c8ecdf
    type: regular
    task:
      id: eb00f0b5-5973-4f5d-8c2e-ad3848c8ecdf
      version: -1
      name: fireeye-hx-list-policy
      description: Get a list of all policy.
      script: FireEyeHX v2|||fireeye-hx-list-policy
      type: regular
      iscommand: true
      brand: FireEyeHX v2
    nexttasks:
      '#none#':
      - "15"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1975
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 9ac3931b-8375-4515-8a53-8acd6a5b6b23
    type: condition
    task:
      id: 9ac3931b-8375-4515-8a53-8acd6a5b6b23
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "16"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Policy.data.entries._id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Policy.data.entries.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Policy.data.entries.description
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Policy.data.entries.priority
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Policy.data.entries.enabled
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 2150
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: 0e241271-4ae5-4f9a-8ebb-44e0d454b422
    type: regular
    task:
      id: 0e241271-4ae5-4f9a-8ebb-44e0d454b422
      version: -1
      name: fireeye-hx-list-host-set-policy
      description: Get a list of all policies for all host sets.
      script: FireEyeHX v2|||fireeye-hx-list-host-set-policy
      type: regular
      iscommand: true
      brand: FireEyeHX v2
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 2325
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: a8a21b27-0d61-4e23-80fa-5d9ae1bedadf
    type: condition
    task:
      id: a8a21b27-0d61-4e23-80fa-5d9ae1bedadf
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "38"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.HostSets.Policy.policy_id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.HostSets.Policy.persist_id
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 2500
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: b75a9754-ebd2-4039-871e-e59c97821cd0
    type: regular
    task:
      id: b75a9754-ebd2-4039-871e-e59c97821cd0
      version: -1
      name: fireeye-hx-list-containment
      description: Fetches all containment states across known hosts.
      script: FireEyeHX v2|||fireeye-hx-list-containment
      type: regular
      iscommand: true
      brand: FireEyeHX v2
    nexttasks:
      '#none#':
      - "19"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 2850
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: 920bbe98-234d-4f1d-8440-3ca8cf29dd26
    type: condition
    task:
      id: 920bbe98-234d-4f1d-8440-3ca8cf29dd26
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "43"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Hosts._id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Hosts.state
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Hosts.url
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 3025
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: b63be6f2-d690-43f4-8949-5a2e6b71246c
    type: regular
    task:
      id: b63be6f2-d690-43f4-8949-5a2e6b71246c
      version: -1
      name: fireeye-hx-search-list
      description: Fetches all enterprise searches.
      script: FireEyeHX v2|||fireeye-hx-search-list
      type: regular
      iscommand: true
      brand: FireEyeHX v2
    nexttasks:
      '#none#':
      - "58"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 5650
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 4f1b0848-fa5d-4445-8722-a926e779acb2
    type: regular
    task:
      id: 4f1b0848-fa5d-4445-8722-a926e779acb2
      version: -1
      name: fireeye-hx-search-stop
      description: Stops a specific running search.
      script: FireEyeHX v2|||fireeye-hx-search-stop
      type: regular
      iscommand: true
      brand: FireEyeHX v2
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      searchId:
        simple: ${FireEyeHX.Search._id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 275,
          "y": 8100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: 144aa607-d8b8-45e0-8333-da6c487bdfe5
    type: condition
    task:
      id: 144aa607-d8b8-45e0-8333-da6c487bdfe5
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "63"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Search._id
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Search.state
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Search.update_time
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Search.create_time
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Search.scripts.platform
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Search.update_actor
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Search.create_actor
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Search.url
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 275,
          "y": 8275
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: e6801d17-f0c6-4ecc-8407-a62c7f6410f6
    type: regular
    task:
      id: e6801d17-f0c6-4ecc-8407-a62c7f6410f6
      version: -1
      name: fireeye-hx-search-result-get
      description: Fetches the result for a specific enterprise search.
      script: FireEyeHX v2|||fireeye-hx-search-result-get
      type: regular
      iscommand: true
      brand: FireEyeHX v2
    nexttasks:
      '#none#':
      - "25"
    scriptarguments:
      searchId:
        simple: ${FireEyeHX.Search._id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 275,
          "y": 6175
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "25":
    id: "25"
    taskid: 2766ec81-68f7-4fa2-882e-dc001b972718
    type: condition
    task:
      id: 2766ec81-68f7-4fa2-882e-dc001b972718
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "59"
      "yes":
      - "10"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Search.host._id
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Search.host.url
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Search.host.hostname
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Search.results.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Search.results.type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Search.results.data
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 275,
          "y": 6350
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: d6791444-4a7b-4c62-8570-8d11f0542281
    type: regular
    task:
      id: d6791444-4a7b-4c62-8570-8d11f0542281
      version: -1
      name: fireeye-hx-get-alert
      description: Get details of a specific alert.
      script: FireEyeHX v2|||fireeye-hx-get-alert
      type: regular
      iscommand: true
      brand: FireEyeHX v2
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      alertId:
        simple: ${FireEyeHX.Alerts._id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 3550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: 3bae7416-9090-4176-8286-9f052fb2afde
    type: condition
    task:
      id: 3bae7416-9090-4176-8286-9f052fb2afde
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "31"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Alerts._id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Alerts.agent._id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Alerts.agent.containment_state
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Alerts.condition._id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Alerts.event_at
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Alerts.matched_at
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Alerts.reported_at
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Alerts.source
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Alerts.event_type
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 3725
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: bc3238e0-1b4b-4d38-8317-13f09cbbcfb0
    type: regular
    task:
      id: bc3238e0-1b4b-4d38-8317-13f09cbbcfb0
      version: -1
      name: fireeye-hx-get-indicators
      description: Get a list of indicators.
      script: FireEyeHX v2|||fireeye-hx-get-indicators
      type: regular
      iscommand: true
      brand: FireEyeHX v2
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 3900
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: a539dc39-1f49-485c-8147-031bba65439e
    type: condition
    task:
      id: a539dc39-1f49-485c-8147-031bba65439e
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "33"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators._id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators.category.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators.created_by
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators.active_since
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators.stats.source_alerts
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators.stats.alerted_agents
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators.platforms
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators.uri_name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators.category.uri_name
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 4075
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: c3109d36-112e-4d62-8b77-a572a454d41b
    type: regular
    task:
      id: c3109d36-112e-4d62-8b77-a572a454d41b
      version: -1
      name: fireeye-hx-get-indicator
      description: Get a specific indicator details.
      script: FireEyeHX v2|||fireeye-hx-get-indicator
      type: regular
      iscommand: true
      brand: FireEyeHX v2
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      category:
        simple: ${FireEyeHX.Indicators.category.uri_name}
      name:
        simple: ${FireEyeHX.Indicators.uri_name}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 4250
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: 60826ab4-506b-4e2f-8e9f-4b8431474902
    type: condition
    task:
      id: 60826ab4-506b-4e2f-8e9f-4b8431474902
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "55"
      "yes":
      - "47"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators._id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators.category.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators.created_by
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators.active_since
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators.stats.source_alerts
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators.stats.alerted_agents
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators.platforms
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Conditions._id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Conditions.event_type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Conditions.enabled
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 4425
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: 1059750d-6d2d-4aa1-8a87-60e6ae16d6f9
    type: regular
    task:
      id: 1059750d-6d2d-4aa1-8a87-60e6ae16d6f9
      version: -1
      name: fireeye-hx-append-conditions
      description: Add conditions to an indicator. Conditions can be MD5, hash values,
        domain names and IP addresses.
      script: FireEyeHX v2|||fireeye-hx-append-conditions
      type: regular
      iscommand: true
      brand: FireEyeHX v2
    nexttasks:
      '#none#':
      - "37"
    scriptarguments:
      category:
        simple: ${FireEyeHX.Indicators.category.uri_name}
      condition:
        simple: exsmple.com
      name:
        simple: ${FireEyeHX.Indicators.uri_name}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 5125
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: cec5dda7-cad1-4959-8817-d2998abf4a26
    type: regular
    task:
      id: cec5dda7-cad1-4959-8817-d2998abf4a26
      version: -1
      name: fireeye-hx-delete-file-acquisition
      description: Delete the file acquisition, by ID.
      script: FireEyeHX v2|||fireeye-hx-delete-file-acquisition
      type: regular
      iscommand: true
      brand: FireEyeHX v2
    nexttasks:
      '#none#':
      - "62"
    scriptarguments:
      acquisitionId:
        simple: ${FireEyeHX.Acquisitions.Data._id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 7400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: 537399b1-f54f-498b-8096-3af6992e5b21
    type: regular
    task:
      id: 537399b1-f54f-498b-8096-3af6992e5b21
      version: -1
      name: fireeye-hx-approve-containment
      description: Approve pending containment requests made by other components or
        users, The permissions necessary are api_admin role.
      script: FireEyeHX v2|||fireeye-hx-approve-containment
      type: regular
      iscommand: true
      brand: FireEyeHX v2
    nexttasks:
      '#none#':
      - "56"
    scriptarguments:
      agentId:
        simple: Hqb2ns3oui1fpzg0BxI1Ch
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 5300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: a1f7469c-9856-4612-81df-0fdcebe2b530
    type: regular
    task:
      id: a1f7469c-9856-4612-81df-0fdcebe2b530
      version: -1
      name: fireeye-hx-assign-host-set-policy
      description: Insert a new host set policy on your Endpoint Security server.
      script: FireEyeHX v2|||fireeye-hx-assign-host-set-policy
      type: regular
      iscommand: true
      brand: FireEyeHX v2
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      hostSetId:
        simple: ${FireEyeHX.HostSets.Policy.persist_id}
      policyId:
        simple: ${FireEyeHX.HostSets.Policy.policy_id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 2675
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: 68ff1b84-8e96-4e8b-829b-08d74d0c193f
    type: regular
    task:
      id: 68ff1b84-8e96-4e8b-829b-08d74d0c193f
      version: -1
      name: fireeye-hx-get-data-acquisition
      description: Gather artifacts from the system disk and memory for the given
        acquisition id. (The data is fetched as mans file)
      script: FireEyeHX v2|||fireeye-hx-get-data-acquisition
      type: regular
      iscommand: true
      brand: FireEyeHX v2
    nexttasks:
      '#none#':
      - "40"
    scriptarguments:
      acquisitionId:
        simple: ${FireEyeHX.Acquisitions.Data._id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 7050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: 9834fd84-af10-43a1-8ba1-0db607ae0e7e
    type: condition
    task:
      id: 9834fd84-af10-43a1-8ba1-0db607ae0e7e
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "36"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Acquisitions.Data._id
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Acquisitions.Data.state
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Acquisitions.Data.host._id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Acquisitions.Data.host.hostname
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Acquisitions.Data.instance
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 7225
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: b35c2ae5-33bb-4acc-8dff-15c2e4a1a865
    type: regular
    task:
      id: b35c2ae5-33bb-4acc-8dff-15c2e4a1a865
      version: -1
      name: fireeye-hx-get-alerts
      description: Get a list of alerts, use the different arguments to filter the
        results returned.
      script: FireEyeHX v2|||fireeye-hx-get-alerts
      type: regular
      iscommand: true
      brand: FireEyeHX v2
    nexttasks:
      '#none#':
      - "44"
    scriptarguments:
      limit:
        simple: "2"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 3200
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "44":
    id: "44"
    taskid: 039d3a61-a9b3-4392-8f3e-364032401ef1
    type: condition
    task:
      id: 039d3a61-a9b3-4392-8f3e-364032401ef1
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "28"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Alerts._id
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Alerts.agent._id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Alerts.agent.containment_state
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Alerts.condition._id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Alerts.event_at
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Alerts.matched_at
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Alerts.reported_at
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Alerts.event_type
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 3375
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: 1b63a236-b487-4d6d-8e30-5532cfec6e2c
    type: regular
    task:
      id: 1b63a236-b487-4d6d-8e30-5532cfec6e2c
      version: -1
      name: fireeye-hx-create-indicator
      description: Create new indicator
      script: FireEyeHX v2|||fireeye-hx-create-indicator
      type: regular
      iscommand: true
      brand: FireEyeHX v2
    nexttasks:
      '#none#':
      - "48"
    scriptarguments:
      category:
        simple: Custom
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 4775
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: a11eaf58-74a8-4149-8477-9513facb1be5
    type: condition
    task:
      id: a11eaf58-74a8-4149-8477-9513facb1be5
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "35"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators.active_since
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators.created_by
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators.url
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators.platforms
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators.create_actor._id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators.create_actor.username
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators._id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators.category._id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators.category.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators.category.uri_name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators.uri_name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators.stats.active_conditions
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators.update_actor._id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators.update_actor.username
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 4950
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: d1840a32-136d-4403-8ed4-49bbfbb28baa
    type: title
    task:
      id: d1840a32-136d-4403-8ed4-49bbfbb28baa
      version: -1
      name: Test Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 11310
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "55":
    id: "55"
    taskid: 99ee3c2a-2abb-49c7-86e6-eff6544184f1
    type: condition
    task:
      id: 99ee3c2a-2abb-49c7-86e6-eff6544184f1
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "47"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators._id
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators.category.name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators.created_by
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators.active_since
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators.stats.source_alerts
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators.stats.alerted_agents
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Indicators.platforms
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4600
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "56":
    id: "56"
    taskid: 2de96e8c-0e6d-46b4-8255-5e631c323750
    type: regular
    task:
      id: 2de96e8c-0e6d-46b4-8255-5e631c323750
      version: -1
      name: fireeye-hx-cancel-containment
      description: Release a specific host from containment.
      script: FireEyeHX v2|||fireeye-hx-cancel-containment
      type: regular
      iscommand: true
      brand: FireEyeHX v2
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      agentId:
        simple: Hqb2ns3oui1fpzg0BxI1Ch
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 5475
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "57":
    id: "57"
    taskid: 925c2528-14b2-4f36-886d-173705b52bfa
    type: condition
    task:
      id: 925c2528-14b2-4f36-886d-173705b52bfa
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "24"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Search._id
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Search.state
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Search.scripts
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Search.update_time
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Search.create_time
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Search.scripts.platform
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Search.update_actor
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Search.create_actor
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Search._revision
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Search.input_type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Search.url
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Search.stats
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Search.stats.search_state
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 400,
          "y": 5990
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "58":
    id: "58"
    taskid: 6fcb55a4-8297-4b7a-891e-15da00dd3791
    type: condition
    task:
      id: 6fcb55a4-8297-4b7a-891e-15da00dd3791
      version: -1
      name: Is There Search
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "10"
      "yes":
      - "57"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Search._id
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 5810
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "59":
    id: "59"
    taskid: e57dabd8-0850-4ca3-821a-46c8b58a3c89
    type: condition
    task:
      id: e57dabd8-0850-4ca3-821a-46c8b58a3c89
      version: -1
      name: No Results
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "10"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEmpty
          left:
            value:
              simple: FireEyeHX.Search.host._id
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 6525
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: 643d43fc-6f9e-4b6b-8514-872db8efc8ae
    type: condition
    task:
      id: 643d43fc-6f9e-4b6b-8514-872db8efc8ae
      version: -1
      name: If there is a search in run mode
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "63"
      "yes":
      - "22"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Search._id
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 7925
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    id: "61"
    taskid: 87d7e29b-4ed4-443b-8fef-d24675c9711e
    type: regular
    task:
      id: 87d7e29b-4ed4-443b-8fef-d24675c9711e
      version: -1
      name: fireeye-hx-search-list
      description: Fetches all enterprise searches.
      script: FireEyeHX v2|||fireeye-hx-search-list
      type: regular
      iscommand: true
      brand: FireEyeHX v2
    nexttasks:
      '#none#':
      - "60"
    scriptarguments:
      limit:
        simple: "1"
      state:
        simple: RUNNING
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 7750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "62":
    id: "62"
    taskid: f2eafbf9-5b0b-46b6-84b0-a3b9c3a1dc8d
    type: regular
    task:
      id: f2eafbf9-5b0b-46b6-84b0-a3b9c3a1dc8d
      version: -1
      name: DeleteContext
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "61"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 7575
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: c8da41f1-7ea4-4965-8019-843d17d91b5c
    type: regular
    task:
      id: c8da41f1-7ea4-4965-8019-843d17d91b5c
      version: -1
      name: fireeye-hx-search
      description: Search endpoints to check all hosts or a subset of hosts for a
        specific file or indicator.
      script: FireEyeHX v2|||fireeye-hx-search
      type: regular
      iscommand: true
      brand: FireEyeHX v2
    nexttasks:
      '#none#':
      - "67"
    scriptarguments:
      hostsNames:
        simple: WIN10X64
      ipAddress:
        simple: 8.8.8.8
      ipAddressOperator:
        simple: equals
      stopSearch:
        simple: stopAndDelete
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 8450
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "65":
    id: "65"
    taskid: a925868e-78dc-44ec-8137-78f06bc7d388
    type: regular
    task:
      id: a925868e-78dc-44ec-8137-78f06bc7d388
      version: -1
      name: fireeye-hx-search-list
      description: Fetches all enterprise searches.
      script: FireEyeHX v2|||fireeye-hx-search-list
      type: regular
      iscommand: true
      brand: FireEyeHX v2
    nexttasks:
      '#none#':
      - "66"
    scriptarguments:
      limit:
        simple: "1"
      state:
        simple: RUNNING
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 8800
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "66":
    id: "66"
    taskid: 68e79a85-ba66-472f-84e0-7565d4eb27ac
    type: regular
    task:
      id: 68e79a85-ba66-472f-84e0-7565d4eb27ac
      version: -1
      name: fireeye-hx-search-delete
      description: Delete the search, by ID.
      script: FireEyeHX v2|||fireeye-hx-search-delete
      type: regular
      iscommand: true
      brand: FireEyeHX v2
    nexttasks:
      '#none#':
      - "68"
    scriptarguments:
      searchId:
        simple: ${FireEyeHX.Search._id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 8975
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "67":
    id: "67"
    taskid: 771d5127-a655-4a37-89fc-fb0145a6f388
    type: regular
    task:
      id: 771d5127-a655-4a37-89fc-fb0145a6f388
      version: -1
      name: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "65"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 8625
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "68":
    id: "68"
    taskid: bad104a6-7823-4281-8663-9b805f6bea86
    type: regular
    task:
      id: bad104a6-7823-4281-8663-9b805f6bea86
      version: -1
      name: fireeye-hx-search
      description: Search endpoints to check all hosts or a subset of hosts for a
        specific file or indicator.
      script: FireEyeHX v2|||fireeye-hx-search
      type: regular
      iscommand: true
      brand: FireEyeHX v2
    nexttasks:
      '#none#':
      - "69"
    scriptarguments:
      hostsNames:
        simple: WIN10X64
      ipAddress:
        simple: 8.8.8.8
      ipAddressOperator:
        simple: equals
      limit:
        simple: "1"
      polling:
        simple: "true"
      stopSearch:
        simple: stopAndDelete
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 9210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "69":
    id: "69"
    taskid: a5e6db61-6ec7-48a0-8ea6-14d45af33ff7
    type: condition
    task:
      id: a5e6db61-6ec7-48a0-8ea6-14d45af33ff7
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "70"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Search.results.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Search.results.type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Search.host._id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Search.host.hostname
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: FireEyeHX.Search.host.url
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 9380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "70":
    id: "70"
    taskid: 9f78092b-3e2d-4710-8f7f-e68e0c07c520
    type: regular
    task:
      id: 9f78092b-3e2d-4710-8f7f-e68e0c07c520
      version: -1
      name: fireeye-hx-create-indicator
      description: Create a new indicator.
      script: FireEyeHX v2|||fireeye-hx-create-indicator
      type: regular
      iscommand: true
      brand: FireEyeHX v2
    nexttasks:
      '#none#':
      - "71"
    scriptarguments:
      category:
        simple: Custom
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 9660
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "71":
    id: "71"
    taskid: 5bd72ae2-16d2-45af-8989-6f28d177063e
    type: regular
    task:
      id: 5bd72ae2-16d2-45af-8989-6f28d177063e
      version: -1
      name: fireeye-hx-delete-indicator
      description: Delete an indicator.
      script: FireEyeHX v2|||fireeye-hx-delete-indicator
      type: regular
      iscommand: true
      brand: FireEyeHX v2
    nexttasks:
      '#none#':
      - "72"
    scriptarguments:
      category:
        simple: Custom
      indicator_name:
        simple: ${FireEyeHX.Indicators.name}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 9810
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "72":
    id: "72"
    taskid: a617b78f-26bf-45b3-8e1d-77638392452d
    type: regular
    task:
      id: a617b78f-26bf-45b3-8e1d-77638392452d
      version: -1
      name: fireeye-hx-create-host-set-static
      description: Creates static host set.
      script: FireEyeHX v2|||fireeye-hx-create-host-set-static
      type: regular
      iscommand: true
      brand: FireEyeHX v2
    nexttasks:
      '#none#':
      - "73"
    scriptarguments:
      host_set_name:
        simple: Playbook_test
      hosts_ids:
        simple: Hqb2ns3oui1fpzg0BxI1Ch
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 10060
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "73":
    id: "73"
    taskid: d60c96bb-ec6d-4c5f-8022-bc06b125abe0
    type: regular
    task:
      id: d60c96bb-ec6d-4c5f-8022-bc06b125abe0
      version: -1
      name: fireeye-hx-update-host-set-static
      description: Updates a static host set.
      script: FireEyeHX v2|||fireeye-hx-update-host-set-static
      type: regular
      iscommand: true
      brand: FireEyeHX v2
    nexttasks:
      '#none#':
      - "74"
    scriptarguments:
      add_host_ids:
        simple: GfLI00Q4zpidezw9I11rV6
      host_set_id:
        simple: ${FireEyeHX.HostSets._id}
      host_set_name:
        simple: ${FireEyeHX.HostSets.name}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 10210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "74":
    id: "74"
    taskid: 6e883dc2-0f65-42e7-805b-8e6306a3c519
    type: regular
    task:
      id: 6e883dc2-0f65-42e7-805b-8e6306a3c519
      version: -1
      name: fireeye-hx-delete-host-set
      description: Deletes a host set.
      script: FireEyeHX v2|||fireeye-hx-delete-host-set
      type: regular
      iscommand: true
      brand: FireEyeHX v2
    nexttasks:
      '#none#':
      - "79"
    scriptarguments:
      host_set_id:
        simple: ${FireEyeHX.HostSets._id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 10360
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "75":
    id: "75"
    taskid: 9f995fe5-3744-437e-894a-f8cced57e502
    type: regular
    task:
      id: 9f995fe5-3744-437e-894a-f8cced57e502
      version: -1
      name: fireeye-hx-create-host-set-dynamic
      description: Creates dynamic host set.
      script: FireEyeHX v2|||fireeye-hx-create-host-set-dynamic
      type: regular
      iscommand: true
      brand: FireEyeHX v2
    nexttasks:
      '#none#':
      - "78"
    scriptarguments:
      host_set_name:
        simple: Playbook_dynamic_test
      query_key:
        simple: Bitlevel
      query_operator:
        simple: eq
      query_value:
        simple: 64-bit
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 10820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "77":
    id: "77"
    taskid: 08e6f9eb-ff79-4a8c-8974-1f5f2e17a9e7
    type: regular
    task:
      id: 08e6f9eb-ff79-4a8c-8974-1f5f2e17a9e7
      version: -1
      name: fireeye-hx-delete-host-set
      description: Deletes a host set.
      script: FireEyeHX v2|||fireeye-hx-delete-host-set
      type: regular
      iscommand: true
      brand: FireEyeHX v2
    nexttasks:
      '#none#':
      - "49"
    scriptarguments:
      host_set_id:
        simple: ${FireEyeHX.HostSets._id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 11150
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "78":
    id: "78"
    taskid: f512b771-3f6c-49ae-80b5-c9960f66047f
    type: regular
    task:
      id: f512b771-3f6c-49ae-80b5-c9960f66047f
      version: -1
      name: fireeye-hx-update-host-set-dynamic
      description: Updates dynamic host set.
      script: FireEyeHX v2|||fireeye-hx-update-host-set-dynamic
      type: regular
      iscommand: true
      brand: FireEyeHX v2
    nexttasks:
      '#none#':
      - "77"
    scriptarguments:
      host_set_id:
        simple: ${FireEyeHX.HostSets._id}
      host_set_name:
        simple: ${FireEyeHX.HostSets.name}
      query_key:
        simple: AgentVersion
      query_operator:
        simple: gte
      query_value:
        simple: 31.28.17
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 10990
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "79":
    id: "79"
    taskid: eb7938d1-090d-414a-893c-bbcb7bb166f1
    type: regular
    task:
      id: eb7938d1-090d-414a-893c-bbcb7bb166f1
      version: -1
      name: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "75"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 10640
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "19_43_yes": 0.52,
      "25_10_yes": 0.9,
      "29_31_yes": 0.77,
      "34_47_yes": 0.9,
      "40_36_yes": 0.71,
      "44_28_yes": 0.57,
      "48_35_yes": 0.87,
      "55_47_yes": 0.87,
      "59_10_yes": 0.9
    },
    "paper": {
      "dimensions": {
        "height": 11310,
        "width": 730,
        "x": 50,
        "y": 65
      }
    }
  }
inputs: []
outputs: []
fromversion: 6.0.0
