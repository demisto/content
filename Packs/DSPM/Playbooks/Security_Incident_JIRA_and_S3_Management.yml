id: da7fa1c4-11b7-4c6c-8afa-15d0e3e5f417
version: 57
vcShouldKeepItemLegacyProdMachine: false
name: Security Incident JIRA and S3 Management
description: This playbook automates incident response actions by creating a JIRA
  ticket and setting AWS S3 bucket public access blocks based on predefined incident
  fields. It helps streamline the incident management process by integrating JIRA
  for issue tracking and AWS for securing S3 buckets.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 2adde2a7-864b-44a5-8aaf-7d7574c68740
    type: start
    task:
      id: 2adde2a7-864b-44a5-8aaf-7d7574c68740
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 45bab92e-7774-4864-8fa6-2c5def306e74
    type: condition
    task:
      id: 45bab92e-7774-4864-8fa6-2c5def306e74
      version: -1
      name: Check if the Action is value
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      Jira action:
      - "16"
      Remedition action (Sensitive asset open to world):
      - "17"
    separatecontext: false
    conditions:
    - label: Jira action
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: incident.action
            iscontext: true
          right:
            value:
              simple: jira
    - label: Remedition action (Sensitive asset open to world)
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: incident.action
            iscontext: true
          right:
            value:
              simple: remediate
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: c35d1124-d9ce-4629-86a6-616667566215
    type: regular
    task:
      id: c35d1124-d9ce-4629-86a6-616667566215
      version: -1
      name: Update Slack Incident with JIRA details
      description: commands.local.cmd.set.incident
      script: Builtin|||setIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      details:
        simple: 'JIRA Ticket created with ${Ticket.Id}: ${Ticket.Key}'
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 97455db4-83e9-4d31-8312-805fe8bc980a
    type: regular
    task:
      id: 97455db4-83e9-4d31-8312-805fe8bc980a
      version: -1
      name: Set parent incident ID  to slack incident
      description: commands.local.cmd.set.incident
      script: Builtin|||setIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      parentincident:
        simple: ${incident.parentIncidentId}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: d74302a5-566c-4a44-814d-2d07ca11d5da
    type: regular
    task:
      id: d74302a5-566c-4a44-814d-2d07ca11d5da
      version: -1
      name: Closed current  Incident
      description: commands.local.cmd.close.inv
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    scriptarguments:
      closeNotes:
        simple: Remediation has completed.
      closeReason:
        simple: Resolved
      id:
        simple: ${incident.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: 46b55d7d-c497-4846-8c56-d2d5cac3cc5f
    type: regular
    task:
      id: 46b55d7d-c497-4846-8c56-d2d5cac3cc5f
      version: -1
      name: Create Jira Issue
      description: Creates a new issue in Jira.
      script: Jira V3|||jira-create-issue
      type: regular
      iscommand: true
      brand: Jira V3
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      assignee:
        simple: ${incident.jira_user}
      assignee_id:
        simple: ${AccountInfo.AccountID}
      description:
        simple: 'The issue created from incident Id: ${incident.id} and Incident Name:
          ${incident.name}'
      issue_type_id:
        simple: ${incident.issue_type}
      project_key:
        simple: ${incident.project_key}
      summary:
        simple: 'The issue created from Incident Id: ${incident.id} for ${incident.project_key}'
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 8c9624cd-02cd-4c6c-86e8-cb0032dbaed9
    type: regular
    task:
      id: 8c9624cd-02cd-4c6c-86e8-cb0032dbaed9
      version: -1
      name: 'Closing Parent Incident : ${incident.parentincident}'
      description: Close the current incident
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      closeNotes:
        simple: ${incident.details}
      closeReason:
        simple: ${incident.details}
      id:
        simple: ${incident.parentincident}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: e720622d-ef47-4984-8928-285183ab945e
    type: regular
    task:
      id: e720622d-ef47-4984-8928-285183ab945e
      version: -1
      name: Linking slack incident to parent incident
      description: Link incidents together or mark them as duplicate and close them
      script: Builtin|||linkIncidents
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      action:
        simple: link
      linkedIncidentIDs:
        simple: ${incident.parentIncidentId}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: 66825e37-981e-4fe9-82b6-4ca0c74d5fe8
    type: regular
    task:
      id: 66825e37-981e-4fe9-82b6-4ca0c74d5fe8
      version: -1
      name: get-jira-accountId
      scriptName: get-jira-accountId
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      email:
        simple: ${incident.jira_user}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: ee7cbc85-6935-49fc-8736-53962be9ae90
    type: regular
    task:
      id: ee7cbc85-6935-49fc-8736-53962be9ae90
      version: -1
      name: aws-s3-get-public-access-block
      description: Retrieves the PublicAccessBlock configuration for an Amazon S3
        bucket.
      script: AWS - S3|||aws-s3-get-public-access-block
      type: regular
      iscommand: true
      brand: AWS - S3
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      bucket:
        simple: ${incident.assetId}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: 943a2f42-76c5-4ebf-86be-ee1ee80e3e7b
    type: regular
    task:
      id: 943a2f42-76c5-4ebf-86be-ee1ee80e3e7b
      version: -1
      name: Update Slack Incident with AWS details
      description: commands.local.cmd.set.incident
      script: Builtin|||setIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      details:
        simple: 'Bucket RestrictPublicBuckets : ${AWS.S3.Buckets.PublicAccessBlockConfiguration.RestrictPublicBuckets}'
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1465,
        "width": 810,
        "x": 50,
        "y": 50
      }
    }
  }
inputs:
- key: Incident Name
  value:
    simple: ${incident.name}
  required: true
  description: ""
  playbookInputQuery: null
- key: Project Key
  value:
    simple: ${incident.jiraproject}
  required: false
  description: ""
  playbookInputQuery: null
- key: Summary
  value:
    simple: ${incident.jirasummary}
  required: false
  description: ""
  playbookInputQuery: null
- key: Issue Type
  value:
    simple: ${incident.jiraissuetype}
  required: false
  description: ""
  playbookInputQuery: null
- key: Issue Description
  value:
    simple: ${incident.jiradescription}
  required: false
  description: ""
  playbookInputQuery: null
- key: Action
  value:
    simple: ${incident.action}
  required: true
  description: ""
  playbookInputQuery: null
outputs: []
