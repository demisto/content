id: da7fa1c4-11b7-4c6c-8afa-15d0e3e5f417
version: 6
vcShouldKeepItemLegacyProdMachine: false
name: Security Incident JIRA and S3 Management
description: This playbook automates incident response actions by creating a JIRA
  ticket and setting AWS S3 bucket public access blocks based on predefined incident
  fields. It helps streamline the incident management process by integrating JIRA
  for issue tracking and AWS for securing S3 buckets.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: adb21f2d-be36-457a-88d1-0dfef71103e0
    type: start
    task:
      id: adb21f2d-be36-457a-88d1-0dfef71103e0
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 13cc346c-e5e1-41f6-8fb8-ccba7a0d7faf
    type: condition
    task:
      id: 13cc346c-e5e1-41f6-8fb8-ccba7a0d7faf
      version: -1
      name: Check if the Action is value
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      Jira action:
      - "16"
      Remedition action (Sensitive asset open to world):
      - "17"
    separatecontext: false
    conditions:
    - label: Jira action
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: incident.action
            iscontext: true
          right:
            value:
              simple: jira
    - label: Remedition action (Sensitive asset open to world)
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: incident.action
            iscontext: true
          right:
            value:
              simple: remediate
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 8547d2df-30b8-44e4-8cac-ffa2f36c7361
    type: regular
    task:
      id: 8547d2df-30b8-44e4-8cac-ffa2f36c7361
      version: -1
      name: Update Slack Incident with JIRA details
      description: commands.local.cmd.set.incident
      script: Builtin|||setIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      details:
        simple: 'JIRA Ticket created with ${Ticket.Id} : ${Ticket.Key}'
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: 22f934cc-3d9f-438d-8f74-19343eebd636
    type: regular
    task:
      id: 22f934cc-3d9f-438d-8f74-19343eebd636
      version: -1
      name: Closed current  Incident
      description: commands.local.cmd.close.inv
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    scriptarguments:
      closeNotes:
        simple: |-
          Remediation has completed.
          Risk Finding ID : ${incident.riskFindingId} status updated to${Response.newStatus} on DSPM portal.
      closeReason:
        simple: Resolved
      id:
        simple: ${incident.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: fd45c9a6-f626-4ad6-88a2-e2d4dc76f2f6
    type: regular
    task:
      id: fd45c9a6-f626-4ad6-88a2-e2d4dc76f2f6
      version: -1
      name: Create Jira Issue
      description: Creates a new issue in Jira.
      script: Jira V3|||jira-create-issue
      type: regular
      iscommand: true
      brand: Jira V3
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      assignee:
        simple: ${incident.jira_user}
      assignee_id:
        simple: ${AccountInfo.AccountID}
      description:
        simple: 'The issue created from incident Id: ${incident.id} and Incident Name:
          ${incident.name}'
      issue_type_id:
        simple: ${incident.issue_type}
      project_key:
        simple: ${incident.project_key}
      summary:
        simple: 'The issue created from Incident Id: ${incident.id} for ${incident.project_key}'
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: df98fac5-c0c4-4470-8245-a75637c9a5b8
    type: regular
    task:
      id: df98fac5-c0c4-4470-8245-a75637c9a5b8
      version: -1
      name: 'Closing Parent Incident : ${incident.parentincident}'
      description: Close the current incident
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      closeNotes:
        simple: "${incident.details} \nRisk Finding ID : ${incident.riskFindingId}
          status updated to ${Response.newStatus} on DSPM portal."
      closeReason:
        simple: ${incident.details}
      id:
        simple: ${incident.parentincident}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1325
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 923a5a31-1728-4513-8d49-9a832732d3f7
    type: regular
    task:
      id: 923a5a31-1728-4513-8d49-9a832732d3f7
      version: -1
      name: Linking slack incident to parent incident
      description: Link incidents together or mark them as duplicate and close them
      script: Builtin|||linkIncidents
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      action:
        simple: link
      linkedIncidentIDs:
        simple: ${incident.parentIncidentId}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 910
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: 09ab0ba5-4d28-49b1-8dce-666e73f7e9f4
    type: regular
    task:
      id: 09ab0ba5-4d28-49b1-8dce-666e73f7e9f4
      version: -1
      name: Get Assignee ID from email
      scriptName: DSPM-Get-Jira-accountId
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      email:
        simple: ${incident.jira_user}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: b3285112-7b8e-413e-8e9c-0ed2f7ee4183
    type: regular
    task:
      id: b3285112-7b8e-413e-8e9c-0ed2f7ee4183
      version: -1
      name: aws-s3-get-public-access-block
      description: Retrieves the PublicAccessBlock configuration for an Amazon S3
        bucket.
      script: AWS - S3|||aws-s3-get-public-access-block
      type: regular
      iscommand: true
      brand: AWS - S3
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      bucket:
        simple: dig-security-integration
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: 05102cac-552b-4211-8831-d14339c30be3
    type: regular
    task:
      id: 05102cac-552b-4211-8831-d14339c30be3
      version: -1
      name: Update Slack Incident with AWS details
      description: commands.local.cmd.set.incident
      script: Builtin|||setIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      details:
        simple: Change the S3 PublicAccessBlock settings to block public access control
          lists (ACLs) for ${incident.assetId} bucket Bucket.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: 2f1f5485-5b79-4ec8-8284-fdbbabf1f2fa
    type: regular
    task:
      id: 2f1f5485-5b79-4ec8-8284-fdbbabf1f2fa
      version: -1
      name: DSPM_risk_status_update
      scriptName: DSPM_risk_status_update
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      riskFindingId:
        simple: ${incident.riskFindingId}
      status:
        simple: INVESTIGATING
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1110
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1595,
        "width": 810,
        "x": 50,
        "y": 50
      }
    }
  }
inputs:
- key: Incident Name
  value:
    simple: ${incident.name}
  required: true
  description: ""
  playbookInputQuery: null
- key: Project Key
  value:
    simple: ${incident.jiraproject}
  required: false
  description: ""
  playbookInputQuery: null
- key: Summary
  value:
    simple: ${incident.jirasummary}
  required: false
  description: ""
  playbookInputQuery: null
- key: Issue Type
  value:
    simple: ${incident.jiraissuetype}
  required: false
  description: ""
  playbookInputQuery: null
- key: Issue Description
  value:
    simple: ${incident.jiradescription}
  required: false
  description: ""
  playbookInputQuery: null
- key: Action
  value:
    simple: ${incident.action}
  required: true
  description: ""
  playbookInputQuery: null
outputs: []