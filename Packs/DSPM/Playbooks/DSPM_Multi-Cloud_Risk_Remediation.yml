id: 3f9933ab-2f20-4e6d-8bb3-927362eedffe
version: 7
vcShouldKeepItemLegacyProdMachine: false
name: DSPM Multi-Cloud Risk Remediation
description: The playbook ensures efficient incident resolution and compliance with
  security policies by guiding the user through decision points based on incident
  type, such as empty storage assets or assets open to the world. It concludes by
  updating the incident status and closing the playbook upon resolution.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 96c429d4-b29b-419c-83d8-bfdb463dad21
    type: start
    task:
      id: 96c429d4-b29b-419c-83d8-bfdb463dad21
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "25"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 240,
          "y": -1730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: f9a9d173-c54c-49ad-84cc-55578fd866eb
    type: condition
    task:
      id: f9a9d173-c54c-49ad-84cc-55578fd866eb
      version: -1
      name: Check if the Action is value
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      Invalid response:
      - "48"
      Jira action:
      - "16"
      No Response from user:
      - "29"
      Remediation action for Empty storage asset:
      - "44"
      Remedition action (Sensitive asset open to world):
      - "40"
    separatecontext: false
    conditions:
    - label: Jira action
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: User.Action
            iscontext: true
          right:
            value:
              simple: jira
    - label: Remedition action (Sensitive asset open to world)
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: User.Action
            iscontext: true
          right:
            value:
              simple: remediate
      - - operator: isEqualString
          left:
            value:
              simple: incident.name
            iscontext: true
          right:
            value:
              simple: Sensitive asset open to world
    - label: No Response from user
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: User.Action
            iscontext: true
          right:
            value:
              simple: no_response
    - label: Remediation action for Empty storage asset
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: User.Action
            iscontext: true
          right:
            value:
              simple: remediate
      - - operator: isEqualString
          left:
            value:
              simple: incident.name
            iscontext: true
          right:
            value:
              simple: Empty storage asset
    - label: Invalid response
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: User.Action
            iscontext: true
          right:
            value:
              simple: invalid_response
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -490,
          "y": 565
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 9cc058d4-3cc7-4d1f-8005-60a8258a3561
    type: regular
    task:
      id: 9cc058d4-3cc7-4d1f-8005-60a8258a3561
      version: -1
      name: Update Slack Incident with JIRA details
      description: commands.local.cmd.set.incident
      script: Builtin|||setIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "33"
    scriptarguments:
      details:
        simple: 'JIRA Ticket created successfully with ID: ${Ticket.Id} and Key: ${Ticket.Key}.
          Associated Remediation ID: ${riskFindingId}.'
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -1930,
          "y": 1380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: 0614c09c-b6c5-437b-884d-d8e2da893228
    type: regular
    task:
      id: 0614c09c-b6c5-437b-884d-d8e2da893228
      version: -1
      name: Closed current  Incident playbook
      description: commands.local.cmd.close.inv
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    scriptarguments:
      closeReason:
        simple: Resolved
      id:
        simple: ${incident.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 440,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: f0477977-40c1-4fb4-81e8-8dc0df364a8e
    type: regular
    task:
      id: f0477977-40c1-4fb4-81e8-8dc0df364a8e
      version: -1
      name: Create Jira Issue with Assignee ID
      description: Creates a new issue in Jira.
      script: Jira V3|||jira-create-issue
      type: regular
      iscommand: true
      brand: Jira V3
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      assignee_id:
        simple: ${AccountInfo.AccountID}
      description:
        simple: "Risk Details : \nRule Name: ${incident_object.ruleName}\nSeverity:
          \ ${incident_object.severity}\nAsset Name:  ${incident_object.assetName}\nAsset
          ID:   ${incident_object.assetId}\nProject ID:   ${incident_object.projectId}\nCloud
          Provider:   ${incident_object.cloudProvider}\nCloud Environment:  ${incident_object.cloudEnvironment}\nFirst
          Discovered: ${incident_object.firstDiscovered}\nService Type:   ${incident_object.serviceType}\nData
          Type Groups:   ${incident_object.dataTypeGroups}\n\nRemediation steps :
          \ ${incident.remediateSteps}"
      issue_type_id:
        simple: ${User.JiraTicketTypeID}
      project_name:
        simple: ${User.JiraProjectName}
      summary:
        simple: 'The issue created from XSOAR incident Id: ${incident.id} of DSPM
          risk : ${incident.riskFindingId}. Rule Name: ${incident_object.ruleName}'
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -1930,
          "y": 1210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: 7f5357bc-86a6-4d96-8642-19b92e302ebc
    type: regular
    task:
      id: 7f5357bc-86a6-4d96-8642-19b92e302ebc
      version: -1
      name: Get Assignee ID from email
      scriptName: DSPM-Get-Jira-accountId
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "41"
    scriptarguments:
      email:
        simple: ${User.Email}
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -1590,
          "y": 870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: 36424aa2-e0b1-4d22-8958-451fe5e95530
    type: regular
    task:
      id: 36424aa2-e0b1-4d22-8958-451fe5e95530
      version: -1
      name: ParseSlackBlockBuilderResponse
      scriptName: ParseSlackBlockBuilderResponse
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      SlackBlockState:
        simple: ${SlackBlockState}
      incident_data:
        simple: ${incident_object}
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -490,
          "y": 375
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 7d4c6217-898b-4922-884a-cfdf997d74c3
    type: regular
    task:
      id: 7d4c6217-898b-4922-884a-cfdf997d74c3
      version: -1
      name: SlackBlockBuilder
      description: SlackBlockBuilder will format a given Slack block into a format
        readable by the SlackV3 integration. The script will also send the block to
        the given destination. Make sure to mark **Trust any certificate** and fill
        the **XSOAR API Key integration** parameters if you want to get a response
        to the incident context.
      scriptName: SlackBlockBuilder
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "47"
    scriptarguments:
      list_name:
        simple: ${block_list_name}
      user:
        simple: manas
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -490,
          "y": -540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: 29ffcd9d-f20e-46f5-8dff-d6c103e943cf
    type: regular
    task:
      id: 29ffcd9d-f20e-46f5-8dff-d6c103e943cf
      version: -1
      name: GetSlackBlockBuilderResponse
      description: GetSlackBlockBuilderResponse will format a SlackBlockBuilder response
        and insert it into an incident's context.
      scriptName: GetSlackBlockBuilderResponse
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "45"
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -490,
          "y": -180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: aae7f9b5-c707-428b-8a6f-2bf2ae8e10ae
    type: regular
    task:
      id: aae7f9b5-c707-428b-8a6f-2bf2ae8e10ae
      version: -1
      name: DSPM_risk_status_update
      scriptName: DSPM_risk_status_update
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "28"
    scriptarguments:
      riskFindingId:
        simple: 247f5b8e-7db4-497e-86f2-0ef7d8ac479e
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -460,
          "y": 1820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "25":
    id: "25"
    taskid: d8338f83-8ef9-42a6-887b-fa8ea2560139
    type: regular
    task:
      id: d8338f83-8ef9-42a6-887b-fa8ea2560139
      version: -1
      name: Extracts DSPM risk fields
      scriptName: DSPM_fetch_incident_details
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "26"
    scriptarguments:
      get_incident_details:
        simple: ${incident}
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 240,
          "y": -1580
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: 4831a88a-a579-4400-8ba3-1213128e4170
    type: regular
    task:
      id: 4831a88a-a579-4400-8ba3-1213128e4170
      version: -1
      name: Fetch list of Jira project
      scriptName: DSPM_fetch_list_of_jira_project
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "35"
    scriptarguments:
      retry-count:
        simple: "3"
      retry-interval:
        simple: "300"
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 240,
          "y": -1390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: 9ce77c1c-e5e8-47c6-8e17-02b528613eef
    type: regular
    task:
      id: 9ce77c1c-e5e8-47c6-8e17-02b528613eef
      version: -1
      name: CreateDSPMRiskSlackBlocks
      scriptName: CreateDSPMRiskSlackBlocks
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      dspm_incident:
        simple: ${incident_object}
      list_of_project:
        simple: ${projects_list}
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -200,
          "y": -1020
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: 95374e62-6800-4afa-8811-5a3cd46807d0
    type: regular
    task:
      id: 95374e62-6800-4afa-8811-5a3cd46807d0
      version: -1
      name: RemoveSlackBlockList
      scriptName: RemoveSlackBlockList
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      list_name:
        simple: ${block_list_name}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 440,
          "y": 1740
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: 6de0566a-54da-425e-84fb-0c6138476f66
    type: regular
    task:
      id: 6de0566a-54da-425e-84fb-0c6138476f66
      version: -1
      name: OverwriteListAndNotify
      description: This automation script overwrites the value of a specified list
        and sends a Slack notification to inform the user that they failed to respond
        to an incident notification in a timely manner. The notification includes
        a message indicating the end of the incident playbook and an invitation to
        reopen the incident if necessary.
      scriptName: OverwriteListAndNotify
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      incident_id:
        simple: ${incident_object.incidentId}
      list_name:
        simple: ${block_list_name}
      message:
        simple: |-
          You have not responded to the ${incident_object.incidentId} incident notification in a timely manner.
          We are coming to an end of the${incident_object.incidentId} incident playbook from XSOAR.You are welcome to reopen it. Regards.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 500,
          "y": 750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: e96fc43c-ad00-46db-8a9b-834733e70bbf
    type: regular
    task:
      id: e96fc43c-ad00-46db-8a9b-834733e70bbf
      version: -1
      name: SlackBlockBuilder
      description: SlackBlockBuilder will format a given Slack block into a format
        readable by the SlackV3 integration. The script will also send the block to
        the given destination. Make sure to mark **Trust any certificate** and fill
        the **XSOAR API Key integration** parameters if you want to get a response
        to the incident context.
      scriptName: SlackBlockBuilder
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "28"
    scriptarguments:
      list_name:
        simple: ${block_list_name}
      user:
        simple: manas
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 430,
          "y": 1350
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: ba8cbcc2-645c-4fa1-8b15-113aa5063e36
    type: regular
    task:
      id: ba8cbcc2-645c-4fa1-8b15-113aa5063e36
      version: -1
      name: OverwriteListAndNotify
      description: This automation script overwrites the value of a specified list
        and sends a Slack notification to inform the user that they failed to respond
        to an incident notification in a timely manner. The notification includes
        a message indicating the end of the incident playbook and an invitation to
        reopen the incident if necessary.
      scriptName: OverwriteListAndNotify
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      list_name:
        simple: ${block_list_name}
      message:
        simple: 'JIRA Ticket created successfully with ID: ${Ticket.Id} on Project
          Key: ${Ticket.Key}. Associated XSOAR incident ID: ${incident.id}.'
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -1670,
          "y": 1740
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: 435964ce-8c9f-44e3-8e64-cf6607314615
    type: regular
    task:
      id: 435964ce-8c9f-44e3-8e64-cf6607314615
      version: -1
      name: SlackBlockBuilder
      description: SlackBlockBuilder will format a given Slack block into a format
        readable by the SlackV3 integration. The script will also send the block to
        the given destination. Make sure to mark **Trust any certificate** and fill
        the **XSOAR API Key integration** parameters if you want to get a response
        to the incident context.
      scriptName: SlackBlockBuilder
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "24"
    scriptarguments:
      list_name:
        simple: ${block_list_name}
      user:
        simple: manas
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -460,
          "y": 1645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: d570b202-2124-4cda-8337-1d82577d13a8
    type: condition
    task:
      id: d570b202-2124-4cda-8337-1d82577d13a8
      version: -1
      name: Errors occurred when retrieving the project ID list?
      description: Check whether given entry/entries returned an error. Use ${lastCompletedTaskEntries}
        to check the previous task entries. If array is provided, will return yes
        if one of the entries returned an error.
      scriptName: isError
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "no":
      - "27"
      "yes":
      - "37"
    scriptarguments:
      entryId:
        simple: ${lastCompletedTaskEntries}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 240,
          "y": -1190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: 600903f2-9792-4722-83c9-8988f9039441
    type: condition
    task:
      id: 600903f2-9792-4722-83c9-8988f9039441
      version: -1
      name: 'Errors occurred when generating the Slack block list for the incident
        ID : ${incident_object.id}'
      description: Check whether given entry/entries returned an error. Use ${lastCompletedTaskEntries}
        to check the previous task entries. If array is provided, will return yes
        if one of the entries returned an error.
      scriptName: isError
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "no":
      - "22"
      "yes":
      - "38"
    scriptarguments:
      entryId:
        simple: ${lastCompletedTaskEntries}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -200,
          "y": -760
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: 7f32493a-831a-41e2-8c2c-63f63dbf74de
    type: regular
    task:
      id: 7f32493a-831a-41e2-8c2c-63f63dbf74de
      version: -1
      name: closeInvestigation
      description: Close the current incident
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    scriptarguments:
      closeNotes:
        simple: Closing the playbook before sending notification to user.
      closeReason:
        simple: Unable to fetch the list of project.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 740,
          "y": -1010
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: 66798e6e-e17a-4733-8b30-5f5d2727dfe2
    type: regular
    task:
      id: 66798e6e-e17a-4733-8b30-5f5d2727dfe2
      version: -1
      name: closeInvestigation
      description: Close the current incident
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    scriptarguments:
      closeNotes:
        simple: Closing the playbook before sending notification to user.
      closeReason:
        simple: Unable to create custom slack block for this incident.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 80,
          "y": -540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: 45dc8b97-987b-4dad-8c1e-30109603181a
    type: playbook
    task:
      id: 45dc8b97-987b-4dad-8c1e-30109603181a
      version: -1
      name: DSPM Remediation playbook for Sensitive asset open to world.
      playbookName: DSPM Remediation playbook for Sensitive asset open to world.
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "34"
    separatecontext: false
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": -990,
          "y": 980
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: 5e21ad12-2bce-4bf8-8d37-68b64425be53
    type: condition
    task:
      id: 5e21ad12-2bce-4bf8-8d37-68b64425be53
      version: -1
      name: Errors occurred while fetching assignee ID from email ?
      description: Check whether given entry/entries returned an error. Use ${lastCompletedTaskEntries}
        to check the previous task entries. If array is provided, will return yes
        if one of the entries returned an error.
      scriptName: isError
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "no":
      - "12"
      "yes":
      - "42"
    scriptarguments:
      entryId:
        simple: ${lastCompletedTaskEntries}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -1630,
          "y": 1030
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: 1c79b958-a611-4a8b-84c7-2d63d1ff96f5
    type: regular
    task:
      id: 1c79b958-a611-4a8b-84c7-2d63d1ff96f5
      version: -1
      name: Create Jira Issue without Assignee ID
      description: Creates a new issue in Jira.
      script: Jira V3|||jira-create-issue
      type: regular
      iscommand: true
      brand: Jira V3
    nexttasks:
      '#none#':
      - "43"
    scriptarguments:
      description:
        simple: "Risk Details : \nRule Name: ${incident_object.ruleName}\nSeverity:
          \ ${incident_object.severity}\nAsset Name:  ${incident_object.assetName}\nAsset
          ID:   ${incident_object.assetId}\nProject ID:   ${incident_object.projectId}\nCloud
          Provider:   ${incident_object.cloudProvider}\nCloud Environment:  ${incident_object.cloudEnvironment}\nFirst
          Discovered: ${incident_object.firstDiscovered}\nService Type:   ${incident_object.serviceType}\nData
          Type Groups:   ${incident_object.dataTypeGroups}\n\nRemediation steps :
          \ ${incident.remediateSteps}"
      issue_type_id:
        simple: ${User.JiraTicketTypeID}
      project_name:
        simple: ${User.JiraProjectName}
      summary:
        simple: 'The issue created from XSOAR incident Id: ${incident.id} of DSPM
          risk : ${incident.riskFindingId}. Rule Name: ${incident_object.ruleName}'
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -1410,
          "y": 1210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: f59fccd1-1268-41d0-8593-62575819d263
    type: regular
    task:
      id: f59fccd1-1268-41d0-8593-62575819d263
      version: -1
      name: Update Slack Incident with JIRA details
      description: commands.local.cmd.set.incident
      script: Builtin|||setIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "33"
    scriptarguments:
      details:
        simple: 'JIRA Ticket created successfully with ID: ${Ticket.Id} and Key: ${Ticket.Key}.
          Associated Remediation ID: ${riskFindingId}. The ticket is not assigned
          to anybody because an error occurred when retrieving the assignee ID for
          ${User.Email} from Jira.'
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -1410,
          "y": 1380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "44":
    id: "44"
    taskid: e981f641-07f0-470b-82db-b0f9bb877ae3
    type: playbook
    task:
      id: e981f641-07f0-470b-82db-b0f9bb877ae3
      version: -1
      name: DSPM Remediation playbook for Empty storage asset
      playbookName: DSPM Remediation playbook for Empty storage asset
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "34"
    separatecontext: false
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": -310,
          "y": 1010
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: 2b8925a1-aad9-4ad3-8a44-9da4cd0eecb7
    type: condition
    task:
      id: 2b8925a1-aad9-4ad3-8a44-9da4cd0eecb7
      version: -1
      name: 'Errors occurred when generating the Slack block list for the incident
        ID : ${incident_object.id}'
      description: Check whether given entry/entries returned an error. Use ${lastCompletedTaskEntries}
        to check the previous task entries. If array is provided, will return yes
        if one of the entries returned an error.
      scriptName: isError
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "no":
      - "21"
      "yes":
      - "46"
    scriptarguments:
      entryId:
        simple: ${lastCompletedTaskEntries}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -490,
          "y": 5
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: 79db1098-872b-4e43-8a3d-39f2f5af68c3
    type: regular
    task:
      id: 79db1098-872b-4e43-8a3d-39f2f5af68c3
      version: -1
      name: DSPM Incident Handler
      scriptName: DSPMIncidentList
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "21"
    scriptarguments:
      incident_data:
        simple: ${incident_object}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -890,
          "y": 200
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: c0cfcfb4-61fa-4b2e-873c-be40a81712c7
    type: regular
    task:
      id: c0cfcfb4-61fa-4b2e-873c-be40a81712c7
      version: -1
      name: Waiting until user-specified time
      description: waiting time for user response
      script: DSPM|||dspm-get-lifetime-for-slack
      type: regular
      iscommand: true
      brand: DSPM
    nexttasks:
      '#none#':
      - "23"
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -490,
          "y": -370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: 20f82b29-2342-410d-8d2b-17261561f1dd
    type: regular
    task:
      id: 20f82b29-2342-410d-8d2b-17261561f1dd
      version: -1
      name: OverwriteListAndNotify
      description: This automation script overwrites the value of a specified list
        and sends a Slack notification to inform the user that they failed to respond
        to an incident notification in a timely manner. The notification includes
        a message indicating the end of the incident playbook and an invitation to
        reopen the incident if necessary.
      scriptName: OverwriteListAndNotify
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      incident_id:
        simple: ${incident_object.incidentId}
      list_name:
        simple: ${block_list_name}
      message:
        simple: |-
          We received invalid response from you on incident ID : ${incident_object.incidentId} .
          We are coming to an end of the ${incident_object.incidentId} incident playbook from XSOAR.You are welcome to reopen it. Regards.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 140,
          "y": 935
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "3_29_No Response from user": 0.52
    },
    "paper": {
      "dimensions": {
        "height": 3740,
        "width": 3050,
        "x": -1930,
        "y": -1730
      }
    }
  }
inputs:
- key: Incident Name
  value:
    simple: ${incident.name}
  required: true
  description: ""
  playbookInputQuery: null
- key: Project Key
  value:
    simple: ${incident.jiraproject}
  required: false
  description: ""
  playbookInputQuery: null
- key: Summary
  value:
    simple: ${incident.jirasummary}
  required: false
  description: ""
  playbookInputQuery: null
- key: Issue Type
  value:
    simple: ${incident.jiraissuetype}
  required: false
  description: ""
  playbookInputQuery: null
- key: Issue Description
  value:
    simple: ${incident.jiradescription}
  required: false
  description: ""
  playbookInputQuery: null
- key: Action
  value:
    simple: ${incident.action}
  required: true
  description: ""
  playbookInputQuery: null
outputs: []
sourceplaybookid: da7fa1c4-11b7-4c6c-8afa-15d0e3e5f417