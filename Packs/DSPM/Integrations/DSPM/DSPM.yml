category: Network Security
commonfields:
  id: DSPM
  version: -1
configuration:
- defaultvalue: https://api.dig.security/
  display: Your DSPM server URL
  name: dspmBaseUrl
  required: true
  type: 0
- displaypassword: DSPM API Key
  additionalinfo: API key to use for the connection
  name: dspmApiKey
  required: true
  hiddenusername: true
  type: 9
- display: Default Slack user for notifications
  additionalinfo: the default user to receive Slack notifications in case of any errors.
  name: defaultSlackUser
  required: true
  type: 0
- display: Lifetime for slack notification ( in hours)
  name: slackMsgLifetime
  required: true
  defaultvalue: 2
  type: 0
- display: Trust any certificate (not secure)
  name: insecure
  type: 8
  required: false
- display: Use system proxy settings
  name: proxy
  type: 8
  required: false
- display: Fetch incidents
  name: isFetch
  type: 8
  required: false
description: |
  Remediate your data security risks. Integrate with Prisma Cloud DSPM to fetch your data security risks and remediate them with OOTB playbooks.
display: Prisma Cloud DSPM
name: DSPM
script:
  commands:
  - arguments:
    - description: 'List of rule names'
      isArray: true
      isOptional: true
      name: ruleNameIn
      required: false
      secret: false
    - description: 'Exact rule name'
      isArray: false
      isOptional: true
      name: ruleNameEqual
      required: false
      secret: false
    - description: 'List of DSPM tag keys'
      isArray: true
      isOptional: true
      name: dspmTagKeyIn
      required: false
      secret: false
    - description: 'Exact DSPM tag key'
      isArray: false
      isOptional: true
      name: dspmTagKeyEqual
      required: false
      secret: false
    - description: 'List of DSPM tag values'
      isArray: true
      isOptional: true
      name: dspmTagValueIn
      required: false
      secret: false
    - description: 'Exact DSPM tag value'
      isArray: false
      isOptional: true
      name: dspmTagValueEqual
      required: false
      secret: false
    - description: 'List of project IDs'
      isArray: true
      isOptional: true
      name: projectIdIn
      required: false
      secret: false
    - description: 'Exact project ID'
      isArray: false
      isOptional: true
      name: projectIdEqual
      required: false
      secret: false
    - description: 'List of cloud providers ["AWS", "AZURE", "GCP", "SNOWFLAKE", "FILE_SHARE", "O365"]'
      isArray: false
      isOptional: true
      name: cloudProviderIn
      required: false
      secret: false
    - description: 'Exact cloud provider ["AWS", "AZURE", "GCP", "SNOWFLAKE", "FILE_SHARE", "O365"]'
      isArray: false
      isOptional: true
      name: cloudProviderEqual
      required: false
      secret: false
    - description: 'List of affects ["SECURITY", "COMPLIANCE", "GOVERNANCE", "SECURITY_AND_COMPLIANCE", "SECURITY_AND_GOVERNANCE", "COMPLIANCE_AND_GOVERNANCE","SECURITY_AND_COMPLIANCE_AND_GOVERNANCE"]'
      isArray: true
      isOptional: true
      name: affectsIn
      required: false
      secret: false
    - description: 'Exact affect ["SECURITY", "COMPLIANCE", "GOVERNANCE", "SECURITY_AND_COMPLIANCE", "SECURITY_AND_GOVERNANCE", "COMPLIANCE_AND_GOVERNANCE","SECURITY_AND_COMPLIANCE_AND_GOVERNANCE"]'
      isArray: false
      isOptional: true
      name: affectsEqual
      required: false
      secret: false
    - description: 'List of statuses ["OPEN", "CLOSED", "UNIMPORTANT", "WRONG", "HANDLED", "INVESTIGATING"]'
      isArray: true
      isOptional: true
      name: statusIn
      required: false
      secret: false
    - description: 'Exact status ["OPEN", "CLOSED", "UNIMPORTANT", "WRONG", "HANDLED", "INVESTIGATING"]'
      isArray: false
      isOptional: true
      name: statusEqual
      required: false
      secret: false
    - description: 'Sort order'
      isArray: false
      isOptional: true
      name: sort
      required: false
      secret: false
    description: Retrieves risk findings matching the input criteria.
    name: dspm-get-risk-findings
    outputs:
    - contextPath: DSPM.RiskFindings
      description: List of risk findings matching the input criteria.
      type: String
  - arguments:
    - description: ID of the risk for which to retrieve details.
      name: finding_id
      required: true
    description: Retrieves the details of a risk for the provided risk ID.
    name: dspm-get-risk-finding-by-id
    outputs:
    - contextPath: DSPM.RiskFinding
      description: Details of the risk finding for the provided ID.
      type: String
  - arguments:
    - description: List of regions (comma separated values)
      isArray: false
      isOptional: true
      name: regionIn
      required: false
      secret: false
    - description: Exact region
      isArray: false
      isOptional: true
      name: regionEqual
      required: false
      secret: false
    - description: 'List of cloud providers ["AWS", "AZURE", "GCP", "SNOWFLAKE",
      "FILE_SHARE", "O365"] (comma separated values)'
      isArray: false
      isOptional: true
      name: cloudProviderIn
      required: false
      secret: false
    - description: 'Exact cloud provider ["AWS", "AZURE", "GCP", "SNOWFLAKE",
      "FILE_SHARE", "O365"]'
      isArray: false
      isOptional: true
      name: cloudProviderEqual
      required: false
      secret: false
    - description: List of Service Types (comma separated values)
      isArray: false
      isOptional: true
      name: serviceTypeIn
      required: false
      secret: false
    - description: Exact Service Type
      isArray: false
      isOptional: true
      name: serviceTypeEqual
      required: false
      secret: false
    - description: List of Life Cycles egs.['RUNNING', 'STOPPED', 'DELETED'](comma separated values)
      isArray: false
      isOptional: true
      name: lifecycleIn
      required: false
      secret: false
    - description: Exact Life Cycle ['RUNNING', 'STOPPED', 'DELETED']
      isArray: false
      isOptional: true
      name: lifecycleEqual
      required: false
      secret: false
    - description: 'Sorting criteria in the format: property,(asc|desc). Default sort
      order is ascending. Multiple sort criteria are supported.'
      isArray: false
      isOptional: true
      name: sort
      required: false
      secret: false
    description: Retrieves a list of assets for the company.
    name: dspm-get-list-of-assets
    outputs:
    - contextPath: DSPM.Assets
      description: List of assets for the company.
      type: String
  - arguments:
    - description: ID of the asset for which to retrieve details.
      name: asset_id
      required: true
    description: Retrieves details for the specified asset ID.
    name: dspm-get-asset-details
    outputs:
    - contextPath: DSPM.AssetDetails
      description: Details of the asset for the provided ID.
      type: String
  - arguments:
    - description: ID of the asset for which to retrieve file details.
      name: asset_id
      required: true
    description: Retrieves file details for the specified asset ID.
    name: dspm-get-asset-files-by-id
    outputs:
    - contextPath: DSPM.AssetFiles
      description: File Details of the asset for the provided ID.
      type: String
  - arguments:
    name: dspm-get-data-types
    outputs:
    - contextPath: DSPM.DataTypes
      description: List of data types for company.
      type: String
  - arguments:
    - description: List of regions (comma-separated values)
      isArray: false
      isOptional: true
      name: regionIn
      required: false
      secret: false
    - description: Exact region
      isArray: false
      isOptional: true
      name: regionEqual
      required: false
      secret: false
    - description: 'List of cloud providers ["AWS", "AZURE", "GCP", "SNOWFLAKE", "FILE_SHARE", "O365"]'
      isArray: false
      isOptional: true
      name: cloudProviderIn
      required: false
      secret: false
    - description: 'Exact cloud provider ["AWS", "AZURE", "GCP", "SNOWFLAKE",
      "FILE_SHARE", "O365"]'
      isArray: false
      isOptional: true
      name: cloudProviderEqual
      required: false
      secret: false
    - description: List of Service Types (comma separated values)
      isArray: false
      isOptional: true
      name: serviceTypeIn
      required: false
      secret: false
    - description: Exact Service Type
      isArray: false
      isOptional: true
      name: serviceTypeEqual
      required: false
      secret: false
    - description: List of Life Cycles (comma separated values)
      isArray: false
      isOptional: true
      name: lifecycleIn
      required: false
      secret: false
    - description: 'List of project IDs'
      isArray: true
      isOptional: true
      name: projectIdIn
      required: false
      secret: false
    - description: 'Exact project ID'
      isArray: false
      isOptional: true
      name: projectIdEqual
      required: false
      secret: false
    - description: Exact Life Cycle
      isArray: false
      isOptional: true
      name: lifecycleEqual
      required: false
      secret: false
    - description: 'Sorting criteria in the format: property,(asc|desc). Default sort
      order is ascending. Multiple sort criteria are supported.'
      isArray: false
      isOptional: true
      name: sort
      required: false
      secret: false
    description: Retrieves a list of data type findings for the company.
    name: dspm-get-data-types-findings
    outputs:
    - contextPath: DSPM.DataTypeFindings
      description: List of data type findings for the company.
      type: String
  # - arguments: []
  #   description: for testing the fetch-handle method.
  #   name: fetch-incidents
  - arguments: []
    description: Retrieves integration configuration.
    name: dspm-get-integration-config
    outputs:
    - contextPath: DSPM.configs
      description: Integration configuration values.
      type: String
  - arguments:
    - description: 'Risk Finding ID'
      isArray: false
      isOptional: false
      name: riskFindingId
      required: true
    - description: Updated Status.
      isArray: false
      isOptional: false
      name: status
      required: true
    description: Updates the status of a risk finding.
    name: dspm-update-risk-finding-status
    outputs:
      - contextPath: DSPM.RiskFindingStatusUpdate
        description: The updated risk finding.
        type: String
  - arguments:
    - description: 'Exact detection time (equals)'
      isArray: false
      isOptional: true
      name: detectionTimeEquals
      required: false
      secret: false
    - description: 'Detection time (greater than or equal)'
      isArray: false
      isOptional: true
      name: detectionTimeGreaterThanOrEqual
      required: false
      secret: false
    - description: 'Detection time (greater than)'
      isArray: false
      isOptional: true
      name: detectionTimeGreaterThan
      required: false
      secret: false
    - description: 'Detection time (less than or equal)'
      isArray: false
      isOptional: true
      name: detectionTimeLessThanOrEqual
      required: false
      secret: false
    - description: 'Detection time (less than)'
      isArray: false
      isOptional: true
      name: detectionTimeLessThan
      required: false
      secret: false
    - description: 'List of policy names'
      isArray: true
      isOptional: true
      name: policyNameIn
      required: false
      secret: false
    - description: 'Exact policy name'
      isArray: false
      isOptional: true
      name: policyNameEquals
      required: false
      secret: false
    - description: 'List of asset names'
      isArray: true
      isOptional: true
      name: assetNameIn
      required: false
      secret: false
    - description: 'Exact asset name'
      isArray: false
      isOptional: true
      name: assetNameEquals
      required: false
      secret: false
    - description: 'List of cloud providers ["AWS", "AZURE", "GCP", "SNOWFLAKE", "FILE_SHARE", "O365"]'
      isArray: true
      isOptional: true
      name: cloudProviderIn
      required: false
      secret: false
    - description: 'Exact cloud provider ["AWS", "AZURE", "GCP", "SNOWFLAKE", "FILE_SHARE", "O365"]'
      isArray: false
      isOptional: true
      name: cloudProviderEquals
      required: false
      secret: false
    - description: 'List of destination project vendor names'
      isArray: true
      isOptional: true
      name: destinationProjectVendorNameIn
      required: false
      secret: false
    - description: 'Exact destination project vendor name'
      isArray: false
      isOptional: true
      name: destinationProjectVendorNameEquals
      required: false
      secret: false
    - description: 'List of cloud environments ["UNKNOWN", "DEVELOPMENT", "STAGING", "TESTING", "PRODUCTION"]'
      isArray: true
      isOptional: true
      name: cloudEnvironmentIn
      required: false
      secret: false
    - description: 'Exact cloud environment ["UNKNOWN", "DEVELOPMENT", "STAGING", "TESTING", "PRODUCTION"]'
      isArray: false
      isOptional: true
      name: cloudEnvironmentEquals
      required: false
      secret: false
    - description: 'List of policy severities ["HIGH", "MEDIUM", "LOW"]'
      isArray: true
      isOptional: true
      name: policySeverityIn
      required: false
      secret: false
    - description: 'Exact policy severity ["HIGH", "MEDIUM", "LOW"]'
      isArray: false
      isOptional: true
      name: policySeverityEquals
      required: false
      secret: false
    - description: 'List of category types ["FIRST_MOVE", "ATTACK", "COMPLIANCE", "ASSET_AT_RISK", "RECONNAISSANCE"]'
      isArray: true
      isOptional: true
      name: categoryTypeIn
      required: false
      secret: false
    - description: 'Exact category type ["FIRST_MOVE", "ATTACK", "COMPLIANCE", "ASSET_AT_RISK", "RECONNAISSANCE"]'
      isArray: false
      isOptional: true
      name: categoryTypeEquals
      required: false
      secret: false
    - description: 'List of statuses ["OPEN", "UNIMPORTANT", "WRONG", "HANDLED", "INVESTIGATING"]'
      isArray: true
      isOptional: true
      name: statusIn
      required: false
      secret: false
    - description: 'Exact status ["OPEN", "UNIMPORTANT", "WRONG", "HANDLED", "INVESTIGATING"]'
      isArray: false
      isOptional: true
      name: statusEquals
      required: false
      secret: false
    - description: 'Sort order (property,asc|desc)'
      isArray: false
      isOptional: true
      name: sort
      required: false
      secret: false
    description: Fetch list of alerts.
    name: dspm-get-list-of-alerts
    outputs:
    - contextPath: DSPM.Alerts
      description: List of DSPM alerts.
      type: String

  runonce: false
  script: '-'
  type: python
  subtype: python3
  dockerimage: demisto/python3:3.10.12.63474
  isfetch: true
  ismappable: true
  isremotesyncin: true
  isremotesyncout: true
fromversion: '6.12'
tests:
- No tests (auto formatted)
