category: Network Security
commonfields:
  id: DSPM
  version: -1
configuration:
- defaultvalue: https://api.dig.security/
  display: Your DSPM server URL
  name: dspmBaseUrl
  required: true
  type: 0
- displaypassword: API Key
  additionalinfo: The API Key to use for connection
  name: dspmApiKey
  required: true
  hiddenusername: true
  type: 9
- display: Your Jira server URL
  name: jiraServerUrl
  required: true
  type: 0
- display: Your Jira user name (email).
  name: jiraEmail
  required: true
  type: 0
- displaypassword: API Token
  additionalinfo: The API Token to use for jira connection
  name: jiraApiToken
  required: true
  hiddenusername: true
  type: 9
- display: Azure Storage Account name
  name: azureStorageName
  required: true
  type: 0
- displaypassword: Azure Storage Shared Key
  additionalinfo: The Shared API Key that is available in Azure Storage Account
  name: azureSharedKey
  required: true
  hiddenusername: true
  type: 9
- display: GCP Service Account JSON
  name: serviceAccountJson
  required: true
  type: 0
- display: Lifetime for slack notification ( in hours)
  name: slackMsgLifetime
  required: true
  defaultvalue: 2
  type: 0
- display: Trust any certificate (not secure)
  name: insecure
  type: 8
  required: false
- display: Use system proxy settings
  name: proxy
  type: 8
  required: false
- display: Fetch incidents
  name: isFetch
  type: 8
  required: false
description: |
  This integration fetches risk findings from Dig Security, allowing users to monitor and manage security risks identified by Dig Security in their cloud environments.
display: DSPM
name: DSPM
script:
  commands:
  - arguments:
    - description: 'List of rule names'
      isArray: true
      isOptional: true
      name: ruleNameIn
      required: false
      secret: false
    - description: 'Exact rule name'
      isArray: false
      isOptional: true
      name: ruleNameEqual
      required: false
      secret: false
    - description: 'List of DSPM tag keys'
      isArray: true
      isOptional: true
      name: dspmTagKeyIn
      required: false
      secret: false
    - description: 'Exact DSPM tag key'
      isArray: false
      isOptional: true
      name: dspmTagKeyEqual
      required: false
      secret: false
    - description: 'List of DSPM tag values'
      isArray: true
      isOptional: true
      name: dspmTagValueIn
      required: false
      secret: false
    - description: 'Exact DSPM tag value'
      isArray: false
      isOptional: true
      name: dspmTagValueEqual
      required: false
      secret: false
    - description: 'List of project IDs'
      isArray: true
      isOptional: true
      name: projectIdIn
      required: false
      secret: false
    - description: 'Exact project ID'
      isArray: false
      isOptional: true
      name: projectIdEqual
      required: false
      secret: false
    - description: 'List of cloud providers ["AWS", "AZURE", "GCP", "SNOWFLAKE", "FILE_SHARE", "O365"]'
      isArray: false
      isOptional: true
      name: cloudProviderIn
      required: false
      secret: false
    - description: 'Exact cloud provider ["AWS", "AZURE", "GCP", "SNOWFLAKE", "FILE_SHARE", "O365"]'
      isArray: false
      isOptional: true
      name: cloudProviderEqual
      required: false
      secret: false
    - description: 'List of affects ["SECURITY", "COMPLIANCE", "GOVERNANCE", "SECURITY_AND_COMPLIANCE", "SECURITY_AND_GOVERNANCE", "COMPLIANCE_AND_GOVERNANCE","SECURITY_AND_COMPLIANCE_AND_GOVERNANCE"]'
      isArray: true
      isOptional: true
      name: affectsIn
      required: false
      secret: false
    - description: 'Exact affect ["SECURITY", "COMPLIANCE", "GOVERNANCE", "SECURITY_AND_COMPLIANCE", "SECURITY_AND_GOVERNANCE", "COMPLIANCE_AND_GOVERNANCE","SECURITY_AND_COMPLIANCE_AND_GOVERNANCE"]'
      isArray: false
      isOptional: true
      name: affectsEqual
      required: false
      secret: false
    - description: 'List of statuses ["OPEN", "CLOSED", "UNIMPORTANT", "WRONG", "HANDLED", "INVESTIGATING"]'
      isArray: true
      isOptional: true
      name: statusIn
      required: false
      secret: false
    - description: 'Exact status ["OPEN", "CLOSED", "UNIMPORTANT", "WRONG", "HANDLED", "INVESTIGATING"]'
      isArray: false
      isOptional: true
      name: statusEqual
      required: false
      secret: false
    - description: 'Sort order'
      isArray: false
      isOptional: true
      name: sort
      required: false
      secret: false
    description: Retrieves risk findings matching the input criteria.
    name: dspm-get-risk-findings
    outputs:
    - contextPath: DSPM.RiskFindings
      description: List of risk findings matching the input criteria.
      type: String
  - arguments:
    - description: ID of the risk to retrieve details for.
      name: finding_id
      required: true
    description: Retrieves risk details for the provided risk ID.
    name: dspm-get-risk-finding-by-id
    outputs:
    - contextPath: DSPM.RiskFinding
      description: Details of the risk finding for the provided ID.
      type: String
  - arguments:
    - description: List of regions (comma separated values)
      isArray: false
      isOptional: true
      name: regionIn
      required: false
      secret: false
    - description: Exact region
      isArray: false
      isOptional: true
      name: regionEqual
      required: false
      secret: false
    - description: 'List of cloud providers ["AWS", "AZURE", "GCP", "SNOWFLAKE",
      "FILE_SHARE", "O365"] (comma separated values)'
      isArray: false
      isOptional: true
      name: cloudProviderIn
      required: false
      secret: false
    - description: 'Exact cloud provider ["AWS", "AZURE", "GCP", "SNOWFLAKE",
      "FILE_SHARE", "O365"]'
      isArray: false
      isOptional: true
      name: cloudProviderEqual
      required: false
      secret: false
    - description: List of Service Types (comma separated values)
      isArray: false
      isOptional: true
      name: serviceTypeIn
      required: false
      secret: false
    - description: Exact Service Type
      isArray: false
      isOptional: true
      name: serviceTypeEqual
      required: false
      secret: false
    - description: List of Life Cycles egs.['RUNNING', 'STOPPED', 'DELETED'](comma separated values)
      isArray: false
      isOptional: true
      name: lifecycleIn
      required: false
      secret: false
    - description: Exact Life Cycle ['RUNNING', 'STOPPED', 'DELETED']
      isArray: false
      isOptional: true
      name: lifecycleEqual
      required: false
      secret: false
    - description: 'Sorting criteria in the format: property,(asc|desc). Default sort
      order is ascending. Multiple sort criteria are supported.'
      isArray: false
      isOptional: true
      name: sort
      required: false
      secret: false
    description: for retrieve list of assets for company.
    name: dspm-get-list-of-assets
    outputs:
    - contextPath: DSPM.Assets
      description: List of assets for company.
      type: String
  - arguments:
    - description: ID of the asset to retrieve details for.
      name: asset_id
      required: true
    description: Retrieves asset details for the provided asset ID.
    name: dspm-get-asset-details
    outputs:
    - contextPath: DSPM.AssetDetails
      description: Details of the asset for the provided ID.
      type: String
  - arguments:
    - description: ID of the asset to retrieve details for.
      name: asset_id
      required: true
    description: Retrieves asset file details for the provided asset ID.
    name: dspm-get-asset-files-by-id
    outputs:
    - contextPath: DSPM.AssetFiles
      description: File Details of the asset for the provided ID.
      type: String
  - arguments:
    name: dspm-get-data-types
    outputs:
    - contextPath: DSPM.DataTypes
      description: List of data types for company.
      type: String
  - arguments:
    - description: List of regions (comma separated values)
      isArray: false
      isOptional: true
      name: regionIn
      required: false
      secret: false
    - description: Exact region
      isArray: false
      isOptional: true
      name: regionEqual
      required: false
      secret: false
    - description: 'List of cloud providers ["AWS", "AZURE", "GCP", "SNOWFLAKE", "FILE_SHARE", "O365"]'
      isArray: false
      isOptional: true
      name: cloudProviderIn
      required: false
      secret: false
    - description: 'Exact cloud provider ["AWS", "AZURE", "GCP", "SNOWFLAKE",
      "FILE_SHARE", "O365"]'
      isArray: false
      isOptional: true
      name: cloudProviderEqual
      required: false
      secret: false
    - description: List of Service Types (comma separated values)
      isArray: false
      isOptional: true
      name: serviceTypeIn
      required: false
      secret: false
    - description: Exact Service Type
      isArray: false
      isOptional: true
      name: serviceTypeEqual
      required: false
      secret: false
    - description: List of Life Cycles (comma separated values)
      isArray: false
      isOptional: true
      name: lifecycleIn
      required: false
      secret: false
    - description: 'List of project IDs'
      isArray: true
      isOptional: true
      name: projectIdIn
      required: false
      secret: false
    - description: 'Exact project ID'
      isArray: false
      isOptional: true
      name: projectIdEqual
      required: false
      secret: false
    - description: Exact Life Cycle
      isArray: false
      isOptional: true
      name: lifecycleEqual
      required: false
      secret: false
    - description: 'Sorting criteria in the format: property,(asc|desc). Default sort
      order is ascending. Multiple sort criteria are supported.'
      isArray: false
      isOptional: true
      name: sort
      required: false
      secret: false
    description: for retrieve list of data type findings for company.
    name: dspm-get-data-types-findings
    outputs:
    - contextPath: DSPM.DataTypeFindings
      description: List of data type findings for company.
      type: String
  - arguments: []
    description: for testing the fetch-handle method.
    name: fetch-incidents
  - arguments: []
    description: for getting integration config.
    name: dspm-get-integration-cofig
    outputs:
    - contextPath: DSPM.configs
      description: Integration configuration values.
      type: String
  - name: dspm-get-lifetime-for-slack
    arguments: []
    description: waiting time for user response
  - arguments:
    - description: 'Risk Finding ID'
      isArray: false
      isOptional: false
      name: riskFindingId
      required: true
    - description: Updated Status.
      isArray: false
      isOptional: false
      name: status
      required: true
    description: Updates the status of a risk finding.
    name: dspm-update-risk-finding-status
    outputs:
      - contextPath: DSPM.RiskFindingStatusUpdate
        description: The updated risk finding.
        type: String
  runonce: false
  script: '-'
  type: python
  subtype: python3
  dockerimage: demisto/python3:3.10.12.63474
  isfetch: true
  ismappable: true
  isremotesyncin: true
  isremotesyncout: true
fromversion: '6.12'
tests:
- No tests (auto formatted)
defaultclassifier: DSPM Classifier
# defaultmapperin: DSPM Incoming Mapper
