id: PAN-OS EDL Service Configuration
version: -1
name: PAN-OS EDL Service Configuration
description: "This single-run playbook enables Cortex XSOAR built-in External Dynamic\
  \ List (EDL) as a service for the system indicators, configures PAN-OS EDL Objects\
  \ and the respective firewall policy rules.\nThe EDLs will continuously update for\
  \ each indicator that matches the query syntax inputted in the playbook\n(in order\
  \ to validate to which indicators the query applied, you need to enter the query\
  \ syntax from the indicator tab at the top of the playbook inputs window as well).\
  \ \nIf both the IP and URL indicator types exist in the query, it sorts the indicators\
  \ into two EDLs, IP and URL. If only one indicator type exists in the query, only\
  \ one EDL is created. \nThe playbook then creates EDL objects directing to the indicator\
  \ lists and firewall policy rules in PAN-OS. \n- It is recommended to configure\
  \ a dedicated EDL Service instance for the usage of this playbook.\n- In case it\
  \ is needed to edit or update the EDL query after this playbook run, use the panorama-edit-edl\
  \ command and panorama integration to update the URL containing the indicator query\
  \ syntax."
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 9edd9420-7ba1-417d-8786-d374de036f8b
    type: start
    task:
      id: 9edd9420-7ba1-417d-8786-d374de036f8b
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 0,
          "y": -170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "1":
    id: "1"
    taskid: cbb882b1-9b9d-458c-819f-dff32f04f636
    type: condition
    task:
      id: cbb882b1-9b9d-458c-819f-dff32f04f636
      version: -1
      name: Is PAN-OS integration enabled?
      description: Checks if there is an active instance of the PAN-OS integration
        enabled.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "48"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: modules
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: modules.brand
                      iscontext: true
                    right:
                      value:
                        simple: Panorama
                - - operator: isEqualString
                    left:
                      value:
                        simple: modules.state
                      iscontext: true
                    right:
                      value:
                        simple: active
                accessor: brand
            iscontext: true
    view: |-
      {
        "position": {
          "x": 0,
          "y": -10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "3":
    id: "3"
    taskid: 398f7d3c-0ea3-4892-8f5e-842bb8b34b81
    type: title
    task:
      id: 398f7d3c-0ea3-4892-8f5e-842bb8b34b81
      version: -1
      name: Completed
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "92"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 0,
          "y": 5280
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "23":
    id: "23"
    taskid: 13a42428-391d-4e93-8e04-0f617ada87f1
    type: condition
    task:
      id: 13a42428-391d-4e93-8e04-0f617ada87f1
      version: -1
      name: Is auto-commit defined?
      description: Checks if the values provided in the arguments are equal. If either
        of the arguments are missing, "no" is returned.
      scriptName: AreValuesEqual
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "no":
      - "27"
      "yes":
      - "83"
    scriptarguments:
      left:
        complex:
          root: inputs.AutoCommit
      right:
        simple: "Yes"
    results:
    - AreValuesEqual
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 700,
          "y": 4375
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "27":
    id: "27"
    taskid: 87523ff1-b99b-4ce3-8f01-8de8b2c81014
    type: regular
    task:
      id: 87523ff1-b99b-4ce3-8f01-8de8b2c81014
      version: -1
      name: Manually commit
      description: Allows the analyst to manually commit the changes. This option
        is available when auto-commit is "false".
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "73"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 930,
          "y": 4550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "41":
    id: "41"
    taskid: e25b762e-c8cc-4d52-8ed0-737e6269d4c8
    type: playbook
    task:
      id: e25b762e-c8cc-4d52-8ed0-737e6269d4c8
      version: -1
      name: PAN-OS - Create Or Edit EDL Rule
      description: Creates or edits a Panorama rule and moves it into the desired
        position
      playbookName: PAN-OS - Create Or Edit EDL Rule
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "66"
    scriptarguments:
      action-type:
        complex:
          root: inputs.ActionType
      device-group:
        complex:
          root: inputs.DeviceGroup
      element-to-add:
        simple: ${inputs.ip-edl-object-name}-ip-edl-object
      inbound-or-outbound-rule:
        complex:
          root: inputs.inbound-or-outbound-rule
      log-forwarding-object-name:
        complex:
          root: inputs.log-forwarding-object-name
      pre-post-rulebase:
        complex:
          root: inputs.pre-post-rulebase
      relative-rule-name:
        complex:
          root: inputs.relative-rule-name
      rule-position:
        complex:
          root: inputs.RulePosition
      rule_name:
        complex:
          root: inputs.ip-edl-object-name
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 460,
          "y": 4075
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "42":
    id: "42"
    taskid: 773a65ab-4656-492f-83fa-169d354c3d78
    type: condition
    task:
      id: 773a65ab-4656-492f-83fa-169d354c3d78
      version: -1
      name: Is auto-commit defined?
      description: Checks if the values provided in the arguments are equal. If either
        of the arguments are missing, "no" is returned.
      scriptName: AreValuesEqual
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "no":
      - "44"
      "yes":
      - "82"
    scriptarguments:
      left:
        complex:
          root: inputs.AutoCommit
      right:
        simple: "Yes"
    results:
    - AreValuesEqual
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 700,
          "y": 2705
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "44":
    id: "44"
    taskid: 3484662e-0fc7-4dd8-808e-0dd708d54786
    type: regular
    task:
      id: 3484662e-0fc7-4dd8-808e-0dd708d54786
      version: -1
      name: Manually commit
      description: Allows the analyst to manually commit the changes. This option
        is available when auto-commit is "false".
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "77"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 930,
          "y": 2880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "48":
    id: "48"
    taskid: 7d1c025a-47ec-4672-853a-7cf2ba1959e1
    type: condition
    task:
      id: 7d1c025a-47ec-4672-853a-7cf2ba1959e1
      version: -1
      name: Is PAN-OS EDL Service integration enabled?
      description: Checks if there is an active instance of the PAN-OS EDL Management
        integration enabled.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "73"
      - "3"
      "yes":
      - "68"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: modules
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: modules.brand
                      iscontext: true
                    right:
                      value:
                        simple: EDL
                - - operator: isEqualString
                    left:
                      value:
                        simple: modules.state
                      iscontext: true
                    right:
                      value:
                        simple: active
                accessor: brand
            iscontext: true
    view: |-
      {
        "position": {
          "x": 690,
          "y": 170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "50":
    id: "50"
    taskid: b6a798b4-c9d7-40a2-857b-ff668bd8ee54
    type: regular
    task:
      id: b6a798b4-c9d7-40a2-857b-ff668bd8ee54
      version: -1
      name: Get IP EDL Object from Panorama
      description: Returns information for an external dynamic list
      script: '|||panorama-get-edl'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "51"
    scriptarguments:
      device-group: {}
      name:
        simple: ${inputs.ip-edl-object-name}-ip-edl-object
    continueonerror: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "51":
    id: "51"
    taskid: 77f1d56a-dab1-4735-894a-9b74d89dce12
    type: condition
    task:
      id: 77f1d56a-dab1-4735-894a-9b74d89dce12
      version: -1
      name: Is there an existing IP EDL object?
      description: Checks if an external file exists on the web server.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "64"
      "yes":
      - "3"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsString
          left:
            value:
              simple: Panorama.EDL.Name
            iscontext: true
          right:
            value:
              complex:
                root: inputs.ip-edl-object-name
            iscontext: true
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "52":
    id: "52"
    taskid: 56a78384-6db3-441f-8862-6b159bdb84c9
    type: regular
    task:
      id: 56a78384-6db3-441f-8862-6b159bdb84c9
      version: -1
      name: Create IP EDL Object access by instance name
      description: Creates an external dynamic list in PAN-OS and connects it to the
        external file.
      script: '|||panorama-create-edl'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "65"
    scriptarguments:
      certificate_profile: {}
      description: {}
      device-group:
        complex:
          root: inputs.device-group
      name:
        simple: ${inputs.ip-edl-object-name}-ip-edl-object
      recurring:
        simple: five-minute
      type:
        simple: ip
      url:
        simple: ${inputs.EDLServiceURL}/instance/execute/${inputs.InstanceName}?q=${inputs.IndicatorQuery}
          and type:ip
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "61":
    id: "61"
    taskid: 749d78da-ff92-4f17-84ab-42989269b34c
    type: regular
    task:
      id: 749d78da-ff92-4f17-84ab-42989269b34c
      version: -1
      name: Create URL EDL Object access by instance name
      description: Creates an external dynamic list in PAN-OS and connects it to the
        external file.
      script: '|||panorama-create-edl'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "65"
    scriptarguments:
      certificate_profile: {}
      description: {}
      device-group:
        complex:
          root: inputs.device-group
      name:
        simple: ${inputs.url-edl-object-name}-url-edl-object
      recurring:
        simple: five-minute
      type:
        simple: url
      url:
        simple: ${inputs.EDLServiceURL}/instance/execute/${inputs.InstanceName}?q=${inputs.IndicatorQuery}
          and type:url
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 940,
          "y": 2390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "62":
    id: "62"
    taskid: 97dd487b-d16a-4c93-8844-e6c7c4bfd717
    type: title
    task:
      id: 97dd487b-d16a-4c93-8844-e6c7c4bfd717
      version: -1
      name: 'IP EDL Verification '
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "50"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1260
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "64":
    id: "64"
    taskid: 57080b60-0f02-4ec8-8d77-9006ec610c0e
    type: title
    task:
      id: 57080b60-0f02-4ec8-8d77-9006ec610c0e
      version: -1
      name: Create IP EDL Objects
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "84"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1940
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "65":
    id: "65"
    taskid: 827f0a03-795a-4e69-846f-f27316107a46
    type: title
    task:
      id: 827f0a03-795a-4e69-846f-f27316107a46
      version: -1
      name: Commit EDL Objects
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "42"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 700,
          "y": 2560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "66":
    id: "66"
    taskid: c92d77ee-cf4e-49cf-8e40-67c289686b26
    type: title
    task:
      id: c92d77ee-cf4e-49cf-8e40-67c289686b26
      version: -1
      name: Commit EDL Rules
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "23"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 700,
          "y": 4250
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "68":
    id: "68"
    taskid: 84d55fa6-b3df-4436-8e9d-4cab3c59c3fc
    type: title
    task:
      id: 84d55fa6-b3df-4436-8e9d-4cab3c59c3fc
      version: -1
      name: Validate Indicator query input
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "95"
      - "94"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 690,
          "y": 680
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "73":
    id: "73"
    taskid: b9ce9be5-965a-4685-84dd-e804bf53eefc
    type: title
    task:
      id: b9ce9be5-965a-4685-84dd-e804bf53eefc
      version: -1
      name: Completed
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "92"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1410,
          "y": 5270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "74":
    id: "74"
    taskid: 82061b2b-2e6b-4486-840e-b3e55d8ab19e
    type: regular
    task:
      id: 82061b2b-2e6b-4486-840e-b3e55d8ab19e
      version: -1
      name: Get URL EDL Object from Panorama
      description: Returns information for an external dynamic list
      script: '|||panorama-get-edl'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "75"
    scriptarguments:
      device-group: {}
      name:
        simple: ${inputs.url-edl-object-name}-url-edl-object
    continueonerror: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 940,
          "y": 1380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "75":
    id: "75"
    taskid: 346287b1-6e2d-4115-80ca-b32c2f5fa7b0
    type: condition
    task:
      id: 346287b1-6e2d-4115-80ca-b32c2f5fa7b0
      version: -1
      name: Is there an existing URL EDL object?
      description: Checks if an external file exists on the web server.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "90"
      "yes":
      - "73"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsString
          left:
            value:
              simple: Panorama.EDL.Name
            iscontext: true
          right:
            value:
              complex:
                root: inputs.url-edl-object-name
            iscontext: true
    view: |-
      {
        "position": {
          "x": 940,
          "y": 1550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "76":
    id: "76"
    taskid: 0ebcc259-4dc2-4e98-892a-3ab27b61d7e2
    type: playbook
    task:
      id: 0ebcc259-4dc2-4e98-892a-3ab27b61d7e2
      version: -1
      name: PAN-OS - Create Or Edit EDL Rule
      description: Creates or edits a Panorama rule and moves it into the desired
        position
      playbookName: PAN-OS - Create Or Edit EDL Rule
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "66"
    scriptarguments:
      action-type:
        complex:
          root: inputs.ActionType
      device-group:
        complex:
          root: inputs.DeviceGroup
      element-to-add:
        simple: ${inputs.url-edl-object-name}-url-edl-object
      inbound-or-outbound-rule:
        complex:
          root: inputs.inbound-or-outbound-rule
      log-forwarding-object-name:
        complex:
          root: inputs.log-forwarding-object-name
      pre-post-rulebase:
        complex:
          root: inputs.pre-post-rulebase
      relative-rule-name:
        complex:
          root: inputs.relative-rule-name
      rule-position:
        complex:
          root: inputs.RulePosition
      rule_name:
        complex:
          root: inputs.url-edl-object-name
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 930,
          "y": 4075
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "77":
    id: "77"
    taskid: 6d225a43-6892-4e86-8fbf-58babb50c2b4
    type: title
    task:
      id: 6d225a43-6892-4e86-8fbf-58babb50c2b4
      version: -1
      name: Create EDL Rules
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "101"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 700,
          "y": 3060
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "82":
    id: "82"
    taskid: a8f5c310-eebd-4926-8a0b-c8449f6e4612
    type: playbook
    task:
      id: a8f5c310-eebd-4926-8a0b-c8449f6e4612
      version: -1
      name: PAN-OS Commit Configuration
      description: Commit the PAN-OS Panorama or Firewall configuration.\nIf specified
        as Panorama, it also pushes the Policies to the specified Device Group in
        the instance.
      playbookName: PAN-OS Commit Configuration
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "77"
    separatecontext: true
    view: |-
      {
        "position": {
          "x": 460,
          "y": 2880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "83":
    id: "83"
    taskid: b7eb0f26-4319-4bd9-881e-ab2fd673cdc0
    type: playbook
    task:
      id: b7eb0f26-4319-4bd9-881e-ab2fd673cdc0
      version: -1
      name: PAN-OS Commit Configuration
      description: Commit the PAN-OS Panorama or Firewall configuration.\nIf specified
        as Panorama, it also pushes the Policies to the specified Device Group in
        the instance.
      playbookName: PAN-OS Commit Configuration
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "99"
    separatecontext: true
    view: |-
      {
        "position": {
          "x": 460,
          "y": 4550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "84":
    id: "84"
    taskid: 7c25d760-4f1c-40ae-824d-04d8d88af923
    type: condition
    task:
      id: 7c25d760-4f1c-40ae-824d-04d8d88af923
      version: -1
      name: Verify access method to the EDL Service
      description: ''''''
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      Instance Name:
      - "52"
      Port:
      - "85"
    separatecontext: false
    conditions:
    - label: Port
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: inputs.InstancePort
            iscontext: true
    - label: Instance Name
      condition:
      - - operator: isEmpty
          left:
            value:
              complex:
                root: inputs.InstancePort
            iscontext: true
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "85":
    id: "85"
    taskid: 42bae9b9-6d44-4fed-8953-a9696c9c1841
    type: regular
    task:
      id: 42bae9b9-6d44-4fed-8953-a9696c9c1841
      version: -1
      name: Create IP EDL Object access by port
      description: Creates an external dynamic list in PAN-OS and connects it to the
        external file.
      script: '|||panorama-create-edl'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "87"
    scriptarguments:
      certificate_profile: {}
      description: {}
      device-group:
        complex:
          root: inputs.device-group
      name:
        simple: ${inputs.ip-edl-object-name}-ip-edl-object
      recurring:
        simple: five-minute
      type:
        simple: ip
      url:
        simple: ${inputs.EDLServiceURL}:${inputs.InstancePort}/?q=${inputs.IndicatorQuery}
          and type:ip
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 220,
          "y": 2240
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "86":
    id: "86"
    taskid: c31b19b1-e743-4795-8b98-02230c2429fb
    type: regular
    task:
      id: c31b19b1-e743-4795-8b98-02230c2429fb
      version: -1
      name: Create URL EDL Object access by port
      description: Creates an external dynamic list in PAN-OS and connects it to the
        external file.
      script: '|||panorama-create-edl'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "88"
    scriptarguments:
      certificate_profile: {}
      description: {}
      device-group:
        complex:
          root: inputs.device-group
      name:
        simple: ${inputs.url-edl-object-name}-url-edl-object
      recurring:
        simple: five-minute
      type:
        simple: url
      url:
        simple: ${inputs.EDLServiceURL}:${inputs.InstancePort}/?q=${inputs.IndicatorQuery}
          and type:url
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1200,
          "y": 2250
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "87":
    id: "87"
    taskid: 75edd5e3-ce38-47db-85e1-3db899f2300e
    type: title
    task:
      id: 75edd5e3-ce38-47db-85e1-3db899f2300e
      version: -1
      name: Commit EDL Objects
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "42"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 220,
          "y": 2560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "88":
    id: "88"
    taskid: 15c84ed1-be9c-4b10-8616-8d225960b1fd
    type: title
    task:
      id: 15c84ed1-be9c-4b10-8616-8d225960b1fd
      version: -1
      name: Commit EDL Objects
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "42"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1200,
          "y": 2560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "89":
    id: "89"
    taskid: 05b9e750-9888-4372-8f00-77f65e117da4
    type: condition
    task:
      id: 05b9e750-9888-4372-8f00-77f65e117da4
      version: -1
      name: Verify access method to the EDL Service
      description: ''''''
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      Instance Name:
      - "61"
      Port:
      - "86"
    separatecontext: false
    conditions:
    - label: Port
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: inputs.InstancePort
            iscontext: true
    - label: Instance Name
      condition:
      - - operator: isEmpty
          left:
            value:
              complex:
                root: inputs.InstancePort
            iscontext: true
    view: |-
      {
        "position": {
          "x": 940,
          "y": 2070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "90":
    id: "90"
    taskid: e58e5b26-a02c-4d7a-8f2b-f83aefb816cc
    type: title
    task:
      id: e58e5b26-a02c-4d7a-8f2b-f83aefb816cc
      version: -1
      name: Create URL EDL Object
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "89"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 940,
          "y": 1940
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "91":
    id: "91"
    taskid: f5d663ea-1195-432f-8de6-6ad23dca1b7b
    type: title
    task:
      id: f5d663ea-1195-432f-8de6-6ad23dca1b7b
      version: -1
      name: URL EDL Verification
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "74"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 940,
          "y": 1260
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "92":
    id: "92"
    taskid: f6c70049-279b-4f27-80e6-66224f75237f
    type: title
    task:
      id: f6c70049-279b-4f27-80e6-66224f75237f
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 700,
          "y": 5420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "94":
    id: "94"
    taskid: f895aad3-c8a5-47e0-8df8-ca752842144e
    type: condition
    task:
      id: f895aad3-c8a5-47e0-8df8-ca752842144e
      version: -1
      name: Validate if IP indicator exists
      description: ''''''
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "62"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: playbookQuery.indicator_type
            iscontext: true
          right:
            value:
              simple: IP
    view: |-
      {
        "position": {
          "x": 480,
          "y": 820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "95":
    id: "95"
    taskid: 0a7b8987-8223-4a95-84a3-306342c0f477
    type: condition
    task:
      id: 0a7b8987-8223-4a95-84a3-306342c0f477
      version: -1
      name: Validate if URL indicator exists
      description: ''''''
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "73"
      "yes":
      - "91"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: playbookQuery.indicator_type
            iscontext: true
          right:
            value:
              simple: URL
    view: |-
      {
        "position": {
          "x": 940,
          "y": 820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "97":
    id: "97"
    taskid: 48c80ba0-22ab-4799-89ef-87f928f25a8b
    type: condition
    task:
      id: 48c80ba0-22ab-4799-89ef-87f928f25a8b
      version: -1
      name: Validate if URL indicator exists
      description: ''''''
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "73"
      "yes":
      - "103"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: playbookQuery.indicator_type
            iscontext: true
          right:
            value:
              simple: URL
    view: |-
      {
        "position": {
          "x": 930,
          "y": 3360
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "98":
    id: "98"
    taskid: 43876073-c20c-4c8e-801b-755fcf69703d
    type: condition
    task:
      id: 43876073-c20c-4c8e-801b-755fcf69703d
      version: -1
      name: Validate if IP indicator exists
      description: ''''''
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "102"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: playbookQuery.indicator_type
            iscontext: true
          right:
            value:
              simple: IP
    view: |-
      {
        "position": {
          "x": 460,
          "y": 3360
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "99":
    id: "99"
    taskid: 1872af34-6acc-4175-8327-df6c4fceb8ca
    type: condition
    task:
      id: 1872af34-6acc-4175-8327-df6c4fceb8ca
      version: -1
      name: Are there any EDL commit/push warnings?
      description: ''''''
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "100"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsString
          left:
            value:
              simple: ${Panorama.Commit.Warnings}
            iscontext: true
          right:
            value:
              simple: ${inputs.ip-edl-object-name}
            iscontext: true
        - operator: containsString
          left:
            value:
              simple: ${Panorama.Commit.Warnings}
            iscontext: true
          right:
            value:
              simple: ${inputs.url-edl-object-name}
            iscontext: true
        - operator: containsString
          left:
            value:
              simple: ${Panorama.Push.Warnings}
            iscontext: true
          right:
            value:
              simple: ${inputs.ip-edl-object-name}
            iscontext: true
        - operator: containsString
          left:
            value:
              simple: ${Panorama.Push.Warnings}
            iscontext: true
          right:
            value:
              simple: ${inputs.url-edl-object-name}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 460,
          "y": 4720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "100":
    id: "100"
    taskid: 7a315d01-963e-42bc-8e07-2448c1d11a07
    type: regular
    task:
      id: 7a315d01-963e-42bc-8e07-2448c1d11a07
      version: -1
      name: Manually debug EDL warning
      description: |-
        An EDL commit warning can be caused by an environment issue or a bad playbook input. Please review the warnings and Check the following:
        1. Playbook inputs
            1. EDLServiceURL - Verify Input is correct.
        2. Possible environment issues
            1. The EDL Service server is not accessible from PAN-OS
            2. Network Permissions
            3. The URL entered on the EDL object has a typo, spaces, etc.
            4. EDL Objects canâ€™t handle redirects
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 460,
          "y": 5110
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "101":
    id: "101"
    taskid: 06eafab3-697c-4ec4-8a9e-c68325f60d34
    type: regular
    task:
      id: 06eafab3-697c-4ec4-8a9e-c68325f60d34
      version: -1
      name: List PAN-OS rules
      description: Returns a list of predefined Security Rules.
      script: '|||panorama-list-rules'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "98"
      - "97"
    scriptarguments:
      device-group: {}
      pre_post:
        simple: pre-rulebase
      tag: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 700,
          "y": 3190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "102":
    id: "102"
    taskid: c0cc8141-9634-4b33-8dce-de4fb500ff68
    type: condition
    task:
      id: c0cc8141-9634-4b33-8dce-de4fb500ff68
      version: -1
      name: Is there an existing IP EDL security rule?
      description: ''''''
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "41"
      "yes":
      - "3"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Panorama.SecurityRule.Name
            iscontext: true
          right:
            value:
              simple: inputs.ip-edl-object-name
            iscontext: true
    view: |-
      {
        "position": {
          "x": 460,
          "y": 3730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "103":
    id: "103"
    taskid: 4e2525f9-49a2-47e9-847a-029a2d82fa57
    type: condition
    task:
      id: 4e2525f9-49a2-47e9-847a-029a2d82fa57
      version: -1
      name: Is there an existing URL EDL security rule?
      description: ''''''
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "76"
      "yes":
      - "73"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Panorama.SecurityRule.Name
            iscontext: true
          right:
            value:
              simple: inputs.url-edl-object-name
            iscontext: true
    view: |-
      {
        "position": {
          "x": 930,
          "y": 3730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
view: |-
  {
    "linkLabelsPosition": {
      "102_3_yes": 0.1,
      "103_73_yes": 0.1,
      "1_3_#default#": 0.1,
      "1_48_yes": 0.35,
      "23_27_no": 0.74,
      "42_44_no": 0.73,
      "48_3_#default#": 0.11,
      "48_68_yes": 0.56,
      "48_73_#default#": 0.11,
      "51_3_yes": 0.11,
      "51_64_#default#": 0.74,
      "75_73_yes": 0.1,
      "84_52_Instance Name": 0.6,
      "89_61_Instance Name": 0.61,
      "94_3_#default#": 0.11,
      "94_62_yes": 0.68,
      "95_73_#default#": 0.1,
      "95_91_yes": 0.68,
      "97_73_#default#": 0.15,
      "98_3_#default#": 0.16,
      "99_100_yes": 0.53,
      "99_3_#default#": 0.2
    },
    "paper": {
      "dimensions": {
        "height": 5655,
        "width": 1790,
        "x": 0,
        "y": -170
      }
    }
  }
inputs:
- key: ip-edl-object-name
  value:
    simple: IP EDL Rule Validation
  required: false
  description: Set a name for the EDL object that will be configured on pan-os. This
    value is used to set the rule name as well.
  playbookInputQuery:
- key: url-edl-object-name
  value:
    simple: URL EDL Rule Validation
  required: false
  description: Set a name for the EDL object that will be configured on pan-os. This
    value is used to set the rule name as well.
  playbookInputQuery:
- key: EDLServiceURL
  value:
    simple: http://ec2-52-213-240-199.eu-west-1.compute.amazonaws.com
  required: false
  description: "The EDL service provides serval access methods to the EDL instance.\
    \ By default, it uses a unique port, configured in the EDL Service integration,\
    \ and an HTTP session. It is possible to either configure a certificate for the\
    \ default option or to access the EDL by instance name, which is HTTPS by default.\n\
    Please refer to the EDL Service integration tip for more information.\nEDLServiceURL\
    \ input Examples: \n  1. if not configured with a certificate -  http://cortex-xsoar_address\n\
    \  2. if configured with a certificate - https://cortex-xsoar_address\n\n* Depending\
    \ on the access method to the EDL, the full URL of the EDL is constructed from\
    \ this input, and by InstanceName OR by InstacePort and IndicatorQuery. The playbook\
    \ identifies which access method is used from the playbook inputs and crafts the\
    \ correct URL address.\nFull constructed URL examples:\n1. by port  - \n${EDLServiceURL}:${InstancePort}/${IndicatorQuery}\n\
    2. By Instance Name - \n${EDLServiceURL}:${InstanceName}/${IndicatorQuery}\n "
  playbookInputQuery:
- key: InstanceName
  value: {}
  required: false
  description: "Name of the instance as configured in EDL Service integration. \n\
    Only needed when accessing EDL Service by instance name.\nRefer to the EDL Service\
    \ integration tip for more information."
  playbookInputQuery:
- key: InstancePort
  value:
    simple: "1000"
  required: false
  description: |-
    Instance name port as configured in EDL Service integration.
    Only needed when accessing EDL Service by URL and Port.
    Refer to the EDL Service integration tip for more information.
  playbookInputQuery:
- key: IndicatorQuery
  value:
    simple: reputation:bad
  required: false
  description: |-
    The query to run to create the EDL.
    When no query is entered, EDLs will contain all IP and URL indicators.
    The query should be inserted in the indicators tab(top of this input window) so the playbook can query and validate the indicator types and create only the relevant EDL objects and rules.
  playbookInputQuery:
- key: AutoCommit
  value:
    simple: "Yes"
  required: false
  description: |-
    This input establishes whether to commit the configuration automatically.
    Yes - Commit automatically.
    No - Commit manually.
  playbookInputQuery:
- key: RulePosition
  value:
    simple: top
  required: false
  description: |-
    The position of the rule in the ruleset. Valid values are:
      * top
      * bottom
      * before
      * after

    The default position is 'top'
  playbookInputQuery:
- key: ActionType
  value:
    simple: drop
  required: false
  description: |
    The action that will be defined in the rule:
    allow/deny/drop
  playbookInputQuery:
- key: inbound-or-outbound-rule
  value:
    simple: outbound
  required: false
  description: Determines if the rule is inbound or outbound.
  playbookInputQuery:
- key: pre-post-rulebase
  value:
    simple: pre-rulebase
  required: false
  description: Either pre-rulebase or post-rulebase,  according to the rule structure.
  playbookInputQuery:
- key: DeviceGroup
  value: {}
  required: false
  description: The device group to work on. Exists only in panorama!
  playbookInputQuery:
- key: LogForwarding
  value: {}
  required: false
  description: Log Forwarding object name.
  playbookInputQuery:
- key: relative-rule-name
  value: {}
  required: false
  description: If the rule-position that is chosen is before or after, specify the
    rule name to which it is related.
  playbookInputQuery:
- key: ""
  value: {}
  required: false
  description: ""
  playbookInputQuery:
    query: reputation:bad
    queryEntity: indicators
    results:
    daterange:
      fromdate: 0001-01-01T00:00:00Z
      todate: 0001-01-01T00:00:00Z
      period:
        by: ""
        byto: ""
        byfrom: ""
        tovalue:
        fromvalue:
        field: ""
      fromdatelicenseval: 0001-01-01T00:00:00Z
    runFromLastJobTime: true
outputs:
- contextPath: Panorama.EDL.Name
  description: Name of theEDL.
quiet: true
fromversion: 5.5.0
tests:
- No tests (auto formatted)
