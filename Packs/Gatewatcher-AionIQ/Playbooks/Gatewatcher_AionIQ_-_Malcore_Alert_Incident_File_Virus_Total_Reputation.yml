id: dbfca3e5-2386-4d2c-8868-9ab98ec5bb8c
version: 5
contentitemexportablefields:
  contentitemfields:
    packID: ""
    itemVersion: 1.3.0
    fromServerVersion: 6.5.0
    toServerVersion: ""
    definitionid: ""
vcShouldKeepItemLegacyProdMachine: false
name: Gatewatcher AionIQ - Malcore Alert Incident File Virus Total Reputation
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 86555362-4158-4946-8b02-e591bd7bc3b9
    type: start
    task:
      id: 86555362-4158-4946-8b02-e591bd7bc3b9
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 440,
          "y": -100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: cc64688c-9f7a-4e3f-8c83-7fa86b53d7d0
    type: regular
    task:
      id: cc64688c-9f7a-4e3f-8c83-7fa86b53d7d0
      version: -1
      name: Get Malcore Alerts Files
      description: Get a file attached to an alert with its UUID
      script: GCenter 103|||gcenter103-raw-alerts-file-get
      type: regular
      iscommand: true
      brand: GCenter 103
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      uuid:
        simple: ${incident.uuid}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 640,
          "y": 220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: aca57436-8fdb-4161-8efe-f613c1f4a41a
    type: regular
    task:
      id: aca57436-8fdb-4161-8efe-f613c1f4a41a
      version: -1
      name: Unzip Malcore File
      description: Unzip a file using fileName or entryID to specify a file. Unzipped
        files will be loaded to the War Room and names will be put into the context.
      scriptName: UnzipFile
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      fileName:
        complex:
          root: File
          filters:
          - - operator: isNotEmpty
              left:
                value:
                  simple: File.Name
                iscontext: true
          transformers:
          - operator: LastArrayElement
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 640,
          "y": 390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 70d6f7f6-9bb0-4373-895b-c714e761ffa5
    type: regular
    task:
      id: 70d6f7f6-9bb0-4373-895b-c714e761ffa5
      version: -1
      name: Check Malcore File SHA256 on Virus Total
      description: Checks the file reputation of the specified hash.
      script: VirusTotal|||file
      type: regular
      iscommand: true
      brand: VirusTotal
    scriptarguments:
      file:
        simple: ${File.SHA256}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 640,
          "y": 560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: 2a49df55-cbbd-4109-8ed2-f25f3da45cc8
    type: condition
    task:
      id: 2a49df55-cbbd-4109-8ed2-f25f3da45cc8
      version: -1
      name: Is VirusTotal installed?
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      scriptName: Exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "no":
      - "10"
      "yes":
      - "6"
    scriptarguments:
      value:
        simple: ${modules.brand}=="VirusTotal"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 440,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: a7298345-40ae-4520-87cb-19f23e71af12
    type: regular
    task:
      id: a7298345-40ae-4520-87cb-19f23e71af12
      version: -1
      name: VirusTotal is missing
      description: Prints text to war room (Markdown supported)
      scriptName: Print
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      value:
        simple: VirusTotal is missing
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 230,
          "y": 220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 755,
        "width": 790,
        "x": 230,
        "y": -100
      }
    }
  }
inputs:
- key: Gatewatcher Malcore Incident
  value:
    simple: ${incident}
  required: false
  description: ""
  playbookInputQuery: null
outputs: []
