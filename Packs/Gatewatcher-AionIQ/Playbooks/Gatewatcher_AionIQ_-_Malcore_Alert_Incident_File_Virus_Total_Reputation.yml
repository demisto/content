id: dde79c86-9114-4312-8990-943064f129e8
version: 95
vcShouldKeepItemLegacyProdMachine: false
name: Gatewatcher AionIQ - Malcore Alert Incident File Virus Total Reputation
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 86555362-4158-4946-8b02-e591bd7bc3b9
    type: start
    task:
      id: 86555362-4158-4946-8b02-e591bd7bc3b9
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: bb86993b-f891-4f21-80fa-0106b22cf3fa
    type: condition
    task:
      id: bb86993b-f891-4f21-80fa-0106b22cf3fa
      version: -1
      name: Is GCenter103 installed?
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      scriptName: Exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "no":
      - "4"
      "yes":
      - "9"
    scriptarguments:
      value:
        simple: ${modules.brand}=="GCenter103"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 476235e3-5737-4973-8497-389526fc7f5e
    type: regular
    task:
      id: 476235e3-5737-4973-8497-389526fc7f5e
      version: -1
      name: GCenter103 is missing
      description: Prints text to war room (Markdown supported)
      scriptName: Print
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      value:
        simple: GCenter103 is missing
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 240,
          "y": 365
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: cc64688c-9f7a-4e3f-8c83-7fa86b53d7d0
    type: regular
    task:
      id: cc64688c-9f7a-4e3f-8c83-7fa86b53d7d0
      version: -1
      name: Get Malcore Alerts Files
      description: Get a file attached to an alert with its UUID
      script: GCenter 103|||gcenter103-raw-alerts-file-get
      type: regular
      iscommand: true
      brand: GCenter 103
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      uuid:
        simple: ${incident.uuid}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 670,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: 058e13fd-0545-41c1-8c8a-3c0586d7ed6d
    type: regular
    task:
      id: 058e13fd-0545-41c1-8c8a-3c0586d7ed6d
      version: -1
      name: Unzip Malcore File
      description: Unzip a file using fileName or entryID to specify a file. Unzipped
        files will be loaded to the War Room and names will be put into the context.
      scriptName: UnzipFile
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      lastZipFileInWarroom:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 670,
          "y": 730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 8cf589b5-610b-4872-8c2b-2978b952360a
    type: regular
    task:
      id: 8cf589b5-610b-4872-8c2b-2978b952360a
      version: -1
      name: Check Malcore File SHA256 on Virus Total
      description: Checks the file reputation of the specified hash.
      script: VirusTotal (API v3)|||file
      type: regular
      iscommand: true
      brand: VirusTotal (API v3)
    scriptarguments:
      file:
        simple: ${File.SHA256}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 670,
          "y": 900
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: 2a49df55-cbbd-4109-8ed2-f25f3da45cc8
    type: condition
    task:
      id: 2a49df55-cbbd-4109-8ed2-f25f3da45cc8
      version: -1
      name: Is VirusTotal installed?
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      scriptName: Exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "no":
      - "10"
      "yes":
      - "6"
    scriptarguments:
      value:
        simple: ${modules.brand}=="VirusTotal"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 670,
          "y": 365
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: a7298345-40ae-4520-87cb-19f23e71af12
    type: regular
    task:
      id: a7298345-40ae-4520-87cb-19f23e71af12
      version: -1
      name: VirusTotal is missing
      description: Prints text to war room (Markdown supported)
      scriptName: Print
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      value:
        simple: VirusTotal is missing
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 240,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 945,
        "width": 810,
        "x": 240,
        "y": 50
      }
    }
  }
inputs:
- key: MalcoreIncident
  value:
    complex:
      root: incident.gatewatchereventmodule
      filters:
      - - operator: isEqualString
          left:
            value:
              simple: incident.gatewatchereventmodule
            iscontext: true
          right:
            value:
              simple: malcore
  required: false
  description: ""
  playbookInputQuery: null
outputs: []
