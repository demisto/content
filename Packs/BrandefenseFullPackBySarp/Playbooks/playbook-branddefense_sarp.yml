contentitemexportablefields:
  contentitemfields:
    propagationLabels:
    - all
id: branddefense_sarp
inputs: []
name: branddefense_sarp
outputs: []
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 23189fad-687d-4aee-82b7-db1cb1354a2e
      iscommand: false
      name: ""
      version: -1
      description: ''
    taskid: 23189fad-687d-4aee-82b7-db1cb1354a2e
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 2150,
          "y": -220
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bc926982-b61d-4ea7-872d-b02adf9b4f5e
      iscommand: false
      name: Get all assets
      scriptName: branddefense_getassets
      type: regular
      version: -1
    taskid: bc926982-b61d-4ea7-872d-b02adf9b4f5e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1430,
          "y": 320
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      assetid:
        simple: ${branddefense_assets.assets.results.[0].id}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 00255604-3fa5-4482-8554-f8f9f15e9141
      iscommand: false
      name: Get Details for a specific asset
      scriptName: branddefense_get_specific_asset
      type: regular
      version: -1
    taskid: 00255604-3fa5-4482-8554-f8f9f15e9141
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1430,
          "y": 560
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c141c81e-33a2-4ad0-8ad9-9537e5b48e2f
      iscommand: false
      name: Get Asset Information
      type: title
      version: -1
      description: ''
    taskid: c141c81e-33a2-4ad0-8ad9-9537e5b48e2f
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -1430,
          "y": 100
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8d5200d0-067b-4f0a-8054-58b5495b91da
      iscommand: false
      name: Branddefense Get All Audit Logs
      scriptName: branddefense_get_audit_logs
      type: regular
      version: -1
    taskid: 8d5200d0-067b-4f0a-8054-58b5495b91da
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -920,
          "y": 310
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      audit_log_id:
        simple: ${branddefense_audit_logs.auditlogs.results.[0].id}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9b3f40e4-bbb0-47df-8de2-338736a38e26
      iscommand: false
      name: Get Specified Audit Log
      scriptName: branddefense_get_specific_audit_log
      type: regular
      version: -1
    taskid: 9b3f40e4-bbb0-47df-8de2-338736a38e26
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -920,
          "y": 545
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a528ea2b-80e4-4417-8267-927c05071b1b
      iscommand: false
      name: Get Audit Logs Information
      type: title
      version: -1
      description: ''
    taskid: a528ea2b-80e4-4417-8267-927c05071b1b
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -920,
          "y": 100
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 99093d40-d196-478a-869d-ac5c8b058bf4
      iscommand: false
      name: Branddefense Get Compromised Devices
      scriptName: branddefense_get_compromised_device
      type: regular
      version: -1
    taskid: 99093d40-d196-478a-869d-ac5c8b058bf4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -410,
          "y": 310
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 02bb6697-19ff-4e5f-8af8-805f5664ac73
      iscommand: false
      name: Branddefense Get Compromised Devices
      type: title
      version: -1
      description: ''
    taskid: 02bb6697-19ff-4e5f-8af8-805f5664ac73
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -410,
          "y": 100
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: google.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Create Threat Search endpoint allows you to post indicator of compromises to investigate suspicious/malicious IP, Domain, URL address or Hash values.
      id: 1f6fde05-9afb-4130-8c3f-8041f5533c14
      iscommand: false
      name: Create Threat Search
      scriptName: branddefense_create_threat_search
      type: regular
      version: -1
    taskid: 1f6fde05-9afb-4130-8c3f-8041f5533c14
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 100,
          "y": 300
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 09abe590-4d76-4112-8595-3f6fbc300258
      iscommand: false
      name: Branddefense Create Threat Search (Buraya Qradar vs. bulunan bir değer girilip sorgu atılabilir)
      type: title
      version: -1
      description: ''
    taskid: 09abe590-4d76-4112-8595-3f6fbc300258
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 100,
          "y": 100
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      search_uuid:
        simple: ${search_start.sarch_created.uuid}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 08eaa17f-856e-4826-8f48-6b50e4363679
      iscommand: false
      name: Get Threat Search Results
      scriptName: branddefense_get_threat_search
      type: regular
      version: -1
    taskid: 08eaa17f-856e-4826-8f48-6b50e4363679
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 100,
          "y": 530
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 78099d7c-ecc9-4bd2-887f-67c46d3edd6a
      iscommand: false
      name: Branddefense Incidents
      type: title
      version: -1
      description: ''
    taskid: 78099d7c-ecc9-4bd2-887f-67c46d3edd6a
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 600,
          "y": 100
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "14"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1dc4fb23-3bd2-49ef-80ac-7f351b4e3684
      iscommand: false
      name: Branddefense Get Incidents
      scriptName: branddefense_get_incidents
      type: regular
      version: -1
    taskid: 1dc4fb23-3bd2-49ef-80ac-7f351b4e3684
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 600,
          "y": 300
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      incident_code:
        simple: ${branddefense_all_incidents.branddefense_incidents.results.[0].code}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6d4914d3-ee05-469c-8d98-4d4f962e1e5e
      iscommand: false
      name: Branddefense Get Specific Incident
      scriptName: branddefense_get_specific_incident
      type: regular
      version: -1
    taskid: 6d4914d3-ee05-469c-8d98-4d4f962e1e5e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 600,
          "y": 520
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      incident_code:
        simple: ${branddefense_all_incidents.branddefense_incidents.results.[0].code}
      incident_status:
        simple: ${Please update the incident status of Branddefense accordingly.Answers.0}
      inident_status:
        simple: OPEN
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d5cadb17-ead3-487f-8142-cef4283ce7a9
      iscommand: false
      name: Branddefense Change Incident Status
      scriptName: branddefense_change_incident_status
      type: regular
      version: -1
    taskid: d5cadb17-ead3-487f-8142-cef4283ce7a9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 600,
          "y": 1120
        }
      }
  "16":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: 'What Should be the status of the selected incident? Incident Code to be updated: ${branddefense_all_incidents.branddefense_incidents.results.[0].code}'
        options: []
        optionsarg:
        - simple: OPEN
        - simple: IN_PROGRESS
        - simple: CLOSED
        - simple: RISK_ACCEPTED
        - simple: REJECTED
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: singleSelect
      sender: ""
      title: Please update the incident status of Branddefense accordingly based on the information about the incident and it's indicators.
      totalanswers: 0
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc:
      body:
      cc:
      format: ""
      methods: []
      subject:
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to:
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e51da326-6693-45b5-8264-10b282d28e6e
      iscommand: false
      name: Update the status of Branddefense's Incident
      type: collection
      version: -1
    taskid: e51da326-6693-45b5-8264-10b282d28e6e
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 600,
          "y": 910
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      incident_code:
        simple: ${branddefense_all_incidents.branddefense_incidents.results.[3].code}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3862ddcb-c51c-4479-80d1-93a33fb59c67
      iscommand: false
      name: Branddefense Get Indicators about an Incident
      scriptName: branddefense_get_incident_indicators
      type: regular
      version: -1
    taskid: 3862ddcb-c51c-4479-80d1-93a33fb59c67
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 600,
          "y": 680
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 210cecb6-5352-48fe-8b68-b2b0e0f631b8
      iscommand: false
      name: Branddefense Indicators
      type: title
      version: -1
      description: ''
    taskid: 210cecb6-5352-48fe-8b68-b2b0e0f631b8
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1120,
          "y": 100
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7be3ca41-a184-4575-896c-440e889185fa
      iscommand: false
      name: Branddefense Get Indicators
      scriptName: branddefense_get_indicators
      type: regular
      version: -1
    taskid: 7be3ca41-a184-4575-896c-440e889185fa
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1120,
          "y": 290
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      ioc_type:
        simple: hash
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f683923e-30f6-4d8d-89e5-3ff03908be17
      iscommand: false
      name: Branddefense Get IOC
      scriptName: branddefense_get_ioc
      type: regular
      version: -1
    taskid: f683923e-30f6-4d8d-89e5-3ff03908be17
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1650,
          "y": 290
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: dd35828b-7f3d-400f-8b82-2c2545400e6d
      iscommand: false
      name: Branddefense Get IOC
      type: title
      version: -1
      description: ''
    taskid: dd35828b-7f3d-400f-8b82-2c2545400e6d
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1650,
          "y": 100
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1435,
        "width": 3960,
        "x": -1430,
        "y": -220
      }
    }
  }
tests:
- No tests (auto formatted)
fromversion: 6.0.0
