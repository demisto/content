contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: a3acf260-148d-4af7-81ab-49744965d264
    propagationLabels:
    - all
    toServerVersion: ""
description: Retrieves all the details of the PAN-OS Platform and topology.
id: PAN-OS Network Operations - Platform Management
inputs:
- description: If set, completes the given task in the parent playbook. Used to ensure
    that the parent does not continue until this incident is finished processing.
  key: close_task_id
  playbookInputQuery: null
  required: false
  value: {}
- description: Incident that initiated this subplaybook, if any.
  key: parent_incident_id
  playbookInputQuery: null
  required: false
  value: {}
name: PAN-OS Network Operations - Platform Management
outputs:
- contextPath: PANOS.ShowSystemInfo.Result
  description: PANOS System Information
  type: unknown
- contextPath: PANOS.ShowArp.Result
  description: PANOS ARP Table Details
  type: unknown
- contextPath: PANOS.ShowRouteSummary.Summary
  description: PANOS Route table summary
  type: unknown
- contextPath: PANOS.ShowCounters.Result
  description: PANOS Global counters
  type: unknown
starttaskid: "0"
tasks:
  "0":
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: dd8bfbfc-bdc8-44e7-884f-90b21b40c0d8
      iscommand: false
      name: ""
      version: -1
    taskid: dd8bfbfc-bdc8-44e7-884f-90b21b40c0d8
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 490,
          "y": -560
        }
      }
  "1":
    fieldMapping:
    - incidentfield: PAN-OS Network Operations - System Info
      output:
        complex:
          accessor: Summary
          root: PANOS.ShowSystemInfo
          transformers:
          - operator: ConvertKeysToTableFieldFormat
    - incidentfield: PAN-OS Network Operations - System Info Result
      output:
        complex:
          accessor: Result
          root: PANOS.ShowSystemInfo
          transformers:
          - operator: ConvertKeysToTableFieldFormat
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "14"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Gets information from all PAN-OS systems in the topology.
      id: 621f5ea7-23bd-4942-8b78-59d31a85e43b
      iscommand: true
      name: Get System Information
      script: '|||pan-os-platform-get-system-info'
      type: regular
      version: -1
    taskid: 621f5ea7-23bd-4942-8b78-59d31a85e43b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 10,
          "y": 230
        }
      }
  "2":
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
      - "3"
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Delete field from context
      id: 25d6141d-203d-4203-89f5-12688e331629
      iscommand: false
      name: Delete Context
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: 25d6141d-203d-4203-89f5-12688e331629
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": 60
        }
      }
  "3":
    fieldMapping:
    - incidentfield: PAN-OS Network Operations - ARP Summary
      output:
        simple: ${PANOS.ShowArp.Summary}
    - incidentfield: PAN-OS Network Operations - ARP Table Result
      output:
        simple: ${PANOS.ShowArp.Result}
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "14"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Gets all arp tables from all firewalls in the topology.
      id: 38e80a91-e7bd-49fb-8849-a8cb8e37f7ec
      iscommand: true
      name: Get ARP Summary
      script: '|||pan-os-platform-get-arp-tables'
      type: regular
      version: -1
    taskid: 38e80a91-e7bd-49fb-8849-a8cb8e37f7ec
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": 230
        }
      }
  "4":
    fieldMapping:
    - incidentfield: PAN-OS Route Summary
      output:
        simple: ${PANOS.ShowRouteSummary.Summary}
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Pulls all route summary information from the topology
      id: 9ee416e8-2bb3-41d9-8a83-9c912a8c5f8e
      iscommand: true
      name: Get Route Summary
      script: '|||pan-os-platform-get-route-summary'
      type: regular
      version: -1
    taskid: 9ee416e8-2bb3-41d9-8a83-9c912a8c5f8e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 80,
          "y": 580
        }
      }
  "5":
    fieldMapping:
    - incidentfield: PAN-OS Network Operations - Global Counters
      output:
        simple: ${PANOS.ShowCounters.Summary}
    - incidentfield: PAN-OS Network Operations - Global Counters Result
      output:
        simple: ${PANOS.ShowCounters.Result}
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "14"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Gets global counter information from all the PAN-OS firewalls in
        the topology
      id: ddae5d13-e326-4068-8252-60981c6528fb
      iscommand: true
      name: Get Global Counters
      script: '|||pan-os-platform-get-global-counters'
      type: regular
      version: -1
    taskid: ddae5d13-e326-4068-8252-60981c6528fb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 910,
          "y": 230
        }
      }
  "6":
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 04489f39-37f7-41e2-81f7-7640adf16d2c
      iscommand: false
      name: Finish Information Gathering
      type: title
      version: -1
    taskid: 04489f39-37f7-41e2-81f7-7640adf16d2c
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 490,
          "y": 760
        }
      }
  "7":
    fieldMapping:
    - incidentfield: PAN-OS Routes
      output:
        complex:
          accessor: Summary
          root: PANOS.ShowRoute
          transformers:
          - operator: ConvertKeysToTableFieldFormat
    - incidentfield: PAN-OS Network Operations - Routes Result
      output:
        complex:
          accessor: Result
          root: PANOS.ShowRoute
          transformers:
          - operator: ConvertKeysToTableFieldFormat
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Pulls all route summary information from the topology
      id: 1d2cbcc0-dde3-4b07-840a-f606c1aa269f
      iscommand: true
      name: Get All Routes
      script: '|||pan-os-platform-get-routes'
      type: regular
      version: -1
    taskid: 1d2cbcc0-dde3-4b07-840a-f606c1aa269f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": 580
        }
      }
  "9":
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: fe34e134-5b9e-4f9b-8b02-90effd5d9474
      iscommand: false
      name: PAN-OS Network Operations - Incident Callback
      playbookId: PAN-OS Network Operations - Incident Callback
      type: playbook
      version: -1
    taskid: fe34e134-5b9e-4f9b-8b02-90effd5d9474
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 490,
          "y": 880
        }
      }
  "10":
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 28b8a448-adb0-4672-8fa0-b7a8b34c6533
      iscommand: false
      name: Create Device Specific Incidents
      type: title
      version: -1
    taskid: 28b8a448-adb0-4672-8fa0-b7a8b34c6533
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 490,
          "y": 1040
        }
      }
  "11":
    continueonerror: true
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      panosnetworkoperationsincidentdescription:
        simple: |-
          <h4>PAN-OS System/Platform Information</h4>
          This incident type collects runtime information from the PAN-OS platforms in the environment, including tabular information like routing and arp information.

          Various actions can be taken on the environment using the buttons within this incident layout, which will spawn and link additional incidents to this one.
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 4558d3a5-c361-49e1-8862-02a6a9fcec77
      iscommand: true
      name: Set Incident Type HTML
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 4558d3a5-c361-49e1-8862-02a6a9fcec77
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": -270
        }
      }
  "12":
    fieldMapping:
    - incidentfield: PAN-OS Network Operations - BGP Peers
      output:
        complex:
          accessor: Summary
          root: PANOS.ShowBGPPeers
          transformers:
          - operator: ConvertKeysToTableFieldFormat
    - incidentfield: PAN-OS Network Operations - BGP Peers Result
      output:
        complex:
          accessor: Result
          root: PANOS.ShowBGPPeers
          transformers:
          - operator: ConvertKeysToTableFieldFormat
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Retrieves all BGP peer information from the PAN-OS firewalls in
        the topology.
      id: 8e70740b-7b8c-4c2e-8810-8e0711914de9
      iscommand: true
      name: Get BGP Peers
      script: '|||pan-os-platform-get-bgp-peers'
      type: regular
      version: -1
    taskid: 8e70740b-7b8c-4c2e-8810-8e0711914de9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 920,
          "y": 580
        }
      }
  "13":
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      seconds:
        simple: "5"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sleep for X seconds
      id: 30aa587f-a839-42c6-85ac-9dc48365320e
      iscommand: false
      name: Sleep to ensure everything is caught up
      scriptName: Sleep
      type: regular
      version: -1
    taskid: 30aa587f-a839-42c6-85ac-9dc48365320e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": -430
        }
      }
  "14":
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
      - "7"
      - "12"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7de6c740-31cb-4fcb-879b-7b7b27adf2e5
      iscommand: false
      name: Get More data...
      type: title
      version: -1
    taskid: 7de6c740-31cb-4fcb-879b-7b7b27adf2e5
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 490,
          "y": 410
        }
      }
  "15":
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      target:
        simple: ${PANOS.ShowSystemInfo.Summary.hostid}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Creates, or updates existing device incidents.
      id: 0c0da9d3-cb09-4a2b-8d7b-61a1b8814e69
      iscommand: false
      name: Create Or Update Incidents
      scriptName: CreateOrUpdateDeviceIncident
      type: regular
      version: -1
    taskid: 0c0da9d3-cb09-4a2b-8d7b-61a1b8814e69
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": 1170
        }
      }
  "16":
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 51487703-e0ef-4ea5-8292-37ec9f6b4fa0
      iscommand: false
      name: Finish
      type: title
      version: -1
    taskid: 51487703-e0ef-4ea5-8292-37ec9f6b4fa0
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 490,
          "y": 1330
        }
      }
  "17":
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: 98ec50d8-1576-4f4c-8a43-7f32768bdde0
      iscommand: false
      name: Update Occurred Time
      playbookId: Update Occurred Time
      type: playbook
      version: -1
    taskid: 98ec50d8-1576-4f4c-8a43-7f32768bdde0
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 490,
          "y": -120
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1955,
        "width": 1290,
        "x": 10,
        "y": -560
      }
    }
  }
