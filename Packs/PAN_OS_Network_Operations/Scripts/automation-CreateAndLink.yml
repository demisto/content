args:
- description: New Incident Name
  name: name
  required: true
- description: New Incident type
  name: type
comment: Creates, and then links an incident.
commonfields:
  id: 9600a5c1-f987-4051-8bb8-7f51bd72e0fe
  version: -1
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: a3acf260-148d-4af7-81ab-49744965d264
    propagationLabels:
    - all
    toServerVersion: ""
dockerimage: demisto/python3:3.7.3.286
enabled: true
engineinfo: {}
mainengineinfo: {}
name: CreateAndLink
pswd: ""
runas: DBotWeakRole
runonce: false
script: |-
  incident = demisto.args()

  res = demisto.executeCommand("createNewIncident", incident)
  if isError(res[0]):
      raise DemistoException(f"Could not create new incident: {res}")

  created_incident = res[0]
  id = created_incident.get("EntryContext", dict()).get("CreatedIncidentID")

  res = demisto.executeCommand("linkIncidents", {"linkedIncidentIDs": id})
  if isError(res[0]):
      raise DemistoException(f"Could not create link incidents: {res}")

  return_results("Done!")
scripttarget: 0
subtype: python3
tags: []
type: python
