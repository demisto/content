category: Data Enrichment & Threat Intelligence
commonfields:
  id: McAfee Threat Intelligence Exchange V2
  version: -1
configuration:
- display: Broker CA certificates
  name: broker_ca_bundle
  required: true
  type: 12
  additionalinfo: From `brokercerts.crt` file.
- display: Client certificates
  name: cert_file
  required: true
  type: 12
  additionalinfo: From `client.crt` file.
- display: Client private key
  name: private_key
  required: true
  type: 14
  additionalinfo: From `client.key` file. Make sure that the type of
    the field is not `encrypted` when filling it out.
- display: Broker URLs
  name: broker_urls
  required: true
  type: 0
  additionalinfo: 'The format should be: [ssl://]<hostname>[:port]. Get
    the hostname and port from the `brokerlist.properties` file.
    The broker should be reachable from Demisto server.'
- additionalinfo: Reliability of the source providing the intelligence data.
  defaultvalue: C - Fairly reliable
  display: Source Reliability
  name: integrationReliability
  options:
  - A+ - 3rd party enrichment
  - A - Completely reliable
  - B - Usually reliable
  - C - Fairly reliable
  - D - Not usually reliable
  - E - Unreliable
  - F - Reliability cannot be judged
  required: false
  type: 15
- defaultvalue: indicatorType
  name: feedExpirationPolicy
  display: ''
  options:
  - never
  - interval
  - indicatorType
  - suddenDeath
  required: false
  type: 17
- defaultvalue: '20160'
  name: feedExpirationInterval
  display: ''
  required: false
  type: 1
description: Connect to McAfee TIE using the McAfee DXL client.
display: McAfee Threat Intelligence Exchange V2
name: McAfee Threat Intelligence Exchange V2
script:
  commands:
  - arguments:
    - default: true
      description: Hashes of the files to query. Supports "MD5", "SHA1", and "SHA256"
      isArray: false
      name: files
      required: true
      secret: false
    deprecated: false
    description: Retrieves the reputation for the specified hashes. Can be "MD5", "SHA1",
      or "SHA256".
    execution: false
    name: tie-files-reputation
    outputs:
    - contextPath: File.MD5
      description: ' The MD5 hash of the file.'
      type: String
    - contextPath: File.SHA1
      description: The SHA1 hash of the file.
      type: String
    - contextPath: File.SHA256
      description: The SHA256 hash of the file.
      type: String
    - contextPath: File.TrustLevel
      description: File lowest trust level.
      type: String
    - contextPath: File.Vendor
      description: The vendor that reported the file as malicious.
      type: String
    - contextPath: DBotScore.Score
      description: The actual score.
      type: Number
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: String
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: String
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: String
    - contextPath: File.Malicious.Description
      description: A description explaining why the file was determined to be malicious.
      type: String
    - contextPath: File.Malicious.Vendor
      description: The vendor that reported the file as malicious.
      type: String
    - contextPath: File.Malicious.Score
      description: The actual score.
      type: Number
  - arguments:
    - default: true
      description: Hashes of the files for which to set the reputation. Can be "MD5",
        "SHA1", or "SHA256".
      isArray: false
      name: files
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: The new trust level for the files.
      isArray: false
      name: trust_level
      predefined:
      - NOT_SET
      - KNOWN_MALICIOUS
      - MOST_LIKELY_MALICIOUS
      - MIGHT_BE_MALICIOUS
      - UNKNOWN
      - MIGHT_BE_TRUSTED
      - MOST_LIKELY_TRUSTED
      - KNOWN_TRUSTED
      - KNOWN_TRUSTED_INSTALLER
      required: true
      secret: false
    - default: false
      description: A file name to associate with the specified files.
      isArray: false
      name: filename
      required: false
      secret: false
    - default: false
      description: A comment to associate with the specified files.
      isArray: false
      name: comment
      required: false
      secret: false
    deprecated: false
    description: Sets the “Enterprise” reputation (trust level, filename, and comment) of the specified hashes.
      Hashes that represent the same file can have different "Enterprise" reputation if they are given different
      reputations.
      Permissions are required to invoke this method. See the 'How-to' in instance
      instruction.
    execution: false
    name: tie-set-files-reputation
  - arguments:
    - default: true
      description: 'Hashes of the files for which to search. Can be "MD5", "SHA1",
        or "SHA256".'
      isArray: false
      name: files
      required: true
      secret: false
    - default: false
      description: The maximum number of results to return. The default and maximum number
        is 500 results.
      isArray: false
      name: query_limit
      required: false
      secret: false
    deprecated: false
    description: Retrieves the set of systems which have referenced (typically executed)
      the specified hashes.
    execution: false
    name: tie-files-references
    outputs:
    - contextPath: File.Hashes.type
      description: The type of the hash.
      type: String
    - contextPath: File.Hashes.value
      description: The value of the hash.
      type: String
    - contextPath: McAfee.TIE.References.AgentGuid
      description: The GUID of the system that referenced the file.
      type: String
    - contextPath: McAfee.TIE.References.Date
      description: The time the system first referenced the file.
      type: String
  dockerimage: devdemisto/dxl:1.0.0.33137
  feed: false
  isfetch: false
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  subtype: python3
  type: python
tests:
- McAfee-TIE Test
fromversion: 5.0.0
