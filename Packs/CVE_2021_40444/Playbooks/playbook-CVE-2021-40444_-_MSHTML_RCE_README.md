CVE-2021-4044 refers to the MSHTML engine, that has been found vulnerable to arbitrary code execution by a specially crafted Microsoft Office document or rich text format file. 

Although there is no patch or effective mitigation available for this vulnerability, the playbook does provide several workarounds suggested by Microsoft.

Researchers have validated this attack triggered in Windows Explorer with “Preview Mode” enabled, even in just a rich-text format RTF file (not an Office file and without ActiveX). This indicates it can be exploited even without opening the file and this invalidates Microsoft’s workaround mitigation mentioned above.

This playbook should be trigger manually and includes the following tasks: 

* Collect related known indicators from several sources.
* Indicators, Files and Process creation patterns hunting using PAN-OS, Cortex XDR and SIEM products.
* Block indicators automatically or manually.
* Provide workarounds and detection capabilities.

More information:
[Microsoft MSHTML Remote Code Execution Vulnerability](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-40444)

Note: This is a beta playbook, which lets you implement and test pre-release software. Since the playbook is beta, it might contain bugs. Updates to the pack during the beta phase might include non-backward compatible features. We appreciate your feedback on the quality and usability of the pack to help us identify issues, fix them, and continually improve.


## Dependencies
This playbook uses the following sub-playbooks, integrations, and scripts.

### Sub-playbooks
* Palo Alto Networks - Hunting And Threat Detection
* Block Indicators - Generic v2
* Search Endpoints By Hash - Generic V2
* Splunk Indicator Hunting
* Endpoint Enrichment - Generic v2.1
* QRadar Indicator Hunting V2
* PAN-OS - Block Domain - External Dynamic List

### Integrations
This playbook does not use any integrations.

### Scripts
* ParseHTMLIndicators
* SearchIncidentsV2
* http

### Commands
* closeInvestigation
* linkIncidents
* associateIndicatorsToIncident
* extractIndicators
* splunk-search
* qradar-searches
* setIndicators

## Playbook Inputs
---

| **Name** | **Description** | **Default Value** | **Required** |
| --- | --- | --- | --- |
| YaraRulesSource | The source of the Yara rules | https://github.com/Neo23x0/signature-base/blob/master/yara/expl_cve_2021_40444.yar | Optional |
| SigmaRulesSource | The source of the Sigma rules | https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file_event/win_file_winword_cve_2021_40444.yml | Optional |
| SplunkEarliestTime | The earliest time for the Splunk search query. | -7d | Optional |
| QRadarTimeRange | The time range for the QRadar search query. | LAST 7 DAYS | Optional |
| BlockIndicatorsAutomatically | Whether to automatically block the indicators involved. | False | Optional |
| EDLDomainBlocklist | The name of the EDL Domain Blocklist. | Demisto Remediation - Domain EDL | Optional |

## Playbook Outputs
---
There are no outputs for this playbook.

## Playbook Image
---
![CVE-2021-40444 - MSHTML RCE](https://raw.githubusercontent.com/demisto/content/12c6b931d0eeea90fd9c84096b4645a36ae74e07/Packs/CVE_2021_40444/doc_files/CVE-2021-40444_-_MSHTML_RCE.png)