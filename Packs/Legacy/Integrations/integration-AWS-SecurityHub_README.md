<!-- HTML_DOC -->
<p>Use the AWS Security Hub integration to manage your high-priority security alerts and compliance status across AWS accounts.</p>
<h2>Configure AWS - Security Hub on Demisto</h2>
<ol>
<li>Navigate to <strong>Settings</strong> &gt; <strong>Integrations</strong> &gt; <strong>Servers &amp; Services</strong>.</li>
<li>Search for AWS - Security Hub.</li>
<li>Click <strong>Add instance</strong> to create and configure a new integration instance.<br>
<ul>
<li>
<strong>Name</strong>: a textual name for the integration instance.</li>
<li><strong>AWS Default Region</strong></li>
<li><strong>Role Arn</strong></li>
<li><strong>Fetch incidents</strong></li>
<li><strong>Incident type</strong></li>
<li><strong>Role Session Name</strong></li>
<li><strong>Role Session Duration</strong></li>
<li>
<strong>Security Hub Severity level</strong> (Low, Medium, High)</li>
<li>
<strong>Additional Filters</strong> (Link to Filters table section)</li>
<li><strong>Archive Findings after fetch</strong></li>
</ul>
</li>
<li>Click <strong>Test</strong> to validate the URLs, token, and connection.</li>
</ol>
<h2>Commands</h2>
<p>You can execute these commands from the Demisto CLI, as part of an automation, or in a playbook.<br>After you successfully execute a command, a DBot message appears in the War Room with the command details.</p>
<ol>
<li>Get a list of findings: aws-securityhub-get-findings</li>
<li>Get information for the master account: aws-securityhub-get-master-account</li>
<li>Get information for member accounts: aws-securityhub-list-members</li>
<li>Enable AWS Security Hub: aws-securityhub-enable-security-hub</li>
<li>Disable AWS Security Hub: aws-securityhub-disable-security-hub</li>
<li>Update the findings record state: aws-securityhub-update-finding</li>
</ol>
<h3>1. Get a list of findings</h3>
<hr>
<p>Lists and describes Security Hub-aggregated findings that are specified by filter attributes.</p>
<h5>Base Command</h5>
<p><code>aws-securityhub-get-findings</code></p>
<h5>Input</h5>
<table style="width: 749px;">
<thead>
<tr>
<th style="width: 153px;"><strong>Argument Name</strong></th>
<th style="width: 511px;"><strong>Description</strong></th>
<th style="width: 76px;"><strong>Required</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="width: 153px;">filters</td>
<td style="width: 511px;">The filter to use. Usage: filter=name=,value=,comparison=&lt;EQUALS</td>
<td style="width: 76px;">CONTAINS</td>
</tr>
<tr>
<td style="width: 153px;">region</td>
<td style="width: 511px;">The AWS Region, if not specified the default region will be used</td>
<td style="width: 76px;">False</td>
</tr>
<tr>
<td style="width: 153px;">roleArn</td>
<td style="width: 511px;">The Amazon Resource Name (ARN) of the role to assume.</td>
<td style="width: 76px;">False</td>
</tr>
<tr>
<td style="width: 153px;">roleSessionName</td>
<td style="width: 511px;">An identifier for the assumed role session.</td>
<td style="width: 76px;">False</td>
</tr>
<tr>
<td style="width: 153px;">roleSessionDuration</td>
<td style="width: 511px;">The duration, in seconds, of the role session. The value can range from 900 seconds (15 minutes) up to the maximum session duration setting for the role.</td>
<td style="width: 76px;">False</td>
</tr>
</tbody>
</table>
<p> </p>
<h5>Context Output</h5>
<table style="width: 750px;">
<thead>
<tr>
<th style="width: 587px;"><strong>Path</strong></th>
<th style="width: 66px;"><strong>Type</strong></th>
<th style="width: 222px;"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.SchemaVersion</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The schema version for which a finding is formatted.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Id</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The security findings provider-specific identifier for a finding.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.ProductArn</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The ARN generated by Security Hub that uniquely identifies a third-party company (security findings provider) once this provider's product (solution that generates findings) is registered with Security Hub.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.GeneratorId</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">This is the identifier for the solution-specific component (a discrete unit of logic) that generated a finding. In various security findings provider's solutions, this generator can be called a rule, a check, a detector, a plug-in, etc.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.AwsAccountId</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The AWS account ID in which a finding is generated.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Types</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">One or more finding types in the format of 'namespace/category/classifier' that classify a finding.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.FirstObservedAt</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">An ISO8601-formatted timestamp that indicates when the potential security issue captured by a finding was first observed by the security findings provider.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.LastObservedAt</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">An ISO8601-formatted timestamp that indicates when the potential security issue captured by a finding was most recently observed by the security findings provider.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.CreatedAt</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">An ISO8601-formatted timestamp that indicates when the potential security issue captured by a finding was created by the security findings provider.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.UpdatedAt</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">An ISO8601-formatted timestamp that indicates when the finding record was last updated by the security findings provider.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Severity.Product</td>
<td style="width: 66px;">number</td>
<td style="width: 222px;">The native severity as defined by the security findings provider's solution that generated the finding.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Severity.Normalized</td>
<td style="width: 66px;">number</td>
<td style="width: 222px;">The normalized severity of a finding.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Confidence</td>
<td style="width: 66px;">number</td>
<td style="width: 222px;">A finding's confidence. Confidence is defined as the likelihood that a finding accurately identifies the behavior or issue that it was intended to identify. Confidence is scored on a 0-100 basis using a ratio scale. 0 equates zero percent confidence and 100 equates to 100 percent confidence.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Criticality</td>
<td style="width: 66px;">number</td>
<td style="width: 222px;">The level of importance assigned to the resources associated with the finding. A score of 0 means the underlying resources have no criticality, and a score of 100 is reserved for the most critical resources.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Title</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">A finding's title.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Description</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">A finding's description.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Remediation.Recommendation.Text</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The recommendation of what to do about the issue described in a finding.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Remediation.Recommendation.Url</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">A URL to link to general remediation information for the finding type of a finding.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.SourceUrl</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">A URL that links to a page about the current finding in the security findings provider's solution.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.ProductFields</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">A data type where security findings providers can include additional solution-specific details that are not part of the defined AwsSecurityFinding format.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.UserDefinedFields</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">A list of name/value string pairs associated with the finding. These are custom, user-defined fields added to a finding.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Malware.Name</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The name of the malware that was observed.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Malware.Type</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The type of the malware that was observed.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Malware.Path</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The filesystem path of the malware that was observed.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Malware.State</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The state of the malware that was observed.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Network.Direction</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">Indicates the direction of network traffic associated with a finding.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Network.Protocol</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The protocol of network-related information about a finding.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Network.SourceIpV4</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The source IPv4 address of network-related information about a finding.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Network.SourceIpV6</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The source IPv6 address of network-related information about a finding.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Network.SourcePort</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The source port of network-related information about a finding.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Network.SourceDomain</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The source domain of network-related information about a finding.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Network.SourceMac</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">he source media access control (MAC) address of network-related information about a finding.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Network.DestinationIpV4</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The destination IPv4 address of network-related information about a finding.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Network.DestinationIpV6</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The destination IPv6 address of network-related information about a finding.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Network.DestinationPort</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The destination port of network-related information about a finding.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Network.DestinationDomain</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The destination domain of network-related information about a finding.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Process.Name</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The name of the process.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Process.Path</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The path to the process executable.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Process.Pid</td>
<td style="width: 66px;">number</td>
<td style="width: 222px;">The process ID.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Process.ParentPid</td>
<td style="width: 66px;">number</td>
<td style="width: 222px;">The parent process ID.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Process.LaunchedAt</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The date/time that the process was launched.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Process.TerminatedAt</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The date/time that the process was terminated.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.ThreatIntelIndicators.Type</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The type of a threat intel indicator.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.ThreatIntelIndicators.Value</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The value of a threat intel indicator.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.ThreatIntelIndicators.Category</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The category of a threat intel indicator.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.ThreatIntelIndicators.LastObservedAt</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The date/time of the last observation of a threat intel indicator.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.ThreatIntelIndicators.Source</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The source of the threat intel.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.ThreatIntelIndicators.SourceUrl</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The URL for more details from the source of the threat intel.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Resources.Type</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">Specifies the type of the resource for which details are provided.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Resources.Id</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The canonical identifier for the given resource type.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Resources.Partition</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The canonical AWS partition name to which the region is assigned.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Resources.Region</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The canonical AWS external region name where this resource is located.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Resources.Tags</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">A list of AWS tags associated with a resource at the time the finding was processed.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Resources.Details.AwsEc2Instance.Type</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The instance type of the instance.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Resources.Details.AwsEc2Instance.ImageId</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The Amazon Machine Image (AMI) ID of the instance.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Resources.Details.AwsEc2Instance.IpV4Addresses</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The IPv4 addresses associated with the instance.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Resources.Details.AwsEc2Instance.IpV6Addresses</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The IPv6 addresses associated with the instance.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Resources.Details.AwsEc2Instance.KeyName</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The key name associated with the instance.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Resources.Details.AwsEc2Instance.IamInstanceProfileArn</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The IAM profile ARN of the instance.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Resources.Details.AwsEc2Instance.VpcId</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The identifier of the VPC in which the instance was launched.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Resources.Details.AwsEc2Instance.SubnetId</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The identifier of the subnet in which the instance was launched.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Resources.Details.AwsEc2Instance.LaunchedAt</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The date/time the instance was launched.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Resources.Details.AwsS3Bucket.OwnerId</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The canonical user ID of the owner of the S3 bucket.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Resources.Details.AwsS3Bucket.OwnerName</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The display name of the owner of the S3 bucket.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Resources.Details.AwsIamAccessKey.UserName</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The user associated with the IAM access key related to a finding.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Resources.Details.AwsIamAccessKey.Status</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The status of the IAM access key related to a finding.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Resources.Details.AwsIamAccessKey.CreatedAt</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The creation date/time of the IAM access key related to a finding.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Resources.Details.Container.Name</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The name of the container related to a finding.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Resources.Details.Container.ImageId</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The identifier of the image related to a finding.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Resources.Details.Container.ImageName</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The name of the image related to a finding.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Resources.Details.Container.LaunchedAt</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The date/time that the container was started.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Resources.Details.Other</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The details of a resource that does not have a specific sub-field for the resource type defined.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Compliance.Status</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">Indicates the result of a compliance check.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.VerificationState</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">Indicates the veracity of a finding.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.WorkflowState</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The workflow state of a finding.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.RecordState</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The record state of a finding.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.RelatedFindings.ProductArn</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The ARN of the solution that generated a related finding.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.RelatedFindings.Id</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The solution-generated identifier for a related finding.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Note.Text</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The text of a note.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Note.UpdatedBy</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The principal that created a note.</td>
</tr>
<tr>
<td style="width: 587px;">AWS.SecurityHub.Findings.Note.UpdatedAt</td>
<td style="width: 66px;">string</td>
<td style="width: 222px;">The timestamp of when the note was updated.</td>
</tr>
</tbody>
</table>
<p> </p>
<h5>Command Example</h5>
<p><code>!aws-securityhub-get-findings</code><br><code>!aws-securityhub-get-findings filters="name=Id,value=arn:aws:guardduty:us-west-2:676921422616:detector/e8b3c9a6a818f7aa3219914360e9c6ab/finding/1ab3c9a70d2859d3891fef07d3af35a6,comparison=EQUALS"</code></p>
<h5>Context Example</h5>
<p><a href="https://user-images.githubusercontent.com/34302832/49698671-8a2ff180-fbcf-11e8-9a5b-815d72891278.png" target="_blank" rel="noopener noreferrer"><img src="https://user-images.githubusercontent.com/34302832/49698671-8a2ff180-fbcf-11e8-9a5b-815d72891278.png" alt="image"></a></p>
<h5>Human Readable Output</h5>
<p><a href="https://user-images.githubusercontent.com/34302832/49698656-5ead0700-fbcf-11e8-8cca-a6f4e54d5c0a.png" target="_blank" rel="noopener noreferrer"><img src="https://user-images.githubusercontent.com/34302832/49698656-5ead0700-fbcf-11e8-8cca-a6f4e54d5c0a.png" alt="image"></a></p>
<h3>2. Get information about the master account</h3>
<hr>
<p>Provides the details for the Security Hub master account to the current member account.</p>
<h5>Base Command</h5>
<p><code>aws-securityhub-get-master-account</code></p>
<h5>Input</h5>
<table style="width: 748px;">
<thead>
<tr>
<th style="width: 162px;"><strong>Argument Name</strong></th>
<th style="width: 507px;"><strong>Description</strong></th>
<th style="width: 71px;"><strong>Required</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="width: 162px;">region</td>
<td style="width: 507px;">The AWS Region, if not specified the default region will be used</td>
<td style="width: 71px;">Optional</td>
</tr>
<tr>
<td style="width: 162px;">roleArn</td>
<td style="width: 507px;">The Amazon Resource Name (ARN) of the role to assume.</td>
<td style="width: 71px;">Optional</td>
</tr>
<tr>
<td style="width: 162px;">roleSessionName</td>
<td style="width: 507px;">An identifier for the assumed role session.</td>
<td style="width: 71px;">Optional</td>
</tr>
<tr>
<td style="width: 162px;">roleSessionDuration</td>
<td style="width: 507px;">The duration, in seconds, of the role session. The value can range from 900 seconds (15 minutes) up to the maximum session duration setting for the role.</td>
<td style="width: 71px;">Optional</td>
</tr>
</tbody>
</table>
<h5>Context Output</h5>
<table style="width: 749px;">
<thead>
<tr>
<th style="width: 336px;"><strong>Path</strong></th>
<th style="width: 45px;"><strong>Type</strong></th>
<th style="width: 359px;"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="width: 336px;">AWS.SecurityHub.MasterAccount.AccountId</td>
<td style="width: 45px;">string</td>
<td style="width: 359px;">The account ID of the master Security Hub account who sent the invitation.</td>
</tr>
<tr>
<td style="width: 336px;">AWS.SecurityHub.MasterAccount.InvitationId</td>
<td style="width: 45px;">string</td>
<td style="width: 359px;">The ID of the invitation sent by the master Security Hub account.</td>
</tr>
<tr>
<td style="width: 336px;">AWS.SecurityHub.MasterAccount.InvitedAt</td>
<td style="width: 45px;">date</td>
<td style="width: 359px;">The timestamp of when the invitation was sent.</td>
</tr>
<tr>
<td style="width: 336px;">AWS.SecurityHub.MasterAccount.MemberStatus</td>
<td style="width: 45px;">string</td>
<td style="width: 359px;">The current relationship status between the inviter and invitee accounts.</td>
</tr>
<tr>
<td style="width: 336px;">AWS.SecurityHub.MasterAccount.Region</td>
<td style="width: 45px;">string</td>
<td style="width: 359px;">The AWS Region.</td>
</tr>
</tbody>
</table>
<p> </p>
<h3>3. Get informaiton about member accounts</h3>
<hr>
<p>Lists details about all member accounts for the current Security Hub master account.</p>
<h5>Base Command</h5>
<p><code>aws-securityhub-list-members</code></p>
<h5>Input</h5>
<table style="width: 749px;">
<thead>
<tr>
<th style="width: 137px;"><strong>Argument Name</strong></th>
<th style="width: 532px;"><strong>Description</strong></th>
<th style="width: 71px;"><strong>Required</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="width: 137px;">onlyAssociated</td>
<td style="width: 532px;">Specifies what member accounts the response includes based on their relationship status with the master account. The default value is TRUE. If onlyAssociated is set to TRUE, the response includes member accounts whose relationship status with the master is set to ENABLED or DISABLED. If onlyAssociated is set to FALSE, the response includes all existing member accounts.</td>
<td style="width: 71px;">Required</td>
</tr>
<tr>
<td style="width: 137px;">region</td>
<td style="width: 532px;">The AWS Region, if not specified the default region will be used</td>
<td style="width: 71px;">Optional</td>
</tr>
<tr>
<td style="width: 137px;">roleArn</td>
<td style="width: 532px;">The Amazon Resource Name (ARN) of the role to assume.</td>
<td style="width: 71px;">Optional</td>
</tr>
<tr>
<td style="width: 137px;">roleSessionName</td>
<td style="width: 532px;">An identifier for the assumed role session.</td>
<td style="width: 71px;">Optional</td>
</tr>
<tr>
<td style="width: 137px;">roleSessionDuration</td>
<td style="width: 532px;">The duration, in seconds, of the role session. The value can range from 900 seconds (15 minutes) up to the maximum session duration setting for the role.</td>
<td style="width: 71px;">Optional</td>
</tr>
</tbody>
</table>
<p> </p>
<h5>Context Output</h5>
<table style="width: 749px;">
<thead>
<tr>
<th style="width: 350px;"><strong>Path</strong></th>
<th style="width: 47px;"><strong>Type</strong></th>
<th style="width: 343px;"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="width: 350px;">AWS.SecurityHub.MemberAccounts.AccountId</td>
<td style="width: 47px;">string</td>
<td style="width: 343px;">The AWS account ID of a Security Hub member account.</td>
</tr>
<tr>
<td style="width: 350px;">AWS.SecurityHub.MemberAccounts.Email</td>
<td style="width: 47px;">string</td>
<td style="width: 343px;">The email of a Security Hub member account.</td>
</tr>
<tr>
<td style="width: 350px;">AWS.SecurityHub.MemberAccounts.MasterId</td>
<td style="width: 47px;">string</td>
<td style="width: 343px;">The AWS account ID of the master Security Hub account to this member account.</td>
</tr>
<tr>
<td style="width: 350px;">AWS.SecurityHub.MemberAccounts.MemberStatus</td>
<td style="width: 47px;">string</td>
<td style="width: 343px;">The status of the relationship between the member account and its master account.</td>
</tr>
<tr>
<td style="width: 350px;">AWS.SecurityHub.MemberAccounts.InvitedAt</td>
<td style="width: 47px;">date</td>
<td style="width: 343px;">Time stamp at which the member account was invited to Security Hub.</td>
</tr>
<tr>
<td style="width: 350px;">AWS.SecurityHub.MemberAccounts.UpdatedAt</td>
<td style="width: 47px;">date</td>
<td style="width: 343px;">Time stamp at which this member account was updated.</td>
</tr>
<tr>
<td style="width: 350px;">AWS.SecurityHub.MemberAccounts.Region</td>
<td style="width: 47px;">string</td>
<td style="width: 343px;">The AWS Region</td>
</tr>
</tbody>
</table>
<p> </p>
<h5>Command Example</h5>
<p><code>!aws-securityhub-list-members onlyAssociated=True</code></p>
<h5>Context Example</h5>
<p><a href="https://user-images.githubusercontent.com/34302832/49698398-d711c900-fbcb-11e8-9537-55ca1633e68b.png" target="_blank" rel="noopener noreferrer"><img src="https://user-images.githubusercontent.com/34302832/49698398-d711c900-fbcb-11e8-9537-55ca1633e68b.png" alt="image"></a></p>
<h5>Human Readable Output</h5>
<p><a href="https://user-images.githubusercontent.com/34302832/49698401-edb82000-fbcb-11e8-84a8-3c7f8e8719a0.png" target="_blank" rel="noopener noreferrer"><img src="https://user-images.githubusercontent.com/34302832/49698401-edb82000-fbcb-11e8-84a8-3c7f8e8719a0.png" alt="image"></a></p>
<h3>4. Enable AWS Securty Hub</h3>
<hr>
<p>Enables the AWS Security Hub service.</p>
<h5>Base Command</h5>
<p><code>aws-securityhub-enable-security-hub</code></p>
<h5>Input</h5>
<table style="width: 749px;">
<thead>
<tr>
<th style="width: 136px;"><strong>Argument Name</strong></th>
<th style="width: 533px;"><strong>Description</strong></th>
<th style="width: 71px;"><strong>Required</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="width: 136px;">region</td>
<td style="width: 533px;">The AWS Region, if not specified the default region will be used</td>
<td style="width: 71px;">Optional</td>
</tr>
<tr>
<td style="width: 136px;">roleArn</td>
<td style="width: 533px;">The Amazon Resource Name (ARN) of the role to assume.</td>
<td style="width: 71px;">Optional</td>
</tr>
<tr>
<td style="width: 136px;">roleSessionName</td>
<td style="width: 533px;">An identifier for the assumed role session.</td>
<td style="width: 71px;">Optional</td>
</tr>
<tr>
<td style="width: 136px;">roleSessionDuration</td>
<td style="width: 533px;">The duration, in seconds, of the role session. The value can range from 900 seconds (15 minutes) up to the maximum session duration setting for the role.</td>
<td style="width: 71px;">Optional</td>
</tr>
</tbody>
</table>
<p> </p>
<h5>Context Output</h5>
<p>There is no context output for this command.</p>
<h5>Command Example</h5>
<p><code>!aws-securityhub-enable-security-hub</code></p>
<h5>Human Readable Output</h5>
<p><a href="https://user-images.githubusercontent.com/34302832/49698254-ea239980-fbc9-11e8-825d-8cc5b3796df2.png" target="_blank" rel="noopener noreferrer"><img src="https://user-images.githubusercontent.com/34302832/49698254-ea239980-fbc9-11e8-825d-8cc5b3796df2.png" alt="image"></a></p>
<h3>5. Disable AWS Security Hub</h3>
<hr>
<p>Disables the AWS Security Hub Service.</p>
<h5>Base Command</h5>
<p><code>aws-securityhub-disable-security-hub</code></p>
<h5>Input</h5>
<table style="width: 748px;">
<thead>
<tr>
<th style="width: 152px;"><strong>Argument Name</strong></th>
<th style="width: 517px;"><strong>Description</strong></th>
<th style="width: 71px;"><strong>Required</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="width: 152px;">region</td>
<td style="width: 517px;">The AWS Region, if not specified the default region will be used</td>
<td style="width: 71px;">Optional</td>
</tr>
<tr>
<td style="width: 152px;">roleArn</td>
<td style="width: 517px;">The Amazon Resource Name (ARN) of the role to assume.</td>
<td style="width: 71px;">Optional</td>
</tr>
<tr>
<td style="width: 152px;">roleSessionName</td>
<td style="width: 517px;">An identifier for the assumed role session.</td>
<td style="width: 71px;">Optional</td>
</tr>
<tr>
<td style="width: 152px;">roleSessionDuration</td>
<td style="width: 517px;">The duration, in seconds, of the role session. The value can range from 900 seconds (15 minutes) up to the maximum session duration setting for the role.</td>
<td style="width: 71px;">Optional</td>
</tr>
</tbody>
</table>
<p> </p>
<h5>Context Output</h5>
<p>There is no context output for this command.</p>
<h5>Command Example</h5>
<p><code>!aws-securityhub-disable-security-hub</code></p>
<h5>Human Readable Output</h5>
<p><a href="https://user-images.githubusercontent.com/34302832/49698267-07f0fe80-fbca-11e8-96b3-d06dab6557d6.png" target="_blank" rel="noopener noreferrer"><img src="https://user-images.githubusercontent.com/34302832/49698267-07f0fe80-fbca-11e8-96b3-d06dab6557d6.png" alt="image"></a></p>
<h3>6. Update the findings record state</h3>
<hr>
<p>Updates the AWS Security Hub-aggregated findings Record state.</p>
<h5>Base Command</h5>
<p><code>aws-securityhub-update-finding</code></p>
<h5>Input</h5>
<table style="width: 749px;">
<thead>
<tr>
<th style="width: 136px;"><strong>Argument Name</strong></th>
<th style="width: 533px;"><strong>Description</strong></th>
<th style="width: 71px;"><strong>Required</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="width: 136px;">findingId</td>
<td style="width: 533px;">The security hub finding id.</td>
<td style="width: 71px;">Required</td>
</tr>
<tr>
<td style="width: 136px;">recordState</td>
<td style="width: 533px;">The desired record state.</td>
<td style="width: 71px;">Required</td>
</tr>
<tr>
<td style="width: 136px;">region</td>
<td style="width: 533px;">The AWS Region, if not specified the default region will be used</td>
<td style="width: 71px;">Optional</td>
</tr>
<tr>
<td style="width: 136px;">roleArn</td>
<td style="width: 533px;">The Amazon Resource Name (ARN) of the role to assume.</td>
<td style="width: 71px;">Optional</td>
</tr>
<tr>
<td style="width: 136px;">roleSessionName</td>
<td style="width: 533px;">An identifier for the assumed role session.</td>
<td style="width: 71px;">Optional</td>
</tr>
<tr>
<td style="width: 136px;">roleSessionDuration</td>
<td style="width: 533px;">The duration, in seconds, of the role session. The value can range from 900 seconds (15 minutes) up to the maximum session duration setting for the role.</td>
<td style="width: 71px;">Optional</td>
</tr>
<tr>
<td style="width: 136px;">note</td>
<td style="width: 533px;">add a note, must be used with updatedBy argument.</td>
<td style="width: 71px;">Optional</td>
</tr>
<tr>
<td style="width: 136px;">updatedBy</td>
<td style="width: 533px;">The principal that updated the note.</td>
<td style="width: 71px;">Optional</td>
</tr>
</tbody>
</table>
<p> </p>
<h5>Context Output</h5>
<p>There is no context output for this command.</p>
<h2>Available Filters</h2>
<table style="width: 749px;">
<thead>
<tr>
<th style="width: 346px;"><strong>Filter Name</strong></th>
<th style="width: 397px;"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="width: 346px;">ProductArn</td>
<td style="width: 397px;">The ARN generated by Security Hub that uniquely identifies a third-party company (security findings provider) once this provider's product (solution that generates findings) is registered with Security Hub.</td>
</tr>
<tr>
<td style="width: 346px;">AwsAccountId</td>
<td style="width: 397px;">The AWS account ID in which a finding is generated.</td>
</tr>
<tr>
<td style="width: 346px;">Id</td>
<td style="width: 397px;">The security findings provider-specific identifier for a finding.</td>
</tr>
<tr>
<td style="width: 346px;">GeneratorId</td>
<td style="width: 397px;">This is the identifier for the solution-specific component (a discrete unit of logic) that generated a finding. In various security findings provider's solutions, this generator can be called a rule, a check, a detector, a plug-in, etc.</td>
</tr>
<tr>
<td style="width: 346px;">Type</td>
<td style="width: 397px;">A finding type in the format of 'namespace/category/classifier' that classifies a finding.</td>
</tr>
<tr>
<td style="width: 346px;">SeverityLabel</td>
<td style="width: 397px;">The label of a finding's severity.</td>
</tr>
<tr>
<td style="width: 346px;">Title</td>
<td style="width: 397px;">A finding's title.</td>
</tr>
<tr>
<td style="width: 346px;">Description</td>
<td style="width: 397px;">A finding's description.</td>
</tr>
<tr>
<td style="width: 346px;">RecommendationText</td>
<td style="width: 397px;">The recommendation of what to do about the issue described in a finding.</td>
</tr>
<tr>
<td style="width: 346px;">SourceUrl</td>
<td style="width: 397px;">A URL that links to a page about the current finding in the security findings provider's solution.</td>
</tr>
<tr>
<td style="width: 346px;">ProductName</td>
<td style="width: 397px;">The name of the solution (product) that generates findings.</td>
</tr>
<tr>
<td style="width: 346px;">CompanyName</td>
<td style="width: 397px;">The name of the findings provider (company) that owns the solution (product) that generates findings.</td>
</tr>
<tr>
<td style="width: 346px;">MalwareName</td>
<td style="width: 397px;">The name of the malware that was observed.</td>
</tr>
<tr>
<td style="width: 346px;">MalwareType</td>
<td style="width: 397px;">The type of the malware that was observed.</td>
</tr>
<tr>
<td style="width: 346px;">MalwarePath</td>
<td style="width: 397px;">The filesystem path of the malware that was observed.</td>
</tr>
<tr>
<td style="width: 346px;">MalwareState</td>
<td style="width: 397px;">The state of the malware that was observed.</td>
</tr>
<tr>
<td style="width: 346px;">NetworkDirection</td>
<td style="width: 397px;">Indicates the direction of network traffic associated with a finding.</td>
</tr>
<tr>
<td style="width: 346px;">NetworkProtocol</td>
<td style="width: 397px;">The protocol of network-related information about a finding.</td>
</tr>
<tr>
<td style="width: 346px;">NetworkSourceDomain</td>
<td style="width: 397px;">The source domain of network-related information about a finding.</td>
</tr>
<tr>
<td style="width: 346px;">NetworkSourceMac</td>
<td style="width: 397px;">The source media access control (MAC) address of network-related information about a finding.</td>
</tr>
<tr>
<td style="width: 346px;">NetworkDestinationDomain</td>
<td style="width: 397px;">The destination domain of network-related information about a finding.</td>
</tr>
<tr>
<td style="width: 346px;">ProcessName</td>
<td style="width: 397px;">The name of the process.</td>
</tr>
<tr>
<td style="width: 346px;">ProcessPath</td>
<td style="width: 397px;">The path to the process executable.</td>
</tr>
<tr>
<td style="width: 346px;">ThreatIntelIndicatorType</td>
<td style="width: 397px;">The type of a threat intel indicator.</td>
</tr>
<tr>
<td style="width: 346px;">ThreatIntelIndicatorValue</td>
<td style="width: 397px;">The value of a threat intel indicator.</td>
</tr>
<tr>
<td style="width: 346px;">ThreatIntelIndicatorCategory</td>
<td style="width: 397px;">The category of a threat intel indicator.</td>
</tr>
<tr>
<td style="width: 346px;">ThreatIntelIndicatorSource</td>
<td style="width: 397px;">The source of the threat intel.</td>
</tr>
<tr>
<td style="width: 346px;">ThreatIntelIndicatorSourceUrl</td>
<td style="width: 397px;">The URL for more details from the source of the threat intel.</td>
</tr>
<tr>
<td style="width: 346px;">ResourceType</td>
<td style="width: 397px;">Specifies the type of the resource for which details are provided.</td>
</tr>
<tr>
<td style="width: 346px;">ResourceId</td>
<td style="width: 397px;">The canonical identifier for the given resource type.</td>
</tr>
<tr>
<td style="width: 346px;">ResourcePartition</td>
<td style="width: 397px;">The canonical AWS partition name to which the region is assigned.</td>
</tr>
<tr>
<td style="width: 346px;">ResourceRegion</td>
<td style="width: 397px;">The canonical AWS external region name where this resource is located.</td>
</tr>
<tr>
<td style="width: 346px;">ResourceAwsEc2InstanceType</td>
<td style="width: 397px;">The instance type of the instance.</td>
</tr>
<tr>
<td style="width: 346px;">ResourceAwsEc2InstanceImageId</td>
<td style="width: 397px;">The Amazon Machine Image (AMI) ID of the instance.</td>
</tr>
<tr>
<td style="width: 346px;">ResourceAwsEc2InstanceKeyName</td>
<td style="width: 397px;">The key name associated with the instance.</td>
</tr>
<tr>
<td style="width: 346px;">ResourceAwsEc2InstanceIamInstanceProfileArn</td>
<td style="width: 397px;">The IAM profile ARN of the instance.</td>
</tr>
<tr>
<td style="width: 346px;">ResourceAwsEc2InstanceVpcId</td>
<td style="width: 397px;">The identifier of the VPC in which the instance was launched.</td>
</tr>
<tr>
<td style="width: 346px;">ResourceAwsEc2InstanceSubnetId</td>
<td style="width: 397px;">The identifier of the subnet in which the instance was launched.</td>
</tr>
<tr>
<td style="width: 346px;">ResourceAwsS3BucketOwnerId</td>
<td style="width: 397px;">The canonical user ID of the owner of the S3 bucket.</td>
</tr>
<tr>
<td style="width: 346px;">ResourceAwsS3BucketOwnerName</td>
<td style="width: 397px;">The display name of the owner of the S3 bucket.</td>
</tr>
<tr>
<td style="width: 346px;">ResourceAwsIamAccessKeyUserName</td>
<td style="width: 397px;">The user associated with the IAM access key related to a finding.</td>
</tr>
<tr>
<td style="width: 346px;">ResourceAwsIamAccessKeyStatus</td>
<td style="width: 397px;">The status of the IAM access key related to a finding.</td>
</tr>
<tr>
<td style="width: 346px;">ResourceContainerName</td>
<td style="width: 397px;">The name of the container related to a finding.</td>
</tr>
<tr>
<td style="width: 346px;">ResourceContainerImageId</td>
<td style="width: 397px;">The identifier of the image related to a finding.</td>
</tr>
<tr>
<td style="width: 346px;">ResourceContainerImageName</td>
<td style="width: 397px;">The name of the image related to a finding.</td>
</tr>
<tr>
<td style="width: 346px;">ComplianceStatus</td>
<td style="width: 397px;">Exclusive to findings that are generated as the result of a check run against a specific rule in a supported standard (for example, AWS CIS Foundations). Contains compliance-related finding details.</td>
</tr>
<tr>
<td style="width: 346px;">VerificationState</td>
<td style="width: 397px;">Indicates the veracity of a finding.</td>
</tr>
<tr>
<td style="width: 346px;">WorkflowState</td>
<td style="width: 397px;">The workflow state of a finding.</td>
</tr>
<tr>
<td style="width: 346px;">RecordState</td>
<td style="width: 397px;">The updated record state for the finding.</td>
</tr>
<tr>
<td style="width: 346px;">RelatedFindingsProductArn</td>
<td style="width: 397px;">The ARN of the solution that generated a related finding.</td>
</tr>
<tr>
<td style="width: 346px;">RelatedFindingsId</td>
<td style="width: 397px;">The solution-generated identifier for a related finding.</td>
</tr>
<tr>
<td style="width: 346px;">NoteText</td>
<td style="width: 397px;">The text of a note.</td>
</tr>
<tr>
<td style="width: 346px;">NoteUpdatedBy</td>
<td style="width: 397px;">The principal that created a note.</td>
</tr>
</tbody>
</table>
<p> </p>
<h3>Filter Usage</h3>
<p><code>filter=name=,value=,comparison=&lt;EQUALS | CONTAINS | PREFIX&gt;</code>.</p>