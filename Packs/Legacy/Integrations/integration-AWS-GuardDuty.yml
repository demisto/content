commonfields:
  id: AWS - GuardDuty
  version: -1
name: AWS - GuardDuty
display: AWS - GuardDuty
category: IT Services
image: data:image/png;base64,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
description: Amazon Web Services Guard Duty Service (gd)
configuration:
- display: AWS Default Region
  name: defaultRegion
  defaultvalue: ""
  type: 0
  required: false
- display: Role Arn
  name: roleArn
  defaultvalue: ""
  type: 0
  required: false
- display: Fetch incidents
  name: isFetch
  defaultvalue: ""
  type: 8
  required: false
- display: Incident type
  name: incidentType
  defaultvalue: ""
  type: 13
  required: false
- display: Role Session Name
  name: roleSessionName
  defaultvalue: ""
  type: 0
  required: false
- display: Role Session Duration
  name: sessionDuration
  defaultvalue: ""
  type: 0
  required: false
- display: Guard Duty Severity level
  name: gs_severity
  defaultvalue: ""
  type: 0
  required: false
script:
  script: |+
    import boto3
    import json
    import datetime

    AWS_DEFAULT_REGION = demisto.params()['defaultRegion']
    AWS_roleArn = demisto.params()['roleArn']
    AWS_roleSessionName = demisto.params()['roleSessionName']
    AWS_roleSessionDuration = demisto.params()['sessionDuration']
    AWS_rolePolicy = None
    AWS_GD_SEVERITY = demisto.params()['gs_severity']

    def aws_session(service='guardduty',region=None,roleArn=None,roleSessionName=None,roleSessionDuration=None,rolePolicy=None):
        kwargs = {}
        if roleArn and roleSessionName is not None:
            kwargs.update({
                'RoleArn':roleArn,
                'RoleSessionName':roleSessionName,
                })
        elif AWS_roleArn and AWS_roleSessionName is not None:
            kwargs.update({
                'RoleArn':AWS_roleArn,
                'RoleSessionName':AWS_roleSessionName,
                })

        if roleSessionDuration is not None:
            kwargs.update({'DurationSeconds':int(roleSessionDuration)})
        elif AWS_roleSessionDuration is not None:
            kwargs.update({'DurationSeconds':int(AWS_roleSessionDuration)})

        if rolePolicy is not None:
            kwargs.update({'Policy':rolePolicy})
        elif AWS_rolePolicy is not None:
            kwargs.update({'Policy':AWS_rolePolicy})

        if kwargs:
            sts_client = boto3.client('sts')
            sts_response = sts_client.assume_role(**kwargs)
            if region is not None:
                client = boto3.client(
                    service_name=service,
                    region_name=region,
                    aws_access_key_id=sts_response['Credentials']['AccessKeyId'],
                    aws_secret_access_key=sts_response['Credentials']['SecretAccessKey'],
                    aws_session_token=sts_response['Credentials']['SessionToken']
                    )
            else:
                client = boto3.client(
                    service_name=service,
                    region_name=AWS_DEFAULT_REGION,
                    aws_access_key_id=sts_response['Credentials']['AccessKeyId'],
                    aws_secret_access_key=sts_response['Credentials']['SecretAccessKey'],
                    aws_session_token=sts_response['Credentials']['SessionToken']
                    )
        else:
            if region is not None:
                client = boto3.client(service_name=service,region_name=region)
            else:
                client = boto3.client(service_name=service,region_name=AWS_DEFAULT_REGION)

        return client

    def parse_finding_ids(finding_ids):
        id_list = finding_ids.replace(" ", "")
        findingsids = id_list.split(",")
        return findingsids

    class DatetimeEncoder(json.JSONEncoder):
      def default(self, obj):
        if isinstance (obj, datetime.datetime):
            return obj.strftime ('%Y-%m-%dT%H:%M:%S')
        elif isinstance (obj, datetime.date):
            return obj.strftime ('%Y-%m-%d')
        elif isinstance(obj, datetime):
            return obj.strftime('%Y-%m-%dT%H:%M:%S')
        elif isinstance(obj, date):
            return obj.strftime('%Y-%m-%d')
        # Let the base class default method raise the TypeError
        return json.JSONEncoder.default(self, obj)

    def create_entry(title,data, ec):
        return {
            'ContentsFormat': formats['json'],
            'Type': entryTypes['note'],
            'Contents': data,
            'ReadableContentsFormat': formats['markdown'],
            'HumanReadable': tableToMarkdown(title, data) if data else 'No result were found',
            'EntryContext': ec
        }

    def raise_error(error):
        return {
            'Type' : entryTypes['error'],
            'ContentsFormat' : formats['text'],
            'Contents' : str(error)
        }

    def create_detector(args):
        try:
            client = aws_session(
                    service = 'guardduty',
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            kwargs = {'Enable':True if args.get('enable') == 'True' else False}
            response = client.create_detector(**kwargs)
            data =({
                'DetectorId': response['DetectorId']
            })
            ec = {'AWS.GuardDuty.Detectors(val.DetectorId === obj.DetectorId)': data}
            return create_entry('AWS GuardDuty Detectors', data, ec)

        except Exception as e:
            return raise_error(e)


    def delete_detector(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            response = client.delete_detector(DetectorId=args.get('detectorId'))
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return 'The Detector {0} has been deleted'.format(args.get('detectorId'))

        except Exception as e:
            return raise_error(e)

    def get_detector(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )

            response = client.get_detector(DetectorId=args.get('detectorId'))
            data = ({
                'DetectorId': args.get('detectorId'),
                'CreatedAt': response['CreatedAt'],
                'ServiceRole': response['ServiceRole'],
                'Status': response['Status'],
                'UpdatedAt': response['UpdatedAt'],
            })
            ec = {'AWS.GuardDuty.Detectors(val.DetectorId === obj.DetectorId)': data}
            return create_entry('AWS GuardDuty Detectors', data, ec)

        except Exception as e:
            return raise_error(e)

    def update_detector(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            response = client.update_detector(
                DetectorId = args.get('detectorId'),
                Enable = True if args.get('enable') == 'True' else False
            )
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return 'The Detector {0} has been Updated'.format(args.get('detectorId'))

        except Exception as e:
            return raise_error(e)

    def list_detectors(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            response = client.list_detectors()
            detector = response['DetectorIds']

            data = ({
                'DetectorId': detector[0]
            })
            ec = {'AWS.GuardDuty.Detectors(val.DetectorId === obj.DetectorId)': data}
            return create_entry('AWS GuardDuty Detectors', data, ec)
        except Exception as e:
            return raise_error(e)

    def create_ip_set(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )

            kwargs = {'DetectorId':args.get('detectorId')}
            if args.get('activate') is not None:
              kwargs.update({'Activate':True if args.get('activate') == 'True' else False})
            if args.get('format') is not None:
              kwargs.update({'Format':args.get('format')})
            if args.get('location') is not None:
              kwargs.update({'Location':args.get('location')})
            if args.get('name') is not None:
              kwargs.update({'Name':args.get('name')})

            response = client.create_ip_set(**kwargs)

            data = ({
                'DetectorId':args.get('detectorId'),
                'IpSetId': response['IpSetId']
            })
            ec = {"AWS.GuardDuty.Detectors(val.DetectorId === obj.DetectorId).IPSet(val.IpSetId === obj.IpSetId)": data}
            return create_entry('AWS GuardDuty IPSets', data, ec)

        except Exception as e:
            return e#raise_error(e)

    def delete_ip_set(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            response = client.delete_ip_set(
                DetectorId=args.get('detectorId'),
                IpSetId=args.get('ipSetId')
            )
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return 'The IPSet {0} has been deleted from Detector {1}'.format(args.get('ipSetId'),args.get('detectorId'))

        except Exception as e:
            return raise_error(e)

    def update_ip_set(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            kwargs ={
                'DetectorId':args.get('detectorId'),
                'IpSetId':args.get('ipSetId')
            }
            if args.get('activate'):
                kwargs.update({'Activate': True if args.get('activate') == 'True' else False})
            if args.get('location'):
                kwargs.update({'Location':args.get('location')})
            if args.get('name'):
                kwargs.update({'Name':args.get('name')})

            response = client.update_ip_set(**kwargs)

            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return 'The IPSet {0} has been Updated'.format(args.get('ipSetId'))

        except Exception as e:
            return raise_error(e)

    def get_ip_set(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            response = client.get_ip_set(
                DetectorId=args.get('detectorId'),
                IpSetId=args.get('ipSetId')
            )
            data = ({
                'DetectorId': args.get('detectorId'),
                'IpSetId': args.get('ipSetId'),
                'Format': response['Format'],
                'Location': response['Location'],
                'Name': response['Name'],
                'Status': response['Status']
            })
            ec = {"AWS.GuardDuty.Detectors(val.DetectorId === obj.DetectorId).IPSet(val.IpSetId === obj.IpSetId)": data}
            return create_entry('AWS GuardDuty IPSets', data, ec)

        except Exception as e:
            return raise_error(e)


    def list_ip_sets(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            response = client.list_ip_sets(DetectorId=args.get('detectorId'))
            data = []
            data.append({
                'DetectorId':args.get('detectorId')
            })
            for ipset in response['IpSetIds']:
                data.append({
                    'IpSetId': ipset
                })
            ec = {"AWS.GuardDuty.Detectors(val.DetectorId === obj.DetectorId).IPSet(val.IpSetId === obj.IpSetId)": data}
            return create_entry('AWS GuardDuty IPSets', data, ec)

        except Exception as e:
            return raise_error(e)

    def create_threat_intel_set(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            kwargs = {'DetectorId':args.get('detectorId')}
            if args.get('activate') is not None:
              kwargs.update({'Activate':True if args.get('activate') == 'True' else False})
            if args.get('format') is not None:
              kwargs.update({'Format':args.get('format')})
            if args.get('location') is not None:
              kwargs.update({'Location':args.get('location')})
            if args.get('name') is not None:
              kwargs.update({'Name':args.get('name')})

            response = client.create_threat_intel_set(**kwargs)

            data =({
                'DetectorId':args.get('detectorId'),
                'ThreatIntelSetId': response['ThreatIntelSetId']
            })
            ec = {"AWS.GuardDuty.Detectors(val.DetectorId === obj.DetectorId).ThreatIntelSet(val.ThreatIntelSetId === obj.ThreatIntelSetId)": data}
            return create_entry('AWS GuardDuty ThreatIntel Set', data, ec)

        except Exception as e:
            return raise_error(e)

    def delete_threat_intel_set(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            response = client.delete_threat_intel_set(
                DetectorId=args.get('detectorId'),
                ThreatIntelSetId=args.get('threatIntelSetId')
            )
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return 'The ThreatIntel Set {0} has been deleted from Detector {1}'.format(args.get('ipSetId'),args.get('detectorId'))

        except Exception as e:
            return raise_error(e)


    def get_threat_intel_set(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            response = client.get_threat_intel_set(
                DetectorId=args.get('detectorId'),
                ThreatIntelSetId=args.get('threatIntelSetId')
            )
            data = ({
                'DetectorId':args.get('detectorId'),
                'ThreatIntelSetId':args.get('threatIntelSetId'),
                'Format': response['Format'],
                'Location': response['Location'],
                'Name': response['Name'],
                'Status': response['Status']
            })
            ec = {"AWS.GuardDuty.Detectors(val.DetectorId === obj.DetectorId).ThreatIntelSet(val.ThreatIntelSetId === obj.ThreatIntelSetId)": data}
            return create_entry('AWS GuardDuty ThreatIntel Set', data, ec)

        except Exception as e:
            return raise_error(e)

    def list_threat_intel_sets(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            response = client.list_threat_intel_sets(DetectorId=args.get('detectorId'))
            data = []
            data.append({
                'DetectorId':args.get('detectorId')
            })
            for threatintelset in response['ThreatIntelSetIds']:
                data.append({
                    'ThreatIntelSetId':threatintelset
                })
            ec = {"AWS.GuardDuty.Detectors(val.DetectorId === obj.DetectorId).ThreatIntelSet(val.ThreatIntelSetId === obj.ThreatIntelSetId)": data}
            return create_entry('AWS GuardDuty IPSets', data, ec)

        except Exception as e:
            return raise_error(e)

    def update_threat_intel_set(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            kwargs = {
                'DetectorId':args.get('detectorId'),
                'ThreatIntelSetId':args.get('threatIntelSetId')
            }
            if args.get('activate'):
                kwargs.update({'Activate':True if args.get('activate') == 'True' else False})
            if args.get('location'):
                kwargs.update({'Location':args.get('location')})
            if args.get('name'):
                kwargs.update({'Name':args.get('name')})
            response = client.update_threat_intel_set(**kwargs)
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return 'The ThreatIntel Set {0} has been Updated'.format(args.get('threatIntelSetId'))

        except Exception as e:
            return raise_error(e)

    def severity_mapping(severity):
        if severity <= 3.9:
            demistoSevirity = 1
        elif severity >= 4 and severity <= 6.9:
            demistoSevirity = 2
        elif severity >= 7 and severity <= 8.9:
            demistoSevirity = 3
        else:
            demistoSevirity = 0

        return demistoSevirity

    def gd_severity_mapping(severity):
        if severity == 'Low':
            gdSevirity = 1
        elif severity == 'Medium':
            gdSevirity = 4
        elif severity == 'High':
            gdSevirity = 7
        else:
            gdSevirity = 1

        return gdSevirity

    def list_findings(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )

            paginator = client.get_paginator('list_findings')
            response_iterator = paginator.paginate(DetectorId=args.get('detectorId'))
            data = []
            for page in response_iterator:
                for finding in page['FindingIds']:
                    data.append({'FindingId':finding})

            ec = {"AWS.GuardDuty.Findings": data}
            return create_entry('AWS GuardDuty Findings', data, ec)

        except Exception as e:
            return raise_error(e)

    def get_findings(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            response = client.get_findings(
                DetectorId=args.get('detectorId'),
                FindingIds=parse_finding_ids(args.get('findingIds')))

            data = []
            for finding in response['Findings']:
                data.append({
                        'AccountId':finding['AccountId'],
                        'Arn':finding['Arn'],
                        'CreatedAt':finding['CreatedAt'],
                        'Description':finding['Description'],
                        'Id':finding['Id'],
                        'Region':finding['Region'],
                        'Title':finding['Title'],
                        'Type':finding['Type'],
                    })

            output = json.dumps( response['Findings'], cls=DatetimeEncoder)
            raw = json.loads(output)
            ec = {"AWS.GuardDuty.Findings(val.FindingId === obj.Id)": raw}
            return create_entry('AWS GuardDuty Findings', data, ec)

        except Exception as e:
            return raise_error(e)

    def parse_incident_from_finding(finding):
        incident = {}
        incident['name'] = finding['Title']
        incident['details'] = finding['Description']
        incident['occurred'] = finding['CreatedAt']
        incident['severity'] = severity_mapping(finding['Severity'])
        incident['rawJSON'] = json.dumps(finding)
        return incident

    def fetch_incidents():
        try:
            client = aws_session()
            findingIds = []
            incidents = []
            response = client.list_detectors()
            detector = response['DetectorIds']

            list_findings = client.list_findings(DetectorId=detector[0],FindingCriteria={
            'Criterion': {
                    'service.archived': {'Eq': ['false','false']},
                    'severity': {'Gt': gd_severity_mapping(AWS_GD_SEVERITY)}
                    }
                }
            )

            get_findings = client.get_findings(DetectorId=detector[0], FindingIds=list_findings['FindingIds'])

            for finding in get_findings['Findings']:
                incident = parse_incident_from_finding(finding)
                incidents.append(incident)

            #Create demisto incidents
            demisto.incidents(incidents)
            if incidents is not None:
                #Archive findings
                archive_findings = client.archive_findings(DetectorId=detector[0],FindingIds=list_findings['FindingIds'])

        except Exception as e:
            return raise_error(e)

    def create_sample_findings(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            kwargs = {'DetectorId':args.get('detectorId')}
            if args.get('findingTypes') is not None:
                kwargs.update({'FindingTypes':parse_finding_ids(args.get('findingTypes'))})

            response = client.create_sample_findings(**kwargs)

            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return 'Sample Findings were generated'

        except Exception as e:
            return raise_error(e)

    def archive_findings(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            kwargs = {'DetectorId':args.get('detectorId')}
            if args.get('findingIds') is not None:
                kwargs.update({'FindingIds':parse_finding_ids(args.get('findingIds'))})

            response = client.archive_findings(**kwargs)

            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return 'Findings were archived'

        except Exception as e:
            return raise_error(e)

    def unarchive_findings(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            kwargs = {'DetectorId':args.get('detectorId')}
            if args.get('findingIds') is not None:
                kwargs.update({'FindingIds':parse_finding_ids(args.get('findingIds'))})

            response = client.unarchive_findings(**kwargs)

            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return 'Findings were Unarchived'

        except Exception as e:
            return raise_error(e)

    def update_findings_feedback(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )

            kwargs = {'DetectorId':args.get('detectorId')}
            if args.get('findingIds') is not None:
                kwargs.update({'FindingIds':parse_finding_ids(args.get('findingIds'))})
            if args.get('comments') is not None:
                kwargs.update({'Comments':parse_finding_ids(args.get('comments'))})
            if args.get('feedback') is not None:
                kwargs.update({'Feedback':parse_finding_ids(args.get('feedback'))})

            response = client.update_findings_feedback(**kwargs)
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return 'Findings Feedback sent!'

        except Exception as e:
            return raise_error(e)


    def test_function():
        try:
            client = aws_session()
            response = client.list_detectors()
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return 'ok'

        except Exception as e:
            return raise_error(e)

    # The command demisto.command() holds the command sent from the user.
    if demisto.command() == 'test-module':
        # This is the call made when pressing the integration test button.
        result = test_function()

    if demisto.command() == 'aws-gd-create-detector':
        result = create_detector(demisto.args())

    if demisto.command() == 'aws-gd-delete-detector':
        result = delete_detector(demisto.args())

    if demisto.command() == 'aws-gd-get-detector':
        result = get_detector(demisto.args())

    if demisto.command() == 'aws-gd-update-detector':
        result = update_detector(demisto.args())

    if demisto.command() == 'aws-gd-create-ip-set':
        result = create_ip_set(demisto.args())

    if demisto.command() == 'aws-gd-delete-ip-set':
        result = delete_ip_set(demisto.args())

    if demisto.command() == 'aws-gd-list-detectors':
        result = list_detectors(demisto.args())

    if demisto.command() == 'aws-gd-update-ip-set':
        result = update_ip_set(demisto.args())

    if demisto.command() == 'aws-gd-get-ip-set':
        result = get_ip_set(demisto.args())

    if demisto.command() == 'aws-gd-list-ip-sets':
        result = list_ip_sets(demisto.args())

    if demisto.command() == 'aws-gd-create-threatintel-set':
        result = create_threat_intel_set(demisto.args())

    if demisto.command() == 'aws-gd-delete-threatintel-set':
        result = delete_threat_intel_set(demisto.args())

    if demisto.command() == 'aws-gd-get-threatintel-set':
        result = get_threat_intel_set(demisto.args())

    if demisto.command() == 'aws-gd-list-threatintel-sets':
        result = list_threat_intel_sets(demisto.args())

    if demisto.command() == 'aws-gd-update-threatintel-set':
        result = update_threat_intel_set(demisto.args())

    if demisto.command() == 'aws-gd-list-findings':
        result = list_findings(demisto.args())

    if demisto.command() == 'aws-gd-get-findings':
        result = get_findings(demisto.args())

    if demisto.command() == 'aws-gd-create-sample-findings':
        result = create_sample_findings(demisto.args())

    if demisto.command() == 'aws-gd-archive-findings':
        result = archive_findings(demisto.args())

    if demisto.command() == 'aws-gd-unarchive-findings':
        result = unarchive_findings(demisto.args())

    if demisto.command() == 'aws-gd-update-findings-feedback':
        result = update_findings_feedback(demisto.args())

    if demisto.command() == 'fetch-incidents':
        fetch_incidents()
        sys.exit(0)

    demisto.results(result)
    sys.exit(0)

  type: python
  subtype: python2
  commands:
  - name: aws-gd-create-detector
    arguments:
    - name: enabled
      required: true
      auto: PREDEFINED
      predefined:
      - "True"
      - "False"
      description: A boolean value that specifies whether the detector is to be enabled.
      defaultValue: "True"
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.GuardDuty.Detectors.DetectorId
      description: The unique ID of the created detector.
      type: string
    description: Create an AWS Guard Duty Detector on the integration instance specified
      aws account.
  - name: aws-gd-delete-detector
    arguments:
    - name: detectorId
      required: true
      description: The unique ID that specifies the detector that you want to delete.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Deletes a Amazon GuardDuty detector specified by the detector ID.
  - name: aws-gd-get-detector
    arguments:
    - name: detectorId
      required: true
      description: The unique ID of the detector that you want to retrieve.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.GuardDuty.Detectors.DetectorId
      description: The unique ID of the created detector.
      type: string
    - contextPath: AWS.GuardDuty.Detectors.CreatedAt
      description: The first time a resource was created.
      type: string
    - contextPath: AWS.GuardDuty.Detectors.ServiceRole
      description: Customer serviceRole name or ARN for accessing customer resources.
      type: string
    - contextPath: AWS.GuardDuty.Detectors.Status
      description: The status of detector.
      type: string
    - contextPath: AWS.GuardDuty.Detectors.UpdatedAt
      description: The time a resource was last updated.
      type: string
    description: Retrieves an Amazon GuardDuty detector specified by the detectorId.
  - name: aws-gd-update-detector
    arguments:
    - name: detectorId
      required: true
      description: The unique ID of the detector that you want to update.
    - name: enable
      required: true
      auto: PREDEFINED
      predefined:
      - "True"
      - "False"
      description: Updated boolean value for the detector that specifies whether the
        detector is enabled.
      defaultValue: "True"
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Updates an Amazon GuardDuty detector specified by the detectorId.
  - name: aws-gd-create-ip-set
    arguments:
    - name: activate
      auto: PREDEFINED
      predefined:
      - "True"
      - "False"
      description: A boolean value that indicates whether GuardDuty is to start using
        the uploaded IPSet.
      defaultValue: "True"
    - name: detectorId
      required: true
      description: The unique ID of the detector that you want to update.
    - name: format
      required: true
      auto: PREDEFINED
      predefined:
      - TXT
      - STIX
      - OTX_CSV
      - ALIEN_VAULT
      - PROOF_POINT
      - FIRE_EYE
      description: The format of the file that contains the IPSet.
    - name: location
      description: The URI of the file that contains the IPSet. For example (https://s3.us-west-2.amazonaws.com/my-bucket/my-object-key)
    - name: name
      description: The user friendly name to identify the IPSet. This name is displayed
        in all findings that are triggered by activity that involves IP addresses
        included in this IPSet.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.GuardDuty.Detectors.IPSet.IpSetId
      description: The unique identifier for an IP Set.
    description: A list of trusted IP addresses that have been whitelisted for secure
      communication with AWS infrastructure and applications.
  - name: aws-gd-delete-ip-set
    arguments:
    - name: detectorId
      required: true
      description: The detectorID that specifies the GuardDuty service whose IPSet
        you want to delete.
    - name: ipSetId
      required: true
      description: The unique ID that specifies the IPSet that you want to delete.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Deletes the IPSet specified by the IPSet ID.
  - name: aws-gd-list-detectors
    arguments:
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.GuardDuty.Detectors.DetectorId
      description: The unique identifier for a detector.
      type: string
    description: Lists detectorIds of all the existing Amazon GuardDuty detector resources.
  - name: aws-gd-update-ip-set
    arguments:
    - name: activate
      auto: PREDEFINED
      predefined:
      - "True"
      - "False"
      description: The updated boolean value that specifies whether the IPSet is active
        or not.
    - name: detectorId
      required: true
      description: The detectorID that specifies the GuardDuty service whose IPSet
        you want to update.
    - name: ipSetId
      required: true
      description: The unique ID that specifies the IPSet that you want to update.
    - name: location
      description: The updated URI of the file that contains the IPSet. For example
        (https://s3.us-west-2.amazonaws.com/my-bucket/my-object-key).
    - name: name
      description: The user friendly name to identify the IPSet.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Updates the IPSet specified by the IPSet ID.
  - name: aws-gd-get-ip-set
    arguments:
    - name: detectorId
      required: true
      description: The detectorID that specifies the GuardDuty service whose IPSet
        you want to retrieve.
    - name: ipSetId
      required: true
      description: The unique ID that specifies the IPSet that you want to describe.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.GuardDuty.Detectors.IPSet.IpSetId
      description: The unique ID for the IPSet.
      type: string
    - contextPath: AWS.GuardDuty.Detectors.IPSet.Format
      description: The format of the file that contains the IPSet.
      type: string
    - contextPath: AWS.GuardDuty.Detectors.IPSet.Location
      description: The URI of the file that contains the IPSet.
      type: string
    - contextPath: AWS.GuardDuty.Detectors.IPSet.Name
      description: he user friendly name to identify the IPSet.
      type: string
    - contextPath: AWS.GuardDuty.Detectors.IPSet.Status
      description: The status of ipSet file uploaded.
      type: string
    description: Retrieves the IPSet specified by the IPSet ID.
  - name: aws-gd-list-ip-sets
    arguments:
    - name: detectorId
      required: true
      description: The unique ID of the detector that you want to retrieve.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.GuardDuty.Detectors.IPSet.IpSetId
      description: The unique identifier for an IP Set
    description: Lists the IPSets of the GuardDuty service specified by the detector
      ID.
  - name: aws-gd-create-threatintel-set
    arguments:
    - name: activate
      required: true
      auto: PREDEFINED
      predefined:
      - "True"
      - "False"
      description: A boolean value that indicates whether GuardDuty is to start using
        the uploaded ThreatIntelSet.
      defaultValue: "True"
    - name: detectorId
      required: true
      description: The unique ID of the detector that you want to update.
    - name: format
      required: true
      auto: PREDEFINED
      predefined:
      - TXT
      - STIX
      - OTX_CSV
      - ALIEN_VAULT
      - PROOF_POINT
      - FIRE_EYE
      description: The format of the file that contains the ThreatIntelSet.
    - name: location
      required: true
      description: The URI of the file that contains the ThreatIntelSet. For example
        (https://s3.us-west-2.amazonaws.com/my-bucket/my-object-key).
    - name: name
      required: true
      description: A user-friendly ThreatIntelSet name that is displayed in all finding
        generated by activity that involves IP addresses included in this ThreatIntelSet.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.GuardDuty.Detectors.ThreatIntelSet.ThreatIntelSetId
      description: The unique identifier for an threat intel set.
      type: string
    description: Create a new ThreatIntelSet. ThreatIntelSets consist of known malicious
      IP addresses. GuardDuty generates findings based on ThreatIntelSets.
  - name: aws-gd-delete-threatintel-set
    arguments:
    - name: detectorId
      required: true
      description: The detectorID that specifies the GuardDuty service whose ThreatIntelSet
        you want to delete.
    - name: threatIntelSetId
      required: true
      description: The unique ID that specifies the ThreatIntelSet that you want to
        delete.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Deletes ThreatIntelSet specified by the ThreatIntelSet ID.
  - name: aws-gd-get-threatintel-set
    arguments:
    - name: detectorId
      required: true
      description: The detectorID that specifies the GuardDuty service whose ThreatIntelSet
        you want to describe.
    - name: threatIntelSetId
      required: true
      description: The unique ID that specifies the ThreatIntelSet that you want to
        describe.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.GuardDuty.Detectors.ThreatIntelSet.ThreatIntelSetId
      description: The unique ID that specifies the ThreatIntelSet.
      type: string
    - contextPath: AWS.GuardDuty.Detectors.ThreatIntelSet.Format
      description: The format of the threatIntelSet.
      type: string
    - contextPath: AWS.GuardDuty.Detectors.ThreatIntelSet.Location
      description: The URI of the file that contains the ThreatIntelSet.
      type: string
    - contextPath: AWS.GuardDuty.Detectors.ThreatIntelSet.Name
      description: A user-friendly ThreatIntelSet name.
      type: string
    - contextPath: AWS.GuardDuty.Detectors.ThreatIntelSet.Status
      description: The status of threatIntelSet file uploaded.
      type: string
    description: Retrieves the ThreatIntelSet that is specified by the ThreatIntelSet
      ID.
  - name: aws-gd-list-threatintel-sets
    arguments:
    - name: detectorId
      required: true
      description: The detectorID that specifies the GuardDuty service whose ThreatIntelSets
        you want to list.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.GuardDuty.Detectors.ThreatIntelSet.ThreatIntelSetId
      description: The unique identifier for an threat intel set
      type: string
    description: Lists the ThreatIntelSets of the GuardDuty service specified by the
      detector ID.
  - name: aws-gd-update-threatintel-set
    arguments:
    - name: detectorId
      required: true
      description: The detectorID that specifies the GuardDuty service whose ThreatIntelSet
        you want to update.
    - name: threatIntelSetId
      description: The unique ID that specifies the ThreatIntelSet that you want to
        update.
    - name: activate
      auto: PREDEFINED
      predefined:
      - "True"
      - "False"
      description: The updated boolean value that specifies whether the ThreateIntelSet
        is active or not.
    - name: location
      description: The updated URI of the file that contains the ThreateIntelSet.
        For example (https://s3.us-west-2.amazonaws.com/my-bucket/my-object-key).
    - name: name
      description: The user-friendly ThreatIntelSet name.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Updates the ThreatIntelSet specified by ThreatIntelSet ID.
  - name: aws-gd-list-findings
    arguments:
    - name: detectorId
      required: true
      description: The ID of the detector that specifies the GuardDuty service whose
        findings you want to list.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.GuardDuty.Findings.FindingId
      description: The unique identifier for the Finding
      type: string
    description: Lists Amazon GuardDuty findings for the specified detector ID.
  - name: aws-gd-get-findings
    arguments:
    - name: detectorId
      required: true
      description: The ID of the detector that specifies the GuardDuty service whose
        findings you want to retrieve.
    - name: findingIds
      required: true
      description: IDs of the findings that you want to retrieve.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Describes Amazon GuardDuty findings specified by finding IDs.
  - name: aws-gd-create-sample-findings
    arguments:
    - name: detectorId
      required: true
      description: The ID of the detector to create sample findings for.
    - name: findingTypes
      description: Types of sample findings that you want to generate. Separated by
        comma.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Generates example findings of types specified by the list of finding
      types. If 'NULL' is specified for findingTypes, the API generates example findings
      of all supported finding types.
  - name: aws-gd-archive-findings
    arguments:
    - name: detectorId
      required: true
      description: The ID of the detector that specifies the GuardDuty service whose
        findings you want to archive.
    - name: findingIds
      description: IDs of the findings that you want to archive. Separated by comma.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Archives Amazon GuardDuty findings specified by the list of finding
      IDs.
  - name: aws-gd-unarchive-findings
    arguments:
    - name: detectorId
      required: true
      description: The ID of the detector that specifies the GuardDuty service whose
        findings you want to unarchive.
    - name: findingIds
      description: IDs of the findings that you want to unarchive.
    description: Unarchives Amazon GuardDuty findings specified by the list of finding
      IDs.
  - name: aws-gd-update-findings-feedback
    arguments:
    - name: detectorId
      required: true
      description: The ID of the detector that specifies the GuardDuty service whose
        findings you want to mark as useful or not useful.
    - name: findingIds
      description: IDs of the findings that you want to mark as useful or not useful.
    - name: comments
      description: Additional feedback about the GuardDuty findings.
    - name: feedback
      auto: PREDEFINED
      predefined:
      - USEFUL
      - NOT_USEFUL
      description: Specifi wheter the finding was usful or not.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Marks specified Amazon GuardDuty findings as useful or not useful.
  dockerimage: demisto/boto3
  isfetch: true
  runonce: false
tests:
  - No test
