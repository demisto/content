elasticcommonfields: {}
id: Process Url Indicators
version: -1
fromversion: 5.5.0
name: Process Url Indicators
description: 'TIM playbook - This playbook processes indicators by running enrichment, manually reviewing
  the indicator, and tagging indicators accordingly based on user preferences or enrichment
  results. Tagging can later be used to update black/white list and other purposes.
  To process indicators, go to playbook inputs, choose From indicators and set your
  query (for example: "type:url").'
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 313fb0dc-a2d7-4b0b-82e3-7c4cb3b4b29c
    type: start
    task:
      elasticcommonfields: {}
      id: 313fb0dc-a2d7-4b0b-82e3-7c4cb3b4b29c
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "19"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 510,
          "y": -1530
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "3":
    id: "3"
    taskid: b699e9a1-9567-46fb-862b-5b17f8560446
    type: title
    task:
      elasticcommonfields: {}
      id: b699e9a1-9567-46fb-862b-5b17f8560446
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 510,
          "y": 1930
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "19":
    id: "19"
    taskid: 21b582a1-f7db-4e5e-820b-38aa003a96e0
    type: condition
    task:
      elasticcommonfields: {}
      id: 21b582a1-f7db-4e5e-820b-38aa003a96e0
      version: -1
      name: Are there results?
      description: Checks whether the specified item is in a list. The default list
        is the Demisto Indicators Whitelist.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "73"
      - "76"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: playbookQuery.value
            iscontext: true
    view: |-
      {
        "position": {
          "x": 510,
          "y": -1320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "21":
    id: "21"
    taskid: eff7fd52-7d89-4f0e-809c-6cb461133f83
    type: regular
    task:
      elasticcommonfields: {}
      id: eff7fd52-7d89-4f0e-809c-6cb461133f83
      version: -1
      name: Gather more data on results
      description: Check the given URL reputation
      script: '|||url'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "77"
      - "78"
      - "79"
      - "80"
    scriptarguments:
      long: {}
      retries: {}
      sampleSize: {}
      submitWait: {}
      threshold: {}
      url:
        simple: ${playbookQuery.value}
      wait: {}
    continueonerror: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 290,
          "y": 215
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 1
  "44":
    id: "44"
    taskid: 84fcec74-5a37-495e-864a-a3535704245f
    type: regular
    task:
      elasticcommonfields: {}
      id: 84fcec74-5a37-495e-864a-a3535704245f
      version: -1
      name: Add bad tag to indicators
      description: commands.local.cmd.add.values.to.indicator.multi.select.field
      script: Builtin|||appendIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "72"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: processed_bad
      indicatorsValues:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "3"
          accessor: Indicator
      value:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "3"
          - - operator: in
              left:
                value:
                  simple: DBotScore.Indicator
                iscontext: true
              right:
                value:
                  simple: playbookQuery.value
                iscontext: true
          accessor: Indicator
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2590,
          "y": 1580
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 1
  "45":
    id: "45"
    taskid: effdbc79-9cf0-4c65-8cd9-2a899e5eccab
    type: condition
    task:
      elasticcommonfields: {}
      id: effdbc79-9cf0-4c65-8cd9-2a899e5eccab
      version: -1
      name: Are there indicators  with high risk score?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "64"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "3"
    view: |-
      {
        "position": {
          "x": 2370,
          "y": 550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "46":
    id: "46"
    taskid: cd201c7a-6495-40ec-8b2b-8d20f498f562
    type: condition
    task:
      elasticcommonfields: {}
      id: cd201c7a-6495-40ec-8b2b-8d20f498f562
      version: -1
      name: Are there indicators with good Dbot score?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "67"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "1"
    view: |-
      {
        "position": {
          "x": -1310,
          "y": 570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "47":
    id: "47"
    taskid: 631c6c9a-f401-4b67-80dc-770d71959ec3
    type: regular
    task:
      elasticcommonfields: {}
      id: 631c6c9a-f401-4b67-80dc-770d71959ec3
      version: -1
      name: Add good tag to indicators
      description: commands.local.cmd.add.values.to.indicator.multi.select.field
      script: Builtin|||appendIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "69"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: processed_good
      indicatorsValues:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "1"
          accessor: Indicator
      value:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "1"
          accessor: Indicator
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1510,
          "y": 1580
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 1
  "48":
    id: "48"
    taskid: a74d2dfd-7d49-4c23-816a-b848b23c34f6
    type: condition
    task:
      elasticcommonfields: {}
      id: a74d2dfd-7d49-4c23-816a-b848b23c34f6
      version: -1
      name: Are there indicators with unknown risk score?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "65"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "0"
    view: |-
      {
        "position": {
          "x": 880,
          "y": 570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "49":
    id: "49"
    taskid: 772300b7-7860-4f63-8a25-4e28446af6a4
    type: regular
    task:
      elasticcommonfields: {}
      id: 772300b7-7860-4f63-8a25-4e28446af6a4
      version: -1
      name: Add unknown tag to indicators
      description: commands.local.cmd.add.values.to.indicator.multi.select.field
      script: Builtin|||appendIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "71"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: processed_unknown
      indicatorsValues:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "0"
          accessor: Indicator
      value:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "0"
          - - operator: in
              left:
                value:
                  simple: DBotScore.Indicator
                iscontext: true
              right:
                value:
                  simple: playbookQuery.value
                iscontext: true
          accessor: Indicator
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1160,
          "y": 1570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 1
  "50":
    id: "50"
    taskid: f946b75b-3008-41d1-888c-625ca36506ac
    type: condition
    task:
      elasticcommonfields: {}
      id: f946b75b-3008-41d1-888c-625ca36506ac
      version: -1
      name: Are there indicators with suspicious Dbot score?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "66"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "2"
    view: |-
      {
        "position": {
          "x": 160,
          "y": 570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "51":
    id: "51"
    taskid: bed76f41-ce07-4312-8a86-bbee09679dcf
    type: regular
    task:
      elasticcommonfields: {}
      id: bed76f41-ce07-4312-8a86-bbee09679dcf
      version: -1
      name: Add suspicious tag to indicators
      description: commands.local.cmd.add.values.to.indicator.multi.select.field
      script: Builtin|||appendIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "70"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: processed_suspicious
      indicatorsValues:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "2"
          accessor: Indicator
      value:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "2"
          accessor: Indicator
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -130,
          "y": 1570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 1
  "52":
    id: "52"
    taskid: 042166ca-936c-41d5-8527-19d43bedc590
    type: condition
    task:
      elasticcommonfields: {}
      id: 042166ca-936c-41d5-8527-19d43bedc590
      version: -1
      name: Do values appear in business partners Url list?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "53"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: List.In
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: List.ListName
            iscontext: true
          right:
            value:
              simple: inputs.BusinessPartnersUrlListName
            iscontext: true
    view: |-
      {
        "position": {
          "x": 750,
          "y": -340
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "53":
    id: "53"
    taskid: d61f5b1b-f383-4fd7-8f18-60b4888e0c19
    type: regular
    task:
      elasticcommonfields: {}
      id: d61f5b1b-f383-4fd7-8f18-60b4888e0c19
      version: -1
      name: Add business partner tag to indicators
      description: commands.local.cmd.add.values.to.indicator.multi.select.field
      script: Builtin|||appendIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: business_partner
      indicatorsValues:
        complex:
          root: List
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: List.ListName
                iscontext: true
              right:
                value:
                  simple: inputs.BusinessPartnersDomainsListName
                iscontext: true
          accessor: In
          transformers:
          - operator: uniq
      value:
        simple: ${List.In}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 750,
          "y": 0
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "54":
    id: "54"
    taskid: 8dbba0b8-ced3-4614-83f9-b4bcb9d7ffb6
    type: condition
    task:
      elasticcommonfields: {}
      id: 8dbba0b8-ced3-4614-83f9-b4bcb9d7ffb6
      version: -1
      name: Is there a business partners Url list?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "55"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: inputs.BusinessPartnersUrlListName
            iscontext: true
    view: |-
      {
        "position": {
          "x": 750,
          "y": -840
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "55":
    id: "55"
    taskid: a0abf9c1-827c-4227-8f1a-e5eda2ba5b47
    type: regular
    task:
      elasticcommonfields: {}
      id: a0abf9c1-827c-4227-8f1a-e5eda2ba5b47
      version: -1
      name: Run filter by list check on indicators
      description: Checks whether the specified item is in a list. The default list
        is the Demisto Indicators Whitelist.
      scriptName: FilterByList
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "52"
    scriptarguments:
      ignorecase:
        simple: "yes"
      listname:
        simple: ${inputs.BusinessPartnersUrlListName}
      matchexact:
        simple: "yes"
      values:
        simple: ${playbookQuery.value}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 750,
          "y": -500
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "60":
    id: "60"
    taskid: b00e5c6f-b743-4946-8fc5-c77116ec34fa
    type: condition
    task:
      elasticcommonfields: {}
      id: b00e5c6f-b743-4946-8fc5-c77116ec34fa
      version: -1
      name: Manual approve indicators to be good
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "81"
      "yes":
      - "47"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1250,
          "y": 1005
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "61":
    id: "61"
    taskid: 4149ebbd-b7e1-4da4-8293-6b7f834f0041
    type: condition
    task:
      elasticcommonfields: {}
      id: 4149ebbd-b7e1-4da4-8293-6b7f834f0041
      version: -1
      name: Manual approve indicators to be suspicious
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "93"
      "yes":
      - "51"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 180,
          "y": 990
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "62":
    id: "62"
    taskid: 2a5e12b6-ce67-4bf4-8cc3-d1c38e56f612
    type: condition
    task:
      elasticcommonfields: {}
      id: 2a5e12b6-ce67-4bf4-8cc3-d1c38e56f612
      version: -1
      name: Manual approve indicators to be unknown
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "95"
      "yes":
      - "49"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 860,
          "y": 990
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "63":
    id: "63"
    taskid: b4bcc308-aa8b-459b-8c61-1dc4d521e768
    type: condition
    task:
      elasticcommonfields: {}
      id: b4bcc308-aa8b-459b-8c61-1dc4d521e768
      version: -1
      name: Manual approve indicators to be bad
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "97"
      "yes":
      - "44"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2340,
          "y": 970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "64":
    id: "64"
    taskid: 8ad1d76e-c5f3-454b-88bf-73b5ad5e13f5
    type: condition
    task:
      elasticcommonfields: {}
      id: 8ad1d76e-c5f3-454b-88bf-73b5ad5e13f5
      version: -1
      name: Is auto approved is allowed?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "63"
      "yes":
      - "44"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: inputs.AllowAutomaticApproval
            iscontext: true
          right:
            value:
              simple: "yes"
    view: |-
      {
        "position": {
          "x": 2590,
          "y": 750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "65":
    id: "65"
    taskid: 7ab00d9b-2686-4288-8761-06a408a94242
    type: condition
    task:
      elasticcommonfields: {}
      id: 7ab00d9b-2686-4288-8761-06a408a94242
      version: -1
      name: Is auto approved is allowed?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "62"
      "yes":
      - "49"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: inputs.AllowAutomaticApproval
            iscontext: true
          right:
            value:
              simple: "yes"
    view: |-
      {
        "position": {
          "x": 1160,
          "y": 750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "66":
    id: "66"
    taskid: 446c9524-f072-4e8c-8f95-03355237bc3a
    type: condition
    task:
      elasticcommonfields: {}
      id: 446c9524-f072-4e8c-8f95-03355237bc3a
      version: -1
      name: Is auto approved is allowed?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "61"
      "yes":
      - "51"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: inputs.AllowAutomaticApproval
            iscontext: true
          right:
            value:
              simple: "yes"
    view: |-
      {
        "position": {
          "x": -130,
          "y": 750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "67":
    id: "67"
    taskid: e0ed265b-dd64-40b4-8bdb-346059beede1
    type: condition
    task:
      elasticcommonfields: {}
      id: e0ed265b-dd64-40b4-8bdb-346059beede1
      version: -1
      name: Is auto approved is allowed?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "60"
      "yes":
      - "47"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: inputs.AllowAutomaticApproval
            iscontext: true
          right:
            value:
              simple: "yes"
    view: |-
      {
        "position": {
          "x": -1510,
          "y": 750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "69":
    id: "69"
    taskid: 7ac103ce-22a1-4539-8798-6b289952aeb2
    type: regular
    task:
      elasticcommonfields: {}
      id: 7ac103ce-22a1-4539-8798-6b289952aeb2
      version: -1
      name: Remove other tags from indicators
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      script: Builtin|||removeIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: processed_bad,processed_suspicious,processed_unknown
      indicatorsValues:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "1"
          accessor: Indicator
      value:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "1"
          accessor: Indicator
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1180,
          "y": 1750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 1
  "70":
    id: "70"
    taskid: 997c2218-f886-41de-8cdc-ee9dc81929be
    type: regular
    task:
      elasticcommonfields: {}
      id: 997c2218-f886-41de-8cdc-ee9dc81929be
      version: -1
      name: Remove other tags from indicators
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      script: Builtin|||removeIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: processed_bad,processed_good,processed_unknown
      indicatorsValues:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "2"
          accessor: Indicator
      value:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "2"
          accessor: Indicator
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 150,
          "y": 1750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 1
  "71":
    id: "71"
    taskid: edfbe126-3144-4fb7-8165-1d3fe7789f9b
    type: regular
    task:
      elasticcommonfields: {}
      id: edfbe126-3144-4fb7-8165-1d3fe7789f9b
      version: -1
      name: Remove other tags from indicators
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      script: Builtin|||removeIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: processed_bad,processed_good,processed_suspicious
      indicatorsValues:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "0"
          accessor: Indicator
      value:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "0"
          accessor: Indicator
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 880,
          "y": 1750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 1
  "72":
    id: "72"
    taskid: 8aedb4d6-7dad-4eb0-80a8-a620808b9b79
    type: regular
    task:
      elasticcommonfields: {}
      id: 8aedb4d6-7dad-4eb0-80a8-a620808b9b79
      version: -1
      name: Remove other tags from indicators
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      script: Builtin|||removeIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: processed_unknown,processed_good,processed_suspicious
      indicatorsValues:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "3"
          accessor: Indicator
      value:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "3"
          accessor: Indicator
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2410,
          "y": 1750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 1
  "73":
    id: "73"
    taskid: 0773b64b-1363-495d-87fa-ef541b90230a
    type: title
    task:
      elasticcommonfields: {}
      id: 0773b64b-1363-495d-87fa-ef541b90230a
      version: -1
      name: Business partner Url list
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "54"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 750,
          "y": -1100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "76":
    id: "76"
    taskid: 0a0fbee4-fd48-4bde-82e6-59e63daae90e
    type: title
    task:
      elasticcommonfields: {}
      id: 0a0fbee4-fd48-4bde-82e6-59e63daae90e
      version: -1
      name: Enrichment
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "21"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 290,
          "y": 65
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "77":
    id: "77"
    taskid: f0a5eb8a-8952-45b0-82e2-261782ea610a
    type: title
    task:
      elasticcommonfields: {}
      id: f0a5eb8a-8952-45b0-82e2-261782ea610a
      version: -1
      name: Good indicators
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "46"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1310,
          "y": 385
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "78":
    id: "78"
    taskid: c53ac421-c27e-4e84-8d67-083705c3d214
    type: title
    task:
      elasticcommonfields: {}
      id: c53ac421-c27e-4e84-8d67-083705c3d214
      version: -1
      name: Suspicious indicators
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "50"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -100,
          "y": 385
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "79":
    id: "79"
    taskid: ae649aaf-f6ad-437b-8e3b-512f348d8da6
    type: title
    task:
      elasticcommonfields: {}
      id: ae649aaf-f6ad-437b-8e3b-512f348d8da6
      version: -1
      name: Unknown indicators
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "48"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1110,
          "y": 385
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "80":
    id: "80"
    taskid: 23a93f9a-ad9e-47f9-8f68-4891160a5294
    type: title
    task:
      elasticcommonfields: {}
      id: 23a93f9a-ad9e-47f9-8f68-4891160a5294
      version: -1
      name: Bad indicators
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "45"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2370,
          "y": 385
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "81":
    id: "81"
    taskid: 29a364f1-f16e-4b87-8a2e-fa7e6ae45a38
    type: regular
    task:
      elasticcommonfields: {}
      id: 29a364f1-f16e-4b87-8a2e-fa7e6ae45a38
      version: -1
      name: Manually provide tag for listed indicators
      description: Go to the next task and provide in the value field the name of
        the tag to add and select run Automation Now.
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "83"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1020,
          "y": 1215
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "82":
    id: "82"
    taskid: 51cedac9-c7b2-46a0-886b-28afc1539c1c
    type: regular
    task:
      elasticcommonfields: {}
      id: 51cedac9-c7b2-46a0-886b-28afc1539c1c
      version: -1
      name: Add manual user tag to indicators
      description: commands.local.cmd.add.values.to.indicator.multi.select.field
      script: Builtin|||appendIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "69"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${UserDefinedTag1}
      indicatorsValues:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "1"
          accessor: Indicator
          transformers:
          - operator: uniq
      value:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "1"
          accessor: Indicator
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1020,
          "y": 1570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 1
  "83":
    id: "83"
    taskid: 5dabc30e-992d-4c6f-87d5-d980ebcb00bd
    type: regular
    task:
      elasticcommonfields: {}
      id: 5dabc30e-992d-4c6f-87d5-d980ebcb00bd
      version: -1
      name: Set tags to context
      description: Sets a value into the context with the given context key
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "82"
    scriptarguments:
      append: {}
      key:
        simple: UserDefinedTag1
      stringify: {}
      value: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1020,
          "y": 1385
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "86":
    id: "86"
    taskid: e9e4e2ab-5645-48da-8847-992a866d0823
    type: regular
    task:
      elasticcommonfields: {}
      id: e9e4e2ab-5645-48da-8847-992a866d0823
      version: -1
      name: Add manual user tag to indicators
      description: commands.local.cmd.add.values.to.indicator.multi.select.field
      script: Builtin|||appendIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "70"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${UserDefinedTag2}
      indicatorsValues:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "2"
          accessor: Indicator
          transformers:
          - operator: uniq
      value:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "1"
          accessor: Indicator
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 300,
          "y": 1570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 1
  "89":
    id: "89"
    taskid: d7eb80da-7ff4-4257-86d5-c1e7efd73bf5
    type: regular
    task:
      elasticcommonfields: {}
      id: d7eb80da-7ff4-4257-86d5-c1e7efd73bf5
      version: -1
      name: Add manual user tag to indicators
      description: commands.local.cmd.add.values.to.indicator.multi.select.field
      script: Builtin|||appendIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "71"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${UserDefinedTag3}
      indicatorsValues:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "0"
          accessor: Indicator
          transformers:
          - operator: uniq
      value:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "1"
          accessor: Indicator
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 730,
          "y": 1570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 1
  "91":
    id: "91"
    taskid: 1204f004-0251-4385-814a-881622dc4049
    type: regular
    task:
      elasticcommonfields: {}
      id: 1204f004-0251-4385-814a-881622dc4049
      version: -1
      name: Add manual user tag to indicators
      description: commands.local.cmd.add.values.to.indicator.multi.select.field
      script: Builtin|||appendIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "72"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${UserDefinedTag4}
      indicatorsValues:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "3"
          accessor: Indicator
          transformers:
          - operator: uniq
      value:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "1"
          accessor: Indicator
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2160,
          "y": 1580
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 1
  "93":
    id: "93"
    taskid: 56161e94-2072-4593-80f6-56552a059345
    type: regular
    task:
      elasticcommonfields: {}
      id: 56161e94-2072-4593-80f6-56552a059345
      version: -1
      name: Manually provide tag for listed indicators
      description: Go to the next task and provide in the value field the name of
        the tag to add and select run Automation Now.
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "94"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 300,
          "y": 1215
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "94":
    id: "94"
    taskid: ef5c082d-83a2-4741-8d76-1cfe9a3d2f7e
    type: regular
    task:
      elasticcommonfields: {}
      id: ef5c082d-83a2-4741-8d76-1cfe9a3d2f7e
      version: -1
      name: Set tags to context
      description: Sets a value into the context with the given context key
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "86"
    scriptarguments:
      append: {}
      key:
        simple: UserDefinedTag2
      stringify: {}
      value: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 300,
          "y": 1385
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "95":
    id: "95"
    taskid: 9a24d9b9-e06b-4f31-8a85-0865d82e810d
    type: regular
    task:
      elasticcommonfields: {}
      id: 9a24d9b9-e06b-4f31-8a85-0865d82e810d
      version: -1
      name: Manually provide tag for listed indicators
      description: Go to the next task and provide in the value field the name of
        the tag to add and select run Automation Now.
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "96"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 730,
          "y": 1225
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "96":
    id: "96"
    taskid: 40d9e108-a98c-4b4e-8606-d6cb0a87631d
    type: regular
    task:
      elasticcommonfields: {}
      id: 40d9e108-a98c-4b4e-8606-d6cb0a87631d
      version: -1
      name: Set tags to context
      description: Sets a value into the context with the given context key
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "89"
    scriptarguments:
      append: {}
      key:
        simple: UserDefinedTag2
      stringify: {}
      value: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 730,
          "y": 1385
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "97":
    id: "97"
    taskid: bb06e61b-3355-4d6a-891a-5198d56e3268
    type: regular
    task:
      elasticcommonfields: {}
      id: bb06e61b-3355-4d6a-891a-5198d56e3268
      version: -1
      name: Manually provide tag for listed indicators
      description: Go to the next task and provide in the value field the name of
        the tag to add and select run Automation Now.
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "98"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2160,
          "y": 1215
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "98":
    id: "98"
    taskid: 42bb52ec-27c0-4e8e-8ede-c70f15aa8706
    type: regular
    task:
      elasticcommonfields: {}
      id: 42bb52ec-27c0-4e8e-8ede-c70f15aa8706
      version: -1
      name: Set tags to context
      description: Sets a value into the context with the given context key
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "91"
    scriptarguments:
      append: {}
      key:
        simple: UserDefinedTag2
      stringify: {}
      value: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2160,
          "y": 1385
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 3525,
        "width": 4480,
        "x": -1510,
        "y": -1530
      }
    }
  }
inputs:
- key: ""
  value: {}
  required: false
  description: ""
  playbookInputQuery:
    query: ''
    queryEntity: indicators
    results: null
    daterange:
      fromdate: 0001-01-01T00:00:00Z
      todate: 0001-01-01T00:00:00Z
      period:
        by: ""
        byto: ""
        byfrom: ""
        tovalue: null
        fromvalue: null
        field: ""
      fromdatelicenseval: 0001-01-01T00:00:00Z
    runFromLastJobTime: false
- key: BusinessPartnersUrlListName
  value: {}
  required: false
  description: A Demisto list containing business partners Url values. Url Indicators
    that appear in the list will be tagged as business partners.
  playbookInputQuery: null
- key: AllowAutomaticApproval
  value:
    simple: "yes"
  required: true
  description: Values will be yes or no, default is yes.
  playbookInputQuery: null
outputs: []
sourceplaybookid: 4dd3e7d3-3703-44e8-80d6-513874da3866
quiet: true
tests:
- No test