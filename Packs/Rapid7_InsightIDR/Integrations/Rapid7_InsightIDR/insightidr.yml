category: Analytics & SIEM
commonfields:
  id: rapid7_insightidr
  version: -1
configuration:
- display: Insight cloud server region (i.e EU)
  name: region
  options:
  - US
  - EU
  - CA
  - AU
  - AP
  required: true
  type: 15
- display: InsightIDR API key
  name: apiKey
  required: true
  type: 4
- display: Fetch incidents
  name: isFetch
  required: false
  type: 8
- display: Incident type
  name: incidentType
  required: false
  type: 13
- defaultvalue: 7 days
  display: First Fetch Time
  name: fetch_time
  required: false
  type: 0
  additionalinfo: First fetch timestamp (<number> <time unit>, e.g., 12 hours, 7 days.)
- additionalinfo: Max number of alerts per fetch. Defaults to 20, max is 1000.
  defaultvalue: '20'
  display: Fetch Limit
  name: max_fetch
  required: false
  type: 0
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: 'Cloud-based SIEM '
display: Rapid7 InsightIDR
name: rapid7_insightidr
script:
  commands:
  - arguments:
    - default: false
      description: An optional time range string (ie 1 week, 1 day)
      isArray: false
      name: time_range
      required: false
      secret: false
    - default: false
      description: "An optional ISO formatted timestamp. Only investigations whose\
        \ createTime is after this date will be returned by the api. If this parameter\
        \ is omitted investigations with any create_time may be returned - Use ISO\
        \ time format (i.e 2018-07-01T00:00:00Z)"
      isArray: false
      name: start_time
      required: false
      secret: false
    - default: false
      description: "An optional ISO formatted timestamp. Only investigations whose\
        \ createTime is before this date will be returned by the api. If this parameter\
        \ is omitted investigations with any create_time may be returned - Use ISO\
        \ time format (i.e 2018-07-01T00:00:00Z)"
      isArray: false
      name: end_time
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Only an investigation whose status matches one of the entries in
        the list will be returned. If this parameter is omitted investigations with
        any status may be returned.
      isArray: false
      name: statuses
      predefined:
      - open
      - closed
      required: false
      secret: false
    - default: false
      description: The optional 0 based index of the page to retrieve. Must be an
        integer greater than or equal to 0
      isArray: false
      name: index
      required: false
      secret: false
    - default: false
      description: The optional size of the page to retrieve. Must be an integer greater
        than 0 or less than or equal to 1000
      isArray: false
      name: page_size
      required: false
      secret: false
    deprecated: false
    description: List open/closed investigations
    execution: false
    name: rapid7-insight-idr-list-investigations
    outputs:
    - contextPath: Rapid7InsightIDR.Investigation.title
      description: Title of investigation
      type: String
    - contextPath: Rapid7InsightIDR.Investigation.id
      description: ID of investigation
      type: String
    - contextPath: Rapid7InsightIDR.Investigation.status
      description: Whether it is open or closed
      type: String
    - contextPath: Rapid7InsightIDR.Investigation.created_time
      description: Time the investigation was created
      type: String
    - contextPath: Rapid7InsightIDR.Investigation.source
      description: Source of the investigation
      type: String
    - contextPath: Rapid7InsightIDR.Investigation.assignee.email
      description: Email of investigation assignee
      type: String
    - contextPath: Rapid7InsightIDR.Investigation.assignee.name
      description: Name of investigation assignee
      type: String
    - contextPath: Rapid7InsightIDR.Investigation.alert.type
      description: Type of alert in the investigation
      type: String
    - contextPath: Rapid7InsightIDR.Investigation.alert.type_description
      description: Type description of alert in the investigation
      type: String
    - contextPath: Rapid7InsightIDR.Investigation.alert.first_event_time
      description: first event time of alert in the investigation
      type: String
  - arguments:
    - default: false
      description: ID of the investigation to get
      isArray: false
      name: investigation_id
      required: true
      secret: false
    deprecated: false
    description: Get a single open/closed investigation
    execution: false
    name: rapid7-insight-idr-get-investigation
    outputs:
    - contextPath: Rapid7InsightIDR.Investigation.title
      description: Title of investigation
      type: String
    - contextPath: Rapid7InsightIDR.Investigation.id
      description: ID of investigation
      type: String
    - contextPath: Rapid7InsightIDR.Investigation.status
      description: Whether it is open or closed
      type: String
    - contextPath: Rapid7InsightIDR.Investigation.created_time
      description: Time the investigation was created
      type: String
    - contextPath: Rapid7InsightIDR.Investigation.source
      description: Source of the investigation
      type: String
    - contextPath: Rapid7InsightIDR.Investigation.assignee.email
      description: Email of investigation assignee
      type: String
    - contextPath: Rapid7InsightIDR.Investigation.assignee.name
      description: Name of investigation assignee
      type: String
    - contextPath: Rapid7InsightIDR.Investigation.alert.type
      description: Type of alert in the investigation
      type: String
    - contextPath: Rapid7InsightIDR.Investigation.alert.type_description
      description: Type description of alert in the investigation
      type: String
    - contextPath: Rapid7InsightIDR.Investigation.alert.first_event_time
      description: first event time of alert in the investigation
      type: String
  - arguments:
    - default: false
      description: "An ISO formatted timestamp. Only investigations whose createTime\
        \ is after this date will be returned by the API. If this parameter is omitted\
        \ investigations with any create_time may be returned - Use ISO time format \
        (i.e 2018-07-01T00:00:00Z)"
      isArray: false
      name: start_time
      required: true
      secret: false
    - default: false
      description: "An ISO formatted timestamp. Only investigations whose createTime\
        \ is before this date will be returned by the API. If this parameter is omitted\
        \ investigations with any create_time may be returned - Use ISO time format \
        (i.e 2018-07-01T00:00:00Z)"
      isArray: false
      name: end_time
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: The name of an investigation source. Only investigations from this
        source will be closed. If the source is ALERT, an alert type must be specified
        as well.
      isArray: false
      name: source
      predefined:
      - ALERT
      - MANUAL
      - HUNT
      required: true
      secret: false
    - default: false
      description: The category of alerts that should be closed. This parameter is
        required if the source is ALERT and ignored for other sources. This value
        must exactly match the alert type returned by the List Investigations response.
      isArray: true
      name: alert_type
      required: false
      secret: false
    - default: false
      description: An optional maximum number of alerts to close with this request.
        If this parameter is not specified then there is no maximum. If this limit
        is exceeded, then a 400 error response is returned. The minimum value is 0.
      name: max_investigations_to_close
      required: false
      secret: false
    deprecated: false
    description: Close several investigations in bulk by time range
    execution: false
    name: rapid7-insight-idr-close-investigations
    outputs:
    - contextPath: Rapid7InsightIDR.Investigation.id
      description: ID of investigation
      type: String
  - arguments:
    - default: false
      description: ID of the investigation to assign the user to
      isArray: true
      name: investigation_id
      required: true
      secret: false
    - default: false
      description: The email address of the user to assign to this Investigation.
        Same email used to log into the insight platform
      isArray: false
      name: user_email_address
      required: true
      secret: false
    deprecated: false
    description: Assign a user by email to an investigation
    execution: false
    name: rapid7-insight-idr-assign-user
    outputs:
    - contextPath: Rapid7InsightIDR.Investigation.title
      description: Title of investigation
      type: String
    - contextPath: Rapid7InsightIDR.Investigation.id
      description: ID of investigation
      type: String
    - contextPath: Rapid7InsightIDR.Investigation.status
      description: Whether it is open or closed
      type: String
    - contextPath: Rapid7InsightIDR.Investigation.created_time
      description: Time the investigation was created
      type: String
    - contextPath: Rapid7InsightIDR.Investigation.source
      description: Source of the investigation
      type: String
    - contextPath: Rapid7InsightIDR.Investigation.assignee.email
      description: Email of investigation assignee
      type: String
    - contextPath: Rapid7InsightIDR.Investigation.assignee.name
      description: Name of investigation assignee
      type: String
    - contextPath: Rapid7InsightIDR.Investigation.alert.type
      description: Type of alert in the investigation
      type: String
    - contextPath: Rapid7InsightIDR.Investigation.alert.type_description
      description: Type description of alert in the investigation
      type: String
    - contextPath: Rapid7InsightIDR.Investigation.alert.first_event_time
      description: first event time of alert in the investigation
      type: String
  - arguments:
    - default: false
      description: ID of the investigation to set the status of
      isArray: true
      name: investigation_id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: The new status for the investigation
      isArray: false
      name: status
      predefined:
      - open
      - closed
      required: true
      secret: false
    deprecated: false
    description: Set investigation status to open/closed
    execution: false
    name: rapid7-insight-idr-set-status
    outputs:
    - contextPath: Rapid7InsightIDR.Investigation.title
      description: Title of investigation
      type: String
    - contextPath: Rapid7InsightIDR.Investigation.id
      description: ID of investigation
      type: String
    - contextPath: Rapid7InsightIDR.Investigation.status
      description: Whether it is open or closed
      type: String
    - contextPath: Rapid7InsightIDR.Investigation.created_time
      description: Time the investigation was created
      type: String
    - contextPath: Rapid7InsightIDR.Investigation.source
      description: Source of the investigation
      type: String
    - contextPath: Rapid7InsightIDR.Investigation.assignee_email
      description: Email of investigation assignee
      type: String
    - contextPath: Rapid7InsightIDR.Investigation.assignee_name
      description: Name of investigation assignee
      type: String
    - contextPath: Rapid7InsightIDR.Investigation.alert_type
      description: Type of alert in the investigation
      type: String
  - arguments:
    - default: false
      description: Key of the threat (or threats) to add indicators to
      isArray: true
      name: key
      required: true
      secret: false
    - default: false
      description: IPs indicators to add
      isArray: true
      name: ip_addresses
      required: false
      secret: false
    - default: false
      description: "hashes indicators to add"
      isArray: true
      name: hashes
      required: false
      secret: false
    - default: false
      description: Domain indicators to add
      isArray: true
      name: domain_names
      required: false
      secret: false
    - default: false
      description: URL indicators to add
      isArray: true
      name: url
      required: false
      secret: false
    deprecated: false
    description: Add new indicators to a threat
    execution: false
    name: rapid7-insight-idr-add-threat-indicators
    outputs:
    - contextPath: Rapid7InsightIDR.Threat.name
      description: Name of the Threat.
      type: String
    - contextPath: Rapid7InsightIDR.Threat.note
      description: Notes for the Threat.
      type: String
    - contextPath: Rapid7InsightIDR.Threat.indicator_count
      description: How many indicators the threat has.
      type: Number
    - contextPath: Rapid7InsightIDR.Threat.published
      description: Whether or not the threat is published.
      type: Boolean
  - arguments:
    - default: false
      description: Key of the threat (or threats) to replace indicators for
      isArray: true
      name: key
      required: true
      secret: false
    - default: false
      description: IPs indicators to add
      isArray: true
      name: ip_addresses
      required: false
      secret: false
    - default: false
      description: "hashes indicators to add"
      isArray: true
      name: hashes
      required: false
      secret: false
    - default: false
      description: Domain indicators to add
      isArray: true
      name: domain_names
      required: false
      secret: false
    - default: false
      description: URL indicators to add
      isArray: true
      name: url
      required: false
      secret: false
    deprecated: false
    description: Delete existing indicators and insert new ones.
    execution: false
    name: rapid7-insight-idr-replace-threat-indicators
    outputs:
    - contextPath: Rapid7InsightIDR.Threat.name
      description: Name of the Threat.
      type: String
    - contextPath: Rapid7InsightIDR.Threat.note
      description: Notes for the Threat.
      type: String
    - contextPath: Rapid7InsightIDR.Threat.indicator_count
      description: How many indicators the threat has.
      type: Number
    - contextPath: Rapid7InsightIDR.Threat.published
      description: Whether or not the threat is published.
      type: Boolean
  - arguments: []
    deprecated: false
    description: List all existing logs for an account
    execution: false
    name: rapid7-insight-idr-list-logs
    outputs:
    - contextPath: Rapid7InsightIDR.Log.name
      description: Log name
      type: String
    - contextPath: Rapid7InsightIDR.Log.id
      description: Log ID
      type: String
  - arguments: []
    deprecated: false
    description: List all existing log sets for an account
    execution: false
    name: rapid7-insight-idr-list-log-sets
    outputs:
    - contextPath: Rapid7InsightIDR.LogSet.name
      description: Log name
      type: String
    - contextPath: Rapid7InsightIDR.LogSet.id
      description: Log ID
      type: String
  - arguments:
    - default: false
      description: IDs of the logs to download - up to 10 logs allowed.
      isArray: true
      name: log_ids
      required: true
      secret: false
    - default: false
      description: "Lower bound of the time range you want to query against. Format:\
        \ UNIX timestamp in milliseconds. This is optional if time_range is supplied."
      isArray: false
      name: start_time
      required: false
      secret: false
    - default: false
      description: 'Upper bound of the time range you want to query against. Format:
        UNIX timestamp in milliseconds.'
      isArray: false
      name: end_time
      required: false
      secret: false
    - default: false
      description: "The relative time range in a readable format. Optional if from \
        is supplied. Example: Last 4 Days. Note that if start_time, end_time and\
        \ time_range is not provided - The default will be Last 3 days."
      isArray: false
      name: time_range
      required: false
      secret: false
    - default: false
      description: "The LEQL query to match desired log events. Do not use a calculation.more\
        \ info: https://docs.rapid7.com/insightidr/build-a-query/"
      isArray: false
      name: query
      required: false
      secret: false
    - default: false
      description: Max number of log events to download; cannot exceed 20 million.
        The default is 20 million (Note that a number should be written like "10 thousand"
        or "2 million")
      isArray: false
      name: limit
      required: false
      secret: false
    deprecated: false
    description: Download up to 10 logs for an account.
    execution: false
    name: rapid7-insight-idr-download-logs
    outputs: []
  - arguments:
    - default: false
      description: Logentries log key
      isArray: false
      name: log_id
      required: true
      secret: false
    - default: false
      description: "A valid LEQL query to run against the logmore info: https://docs.rapid7.com/insightidr/build-a-query/"
      isArray: false
      name: query
      required: true
      secret: false
    - default: false
      description: An optional time range string (ie 1 week, 1 day) - While using
        this parameter, start_time and end_time isn't needed
      isArray: false
      name: time_range
      required: false
      secret: false
    - default: false
      description: 'Lower bound of the time range you want to query against. Format:
        UNIX timestamp in milliseconds. Example:1450557004000'
      isArray: false
      name: start_time
      required: false
      secret: false
    - default: false
      description: 'Upper bound of the time range you want to query against. Format:
        UNIX timestamp in milliseconds. Example:1460557604000'
      isArray: false
      name: end_time
      required: false
      secret: false
    - default: false
      description: The number of log entries to return per page. Default of 50
      isArray: false
      name: logs_per_page
      required: false
      secret: false
    - default: false
      description: the earlier sequence number of a log entry to start searching from
      isArray: false
      name: sequence_number
      required: false
      secret: false
    deprecated: false
    description: Query inside a log for certain values.
    execution: false
    name: rapid7-insight-idr-query-log
    outputs:
    - contextPath: Rapid7InsightIDR.Event.log_id
      description: Event message
      type: String
    - contextPath: Rapid7InsightIDR.Event.message
      description: ID of the log the event appears in
      type: String
    - contextPath: Rapid7InsightIDR.Event.timestamp
      description: Time when the event fired
      type: Number
  - arguments:
    - default: false
      description: log set ID
      isArray: true
      name: log_set_id
      required: true
      secret: false
    - default: false
      description: "A valid LEQL query to run against the logmore info: https://docs.rapid7.com/insightidr/build-a-query/"
      isArray: false
      name: query
      required: true
      secret: false
    - default: false
      description: An optional time range string (ie 1 week, 1 day) - While using
        this parameter, start_time and end_time isn't needed
      isArray: false
      name: time_range
      required: false
      secret: false
    - default: false
      description: 'Lower bound of the time range you want to query against. Format:
        UNIX timestamp in milliseconds. Example:1450557004000'
      isArray: false
      name: start_time
      required: false
      secret: false
    - default: false
      description: 'Upper bound of the time range you want to query against. Format:
        UNIX timestamp in milliseconds. Example:1460557604000'
      isArray: false
      name: end_time
      required: false
      secret: false
    - default: false
      description: The number of log entries to return per page. Default of 50
      isArray: false
      name: logs_per_page
      required: false
      secret: false
    - default: false
      description: the earlier sequence number of a log entry to start searching from
      isArray: false
      name: sequence_number
      required: false
      secret: false
    deprecated: false
    description: Query inside a log set for certain values.
    execution: false
    name: rapid7-insight-idr-query-log-set
    outputs:
    - contextPath: Rapid7InsightIDR.Event.log_id
      description: Event message
      type: String
    - contextPath: Rapid7InsightIDR.Event.message
      description: ID of the log the event appears in
      type: String
    - contextPath: Rapid7InsightIDR.Event.timestamp
      description: Time when the event fired
      type: Number
  dockerimage: demisto/python3:3.8.6.13358
  feed: false
  isfetch: true
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  subtype: python3
  type: python
tests:
- playbook-InsightIDR-test
fromversion: 5.0.0