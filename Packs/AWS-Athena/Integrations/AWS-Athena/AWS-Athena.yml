commonfields:
  id: AWS - Athena
  version: -1
name: AWS - Athena
display: AWS - Athena
category: IT Services
description: Amazon Web Services Athena.
configuration:
- display: Role Arn
  name: roleArn
  type: 0
  required: false
  section: Connect
- display: Role Session Name
  name: roleSessionName
  type: 0
  required: false
  section: Connect
- display: Role Session Duration
  name: sessionDuration
  type: 0
  required: false
  section: Connect
  advanced: true
- display: AWS Default Region
  name: defaultRegion
  options:
  - us-east-1
  - us-east-2
  - us-west-1
  - us-west-2
  - ca-central-1
  - eu-west-1
  - eu-central-1
  - eu-west-2
  - ap-northeast-1
  - ap-northeast-2
  - ap-southeast-1
  - ap-southeast-2
  - ap-south-1
  - sa-east-1
  - eu-north-1
  - eu-west-3
  - us-gov-east-1
  - us-gov-west-1
  type: 15
  required: false
  section: Connect
- display: Access Key
  name: credentials
  type: 9
  displaypassword: Secret Key
  required: true
  section: Connect
- display: Timeout
  name: timeout
  additionalinfo: The time in seconds until a timeout exception is reached. You can specify just the read timeout (for example 60) or also the connect timeout followed after a comma (for example 60,10). If a connect timeout is not specified, a default of 10 second will be used.
  defaultvalue: 60,10
  type: 0
  section: Connect
  required: false
  advanced: true
- display: Retries
  name: retries
  defaultvalue: 5
  additionalinfo: "The maximum number of retry attempts when connection or throttling errors are encountered. Set to 0 to disable retries. The default value is 5 and the limit is 10. Note: Increasing the number of retries will increase the execution time."
  type: 0
  required: false
  section: Connect
  advanced: true
- display: Trust any certificate (not secure)
  name: insecure
  type: 8
  required: false
  section: Connect
- display: Use system proxy settings
  name: proxy
  type: 8
  required: false
  section: Connect
script:
  script: ''
  type: python
  commands:
  - name: aws-athena-start-query
    arguments:
    - name: QueryString
      required: true
      description: The SQL query statements to be executed.
    - name: ClientRequestToken
      auto: PREDEFINED
      predefined:
      - private
      - public-read
      - public-read-write
      - authenticated-read
      description: A unique case-sensitive string used to ensure the request to create the query is idempotent (executes only once).
    - name: Database
      description: The name of the database.
    - name: OutputLocation
      description: he location in Amazon S3 where your query results are stored, such as s3://path/to/query/bucket/.
    - name: EncryptionOption
      description: Indicates whether Amazon S3 server-side encryption with Amazon S3-managed keys (SSE-S3 ), server-side encryption with KMS-managed keys (SSE-KMS ), or client-side encryption with KMS-managed keys (CSE-KMS) is used.
    - name: KmsKey
      description: For SSE-KMS and CSE-KMS , this is the KMS key ARN or ID.
    - name: WorkGroup
      description: The name of the workgroup in which the query is being started.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range from 900 seconds (15 minutes) up to the maximum session duration setting for the role.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    outputs:
      - contextPath: AWS.Athena.StartQuery
        description: ID of the newly created query.
        type: String
      - contextPath: AWS.Athena.QueryString
        description: Object size.
        type: String
    description: Start Athena Query.
  - name: aws-athena-stop-query
    arguments:
    - name: QueryExecutionId
      required: true
      description: The unique ID of the query execution to stop.  This field is auto-populated if not provided.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range from 900 seconds (15 minutes) up to the maximum session duration setting for the role.
    description: Stops a query execution. Requires you to have access to the workgroup in which the query ran.
  - name: aws-athena-get-query-execution
    arguments:
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range from 900 seconds (15 minutes) up to the maximum session duration setting for the role.
    - name: QueryExecutionId
      required: true
      description: The unique ID of the query execution.
    outputs:
      - contextPath: AWS.Athena.QueryExecution
        description: Query execution details.
        type: Dictionary
    description: Returns information about a single execution of a query if you have access to the workgroup in which the query ran.
  - name: aws-athena-get-query-results
    arguments:
    - name: QueryExecutionId
      required: true
      description: The unique ID of the query execution.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range from 900 seconds (15 minutes) up to the maximum session duration setting for the role.
    outputs:
      - contextPath: AWS.Athena.QueryResults
        description: List of query results.
        type: List
    description: Returns the results of a single query execution specified by QueryExecutionId if you have access to the workgroup in which the query ran.
  dockerimage: demisto/boto3py3:1.0.0.79944
  subtype: python3
tests:
- Athena-Test
fromversion: 5.0.0
