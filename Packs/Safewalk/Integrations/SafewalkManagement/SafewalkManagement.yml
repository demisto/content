commonfields:
  id: Safewalk_Management
  version: -1
name: Safewalk_Management
display: Safewalk_Management
category: Authentication
description: Safewalk server integration
detaileddescription: |2
   ### Safewalk XSOAR Integration
   #### Integration Author: Altipeak
configuration:
- display: Server URL (e.g. https://soar.monstersofhack.com)
  name: url
  defaultvalue: https://safewalk-server.company.com:8443/
  type: 0
  required: true
- display: Fetch incidents
  name: isFetch
  type: 8
  required: false
- display: Incident type
  name: incidentType
  type: 13
  required: false
- display: API Key
  name: apikey
  defaultvalue: f8ee1ee7135d547368122410e19436d47fc351dc
  type: 4
  required: true
- display: Trust any certificate (not secure)
  name: insecure
  defaultvalue: "false"
  type: 8
  required: false
- display: Use system proxy settings
  name: proxy
  type: 8
  required: false
- display: Fetch indicators
  name: feed
  type: 8
  required: false
- display: Incidents Fetch Interval
  name: incidentFetchInterval
  defaultvalue: "1"
  type: 19
  required: false
- name: feedReputation
  display: Indicator Reputation
  type: 18
  required: false
  options:
  - None
  - Good
  - Suspicious
  - Bad
  additionalinfo: Indicators from this integration instance will be marked with this
    reputation
- name: feedReliability
  display: Source Reliability
  type: 15
  required: true
  options:
  - A - Completely reliable
  - B - Usually reliable
  - C - Fairly reliable
  - D - Not usually reliable
  - E - Unreliable
  - F - Reliability cannot be judged
  additionalinfo: Reliability of the source providing the intelligence data
- name: feedExpirationPolicy
  display: ''
  type: 17
  required: false
  options:
  - never
  - interval
  - indicatorType
  - suddenDeath
- name: feedExpirationInterval
  display: ''
  type: 1
  required: false
- name: feedFetchInterval
  display: Feed Fetch Interval
  type: 19
  required: false
- name: feedBypassExclusionList
  display: Bypass exclusion list
  type: 8
  required: false
  additionalinfo: When selected, the exclusion list is ignored for indicators from
    this feed. This means that if an indicator from this feed is on the exclusion
    list, the indicator might still be added to the system.
- name: feedTags
  display: Tags
  required: false
  type: 0
  additionalinfo: Supports CSV values.
- name: tlp_color
  display: Traffic Light Protocol Color
  options:
  - RED
  - AMBER
  - GREEN
  - WHITE
  required: false
  type: 15
  additionalinfo: The Traffic Light Protocol (TLP) designation to apply to indicators
    fetched from the feed
script:
  commands:
  - name: safewalk-get-transactionlog
    arguments:
    - name: page
      description: Pages to be displayed.
    - name: search
      description: User to search.
    - name: locked
    description: Display transaction log.
  - name: safewalk-get-users
    arguments:
    - name: page
    - name: search
    - name: locked
    description: Search local users.
  - name: safewalk-get-ldap-users
    arguments:
    - name: page
    - name: search
    - name: locked
    - name: ldap
    description: Search LDAP users
  - name: safewalk-get-ldaps
    arguments: []
    description: Get LDAP configuration.
  - name: safewalk-get-user-personalinformation
    arguments:
    - name: username
      description: Username to display.
    description: Get users personal information.
  - name: safewalk-set-user-personalinformation
    arguments:
    - name: username
    - name: email
    - name: mobile_phone
    description: Set user personal information.
  - name: safewalk-get-user-accessattempts
    arguments:
    - name: username
    description: Get user access attempts
  - name: safewalk-delete-user-accessattempts
    arguments:
    - name: username
    description: Delete user access attempts
  - name: safewalk-create-user-token
    arguments:
    - name: username
    - name: params
    description: Create user token
  - name: safewalk-update-user-token
    arguments:
    - name: username
    - name: token_devicetype
    - name: token_serialnumber
    - name: params
    description: Update user token.
  - name: safewalk-get-user-tokens
    arguments:
    - name: username
    description: Get user tokens
  - name: safewalk-delete-user-token
    arguments:
    - name: username
    - name: devicetype
    - name: serialnumber
    description: Delete user token.
  - name: safewalk-send-user-virtualtoken
    arguments:
    - name: username
    - name: token_devicetype
    - name: token_serialnumber
    description: Send user virtual token.
  - name: safewalk-get-user-settings
    arguments:
    - name: username
    description: Get user settings.
  - name: safewalk-get-user-group
    arguments:
    - name: username
    description: Get user group.
  - name: safewalk-add-user-group
    arguments:
    - name: username
    - name: new-group-name
    description: Add user group.
  - name: safewalk-remove-user-group
    arguments:
    - name: username
    - name: old-group-name
    description: Remove user group.
  - name: safewalk-get-user-registrationcode
    arguments:
    - name: username
    description: Get user registration code
  - name: safewalk-set-user-registrationcode
    arguments:
    - name: username
    - name: expiration
    - name: attempts-left
    description: Set user registration code
  - name: safewalk-send-user-registrationcode
    arguments:
    - name: username
    description: Send user registration code
  - name: safewalk-create-user-token-virtual
    arguments:
    - name: username
    description: Create user virtual token
  - name: safewalk-create-user-token-fastauth
    arguments:
    - name: username
    - name: serial-number
    description: Create user FastAuth Token
  - name: safewalk-create-user-token-totpmobile
    arguments:
    - name: username
    - name: serial-number
    - name: password-required
    description: Create user TopMobile Token
  - name: safewalk-create-user-token-totmobilehybrid
    arguments:
    - name: username
    - name: serial-number
    description: Create user TotMobileHybrid
  - name: safewalk-create-user-token-physical
    arguments:
    - name: username
    - name: serial-number
    - name: password-required
    description: Create user Physical Token
  - name: safewalk-create-user-token-backup
    arguments:
    - name: username
    - name: password-required
    - name: backuptoken-timeout
    - name: backuptoken_attempts
    description: Create user Backup Token
  - name: safewalk-set-user-backuptoken-settings
    arguments:
    - name: username
    - name: backup-password-required
    - name: backuptoken-attempts
    - name: backuptoken-timeout
  - name: safewalk-set-user-general-settings
    arguments:
    - name: username
    - name: user-storage
  - name: safewalk-set-user-hotpauthentication-settings
    arguments:
    - name: username
    - name: hotp-accept-tolerance
    - name: hotp-resend-tolerance
    - name: hotp-resend-timeout
    - name: hotp-password_required
    - name: hotp-flex-password-required
    - name: hotp-flex-pin-password-required
  - name: safewalk-set-user-sesamiauthentication-settings
    arguments:
    - name: username
    - name: sesami_mobile_password_required
    - name: sesami_slim_password_required
    - name: gaia_ttw_level
  - name: safewalk-set-user-totpauthentication-settings
    arguments:
    - name: username
    - name: totp-accept-tolerance
    - name: totp-resend-tolerance
    - name: totp-resend-timeout
    - name: totp-password-required
    - name: totp-flex-password-required
    - name: totp-flex-pin-password-required
    - name: totp-mobile-password-required
  - name: safewalk-set-user-userauthentication-settings
    arguments:
    - name: username
    - name: multiple-step-auth-timeout
    - name: allow-password
    - name: allow-password-for-registration
    - name: max-allowed-failures
    - name: allow-access-when-pwd-expired
    - name: allow-password-reset-when-forgot-pwd
    - name: min-otp-length
    - name: max-otp-length
    - name: dos-tmp-lockdown-max-fail-authentications
    - name: dos-tmp-lockdown-time-interval-in-seconds
    - name: dos-tmp-lockdown-time-in-seconds
  - name: safewalk-set-user-virtualauthentication-settings
    arguments:
    - name: username
    - name: virtual-device-accept-tolerance
    - name: virtual-device-gateways
  - name: safewalk-create-user
    arguments:
    - name: username
    - name: password
    - name: firstname
    - name: lastname
    - name: mobilephone
    - name: email
  - name: safewalk-delete-user
    arguments:
    - name: username
  dockerimage: demisto/python3:3.9.5.20070
  isfetch: true
  feed: true
  runonce: false
  script: '-'
  subtype: python3
  type: python
  isFetchSamples: true
tests:
- No tests (auto formatted)
