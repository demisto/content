commonfields:
  id: Safewalk_reports
  version: -1
vcShouldKeepItemLegacyProdMachine: false
name: Safewalk_Reports
display: Safewalk_reports
category: Analytics & SIEM
image: data:image/png;base64,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
description: Safewalk server integration
detaileddescription: |2
   ### Safewalk XSOAR Integration
   #### Integration Author: Altipeak
configuration:
- display: Server URL (e.g. https://soar.monstersofhack.com)
  name: url
  defaultvalue: https://safewalk-server.company.com:8443/
  type: 0
  required: true
- display: Fetch incidents
  name: isFetch
  type: 8
  required: false
- display: Incident type
  name: incidentType
  type: 13
  required: false
- display: API Key
  name: apikey
  defaultvalue: 
  type: 4
  required: true
- display: Trust any certificate (not secure)
  name: insecure
  defaultvalue: "true"
  type: 8
  required: false
- display: Use system proxy settings
  name: proxy
  type: 8
  required: false
- display: Fetch indicators
  name: feed
  type: 8
  required: false
- display: Incidents Fetch Interval
  name: incidentFetchInterval
  defaultvalue: "1"
  type: 19
  required: false
- display: ""
  name: first_fetch
  defaultvalue: 0 minutes
  type: 0
  required: false
- display: ""
  name: max_fetch
  defaultvalue: "50"
  type: 0
  required: false
- display: ""
  name: fetch_query_filter
  defaultvalue: ACCESS_DENIED,USER_DOES_NOT_EXIST,INVALID_OTP
  type: 0
  required: false
script:
  script: |
    from datetime import datetime, timedelta
    import json
    import urllib3
    import json
    import dateparser
    import traceback
    from typing import Any, Dict, Tuple, List, Optional, Union, cast



    urllib3.disable_warnings()



    DATE_FORMAT = '%Y-%m-%dT%H:%M:%SZ'
    MAX_INCIDENTS_TO_FETCH = 50
    HELLOWORLD_SEVERITIES = ['Low', 'Medium', 'High', 'Critical']



    class Client(BaseClient):

        def get_associated_users(self, devicetype):
            return self._http_request(
                method='GET',
                url_suffix='/reports/associated_users/?device_type=%s' % (devicetype),
                resp_type='text'
            )

        def get_authentication_methods_distribution(self):
            return self._http_request(
                method='GET',
                url_suffix='/reports/device_auth_distribution/',
                resp_type='text'
            )

        def get_authentication_rate_per_device(self):
            return self._http_request(
                method='GET',
                url_suffix='/reports/device_auth_rate/',
                resp_type='text'
            )

        def get_least_active_users(self, sincedate=None, userinformation=False):
            if sincedate==None:
                sincedate = (datetime.now() - timedelta(days=30)).strftime("%Y-%m-%d")

            return self._http_request(
                method='GET',
                url_suffix='/reports/inactive_users/?since_date=%s&user_information=%s' % (sincedate, str(userinformation)),
                resp_type='text'
            )

        def get_licenses_inventory(self):
            return self._http_request(
                method='GET',
                url_suffix='/reports/device_inventory/',
                resp_type='text'
            )

        def get_licenses_usage(self, begindate=None, enddate=None):
            if begindate==None:
                begindate = (datetime.now() - timedelta(days=90)).strftime("%Y-%m-%d")

            if enddate==None:
                enddate = (datetime.now() - timedelta(days=30)).strftime("%Y-%m-%d")

            return self._http_request(
                method='GET',
                url_suffix='/reports/licensesusage/?begin_date=%s&end_date=%s' % (begindate, enddate),
                resp_type='text'
            )

        def get_most_active_users(self, days=10, limit=30, userinformation=False):
            return self._http_request(
                method='GET',
                url_suffix='/reports/top_users/?days=%s&limit=%s&user_information=%s' % (str(days), str(limit), str(userinformation)),
                resp_type='text'
            )

        def get_physical_tokens_inventory(self):
            return self._http_request(
                method='GET',
                url_suffix='/reports/physical_tokens_inventory/',
                resp_type='text'
            )

        def get_registered_devices_distribution(self):
            return self._http_request(
                method='GET',
                url_suffix='/reports/device_inventory/?fields=associated_and_registered',
                resp_type='text'
            )

        def get_registration(self, begindate=None, enddate=None, userinformation=False):
            if begindate==None:
                begindate = (datetime.now() - timedelta(days=90)).strftime("%Y-%m-%d")

            if enddate==None:
                enddate = (datetime.now() - timedelta(days=30)).strftime("%Y-%m-%d")

            return self._http_request(
                method='GET',
                url_suffix='/reports/registrations/?begin_date=%s&end_date=%s&user_information=%s' % (begindate, enddate, str(userinformation)),
                resp_type='text'
            )

        def get_users_associations_indicators(self):
            return self._http_request(
                method='GET',
                url_suffix='/reports/users/',
                resp_type='text'
            )

        def list_incidents(self, page, search, locked, query_filter=None) -> Dict[str, Any]:
            if page == None:
                page = 1

            p_search=""
            if search != None and search != '':
                p_search = '&search=%s' % search

            p_locked = ""
            if locked != None and locked:
                p_locked = '&locked=%s' % "true"

            p_query_filter = ""
            if query_filter != None:
                p_query_filter = '&q=%s' % query_filter

            return self._http_request(
                method='GET',
                url_suffix='/transactionlog/?page=%s%s%s%s' % (page, p_search, p_locked, p_query_filter),
                resp_type = 'text'
            )



    def get_associated_users(client, args):

        devicetype = args.get('devicetype')

        result = client.get_associated_users(devicetype)

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='GetAssociatedUsers.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results


    def get_authentication_methods_distribution(client, args):

        result = client.get_authentication_methods_distribution()

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='GetAuthenticationMethodsDistribution.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results


    def get_authentication_rate_per_device(client, args):
        result = client.get_authentication_rate_per_device()

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='GetAuthenticationRatePerDevice.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results


    def get_least_active_users(client, args):
        sincedate = args.get('sincedate')
        userinformation = args.get('userinformation')

        result = client.get_least_active_users(sincedate, userinformation)

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='GetLeastActiveUsers.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results


    def get_licenses_inventory(client, args):

        result = client.get_licenses_inventory()

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='GetLicensesInventory.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results


    def get_licenses_usage(client, args):
        begindate = args.get('begindate')
        enddate = args.get('enddate')

        result = client.get_licenses_usage(begindate, enddate)

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='GetLicensesUsage.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results


    def get_most_active_users(client, args):
        days = args.get('days')
        limit = args.get('limit')
        userinformation = args.get('userinformation')

        result = client.get_most_active_users(days, limit, userinformation)

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='GetMostActiveUsers.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results


    def get_physical_tokens_inventory(client, args):

        result = client.get_physical_tokens_inventory()

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='GetPhysicalTokensInventory.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results


    def get_registered_devices_distribution(client, args):

        result = client.get_registered_devices_distribution()

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='GetRegisteredDevicesDistribution.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results


    def get_registration(client, args):
        begindate = args.get('begindate')
        enddate = args.get('enddate')
        userinformation = args.get('userinformation')

        result = client.get_registration(begindate, enddate, userinformation)

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='GetRegistration.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results


    def get_users_associations_indicators(client, args):

        result = client.get_users_associations_indicators()

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='GetUsersAssociationsIndicators.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results


    def test_module(client, args):
        results = json.loads(client.list_incidents(None, None, None, None))['results']

        if results is not None:
            return 'Test executed successfully'
        else:
            return 'Failed to run the test'


    def fetch_incidents(client, last_run, first_fetch_str, fetch_limit, query_filter=None,
                        auto_generate_filter=False, context=None):
        incidents = []

        first_fetch = dateparser.parse(first_fetch_str).strftime(DATE_FORMAT)
        last_run_time = last_run.get('last_run_time', first_fetch)
        next_run_time = last_run_time

        #Last run time must be used to filter transaction log
        results = []
        if query_filter is not None:
            q_list = query_filter.split(',')
            for q in q_list:
                if q!='':
                    tmp = json.loads(client.list_incidents(None, None, None, q))['results']
                    results.extend([element for element in tmp if element not in results])
        else:
            results = json.loads(client.list_incidents(None, None, None, query_filter))['results']

        for result in results:
            incident_time = dateparser.parse(result['timestamp']).strftime(DATE_FORMAT)

            #This condition is temporal
            if incident_time > last_run_time:
                incident = {
                    'name': result['reason_detail'],
                    'occurred': incident_time,
                    'rawJSON': json.dumps(result)
                }
                incidents.append(incident)

                if incident_time > next_run_time:
                    next_run_time = incident_time

        next_run = {
            'last_run_time': next_run_time
        }

        return incidents[:int(fetch_limit)], next_run



    def main():

        base_url = demisto.params()['url']
        base_url = base_url + 'api/v1/admin/'
        demisto.info('BASE_URL'+base_url)
        verify_certificate = demisto.params().get('insecure', True)
        auth_access_token = demisto.params()['apikey']
        proxy = demisto.params().get('proxy', False)

        fetch_limit = (demisto.params().get('max_fetch'))
        first_fetch_str = demisto.params().get('first_fetch')
        auto_generate_query_filter = demisto.params().get('auto_generate_query_filter')
        fetch_query_filter = demisto.params().get('fetch_query_filter')
        context = demisto.getIntegrationContext()


        demisto.debug(f'Command being called is {demisto.command()}')
        try:
            client = Client(
                base_url=base_url,
                verify=verify_certificate,
                headers={'Authorization': 'Bearer %s' % auth_access_token},
                proxy=proxy)

            if demisto.command() == 'safewalk-get-associated-users':
                result = get_associated_users(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-get-authentication-methods-distribution':
                result = get_authentication_methods_distribution(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-get-authentication-rate-per-device':
                result = get_authentication_rate_per_device(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-get-least-active-users':
                result = get_least_active_users(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-get-licenses-inventory':
                result = get_licenses_inventory(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-get-licenses-usage':
                result = get_licenses_usage(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-get-most-active-users':
                result = get_most_active_users(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-get-physical-tokens-inventory':
                result = get_physical_tokens_inventory(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-get-registered-devices-distribution':
                result = get_registered_devices_distribution(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-get-registration':
                result = get_registration(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-get-users-associations-indicators':
                result = get_users_associations_indicators(client, demisto.args())
                return_results(result)

            if demisto.command() == 'test-module':
                result = test_module(client, demisto.args())
                return_results(result)

            if demisto.command() == 'fetch-incidents':
                last_run = demisto.getLastRun()
                context = demisto.getIntegrationContext()
                incidents, next_run = fetch_incidents(client, last_run, first_fetch_str, fetch_limit, fetch_query_filter,
                                                      auto_generate_query_filter, context)
                demisto.incidents(incidents)
                demisto.setLastRun(next_run)

        except Exception as e:
            return_error(f'Failed to execute {demisto.command()} command. Error: {str(e)}')



    if __name__ in ('__main__', '__builtin__', 'builtins'):
        main()
  type: python
  commands:
  - name: safewalk-get-associated-users
    arguments:
    - name: devicetype
  - name: safewalk-get-authentication-methods-distribution
    arguments: []
  - name: safewalk-get-authentication-rate-per-device
    arguments: []
  - name: safewalk-get-least-active-users
    arguments:
    - name: sincedate
    - name: userinformation
  - name: safewalk-get-licenses-inventory
    arguments: []
  - name: safewalk-get-licenses-usage
    arguments:
    - name: begindate
    - name: enddate
  - name: safewalk-get-most-active-users
    arguments:
    - name: days
    - name: limit
    - name: userinformation
  - name: safewalk-get-physical-tokens-inventory
    arguments: []
  - name: safewalk-get-registered-devices-distribution
    arguments: []
  - name: safewalk-get-registration
    arguments:
    - name: begindate
    - name: enddate
    - name: userinformation
  - name: safewalk-get-users-associations-indicators
    arguments: []
  dockerimage: demisto/python3:3.9.1.14969
  isfetch: true
  feed: true
  runonce: false
  subtype: python3
  ismappable: true
  isFetchSamples: true
sourcemoduleid: Safewalk
