commonfields:
  id: Safewalk_Management
  version: -1
name: Safewalk_Management
display: Safewalk_Management
category: Authentication
image: data:image/png;base64,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
description: Safewalk server integration
detaileddescription: |2
   ### Safewalk XSOAR Integration
   #### Integration Author: Altipeak
configuration:
- display: Server URL (e.g. https://soar.monstersofhack.com)
  name: url
  defaultvalue: https://safewalk-server.company.com:8443/
  type: 0
  required: true
- display: Fetch incidents
  name: isFetch
  type: 8
  required: false
- display: Incident type
  name: incidentType
  type: 13
  required: false
- display: API Key
  name: apikey
  defaultvalue: f8ee1ee7135d547368122410e19436d47fc351dc
  type: 4
  required: true
- display: Trust any certificate (not secure)
  name: insecure
  defaultvalue: "false"
  type: 8
  required: false
- display: Use system proxy settings
  name: proxy
  type: 8
  required: false
- display: Fetch indicators
  name: feed
  type: 8
  required: false
- display: Incidents Fetch Interval
  name: incidentFetchInterval
  defaultvalue: "1"
  type: 19
  required: false
- name: feedReputation
  display: Indicator Reputation
  type: 18
  required: false
  options:
  - None
  - Good
  - Suspicious
  - Bad
  additionalinfo: Indicators from this integration instance will be marked with this
    reputation
- name: feedReliability
  display: Source Reliability
  type: 15
  required: true
  options:
  - A - Completely reliable
  - B - Usually reliable
  - C - Fairly reliable
  - D - Not usually reliable
  - E - Unreliable
  - F - Reliability cannot be judged
  additionalinfo: Reliability of the source providing the intelligence data
- name: feedExpirationPolicy
  display: ''
  type: 17
  required: false
  options:
  - never
  - interval
  - indicatorType
  - suddenDeath
- name: feedExpirationInterval
  display: ''
  type: 1
  required: false
- name: feedFetchInterval
  display: Feed Fetch Interval
  type: 19
  required: false
- name: feedBypassExclusionList
  display: Bypass exclusion list
  type: 8
  required: false
  additionalinfo: When selected, the exclusion list is ignored for indicators from
    this feed. This means that if an indicator from this feed is on the exclusion
    list, the indicator might still be added to the system.
- name: feedTags
  display: Tags
  required: false
  type: 0
  additionalinfo: Supports CSV values.
- name: tlp_color
  display: Traffic Light Protocol Color
  options:
  - RED
  - AMBER
  - GREEN
  - WHITE
  required: false
  type: 15
  additionalinfo: The Traffic Light Protocol (TLP) designation to apply to indicators
    fetched from the feed
script:
  script: |-
    import urllib3
    import json
    from typing import Any, Dict



    urllib3.disable_warnings()



    DATE_FORMAT = '%Y-%m-%dT%H:%M:%SZ'
    MAX_INCIDENTS_TO_FETCH = 50
    HELLOWORLD_SEVERITIES = ['Low', 'Medium', 'High', 'Critical']



    class Client(BaseClient):

        def get_transactionlog(self, page, search, locked) -> Dict[str, Any]:
            if page is None:
                page = 1

            p_search=""
            if search is not None and search != '':
                p_search = '&search=%s' % search

            p_locked = ""
            if locked is not None and locked:
                p_locked = '&locked=%s' % "true"

            return self._http_request(
                method='GET',
                url_suffix='/transactionlog/?page=%s%s%s' % (page, p_search, p_locked),
                resp_type = 'text'
            )

        def get_users(self, page, search, locked) -> Dict[str, Any]:
            if page is None:
                page = 1

            p_search=""
            if search is not None and search != '':
                p_search = '&search=%s' % search

            p_locked = ""
            if locked is not None and locked:
                p_locked = '&locked=%s' % "true"

            return self._http_request(
                method='GET',
                url_suffix='/userlist/?page=%s%s%s' % (page, p_search, p_locked),
                resp_type = 'text'
            )

        def get_ldap_users(self, page, search, locked, ldap) -> Dict[str, Any]:
            if page is None:
                page = 1

            p_search = ""
            if search is not None and search != '':
                p_search = '&search=%s' % search

            p_locked = ""
            if locked is not None and locked:
                p_locked = '&locked=%s' % "true"

            return self._http_request(
                method='GET',
                url_suffix='/userlist/%s/?page=%s%s%s' % (ldap, page, p_search, p_locked),
                resp_type = 'text'
            )

        def get_ldaps(self) -> Dict[str, Any]:
            return self._http_request(
                method='GET',
                url_suffix='/ldapconfiguration/',
                resp_type = 'text'
            )

        def get_user_personalinformation(self, username) -> Dict[str, Any]:
            return self._http_request(
                method='GET',
                url_suffix='/user/%s/'% username,
                resp_type = 'text'
            )

        def set_user_personalinformation(self, username, email, mobile_phone) -> Dict[str, Any]:
            post_params = {}
            if email:
                post_params['email'] = email
            if mobile_phone:
                post_params['mobile_phone'] = mobile_phone

            return self._http_request(
                method='PUT',
                url_suffix='/user/%s/'% username,
                json_data=post_params,
                resp_type = 'text'
            )

        def get_user_accessattempts(self, username) -> Dict[str, Any]:
            return self._http_request(
                method='GET',
                url_suffix='/user/%s/access_attempt/' % username,
                resp_type = 'text'
            )

        def delete_user_accessattempts(self, username) -> Dict[str, Any]:
            return self._http_request(
                method='DELETE',
                url_suffix='/user/%s/access_attempt/' % username,
                resp_type = 'text'
            )

        #Get "params" to generalize all token types. Said argument must be a dictionary or json with the data corresponding to the token to be registered
        def create_user_token(self, username, post_params) -> Dict[str, Any]:
            return self._http_request(
                method='POST',
                url_suffix='/user/%s/devices/' % username,
                json_data=post_params,
                resp_type = 'text'
            )

        def update_user_token(self, username, token_devicetype, token_serialnumber, post_params) -> Dict[str, Any]:
            return self._http_request(
                method='PUT',
                url_suffix='/user/%s/devices/%s/%s/' % (username, token_devicetype, token_serialnumber),
                json_data=post_params,
                resp_type = 'text'
            )

        def get_user_tokens(self, username) -> Dict[str, Any]:
            return self._http_request(
                method='GET',
                url_suffix='/user/%s/devices/' % username,
                resp_type = 'text'
            )

        def delete_user_token(self, username, token_devicetype, token_serialnumber) -> Dict[str, Any]:
            return self._http_request(
                method='DELETE',
                url_suffix='/user/%s/devices/%s/%s/' % (username, token_devicetype, token_serialnumber),
                resp_type = 'text'
            )

        def send_user_token(self, username, token_devicetype, token_serialnumber) -> Dict[str, Any]:
            return self._http_request(
                method='POST',
                url_suffix='/user/%s/devices/%s/%s/send/' % (username, token_devicetype, token_serialnumber),
                resp_type = 'text'
            )

        def send_user_virtualtoken(self, username, token_devicetype, token_serialnumber) -> Dict[str, Any]:
            return self._http_request(
                method='POST',
                url_suffix='/devices/<device_type>/<serial_number>/code/' % (token_devicetype, token_serialnumber),
                resp_type = 'text'
            )

        def get_user_settings(self, username) -> Dict[str, Any]:
            return self._http_request(
                method='GET',
                url_suffix='/user/%s/settings/' % username,
                resp_type = 'text'
            )

        #Get "params" to generalize all configuration items. This argument must be a dictionary or json with the items that you want to modify
        def set_user_settings(self, username, post_params) -> Dict[str, Any]:
            return self._http_request(
                method='PATCH',
                url_suffix='/user/%s/settings/' % username,
                json_data=post_params,
                resp_type = 'text'
            )

        def get_user_group(self, username) -> Dict[str, Any]:
            return self._http_request(
                method='GET',
                url_suffix='/user/%s/group/' % username,
                resp_type = 'text'
            )

        def add_user_group(self, username, new_group_name) -> Dict[str, Any]:
            post_params = {'username':username}

            return self._http_request(
                method='POST',
                url_suffix='/group/%s/member/' % new_group_name,
                json_data=post_params,
                resp_type = 'text'
            )

        def remove_user_group(self, username, old_group_name) -> Dict[str, Any]:
            return self._http_request(
                method='DELETE',
                url_suffix='/group/%s/member/%s/' % (old_group_name, username),
                resp_type = 'text'
            )

        def get_user_registrationcode(self, username) -> Dict[str, Any]:
            return self._http_request(
                method='GET',
                url_suffix='/user/%s/registrationtoken/' % username,
                resp_type = 'text'
            )

        def set_user_registrationcode(self, username, expiration, attempts_left) -> Dict[str, Any]:

            post_params = {
                'username': username,
                'expiration': expiration,
                'attempts_left': attempts_left,
                'sent_on': '',
                'sent_by': '',
                'token': ''
            }

            return self._http_request(
                method='POST',
                url_suffix='/user/%s/registrationtoken/' % username,
                json_data=post_params,
                resp_type = 'text'
            )

        def delete_user_registrationcode(self, username) -> Dict[str, Any]:
            return self._http_request(
                method='DELETE',
                url_suffix='/user/%s/registrationtoken/' % username,
                resp_type = 'text'
            )

        def send_user_registrationcode(self, username) -> Dict[str, Any]:
            return self._http_request(
                method='POST',
                url_suffix='/user/%s/registrationtoken/send/' % username,
                resp_type = 'text'
            )

        def create_user(self, username, password, firstname, lastname, mobilephone, email):

            post_params = {'username':username, 'password':password, 'first_name':firstname, 'last_name':lastname, 'mobile_phone':mobilephone, 'email':email}

            return self._http_request(
                method='POST',
                url_suffix='/user/',
                json_data=post_params,
                resp_type='text'
            )

        def delete_user(self, username):
            return self._http_request(
                method='DELETE',
                url_suffix='/user/%s/' % username,
                resp_type='text'
            )

    def get_transactionlog(client, args):
        page = args.get('page')
        search = args.get('search')
        locked = args.get('locked')

        result = client.get_transactionlog(page, search, locked)

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='GetTransactionLog.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results

    def get_users(client, args):
        page = args.get('page')
        search = args.get('search')
        locked = args.get('locked')

        result = client.get_users(page, search, locked)

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='GetUsers.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results

    def get_ldap_users(client, args):
        page = args.get('page')
        search = args.get('search')
        locked = args.get('locked')
        ldap = args.get('ldap')

        result = client.get_ldap_users(page, search, locked, ldap)

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='GetLdapUsers.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results

    def get_ldaps(client, args):
        result = client.get_ldaps()

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='GetLdaps.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results

    def get_user_personalinformation(client, args):
        username = args.get('username')

        result = client.get_user_personalinformation(username)

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='GetUserPersonalInformation.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results

    def set_user_personalinformation(client, args):
        username = args.get('username')
        email = args.get('email')
        mobile_phone = args.get('mobile_phone')

        result = client.set_user_personalinformation(username, email, mobile_phone)

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='SetUserPersonalInformation.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results

    def get_user_accessattempts(client, args):
        username = args.get('username')

        result = client.get_user_accessattempts(username)

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='GetUserAccessAttempts.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results

    def delete_user_accessattempts(client, args):
        username = args.get('username')

        result = client.delete_user_accessattempts(username)

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='DeleteUserAccessAttempts.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results

    def create_user_token_virtual(client, args):

        username = args.get('username')
        post_params = {
            'device_type': 'Virtual'
        }

        result = client.create_user_token(username, post_params)

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='CreateUserTokenVirtual.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results

    def create_user_token_fastauth(client, args):

        username = args.get('username')
        post_params = {
            'device_type': 'Fast:Auth:Mobile:Asymmetric',
            'serial_number': args.get('serial-number'),
            'password_required': ''
        }

        result = client.create_user_token(username, post_params)

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='CreateUserTokenFastAuth.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results

    def create_user_token_totpmobile(client, args):

        username = args.get('username')
        post_params = {
            'device_type': 'TOTP:Mobile',
            'serial_number': args.get('serial-number'),
            'password_required': args.get('password-required')
        }

        result = client.create_user_token(username, post_params)

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='CreateUserTokenTotpMobile.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results

    def create_user_token_totmobilehybrid(client, args):

        username = args.get('username')
        post_params = {
            'device_type': 'TOTP:Mobile:Hybrid',
            'serial_number': args.get('serial-number'),
            'password_required': ''
        }

        result = client.create_user_token(username, post_params)

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='CreateUserTokenTotMobileHybrid.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results

    def create_user_token_physical(client, args):

        username = args.get('username')
        post_params = {
            'device_type': args.get('devicetype'),
            'serial_number': args.get('serial-number'),
            'password_required': args.get('password-required')
        }

        result = client.create_user_token(username, post_params)

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='CreateUserTokenPhysical.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results

    def create_user_token_backup(client, args):

        username = args.get('username')
        post_params = {
            'device_type': 'Backup',
            'serial_number': '',
            'password_required': args.get('password-required'),
            'backuptoken_timeout': args.get('backuptoken-timeout'),
            'backuptoken_attempts': args.get('backuptoken_attempts'),
            'backuptoken_gateways': ''
        }

        result = client.create_user_token(username, post_params)

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='CreateUserTokenBackup.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results

    #See
    def update_user_token(client, args):
        username = args.get('username')
        token_devicetype = args.get('devicetype')
        token_serialnumber = args.get('serialnumber')
        post_params = args.get('params')

        result = client.update_user_token(username, token_devicetype, token_serialnumber, post_params)

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='UpdateUserToken.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results

    def get_user_tokens(client, args):
        username = args.get('username')

        result = client.get_user_tokens(username)

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='GetUserTokens.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results

    def delete_user_token(client, args):
        username = args.get('username')
        token_devicetype = args.get('devicetype')
        token_serialnumber = args.get('serialnumber')

        result = client.delete_user_token(username, token_devicetype, token_serialnumber)

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='DeleteUserToken.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results

    def send_user_token(client, args):
        username = args.get('username')
        token_devicetype = args.get('devicetype')
        token_serialnumber = args.get('serialnumber')

        result = client.send_user_token(username, token_devicetype, token_serialnumber)

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='SendUserToken.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results

    def send_user_virtualtoken(client, args):
        username = args.get('username')
        token_devicetype = args.get('devicetype')
        token_serialnumber = args.get('serialnumber')

        result = client.send_user_virtualtoken(username, token_devicetype, token_serialnumber)

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='SendUserVirtualToken.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results

    def get_user_settings(client, args):
        username = args.get('username')

        result = client.get_user_settings(username)

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='GetUserSettings.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results

    def set_user_backuptoken_settings(client, args):
        username = args.get('username')
        backup_password_required = args.get('backup-password-required')
        backuptoken_attempts = args.get('backuptoken-attempts')
        backuptoken_timeout = args.get('backuptoken-timeout')

        params = {}

        if backup_password_required != None:
            params['backup_password_required'] = backup_password_required

        if backuptoken_attempts != None:
            params['backuptoken_attempts'] = backuptoken_attempts

        if backuptoken_timeout != None:
            params['backuptoken_timeout'] = backuptoken_timeout


        result = client.set_user_settings(username, params)

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='SetUserBackupTokenSettings.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results


    def set_user_general_settings(client, args):
        username = args.get('username')
        user_storage = args.get('user-storage')

        params = {}

        if user_storage != None:
            params['user_storage'] = user_storage


        result = client.set_user_settings(username, params)

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='SetUserGeneralSettings.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results

    def set_user_hotpauthentication_settings(client, args):
        username = args.get('username')
        hotp_accept_tolerance = args.get('hotp-accept-tolerance')
        hotp_resend_tolerance = args.get('hotp-resend-tolerance')
        hotp_resend_timeout = args.get('hotp-resend-timeout')
        hotp_password_required = args.get('hotp-password_required')
        hotp_flex_password_required = args.get('hotp-flex-password-required')
        hotp_flex_pin_password_required = args.get('hotp-flex-pin-password-required')

        params = {}

        if hotp_accept_tolerance != None:
            params['hotp_accept_tolerance'] = hotp_accept_tolerance

        if hotp_resend_tolerance != None:
            params['hotp_resend_tolerance'] = hotp_resend_tolerance

        if hotp_resend_timeout != None:
            params['hotp_resend_timeout'] = hotp_resend_timeout

        if hotp_password_required != None:
            params['hotp_password_required'] = hotp_password_required

        if hotp_flex_password_required != None:
            params['hotp_flex_password_required'] = hotp_flex_password_required

        if hotp_flex_pin_password_required != None:
            params['hotp_flex_pin_password_required'] = hotp_flex_pin_password_required


        result = client.set_user_settings(username, params)

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='SetUserHotpAuthenticationSettings.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results

    def set_user_sesamiauthentication_settings(client, args):
        username = args.get('username')
        sesami_mobile_password_required = args.get('sesami_mobile_password_required')
        sesami_slim_password_required = args.get('sesami_slim_password_required')
        gaia_ttw_level = args.get('gaia_ttw_level')

        params = {}

        if sesami_mobile_password_required != None:
            params['sesami_mobile_password_required'] = sesami_mobile_password_required

        if sesami_slim_password_required != None:
            params['sesami_slim_password_required'] = sesami_slim_password_required

        if gaia_ttw_level != None:
            params['gaia_ttw_level'] = gaia_ttw_level


        result = client.set_user_settings(username, params)

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='SetUserSesamiAuthenticationSettings.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results

    def set_user_totpauthentication_settings(client, args):
        username = args.get('username')
        totp_accept_tolerance = args.get('totp-accept-tolerance')
        totp_resend_tolerance = args.get('totp-resend-tolerance')
        totp_resend_timeout = args.get('totp-resend-timeout')
        totp_password_required = args.get('totp-password-required')
        totp_flex_password_required = args.get('totp-flex-password-required')
        totp_flex_pin_password_required = args.get('totp-flex-pin-password-required')
        totp_mobile_password_required = args.get('totp-mobile-password-required')

        params = {}

        if totp_accept_tolerance != None:
            params['totp_accept_tolerance'] = totp_accept_tolerance

        if totp_resend_tolerance != None:
            params['totp_resend_tolerance'] = totp_resend_tolerance

        if totp_resend_timeout != None:
            params['totp_resend_timeout'] = totp_resend_timeout

        if totp_password_required != None:
            params['totp_password_required'] = totp_password_required

        if totp_flex_password_required != None:
            params['totp_flex_password_required'] = totp_flex_password_required

        if totp_flex_pin_password_required != None:
            params['totp_flex_pin_password_required'] = totp_flex_pin_password_required

        if totp_mobile_password_required != None:
            params['totp_mobile_password_required'] = totp_mobile_password_required


        result = client.set_user_settings(username, params)

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='SetUserTotpAuthenticatioSettings.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results

    def set_user_userauthentication_settings(client, args):
        username = args.get('username')
        multiple_step_auth_timeout = args.get('multiple-step-auth-timeout')
        allow_password = args.get('allow-password')
        allow_password_for_registration = args.get('allow-password-for-registration')
        max_allowed_failures = args.get('max-allowed-failures')
        allow_access_when_pwd_expired = args.get('allow-access-when-pwd-expired')
        allow_password_reset_when_forgot_pwd = args.get('allow-password-reset-when-forgot-pwd')
        min_otp_length = args.get('min-otp-length')
        max_otp_length = args.get('max-otp-length')
        dos_tmp_lockdown_max_fail_authentications = args.get('dos-tmp-lockdown-max-fail-authentications')
        dos_tmp_lockdown_time_interval_in_seconds = args.get('dos-tmp-lockdown-time-interval-in-seconds')
        dos_tmp_lockdown_time_in_seconds = args.get('dos-tmp-lockdown-time-in-seconds')

        params = {}

        if multiple_step_auth_timeout != None:
            params['multiple_step_auth_timeout'] = multiple_step_auth_timeout

        if allow_password != None:
            params['allow_password'] = allow_password

        if allow_password_for_registration != None:
            params['allow_password_for_registration'] = allow_password_for_registration

        if max_allowed_failures != None:
            params['max_allowed_failures'] = max_allowed_failures

        if allow_access_when_pwd_expired != None:
            params['allow_access_when_pwd_expired'] = allow_access_when_pwd_expired

        if allow_password_reset_when_forgot_pwd != None:
            params['allow_password_reset_when_forgot_pwd'] = allow_password_reset_when_forgot_pwd

        if min_otp_length != None:
            params['min_otp_length'] = min_otp_length

        if max_otp_length != None:
            params['max_otp_length'] = max_otp_length

        if dos_tmp_lockdown_max_fail_authentications != None:
            params['dos_tmp_lockdown_max_fail_authentications'] = dos_tmp_lockdown_max_fail_authentications

        if dos_tmp_lockdown_time_interval_in_seconds != None:
            params['dos_tmp_lockdown_time_interval_in_seconds'] = dos_tmp_lockdown_time_interval_in_seconds

        if dos_tmp_lockdown_time_in_seconds != None:
            params['dos_tmp_lockdown_time_in_seconds'] = dos_tmp_lockdown_time_in_seconds


        result = client.set_user_settings(username, params)

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='SetUserUserAuthenticationSettings.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results

    def set_user_virtualauthentication_settings(client, args):
        username = args.get('username')
        virtual_device_accept_tolerance = args.get('virtual-device-accept-tolerance')
        virtual_device_gateways = args.get('virtual-device-gateways')

        params = {}

        if virtual_device_accept_tolerance != None:
            params['virtual_device_accept_tolerance'] = virtual_device_accept_tolerance

        if virtual_device_gateways != None:
            params['virtual_device_gateways'] = virtual_device_gateways


        result = client.set_user_settings(username, params)

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='SetUserVirtualAuthenticationSettings.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results

    def get_user_group(client, args):
        username = args.get('username')

        result = client.get_user_group(username)

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='GetUserGroup.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results

    def update_user_group(client, args):
        username = args.get('username')
        new_group_name = args.get('new-group-name')

        result = client.get_user_group(username)

        result_json = json.loads(result)
        old_group_name = None
        for group in result_json["groups"]:
            if group["is_member"] == True:
                old_group_name = group["name"]

        if old_group_name and new_group_name:
            client.remove_user_group(username, old_group_name)
            client.add_user_group(username, new_group_name)


    def add_user_group(client, args):
        username = args.get('username')
        new_group_name = args.get('new-group-name')

        result = client.add_user_group(username, new_group_name)

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='AddUserGroup.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results

    def remove_user_group(client, args):
        username = args.get('username')
        old_group_name = args.get('old-group-name')

        result = client.remove_user_group(username, old_group_name)

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='RemoveUserGroup.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results

    def get_user_registrationcode(client, args):
        username = args.get('username')

        result = client.get_user_registrationcode(username)

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='GetUserRegistrationCode.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results

    def set_user_registrationcode(client, args):
        username = args.get('username')

        expiration = args.get('expiration')
        attempts_left = args.get('attempts-left')

        result = client.set_user_registrationcode(username, expiration, attempts_left)

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='SetUserRegistrationCode.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results

    def delete_user_registrationcode(client, args):
        username = args.get('username')

        result = client.delete_user_registrationcode(username)

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='DeleteUserRegistrationCode.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results

    def send_user_registrationcode(client, args):
        username = args.get('username')

        result = client.send_user_registrationcode(username)

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='SendUserRegistrationCode.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results


    def create_user(client, args):
        username = args.get('username')
        password = args.get('password')
        firstname = args.get('firstname')
        lastname = args.get('lastname')
        mobilephone = args.get('mobilephone')
        email = args.get('email')

        result = client.create_user(username, password, firstname, lastname, mobilephone, email)

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='CreateUser.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results


    def delete_user(client, args):
        username = args.get('username')

        result = client.delete_user(username)

        readable_output = f'## {result}'

        command_results = CommandResults(
            readable_output=readable_output,
            outputs_prefix='DeleteUser.Result',
            outputs_key_field='',
            outputs=result,
            raw_response=result
        )

        return command_results


    def test_module(client, args):
        results = json.loads(client.get_transactionlog(None, None, None))['results']

        if results is not None:
            return 'ok'
        else:
            return 'Failed to run the test'


    def main():

        base_url = demisto.params()['url']
        base_url = base_url + '/api/v1/admin/'
        demisto.info('BASE_URL' + base_url)
        verify_certificate = not demisto.params().get('insecure', False)
        auth_access_token = demisto.params()['apikey']
        proxy = demisto.params().get('proxy', False)

        demisto.debug(f'Command being called is {demisto.command()}')
        try:
            client = Client(
                base_url=base_url,
                verify=verify_certificate,
                headers={'Authorization': 'Bearer %s' % auth_access_token},
                proxy=proxy)

            if demisto.command() == 'safewalk-get-transactionlog':
                result = get_transactionlog(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-get-users':
                result = get_users(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-get-ldap-users':
                result = get_ldap_users(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-get-ldaps':
                result = get_ldaps(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-get-user-personalinformation':
                result = get_user_personalinformation(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-set-user-personalinformation':
                result = set_user_personalinformation(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-get-user-accessattempts':
                result = get_user_accessattempts(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-delete-user-accessattempts':
                result = delete_user_accessattempts(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-create-user-token-virtual':
                result = create_user_token_virtual(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-create-user-token-fastauth':
                result = create_user_token_fastauth(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-create-user-token-totpmobile':
                result = create_user_token_totpmobile(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-create-user-token-totmobilehybrid':
                result = create_user_token_totmobilehybrid(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-create-user-token-physical':
                result = create_user_token_physical(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-create-user-token-backup':
                result = create_user_token_backup(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-update-user-token':
                result = update_user_token(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-get-user-tokens':
                result = get_user_tokens(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-delete-user-token':
                result = delete_user_token(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-send-user-token':
                result = send_user_token(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-send-user-virtualtoken':
                result = send_user_virtualtoken(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-get-user-settings':
                result = get_user_settings(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-set-user-backuptoken-settings':
                result = set_user_backuptoken_settings(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-set-user-general-settings':
                result = set_user_general_settings(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-set-user-hotpauthentication-settings':
                result = set_user_hotpauthentication_settings(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-set-user-sesamiauthentication-settings':
                result = set_user_sesamiauthentication_settings(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-set-user-totpauthentication-settings':
                result = set_user_totpauthentication_settings(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-set-user-userauthentication-settings':
                result = set_user_userauthentication_settings(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-set-user-virtualauthentication-settings':
                result = set_user_virtualauthentication_settings(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-get-user-group':
                result = get_user_group(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-update-user-group':
                result = update_user_group(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-add-user-group':
                result = add_user_group(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-remove-user-group':
                result = remove_user_group(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-get-user-registrationcode':
                result = get_user_registrationcode(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-set-user-registrationcode':
                result = set_user_registrationcode(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-delete-user-registrationcode':
                result = delete_user_registrationcode(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-send-user-registrationcode':
                result = send_user_registrationcode(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-create-user':
                result = create_user(client, demisto.args())
                return_results(result)

            if demisto.command() == 'safewalk-delete-user':
                result = delete_user(client, demisto.args())
                return_results(result)

            if demisto.command() == 'test-module':
                result = test_module(client, demisto.args())
                return_results(result)

        # Log exceptions
        except Exception as e:
            return_error(f'Failed to execute {demisto.command()} command. Error: {str(e)}')



    if __name__ in ('__main__', '__builtin__', 'builtins'):
        main()
  type: python
  commands:
  - name: safewalk-get-transactionlog
    arguments:
    - name: page
      description: Pages to be displayed.
    - name: search
      description: User to search.
    - name: locked
    description: Display transaction log.
  - name: safewalk-get-users
    arguments:
    - name: page
    - name: search
    - name: locked
    description: Search local users.
  - name: safewalk-get-ldap-users
    arguments:
    - name: page
    - name: search
    - name: locked
    - name: ldap
    description: Search LDAP users
  - name: safewalk-get-ldaps
    arguments: []
    description: Get LDAP configuration.
  - name: safewalk-get-user-personalinformation
    arguments:
    - name: username
      description: Username to display.
    description: Get users personal information.
  - name: safewalk-set-user-personalinformation
    arguments:
    - name: username
    - name: email
    - name: mobile_phone
    description: Set user personal information.
  - name: safewalk-get-user-accessattempts
    arguments:
    - name: username
    description: Get user access attempts
  - name: safewalk-delete-user-accessattempts
    arguments:
    - name: username
    description: Delete user access attempts
  - name: safewalk-create-user-token
    arguments:
    - name: username
    - name: params
    description: Create user token
  - name: safewalk-update-user-token
    arguments:
    - name: username
    - name: token_devicetype
    - name: token_serialnumber
    - name: params
    description: Update user token.
  - name: safewalk-get-user-tokens
    arguments:
    - name: username
    description: Get user tokens
  - name: safewalk-delete-user-token
    arguments:
    - name: username
    - name: devicetype
    - name: serialnumber
    description: Delete user token.
  - name: safewalk-send-user-virtualtoken
    arguments:
    - name: username
    - name: token_devicetype
    - name: token_serialnumber
    description: Send user virtual token.
  - name: safewalk-get-user-settings
    arguments:
    - name: username
    description: Get user settings.
  - name: safewalk-get-user-group
    arguments:
    - name: username
    description: Get user group.
  - name: safewalk-add-user-group
    arguments:
    - name: username
    - name: new-group-name
    description: Add user group.
  - name: safewalk-remove-user-group
    arguments:
    - name: username
    - name: old-group-name
    description: Remove user group.
  - name: safewalk-get-user-registrationcode
    arguments:
    - name: username
    description: Get user registration code
  - name: safewalk-set-user-registrationcode
    arguments:
    - name: username
    - name: expiration
    - name: attempts-left
    description: Set user registration code
  - name: safewalk-send-user-registrationcode
    arguments:
    - name: username
    description: Send user registration code
  - name: safewalk-create-user-token-virtual
    arguments:
    - name: username
    description: Create user virtual token
  - name: safewalk-create-user-token-fastauth
    arguments:
    - name: username
    - name: serial-number
    description: Create user FastAuth Token
  - name: safewalk-create-user-token-totpmobile
    arguments:
    - name: username
    - name: serial-number
    - name: password-required
    description: Create user TopMobile Token
  - name: safewalk-create-user-token-totmobilehybrid
    arguments:
    - name: username
    - name: serial-number
    description: Create user TotMobileHybrid
  - name: safewalk-create-user-token-physical
    arguments:
    - name: username
    - name: serial-number
    - name: password-required
    description: Create user Physical Token
  - name: safewalk-create-user-token-backup
    arguments:
    - name: username
    - name: password-required
    - name: backuptoken-timeout
    - name: backuptoken_attempts
    description: Create user Backup Token
  - name: safewalk-set-user-backuptoken-settings
    arguments:
    - name: username
    - name: backup-password-required
    - name: backuptoken-attempts
    - name: backuptoken-timeout
  - name: safewalk-set-user-general-settings
    arguments:
    - name: username
    - name: user-storage
  - name: safewalk-set-user-hotpauthentication-settings
    arguments:
    - name: username
    - name: hotp-accept-tolerance
    - name: hotp-resend-tolerance
    - name: hotp-resend-timeout
    - name: hotp-password_required
    - name: hotp-flex-password-required
    - name: hotp-flex-pin-password-required
  - name: safewalk-set-user-sesamiauthentication-settings
    arguments:
    - name: username
    - name: sesami_mobile_password_required
    - name: sesami_slim_password_required
    - name: gaia_ttw_level
  - name: safewalk-set-user-totpauthentication-settings
    arguments:
    - name: username
    - name: totp-accept-tolerance
    - name: totp-resend-tolerance
    - name: totp-resend-timeout
    - name: totp-password-required
    - name: totp-flex-password-required
    - name: totp-flex-pin-password-required
    - name: totp-mobile-password-required
  - name: safewalk-set-user-userauthentication-settings
    arguments:
    - name: username
    - name: multiple-step-auth-timeout
    - name: allow-password
    - name: allow-password-for-registration
    - name: max-allowed-failures
    - name: allow-access-when-pwd-expired
    - name: allow-password-reset-when-forgot-pwd
    - name: min-otp-length
    - name: max-otp-length
    - name: dos-tmp-lockdown-max-fail-authentications
    - name: dos-tmp-lockdown-time-interval-in-seconds
    - name: dos-tmp-lockdown-time-in-seconds
  - name: safewalk-set-user-virtualauthentication-settings
    arguments:
    - name: username
    - name: virtual-device-accept-tolerance
    - name: virtual-device-gateways
  - name: safewalk-create-user
    arguments:
    - name: username
    - name: password
    - name: firstname
    - name: lastname
    - name: mobilephone
    - name: email
  - name: safewalk-delete-user
    arguments:
    - name: username
  dockerimage: demisto/python3:3.9.1.14969
  isfetch: true
  feed: true
  runonce: false
  subtype: python3
  isFetchSamples: true
tests:
- No tests (auto formatted)
