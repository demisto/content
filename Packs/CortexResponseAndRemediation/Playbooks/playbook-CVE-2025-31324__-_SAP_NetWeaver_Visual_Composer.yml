id: CVE-2025-31324  - SAP NetWeaver Visual Composer
version: -1
name: CVE-2025-31324  - SAP NetWeaver Visual Composer
description: "CVE-2025-31324 is a critical zero-day vulnerability affecting the Metadata Uploader component of SAP NetWeaver Visual Composer. The vulnerability arises from missing authorization checks, allowing unauthenticated attackers to upload malicious executable binaries. Exploitation of this flaw can lead to full remote code execution (RCE) on affected systems, posing a significant risk to confidentiality, integrity, and availability\n\n## CVE-2025-31324 - SAP NetWeaver RCE Vulnerability\n\n## ðŸ”  Vulnerability Overview\n\n- **Component Affected**: SAP NetWeaver Visual Composer Metadata Uploader  \n- **Endpoint**: `/developmentserver/metadatauploader`  \n- **CVE ID**: CVE-2025-31324  \n- **CVSS Score**: 10.0 (Critical)  \n- **Exploitability**: Unauthenticated remote attackers can exploit this without user interaction  \n\nThis flaw allows unauthenticated attackers to upload arbitrary files (e.g., JSP web shells), enabling remote code execution with the same privileges as the SAP application server process.  \n[Source: Unit42 - Palo Alto Networks](https://unit42.paloaltonetworks.com/threat-brief-sap-netweaver-cve-2025-31324/)\n\n\n## ðŸ›¡ï¸ Mitigation and Recommendations\n\n- ðŸ”§ **Apply Patch**: SAP Note #3594142 (released April 24, 2025)  \n- ðŸš« **Disable Visual Composer** if not in use  \n- ðŸ”’ **Restrict Access** to the vulnerable endpoint  \n- ðŸ” **Monitor for IoCs** in `/irj/servlet_jsp/irj/root/` and suspicious traffic  \n\n## ðŸ“Œ Conclusion\n\nCVE-2025-31324 is actively exploited and critically severe. Organizations should patch immediately, monitor for compromise, and disable or restrict vulnerable components.\n\nâž¡ï¸ [View official CVE details on NIST](https://nvd.nist.gov/vuln/detail/CVE-2025-31324)\n\n## ðŸ”” Alert Triggering\n1. Manually\n2. Part of Agent alert -> \"CVE Exploitation - 986328356\"\n\n ##  â–¶ï¸ Playbook Flow\n1. Using XQL, identify potential SAP NetWeaver instances in your environment.\n2. Using XQL, check if there are events that point to any potential webshells downloaded in the directories.\n3. Using Agent Script, identify if there are already any suspicious files that might indicate a webshell.\n4. *Collect* IOCs from a Unit42 blog, *search* them using the \"Threat Hunting - Generic\" playbook ( supports Palo Alto products, Qradar, and Splunk), and *block* those indicators\n5. Provides Mitigation actions.\n"
tags:
- Rapid Breach Response
- 'CVE-2025-31324 '
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 99845970-0608-4206-83f9-a5adb16f7e91
    type: start
    task:
      id: 99845970-0608-4206-83f9-a5adb16f7e91
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "26"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3571,
          "y": -465
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 4e08c4b5-ed16-48af-824d-27117058be50
    type: regular
    task:
      id: 4e08c4b5-ed16-48af-824d-27117058be50
      version: -1
      name: XQL Query - Search file creation event by certutil
      description: |-
        Execute an XQL query and retrieve results of an executed XQL query API. The command will be executed every 10 seconds until results are retrieved or until a timeout error is raised.
        When more than 1000 results are retrieved, the command will return a compressed gzipped JSON format file,
        unless the argument 'parse_result_file_to_context' is set to true and then the results will be extracted to the context.
      script: '|||xdr-xql-generic-query'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      max_fields:
        simple: "100"
      query:
        simple: 'config timeframe=7d | dataset = xdr_data | filter event_type = ENUM.FILE  and lowercase(actor_process_image_name) = "jstart.exe" and lowercase(action_file_path) contains  "visualcomposer" | fields  agent_id,agent_hostname,agent_ip_addresses | dedup agent_id  '
      query_name:
        simple: Check for SAP NetWeaver Visual Composer
      time_frame:
        simple: 1 week ago
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3211.5,
          "y": 532
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: aabf1464-d2a4-4cb8-8bd4-988bf4996095
    type: regular
    task:
      id: aabf1464-d2a4-4cb8-8bd4-988bf4996095
      version: -1
      name: 'Manual â€“ Search file using XQL query and quarantine the file '
      description: "Dear Analyst,\n\nEnsure that the 'XQL Query Engine' integration is active. If it's not enabled, activate the integration or manually run the following XQL query to determine if a file was successfully downloaded from a malicious URL using certutil.\n\nQuery:\n\ndataset = xdr_data | filter event_type = 3 and lowercase(actor_process_image_name) = \"jstart.exe\" and lowercase(action_file_path) contains  \"visualcomposer\" | fields  agent_id,agent_hostname,agent_ip_addresses | dedup agent_id  \n\nIf the query output indicates a file created by a malicious certutil command line with a malicious URL, quarantine and remove the file immediately."
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "103"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3702.25,
          "y": 532
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 040ff4e3-934b-4356-834b-5e9e3d19d5d7
    type: condition
    task:
      id: 040ff4e3-934b-4356-834b-5e9e3d19d5d7
      version: -1
      name: Is the integration of 'XQL Query Engine' available?
      description: Returns 'yes' if integration brand 'XQL Query Engine' is available. Otherwise returns 'no'.
      scriptName: IsIntegrationAvailable
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "no":
      - "2"
      "yes":
      - "5"
    scriptarguments:
      brandname:
        simple: XQL Query Engine
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3571,
          "y": 36
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 41a59330-6c0a-4f22-b820-9ba2e9972d2c
    type: condition
    task:
      id: 41a59330-6c0a-4f22-b820-9ba2e9972d2c
      version: -1
      name: Any results from XQL?
      description: Any results from the XQL Query?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "9"
      "yes":
      - "92"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXQL.GenericQuery.results
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3211.5,
          "y": 680
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 4a7171dd-648e-4b5d-831e-7cd7d0c54a9c
    type: regular
    task:
      id: 4a7171dd-648e-4b5d-831e-7cd7d0c54a9c
      version: -1
      name: Check XQL Quota
      description: Retrieve the amount of query quota available and used.
      script: '|||xdr-xql-get-quota'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3321.25,
          "y": 212
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 7261879b-6587-4eae-b31b-d95c4feaa8ad
    type: condition
    task:
      id: 7261879b-6587-4eae-b31b-d95c4feaa8ad
      version: -1
      name: Is there enough quota?
      description: Check if there is enough quota to run the query.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "1"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: greaterThanOrEqual
          left:
            value:
              complex:
                root: PaloAltoNetworksXQL.Quota
                accessor: license_quota
                transformers:
                - operator: subtraction
                  args:
                    by:
                      value:
                        simple: PaloAltoNetworksXQL.Quota.used_quota
                      iscontext: true
            iscontext: true
          right:
            value:
              simple: "1"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3321.25,
          "y": 354
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: bcd35669-4243-4504-8017-9900c3f068cd
    type: title
    task:
      id: bcd35669-4243-4504-8017-9900c3f068cd
      version: -1
      name: 'XQL: Identify SAP NetWeaver Instances'
      description: This section is intent to identify SAP NetWeaver Visual Composer instances.
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3571,
          "y": -131
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: 7a49c544-a9ae-4be4-8dce-052dc7d7910e
    type: title
    task:
      id: 7a49c544-a9ae-4be4-8dce-052dc7d7910e
      version: -1
      name: Investigation
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "11"
      - "12"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4191.5,
          "y": 1105
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 45f0711c-3813-4efe-871a-43cdccbeb400
    type: title
    task:
      id: 45f0711c-3813-4efe-871a-43cdccbeb400
      version: -1
      name: Hunt For IOCs
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "15"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2771,
          "y": 1283
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: f9c14a90-eae6-4c12-9087-89b2a1ac9d05
    type: title
    task:
      id: f9c14a90-eae6-4c12-9087-89b2a1ac9d05
      version: -1
      name: Anlysis Endpoints
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "72"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4193.25,
          "y": 1283
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 9c1b9e3b-6c90-4635-a61a-155c07847188
    type: title
    task:
      id: 9c1b9e3b-6c90-4635-a61a-155c07847188
      version: -1
      name: Manually Open Source Scripts
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "18"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -1396,
          "y": -392
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 8dbc7b41-98fa-4661-886b-4e1db73b5a8d
    type: title
    task:
      id: 8dbc7b41-98fa-4661-886b-4e1db73b5a8d
      version: -1
      name: Collect Indicators
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "17"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2771,
          "y": 1560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: 4c543483-345a-49a6-97e0-a61a0e3e5f40
    type: regular
    task:
      id: 4c543483-345a-49a6-97e0-a61a0e3e5f40
      version: -1
      name: Collect indicators from Unit42 Blog
      description: This script will extract indicators from HTML and will handle bad TLD to avoid file extensions false positives.
      scriptName: ParseHTMLIndicators
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "25"
    scriptarguments:
      unescape_domain:
        simple: "False"
      url:
        simple: https://unit42.paloaltonetworks.com/threat-brief-sap-netweaver-cve-2025-31324/
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2771,
          "y": 1670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: 5e6b9936-258e-4f3c-8e29-d678d529e265
    type: regular
    task:
      id: 5e6b9936-258e-4f3c-8e29-d678d529e265
      version: -1
      name: 'Tool #1 Onapsis/Mandiant Github'
      description: |-
        Onapsis and Mandiant have collaborated to release an open-source tool to assist SAP customers in identifying potential compromises related to CVE-2025-31324, a critical 0-day vulnerability in SAP NetWeaver Java systems.

        Follow the following GitHub for more information:
        https://github.com/Onapsis/Onapsis-Mandiant-CVE-2025-31324-Vuln-Compromise-Assessment

        **Note that this is a suggestion for manual action; run this script on your own responsibility.**
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "50"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -1396,
          "y": -227
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: 560fef57-e21f-40bf-aea4-b4ef0ba76ce9
    type: regular
    task:
      id: 560fef57-e21f-40bf-aea4-b4ef0ba76ce9
      version: -1
      name: Extract Indicators From Data Collected
      description: commands.local.cmd.extract.indicators
      script: Builtin|||extractIndicators
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      text:
        complex:
          root: http.parsedBlog
          accessor: indicators
          transformers:
          - operator: RemoveEmpty
            args:
              empty_values: {}
              remove_keys:
                value:
                  simple: "true"
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2771,
          "y": 1913
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: b287a3b1-3ffd-452f-8933-a4fa76f018c2
    type: title
    task:
      id: b287a3b1-3ffd-452f-8933-a4fa76f018c2
      version: -1
      name: Tag and Link Indicators
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "23"
      - "24"
      - "52"
      - "51"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2771,
          "y": 2065
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: ac0243c2-ebd0-4fcc-80f7-10f87cb511fb
    type: regular
    task:
      id: ac0243c2-ebd0-4fcc-80f7-10f87cb511fb
      version: -1
      name: Tag IP indicators
      description: commands.local.cmd.new.indicator
      script: Builtin|||createNewIndicator
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "48"
    scriptarguments:
      retry-count:
        simple: "3"
      retry-interval:
        simple: "2"
      tags:
        simple: CVE-2025-31324
      type:
        simple: IP
      value:
        complex:
          root: ExtractedIndicators.IP
          filters:
          - - operator: isNotEmpty
              left:
                value:
                  simple: ExtractedIndicators.IP
                iscontext: true
          transformers:
          - operator: uniq
      verdict:
        complex:
          root: inputs.CollectedIndicatorsSeverity
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2183.25,
          "y": 2199
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: 5543632b-a2db-4b06-b22a-79105bd808c6
    type: regular
    task:
      id: 5543632b-a2db-4b06-b22a-79105bd808c6
      version: -1
      name: Tag CVE indicators
      description: commands.local.cmd.new.indicator
      script: Builtin|||createNewIndicator
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "48"
    scriptarguments:
      retry-count:
        simple: "3"
      retry-interval:
        simple: "2"
      tags:
        simple: SAP NetWeaver's Visual Composer Framework
      type:
        simple: CVE
      value:
        complex:
          root: inputs.RelatedCVEs
          transformers:
          - operator: split
            args:
              delimiter:
                value:
                  simple: ', '
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2577.25,
          "y": 2199
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "25":
    id: "25"
    taskid: 46f81426-97be-4d1d-852e-29bc565afc03
    type: title
    task:
      id: 46f81426-97be-4d1d-852e-29bc565afc03
      version: -1
      name: Extract Indicatos
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "21"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2771,
          "y": 1790
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: 72948c13-c741-4943-80ac-eb7f31a54365
    type: condition
    task:
      id: 72948c13-c741-4943-80ac-eb7f31a54365
      version: -1
      name: Triggered Manually or Alert?
      description: How was this alert triggered? manually or via an alert trigger.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "27"
      Manually:
      - "7"
    separatecontext: false
    conditions:
    - label: Manually
      condition:
      - - operator: isNotEqualString
          left:
            value:
              simple: alert.name
            iscontext: true
          right:
            value:
              simple: CVE Exploitation - 986328356
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3571,
          "y": -343
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: fe9ffd47-ca37-449c-8cc9-ee6f0dd46458
    type: title
    task:
      id: fe9ffd47-ca37-449c-8cc9-ee6f0dd46458
      version: -1
      name: Alert
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "9"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4193.25,
          "y": -144
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: 73f3d730-71ba-4d3d-8666-93d96886ba3f
    type: title
    task:
      id: 73f3d730-71ba-4d3d-8666-93d96886ba3f
      version: -1
      name: 'Remediation '
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "29"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3590,
          "y": 2796
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: bc3d2d04-4f3a-4f2e-8c1b-a068f4ce68cd
    type: condition
    task:
      id: bc3d2d04-4f3a-4f2e-8c1b-a068f4ce68cd
      version: -1
      name: Block indicators automatically?
      description: Checks whether IOCs associated with the alert can be blocked automatically.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "30"
      "yes":
      - "84"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: inputs.BlockIndicatorsAutomatically
            iscontext: true
          right:
            value:
              simple: "True"
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3590,
          "y": 2916
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: 7ea17631-8eb4-439d-889e-f3bff574a694
    type: regular
    task:
      id: 7ea17631-8eb4-439d-889e-f3bff574a694
      version: -1
      name: Block indicators manually
      description: Manually block the IOCs in the relevant systems.
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "93"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3810.5,
          "y": 3053
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: 8a3fd96c-b466-4037-846c-f48a8349caee
    type: title
    task:
      id: 8a3fd96c-b466-4037-846c-f48a8349caee
      version: -1
      name: Mitigation
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "87"
      - "99"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3591,
          "y": 3519
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: cc7ddaff-3fee-4d61-8f3c-dc254fec3cea
    type: regular
    task:
      id: cc7ddaff-3fee-4d61-8f3c-dc254fec3cea
      version: -1
      name: Patch Recommendations For SAP Visual Composer
      description: "According to the Onapsis blog - \nhttps://onapsis.com/blog/active-exploitation-of-sap-vulnerability-cve-2025-31324/\n\n## Please refer to the following link to download and patch your SAP product according to the vendor's advisory. Link below:\n[SAP Security Note #3594142](https://me.sap.com/notes/3594142)\n\n## For more information, here is the link to SAP's FAQ:\n[SAP Note #3596125](https://me.sap.com/notes/3596125/E)\n\n## Provides workaround mitigation steps for customers that cannot apply the patch.\n[SAP Note #3593336](https://me.sap.com/notes/3593336/E)"
      type: regular
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -915,
          "y": -227
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: 5e25e956-702e-455a-9554-671133b96e2e
    type: condition
    task:
      id: 5e25e956-702e-455a-9554-671133b96e2e
      version: -1
      name: Analysis resolution - Should continue with the investigation?
      description: |-
        ## Check with the analyst whether to continue with the investigation.

        - Please ensure SAP NetWeaver's Visual Composer Framework is indeed in the vulnerable version of 7.50.

        - Check the return results of the IOC's.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "No":
      - "37"
      "Yes":
      - "36"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3589,
          "y": 4087
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to:
      subject:
      body:
        simple: Do you need to continue with the investigation?
      methods: []
      format: ""
      bcc:
      cc:
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
        completeafterv2: true
        completeaftersla: false
      replyOptions:
      - "Yes"
      - "No"
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: 2c1acf31-f11c-46c5-8d78-db7434d2759b
    type: title
    task:
      id: 2c1acf31-f11c-46c5-8d78-db7434d2759b
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3589,
          "y": 4427
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: fb167917-e3aa-4e5e-ae37-95d19afde3bc
    type: regular
    task:
      id: fb167917-e3aa-4e5e-ae37-95d19afde3bc
      version: -1
      name: Investigate Further
      description: "## Manual step for further alert investigation. \nAs an example - you may use the following opensource tool from Onapsis.\n\nOnapsis and Mandiant have collaborated to release an open-source tool to assist SAP customers in identifying potential compromises related to CVE-2025-31324, a critical 0-day vulnerability in SAP NetWeaver Java systems.\n\nFollow the following GitHub for more information:\nhttps://github.com/Onapsis/Onapsis-Mandiant-CVE-2025-31324-Vuln-Compromise-Assessment\n\n**Note that this is a suggestion for manual action; run this script on your own responsibility.**\n"
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "35"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3589,
          "y": 4257
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: ce255f16-c4e8-473d-81a3-c591ba37071a
    type: regular
    task:
      id: ce255f16-c4e8-473d-81a3-c591ba37071a
      version: -1
      name: Close Investigation
      description: Close the current alert
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "35"
    scriptarguments:
      closeReason:
        simple: No further actions are required.
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4003,
          "y": 4257
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: 2d19c1e8-6bcf-4ea3-868e-a37a034b1850
    type: title
    task:
      id: 2d19c1e8-6bcf-4ea3-868e-a37a034b1850
      version: -1
      name: Resolution
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "34"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3590,
          "y": 3951
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: aacd98ad-bd25-4988-8fa3-4877009fac6f
    type: title
    task:
      id: aacd98ad-bd25-4988-8fa3-4877009fac6f
      version: -1
      name: Unit42 Recommended Mitigations
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "40"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -434,
          "y": -392
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: 6358ec01-4f44-4345-a0c3-96d96d662744
    type: regular
    task:
      id: 6358ec01-4f44-4345-a0c3-96d96d662744
      version: -1
      name: XQL - Monitor creation of suspicious files
      description: "Use the following XQL to identify any suspicious activity created \n\n```config case_sensitive = false timeframe=30d\n| dataset = xdr_data\n| filter event_type = ENUM.FILE and event_sub_type in (ENUM.FILE_WRITE, ENUM.FILE_CREATE_NEW, ENUM.FILE_RENAME, ENUM.FILE_REMOVE)\n| filter lowercase(action_file_extension) in (\"jsp\",\"class\",\"jar\",\"jspx\",\"war\",\"jnlp\") and lowercase(action_file_path) contains  \"\\servlet_jsp\\irj\\\"```"
      type: regular
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -434,
          "y": -227
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: 985f1e85-1204-44b6-8e4b-cb8290d54c70
    type: title
    task:
      id: 985f1e85-1204-44b6-8e4b-cb8290d54c70
      version: -1
      name: Patch Vulnerability
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "32"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -915,
          "y": -392
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: c57ae06e-ce23-4784-81d7-fa9752c403e5
    type: title
    task:
      id: c57ae06e-ce23-4784-81d7-fa9752c403e5
      version: -1
      name: Deploy Detection Rules
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "45"
      - "46"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 287.5,
          "y": -392
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: 22e30d5e-6fc6-4cb5-aaf5-7b1adfb9f852
    type: regular
    task:
      id: 22e30d5e-6fc6-4cb5-aaf5-7b1adfb9f852
      version: -1
      name: Sigma Rules
      description: |-
        **Note**
        The Sigma rules yet been merged to the public repository. You can browse them and apply based on the Pull Request mentioned below:

        https://github.com/SigmaHQ/sigma/pull/5387/files
      type: regular
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 47,
          "y": -227
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: ac077959-a093-4d1b-b0da-26899cb9480a
    type: regular
    task:
      id: ac077959-a093-4d1b-b0da-26899cb9480a
      version: -1
      name: Yara Rules
      description: "You can implement the following YARA rule \n\n[Link to the blog for this Yara rule](https://onapsis.com/blog/active-exploitation-of-sap-vulnerability-cve-2025-31324/)\n\nrule detect_CVE202531324_webshells_by_name\n{\n    meta:\n        description = â€œDetects the known webshell file names that are uploaded in the root directoryâ€\n        author = â€œEmanuela Ionas, Onapsis Research Labsâ€\n        date = â€œ2025-05-05â€\n        tags = â€œCVE-2025-31324â€\n    strings:\n        $webshell_1 = â€œ/irj/cache.jspâ€ nocase\n        $webshell_2 = â€œ/irj/helper.jspâ€ nocase\n        $webshell_3 = â€œ/irj/forwardsap.jspâ€ nocase\n        $webshell_4 = â€œ/irj/coresap.jspâ€ nocase\n        $webshell_5 = â€œ/irj/webhelp.jspâ€ nocase\n        $webshell_6 = â€œ/irj/.webhelper.jspâ€ nocase\n        $webshell_7 = â€œ/irj/usage.jspâ€ nocase\n        $webshell_8 = â€œ/irj/usage1.jspâ€ nocase\n        $webshell_9 = â€œ/irj/404_error.jspâ€ nocase\n        $webshell_10 = â€œ/irj/.h.jspâ€ nocase\n        $webshell_regex = /\\/irj\\/[._a-zA-Z0-9]{2,10}\\.jsp/\n        $status = /HTTP\\/[12]\\.[012]\\s+200/\n    condition:\n        ($webshell_1 or $webshell_2 or $webshell_3 or $webshell_4 or $webshell_5 or $webshell_6 or $webshell_7 or $webshell_8 or $webshell_9 or $webshell_10 or $webshell_regex) and $status\n}"
      type: regular
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 528,
          "y": -227
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: 4c840e8e-3557-467d-829d-dd24faface57
    type: regular
    task:
      id: 4c840e8e-3557-467d-829d-dd24faface57
      version: -1
      name: Link Indicators To Alert
      description: commands.local.cmd.associate.indicators
      script: Builtin|||associateIndicatorsToAlert
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "68"
    scriptarguments:
      alertId:
        simple: ${alert.id}
      indicatorsValues:
        complex:
          root: ExtractedIndicators.IP
          filters:
          - - operator: isNotEmpty
              left:
                value:
                  simple: ExtractedIndicators.IP
                iscontext: true
          transformers:
          - operator: append
            args:
              item:
                value:
                  simple: ExtractedIndicators.Domain
                iscontext: true
          - operator: append
            args:
              item:
                value:
                  simple: ExtractedIndicators.URL
                iscontext: true
          - operator: append
            args:
              item:
                value:
                  simple: ExtractedIndicators.CVE
                iscontext: true
          - operator: append
            args:
              item:
                value:
                  simple: ExtractedIndicators.File
                iscontext: true
          - operator: uniq
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2771,
          "y": 2330
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: ddca72f8-fcf4-4797-8b3c-a1af63717313
    type: condition
    task:
      id: ddca72f8-fcf4-4797-8b3c-a1af63717313
      version: -1
      name: Are there any vulnerable servers?
      type: condition
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -1396,
          "y": -57
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to:
      subject:
      body:
        simple: Are there any vulnerable servers?
      methods: []
      format: ""
      bcc:
      cc:
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
        completeafterv2: true
        completeaftersla: false
      replyOptions:
      - "Yes"
      - "No"
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: 35fe06e1-fbb5-4375-814e-04296431e09b
    type: regular
    task:
      id: 35fe06e1-fbb5-4375-814e-04296431e09b
      version: -1
      name: Tag File indicators
      description: commands.local.cmd.new.indicator
      script: Builtin|||createNewIndicator
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "48"
    scriptarguments:
      retry-count:
        simple: "3"
      retry-interval:
        simple: "2"
      tags:
        simple: CVE-2025-31324
      type:
        simple: File
      value:
        complex:
          root: ExtractedIndicators.File
          filters:
          - - operator: isNotEmpty
              left:
                value:
                  simple: ExtractedIndicators.File
                iscontext: true
          transformers:
          - operator: uniq
      verdict:
        complex:
          root: inputs.CollectedIndicatorsSeverity
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3356.25,
          "y": 2199
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "52":
    id: "52"
    taskid: 48fd633b-d28c-443f-8734-cbf7d73413f1
    type: regular
    task:
      id: 48fd633b-d28c-443f-8734-cbf7d73413f1
      version: -1
      name: Tag Domain indicators
      description: commands.local.cmd.new.indicator
      script: Builtin|||createNewIndicator
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "48"
    scriptarguments:
      retry-count:
        simple: "3"
      retry-interval:
        simple: "2"
      tags:
        simple: CVE-2025-31324
      type:
        simple: Domain
      value:
        complex:
          root: ExtractedIndicators.Domain
          filters:
          - - operator: isNotEmpty
              left:
                value:
                  simple: ExtractedIndicators.Domain
                iscontext: true
          transformers:
          - operator: uniq
      verdict:
        complex:
          root: inputs.CollectedIndicatorsSeverity
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2963.25,
          "y": 2199
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: e1005fc2-19a3-4c88-8a69-e7bcd4ca2938
    type: title
    task:
      id: e1005fc2-19a3-4c88-8a69-e7bcd4ca2938
      version: -1
      name: Using Micorosft Advanced Hunting
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "55"
      - "54"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -250,
          "y": -65
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "54":
    id: "54"
    taskid: f7b87409-f2f3-4c1f-8243-0a63be4453ee
    type: condition
    task:
      id: f7b87409-f2f3-4c1f-8243-0a63be4453ee
      version: -1
      name: Is the integration of 'Microsoft 365 Defender' available?
      description: Returns 'yes' if integration brand 'XQL Query Engine' is available. Otherwise returns 'no'.
      scriptName: IsIntegrationAvailable
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "56"
      "yes":
      - "57"
    scriptarguments:
      brandname:
        simple: Microsoft 365 Defender
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -34.5,
          "y": 62
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "55":
    id: "55"
    taskid: 0aaca96b-7178-47c0-8ccc-1ce2cf9fe3f3
    type: condition
    task:
      id: 0aaca96b-7178-47c0-8ccc-1ce2cf9fe3f3
      version: -1
      name: Is the integration of 'Microsoft Graph' available?
      description: Returns 'yes' if integration brand 'XQL Query Engine' is available. Otherwise returns 'no'.
      scriptName: IsIntegrationAvailable
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "56"
      "yes":
      - "59"
    scriptarguments:
      brandname:
        simple: Microsoft Graph
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -533.75,
          "y": 62
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "56":
    id: "56"
    taskid: 3ae24283-7dec-4cc5-8479-e0ad2d5b9546
    type: title
    task:
      id: 3ae24283-7dec-4cc5-8479-e0ad2d5b9546
      version: -1
      name: Integration is unavailble
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -284,
          "y": 794
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "57":
    id: "57"
    taskid: 4241570c-9dff-4c76-9525-8f0b3e5c76b5
    type: regular
    task:
      id: 4241570c-9dff-4c76-9525-8f0b3e5c76b5
      version: -1
      name: Run KQL Advanced Hunting
      description: 'Advanced hunting is a threat-hunting tool that uses specially constructed queries to examine the past 30 days of event data in Microsoft 365 Defender. Details on how to write queries: https://docs.microsoft.com/en-us/microsoft-365/security/defender/advanced-hunting-query-language?view=o365-worldwide.'
      script: '|||microsoft-365-defender-advanced-hunting'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "58"
    scriptarguments:
      limit:
        simple: "100"
      query:
        simple: |-
          DeviceProcessEvents
          | where (FileName == "disp+work.exe" and ProcessVersionInfoProductName == "SAP NetWeaver") or FileName == "disp+work" and Timestamp > ago(7d)
          | distinct DeviceId, DeviceName, FileName, ProcessVersionInfoProductName, ProcessVersionInfoProductVersion
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -34.5,
          "y": 240
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "58":
    id: "58"
    taskid: a2068e44-c7e4-492d-8f90-318688cd0586
    type: condition
    task:
      id: a2068e44-c7e4-492d-8f90-318688cd0586
      version: -1
      name: Are there any results
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "56"
      "yes":
      - "61"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Microsoft365Defender.Hunt.results
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -34.5,
          "y": 392
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "59":
    id: "59"
    taskid: b88139cb-9a8c-4394-870a-942dc7e27f26
    type: regular
    task:
      id: b88139cb-9a8c-4394-870a-942dc7e27f26
      version: -1
      name: Run KQL Advanced Hunting
      description: Advanced hunting is a threat-hunting tool that uses specially constructed queries to examine the past 30 days of event data in Microsoft Graph Security.
      script: '|||msg-advanced-hunting'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "60"
    scriptarguments:
      query:
        simple: |-
          DeviceProcessEvents
          | where (FileName == "disp+work.exe" and ProcessVersionInfoProductName == "SAP NetWeaver") or FileName == "disp+work" and Timestamp > ago(7d)
          | distinct DeviceId, DeviceName, FileName, ProcessVersionInfoProductName, ProcessVersionInfoProductVersion
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -533.75,
          "y": 240
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: aefeb5f3-daf9-4103-848a-ab8db376a8e9
    type: condition
    task:
      id: aefeb5f3-daf9-4103-848a-ab8db376a8e9
      version: -1
      name: Are there any results
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "56"
      "yes":
      - "61"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MsGraph.Hunt.results
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -533.75,
          "y": 392
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    id: "61"
    taskid: ab076de2-0594-4f57-ac01-6a4366d3d589
    type: condition
    task:
      id: ab076de2-0594-4f57-ac01-6a4366d3d589
      version: -1
      name: Check the MSKQL results for potential servers
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "80"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MsGraph.Hunt.results
            iscontext: true
        - operator: isNotEmpty
          left:
            value:
              simple: Microsoft365Defender.Hunt.results
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 97,
          "y": 680
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "62":
    id: "62"
    taskid: ca548af0-23b2-464b-865a-59389b88695b
    type: title
    task:
      id: ca548af0-23b2-464b-865a-59389b88695b
      version: -1
      name: SIEM Hunting
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "64"
      - "65"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 362.75,
          "y": 844
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: c688f8e5-82d7-44cd-8344-806be96412c9
    type: title
    task:
      id: c688f8e5-82d7-44cd-8344-806be96412c9
      version: -1
      name: Palo Alto Networks Hunting
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "70"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 830.5,
          "y": 844
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "64":
    id: "64"
    taskid: ad653ee7-423c-469d-9b16-91f5bf557d52
    type: playbook
    task:
      id: ad653ee7-423c-469d-9b16-91f5bf557d52
      version: -1
      name: Splunk Indicator Hunting
      description: This playbook queries Splunk for indicators such as file hashes, IP addresses, domains, or urls. It outputs detected users, ip addresses, and hostnames related to the indicators.
      playbookName: Splunk Indicator Hunting
      type: playbook
      iscommand: false
      brand: ""
    scriptarguments:
      IPAddress:
        complex:
          root: ExtractedIndicators
          accessor: IP
          transformers:
          - operator: uniq
      IndexName:
        complex:
          root: inputs.SplunkIndex
      SHA256:
        complex:
          root: ExtractedIndicators
          filters:
          - - operator: stringHasLength
              left:
                value:
                  simple: ExtractedIndicators.File
                iscontext: true
              right:
                value:
                  simple: "64"
          transformers:
          - operator: uniq
      SelectFields:
        simple: source,timestamp
      URLDomain:
        complex:
          root: ExtractedIndicators
          accessor: Domain
          transformers:
          - operator: uniq
      earliest_time:
        complex:
          root: inputs.SplunkEarliestTime
      event_limit:
        simple: "100"
      latest_time:
        complex:
          root: inputs.SplunkLatestTime
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      scriptArguments:
        IPAddress:
          complex:
            root: ExtractedIndicators
            accessor: IP
            transformers:
            - operator: uniq
        IndexName:
          simple: index=*
        MD5:
          complex:
            root: ExtractedIndicators
            filters:
            - - operator: stringHasLength
                left:
                  value:
                    simple: ExtractedIndicators
                  iscontext: true
                right:
                  value:
                    simple: "32"
            accessor: File
            transformers:
            - operator: uniq
        SHA1:
          complex:
            root: ExtractedIndicators
            filters:
            - - operator: stringHasLength
                left:
                  value:
                    simple: ExtractedIndicators
                  iscontext: true
                right:
                  value:
                    simple: "40"
            accessor: File
            transformers:
            - operator: uniq
        SHA256:
          complex:
            root: ExtractedIndicators
            filters:
            - - operator: stringHasLength
                left:
                  value:
                    simple: ExtractedIndicators
                  iscontext: true
                right:
                  value:
                    simple: "64"
            accessor: File
            transformers:
            - operator: uniq
        SelectFields:
          simple: source,timestamp
        URLDomain:
          complex:
            root: ExtractedIndicators
            accessor: Domain
            transformers:
            - operator: uniq
        earliest_time:
          complex:
            root: inputs.SplunkEarliestTime
        event_limit:
          simple: "100"
        latest_time:
          complex:
            root: inputs.SplunkLatestTime
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 362.75,
          "y": 979
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "65":
    id: "65"
    taskid: 5a96320a-4e85-4c54-890f-1eca57019ea9
    type: playbook
    task:
      id: 5a96320a-4e85-4c54-890f-1eca57019ea9
      version: -1
      name: QRadar Indicator Hunting V2
      description: 'The Playbook queries QRadar SIEM for indicators such as file hashes, IP addresses, domains, or urls. '
      playbookName: QRadar Indicator Hunting V2
      type: playbook
      iscommand: false
      brand: ""
    scriptarguments:
      IPAddress:
        complex:
          root: ExtractedIndicators
          accessor: IP
          transformers:
          - operator: uniq
      InternalRange:
        complex:
          root: lists
          accessor: PrivateIPs
          transformers:
          - operator: RegexExtractAll
            args:
              error_if_no_match: {}
              ignore_case: {}
              multi_line: {}
              period_matches_newline: {}
              regex:
                value:
                  simple: (\b(?:\d{1,3}\.){3}\d{1,3}\b/\d{1,2})
              unpack_matches: {}
          - operator: join
            args:
              separator:
                value:
                  simple: ','
      InvestigationIPFields:
        simple: sourceip,destinationip
      InvestigationUserFields:
        simple: username
      QradarIPfield:
        simple: sourceip,destinationip
      SHA256:
        complex:
          root: ExtractedIndicators.File
          filters:
          - - operator: stringHasLength
              left:
                value:
                  simple: ExtractedIndicators.File
                iscontext: true
              right:
                value:
                  simple: "64"
          transformers:
          - operator: uniq
      TimeFrame:
        complex:
          root: inputs.QRadarTimeRange
      URLDomain:
        complex:
          root: ExtractedIndicators
          accessor: Domain
          transformers:
          - operator: uniq
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      scriptArguments:
        IPAddress:
          complex:
            root: ExtractedIndicators
            accessor: IP
            transformers:
            - operator: uniq
        InvestigationIPFields:
          simple: sourceip,destinationip
        InvestigationUserFields:
          simple: username
        MD5:
          complex:
            root: ExtractedIndicators.File
            filters:
            - - operator: stringHasLength
                left:
                  value:
                    simple: ExtractedIndicators.File
                  iscontext: true
                right:
                  value:
                    simple: "32"
            transformers:
            - operator: uniq
        QradarIPfield:
          simple: sourceip,destinationip
        SHA1:
          complex:
            root: ExtractedIndicators.File
            filters:
            - - operator: stringHasLength
                left:
                  value:
                    simple: ExtractedIndicators.File
                  iscontext: true
                right:
                  value:
                    simple: "40"
            transformers:
            - operator: uniq
        SHA256:
          complex:
            root: ExtractedIndicators.File
            filters:
            - - operator: stringHasLength
                left:
                  value:
                    simple: ExtractedIndicators.File
                  iscontext: true
                right:
                  value:
                    simple: "64"
            transformers:
            - operator: uniq
        TimeFrame:
          complex:
            root: inputs.QRadarTimeRange
        URLDomain:
          complex:
            root: ExtractedIndicators
            accessor: Domain
            transformers:
            - operator: uniq
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 743.75,
          "y": 979
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "68":
    id: "68"
    taskid: 4e38e571-907c-4255-8d73-56c8e544688f
    type: title
    task:
      id: 4e38e571-907c-4255-8d73-56c8e544688f
      version: -1
      name: Threat Hunting
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "98"
      - "71"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2771,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "70":
    id: "70"
    taskid: 6a31bacc-a930-4772-a118-0c43ac7a1efa
    type: playbook
    task:
      id: 6a31bacc-a930-4772-a118-0c43ac7a1efa
      version: -1
      name: Palo Alto Networks - Hunting And Threat Detection
      description: "This is a multipurpose playbook used for hunting and threat detection. The playbook receives inputs based on hashes, IP addresses, or domain names provided manually or from outputs by other playbooks. \nThe playbook leverages data received by PANW products including, Strata Logging Service, Autofocus and Pan-OS to search for IP addresses, host names and users related to the provided indicators.\nThe output provided by the playbook enables you to find possibly affected IP addresses, users, and endpoints."
      playbookName: Palo Alto Networks - Hunting And Threat Detection
      type: playbook
      iscommand: false
      brand: ""
    scriptarguments:
      IPAddresses:
        complex:
          root: ExtractedIndicators
          accessor: IP
          transformers:
          - operator: uniq
      InternalRange:
        complex:
          root: lists
          accessor: PrivateIPs
          transformers:
          - operator: RegexExtractAll
            args:
              error_if_no_match: {}
              ignore_case: {}
              multi_line: {}
              period_matches_newline: {}
              regex:
                value:
                  simple: (\b(?:\d{1,3}\.){3}\d{1,3}\b/\d{1,2})
              unpack_matches: {}
          - operator: join
            args:
              separator:
                value:
                  simple: ','
      SHA256:
        complex:
          root: ExtractedIndicators.File
          filters:
          - - operator: stringHasLength
              left:
                value:
                  simple: ExtractedIndicators.File
                iscontext: true
              right:
                value:
                  simple: "64"
          transformers:
          - operator: uniq
      URLDomain:
        complex:
          root: ExtractedIndicators
          accessor: Domain
          transformers:
          - operator: uniq
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 1120.5,
          "y": 976
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "71":
    id: "71"
    taskid: bf313341-ebef-4124-a61a-90e4d4ba81d8
    type: playbook
    task:
      id: bf313341-ebef-4124-a61a-90e4d4ba81d8
      version: -1
      name: Panorama Query Logs for Related Session
      description: 'Query Panorama Logs of types: traffic, threat, url, data-filtering and wildfire.'
      playbookName: Panorama Query Logs
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "28"
    scriptarguments:
      log_type:
        simple: threat
      query:
        simple: '(threatid eq 96181) '
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 2551.5,
          "y": 2594
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "72":
    id: "72"
    taskid: 4b886b78-92cf-42df-b20e-a8577c31277d
    type: condition
    task:
      id: 4b886b78-92cf-42df-b20e-a8577c31277d
      version: -1
      name: Are there any compromised hosts?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "15"
      "yes":
      - "73"
      - "81"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: alert.agentsid
            iscontext: true
          right:
            value: {}
        - operator: isNotEmpty
          left:
            value:
              simple: alert.agentid
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4191.5,
          "y": 1412
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "73":
    id: "73"
    taskid: ce2c66f1-5fbf-4b95-b054-db87bf343c1b
    type: title
    task:
      id: ce2c66f1-5fbf-4b95-b054-db87bf343c1b
      version: -1
      name: WebShell XQL hunt
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "75"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4193.25,
          "y": 1620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "74":
    id: "74"
    taskid: cca24334-4904-4bc7-9881-ae49625e1f75
    type: regular
    task:
      id: cca24334-4904-4bc7-9881-ae49625e1f75
      version: -1
      name: XQL Query - Search file creation event by certutil
      description: |-
        Execute an XQL query and retrieve results of an executed XQL query API. The command will be executed every 10 seconds until results are retrieved or until a timeout error is raised.
        When more than 1000 results are retrieved, the command will return a compressed gzipped JSON format file,
        unless the argument 'parse_result_file_to_context' is set to true and then the results will be extracted to the context.
      script: '|||xdr-xql-generic-query'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "94"
    scriptarguments:
      extend-context:
        simple: XQLPossibleMaliciousFiles=
      ignore-outputs:
        simple: "true"
      max_fields:
        simple: "100"
      query:
        simple: |-
          config case_sensitive = false timeframe=7d
          | dataset = xdr_data
          | filter event_type = ENUM.FILE and event_sub_type in (ENUM.FILE_WRITE, ENUM.FILE_CREATE_NEW, ENUM.FILE_RENAME, ENUM.FILE_REMOVE)
          | filter lowercase(action_file_extension) in ("jsp","class","jar","jspx","war","jnlp") and lowercase(action_file_path) contains  "\servlet_jsp\irj\" | fields agent_id,agent_hostname,action_file_path | dedup action_file_path
      query_name:
        simple: Check for possibles malicious payload
      time_frame:
        simple: 7 days ago
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3770.75,
          "y": 2288
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "75":
    id: "75"
    taskid: a2837c0f-f130-495c-8c75-e9efdd51c1f7
    type: condition
    task:
      id: a2837c0f-f130-495c-8c75-e9efdd51c1f7
      version: -1
      name: Is the integration of 'XQL Query Engine' available?
      description: Returns 'yes' if integration brand 'XQL Query Engine' is available. Otherwise returns 'no'.
      scriptName: IsIntegrationAvailable
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "97"
      "yes":
      - "77"
    scriptarguments:
      brandname:
        simple: XQL Query Engine
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4191.5,
          "y": 1720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "77":
    id: "77"
    taskid: 995518bd-e0c4-407e-8ef0-d42de40f3c93
    type: regular
    task:
      id: 995518bd-e0c4-407e-8ef0-d42de40f3c93
      version: -1
      name: Check XQL Quota
      description: Retrieve the amount of query quota available and used.
      script: '|||xdr-xql-get-quota'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "78"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3770.75,
          "y": 1950
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "78":
    id: "78"
    taskid: 8079423c-9130-49c0-8fa3-65cf4c1fb18c
    type: condition
    task:
      id: 8079423c-9130-49c0-8fa3-65cf4c1fb18c
      version: -1
      name: Is there enough quota?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "79"
      "yes":
      - "74"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: greaterThanOrEqual
          left:
            value:
              complex:
                root: PaloAltoNetworksXQL.Quota
                accessor: license_quota
                transformers:
                - operator: subtraction
                  args:
                    by:
                      value:
                        simple: PaloAltoNetworksXQL.Quota.used_quota
                      iscontext: true
            iscontext: true
          right:
            value:
              simple: "1"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3770.75,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "79":
    id: "79"
    taskid: e2622ab6-47ec-43de-9315-bf4bfa1e7526
    type: regular
    task:
      id: e2622ab6-47ec-43de-9315-bf4bfa1e7526
      version: -1
      name: 'Manual â€“ Search the file using XQL query and quarantine the files '
      description: |-
        Dear Analyst,

        Ensure that the 'XQL Query Engine' integration is active. If it's not enabled, activate the integration or manually run the following XQL query to determine if a file was successfully downloaded from a malicious URL using certutil.

        Query:

        config case_sensitive = false timeframe=7d
        | dataset = xdr_data
        | filter event_type = ENUM.FILE and event_sub_type in (ENUM.FILE_WRITE, ENUM.FILE_CREATE_NEW, ENUM.FILE_RENAME, ENUM.FILE_REMOVE)
        | filter lowercase(action_file_extension) in ("jsp","class","jar","jspx","war","jnlp") and lowercase(action_file_path) contains  "\servlet_jsp\irj\" | fields agent_id,agent_hostname,action_file_path | dedup action_file_path

        If the query output indicates a file created by a malicious certutil command line with a malicious URL, quarantine and remove the file immediately.
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "97"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4191.5,
          "y": 2288
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "80":
    id: "80"
    taskid: 76ab84e1-c3ee-4ac7-8c73-caa970c83422
    type: title
    task:
      id: 76ab84e1-c3ee-4ac7-8c73-caa970c83422
      version: -1
      name: No data found on MS
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -284,
          "y": 1035
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "81":
    id: "81"
    taskid: 8c39419a-5aeb-4858-9db0-dac059efa169
    type: title
    task:
      id: 8c39419a-5aeb-4858-9db0-dac059efa169
      version: -1
      name: Potential WebShells Via Script
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "96"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4605.5,
          "y": 1615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "82":
    id: "82"
    taskid: 6e6ddc93-94d2-418a-987d-842b3279293f
    type: regular
    task:
      id: 6e6ddc93-94d2-418a-987d-842b3279293f
      version: -1
      name: Check for any other files in that directory
      description: Initiate a new endpoint script execution of shell commands.
      script: '|||core-run-script-execute-commands'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "89"
    scriptarguments:
      commands:
        complex:
          root: alert.filepath
          filters:
          - - operator: containsGeneral
              left:
                value:
                  simple: alert.filepath
                iscontext: true
              right:
                value:
                  simple: servlet_jsp\irj
          transformers:
          - operator: RegexExtractAll
            args:
              error_if_no_match: {}
              ignore_case: {}
              multi_line: {}
              period_matches_newline: {}
              regex:
                value:
                  simple: ^(.*\\)[^\\]+$
              unpack_matches: {}
          - operator: concat
            args:
              prefix:
                value:
                  simple: 'dir '
              suffix: {}
      endpoint_ids:
        complex:
          root: alert
          accessor: agentid
          transformers:
          - operator: AppendIfNotEmpty
            args:
              item:
                value:
                  simple: alert.agentsid
                iscontext: true
              raw: {}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4872.5,
          "y": 1880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "84":
    id: "84"
    taskid: d471cdcb-d9cd-4a37-9db6-c45fb6c0e921
    type: playbook
    task:
      id: d471cdcb-d9cd-4a37-9db6-c45fb6c0e921
      version: -1
      name: Containment Plan - Block Indicators
      description: |-
        ## Containment Plan - Block Indicators

        This playbook is a sub-playbook within the containment plan playbook.

        ### Indicator Blocking

        The playbook block indicators by two methods:

        1. It adds the malicious hashes into the XSIAM hash block list
        2. It utilizes the sub-playbook "Block Indicators - Generic v3"
      playbookName: Containment Plan - Block Indicators
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "93"
    scriptarguments:
      AutoBlockIndicators:
        simple: "True"
      AutoContainment:
        simple: "True"
      BlockIndicators:
        simple: "True"
      Domain:
        complex:
          root: ExtractedIndicators
          accessor: Domain
          transformers:
          - operator: uniq
      FileHash:
        complex:
          root: ExtractedIndicators.File
          filters:
          - - operator: stringHasLength
              left:
                value:
                  simple: ExtractedIndicators.File
                iscontext: true
              right:
                value:
                  simple: "64"
          transformers:
          - operator: uniq
      IP:
        complex:
          root: ExtractedIndicators
          accessor: IP
          transformers:
          - operator: uniq
      URL:
        complex:
          root: ExtractedIndicators
          accessor: URL
          transformers:
          - operator: uniq
      UserVerification:
        simple: "False"
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 3356.25,
          "y": 3053
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "87":
    id: "87"
    taskid: d4c425d9-8a3d-4007-a4eb-dfbaac1cf9a6
    type: regular
    task:
      id: d4c425d9-8a3d-4007-a4eb-dfbaac1cf9a6
      version: -1
      name: Mitigation Actions
      description: "# The following bullets are intent to assist you with the mitigation of the following incident\n\n## Patch Recommendations For SAP Visual Composer. \n\nAccording to the Onapsis blog - \nhttps://onapsis.com/blog/active-exploitation-of-sap-vulnerability-cve-2025-31324/\n\n### Please refer to the following link to download and patch your SAP product according to the vendor's advisory. Link below:\n[SAP Security Note #3594142](https://me.sap.com/notes/3594142)\n\n### For more information, here is the link to SAP's FAQ:\n[SAP Note #3596125](https://me.sap.com/notes/3596125/E)\n\n### Provides workaround mitigation steps for customers that cannot apply the patch.\n[SAP Note #3593336](https://me.sap.com/notes/3593336/E)\n\n\n## Sigma Rules:\n**Note**\nThe Sigma rules yet been merged to the public repository. You can browse them and apply based on the Pull Request mentioned below:\n\nhttps://github.com/SigmaHQ/sigma/pull/5387/files\n\n\n## You can implement the following YARA rule \n\n[Link to the blog for this Yara rule](https://onapsis.com/blog/active-exploitation-of-sap-vulnerability-cve-2025-31324/)\n\nrule detect_CVE202531324_webshells_by_name\n`{\n    meta:\n        description = â€œDetects the known webshell file names that are uploaded in the root directoryâ€\n        author = â€œEmanuela Ionas, Onapsis Research Labsâ€\n        date = â€œ2025-05-05â€\n        tags = â€œCVE-2025-31324â€\n    strings:\n        $webshell_1 = â€œ/irj/cache.jspâ€ nocase\n        $webshell_2 = â€œ/irj/helper.jspâ€ nocase\n        $webshell_3 = â€œ/irj/forwardsap.jspâ€ nocase\n        $webshell_4 = â€œ/irj/coresap.jspâ€ nocase\n        $webshell_5 = â€œ/irj/webhelp.jspâ€ nocase\n        $webshell_6 = â€œ/irj/.webhelper.jspâ€ nocase\n        $webshell_7 = â€œ/irj/usage.jspâ€ nocase\n        $webshell_8 = â€œ/irj/usage1.jspâ€ nocase\n        $webshell_9 = â€œ/irj/404_error.jspâ€ nocase\n        $webshell_10 = â€œ/irj/.h.jspâ€ nocase\n        $webshell_regex = /\\/irj\\/[._a-zA-Z0-9]{2,10}\\.jsp/\n        $status = /HTTP\\/[12]\\.[012]\\s+200/\n    condition:\n        ($webshell_1 or $webshell_2 or $webshell_3 or $webshell_4 or $webshell_5 or $webshell_6 or $webshell_7 or $webshell_8 or $webshell_9 or $webshell_10 or $webshell_regex) and $status\n}`\n\n## Monitor Creation of Suspicious Files with XQL. \nUse the following XQL to identify any suspicious activity created \n\n``` config case_sensitive = false timeframe=30d\n| dataset = xdr_data\n| filter event_type = ENUM.FILE and event_sub_type in (ENUM.FILE_WRITE, ENUM.FILE_CREATE_NEW, ENUM.FILE_RENAME, ENUM.FILE_REMOVE)\n| filter lowercase(action_file_extension) in (\"jsp\",\"class\",\"jar\",\"jspx\",\"war\",\"jnlp\") and lowercase(action_file_path) contains  \"\\servlet_jsp\\irj\\\" ```"
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "38"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3592.5,
          "y": 3657
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "89":
    id: "89"
    taskid: ca5022cb-65be-408a-ba57-ba18c2ae52b9
    type: regular
    task:
      id: ca5022cb-65be-408a-ba57-ba18c2ae52b9
      version: -1
      name: Get script results
      description: Retrieve the results of a script execution action.
      script: '|||core-get-script-execution-results'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "90"
    scriptarguments:
      action_id:
        simple: ${Core.ScriptRun.action_id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4872.5,
          "y": 2005
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "90":
    id: "90"
    taskid: 4231354a-b09b-4cc9-a9ef-e1fae171c91d
    type: regular
    task:
      id: 4231354a-b09b-4cc9-a9ef-e1fae171c91d
      version: -1
      name: Extract file potential files
      description: "Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.\n\nThis automation runs using the default Limited User role, unless you explicitly change the permissions.\nFor more information, see the section about permissions here:\n- For Cortex XSOAR 6 see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n- For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "97"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Potential_suspicious_files
      value:
        complex:
          root: Core.ScriptResult.results
          accessor: standard_output
          transformers:
          - operator: RegexExtractAll
            args:
              error_if_no_match: {}
              ignore_case: {}
              multi_line: {}
              period_matches_newline: {}
              regex:
                value:
                  simple: \b[\w.-]+\.(jsp|class|jar|jspx|war|jnlp)\b
              unpack_matches: {}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4872.5,
          "y": 2139
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "92":
    id: "92"
    taskid: 2e95ff0e-542b-4fd2-9b4b-a8c2cf3f8e4e
    type: regular
    task:
      id: 2e95ff0e-542b-4fd2-9b4b-a8c2cf3f8e4e
      version: -1
      name: Set Agent IDs to Alert Context
      description: commands.local.cmd.set.incident
      script: Builtin|||setAlert
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      agentsid:
        simple: ${PaloAltoNetworksXQL.GenericQuery.results.agent_id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3211.5,
          "y": 904
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "93":
    id: "93"
    taskid: fa98a78c-6a7a-4d73-9521-066cd65f3385
    type: condition
    task:
      id: fa98a78c-6a7a-4d73-9521-066cd65f3385
      version: -1
      name: Are there any potential WebShells found?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "31"
      "yes":
      - "95"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Potential_suspicious_files
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3590,
          "y": 3196
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "94":
    id: "94"
    taskid: 3c9e5d5c-cc1f-4398-9fe7-b351d4207e4e
    type: regular
    task:
      id: 3c9e5d5c-cc1f-4398-9fe7-b351d4207e4e
      version: -1
      name: Set Potential Files Paths
      description: "Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.\n\nThis automation runs using the default Limited User role, unless you explicitly change the permissions.\nFor more information, see the section about permissions here:\n- For Cortex XSOAR 6 see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n- For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "97"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Potential_suspicious_files
      value:
        simple: ${XQLPossibleMaliciousFiles.results.action_file_path}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3770.75,
          "y": 2530
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "95":
    id: "95"
    taskid: d3728ed9-ffcd-46e4-91f6-1821e4c02de9
    type: regular
    task:
      id: d3728ed9-ffcd-46e4-91f6-1821e4c02de9
      version: -1
      name: Manual Action - Quarantine
      description: "As a part of the playbook, we have determined potential webshells that might be in the same directory *\"...servlet_jsp\\irj\\....\"*.\nSince we can't determine with strong confidence that those files are webshells, we suggest that you investigate them and quarantine as needed. \n\nList of files:\n${Potential_suspicious_files}\n\nList of agent IDs:\n${alert.agentid}\n${alert.agentsid}"
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "31"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3833,
          "y": 3361
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "96":
    id: "96"
    taskid: 9742b3be-3d5f-40e4-854a-cd65fbd4c75e
    type: condition
    task:
      id: 9742b3be-3d5f-40e4-854a-cd65fbd4c75e
      version: -1
      name: Is there a File path
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "97"
      "yes":
      - "82"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: alert.filepath
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4602,
          "y": 1720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "97":
    id: "97"
    taskid: bace7c34-eb29-42ea-9df6-4903ca8015d6
    type: title
    task:
      id: bace7c34-eb29-42ea-9df6-4903ca8015d6
      version: -1
      name: Finished Analysis
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "28"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 4605.5,
          "y": 2673
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "98":
    id: "98"
    taskid: 0304a606-f6cf-4f55-b8df-dd5a0d073be4
    type: playbook
    task:
      id: 0304a606-f6cf-4f55-b8df-dd5a0d073be4
      version: -1
      name: Threat Hunting - Generic
      description: "This playbook enables threat hunting for IOCs in your enterprise. It currently supports the following integrations: \n- Splunk\n- Qradar\n- Pan-os \n- Cortex Data Lake \n- Autofocus\n- Microsoft 365 Defender"
      playbookName: Threat Hunting - Generic
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "28"
    scriptarguments:
      IPAddress:
        complex:
          root: ExtractedIndicators
          accessor: IP
          transformers:
          - operator: uniq
      InternalRange:
        complex:
          root: lists
          accessor: PrivateIPs
          transformers:
          - operator: RegexExtractAll
            args:
              error_if_no_match: {}
              ignore_case: {}
              multi_line: {}
              period_matches_newline: {}
              regex:
                value:
                  simple: (\b(?:\d{1,3}\.){3}\d{1,3}\b/\d{1,2})
              unpack_matches: {}
          - operator: join
            args:
              separator:
                value:
                  simple: ','
      QRadarTimeFrame:
        simple: ${inputs.QRadarTimeRange}
      SHA256:
        complex:
          root: ExtractedIndicators.File
          filters:
          - - operator: hasLength
              left:
                value:
                  simple: ExtractedIndicators.File
                iscontext: true
              right:
                value:
                  simple: "64"
          transformers:
          - operator: uniq
      SplunkEarliestTime:
        simple: ${inputs.SplunkEarliestTime}
      SplunkLatestTime:
        simple: ${inputs.SplunkLatestTime}
      URLDomain:
        complex:
          root: ExtractedIndicators
          accessor: URL
          transformers:
          - operator: AppendIfNotEmpty
            args:
              item:
                value:
                  simple: ExtractedIndicators.Domain
                iscontext: true
              raw: {}
          - operator: uniq
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 3001,
          "y": 2594
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "99":
    id: "99"
    taskid: 839be7e8-0cb0-459c-a03f-bf839a65ffd8
    type: condition
    task:
      id: 839be7e8-0cb0-459c-a03f-bf839a65ffd8
      version: -1
      name: Any results from Threat Hunting??
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "38"
      "yes":
      - "102"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Splunk
            iscontext: true
          right:
            value: {}
        - operator: isNotEmpty
          left:
            value:
              simple: PANWHunting
            iscontext: true
        - operator: isNotEmpty
          left:
            value:
              simple: QRadar
            iscontext: true
        - operator: isNotEmpty
          left:
            value:
              simple: Microsoft365Defender
            iscontext: true
        - operator: isNotEmpty
          left:
            value:
              simple: Panorama.Monitor.Logs
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3987,
          "y": 3657
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "102":
    id: "102"
    taskid: 20f1e810-0761-45a5-ab4f-f65ae1bcef80
    type: regular
    task:
      id: 20f1e810-0761-45a5-ab4f-f65ae1bcef80
      version: -1
      name: Review Threat Hunting Results
      description: The "Threat Hunting - Generic" playbook returned results. Please review the Playbook outputs and act accordingly.
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "38"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3987,
          "y": 3818
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "103":
    id: "103"
    taskid: fada94d7-eab7-4de8-9fd0-a0a68fd7be15
    type: collection
    task:
      id: fada94d7-eab7-4de8-9fd0-a0a68fd7be15
      version: -1
      name: Any results from the manual XQL?
      type: collection
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "104"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3702.25,
          "y": 684
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to:
      subject:
      body:
        simple: Are there any SAP NetWeaver Visual Composer instances in your env?
      methods: []
      format: ""
      bcc:
      cc:
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
        completeafterv2: true
        completeaftersla: false
      replyOptions:
      - "Yes"
      - "No"
    form:
      questions:
      - id: 87805282-9958-404d-a9de-376eea3596bb
        label: ""
        labelarg:
          simple: Please provide the agent IDs for those machines. If you have multiple endpoints, enter them as comma-separated values.
        required: false
        gridcolumns: []
        defaultrows: []
        type: shortText
        options: []
        optionsarg:
        - simple: "Yes"
        - simple: "No"
        fieldassociated: ""
        placeholder: ""
        tooltip: ""
        readonly: false
      title: Have you find any instances of SAP NetWaver?
      description: ""
      sender: ""
      expired: false
      totalanswers: 0
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "104":
    id: "104"
    taskid: 91541111-9bef-4e5d-a623-5af45152184e
    type: regular
    task:
      id: 91541111-9bef-4e5d-a623-5af45152184e
      version: -1
      name: Set Agent IDs to Alert Context
      description: commands.local.cmd.set.incident
      script: Builtin|||setAlert
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      agentsid:
        complex:
          root: Have you find any instances of SAP NetWaver?.Answers
          accessor: "0"
          transformers:
          - operator: split
            args:
              delimiter:
                value:
                  simple: ','
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3702.25,
          "y": 882
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 4952,
        "width": 6649.5,
        "x": -1396,
        "y": -465
      }
    }
  }
inputs:
- key: SplunkIndex
  value:
    simple: '*'
  required: false
  description: |-
    The Splunk index field to search in.
    Default is "*"
  playbookInputQuery:
- key: SplunkSourcetype
  value:
    simple: '*'
  required: false
  description: |-
    The Splunk sourcetype field to search in.
    Default is "*"
  playbookInputQuery:
- key: SplunkEarliestTime
  value:
    simple: -1d@d
  required: false
  description: The earliest time for Splunk query.
  playbookInputQuery:
- key: SplunkLatestTime
  value:
    simple: now
  required: false
  description: The latest time for the Splunk search query.
  playbookInputQuery:
- key: XDRScriptExecution
  value:
    simple: "False"
  required: false
  description: Whether to investigate automatically the endpoint logs "/var/log" using XDR Endpoint Script Execution or manually.
  playbookInputQuery:
- key: XDREndpointIDs
  value: {}
  required: false
  description: The Endpoint IDs to search using XDR Endpoint Script Execution in a comma delimited format. If you would like the playbook to execute the command on all known Linux OS endpoints Set to "ALL".
  playbookInputQuery:
- key: PlaybookDescription
  value:
    simple: "Critical RCE Vulnerability: log4j - CVE-2021-44228\n\nOn Dec. 9, 2021, a remote code execution (RCE) vulnerability in Apache log4j 2 was identified being exploited in the wild. Public proof of concept (PoC) code was released and subsequent investigation revealed that exploitation was incredibly easy to perform. \n\nOn Dec. 14 2021, another vulnerability was discovered related the log4j 0-day exploit known as CVE-2021-45046.\n\nOn Dec 18 2021, yet another vulnerability was discovered related the log4j 0-day exploit known as CVE-2021-45105 that allows an attacker with control over Thread Context Map data to cause a denial of service when a crafted string is interpreted. This issue was fixed in Log4j 2.17.0 and 2.12.3.\n\nOn Dec 28 2021, another RCE vulnerability was published for Apache Log4j2, versions 2.0-beta7 through 2.17.0 (excluding security fix releases 2.3.2 and 2.12.4).\nIn order to exploit this vulnerability, an attacker with permission to modify the logging configuration file can construct a malicious configuration using a JDBC Appender with a data source referencing a JNDI URI which can execute remote code. This issue is fixed by limiting JNDI data source names to the java protocol in Log4j2 versions 2.17.1, 2.12.4, and 2.3.2.\n\n**Affected Version**\n\nApache Log4j 2.x <= 2.17.0\n\nThis playbook should be triggered manually or can be configured as a job.\nPlease create a new incident and choose the **CVE-2021-44228 - Log4j RCE** playbook and **Rapid Breach Response** incident type.\n\n**The playbook includes the following tasks:**\n\n* Collect related known indicators from several sources.\n* Indicators and exploitation patterns hunting using PAN-OS, Cortex XDR and SIEM products.\n*Search for possible vulnerable servers using Xpanse and Prisma Cloud.\n* Block indicators automatically or manually.\n\n**Mitigations:**\n* Apache official CVE-2021-44228 patch.\n* Unit42 recommended mitigations.\n* Detection Rules.\n    * Snort\n    * Suricata\n    * Sigma\n    * Yara\n    * Zeek Intel\n\nMore information:\n[Apache Log4j Vulnerability Is Actively Exploited in the Wild (CVE-2021-44228)](https://unit42.paloaltonetworks.com/apache-log4j-vulnerability-cve-2021-44228/)\n\nNote: This is a beta playbook, which lets you implement and test pre-release software. Since the playbook is beta, it might contain bugs. Updates to the pack during the beta phase might include non-backward compatible features. We appreciate your feedback on the quality and usability of the pack to help us identify issues, fix them, and continually improve."
  required: false
  description: The playbook description for Rapid Breach Response layout.
  playbookInputQuery:
- key: EDLDomainBlocklist
  value: {}
  required: false
  description: The EDL domain blocklist name.
  playbookInputQuery:
- key: BlockIndicatorsAutomatically
  value:
    simple: "True"
  required: false
  description: Whether to block the indicators automatically or not.
  playbookInputQuery:
- key: CollectedIndicatorsSeverity
  value:
    simple: Malicious
  required: false
  description: "The verdict of the collected indicators. Default is \"Malicious\". \nOther options can be \"Suspicious\" and \"Unknown\"."
  playbookInputQuery:
- key: RunXQLHuntingQueries
  value:
    simple: "False"
  required: false
  description: Whether to perform XQL hunting queries. Default is "False".
  playbookInputQuery:
- key: RelatedCVEs
  value:
    simple: CVE-2025-31324
  required: false
  description: The log4j related CVEs.
  playbookInputQuery:
- key: QRadarTimeRange
  value:
    simple: Last 1 DAYS
  required: false
  description: The time range for QRadar query.
  playbookInputQuery:
- key: UserVerification
  value:
    simple: "False"
  required: false
  description: "Possible values: True/False.\nWhether to provide user verification for blocking IPs. \n\nFalse - No prompt will be displayed to the user.\nTrue - The server will ask the user for blocking verification and will display the blocking list."
  playbookInputQuery:
- key: AutoBlockIndicators
  value:
    simple: "False"
  required: false
  description: |-
    |-
    Should the given indicators be automatically blocked, or should the user be given the option to choose?
    If set to False - no prompt will appear, and all provided indicators will be blocked automatically. If set to True - the user will be prompted to select which indicators to block.
  playbookInputQuery:
inputSections:
- inputs:
  - SplunkIndex
  - SplunkSourcetype
  - SplunkEarliestTime
  - SplunkLatestTime
  - XDRScriptExecution
  - XDREndpointIDs
  - PlaybookDescription
  - EDLDomainBlocklist
  - BlockIndicatorsAutomatically
  - CollectedIndicatorsSeverity
  - RunXQLHuntingQueries
  - RelatedCVEs
  - QRadarTimeRange
  - UserVerification
  - AutoBlockIndicators
  name: General (Inputs group)
  description: Generic group for inputs
outputSections:
- outputs: []
  name: General (Outputs group)
  description: Generic group for outputs
outputs: []
tests:
- No tests (auto formatted)
fromversion: 6.10.0
