CVE-2025-31324 is a critical zero-day vulnerability affecting the Metadata Uploader component of SAP NetWeaver Visual Composer. The vulnerability arises from missing authorization checks, allowing unauthenticated attackers to upload malicious executable binaries. Exploitation of this flaw can lead to full remote code execution (RCE) on affected systems, posing a significant risk to confidentiality, integrity, and availability

## CVE-2025-31324 - SAP NetWeaver RCE Vulnerability

## üîç  Vulnerability Overview

- **Component Affected**: SAP NetWeaver Visual Composer Metadata Uploader  
- **Endpoint**: `/developmentserver/metadatauploader`  
- **CVE ID**: CVE-2025-31324  
- **CVSS Score**: 10.0 (Critical)  
- **Exploitability**: Unauthenticated remote attackers can exploit this without user interaction  

This flaw allows unauthenticated attackers to upload arbitrary files (e.g., JSP web shells), enabling remote code execution with the same privileges as the SAP application server process.  
[Source: Unit42 - Palo Alto Networks](https://unit42.paloaltonetworks.com/threat-brief-sap-netweaver-cve-2025-31324/)


## üõ°Ô∏è Mitigation and Recommendations

- üîß **Apply Patch**: SAP Note #3594142 (released April 24, 2025)  
- üö´ **Disable Visual Composer** if not in use  
- üîí **Restrict Access** to the vulnerable endpoint  
- üîç **Monitor for IoCs** in `/irj/servlet_jsp/irj/root/` and suspicious traffic  

## üìå Conclusion

CVE-2025-31324 is actively exploited and critically severe. Organizations should patch immediately, monitor for compromise, and disable or restrict vulnerable components.

‚û°Ô∏è [View official CVE details on NIST](https://nvd.nist.gov/vuln/detail/CVE-2025-31324)

## üîî Alert Triggering
1. Manually
2. Part of Agent alert -> "CVE Exploitation - 986328356"

 ##  ‚ñ∂Ô∏è Playbook Flow
1. Using XQL, identify potential SAP NetWeaver instances in your environment.
2. Using XQL, check if there are events that point to any potential webshells downloaded in the directories.
3. Using Agent Script, identify if there are already any suspicious files that might indicate a webshell.
4. *Collect* IOCs from a Unit42 blog, *search* them using the "Threat Hunting - Generic" playbook ( supports Palo Alto products, Qradar, and Splunk), and *block* those indicators
5. Provides Mitigation actions.


## Dependencies

This playbook uses the following sub-playbooks, integrations, and scripts.

### Sub-playbooks

* Containment Plan - Block Indicators
* Panorama Query Logs for Related Session
* Threat Hunting - Generic

### Integrations

This playbook does not use any integrations.

### Scripts

* IsIntegrationAvailable
* ParseHTMLIndicators
* SetAndHandleEmpty

### Commands

* associateIndicatorsToAlert
* closeInvestigation
* core-get-script-execution-results
* core-run-script-execute-commands
* createNewIndicator
* extractIndicators
* setAlert
* xdr-xql-generic-query
* xdr-xql-get-quota

## Playbook Inputs

---

| **Name** | **Description** | **Default Value** | **Required** |
| --- | --- | --- | --- |
| SplunkIndex | The Splunk index field to search in.<br/>Default is "\*" | * | Optional |
| SplunkSourcetype | The Splunk sourcetype field to search in.<br/>Default is "\*" | * | Optional |
| SplunkEarliestTime | The earliest time for Splunk query. | -1d@d | Optional |
| SplunkLatestTime | The latest time for the Splunk search query. | now | Optional |
| XDRScriptExecution | Whether to investigate automatically the endpoint logs "/var/log" using XDR Endpoint Script Execution or manually. | False | Optional |
| XDREndpointIDs | The Endpoint IDs to search using XDR Endpoint Script Execution in a comma delimited format. If you would like the playbook to execute the command on all known Linux OS endpoints Set to "ALL". |  | Optional |
| PlaybookDescription | The playbook description for Rapid Breach Response layout. | Critical RCE Vulnerability: log4j - CVE-2021-44228<br/><br/>On Dec. 9, 2021, a remote code execution (RCE) vulnerability in Apache log4j 2 was identified being exploited in the wild. Public proof of concept (PoC) code was released and subsequent investigation revealed that exploitation was incredibly easy to perform. <br/><br/>On Dec. 14 2021, another vulnerability was discovered related the log4j 0-day exploit known as CVE-2021-45046.<br/><br/>On Dec 18 2021, yet another vulnerability was discovered related the log4j 0-day exploit known as CVE-2021-45105 that allows an attacker with control over Thread Context Map data to cause a denial of service when a crafted string is interpreted. This issue was fixed in Log4j 2.17.0 and 2.12.3.<br/><br/>On Dec 28 2021, another RCE vulnerability was published for Apache Log4j2, versions 2.0-beta7 through 2.17.0 (excluding security fix releases 2.3.2 and 2.12.4).<br/>In order to exploit this vulnerability, an attacker with permission to modify the logging configuration file can construct a malicious configuration using a JDBC Appender with a data source referencing a JNDI URI which can execute remote code. This issue is fixed by limiting JNDI data source names to the java protocol in Log4j2 versions 2.17.1, 2.12.4, and 2.3.2.<br/><br/>**Affected Version**<br/><br/>Apache Log4j 2.x &lt;= 2.17.0<br/><br/>This playbook should be triggered manually or can be configured as a job.<br/>Please create a new incident and choose the **CVE-2021-44228 - Log4j RCE** playbook and **Rapid Breach Response** incident type.<br/><br/>**The playbook includes the following tasks:**<br/><br/>* Collect related known indicators from several sources.<br/>* Indicators and exploitation patterns hunting using PAN-OS, Cortex XDR and SIEM products.<br/>*Search for possible vulnerable servers using Xpanse and Prisma Cloud.<br/>* Block indicators automatically or manually.<br/><br/>**Mitigations:**<br/>* Apache official CVE-2021-44228 patch.<br/>* Unit42 recommended mitigations.<br/>* Detection Rules.<br/>    * Snort<br/>    * Suricata<br/>    * Sigma<br/>    * Yara<br/>    * Zeek Intel<br/><br/>More information:<br/>[Apache Log4j Vulnerability Is Actively Exploited in the Wild (CVE-2021-44228)](https://unit42.paloaltonetworks.com/apache-log4j-vulnerability-cve-2021-44228/)<br/><br/>Note: This is a beta playbook, which lets you implement and test pre-release software. Since the playbook is beta, it might contain bugs. Updates to the pack during the beta phase might include non-backward compatible features. We appreciate your feedback on the quality and usability of the pack to help us identify issues, fix them, and continually improve. | Optional |
| EDLDomainBlocklist | The EDL domain blocklist name. |  | Optional |
| BlockIndicatorsAutomatically | Whether to block the indicators automatically or not. | True | Optional |
| CollectedIndicatorsSeverity | The verdict of the collected indicators. Default is "Malicious". <br/>Other options can be "Suspicious" and "Unknown". | Malicious | Optional |
| RunXQLHuntingQueries | Whether to perform XQL hunting queries. Default is "False". | False | Optional |
| RelatedCVEs | The log4j related CVEs. | CVE-2025-31324 | Optional |
| QRadarTimeRange | The time range for QRadar query. | Last 1 DAYS | Optional |
| UserVerification | Possible values: True/False.<br/>Whether to provide user verification for blocking IPs. <br/><br/>False - No prompt will be displayed to the user.<br/>True - The server will ask the user for blocking verification and will display the blocking list. | False | Optional |
| AutoBlockIndicators | \|-<br/>Should the given indicators be automatically blocked, or should the user be given the option to choose?<br/>If set to False - no prompt will appear, and all provided indicators will be blocked automatically. If set to True - the user will be prompted to select which indicators to block. | False | Optional |

## Playbook Outputs

---
There are no outputs for this playbook.

## Playbook Image

---

![CVE-2025-31324  - SAP NetWeaver Visual Composer](../doc_files/CVE-2025-31324__-_SAP_NetWeaver_Visual_Composer.png)
