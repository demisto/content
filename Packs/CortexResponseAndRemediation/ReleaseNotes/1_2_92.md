
#### Playbooks

<!-- ##### New: silent-First Azure AD PowerShell operation for a user

**This playbook addresses the following alert**:
- First Azure AD PowerShell operation for a user

**Playbook Stages**:

**Triage**:
- Gather initial information about the user.
- Check IP Reputation.
- Check the User Agent.

**Investigation**:
- **Check for Azure Alerts**:
  - Extract recent Azure security alerts for the user.
- **Check if User is Risky**:
  - Assess the user's risk score based on Core and Azure risk indicators.
  - Investigate reasons behind any identified risks, including recent detections.
- **Investigate user data**:
  - Check the user creation date to asses if the user is new.
  - Check the role of the user.

**Containment**:
- The playbook checks if soft remediation is needed, if yes, it will check if the integration "Microsoft Graph User" is enabled, the playbook will revoke the sessions of the user.
- The playbook checks if hard remediation is needed, if yes, 
a manual task will be displayed for an analyst to review the findings and decide the next steps.
- Possible actions:
  - Disable the user.
  - Take no action.

**Requirements**:
For the best results, it's recommended to ensure these integrations are configured and working:
- `Cortex Core - Investigation and Response` for Core user risk evaluation.
- `Azure Risky Users` for retrieving user risk scores.
- `Microsoft 365 Defender` for advanced hunting queries and Azure security alerts.
- `Microsoft Graph User` is used to disable user and revoke session.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-Windows LOLBIN scripting engine connected to a rare external host

This playbook handles "Windows LOLBIN scripting engine connected to a rare external host" alerts.

### **Analysis**
* Analyzes the suspicious command line to score its risk level.
* Gathers related alerts to provide broader context for the investigation.

### **Investigation**
* Extracts and enriches any URLs or domains found in the command to check their reputation.
* Determines if the activity is malicious based on a high-risk command score, other related threat alerts, or a malicious verdict for the URL/domain.
* If no threat indicators are found, the playbook closes the alert as a False Positive.

### **Remediation**
* If the activity is deemed malicious, the playbook automatically terminates the offending process.
* It seeks analyst approval to block any identified malicious URLs via a PAN-OS firewall.
* It recommends isolating the endpoint if it is a workstation, pending analyst approval. For servers or disconnected endpoints, it notifies the analyst that manual action is required.
* After taking action, it closes the alert as a True Positive.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-A remote service with an uncommon name was created via RPC over SMB

This playbook is triggered by an alert for the creation of a remote service with an uncommon name using the RPC over SMB protocol. It is designed to automatically investigate and respond to this activity, which is a common lateral movement technique used by attackers to establish persistence and execute malicious code on remote systems. The playbook analyzes the service, process, and network activity, and if the activity is deemed malicious, it will automatically perform remediation steps such as isolating the endpoint and removing the malicious service.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-A mail forwarding rule was configured in Google Workspace Test

##### This playbook addresses the following alerts:

- A mail forwarding rule was configured in Google Workspace.
- A mail forwarding rule was configured in Google Workspace to an uncommon domain.

##### Playbook Stages:
 
Triage: 

- The playbook retrieves the caller's IP, the forwarding email address, and associated filters.

###### Early Containment:

- The playbook checks if the IP or domain of the forwarding email address is malicious. If so, it suggests blocking the IP using PAN-OS while continuing the investigation in parallel.

###### Investigation:

- The playbook verifies if the rule was created outside of working hours or from an unusual geolocation and extracts suspicious keywords from the forwarding rules. It then aggregates all evidence collected during the investigation.

###### Containment:

- If only one suspicious evidence is found, the playbook executes soft response actions, including signing the user out and deleting the forwarding email address from the user account mailbox. The user will be notified of these actions via email.
- If multiple suspicious evidences are found, the playbook executes both soft and hard response actions, recommending the analyst suspend the user account.

Requirements: 

For any response action, you need one of the following integrations:
- Gmail integration to fetch filters and remove the forwarding email address.
- Google Workspace Admin access to sign out and suspend the user account.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-Endpoint initiated uncommon remote scheduled task creation Test

This playbook handles "Uncommon remote scheduled task creation" alert, which is generated on the source host that created the remote scheduled task.

##### Playbook Stages:

Analysis:

- The playbook verifies whether the causality process is signed and prevalent. If the process is not signed and not prevalent, it proceeds with remediation actions; otherwise, it continues investigating the alert.

###### Investigation:

During the alert investigation, the playbook will perform the following:

- Searches for related Cortex XSIAM alerts on the endpoint that use the following MITRE techniques to identify malicious activity: T1202 - Indirect Command Execution, T1021 - Remote Services.
- Searches for related Cortex XSIAM agent alerts on the remote endpoint, to determine if the creation of the scheduled task is part of an attack pattern.
- Searches for suspicious command-line parameters indicating a malicious scheduled task.

Remediation:

- Automatically disable the malicious scheduled task on the remote host.
- Automatically terminate the causality process.
- Automatically close the alert.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-External Login Password Spray Test

This playbook is designed to handle the following alerts:

- Successful External Login Password Spray
- External Login Password Spray on a Domain Controller
- External Login Password Spray Involving a Honey User
- Successful External Login Password Spray on a Domain Controller
- Successful External Login Password Spray on a sensitive server

The playbook is designed to investigate and respond to external login password sprays. It enriches the external IP to enable early containment, retrieves event information, and determines how the attack was carried out and whether it was successful.

##### Playbook Stages:

###### Early Containment:

- With analyst approval, the playbook will block the malicious external IP address involved in the password spray attack, limiting the attacker's ability to continue their actions.

###### Investigation:

- The playbook analyzes the timestamps of the login attempts to detect patterns, checks whether any logons were successful, and retrieves the Risk Score for users who successfully logged in as part of the attack.

###### Containment:

- Based on the user’s risk level, the playbook will expire the user’s password to prevent further unauthorized access and terminate any active RDP sessions for the affected user.

##### Requirements:

- For response actions, the following integrations are required: Active Directory (AD), PAN-OS, Core - IR.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
##### New: A user deleted multiple users for the first time

##### This playbook addresses the following alerts:

- A user deleted multiple users for the first time

##### Playbook Stages:

###### Triage:

- Collect initial alert data regarding the event.
- Check the user type of the source user.
- Host enrichment. 

###### Investigation:

- Check if an admin user initiated the operation and whether the deleted users are disabled. 
- Correlate recent user activity with related security alerts.
- Assess user's and host's risk level in Cortex XDR.
- Check the type of the user target. 

Remediation:

- Evaluate investigation findings, if TP, the playbook will display the findings to an analyst for review and suggest user/host account disablement.


##### Requirements:

For response actions, you need the following integrations:

- Cortex Core - Investigation and Response
- Active Directory Query v2.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

<!-- ##### New: silent-Rundll32.exe executes a rare unsigned module

This playbook handles the "Rundll32.exe executes a rare unsigned module" alerts.

The playbook executes the following stages:

Data retrieval:
- Retrieve the alert extra data.
- Calculate the host risk score
- Extract the extension of the loaded DLL.
- Calculate the similarity between the CGO process signer and the loaded DLL's company attribute.

###### Investigation:
- Check the DLL reputation.
- Check the similarity between the CGO process signer and the loaded DLL's company attribute.
- Check for uncommon DLL extensions.
- Check for uncommon causality chain executions.
- Search for related XDR agent alerts to determine if any suspicious behavior occurred as part of the causality chain and the related case ID.

Remediation actions will be taken if:
- The loaded DLL is malicious.
- The DLL is loaded from an uncommon causality chain.
- The DLL extension is uncommon, or the DLL's SHA256 is suspicious, and the host risk score is Medium.
- The host risk score is High (and the similarity check is less than 0.6).


Remediation actions:
- Terminate the causality chain. 
- Quarantine suspicious or malicious DLLs, if any.

The playbook requires enrichment integrations for checking the DLL's SHA256 reputation.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
##### New: Uncommon execution of ODBCConf

This playbook handles "Uncommon execution of ODBCConf" alerts.

##### Playbook Stages:

Analysis:
During the analysis, the playbook will perform the following:

- Checks if the causality process (CGO) is signed and prevalent.
- Checks for the host's risk score.

If the CGO process is not signed and not prevalent, or if either of these conditions is met in addition to having a high-risk score, the playbook proceeds with remediation actions. Otherwise, it will continue to the investigation phase.

###### Investigation:
During the alert investigation, the playbook will perform the following:

Searches for related Cortex XSIAM alerts and insights on the same causalities chains by specific alert names :
- Evasion Technique - 3048798454
- Evasion Technique - 474958459
- An uncommon LOLBIN added to startup-related Registry keys
- Behavioral Threat
- An uncommon file was created in the startup folder
- Unsigned process running from a temporary directory
- Execution From a Restricted Location
- Execution of an uncommon process with a local/domain user SID at an early startup stage by Windows system binary - Explorer CGO

The playbook determines the appropriate verdict. If related alerts are found, it proceeds to remediation actions. In case of related insights are found ,and one of the following is met: the host score is listed as high or the CGO process is not prevalent, it will proceed to remediation actions. Otherwise, it closes the alert with the following message: "No indication of malicious activity was found".


Remediation:

- Automatically terminate the causality process.
- Automatically Close the alert.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

##### New: CVE-2025-31324 - SAP NetWeaver Visual Composer

CVE-2025-31324 is a critical zero-day vulnerability affecting the Metadata Uploader component of SAP NetWeaver Visual Composer. The vulnerability arises from missing authorization checks, allowing unauthenticated attackers to upload malicious executable binaries. Exploitation of this flaw can lead to full remote code execution (RCE) on affected systems, posing a significant risk to confidentiality, integrity, and availability.

## CVE-2025-31324 - SAP NetWeaver RCE Vulnerability

## Vulnerability Overview

- **Component Affected**: SAP NetWeaver Visual Composer Metadata Uploader 
- **Endpoint**: `/developmentserver/metadatauploader` 
- **CVE ID**: CVE-2025-31324 
- **CVSS Score**: 10.0 (Critical) 
- **Exploitability**: Unauthenticated remote attackers can exploit this without user interaction 

This flaw allows unauthenticated attackers to upload arbitrary files (e.g., JSP web shells), enabling remote code execution with the same privileges as the SAP application server process. 
[Source: Unit42 - Palo Alto Networks](https://unit42.paloaltonetworks.com/threat-brief-sap-netweaver-cve-2025-31324/)


## Mitigation and Recommendations

- **Apply Patch**: SAP Note #3594142 (released April 24, 2025) 
- **Disable Visual Composer** if not in use 
- **Restrict Access** to the vulnerable endpoint 
- **Monitor for IoCs** in `/irj/servlet_jsp/irj/root/` and suspicious traffic 

## Conclusion

CVE-2025-31324 is actively exploited and is critically severe. Organizations should patch immediately, monitor for compromise, and disable or restrict vulnerable components.

[View official CVE details on NIST](https://nvd.nist.gov/vuln/detail/CVE-2025-31324)

## Playbook Triggers
- Manually
- "CVE Exploitation - 986328356" Agent rule

## Playbook Flow
1. Using XQL, identify potential SAP NetWeaver instances in your environment.
2. Using XQL, check if there are events that point to any potential webshells downloaded in the directories.
3. Directory enumeration to identify if there are already any suspicious files that might indicate a webshell.
4. *Collect* IOCs from a Unit42 blog, *search* them using the "Threat Hunting - Generic" playbook (supports Palo Alto networks products, Qradar, and Splunk), and *block* those indicators using the "Containment Plan - Block Indicators" playbook.
5. Provides Mitigation recommendations.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

<!-- ##### New: silent-Unprivileged process opened a registry hive Test

This playbook is designed to handle the 'Unprivileged process opened a registry hive' alert.

##### Playbook Stages:

###### Investigation:

During the alert investigation, the playbook will perform the following:

- Checks the prevalence of the unprivileged process that triggered the alert.
- Checks the prevalence of the command line used by the unprivileged process.
- Searches for additional suspicious Cortex XSIAM alerts within the same incident in order to determine whether a remediation measure is required.

Remediation:

- To prevent malicious activity from continuing, the playbook terminates the causality processes that triggered the alert.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
##### New: Execution of an uncommon process at an early startup stage

This playbook is designed to handle the following alerts:
- Execution of an uncommon process at an early startup stage with suspicious characteristics.
- Execution of an uncommon process with a local/domain user SID at an early startup stage with suspicious characteristics.

##### Playbook Stages:

Analysis:

- Checks the process's reputation.

###### Investigation:

- Searches for related Cortex XSIAM alerts to identify potential attack patterns with persistence mechanisms.
- Checks for any suspicious parameters in the command line (if the command line risk score is medium or higher).
- Checks the Action process prevalence.

Verdict:

If the playbook detects that the Action process is globally prevalent and the other conditions in the investigation stage do not match, it closes the alert as a False Positive.

If the playbook detects that any of the following conditions are met:
- The process reputation is malicious.
- Related alerts were found.
- The command line risk score is medium or higher.

The playbook proceeds with remediation actions. Otherwise, it presents the investigation data to the analyst for decision-making on the appropriate action.



Remediation:

- Terminate the malicious process.
- Quarantine the malicious process. (Requires analyst approval.)
- Add the malicious process hash to the block list. (Requires analyst approval.)
- Automatically close the alert.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

##### New: Suspicious execution from tmp folder

This playbook addresses the following alerts for linux os:

- Suspicious process execution from tmp folder
- Suspicious interactive execution of a binary from the tmp folder
- Suspicious cron job task execution of a binary from the tmp folder
- A web server process executed an unpopular application from the tmp folder

##### Playbook Stages:

Analysis:

- Check target process hash reputation
- Check commandline extracted indicators reputation

The playbook will proceed directly to remediation if suspicious/Suspicious reputation is found during the analysis stage.

###### Investigation:

- Search for the following suspicious insights/related alerts:
  - Suspicious access to shadow file
  - UNIX LOLBIN process connected to a rare external host
  - Persistence through service registration
  - Adding execution privileges 
  - Modification of systemd service files
  - Adding execution privileges
  - Local account discovery

If no suspicious reputation is found in the analysis stage, but suspicious insights/related alerts are discovered during investigation, the playbook will then proceed to remediation.

Remediation:

- Terminate causality process
- Quarantine the Suspicious process image file (requires manual approval).
- Disable the suspicious cron job task (requires manual action).<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

<!-- ##### New: silent-Unsigned and unpopular process performed an injection Test

##### This playbook addresses the following alerts:

- Unsigned and unpopular process performed injection into a commonly abused process
- Unsigned and unpopular process performed process hollowing injection
- Unsigned and unpopular process performed queue APC injection
- Unsigned and unpopular process performed injection into a sensitive process
- Unsigned and unpopular process performed injection into svchost.exe


##### Playbook Stages:

###### Triage:

- Checks the processes’ reputation.
- Retrieve all alerts associated with the case for initial analysis.

###### Early Containment:

- Identify whether an agent prevention rule was triggered for the same process ID. If so, there is high confidence that the alert is malicious.
  - **If triggered in prevent mode**: This indicates a high-confidence verdict and the playbook proceeds with endpoint isolation.
  - **If triggered in report mode**: This also indicates a high-confidence verdict. The playbook will notify the customer, advise an update to **prevent mode** for better protection in the future, and proceed with the investigation.
  - **If no rule is triggered**: The playbook will continue with additional checks to ensure thorough assessment.

###### Investigation:

- Checks for a malicious process by reputation and continues to containment if found.
- Check for commonly triggered alerts that often precede process injection:
  - If found, initiate containment.
  - If not found, proceed with additional checks.
- Analyze if any alerts align with MITRE ATT&CK tactics **TA0004 (Privilege Escalation)** and **TA0005 (Defense Evasion)**:
  - If matching tactics are found, initiate containment.
  - If not, proceed with further investigation.
- Determine if the causality (parent) process is signed:
  - If signed by a trusted authority, close the alert.
  - If unsigned, escalate for manual approval for containment.

###### Containment:

- For alerts validated as threats, execute the following actions:
  - Terminate the causality process (CGO) if deemed malicious.
  - Quarantine the malicious process.
  - Adds the malicious process to the block list.
  - Isolate the endpoint in high-risk scenarios to prevent further compromise.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
##### New: Event Log Was Cleared

This playbook is designed to handle the following alerts: 
- Windows Event Log was cleared using wevtutil.exe
- Security Event Log was cleared using wevtutil.exe
- A Sensitive Windows Event Log was cleared using wevtutil.exe
- Windows event logs were cleared with PowerShell
- Suspicious clear or delete security provider event logs with PowerShell
- Suspicious clear or delete default providers event logs with PowerShell
- Windows event logs cleared using wmic.exe

The playbook executes the following stages:

###### Investigation:
Check the following parameters to determine if remediation actions are needed:
- Cortex XSIAM alerts related to the hostname by MITRE tactics indicating malicious activity.
- Whether the CGO or the OSParent process is unsigned.
- The prevalence of the OSParent process.

Remediation:
- Handles malicious alerts by terminating the relevant processes.
- Handles non-malicious alerts identified during the investigation.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

<!-- ##### New: silent-Suspicious Port Scan

This playbook is designed to handle the following alerts:
- Suspicious port scan
- Highly suspicious port scan
- Port scan by suspicious process

##### Playbook Stages:

Analysis:

- Checks whether the reputation of associated processes is malicious.
- Checks whether the endpoint has a high risk score.
- Determines whether the alert process is a known scanner.
- Checks whether the port scan has a highly suspicious connection ratio compared to the baseline.

###### Investigation:

- Checks for a suspicious ratio of unique ports to connections.
- Checks if the port scan intervals are indicative of an automated scan.
- Checks if the reputation of associated processes is suspicious.
- Checks if the endpoint has a medium risk score.
- Searches for related XSIAM alerts related to the destination host that indicate suspicious activity.
- Searches for related XSIAM alerts related to the source host that indicate suspicious or malicious activity.

Verdict:

Determine the verdict as malicious if:
- At least four specific related alerts indicating malicious activity are found.
- At least two suspicious indicators are detected.

Remediation:

- Terminates the processes.
- Quarantines the malicious process.
- Adds the malicious process hash to the blocklist.
- Adds an IOC rule for malicious processes.
- Isolate the source host. (Requires analyst approval).
- Block the source IP Address (Requires analyst approval).
- Automatically close the alert.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-Msiexec execution of an executable from an uncommon remote location Test

##### This playbook addresses the following alerts:
 
- Msiexec execution of an executable from an uncommon remote location with a specific port
- Msiexec execution of an executable from an uncommon remote location without properties
 
##### Playbook Stages:
  
Analysis: 
 
- Check extracted URL reputation:
  - Determine if the MSI package was installed from a malicious source
  - If the URL is found to be malicious, the playbook will proceed directly to remediation steps
 
###### Investigation:

- Check extracted domain's prevalence and causality process signature status:
  - Evaluate the prevalence of the domain from which the MSI package was downloaded
  - Verify if the causality process (CGO) is signed or unsigned
  - If the domain is found malicious and the causality process is unsigned, the playbook will proceed directly to remediation steps

- Check for the following related alerts: 
  - Local Analysis Malware
  - Mitre Techniques:
    - T1140 - Deobfuscate/Decode Files or Information
    - T1059 - Command and Scripting Interpreter 

- Analyze CGO command line for defense evasion techniques:
  - Evaluate the command line for suspicious patterns which indicates attempts to bypass security controls

- If the command line contains suspicious patterns or related alerts are found, the playbook will proceed directly to remediation steps

###### Containment:
 
- Terminate causality process
- Block maliciou URL (Manual approval)
  - Implement URL blocking using PAN-OS through Custom URL Categories
- Isolate endpoint (Manual approval)
 
Requirements: 
 
For any response action, you need the following integration:
 
- PAN-OS.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-User added to local administrator group using a PowerShell command Test

This playbook is designed to handle the alert
'User added to local administrator group using a PowerShell command'

The playbook executes the following stages:

###### Investigation:
Check the following parameters to determine if remediation actions are needed:
- Cortex XSIAM alerts related to the hostname by MITRE tactics indicating malicious activity.
- Whether the process is unsigned.

Remediation:
Handles malicious alerts by terminating the relevant processes and requesting the analyst's approval to remove the user from the local Administrators group.
Handles non-malicious alerts identified during the investigation.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-SSO Password Spray Test

This playbook is designed to handle the following alerts:

- SSO Password Spray Threat Detected
- SSO Password Spray Activity Observed
- SSO Password Spray Involving a Honey User

##### Playbook Stages:

###### Triage:

- The playbook checks the IP reputation and fetches the events related to the SSO login attempts.

###### Early Containment:

- The playbook checks if the IP is suspicious. If it is, the playbook suggests blocking the IP.

###### Investigation:

- The playbook assess the risk score of the user who successfully logged in and examines the legitimacy of the user agent. It verifies if the user has MFA configured and analyzes the timestamps of the login attempts to detect potential malicious automated patterns.

###### Containment:
- If there is a successful login attempt and the user's risk score is high, or if the user agent is detected as suspicious, or if the time intervals were automated, the playbook clears the user's session. If the user doesn't have MFA, the playbook recommends expiring the user's password.

##### Requirements:

For any response action, you need one of the following integrations:

- Microsoft Graph User
- Okta.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
##### New: Uncommon remote scheduled task created

This playbook handles "Uncommon remote scheduled task created" alerts.

##### Playbook Stages:

Analysis:

- The playbook checks if the remote IP is external or has a bad reputation.
- The playbook checks the host risk score.

###### Investigation:
During the alert investigation, the playbook will perform the following:

- Searches for related XSIAM alerts on the endpoint that use the following MITRE techniques to identify malicious activity: T1202 - Indirect Command Execution, T1021 - Remote Services.
- Searches for related XSIAM agent alerts on the remote endpoint, to determine if the creation of the scheduled task is part of an attack pattern.
- Searches for suspicious command-line parameters indicating a malicious scheduled task.

Remediation:

- Automatically disable the malicious scheduled task.
- Block the malicious IP (requires analyst approval).
- Automatically Close the alert.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

<!-- ##### New: silent-SSO Brute Force Test

##### This playbook addresses the following alerts:

- SSO Brute Force Threat Detected
- SSO Brute Force Activity Observed

##### Playbook Stages:

###### Triage:

- The playbook checks the IP reputation and fetches the events related to the brute force login attempts.

###### Early Containment:

- The playbook checks if the IP is suspicious. If it is, the playbook suggests blocking the IP using PAN-OS. The investigation continues in parallel to this phase.

###### Investigation:

- The playbook assesses the risk score of the user who successfully logged in after a brute force attempt, examines the legitimacy of the user agent and if the brute force attempt is likely automated based on the timestamp interval. It also verifies if the user has MFA configured when the alert source is Okta.

###### Containment:
- If there is a successful login attempt and the user's risk score is high, or if the user agent is detected as suspicious, or if the time intervals indicates that the login attempts is likely automated, the playbook clears the user's session. If the user doesn't have MFA configured, the playbook recommends expiring the user's password. If there is no successful login detected, no action is taken.


##### Requirements:

For any response action, you need one of the following integrations:

- Microsoft Graph User
- Okta v2

For eradication step, you need the following integration:

- Palo Alto Networks PAN-OS.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-Execution of significantly renamed lolbin

This playbook is designed to handle the "Execution of significantly renamed lolbin" alerts.

##### Playbook Stages:

Analysis:

- Analyze the issue command lines.
- Retrieves the user risk score.
- Retrieves the host risk score.
- Retrieves the endpoint data.
- Extracts related script paths from the action command line.
- Enriches the process SHA-256.


###### Investigation:

- Retrieves and investigates scripts from the action command line.
- Checks if the action occurred on host with a high risk level.
- Searches for the user who renamed the lolbin.
- Checks if the action performed by a high risk user.
- Checks if the action performed by a high risk user.
- Checks if the action was performed by a suspicious remote actor.
- Searches for related alerts indicating suspicious or malicious activity.
- Checks the process reputation.
- Checks for suspicious execution paths.
- Checks for unsigned processes in the causality.
- Retrieves and analyzes the command line in the same causality chain for malicious activity.
- Investigates to identify known masquerading techniques.

Verdict:

The verdict is determined as malicious based on the evidence found during the investigation phase.

Remediation:

- Terminates the processes.
- Quarantines the masqueraded file or, if impossible, blocks its execution.
- Quarantines the related scripts.
- Disables the involved users (requires analyst approval).
- Logs off the involved users.
- Blocks the the connection from the remote actor.
- Block the external IP of the remote actor.
- Automatically close the alert.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-Execution of an uncommon process at an early startup stage

This playbook is designed to handle the following alerts:
- Execution of an uncommon process at an early startup stage with suspicious characteristics.
- Execution of an uncommon process with a local/domain user SID at an early startup stage with suspicious characteristics.

##### Playbook Stages:

Analysis:

- Checks the process's reputation.

###### Investigation:

- Searches for related Cortex XSIAM alerts to identify potential attack patterns with persistence mechanisms.
- Checks for any suspicious parameters in the command line (if the command line risk score is medium or higher).
- Checks the Action process prevalence.

Verdict:

If the playbook detects that the Action process is globally prevalent and the other conditions in the investigation stage do not match, it closes the alert as a False Positive.

If the playbook detects that any of the following conditions are met:
- The process reputation is malicious.
- Related alerts were found.
- The command line risk score is medium or higher.

The playbook proceeds with remediation actions. Otherwise, it presents the investigation data to the analyst for decision-making on the appropriate action.



Remediation:

- Terminate the malicious process.
- Quarantine the malicious process. (Requires analyst approval.)
- Add the malicious process hash to the block list. (Requires analyst approval.)
- Automatically close the alert.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
##### New: CVE-2025-55182 and CVE-2025-66478 - React and Next js Remote Code Execution

## CVE-2025-55182 and CVE-2025-66478 - React and Next.js Remote Code Execution

## Vulnerability Overview

- **Vulnerability Name**: Insecure Deserialization in React Server Components (RSC) "Flight" Protocol (Also referred to as React2Shell)
- **CVE ID**: CVE-2025-55182 (Primary React RCE) and CVE-2025-66478 (Next.js RCE, affecting downstream implementations).
- **CVSS Score**: 10 (Critical) 


An unauthenticated Remote Code Execution (RCE) vulnerability exists in the core packages used by React Server Components (RSC), which are primarily exposed via the Next.js App Router. The flaw is an insecure deserialization issue in the RSC "Flight" protocol that allows an attacker to execute arbitrary code on the server by sending a single, crafted HTTP request. The vulnerability is present in default configurations of affected applications.
[Source: Unit42 - Palo Alto Networks](https://unit42.paloaltonetworks.com/cve-2025-55182-react-and-cve-2025-66478-next/)


## Mitigation and Recommendations

- **Apply Patch**
- **Restrict Access** to the vulnerable serves 
- **Monitor for IoCs and suspicious traffic** 

## Conclusion

CVE‑2025‑55182 is a critical, highly reliable, and unauthenticated RCE vulnerability in the modern React ecosystem. Due to its remote exploitability without user interaction or authentication, immediate patching is required to prevent server compromise.

[View official CVE details on NIST](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)

## Vulnerable Versions

**React**: Versions 19.0, 19.1, and 19.2
**Next.js**: Versions 15.x and 16.x (App Router), as well as Canary builds starting from 14.3.0
**Other frameworks**: Any library bundling the react-server implementation, including React Router, Waku, RedwoodSDK, Parcel and Vite RSC plugins


## Playbook Triggers
- Manually - Create a new incident and select this playbook from the dropdown menu.

## Playbook Flow
1. Collects IOCs from the Unit42 blog.
2. Uses XQL to detect any suspicious command lines indicative of exploitation of this vulnerability.
3. Investigates the command lines to identify malicious indicators related to the vulnerability.
4. Uses XQL to hunt for malicious IOCs.
5. Isolates possible compromised servers.
6. Blocks malicious indicators using the "Containment Plan – Block Indicators" playbook.
7. Provides mitigation recommendations.

Note: This is a beta playbook, which lets you implement and test pre-release software. Since the playbook is beta, it might contain bugs. Updates to the pack during the beta phase might include non-backward compatible features. We appreciate your feedback on the quality and usability of the pack to help us identify issues, fix them, and continually improve.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

<!-- ##### New: silent-Scheduled task created with HTTP or FTP reference Test

This playbook is designed to handle the alert "Scheduled task created with HTTP or FTP reference".

The playbook executes the following stages:

Analysis:
- Extracts the Indicators from action command line
- Checks the IP and the URL reputation.

###### Investigation:
During the alert investigation, the playbook will perform the following:
- Checks if the IP and the URL reputation is malicious.
- Checks the CGO process is unsigned.
- Searches for related alerts to determine if the creation of the scheduled task is part of an attack pattern.

Remediation:
- Remediation actions will be taken if the CGO process is unsigned, the IP or URL has a malicious reputation, or a related alert is detected. In these cases, the playbook will disable the scheduled task, block the malicious indicators, and close the alert.

Requires: To block the malicious URL, configure 'Palo Alto Networks PAN-OS' integration.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
##### New: A mail forwarding rule was configured in Google Workspace

##### This playbook addresses the following alerts:

- A mail forwarding rule was configured in Google Workspace.
- A mail forwarding rule was configured in Google Workspace to an uncommon domain.

##### Playbook Stages:
 
Triage: 

- The playbook retrieves the caller's IP, the forwarding email address, and associated filters.

###### Early Containment:

- The playbook checks if the IP or domain of the forwarding email address is malicious. If so, it suggests blocking the IP using PAN-OS while continuing the investigation in parallel.

###### Investigation:

- The playbook verifies if the rule was created outside of working hours or from an unusual geolocation and extracts suspicious keywords from the forwarding rules. It then aggregates all evidence collected during the investigation.

###### Containment:

- If only one suspicious evidence is found, the playbook executes soft response actions, including signing the user out and deleting the forwarding email address from the user account mailbox. The user will be notified of these actions via email.
- If multiple suspicious evidences are found, the playbook executes both soft and hard response actions, recommending the analyst suspend the user account.

Requirements: 

For any response action, you need one of the following integrations:
- Gmail integration to fetch filters and remove the forwarding email address.
- Google Workspace Admin access to sign out and suspend the user account.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

##### New: Suspicious SaaS Access From a TOR Exit Node

This playbook is designed to handle the following alerts:

- Suspicious SaaS API call from a Tor exit node
- Suspicious SaaS API call from a Tor exit node via a mobile device
- Suspicious API call from a Tor exit node
- Suspicious Kubernetes API call from a Tor exit node

##### Playbook Stages:

###### Early Containment:
- To terminate the connection from the Tor exit node, the playbook will clear/revoke the user's sessions and force re-authentication. Depending on the alert source, the playbook will use either MS-Graph or G-Suite to clear the user sessions.

###### Investigation:
- The playbook will assess the risk score of the user connected from the Tor exit node and examine the legitimacy of the user agent.

###### Containment:
- If the user's risk score is high or the user agent is detected as suspicious, the playbook will recommend blocking the account connected from the Tor exit node. The playbook will use MS-Graph, G-Suite, or AWS-IAM, depending on the alert source.

Eradication:
- For users with PAN-OS enabled, the playbook will recommend blocking all IPs from the Palo Alto Intelligence-based external dynamic list that contains Tor exit nodes. The goal is to prevent the use of Tor within the organization.

##### Requirements:

For any response action, you will need one of the following integrations: 
- Microsoft Graph User
- G-Suite Admin
- AWS-IAM.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

##### New: Compromise Accounts - User rejected numerous SSO MFA attempts

##### This playbook addresses the following alerts:

- User rejected numerous SSO MFA attempts
- Multiple SSO MFA attempts were rejected by a user with suspicious characteristics

##### Playbook Stages:

###### Triage:
- The playbook checks the IP address reputation associated with the MFA attempts and gathers related login events.

###### Early Containment:
- If the IP address is identified as malicious, the playbook blocks the IP. The investigation continues in parallel to this phase.

###### Investigation:
- The playbook performs an in-depth analysis, including:
  - Assessing the user's risk score to identify potentially compromised accounts.
  - Checking for an unusually high number of invalid credential attempts, which may indicate brute-force or credential-stuffing activity.
  - Verifying whether Okta logs indicate a malicious source IP based on Okta's threat intelligence.
  - Reviewing whether there have been an excessive number of MFA rejections from the user, suggesting potentially compromised behavior.
  - Looking for abnormal user agent patterns that may indicate suspicious or compromised access methods.
  - Investigating previous failed Okta login attempts within a specified timeframe to identify patterns.

###### Containment:
- If suspicious activity is confirmed, the playbook initiates the following containment actions:
  - Clears the user's active sessions and expires their password to prevent further unauthorized access.
  - If a successful login attempt was also detected, the playbook prompts a manual task for an analyst to review and decide on further action.

##### Requirements:
For any response actions, the following integration is required:
- Okta v2

For early containment actions, the following integration is required:
- Palo Alto Networks PAN-OS.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

<!-- ##### New: silent-Azure AD PIM role settings change

##### This playbook addresses the following alerts:

- Azure AD PIM role settings change

##### Playbook Stages:

###### Triage:

- Collect initial alert data regarding the Azure AD role settings modification.

###### Investigation:

- Analyze the impact of the role settings changes, categorizing them as high or moderate risk.
- Determine if the changes affect privileged roles in Azure AD.
- Correlate recent user activity with related security alerts.
- Assess the user's risk status in Azure AD and Cortex XDR.
- Evaluate the reputation of the IP address used for the changes.

###### Containment:

- Automatically revoke the user's active sessions across all applications.
- Present findings to an analyst for review and potential user account disablement.

##### Requirements:

For response actions, you need the following integrations:

- Cortex Core - Investigation and Response
- Microsoft Graph User.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-Azure Temporary Access Pass (TAP) registered to an account

##### This playbook addresses the following alerts:

- Abnormal Azure Temporary Access Pass (TAP) account registration

##### Playbook Stages:

###### Triage:

- Retrieve additional data about the TAP registration including start/end times, usage type, and user details

###### Investigation:

- Analyze the reputation of the caller IP address
- Examine alerts from Microsoft Defender 365 related to the TAP assigner
- Check Azure AD risky user status and risk detections
- Review Cortex Core risk level for the user
- Verify creation date of the user account in Azure AD to identify recently created accounts
- Correlate evidence across multiple sources to determine potential compromise

###### Containment:

- For alerts determined to be true positives, automatically revoke the user's session in Microsoft applications
- Upon analyst approval, disable the user account that granted the TAP

Requirements: For response actions, you need the following integrations:

- Microsoft Graph User.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-Suspicious Local Administrator Login Test

##### This playbook addresses the following alerts:
 
- Suspicious local administrator login
 
##### Playbook Stages:
 
###### Investigation:
 
- Retrieves the name of the process image involved in the alert.
- Checks for related Powershell/Command and Scripting/WMI alerts in the incident.
- Retrieves the host risk score.
 
###### Containment:
 
- Provide a manual task for an analyst to review the findings and decide the next steps.
- Possible actions:
 - Disable User.
 - Take no action.
 
Requirements: 

- For response actions, the following integration is required: Core - IR.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-Recurring rare domain access from an unsigned process

##### This playbook addresses the following alerts:

- Recurring rare domain access from an uncommon unsigned process
- Recurring access to a rare domain associated with known threats

##### Playbook Stages:
  
Analysis:

- Check actor process hash reputation
- Check suspicious domain reputation
- Check actor process hash category using WildFire

  If suspicious/malicious reputation found:
    - Execute Remediation

###### Investigation:

- Check Actor for Risky Path
- Get Actor CommandLine Analysis
- Get CGO Process Prevalence
- Get Related Alerts

  If found related alerts and one other risk:
    - Execute Remediation

###### Containment:

- Kill CGO Process
- Add Domain IOC rule.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-Suspicious Local User Account Creation

##### This playbook addresses the following alerts:
- Suspicious Local User Account Creation

##### Playbook Stages:

###### Triage:
- Retrieve extra information about the alert, such as the SID of the created user.

###### Investigation:
- Get host risk level for the machine where the user was created.
- Search for related alerts in the incident that hint of privilege escalation or persistence.
- Retrieve local user password expiration status using PowerShell commands.
- Get creator user risk level from the system.
- Search for privileged group memberships of the created user (Administrators, Domain Admins, etc.).
- Analyze command line executions for both created user and creator user to detect suspicious activities.
- Check creator's historical user creation patterns.

###### Containment:
- Analyze evidence using multiple indicators to determine if the alert is a true positive, false positive, or inconclusive.
- For true positives: Automatically disable the suspicious local user account.
- Present analyst review with comprehensive findings including related alerts, privileged groups, host/user risk levels, and suspicious command lines.
- Upon analyst approval: Disable the creator user account either locally or in Active Directory based on user type detection.

##### Requirements:

For response actions, you need the following integrations:
- Cortex Core - Investigation and Response
- Active Directory Query v2.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-Suspicious Powershell Command Execution

This playbook handles the following alerts:

- PowerShell runs suspicious base64-encoded commands
- PowerShell suspicious flags
- Reverse shell using PowerShell
- PowerShell downloads files via BITS

Playbook Stages

Analysis:

1. Analyze command-line for suspicious patterns.
2. Evaluate PowerShell command risk scores.
3. Check for indicators of compromise (IOCs).
  - If suspicious or malicious patterns are detected, execute remediation.

###### Investigation:

1. Check the process reputation.
2. Analyze the process causality chain.
3. Check for related alerts.
4. Search for suspicious execution patterns.
  - If there is evidence of malicious activity, execute remediation.

###### Containment:

1. Terminate the causality process tree.
2. Block malicious indicators.
3. Add malicious files to the blocklist.
4. Close the alert as a true positive.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-Remote WMI Process Execution Test

##### This playbook addresses the following alerts:

* Remote WMI process execution
* Suspicious remote WMI process execution

**Playbook Stages:**

**Analysis:**

* Enrich the attacker’s IP address to identify any known malicious activity.

* Retrieve all incident-related alerts to consolidate context for further analysis.

**Investigation:**

* Analyze command-line activity to assess risks based on suspicious patterns.

* Check for high-confidence evidence, such as malicious IP addresses or suspicious command-line activity, to determine the next course of action.

* Evaluate medium-confidence detections and request analyst approval for further containment if required.

**Containment:**

* Attempt to terminate the malicious process tree using its causality ID.

* Provide guidance for manual process termination if the automated action fails.

* Propose endpoint isolation to prevent further compromise if malicious activity is confirmed.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
##### New: Remote WMI Process Execution

##### This playbook addresses the following alerts:

* Remote WMI process execution
* Suspicious remote WMI process execution

**Playbook Stages:**

**Analysis:**

* Enrich the attacker’s IP address to identify any known malicious activity.

* Retrieve all incident-related alerts to consolidate context for further analysis.

**Investigation:**

* Analyze command-line activity to assess risks based on suspicious patterns.

* Check for high-confidence evidence, such as malicious IP addresses or suspicious command-line activity, to determine the next course of action.

* Evaluate medium-confidence detections and request analyst approval for further containment if required.

**Containment:**

* Attempt to terminate the malicious process tree using its causality ID.

* Provide guidance for manual process termination if the automated action fails.

* Propose endpoint isolation to prevent further compromise if malicious activity is confirmed.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

<!-- ##### New: silent-A successful SSO sign-in from TOR Test

This playbook is designed to handle the following alerts:
- A successful SSO sign-in from TOR
- A successful SSO sign-in from TOR via a mobile device

The playbook executes the following stages:

###### Early Containment:
- The playbooks will perform early containment actions by clearing\revoking user sessions and enforcing re-authentication to terminate the connection from the Tor exit node and verify the user's identity. 
Depending on the alert source, the playbook will use either
Azure Active Directory Users or Okta v2 integrations to clear the user sessions.

###### Investigation:
During the alert investigation, the playbook will perform the following:
- Checks the user's risk score.
- Search for suspicious user agent usage within the alert.
- Search for related XDR alerts using the following MITRE techniques to identify any malicious activity:
T1566 - Phishing 
T1621 - Multi-Factor Authentication Request Generation
 T1110 - Brute Force
 T1556 - Modify Authentication Process

Remediation:
- Remediation actions will be taken if the user’s risk score is high, a suspicious user agent is detected, or a related alert is found. In such cases, the playbook will disable the account.
By default, account disabling requires analyst approval.

Requires: 
For any response action, you will need one of the following integrations: Azure Active Directory Users / Okta v2.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-Suspicious Conditional Access operation for an identity

**This playbook addresses the following alert**:
- Suspicious Conditional Access operation for an identity

**Playbook Stages**:

**Triage**:
- Gather initial information about the initiating user.
**User Investigation**:
- **IP Enrichment**:
  - Analyze the reputation of the initiating user IP addresses.
- **Azure Detection Analysis**:
  - Investigate recent Azure security alerts for the initiating user to detect additional suspicious activity.
  - If any detections found, investigate the related user agent. 
- **User Risk Analysis**:
  - Assess the risk level of the initiating user based on XSIAM Core and Azure risk score.
  - Investigate reasons behind any identified risks, including recent detections.
- **Attacker Geolocation Analysis**:
  - Investigate the initiating user connection geolocation.
- **Insights Analysis**:
  - Investigate the XSIAM insights that related to the initiating user to detect additional suspicious activity.

**User Investigation**:
- **Search for suspicious MFA activity**:
  - Search for a policy change that indicates on disabling the need in MFA
- **Search for suspicious guest user activity**:
  - Search for a policy change that indicates on allowing 
**Verdict & Containment**:
- If any suspicious evidence found during the user investigation phase and the integration "Microsoft Graph User" integration is enabled, the playbook will revoke the sessions of the initiating user and the destination user. If the integration is not enabled, the playbook will recommend to perform the same action but manually.
- If the initiating user IP is malicious, or the initiating user risk is HIGH, or more than one suspicious evidence found during the Azure detection analysis and the CA policy investigation phase, and the integration "Microsoft Graph User" is enabled, the playbook will revoke the sessions of the initiating user and the destination user and will recommend manually to disable either one of the users or both of the users. If the integration is not enabled, the playbook will recommend to perform the same action but manually.

**Requirements**:
- `Azure Risky Users` for retrieving user risk scores.
- `Microsoft 365 Defender` for advanced hunting queries and Azure security alerts.
- `Microsoft Graph User` for disabling accounts and revoking sessions.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-Suspicious user access to multiple resources via SSO

**This playbook addresses the following alert**:
- Suspicious user access to multiple resources via SSO.

**Playbook Stages**:

**Triage**:
- Collect additional alert data.

**Investigation**:
- **IP Reputation Check**:
  - Look up the reputation of the IP address associated with the sign-in attempt.
- **Uncommon Target Application Ratio**:
  - Calculate the percentage of accessed applications that are considered uncommon for the user.
- **Check for Azure Alerts**:
  - Retrieve Azure security alerts linked to the user over the last 24 hours.
- **Check If User Is Risky**:
  - Retrieve risk indicators from Azure and Cortex.
  - Determine if the user has medium/high risk detections and capture relevant risk reasons.
- **Activity Duration Analysis**:
  - Calculate the time window between the first and last activity in the alert.
- **Search for Related Alerts**:
  - Look for other alerts related to the same user with suspicious access patterns (e.g., abnormal SSO activity).

- **Check for Suspicious Evidence**, including:
  - IP address flagged as malicious.
  - Confirmed Azure or Core risky detections.
  - Relevant Azure security alerts.
  - High ratio of uncommon applications accessed.
  - Short sign-in activity window.
  - Behavioral deviation in number of accessed apps compared to normal usage.
  - Additional related alerts in the environment.

**Containment**:
- **Analyst Review**:
  - Present findings and evidence to the analyst for review.
  - If needed, the analyst can choose to disable the user.
- **Automatic Actions**:
  - If the analyst disables the user, clear their active sessions as a containment measure.

**Requirements**:
Ensure the following integrations are configured:
- **Microsoft 365 Defender** for Azure user alerts.
- **Microsoft Graph User** for user disablement and session control.
- **Core - Investigation and Response** for alert context and user risk scores.
- **Threat Intelligence Integrations** for IP reputation analysis.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
##### New: Azure AD account unlock or password reset

**This playbook addresses the following alert**:
- Azure AD account unlock/successful password reset

**Playbook Stages**:

**Triage**:
- Gather initial information about the user.

**Investigation**:
- **Check IP Reputation**:
  - Analyze the reputation of the IP address related to the alert.
- **Check for Azure Alerts**:
  - Extract recent Azure security alerts for the user.
- **Check if User is Risky**:
  - Assess the risk score of the user based on Core and Azure risk indicators.
  - Investigate reasons behind any identified risks, including recent detections.

**Containment**:
- Check if feature sum is greater than 2 (Possible features:new user agent/new asn/new country). If yes, continue to revoke user's active sessions to ensure immediate containment.
If no, continue to check investigation findings.
- Provide a manual task for an analyst to review the findings and decide the next steps.
- Possible actions:
  - Disable the target user.
  - Disable the resource user.
  - Disable both users.
  - Take no action.

**Requirements**:
For the best results, it's recommended to ensure these integrations are configured and working:
- `Cortex Core - Investigation and Response` for Core user risk evaluation.
- `Azure Risky Users` for retrieving user risk scores.
- `Microsoft 365 Defender` for advanced hunting queries and Azure security alerts.
- `Microsoft Graph User` for disabling accounts and revoking sessions.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

<!-- ##### New: silent-Netcat Makes or Gets Connections Test

This playbook is designed to handle the following alerts:
 
- Netcat makes or gets connections

The playbook executes the following stages:

Analysis:

- Investigate the IP and Domain reputation
- Search previous similar alerts

Remediation:
 
- Handles malicious alerts by terminating the causality process.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
##### New: Unsigned and unpopular process performed an injection

##### This playbook addresses the following alerts:

- Unsigned and unpopular process performed injection into a commonly abused process
- Unsigned and unpopular process performed process hollowing injection
- Unsigned and unpopular process performed queue APC injection
- Unsigned and unpopular process performed injection into a sensitive process
- Unsigned and unpopular process performed injection into svchost.exe


##### Playbook Stages:

###### Triage:

- Checks the processes’ reputation.
- Retrieve all alerts associated with the case for initial analysis.

###### Early Containment:

- Identify whether an agent prevention rule was triggered for the same process ID. If so, there is high confidence that the alert is malicious.
  - **If triggered in prevent mode**: This indicates a high-confidence verdict and the playbook proceeds with endpoint isolation.
  - **If triggered in report mode**: This also indicates a high-confidence verdict. The playbook will notify the customer, advise an update to **prevent mode** for better protection in the future, and proceed with the investigation.
  - **If no rule is triggered**: The playbook will continue with additional checks to ensure thorough assessment.

###### Investigation:

- Checks for a malicious process by reputation and continues to containment if found.
- Check for commonly triggered alerts that often precede process injection:
  - If found, initiate containment.
  - If not found, proceed with additional checks.
- Analyze if any alerts align with MITRE ATT&CK tactics **TA0004 (Privilege Escalation)** and **TA0005 (Defense Evasion)**:
  - If matching tactics are found, initiate containment.
  - If not, proceed with further investigation.
- Determine if the causality (parent) process is signed:
  - If signed by a trusted authority, close the alert.
  - If unsigned, escalate for manual approval for containment.

###### Containment:

- For alerts validated as threats, execute the following actions:
  - Terminate the causality process (CGO) if deemed malicious.
  - Quarantine the malicious process.
  - Adds the malicious process to the block list.
  - Isolate the endpoint in high-risk scenarios to prevent further compromise.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

##### New: Excessive User Account Lockouts

##### This playbook addresses the following alerts:

- Excessive user account lockouts
- Excessive account lockouts on suspicious users
- Excessive user account lockouts from a suspicious source

The playbook investigates and responds to excessive user account lockout alerts. It gathers information about the alert, enriches relevant host data, and analyzes event patterns. This analysis helps distinguish between benign lockouts and lockouts caused by brute-force or password spray attacks.

##### Playbook Stages:

###### Triage:

- The playbook enriches the alert with details about the lockout events.

###### Investigation:

- Analyzes the lockout event timestamps to detect patterns.
- Checks for related medium severity brute-force alerts in the incident.
- Retrieves the Risk Score for the Caller Computer that caused the lockouts.

###### Containment:

- With analyst approval, the playbook can isolate the endpoint (either the Caller Computer or the target host) if it's determined to be a true positive and not a server.

##### Requirements:

- For response actions, the following integration is required: Core - IR.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

<!-- ##### New: silent-CVE-2025-59287 - Microsoft WSUS Remote Code Execution

CVE-2025-59287 - Microsoft WSUS Remote Code Execution


## Vulnerability Overview

- **Vulnerability Name**: Microsoft Windows Server Update Service (WSUS) Deserialization of Untrusted Data Vulnerability
- **CVE ID**: CVE-2025-59287 
- **CVSS Score**: 9.8 (Critical) 


An unauthenticated remote code execution (RCE) vulnerability has been identified in Microsoft Windows Server Update Services (WSUS).
[Source: Unit42 - Palo Alto Networks](https://unit42.paloaltonetworks.com/microsoft-cve-2025-59287/)


## Mitigation and Recommendations

- **Apply Patch**
- **Restrict Access** to the vulnerable serves 
- **Monitor for IoCs and suspicious traffic** 

## Conclusion

CVE‑2025‑59287 is a critical, remotely exploitable vulnerability in WSUS that allows unauthenticated attackers to execute arbitrary code with SYSTEM privileges.

[View official CVE details on NIST](https://nvd.nist.gov/vuln/detail/CVE-2025-59287)

## Playbook Triggers
- Manually
- "CVE Exploitation - 2037164431" or "CVE Exploitation - 3823999562" Agents rules

## Playbook Flow
1. Uses XQL to identify WSUS servers in your environment.
2. Collects IOCs from the Unit42 blog.
3. Uses XQL to detect any suspicious command lines indicative of exploitation of this vulnerability.
4. Investigates the command lines to identify malicious indicators related to the vulnerability.
5. Uses XQL to hunt for malicious IOCs.
6. Isolates compromised WSUS servers.
7. Blocks malicious indicators using the "Containment Plan – Block Indicators" playbook.
8. Provides mitigation recommendations.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
##### New: Credential Dumping using a known tool

This playbook is designed to handle the following alerts:
- Command-line arguments match Mimikatz execution
- Mimikatz command-line arguments
- Credential dumping via wce.exe
- Credential dumping via gsecdump.exe
- PowerShell runs with known Mimikatz arguments
- Hash cracking using Hashcat tool
- Credential dumping via fgdump.exe
- Credential dumping via LaZagne
- Credential dumping via pwdumpx.exe
- Dumping lsass.exe memory for credential extraction
- Memory dumping with comsvcs.dll

The playbook executes the following stages:

###### Early Containment:
- Handles malicious alerts by terminating the causality process.

Remediation:
- Handles malicious alerts by suggesting the analyst to isolate the endpoint.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

##### New: User added to local administrator group using a PowerShell command

This playbook is designed to handle the alert
'User added to local administrator group using a PowerShell command'

The playbook executes the following stages:

###### Investigation:
Check the following parameters to determine if remediation actions are needed:
- Cortex XSIAM alerts related to the hostname by MITRE tactics indicating malicious activity.
- Whether the process is unsigned.

Remediation:
Handles malicious alerts by terminating the relevant processes and requesting the analyst's approval to remove the user from the local Administrators group.
Handles non-malicious alerts identified during the investigation.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

##### New: SSO Authentication With Suspicious Characteristics

**This playbook addresses the following alerts**:
- SSO authentication attempt with suspicious characteristics.
- Successful SSO authentication with suspicious characteristics.

**Playbook Stages**:

**Triage**:
- Collect initial information about the user and the SSO authentication event.
- Validate whether the authentication proxy is linked to iCloud Relay.

**Investigation**:
- **Check IOCs Reputation**:
  - Analyze the reputation of IP addresses associated with the alert.
- **Search Related Alerts**:
  - Look for alerts related to the same user within the system to identify suspicious activity trends.
- **Check If User Is Risky**:
  - Retrieve the user's risk score and evaluate high-risk indicators for suspicious activities.
- **Check User Agent**:
  - Identify suspicious user agents used during the authentication attempts.
- **Check Okta Logs**:
  - Retrieve Okta authentication logs for failed login attempts and suspicious authentication activities within the last day.

**Containment**:
- **Automatic Actions**:
  - Clear user sessions if any suspicious evidence is found during the investigation.
- **Analyst Review**:
  - Provide an analyst with findings for review and determine the appropriate action:
    - No action required.
    - Suspend the user in Okta.
  - If the analyst chooses to suspend the user, their active sessions are cleared in Okta.

**Requirements**:
For the best results, it's recommended to ensure these integrations are configured and working:
- **Core** integration for user risk evaluation and suspicious activity checks.
- **Okta v2** integration for analyzing authentication logs, clearing sessions, and user suspension.
- Any IP reputation integration that supports the `!ip` command for checking IP address reputation.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

<!-- ##### New: silent-Process attempts to kill a known security or AV tool

This playbook is designed to handle the 'Process attempts to kill a known security/AV tool' alert.

The playbook executes the following stages:

###### Early Containment:
- The playbook will perform early containment actions by terminating the causality chain processes. 

###### Investigation:
During the alert investigation, the playbook will perform the following:
- Checks the endpoint's risk level.
- Searches for related alerts to identify any malicious activity.

Remediation:
- Remediation actions will be taken if the user’s risk score is high or a related alert is found.
In such cases, the playbook will wait for an analyst’s decision before isolating the endpoint
By default, endpoint isolation requires analyst approval.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
##### New: Suspicious certutil command line

This playbook handles "Suspicious certutil command line" alerts.

##### Playbook Stages:

Analysis:

During the alert analysis, the playbook will perform the following actions:

- Extracts and enriches the URL from the command line.
- Checks if the URL reputation is suspicious.
- Checks if any process in the causality chain is unsigned.
- Checks if any process in the causality chain is non-prevalent.
- Searches for Cortex XDR agent alerts related to file drops using certutil.
- Checks for any suspicious parameters in the command line (if the command line risk score is medium or higher).

If the playbook detects any of these conditions, it will proceed to the early containment stage; otherwise, it will close the alert.

###### Early Containment:

- Identify if an agent prevention rule was triggered. If triggered in **block mode**, proceed with the URL reputation check; otherwise, terminate the causality process tree.

Verdict:

- Based on the URL's reputation, if found to be malicious, the playbook will perform remediation actions; otherwise, it will close the alert.

Remediation:

If the URL is found to have a malicious reputation, the playbook will perform the following actions:

- Block the malicious URL using PAN-OS (requires analyst approval).
- Isolate the endpoint (requires analyst approval).
- Execute an XQL query to check for file creation events by the certutil process, and if a file is found, quarantine it (requires analyst approval).
- Automatically close the alert.

Required Integrations:

For response actions, you need the following integrations:

- Palo Alto Networks PAN-OS
- XQL Query Engine.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

<!-- ##### New: silent-Impossible Traveler SSO

This playbook addresses the following alert:
- Impossible traveler - SSO

# Playbook Stages:

## Triage:
- Gather **extended alert data** (e.g., source IPs, timestamps, associated events).
- Classify the gathered events into two distinct groups: **Normal Activity and Suspicious Activity**.

## Investigation:
- Check for switch to **mobile/VPN**.
- Analyze network context, such as a switch to **a mobile network or a VPN**.
- Validate the reputation of involved **IP addresses**.
- Assess the user's **risk level** in Cortex.
- Search for medium or high **Azure Risk Detections and Defender Alerts**.
- Search for suspicious **Okta activity**.
- Look for **suspicious new cloud provider**.

## Verdict:
- At least **1 piece of evidence**.
- User verification (*only when a switch to mobile/VPN is detected*)

## Remediation:
- Clear user sessions (*immediately*).
- Expire password (*approval needed*).

# Requirements:

## Investigation:
- `Azure Risky Users` or `MSGraph Identity and Access` for retrieving **Azure Risk Detections**.
- `Microsoft 365 Defender` for retrieving **Defender Alerts**.
- `Okta V2` for retrieving Okta activity.
- `XQL Query Engine` to count past events.
- `Slack` for user verification.

## Remediation:
- `Microsoft Graph User`/`Okta V2` for clearing user sessions & expiring password.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-User moved Exchange sent messages to deleted items

##### This playbook addresses the following alerts:

- User moved Exchange sent messages to deleted items

##### Playbook Stages:

###### Triage:

- Retrieve additional data about the email movement activity including user details and message information

###### Investigation:

- Analyze the reputation of the source IP address
- Examine user risk level in Cortex Core and Azure AD risk detections
- Check for related security alerts (phishing, DLP violations)
- Retrieve and analyze recently sent email content and recipients
- Perform URL and domain reputation analysis on email content
- Assess user agent patterns for suspicious behavior
- Determine attacker motive based on email content and recipient analysis

###### Containment:

- For alerts determined to be true positives, automatically revoke the user's session
- Upon analyst approval, disable the compromised user account
- Provide manual verification options for inconclusive cases
- Manual actions are suggested for alerts indicative of Phishing/fraud or Exfiltration

Requirements: For response actions, you need the following integrations:

- Microsoft Graph User
- Microsoft Graph Mail.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-Suspicious certutil command line Test

This playbook handles "Suspicious certutil command line" alerts.

##### Playbook Stages:

Analysis:

During the alert analysis, the playbook will perform the following actions:

- Extracts and enriches the URL from the command line.
- Checks if the URL reputation is suspicious.
- Checks if any process in the causality chain is unsigned.
- Checks if any process in the causality chain is non-prevalent.
- Searches for Cortex XDR agent alerts related to file drops using certutil.
- Checks for any suspicious parameters in the command line (if the command line risk score is medium or higher).

If the playbook detects any of these conditions, it will proceed to the early containment stage; otherwise, it will close the alert.

###### Early Containment:

- Identify if an agent prevention rule was triggered. If triggered in **block mode**, proceed with the URL reputation check; otherwise, terminate the causality process tree.

Verdict:

- Based on the URL's reputation, if found to be malicious, the playbook will perform remediation actions; otherwise, it will close the alert.

Remediation:

If the URL is found to have a malicious reputation, the playbook will perform the following actions:

- Block the malicious URL using PAN-OS (requires analyst approval).
- Isolate the endpoint (requires analyst approval).
- Execute an XQL query to check for file creation events by the certutil process, and if a file is found, quarantine it (requires analyst approval).
- Automatically close the alert.

Required Integrations:

For response actions, you need the following integrations:

- Palo Alto Networks PAN-OS
- XQL Query Engine.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-Credential Dumping using a known tool Test

This playbook is designed to handle the following alerts:
- Command-line arguments match Mimikatz execution
- Mimikatz command-line arguments
- Credential dumping via wce.exe
- Credential dumping via gsecdump.exe
- PowerShell runs with known Mimikatz arguments
- Hash cracking using Hashcat tool
- Credential dumping via fgdump.exe
- Credential dumping via LaZagne
- Credential dumping via pwdumpx.exe
- Dumping lsass.exe memory for credential extraction
- Memory dumping with comsvcs.dll

The playbook executes the following stages:

###### Early Containment:
- Handles malicious alerts by terminating the causality process.

Remediation:
- Handles malicious alerts by suggesting the analyst to isolate the endpoint.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-Authentication method added to an Azure account

**This playbook addresses the following alert**:
- Suspicious authentication method addition to Azure account

**Playbook Stages**:

**Triage**:
- Gather initial information about the user.

**Investigation**:
- **Check IP Reputation**:
  - Analyze the reputation of the IP address related to the alert.
- **Check for Azure Alerts**:
  - Extract recent Azure security alerts for the user.
- **Check if User is Risky**:
  - Assess the risk score of the user based on Core and Azure risk indicators.
  - Investigate reasons behind any identified risks, including recent detections.

**Containment**:
- The playbook checks If hard remediation is needed, if yes, it will check if the integration "Microsoft Graph User" is enabled, the playbook will revoke the sessions of the user and provide a manual task for an analyst to review the findings and decide the next steps.
- Possible actions:
  - Disable the user.
  - Take no action.

If the integration is not enabled, the playbook will recommend performing the same action but manually.
- The playbook will check if soft remediation is needed, If yes, continue to revoke user's active sessions to ensure immediate containment.

**Requirements**:
For the best results, it's recommended to ensure these integrations are configured and working:
- `Cortex Core - Investigation and Response` for Core user risk evaluation.
- `Azure Risky Users` for retrieving user risk scores.
- `Microsoft 365 Defender` for advanced hunting queries and Azure security alerts.
- `Microsoft Graph User` is used to disable user and revoke session.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
##### New: CVE-2025-59287 - Microsoft WSUS Remote Code Execution

CVE-2025-59287 - Microsoft WSUS Remote Code Execution


## Vulnerability Overview

- **Vulnerability Name**: Microsoft Windows Server Update Service (WSUS) Deserialization of Untrusted Data Vulnerability
- **CVE ID**: CVE-2025-59287 
- **CVSS Score**: 9.8 (Critical) 


An unauthenticated remote code execution (RCE) vulnerability has been identified in Microsoft Windows Server Update Services (WSUS).
[Source: Unit42 - Palo Alto Networks](https://unit42.paloaltonetworks.com/microsoft-cve-2025-59287/)


## Mitigation and Recommendations

- **Apply Patch**
- **Restrict Access** to the vulnerable serves 
- **Monitor for IoCs and suspicious traffic** 

## Conclusion

CVE‑2025‑59287 is a critical, remotely exploitable vulnerability in WSUS that allows unauthenticated attackers to execute arbitrary code with SYSTEM privileges.

[View official CVE details on NIST](https://nvd.nist.gov/vuln/detail/CVE-2025-59287)

## Playbook Triggers
- Manually
- "CVE Exploitation - 2037164431" or "CVE Exploitation - 3823999562" Agents rules

## Playbook Flow
1. Uses XQL to identify WSUS servers in your environment.
2. Collects IOCs from the Unit42 blog.
3. Uses XQL to detect any suspicious command lines indicative of exploitation of this vulnerability.
4. Investigates the command lines to identify malicious indicators related to the vulnerability.
5. Uses XQL to hunt for malicious IOCs.
6. Isolates compromised WSUS servers.
7. Blocks malicious indicators using the "Containment Plan – Block Indicators" playbook.
8. Provides mitigation recommendations.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

<!-- ##### New: silent-Successful guest user invitation Test

**This playbook addresses the following alert**:
- Rare successful guest invitation in the organization

**Playbook Stages**:

**Triage**:
- Gather initial information about the invited user and associated alerts.

**Investigation**:
- **Check IOCs Reputation**:
  - Analyze the reputation of IP addresses, email addresses, and domains related to the incident.
- **Check for Azure Alerts**:
  - Retrieve user Principal Name (UPN).
  - Extract recent Azure security alerts for the inviting user.
- **Check if User is Risky**:
  - Assess the risk score of the inviting user based on Core and Azure risk indicators.
  - Investigate reasons behind any identified risks, including recent detections.

**Containment**:
- Provide a manual task for an analyst to review the findings and decide the next steps.
- Possible actions:
  - Disable the invited user.
  - Disable the inviting user.
  - Disable both users.
  - Take no action.
- If users are disabled, revoke their active sessions to ensure immediate containment.

**Requirements**:
For the best results, it's recommended to ensure these integrations are configured and working:
- `Cortex Core - Investigation and Response` for Core user risk evaluation.
- `Azure Risky Users` for retrieving user risk scores.
- `Microsoft 365 Defender` for advanced hunting queries and Azure security alerts.
- `Microsoft Graph User` for disabling accounts and revoking sessions.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-First seen Azure admin consent to an application

**This playbook addresses the following alert**:
- First seen Azure admin consent to an application

**Playbook Stages**:

**Triage**:
- Gather initial information about the the application and the admin who initiated the consent.
- **IP Enrichment**:
  - Analyze the reputation of the initiating user IP addresses.
**User Investigation**:
- **Azure Detection Analysis**:
  - Investigate recent Azure security alerts for the admin user and app owner to detect additional suspicious activity.
  - If any detections found, investigate the related user agent. 
- **User Risk Analysis**:
  - Assess the risk level of the admin user and app owner based on XSIAM Core and Azure risk score.
  - Investigate reasons behind any identified risks, including recent detections.
- **Recent user creations**:
  - checks if the app owner or the admin users was added recently 
**Application Investigation**:
- **Logins from uncommon location**:
  - Search for app sign ins from the last 24 hours that was not seen prior to it.
- **Conditional Access Blocks**:
  - Search for app sign ins that blocked by Conditional Access Policy
- **App access **:
  - checks if users with personal accounts allowed to access the app
- **App Verified Publisher **:
  - checks if the app publisher is verified by Microsoft
**Verdict & Containment**:
- If any suspicious evidence found during the user investigation phase and the integration "Microsoft Graph User" integration is enabled, the playbook will revoke the sessions of the admin user. If the integration is not enabled, the playbook will recommend to perform the same action but manually.
- If any suspicious evidence found during the application investigation AND the app consented with high privileges AND the application publisher is not verified, the playbook will present a data collection task that contains all of the details and will suggest to either remove or disable the service principal who associated to the app.
**Requirements**:
- `Azure Risky Users` for retrieving user risk scores.
- `Microsoft Graph User` for disabling accounts and revoking sessions.
- `Microsoft Graph Applications` for disabling and removing service principals.
- `Azure Log Analytics` for application investigation and part of user investigation.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-Compromise Accounts - User rejected numerous SSO MFA attempts Test

##### This playbook addresses the following alerts:

- User rejected numerous SSO MFA attempts
- Multiple SSO MFA attempts were rejected by a user with suspicious characteristics

##### Playbook Stages:

###### Triage:
- The playbook checks the IP address reputation associated with the MFA attempts and gathers related login events.

###### Early Containment:
- If the IP address is identified as malicious, the playbook blocks the IP. The investigation continues in parallel to this phase.

###### Investigation:
- The playbook performs an in-depth analysis, including:
  - Assessing the user's risk score to identify potentially compromised accounts.
  - Checking for an unusually high number of invalid credential attempts, which may indicate brute-force or credential-stuffing activity.
  - Verifying whether Okta logs indicate a malicious source IP based on Okta's threat intelligence.
  - Reviewing whether there have been an excessive number of MFA rejections from the user, suggesting potentially compromised behavior.
  - Looking for abnormal user agent patterns that may indicate suspicious or compromised access methods.
  - Investigating previous failed Okta login attempts within a specified timeframe to identify patterns.

###### Containment:
- If suspicious activity is confirmed, the playbook initiates the following containment actions:
  - Clears the user's active sessions and expires their password to prevent further unauthorized access.
  - If a successful login attempt was also detected, the playbook prompts a manual task for an analyst to review and decide on further action.

##### Requirements:
For any response actions, the following integration is required:
- Okta v2

For early containment actions, the following integration is required:
- Palo Alto Networks PAN-OS.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
##### New: A successful SSO sign-in from TOR

This playbook is designed to handle the following alerts:
- A successful SSO sign-in from TOR
- A successful SSO sign-in from TOR via a mobile device

The playbook executes the following stages:

###### Early Containment:
- The playbooks will perform early containment actions by clearing\revoking user sessions and enforcing re-authentication to terminate the connection from the Tor exit node and verify the user's identity. 
Depending on the alert source, the playbook will use either
Azure Active Directory Users or Okta v2 integrations to clear the user sessions.

###### Investigation:
During the alert investigation, the playbook will perform the following:
- Checks the user's risk score.
- Search for suspicious user agent usage within the alert.
- Search for related XDR alerts using the following MITRE techniques to identify any malicious activity:
T1566 - Phishing 
T1621 - Multi-Factor Authentication Request Generation
 T1110 - Brute Force
 T1556 - Modify Authentication Process

Remediation:
- Remediation actions will be taken if the user’s risk score is high, a suspicious user agent is detected, or a related alert is found. In such cases, the playbook will disable the account.
By default, account disabling requires analyst approval.

Requires: 
For any response action, you will need one of the following integrations: Azure Active Directory Users / Okta v2.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

<!-- ##### New: silent-NTDS.dit file written by an uncommon executable

This playbook is designed to handle the following alerts:
- NTDS.dit file written by a rare executable	
- NTDS.dit file written by a rare executable to a suspicious path	
- NTDS.dit file written by a remote actor

##### Playbook Stages:

Analysis:

- Retrieves the user risk score.
- Retrieves endpoint data and the endpoint risk score.
- Checks whether the host is a server.
- Collects all command lines in the causality chain.
- Checks whether any command lines have a high risk score.

###### Investigation:

- Checks if the NTDS.dit file was written by a non-DC server with a high risk level.
- Checks if the NTDS.dit file was written by a known server role but not a DC server.
- Checks if the NTDS.dit file was written by a high-risk user.
- Checks if the NTDS.dit file was written by unsigned processes.
- Checks if the NTDS.dit file was written by suspicious processes.
- Checks if the NTDS.dit file was written to a suspicious location.
- Searches for related alerts that indicate suspicious or malicious activity.
- Checks if the NTDS.dit file was written to a suspicious remote hostname or IP address.
- Checks if the NTDS.dit file was written by a suspicious remote actor.

Verdict:

The verdict is determined as malicious if any of the following conditions are met:
- Related alerts indicate malicious activity.
- The NTDS.dit file was written on a non-server host.
- The NTDS.dit file was written to an external ip address.
- The NTDS.dit file written by an actor with an external IP address.
- At least two suspicious indicators were identified during the investigation.

Remediation:

- Terminates the processes.
- Quarantines the written NTDS.dit file to prevent exfiltration or credential theft attempts.
- Disables the user (requires analyst approval).
- Isolates the endpoint to prevent exfiltration or credential theft attempts (requires analyst approval).
- Blocks the the connection to the remote actor (requires analyst approval).
- Block the external IP of the remote actor (requires analyst approval).
- Automatically close the alert.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-Suspicious process spawns MSBuild

##### This playbook addresses the following alerts:

  - Suspicious process spawns MSBuild.exe

  **Playbook Stages:**

  **Analysis:**
**Investigate potential masquerading technique:**
  - Get target process Reputation
  - Check target process name mismatch
  - Check target process for non standard paths
  - Check target process signature status

**Investigate potential code execution technique:**

  - Analyze suspicious project file for malicious code
  - Check the domain reputation when the file is on a remote host domain
  - Search for any additional processes, files, registry keys created by the code execution

  **Remediation:**
  - Terminate CGO process
  - Add hash to blocklist
  - Quarantine malicious files
  - Isolates the endpoint (requires analyst approval).<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-Excessive User Account Lockouts Test

##### This playbook addresses the following alerts:

- Excessive user account lockouts
- Excessive account lockouts on suspicious users
- Excessive user account lockouts from a suspicious source

The playbook investigates and responds to excessive user account lockout alerts. It gathers information about the alert, enriches relevant host data, and analyzes event patterns. This analysis helps distinguish between benign lockouts and lockouts caused by brute-force or password spray attacks.

##### Playbook Stages:

###### Triage:

- The playbook enriches the alert with details about the lockout events.

###### Investigation:

- Analyzes the lockout event timestamps to detect patterns.
- Checks for related medium severity brute-force alerts in the incident.
- Retrieves the Risk Score for the Caller Computer that caused the lockouts.

###### Containment:

- With analyst approval, the playbook can isolate the endpoint (either the Caller Computer or the target host) if it's determined to be a true positive and not a server.

##### Requirements:

- For response actions, the following integration is required: Core - IR.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-Suspicious execution from tmp folder Test

This playbook addresses the following alerts for linux os:

- Suspicious process execution from tmp folder
- Suspicious interactive execution of a binary from the tmp folder
- Suspicious cron job task execution of a binary from the tmp folder
- A web server process executed an unpopular application from the tmp folder

##### Playbook Stages:

Analysis:

- Check target process hash reputation
- Check commandline extracted indicators reputation

The playbook will proceed directly to remediation if suspicious/Suspicious reputation is found during the analysis stage.

###### Investigation:

- Search for the following suspicious insights/related alerts:
  - Suspicious access to shadow file
  - UNIX LOLBIN process connected to a rare external host
  - Persistence through service registration
  - Adding execution privileges 
  - Modification of systemd service files
  - Adding execution privileges
  - Local account discovery

If no suspicious reputation is found in the analysis stage, but suspicious insights/related alerts are discovered during investigation, the playbook will then proceed to remediation.

Remediation:

- Terminate causality process
- Quarantine the Suspicious process image file (requires manual approval).
- Disable the suspicious cron job task (requires manual action).<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
##### New: MFA was disabled for an Azure identity

**This playbook addresses the following alerts**:
- MFA was disabled for an Azure identity
- MFA was disabled for an Azure identity from a new country

**Playbook Stages**:

**Triage**:
- Gather initial information about the initiating user.
**Investigation**:
- **IP Enrichment**:
  - Analyze the reputation of the initiating user IP addresses.
- **Azure Detection Analysis**:
  - Investigate recent Azure security alerts for the initiating user to detect additional suspicious activity.
  - If any detections found, investigate the related user agent. 
- **User Risk Analysis**:
  - Assess the risk level of the initiating user based on Cortex XSIAM Core and Azure risk score.
  - Investigate reasons behind any identified risks, including recent detections.
- **Attacker Geolocation Analysis:**:
  - Investigate the initiating user connection geolocation.
- **Insights Analysis**:
  - Investigate the Cortex XSIAM insights that relate to the initiating user to detect additional suspicious activity.

**Verdict & Containment**:
- If any suspicious evidence is found during the investigation phase and the integration "Microsoft Graph User" integration is enabled, the playbook will revoke the sessions of the initiating user and the destination user. If the integration is not enabled, the playbook will recommend to perform the same action but manually.
- If any suspicious evidence found during the Azure detection analysis, Attacker geolocation analysis and Insight analysis investigations, and the integration "Microsoft Graph User" is enabled, the playbook will revoke the sessions of the initiating user and the destination user and will recommend manually to disable either one of the users or both of the users. If the integration is not enabled, the playbook will recommend to perform the same action but manually.

**Requirements:**:
- `Azure Risky Users` for retrieving user risk scores.
- `Microsoft 365 Defender` for advanced hunting queries and Azure security alerts.
- `Microsoft Graph User` for disabling accounts and revoking sessions.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

<!-- ##### New: silent-SSO Authentication With Suspicious Characteristics Test

**This playbook addresses the following alerts**:
- SSO authentication attempt with suspicious characteristics.
- Successful SSO authentication with suspicious characteristics.

**Playbook Stages**:

**Triage**:
- Collect initial information about the user and the SSO authentication event.
- Validate whether the authentication proxy is linked to iCloud Relay.

**Investigation**:
- **Check IOCs Reputation**:
  - Analyze the reputation of IP addresses associated with the alert.
- **Search Related Alerts**:
  - Look for alerts related to the same user within the system to identify suspicious activity trends.
- **Check If User Is Risky**:
  - Retrieve the user's risk score and evaluate high-risk indicators for suspicious activities.
- **Check User Agent**:
  - Identify suspicious user agents used during the authentication attempts.
- **Check Okta Logs**:
  - Retrieve Okta authentication logs for failed login attempts and suspicious authentication activities within the last day.

**Containment**:
- **Automatic Actions**:
  - Clear user sessions if any suspicious evidence is found during the investigation.
- **Analyst Review**:
  - Provide an analyst with findings for review and determine the appropriate action:
    - No action required.
    - Suspend the user in Okta.
  - If the analyst chooses to suspend the user, their active sessions are cleared in Okta.

**Requirements**:
For the best results, it's recommended to ensure these integrations are configured and working:
- **Core** integration for user risk evaluation and suspicious activity checks.
- **Okta v2** integration for analyzing authentication logs, clearing sessions, and user suspension.
- Any IP reputation integration that supports the `!ip` command for checking IP address reputation.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-Azure AD Administrator Role Assignment

### This playbook addresses the following alerts:
- Suspicious Azure AD Administrator Role assignment.
- Identity assigned an Azure AD Administrator Role by an Application.

### Playbook Stages:

#### Triage:
- Gather additional information about the **assignor and assignee identities** involved in the admin role assignment, as well as **any anomalies** related to the alert.

#### Investigation:
- Assignor/Assignee Identities Analysis:
  - Assess the **risk level** of the user in Cortex. 
  - Search for medium/high risk level **Azure Risk Detections and Defender Alerts** from the past day.
  - Mark if the user is **new**.
- Analyze the reputation of the assigning **IP address**.
- Check for anomalies in **User Agent, ASN, and country**.

#### Verdict:
- If **either** the assignor and assignee identities are identical *OR* an application assigned the admin role for the first time from a rare IP, **AND** at least two evidence items were found.
- If at least three evidence items include a mix of *global evidence with assignor-related evidence*, **OR** a mix of *global evidence with assignee-related evidence*.

#### Remediation:
- *Immediately* revoke the assignor's user sessions.
- Remove the admin role assignment (*approval needed*).
- Disable the assignor user and/or the assignee user (*approval needed*).

### Requirements:
- *For Investigation Steps:*
  - `Azure Risky Users` or `MSGraph Identity and Access` for retrieving **Azure Risk Detections**.
  - `Microsoft 365 Defender` for retrieving **Defender Alerts**.
  - `Microsoft Graph User` for retrieving user properties.
- *For Remediation Steps:*
  - `Microsoft Graph Identity and Access` for removing the admin role assignment.
  - `Microsoft Graph User` for revoking user sessions and for disabling users.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-Exchange forwarding rule configured Test

##### This playbook addresses the following alerts:

- External Exchange inbox forwarding rule configured.
- Suspicious Exchange inbox forwarding rule configured.
- Suspicious Exchange email-hiding inbox rule.
- Possible BEC Exchange email-hiding inbox rule.
- Exchange email-hiding transport rule based on message keywords.
- Suspicious Exchange email-hiding transport rule.
- Exchange transport forwarding rule configured.
- Suspicious Exchange transport forwarding rule configured.

##### Playbook Stages:
 
Triage: 

- The playbook retrieves the caller's IP, the forwarding email address, and the domain.

###### Early Containment:

- The playbook checks if the IP or domain of the forwarding email address is malicious. If so, it suggests blocking the IP using PAN-OS while continuing the investigation in parallel.

###### Investigation:

- The playbook checks for suspicious behaviors, including whether an Exchange admin created the rule outside of working hours, from unusual geolocation, or if the user who created the rule has a high-risk score. It then aggregates all evidence collected during the investigation.

###### Containment:

- Soft Response Actions: If at least two suspicious pieces of evidence are identified, the playbook will execute soft response actions. These actions include signing the user out and disabling the forwarding rule configured in the user's account mailbox.
- Hard Response Actions: If more than two suspicious pieces of evidence are identified, the playbook escalates to hard response actions. These actions include disabling the user account upon analyst decision and removing the forwarding rule from the user's account mailbox.

Requirements: 

For any response action, you need the following integrations:
- EWS Extension Online Powershell v3 integration.
- Azure Active Directory Users.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-A user created a pfx in a suspicious folder for the first time

##### This playbook addresses the following alerts:

- A user created a pfx in a suspicious folder for the first time

##### Playbook Stages:

###### Triage:

- Collect initial alert data regarding the event.
- Check the user type of the source user.
- Host enrichment. 

###### Investigation:

- Check if an admin user initiated the operation and whether the deleted users are disabled. 
- Correlate recent user activity with related security alerts.
- Assess user's and host's risk level in Cortex XDR.
- Check the type of the user target. 

Remediation:

- Evaluate investigation findings, if TP, the playbook will display the findings to an analyst for review and suggest user/host account disablement.


##### Requirements:

For response actions, you need the following integrations:

- Cortex Core - Investigation and Response
- Active Directory Query v2.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-Intense SSO failures with suspicious characteristics

**This playbook addresses the following alert**:
- Intense SSO failures with suspicious characteristics.

**Playbook Stages**:

**Triage**:
- Collect additional alert data.
- Retrieve IP reputation.
- Analyze identity count and IP reputation:
  - If failures involve many users and the IP is not malicious, the alert is likely a false positive and will be closed automatically.

**Investigation**:
- Identify users with successful logins.
- Check risk indicators for affected users.
- Search for related alerts.
- Analyze authentication patterns for automation.
- Retrieve Azure and Core risk scores.
- Extract security alerts linked to affected users.
- **Check for Suspicious Evidence**, including:
  - Blocked sign-ins from a malicious IP.
  - Related security incidents and high-risk IP reputation.
  - Risk detections from Azure and Core.
  - Suspicious authentication targeting admin portals (e.g., Azure Portal, Exchange Admin, Microsoft 365 Admin).
  - The number of distinct identities involved.

**Containment**:
- **Automatic Actions**:
  - If strong indicators of compromise exist, clear active user sessions.
- **Analyst Review**:
  - Findings are presented for review.
  - **If user disablement is required**, the analyst can select users to disable in Azure AD.
  - If a user is disabled, the playbook will also **clear their active sessions**.

**Requirements**:
Ensure the following integrations are configured:
- **Microsoft Graph Identity** for Conditional Access and risk scores.
- **Microsoft Defender for Identity** for authentication analysis.
- **Core** for user risk evaluation and alert correlation.
- **Threat Intelligence Integrations** for IP reputation analysis.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
##### New: A user executed multiple LDAP enumeration queries

##### This playbook addresses the following alerts:

- A user executed suspicious LDAP enumeration queries

##### Playbook Stages:

###### Triage:

- Get additional event information about the LDAP searches executed by the user
- Ensure that a single client IP exists in the alert
- Get endpoint information for the client IP
- Check preconditions for continuing investigation based on the number of suspicious attributes, attack tool queries, and vulnerable certificate templates


###### Investigation:

- Enrich the user that executed the queries
- Check if the user was created recently
- Search for additional discovery alerts in the incident
- Check user groups and roles to determine if the user is unprivileged
- Check user querying frequency to detect anomalies
- Get host risk level
- Search for recent malware alerts on client IP

Remediation:

- With analyst approval, disable the user in Active Directory if user-related anomalies are found and the alert is a True Positive.
- With analyst approval, isolate the endpoint if host-related anomalies are found and the alert is a True Positive.
- Logoff user from client host if an active session is detected and the alert is a True Positive.

##### Requirements:

For any response action, you need the following integrations:

- Core - IR
- Active Directory Query v2.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

##### New: Suspicious LDAP search query

This playbook is designed to handle the following alerts: 
- Possible LDAP enumeration by unsigned process.
- Suspicious LDAP search query executed.

The playbook executes the following stages:

###### Investigation:
Check the following parameters to determine if remediation actions are needed:
- Cortex XSIAM alerts related to the hostname by MITRE tactics indicating malicious activity.
- Whether the Actor Process Command line contains suspicious arguments.
- Checks for the prevalence of the Actor Process Name.
- Host risk score is "Medium" or "High".
- User risk score is "High".

Remediation:
- Handles malicious alerts by terminating the causality process.
- Handles non-malicious alerts identified during the investigation.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

<!-- ##### New: silent-Multiple discovery commands on a Windows host

#### This playbook is designed to handle the following alerts:
- Multiple discovery commands on a Windows host by the same process
- Remote Multiple discovery commands on a Windows host by the same IP
- Multiple discovery commands on a Windows host by the same process from a web server CGO
- Multiple discovery commands on a Windows host by the same process from an SQL server CGO
- Multiple discovery commands on a Windows host by the same process from a remote CGO
- Rare Multiple discovery commands on a Windows host by the same process


#### The playbook executes the following stages:
*Investigation:*
- Check the CGO SHA256 Reputation if malicious.
- Check the CGO SHA256 Reputation if medium and the CGO process is unsigned.
- OS Actor CMD analysis is at high risk.
- OS Actor CMD analysis is at medium, and there is an output file for the discovery commands.
- Check if the host risk score is high.
- Check if the host risk score is medium and there is an output file, or the command line analysis is at medium risk.
- Check for host-related alerts
- Check if there are any related alerts on the remote host ( if there are any) and their host risk score.

*Additional advanced preformed checks:*
- If there is a script associated with the os actor command line, check the following:
    - the script's sha256 reputation.
    - the script's content with the command line analysis.
    - detonate the script in Wildfire Sandbox.
    - Check the process sha256 that created the script for reputation.

*Remediation:*

- Terminate the causality
- Add to the block list all the suspicious SHA256 files.
- Quarantine the malicious files.
- Block IP on the host and block the external IP if required.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
##### New: Endpoint initiated uncommon remote scheduled task creation

This playbook handles "Uncommon remote scheduled task creation" alert, which is generated on the source host that created the remote scheduled task.

##### Playbook Stages:

Analysis:

- The playbook verifies whether the causality process is signed and prevalent. If the process is not signed and not prevalent, it proceeds with remediation actions; otherwise, it continues investigating the alert.

###### Investigation:

During the alert investigation, the playbook will perform the following:

- Searches for related Cortex XSIAM alerts on the endpoint that use the following MITRE techniques to identify malicious activity: T1202 - Indirect Command Execution, T1021 - Remote Services.
- Searches for related Cortex XSIAM agent alerts on the remote endpoint, to determine if the creation of the scheduled task is part of an attack pattern.
- Searches for suspicious command-line parameters indicating a malicious scheduled task.

Remediation:

- Automatically disable the malicious scheduled task on the remote host.
- Automatically terminate the causality process.
- Automatically close the alert.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

##### New: Azure Temporary Access Pass (TAP) registered to an account

##### This playbook addresses the following alerts:

- Abnormal Azure Temporary Access Pass (TAP) account registration

##### Playbook Stages:

###### Triage:

- Retrieve additional data about the TAP registration including start/end times, usage type, and user details

###### Investigation:

- Analyze the reputation of the caller IP address
- Examine alerts from Microsoft Defender 365 related to the TAP assigner
- Check Azure AD risky user status and risk detections
- Review Cortex Core risk level for the user
- Verify creation date of the user account in Azure AD to identify recently created accounts
- Correlate evidence across multiple sources to determine potential compromise

###### Containment:

- For alerts determined to be true positives, automatically revoke the user's session in Microsoft applications
- Upon analyst approval, disable the user account that granted the TAP

Requirements: For response actions, you need the following integrations:

- Microsoft Graph User.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

<!-- ##### New: silent-A Successful login from TOR Test

This playbook is designed to handle the following alert:

- A successful login from TOR

The playbook executes the following stages:

###### Triage:

- The playbook will fetch the user identity details.

Remediation & Eradication:

- The playbooks will suggest several actions for the analyst to take: disabling the user account using Active Directory or Azure Active Directory, expiring the user password using Active Directory, or blocking traffic from TOR exit nodes using PAN-OS and Palo Alto Networks' predefined EDL.

The analyst can select multiple actions, which will then be executed by the playbook based on the analyst's choices.

Requirements: 
For any response action, you will need one of the following integrations: Azure Active Directory Users / Active Directory Users.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
##### New: Netcat Makes or Gets Connections

This playbook is designed to handle the following alerts:
 
- Netcat makes or gets connections

The playbook executes the following stages:

Analysis:

- Investigate the IP and Domain reputation
- Search previous similar alerts

Remediation:
 
- Handles malicious alerts by terminating the causality process.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

##### New: SSO Password Spray

This playbook is designed to handle the following alerts:

- SSO Password Spray Threat Detected
- SSO Password Spray Activity Observed
- SSO Password Spray Involving a Honey User

##### Playbook Stages:

###### Triage:

- The playbook checks the IP reputation and fetches the events related to the SSO login attempts.

###### Early Containment:

- The playbook checks if the IP is suspicious. If it is, the playbook suggests blocking the IP.

###### Investigation:

- The playbook assess the risk score of the user who successfully logged in and examines the legitimacy of the user agent. It verifies if the user has MFA configured and analyzes the timestamps of the login attempts to detect potential malicious automated patterns.

###### Containment:
- If there is a successful login attempt and the user's risk score is high, or if the user agent is detected as suspicious, or if the time intervals were automated, the playbook clears the user's session. If the user doesn't have MFA, the playbook recommends expiring the user's password.

##### Requirements:

For any response action, you need one of the following integrations:

- Microsoft Graph User
- Okta.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

<!-- ##### New: silent-Execution of an uncommon process at an early startup stage by Windows system binary

This playbook is designed to handle the following alerts:
- Execution of an uncommon process with a local/domain user SID at an early startup stage with a suspicious characteristics by Windows system binary.
- Execution of an uncommon process at an early startup stage by Windows system binary with suspicious characteristics.

##### Playbook Stages:

Analysis:

- Checks the process's reputation.
- Searches for related alerts.

###### Investigation:
The investigation follows different flows depending on the persistence techniques and involved processes from the following list:
- winlogon
- LogonUI
- WMI
- Scheduled tasks
- Registry keys
- spoolsv
- RunOnce
- Startup Folder
- Malicious IIS extensions or modules via w3wp.exe


Verdict:

Based on the investigation findings, the playbook will either perform remediation actions or close the alert as a false positive.


Remediation:

The playbook performs actions to stop the attack and remove persistence mechanisms by:
- Terminating the malicious process.
- Quarantining the malicious process. (Requires analyst approval)
- Adding the malicious process hash to the block list. (Requires analyst approval)
- Searching for and deleting malicious scheduled tasks to remove persistence. (Requires analyst approval)
- Recommending the deleting of specific registry keys to remove persistence.
- Automatically closing the alert.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
##### New: First Azure AD PowerShell operation for a user

**This playbook addresses the following alert**:
- First Azure AD PowerShell operation for a user

**Playbook Stages**:

**Triage**:
- Gather initial information about the user.
- Check IP Reputation.
- Check the User Agent.

**Investigation**:
- **Check for Azure Alerts**:
  - Extract recent Azure security alerts for the user.
- **Check if User is Risky**:
  - Assess the user's risk score based on Core and Azure risk indicators.
  - Investigate reasons behind any identified risks, including recent detections.
- **Investigate user data**:
  - Check the user creation date to asses if the user is new.
  - Check the role of the user.

**Containment**:
- The playbook checks if soft remediation is needed, if yes, it will check if the integration "Microsoft Graph User" is enabled, the playbook will revoke the sessions of the user.
- The playbook checks if hard remediation is needed, if yes, 
a manual task will be displayed for an analyst to review the findings and decide the next steps.
- Possible actions:
  - Disable the user.
  - Take no action.

**Requirements**:
For the best results, it's recommended to ensure these integrations are configured and working:
- `Cortex Core - Investigation and Response` for Core user risk evaluation.
- `Azure Risky Users` for retrieving user risk scores.
- `Microsoft 365 Defender` for advanced hunting queries and Azure security alerts.
- `Microsoft Graph User` is used to disable user and revoke session.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

<!-- ##### New: silent-Uncommon execution of ODBCConf Test

This playbook handles "Uncommon execution of ODBCConf" alerts.

##### Playbook Stages:

Analysis:
During the analysis, the playbook will perform the following:

- Checks if the causality process (CGO) is signed and prevalent.
- Checks for the host's risk score.

If the CGO process is not signed and not prevalent, or if either of these conditions is met in addition to having a high-risk score, the playbook proceeds with remediation actions. Otherwise, it will continue to the investigation phase.

###### Investigation:
During the alert investigation, the playbook will perform the following:

Searches for related Cortex XSIAM alerts and insights on the same causalities chains by specific alert names : 
- Evasion Technique - 3048798454
- An uncommon LOLBIN added to startup-related Registry keys
- Behavioral Threat
- An uncommon file was created in the startup folder
- Unsigned process running from a temporary directory
- Execution From a Restricted Location
- Execution of an uncommon process with a local/domain user SID at an early startup stage by Windows system binary - Explorer CGO

The playbook determines the appropriate verdict. If related alerts are found, it proceeds to remediation actions. In case of related insights are found ,and one of the following is met: the host score is listed as high or the CGO process is not prevalent, it will proceed to remediation actions. Otherwise, it closes the alert with the following message: "No indication of malicious activity was found".


Remediation: 

- Automatically terminate the causality process.
- Automatically Close the alert.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-Script file added to startup-related Registry keys

This playbook handles "Script file added to startup-related Registry keys" alerts.

##### Playbook Stages:

Analysis:

- Extract the script path from the registry key value.
- Check the reputation of the associated processes.

###### Investigation:

- Searches for related Cortex XSIAM alerts to identify potential attack patterns.
- Retrieves the script file and relevant details for investigation.
- Analyzes the script for malicious or suspicious parameters:
  - If malicious parameters are found, proceed to remediation.
  - If suspicious parameters are found, detonate and analyze the script using WildFire Sandbox.
- Checks the script file reputation.
- Detonates and analyzes the script using WildFire Sandbox.

Remediation:

- Terminates the malicious process.
- Quarantines the malicious process.
- Adds the malicious process hash to the blocklist.
- Calculates the script file’s SHA256 hash if not already available.
- Deletes the Registry key value (Requires analyst approval).
- Adds the script file hash to the blocklist (Requires analyst approval).
- Automatically close the alert.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
##### New: Successful guest user invitation

**This playbook addresses the following alert**:
- Rare successful guest invitation in the organization

**Playbook Stages**:

**Triage**:
- Gather initial information about the invited user and associated alerts.

**Investigation**:
- **Check IOCs Reputation**:
  - Analyze the reputation of IP addresses, email addresses, and domains related to the incident.
- **Check for Azure Alerts**:
  - Retrieve user Principal Name (UPN).
  - Extract recent Azure security alerts for the inviting user.
- **Check if User is Risky**:
  - Assess the risk score of the inviting user based on Core and Azure risk indicators.
  - Investigate reasons behind any identified risks, including recent detections.

**Containment**:
- Provide a manual task for an analyst to review the findings and decide the next steps.
- Possible actions:
  - Disable the invited user.
  - Disable the inviting user.
  - Disable both users.
  - Take no action.
- If users are disabled, revoke their active sessions to ensure immediate containment.

**Requirements**:
For the best results, it's recommended to ensure these integrations are configured and working:
- `Cortex Core - Investigation and Response` for Core user risk evaluation.
- `Azure Risky Users` for retrieving user risk scores.
- `Microsoft 365 Defender` for advanced hunting queries and Azure security alerts.
- `Microsoft Graph User` for disabling accounts and revoking sessions.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

<!-- ##### New: silent-Uncommon remote scheduled task created Test

This playbook handles "Uncommon remote scheduled task created" alerts.

##### Playbook Stages:

Analysis:

- The playbook checks if the remote IP is external or has a bad reputation.
- The playbook checks the host risk score.

###### Investigation:
During the alert investigation, the playbook will perform the following:

- Searches for related XSIAM alerts on the endpoint that use the following MITRE techniques to identify malicious activity: T1202 - Indirect Command Execution, T1021 - Remote Services.
- Searches for related XSIAM agent alerts on the remote endpoint, to determine if the creation of the scheduled task is part of an attack pattern.
- Searches for suspicious command-line parameters indicating a malicious scheduled task.

Remediation:

- Automatically disable the malicious scheduled task.
- Block the malicious IP (requires analyst approval).
- Automatically Close the alert.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-Event Log Was Cleared Test

This playbook is designed to handle the following alerts: 
- Windows Event Log was cleared using wevtutil.exe
- Security Event Log was cleared using wevtutil.exe
- A Sensitive Windows Event Log was cleared using wevtutil.exe
- Windows event logs were cleared with PowerShell
- Suspicious clear or delete security provider event logs with PowerShell
- Suspicious clear or delete default providers event logs with PowerShell
- Windows event logs cleared using wmic.exe

The playbook executes the following stages:

###### Investigation:
Check the following parameters to determine if remediation actions are needed:
- Cortex XSIAM alerts related to the hostname by MITRE tactics indicating malicious activity.
- Whether the CGO or the OSParent process is unsigned.
- The prevalence of the OSParent process.

Remediation:
- Handles malicious alerts by terminating the relevant processes.
- Handles non-malicious alerts identified during the investigation.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-Suspicious dump of ntds.dit using Shadow Copy with ntdsutil or vssadmin

This playbook is designed to handle the "Suspicious dump of ntds.dit using Shadow Copy with ntdsutil/vssadmin" alerts.

##### Playbook Stages:

Analysis:

- Retrieves the user risk score.
- Retrieves the host risk score.
- Retrieves the ntds.dit file location
- Checks if the shadow copy includes the volume with the ntds.dit file (for VSSAdmin operations).
- Checks if ntdsutil accessed the ntds.dit file (for ntdsutil operations).

###### Investigation:

- Checks if the action was performed by a high-risk user.
- Checks if the action occurred on DC server with a high risk level.
- Checks if the action was performed by a suspicious remote actor.
- Searches for related alerts indicating suspicious or malicious activity.
- Searches for NTDS.dit file write events.
- Determines if the user is highly privileged.
- Analyzes the command line in the same causality chain for malicious activity.

Verdict:

The verdict is determined as malicious based on the evidence found during the investigation phase.

Remediation:

- Terminates the processes.
- Quarantines the written NTDS.dit file to prevent exfiltration or credential theft attempts.
- Delete the relevant shadow copies and snapshots.
- Disables the user (requires analyst approval).
- Logs off the user.
- Blocks the the connection from the remote actor.
- Block the external IP of the remote actor.
- Automatically close the alert.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
##### New: Msiexec execution of an executable from an uncommon remote location

##### This playbook addresses the following alerts:
 
- Msiexec execution of an executable from an uncommon remote location with a specific port
- Msiexec execution of an executable from an uncommon remote location without properties
 
##### Playbook Stages:
  
Analysis: 
 
- Check extracted URL reputation:
  - Determine if the MSI package was installed from a malicious source
  - If the URL is found to be malicious, the playbook will proceed directly to remediation steps
 
###### Investigation:

- Check extracted domain's prevalence and causality process signature status:
  - Evaluate the prevalence of the domain from which the MSI package was downloaded
  - Verify if the causality process (CGO) is signed or unsigned
  - If the domain is found malicious and the causality process is unsigned, the playbook will proceed directly to remediation steps

- Check for the following related alerts: 
  - Local Analysis Malware
  - Mitre Techniques:
    - T1140 - Deobfuscate/Decode Files or Information
    - T1059 - Command and Scripting Interpreter 

- Analyze CGO command line for defense evasion techniques:
  - Evaluate the command line for suspicious patterns which indicates attempts to bypass security controls

- If the command line contains suspicious patterns or related alerts are found, the playbook will proceed directly to remediation steps

###### Containment:
 
- Terminate causality process
- Block maliciou URL (Manual approval)
  - Implement URL blocking using PAN-OS through Custom URL Categories
- Isolate endpoint (Manual approval)
 
Requirements: 
 
For any response action, you need the following integration:
 
- PAN-OS.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

<!-- ##### New: silent-Unusual process accessed web browser credentials and executed by a terminal process Test

This playbook handles "Unusual process accessed web browser credentials and executed by a terminal process" alerts.

##### Playbook Stages:

Analysis:
During the analysis, the playbook will perform the following:

- Checks the initiator file path for any suspicious locations.
- Checks the initiator process reputation.

If the file is malicious, it proceeds to remediation actions; otherwise, it continues to the investigation phase.

###### Investigation:
During the alert investigation, the playbook will perform the following:

- Searches for related Cortex XSIAM alerts and insights on the endpoint by specific alert names or by the following MITRE technique to identify malicious activity: T1555.001 - Credentials from Password Stores: Keychain.

The playbook determines the appropriate verdict. If related alerts or insights are found, it proceeds to remediation actions; otherwise, it closes the alert with the message "No indication of malicious activity was found".

Remediation:

- Automatically terminate the causality process.
- Quarantine the initiator file if its reputation is malicious, if medium- to high-severity alerts indicating malicious activity are found, or if related insights are found and the initiator is running from a suspicious path. (This action requires analyst approval).
- Automatically Close the alert.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-AppleScript Process Executed With Rare Command Line Test

This playbook handles "AppleScript Process Executed With Rare Command Line" alerts.

##### Playbook Stages:

###### Investigation:
During the alert investigation, the playbook will perform the following:

- Searches for XSIAM prevention alerts with the same causality process ID.
- Checks if the causality|actor image has bad reputation or is not signed.
- Checks if malicious|suspicious patterns found in the command line.
- Searches for XSIAM insights alerts indicating a suspicious activity.


Remediation:

- Automatically terminate the causality process.
- Quarantine the causality|actor image (requires analyst approval).
- Automatically Close the alert.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-Suspicious process execution by scheduled task on a sensitive server Test

This playbook handles "Suspicious process execution by scheduled task on a sensitive server" alerts.

##### Playbook Stages:

Analysis:

- Checks the suspicious process reputation.

###### Investigation:

- Searches for related XSIAM agent alerts to identify any malicious activity on the server.

Remediation:

If the suspicious process reputation is malicious, or if a related alert is found, the following remediation actions will be taken:

- Disable the scheduled task responsible for executing the process.
- Terminate the malicious process.
- Quarantine the malicious process.
- Automatically Close the alert.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
##### New: Uncommon creation or access operation of sensitive shadow copy by a high-risk process

##### This playbook addresses the following alerts:
 
- Uncommon creation or access operation of sensitive shadow copy by a high-risk process
 
##### Playbook Stages:
  
Triage: 
 
- Check if the causality process image (CGO) is signed or not
 
###### Investigation:
 
- If CGO is unsigned:
  - Check the CGO process prevalence
  - Check if the process image path is common
  - Check the CGO process hash reputation
  - Check the CGO commandline risk score
- If CGO is signed:
  - Check process image name
  - Check initiating process image name
  - Check if username is SYSTEM
  - Check if host is a server
  - Check for previous similar alert closed as False Positive
 
###### Containment:
 
- Terminate causality process (CGO) process - when a signed high-risk process or an unsigned process from an uncommon path attempting to create or access sensitive shadow copy data.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

##### New: Exchange forwarding rule configured

##### This playbook addresses the following alerts:

- External Exchange inbox forwarding rule configured.
- Suspicious Exchange inbox forwarding rule configured.
- Suspicious Exchange email-hiding inbox rule.
- Possible BEC Exchange email-hiding inbox rule.
- Exchange email-hiding transport rule based on message keywords.
- Suspicious Exchange email-hiding transport rule.
- Exchange transport forwarding rule configured.
- Suspicious Exchange transport forwarding rule configured.

##### Playbook Stages:
 
Triage: 

- The playbook retrieves the caller's IP, the forwarding email address, and the domain.

###### Early Containment:

- The playbook checks if the IP or domain of the forwarding email address is malicious. If so, it suggests blocking the IP using PAN-OS while continuing the investigation in parallel.

###### Investigation:

- The playbook checks for suspicious behaviors, including whether an Exchange admin created the rule outside of working hours, from unusual geolocation, or if the user who created the rule has a high-risk score. It then aggregates all evidence collected during the investigation.

###### Containment:

- Soft Response Actions: If at least two suspicious pieces of evidence are identified, the playbook will execute soft response actions. These actions include signing the user out and disabling the forwarding rule configured in the user's account mailbox.
- Hard Response Actions: If more than two suspicious pieces of evidence are identified, the playbook escalates to hard response actions. These actions include disabling the user account upon analyst decision and removing the forwarding rule from the user's account mailbox.

Requirements: 

For any response action, you need the following integrations:
- EWS Extension Online Powershell v3 integration.
- Azure Active Directory Users.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

<!-- ##### New: silent-Regsvr32 may have run code from an untrusted source

This playbook is designed to handle the following alert: 
- Regsvr32 may have run code from an untrusted source

The playbook executes the following stages:

Investigation Flow:
 - Checks for possible related alerts & insights.
 - Checks if the alert triggered by an attack simulation tools.
 - Gets the host risk score.
 - Checks for suspicious XML path in the regsvr32 cmd (such as the tmp folder)
 - Retrieves the XML file (in some cases, only its content), and analysis it.
 - Extracts indicators and enrich them.

Verdict decision Flow:
The playbook will classify the alert as True Positive if one of the following check is matched:
 - The host risk score is high
 - Alert triggered by BAS execution
 - External URL reference
 - If there are related alerts
 - if there are related insights + host risk score is medium
 - Reputation for XML hash when the XML is on the local machine path
 - CMD Analysis will be for: UNC, local path, Internal URL
 - For the external URL, the hash will be calculated and blocked automatically in the Remediation step

Remediation:
 - Terminate CGO
 - Quarantine XML (in case of local xml path )
 - Block IOCs:
   - Domain and IP over TIM score of suspicious.
   - XML Hash (in cases of External URL or local path).
   - URL ( only if it is external URL).
 - Closes the alert as True Positive or False Positive.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-Azure AD account unlock or password reset Test

**This playbook addresses the following alert**:
- Azure AD account unlock/successful password reset

**Playbook Stages**:

**Triage**:
- Gather initial information about the user.

**Investigation**:
- **Check IP Reputation**:
  - Analyze the reputation of the IP address related to the alert.
- **Check for Azure Alerts**:
  - Extract recent Azure security alerts for the user.
- **Check if User is Risky**:
  - Assess the risk score of the user based on Core and Azure risk indicators.
  - Investigate reasons behind any identified risks, including recent detections.

**Containment**:
- Check if feature sum is greater than 2 (Possible features:new user agent/new asn/new country). If yes, continue to revoke user's active sessions to ensure immediate containment.
If no, continue to check investigation findings.
- Provide a manual task for an analyst to review the findings and decide the next steps.
- Possible actions:
  - Disable the target user.
  - Disable the resource user.
  - Disable both users.
  - Take no action.

**Requirements**:
For the best results, it's recommended to ensure these integrations are configured and working:
- `Cortex Core - Investigation and Response` for Core user risk evaluation.
- `Azure Risky Users` for retrieving user risk scores.
- `Microsoft 365 Defender` for advanced hunting queries and Azure security alerts.
- `Microsoft Graph User` for disabling accounts and revoking sessions.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-Suspicious SaaS Access From a TOR Exit Node Test

This playbook is designed to handle the following alerts:

- Suspicious SaaS API call from a Tor exit node
- Suspicious SaaS API call from a Tor exit node via a mobile device
- Suspicious API call from a Tor exit node
- Suspicious Kubernetes API call from a Tor exit node

##### Playbook Stages:

###### Early Containment:
- To terminate the connection from the Tor exit node, the playbook will clear/revoke the user's sessions and force re-authentication. Depending on the alert source, the playbook will use either MS-Graph or G-Suite to clear the user sessions.

###### Investigation:
- The playbook will assess the risk score of the user connected from the Tor exit node and examine the legitimacy of the user agent.

###### Containment:
- If the user's risk score is high or the user agent is detected as suspicious, the playbook will recommend blocking the account connected from the Tor exit node. The playbook will use MS-Graph, G-Suite, or AWS-IAM, depending on the alert source.

Eradication:
- For users with PAN-OS enabled, the playbook will recommend blocking all IPs from the Palo Alto Intelligence-based external dynamic list that contains Tor exit nodes. The goal is to prevent the use of Tor within the organization.

##### Requirements:

For any response action, you will need one of the following integrations: 
- Microsoft Graph User
- G-Suite Admin
- AWS-IAM.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-A user executed multiple LDAP enumeration queries Test

##### This playbook addresses the following alerts:

- A user executed suspicious LDAP enumeration queries

##### Playbook Stages:

###### Triage:

- Get additional event information about the LDAP searches executed by the user
- Ensure that a single client IP exists in the alert
- Get endpoint information for the client IP
- Check preconditions for continuing investigation based on the number of suspicious attributes, attack tool queries, and vulnerable certificate templates


###### Investigation:

- Enrich the user that executed the queries
- Check if the user was created recently
- Search for additional discovery alerts in the alert
- Check user groups and roles to determine if the user is unprivileged
- Check user querying frequency to detect anomalies
- Get host risk level
- Search for recent malware alerts on client IP

Remediation:

- With analyst approval, disable the user in Active Directory if user-related anomalies are found and the alert is a True Positive.
- With analyst approval, isolate the endpoint if host-related anomalies are found and the alert is a True Positive.
- Logoff user from client host if an active session is detected and the alert is a True Positive.

##### Requirements:

For any response action, you need the following integrations:

- Core - IR
- Active Directory Query v2.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
##### New: Suspicious Conditional Access operation for an identity

**This playbook addresses the following alert**:
- Suspicious Conditional Access operation for an identity

**Playbook Stages**:

**Triage**:
- Gather initial information about the initiating user.
**User Investigation**:
- **IP Enrichment**:
  - Analyze the reputation of the initiating user IP addresses.
- **Azure Detection Analysis**:
  - Investigate recent Azure security alerts for the initiating user to detect additional suspicious activity.
  - If any detections found, investigate the related user agent. 
- **User Risk Analysis**:
  - Assess the risk level of the initiating user based on XSIAM Core and Azure risk score.
  - Investigate reasons behind any identified risks, including recent detections.
- **Attacker Geolocation Analysis**:
  - Investigate the initiating user connection geolocation.
- **Insights Analysis**:
  - Investigate the XSIAM insights that related to the initiating user to detect additional suspicious activity.

**User Investigation**:
- **Search for suspicious MFA activity**:
  - Search for a policy change that indicates on disabling the need in MFA
- **Search for suspicious guest user activity**:
  - Search for a policy change that indicates on allowing 
**Verdict & Containment**:
- If any suspicious evidence found during the user investigation phase and the integration "Microsoft Graph User" integration is enabled, the playbook will revoke the sessions of the initiating user and the destination user. If the integration is not enabled, the playbook will recommend to perform the same action but manually.
- If the initiating user IP is malicious, or the initiating user risk is HIGH, or more than one suspicious evidence found during the Azure detection analysis and the CA policy investigation phase, and the integration "Microsoft Graph User" is enabled, the playbook will revoke the sessions of the initiating user and the destination user and will recommend manually to disable either one of the users or both of the users. If the integration is not enabled, the playbook will recommend to perform the same action but manually.

**Requirements**:
- `Azure Risky Users` for retrieving user risk scores.
- `Microsoft 365 Defender` for advanced hunting queries and Azure security alerts.
- `Microsoft Graph User` for disabling accounts and revoking sessions.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

<!-- ##### New: silent-Exchange User Mailbox Forwarding Test

**This playbook addresses the following alerts**:
- Exchange user mailbox forwarding.
- Suspicious Exchange user mailbox forwarding.

**Playbook Stages**:

**Triage**:
- Collect initial information about the internal user and the associated external forwarding address.

**Investigation**:
- **Check IOCs Reputation**:
  - Analyze the reputation of IP addresses, email addresses, and domains associated with the alert.
- **Get External Email Statistics**:
  - Retrieve statistics of email interactions between the internal user and the external forwarding address over the last 2 days, including:
    - Number of emails sent to and received from the external address.
    - Number of users interacting with the external address.
- **Check if User is Risky**:
  - Assess the internal user's risk score using:
    - **Core Risk Evaluation**: Identify high-risk users and extract reasons behind elevated risk levels.
    - **Azure Risk Indicators**: Retrieve Azure risk scores, detections, and recent security alerts for the internal user.
- **Check for Azure Alerts**:
  - Perform an advanced hunting query in Microsoft 365 Defender to extract recent Azure alerts associated with the internal user.

**Containment**:
- Provide a manual task for an analyst to review the findings and determine the appropriate response.
- Possible actions:
  - Disable the user in Azure AD to prevent further unauthorized actions.
  - Disable mailbox forwarding for the user in Exchange Online.
  - Disable both user and forwarding.
  - Take no action.
- If the user is disabled, revoke active sessions to ensure immediate containment.

**Requirements**:
For the best results, it's recommended to ensure these integrations are configured and working:
- `Cortex Core - Investigation and Response` for Core user risk evaluation.
- `Azure Risky Users` for retrieving Azure-based user risk scores and detections.
- `Microsoft 365 Defender` for advanced hunting queries and extracting Azure alerts.
- `Microsoft Graph User` for disabling user accounts and revoking active sessions.
- `Exchange Online EWS` for disabling mailbox forwarding.
- `Security And Compliance V2` for fetching email interaction statistics.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
##### New: Script file added to startup-related Registry keys

This playbook handles "Script file added to startup-related Registry keys" alerts.

##### Playbook Stages:

Analysis:

- Extract the script path from the registry key value.
- Check the reputation of the associated processes.

###### Investigation:

- Searches for related Cortex XSIAM alerts to identify potential attack patterns.
- Retrieves the script file and relevant details for investigation.
- Analyzes the script for malicious or suspicious parameters:
  - If malicious parameters are found, proceed to remediation.
  - If suspicious parameters are found, detonate and analyze the script using WildFire Sandbox.
- Checks the script file reputation.
- Detonates and analyzes the script using WildFire Sandbox.

Remediation:

- Terminates the malicious process.
- Quarantines the malicious process.
- Adds the malicious process hash to the blocklist.
- Calculates the script file’s SHA256 hash if not already available.
- Deletes the Registry key value (Requires analyst approval).
- Adds the script file hash to the blocklist (Requires analyst approval).
- Automatically close the alert.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

##### New: Suspicious process execution by scheduled task on a sensitive server

This playbook handles "Suspicious process execution by scheduled task on a sensitive server" alerts.

##### Playbook Stages:

Analysis:

- Checks the suspicious process reputation.

###### Investigation:

- Searches for related XSIAM agent alerts to identify any malicious activity on the server.

Remediation:

If the suspicious process reputation is malicious, or if a related alert is found, the following remediation actions will be taken:

- Disable the scheduled task responsible for executing the process.
- Terminate the malicious process.
- Quarantine the malicious process.
- Automatically Close the alert.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

##### New: AppleScript Process Executed With Rare Command Line

This playbook handles "AppleScript Process Executed With Rare Command Line" alerts.

##### Playbook Stages:

###### Investigation:
During the alert investigation, the playbook will perform the following:

- Searches for XSIAM prevention alerts with the same causality process ID.
- Checks if the causality|actor image has bad reputation or is not signed.
- Checks if malicious|suspicious patterns found in the command line.
- Searches for XSIAM insights alerts indicating a suspicious activity.


Remediation:

- Automatically terminate the causality process.
- Quarantine the causality|actor image (requires analyst approval).
- Automatically Close the alert.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

##### New: Unprivileged process opened a registry hive

This playbook is designed to handle the 'Unprivileged process opened a registry hive' alert.

##### Playbook Stages:

###### Investigation:

During the alert investigation, the playbook will perform the following:

- Checks the prevalence of the unprivileged process that triggered the alert.
- Checks the prevalence of the command line used by the unprivileged process.
- Searches for additional suspicious Cortex XSIAM alerts within the same incident in order to determine whether a remediation measure is required.

Remediation:

- To prevent malicious activity from continuing, the playbook terminates the causality processes that triggered the alert.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

<!-- ##### New: silent-Uncommon creation or access operation of sensitive shadow copy by a high-risk process Test

##### This playbook addresses the following alerts:
 
- Uncommon creation or access operation of sensitive shadow copy by a high-risk process
 
##### Playbook Stages:
  
Triage: 
 
- Check if the causality process image (CGO) is signed or not
 
###### Investigation:
 
- If CGO is unsigned:
  - Check the CGO process prevalence
  - Check if the process image path is common
  - Check the CGO process hash reputation
  - Check the CGO commandline risk score
- If CGO is signed:
  - Check process image name
  - Check initiating process image name
  - Check if username is SYSTEM
  - Check if host is a server
  - Check for previous similar alert closed as False Positive
 
###### Containment:
 
- Terminate causality process (CGO) process - when a signed high-risk process or an unsigned process from an uncommon path attempting to create or access sensitive shadow copy data.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
##### New: A Successful login from TOR

This playbook is designed to handle the following alert:

- A successful login from TOR

The playbook executes the following stages:

###### Triage:

- The playbook will fetch the user identity details.

Remediation & Eradication:

- The playbooks will suggest several actions for the analyst to take: disabling the user account using Active Directory or Azure Active Directory, expiring the user password using Active Directory, or blocking traffic from TOR exit nodes using PAN-OS and Palo Alto Networks' predefined EDL.

The analyst can select multiple actions, which will then be executed by the playbook based on the analyst's choices.

Requirements: 
For any response action, you will need one of the following integrations: Azure Active Directory Users / Active Directory Users.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

<!-- ##### New: silent-User attempted to connect from a suspicious country

##### This playbook addresses the following alerts:
- User successfully connected from a suspicious country

##### Playbook Stages:

###### Triage:
- Retrieve detailed event information about the suspicious country connection attempt.

###### Investigation:
- Check source IP reputation and prevalence in the organization to determine if the IP is known malicious or rarely seen.
- Analyze user risk score and check for risky user detections in Azure AD or suspicious activity logs in Okta.
- Search for related alerts in the same case that may indicate user compromise (SSO abuse, unusual VPN connections, password reset attempts).
- Examine user agent strings for suspicious automation tools or non-standard browsers.
- Verify MFA usage during the authentication attempt by querying Azure Log Analytics or Okta System Log.
- Check for suspicious user activity patterns in authentication logs (account locks, bypass attempts, token abuse).
- Analyze connection history to determine if the country is unusual for the user or organization.

###### Containment:
- The playbook automatically clears active user sessions in Azure AD or Okta to prevent continued access from the suspicious location.
- For alerts determined to be true positives (based on evidence analysis), the playbook prompts analysts to suspend/disable the user account.
- Upon analyst approval: Suspend the user in Okta or disable the account in Azure AD.
- For unsupported authentication systems, provides manual remediation guidance including session termination, password reset, and conditional access policies.

##### Requirements:

For response actions, you need one of the following integrations:
- Okta v2 (for Okta-based authentication systems)
- Microsoft Graph User (for Azure AD-based authentication systems).<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-Suspicious LDAP search query Test

This playbook is designed to handle the following alerts: 
- Possible LDAP enumeration by unsigned process.
- Suspicious LDAP search query executed.

The playbook executes the following stages:

###### Investigation:
Check the following parameters to determine if remediation actions are needed:
- Cortex XSIAM alerts related to the hostname by MITRE tactics indicating malicious activity.
- Whether the Actor Process Command line contains suspicious arguments.
- Checks for the prevalence of the Actor Process Name.
- Host risk score is "Medium" or "High".
- User risk score is "High".

Remediation:
- Handles malicious alerts by terminating the causality process.
- Handles non-malicious alerts identified during the investigation.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
##### New: Office process creates a scheduled task via file access

This playbook handles "Office process creates a scheduled task via file access" alerts.

##### Playbook Stages:

Analysis:
During the analysis, the playbook will perform the following:

- Checks the Office file path for any suspicious locations.
- Checks the initiator process prevalence.
- Checks the initiator process reputation.
- Extracts the local path of the Office file and runs a script to calculate the Office file hash.
- Checks if the hash of the Office file identified as malicious.
- Checks if the initiator process is non-prevalent with suspicious reputation or path.

###### Investigation:
During the alert investigation, the playbook will perform the following:

- Searches for related Cortex XSIAM alerts and insights on the endpoint by specific alert names or by the following MITRE techniques to identify malicious activity: T1055 - Process Injection, T1566 - Phishing. If related alerts are found, the playbook will automatically disable the malicious scheduled task.



Remediation:

- Automatically disable the malicious scheduled task.
- Automatically terminate the causality process.
- Quarantine the Office file (requires analyst approval).
- Automatically close the alert.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

##### New: CVE-2025-49704 and CVE-2025-49706 and CVE-2025-53770 and CVE-2025-53771 - Microsoft SharePoint ToolShell vulnerability chain

CVE-2025-49706 and CVE-2025-49704 and CVE-2025-53770 and CVE-2025-53771 — Microsoft SharePoint Identity Spoofing & RCE Chain - ToolShell

---

CVE-2025-49704, CVE-2025-49706, CVE-2025-53770, and CVE-2025-53771 are a set of vulnerabilities that impact Microsoft SharePoint. CVE-2025-49704 and CVE-2025-49706, or CVE-2025-53770 and CVE-2025-53771, may be chained together, allowing unauthenticated threat actors to access functionality that is normally restricted, to run arbitrary commands on vulnerable instances of Microsoft SharePoint.

### Vulnerability Overview

* **Platform Affected**: Microsoft SharePoint Server 2016 / 2019 / Subscription Edition
* **CVE IDs**:
  * CVE-2025-49706 – Improper authentication in Microsoft Office SharePoint allows an authorized attacker to perform spoofing over a network.	
  * CVE-2025-49704 – Improper control of generation of code ('code injection') in Microsoft Office SharePoint allows an authorized attacker to execute code over a network.
  * CVE-2025-53770 – Deserialization of untrusted data in on-premises Microsoft SharePoint Server allows an unauthorized attacker to execute code over a network.	
  * CVE-2025-53771 – Improper limitation of a pathname to a restricted directory (path traversal) in Microsoft Office SharePoint allows an authorized attacker to perform spoofing over a network.	

* **CVSS Scores**: 7.1, 8.8, 9.8 ,7.1

* **Impact**:When chained together, they allow an attacker to run arbitrary commands on vulnerable instances of Microsoft SharePoint.

These flaws enable an attacker to:
- Spoof authentication
- Bypass security boundaries
- Gain remote execution


### Mitigation & Recommendations

* Apply Patches Immediately:
  * [CVE-2025-49706](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-49706)
  * [CVE-2025-49704](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-49704)
  * [CVE-2025-53770](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-53770)
  * [CVE-2025-53771](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-53771)

* Harden SharePoint diagnostic/debug endpoints
* Rotate SharePoint Server ASP.NET machine keys
* Check IIS logs for suspicious activity
* Disable/Isolate unnecessary SharePoint services or endpoints (at least until those servers are patched)

---

### References

* [CVE-2025-49706 - NVD](https://nvd.nist.gov/vuln/detail/CVE-2025-49706)
* [CVE-2025-49704 - NVD](https://nvd.nist.gov/vuln/detail/CVE-2025-49704)
* [CVE-2025-53770 - NVD](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)
* [CVE-2025-53771 - NVD](https://nvd.nist.gov/vuln/detail/CVE-2025-53771)
* [Microsoft Security Update – July 2025](https://msrc.microsoft.com/update-guide/)
* [Unit42 Blog](https://unit42.paloaltonetworks.com/microsoft-sharepoint-cve-2025-49704-cve-2025-49706-cve-2025-53770/)

---

### How to trigger the playbook

Triggered via:
- Cortex XDR alerts: `"CVE Exploitation - 685768089"` or `"CVE Exploitation - 818854253"` or `"CVE Exploitation - 903162508"`
- Manual creation of an incident with this playbook.

---

### Playbook Flow

1. Run XQL Queries to detect possible affected servers running Microsoft SharePoint.
2. Search for downloaded or created webshell files using XQL (especially for the known file name artifacts).
3. Run XQL on network events and XDR .net events to determine if there was any usage of the CVEs in the organization.
4. Check for malicious activity on the possible affected hosts for post-exploitation activities (such as running PowerShell encoded commands on the hosts) via additional alerts on the same host.
5. Retrieve IOCs from the Unit42 blog, hunt for those IOCs with XQL, and block malicious indicators.
6. Instruct the analyst on relevant response actions and mitigation steps.

---

**Note:** 
This is a beta playbook. Updates to the pack during the beta phase might include non-backward-compatible features. We appreciate your feedback on the quality and usability of the pack to help us identify issues, fix them, and continually improve.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

<!-- ##### New: silent-WmiPrvSe.exe Rare Child Command Line

##### This playbook addresses the following alerts:

* WmiPrvSe.exe Rare Child Command Line

**Playbook Stages:**

**Analysis:**

* Enrich the attacker’s IP address to identify any known malicious activity.

* Retrieve all alert-related alerts to consolidate context for further analysis.

**Investigation:**

* Analyze command-line activity to assess risks based on suspicious patterns.

* Check for high-confidence evidence, such as malicious IP addresses or suspicious command-line activity, to determine the next course of action.

* Evaluate medium-confidence detections and request analyst approval for further containment if required.

**Containment:**

* Attempt to terminate the malicious process.

* Provide guidance for manual process termination if the automated action fails.

* Propose endpoint isolation to prevent further compromise if malicious activity is confirmed.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
##### New: Unusual process accessed web browser credentials and executed by a terminal process

This playbook handles "Unusual process accessed web browser credentials and executed by a terminal process" alerts.

##### Playbook Stages:

Analysis:
During the analysis, the playbook will perform the following:

- Checks the initiator file path for any suspicious locations.
- Checks the initiator process reputation.

If the file is malicious, it proceeds to remediation actions; otherwise, it continues to the investigation phase.

###### Investigation:
During the alert investigation, the playbook will perform the following:

- Searches for related Cortex XSIAM alerts and insights on the endpoint by specific alert names or by the following MITRE technique to identify malicious activity: T1555.001 - Credentials from Password Stores: Keychain.

The playbook determines the appropriate verdict. If related alerts or insights are found, it proceeds to remediation actions; otherwise, it closes the alert with the message "No indication of malicious activity was found".

Remediation:

- Automatically terminate the causality process.
- Quarantine the initiator file if its reputation is malicious, if medium- to high-severity alerts indicating malicious activity are found, or if related insights are found and the initiator is running from a suspicious path. (This action requires analyst approval).
- Automatically Close the alert.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

##### New: Scheduled task created with HTTP or FTP reference

This playbook is designed to handle the alert "Scheduled task created with HTTP or FTP reference".

The playbook executes the following stages:

Analysis:
- Extracts the Indicators from action command line
- Checks the IP and the URL reputation.

###### Investigation:
During the alert investigation, the playbook will perform the following:
- Checks if the IP and the URL reputation is malicious.
- Checks the CGO process is unsigned.
- Searches for related alerts to determine if the creation of the scheduled task is part of an attack pattern.

Remediation:
- Remediation actions will be taken if the CGO process is unsigned, the IP or URL has a malicious reputation, or a related alert is detected. In these cases, the playbook will disable the scheduled task, block the malicious indicators, and close the alert.

Requires: To block the malicious URL, configure 'Palo Alto Networks PAN-OS' integration.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

<!-- ##### New: silent-Suspicious Hidden User Created Test

##### This playbook addresses the following alerts:

  - Suspicious Hidden User Created

  Playbook Stages:

  Triage:
  - Retrieve event information about the created user

  Investigation:
  - Check whether the user account is local or domain-based.
  - For domain users: Retrieve AD attributes, including password expiration.
  - For local users: Run a Powershell command to get "Password Expires" attribute of the local user.
  - Retrieve the risk level for the affected host.
  - Search for related Script Engine Activity alerts in the incident.
  - Check for suspicious command lines executed on the host.
  - Search for privileged group membership changes.
  - Check for authentication logs of the hidden user.
  - Monitor for suspicious share access or service installations.
  - Search for RDP sessions related to the hidden user.

  Containment:
  - For risky hosts with suspicious users that have non-expiring passwords, perform soft remediation by terminating causality processes.
  - For alerts showing clear malicious behavior patterns, perform hard remediation.
  - For alerts confirmed as true positives, ask the analyst to disable the user.
  - Upon receiving the analyst's approval, disable the suspicious user account (domain or local).
  - If a related alert about malicious activity exists, kill the Causality Group Owner (CGO) process that created the suspicious user.

  Requirements:
  For response actions, you need the following integrations:
  - Cortex Core - Investigation and Response
  - Active Directory Query v2 (for domain user actions)
  - XQL Query Engine (for enhanced investigation)
  - SlackV3 or Microsoft Teams (optional, for user verification).<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-A user deleted multiple users for the first time

##### This playbook addresses the following alerts:

- A user deleted multiple users for the first time

##### Playbook Stages:

###### Triage:

- Collect initial alert data regarding the event.
- Check the user type of the source user.
- Host enrichment. 

###### Investigation:

- Check if an admin user initiated the operation and whether the deleted users are disabled. 
- Correlate recent user activity with related security alerts.
- Assess user's and host's risk level in Cortex XDR.
- Check the type of the user target. 

Remediation:

- Evaluate investigation findings, if TP, the playbook will display the findings to an analyst for review and suggest user/host account disablement.


##### Requirements:

For response actions, you need the following integrations:

- Cortex Core - Investigation and Response
- Active Directory Query v2.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
##### New: Azure AD PIM role settings change

##### This playbook addresses the following alerts:

- Azure AD PIM role settings change

##### Playbook Stages:

###### Triage:

- Collect initial alert data regarding the Azure AD role settings modification.

###### Investigation:

- Analyze the impact of the role settings changes, categorizing them as high or moderate risk.
- Determine if the changes affect privileged roles in Azure AD.
- Correlate recent user activity with related security alerts.
- Assess the user's risk status in Azure AD and Cortex XDR.
- Evaluate the reputation of the IP address used for the changes.

###### Containment:

- Automatically revoke the user's active sessions across all applications.
- Present findings to an analyst for review and potential user account disablement.

##### Requirements:

For response actions, you need the following integrations:

- Cortex Core - Investigation and Response
- Microsoft Graph User.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

<!-- ##### New: silent-Office process creates a scheduled task via file access Test

This playbook handles "Office process creates a scheduled task via file access" alerts.

##### Playbook Stages:

Analysis:
During the analysis, the playbook will perform the following:

- Checks the Office file path for any suspicious locations.
- Checks the initiator process prevalence.
- Checks the initiator process reputation.
- Extracts the local path of the Office file and runs a script to calculate the Office file hash.
- Checks if the hash of the Office file identified as malicious.
- Checks if the initiator process is non-prevalent with suspicious reputation or path.

###### Investigation:
During the alert investigation, the playbook will perform the following:

- Searches for related Cortex XSIAM alerts and insights on the endpoint by specific alert names or by the following MITRE techniques to identify malicious activity: T1055 - Process Injection, T1566 - Phishing. If related alerts are found, the playbook will automatically disable the malicious scheduled task.



Remediation:

- Automatically disable the malicious scheduled task.
- Automatically terminate the causality process.
- Quarantine the Office file (requires analyst approval).
- Automatically close the alert.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
##### New: Suspicious Hidden User Created

##### This playbook addresses the following alerts:

  - Suspicious Hidden User Created

  Playbook Stages:

  Triage:
  - Retrieve event information about the created user

  Investigation:
  - Check whether the user account is local or domain-based.
  - For domain users: Retrieve AD attributes, including password expiration.
  - For local users: Run a Powershell command to get "Password Expires" attribute of the local user.
  - Retrieve the risk level for the affected host.
  - Search for related Script Engine Activity alerts in the incident.
  - Check for suspicious command lines executed on the host.
  - Search for privileged group membership changes.
  - Check for authentication logs of the hidden user.
  - Monitor for suspicious share access or service installations.
  - Search for RDP sessions related to the hidden user.

  Containment:
  - For risky hosts with suspicious users that have non-expiring passwords, perform soft remediation by terminating causality processes.
  - For alerts showing clear malicious behavior patterns, perform hard remediation.
  - For alerts confirmed as true positives, ask the analyst to disable the user.
  - Upon receiving the analyst's approval, disable the suspicious user account (domain or local).
  - If a related alert about malicious activity exists, kill the Causality Group Owner (CGO) process that created the suspicious user.

  Requirements:
  For response actions, you need the following integrations:
  - Cortex Core - Investigation and Response
  - Active Directory Query v2 (for domain user actions)
  - XQL Query Engine (for enhanced investigation)
  - SlackV3 or Microsoft Teams (optional, for user verification).<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

##### New: Authentication method added to an Azure account

**This playbook addresses the following alert**:
- Suspicious authentication method addition to Azure account

**Playbook Stages**:

**Triage**:
- Gather initial information about the user.

**Investigation**:
- **Check IP Reputation**:
  - Analyze the reputation of the IP address related to the alert.
- **Check for Azure Alerts**:
  - Extract recent Azure security alerts for the user.
- **Check if User is Risky**:
  - Assess the risk score of the user based on Core and Azure risk indicators.
  - Investigate reasons behind any identified risks, including recent detections.

**Containment**:
- The playbook checks If hard remediation is needed, if yes, it will check if the integration "Microsoft Graph User" is enabled, the playbook will revoke the sessions of the user and provide a manual task for an analyst to review the findings and decide the next steps.
- Possible actions:
  - Disable the user.
  - Take no action.

If the integration is not enabled, the playbook will recommend performing the same action but manually.
- The playbook will check if soft remediation is needed, If yes, continue to revoke user's active sessions to ensure immediate containment.

**Requirements**:
For the best results, it's recommended to ensure these integrations are configured and working:
- `Cortex Core - Investigation and Response` for Core user risk evaluation.
- `Azure Risky Users` for retrieving user risk scores.
- `Microsoft 365 Defender` for advanced hunting queries and Azure security alerts.
- `Microsoft Graph User` is used to disable user and revoke session.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

##### New: Exchange User Mailbox Forwarding

**This playbook addresses the following alerts**:
- Exchange user mailbox forwarding.
- Suspicious Exchange user mailbox forwarding.

**Playbook Stages**:

**Triage**:
- Collect initial information about the internal user and the associated external forwarding address.

**Investigation**:
- **Check IOCs Reputation**:
  - Analyze the reputation of IP addresses, email addresses, and domains associated with the alert.
- **Get External Email Statistics**:
  - Retrieve statistics of email interactions between the internal user and the external forwarding address over the last 2 days, including:
    - Number of emails sent to and received from the external address.
    - Number of users interacting with the external address.
- **Check if User is Risky**:
  - Assess the internal user's risk score using:
    - **Core Risk Evaluation**: Identify high-risk users and extract reasons behind elevated risk levels.
    - **Azure Risk Indicators**: Retrieve Azure risk scores, detections, and recent security alerts for the internal user.
- **Check for Azure Alerts**:
  - Perform an advanced hunting query in Microsoft 365 Defender to extract recent Azure alerts associated with the internal user.

**Containment**:
- Provide a manual task for an analyst to review the findings and determine the appropriate response.
- Possible actions:
  - Disable the user in Azure AD to prevent further unauthorized actions.
  - Disable mailbox forwarding for the user in Exchange Online.
  - Disable both user and forwarding.
  - Take no action.
- If the user is disabled, revoke active sessions to ensure immediate containment.

**Requirements**:
For the best results, it's recommended to ensure these integrations are configured and working:
- `Cortex Core - Investigation and Response` for Core user risk evaluation.
- `Azure Risky Users` for retrieving Azure-based user risk scores and detections.
- `Microsoft 365 Defender` for advanced hunting queries and extracting Azure alerts.
- `Microsoft Graph User` for disabling user accounts and revoking active sessions.
- `Exchange Online EWS` for disabling mailbox forwarding.
- `Security And Compliance V2` for fetching email interaction statistics.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

##### New: Intense SSO failures with suspicious characteristics

**This playbook addresses the following alert**:
- Intense SSO failures with suspicious characteristics.

**Playbook Stages**:

**Triage**:
- Collect additional alert data.
- Retrieve IP reputation.
- Analyze identity count and IP reputation:
  - If failures involve many users and the IP is not malicious, the alert is likely a false positive and will be closed automatically.

**Investigation**:
- Identify users with successful logins.
- Check risk indicators for affected users.
- Search for related alerts.
- Analyze authentication patterns for automation.
- Retrieve Azure and Core risk scores.
- Extract security alerts linked to affected users.
- **Check for Suspicious Evidence**, including:
  - Blocked sign-ins from a malicious IP.
  - Related security incidents and high-risk IP reputation.
  - Risk detections from Azure and Core.
  - Suspicious authentication targeting admin portals (e.g., Azure Portal, Exchange Admin, Microsoft 365 Admin).
  - The number of distinct identities involved.

**Containment**:
- **Automatic Actions**:
  - If strong indicators of compromise exist, clear active user sessions.
- **Analyst Review**:
  - Findings are presented for review.
  - **If user disablement is required**, the analyst can select users to disable in Azure AD.
  - If a user is disabled, the playbook will also **clear their active sessions**.

**Requirements**:
Ensure the following integrations are configured:
- **Microsoft Graph Identity** for Conditional Access and risk scores.
- **Microsoft Defender for Identity** for authentication analysis.
- **Core** for user risk evaluation and alert correlation.
- **Threat Intelligence Integrations** for IP reputation analysis.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

##### New: SSO Brute Force

##### This playbook addresses the following alerts:

- SSO Brute Force Threat Detected
- SSO Brute Force Activity Observed

##### Playbook Stages:

###### Triage:

- The playbook checks the IP reputation and fetches the events related to the brute force login attempts.

###### Early Containment:

- The playbook checks if the IP is suspicious. If it is, the playbook suggests blocking the IP using PAN-OS. The investigation continues in parallel to this phase.

###### Investigation:

- The playbook assesses the risk score of the user who successfully logged in after a brute force attempt, examines the legitimacy of the user agent and if the brute force attempt is likely automated based on the timestamp interval. It also verifies if the user has MFA configured when the alert source is Okta.

###### Containment:
- If there is a successful login attempt and the user's risk score is high, or if the user agent is detected as suspicious, or if the time intervals indicates that the login attempts is likely automated, the playbook clears the user's session. If the user doesn't have MFA configured, the playbook recommends expiring the user's password. If there is no successful login detected, no action is taken.


##### Requirements:

For any response action, you need one of the following integrations:

- Microsoft Graph User
- Okta v2

For eradication step, you need the following integration:

- Palo Alto Networks PAN-OS.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

##### New: External Login Password Spray

This playbook is designed to handle the following alerts:

- Successful External Login Password Spray
- External Login Password Spray on a Domain Controller
- External Login Password Spray Involving a Honey User
- Successful External Login Password Spray on a Domain Controller
- Successful External Login Password Spray on a sensitive server

The playbook is designed to investigate and respond to external login password sprays. It enriches the external IP to enable early containment, retrieves event information, and determines how the attack was carried out and whether it was successful.

##### Playbook Stages:

###### Early Containment:

- With analyst approval, the playbook will block the malicious external IP address involved in the password spray attack, limiting the attacker's ability to continue their actions.

###### Investigation:

- The playbook analyzes the timestamps of the login attempts to detect patterns, checks whether any logons were successful, and retrieves the Risk Score for users who successfully logged in as part of the attack.

###### Containment:

- Based on the user’s risk level, the playbook will expire the user’s password to prevent further unauthorized access and terminate any active RDP sessions for the affected user.

##### Requirements:

- For response actions, the following integrations are required: Active Directory (AD), PAN-OS, Core - IR.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

<!-- ##### New: silent-Member added to a Windows local security group

##### This playbook addresses the following alerts:

- User added to the Windows local Administrator group

##### Playbook Stages:

###### Triage:

- Retrieve alert extra data and set member origin as domain

###### Early Containment:

- Automatically remove the added member from the local Administrators group (soft remediation)

###### Investigation:

- Enrich subject user information from Active Directory, host (via PowerShell), or DSS (Directory Sync Service)
- Analyze subject user attributes including creation date, group memberships, risk level, and process executions
- Enrich added member information from Active Directory, host (via PowerShell), or DSS
- Analyze added member attributes including password expiration status, creation date, and risk level
- Assess host risk level
- Search for related alerts in the case indicating persistence, privilege escalation, initial access, or credential access tactics
- Evaluate evidence to determine if the activity is malicious, including:
- Whether the subject user is new and rarely adds users to groups
- Whether the subject user is an IT user based on privileged group memberships
- Whether the subject user has a high risk score
- Whether the subject user executed suspicious command-lines
- Whether the added member is new and rarely added to groups
- Whether the added member's password is set to never expire
- Whether the added member has a high risk score
- Whether the host has a high risk level

###### Containment:

- If malicious activity is detected:
- Increase alert severity to Medium
- Present analyst with remediation options:
  - Expire subject user's password and force password change on next login (for local users)
  - Disable the added member's account in Active Directory
  - Both actions
  - Skip remediation

##### Requirements:

For any response action, you need the following integrations:

- Cortex XDR - IR
- Active Directory Query v2.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-MFA was disabled for an Azure identity

**This playbook addresses the following alerts**:
- MFA was disabled for an Azure identity
- MFA was disabled for an Azure identity from a new country

**Playbook Stages**:

**Triage**:
- Gather initial information about the initiating user.
**Investigation**:
- **IP Enrichment**:
  - Analyze the reputation of the initiating user IP addresses.
- **Azure Detection Analysis**:
  - Investigate recent Azure security alerts for the initiating user to detect additional suspicious activity.
  - If any detections found, investigate the related user agent. 
- **User Risk Analysis**:
  - Assess the risk level of the initiating user based on Cortex XSIAM Core and Azure risk score.
  - Investigate reasons behind any identified risks, including recent detections.
- **Attacker Geolocation Analysis:**:
  - Investigate the initiating user connection geolocation.
- **Insights Analysis**:
  - Investigate the Cortex XSIAM insights that relate to the initiating user to detect additional suspicious activity.

**Verdict & Containment**:
- If any suspicious evidence is found during the investigation phase and the integration "Microsoft Graph User" integration is enabled, the playbook will revoke the sessions of the initiating user and the destination user. If the integration is not enabled, the playbook will recommend to perform the same action but manually.
- If any suspicious evidence found during the Azure detection analysis, Attacker geolocation analysis and Insight analysis investigations, and the integration "Microsoft Graph User" is enabled, the playbook will revoke the sessions of the initiating user and the destination user and will recommend manually to disable either one of the users or both of the users. If the integration is not enabled, the playbook will recommend to perform the same action but manually.

**Requirements:**:
- `Azure Risky Users` for retrieving user risk scores.
- `Microsoft 365 Defender` for advanced hunting queries and Azure security alerts.
- `Microsoft Graph User` for disabling accounts and revoking sessions.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
##### New: Suspicious Local Administrator Login

##### This playbook addresses the following alerts:
 
- Suspicious local administrator login
 
##### Playbook Stages:
 
###### Investigation:
 
- Retrieves the name of the process image involved in the alert.
- Checks for related Powershell/Command and Scripting/WMI alerts in the incident.
- Retrieves the host risk score.
 
###### Containment:
 
- Provide a manual task for an analyst to review the findings and decide the next steps.
- Possible actions:
 - Disable User.
 - Take no action.
 
Requirements: 

- For response actions, the following integration is required: Core - IR.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

<!-- ##### New: silent-Encoded information using windows certificate management tool

##### This playbook addresses the following alerts:

  - Encoded information using windows certificate management tool

  **Playbook Stages:**

  **Analysis:**
**Investigate potential encoding/decoding technique:**
  - Analyze command line for Encode/Decode operations
  - Extract source and destination files
  - Retrieve and analyze suspicious files
  - Check for high-risk directories usage
  - Check for suspicious file extensions
  - Detect content appended to certificates

**Investigate potential malicious activity:**
  - Check file reputation and prevalence
  - Analyze CGO reputation and signature
  - Check user risk score
  - Search for related alerts
  - Upload files to sandbox for analysis

  **Remediation:**
  - Terminate CGO process
  - Add hash to blocklist
  - Quarantine malicious files
  - Isolate the endpoint (requires analyst approval).<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-SaaS File External Access

### This playbook addresses the following alert:
- External user accessed a sensitive SaaS file via anonymous link.

### Playbook Stages:

#### Triage:
- Retrieve past **file activities**.
- Gather the **users** involved in the SaaS file (e.g., owner, sharer, actor).
- Get **any anomalies** related to the alert.

#### Investigation:
- Analyze the **IP/domain/email** reputation.
- Assess the user's **risk level** in Cortex.
- Verify that the sharing link has not been forgotten.
- Determine if the user account has been **disabled or deleted**.
- Look for the sharer user's anonymous link creation count.
- Search for medium or high **Azure Risk Detections and Defender Alerts** (*SharePoint/OneDrive only*).
- Check for anomalies in **User Agent, ASN, and Geo-location** (*SharePoint/OneDrive only*).
- Check the actor user's frequency of accessing various external files (*Drive only*).

#### Verdict:
- If there are at least *2 pieces of LOW* evidence.
- **OR** if there is at least *1 piece of HIGH* evidence.

#### Remediation:
- *Immediately* delete anonymous links from the file.
- Delete all file permissions (*approval needed*).
- Notify the owner and/or their manager (*approval needed*).

### Requirements:

#### Triage:
- `Microsoft Graph Files`/`Google Drive` for retrieving **File Activities**.

#### Investigation:
- `Azure Risky Users` or `MSGraph Identity and Access` for retrieving **Azure Risk Detections**.
- `Microsoft 365 Defender` for retrieving **Defender Alerts**.
- `Microsoft Graph User`/`GSuite Admin` for retrieving user properties.
- `XQL Query Engine` to count past events.

#### Remediation:
- `Microsoft Graph Files`/`Google Drive` for removing permissions.
- `Mail Sender` or a similar intergration (e.g., Gmail, EWS) for notifying.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-CVE-2025-31324 - SAP NetWeaver Visual Composer

CVE-2025-31324 is a critical zero-day vulnerability affecting the Metadata Uploader component of SAP NetWeaver Visual Composer. The vulnerability arises from missing authorization checks, allowing unauthenticated attackers to upload malicious executable binaries. Exploitation of this flaw can lead to full remote code execution (RCE) on affected systems, posing a significant risk to confidentiality, integrity, and availability.

## CVE-2025-31324 - SAP NetWeaver RCE Vulnerability

## Vulnerability Overview

- **Component Affected**: SAP NetWeaver Visual Composer Metadata Uploader 
- **Endpoint**: `/developmentserver/metadatauploader` 
- **CVE ID**: CVE-2025-31324 
- **CVSS Score**: 10.0 (Critical) 
- **Exploitability**: Unauthenticated remote attackers can exploit this without user interaction 

This flaw allows unauthenticated attackers to upload arbitrary files (e.g., JSP web shells), enabling remote code execution with the same privileges as the SAP application server process. 
[Source: Unit42 - Palo Alto Networks](https://unit42.paloaltonetworks.com/threat-brief-sap-netweaver-cve-2025-31324/)


## Mitigation and Recommendations

- **Apply Patch**: SAP Note #3594142 (released April 24, 2025) 
- **Disable Visual Composer** if not in use 
- **Restrict Access** to the vulnerable endpoint 
- **Monitor for IoCs** in `/irj/servlet_jsp/irj/root/` and suspicious traffic 

## Conclusion

CVE-2025-31324 is actively exploited and is critically severe. Organizations should patch immediately, monitor for compromise, and disable or restrict vulnerable components.

[View official CVE details on NIST](https://nvd.nist.gov/vuln/detail/CVE-2025-31324)

## Playbook Triggers
- Manually
- "CVE Exploitation - 986328356" Agent rule

## Playbook Flow
1. Using XQL, identify potential SAP NetWeaver instances in your environment.
2. Using XQL, check if there are events that point to any potential webshells downloaded in the directories.
3. Directory enumeration to identify if there are already any suspicious files that might indicate a webshell.
4. *Collect* IOCs from a Unit42 blog, *search* them using the "Threat Hunting - Generic" playbook (supports Palo Alto networks products, Qradar, and Splunk), and *block* those indicators using the "Containment Plan - Block Indicators" playbook.
5. Provides Mitigation recommendations.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
<!-- ##### New: silent-SPNs cleared from a machine account

##### This playbook addresses the following alerts:

- SPNs cleared from a machine account
- SPNs cleared from a machine account for the first time

##### Playbook Stages:

###### Triage:

- Retrieve additional data about the Account Changed event, including the Machine Account whose SPNs were cleared and the number of times the user cleared SPNs in the last 30 days.
###### Investigation:

- Search for creation of suspicious account on the Domain Controller.
- Search for suspicious TGT/Service ticket requests.
- Search for user insights associated with malicious tools related to Kerberos ticket manipulation.
- Search for suspicious account renames, particularly to mimic DC name.
- Search for additional alerts in the incident that could indicate attempts to find controlled accounts or create accounts.

###### Containment:

- For alerts determined to be true positives, prompt the analyst to decide whether to disable the user account.
- Upon analyst approval: Disable the suspicious user account in Active Directory.

##### Requirements:

For response actions, you need the following integrations:

- Active Directory Query v2.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>

 -->
- Documentation and metadata improvements.
##### New: SPNs cleared from a machine account

##### This playbook addresses the following alerts:

- SPNs cleared from a machine account
- SPNs cleared from a machine account for the first time

##### Playbook Stages:

###### Triage:

- Retrieve additional data about the Account Changed event, including the Machine Account whose SPNs were cleared and the number of times the user cleared SPNs in the last 30 days.
###### Investigation:

- Search for creation of suspicious account on the Domain Controller.
- Search for suspicious TGT/Service ticket requests.
- Search for user insights associated with malicious tools related to Kerberos ticket manipulation.
- Search for suspicious account renames, particularly to mimic DC name.
- Search for additional alerts in the incident that could indicate attempts to find controlled accounts or create accounts.

###### Containment:

- For alerts determined to be true positives, prompt the analyst to decide whether to disable the user account.
- Upon analyst approval: Disable the suspicious user account in Active Directory.

##### Requirements:

For response actions, you need the following integrations:

- Active Directory Query v2.<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>


#### Triggers Recommendations

##### New: silent-Endpoint initiated uncommon remote scheduled task creation Test

- New: Added a new triggers recommendation- silent-Endpoint initiated uncommon remote scheduled task creation Test that This trigger is responsible for handling 'Uncommon remote scheduled task creation' alerts
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Successful guest user invitation Test

- New: Added a new triggers recommendation- silent-Successful guest user invitation Test that This trigger is responsible for handling Valid Accounts alerts related to successful guest user invitations.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-A user created a pfx in a suspicious folder for the first time

- New: Added a new triggers recommendation- silent-A user created a pfx in a suspicious folder for the first time that This trigger is responsible for handling alerts where a user created a pfx in a suspicious folder for the first time.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Execution of significantly renamed lolbin

- New: Added a new triggers recommendation- silent-Execution of significantly renamed lolbin that This trigger is responsible for handling the 'Execution of significantly renamed lolbin' alerts
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: Exchange forwarding rule configured

- New: Added a new triggers recommendation- Exchange forwarding rule configured that This trigger runs the Exchange forwarding rule alerts playbook, which handles the External Exchange inbox forwarding rule configured, Suspicious Exchange inbox forwarding rule configured and Suspicious Exchange email-hiding inbox rule alerts.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-User attempted to connect from a suspicious country

- New: Added a new triggers recommendation- silent-User attempted to connect from a suspicious country that This trigger is responsible for handling alerts where a user attempted to connect from a suspicious country.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Azure AD PIM role settings change

- New: Added a new triggers recommendation- silent-Azure AD PIM role settings change that This trigger is responsible for handling alerts where role settings inside Azure AD Privileged Identity Management (PIM) have been changed.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: Exchange User Mailbox Forwarding

- New: Added a new triggers recommendation- Exchange User Mailbox Forwarding that This trigger is responsible for handling Exchange User Mailbox Forwarding alerts.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Scheduled task created with HTTP or FTP reference Test

- New: Added a new triggers recommendation- silent-Scheduled task created with HTTP or FTP reference Test that This trigger is responsible for handling 'Scheduled task created with HTTP or FTP reference' alert
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: A user executed multiple LDAP enumeration queries

- New: Added a new triggers recommendation- A user executed multiple LDAP enumeration queries that This trigger is responsible for handling alerts where a user executes suspicious LDAP enumeration queries.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Suspicious certutil command line Test

- New: Added a new triggers recommendation- silent-Suspicious certutil command line Test that This trigger is responsible for handling 'Suspicious certutil command line' alerts
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Suspicious process spawns MSBuild

- New: Added a new triggers recommendation- silent-Suspicious process spawns MSBuild that This trigger is responsible for handling the 'Suspicious process spawns MSBuild.exe' alerts via the 'Suspicious process spawns MSBuild' playbook
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: Suspicious process execution by scheduled task on a sensitive server

- New: Added a new triggers recommendation- Suspicious process execution by scheduled task on a sensitive server that This trigger is responsible for handling 'Suspicious process execution by scheduled task on a sensitive server' alert
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: Suspicious Conditional Access operation for an identity

- New: Added a new triggers recommendation- Suspicious Conditional Access operation for an identity that This trigger runs the Suspicious Conditional Access operation for an identity playbook, which handles the Suspicious Conditional Access operation for an identity alert.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Remote WMI Process Execution Test

- New: Added a new triggers recommendation- silent-Remote WMI Process Execution Test that This trigger is responsible for handling Remote WMI Process Execution alerts
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-A user executed multiple LDAP enumeration queries Test

- New: Added a new triggers recommendation- silent-A user executed multiple LDAP enumeration queries Test that This trigger is responsible for handling alerts where a user executes suspicious LDAP enumeration queries.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Azure AD account unlock or password reset Test

- New: Added a new triggers recommendation- silent-Azure AD account unlock or password reset Test that This trigger is responsible for handling the 'Azure AD account unlock/successful password reset' alert
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Azure AD Administrator Role Assignment

- New: Added a new triggers recommendation- silent-Azure AD Administrator Role Assignment that This trigger is responsible for handling the 'Azure AD Administrator Role Assignment' alert
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: Credential Dumping using a known tool

- New: Added a new triggers recommendation- Credential Dumping using a known tool that This trigger is responsible for handling the 'Credential Dumping using a known tool' alerts
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Alert Trigger - Suspicious Hidden User Created Test

- New: Added a new triggers recommendation- silent-Alert Trigger - Suspicious Hidden User Created Test that This trigger is responsible for handling alerts where a suspicious hidden user is created.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Uncommon remote scheduled task created Test

- New: Added a new triggers recommendation- silent-Uncommon remote scheduled task created Test that This trigger is responsible for handling 'Uncommon remote scheduled task created
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: SPNs cleared from a machine account

- New: Added a new triggers recommendation- SPNs cleared from a machine account that This trigger is responsible for handling alerts where the Service Principal Names (SPNs) are cleared from a domain machine account.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: A mail forwarding rule was configured in Google Workspace

- New: Added a new triggers recommendation- A mail forwarding rule was configured in Google Workspace that This trigger runs the A mail forwarding rule was configured in Google Workspace playbook, which handles the A mail forwarding rule was configured in Google Workspace and A mail forwarding rule was configured in Google Workspace to an uncommon domain alerts.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: MFA was disabled for an Azure identity

- New: Added a new triggers recommendation- MFA was disabled for an Azure identity that This trigger runs the A MFA was disabled for an Azure identity playbook, which handles the 'MFA was disabled for an Azure identity' and 'MFA was disabled for an Azure identity from a new country' alerts.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Member added to a Windows local security group

- New: Added a new triggers recommendation- silent-Member added to a Windows local security group that This trigger is responsible for handling alerts where a user was added to the Windows local Administrator group.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: SSO Brute Force

- New: Added a new triggers recommendation- SSO Brute Force that This trigger is responsible for handling the 'SSO Brute Force Threat Detected' and 'SSO Brute Force Activity Observed' alerts
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-AppleScript Process Executed With Rare Command Line Test

- New: Added a new triggers recommendation- silent-AppleScript Process Executed With Rare Command Line Test that This trigger is responsible for handling several the 'AppleScript Process Executed With Rare Command Line' alerts
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: CVE-2025-49704 and CVE-2025-49706 and CVE-2025-53770 and CVE-2025-53771 - Microsoft SharePoint ToolShell vulnerability chain

- New: Added a new triggers recommendation- CVE-2025-49704 and CVE-2025-49706 and CVE-2025-53770 and CVE-2025-53771 - Microsoft SharePoint ToolShell vulnerability chain that This trigger is responsible for handling the 'CVE Exploitation - 685768089' , 'CVE Exploitation - 818854253', and 'CVE Exploitation - 903162508' alerts alerts.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-WmiPrvSe.exe Rare Child Command Line

- New: Added a new triggers recommendation- silent-WmiPrvSe.exe Rare Child Command Line that This trigger is responsible for handling WmiPrvSe.exe Rare Child Command Line alerts
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: Alert Trigger - Suspicious Hidden User Created

- New: Added a new triggers recommendation- Alert Trigger - Suspicious Hidden User Created that This trigger is responsible for handling alerts where a suspicious hidden user is created.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Unusual process accessed web browser credentials and executed by a terminal process Test

- New: Added a new triggers recommendation- silent-Unusual process accessed web browser credentials and executed by a terminal process Test that This trigger is responsible for handling 'Unusual process accessed web browser credentials and executed by a terminal process' alerts
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-User moved Exchange sent messages to deleted items

- New: Added a new triggers recommendation- silent-User moved Exchange sent messages to deleted items that This trigger is responsible for handling alerts where sensitive Exchange emails were deleted from the Sent Items folder from an unusual source.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: Suspicious execution from tmp folder

- New: Added a new triggers recommendation- Suspicious execution from tmp folder that This trigger is responsible for handling the 'Suspicious interactive execution of a binary from the tmp folder', 'Suspicious cron job task execution of a binary from the tmp folder' and 'A web server process executed an unpopular application from the tmp folder' alerts via the 'Suspicious execution from tmp folder' playbook
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-MFA was disabled for an Azure identity

- New: Added a new triggers recommendation- silent-MFA was disabled for an Azure identity that This trigger runs the A MFA was disabled for an Azure identity playbook, which handles the 'MFA was disabled for an Azure identity' and 'MFA was disabled for an Azure identity from a new country' alerts.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Compromise Accounts - User has rejected numerous SSO MFA attempts Test

- New: Added a new triggers recommendation- silent-Compromise Accounts - User has rejected numerous SSO MFA attempts Test that This trigger is responsible for handling Compromise Accounts alerts where user rejected MFA attempts.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Suspicious local administrator login Test

- New: Added a new triggers recommendation- silent-Suspicious local administrator login Test that This trigger is responsible for handling alerts for Suspicious local administrator login.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-CVE-2025-59287 - Microsoft WSUS Remote Code Execution

- New: Added a new triggers recommendation- silent-CVE-2025-59287 - Microsoft WSUS Remote Code Execution that This trigger runs the SAP NetWeaver Visual Composer playbook for 'CVE Exploitation - 2037164431' and 'CVE Exploitation - 3823999562' alerts
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Office process creates a scheduled task via file access Test

- New: Added a new triggers recommendation- silent-Office process creates a scheduled task via file access Test that This trigger is responsible for handling 'Office process creates a scheduled task via file access' alerts
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-A mail forwarding rule was configured in Google Workspace Test

- New: Added a new triggers recommendation- silent-A mail forwarding rule was configured in Google Workspace Test that This trigger runs the Suspicious Conditional Access operation for an identity playbook, which handles the Suspicious Conditional Access operation for an identity alert.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-SaaS File External Access

- New: Added a new triggers recommendation- silent-SaaS File External Access that This trigger is responsible for handling the 'External user accessed a sensitive SaaS file via anonymous link' alert
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-CVE-2025-31324 - SAP NetWeaver Visual Composer

- New: Added a new triggers recommendation- silent-CVE-2025-31324 - SAP NetWeaver Visual Composer that This trigger runs the SAP NetWeaver Visual Composer playbook for 'CVE Exploitation - 986328356' alerts.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: Unsigned and unpopular process performed an injection

- New: Added a new triggers recommendation- Unsigned and unpopular process performed an injection that This trigger is responsible for handling several the 'Unsigned and unpopular process performed an injection' alerts
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Exchange User Mailbox Forwarding Test

- New: Added a new triggers recommendation- silent-Exchange User Mailbox Forwarding Test that This trigger is responsible for handling Exchange User Mailbox Forwarding alerts.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Suspicious LDAP search query Test

- New: Added a new triggers recommendation- silent-Suspicious LDAP search query Test that This trigger is responsible for handling the 'Suspicious LDAP search query executed' and 'Possible LDAP enumeration by unsigned process' alerts via the 'Suspicious LDAP search query' playbook
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: A user deleted multiple users for the first time

- New: Added a new triggers recommendation- A user deleted multiple users for the first time that This trigger is responsible for handling A user deleted multiple users for the first time alert.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: Suspicious SaaS Access From a TOR Exit Node

- New: Added a new triggers recommendation- Suspicious SaaS Access From a TOR Exit Node that This trigger is responsible for handling Suspicious SaaS Access From a TOR Exit Node
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: Compromise Accounts - User has rejected numerous SSO MFA attempts

- New: Added a new triggers recommendation- Compromise Accounts - User has rejected numerous SSO MFA attempts that This trigger is responsible for handling Compromise Accounts alerts where user rejected MFA attempts.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Suspicious process execution by scheduled task on a sensitive server Test

- New: Added a new triggers recommendation- silent-Suspicious process execution by scheduled task on a sensitive server Test that This trigger is responsible for handling 'Suspicious process execution by scheduled task on a sensitive server' alert
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: Successful guest user invitation

- New: Added a new triggers recommendation- Successful guest user invitation that This trigger is responsible for handling Valid Accounts alerts related to successful guest user invitations.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-First seen Azure admin consent to an application

- New: Added a new triggers recommendation- silent-First seen Azure admin consent to an application that This trigger runs the 'First seen Azure admin consent to an application' playbook, which handles the 'First seen Azure admin consent to an application' alert.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: Azure AD PIM role settings change

- New: Added a new triggers recommendation- Azure AD PIM role settings change that This trigger is responsible for handling alerts where role settings inside Azure AD Privileged Identity Management (PIM) have been changed.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Regsvr32 may have run code from an untrusted source

- New: Added a new triggers recommendation- silent-Regsvr32 may have run code from an untrusted source that This trigger is responsible for handling the 'Regsvr32 may have run code from an untrusted source' alert
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Multiple discovery commands on a Windows host

- New: Added a new triggers recommendation- silent-Multiple discovery commands on a Windows host that This trigger is responsible for handling the following alerts:'Multiple discovery commands on a Windows host by the same process','Remote Multiple discovery commands on a Windows host by the same IP','Multiple discovery commands on a Windows host by the same process from a web server CGO','Multiple discovery commands on a Windows host by the same process from an SQL server CGO','Multiple discovery commands on a Windows host by the same process from a remote CGO','Rare Multiple discovery commands on a Windows host by the same process'
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: SSO Authentication With Suspicious Characteristics

- New: Added a new triggers recommendation- SSO Authentication With Suspicious Characteristics that This trigger is responsible for handling SSO Authentication With Suspicious Characteristics alerts
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: Suspicious local administrator login

- New: Added a new triggers recommendation- Suspicious local administrator login that This trigger is responsible for handling alerts for Suspicious local administrator login.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: Unprivileged process opened a registry hive

- New: Added a new triggers recommendation- Unprivileged process opened a registry hive that This trigger is responsible for handling the 'Unprivileged process opened a registry hive' alert
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Excessive User Account Lockouts Test

- New: Added a new triggers recommendation- silent-Excessive User Account Lockouts Test that This trigger is responsible for handling excessive user account lockouts.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: Msiexec execution of an executable from an uncommon remote location

- New: Added a new triggers recommendation- Msiexec execution of an executable from an uncommon remote location that This trigger is responsible for handling the 'Msiexec execution of an executable from an uncommon remote location with a specific port' and 'Msiexec execution of an executable from an uncommon remote location without properties' alerts via the 'Msiexec_execution_of_an_executable_from_an_uncommon_remote_location' playbook
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Unsigned and unpopular process performed an injection Test

- New: Added a new triggers recommendation- silent-Unsigned and unpopular process performed an injection Test that This trigger is responsible for handling several the 'Unsigned and unpopular process performed an injection' alerts
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-A remote service with an uncommon name was created via RPC over SMB

- New: Added a new triggers recommendation- silent-A remote service with an uncommon name was created via RPC over SMB that This trigger is responsible for handling the 'A remote service with an uncommon name was created via RPC over SMB' alert
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Netcat Makes or Gets Connections Test

- New: Added a new triggers recommendation- silent-Netcat Makes or Gets Connections Test that This trigger is responsible for handling `Netcat Makes or Gets Connections` alert
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-External Login Password Spray Test

- New: Added a new triggers recommendation- silent-External Login Password Spray Test that This trigger is responsible for handling External Login Password Spray attacks.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Suspicious execution from tmp folder Test

- New: Added a new triggers recommendation- silent-Suspicious execution from tmp folder Test that This trigger is responsible for handling the 'Suspicious interactive execution of a binary from the tmp folder', 'Suspicious cron job task execution of a binary from the tmp folder' and 'A web server process executed an unpopular application from the tmp folder' alerts via the 'Suspicious execution from tmp folder' playbook
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: Event Log Was Cleared

- New: Added a new triggers recommendation- Event Log Was Cleared that This trigger is responsible for handling the 'Windows Event Log Was Cleared' alerts
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Rundll32.exe executes a rare unsigned module

- New: Added a new triggers recommendation- silent-Rundll32.exe executes a rare unsigned module that This trigger runs the silent-Rundll32.exe executes a rare unsigned module playbok
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Exchange forwarding rule configured Test

- New: Added a new triggers recommendation- silent-Exchange forwarding rule configured Test that This trigger runs the Exchange forwarding rule alerts playbook, which handles the External Exchange inbox forwarding rule configured, Suspicious Exchange inbox forwarding rule configured and Suspicious Exchange email-hiding inbox rule alerts.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: Office process creates a scheduled task via file access

- New: Added a new triggers recommendation- Office process creates a scheduled task via file access that This trigger is responsible for handling 'Office process creates a scheduled task via file access' alerts
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Alert Trigger - Suspicious Hidden User Created

- New: Added a new triggers recommendation- silent-Alert Trigger - Suspicious Hidden User Created that This trigger is responsible for handling alerts where a suspicious hidden user is created.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Suspicious local user account creation

- New: Added a new triggers recommendation- silent-Suspicious local user account creation that This trigger is responsible for handling alerts where a suspicious local user account is created.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: A successful SSO sign-in from TOR

- New: Added a new triggers recommendation- A successful SSO sign-in from TOR that This trigger is responsible for handling the 'A successful SSO sign-in from TOR' and the 'A successful SSO sign-in from TOR via a mobile device' alerts
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: Endpoint initiated uncommon remote scheduled task creation

- New: Added a new triggers recommendation- Endpoint initiated uncommon remote scheduled task creation that This trigger is responsible for handling 'Uncommon remote scheduled task creation' alerts
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: SSO Password Spray

- New: Added a new triggers recommendation- SSO Password Spray that This trigger is responsible for handling SSO Password Spray alerts
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-User added to local administrator group using a PowerShell command Test

- New: Added a new triggers recommendation- silent-User added to local administrator group using a PowerShell command Test that This trigger is responsible for handling 'User added to local administrator group using a PowerShell command' alert
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Recurring rare domain access from an unsigned process

- New: Added a new triggers recommendation- silent-Recurring rare domain access from an unsigned process that This trigger is responsible for handling Recurring rare domain access from an unsigned process alerts.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Credential Dumping using a known tool Test

- New: Added a new triggers recommendation- silent-Credential Dumping using a known tool Test that This trigger is responsible for handling the 'Credential Dumping using a known tool' alerts
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Execution of an uncommon process at an early startup stage by Windows system binary

- New: Added a new triggers recommendation- silent-Execution of an uncommon process at an early startup stage by Windows system binary that This trigger is responsible for handling the 'Execution of an uncommon process at an early startup stage by Windows system binary with suspicious characteristics' and the 'Execution of an uncommon process with a local/domain user SID at an early startup stage with a suspicious characteristics by Windows system binary' alerts
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-SSO Authentication With Suspicious Characteristics Test

- New: Added a new triggers recommendation- silent-SSO Authentication With Suspicious Characteristics Test that This trigger is responsible for handling SSO Authentication With Suspicious Characteristics alerts
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Encoded information using Windows certificate management tool

- New: Added a new triggers recommendation- silent-Encoded information using Windows certificate management tool that This trigger is responsible for handling the 'Encoded information using Windows certificate management tool' alerts via the 'Encoded information using Windows certificate management tool' playbook
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Unprivileged process opened a registry hive Test

- New: Added a new triggers recommendation- silent-Unprivileged process opened a registry hive Test that This trigger is responsible for handling the 'Unprivileged process opened a registry hive' alert
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-First Azure AD PowerShell operation for a user

- New: Added a new triggers recommendation- silent-First Azure AD PowerShell operation for a user that This trigger is responsible for handling the 'First Azure AD PowerShell operation for a user' alert
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Event Log Was Cleared Test

- New: Added a new triggers recommendation- silent-Event Log Was Cleared Test that This trigger is responsible for handling the 'Windows Event Log Was Cleared' alerts
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-SSO Brute Force Activity Test

- New: Added a new triggers recommendation- silent-SSO Brute Force Activity Test that This trigger is responsible for handling the 'SSO Brute Force Threat Detected' and 'SSO Brute Force Activity Observed' alerts
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: Azure Temporary Access Pass (TAP) registered to an account

- New: Added a new triggers recommendation- Azure Temporary Access Pass (TAP) registered to an account that This trigger is responsible for handling Abnormal Azure Temporary Access Pass (TAP) account registration alerts.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-A successful SSO sign-in from TOR Test

- New: Added a new triggers recommendation- silent-A successful SSO sign-in from TOR Test that This trigger is responsible for handling the 'A successful SSO sign-in from TOR' and the 'A successful SSO sign-in from TOR via a mobile device' alerts
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Suspicious Powershell Command Execution

- New: Added a new triggers recommendation- silent-Suspicious Powershell Command Execution that This trigger is responsible for handling the following alerts 'PowerShell runs suspicious base64-encoded commands','PowerShell suspicious flags','Reverse shell using PowerShell','PowerShell downloads files via BITS' alerts
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-NTDS.dit file written by an uncommon executable

- New: Added a new triggers recommendation- silent-NTDS.dit file written by an uncommon executable that This trigger is responsible for handling the 'NTDS.dit file written by an uncommon executable' alerts
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Suspicious User access to multiple resources via SSO

- New: Added a new triggers recommendation- silent-Suspicious User access to multiple resources via SSO that This trigger is responsible for handling Valid Accounts alerts related to suspicious user access to multiple resources via SSO.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Process attempts to kill a known security or AV tool

- New: Added a new triggers recommendation- silent-Process attempts to kill a known security or AV tool that This trigger is responsible for handling the 'Process attempts to kill a known security/AV tool' alert
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Suspicious dump of ntds.dit using Shadow Copy with ntdsutil or vssadmin

- New: Added a new triggers recommendation- silent-Suspicious dump of ntds.dit using Shadow Copy with ntdsutil or vssadmin that This trigger is responsible for handling the 'NTDS.dit file written by an uncommon executable' alerts
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: External Login Password Spray

- New: Added a new triggers recommendation- External Login Password Spray that This trigger is responsible for handling External Login Password Spray attacks.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Execution of an uncommon process at an early startup stage

- New: Added a new triggers recommendation- silent-Execution of an uncommon process at an early startup stage that This trigger is responsible for handling the 'Execution of an uncommon process at an early startup stage with suspicious characteristics' and the 'Execution of an uncommon process with a local/domain user SID at an early startup stage with suspicious characteristics' alerts
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Msiexec execution of an executable from an uncommon remote location Test

- New: Added a new triggers recommendation- silent-Msiexec execution of an executable from an uncommon remote location Test that This trigger is responsible for handling the 'Msiexec execution of an executable from an uncommon remote location with a specific port' and 'Msiexec execution of an executable from an uncommon remote location without properties' alerts via the 'Msiexec_execution_of_an_executable_from_an_uncommon_remote_location' playbook
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: Excessive User Account Lockouts

- New: Added a new triggers recommendation- Excessive User Account Lockouts that This trigger is responsible for handling excessive user account lockouts.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Impossible Traveler SSO

- New: Added a new triggers recommendation- silent-Impossible Traveler SSO that This trigger is responsible for handling the 'Impossible traveler - SSO' alert
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: Intense SSO failures with suspicious characteristics

- New: Added a new triggers recommendation- Intense SSO failures with suspicious characteristics that This trigger is responsible for handling the 'Intense SSO failures with suspicious characteristics' alert
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-SSO Password Spray Test

- New: Added a new triggers recommendation- silent-SSO Password Spray Test that This trigger is responsible for handling SSO Password Spray alerts
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: User added to local administrator group using a PowerShell command

- New: Added a new triggers recommendation- User added to local administrator group using a PowerShell command that This trigger is responsible for handling 'User added to local administrator group using a PowerShell command' alert
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Uncommon creation or access operation of sensitive shadow copy by a high-risk process Test

- New: Added a new triggers recommendation- silent-Uncommon creation or access operation of sensitive shadow copy by a high-risk process Test that This trigger is responsible for handling 'Uncommon creation or access operation of sensitive shadow copy by a high-risk process
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: Uncommon remote scheduled task created

- New: Added a new triggers recommendation- Uncommon remote scheduled task created that This trigger is responsible for handling 'Uncommon remote scheduled task created
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: AppleScript Process Executed With Rare Command Line

- New: Added a new triggers recommendation- AppleScript Process Executed With Rare Command Line that This trigger is responsible for handling several the 'AppleScript Process Executed With Rare Command Line' alerts
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-A Successful login from TOR Test

- New: Added a new triggers recommendation- silent-A Successful login from TOR Test that This trigger is responsible for handling the 'A Successful login from TOR' alert
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Windows LOLBIN scripting engine connected to a rare external host

- New: Added a new triggers recommendation- silent-Windows LOLBIN scripting engine connected to a rare external host that This trigger is responsible for handling the 'Windows LOLBIN scripting engine connected to a rare external host' alert
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Azure Temporary Access Pass (TAP) registered to an account

- New: Added a new triggers recommendation- silent-Azure Temporary Access Pass (TAP) registered to an account that This trigger is responsible for handling Abnormal Azure Temporary Access Pass (TAP) account registration alerts.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-SPNs cleared from a machine account

- New: Added a new triggers recommendation- silent-SPNs cleared from a machine account that This trigger is responsible for handling alerts where the Service Principal Names (SPNs) are cleared from a domain machine account.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: Suspicious LDAP search query

- New: Added a new triggers recommendation- Suspicious LDAP search query that This trigger is responsible for handling the 'Suspicious LDAP search query executed' and 'Possible LDAP enumeration by unsigned process' alerts via the 'Suspicious LDAP search query' playbook
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: Uncommon execution of ODBCConf

- New: Added a new triggers recommendation- Uncommon execution of ODBCConf that This trigger is responsible for handling 'Uncommon execution of ODBCConf' alerts.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Uncommon execution of ODBCConf Test

- New: Added a new triggers recommendation- silent-Uncommon execution of ODBCConf Test that This trigger is responsible for handling 'Uncommon execution of ODBCConf' alerts.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: First Azure AD PowerShell operation for a user

- New: Added a new triggers recommendation- First Azure AD PowerShell operation for a user that This trigger is responsible for handling the 'First Azure AD PowerShell operation for a user' alert
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: Script file added to startup-related Registry keys

- New: Added a new triggers recommendation- Script file added to startup-related Registry keys that This trigger is responsible for handling the 'Script file added to startup-related Registry keys' alerts
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: Scheduled task created with HTTP or FTP reference

- New: Added a new triggers recommendation- Scheduled task created with HTTP or FTP reference that This trigger is responsible for handling 'Scheduled task created with HTTP or FTP reference' alert
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Authentication method added to an Azure account

- New: Added a new triggers recommendation- silent-Authentication method added to an Azure account that This trigger is responsible for handling the 'Suspicious authentication method addition to Azure account' alert
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: Azure AD account unlock or password reset

- New: Added a new triggers recommendation- Azure AD account unlock or password reset that This trigger is responsible for handling the 'Azure AD account unlock/successful password reset' alert
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Intense SSO failures with suspicious characteristics

- New: Added a new triggers recommendation- silent-Intense SSO failures with suspicious characteristics that This trigger is responsible for handling the 'Intense SSO failures with suspicious characteristics' alert
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: CVE-2025-31324 - SAP NetWeaver Visual Composer

- New: Added a new triggers recommendation- CVE-2025-31324 - SAP NetWeaver Visual Composer that This trigger runs the SAP NetWeaver Visual Composer playbook for 'CVE Exploitation - 986328356' alerts.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-A user deleted multiple users for the first time

- New: Added a new triggers recommendation- silent-A user deleted multiple users for the first time that This trigger is responsible for handling A user deleted multiple users for the first time alert.
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: Unusual process accessed web browser credentials and executed by a terminal process

- New: Added a new triggers recommendation- Unusual process accessed web browser credentials and executed by a terminal process that This trigger is responsible for handling 'Unusual process accessed web browser credentials and executed by a terminal process' alerts
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: Authentication method added to an Azure account

- New: Added a new triggers recommendation- Authentication method added to an Azure account that This trigger is responsible for handling the 'Suspicious authentication method addition to Azure account' alert
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: SSO Brute Force Activity

- New: Added a new triggers recommendation- SSO Brute Force Activity that This trigger is responsible for handling the 'SSO Brute Force Threat Detected' and 'SSO Brute Force Activity Observed' alerts
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: A Successful login from TOR

- New: Added a new triggers recommendation- A Successful login from TOR that This trigger is responsible for handling the 'A Successful login from TOR' alert
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Script file added to startup-related Registry keys

- New: Added a new triggers recommendation- silent-Script file added to startup-related Registry keys that This trigger is responsible for handling the 'Script file added to startup-related Registry keys' alerts
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: Execution of an uncommon process at an early startup stage

- New: Added a new triggers recommendation- Execution of an uncommon process at an early startup stage that This trigger is responsible for handling the 'Execution of an uncommon process at an early startup stage with suspicious characteristics' and the 'Execution of an uncommon process with a local/domain user SID at an early startup stage with suspicious characteristics' alerts
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: Uncommon creation or access operation of sensitive shadow copy by a high-risk process

- New: Added a new triggers recommendation- Uncommon creation or access operation of sensitive shadow copy by a high-risk process that This trigger is responsible for handling 'Uncommon creation or access operation of sensitive shadow copy by a high-risk process
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: CVE-2025-59287 - Microsoft WSUS Remote Code Execution

- New: Added a new triggers recommendation- CVE-2025-59287 - Microsoft WSUS Remote Code Execution that This trigger runs the SAP NetWeaver Visual Composer playbook for 'CVE Exploitation - 2037164431' and 'CVE Exploitation - 3823999562' alerts
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Suspicious SaaS Access From a TOR Exit Node Test

- New: Added a new triggers recommendation- silent-Suspicious SaaS Access From a TOR Exit Node Test that This trigger is responsible for handling Suspicious SaaS Access From a TOR Exit Node
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: Netcat Makes or Gets Connections

- New: Added a new triggers recommendation- Netcat Makes or Gets Connections that This trigger is responsible for handling `Netcat Makes or Gets Connections` alert
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: Suspicious certutil command line

- New: Added a new triggers recommendation- Suspicious certutil command line that This trigger is responsible for handling 'Suspicious certutil command line' alerts
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: Remote WMI Process Execution

- New: Added a new triggers recommendation- Remote WMI Process Execution that This trigger is responsible for handling Remote WMI Process Execution alerts
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
##### New: silent-Suspicious Port Scan

- New: Added a new triggers recommendation- silent-Suspicious Port Scan that This trigger is responsible for handling the 'Port Scan' alerts
<~XSIAM> (Available from Cortex XSIAM %%XSIAM_VERSION%%).</~XSIAM>
