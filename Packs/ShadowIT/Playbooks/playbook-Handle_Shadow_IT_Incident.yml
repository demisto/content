id: Handle Shadow IT Incident
version: -1
name: Handle Shadow IT Incident
description: |-
  This Playbook is used to handle a Shadow IT incident. A Shadow IT incident occurs when a resource attributed to the organization that is not sanctioned by IT nor protected by the InfoSec team is found.

  This playbook handles the incident by helping the analyst to find the owner of the resource based on existing evidence. The playbook also marks the service indicators (IP or FQDN) with a Shadow IT tag. The possible owner and their manager are notified and onboarding of the asset on Prisma Cloud is triggered through a manual process.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: c62332a7-64eb-4b82-8011-bdef8c0464d7
    type: start
    task:
      id: c62332a7-64eb-4b82-8011-bdef8c0464d7
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "2"
      - "59"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": -2600
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "1":
    id: "1"
    taskid: 54fec135-6d81-4394-8bd5-8554bc2817a7
    type: collection
    task:
      id: 54fec135-6d81-4394-8bd5-8554bc2817a7
      version: -1
      name: Collect Service details from Asset owner
      description: Collect details about a service from the owner of the asset.
      type: collection
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "41"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": -710
        }
      }
    note: true
    evidencedata:
      description:
        simple: Shadow IT Asset Questionnaire
      customfields: {}
    timertriggers: []
    ignoreworker: false
    message:
      to:
        complex:
          root: incident
          accessor: shadowitaccountowneremail
      subject:
        complex:
          root: incident
          accessor: shadowitip
          transformers:
          - operator: concat
            args:
              prefix:
                value:
                  simple: 'Shadow IT Detected - please provide details for asset '
              suffix:
                iscontext: true
      body:
        simple: |-
          Dear ${incident.shadowitaccountownername},

          we have identified an asset that might be associated to you.

          IP Address: ${incident.shadowitip}
          Port: ${incident.shadowitport}
          FQDN (if present): ${incident.shadowitfqdn}

          Please urgently fill the form linked to this email.


          Best regards,
          Your Company Infosec Team
      methods:
      - email
      format: ""
      bcc:
      cc:
        complex:
          root: incident
          accessor: shadowitoucontactemail
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
    form:
      questions:
      - id: "0"
        label: ""
        labelarg:
          simple: Do you own this asset? ${incident.shadowitip}:${incident.shadowitport}
            (${incident.shadowitfqdn})
        required: true
        gridcolumns: []
        defaultrows: []
        type: singleSelect
        options: []
        optionsarg:
        - {}
        - simple: "Yes"
        - simple: "No"
        fieldassociated: ""
        placeholder: ""
        tooltip: Please confirm you are the current owner of this asset
        readonly: false
      - id: "1"
        label: ""
        labelarg:
          simple: Is this a service sanctioned by InfoSec?
        required: true
        gridcolumns: []
        defaultrows: []
        type: singleSelect
        options: []
        optionsarg:
        - {}
        - simple: "No"
        - simple: "Yes"
        fieldassociated: ""
        placeholder: ""
        tooltip: Please confirm this service is allowed by InfoSec
        readonly: false
      - id: "2"
        label: ""
        labelarg:
          simple: Is this service being billed to Corporate?
        required: true
        gridcolumns: []
        defaultrows: []
        type: singleSelect
        options: []
        optionsarg:
        - {}
        - simple: "No"
        - simple: "Yes"
        fieldassociated: ""
        placeholder: ""
        tooltip: Please confirm this service is being billed directly to corporate
          via existing procurement process.
        readonly: false
      - id: "3"
        label: ""
        labelarg:
          simple: Does this service host sensitive corporate information?
        required: true
        gridcolumns: []
        defaultrows: []
        type: singleSelect
        options: []
        optionsarg:
        - simple: "Yes"
        - simple: "No"
        fieldassociated: ""
        placeholder: ""
        tooltip: Please confirm whether this service hosts sensitive company information.
        readonly: false
      - id: "4"
        label: ""
        labelarg:
          simple: What is the purpose of this service?
        required: true
        gridcolumns: []
        defaultrows: []
        type: multiSelect
        options: []
        optionsarg:
        - simple: Marketing
        - simple: Business Development
        - simple: Engineering
        - simple: Sales
        - simple: Other (please specify in the next question)
        fieldassociated: ""
        placeholder: ""
        tooltip: Confirm the purpose of this service
        readonly: false
      - id: "5"
        label: ""
        labelarg:
          simple: If other, please state the purpose of this service.
        required: false
        gridcolumns: []
        defaultrows: []
        type: shortText
        options: []
        optionsarg: []
        fieldassociated: ""
        placeholder: ""
        tooltip: Please state the purpose of this service
        readonly: false
      - id: "6"
        label: ""
        labelarg:
          simple: What Provider is this service Hosted on?
        required: true
        gridcolumns: []
        defaultrows: []
        type: singleSelect
        options: []
        optionsarg:
        - simple: Google Cloud Platform
        - simple: Amazon Web Services
        - simple: Microsoft Azure
        - simple: Alibaba Cloud
        - simple: Oracle Cloud
        - simple: IBM Cloud
        - simple: Corporate Network (On Prem)
        - simple: Other/Unknown
        fieldassociated: ""
        placeholder: ""
        tooltip: Please specify the Service Provider
        readonly: false
      title: Shadow IT Information Collection
      description: |-
        ## Please urgently fill the form below.


        Best regards,
        **Your Company Infosec Team**
      sender: ""
      expired: false
      totalanswers: 0
    skipunavailable: false
    quietmode: 0
  "2":
    id: "2"
    taskid: c3f082f4-beca-4a5f-8a33-51d6058a514d
    type: condition
    task:
      id: c3f082f4-beca-4a5f-8a33-51d6058a514d
      version: -1
      name: Is owner known?
      description: Check whether the owner of the asset is known.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "57"
      "yes":
      - "9"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: incident
                accessor: shadowitaccountowneremail
            iscontext: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": -2310
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "3":
    id: "3"
    taskid: 103928b4-6710-4c5e-82a5-093cd7cfdfb5
    type: regular
    task:
      id: 103928b4-6710-4c5e-82a5-093cd7cfdfb5
      version: -1
      name: Print Potential Asset Owners
      description: Convert an array to a nice table display. Usually, from the context.
      scriptName: ToTable
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      columns: {}
      data:
        complex:
          root: incident
          accessor: shadowitusersuggestions
      title:
        simple: Potential Asset Owners
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 750,
          "y": -1950
        }
      }
    note: true
    evidencedata:
      description:
        simple: Potential Asset Owners
      customfields: {}
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "5":
    id: "5"
    taskid: be2be86f-eefc-4ba6-80b0-346fd15ecbc2
    type: condition
    task:
      id: be2be86f-eefc-4ba6-80b0-346fd15ecbc2
      version: -1
      name: Cloud Type
      description: Select appropriate branch depending on Cloud Provider
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "12"
      AWS:
      - "63"
      AZURE:
      - "13"
      GCP:
      - "14"
    separatecontext: false
    conditions:
    - label: AWS
      condition:
      - - operator: inList
          left:
            value:
              complex:
                root: incident
                accessor: shadowitcloudaccounttype
            iscontext: true
          right:
            value:
              simple: aws,amazon,amazon web services
          ignorecase: true
    - label: GCP
      condition:
      - - operator: inList
          left:
            value:
              complex:
                root: incident
                accessor: shadowitcloudaccounttype
            iscontext: true
          right:
            value:
              simple: gcp,google,google cloud platform
          ignorecase: true
    - label: AZURE
      condition:
      - - operator: inList
          left:
            value:
              complex:
                root: incident
                accessor: shadowitcloudaccounttype
            iscontext: true
          right:
            value:
              simple: microsoft,azure,microsoft azure,msft
          ignorecase: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1790
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "6":
    id: "6"
    taskid: febe61a5-e248-431a-8874-2938f4c8fe76
    type: regular
    task:
      id: febe61a5-e248-431a-8874-2938f4c8fe76
      version: -1
      name: Manually handling of Shadow IT incident
      description: Manually onboard the account in Prisma Cloud
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1140,
          "y": 2170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "8":
    id: "8"
    taskid: c7144f9d-3dc1-4f7c-8bc8-03d5f0d0a10d
    type: title
    task:
      id: c7144f9d-3dc1-4f7c-8bc8-03d5f0d0a10d
      version: -1
      name: Done Collecting Information
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "43"
      - "60"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 930
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "9":
    id: "9"
    taskid: 75ff4859-47b5-4f36-8250-5c23a800b303
    type: title
    task:
      id: 75ff4859-47b5-4f36-8250-5c23a800b303
      version: -1
      name: Collect information
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": -880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "10":
    id: "10"
    taskid: d759f0af-d5d9-4659-8954-b014fcedb1d6
    type: title
    task:
      id: d759f0af-d5d9-4659-8954-b014fcedb1d6
      version: -1
      name: Done Prisma Cloud Onboarding
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "11"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "11":
    id: "11"
    taskid: 7b12b347-8983-43c7-8a5a-d488a4b0adfb
    type: title
    task:
      id: 7b12b347-8983-43c7-8a5a-d488a4b0adfb
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3350
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "12":
    id: "12"
    taskid: 7d4195a2-29c8-4e6c-8a28-d99abeb8ef93
    type: regular
    task:
      id: 7d4195a2-29c8-4e6c-8a28-d99abeb8ef93
      version: -1
      name: Onboard Cloud Account on Prisma Cloud
      description: Onboard Cloud Account on Prisma Cloud.
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 675,
          "y": 2170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "13":
    id: "13"
    taskid: 3d9aec16-275c-4ac9-83a0-fba24d610ba0
    type: regular
    task:
      id: 3d9aec16-275c-4ac9-83a0-fba24d610ba0
      version: -1
      name: Onboard Azure Cloud Account on Prisma Cloud
      description: Onboard Azure Cloud Account on Prisma Cloud
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "14":
    id: "14"
    taskid: c6a3027c-5332-472d-8ce5-a60b5b01c0ff
    type: regular
    task:
      id: c6a3027c-5332-472d-8ce5-a60b5b01c0ff
      version: -1
      name: Onboard GCP Cloud Account on Prisma Cloud
      description: Onboard GCP Cloud Account on Prisma Cloud.
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -170,
          "y": 2170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "32":
    id: "32"
    taskid: 1e74ea1c-ca9e-427b-825a-9272c786bb88
    type: collection
    task:
      id: 1e74ea1c-ca9e-427b-825a-9272c786bb88
      version: -1
      name: Choose Asset Owner
      description: Ask the Analyst to select the owner of the asset.
      type: collection
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "33"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 750,
          "y": -1790
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to:
        simple: Analyst
      subject:
        simple: 'Shadow IT: Choose asset owner'
      body:
        simple: Please choose an asset owner from the list or select add new.
      methods: []
      format: ""
      bcc:
      cc:
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
    form:
      questions:
      - id: "0"
        label: ""
        labelarg:
          simple: Choose asset owner
        required: false
        gridcolumns: []
        defaultrows: []
        type: singleSelect
        options: []
        optionsarg:
        - complex:
            root: incident
            accessor: shadowitusersuggestions
            transformers:
            - operator: getField
              args:
                field:
                  value:
                    simple: name
        - simple: âž• Add New
        fieldassociated: ""
        placeholder: ""
        tooltip: Choose asset owner from the list or select add new.
        readonly: false
      title: 'Shadow IT: Choose asset owner'
      description: Choose asset owner from the list or select add new.
      sender: ""
      expired: false
      totalanswers: 0
    skipunavailable: false
    quietmode: 0
  "33":
    id: "33"
    taskid: 825b872c-02e5-4430-85f1-e9b7d287dce2
    type: condition
    task:
      id: 825b872c-02e5-4430-85f1-e9b7d287dce2
      version: -1
      name: Add new owner?
      description: Shall we add a new owner for this asset?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "36"
      ADD-NEW:
      - "34"
    separatecontext: false
    conditions:
    - label: ADD-NEW
      condition:
      - - operator: containsString
          left:
            value:
              complex:
                root: 'Shadow IT: Choose asset owner.Answers'
                accessor: "0"
            iscontext: true
          right:
            value:
              simple: Add New
    view: |-
      {
        "position": {
          "x": 750,
          "y": -1630
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "34":
    id: "34"
    taskid: 14a0965f-062a-4515-88a8-ebfc036534ee
    type: collection
    task:
      id: 14a0965f-062a-4515-88a8-ebfc036534ee
      version: -1
      name: Insert owner name and email
      description: Ask the user to provide asset owner's name and email.
      type: collection
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "35"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1030,
          "y": -1440
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to:
        simple: Analyst
      subject:
        simple: 'Shadow IT: Insert asset owner name and email'
      body:
        simple: Please Insert asset owner name and email
      methods: []
      format: ""
      bcc:
      cc:
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
    form:
      questions:
      - id: "0"
        label: ""
        labelarg:
          simple: Asset owner name
        required: true
        gridcolumns: []
        defaultrows: []
        type: shortText
        options: []
        optionsarg: []
        fieldassociated: ""
        placeholder: ""
        tooltip: Please insert asset owner name.
        readonly: false
      - id: "1"
        label: ""
        labelarg:
          simple: Asset owner email
        required: true
        gridcolumns: []
        defaultrows: []
        type: shortText
        options: []
        optionsarg: []
        fieldassociated: ""
        placeholder: ""
        tooltip: Please insert asset owner n email.
        readonly: false
      title: 'Shadow IT: Insert asset owner name and email'
      description: Please Insert asset owner name and email.
      sender: ""
      expired: false
      totalanswers: 0
    skipunavailable: false
    quietmode: 0
  "35":
    id: "35"
    taskid: 7937518e-9e4d-48e5-88d7-e8acbe77a099
    type: regular
    task:
      id: 7937518e-9e4d-48e5-88d7-e8acbe77a099
      version: -1
      name: Set asset owner name and email in incident
      description: commands.local.cmd.set.incident
      script: Builtin|||setIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "58"
    scriptarguments:
      accountid: {}
      accountname: {}
      addLabels: {}
      agentid: {}
      app: {}
      appendMultiSelect: {}
      assetid: {}
      assigneduser: {}
      assignmentgroup: {}
      attachmentcount: {}
      attachmentextension: {}
      attachmenthash: {}
      attachmentid: {}
      attachmentname: {}
      attachmentsize: {}
      attachmenttype: {}
      blockedaction: {}
      bugtraq: {}
      caller: {}
      city: {}
      closeNotes: {}
      closeReason: {}
      cloudservice: {}
      commandline: {}
      costcenter: {}
      costcentercode: {}
      country: {}
      countryname: {}
      criticalassets: {}
      customFields: {}
      cve: {}
      cvss: {}
      dbotMirrorDirection: {}
      dbotMirrorId: {}
      dbotMirrorInstance: {}
      dbotMirrorTags: {}
      dbotprediction: {}
      dbotpredictionprobability: {}
      dbottextsuggestionhighlighted: {}
      deleteEmptyField: {}
      department: {}
      dest: {}
      desthostname: {}
      destinationhostname: {}
      destinationip: {}
      destinationnetwork: {}
      destinationport: {}
      destntdomain: {}
      destos: {}
      details: {}
      detectedexternalhosts: {}
      detectedexternalips: {}
      detectedinternalhosts: {}
      detectedinternalips: {}
      detectedusers: {}
      detectionendtime: {}
      detectionid: {}
      detectionupdatetime: {}
      detectionurl: {}
      deviceexternalip: {}
      devicehash: {}
      devicelocalip: {}
      devicemodel: {}
      devicename: {}
      displayname: {}
      duration: {}
      email: {}
      emailauthenticitycheck: {}
      emailbcc: {}
      emailbody: {}
      emailbodyformat: {}
      emailbodyhtml: {}
      emailcc: {}
      emailclassification: {}
      emailclientname: {}
      emailfrom: {}
      emailheaders: {}
      emailhtml: {}
      emailinreplyto: {}
      emailkeywords: {}
      emailmessageid: {}
      emailreceived: {}
      emailreplyto: {}
      emailreturnpath: {}
      emailsenderip: {}
      emailsize: {}
      emailsource: {}
      emailsubject: {}
      emailto: {}
      emailtocount: {}
      emailurlclicked: {}
      employeedisplayname: {}
      employeeemail: {}
      employeemanageremail: {}
      escalation: {}
      eventaction: {}
      eventid: {}
      eventtype: {}
      externaladdresses: {}
      filehash: {}
      filename: {}
      filepath: {}
      filesize: {}
      firstname: {}
      firstseen: {}
      givenname: {}
      helloworldid: {}
      helloworldstatus: {}
      helloworldtype: {}
      hostname: {}
      id: {}
      incomingmirrorerror: {}
      infectedhosts: {}
      internaladdresses: {}
      investigationstage: {}
      isolated: {}
      jobcode: {}
      jobfamily: {}
      jobfunction: {}
      labels: {}
      lastmodifiedby: {}
      lastmodifiedon: {}
      lastname: {}
      lastseen: {}
      leadership: {}
      location: {}
      locationregion: {}
      logsource: {}
      macaddress: {}
      maliciousbehavior: {}
      malwarefamily: {}
      malwarename: {}
      manageremailaddress: {}
      managername: {}
      md5: {}
      mobiledevicemodel: {}
      mobilephone: {}
      name: {}
      occurred: {}
      os: {}
      osversion: {}
      outgoingmirrorerror: {}
      owner: {}
      parentprocessid: {}
      personalemail: {}
      phase: {}
      phishingsubtype: {}
      phonenumber: {}
      pid: {}
      policydeleted: {}
      policydescription: {}
      policydetails: {}
      policyid: {}
      policyrecommendation: {}
      policyremediable: {}
      policyseverity: {}
      policytype: {}
      prismacloudid: {}
      prismacloudreason: {}
      prismacloudrules: {}
      prismacloudstatus: {}
      prismacloudtime: {}
      protocol: {}
      protocols: {}
      quarantined: {}
      rating: {}
      region: {}
      regionid: {}
      replacePlaybook: {}
      reporteremailaddress: {}
      resourceapiname: {}
      resourcecloudtype: {}
      resourceid: {}
      resourcename: {}
      resourcetype: {}
      riskrating: {}
      riskscore: {}
      roles: {}
      rrn: {}
      samaccountname: {}
      severity: {}
      sha256: {}
      shadowitaccountowneremail:
        complex:
          root: 'Shadow IT: Insert asset owner name and email.Answers'
          accessor: "1"
      shadowitaccountownername:
        complex:
          root: 'Shadow IT: Insert asset owner name and email.Answers'
          accessor: "0"
      shadowitbilledtocorp: {}
      shadowitcertificate: {}
      shadowitcloudaccountid: {}
      shadowitcloudaccounttype: {}
      shadowitfqdn: {}
      shadowitip: {}
      shadowitorganizationalunit: {}
      shadowitoucontactemail: {}
      shadowitoucontactname: {}
      shadowitport: {}
      shadowitprovider: {}
      shadowitrisk: {}
      shadowitsactionedservice: {}
      shadowitsource: {}
      shadowusersuggestions: {}
      signature: {}
      skuname: {}
      skutier: {}
      sla: {}
      slaField: {}
      sourcehostname: {}
      sourceip: {}
      sourcenetwork: {}
      sourceport: {}
      sourceusername: {}
      src: {}
      srchostname: {}
      srcntdomain: {}
      srcos: {}
      srcuser: {}
      state: {}
      streetaddress: {}
      subcategory: {}
      subscriptionassignedby: {}
      subscriptioncreatedby: {}
      subscriptioncreatedon: {}
      subscriptiondescription: {}
      subscriptionid: {}
      subscriptionname: {}
      subscriptiontype: {}
      subscriptionupdatedby: {}
      subscriptionupdatedon: {}
      subtype: {}
      surname: {}
      systemdefault: {}
      systems: {}
      targetfirewallversion: {}
      tenantname: {}
      terminatedaction: {}
      threatactor: {}
      ticketcloseddate: {}
      ticketnumber: {}
      ticketopeneddate: {}
      title: {}
      triggeredsecurityprofile: {}
      type: {}
      uniqueports: {}
      urlsslverification: {}
      user: {}
      useraccountcontrol: {}
      username: {}
      vendorid: {}
      vendorproduct: {}
      vpcid: {}
      vulnerabilitycategory: {}
      workphone: {}
      xdralertcount: {}
      xdralerts: {}
      xdrassigneduseremail: {}
      xdrassigneduserprettyname: {}
      xdrdescription: {}
      xdrdetectiontime: {}
      xdrfileartifacts: {}
      xdrhighseverityalertcount: {}
      xdrhostcount: {}
      xdrincidentid: {}
      xdrlowseverityalertcount: {}
      xdrmediumseverityalertcount: {}
      xdrnetworkartifacts: {}
      xdrnotes: {}
      xdrresolvecomment: {}
      xdrstatus: {}
      xdrstatusv2: {}
      xdrurl: {}
      xdrusercount: {}
      zipcode: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1030,
          "y": -1250
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "36":
    id: "36"
    taskid: 50b8d3a6-40d9-49d5-8843-1819023d6157
    type: regular
    task:
      id: 50b8d3a6-40d9-49d5-8843-1819023d6157
      version: -1
      name: Set asset owner name and email in incident
      description: commands.local.cmd.set.incident
      script: Builtin|||setIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "58"
    scriptarguments:
      accountid: {}
      accountname: {}
      addLabels: {}
      agentid: {}
      app: {}
      appendMultiSelect: {}
      assetid: {}
      assigneduser: {}
      assignmentgroup: {}
      attachmentcount: {}
      attachmentextension: {}
      attachmenthash: {}
      attachmentid: {}
      attachmentname: {}
      attachmentsize: {}
      attachmenttype: {}
      blockedaction: {}
      bugtraq: {}
      caller: {}
      city: {}
      closeNotes: {}
      closeReason: {}
      cloudservice: {}
      commandline: {}
      costcenter: {}
      costcentercode: {}
      country: {}
      countryname: {}
      criticalassets: {}
      customFields: {}
      cve: {}
      cvss: {}
      dbotMirrorDirection: {}
      dbotMirrorId: {}
      dbotMirrorInstance: {}
      dbotMirrorTags: {}
      dbotprediction: {}
      dbotpredictionprobability: {}
      dbottextsuggestionhighlighted: {}
      deleteEmptyField: {}
      department: {}
      dest: {}
      desthostname: {}
      destinationhostname: {}
      destinationip: {}
      destinationnetwork: {}
      destinationport: {}
      destntdomain: {}
      destos: {}
      details: {}
      detectedexternalhosts: {}
      detectedexternalips: {}
      detectedinternalhosts: {}
      detectedinternalips: {}
      detectedusers: {}
      detectionendtime: {}
      detectionid: {}
      detectionupdatetime: {}
      detectionurl: {}
      deviceexternalip: {}
      devicehash: {}
      devicelocalip: {}
      devicemodel: {}
      devicename: {}
      displayname: {}
      duration: {}
      email: {}
      emailauthenticitycheck: {}
      emailbcc: {}
      emailbody: {}
      emailbodyformat: {}
      emailbodyhtml: {}
      emailcc: {}
      emailclassification: {}
      emailclientname: {}
      emailfrom: {}
      emailheaders: {}
      emailhtml: {}
      emailinreplyto: {}
      emailkeywords: {}
      emailmessageid: {}
      emailreceived: {}
      emailreplyto: {}
      emailreturnpath: {}
      emailsenderip: {}
      emailsize: {}
      emailsource: {}
      emailsubject: {}
      emailto: {}
      emailtocount: {}
      emailurlclicked: {}
      employeedisplayname: {}
      employeeemail: {}
      employeemanageremail: {}
      escalation: {}
      eventaction: {}
      eventid: {}
      eventtype: {}
      externaladdresses: {}
      filehash: {}
      filename: {}
      filepath: {}
      filesize: {}
      firstname: {}
      firstseen: {}
      givenname: {}
      helloworldid: {}
      helloworldstatus: {}
      helloworldtype: {}
      hostname: {}
      id: {}
      incomingmirrorerror: {}
      infectedhosts: {}
      internaladdresses: {}
      investigationstage: {}
      isolated: {}
      jobcode: {}
      jobfamily: {}
      jobfunction: {}
      labels: {}
      lastmodifiedby: {}
      lastmodifiedon: {}
      lastname: {}
      lastseen: {}
      leadership: {}
      location: {}
      locationregion: {}
      logsource: {}
      macaddress: {}
      maliciousbehavior: {}
      malwarefamily: {}
      malwarename: {}
      manageremailaddress: {}
      managername: {}
      md5: {}
      mobiledevicemodel: {}
      mobilephone: {}
      name: {}
      occurred: {}
      os: {}
      osversion: {}
      outgoingmirrorerror: {}
      owner: {}
      parentprocessid: {}
      personalemail: {}
      phase: {}
      phishingsubtype: {}
      phonenumber: {}
      pid: {}
      policydeleted: {}
      policydescription: {}
      policydetails: {}
      policyid: {}
      policyrecommendation: {}
      policyremediable: {}
      policyseverity: {}
      policytype: {}
      prismacloudid: {}
      prismacloudreason: {}
      prismacloudrules: {}
      prismacloudstatus: {}
      prismacloudtime: {}
      protocol: {}
      protocols: {}
      quarantined: {}
      rating: {}
      region: {}
      regionid: {}
      replacePlaybook: {}
      reporteremailaddress: {}
      resourceapiname: {}
      resourcecloudtype: {}
      resourceid: {}
      resourcename: {}
      resourcetype: {}
      riskrating: {}
      riskscore: {}
      roles: {}
      rrn: {}
      samaccountname: {}
      severity: {}
      sha256: {}
      shadowitaccountowneremail:
        complex:
          root: incident.shadowitusersuggestions
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: incident.shadowitusersuggestions.name
                iscontext: true
              right:
                value:
                  simple: 'Shadow IT: Choose asset owner.Answers.0'
                iscontext: true
          transformers:
          - operator: getField
            args:
              field:
                value:
                  simple: email
      shadowitaccountownername:
        complex:
          root: 'Shadow IT: Choose asset owner.Answers'
          accessor: "0"
      shadowitbilledtocorp: {}
      shadowitcertificate: {}
      shadowitcloudaccountid: {}
      shadowitcloudaccounttype: {}
      shadowitfqdn: {}
      shadowitip: {}
      shadowitorganizationalunit: {}
      shadowitoucontactemail: {}
      shadowitoucontactname: {}
      shadowitport: {}
      shadowitprovider: {}
      shadowitrisk: {}
      shadowitsactionedservice: {}
      shadowitsensitivedata: {}
      shadowitservicepurpose: {}
      shadowitsource: {}
      shadowitusersuggestions: {}
      shadowusersuggestions: {}
      signature: {}
      skuname: {}
      skutier: {}
      sla: {}
      slaField: {}
      sourcehostname: {}
      sourceip: {}
      sourcenetwork: {}
      sourceport: {}
      sourceusername: {}
      src: {}
      srchostname: {}
      srcntdomain: {}
      srcos: {}
      srcuser: {}
      state: {}
      streetaddress: {}
      subcategory: {}
      subscriptionassignedby: {}
      subscriptioncreatedby: {}
      subscriptioncreatedon: {}
      subscriptiondescription: {}
      subscriptionid: {}
      subscriptionname: {}
      subscriptiontype: {}
      subscriptionupdatedby: {}
      subscriptionupdatedon: {}
      subtype: {}
      surname: {}
      systemdefault: {}
      systems: {}
      targetfirewallversion: {}
      tenantname: {}
      terminatedaction: {}
      threatactor: {}
      ticketcloseddate: {}
      ticketnumber: {}
      ticketopeneddate: {}
      title: {}
      triggeredsecurityprofile: {}
      type: {}
      uniqueports: {}
      urlsslverification: {}
      user: {}
      useraccountcontrol: {}
      username: {}
      vendorid: {}
      vendorproduct: {}
      vpcid: {}
      vulnerabilitycategory: {}
      workphone: {}
      xdralertcount: {}
      xdralerts: {}
      xdrassigneduseremail: {}
      xdrassigneduserprettyname: {}
      xdrdescription: {}
      xdrdetectiontime: {}
      xdrfileartifacts: {}
      xdrhighseverityalertcount: {}
      xdrhostcount: {}
      xdrincidentid: {}
      xdrlowseverityalertcount: {}
      xdrmediumseverityalertcount: {}
      xdrnetworkartifacts: {}
      xdrnotes: {}
      xdrresolvecomment: {}
      xdrstatus: {}
      xdrstatusv2: {}
      xdrurl: {}
      xdrusercount: {}
      zipcode: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 560,
          "y": -1250
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "37":
    id: "37"
    taskid: 2d022bb4-9885-4077-84a4-4ceea9d20e86
    type: regular
    task:
      id: 2d022bb4-9885-4077-84a4-4ceea9d20e86
      version: -1
      name: Set Incident Information based on responses
      description: commands.local.cmd.set.incident
      script: Builtin|||setIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "39"
    scriptarguments:
      accountid: {}
      accountname: {}
      addLabels: {}
      agentid: {}
      app: {}
      appendMultiSelect: {}
      assetid: {}
      assigneduser: {}
      assignmentgroup: {}
      attachmentcount: {}
      attachmentextension: {}
      attachmenthash: {}
      attachmentid: {}
      attachmentname: {}
      attachmentsize: {}
      attachmenttype: {}
      blockedaction: {}
      bugtraq: {}
      caller: {}
      city: {}
      closeNotes: {}
      closeReason: {}
      cloudservice: {}
      commandline: {}
      costcenter: {}
      costcentercode: {}
      country: {}
      countryname: {}
      criticalassets: {}
      customFields: {}
      cve: {}
      cvss: {}
      dbotMirrorDirection: {}
      dbotMirrorId: {}
      dbotMirrorInstance: {}
      dbotMirrorTags: {}
      dbotprediction: {}
      dbotpredictionprobability: {}
      dbottextsuggestionhighlighted: {}
      deleteEmptyField: {}
      department: {}
      dest: {}
      desthostname: {}
      destinationhostname: {}
      destinationip: {}
      destinationnetwork: {}
      destinationport: {}
      destntdomain: {}
      destos: {}
      details: {}
      detectedexternalhosts: {}
      detectedexternalips: {}
      detectedinternalhosts: {}
      detectedinternalips: {}
      detectedusers: {}
      detectionendtime: {}
      detectionid: {}
      detectionupdatetime: {}
      detectionurl: {}
      deviceexternalip: {}
      devicehash: {}
      devicelocalip: {}
      devicemodel: {}
      devicename: {}
      displayname: {}
      duration: {}
      email: {}
      emailauthenticitycheck: {}
      emailbcc: {}
      emailbody: {}
      emailbodyformat: {}
      emailbodyhtml: {}
      emailcc: {}
      emailclassification: {}
      emailclientname: {}
      emailfrom: {}
      emailheaders: {}
      emailhtml: {}
      emailinreplyto: {}
      emailkeywords: {}
      emailmessageid: {}
      emailreceived: {}
      emailreplyto: {}
      emailreturnpath: {}
      emailsenderip: {}
      emailsize: {}
      emailsource: {}
      emailsubject: {}
      emailto: {}
      emailtocount: {}
      emailurlclicked: {}
      employeedisplayname: {}
      employeeemail: {}
      employeemanageremail: {}
      escalation: {}
      eventaction: {}
      eventid: {}
      eventtype: {}
      externaladdresses: {}
      filehash: {}
      filename: {}
      filepath: {}
      filesize: {}
      firstname: {}
      firstseen: {}
      givenname: {}
      helloworldid: {}
      helloworldstatus: {}
      helloworldtype: {}
      hostname: {}
      id: {}
      incomingmirrorerror: {}
      infectedhosts: {}
      internaladdresses: {}
      investigationstage: {}
      isolated: {}
      jobcode: {}
      jobfamily: {}
      jobfunction: {}
      labels: {}
      lastmodifiedby: {}
      lastmodifiedon: {}
      lastname: {}
      lastseen: {}
      leadership: {}
      location: {}
      locationregion: {}
      logsource: {}
      macaddress: {}
      maliciousbehavior: {}
      malwarefamily: {}
      malwarename: {}
      manageremailaddress: {}
      managername: {}
      md5: {}
      mobiledevicemodel: {}
      mobilephone: {}
      name: {}
      occurred: {}
      os: {}
      osversion: {}
      outgoingmirrorerror: {}
      owner: {}
      parentprocessid: {}
      personalemail: {}
      phase: {}
      phishingsubtype: {}
      phonenumber: {}
      pid: {}
      policydeleted: {}
      policydescription: {}
      policydetails: {}
      policyid: {}
      policyrecommendation: {}
      policyremediable: {}
      policyseverity: {}
      policytype: {}
      prismacloudid: {}
      prismacloudreason: {}
      prismacloudrules: {}
      prismacloudstatus: {}
      prismacloudtime: {}
      protocol: {}
      protocols: {}
      quarantined: {}
      rating: {}
      region: {}
      regionid: {}
      replacePlaybook: {}
      reporteremailaddress: {}
      resourceapiname: {}
      resourcecloudtype: {}
      resourceid: {}
      resourcename: {}
      resourcetype: {}
      riskrating: {}
      riskscore: {}
      roles: {}
      rrn: {}
      samaccountname: {}
      severity: {}
      sha256: {}
      shadowitaccountowneremail: {}
      shadowitaccountownername: {}
      shadowitbilledtocorp:
        complex:
          root: Shadow IT Information Collection.Answers
          accessor: "2"
          transformers:
          - operator: If-Then-Else
            args:
              else:
                value:
                  simple: "false"
              equals:
                value:
                  simple: "Yes"
              then:
                value:
                  simple: "true"
      shadowitcertificate: {}
      shadowitcloudaccountid: {}
      shadowitcloudaccounttype:
        complex:
          root: Shadow IT Information Collection.Answers
          accessor: "6"
      shadowitfqdn: {}
      shadowitip: {}
      shadowitorganizationalunit: {}
      shadowitoucontactemail: {}
      shadowitoucontactname: {}
      shadowitport: {}
      shadowitprovider:
        complex:
          root: Shadow IT Information Collection.Answers
          accessor: "6"
      shadowitregion: {}
      shadowitrisk: {}
      shadowitsactionedservice:
        complex:
          root: Shadow IT Information Collection.Answers
          accessor: "1"
          transformers:
          - operator: If-Then-Else
            args:
              else:
                value:
                  simple: "false"
              equals:
                value:
                  simple: "Yes"
              then:
                value:
                  simple: "true"
      shadowitsensitivedata:
        complex:
          root: Shadow IT Information Collection.Answers
          accessor: "3"
          transformers:
          - operator: If-Then-Else
            args:
              else:
                value:
                  simple: "false"
              equals:
                value:
                  simple: "Yes"
              then:
                value:
                  simple: "true"
      shadowitservice: {}
      shadowitservicepurpose:
        complex:
          root: Shadow IT Information Collection.Answers
          accessor: "4"
      shadowitsource: {}
      shadowitusersuggestions: {}
      shadowusersuggestions: {}
      signature: {}
      skuname: {}
      skutier: {}
      sla: {}
      slaField: {}
      sourcehostname: {}
      sourceip: {}
      sourcenetwork: {}
      sourceport: {}
      sourceusername: {}
      src: {}
      srchostname: {}
      srcntdomain: {}
      srcos: {}
      srcuser: {}
      state: {}
      streetaddress: {}
      subcategory: {}
      subscriptionassignedby: {}
      subscriptioncreatedby: {}
      subscriptioncreatedon: {}
      subscriptiondescription: {}
      subscriptionid: {}
      subscriptionname: {}
      subscriptiontype: {}
      subscriptionupdatedby: {}
      subscriptionupdatedon: {}
      subtype: {}
      surname: {}
      systemdefault: {}
      systems: {}
      targetfirewallversion: {}
      tenantname: {}
      terminatedaction: {}
      threatactor: {}
      ticketcloseddate: {}
      ticketnumber: {}
      ticketopeneddate: {}
      title: {}
      triggeredsecurityprofile: {}
      type: {}
      uniqueports: {}
      urlsslverification: {}
      user: {}
      useraccountcontrol: {}
      username: {}
      vendorid: {}
      vendorproduct: {}
      vpcid: {}
      vulnerabilitycategory: {}
      workphone: {}
      xdralertcount: {}
      xdralerts: {}
      xdrassigneduseremail: {}
      xdrassigneduserprettyname: {}
      xdrdescription: {}
      xdrdetectiontime: {}
      xdrfileartifacts: {}
      xdrhighseverityalertcount: {}
      xdrhostcount: {}
      xdrincidentid: {}
      xdrlowseverityalertcount: {}
      xdrmediumseverityalertcount: {}
      xdrnetworkartifacts: {}
      xdrnotes: {}
      xdrresolvecomment: {}
      xdrstatus: {}
      xdrstatusv2: {}
      xdrurl: {}
      xdrusercount: {}
      zipcode: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": -305
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "39":
    id: "39"
    taskid: 2254a855-4154-4101-8e5e-1f881f19ae40
    type: condition
    task:
      id: 2254a855-4154-4101-8e5e-1f881f19ae40
      version: -1
      name: Does the service contain sensitive information?
      description: Check whether the user confirmed that the service might contain
        sensitive data.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "8"
      "yes":
      - "40"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Shadow IT Information Collection.Answers
                accessor: "3"
            iscontext: true
          right:
            value:
              simple: "yes"
          ignorecase: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": -80
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "40":
    id: "40"
    taskid: 279aac1d-499e-4cfb-8ba6-f77f73266e17
    type: regular
    task:
      id: 279aac1d-499e-4cfb-8ba6-f77f73266e17
      version: -1
      name: Set Shadow IT Risk and Severity to Critical
      description: commands.local.cmd.set.incident
      script: Builtin|||setIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      accountid: {}
      accountname: {}
      addLabels: {}
      agentid: {}
      app: {}
      appendMultiSelect: {}
      assetid: {}
      assigneduser: {}
      assignmentgroup: {}
      attachmentcount: {}
      attachmentextension: {}
      attachmenthash: {}
      attachmentid: {}
      attachmentname: {}
      attachmentsize: {}
      attachmenttype: {}
      blockedaction: {}
      bugtraq: {}
      caller: {}
      city: {}
      closeNotes: {}
      closeReason: {}
      cloudservice: {}
      commandline: {}
      costcenter: {}
      costcentercode: {}
      country: {}
      countryname: {}
      criticalassets: {}
      customFields: {}
      cve: {}
      cvss: {}
      dbotMirrorDirection: {}
      dbotMirrorId: {}
      dbotMirrorInstance: {}
      dbotMirrorTags: {}
      dbotprediction: {}
      dbotpredictionprobability: {}
      dbottextsuggestionhighlighted: {}
      deleteEmptyField: {}
      department: {}
      dest: {}
      desthostname: {}
      destinationhostname: {}
      destinationip: {}
      destinationnetwork: {}
      destinationport: {}
      destntdomain: {}
      destos: {}
      details: {}
      detectedexternalhosts: {}
      detectedexternalips: {}
      detectedinternalhosts: {}
      detectedinternalips: {}
      detectedusers: {}
      detectionendtime: {}
      detectionid: {}
      detectionupdatetime: {}
      detectionurl: {}
      deviceexternalip: {}
      devicehash: {}
      devicelocalip: {}
      devicemodel: {}
      devicename: {}
      displayname: {}
      duration: {}
      email: {}
      emailauthenticitycheck: {}
      emailbcc: {}
      emailbody: {}
      emailbodyformat: {}
      emailbodyhtml: {}
      emailcc: {}
      emailclassification: {}
      emailclientname: {}
      emailfrom: {}
      emailheaders: {}
      emailhtml: {}
      emailinreplyto: {}
      emailkeywords: {}
      emailmessageid: {}
      emailreceived: {}
      emailreplyto: {}
      emailreturnpath: {}
      emailsenderip: {}
      emailsize: {}
      emailsource: {}
      emailsubject: {}
      emailto: {}
      emailtocount: {}
      emailurlclicked: {}
      employeedisplayname: {}
      employeeemail: {}
      employeemanageremail: {}
      escalation: {}
      eventaction: {}
      eventid: {}
      eventtype: {}
      externaladdresses: {}
      filehash: {}
      filename: {}
      filepath: {}
      filesize: {}
      firstname: {}
      firstseen: {}
      givenname: {}
      helloworldid: {}
      helloworldstatus: {}
      helloworldtype: {}
      hostname: {}
      id: {}
      incomingmirrorerror: {}
      infectedhosts: {}
      internaladdresses: {}
      investigationstage: {}
      isolated: {}
      jobcode: {}
      jobfamily: {}
      jobfunction: {}
      labels: {}
      lastmodifiedby: {}
      lastmodifiedon: {}
      lastname: {}
      lastseen: {}
      leadership: {}
      location: {}
      locationregion: {}
      logsource: {}
      macaddress: {}
      maliciousbehavior: {}
      malwarefamily: {}
      malwarename: {}
      manageremailaddress: {}
      managername: {}
      md5: {}
      mobiledevicemodel: {}
      mobilephone: {}
      name: {}
      occurred: {}
      os: {}
      osversion: {}
      outgoingmirrorerror: {}
      owner: {}
      parentprocessid: {}
      personalemail: {}
      phase: {}
      phishingsubtype: {}
      phonenumber: {}
      pid: {}
      policydeleted: {}
      policydescription: {}
      policydetails: {}
      policyid: {}
      policyrecommendation: {}
      policyremediable: {}
      policyseverity: {}
      policytype: {}
      prismacloudid: {}
      prismacloudreason: {}
      prismacloudrules: {}
      prismacloudstatus: {}
      prismacloudtime: {}
      protocol: {}
      protocols: {}
      quarantined: {}
      rating: {}
      region: {}
      regionid: {}
      replacePlaybook: {}
      reporteremailaddress: {}
      resourceapiname: {}
      resourcecloudtype: {}
      resourceid: {}
      resourcename: {}
      resourcetype: {}
      riskrating: {}
      riskscore: {}
      roles: {}
      rrn: {}
      samaccountname: {}
      severity:
        simple: "4"
      sha256: {}
      shadowitaccountowneremail: {}
      shadowitaccountownername: {}
      shadowitbilledtocorp: {}
      shadowitcertificate: {}
      shadowitcloudaccountid: {}
      shadowitcloudaccounttype: {}
      shadowitfqdn: {}
      shadowitip: {}
      shadowitorganizationalunit: {}
      shadowitoucontactemail: {}
      shadowitoucontactname: {}
      shadowitport: {}
      shadowitprovider: {}
      shadowitrisk:
        simple: Critical
      shadowitsactionedservice: {}
      shadowitsensitivedata: {}
      shadowitservicepurpose: {}
      shadowitsource: {}
      shadowitusersuggestions: {}
      signature: {}
      skuname: {}
      skutier: {}
      sla: {}
      slaField: {}
      sourcehostname: {}
      sourceip: {}
      sourcenetwork: {}
      sourceport: {}
      sourceusername: {}
      src: {}
      srchostname: {}
      srcntdomain: {}
      srcos: {}
      srcuser: {}
      state: {}
      streetaddress: {}
      subcategory: {}
      subscriptionassignedby: {}
      subscriptioncreatedby: {}
      subscriptioncreatedon: {}
      subscriptiondescription: {}
      subscriptionid: {}
      subscriptionname: {}
      subscriptiontype: {}
      subscriptionupdatedby: {}
      subscriptionupdatedon: {}
      subtype: {}
      surname: {}
      systemdefault: {}
      systems: {}
      targetfirewallversion: {}
      tenantname: {}
      terminatedaction: {}
      threatactor: {}
      ticketcloseddate: {}
      ticketnumber: {}
      ticketopeneddate: {}
      title: {}
      triggeredsecurityprofile: {}
      type: {}
      uniqueports: {}
      urlsslverification: {}
      user: {}
      useraccountcontrol: {}
      username: {}
      vendorid: {}
      vendorproduct: {}
      vpcid: {}
      vulnerabilitycategory: {}
      workphone: {}
      xdralertcount: {}
      xdralerts: {}
      xdrassigneduseremail: {}
      xdrassigneduserprettyname: {}
      xdrdescription: {}
      xdrdetectiontime: {}
      xdrfileartifacts: {}
      xdrhighseverityalertcount: {}
      xdrhostcount: {}
      xdrincidentid: {}
      xdrlowseverityalertcount: {}
      xdrmediumseverityalertcount: {}
      xdrnetworkartifacts: {}
      xdrnotes: {}
      xdrresolvecomment: {}
      xdrstatus: {}
      xdrstatusv2: {}
      xdrurl: {}
      xdrusercount: {}
      zipcode: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -30,
          "y": 170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "41":
    id: "41"
    taskid: dbbfc184-92a9-463a-828a-af7f4b858669
    type: condition
    task:
      id: dbbfc184-92a9-463a-828a-af7f4b858669
      version: -1
      name: Did the user confirm they own the asset?
      description: Check whether the user confirmed to own this asset.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "42"
      "yes":
      - "37"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Shadow IT Information Collection.Answers
                accessor: "0"
            iscontext: true
          right:
            value:
              simple: "yes"
          ignorecase: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": -565
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "42":
    id: "42"
    taskid: 1a980226-1ee9-48ad-88b3-f5eaf0c63b7a
    type: regular
    task:
      id: 1a980226-1ee9-48ad-88b3-f5eaf0c63b7a
      version: -1
      name: Find owner and collect information manually
      description: The analyst must manually investigate this incidentand, find the
        owner and collect the service information.
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 810,
          "y": -360
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "43":
    id: "43"
    taskid: 18bdd6d8-0e6c-4c28-818c-823d1e13530d
    type: title
    task:
      id: 18bdd6d8-0e6c-4c28-818c-823d1e13530d
      version: -1
      name: Notify Manager
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "45"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1660,
          "y": 1175
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "44":
    id: "44"
    taskid: 95c3f5c8-c3e9-4a05-8bfd-706372bb128d
    type: playbook
    task:
      id: 95c3f5c8-c3e9-4a05-8bfd-706372bb128d
      version: -1
      name: Active Directory - Get User Manager Details
      playbookName: Active Directory - Get User Manager Details
      type: playbook
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "47"
    scriptarguments:
      UserEmail:
        complex:
          root: incident
          accessor: shadowitaccountowneremail
      Username: {}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 1660,
          "y": 1695
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "45":
    id: "45"
    taskid: 4787d1bf-bfed-4649-8bd9-c1e53b263e15
    type: condition
    task:
      id: 4787d1bf-bfed-4649-8bd9-c1e53b263e15
      version: -1
      name: Shall we notify user's manager?
      description: Check whether to notify the user's manger.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "44"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: inputs.Notify Manager
            iscontext: true
          right:
            value:
              simple: "yes"
          ignorecase: true
    view: |-
      {
        "position": {
          "x": 1660,
          "y": 1470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "46":
    id: "46"
    taskid: 71fa2a95-60d2-4f94-899b-1bd3f97abd44
    type: title
    task:
      id: 71fa2a95-60d2-4f94-899b-1bd3f97abd44
      version: -1
      name: Done Notify Manager
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "11"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1660,
          "y": 2760
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "47":
    id: "47"
    taskid: 23b64654-c78b-4b5b-8248-8be07e1c88fb
    type: condition
    task:
      id: 23b64654-c78b-4b5b-8248-8be07e1c88fb
      version: -1
      name: Did we find the user's manager?
      description: Check whether to notify the user's manager.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "46"
      "yes":
      - "48"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: UserManagerEmail
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1660,
          "y": 1910
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "48":
    id: "48"
    taskid: 8bfb7c30-98e7-4f7d-87a6-8dfb1bd9610e
    type: regular
    task:
      id: 8bfb7c30-98e7-4f7d-87a6-8dfb1bd9610e
      version: -1
      name: Notify User's manager
      description: Send an email
      script: '|||send-mail'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "46"
    scriptarguments:
      additionalHeader: {}
      attachCIDs: {}
      attachIDs: {}
      attachNames: {}
      bcc: {}
      body: {}
      cc: {}
      htmlBody:
        simple: ${inputs.ManagerNotificationBody}
      raw_message: {}
      replyTo: {}
      subject:
        complex:
          root: incident
          accessor: shadowitaccountownername
          transformers:
          - operator: concat
            args:
              prefix:
                value:
                  simple: inputs.ManagerNotificationSubjectPrefix
                iscontext: true
              suffix: {}
      templateParams: {}
      to:
        complex:
          root: UserManagerEmail
      transientFile: {}
      transientFileCID: {}
      transientFileContent: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1660,
          "y": 2170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "49":
    id: "49"
    taskid: 2053aac3-a83f-48ca-8ccb-03ae5192d12a
    type: title
    task:
      id: 2053aac3-a83f-48ca-8ccb-03ae5192d12a
      version: -1
      name: Tag Shadow IT Indicators
      description: commands.local.cmd.find.indicators
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "50"
      - "52"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1630,
          "y": 800
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "50":
    id: "50"
    taskid: edcc6efa-52a8-4a1a-8fae-448ae56b66ae
    type: condition
    task:
      id: edcc6efa-52a8-4a1a-8fae-448ae56b66ae
      version: -1
      name: Is there an IP?
      description: Check whether an IP address is part of the incident.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "54"
      "yes":
      - "51"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: incident
                accessor: shadowitip
            iscontext: true
    view: |-
      {
        "position": {
          "x": -2120,
          "y": 1030
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "51":
    id: "51"
    taskid: e3302167-4fa2-4da3-8a2a-2c0cb38f610c
    type: regular
    task:
      id: e3302167-4fa2-4da3-8a2a-2c0cb38f610c
      version: -1
      name: Find IP Indicator
      description: commands.local.cmd.find.indicators
      script: Builtin|||findIndicators
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "54"
    scriptarguments:
      extend-context:
        simple: ShadowITIndicator=
      fromdate: {}
      ignore-outputs:
        simple: "true"
      page: {}
      query: {}
      size: {}
      todate: {}
      value:
        complex:
          root: incident
          accessor: shadowitip
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -2120,
          "y": 1240
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "52":
    id: "52"
    taskid: e53839f9-ee2e-40ed-832d-9868ac35bc32
    type: condition
    task:
      id: e53839f9-ee2e-40ed-832d-9868ac35bc32
      version: -1
      name: Is there a FQDN?
      description: Check whether an FQDN was provided with this incident.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "54"
      "yes":
      - "53"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: incident
                accessor: shadowitfqdn
            iscontext: true
    view: |-
      {
        "position": {
          "x": -1230,
          "y": 1050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "53":
    id: "53"
    taskid: 9a1d5eff-ea82-4920-8589-fef36cb0faf9
    type: regular
    task:
      id: 9a1d5eff-ea82-4920-8589-fef36cb0faf9
      version: -1
      name: Find FQDN Indicator
      description: commands.local.cmd.find.indicators
      script: Builtin|||findIndicators
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "54"
    scriptarguments:
      extend-context:
        simple: ShadowITIndicator=
      fromdate: {}
      ignore-outputs:
        simple: "true"
      page: {}
      query: {}
      size: {}
      todate: {}
      value:
        complex:
          root: incident
          accessor: shadowitfqdn
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1230,
          "y": 1260
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "54":
    id: "54"
    taskid: 0773c6c1-7767-491f-8574-bb0593b0eae6
    type: condition
    task:
      id: 0773c6c1-7767-491f-8574-bb0593b0eae6
      version: -1
      name: Are there Shadow IT Indicators?
      description: Check whether there are indicators labelled Shadow IT.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "56"
      "yes":
      - "55"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: ShadowITIndicator
            iscontext: true
    view: |-
      {
        "position": {
          "x": -1700,
          "y": 1480
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "55":
    id: "55"
    taskid: 86f2fd2c-cfb4-4e9b-8979-402d326edded
    type: regular
    task:
      id: 86f2fd2c-cfb4-4e9b-8979-402d326edded
      version: -1
      name: Tag Shadow IT Indicators
      description: commands.local.cmd.add.values.to.indicator.multi.select.field
      script: Builtin|||appendIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "56"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        complex:
          root: inputs.ShadowITIndicatorTags
      indicatorsValues:
        complex:
          root: ShadowITIndicator
          accessor: value
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -2020,
          "y": 1910
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "56":
    id: "56"
    taskid: deed11a3-6ba3-4c2c-82f3-86686bc9383d
    type: title
    task:
      id: deed11a3-6ba3-4c2c-82f3-86686bc9383d
      version: -1
      name: Done Tagging Shadow IT Indicators
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "11"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1700,
          "y": 2490
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "57":
    id: "57"
    taskid: c7736540-a75a-4bef-810c-a3186ea63f52
    type: title
    task:
      id: c7736540-a75a-4bef-810c-a3186ea63f52
      version: -1
      name: Identify Owner
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "3"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 750,
          "y": -2090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "58":
    id: "58"
    taskid: cb5ed74c-e836-43b5-8d2f-f0e57832c001
    type: title
    task:
      id: cb5ed74c-e836-43b5-8d2f-f0e57832c001
      version: -1
      name: Done Identifying Owner
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "9"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 560,
          "y": -1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "59":
    id: "59"
    taskid: 43765462-0324-409a-8735-baf5bbcff9f2
    type: condition
    task:
      id: 43765462-0324-409a-8735-baf5bbcff9f2
      version: -1
      name: Restrict outgoing traffic to this service?
      description: Ask the analyst whether to restrict access to this service.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      âœ… Yes:
      - "49"
      âŒ No:
      - "9"
    separatecontext: false
    defaultassigneecomplex:
      simple: Analyst
    view: |-
      {
        "position": {
          "x": -550,
          "y": -2240
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "60":
    id: "60"
    taskid: 200d42d2-080c-4ee7-839d-5d0adb2f6baf
    type: condition
    task:
      id: 200d42d2-080c-4ee7-839d-5d0adb2f6baf
      version: -1
      name: Onboard this account on Prisma Cloud?
      description: Ask the analyst whether to onboard this account on Prisma Cloud.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      âœ… Yes:
      - "64"
      âŒ No:
      - "6"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1290
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "63":
    id: "63"
    taskid: 23641b66-61fd-45de-89e2-4dbbe5d999dd
    type: regular
    task:
      id: 23641b66-61fd-45de-89e2-4dbbe5d999dd
      version: -1
      name: Onboard AWS Cloud Account on Prisma Cloud
      description: Onboard AWS Cloud Account on Prisma Cloud.
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -620,
          "y": 2170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "64":
    id: "64"
    taskid: 1863d5ce-2ad4-460d-8270-25abf7248483
    type: title
    task:
      id: 1863d5ce-2ad4-460d-8270-25abf7248483
      version: -1
      name: Prisma Cloud Onboarding
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "5"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1660
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
view: |-
  {
    "linkLabelsPosition": {
      "50_54_#default#": 0.34,
      "59_49_âœ… Yes": 0.1,
      "59_9_âŒ No": 0.21,
      "60_6_âŒ No": 0.49
    },
    "paper": {
      "dimensions": {
        "height": 6015,
        "width": 4160,
        "x": -2120,
        "y": -2600
      }
    }
  }
inputs:
- key: Notify Manager
  value:
    simple: "Yes"
  required: false
  description: Notify user's manager
  playbookInputQuery:
- key: ShadowITIndicatorTags
  value:
    simple: ShadowIT
  required: false
  description: Tags to add to indicators to identify potential Shadow IT assets
  playbookInputQuery:
- key: ManagerNotificationSubjectPrefix
  value:
    simple: 'Shadow IT asset detected - owned by '
  required: false
  description: This input is added as prefix to the owner name to build the subject
    of the email sent to the owner's manager.
  playbookInputQuery:
- key: ManagerNotificationBody
  value:
    simple: |-
      Dear ${UserManagerDisplayName},

      we detected a Shadow IT service for User ${incident.shadowitaccountownername} who, according to the Company's directory, directly reports to you.

      The service is: ${shadowitip}:${shadowitport} (${shadowitfqdn}), please work with your team and us to resolve this issue.

      Best regards,

      InfoSec team
  required: false
  description: Body of the email to send to the owner's manager.
  playbookInputQuery:
outputs: []
tests:
- No tests (auto formatted)
fromversion: 6.0.0
