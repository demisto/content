description: Handle Shadow IT incident
id: Handle Shadow IT Incident
inputs:
- description: Enable Automated Prisma Cloud Onboarding
  key: AutomatedPrismaCloudOnboarding
  playbookInputQuery:
  required: false
  value:
    simple: "false"
- description: Link to CloudFormation Template for AWS MONITOR mode
  key: AWSCFTLinkMonitor
  playbookInputQuery:
  required: false
  value:
    simple: https://redlock-public.s3.amazonaws.com/cft/rl-read-only.template
- description: Link to CloudFormation Template for AWS MONITOR and PROTECT mode
  key: AWSCFTLinkMonitorAndProtect
  playbookInputQuery:
  required: false
  value:
    simple: https://redlock-public.s3.amazonaws.com/cft/rl-read-only.template
- description: Notify user's manager
  key: Notify Manager
  playbookInputQuery:
  required: false
  value:
    simple: "Yes"
- description: Tags to add to indicators to identify potential Shadow IT assets
  key: ShadowITIndicatorTags
  playbookInputQuery:
  required: false
  value:
    simple: ShadowIT
name: Handle Shadow IT Incident
outputs: []
starttaskid: "0"
tasks:
  "0":
    id: "0"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "2"
      - "59"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: acb37e7c-8d8d-4b3f-88d6-cc36d16b7e4f
      iscommand: false
      name: ""
      version: -1
      description: ''
    taskid: acb37e7c-8d8d-4b3f-88d6-cc36d16b7e4f
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 265,
          "y": -2600
        }
      }
  "1":
    evidencedata:
      customfields: {}
      description:
        simple: Shadow IT Asset Questionnaire
    form:
      description: |-
        ## Please urgently fill the form below.


        Best regards,
        **Your Company Infosec Team**
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Do you own this asset? ${incident.shadowitip}:${incident.shadowitport}
            (${incident.shadowitfqdn})
        options: []
        optionsarg:
        - {}
        - simple: "Yes"
        - simple: "No"
        placeholder: ""
        readonly: false
        required: true
        tooltip: Please confirm you are the current owner of this asset
        type: singleSelect
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "1"
        label: ""
        labelarg:
          simple: Is this a service sanctioned by InfoSec?
        options: []
        optionsarg:
        - {}
        - simple: "No"
        - simple: "Yes"
        placeholder: ""
        readonly: false
        required: true
        tooltip: Please confirm this service is allowed by InfoSec
        type: singleSelect
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "2"
        label: ""
        labelarg:
          simple: Is this service being billed to Corporate?
        options: []
        optionsarg:
        - {}
        - simple: "No"
        - simple: "Yes"
        placeholder: ""
        readonly: false
        required: true
        tooltip: Please confirm this service is being billed directly to corporate
          via existing procurement process.
        type: singleSelect
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "3"
        label: ""
        labelarg:
          simple: Does this service host sensitive corporate information?
        options: []
        optionsarg:
        - simple: "Yes"
        - simple: "No"
        placeholder: ""
        readonly: false
        required: true
        tooltip: Please confirm whether this service hosts sensitive company information.
        type: singleSelect
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "4"
        label: ""
        labelarg:
          simple: What is the purpose of this service?
        options: []
        optionsarg:
        - simple: Marketing
        - simple: Business Development
        - simple: Engineering
        - simple: Sales
        - simple: Other (please specify in the next question)
        placeholder: ""
        readonly: false
        required: true
        tooltip: Confirm the purpose of this service
        type: multiSelect
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "5"
        label: ""
        labelarg:
          simple: If other, please state the purpose of this service.
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: false
        tooltip: Please state the purpose of this service
        type: shortText
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "6"
        label: ""
        labelarg:
          simple: What Provider is this service Hosted on?
        options: []
        optionsarg:
        - simple: Google Cloud Platform
        - simple: Amazon Web Services
        - simple: Microsoft Azure
        - simple: Alibaba Cloud
        - simple: Oracle Cloud
        - simple: IBM Cloud
        - simple: Corporate Network (On Prem)
        - simple: Other/Unknown
        placeholder: ""
        readonly: false
        required: true
        tooltip: Please specify the Service Provider
        type: singleSelect
      sender: ""
      title: Shadow IT Information Collection
      totalanswers: 0
    id: "1"
    ignoreworker: false
    message:
      bcc:
      body:
        simple: |-
          Dear ${incident.shadowitaccountownername},

          we have identified an asset that might be associated to you.

          IP Address: ${incident.shadowitip}
          Port: ${incident.shadowitport}
          FQDN (if present): ${incident.shadowitfqdn}

          Please urgently fill the form linked to this email.


          Best regards,
          Your Company Infosec Team
      cc:
        complex:
          accessor: shadowitoucontactemail
          root: incident
      format: ""
      methods:
      - email
      subject:
        complex:
          accessor: shadowitip
          root: incident
          transformers:
          - args:
              prefix:
                value:
                  simple: 'Shadow IT Detected - please provide details for asset '
              suffix:
                iscontext: true
            operator: concat
      timings:
        completeafterreplies: 1
        retriescount: 2
        retriesinterval: 360
      to:
        complex:
          accessor: shadowitaccountowneremail
          root: incident
    nexttasks:
      '#none#':
      - "41"
    note: true
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cce6ef77-3c17-4220-81df-08316490a535
      iscommand: false
      name: Collect Service details from Asset owner
      type: collection
      version: -1
      description: Collect details about a service from the owner of the asset.
    taskid: cce6ef77-3c17-4220-81df-08316490a535
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 265,
          "y": -710
        }
      }
  "2":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: shadowitaccountowneremail
                root: incident
          operator: isNotEmpty
      label: "yes"
    id: "2"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "57"
      "yes":
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 75635a7b-bcbf-443c-82ad-e131b79306c4
      iscommand: false
      name: Is owner known?
      type: condition
      version: -1
      description: Check whether the owner of the asset is known.
    taskid: 75635a7b-bcbf-443c-82ad-e131b79306c4
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 265,
          "y": -2310
        }
      }
  "3":
    evidencedata:
      customfields: {}
      description:
        simple: Potential Asset Owners
    id: "3"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "32"
    note: true
    quietmode: 0
    scriptarguments:
      columns: {}
      data:
        complex:
          accessor: shadowitusersuggestions
          root: incident
      title:
        simple: Potential Asset Owners
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Convert an array to a nice table display. Usually, from the context.
      id: d49cb5f4-47f3-4bc6-8ed3-b38a5f4c4625
      iscommand: false
      name: Print Potential Asset Owners
      script: ToTable
      type: regular
      version: -1
    taskid: d49cb5f4-47f3-4bc6-8ed3-b38a5f4c4625
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 750,
          "y": -1950
        }
      }
  "4":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.AutomatedPrismaCloudOnboarding
          operator: isEqualString
          right:
            value:
              simple: "true"
      label: "yes"
    id: "4"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "60"
      "yes":
      - "5"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8eeebf53-339c-4ec9-897b-210e55e86c2e
      iscommand: false
      name: Automated onboarding enabled?
      type: condition
      version: -1
      description: Check whether Automated Prisma Cloud Onboarding is enabled.
    taskid: 8eeebf53-339c-4ec9-897b-210e55e86c2e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1335
        }
      }
  "5":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: shadowitcloudaccounttype
                root: incident
          operator: inList
          right:
            value:
              simple: aws,amazon,amazon web services
      label: AWS
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: shadowitcloudaccounttype
                root: incident
          operator: inList
          right:
            value:
              simple: gcp,google,google cloud platform
      label: GCP
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: shadowitcloudaccounttype
                root: incident
          operator: inList
          right:
            value:
              simple: microsoft,azure,microsoft azure,msft
      label: AZURE
    id: "5"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "12"
      AWS:
      - "15"
      AZURE:
      - "13"
      GCP:
      - "14"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 487c56b7-cb3b-43a9-8e94-300f6de69f67
      iscommand: false
      name: Cloud Type
      type: condition
      version: -1
      description: Select appropriate branch depending on Cloud Provider
    taskid: 487c56b7-cb3b-43a9-8e94-300f6de69f67
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1790
        }
      }
  "6":
    id: "6"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Manually onboard the account in Prisma Cloud
      id: 4a7090ba-fe42-40ca-81bc-6b842aa6d6e0
      iscommand: false
      name: Manually handling of Shadow IT incident
      type: regular
      version: -1
    taskid: 4a7090ba-fe42-40ca-81bc-6b842aa6d6e0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 990,
          "y": 2450
        }
      }
  "7":
    id: "7"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: abbd91ae-2e29-4c3d-8d90-ecd8ff5bc802
      iscommand: false
      name: Prisma Cloud Onboarding
      type: title
      version: -1
      description: ''
    taskid: abbd91ae-2e29-4c3d-8d90-ecd8ff5bc802
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1175
        }
      }
  "8":
    id: "8"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "7"
      - "43"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 425488d6-e94f-4ccf-8f1e-44651f6753da
      iscommand: false
      name: Done Collecting Information
      type: title
      version: -1
      description: ''
    taskid: 425488d6-e94f-4ccf-8f1e-44651f6753da
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 265,
          "y": 930
        }
      }
  "9":
    id: "9"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 123a8841-6a67-46bc-8fb1-eca4fb423859
      iscommand: false
      name: Collect information
      type: title
      version: -1
      description: ''
    taskid: 123a8841-6a67-46bc-8fb1-eca4fb423859
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 265,
          "y": -880
        }
      }
  "10":
    id: "10"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "62"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2bd6cdee-468e-43b0-8428-a3792a5ff451
      iscommand: false
      name: Done Prisma Cloud Onboarding
      type: title
      version: -1
      description: ''
    taskid: 2bd6cdee-468e-43b0-8428-a3792a5ff451
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 170,
          "y": 5460
        }
      }
  "11":
    id: "11"
    ignoreworker: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c7a242a8-935c-4347-80b1-aebe351d0cde
      iscommand: false
      name: Done
      type: title
      version: -1
      description: ''
    taskid: c7a242a8-935c-4347-80b1-aebe351d0cde
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 170,
          "y": 5780
        }
      }
  "12":
    id: "12"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: '## Cannot automatically onboard Cloud Account of type ${incident.shadowitcloudaccounttype},
          please onboard manually.'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Prints text to war room (Markdown supported)
      id: 8674e171-6c3d-4d05-8779-b449fe3da121
      iscommand: false
      name: Print manual onboard message
      script: Print
      type: regular
      version: -1
    taskid: 8674e171-6c3d-4d05-8779-b449fe3da121
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 675,
          "y": 2170
        }
      }
  "13":
    id: "13"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: '## Cannot automatically onboard Cloud Account of type Azure, please
          onboard manually.'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Prints text to war room (Markdown supported)
      id: eec50890-b481-46a0-835e-4062f9731417
      iscommand: false
      name: AZURE NOT SUPPORTED YET
      script: Print
      type: regular
      version: -1
    taskid: eec50890-b481-46a0-835e-4062f9731417
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2170
        }
      }
  "14":
    id: "14"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: '## Cannot automatically onboard Cloud Account of type GCP, please
          onboard manually.'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Prints text to war room (Markdown supported)
      id: b59a8f66-e19c-47ee-8357-4e7141fe72d4
      iscommand: false
      name: GCP NOT SUPPORTED YET
      script: Print
      type: regular
      version: -1
    taskid: b59a8f66-e19c-47ee-8357-4e7141fe72d4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -170,
          "y": 2170
        }
      }
  "15":
    id: "15"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 408206d7-603e-4708-8efb-de020edd4ce5
      iscommand: false
      name: AWS Automated Onboarding
      type: title
      version: -1
      description: ''
    taskid: 408206d7-603e-4708-8efb-de020edd4ce5
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -730,
          "y": 2090
        }
      }
  "16":
    id: "16"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 89219ff8-85a9-4440-82f6-604adc86e9e7
      iscommand: false
      name: Done AWS Automated Onboarding
      type: title
      version: -1
      description: ''
    taskid: 89219ff8-85a9-4440-82f6-604adc86e9e7
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -730,
          "y": 4990
        }
      }
  "17":
    id: "17"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: List account groups
      id: 6e0845e6-db46-46d7-80ea-d3bdd97d3baf
      iscommand: true
      name: List Prisma Cloud Account Groups
      script: '|||redlock-list-account-groups'
      type: regular
      version: -1
    taskid: 6e0845e6-db46-46d7-80ea-d3bdd97d3baf
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -730,
          "y": 2240
        }
      }
  "18":
    id: "18"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      columns:
        simple: id,description
      data:
        complex:
          accessor: AccountGroup
          root: Redlock
      title:
        simple: Available Account Groups
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Convert an array to a nice table display. Usually, from the context.
      id: e4fbf628-ef3f-46c0-8efd-6bed84cd9905
      iscommand: false
      name: Print Available Account Groups
      script: ToTable
      type: regular
      version: -1
    taskid: e4fbf628-ef3f-46c0-8efd-6bed84cd9905
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -730,
          "y": 2410
        }
      }
  "19":
    evidencedata:
      customfields: {}
      description:
        simple: AWS Account details from End User
    form:
      description: "To onboard your AWS account in Prisma Cloud, is run a CloudFormation\
        \ template that will create the proper permissions. \n\nProvide here the AWS\
        \ Account ID and RRN.\n\n\nThe process is as follows:\n1. Create Stack in\
        \ your AWS master account (see the Stack link below)\n1. Select I acknowledge\
        \ that AWS CloudFormation might create IAM resources with custom names and\
        \ click Create Stack\n1. When status is CREATE_COMPLETE, copy Role ARN from\
        \ Outputs Tab"
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Provide the AWS Account ID for this asset
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: Please provide the AWS Account ID for Prisma Cloud onboarding
        type: shortText
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "1"
        label: ""
        labelarg:
          complex:
            root: CFTLink
            transformers:
            - args:
                prefix:
                  value:
                    simple: 'Role RRN (CloudFormation link: '
                suffix:
                  value:
                    simple: ' )'
              operator: concat
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: Enter the Role RRN of the Role you have created in Prisma Cloud.
          See instructions above to use CloudFormation template.
        type: shortText
      sender: ""
      title: Prisma Cloud Automated Onboarding - AWS
      totalanswers: 0
    id: "19"
    ignoreworker: false
    message:
      bcc:
      body:
        simple: |-
          Dear ${incident.shadowitaccountownername},

          It is required by our policies that you onboard your Amazon Web Services account immediately in Prisma Cloud for additional protection.

          Please follow the instructions provided in the form to proceed with the automated onboarding.

          For any questions reach out to the InfoSec team.

          Best regards,

          DBot
      cc:
        simple: fvigo@paloaltonetworks.com
      format: ""
      methods:
      - email
      subject:
        simple: Prisma Cloud Automated Onboarding
      timings:
        completeafterreplies: 1
        retriescount: 2
        retriesinterval: 360
      to:
        simple: ${incident.shadowitaccountowneremail}
    nexttasks:
      '#none#':
      - "61"
    note: true
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b009797d-ccda-44d5-8fc5-296f07fe7210
      iscommand: false
      name: Collect Cloud Account ID RRN from User for AWS Onboarding
      type: collection
      version: -1
      description: Collect information for AWS account onboarding.
    taskid: b009797d-ccda-44d5-8fc5-296f07fe7210
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": -730,
          "y": 4430
        }
      }
  "20":
    id: "20"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "21"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Generates  Random UUID (UUID 4)
      id: 4eda6fda-f614-4981-8684-0036c20351f8
      iscommand: false
      name: Generate Random UUID
      script: GenerateRandomUUID
      type: regular
      version: -1
    taskid: 4eda6fda-f614-4981-8684-0036c20351f8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -730,
          "y": 2600
        }
      }
  "21":
    form:
      description: This process will prepare the right questionnaire to send to the
        target user to set up their AWS cloud account in Prisma Cloud.
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Account Name
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: 'Enter a descriptive name for the cloud account and choose whether
          you want the service to only monitor your AWS account or monitor and protect
          it with auto-remediation. '
        type: shortText
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "1"
        label: ""
        labelarg:
          simple: Select Account Group
        options: []
        optionsarg:
        - complex:
            accessor: name
            root: Redlock.AccountGroup
        placeholder: ""
        readonly: false
        required: true
        tooltip: Select the Prisma Cloud account group from the list of existing groups
        type: singleSelect
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "2"
        label: ""
        labelarg:
          simple: Protection mode
        options: []
        optionsarg:
        - {}
        - simple: MONITOR
        - simple: MONITOR_AND_PROTECT
        placeholder: ""
        readonly: false
        required: true
        tooltip: Choose whether you want the service to only monitor your AWS account
          or monitor and protect it with auto-remediation.
        type: singleSelect
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "3"
        label: ""
        labelarg:
          simple: External ID to use
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: false
        tooltip: This is a random UUID that will be used to match permissions. Leave
          blank to use the autogenerated one.
        type: shortText
      sender: ""
      title: Prisma Cloud Account Setup - AWS
      totalanswers: 0
    id: "21"
    ignoreworker: false
    message:
      bcc:
      body:
        simple: Please provide onboarding information for this AWS account
      cc:
      format: ""
      methods:
      - email
      subject:
        simple: Prisma Cloud Account Setup - AWS
      timings:
        completeafterreplies: 1
        retriescount: 2
        retriesinterval: 360
      to:
        simple: Analyst
    nexttasks:
      '#none#':
      - "30"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a9d6e53f-fdda-4553-8d9a-fa6389c08e23
      iscommand: false
      name: Ask Information to Analyst
      type: collection
      version: -1
      description: Ask the Analyst to select the Prisma Cloud Account Group and monitor type.
    taskid: a9d6e53f-fdda-4553-8d9a-fa6389c08e23
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": -730,
          "y": 2790
        }
      }
  "22":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "3"
                root: Prisma Cloud Account Setup - AWS.Answers
          operator: isNotEmpty
      label: "yes"
    id: "22"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "24"
      "yes":
      - "23"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 241c2497-53c2-4512-8d5f-6d558a1b6a07
      iscommand: false
      name: Use Provided Entry ID?
      type: condition
      version: -1
      description: Are we using the provided Entry ID for onboarding?
    taskid: 241c2497-53c2-4512-8d5f-6d558a1b6a07
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -730,
          "y": 3190
        }
      }
  "23":
    id: "23"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    scriptarguments:
      append: {}
      key:
        simple: ExternalID
      stringify: {}
      value:
        complex:
          accessor: "3"
          root: Prisma Cloud Account Setup - AWS.Answers
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 36b881dc-dbf8-4eda-86f8-3c714b29b048
      iscommand: false
      name: Set ExternalID with provided value
      script: Set
      type: regular
      version: -1
    taskid: 36b881dc-dbf8-4eda-86f8-3c714b29b048
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -950,
          "y": 3390
        }
      }
  "24":
    id: "24"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    scriptarguments:
      append: {}
      key:
        simple: ExternalID
      stringify: {}
      value:
        complex:
          root: GeneratedUUID
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 82730fe0-5846-4cdd-84c0-297a656abb42
      iscommand: false
      name: Set ExternalID with Random UUID
      script: Set
      type: regular
      version: -1
    taskid: 82730fe0-5846-4cdd-84c0-297a656abb42
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -430,
          "y": 3390
        }
      }
  "25":
    id: "25"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: e96bc1e9-8bb1-4055-84e1-4515aa0a4fce
      iscommand: false
      name: Generate CloudFormation Link
      type: title
      version: -1
    taskid: e96bc1e9-8bb1-4055-84e1-4515aa0a4fce
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -730,
          "y": 3610
        }
      }
  "26":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: "2"
                root: Prisma Cloud Account Setup - AWS.Answers
          operator: isEqualString
          right:
            value:
              simple: MONITOR
      label: MONITOR
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: "2"
                root: Prisma Cloud Account Setup - AWS.Answers
          operator: isEqualString
          right:
            value:
              simple: MONITOR_AND_PROTECT
      label: MONITOR_AND_PROTECT
    id: "26"
    ignoreworker: false
    nexttasks:
      MONITOR:
      - "27"
      MONITOR_AND_PROTECT:
      - "28"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5bdeb974-ddfb-4dc2-8712-bdda3cecf472
      iscommand: false
      name: Check Protection type
      type: condition
      version: -1
      description: Check the protection type (MONITOR or MONITOR AND PROTECT)
    taskid: 5bdeb974-ddfb-4dc2-8712-bdda3cecf472
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -730,
          "y": 3750
        }
      }
  "27":
    id: "27"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    scriptarguments:
      append: {}
      key:
        simple: CFTLink
      stringify: {}
      value:
        complex:
          root: inputs.AWSCFTLinkMonitor
          transformers:
          - args:
              prefix:
                value:
                  simple: https://us-east-1.console.aws.amazon.com/cloudformation/home?region=us-east-1#/stacks/create/review?templateURL=
              suffix:
                value:
                  simple: '&stackName=PrismaCloudApp&param_ExternalID='
            operator: concat
          - args:
              prefix: {}
              suffix:
                iscontext: true
                value:
                  simple: ${ExternalID}
            operator: concat
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 922ace4f-ae8e-42ff-8029-84a47381ad22
      iscommand: false
      name: Create Monitor CFT Link
      script: Set
      type: regular
      version: -1
    taskid: 922ace4f-ae8e-42ff-8029-84a47381ad22
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -950,
          "y": 3970
        }
      }
  "28":
    id: "28"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    scriptarguments:
      append: {}
      key:
        simple: CFTLink
      stringify: {}
      value:
        complex:
          root: inputs.AWSCFTLinkMonitorAndProtect
          transformers:
          - args:
              prefix:
                value:
                  simple: https://us-east-1.console.aws.amazon.com/cloudformation/home?region=us-east-1#/stacks/create/review?templateURL=
              suffix:
                value:
                  simple: '&stackName=PrismaCloudApp&param_ExternalID='
            operator: concat
          - args:
              prefix: {}
              suffix:
                iscontext: true
                value:
                  simple: ${ExternalID}
            operator: concat
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 3a1245ac-3c10-4fb4-81ef-228808b78888
      iscommand: false
      name: Create Monitor and Protect CFT Link
      script: Set
      type: regular
      version: -1
    taskid: 3a1245ac-3c10-4fb4-81ef-228808b78888
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -430,
          "y": 3970
        }
      }
  "29":
    id: "29"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f6de9af4-2f35-4650-89e4-b0c65fc1bd04
      iscommand: false
      name: CloudFormation Link Generated
      type: title
      version: -1
      description: ''
    taskid: f6de9af4-2f35-4650-89e4-b0c65fc1bd04
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -730,
          "y": 4260
        }
      }
  "30":
    id: "30"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    scriptarguments:
      append: {}
      key:
        simple: TargetAccountGroupId
      stringify: {}
      value:
        complex:
          accessor: id
          filters:
          - - left:
                iscontext: true
                value:
                  simple: Redlock.AccountGroup.name
              operator: isEqualString
              right:
                iscontext: true
                value:
                  simple: Prisma Cloud Account Setup - AWS.Answers.1
          root: Redlock.AccountGroup
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 8b86390d-21ea-40b3-83a1-a52debf7fc43
      iscommand: false
      name: Set Target Account Group ID
      script: Set
      type: regular
      version: -1
    taskid: 8b86390d-21ea-40b3-83a1-a52debf7fc43
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -730,
          "y": 2980
        }
      }
  "31":
    id: "31"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      account_id:
        complex:
          accessor: "0"
          root: Prisma Cloud Automated Onboarding - AWS.Answers
      account_type:
        simple: account
      external_id:
        complex:
          root: ExternalID
      group_ids:
        complex:
          root: TargetAccountGroupId
      member_external_id: {}
      member_role_name: {}
      member_role_status: {}
      name:
        complex:
          accessor: "0"
          root: Prisma Cloud Account Setup - AWS.Answers
      protection_mode:
        complex:
          accessor: "2"
          root: Prisma Cloud Account Setup - AWS.Answers
      role_arn:
        complex:
          accessor: "1"
          root: Prisma Cloud Automated Onboarding - AWS.Answers
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Add new AWS Account
      id: 64def290-996c-47ce-8844-ccebdaf75bec
      iscommand: true
      name: Add AWS Account in Prisma Cloud
      script: '|||redlock-add-aws-account'
      type: regular
      version: -1
    taskid: 64def290-996c-47ce-8844-ccebdaf75bec
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -730,
          "y": 4790
        }
      }
  "32":
    form:
      description: Choose asset owner from the list or select add new.
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Choose asset owner
        options: []
        optionsarg:
        - complex:
            accessor: shadowitusersuggestions
            root: incident
            transformers:
            - args:
                field:
                  value:
                    simple: name
              operator: getField
        - simple: ➕ Add New
        placeholder: ""
        readonly: false
        required: false
        tooltip: Choose asset owner from the list or select add new.
        type: singleSelect
      sender: ""
      title: 'Shadow IT: Choose asset owner'
      totalanswers: 0
    id: "32"
    ignoreworker: false
    message:
      bcc:
      body:
        simple: Please choose an asset owner from the list or select add new.
      cc:
      format: ""
      methods: []
      subject:
        simple: 'Shadow IT: Choose asset owner'
      timings:
        completeafterreplies: 1
        retriescount: 2
        retriesinterval: 360
      to:
        simple: Analyst
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7212a524-a998-4dc0-8929-6fadb6b3f42a
      iscommand: false
      name: Choose Asset Owner
      type: collection
      version: -1
      description: Ask the Analyst to select the owner of the asset.
    taskid: 7212a524-a998-4dc0-8929-6fadb6b3f42a
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 750,
          "y": -1790
        }
      }
  "33":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: 'Shadow IT: Choose asset owner.Answers'
          operator: containsString
          right:
            value:
              simple: Add New
      label: ADD-NEW
    id: "33"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "36"
      ADD-NEW:
      - "34"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2ecd2ee8-a545-440a-856b-683d822714d0
      iscommand: false
      name: Add new owner?
      type: condition
      version: -1
      description: Shall we add a new owner for this asset?
    taskid: 2ecd2ee8-a545-440a-856b-683d822714d0
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 750,
          "y": -1630
        }
      }
  "34":
    form:
      description: Please Insert asset owner name and email.
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Asset owner name
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: Please insert asset owner name.
        type: shortText
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "1"
        label: ""
        labelarg:
          simple: Asset owner email
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: Please insert asset owner n email.
        type: shortText
      sender: ""
      title: 'Shadow IT: Insert asset owner name and email'
      totalanswers: 0
    id: "34"
    ignoreworker: false
    message:
      bcc:
      body:
        simple: Please Insert asset owner name and email
      cc:
      format: ""
      methods: []
      subject:
        simple: 'Shadow IT: Insert asset owner name and email'
      timings:
        completeafterreplies: 1
        retriescount: 2
        retriesinterval: 360
      to:
        simple: Analyst
    nexttasks:
      '#none#':
      - "35"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 326d308c-cb5f-476d-8a9a-df063de9388e
      iscommand: false
      name: Insert owner name and email
      type: collection
      version: -1
      description: Ask the user to provide asset owner's name and email.
    taskid: 326d308c-cb5f-476d-8a9a-df063de9388e
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 1030,
          "y": -1440
        }
      }
  "35":
    id: "35"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "58"
    note: false
    quietmode: 0
    scriptarguments:
      accountid: {}
      accountname: {}
      addLabels: {}
      agentid: {}
      app: {}
      appendMultiSelect: {}
      assetid: {}
      assigneduser: {}
      assignmentgroup: {}
      attachmentcount: {}
      attachmentextension: {}
      attachmenthash: {}
      attachmentid: {}
      attachmentname: {}
      attachmentsize: {}
      attachmenttype: {}
      blockedaction: {}
      bugtraq: {}
      caller: {}
      city: {}
      closeNotes: {}
      closeReason: {}
      cloudservice: {}
      commandline: {}
      costcenter: {}
      costcentercode: {}
      country: {}
      countryname: {}
      criticalassets: {}
      customFields: {}
      cve: {}
      cvss: {}
      dbotMirrorDirection: {}
      dbotMirrorId: {}
      dbotMirrorInstance: {}
      dbotMirrorTags: {}
      dbotprediction: {}
      dbotpredictionprobability: {}
      dbottextsuggestionhighlighted: {}
      deleteEmptyField: {}
      department: {}
      dest: {}
      desthostname: {}
      destinationhostname: {}
      destinationip: {}
      destinationnetwork: {}
      destinationport: {}
      destntdomain: {}
      destos: {}
      details: {}
      detectedexternalhosts: {}
      detectedexternalips: {}
      detectedinternalhosts: {}
      detectedinternalips: {}
      detectedusers: {}
      detectionendtime: {}
      detectionid: {}
      detectionupdatetime: {}
      detectionurl: {}
      deviceexternalip: {}
      devicehash: {}
      devicelocalip: {}
      devicemodel: {}
      devicename: {}
      displayname: {}
      duration: {}
      email: {}
      emailauthenticitycheck: {}
      emailbcc: {}
      emailbody: {}
      emailbodyformat: {}
      emailbodyhtml: {}
      emailcc: {}
      emailclassification: {}
      emailclientname: {}
      emailfrom: {}
      emailheaders: {}
      emailhtml: {}
      emailinreplyto: {}
      emailkeywords: {}
      emailmessageid: {}
      emailreceived: {}
      emailreplyto: {}
      emailreturnpath: {}
      emailsenderip: {}
      emailsize: {}
      emailsource: {}
      emailsubject: {}
      emailto: {}
      emailtocount: {}
      emailurlclicked: {}
      employeedisplayname: {}
      employeeemail: {}
      employeemanageremail: {}
      escalation: {}
      eventaction: {}
      eventid: {}
      eventtype: {}
      externaladdresses: {}
      filehash: {}
      filename: {}
      filepath: {}
      filesize: {}
      firstname: {}
      firstseen: {}
      givenname: {}
      helloworldid: {}
      helloworldstatus: {}
      helloworldtype: {}
      hostname: {}
      id: {}
      incomingmirrorerror: {}
      infectedhosts: {}
      internaladdresses: {}
      investigationstage: {}
      isolated: {}
      jobcode: {}
      jobfamily: {}
      jobfunction: {}
      labels: {}
      lastmodifiedby: {}
      lastmodifiedon: {}
      lastname: {}
      lastseen: {}
      leadership: {}
      location: {}
      locationregion: {}
      logsource: {}
      macaddress: {}
      maliciousbehavior: {}
      malwarefamily: {}
      malwarename: {}
      manageremailaddress: {}
      managername: {}
      md5: {}
      mobiledevicemodel: {}
      mobilephone: {}
      name: {}
      occurred: {}
      os: {}
      osversion: {}
      outgoingmirrorerror: {}
      owner: {}
      parentprocessid: {}
      personalemail: {}
      phase: {}
      phishingsubtype: {}
      phonenumber: {}
      pid: {}
      policydeleted: {}
      policydescription: {}
      policydetails: {}
      policyid: {}
      policyrecommendation: {}
      policyremediable: {}
      policyseverity: {}
      policytype: {}
      prismacloudid: {}
      prismacloudreason: {}
      prismacloudrules: {}
      prismacloudstatus: {}
      prismacloudtime: {}
      protocol: {}
      protocols: {}
      quarantined: {}
      rating: {}
      region: {}
      regionid: {}
      replacePlaybook: {}
      reporteremailaddress: {}
      resourceapiname: {}
      resourcecloudtype: {}
      resourceid: {}
      resourcename: {}
      resourcetype: {}
      riskrating: {}
      riskscore: {}
      roles: {}
      rrn: {}
      samaccountname: {}
      severity: {}
      sha256: {}
      shadowitaccountowneremail:
        complex:
          accessor: "1"
          root: 'Shadow IT: Insert asset owner name and email.Answers'
      shadowitaccountownername:
        complex:
          accessor: "0"
          root: 'Shadow IT: Insert asset owner name and email.Answers'
      shadowitbilledtocorp: {}
      shadowitcertificate: {}
      shadowitcloudaccountid: {}
      shadowitcloudaccounttype: {}
      shadowitfqdn: {}
      shadowitip: {}
      shadowitorganizationalunit: {}
      shadowitoucontactemail: {}
      shadowitoucontactname: {}
      shadowitport: {}
      shadowitprovider: {}
      shadowitrisk: {}
      shadowitsactionedservice: {}
      shadowitsource: {}
      shadowusersuggestions: {}
      signature: {}
      skuname: {}
      skutier: {}
      sla: {}
      slaField: {}
      sourcehostname: {}
      sourceip: {}
      sourcenetwork: {}
      sourceport: {}
      sourceusername: {}
      src: {}
      srchostname: {}
      srcntdomain: {}
      srcos: {}
      srcuser: {}
      state: {}
      streetaddress: {}
      subcategory: {}
      subscriptionassignedby: {}
      subscriptioncreatedby: {}
      subscriptioncreatedon: {}
      subscriptiondescription: {}
      subscriptionid: {}
      subscriptionname: {}
      subscriptiontype: {}
      subscriptionupdatedby: {}
      subscriptionupdatedon: {}
      subtype: {}
      surname: {}
      systemdefault: {}
      systems: {}
      targetfirewallversion: {}
      tenantname: {}
      terminatedaction: {}
      threatactor: {}
      ticketcloseddate: {}
      ticketnumber: {}
      ticketopeneddate: {}
      title: {}
      triggeredsecurityprofile: {}
      type: {}
      uniqueports: {}
      urlsslverification: {}
      user: {}
      useraccountcontrol: {}
      username: {}
      vendorid: {}
      vendorproduct: {}
      vpcid: {}
      vulnerabilitycategory: {}
      workphone: {}
      xdralertcount: {}
      xdralerts: {}
      xdrassigneduseremail: {}
      xdrassigneduserprettyname: {}
      xdrdescription: {}
      xdrdetectiontime: {}
      xdrfileartifacts: {}
      xdrhighseverityalertcount: {}
      xdrhostcount: {}
      xdrincidentid: {}
      xdrlowseverityalertcount: {}
      xdrmediumseverityalertcount: {}
      xdrnetworkartifacts: {}
      xdrnotes: {}
      xdrresolvecomment: {}
      xdrstatus: {}
      xdrstatusv2: {}
      xdrurl: {}
      xdrusercount: {}
      zipcode: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: db0ae576-5567-4f01-8c66-acbc0b85d212
      iscommand: true
      name: Set asset owner name and email in incident
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: db0ae576-5567-4f01-8c66-acbc0b85d212
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1030,
          "y": -1250
        }
      }
  "36":
    id: "36"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "58"
    note: false
    quietmode: 0
    scriptarguments:
      accountid: {}
      accountname: {}
      addLabels: {}
      agentid: {}
      app: {}
      appendMultiSelect: {}
      assetid: {}
      assigneduser: {}
      assignmentgroup: {}
      attachmentcount: {}
      attachmentextension: {}
      attachmenthash: {}
      attachmentid: {}
      attachmentname: {}
      attachmentsize: {}
      attachmenttype: {}
      blockedaction: {}
      bugtraq: {}
      caller: {}
      city: {}
      closeNotes: {}
      closeReason: {}
      cloudservice: {}
      commandline: {}
      costcenter: {}
      costcentercode: {}
      country: {}
      countryname: {}
      criticalassets: {}
      customFields: {}
      cve: {}
      cvss: {}
      dbotMirrorDirection: {}
      dbotMirrorId: {}
      dbotMirrorInstance: {}
      dbotMirrorTags: {}
      dbotprediction: {}
      dbotpredictionprobability: {}
      dbottextsuggestionhighlighted: {}
      deleteEmptyField: {}
      department: {}
      dest: {}
      desthostname: {}
      destinationhostname: {}
      destinationip: {}
      destinationnetwork: {}
      destinationport: {}
      destntdomain: {}
      destos: {}
      details: {}
      detectedexternalhosts: {}
      detectedexternalips: {}
      detectedinternalhosts: {}
      detectedinternalips: {}
      detectedusers: {}
      detectionendtime: {}
      detectionid: {}
      detectionupdatetime: {}
      detectionurl: {}
      deviceexternalip: {}
      devicehash: {}
      devicelocalip: {}
      devicemodel: {}
      devicename: {}
      displayname: {}
      duration: {}
      email: {}
      emailauthenticitycheck: {}
      emailbcc: {}
      emailbody: {}
      emailbodyformat: {}
      emailbodyhtml: {}
      emailcc: {}
      emailclassification: {}
      emailclientname: {}
      emailfrom: {}
      emailheaders: {}
      emailhtml: {}
      emailinreplyto: {}
      emailkeywords: {}
      emailmessageid: {}
      emailreceived: {}
      emailreplyto: {}
      emailreturnpath: {}
      emailsenderip: {}
      emailsize: {}
      emailsource: {}
      emailsubject: {}
      emailto: {}
      emailtocount: {}
      emailurlclicked: {}
      employeedisplayname: {}
      employeeemail: {}
      employeemanageremail: {}
      escalation: {}
      eventaction: {}
      eventid: {}
      eventtype: {}
      externaladdresses: {}
      filehash: {}
      filename: {}
      filepath: {}
      filesize: {}
      firstname: {}
      firstseen: {}
      givenname: {}
      helloworldid: {}
      helloworldstatus: {}
      helloworldtype: {}
      hostname: {}
      id: {}
      incomingmirrorerror: {}
      infectedhosts: {}
      internaladdresses: {}
      investigationstage: {}
      isolated: {}
      jobcode: {}
      jobfamily: {}
      jobfunction: {}
      labels: {}
      lastmodifiedby: {}
      lastmodifiedon: {}
      lastname: {}
      lastseen: {}
      leadership: {}
      location: {}
      locationregion: {}
      logsource: {}
      macaddress: {}
      maliciousbehavior: {}
      malwarefamily: {}
      malwarename: {}
      manageremailaddress: {}
      managername: {}
      md5: {}
      mobiledevicemodel: {}
      mobilephone: {}
      name: {}
      occurred: {}
      os: {}
      osversion: {}
      outgoingmirrorerror: {}
      owner: {}
      parentprocessid: {}
      personalemail: {}
      phase: {}
      phishingsubtype: {}
      phonenumber: {}
      pid: {}
      policydeleted: {}
      policydescription: {}
      policydetails: {}
      policyid: {}
      policyrecommendation: {}
      policyremediable: {}
      policyseverity: {}
      policytype: {}
      prismacloudid: {}
      prismacloudreason: {}
      prismacloudrules: {}
      prismacloudstatus: {}
      prismacloudtime: {}
      protocol: {}
      protocols: {}
      quarantined: {}
      rating: {}
      region: {}
      regionid: {}
      replacePlaybook: {}
      reporteremailaddress: {}
      resourceapiname: {}
      resourcecloudtype: {}
      resourceid: {}
      resourcename: {}
      resourcetype: {}
      riskrating: {}
      riskscore: {}
      roles: {}
      rrn: {}
      samaccountname: {}
      severity: {}
      sha256: {}
      shadowitaccountowneremail:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: incident.shadowitusersuggestions.name
              operator: isEqualString
              right:
                iscontext: true
                value:
                  simple: 'Shadow IT: Choose asset owner.Answers.0'
          root: incident.shadowitusersuggestions
          transformers:
          - args:
              field:
                value:
                  simple: email
            operator: getField
      shadowitaccountownername:
        complex:
          accessor: "0"
          root: 'Shadow IT: Choose asset owner.Answers'
      shadowitbilledtocorp: {}
      shadowitcertificate: {}
      shadowitcloudaccountid: {}
      shadowitcloudaccounttype: {}
      shadowitfqdn: {}
      shadowitip: {}
      shadowitorganizationalunit: {}
      shadowitoucontactemail: {}
      shadowitoucontactname: {}
      shadowitport: {}
      shadowitprovider: {}
      shadowitrisk: {}
      shadowitsactionedservice: {}
      shadowitsensitivedata: {}
      shadowitservicepurpose: {}
      shadowitsource: {}
      shadowitusersuggestions: {}
      shadowusersuggestions: {}
      signature: {}
      skuname: {}
      skutier: {}
      sla: {}
      slaField: {}
      sourcehostname: {}
      sourceip: {}
      sourcenetwork: {}
      sourceport: {}
      sourceusername: {}
      src: {}
      srchostname: {}
      srcntdomain: {}
      srcos: {}
      srcuser: {}
      state: {}
      streetaddress: {}
      subcategory: {}
      subscriptionassignedby: {}
      subscriptioncreatedby: {}
      subscriptioncreatedon: {}
      subscriptiondescription: {}
      subscriptionid: {}
      subscriptionname: {}
      subscriptiontype: {}
      subscriptionupdatedby: {}
      subscriptionupdatedon: {}
      subtype: {}
      surname: {}
      systemdefault: {}
      systems: {}
      targetfirewallversion: {}
      tenantname: {}
      terminatedaction: {}
      threatactor: {}
      ticketcloseddate: {}
      ticketnumber: {}
      ticketopeneddate: {}
      title: {}
      triggeredsecurityprofile: {}
      type: {}
      uniqueports: {}
      urlsslverification: {}
      user: {}
      useraccountcontrol: {}
      username: {}
      vendorid: {}
      vendorproduct: {}
      vpcid: {}
      vulnerabilitycategory: {}
      workphone: {}
      xdralertcount: {}
      xdralerts: {}
      xdrassigneduseremail: {}
      xdrassigneduserprettyname: {}
      xdrdescription: {}
      xdrdetectiontime: {}
      xdrfileartifacts: {}
      xdrhighseverityalertcount: {}
      xdrhostcount: {}
      xdrincidentid: {}
      xdrlowseverityalertcount: {}
      xdrmediumseverityalertcount: {}
      xdrnetworkartifacts: {}
      xdrnotes: {}
      xdrresolvecomment: {}
      xdrstatus: {}
      xdrstatusv2: {}
      xdrurl: {}
      xdrusercount: {}
      zipcode: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: a52f046f-d903-4473-8cdf-174b2b4d1985
      iscommand: true
      name: Set asset owner name and email in incident
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: a52f046f-d903-4473-8cdf-174b2b4d1985
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 560,
          "y": -1250
        }
      }
  "37":
    id: "37"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "39"
    note: false
    quietmode: 0
    scriptarguments:
      accountid: {}
      accountname: {}
      addLabels: {}
      agentid: {}
      app: {}
      appendMultiSelect: {}
      assetid: {}
      assigneduser: {}
      assignmentgroup: {}
      attachmentcount: {}
      attachmentextension: {}
      attachmenthash: {}
      attachmentid: {}
      attachmentname: {}
      attachmentsize: {}
      attachmenttype: {}
      blockedaction: {}
      bugtraq: {}
      caller: {}
      city: {}
      closeNotes: {}
      closeReason: {}
      cloudservice: {}
      commandline: {}
      costcenter: {}
      costcentercode: {}
      country: {}
      countryname: {}
      criticalassets: {}
      customFields: {}
      cve: {}
      cvss: {}
      dbotMirrorDirection: {}
      dbotMirrorId: {}
      dbotMirrorInstance: {}
      dbotMirrorTags: {}
      dbotprediction: {}
      dbotpredictionprobability: {}
      dbottextsuggestionhighlighted: {}
      deleteEmptyField: {}
      department: {}
      dest: {}
      desthostname: {}
      destinationhostname: {}
      destinationip: {}
      destinationnetwork: {}
      destinationport: {}
      destntdomain: {}
      destos: {}
      details: {}
      detectedexternalhosts: {}
      detectedexternalips: {}
      detectedinternalhosts: {}
      detectedinternalips: {}
      detectedusers: {}
      detectionendtime: {}
      detectionid: {}
      detectionupdatetime: {}
      detectionurl: {}
      deviceexternalip: {}
      devicehash: {}
      devicelocalip: {}
      devicemodel: {}
      devicename: {}
      displayname: {}
      duration: {}
      email: {}
      emailauthenticitycheck: {}
      emailbcc: {}
      emailbody: {}
      emailbodyformat: {}
      emailbodyhtml: {}
      emailcc: {}
      emailclassification: {}
      emailclientname: {}
      emailfrom: {}
      emailheaders: {}
      emailhtml: {}
      emailinreplyto: {}
      emailkeywords: {}
      emailmessageid: {}
      emailreceived: {}
      emailreplyto: {}
      emailreturnpath: {}
      emailsenderip: {}
      emailsize: {}
      emailsource: {}
      emailsubject: {}
      emailto: {}
      emailtocount: {}
      emailurlclicked: {}
      employeedisplayname: {}
      employeeemail: {}
      employeemanageremail: {}
      escalation: {}
      eventaction: {}
      eventid: {}
      eventtype: {}
      externaladdresses: {}
      filehash: {}
      filename: {}
      filepath: {}
      filesize: {}
      firstname: {}
      firstseen: {}
      givenname: {}
      helloworldid: {}
      helloworldstatus: {}
      helloworldtype: {}
      hostname: {}
      id: {}
      incomingmirrorerror: {}
      infectedhosts: {}
      internaladdresses: {}
      investigationstage: {}
      isolated: {}
      jobcode: {}
      jobfamily: {}
      jobfunction: {}
      labels: {}
      lastmodifiedby: {}
      lastmodifiedon: {}
      lastname: {}
      lastseen: {}
      leadership: {}
      location: {}
      locationregion: {}
      logsource: {}
      macaddress: {}
      maliciousbehavior: {}
      malwarefamily: {}
      malwarename: {}
      manageremailaddress: {}
      managername: {}
      md5: {}
      mobiledevicemodel: {}
      mobilephone: {}
      name: {}
      occurred: {}
      os: {}
      osversion: {}
      outgoingmirrorerror: {}
      owner: {}
      parentprocessid: {}
      personalemail: {}
      phase: {}
      phishingsubtype: {}
      phonenumber: {}
      pid: {}
      policydeleted: {}
      policydescription: {}
      policydetails: {}
      policyid: {}
      policyrecommendation: {}
      policyremediable: {}
      policyseverity: {}
      policytype: {}
      prismacloudid: {}
      prismacloudreason: {}
      prismacloudrules: {}
      prismacloudstatus: {}
      prismacloudtime: {}
      protocol: {}
      protocols: {}
      quarantined: {}
      rating: {}
      region: {}
      regionid: {}
      replacePlaybook: {}
      reporteremailaddress: {}
      resourceapiname: {}
      resourcecloudtype: {}
      resourceid: {}
      resourcename: {}
      resourcetype: {}
      riskrating: {}
      riskscore: {}
      roles: {}
      rrn: {}
      samaccountname: {}
      severity: {}
      sha256: {}
      shadowitaccountowneremail: {}
      shadowitaccountownername: {}
      shadowitbilledtocorp:
        complex:
          accessor: "2"
          root: Shadow IT Information Collection.Answers
          transformers:
          - args:
              else:
                value:
                  simple: "false"
              equals:
                value:
                  simple: "Yes"
              then:
                value:
                  simple: "true"
            operator: If-Then-Else
      shadowitcertificate: {}
      shadowitcloudaccountid: {}
      shadowitcloudaccounttype:
        complex:
          accessor: "6"
          root: Shadow IT Information Collection.Answers
      shadowitfqdn: {}
      shadowitip: {}
      shadowitorganizationalunit: {}
      shadowitoucontactemail: {}
      shadowitoucontactname: {}
      shadowitport: {}
      shadowitprovider:
        complex:
          accessor: "6"
          root: Shadow IT Information Collection.Answers
      shadowitregion: {}
      shadowitrisk: {}
      shadowitsactionedservice:
        complex:
          accessor: "1"
          root: Shadow IT Information Collection.Answers
          transformers:
          - args:
              else:
                value:
                  simple: "false"
              equals:
                value:
                  simple: "Yes"
              then:
                value:
                  simple: "true"
            operator: If-Then-Else
      shadowitsensitivedata:
        complex:
          accessor: "3"
          root: Shadow IT Information Collection.Answers
          transformers:
          - args:
              else:
                value:
                  simple: "false"
              equals:
                value:
                  simple: "Yes"
              then:
                value:
                  simple: "true"
            operator: If-Then-Else
      shadowitservice: {}
      shadowitservicepurpose:
        complex:
          accessor: "4"
          root: Shadow IT Information Collection.Answers
      shadowitsource: {}
      shadowitusersuggestions: {}
      shadowusersuggestions: {}
      signature: {}
      skuname: {}
      skutier: {}
      sla: {}
      slaField: {}
      sourcehostname: {}
      sourceip: {}
      sourcenetwork: {}
      sourceport: {}
      sourceusername: {}
      src: {}
      srchostname: {}
      srcntdomain: {}
      srcos: {}
      srcuser: {}
      state: {}
      streetaddress: {}
      subcategory: {}
      subscriptionassignedby: {}
      subscriptioncreatedby: {}
      subscriptioncreatedon: {}
      subscriptiondescription: {}
      subscriptionid: {}
      subscriptionname: {}
      subscriptiontype: {}
      subscriptionupdatedby: {}
      subscriptionupdatedon: {}
      subtype: {}
      surname: {}
      systemdefault: {}
      systems: {}
      targetfirewallversion: {}
      tenantname: {}
      terminatedaction: {}
      threatactor: {}
      ticketcloseddate: {}
      ticketnumber: {}
      ticketopeneddate: {}
      title: {}
      triggeredsecurityprofile: {}
      type: {}
      uniqueports: {}
      urlsslverification: {}
      user: {}
      useraccountcontrol: {}
      username: {}
      vendorid: {}
      vendorproduct: {}
      vpcid: {}
      vulnerabilitycategory: {}
      workphone: {}
      xdralertcount: {}
      xdralerts: {}
      xdrassigneduseremail: {}
      xdrassigneduserprettyname: {}
      xdrdescription: {}
      xdrdetectiontime: {}
      xdrfileartifacts: {}
      xdrhighseverityalertcount: {}
      xdrhostcount: {}
      xdrincidentid: {}
      xdrlowseverityalertcount: {}
      xdrmediumseverityalertcount: {}
      xdrnetworkartifacts: {}
      xdrnotes: {}
      xdrresolvecomment: {}
      xdrstatus: {}
      xdrstatusv2: {}
      xdrurl: {}
      xdrusercount: {}
      zipcode: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: ef8c32c8-32b2-4933-8990-f9ff4eb06ce6
      iscommand: true
      name: Set Incident Information based on responses
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: ef8c32c8-32b2-4933-8990-f9ff4eb06ce6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": -305
        }
      }
  "39":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: "3"
                root: Shadow IT Information Collection.Answers
          operator: isEqualString
          right:
            value:
              simple: "yes"
      label: "yes"
    id: "39"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "8"
      "yes":
      - "40"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a96794c6-9070-4496-8679-7cbb37a86381
      iscommand: false
      name: Does the service contain sensitive information?
      type: condition
      version: -1
      description: Check whether the user confirmed that the service might contain sensitive data.
    taskid: a96794c6-9070-4496-8679-7cbb37a86381
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 265,
          "y": -80
        }
      }
  "40":
    id: "40"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      accountid: {}
      accountname: {}
      addLabels: {}
      agentid: {}
      app: {}
      appendMultiSelect: {}
      assetid: {}
      assigneduser: {}
      assignmentgroup: {}
      attachmentcount: {}
      attachmentextension: {}
      attachmenthash: {}
      attachmentid: {}
      attachmentname: {}
      attachmentsize: {}
      attachmenttype: {}
      blockedaction: {}
      bugtraq: {}
      caller: {}
      city: {}
      closeNotes: {}
      closeReason: {}
      cloudservice: {}
      commandline: {}
      costcenter: {}
      costcentercode: {}
      country: {}
      countryname: {}
      criticalassets: {}
      customFields: {}
      cve: {}
      cvss: {}
      dbotMirrorDirection: {}
      dbotMirrorId: {}
      dbotMirrorInstance: {}
      dbotMirrorTags: {}
      dbotprediction: {}
      dbotpredictionprobability: {}
      dbottextsuggestionhighlighted: {}
      deleteEmptyField: {}
      department: {}
      dest: {}
      desthostname: {}
      destinationhostname: {}
      destinationip: {}
      destinationnetwork: {}
      destinationport: {}
      destntdomain: {}
      destos: {}
      details: {}
      detectedexternalhosts: {}
      detectedexternalips: {}
      detectedinternalhosts: {}
      detectedinternalips: {}
      detectedusers: {}
      detectionendtime: {}
      detectionid: {}
      detectionupdatetime: {}
      detectionurl: {}
      deviceexternalip: {}
      devicehash: {}
      devicelocalip: {}
      devicemodel: {}
      devicename: {}
      displayname: {}
      duration: {}
      email: {}
      emailauthenticitycheck: {}
      emailbcc: {}
      emailbody: {}
      emailbodyformat: {}
      emailbodyhtml: {}
      emailcc: {}
      emailclassification: {}
      emailclientname: {}
      emailfrom: {}
      emailheaders: {}
      emailhtml: {}
      emailinreplyto: {}
      emailkeywords: {}
      emailmessageid: {}
      emailreceived: {}
      emailreplyto: {}
      emailreturnpath: {}
      emailsenderip: {}
      emailsize: {}
      emailsource: {}
      emailsubject: {}
      emailto: {}
      emailtocount: {}
      emailurlclicked: {}
      employeedisplayname: {}
      employeeemail: {}
      employeemanageremail: {}
      escalation: {}
      eventaction: {}
      eventid: {}
      eventtype: {}
      externaladdresses: {}
      filehash: {}
      filename: {}
      filepath: {}
      filesize: {}
      firstname: {}
      firstseen: {}
      givenname: {}
      helloworldid: {}
      helloworldstatus: {}
      helloworldtype: {}
      hostname: {}
      id: {}
      incomingmirrorerror: {}
      infectedhosts: {}
      internaladdresses: {}
      investigationstage: {}
      isolated: {}
      jobcode: {}
      jobfamily: {}
      jobfunction: {}
      labels: {}
      lastmodifiedby: {}
      lastmodifiedon: {}
      lastname: {}
      lastseen: {}
      leadership: {}
      location: {}
      locationregion: {}
      logsource: {}
      macaddress: {}
      maliciousbehavior: {}
      malwarefamily: {}
      malwarename: {}
      manageremailaddress: {}
      managername: {}
      md5: {}
      mobiledevicemodel: {}
      mobilephone: {}
      name: {}
      occurred: {}
      os: {}
      osversion: {}
      outgoingmirrorerror: {}
      owner: {}
      parentprocessid: {}
      personalemail: {}
      phase: {}
      phishingsubtype: {}
      phonenumber: {}
      pid: {}
      policydeleted: {}
      policydescription: {}
      policydetails: {}
      policyid: {}
      policyrecommendation: {}
      policyremediable: {}
      policyseverity: {}
      policytype: {}
      prismacloudid: {}
      prismacloudreason: {}
      prismacloudrules: {}
      prismacloudstatus: {}
      prismacloudtime: {}
      protocol: {}
      protocols: {}
      quarantined: {}
      rating: {}
      region: {}
      regionid: {}
      replacePlaybook: {}
      reporteremailaddress: {}
      resourceapiname: {}
      resourcecloudtype: {}
      resourceid: {}
      resourcename: {}
      resourcetype: {}
      riskrating: {}
      riskscore: {}
      roles: {}
      rrn: {}
      samaccountname: {}
      severity:
        simple: "4"
      sha256: {}
      shadowitaccountowneremail: {}
      shadowitaccountownername: {}
      shadowitbilledtocorp: {}
      shadowitcertificate: {}
      shadowitcloudaccountid: {}
      shadowitcloudaccounttype: {}
      shadowitfqdn: {}
      shadowitip: {}
      shadowitorganizationalunit: {}
      shadowitoucontactemail: {}
      shadowitoucontactname: {}
      shadowitport: {}
      shadowitprovider: {}
      shadowitrisk:
        simple: Critical
      shadowitsactionedservice: {}
      shadowitsensitivedata: {}
      shadowitservicepurpose: {}
      shadowitsource: {}
      shadowitusersuggestions: {}
      signature: {}
      skuname: {}
      skutier: {}
      sla: {}
      slaField: {}
      sourcehostname: {}
      sourceip: {}
      sourcenetwork: {}
      sourceport: {}
      sourceusername: {}
      src: {}
      srchostname: {}
      srcntdomain: {}
      srcos: {}
      srcuser: {}
      state: {}
      streetaddress: {}
      subcategory: {}
      subscriptionassignedby: {}
      subscriptioncreatedby: {}
      subscriptioncreatedon: {}
      subscriptiondescription: {}
      subscriptionid: {}
      subscriptionname: {}
      subscriptiontype: {}
      subscriptionupdatedby: {}
      subscriptionupdatedon: {}
      subtype: {}
      surname: {}
      systemdefault: {}
      systems: {}
      targetfirewallversion: {}
      tenantname: {}
      terminatedaction: {}
      threatactor: {}
      ticketcloseddate: {}
      ticketnumber: {}
      ticketopeneddate: {}
      title: {}
      triggeredsecurityprofile: {}
      type: {}
      uniqueports: {}
      urlsslverification: {}
      user: {}
      useraccountcontrol: {}
      username: {}
      vendorid: {}
      vendorproduct: {}
      vpcid: {}
      vulnerabilitycategory: {}
      workphone: {}
      xdralertcount: {}
      xdralerts: {}
      xdrassigneduseremail: {}
      xdrassigneduserprettyname: {}
      xdrdescription: {}
      xdrdetectiontime: {}
      xdrfileartifacts: {}
      xdrhighseverityalertcount: {}
      xdrhostcount: {}
      xdrincidentid: {}
      xdrlowseverityalertcount: {}
      xdrmediumseverityalertcount: {}
      xdrnetworkartifacts: {}
      xdrnotes: {}
      xdrresolvecomment: {}
      xdrstatus: {}
      xdrstatusv2: {}
      xdrurl: {}
      xdrusercount: {}
      zipcode: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: dc5c3050-471f-4c4c-898e-c90c42631e45
      iscommand: true
      name: Set Shadow IT Risk and Severity to Critical
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: dc5c3050-471f-4c4c-898e-c90c42631e45
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -30,
          "y": 170
        }
      }
  "41":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Shadow IT Information Collection.Answers
          operator: isEqualString
          right:
            value:
              simple: "yes"
      label: "yes"
    id: "41"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "42"
      "yes":
      - "37"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cb28bd35-3b02-4204-8b8f-066e04fdced1
      iscommand: false
      name: Did the user confirm they own the asset?
      type: condition
      version: -1
      description: Check whether the user confirmed to own this asset.
    taskid: cb28bd35-3b02-4204-8b8f-066e04fdced1
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 265,
          "y": -565
        }
      }
  "42":
    id: "42"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fcba29dc-f737-49dc-8388-f6e34afdf126
      iscommand: false
      name: Find owner and collect information manually
      type: regular
      version: -1
      description: The analyst must manually investigate this incidentand, find the owner and collect the service information.
    taskid: fcba29dc-f737-49dc-8388-f6e34afdf126
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 810,
          "y": -360
        }
      }
  "43":
    id: "43"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "45"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9b1d356d-400a-46fb-89a6-01b9220e6b3e
      iscommand: false
      name: Notify Manager
      type: title
      version: -1
      description: ''
    taskid: 9b1d356d-400a-46fb-89a6-01b9220e6b3e
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1660,
          "y": 1175
        }
      }
  "44":
    id: "44"
    ignoreworker: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "47"
    note: false
    quietmode: 0
    scriptarguments:
      UserEmail:
        complex:
          accessor: shadowitaccountowneremail
          root: incident
      Username: {}
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: 6ab155a2-9e30-4851-8e67-757f67640173
      iscommand: false
      name: Active Directory - Get User Manager Details
      playbookId: Active Directory - Get User Manager Details
      type: playbook
      version: -1
      description: ''
    taskid: 6ab155a2-9e30-4851-8e67-757f67640173
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1660,
          "y": 1695
        }
      }
  "45":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.Notify Manager
          operator: isEqualString
          right:
            value:
              simple: "yes"
      label: "yes"
    id: "45"
    ignoreworker: false
    nexttasks:
      "yes":
      - "44"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: eacd60ba-6324-4f40-80b5-7a57304f6834
      iscommand: false
      name: Shall we notify user's manager?
      type: condition
      version: -1
      description: Check whether to notify the user's manger.
    taskid: eacd60ba-6324-4f40-80b5-7a57304f6834
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1660,
          "y": 1470
        }
      }
  "46":
    id: "46"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3d34348f-1ad9-4b06-8518-d61b5b0e2df0
      iscommand: false
      name: Done Notify Manager
      type: title
      version: -1
      description: ''
    taskid: 3d34348f-1ad9-4b06-8518-d61b5b0e2df0
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1660,
          "y": 2760
        }
      }
  "47":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: UserManagerEmail
          operator: isNotEmpty
      label: "yes"
    id: "47"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "46"
      "yes":
      - "48"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ac6fbc8e-c76f-49ec-8de8-b8793ec2fcf3
      iscommand: false
      name: Did we find the user's manager?
      type: condition
      version: -1
      description: Check whether to notify the user's manager.
    taskid: ac6fbc8e-c76f-49ec-8de8-b8793ec2fcf3
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1660,
          "y": 1910
        }
      }
  "48":
    id: "48"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "46"
    note: false
    quietmode: 0
    scriptarguments:
      additionalHeader: {}
      attachCIDs: {}
      attachIDs: {}
      attachNames: {}
      bcc: {}
      body: {}
      cc: {}
      htmlBody:
        simple: |-
          Dear ${UserManagerDisplayName},

          we detected a Shadow IT service for User ${incident.shadowitaccountownername} who, according to the Company's directory, directly reports to you.

          The service is: ${shadowitip}:${shadowitport} (${shadowitfqdn}), please work with your team and us to resolve this issue.

          Best regards,

          InfoSec team
      raw_message: {}
      replyTo: {}
      subject:
        complex:
          accessor: shadowitaccountownername
          root: incident
      templateParams: {}
      to:
        complex:
          root: UserManagerEmail
      transientFile: {}
      transientFileCID: {}
      transientFileContent: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Send an email
      id: 78f3b707-6736-4443-8c50-0d3c9a1441ff
      iscommand: true
      name: Notify User's manager
      script: '|||send-mail'
      type: regular
      version: -1
    taskid: 78f3b707-6736-4443-8c50-0d3c9a1441ff
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1660,
          "y": 2170
        }
      }
  "49":
    id: "49"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "50"
      - "52"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: commands.local.cmd.find.indicators
      id: e85c9a1e-2b29-48db-8afa-543976a31b6e
      iscommand: false
      name: Tag Shadow IT Indicators
      type: title
      version: -1
    taskid: e85c9a1e-2b29-48db-8afa-543976a31b6e
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -1630,
          "y": 800
        }
      }
  "50":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: shadowitip
                root: incident
          operator: isNotEmpty
      label: "yes"
    id: "50"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "54"
      "yes":
      - "51"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 96e494d6-9f5e-4527-8f61-3d776e37794e
      iscommand: false
      name: Is there an IP?
      type: condition
      version: -1
      description: Check whether an IP address is part of the incident.
    taskid: 96e494d6-9f5e-4527-8f61-3d776e37794e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -2120,
          "y": 1030
        }
      }
  "51":
    id: "51"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "54"
    note: false
    quietmode: 0
    scriptarguments:
      extend-context:
        simple: ShadowITIndicator=
      fromdate: {}
      ignore-outputs:
        simple: "true"
      page: {}
      query: {}
      size: {}
      todate: {}
      value:
        complex:
          accessor: shadowitip
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: a4850543-626b-4e84-88bb-290b6477bffb
      iscommand: true
      name: Find IP Indicator
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: a4850543-626b-4e84-88bb-290b6477bffb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -2120,
          "y": 1240
        }
      }
  "52":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: shadowitfqdn
                root: incident
          operator: isNotEmpty
      label: "yes"
    id: "52"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "54"
      "yes":
      - "53"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1f02f00f-922b-47f6-80a7-1bd3b738fda9
      iscommand: false
      name: Is there a FQDN?
      type: condition
      version: -1
      description: Check whether an FQDN was provided with this incident.
    taskid: 1f02f00f-922b-47f6-80a7-1bd3b738fda9
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1230,
          "y": 1050
        }
      }
  "53":
    id: "53"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "54"
    note: false
    quietmode: 0
    scriptarguments:
      extend-context:
        simple: ShadowITIndicator=
      fromdate: {}
      ignore-outputs:
        simple: "true"
      page: {}
      query: {}
      size: {}
      todate: {}
      value:
        complex:
          accessor: shadowitfqdn
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.find.indicators
      id: 9f7d96d3-dddb-44f4-8ae5-3de9e9423202
      iscommand: true
      name: Find FQDN Indicator
      script: Builtin|||findIndicators
      type: regular
      version: -1
    taskid: 9f7d96d3-dddb-44f4-8ae5-3de9e9423202
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1230,
          "y": 1260
        }
      }
  "54":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ShadowITIndicator
          operator: isNotEmpty
      label: "yes"
    id: "54"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "56"
      "yes":
      - "55"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e2010a4c-27c3-4c44-8c48-650ea7d05bf3
      iscommand: false
      name: Are there Shadow IT Indicators?
      type: condition
      version: -1
      description: Check whether there are indicators labelled Shadow IT.
    taskid: e2010a4c-27c3-4c44-8c48-650ea7d05bf3
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1700,
          "y": 1480
        }
      }
  "55":
    id: "55"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "56"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        complex:
          root: inputs.ShadowITIndicatorTags
      indicatorsValues:
        complex:
          accessor: value
          root: ShadowITIndicator
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.add.values.to.indicator.multi.select.field
      id: faf16809-4eb7-4256-8a6c-b3d78048b9f9
      iscommand: true
      name: Tag Shadow IT Indicators
      script: Builtin|||appendIndicatorField
      type: regular
      version: -1
    taskid: faf16809-4eb7-4256-8a6c-b3d78048b9f9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -2020,
          "y": 1910
        }
      }
  "56":
    id: "56"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3723ac77-ab8d-4a05-8f6a-6994c1a977fb
      iscommand: false
      name: Done Tagging Shadow IT Indicators
      type: title
      version: -1
      description: ''
    taskid: 3723ac77-ab8d-4a05-8f6a-6994c1a977fb
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -1700,
          "y": 4180
        }
      }
  "57":
    id: "57"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4506c79e-9e5a-44d2-8e43-46719741b0ae
      iscommand: false
      name: Identify Owner
      type: title
      version: -1
      description: ''
    taskid: 4506c79e-9e5a-44d2-8e43-46719741b0ae
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 750,
          "y": -2090
        }
      }
  "58":
    id: "58"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a801736c-67cc-47ca-838e-8ee813793728
      iscommand: false
      name: Done Identifying Owner
      type: title
      version: -1
      description: ''
    taskid: a801736c-67cc-47ca-838e-8ee813793728
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 560,
          "y": -1070
        }
      }
  "59":
    defaultassigneecomplex:
      simple: Analyst
    id: "59"
    ignoreworker: false
    nexttasks:
      ✅ Yes:
      - "49"
      ❌ No:
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6e332cd2-ab05-498e-8276-862ad3401dc3
      iscommand: false
      name: Restrict outgoing traffic to this service?
      type: condition
      version: -1
      description: Ask the analyst whether to restrict access to this service.
    taskid: 6e332cd2-ab05-498e-8276-862ad3401dc3
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -550,
          "y": -2240
        }
      }
  "60":
    id: "60"
    ignoreworker: false
    nexttasks:
      ✅ Yes:
      - "5"
      ❌ No:
      - "6"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6d0a0a98-eebc-408d-8b16-105f27ad8c11
      iscommand: false
      name: Onboard this account on Prisma Cloud?
      type: condition
      version: -1
      description: Ask the analyst whether to onboard this account on Prisma Cloud.
    taskid: 6d0a0a98-eebc-408d-8b16-105f27ad8c11
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 645,
          "y": 1540
        }
      }
  "61":
    id: "61"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "31"
    note: false
    quietmode: 0
    scriptarguments:
      accountid: {}
      accountname: {}
      addLabels: {}
      agentid: {}
      app: {}
      appendMultiSelect: {}
      assetid: {}
      assigneduser: {}
      assignmentgroup: {}
      attachmentcount: {}
      attachmentextension: {}
      attachmenthash: {}
      attachmentid: {}
      attachmentname: {}
      attachmentsize: {}
      attachmenttype: {}
      blockedaction: {}
      bugtraq: {}
      caller: {}
      city: {}
      closeNotes: {}
      closeReason: {}
      cloudservice: {}
      commandline: {}
      costcenter: {}
      costcentercode: {}
      country: {}
      countryname: {}
      criticalassets: {}
      customFields: {}
      cve: {}
      cvss: {}
      dbotMirrorDirection: {}
      dbotMirrorId: {}
      dbotMirrorInstance: {}
      dbotMirrorTags: {}
      dbotprediction: {}
      dbotpredictionprobability: {}
      dbottextsuggestionhighlighted: {}
      deleteEmptyField: {}
      department: {}
      dest: {}
      desthostname: {}
      destinationhostname: {}
      destinationip: {}
      destinationnetwork: {}
      destinationport: {}
      destntdomain: {}
      destos: {}
      details: {}
      detectedexternalhosts: {}
      detectedexternalips: {}
      detectedinternalhosts: {}
      detectedinternalips: {}
      detectedusers: {}
      detectionendtime: {}
      detectionid: {}
      detectionupdatetime: {}
      detectionurl: {}
      deviceexternalip: {}
      devicehash: {}
      devicelocalip: {}
      devicemodel: {}
      devicename: {}
      displayname: {}
      duration: {}
      email: {}
      emailauthenticitycheck: {}
      emailbcc: {}
      emailbody: {}
      emailbodyformat: {}
      emailbodyhtml: {}
      emailcc: {}
      emailclassification: {}
      emailclientname: {}
      emailfrom: {}
      emailheaders: {}
      emailhtml: {}
      emailinreplyto: {}
      emailkeywords: {}
      emailmessageid: {}
      emailreceived: {}
      emailreplyto: {}
      emailreturnpath: {}
      emailsenderip: {}
      emailsize: {}
      emailsource: {}
      emailsubject: {}
      emailto: {}
      emailtocount: {}
      emailurlclicked: {}
      employeedisplayname: {}
      employeeemail: {}
      employeemanageremail: {}
      escalation: {}
      eventaction: {}
      eventid: {}
      eventtype: {}
      externaladdresses: {}
      filehash: {}
      filename: {}
      filepath: {}
      filesize: {}
      firstname: {}
      firstseen: {}
      givenname: {}
      helloworldid: {}
      helloworldstatus: {}
      helloworldtype: {}
      hostname: {}
      id: {}
      incomingmirrorerror: {}
      infectedhosts: {}
      internaladdresses: {}
      investigationstage: {}
      isolated: {}
      jobcode: {}
      jobfamily: {}
      jobfunction: {}
      labels: {}
      lastmodifiedby: {}
      lastmodifiedon: {}
      lastname: {}
      lastseen: {}
      leadership: {}
      location: {}
      locationregion: {}
      logsource: {}
      macaddress: {}
      maliciousbehavior: {}
      malwarefamily: {}
      malwarename: {}
      manageremailaddress: {}
      managername: {}
      md5: {}
      mobiledevicemodel: {}
      mobilephone: {}
      name: {}
      occurred: {}
      os: {}
      osversion: {}
      outgoingmirrorerror: {}
      owner: {}
      parentprocessid: {}
      personalemail: {}
      phase: {}
      phishingsubtype: {}
      phonenumber: {}
      pid: {}
      policydeleted: {}
      policydescription: {}
      policydetails: {}
      policyid: {}
      policyrecommendation: {}
      policyremediable: {}
      policyseverity: {}
      policytype: {}
      prismacloudid: {}
      prismacloudreason: {}
      prismacloudrules: {}
      prismacloudstatus: {}
      prismacloudtime: {}
      protocol: {}
      protocols: {}
      quarantined: {}
      rating: {}
      region: {}
      regionid: {}
      replacePlaybook: {}
      reporteremailaddress: {}
      resourceapiname: {}
      resourcecloudtype: {}
      resourceid: {}
      resourcename: {}
      resourcetype: {}
      riskrating: {}
      riskscore: {}
      roles: {}
      rrn: {}
      samaccountname: {}
      severity: {}
      sha256: {}
      shadowitaccountowneremail: {}
      shadowitaccountownername: {}
      shadowitbilledtocorp: {}
      shadowitcertificate: {}
      shadowitcloudaccountid:
        complex:
          accessor: "0"
          root: Prisma Cloud Automated Onboarding - AWS.Answers
      shadowitcloudaccounttype: {}
      shadowitfqdn: {}
      shadowitip: {}
      shadowitorganizationalunit: {}
      shadowitoucontactemail: {}
      shadowitoucontactname: {}
      shadowitport: {}
      shadowitprovider: {}
      shadowitregion: {}
      shadowitrisk: {}
      shadowitsactionedservice: {}
      shadowitsensitivedata: {}
      shadowitservice: {}
      shadowitservicepurpose: {}
      shadowitsource: {}
      shadowitusersuggestions: {}
      signature: {}
      skuname: {}
      skutier: {}
      sla: {}
      slaField: {}
      sourcehostname: {}
      sourceip: {}
      sourcenetwork: {}
      sourceport: {}
      sourceusername: {}
      src: {}
      srchostname: {}
      srcntdomain: {}
      srcos: {}
      srcuser: {}
      state: {}
      streetaddress: {}
      subcategory: {}
      subscriptionassignedby: {}
      subscriptioncreatedby: {}
      subscriptioncreatedon: {}
      subscriptiondescription: {}
      subscriptionid: {}
      subscriptionname: {}
      subscriptiontype: {}
      subscriptionupdatedby: {}
      subscriptionupdatedon: {}
      subtype: {}
      surname: {}
      systemdefault: {}
      systems: {}
      targetfirewallversion: {}
      tenantname: {}
      terminatedaction: {}
      threatactor: {}
      ticketcloseddate: {}
      ticketnumber: {}
      ticketopeneddate: {}
      title: {}
      triggeredsecurityprofile: {}
      type: {}
      uniqueports: {}
      urlsslverification: {}
      user: {}
      useraccountcontrol: {}
      username: {}
      vendorid: {}
      vendorproduct: {}
      vpcid: {}
      vulnerabilitycategory: {}
      workphone: {}
      xdralertcount: {}
      xdralerts: {}
      xdrassigneduseremail: {}
      xdrassigneduserprettyname: {}
      xdrdescription: {}
      xdrdetectiontime: {}
      xdrfileartifacts: {}
      xdrhighseverityalertcount: {}
      xdrhostcount: {}
      xdrincidentid: {}
      xdrlowseverityalertcount: {}
      xdrmediumseverityalertcount: {}
      xdrnetworkartifacts: {}
      xdrnotes: {}
      xdrresolvecomment: {}
      xdrstatus: {}
      xdrstatusv2: {}
      xdrurl: {}
      xdrusercount: {}
      zipcode: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 8c17ab64-49d0-44cd-8ee6-081b08873588
      iscommand: true
      name: Set Account ID in Incident
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 8c17ab64-49d0-44cd-8ee6-081b08873588
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -730,
          "y": 4610
        }
      }
  "62":
    id: "62"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      assetid: {}
      closeNotes:
        simple: Shadow IT incident successfully resolved!
      closeReason: {}
      emailclassification: {}
      id: {}
      incomingmirrorerror: {}
      outgoingmirrorerror: {}
      phishingsubtype: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: c6952dd7-ce67-41ad-8d72-dbcae9af8d97
      iscommand: true
      name: Close Investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: c6952dd7-ce67-41ad-8d72-dbcae9af8d97
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 170,
          "y": 5590
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "59_49_✅ Yes": 0.1,
      "59_9_❌ No": 0.21
    },
    "paper": {
      "dimensions": {
        "height": 8445,
        "width": 4160,
        "x": -2120,
        "y": -2600
      }
    }
  }
tests:
- No tests (auto formatted)
fromversion: 6.0.0
