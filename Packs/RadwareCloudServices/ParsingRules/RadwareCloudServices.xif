[INGEST:vendor="radware", product="access_logs", target_dataset="radware_access_logs_raw", no_hit=keep]
// Split grouped events
filter _raw_log ~= "^\["
| alter raw_log_array = arraymap(split(if(_raw_log ~= "^\[", rtrim(ltrim(_raw_log, "["), "]")), "},"), trim("@element"))
| alter raw_log_array = arraymap(raw_log_array, if(to_string("@element") ~= "[^\}]$", concat("@element", "}"), "@element"))
| alter _raw_log = raw_log_array
| arrayexpand _raw_log;

alter _time = parse_timestamp("%d/%b/%Y:%X %z", json_extract_scalar(_raw_log, "$.time"));