commonfields:
  id: CTIX
  version: -1
name: CTIX
display: Cyware Threat Intelligence eXchange
category: Data Enrichment & Threat Intelligence
image: data:image/png;base64,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
description: This is Cyware Threat Intelligence eXhange(CTIX) integration which enriches
  IP/Domain/URL/File Data.
detaileddescription: |
  1. Navigate to Administration > Integrations management > CTIX Integrators.
  2. Click “Add New” to create and configure a new integration instance and download the key files.
  3. Login to the Cortex XSOAR application and go to the App Configuration page.
  4. Fill in the following details.
      a. Name: Give a name for the integration instance.
      b. Endpoint URL: Enter the endpoint URL of your CTIX Instance. The Endpoint URL can be generated by a licensed user from the CTIX application. For example, https://<domain_name>/ctixapi/openapi/
      c. Access Key: Enter the Access Key from the CTIX application. The Access Key can be generated by a licensed user from the CTIX application. For example, “74xxxxx7-xxxb-4xxa-xxxx-0xxxxxxxxxx2“.
      d. Secret Key: Enter the Secret Key from the CTIX application. The Secret Key can be generated by a licensed user from the CTIX application. For example, “0xxxxxx8-xxxx-4xx4-xxx6-5xxxxxxxxxxc”.
  5.  After finishing, click the “Test“ button to validate the URL, Token, and Connection.
configuration:
- display: Endpoint URL
  name: base_url
  type: 0
  required: true
  additionalinfo: Enter the endpoint URL of your CTIX Instance.
- display: Access Key
  name: access_id
  type: 4
  required: true
  additionalinfo: Enter the Access Key from the CTIX application.
- display: Secret Key
  name: secret_key
  type: 4
  required: true
  additionalinfo: Enter the Secret Key from the CTIX application.
script:
  script: |
    '''IMPORTS'''


    import base64
    import hashlib
    import hmac
    import time
    import requests
    import urllib
    import urllib3
    from typing import Any, Dict

    # Disable insecure warnings
    urllib3.disable_warnings()

    '''GLOBALS'''

    domain_regex = (
        "([a-z¡-\uffff0-9](?:[a-z¡-\uffff0-9-]{0,61}"
        "[a-z¡-\uffff0-9])?(?:\\.(?!-)[a-z¡-\uffff0-9-]{1,63}(?<!-))*"
        "\\.(?!-)(?!(jpg|jpeg|exif|tiff|tif|png|gif|otf|ttf|fnt|dtd|xhtml|css"
        "|html)$)(?:[a-z¡-\uffff-]{2,63}|xn--[a-z0-9]{1,59})(?<!-)\\.?$"
        "|localhost)"
    )

    REGEX_MAP = {
        'url': re.compile(urlRegex, regexFlags),
        'domain': re.compile(domain_regex, regexFlags),
        'hash': re.compile(hashRegex, regexFlags)
    }

    ''' CLIENT CLASS '''


    class Client:
        """
        Client class to interact with the service API
        """
        def __init__(self, base_url: str, access_id: str, secret_key: str) -> None:
            self.base_url = base_url
            self.access_id = access_id
            self.secret_key = secret_key

        def signature(self, expires: int) -> str:
            to_sign = "%s\n%i" % (self.access_id, expires)
            return base64.b64encode(hmac.new(
                self.secret_key.encode("utf-8"), to_sign.encode("utf-8"), hashlib.sha1).digest()
                                    ).decode("utf-8")

        def http_request(self, **params):
            """
            A wrapper to send requests and handle responses.
            """
            expires = int(time.time() + 5)
            params["AccessID"] = self.access_id
            params["Expires"] = expires
            params["Signature"] = self.signature(expires)
            url_suffix = "objects/indicator/"
            url = self.base_url + url_suffix + "?" + urllib.parse.urlencode(params)
            try:
                resp = (requests.get(url))
                status_code = resp.status_code
                if status_code != 200:
                    return_error('Error in API call to CTIX. Status Code: ' + str(resp.status_code))
                json_data = resp.json()
                response = {"data": json_data, "status": status_code}
                return response
            except Exception as e:
                LOG(e)
                return_error(str(e))

        def get_ip_details(self, ip: list, enhanced: bool = False) -> Dict[str, Any]:
            """Gets the IP Details

            :type ip: ``str``
            :param ip: IP address

            :type enhanced: ``bool``
            :param enhanced: Enhanced search flag

            :return: dict containing the IP Details as returned from the API
            :rtype: ``Dict[str, Any]``
            """
            ip_string = ",".join(ip)

            if enhanced == "True":
                params = {"enhanced_search": ip_string}
            else:
                params = {"q": ip_string}
            return self.http_request(**params)

        def get_domain_details(self, domain: list, enhanced: bool = False) -> Dict[str, Any]:
            """Gets the Domain Details

            :type domain: ``str``
            :param domain: domain name

            :type enhanced: ``bool``
            :param enhanced: Enhanced search flag

            :return: dict containing the domain details as returned from the API
            :rtype: ``Dict[str, Any]``
            """

            domain_string = ",".join(domain)

            if enhanced == "True":
                params = {"enhanced_search": domain_string}
            else:
                params = {"q": domain_string}

            return self.http_request(**params)

        def get_url_details(self, url: list, enhanced: bool = False) -> Dict[str, Any]:
            """Gets the URL Details

            :type url: ``str``
            :param url: url name

            :type enhanced: ``bool``
            :param enhanced: Enhanced search flag

            :return: dict containing the url details as returned from the API
            :rtype: ``Dict[str, Any]``
            """

            url_string = ",".join(url)

            if enhanced == "True":
                params = {"enhanced_search": url_string}
            else:
                params = {"q": url_string}

            return self.http_request(**params)

        def get_file_details(self, file: list, enhanced: bool = False) -> Dict[str, Any]:
            """Gets the File Details

            :type file: ``str``
            :param file: file name

            :type enhanced: ``bool``
            :param enhanced: Enhanced search flag

            :return: dict containing the file details as returned from the API
            :rtype: ``Dict[str, Any]``
            """

            file_string = ",".join(file)
            if enhanced == "True":
                params = {"enhanced_search": file_string}
            else:
                params = {"q": file_string}

            return self.http_request(**params)


    ''' HELPER FUNCTIONS '''


    def to_dbot_score(ctix_score: int) -> Common.DBotScore:
        """
        Maps CTIX Score to DBotScore
        """
        if ctix_score == 0:
            dbot_score = Common.DBotScore.NONE  # unknown
        elif ctix_score <= 30:
            dbot_score = Common.DBotScore.GOOD  # good
        elif ctix_score <=70:
            dbot_score = Common.DBotScore.SUSPICIOUS  # suspicious
        else:
            dbot_score = Common.DBotScore.BAD
        return dbot_score


    ''' COMMAND FUNCTIONS '''


    def test_module(client: Client):
        """
        Performs basic get request to get sample ip details.
        """
        client.get_ip_details(ip="8.208.20.145", enhanced=False)

        # test was successful
        demisto.results('ok')


    def ip_details_command(client: Client, args: Dict[str, Any]) -> CommandResults:
        """
        ip command: Returns IP details for a list of IPs
        """
        ip_addresses_string = args.get('ip')
        ip_addresses_array = argToList(ip_addresses_string)

        for ip_address in ip_addresses_array: # Check for Valid IP Inputs
            if not is_ip_valid(ip_address, accept_v6_ips=True):
                return_error('{0} is not a valid IP Address.'.format(ip_address))

        enhanced = args.get('enhanced')
        response = client.get_ip_details(ip_addresses_array, enhanced)
        ip_list = response.get("data", {}).get("results", {})
        ip_data_list, ip_standard_list = [], []
        for ip_data in ip_list:
            score = to_dbot_score(ip_data.get("score", 0))
            dbot_score = Common.DBotScore(
                indicator=ip_data.get("name2"),
                indicator_type=DBotScoreType.IP,
                integration_name='CTIX',
                score=score
            )
            ip_standard_context = Common.IP(
                ip=ip_data.get("name2"),
                asn=ip_data.get("asn"),
                dbot_score=dbot_score
            )
            ip_standard_list.append(ip_standard_context)
            ip_data_list.append(ip_data)

        readable_output = tableToMarkdown('IP List', ip_data_list, removeNull=True)
        return CommandResults(
            readable_output=readable_output,
            outputs_prefix='CTIX.IP',
            outputs_key_field='name2',
            outputs=ip_data_list,
            indicators=ip_standard_list
        )


    def domain_details_command(client: Client, args: Dict[str, Any]) -> CommandResults:
        """
        domain command: Returns domain details for a list of domains
        """
        domain_string = args.get('domain')
        domain_array = argToList(domain_string)

        for domain in domain_array:  # Check for Valid Domain Inputs
            if not REGEX_MAP['domain'].match(domain):
                return_error('{0} is not a valid domain.'.format(domain))
        enhanced = args.get('enhanced')
        response = client.get_domain_details(domain_array, enhanced)
        domain_list = response.get("data", {}).get("results", {})
        domain_data_list, domain_standard_list = [], []
        for domain_data in domain_list:
            score = to_dbot_score(domain_data.get("score", 0))
            dbot_score = Common.DBotScore(
                indicator=domain_data.get("name2"),
                indicator_type=DBotScoreType.DOMAIN,
                integration_name='CTIX',
                score=score
            )
            domain_standard_context = Common.Domain(
                domain=domain_data.get("name2"),
                dbot_score=dbot_score
            )
            domain_standard_list.append(domain_standard_context)
            domain_data_list.append(domain_data)

        readable_output = tableToMarkdown('Domain List', domain_data_list, removeNull=True)

        return CommandResults(
            readable_output=readable_output,
            outputs_prefix='CTIX.Domain',
            outputs_key_field='name2',
            outputs=domain_data_list,
            indicators=domain_standard_list
        )


    def url_details_command(client: Client, args: Dict[str, Any]) -> CommandResults:
        """
        url command: Returns URL details for a list of URL
        """
        url_string = args.get('url')
        url_array = argToList(url_string)

        for url in url_array:  # Check for Valid URL Inputs
            if not REGEX_MAP['url'].match(url):
                return_error('{0} is not a valid url.'.format(url))
        enhanced = args.get('enhanced')
        response = client.get_url_details(url_array, enhanced)
        url_list = response.get("data", {}).get("results", {})
        url_data_list, url_standard_list = [], []
        for url_data in url_list:
            score = to_dbot_score(url_data.get("score", 0))
            dbot_score = Common.DBotScore(
                indicator=url_data.get("name2"),
                indicator_type=DBotScoreType.URL,
                integration_name='CTIX',
                score=score,
            )
            url_standard_context = Common.URL(
                url=url_data.get("name2"),
                dbot_score=dbot_score
            )
            url_standard_list.append(url_standard_context)
            url_data_list.append(url_data)

        readable_output = tableToMarkdown('URL List', url_data_list, removeNull=True)

        return CommandResults(
            readable_output=readable_output,
            outputs_prefix='CTIX.URL',
            outputs_key_field='name2',
            outputs=url_data_list,
            indicators=url_standard_list
        )


    def file_details_command(client: Client, args: Dict[str, Any]) -> CommandResults:
        """
        file command: Returns FILE details for a list of FILE
        """
        file_string = args.get('file')
        file_array = argToList(file_string)

        for file in file_array:  # Check for Valid File Inputs
            if not REGEX_MAP['hash'].match(file):
                return_error('{0} is not a valid file.'.format(file))
        enhanced = args.get('enhanced')
        response = client.get_file_details(file_array, enhanced)
        file_list = response.get("data", {}).get("results", {})
        file_data_list, file_standard_list = [], []
        for file_data in file_list:
            score = to_dbot_score(file_data.get("score",0))
            dbot_score = Common.DBotScore(
                indicator=file_data.get("name2"),
                indicator_type=DBotScoreType.FILE,
                integration_name='CTIX',
                score=score
            )
            file_standard_context = Common.File(
                name=file_data.get("name2"),
                dbot_score=dbot_score
            )
            file_standard_list.append(file_standard_context)
            file_data_list.append(file_data)

        readable_output = tableToMarkdown('File List', file_data_list, removeNull=True)

        return CommandResults(
            readable_output=readable_output,
            outputs_prefix='CTIX.File',
            outputs_key_field='name2',
            outputs=file_data_list,
            indicators=file_standard_list
        )


    def main() -> None:

        base_url = demisto.params().get('base_url')
        access_id = demisto.params().get('access_id')
        secret_key = demisto.params().get('secret_key')

        demisto.debug(f'Command being called is {demisto.command()}')
        try:

            client = Client(
                base_url=base_url,
                access_id=access_id,
                secret_key=secret_key)

            if demisto.command() == 'test-module':
                test_module(client)
            elif demisto.command() == 'ip':
                return_results(ip_details_command(client, demisto.args()))
            elif demisto.command() == 'domain':
                return_results(domain_details_command(client, demisto.args()))
            elif demisto.command() == 'url':
                return_results(url_details_command(client, demisto.args()))
            elif demisto.command() == 'file':
                return_results(file_details_command(client, demisto.args()))

        except Exception as e:
            demisto.error(traceback.format_exc())  # print the traceback
            return_error(f'Failed to execute {demisto.command()} command.\nError:\n{str(e)}')


    if __name__ in ('__main__', '__builtin__', 'builtins'):
        main()
  type: python
  commands:
  - name: ip
    arguments:
    - name: ip
      required: true
      default: true
      description: List of IPs.
      isArray: true
    - name: enhanced
      auto: PREDEFINED
      predefined:
      - "true"
      - "false"
      description: Boolean Flag which when enabled returns an enhanced response which
        includes the extra enhancement data from various sources.
    outputs:
    - contextPath: IP.Address
      description: IP address.
      type: String
    - contextPath: IP.ASN
      description: The autonomous system name for the IP address.
      type: String
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: String
    - contextPath: DBotScore.Score
      description: The actual score.
      type: Number
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: String
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: String
    - contextPath: CTIX.IP.tenant_id
      description: Tenant ID
      type: string
    - contextPath: CTIX.IP.stix_object_id
      description: ID of the Threat Data Object in CTIX application
      type: string
    - contextPath: CTIX.IP.tlp_data
      description: TLP Value of the Threat Data Object
      type: string
    - contextPath: CTIX.IP.first_seen
      description: Timestamp of when the IP was first seen on the CTIX application
      type: string
    - contextPath: CTIX.IP.last_seen
      description: Timestamp of when the IP was latest seen on the CTIX application
      type: string
    - contextPath: CTIX.IP.deprecated
      description: Shows if the Threat Data Object is deprecated on the CTIX application
      type: boolean
    - contextPath: CTIX.IP.intel_grading
      description: Intel grading
      type: string
    - contextPath: CTIX.IP.criticality
      description: Criticality of the Threat Data Object on the scale of 0-5
      type: number
    - contextPath: CTIX.IP.indicator_type
      description: Threat Data Object type
      type: string
    - contextPath: CTIX.IP.package_id
      description: List of IDs of packages on the CTIX application through which these
        IPs were received
    - contextPath: CTIX.IP.source
      description: List of sources from which the IP address was received in the CTIX
        application
    - contextPath: CTIX.IP.risk_severity
      description: Risk Severity of the Threat Data Object on the scale of 0-5
      type: number
    - contextPath: CTIX.IP.labels
      description: List of Tags applied on the Threat Data Object
    - contextPath: CTIX.IP.source_grading
      description: Source Grading
      type: string
    - contextPath: CTIX.IP.name2
      description: Value of the Threat Data Object
      type: string
    - contextPath: CTIX.IP.published_collections
      description: Published collections
    - contextPath: CTIX.IP.published_package_id
      description: Package ID
    - contextPath: CTIX.IP.blocked
      description: Shows if the Threat Data Object is blocked on the CTIX application
      type: boolean
    - contextPath: CTIX.IP.blocked_time
      description: Timestamp of when the Threat Data Object was blocked on the CTIX
        application.
      type: string
    - contextPath: CTIX.IP.deprecated_time
      description: Timestamp of when the Threat Data Object was deprecated on the
        CTIX application
      type: string
    - contextPath: CTIX.IP.notification_preference
      description: Notification preference
    - contextPath: CTIX.IP.followed_on
      description: Followed On
    - contextPath: CTIX.IP.score
      description: CTIX Confidence Score of the IP Object out of 100
      type: number
    - contextPath: CTIX.IP.type
      description: Type  of object
      type: string
    - contextPath: CTIX.IP.subscriber_id
      description: List of Subscriber IDs
    - contextPath: CTIX.IP.subscriber
      description: List of Subscribers
    - contextPath: CTIX.IP.subscriber_collection_id
      description: List of Subscriber Collection IDs
    - contextPath: CTIX.IP.subscriber_collection
      description: List of Subscriber Collection
    - contextPath: CTIX.IP.object_type
      description: Type of object
      type: string
    - contextPath: CTIX.IP.blocked_on
      description: Name of the Application where the Threat Data Object was blocked
        on.
    - contextPath: CTIX.IP.follow_by
      description: List of Cyware Users who follow the object.
    - contextPath: CTIX.IP.is_false_positive
      description: Shows if the Threat Data Object was marked false positive in the
        CTIX application
      type: boolean
    - contextPath: CTIX.IP.domain_tld
      description: Top-Level Domain information about the Threat Data Object.
      type: string
    - contextPath: CTIX.IP.asn
      description: ASN number of the Threat Data Object
      type: string
    - contextPath: CTIX.IP.registered_domain
      description: Registered Domain
      type: string
    - contextPath: CTIX.IP.geo_details
      description: Geographic details of the Threat Data Object
      type: unknown
    - contextPath: CTIX.IP.country
      description: Geographic details of the Object
      type: string
    - contextPath: CTIX.IP.registrar
      description: Registrar
      type: string
    - contextPath: CTIX.IP.file_extension
      description: File Extension
      type: string
    - contextPath: CTIX.IP.whitelisted
      description: List
    - contextPath: CTIX.IP.object_description
      description: Description of the Threat Data Object.
      type: string
    - contextPath: CTIX.IP.custom_score
      description: Custom Score of the Threat Data Object
      type: number
    - contextPath: CTIX.IP.is_following
      description: Boolean Value
      type: boolean
    - contextPath: CTIX.IP.under_review
      description: Shows if Threat Data Object is marked as Under Review on the CTIX
        application
      type: boolean
    - contextPath: CTIX.IP.under_reviewed_time
      description: Timestamp when the object was marked under review.
      type: string
    - contextPath: CTIX.IP.reviewed
      description: Shows if the Threat Data Object is Marked as Reviewed on the CTIX
        application
      type: boolean
    - contextPath: CTIX.IP.reviewed_time
      description: Timestamp when then object was reviewed.
      type: string
    - contextPath: CTIX.IP.object_description_defang
      description: Description of the object.
      type: string
    - contextPath: CTIX.IP.source_data
      description: List of sources from which CTIX received this IP.
    - contextPath: CTIX.IP.related_fields
      description: Relationship Data about the Threat Data Object present on the CTIX
        application
    - contextPath: CTIX.IP.enhancement_data
      description: Additional enhanced data about the Threat Data Object fetched by
        the CTIX application
    description: Return IP Details.
  - name: domain
    arguments:
    - name: domain
      required: true
      default: true
      description: List of Domains.
      isArray: true
    - name: enhanced
      auto: PREDEFINED
      predefined:
      - "true"
      - "false"
      description: Boolean Flag which when enabled returns an enhanced response which
        includes the extra enhancement data from various sources.
    outputs:
    - contextPath: Domain.Name
      description: The domain name.
      type: String
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: String
    - contextPath: DBotScore.Score
      description: The actual score.
      type: Number
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: String
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: String
    - contextPath: CTIX.Domain.tenant_id
      description: Tenant ID
      type: string
    - contextPath: CTIX.Domain.stix_object_id
      description: ID of the Threat Data Object in CTIX application
      type: string
    - contextPath: CTIX.Domain.tlp_data
      description: TLP Value of the Threat Data Object
      type: string
    - contextPath: CTIX.Domain.first_seen
      description: Timestamp of when the IP was first seen on the CTIX application
      type: string
    - contextPath: CTIX.Domain.last_seen
      description: Timestamp of when the IP was latest seen on the CTIX application
      type: string
    - contextPath: CTIX.Domain.deprecated
      description: Shows if the Threat Data Object is deprecated on the CTIX application
      type: boolean
    - contextPath: CTIX.Domain.intel_grading
      description: Intel grading
      type: string
    - contextPath: CTIX.Domain.criticality
      description: Criticality of the Threat Data Object on the scale of 0-5
      type: number
    - contextPath: CTIX.Domain.indicator_type
      description: Threat Data Object type
      type: string
    - contextPath: CTIX.Domain.package_id
      description: List of IDs of packages on the CTIX application through which these
        IPs were received
    - contextPath: CTIX.Domain.source
      description: List of sources from which the IP address was received in the CTIX
        application
    - contextPath: CTIX.Domain.risk_severity
      description: Risk Severity of the Threat Data Object on the scale of 0-5
      type: number
    - contextPath: CTIX.Domain.labels
      description: List of Tags applied on the Threat Data Object
    - contextPath: CTIX.Domain.source_grading
      description: Source Grading
      type: string
    - contextPath: CTIX.Domain.name2
      description: Value of the Threat Data Object
      type: string
    - contextPath: CTIX.Domain.published_collections
      description: Published collections
    - contextPath: CTIX.Domain.published_package_id
      description: Package ID
    - contextPath: CTIX.Domain.blocked
      description: Shows if the Threat Data Object is blocked on the CTIX application
      type: boolean
    - contextPath: CTIX.Domain.blocked_time
      description: Timestamp of when the Threat Data Object was blocked on the CTIX
        application.
      type: string
    - contextPath: CTIX.Domain.deprecated_time
      description: Timestamp of when the Threat Data Object was deprecated on the
        CTIX application
      type: string
    - contextPath: CTIX.Domain.notification_preference
      description: Notification preference
    - contextPath: CTIX.Domain.followed_on
      description: Followed On
    - contextPath: CTIX.Domain.score
      description: CTIX Confidence Score of the IP Object out of 100
      type: number
    - contextPath: CTIX.Domain.type
      description: Type  of object
      type: string
    - contextPath: CTIX.Domain.subscriber_id
      description: List of Subscriber IDs
    - contextPath: CTIX.Domain.subscriber
      description: List of Subscribers
    - contextPath: CTIX.Domain.subscriber_collection_id
      description: List of Subscriber Collection IDs
    - contextPath: CTIX.Domain.subscriber_collection
      description: List of Subscriber Collection
    - contextPath: CTIX.Domain.object_type
      description: Type of object
      type: string
    - contextPath: CTIX.Domain.blocked_on
      description: Name of the Application where the Threat Data Object was blocked
        on.
    - contextPath: CTIX.Domain.follow_by
      description: List of Cyware Users who follow the object.
    - contextPath: CTIX.Domain.is_false_positive
      description: Shows if the Threat Data Object was marked false positive in the
        CTIX application
      type: boolean
    - contextPath: CTIX.Domain.domain_tld
      description: Top-Level Domain information about the Threat Data Object.
      type: string
    - contextPath: CTIX.Domain.asn
      description: ASN number of the Threat Data Object
      type: string
    - contextPath: CTIX.Domain.registered_domain
      description: Registered Domain
      type: string
    - contextPath: CTIX.Domain.geo_details
      description: Geographic details of the Threat Data Object
      type: unknown
    - contextPath: CTIX.Domain.country
      description: Geographic details of the Object
      type: string
    - contextPath: CTIX.Domain.registrar
      description: Registrar
      type: string
    - contextPath: CTIX.Domain.file_extension
      description: File Extension
      type: string
    - contextPath: CTIX.Domain.whitelisted
      description: List
    - contextPath: CTIX.Domain.object_description
      description: Description of the Threat Data Object.
      type: string
    - contextPath: CTIX.Domain.custom_score
      description: Custom Score of the Threat Data Object
      type: number
    - contextPath: CTIX.Domain.is_following
      description: Boolean Value
      type: boolean
    - contextPath: CTIX.Domain.under_review
      description: Shows if Threat Data Object is marked as Under Review on the CTIX
        application
      type: boolean
    - contextPath: CTIX.Domain.under_reviewed_time
      description: Timestamp when the object was marked under review.
      type: string
    - contextPath: CTIX.Domain.reviewed
      description: Shows if the Threat Data Object is Marked as Reviewed on the CTIX
        application
      type: boolean
    - contextPath: CTIX.Domain.reviewed_time
      description: Timestamp when then object was reviewed.
      type: string
    - contextPath: CTIX.Domain.object_description_defang
      description: Description of the object.
      type: string
    - contextPath: CTIX.Domain.source_data
      description: List of sources from which CTIX received this IP.
    - contextPath: CTIX.Domain.related_fields
      description: Relationship Data about the Threat Data Object present on the CTIX
        application
    - contextPath: CTIX.Domain.enhancement_data
      description: Additional enhanced data about the Threat Data Object fetched by
        the CTIX application
    description: Return Domain Details.
  - name: url
    arguments:
    - name: url
      required: true
      default: true
      description: List of URLs.
      isArray: true
    - name: enhanced
      auto: PREDEFINED
      predefined:
      - "true"
      - "false"
      description: Boolean Flag which when enabled returns an enhanced response which
        includes the extra enhancement data from various sources.
    outputs:
    - contextPath: URL.Data
      description: The URL.
      type: String
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: String
    - contextPath: DBotScore.Score
      description: The actual score.
      type: Number
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: String
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: String
    - contextPath: CTIX.URL.tenant_id
      description: Tenant ID
      type: string
    - contextPath: CTIX.URL.stix_object_id
      description: ID of the Threat Data Object in CTIX application
      type: string
    - contextPath: CTIX.URL.tlp_data
      description: TLP Value of the Threat Data Object
      type: string
    - contextPath: CTIX.URL.first_seen
      description: Timestamp of when the IP was first seen on the CTIX application
      type: string
    - contextPath: CTIX.URL.last_seen
      description: Timestamp of when the IP was latest seen on the CTIX application
      type: string
    - contextPath: CTIX.URL.deprecated
      description: Shows if the Threat Data Object is deprecated on the CTIX application
      type: boolean
    - contextPath: CTIX.URL.intel_grading
      description: Intel grading
      type: string
    - contextPath: CTIX.URL.criticality
      description: Criticality of the Threat Data Object on the scale of 0-5
      type: number
    - contextPath: CTIX.URL.indicator_type
      description: Threat Data Object type
      type: string
    - contextPath: CTIX.URL.package_id
      description: List of IDs of packages on the CTIX application through which these
        IPs were received
    - contextPath: CTIX.URL.source
      description: List of sources from which the IP address was received in the CTIX
        application
    - contextPath: CTIX.URL.risk_severity
      description: Risk Severity of the Threat Data Object on the scale of 0-5
      type: number
    - contextPath: CTIX.URL.labels
      description: List of Tags applied on the Threat Data Object
    - contextPath: CTIX.URL.source_grading
      description: Source Grading
      type: string
    - contextPath: CTIX.URL.name2
      description: Value of the Threat Data Object
      type: string
    - contextPath: CTIX.URL.published_collections
      description: Published collections
    - contextPath: CTIX.URL.published_package_id
      description: Package ID
    - contextPath: CTIX.URL.blocked
      description: Shows if the Threat Data Object is blocked on the CTIX application
      type: boolean
    - contextPath: CTIX.URL.blocked_time
      description: Timestamp of when the Threat Data Object was blocked on the CTIX
        application.
      type: string
    - contextPath: CTIX.URL.deprecated_time
      description: Timestamp of when the Threat Data Object was deprecated on the
        CTIX application
      type: string
    - contextPath: CTIX.URL.notification_preference
      description: Notification preference
    - contextPath: CTIX.URL.followed_on
      description: Followed On
    - contextPath: CTIX.URL.score
      description: CTIX Confidence Score of the IP Object out of 100
      type: number
    - contextPath: CTIX.URL.type
      description: Type  of object
      type: string
    - contextPath: CTIX.URL.subscriber_id
      description: List of Subscriber IDs
    - contextPath: CTIX.URL.subscriber
      description: List of Subscribers
    - contextPath: CTIX.URL.subscriber_collection_id
      description: List of Subscriber Collection IDs
    - contextPath: CTIX.URL.subscriber_collection
      description: List of Subscriber Collection
    - contextPath: CTIX.URL.object_type
      description: Type of object
      type: string
    - contextPath: CTIX.URL.blocked_on
      description: Name of the Application where the Threat Data Object was blocked
        on.
    - contextPath: CTIX.URL.follow_by
      description: List of Cyware Users who follow the object.
    - contextPath: CTIX.URL.is_false_positive
      description: Shows if the Threat Data Object was marked false positive in the
        CTIX application
      type: boolean
    - contextPath: CTIX.URL.domain_tld
      description: Top-Level Domain information about the Threat Data Object.
      type: string
    - contextPath: CTIX.URL.asn
      description: ASN number of the Threat Data Object
      type: string
    - contextPath: CTIX.URL.registered_domain
      description: Registered Domain
      type: string
    - contextPath: CTIX.URL.geo_details
      description: Geographic details of the Threat Data Object
      type: unknown
    - contextPath: CTIX.URL.country
      description: Geographic details of the Object
      type: string
    - contextPath: CTIX.URL.registrar
      description: Registrar
      type: string
    - contextPath: CTIX.URL.file_extension
      description: File Extension
      type: string
    - contextPath: CTIX.URL.whitelisted
      description: List
    - contextPath: CTIX.URL.object_description
      description: Description of the Threat Data Object.
      type: string
    - contextPath: CTIX.URL.custom_score
      description: Custom Score of the Threat Data Object
      type: number
    - contextPath: CTIX.URL.is_following
      description: Boolean Value
      type: boolean
    - contextPath: CTIX.URL.under_review
      description: Shows if Threat Data Object is marked as Under Review on the CTIX
        application
      type: boolean
    - contextPath: CTIX.URL.under_reviewed_time
      description: Timestamp when the object was marked under review.
      type: string
    - contextPath: CTIX.URL.reviewed
      description: Shows if the Threat Data Object is Marked as Reviewed on the CTIX
        application
      type: boolean
    - contextPath: CTIX.URL.reviewed_time
      description: Timestamp when then object was reviewed.
      type: string
    - contextPath: CTIX.URL.object_description_defang
      description: Description of the object.
      type: string
    - contextPath: CTIX.URL.source_data
      description: List of sources from which CTIX received this IP.
    - contextPath: CTIX.URL.related_fields
      description: Relationship Data about the Threat Data Object present on the CTIX
        application
    - contextPath: CTIX.URL.enhancement_data
      description: Additional enhanced data about the Threat Data Object fetched by
        the CTIX application
    description: Return URL Details.
  - name: file
    arguments:
    - name: file
      required: true
      default: true
      description: List of Files.
      isArray: true
    - name: enhanced
      auto: PREDEFINED
      predefined:
      - "true"
      - "false"
      description: Boolean Flag which when enabled returns an enhanced response which
        includes the extra enhancement data from various sources.
    outputs:
    - contextPath: File.Name
      description: The full file name.
      type: String
    - contextPath: File.MD5
      description: The MD5 hash of the file.
      type: String
    - contextPath: File.SHA1
      description: The SHA1 hash of the file.
      type: String
    - contextPath: File.SHA256
      description: The SHA256 hash of the file.
      type: String
    - contextPath: File.SHA512
      description: The SHA512 hash of the file.
      type: String
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: String
    - contextPath: DBotScore.Score
      description: The actual score.
      type: Number
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: String
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: String
    - contextPath: CTIX.File.tenant_id
      description: Tenant ID
      type: string
    - contextPath: CTIX.File.stix_object_id
      description: ID of the Threat Data Object in CTIX application
      type: string
    - contextPath: CTIX.File.tlp_data
      description: TLP Value of the Threat Data Object
      type: string
    - contextPath: CTIX.File.first_seen
      description: Timestamp of when the IP was first seen on the CTIX application
      type: string
    - contextPath: CTIX.File.last_seen
      description: Timestamp of when the IP was latest seen on the CTIX application
      type: string
    - contextPath: CTIX.File.deprecated
      description: Shows if the Threat Data Object is deprecated on the CTIX application
      type: boolean
    - contextPath: CTIX.File.intel_grading
      description: Intel grading
      type: string
    - contextPath: CTIX.File.criticality
      description: Criticality of the Threat Data Object on the scale of 0-5
      type: number
    - contextPath: CTIX.File.indicator_type
      description: Threat Data Object type
      type: string
    - contextPath: CTIX.File.package_id
      description: List of IDs of packages on the CTIX application through which these
        IPs were received
    - contextPath: CTIX.File.source
      description: List of sources from which the IP address was received in the CTIX
        application
    - contextPath: CTIX.File.risk_severity
      description: Risk Severity of the Threat Data Object on the scale of 0-5
      type: number
    - contextPath: CTIX.File.labels
      description: List of Tags applied on the Threat Data Object
    - contextPath: CTIX.File.source_grading
      description: Source Grading
      type: string
    - contextPath: CTIX.File.name2
      description: Value of the Threat Data Object
      type: string
    - contextPath: CTIX.File.published_collections
      description: Published collections
    - contextPath: CTIX.File.published_package_id
      description: Package ID
    - contextPath: CTIX.File.blocked
      description: Shows if the Threat Data Object is blocked on the CTIX application
      type: boolean
    - contextPath: CTIX.File.blocked_time
      description: Timestamp of when the Threat Data Object was blocked on the CTIX
        application.
      type: string
    - contextPath: CTIX.File.deprecated_time
      description: Timestamp of when the Threat Data Object was deprecated on the
        CTIX application
      type: string
    - contextPath: CTIX.File.notification_preference
      description: Notification preference
    - contextPath: CTIX.File.followed_on
      description: Followed On
    - contextPath: CTIX.File.score
      description: CTIX Confidence Score of the IP Object out of 100
      type: number
    - contextPath: CTIX.File.type
      description: Type  of object
      type: string
    - contextPath: CTIX.File.subscriber_id
      description: List of Subscriber IDs
    - contextPath: CTIX.File.subscriber
      description: List of Subscribers
    - contextPath: CTIX.File.subscriber_collection_id
      description: List of Subscriber Collection IDs
    - contextPath: CTIX.File.subscriber_collection
      description: List of Subscriber Collection
    - contextPath: CTIX.File.object_type
      description: Type of object
      type: string
    - contextPath: CTIX.File.blocked_on
      description: Name of the Application where the Threat Data Object was blocked
        on.
    - contextPath: CTIX.File.follow_by
      description: List of Cyware Users who follow the object.
    - contextPath: CTIX.File.is_false_positive
      description: Shows if the Threat Data Object was marked false positive in the
        CTIX application
      type: boolean
    - contextPath: CTIX.File.domain_tld
      description: Top-Level Domain information about the Threat Data Object.
      type: string
    - contextPath: CTIX.File.asn
      description: ASN number of the Threat Data Object
      type: string
    - contextPath: CTIX.File.registered_domain
      description: Registered Domain
      type: string
    - contextPath: CTIX.File.geo_details
      description: Geographic details of the Threat Data Object
      type: unknown
    - contextPath: CTIX.File.country
      description: Geographic details of the Object
      type: string
    - contextPath: CTIX.File.registrar
      description: Registrar
      type: string
    - contextPath: CTIX.File.file_extension
      description: File Extension
      type: string
    - contextPath: CTIX.File.whitelisted
      description: List
    - contextPath: CTIX.File.object_description
      description: Description of the Threat Data Object.
      type: string
    - contextPath: CTIX.File.custom_score
      description: Custom Score of the Threat Data Object
      type: number
    - contextPath: CTIX.File.is_following
      description: Boolean Value
      type: boolean
    - contextPath: CTIX.File.under_review
      description: Shows if Threat Data Object is marked as Under Review on the CTIX
        application
      type: boolean
    - contextPath: CTIX.File.under_reviewed_time
      description: Timestamp when the object was marked under review.
      type: string
    - contextPath: CTIX.File.reviewed
      description: Shows if the Threat Data Object is Marked as Reviewed on the CTIX
        application
      type: boolean
    - contextPath: CTIX.File.reviewed_time
      description: Timestamp when then object was reviewed.
      type: string
    - contextPath: CTIX.File.object_description_defang
      description: Description of the object.
      type: string
    - contextPath: CTIX.File.source_data
      description: List of sources from which CTIX received this IP.
    - contextPath: CTIX.File.related_fields
      description: Relationship Data about the Threat Data Object present on the CTIX
        application
    - contextPath: CTIX.File.enhancement_data
      description: Additional enhanced data about the Threat Data Object fetched by
        the CTIX application
    description: Return File Details.
  - name: ctix-create-intel
    description: Creates Intel in CTIX platform.
    arguments:
    - name: title
      required: false
      description: Title of ioc.
      isArray: false
    - name: description
      required: false
      description: Description of ioc.
      isArray: false
    - name: tlp
      required: false
      description: tlp of ioc.
      isArray: false
    - name: confidence
      required: false
      description: confidence of ioc.
      isArray: false
    - name: ips
      required: false
      description: comma-separated list of IPs.
      isArray: true
    - name: urls
      required: false
      description: comma-separated list of URLs.
      isArray: true
    - name: domains
      required: false
      description: comma-separated list of domains.
      isArray: true
    - name: files
      required: false
      description: comma-separated list of files.
      isArray: true
    - name: emails
      required: false
      description: comma-separated list of emails.
      isArray: true
    - name: malwares
      required: false
      description: comma-separated list of malwares.
      isArray: true
    - name: threat_actors
      required: false
      description: comma-separated list of threat_actors.
      isArray: true
    - name: attack_patterns
      required: false
      description: comma-separated list of attack_patterns.
      isArray: true
    outputs:
      - contextPath: CTIX.Intel.response
        description: The response of the api.
        type: String
      - contextPath: CTIX.Intel.status
        description: Status code returned from the api.
        type: String
  dockerimage: demisto/python3:3.10.1.26972
  runonce: false
  subtype: python3
tests:
- No tests