id: Onion address extraction test
version: 3
vcShouldKeepItemLegacyProdMachine: false
name: Onion address extraction test
description: Test onion addresses extraction.
tags:
- onion
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: baa9e878-0071-49b3-805a-07585a09c56e
    type: start
    task:
      id: baa9e878-0071-49b3-805a-07585a09c56e
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 0c1bde3c-c534-45f4-8710-591e8edb306b
    type: regular
    task:
      id: 0c1bde3c-c534-45f4-8710-591e8edb306b
      version: -1
      name: 'Set Valid Onion Addresses '
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: valid_addresses
      value:
        simple: '"abcdefghijklmnop.onion", "pqrstuvwx2yzabcdefghijklmnopqrstufffwx2yzabcde2jklmnopqw.onion"'
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 425
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: e7772565-2f32-4ae0-836d-3e406727ba33
    type: regular
    task:
      id: e7772565-2f32-4ae0-836d-3e406727ba33
      version: -1
      name: DeleteContext
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 290
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 38874ab9-c22c-4dd2-8438-c19a67b16d8e
    type: regular
    task:
      id: 38874ab9-c22c-4dd2-8438-c19a67b16d8e
      version: -1
      name: Print Valid Addresses
      description: commands.local.cmd.extract.indicators
      script: Builtin|||extractIndicators
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "4"
      - "6"
    scriptarguments:
      text:
        simple: ${valid_addresses}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 710
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 3a33c219-5142-4eea-82ee-3e7ce86d4e9b
    type: condition
    task:
      id: 3a33c219-5142-4eea-82ee-3e7ce86d4e9b
      version: -1
      name: Check extraction - 16 chars address
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "12"
      "yes":
      - "7"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: ExtractedIndicators.Onion_Address
            iscontext: true
          right:
            value:
              simple: abcdefghijklmnop.onion
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 865
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 059148fa-ed98-4e50-8d0d-b12349412882
    type: title
    task:
      id: 059148fa-ed98-4e50-8d0d-b12349412882
      version: -1
      name: Check Valid Onion Adressess
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 165
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: e9f6ec24-da1d-4c5c-8205-c51f86b20fb2
    type: condition
    task:
      id: e9f6ec24-da1d-4c5c-8205-c51f86b20fb2
      version: -1
      name: Check extraction - 56 chars address
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "13"
      "yes":
      - "7"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: ExtractedIndicators.Onion_Address
            iscontext: true
          right:
            value:
              simple: pqrstuvwx2yzabcdefghijklmnopqrstufffwx2yzabcde2jklmnopqw.onion
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 865
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: de6d55e8-9062-4f51-875f-250c1acb4e02
    type: title
    task:
      id: de6d55e8-9062-4f51-875f-250c1acb4e02
      version: -1
      name: Check Non Extraction of invalid Addresses
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 790ffc5d-a12e-4f1f-8791-586cd37a297d
    type: regular
    task:
      id: 790ffc5d-a12e-4f1f-8791-586cd37a297d
      version: -1
      name: 'Set Invalid Onion Addresses '
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: invalid_addresses
      value:
        simple: '"abcdefghijkmnop.onion", "pqrstuvwx2yzabcdeghijklmnopqrstufffwx2yzabcde2jklmnopqw.onion"'
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1360
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: b364f12a-537d-4fdd-8384-e8a8a85d8786
    type: title
    task:
      id: b364f12a-537d-4fdd-8384-e8a8a85d8786
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 500,
          "y": 1740
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: 8f169d3f-9275-437e-8e46-c1bcb379bacc
    type: regular
    task:
      id: 8f169d3f-9275-437e-8e46-c1bcb379bacc
      version: -1
      name: DeleteContext
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1185
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 1660947f-7838-493f-85b6-347cd5572269
    type: condition
    task:
      id: 1660947f-7838-493f-85b6-347cd5572269
      version: -1
      name: Check that no invalid indicators were extracted
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "14"
      "yes":
      - "9"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              simple: ExtractedIndicators
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1535
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: 771f1ea5-4128-4a58-8cbb-5a5b329c5130
    type: regular
    task:
      id: 771f1ea5-4128-4a58-8cbb-5a5b329c5130
      version: -1
      name: Failed to extract 16 char address
      description: Prints an error entry with a given message.
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: Failed to extract 16 char onion address - "abcdefghijklmnop.onion"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -160,
          "y": 1040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: f6409e60-d6d8-4ea7-85eb-570a6e0a7cd8
    type: regular
    task:
      id: f6409e60-d6d8-4ea7-85eb-570a6e0a7cd8
      version: -1
      name: Failed to extract 56 char address
      description: Prints an error entry with a given message.
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: Failed to extract 56 char onion address - "pqrstuvwx2yzabcdefghijklmnopqrstufffwx2yzabcde2jklmnopqw.onion"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 690,
          "y": 1040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 89415b51-578a-4975-8042-4d4d77e60120
    type: regular
    task:
      id: 89415b51-578a-4975-8042-4d4d77e60120
      version: -1
      name: Extracted Invalid indicators as an onion addresses
      description: Prints an error entry with a given message.
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: Extracted Invalid indicators an onion addresses - "${ExtractedIndicators}"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 40,
          "y": 1740
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: f621d9a3-6c73-4b7c-8ddb-38c0c4982b4d
    type: condition
    task:
      id: f621d9a3-6c73-4b7c-8ddb-38c0c4982b4d
      version: -1
      name: check key was set
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "3"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: ${valid_addresses}
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1785,
        "width": 1230,
        "x": -160,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
dirtyInputs: true
