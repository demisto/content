id: Relationships scripts - Test
version: 8
vcShouldKeepItemLegacyProdMachine: false
name: Relationships scripts - Test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 5d78fae8-b63f-4447-89c9-8afde6570cac
    type: start
    task:
      id: 5d78fae8-b63f-4447-89c9-8afde6570cac
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: a45685a7-2296-4616-8762-0f929d8700a5
    type: regular
    task:
      id: a45685a7-2296-4616-8762-0f929d8700a5
      version: -1
      name: Create Relationships
      description: '[Enter a description of the script, including what function it
        performs and any important information users need to know, for example required
        permissions.]'
      scriptName: CreateIndicatorRelationship
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      create_indicator:
        simple: "true"
      description:
        simple: Test Relationships
      entity_a:
        simple: 1.1.1.1
      entity_a_type:
        simple: IP
      entity_b:
        simple: google.com,google1.com
      entity_b_type:
        simple: Domain
      relationship:
        simple: contains
      source_reliability:
        simple: C - Fairly reliable
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: 712c8561-626d-4786-8c7a-fa9948e3eed3
    type: regular
    task:
      id: 712c8561-626d-4786-8c7a-fa9948e3eed3
      version: -1
      name: Search For Relationships of indicator
      description: This automation outputs the indicator relationships to context
        according to the provided query. Using the entities, entityTypes, relationships
        argument. All arguments will be with the AND operator. For example using the
        following arguments entities=8.8.8.8 entities_types=Domain will provide just
        relationships that the 8.8.8.8 indicator has with indicators of type domain.
      scriptName: SearchIndicatorRelationships
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      entities:
        simple: 1.1.1.1
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 4ddc4083-61fd-40f9-8626-a4bbed32f087
    type: condition
    task:
      id: 4ddc4083-61fd-40f9-8626-a4bbed32f087
      version: -1
      name: Check basic relationships exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "9"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Relationships.EntityA
            iscontext: true
          right:
            value:
              simple: 1.1.1.1
      - - operator: isEqualString
          left:
            value:
              simple: Relationships.EntityB
            iscontext: true
          right:
            value:
              simple: google.com
      - - operator: isEqualString
          left:
            value:
              simple: Relationships.EntityAType
            iscontext: true
          right:
            value:
              simple: IP
      - - operator: isEqualString
          left:
            value:
              simple: Relationships.EntityBType
            iscontext: true
          right:
            value:
              simple: Domain
    view: |-
      {
        "position": {
          "x": 50,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 848b02c7-e70e-4e63-812c-bf7521849dc5
    type: regular
    task:
      id: 848b02c7-e70e-4e63-812c-bf7521849dc5
      version: -1
      name: Delete Relationships
      description: This automation allows to delete a relationship between indicator
        objects based on the relationship id.
      scriptName: DeleteIndicatorRelationships
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      ids:
        simple: ${Relationships.ID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 6f6b7f95-87e1-41bb-8094-9f1334bec578
    type: regular
    task:
      id: 6f6b7f95-87e1-41bb-8094-9f1334bec578
      version: -1
      name: Search for deleted Relationship
      description: This automation outputs the indicator relationships to context
        according to the provided query. Using the entities, entityTypes, relationships
        argument. All arguments will be with the AND operator. For example using the
        following arguments entities=8.8.8.8 entities_types=Domain will provide just
        relationships that the 8.8.8.8 indicator has with indicators of type domain.
      scriptName: SearchIndicatorRelationships
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      entities:
        simple: 1.1.1.1
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 761283f7-6138-44a0-8f90-fd0ed1e52511
    type: condition
    task:
      id: 761283f7-6138-44a0-8f90-fd0ed1e52511
      version: -1
      name: Check if Deleted
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "12"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: hasLength
          left:
            value:
              simple: Relationships
            iscontext: true
          right:
            value:
              simple: "0"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: 56c3ad92-6211-4be5-8773-6cd0be010b17
    type: regular
    task:
      id: 56c3ad92-6211-4be5-8773-6cd0be010b17
      version: -1
      name: Search For Relationships of indicator with verbose
      description: This automation outputs the indicator relationships to context
        according to the provided query. Using the entities, entityTypes, relationships
        argument. All arguments will be with the AND operator. For example using the
        following arguments entities=8.8.8.8 entities_types=Domain will provide just
        relationships that the 8.8.8.8 indicator has with indicators of type domain.
      scriptName: SearchIndicatorRelationships
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      entities:
        simple: 1.1.1.1
      verbose:
        simple: "true"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: ead21490-7b4b-4536-833a-e6a90d034c78
    type: condition
    task:
      id: ead21490-7b4b-4536-833a-e6a90d034c78
      version: -1
      name: Check Relationships exists  with verbose
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "4"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Relationships.Brand
            iscontext: true
          right:
            value:
              simple: XSOAR
      - - operator: isEqualString
          left:
            value:
              simple: Relationships.Type
            iscontext: true
          right:
            value:
              simple: IndicatorToIndicator
      - - operator: isEqualString
          left:
            value:
              simple: Relationships.Description
            iscontext: true
          right:
            value:
              simple: Test Relationships
      - - operator: isEqualString
          left:
            value:
              simple: Relationships.Reliability
            iscontext: true
          right:
            value:
              simple: C - Fairly reliable
    view: |-
      {
        "position": {
          "x": 50,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 25440803-8743-44f7-8e78-4eafa2790621
    type: regular
    task:
      id: 25440803-8743-44f7-8e78-4eafa2790621
      version: -1
      name: Delete Context for delete search
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: d4df83d6-d981-4504-8843-1cf6f2582120
    type: title
    task:
      id: d4df83d6-d981-4504-8843-1cf6f2582120
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1765,
        "width": 380,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
