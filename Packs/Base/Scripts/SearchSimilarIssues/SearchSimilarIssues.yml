args:
- description: Issue ID to get the prediction of. If empty, predicts the the current issue ID.
  name: issue_id
- auto: PREDEFINED
  description: 'Comma-separated free-text fields compared using semantic similarity scoring. Suitable for longer descriptive fields where partial matches are meaningful. For example: name, details, commandline.'
  name: text_similarity_fields
- auto: PREDEFINED
  description: 'Comma-separated fields representing discrete identifiers. Each field contributes 1 if values are equal, or 0 if not. The average of all selected fields affects the overall similarity score. For example: sha256, domain, url.'
  name: discrete_match_fields
- auto: PREDEFINED
  description: 'Comma-separated fields containing structured data. Each is compared using element-level similarity. For example: CustomFields.'
  name: json_similarity_fields
- auto: PREDEFINED
  description: Comma-separated list of additional issue fields to display, but which will not be taken into account when computing similarity.
  name: fields_to_display
- auto: PREDEFINED
  description: Comma-separated incident fields that must exactly match the current incident before any similarity scoring is applied. Acts as a strict pre-filter.
  name: filter_equal_fields
- auto: PREDEFINED
  defaultValue: 'False'
  description: Whether to use a predefined set of fields and custom fields to compute similarity. If "True", it will ignore values in text_similarity_fields, json_similarity_fields, discrete_match_fields.
  name: use_all_fields
  predefined:
  - 'True'
  - 'False'
- defaultValue: 1 months ago
  description: The start date by which to filter issues. Date format will be the same as in the issues query page, for example, "3 days ago", ""2019-01-01T00:00:00 +0200").
  name: from_date
- description: The end date by which to filter issues. Date format will be the same as in the issues query page, for example, "3 days ago", ""2019-01-01T00:00:00 +0200").
  name: to_date
- defaultValue: '1500'
  description: The maximum number of issues to query.
  name: limit
- auto: PREDEFINED
  defaultValue: 'False'
  description: Whether to aggregate duplicate issues within diffrerent dates.
  name: aggregate_issues_different_date
  predefined:
  - 'True'
  - 'False'
- defaultValue: '0.2'
  description: Minimum overall similarity score (0-1) required for an incident to be considered similar. Higher thresholds return fewer, more precise matches.
  name: min_similarity
- defaultValue: '100'
  description: The maximum number of issues to display.
  name: max_issues_to_display
- auto: PREDEFINED
  defaultValue: 'False'
  description: Whether to include similarity of indicators from DBotFindSimilarIssuesByIndicators in the final score.
  name: include_indicators_similarity
  predefined:
  - 'True'
  - 'False'
- description: The minimum number of indicators required related to the issue before running the model. Relevant if includeIndicatorsSimilarity is "True".
  name: min_number_of_indicators
- auto: PREDEFINED
  description: Comma-separated list of indicator types to take into account. If empty, uses all indicators types. Relevant if includeIndicatorsSimilarity is "True".
  name: indicators_types
- description: Help to filter out indicators that appear in many issues. Relevant if includeIndicatorsSimilarity is "True".
  name: max_issues_in_indicators_for_white_list
comment: |-
  Searches past similar issues based on issue fields' similarity. Includes an option to also display indicators similarity.
  Note: For the similarity calculation, at least one field must be provided in one of the "text_similarity_fields", "json_similarity_fields", "discrete_match_fields" or "use_all_fields" arguments.
commonfields:
  id: SearchSimilarIssues
  version: -1
enabled: false
name: SearchSimilarIssues
isInternal: true
outputs:
- contextPath: SimilarIssues.excutionSummary
  description: The summary of the execution.
  type: string
- contextPath: SimilarIssues.isSimilarIssueFound
  description: Indicates whether similar issues have been found.
  type: boolean
- contextPath: SimilarIssues.similarIssueList.created
  description: The creation date of the linked issue.
  type: date
- contextPath: SimilarIssues.similarIssueList.id
  description: The ID of the linked issue.
  type: string
- contextPath: SimilarIssues.similarIssueList.name
  description: The name of the linked issue.
  type: string
- contextPath: SimilarIssues.similarIssueList.similarityIssue
  description: The similarity of the linked issue represented as a float in the range 0-1.
  type: number
- contextPath: SimilarIssues.similarIssueList.details
  description: The details of the linked issue.
  type: string
script: '-'
system: false
timeout: '0'
type: python
subtype: python3
dockerimage: demisto/python3:3.9.8.24399
fromversion: 6.1.0
marketplaces:
- platform
