category: Analytics & SIEM
commonfields:
  id: VaronisDataSecurityPlatformSaaS
  version: -1
configuration:
- display: Fetch incidents
  name: isFetch
  required: false
  type: 8
- display: Incident type
  name: incidentType
  required: false
  type: 13
  defaultvalue: Varonis DSP Incident
- display: The FQDN/IP the integration should connect to
  hidden: false
  name: url
  required: true
  type: 0
- display: X-API-Key
  hidden: false
  name: apiKey
  required: true
  type: 0
- display: Use system proxy settings
  hidden: false
  name: proxy
  required: false
  type: 8
- display: Trust any certificate (not secure)
  hidden: false
  name: insecure
  required: false
  type: 8
- defaultvalue: '1000'
  display: Maximum number of incidents per fetch
  additionalinfo: 
  name: max_fetch
  type: 0
  required: false
- defaultvalue: 1 week
  display: First fetch time
  hidden: false
  name: first_fetch
  required: false
  type: 0
- defaultvalue: Low
  display: Minimum severity of alerts to fetch
  hidden: false
  name: severity
  options:
  - Low
  - Medium
  - High
  required: false
  type: 15
- display: Varonis threat model name
  additionalinfo: Comma-separated list of threat model names of alerts to fetch
  hidden: false
  name: threat_model
  required: false
  type: 0
- defaultvalue: New
  display: Varonis alert status
  hidden: false
  name: status
  options:
  - New
  - Under Investigation
  - Closed
  - Action Required
  - Auto-Resolved
  required: false
  type: 15
description: Streamline alerts and related forensic information from Varonis DSP
display: Varonis Data Security Platform SaaS
name: VaronisDataSecurityPlatformSaaS
script:
  commands:
  - arguments:
    - default: false
      description: List of requested threat models to retrieve
      isArray: true
      name: threat_model_name
      required: false
      secret: false
    - default: false
      description: Start time of alert range
      isArray: false
      name: start_time
      required: false
      secret: false
    - default: false
      description: End time of alert range
      isArray: false
      name: end_time
      required: false
      secret: false
    - default: false
      description: List of required alerts status
      isArray: true
      name: alert_status
      required: false
      secret: false
    - default: false
      description: List of required alerts severity
      isArray: true
      name: alert_severity
      required: false
      secret: false
    - default: false
      description: List of required alerts device name
      isArray: true
      name: device_name
      required: false
      secret: false
    - default: false
      description: User domain name (cannot be provided without user_name)
      isArray: false
      name: user_domain_name
      required: false
      secret: false
    - default: false
      description: Number of days you want the search to go back to
      isArray: false
      name: last_days
      required: false
      secret: false
    - default: false
      description: Indicates whether alerts should be ordered in newest to oldest order
      isArray: false
      name: descending_order
      required: false
      secret: false
    deprecated: false
    description: Get alerts from Varonis DA
    execution: false
    name: varonis-get-alerts
    outputs:
    - contextPath: Varonis.Alert.ID
      description: Varonis ID for alert
      type: Number
    - contextPath: Varonis.Alert.Name
      description: Name of retrieved alert
      type: String
    - contextPath: Varonis.Alert.Time
      description: When was the alert triggered
      type: Date
    - contextPath: Varonis.Alert.Severity
      description: Alert severity
      type: String
    - contextPath: Varonis.Alert.Category
      description: "Alert category.\nOptions are:\n- Reconnaissance \n- Intrusion\
        \ \n- Exploitation \n- Privilege Escalation \n- Lateral Movement "
      type: String
    - contextPath: Varonis.Alert.Country
      description: Name of the country from which the event occurred
      type: String
    - contextPath: Varonis.Alert.State
      description: Name of the state or regional subdivision from which the event
        occurred
      type: String
    - contextPath: Varonis.Alert.Status
      description: |-
        Alert state. Options are:
        - New
        - Under investigation
        - Closed
        - Action Required
        - Auto-Resolved
      type: String
    - contextPath: Varonis.Alert.CloseReason
      description: |-
        Reason the alert was closed. Options are:
        - Resolved
        - Misconfiguration
        - Threat model disabled or deleted
        - Account misclassification
        - Legitimate activity
        - Other
      type: String
    - contextPath: Varonis.Alert.BlacklistLocation
      description: Whether any of the geographical locations from which an alerted
        activity originated was on the blacklist at the time the activity occurred
      type: Boolean
    - contextPath: Varonis.Alert.AbnormalLocation
      description: Whether any of the geographical locations from which an alerted
        activity originated is new or abnormal to the organization, the user and peers,
        or only the user
      type: Boolean
    - contextPath: Varonis.Alert.NumOfAlertedEvents
      description: Number of events with alerts
      type: Number
    - contextPath: Varonis.Alert.UserName
      description: Name of the users triggered alerts
      type: String
    - contextPath: Varonis.Alert.SamAccountName
      description: |-
        Logon name used to support clients and servers running earlier versions of Windows operating system, such as Windows NT 4.0.
        In the dashboards (other than the Alert dashboard), this is the SAM account name of the user or group
      type: String
    - contextPath: Varonis.Alert.PrivilegedAccountType
      description: |-
        Privileged account. Options are:
        - Service accounts
        - Admin accounts
        - Executive accounts
      type: String
    - contextPath: Varonis.Alert.Department
      description: User`s department
      type: String
    - contextPath: Varonis.Alert.ContainsFlaggedData
      description: Whether the data affected by the alerted events has global flags
      type: Boolean
    - contextPath: Varonis.Alert.ContainsSensitiveData
      description: Filters according to whether the resource on which the event was
        performed is sensitive (including subfolders)
      type: Boolean
    - contextPath: Varonis.Alert.Platform
      description: Type of platform on which the server resides. For example, Windows,
        Exchange, or SharePoint
      type: String
    - contextPath: Varonis.Alert.Asset
      description: Path of the alerted asset
      type: String
    - contextPath: Varonis.Alert.FileServerOrDomain
      description: Associated file server/domain
      type: String
    - contextPath: Varonis.Alert.DeviceName
      description: Name of the device from which the user generated the event
      type: String
    - contextPath: Varonis.Alert.ContainMaliciousExternalIP
      description: Whether the alert contains IPs known to be malicious
      type: Boolean
    - contextPath: Varonis.Alert.IPThreatTypes
      description: Whether the alert contains IPs known to be malicious
      type: String
  - arguments:
    - default: false
      description: Requested alerts
      isArray: true
      name: alert_id
      required: true
      secret: false
    - auto: PREDEFINED
      predefined:
      - New
      - Under Investigation
      - Action Required
      - Auto-Resolved
      default: false
      description: Alert new status
      isArray: false
      name: status
      required: true
      secret: false
    - default: false
      description: Note
      isArray: false
      name: note
      required: false
      secret: false
    deprecated: false
    description: Update alert status
    execution: false
    name: varonis-update-alert-status
  - arguments:
    - default: false
      description: Requested alerts
      isArray: true
      name: alert_id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: The reason the alert was closed
      predefined:
      - Resolved
      - Misconfiguration
      - Threat model disabled or deleted
      - Account misclassification
      - Legitimate activity
      - Other
      isArray: false
      name: close_reason
      required: true
      secret: false
    - default: false
      description: Note
      isArray: false
      name: note
      required: false
      secret: false
    deprecated: false
    description: Close the alert
    execution: false
    name: varonis-close-alert
  - arguments:
    - default: false
      description: List of alert IDs
      isArray: true
      name: alert_id
      required: true
      secret: false
    - default: false
      description: Start time of alert range
      isArray: false
      name: start_time
      required: false
      secret: false
    - default: false
      description: End time of alert range
      isArray: false
      name: end_time
      required: false
      secret: false
    - default: false
      description: Number of days you want the search to go back to
      isArray: false
      name: last_days
      required: false
      secret: false  
    - default: false
      description: Indicates whether events should be ordered in newest to oldest order
      isArray: false
      name: descending_order
      required: false
      secret: false
    deprecated: false
    description: Get events applied to specific alerts
    execution: false
    name: varonis-get-alerted-events
    outputs:
    - contextPath: Varonis.Event.Type
      description: Event type
      type: String
    - contextPath: Varonis.Event.UTCTime
      description: Event time UTC format
      type: Date
    - contextPath: Varonis.Event.Status
      description: |-
        Filters according to the status of the event. Options are:
        - Fail
        - Success
      type: String
    - contextPath: Varonis.Event.Description
      description: Description of the activity
      type: String
    - contextPath: Varonis.Event.Country
      description: Name of the country from which the event occurred
      type: String
    - contextPath: Varonis.Event.State
      description: Name of the state or regional subdivision from which the event
        occurred
      type: String
    - contextPath: Varonis.Event.ExternalIP
      description: Device external IP
      type: String
    - contextPath: Varonis.Event.IsBlacklist
      description: Whether any of the geographical locations from which an alerted
        activity originated was on the blacklist at the time the activity occurred
      type: Boolean
    - contextPath: Varonis.Event.Operation
      description: |-
        Type of operation that occurred during the event. Options are:
        - Accessed
        - Added
        - Changed
        - Removed
        - Sent
        - Received
        - Requested
      type: String
    - contextPath: Varonis.Event.ByUserName
      description: Name of the user that triggered the event
      type: String
    - contextPath: Varonis.Event.ByUserUserType
      description: Type of account, i.e., user or computer
      type: String
    - contextPath: Varonis.Event.ByUserUserAccountType
      description: |-
        Logon name used to support clients and servers running earlier versions of the Windows operating system, such as Windows NT 4.0.
        In the dashboards (other than the Alert dashboard), this is the SAM account name of the user or group
      type: String
    - contextPath: Varonis.Event.ByUserDomain
      description: Domain of the user that triggered the event
      type: String
    - contextPath: Varonis.Event.ByUserDisabledAccount
      description: Whether the account is disabled
      type: Boolean
    - contextPath: Varonis.Event.ByUserStaleAccount
      description: Whether the account is stale
      type: Boolean
    - contextPath: Varonis.Event.ByUserLockoutAccounts
      description: Whether the account is lockout
      type: Boolean
    - contextPath: Varonis.Event.SourceIP
      description: Source IP of the device triggered the event
      type: String
    - contextPath: Varonis.Event.IsMaliciousIP
      description: Whether the IP is known to be malicious
      type: Boolean
    - contextPath: Varonis.Event.IPReputation
      description: Reputation score of the IP. The score is a numeric value from 1-100
      type: Number
    - contextPath: Varonis.Event.IPThreatType
      description: List of threat types associated with the IP
      type: String
    - contextPath: Varonis.Event.OnObjectName
      description: Name of object on which the event was performed
      type: String
    - contextPath: Varonis.Event.ObjectType
      description: Type of object on which the event was performed
      type: String
    - contextPath: Varonis.Event.Platform
      description: Type of platform on which the server resides. For example, Windows,
        Exchange, or SharePoint
      type: String
    - contextPath: Varonis.Event.IsSensitive
      description: 'Indicates whether the resource on which the event was performed
        is sensitive '
      type: Boolean
    - contextPath: Varonis.Event.FileServerOrDomain
      description: File server of object on which the event was performed
      type: String
    - contextPath: Varonis.Event.IsDisabledAccount
      description: Whether the account is disabled
      type: Boolean
    - contextPath: Varonis.Event.IsLockOutAccount
      description: Whether the account is lockout
      type: Boolean
    - contextPath: Varonis.Event.SAMAccountName
      description: |-
        Logon name used to support clients and servers running earlier versions of the Windows operating system, such as Windows NT 4.0.
        In the dashboards (other than the Alert dashboard), this is the SAM account name of the user or group
      type: String
    - contextPath: Varonis.Event.UserAccountType
      description: |-
        Specified type of privileged account. Options are:
        - Service accounts
        - Admin accounts
        - Executive accounts
        - Test accounts
      type: String
    - contextPath: Varonis.Event.DestinationIP
      description: Destination IP address within the organization
      type: String
    - contextPath: Varonis.Event.DestinationDevice
      description: Destination host name for relevant services
      type: String
    - contextPath: Varonis.Event.Path
      description: Path of asset
      type: String
  - arguments:
      - default: false
        description: List of requested threat model ids
        isArray: true
        name: id
        required: false
        secret: false
      - default: false
        description: List of requested threat model names
        isArray: true
        name: name
        required: false
        secret: false  
      - default: false
        description: List of requested threat model categories
        isArray: true
        name: category
        required: false
        secret: false
      - default: false
        description: List of requested threat model severities
        isArray: true
        name: severity
        required: false
        secret: false
      - default: false
        description: List of requested threat model sources
        isArray: true
        name: source
        required: false
        secret: false
    deprecated: false
    description: Get Varonis threat models
    execution: false
    name: varonis-get-threat-models
  dockerimage: demisto/ntlm:1.0.0.78782
  feed: false
  isfetch: true
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  subtype: python3
  type: python
tests:
- No tests (auto formatted)
fromversion: 6.0.0
defaultmapperin: Varonis DSP Incident - Incoming Mapper
