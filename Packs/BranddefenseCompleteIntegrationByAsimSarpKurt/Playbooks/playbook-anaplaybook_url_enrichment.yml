contentitemexportablefields:
  contentitemfields:
    propagationLabels:
    - all
id: anaplaybook_url_enrichment
inputs: []
name: anaplaybook_url_enrichment
outputs: []
quiet: true
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ada1487b-48dc-4d60-8c6c-2810f15a151c
      iscommand: false
      name: ""
      version: -1
      description: ''
    taskid: ada1487b-48dc-4d60-8c6c-2810f15a151c
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 582.5,
          "y": 50
        }
      }
  "1":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${incident.detectionurl}
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "4"
      "yes":
      - "3"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ae51c6c1-6789-46a0-83c3-6c10bc2d9b8d
      iscommand: false
      name: Is there a URL?
      type: condition
      version: -1
    taskid: ae51c6c1-6789-46a0-83c3-6c10bc2d9b8d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 582.5,
          "y": 195
        }
      }
  "2":
    continueonerror: true
    continueonerrortype: errorPath
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#error#':
      - "7"
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      extended_data:
        simple: "false"
      url:
        simple: ${incident.detectionurl}
    separatecontext: false
    skipunavailable: false
    task:
      brand: VirusTotal (API v3)
      description: Checks the reputation of a URL.
      id: e6215575-ff22-47d1-8499-230f78e46b19
      iscommand: true
      name: VT URL Enrichment
      script: VirusTotal (API v3)|||url
      type: regular
      version: -1
    taskid: e6215575-ff22-47d1-8499-230f78e46b19
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 690
        }
      }
  "3":
    continueonerrortype: ""
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
      - "2"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ab0b1576-d9a8-4cf5-815e-e4c8f3e5e59f
      iscommand: false
      name: Enrichment
      type: title
      version: -1
      description: ''
    taskid: ab0b1576-d9a8-4cf5-815e-e4c8f3e5e59f
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 367.5,
          "y": 370
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ae1f7f71-2ef9-4ce9-8fce-f2d5c42ee3fa
      iscommand: false
      name: Playbook End
      type: title
      version: -1
      description: ''
    taskid: ae1f7f71-2ef9-4ce9-8fce-f2d5c42ee3fa
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 797.5,
          "y": 370
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      url:
        simple: ${incident.detectionurl}
    separatecontext: false
    skipunavailable: false
    task:
      brand: VirusTotal (API v3)
      description: Scans a specified URL. Use the vt-analysis-get command to get the scan results.
      id: ec9ba146-34be-43a1-8561-92fbf66c0727
      iscommand: true
      name: Detailed Advanced URL Scan
      script: VirusTotal (API v3)|||url-scan
      type: regular
      version: -1
    taskid: ec9ba146-34be-43a1-8561-92fbf66c0727
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 582.5,
          "y": 515
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      extended_data:
        simple: "False"
      id:
        simple: ${vtScanID}
    separatecontext: false
    skipunavailable: false
    task:
      brand: VirusTotal (API v3)
      description: Get analysis of a file submitted to VirusTotal.
      id: 7366c006-4d58-4cff-824d-ce8b20437329
      iscommand: true
      name: Get URL Scan Results
      script: VirusTotal (API v3)|||vt-analysis-get
      type: regular
      version: -1
    taskid: 7366c006-4d58-4cff-824d-ce8b20437329
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 582.5,
          "y": 690
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3d0b226f-c3ae-4943-8b27-0aa5dc539138
      iscommand: false
      name: Playbook End
      type: title
      version: -1
      description: ''
    taskid: 3d0b226f-c3ae-4943-8b27-0aa5dc539138
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 367.5,
          "y": 1215
        }
      }
  "8":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${VirusTotal.Analysis.data.attributes.stats.malicious}
          operator: greaterThanOrEqual
          right:
            value:
              simple: "5"
      label: "yes"
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "10"
      "yes":
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f674f7d1-9cae-4292-82a9-82eedb46bf69
      iscommand: false
      name: URL Score Control
      type: condition
      version: -1
    taskid: f674f7d1-9cae-4292-82a9-82eedb46bf69
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 480,
          "y": 865
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      urlscoreoutput:
        simple: Malicious
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: fdb6ce79-a640-4260-89ec-7de135f4dce0
      iscommand: true
      name: URL Score Output
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: fdb6ce79-a640-4260-89ec-7de135f4dce0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1040
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      urlscoreoutput:
        simple: Benign
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: e15b6aef-0bb7-4292-8ceb-7ee6ac7b5db9
      iscommand: true
      name: Set URL score to Benign
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: e15b6aef-0bb7-4292-8ceb-7ee6ac7b5db9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 695,
          "y": 1040
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1230,
        "width": 1127.5,
        "x": 50,
        "y": 50
      }
    }
  }
tests:
- No tests (auto formatted)
fromversion: 6.0.0
