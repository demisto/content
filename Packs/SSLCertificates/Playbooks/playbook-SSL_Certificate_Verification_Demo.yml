contentitemexportablefields:
  contentitemfields:
    propagationLabels:
    - all
description: "Demo playbook - takes list of addresses from an XSOAR list, process the status of each SSL certificate, and generate war room and email summary outputs.\n\nFor this demo, the first task is configured to use the \"lists.SSL_Certificates\" list inside of XSOAR. To run this demo playbook, please pass an array of values or point the first task to an appropriate XSOAR list. "
id: SSL Certificate Verification Demo
inputs: []
name: SSL Certificate Verification Demo
outputs: []
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3a91fa90-fdf5-4747-88a4-4eb8add91062
      iscommand: false
      name: ""
      version: -1
      description: ''
    taskid: 3a91fa90-fdf5-4747-88a4-4eb8add91062
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 725,
          "y": 50
        }
      }
  "2":
    continueonerror: true
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      URL:
        complex:
          accessor: SSL_Certificates
          root: lists
          transformers:
          - args:
              delimiter:
                value:
                  simple: ','
            operator: splitAndTrim
      ignore-outputs:
        simple: "false"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Use this automation to check for validity of your SSL certificate and get the time until expiration.
      id: 5b65570c-0010-4131-8834-7b0980dcb7d4
      iscommand: false
      name: Check certificate status for each domain
      scriptName: SSLVerifierV2
      type: regular
      version: -1
    taskid: 5b65570c-0010-4131-8834-7b0980dcb7d4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 725,
          "y": 195
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "15"
      - "16"
      - "17"
      - "18"
    note: false
    quietmode: 1
    scriptarguments:
      OutputToWarRoom:
        simple: "False"
      StatusType:
        simple: all
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Parses the output from the !SSLVerifier automation into a markdown table and separate context key \n\n"
      id: 2e472ee0-59dc-459a-8a4f-7b0379af7c19
      iscommand: false
      name: Parse SSLVerifierV2 Output
      scriptName: SSLVerifierV2_ParseOutput
      type: regular
      version: -1
    taskid: 2e472ee0-59dc-459a-8a4f-7b0379af7c19
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 725,
          "y": 370
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Generate the HTML-formatted report for delivery via email
      id: 240c0c29-33d4-40a8-80f8-c567cc6020df
      iscommand: false
      name: Generate Report Email (HTML)
      scriptName: SSLVerifierV2_GenerateEmailBody
      type: regular
      version: -1
    taskid: 240c0c29-33d4-40a8-80f8-c567cc6020df
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 725,
          "y": 895
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    scriptarguments:
      htmlBody:
        simple: ${SSLReport.HTML}
      subject:
        simple: SSL Certificate Report
      to:
        simple: user@domain.tld
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Sends mail using Gmail.
      id: fe1bc599-9e89-461c-85bb-80b121fa0dc2
      iscommand: true
      name: Send Report Email (HTML)
      script: '|||send-mail'
      type: regular
      version: -1
    taskid: fe1bc599-9e89-461c-85bb-80b121fa0dc2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 725,
          "y": 1070
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 1
    scriptarguments:
      columns:
        simple: Domain, ExpirationDate, TimeToExpiration
      context_path:
        simple: SSLReport.Expired
      grid_id:
        simple: sslcertificatesexpired
      overwrite:
        simple: "true"
      sort_by:
        simple: timetoexpiration
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Creates a Grid table from items or key-value pairs.
      id: c565ddd3-b221-41ef-87cb-4f63254dfad2
      iscommand: false
      name: Set Expired Certificates Grid
      scriptName: SetGridField
      type: regular
      version: -1
    taskid: c565ddd3-b221-41ef-87cb-4f63254dfad2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 720
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 1
    scriptarguments:
      columns:
        simple: Domain, ExpirationDate, TimeToExpiration
      context_path:
        simple: SSLReport.Expiring
      grid_id:
        simple: sslcertificatesexpiring
      overwrite:
        simple: "true"
      sort_by:
        simple: timetoexpiration
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Creates a Grid table from items or key-value pairs.
      id: e603021f-e23e-4aea-889f-726f0520ff77
      iscommand: false
      name: Set Expiring Certificates Grid
      scriptName: SetGridField
      type: regular
      version: -1
    taskid: e603021f-e23e-4aea-889f-726f0520ff77
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 612.5,
          "y": 720
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 1
    scriptarguments:
      columns:
        simple: Domain, ExpirationDate, TimeToExpiration
      context_path:
        simple: SSLReport.Warning
      grid_id:
        simple: sslcertificateswarning
      overwrite:
        simple: "true"
      sort_by:
        simple: timetoexpiration
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Creates a Grid table from items or key-value pairs.
      id: bd14c4e2-b6c7-4e64-87c7-4c7344b45707
      iscommand: false
      name: Set Warning Certificates Grid
      scriptName: SetGridField
      type: regular
      version: -1
    taskid: bd14c4e2-b6c7-4e64-87c7-4c7344b45707
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1062.5,
          "y": 720
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 1
    scriptarguments:
      columns:
        simple: Domain, ExpirationDate, TimeToExpiration
      context_path:
        simple: SSLReport.Good
      grid_id:
        simple: sslcertificatesgood
      overwrite:
        simple: "true"
      sort_by:
        simple: timetoexpiration
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Creates a Grid table from items or key-value pairs.
      id: c7578ebf-89f7-4732-8141-06dde0668fd7
      iscommand: false
      name: Set Good Certificates Grid
      scriptName: SetGridField
      type: regular
      version: -1
    taskid: c7578ebf-89f7-4732-8141-06dde0668fd7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1512.5,
          "y": 720
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bdfa4fed-fe25-4701-82e9-67a0a161e839
      iscommand: false
      name: Playbook Finished
      type: title
      version: -1
      description: ''
    taskid: bdfa4fed-fe25-4701-82e9-67a0a161e839
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 725,
          "y": 1420
        }
      }
  "15":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${SSLReport.Expired}
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "10"
    note: false
    quietmode: 1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: This script checks that a context key exists (and contains data), and optionally checks the value of the context key for a match against an input value. If a regex is not supplied, the script checks that the key is not empty. This script can be used with the "GenericPolling" playbook to poll for field population or that a field contains a specific value. This scripts does not support a context key which holds a list of values.
      id: 5ee8839a-ef18-456c-8019-0f87527cb005
      iscommand: false
      name: Were Expired Certificates Found?
      type: condition
      version: -1
    taskid: 5ee8839a-ef18-456c-8019-0f87527cb005
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 50,
          "y": 545
        }
      }
  "16":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${SSLReport.Expiring}
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "11"
    note: false
    quietmode: 1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: This script checks that a context key exists (and contains data), and optionally checks the value of the context key for a match against an input value. If a regex is not supplied, the script checks that the key is not empty. This script can be used with the "GenericPolling" playbook to poll for field population or that a field contains a specific value. This scripts does not support a context key which holds a list of values.
      id: 6dd96060-033b-4934-8f06-74e3e1f52a70
      iscommand: false
      name: Were Expiring Certificates Found?
      type: condition
      version: -1
    taskid: 6dd96060-033b-4934-8f06-74e3e1f52a70
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 500,
          "y": 545
        }
      }
  "17":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${SSLReport.Warning}
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "12"
    note: false
    quietmode: 1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: This script checks that a context key exists (and contains data), and optionally checks the value of the context key for a match against an input value. If a regex is not supplied, the script checks that the key is not empty. This script can be used with the "GenericPolling" playbook to poll for field population or that a field contains a specific value. This scripts does not support a context key which holds a list of values.
      id: 50ca6d39-5a7e-4bda-823b-302161b59504
      iscommand: false
      name: Were Warning Certificates Found?
      type: condition
      version: -1
    taskid: 50ca6d39-5a7e-4bda-823b-302161b59504
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 950,
          "y": 545
        }
      }
  "18":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${SSLReport.Good}
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "13"
    note: false
    quietmode: 1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: This script checks that a context key exists (and contains data), and optionally checks the value of the context key for a match against an input value. If a regex is not supplied, the script checks that the key is not empty. This script can be used with the "GenericPolling" playbook to poll for field population or that a field contains a specific value. This scripts does not support a context key which holds a list of values.
      id: 83b40786-0183-4c6c-8b85-5a9d7ed82d4d
      iscommand: false
      name: Were Good Certificates Found?
      type: condition
      version: -1
    taskid: 83b40786-0183-4c6c-8b85-5a9d7ed82d4d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1400,
          "y": 545
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "14"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: ${SSLReport.md}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Prints text to war room (Markdown supported)
      id: a9c1145c-46a0-4194-8510-ba2b0862714a
      iscommand: false
      name: Print output to War Room
      scriptName: Print
      type: regular
      version: -1
    taskid: a9c1145c-46a0-4194-8510-ba2b0862714a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 725,
          "y": 1245
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1435,
        "width": 1842.5,
        "x": 50,
        "y": 50
      }
    }
  }
tests:
- No tests (auto formatted)
fromversion: 6.8.0
