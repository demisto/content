id: RedLockTest
version: 31
name: RedLockTest
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 56707026-34e9-498c-8147-07ef704146dd
    type: start
    task:
      id: 56707026-34e9-498c-8147-07ef704146dd
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 260,
          "y": -160
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "1":
    id: "1"
    taskid: ca76bb21-765d-4bcc-8ceb-13d27105ddad
    type: regular
    task:
      id: ca76bb21-765d-4bcc-8ceb-13d27105ddad
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "37"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 260,
          "y": -35
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "2":
    id: "2"
    taskid: 929f7631-b1df-49d4-8e6c-77a4ff29b219
    type: regular
    task:
      id: 929f7631-b1df-49d4-8e6c-77a4ff29b219
      version: -1
      name: Retrieve All Alerts from Last 6 hours
      description: Search alerts on the RedLock platform
      script: '|||redlock-search-alerts'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "21"
    scriptarguments:
      alert-id: {}
      alert-rule-name: {}
      alert-status:
        simple: resolved
      cloud-account: {}
      cloud-region: {}
      cloud-type: {}
      policy-compliance-standard: {}
      policy-label: {}
      policy-name: {}
      policy-severity: {}
      policy-type: {}
      resource-id: {}
      resource-name: {}
      resource-type: {}
      risk-grade: {}
      time-range-date-from: {}
      time-range-date-to: {}
      time-range-unit:
        simple: day
      time-range-value:
        simple: "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "12":
    id: "12"
    taskid: 7e1c8970-0569-4ae8-8318-6ac5283ff77d
    type: regular
    task:
      id: 7e1c8970-0569-4ae8-8318-6ac5283ff77d
      version: -1
      name: Get Most Recent Alert Details
      script: '|||redlock-get-alert-details'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      alert-id:
        simple: ${RedLockID}
      detailed: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "13":
    id: "13"
    taskid: 9e6ae0d1-ea0e-48ae-8a66-b1f30e6f4897
    type: condition
    task:
      id: 9e6ae0d1-ea0e-48ae-8a66-b1f30e6f4897
      version: -1
      name: Change Alert Status
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "23"
      already open:
      - "28"
      resolved:
      - "32"
    separatecontext: false
    conditions:
    - label: already open
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: ${RedLockStatus}
          right:
            value:
              simple: open
    - label: resolved
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: ${RedLockStatus}
            iscontext: true
          right:
            value:
              simple: resolved
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "21":
    id: "21"
    taskid: 2e0b32c8-0cac-4913-8d3b-62bae625fa54
    type: condition
    task:
      id: 2e0b32c8-0cac-4913-8d3b-62bae625fa54
      version: -1
      name: Check for response
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "24"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: Redlock
                accessor: Alert
            iscontext: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "22":
    id: "22"
    taskid: 938f6ec3-423d-4798-8147-4cd14d0c40b1
    type: title
    task:
      id: 938f6ec3-423d-4798-8147-4cd14d0c40b1
      version: -1
      name: Test Completed
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 270,
          "y": 3060
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "23":
    id: "23"
    taskid: f22dcdab-bcfd-4ff4-8742-23d3d366a81e
    type: regular
    task:
      id: f22dcdab-bcfd-4ff4-8742-23d3d366a81e
      version: -1
      name: Open the Alert
      description: Re-open the alerts matching the given filter.  Must provide either policy IDs or alert IDs.
      script: '|||redlock-reopen-alerts'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      alert-id:
        simple: ${RedLockID}
      alert-rule-name: {}
      alert-status: {}
      cloud-account: {}
      cloud-region: {}
      cloud-type: {}
      policy-compliance-standard: {}
      policy-label: {}
      policy-name: {}
      policy-severity: {}
      policy-type: {}
      resource-id: {}
      resource-name: {}
      resource-type: {}
      risk-grade: {}
      time-range-date-from: {}
      time-range-date-to: {}
      time-range-unit: {}
      time-range-value: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -20,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "24":
    id: "24"
    taskid: f4837fed-5e4f-4dc1-870e-9860a10e82fe
    type: regular
    task:
      id: f4837fed-5e4f-4dc1-870e-9860a10e82fe
      version: -1
      name: Store Recent Alert ID
      description: Sets a value into the context with the given context key
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "25"
    scriptarguments:
      append: {}
      key:
        simple: RedLockID
      stringify: {}
      value:
        simple: ${Redlock.Alert.[0].ID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "25":
    id: "25"
    taskid: 0e82af00-cc54-4d3a-8ffb-3dc790b0ed49
    type: regular
    task:
      id: 0e82af00-cc54-4d3a-8ffb-3dc790b0ed49
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key: {}
      keysToKeep:
        simple: RedLockID
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "28":
    id: "28"
    taskid: 0c5a0fb1-87c7-4c66-8d22-884e860ee4c3
    type: regular
    task:
      id: 0c5a0fb1-87c7-4c66-8d22-884e860ee4c3
      version: -1
      name: Dismiss Alert
      description: Dismiss the alerts matching the given filter. Must provide either policy IDs or alert IDs.
      script: '|||redlock-dismiss-alerts'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      alert-id:
        simple: ${RedLockID}
      alert-rule-name: {}
      alert-status: {}
      cloud-account: {}
      cloud-region: {}
      cloud-type: {}
      dismissal-note:
        simple: Testing
      policy-compliance-standard: {}
      policy-id: {}
      policy-label: {}
      policy-name: {}
      policy-severity: {}
      policy-type: {}
      resource-id: {}
      resource-name: {}
      resource-type: {}
      risk-grade: {}
      time-range-date-from: {}
      time-range-date-to: {}
      time-range-unit: {}
      time-range-value: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 560,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "29":
    id: "29"
    taskid: d391b237-c270-449b-85e3-3be7353aa87e
    type: condition
    task:
      id: d391b237-c270-449b-85e3-3be7353aa87e
      version: -1
      name: Verify Alert Status Change
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "Yes":
      - "34"
      resolved:
      - "36"
    separatecontext: false
    conditions:
    - label: "Yes"
      condition:
      - - operator: isNotEqualString
          left:
            value:
              complex:
                root: ${Redlock
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: ${Redlock.Alert.ID}
                      iscontext: true
                    right:
                      value:
                        simple: ${RedlockID}
                      iscontext: true
                accessor: Alert.Status}
            iscontext: true
          right:
            value:
              simple: ${RedLockStatus}
            iscontext: true
    - label: resolved
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: ${RedLockStatus}
            iscontext: true
          right:
            value:
              simple: resolved
    view: |-
      {
        "position": {
          "x": 260,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "30":
    id: "30"
    taskid: 86d26c82-ce08-4eae-81df-833520c70c42
    type: regular
    task:
      id: 86d26c82-ce08-4eae-81df-833520c70c42
      version: -1
      name: Return alert To Open State
      description: Re-open the alerts matching the given filter.  Must provide either policy IDs or alert IDs.
      script: '|||redlock-reopen-alerts'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      alert-id:
        simple: ${RedLockID}
      alert-rule-name: {}
      alert-status:
        simple: open
      cloud-account: {}
      cloud-region: {}
      cloud-type: {}
      policy-compliance-standard: {}
      policy-label: {}
      policy-name: {}
      policy-severity: {}
      policy-type: {}
      resource-id: {}
      resource-name: {}
      resource-type: {}
      risk-grade: {}
      time-range-date-from: {}
      time-range-date-to: {}
      time-range-unit: {}
      time-range-value: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 610,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "31":
    id: "31"
    taskid: 81c21446-5454-469f-8f49-f0da9ecd1fd5
    type: regular
    task:
      id: 81c21446-5454-469f-8f49-f0da9ecd1fd5
      version: -1
      name: Store Recent Alert Status
      description: Sets a value into the context with the given context key
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      append: {}
      key:
        simple: RedLockStatus
      stringify: {}
      value:
        complex:
          root: Redlock
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: Redlock.Alert.ID
                iscontext: true
              right:
                value:
                  simple: RedLockID
                iscontext: true
          accessor: Alert.Status
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "32":
    id: "32"
    taskid: 5170d6fc-505b-4a6a-80ae-20cd7d1286da
    type: regular
    task:
      id: 5170d6fc-505b-4a6a-80ae-20cd7d1286da
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "33"
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key: {}
      keysToKeep:
        simple: RedLockStatus,RedLockID
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "33":
    id: "33"
    taskid: 567e30be-a6e3-45de-87d9-48e955232eee
    type: regular
    task:
      id: 567e30be-a6e3-45de-87d9-48e955232eee
      version: -1
      name: Get Alert Details
      description: Get remediation details for a given alert
      script: '|||redlock-get-remediation-details'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      alert-id:
        simple: ${RedLockID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "34":
    id: "34"
    taskid: 7de69f34-6cf0-4bdd-8f82-452a9fb42f95
    type: condition
    task:
      id: 7de69f34-6cf0-4bdd-8f82-452a9fb42f95
      version: -1
      name: Return to original state
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "35"
      open:
      - "30"
    separatecontext: false
    conditions:
    - label: open
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: ${RedLockStatus}
            iscontext: true
          right:
            value:
              simple: open
    view: |-
      {
        "position": {
          "x": 260,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "35":
    id: "35"
    taskid: 4a1d5559-c678-4f52-83c4-703c1be43d5a
    type: regular
    task:
      id: 4a1d5559-c678-4f52-83c4-703c1be43d5a
      version: -1
      name: Return alert To Dismissed State
      description: Dismiss the alerts matching the given filter. Must provide either policy IDs or alert IDs.
      script: '|||redlock-dismiss-alerts'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      alert-id:
        simple: ${RedLockID}
      alert-rule-name: {}
      alert-status:
        simple: dismissed
      cloud-account: {}
      cloud-region: {}
      cloud-type: {}
      dismissal-note:
        simple: Testing
      policy-compliance-standard: {}
      policy-id: {}
      policy-label: {}
      policy-name: {}
      policy-severity: {}
      policy-type: {}
      resource-id: {}
      resource-name: {}
      resource-type: {}
      risk-grade: {}
      time-range-date-from: {}
      time-range-date-to: {}
      time-range-unit: {}
      time-range-value: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -70,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "36":
    id: "36"
    taskid: 6ed0828b-898a-466d-8682-b0c81f2d5656
    type: regular
    task:
      id: 6ed0828b-898a-466d-8682-b0c81f2d5656
      version: -1
      name: Get Remediation Details
      description: Get remediation details for a given alert
      script: '|||redlock-get-remediation-details'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "38"
    scriptarguments:
      alert-id:
        simple: ${RedLockID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "37":
    id: "37"
    taskid: 75d523e9-d621-4059-8e65-680539bace6e
    type: regular
    task:
      id: 75d523e9-d621-4059-8e65-680539bace6e
      version: -1
      name: List Alert Filters
      description: List the acceptable filters and values for alerts
      script: '|||redlock-list-alert-filters'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 260,
          "y": 150
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "38":
    id: "38"
    taskid: e07d6883-59d9-4681-889f-1ecd0182f0b3
    type: regular
    task:
      id: e07d6883-59d9-4681-889f-1ecd0182f0b3
      version: -1
      name: Run RQL
      description: Run RQL query on Prisma Cloud
      script: '|||redlock-get-rql-response'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      rql:
        simple: config where api.name = 'aws-iam-list-access-keys'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2830
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
view: |-
  {
    "linkLabelsPosition": {
      "13_28_already open": 0.57,
      "13_32_resolved": 0.48,
      "21_24_yes": 0.53,
      "29_34_Yes": 0.58,
      "29_36_resolved": 0.85,
      "34_30_open": 0.59,
      "34_35_#default#": 0.77
    },
    "paper": {
      "dimensions": {
        "height": 3285,
        "width": 1060,
        "x": -70,
        "y": -160
      }
    }
  }
inputs: []
outputs: []
fromversion: 5.0.0
