id: Prisma Cloud V2 Test
version: -1
vcShouldKeepItemLegacyProdMachine: false
name: Prisma Cloud V2 Test
description: Test for Prisma Cloud V2.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: e1fe81d8-9039-4fcb-8f48-5f38cb43b5e2
    type: start
    task:
      id: e1fe81d8-9039-4fcb-8f48-5f38cb43b5e2
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 0acbdee9-205a-4414-839d-81617a92f90c
    type: regular
    task:
      id: 0acbdee9-205a-4414-839d-81617a92f90c
      version: -1
      name: Delete Context
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
      - "5"
      - "20"
      - "28"
      - "48"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: f00ade5e-4d72-4adb-8095-d1cc66812c21
    type: regular
    task:
      id: f00ade5e-4d72-4adb-8095-d1cc66812c21
      version: -1
      name: prisma-cloud-alert-filter-list
      description: List the acceptable filters and values for alerts
      script: '|||prisma-cloud-alert-filter-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 5a3ea8f2-4aef-433f-81d3-bb2f403ab167
    type: condition
    task:
      id: 5a3ea8f2-4aef-433f-81d3-bb2f403ab167
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "4"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloud.AlertFilters.filterName
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: efe40f00-722c-4d1e-8ac0-99966284245d
    type: title
    task:
      id: efe40f00-722c-4d1e-8ac0-99966284245d
      version: -1
      name: Test Finished Successfully
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 920,
          "y": 2850
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 2e3bd8de-9cb1-45c3-8607-0966b46d46e1
    type: regular
    task:
      id: 2e3bd8de-9cb1-45c3-8607-0966b46d46e1
      version: -1
      name: prisma-cloud-alert-search
      description: Search alerts on the Prisma Cloud platform. When no absolute time
        nor relative time arguments are provided, the search will show alerts from
        the last 7 days.
      script: '|||prisma-cloud-alert-search'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      filters:
        simple: alert.status=open,policy.remediable=true
      limit:
        simple: "1"
      time_range_unit:
        simple: hour
      time_range_value:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1555,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 3d1d22f0-39c6-430a-8353-4ffb48e18250
    type: condition
    task:
      id: 3d1d22f0-39c6-430a-8353-4ffb48e18250
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "7"
      - "26"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloud.Alert.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloud.Alert.policy.policyId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloud.Alert.resource.rrn
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1555,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: d5cec778-808e-4590-823b-0b4249da483d
    type: regular
    task:
      id: d5cec778-808e-4590-823b-0b4249da483d
      version: -1
      name: prisma-cloud-alert-get-details
      description: Gets the details of an alert based on alert ID
      script: '|||prisma-cloud-alert-get-details'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      alert_id:
        simple: ${PrismaCloud.Alert.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: e3b19e7e-8a40-4c5f-83fb-7fa374e82c05
    type: condition
    task:
      id: e3b19e7e-8a40-4c5f-83fb-7fa374e82c05
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "9"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloud.Alert.id
            iscontext: true
          right:
            value:
              simple: PrismaCloud.Alert.id
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: 0c3b6f82-d6fd-4010-88c5-0f899e209d57
    type: regular
    task:
      id: 0c3b6f82-d6fd-4010-88c5-0f899e209d57
      version: -1
      name: prisma-cloud-alert-dismiss
      description: Dismiss or snooze the alerts matching the given filter. Either
        policy IDs or alert IDs must be provided. When no absolute time nor relative
        time arguments are provided, default time range is all times. For snoozing,
        provide "snooze_unit" and "snooze_value" arguments.
      script: '|||prisma-cloud-alert-dismiss'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      alert_ids:
        simple: ${PrismaCloud.Alert.id}
      dismissal_note:
        simple: Dismissing from XSOAR test playbook
      time_range_unit:
        simple: month
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 69eceed5-f4de-49ca-8449-3e7c4456d486
    type: regular
    task:
      id: 69eceed5-f4de-49ca-8449-3e7c4456d486
      version: -1
      name: prisma-cloud-alert-get-details
      description: Gets the details of an alert based on alert ID
      script: '|||prisma-cloud-alert-get-details'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      alert_id:
        simple: ${PrismaCloud.Alert.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: cb81a529-f610-4364-82ff-d796887b110c
    type: condition
    task:
      id: cb81a529-f610-4364-82ff-d796887b110c
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "13"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloud.Alert.status
            iscontext: true
          right:
            value:
              simple: dismissed
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloud.Alert.reason
            iscontext: true
          right:
            value:
              simple: USER_DISMISSED
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: 60e63476-c815-4c22-8e53-443b89a3f39e
    type: regular
    task:
      id: 60e63476-c815-4c22-8e53-443b89a3f39e
      version: -1
      name: prisma-cloud-alert-reopen
      description: Re-open the alerts matching the given filter. Either policy IDs
        or alert IDs must be provided. When no absolute time nor relative time arguments
        are provided, default time range is all times.
      script: '|||prisma-cloud-alert-reopen'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      alert_ids:
        simple: ${PrismaCloud.Alert.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: c24c5db8-2d7a-42d7-81a6-b449d24d442d
    type: regular
    task:
      id: c24c5db8-2d7a-42d7-81a6-b449d24d442d
      version: -1
      name: prisma-cloud-alert-get-details
      description: Gets the details of an alert based on alert ID
      script: '|||prisma-cloud-alert-get-details'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      alert_id:
        simple: ${PrismaCloud.Alert.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 2aac5663-5209-4f2f-855f-26b6f02e4d15
    type: condition
    task:
      id: 2aac5663-5209-4f2f-855f-26b6f02e4d15
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "38"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloud.Alert.status
            iscontext: true
          right:
            value:
              simple: open
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloud.Alert.reason
            iscontext: true
          right:
            value:
              simple: USER_REOPENED
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: eb479885-a2e6-4ac0-8ff1-3207f4c9b5dc
    type: regular
    task:
      id: eb479885-a2e6-4ac0-8ff1-3207f4c9b5dc
      version: -1
      name: prisma-cloud-config-search
      description: Search configuration inventory on the Prisma Cloud platform using
        RQL language. Use this command for all queries that start with "config". When
        no absolute time nor relative time arguments are provided, default time range
        is all times.
      script: '|||prisma-cloud-config-search'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "21"
    scriptarguments:
      limit:
        simple: "1"
      query:
        simple: config from cloud.resource where cloud.region = 'AWS Ohio' AND cloud.service
          = 'Amazon EC2'
      time_range_unit:
        simple: hour
      time_range_value:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: ed7b22ce-fe6f-42ed-8a8c-16538f51f6ea
    type: condition
    task:
      id: ed7b22ce-fe6f-42ed-8a8c-16538f51f6ea
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "22"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloud.Config.id
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloud.Config.regionName
            iscontext: true
          right:
            value:
              simple: AWS Ohio
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 60a9bf3a-413c-4933-8e06-a4b616acb501
    type: regular
    task:
      id: 60a9bf3a-413c-4933-8e06-a4b616acb501
      version: -1
      name: prisma-cloud-event-search
      description: Search events inventory on the Prisma Cloud platform using RQL
        language. Use this command for all queries that start with "event". When no
        absolute time nor relative time arguments are provided, default time range
        is all times.
      script: '|||prisma-cloud-event-search'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      limit:
        simple: "1"
      query:
        simple: event from cloud.audit_logs where cloud.type = 'aws' AND cloud.region
          = 'AWS Oregon'
      time_range_unit:
        simple: hour
      time_range_value:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: e4393825-4b9a-4322-8e90-4ff8dc6214a8
    type: condition
    task:
      id: e4393825-4b9a-4322-8e90-4ff8dc6214a8
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "36"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloud.Event.id
            iscontext: true
      - - operator: containsGeneral
          left:
            value:
              simple: PrismaCloud.Config.regionName
            iscontext: true
          right:
            value:
              simple: AWS
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: d25490db-4245-4bf6-8f9d-11c86f985f7a
    type: regular
    task:
      id: d25490db-4245-4bf6-8f9d-11c86f985f7a
      version: -1
      name: prisma-cloud-resource-get
      description: Get resource details.
      script: '|||prisma-cloud-resource-get'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      rrn:
        simple: ${PrismaCloud.Alert.resource.rrn}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: 427afb74-d0d9-4fbf-892f-a864cec38eea
    type: condition
    task:
      id: 427afb74-d0d9-4fbf-892f-a864cec38eea
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "41"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloud.Resource.rrn
            iscontext: true
          right:
            value:
              simple: PrismaCloud.Alert.resource.rrn
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: 43ac0551-7287-4607-8abb-cdef8472cbad
    type: regular
    task:
      id: 43ac0551-7287-4607-8abb-cdef8472cbad
      version: -1
      name: prisma-cloud-account-list
      description: List accounts.
      script: '|||prisma-cloud-account-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      limit:
        simple: "5"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: 483d23b7-9cab-4015-8d7b-6ef919742c5f
    type: condition
    task:
      id: 483d23b7-9cab-4015-8d7b-6ef919742c5f
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "30"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloud.Account.accountId
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: 68c54238-342b-4ec6-8ff6-613320f58d4c
    type: regular
    task:
      id: 68c54238-342b-4ec6-8ff6-613320f58d4c
      version: -1
      name: prisma-cloud-account-status-get
      description: Get accounts statuses.
      script: '|||prisma-cloud-account-status-get'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      account_ids:
        simple: ${PrismaCloud.Account.[0].accountId}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: 67e2ff92-fdfd-4c1a-8212-ccd1d03f3fc6
    type: condition
    task:
      id: 67e2ff92-fdfd-4c1a-8212-ccd1d03f3fc6
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "32"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloud.Account.accountId
            iscontext: true
          right:
            value:
              simple: PrismaCloud.Account.[0].accountId
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: 7c423564-30e1-4be3-8216-563d1bed5fe2
    type: regular
    task:
      id: 7c423564-30e1-4be3-8216-563d1bed5fe2
      version: -1
      name: prisma-cloud-account-owner-list
      description: Get accounts owners.
      script: '|||prisma-cloud-account-owner-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "33"
    scriptarguments:
      account_ids:
        simple: ${PrismaCloud.Account.[0].accountId}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: f57b4f5e-e0f4-4183-8677-435ad085c241
    type: condition
    task:
      id: f57b4f5e-e0f4-4183-8677-435ad085c241
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "4"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloud.Account.accountId
            iscontext: true
          right:
            value:
              simple: PrismaCloud.Account.[0].accountId
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: 267efa6e-d0a8-431c-871e-02d7b2ecc146
    type: regular
    task:
      id: 267efa6e-d0a8-431c-871e-02d7b2ecc146
      version: -1
      name: prisma-cloud-permission-list
      description: Get permission list. You must provide either "query" or "next_token".
      script: '|||prisma-cloud-permission-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "37"
    scriptarguments:
      limit:
        simple: "5"
      query:
        simple: config from iam where dest.cloud.region = 'AWS Virginia' AND dest.cloud.service.name
          = 'lambda' AND dest.cloud.resource.type = 'function'
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: bc066903-e5db-4147-8ebe-433ea03db5de
    type: condition
    task:
      id: bc066903-e5db-4147-8ebe-433ea03db5de
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "4"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloud.Permission.[0].destCloudServiceName
            iscontext: true
          right:
            value:
              simple: lambda
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloud.Permission.[0].destResourceType
            iscontext: true
          right:
            value:
              simple: function
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloud.Permission.[0].id
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: dcae8a89-39d6-4f4a-880d-acf612dfd2a1
    type: regular
    task:
      id: dcae8a89-39d6-4f4a-880d-acf612dfd2a1
      version: -1
      name: prisma-cloud-alert-dismiss
      description: Dismiss or snooze the alerts matching the given filter. Either
        policy IDs or alert IDs must be provided. When no absolute time nor relative
        time arguments are provided, default time range is all times. For snoozing,
        provide "snooze_unit" and "snooze_value" arguments.
      script: '|||prisma-cloud-alert-dismiss'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "39"
    scriptarguments:
      alert_ids:
        simple: ${PrismaCloud.Alert.id}
      dismissal_note:
        simple: Snoozing from XSOAR test playbook
      snooze_unit:
        simple: hour
      snooze_value:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: bda4f304-5ae6-4d9d-8e1b-df6bce8e469e
    type: regular
    task:
      id: bda4f304-5ae6-4d9d-8e1b-df6bce8e469e
      version: -1
      name: prisma-cloud-alert-get-details
      description: Gets the details of an alert based on alert ID
      script: '|||prisma-cloud-alert-get-details'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "40"
    scriptarguments:
      alert_id:
        simple: ${PrismaCloud.Alert.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: 2c0bb8d4-ef77-4756-8905-ed9c51118eef
    type: condition
    task:
      id: 2c0bb8d4-ef77-4756-8905-ed9c51118eef
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "47"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloud.Alert.status
            iscontext: true
          right:
            value:
              simple: snoozed
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloud.Alert.reason
            iscontext: true
          right:
            value:
              simple: USER_DISMISSED
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: e74f098c-f883-4e07-8962-ca6ff6f062e7
    type: regular
    task:
      id: e74f098c-f883-4e07-8962-ca6ff6f062e7
      version: -1
      name: prisma-cloud-resource-list
      description: Get resource lists.
      script: '|||prisma-cloud-resource-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "42"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: 1fbd01eb-b839-4b34-8971-61ae9b191c76
    type: condition
    task:
      id: 1fbd01eb-b839-4b34-8971-61ae9b191c76
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "43"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloud.ResourceList.id
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: 2b460427-cc47-4251-8e80-f197740c1208
    type: regular
    task:
      id: 2b460427-cc47-4251-8e80-f197740c1208
      version: -1
      name: prisma-cloud-user-roles-list
      description: Get user roles lists.
      script: '|||prisma-cloud-user-roles-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "44"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "44":
    id: "44"
    taskid: ac1aefa8-3508-4136-89f1-863c4b00f9b1
    type: condition
    task:
      id: ac1aefa8-3508-4136-89f1-863c4b00f9b1
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "46"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloud.UserRoles.id
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: 9bdc0b68-09a7-45cb-8ed1-a12e1e8805f4
    type: condition
    task:
      id: 9bdc0b68-09a7-45cb-8ed1-a12e1e8805f4
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "4"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloud.Users.username
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: 1e34c832-621a-468c-8134-801bdaf497dd
    type: regular
    task:
      id: 1e34c832-621a-468c-8134-801bdaf497dd
      version: -1
      name: prisma-cloud-users-list
      description: Get users lists.
      script: '|||prisma-cloud-users-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "45"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: 319df04f-4abb-40b8-823c-efd1698f2e84
    type: regular
    task:
      id: 319df04f-4abb-40b8-823c-efd1698f2e84
      version: -1
      name: Reopen snoozed alert (for next playbook run)
      description: Re-open the alerts matching the given filter. Either policy IDs
        or alert IDs must be provided. When no absolute time nor relative time arguments
        are provided, default time range is all times.
      script: '|||prisma-cloud-alert-reopen'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      alert_ids:
        simple: ${PrismaCloud.Alert.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: 2eba3ea0-55e5-4766-8ec0-f2a3a8dab3c3
    type: regular
    task:
      id: 2eba3ea0-55e5-4766-8ec0-f2a3a8dab3c3
      version: -1
      name: prisma-cloud-access-key-create
      description: Adds a new access key for the current user. If you have API access,
        you can create up to two access keys.
      script: '|||prisma-cloud-access-key-create'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#error#':
      - "49"
      '#none#':
      - "50"
    scriptarguments:
      name:
        simple: TestPlaybook_AccessKey
    separatecontext: false
    continueonerror: true
    continueonerrortype: errorPath
    view: |-
      {
        "position": {
          "x": -150,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: 326bdd8b-49e0-4a1c-8cad-c6f509252a63
    type: regular
    task:
      id: 326bdd8b-49e0-4a1c-8cad-c6f509252a63
      version: -1
      name: prisma-cloud-access-keys-list
      description: Returns all access keys for your tenant if you have a Prisma Cloud
        System Admin role. Returns just your access keys if you don't have this role.
      script: '|||prisma-cloud-access-keys-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "58"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -700,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: 99a33240-fe05-4b1d-868d-6e4f7650836a
    type: regular
    task:
      id: 99a33240-fe05-4b1d-868d-6e4f7650836a
      version: -1
      name: prisma-cloud-access-keys-list Verify Access key by ID
      description: Returns all access keys for your tenant if you have a Prisma Cloud
        System Admin role. Returns just your access keys if you don't have this role.
      script: '|||prisma-cloud-access-keys-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "55"
    scriptarguments:
      access-key:
        simple: ${PrismaCloud.AccessKeys.[0].id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -150,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: 1f730f9e-9049-4a6d-8590-d7c9597e3a9e
    type: regular
    task:
      id: 1f730f9e-9049-4a6d-8590-d7c9597e3a9e
      version: -1
      name: prisma-cloud-access-key-delete
      description: Deletes the access key that has the specified ID.
      script: '|||prisma-cloud-access-key-delete'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "57"
    scriptarguments:
      access-key:
        simple: ${PrismaCloud.AccessKeys.[0].id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -150,
          "y": 1080
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "55":
    id: "55"
    taskid: e0b1360f-989d-481a-86b7-17c3e04b5737
    type: regular
    task:
      id: e0b1360f-989d-481a-86b7-17c3e04b5737
      version: -1
      name: prisma-cloud-access-key-disable
      description: Deactivates the access key that has the specified ID.
      script: '|||prisma-cloud-access-key-disable'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "56"
    scriptarguments:
      access-key:
        simple: ${PrismaCloud.AccessKeys.[0].id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -150,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "56":
    id: "56"
    taskid: 1a9597b5-4686-484d-8e6f-4cab649f9cff
    type: regular
    task:
      id: 1a9597b5-4686-484d-8e6f-4cab649f9cff
      version: -1
      name: prisma-cloud-access-key-enable
      description: Activates the access key that has the specified ID. You cannot
        activate an expired access key.
      script: '|||prisma-cloud-access-key-enable'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "53"
    scriptarguments:
      access-key:
        simple: ${PrismaCloud.AccessKeys.[0].id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -150,
          "y": 905
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "57":
    id: "57"
    taskid: e3a8b04c-89f9-4809-8299-319d323318f6
    type: regular
    task:
      id: e3a8b04c-89f9-4809-8299-319d323318f6
      version: -1
      name: prisma-cloud-access-keys-list
      description: Returns all access keys for your tenant if you have a Prisma Cloud
        System Admin role. Returns just your access keys if you don't have this role.
      script: '|||prisma-cloud-access-keys-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "58"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -150,
          "y": 1260
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "58":
    id: "58"
    taskid: 56fa219e-d67a-4ed2-8780-6008d2df3f80
    type: title
    task:
      id: 56fa219e-d67a-4ed2-8780-6008d2df3f80
      version: -1
      name: Access Key Flow Finished Successfully
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "4"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -460,
          "y": 1450
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "48_49_#error#": 0.57
    },
    "paper": {
      "dimensions": {
        "height": 2865,
        "width": 2850,
        "x": -700,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
