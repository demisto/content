id: Prisma Cloud V2 Test
version: -1
name: Prisma Cloud V2 Test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: b5903b5a-bfb4-442c-8288-49485239bc85
    type: start
    task:
      id: b5903b5a-bfb4-442c-8288-49485239bc85
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: d8cca8fd-83d0-40a6-8c9d-359dd9f64367
    type: regular
    task:
      id: d8cca8fd-83d0-40a6-8c9d-359dd9f64367
      version: -1
      name: Delete Context
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
      - "5"
      - "20"
      - "28"
      - "48"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: 1bc10a48-3cde-4134-8feb-64f266d770f5
    type: regular
    task:
      id: 1bc10a48-3cde-4134-8feb-64f266d770f5
      version: -1
      name: prisma-cloud-alert-filter-list
      description: List the acceptable filters and values for alerts
      script: '|||prisma-cloud-alert-filter-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: bca538a6-93f8-4b55-8ef7-6d992d8b0c49
    type: condition
    task:
      id: bca538a6-93f8-4b55-8ef7-6d992d8b0c49
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "4"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloud.AlertFilters.filterName
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 76a834d7-f61d-495b-84ae-05b8afa4b4fc
    type: title
    task:
      id: 76a834d7-f61d-495b-84ae-05b8afa4b4fc
      version: -1
      name: Test Finished Successfully
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 2820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 525fffbd-5285-474d-800a-a6dddbe084fa
    type: regular
    task:
      id: 525fffbd-5285-474d-800a-a6dddbe084fa
      version: -1
      name: prisma-cloud-alert-search
      description: Search alerts on the Prisma Cloud platform. When no absolute time nor relative time arguments are provided, the search will show alerts from the last 7 days.
      script: '|||prisma-cloud-alert-search'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      filters:
        simple: alert.status=open,policy.remediable=true
      limit:
        simple: "1"
      time_range_unit:
        simple: hour
      time_range_value:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: c0658350-eab6-4817-8cb7-4d673ff7a996
    type: condition
    task:
      id: c0658350-eab6-4817-8cb7-4d673ff7a996
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "7"
      - "26"
      - "59"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloud.Alert.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloud.Alert.policy.policyId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloud.Alert.resource.rrn
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: 253028ef-150b-4fdb-886d-73e0ec14cee5
    type: regular
    task:
      id: 253028ef-150b-4fdb-886d-73e0ec14cee5
      version: -1
      name: prisma-cloud-alert-get-details
      description: Gets the details of an alert based on alert ID
      script: '|||prisma-cloud-alert-get-details'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      alert_id:
        simple: ${PrismaCloud.Alert.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 2389a8de-d9e9-4bfa-83a9-a46319577454
    type: condition
    task:
      id: 2389a8de-d9e9-4bfa-83a9-a46319577454
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "9"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloud.Alert.id
            iscontext: true
          right:
            value:
              simple: PrismaCloud.Alert.id
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: 1279ce5e-5c2b-4ef4-8ecf-c451c160e83e
    type: regular
    task:
      id: 1279ce5e-5c2b-4ef4-8ecf-c451c160e83e
      version: -1
      name: prisma-cloud-alert-dismiss
      description: Dismiss or snooze the alerts matching the given filter. Either policy IDs or alert IDs must be provided. When no absolute time nor relative time arguments are provided, default time range is all times. For snoozing, provide "snooze_unit" and "snooze_value" arguments.
      script: '|||prisma-cloud-alert-dismiss'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      alert_ids:
        simple: ${PrismaCloud.Alert.id}
      dismissal_note:
        simple: Dismissing from XSOAR test playbook
      time_range_unit:
        simple: month
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: ac2f2a8d-e8c8-48ea-8cb3-ee6c650fe772
    type: regular
    task:
      id: ac2f2a8d-e8c8-48ea-8cb3-ee6c650fe772
      version: -1
      name: prisma-cloud-alert-get-details
      description: Gets the details of an alert based on alert ID
      script: '|||prisma-cloud-alert-get-details'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      alert_id:
        simple: ${PrismaCloud.Alert.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: 30dc8165-1714-4a7b-8947-62b89ea27ae9
    type: condition
    task:
      id: 30dc8165-1714-4a7b-8947-62b89ea27ae9
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "13"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloud.Alert.status
            iscontext: true
          right:
            value:
              simple: dismissed
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloud.Alert.reason
            iscontext: true
          right:
            value:
              simple: USER_DISMISSED
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: 285c7d46-70ff-4df2-8a53-87daea7618dc
    type: regular
    task:
      id: 285c7d46-70ff-4df2-8a53-87daea7618dc
      version: -1
      name: prisma-cloud-alert-reopen
      description: Re-open the alerts matching the given filter. Either policy IDs or alert IDs must be provided. When no absolute time nor relative time arguments are provided, default time range is all times.
      script: '|||prisma-cloud-alert-reopen'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      alert_ids:
        simple: ${PrismaCloud.Alert.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 2a78eafb-668e-4122-8451-46899916aa94
    type: regular
    task:
      id: 2a78eafb-668e-4122-8451-46899916aa94
      version: -1
      name: prisma-cloud-alert-get-details
      description: Gets the details of an alert based on alert ID
      script: '|||prisma-cloud-alert-get-details'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      alert_id:
        simple: ${PrismaCloud.Alert.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 6eea2e3b-a003-4b26-8111-62d9de3c0720
    type: condition
    task:
      id: 6eea2e3b-a003-4b26-8111-62d9de3c0720
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "38"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloud.Alert.status
            iscontext: true
          right:
            value:
              simple: open
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloud.Alert.reason
            iscontext: true
          right:
            value:
              simple: USER_REOPENED
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 1f0113ab-df8e-4ac0-8745-97b9da927275
    type: regular
    task:
      id: 1f0113ab-df8e-4ac0-8745-97b9da927275
      version: -1
      name: prisma-cloud-config-search
      description: Search configuration inventory on the Prisma Cloud platform using RQL language. Use this command for all queries that start with "config". When no absolute time nor relative time arguments are provided, default time range is all times.
      script: '|||prisma-cloud-config-search'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "21"
    scriptarguments:
      limit:
        simple: "1"
      query:
        simple: 'config from cloud.resource where cloud.region = ''AWS Ohio'' AND cloud.service = ''Amazon EC2'''
      time_range_unit:
        simple: hour
      time_range_value:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: 082caf2d-82cb-4ecd-83d0-fc7b277f682e
    type: condition
    task:
      id: 082caf2d-82cb-4ecd-83d0-fc7b277f682e
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "22"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloud.Config.id
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloud.Config.regionName
            iscontext: true
          right:
            value:
              simple: AWS Ohio
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 3b874bc2-33c2-452e-8cb8-302ddfa27263
    type: regular
    task:
      id: 3b874bc2-33c2-452e-8cb8-302ddfa27263
      version: -1
      name: prisma-cloud-event-search
      description: Search events inventory on the Prisma Cloud platform using RQL language. Use this command for all queries that start with "event". When no absolute time nor relative time arguments are provided, default time range is all times.
      script: '|||prisma-cloud-event-search'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      limit:
        simple: "1"
      query:
        simple: event from cloud.audit_logs where cloud.type = 'aws' AND cloud.region = 'AWS Oregon'
      time_range_unit:
        simple: hour
      time_range_value:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: 4eca94f5-5e7d-489d-889f-970afabb772d
    type: condition
    task:
      id: 4eca94f5-5e7d-489d-889f-970afabb772d
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "36"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloud.Event.id
            iscontext: true
      - - operator: containsGeneral
          left:
            value:
              simple: PrismaCloud.Config.regionName
            iscontext: true
          right:
            value:
              simple: AWS
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: 6c37c452-f690-4148-8191-fd1c1d7e2c7c
    type: regular
    task:
      id: 6c37c452-f690-4148-8191-fd1c1d7e2c7c
      version: -1
      name: prisma-cloud-resource-get
      description: Get resource details.
      script: '|||prisma-cloud-resource-get'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      rrn:
        simple: ${PrismaCloud.Alert.resource.rrn}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: 7404c9bb-180c-40a5-8b4e-3e43134ade49
    type: condition
    task:
      id: 7404c9bb-180c-40a5-8b4e-3e43134ade49
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "41"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloud.Resource.rrn
            iscontext: true
          right:
            value:
              simple: PrismaCloud.Alert.resource.rrn
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: 527020b1-140a-403d-80ea-43ece4997bbc
    type: regular
    task:
      id: 527020b1-140a-403d-80ea-43ece4997bbc
      version: -1
      name: prisma-cloud-account-list
      description: List accounts.
      script: '|||prisma-cloud-account-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      limit:
        simple: "5"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2200,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: 13f5acb3-8ee2-4557-8922-33bb6355a3bd
    type: condition
    task:
      id: 13f5acb3-8ee2-4557-8922-33bb6355a3bd
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "30"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloud.Account.accountId
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2200,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: 4f291b1a-f9ac-4d27-8895-b6eb872051f5
    type: regular
    task:
      id: 4f291b1a-f9ac-4d27-8895-b6eb872051f5
      version: -1
      name: prisma-cloud-account-status-get
      description: Get accounts statuses.
      script: '|||prisma-cloud-account-status-get'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      account_ids:
        simple: ${PrismaCloud.Account.[0].accountId}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2200,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: e55d7a69-bad6-43b7-8125-9fdf73fd2630
    type: condition
    task:
      id: e55d7a69-bad6-43b7-8125-9fdf73fd2630
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "32"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloud.Account.accountId
            iscontext: true
          right:
            value:
              simple: PrismaCloud.Account.[0].accountId
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2200,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: 56ce68e5-9080-4705-8444-b20849d4cbcd
    type: regular
    task:
      id: 56ce68e5-9080-4705-8444-b20849d4cbcd
      version: -1
      name: prisma-cloud-account-owner-list
      description: Get accounts owners.
      script: '|||prisma-cloud-account-owner-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "33"
    scriptarguments:
      account_ids:
        simple: ${PrismaCloud.Account.[0].accountId}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2200,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: a6e43f53-5518-4456-8a83-2b2b7f1ec0a0
    type: condition
    task:
      id: a6e43f53-5518-4456-8a83-2b2b7f1ec0a0
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "4"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloud.Account.accountId
            iscontext: true
          right:
            value:
              simple: PrismaCloud.Account.[0].accountId
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2200,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: 0a7e3bf2-004e-413f-8d2a-56ff7db0664b
    type: regular
    task:
      id: 0a7e3bf2-004e-413f-8d2a-56ff7db0664b
      version: -1
      name: prisma-cloud-permission-list
      description: Get permission list. You must provide either "query" or "next_token".
      script: '|||prisma-cloud-permission-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "37"
    scriptarguments:
      limit:
        simple: "5"
      query:
        simple: config from iam where dest.cloud.region = 'AWS Virginia' AND dest.cloud.service.name = 'lambda' AND dest.cloud.resource.type = 'function'
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: e7efe4df-c82c-4a6f-8556-e91737b12304
    type: condition
    task:
      id: e7efe4df-c82c-4a6f-8556-e91737b12304
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "4"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloud.Permission.[0].destCloudServiceName
            iscontext: true
          right:
            value:
              simple: lambda
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloud.Permission.[0].destResourceType
            iscontext: true
          right:
            value:
              simple: function
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloud.Permission.[0].id
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: d09d9abf-60d1-4372-8cbd-c6e726345afe
    type: regular
    task:
      id: d09d9abf-60d1-4372-8cbd-c6e726345afe
      version: -1
      name: prisma-cloud-alert-dismiss
      description: Dismiss or snooze the alerts matching the given filter. Either policy IDs or alert IDs must be provided. When no absolute time nor relative time arguments are provided, default time range is all times. For snoozing, provide "snooze_unit" and "snooze_value" arguments.
      script: '|||prisma-cloud-alert-dismiss'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "39"
    scriptarguments:
      alert_ids:
        simple: ${PrismaCloud.Alert.id}
      dismissal_note:
        simple: Snoozing from XSOAR test playbook
      snooze_unit:
        simple: hour
      snooze_value:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: 2813ae53-a514-4b4d-8b5e-2028fadbc5a3
    type: regular
    task:
      id: 2813ae53-a514-4b4d-8b5e-2028fadbc5a3
      version: -1
      name: prisma-cloud-alert-get-details
      description: Gets the details of an alert based on alert ID
      script: '|||prisma-cloud-alert-get-details'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "40"
    scriptarguments:
      alert_id:
        simple: ${PrismaCloud.Alert.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: 7d79b2d7-b37f-4c5a-8b9d-be7bb1dc6535
    type: condition
    task:
      id: 7d79b2d7-b37f-4c5a-8b9d-be7bb1dc6535
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "47"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloud.Alert.status
            iscontext: true
          right:
            value:
              simple: snoozed
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloud.Alert.reason
            iscontext: true
          right:
            value:
              simple: USER_DISMISSED
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: 0600d2aa-ee2d-4337-8ab2-c1a2cb51ae67
    type: regular
    task:
      id: 0600d2aa-ee2d-4337-8ab2-c1a2cb51ae67
      version: -1
      name: prisma-cloud-resource-list
      description: Get resource lists.
      script: '|||prisma-cloud-resource-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "42"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: 678c29e8-8f42-49d2-89f9-c020084992fc
    type: condition
    task:
      id: 678c29e8-8f42-49d2-89f9-c020084992fc
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "43"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloud.ResourceList.id
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: a85fb070-a8ef-4f3f-85c4-9c8f1837ae5c
    type: regular
    task:
      id: a85fb070-a8ef-4f3f-85c4-9c8f1837ae5c
      version: -1
      name: prisma-cloud-user-roles-list
      description: Get user roles lists.
      script: '|||prisma-cloud-user-roles-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "44"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "44":
    id: "44"
    taskid: a54e98db-40b1-4067-8c59-c765d7b152c0
    type: condition
    task:
      id: a54e98db-40b1-4067-8c59-c765d7b152c0
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "46"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloud.UserRoles.id
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: 2a84a32f-ffd9-4480-88aa-7eb436acfa8a
    type: condition
    task:
      id: 2a84a32f-ffd9-4480-88aa-7eb436acfa8a
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "4"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloud.Users.username
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: 382e5ef0-a75a-414f-8562-fcd6b6fe395e
    type: regular
    task:
      id: 382e5ef0-a75a-414f-8562-fcd6b6fe395e
      version: -1
      name: prisma-cloud-users-list
      description: Get users lists.
      script: '|||prisma-cloud-users-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "45"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: ba50b018-32b6-4ed3-84e8-bee11d5c73fc
    type: regular
    task:
      id: ba50b018-32b6-4ed3-84e8-bee11d5c73fc
      version: -1
      name: Reopen snoozed alert (for next playbook run)
      description: Re-open the alerts matching the given filter. Either policy IDs or alert IDs must be provided. When no absolute time nor relative time arguments are provided, default time range is all times.
      script: '|||prisma-cloud-alert-reopen'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      alert_ids:
        simple: ${PrismaCloud.Alert.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: e6530f96-b7dd-4c8e-8188-eaf97afe96da
    type: regular
    task:
      id: e6530f96-b7dd-4c8e-8188-eaf97afe96da
      version: -1
      name: prisma-cloud-access-key-create
      description: Adds a new access key for the current user. If you have API access, you can create up to two access keys.
      script: '|||prisma-cloud-access-key-create'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#error#':
      - "49"
      '#none#':
      - "50"
    scriptarguments:
      name:
        simple: TestPlaybook_AccessKey
    separatecontext: false
    continueonerror: true
    continueonerrortype: errorPath
    view: |-
      {
        "position": {
          "x": 2845,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: e9572ec4-9557-4f56-8bb2-20e876dbc60b
    type: regular
    task:
      id: e9572ec4-9557-4f56-8bb2-20e876dbc60b
      version: -1
      name: prisma-cloud-access-keys-list
      description: Returns all access keys for your tenant if you have a Prisma Cloud System Admin role. Returns just your access keys if you don't have this role.
      script: '|||prisma-cloud-access-keys-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "58"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2630,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: 3ff6480e-6727-4210-829d-f0fb3cab9a55
    type: regular
    task:
      id: 3ff6480e-6727-4210-829d-f0fb3cab9a55
      version: -1
      name: prisma-cloud-access-keys-list Verify Access key by ID
      description: Returns all access keys for your tenant if you have a Prisma Cloud System Admin role. Returns just your access keys if you don't have this role.
      script: '|||prisma-cloud-access-keys-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "55"
    scriptarguments:
      access-key:
        simple: ${PrismaCloud.AccessKeys.[0].id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3060,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: e8b26ea7-4999-4663-8f2d-e63ace318439
    type: regular
    task:
      id: e8b26ea7-4999-4663-8f2d-e63ace318439
      version: -1
      name: prisma-cloud-access-key-delete
      description: Deletes the access key that has the specified ID.
      script: '|||prisma-cloud-access-key-delete'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "57"
    scriptarguments:
      access-key:
        simple: ${PrismaCloud.AccessKeys.[0].id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3060,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "55":
    id: "55"
    taskid: cc4a4bd4-79a4-44b4-85f0-bcf379b718f8
    type: regular
    task:
      id: cc4a4bd4-79a4-44b4-85f0-bcf379b718f8
      version: -1
      name: prisma-cloud-access-key-disable
      description: Deactivates the access key that has the specified ID.
      script: '|||prisma-cloud-access-key-disable'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "56"
    scriptarguments:
      access-key:
        simple: ${PrismaCloud.AccessKeys.[0].id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3060,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "56":
    id: "56"
    taskid: 2ca861d0-f3ae-4be7-8604-150a0ac3e127
    type: regular
    task:
      id: 2ca861d0-f3ae-4be7-8604-150a0ac3e127
      version: -1
      name: prisma-cloud-access-key-enable
      description: Activates the access key that has the specified ID. You cannot activate an expired access key.
      script: '|||prisma-cloud-access-key-enable'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "53"
    scriptarguments:
      access-key:
        simple: ${PrismaCloud.AccessKeys.[0].id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3060,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "57":
    id: "57"
    taskid: 5db2f2d7-d2fb-4d6e-8936-afa5c7063538
    type: regular
    task:
      id: 5db2f2d7-d2fb-4d6e-8936-afa5c7063538
      version: -1
      name: prisma-cloud-access-keys-list
      description: Returns all access keys for your tenant if you have a Prisma Cloud System Admin role. Returns just your access keys if you don't have this role.
      script: '|||prisma-cloud-access-keys-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "58"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3060,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "58":
    id: "58"
    taskid: ebb2cf5b-c606-487c-828b-a84e4c31239e
    type: title
    task:
      id: ebb2cf5b-c606-487c-828b-a84e4c31239e
      version: -1
      name: Access Key Flow Finished Successfully
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "4"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2845,
          "y": 2660
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "59":
    id: "59"
    taskid: 27f39bc8-b659-4d01-8d87-9c3b81fcf496
    type: regular
    task:
      id: 27f39bc8-b659-4d01-8d87-9c3b81fcf496
      version: -1
      name: prisma-cloud-asset-get
      description: Returns detailed information for the asset with the given id.
      script: '|||prisma-cloud-asset-get'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "60"
    scriptarguments:
      asset_id:
        simple: ${PrismaCloud.Alert.resource.rrn}
      limit:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: 63b13794-2770-4584-8aaf-fdd37db2a1c6
    type: condition
    task:
      id: 63b13794-2770-4584-8aaf-fdd37db2a1c6
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "4"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloud.Asset.id
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "48_49_#error#": 0.57
    },
    "paper": {
      "dimensions": {
        "height": 2835,
        "width": 3390,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
fromversion: 6.5.0
description: Test for Prisma Cloud V2.
