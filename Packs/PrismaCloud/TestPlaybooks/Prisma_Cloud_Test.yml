id: Prisma Cloud V2 Test
version: -1
name: Prisma Cloud V2 Test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 79f3555b-090a-4921-842a-c2e903dbb1fb
    type: start
    task:
      id: 79f3555b-090a-4921-842a-c2e903dbb1fb
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: b4b3d675-d82c-4bbe-8343-b3c24df5288e
    type: regular
    task:
      id: b4b3d675-d82c-4bbe-8343-b3c24df5288e
      version: -1
      name: Delete Context
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
      - "5"
      - "20"
      - "28"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: 83495fc7-7d1c-4425-8cd2-4f4c8fc87ac2
    type: regular
    task:
      id: 83495fc7-7d1c-4425-8cd2-4f4c8fc87ac2
      version: -1
      name: prisma-cloud-alert-filter-list
      description: List the acceptable filters and values for alerts
      script: '|||prisma-cloud-alert-filter-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 1ae61b6e-eab3-4b26-8737-8596ec740a01
    type: condition
    task:
      id: 1ae61b6e-eab3-4b26-8737-8596ec740a01
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "4"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloud.AlertFilters.filterName
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 4dbdd14b-aee9-4589-8ced-c6552ed7afce
    type: title
    task:
      id: 4dbdd14b-aee9-4589-8ced-c6552ed7afce
      version: -1
      name: Test Finished Successfully
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 19b7cd8c-b33a-4a00-846f-b140b6c67771
    type: regular
    task:
      id: 19b7cd8c-b33a-4a00-846f-b140b6c67771
      version: -1
      name: prisma-cloud-alert-search
      description: Search alerts on the Prisma Cloud platform. When no absolute time nor relative time arguments are provided, the search will show alerts from the last 7 days.
      script: '|||prisma-cloud-alert-search'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      filters:
        simple: alert.status=open,policy.remediable=true
      limit:
        simple: "1"
      time_range_unit:
        simple: hour
      time_range_value:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1555,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: f0de7417-cbe2-4ea2-8983-7a0d6ad9b8fb
    type: condition
    task:
      id: f0de7417-cbe2-4ea2-8983-7a0d6ad9b8fb
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "7"
      - "26"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloud.Alert.id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloud.Alert.policy.policyId
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloud.Alert.resource.rrn
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1555,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: 575e1f52-f1a4-4fe9-876b-b34f21ba11de
    type: regular
    task:
      id: 575e1f52-f1a4-4fe9-876b-b34f21ba11de
      version: -1
      name: prisma-cloud-alert-get-details
      description: Gets the details of an alert based on alert ID
      script: '|||prisma-cloud-alert-get-details'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      alert_id:
        simple: ${PrismaCloud.Alert.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 36c74e11-7262-4b5c-8ed0-24db4c68abd0
    type: condition
    task:
      id: 36c74e11-7262-4b5c-8ed0-24db4c68abd0
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "9"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloud.Alert.id
            iscontext: true
          right:
            value:
              simple: PrismaCloud.Alert.id
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: 94471ca1-33a3-4d35-88e1-9cc5ae07a2a8
    type: regular
    task:
      id: 94471ca1-33a3-4d35-88e1-9cc5ae07a2a8
      version: -1
      name: prisma-cloud-alert-dismiss
      description: Dismiss or snooze the alerts matching the given filter. Either policy IDs or alert IDs must be provided. When no absolute time nor relative time arguments are provided, default time range is all times. For snoozing, provide "snooze_unit" and "snooze_value" arguments.
      script: '|||prisma-cloud-alert-dismiss'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      alert_ids:
        simple: ${PrismaCloud.Alert.id}
      dismissal_note:
        simple: Dismissing from XSOAR test playbook
      time_range_unit:
        simple: month
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 1dc42406-d1a7-4732-8406-d48da87e426e
    type: regular
    task:
      id: 1dc42406-d1a7-4732-8406-d48da87e426e
      version: -1
      name: prisma-cloud-alert-get-details
      description: Gets the details of an alert based on alert ID
      script: '|||prisma-cloud-alert-get-details'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      alert_id:
        simple: ${PrismaCloud.Alert.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: 352573c8-1860-4b2d-871a-91c63e7bb5b8
    type: condition
    task:
      id: 352573c8-1860-4b2d-871a-91c63e7bb5b8
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "13"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloud.Alert.status
            iscontext: true
          right:
            value:
              simple: dismissed
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloud.Alert.reason
            iscontext: true
          right:
            value:
              simple: USER_DISMISSED
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: f6502e8e-bd02-4f5d-8382-c7666801ebb9
    type: regular
    task:
      id: f6502e8e-bd02-4f5d-8382-c7666801ebb9
      version: -1
      name: prisma-cloud-alert-reopen
      description: Re-open the alerts matching the given filter. Either policy IDs or alert IDs must be provided. When no absolute time nor relative time arguments are provided, default time range is all times.
      script: '|||prisma-cloud-alert-reopen'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      alert_ids:
        simple: ${PrismaCloud.Alert.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 42059885-6d3d-4146-8156-7702d8dc2995
    type: regular
    task:
      id: 42059885-6d3d-4146-8156-7702d8dc2995
      version: -1
      name: prisma-cloud-alert-get-details
      description: Gets the details of an alert based on alert ID
      script: '|||prisma-cloud-alert-get-details'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      alert_id:
        simple: ${PrismaCloud.Alert.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 9aaba689-ba32-4ed8-814d-a072822a690f
    type: condition
    task:
      id: 9aaba689-ba32-4ed8-814d-a072822a690f
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "38"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloud.Alert.status
            iscontext: true
          right:
            value:
              simple: open
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloud.Alert.reason
            iscontext: true
          right:
            value:
              simple: USER_REOPENED
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 9956b851-559a-43cd-8140-917bd55a5d4c
    type: regular
    task:
      id: 9956b851-559a-43cd-8140-917bd55a5d4c
      version: -1
      name: prisma-cloud-config-search
      description: Search configuration inventory on the Prisma Cloud platform using RQL language. Use this command for all queries that start with "config". When no absolute time nor relative time arguments are provided, default time range is all times.
      script: '|||prisma-cloud-config-search'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "21"
    scriptarguments:
      limit:
        simple: "1"
      query:
        simple: 'config from cloud.resource where cloud.region = ''AWS Ohio'' AND cloud.service = ''Amazon EC2'''
      time_range_unit:
        simple: hour
      time_range_value:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: 3ffc707e-a310-401c-80f5-4ade9b2f3adc
    type: condition
    task:
      id: 3ffc707e-a310-401c-80f5-4ade9b2f3adc
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "22"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloud.Config.id
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloud.Config.regionName
            iscontext: true
          right:
            value:
              simple: AWS Ohio
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 3d5d32c3-40e4-483c-822e-a98b4ce24a03
    type: regular
    task:
      id: 3d5d32c3-40e4-483c-822e-a98b4ce24a03
      version: -1
      name: prisma-cloud-event-search
      description: Search events inventory on the Prisma Cloud platform using RQL language. Use this command for all queries that start with "event". When no absolute time nor relative time arguments are provided, default time range is all times.
      script: '|||prisma-cloud-event-search'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      limit:
        simple: "1"
      query:
        simple: event from cloud.audit_logs where cloud.type = 'aws' AND cloud.region = 'AWS Oregon'
      time_range_unit:
        simple: hour
      time_range_value:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: ae3c7441-e40d-4a01-8162-f6bf7a8527c3
    type: condition
    task:
      id: ae3c7441-e40d-4a01-8162-f6bf7a8527c3
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "36"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloud.Event.id
            iscontext: true
      - - operator: containsGeneral
          left:
            value:
              simple: PrismaCloud.Config.regionName
            iscontext: true
          right:
            value:
              simple: AWS
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: 58c9f25e-bbd4-4779-89e5-b51493bdc10b
    type: regular
    task:
      id: 58c9f25e-bbd4-4779-89e5-b51493bdc10b
      version: -1
      name: prisma-cloud-resource-get
      description: Get resource details.
      script: '|||prisma-cloud-resource-get'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      rrn:
        simple: ${PrismaCloud.Alert.resource.rrn}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: 0f9da6a1-f5ba-4e06-891c-4ab65743ff9f
    type: condition
    task:
      id: 0f9da6a1-f5ba-4e06-891c-4ab65743ff9f
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "41"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloud.Resource.rrn
            iscontext: true
          right:
            value:
              simple: PrismaCloud.Alert.resource.rrn
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: 4a36bd3a-e6a0-4444-8b46-eb8884704a2b
    type: regular
    task:
      id: 4a36bd3a-e6a0-4444-8b46-eb8884704a2b
      version: -1
      name: prisma-cloud-account-list
      description: List accounts.
      script: '|||prisma-cloud-account-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      limit:
        simple: "5"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: 71ae85e9-cb4c-4aca-8466-46aa21d776e2
    type: condition
    task:
      id: 71ae85e9-cb4c-4aca-8466-46aa21d776e2
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "30"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloud.Account.accountId
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: 0baca1c0-c349-44c5-89b4-4a37630639bb
    type: regular
    task:
      id: 0baca1c0-c349-44c5-89b4-4a37630639bb
      version: -1
      name: prisma-cloud-account-status-get
      description: Get accounts statuses.
      script: '|||prisma-cloud-account-status-get'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      account_ids:
        simple: ${PrismaCloud.Account.[0].accountId}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: cb47c81e-559a-44fb-8f07-b57b84368cda
    type: condition
    task:
      id: cb47c81e-559a-44fb-8f07-b57b84368cda
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "32"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloud.Account.accountId
            iscontext: true
          right:
            value:
              simple: PrismaCloud.Account.[0].accountId
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: 94f2a736-0e0e-441e-8bc5-207b3845f11f
    type: regular
    task:
      id: 94f2a736-0e0e-441e-8bc5-207b3845f11f
      version: -1
      name: prisma-cloud-account-owner-list
      description: Get accounts owners.
      script: '|||prisma-cloud-account-owner-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "33"
    scriptarguments:
      account_ids:
        simple: ${PrismaCloud.Account.[0].accountId}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: 938b3fdc-2c77-4ec9-851e-3b12e521cb7b
    type: condition
    task:
      id: 938b3fdc-2c77-4ec9-851e-3b12e521cb7b
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "4"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloud.Account.accountId
            iscontext: true
          right:
            value:
              simple: PrismaCloud.Account.[0].accountId
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: bcc9abff-5a39-4aab-8b81-fe7b746c90e2
    type: regular
    task:
      id: bcc9abff-5a39-4aab-8b81-fe7b746c90e2
      version: -1
      name: prisma-cloud-permission-list
      description: Get permission list. You must provide either "query" or "next_token".
      script: '|||prisma-cloud-permission-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "37"
    scriptarguments:
      limit:
        simple: "5"
      query:
        simple: config from iam where dest.cloud.region = 'AWS Virginia' AND dest.cloud.service.name = 'lambda' AND dest.cloud.resource.type = 'function'
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: 5c79af5a-0e8b-4cc1-8eeb-79ba187d2dcf
    type: condition
    task:
      id: 5c79af5a-0e8b-4cc1-8eeb-79ba187d2dcf
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "4"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloud.Permission.[0].destCloudServiceName
            iscontext: true
          right:
            value:
              simple: lambda
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloud.Permission.[0].destResourceType
            iscontext: true
          right:
            value:
              simple: function
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloud.Permission.[0].id
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: 0a2dbc5b-5458-4843-8f91-a0bf31507c1e
    type: regular
    task:
      id: 0a2dbc5b-5458-4843-8f91-a0bf31507c1e
      version: -1
      name: prisma-cloud-alert-dismiss
      description: Dismiss or snooze the alerts matching the given filter. Either policy IDs or alert IDs must be provided. When no absolute time nor relative time arguments are provided, default time range is all times. For snoozing, provide "snooze_unit" and "snooze_value" arguments.
      script: '|||prisma-cloud-alert-dismiss'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "39"
    scriptarguments:
      alert_ids:
        simple: ${PrismaCloud.Alert.id}
      dismissal_note:
        simple: Snoozing from XSOAR test playbook
      snooze_unit:
        simple: hour
      snooze_value:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: afcceb51-0567-450c-8de2-c64c0c835e6b
    type: regular
    task:
      id: afcceb51-0567-450c-8de2-c64c0c835e6b
      version: -1
      name: prisma-cloud-alert-get-details
      description: Gets the details of an alert based on alert ID
      script: '|||prisma-cloud-alert-get-details'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "40"
    scriptarguments:
      alert_id:
        simple: ${PrismaCloud.Alert.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: 00a7cd59-b0fe-4a6b-8088-57685eb946e4
    type: condition
    task:
      id: 00a7cd59-b0fe-4a6b-8088-57685eb946e4
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "47"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloud.Alert.status
            iscontext: true
          right:
            value:
              simple: snoozed
      - - operator: isEqualString
          left:
            value:
              simple: PrismaCloud.Alert.reason
            iscontext: true
          right:
            value:
              simple: USER_DISMISSED
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: eaca5dce-b2ad-41cc-817d-679e8ff8867f
    type: regular
    task:
      id: eaca5dce-b2ad-41cc-817d-679e8ff8867f
      version: -1
      name: prisma-cloud-resource-list
      description: Get resource lists.
      script: '|||prisma-cloud-resource-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "42"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: cec79ad0-8dc8-4d7c-8caa-efa6bd812468
    type: condition
    task:
      id: cec79ad0-8dc8-4d7c-8caa-efa6bd812468
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "43"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloud.ResourceList.id
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: b76daca0-7d5e-4626-8220-7248b035d428
    type: regular
    task:
      id: b76daca0-7d5e-4626-8220-7248b035d428
      version: -1
      name: prisma-cloud-user-roles-list
      description: Get user roles lists.
      script: '|||prisma-cloud-user-roles-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "44"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "44":
    id: "44"
    taskid: 19e9f72b-9707-401c-8b5c-c0ec83fb38bd
    type: condition
    task:
      id: 19e9f72b-9707-401c-8b5c-c0ec83fb38bd
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "46"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloud.UserRoles.id
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: a962633f-f69c-4fda-8d0a-f9ce636d8b13
    type: condition
    task:
      id: a962633f-f69c-4fda-8d0a-f9ce636d8b13
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "4"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PrismaCloud.Users.username
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: 6da8f94a-a7db-4d85-8582-522d6a005ffc
    type: regular
    task:
      id: 6da8f94a-a7db-4d85-8582-522d6a005ffc
      version: -1
      name: prisma-cloud-users-list
      description: Get users lists.
      script: '|||prisma-cloud-users-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "45"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: c5a9929e-2ccf-4d8a-8e5e-93bb2db4f59a
    type: regular
    task:
      id: c5a9929e-2ccf-4d8a-8e5e-93bb2db4f59a
      version: -1
      name: Reopen snoozed alert (for next playbook run)
      description: Re-open the alerts matching the given filter. Either policy IDs or alert IDs must be provided. When no absolute time nor relative time arguments are provided, default time range is all times.
      script: '|||prisma-cloud-alert-reopen'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      alert_ids:
        simple: ${PrismaCloud.Alert.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2835,
        "width": 2100,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
fromversion: 6.5.0
description: Test for Prisma Cloud V2.
