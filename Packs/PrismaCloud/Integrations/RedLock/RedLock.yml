commonfields:
  id: RedLock
  version: -1
name: RedLock
display: Prisma Cloud (RedLock)
category: Network Security
description: Cloud threat defense
configuration:
- display: Server URL
  name: url
  defaultvalue: https://api.redlock.io/
  type: 0
  required: true
- display: Username
  name: credentials
  defaultvalue: ""
  type: 9
  required: true
- display: Customer name
  name: customer
  defaultvalue: ""
  type: 0
  required: false
- display: Use system proxy settings
  name: proxy
  defaultvalue: ""
  type: 8
  required: false
- display: Trust any certificate (not secure)
  name: unsecure
  defaultvalue: ""
  type: 8
  required: false
- display: Fetch only incidents matching this rule name
  name: ruleName
  defaultvalue: ""
  type: 0
  required: false
- display: Fetch only incidents with this severity
  name: policySeverity
  defaultvalue: ""
  type: 0
  required: false
- display: Fetch incidents
  name: isFetch
  type: 8
  required: false
- display: Incident type
  name: incidentType
  type: 13
  required: false
script:
  script: ''
  type: python
  subtype: python2
  commands:
  - name: redlock-get-rql-response
    description: Runs an RQL query on the Prisma Cloud.
    arguments:
    - name: limit
      required: false
      default: false
      isArray: false
      description: "The maximum number of records to return. '; limit search records\
        \ to {}' is appended to every query where {} is the maximum number of records\
        \ to return. If no value is provided, only 1 record is returned."
    - name: rql
      required: true
      default: false
      isArray: false
      description: "The RQL query to run. Examples of RQL queries can be found here:\
        \ https://docs.paloaltonetworks.com/prisma/prisma-cloud/prisma-cloud-rql-reference/rql-reference/rql-examples.\
        \ Note that ` limit search records to 1` is automatically appended to each\
        \ query and a `;` may need to be added to the end of the rql input to make\
        \ the entire query valid.  The limit parameter adjusts this to be a value\
        \ other than 1."
    outputs:
    - contextPath: Redlock.RQL.Query
      description: 'The RQL query that was run.'
      type: String
    - contextPath: Redlock.RQL.Response.AccountId
      description: 'The cloud account ID.'
      type: Date
    - contextPath: Redlock.RQL.Response.AccountName
      description: 'The cloud account name.'
      type: String
    - contextPath: Redlock.RQL.Response.AllowDrillDown
      description: 'Flag to allow drill down.'
      type: Boolean
    - contextPath: Redlock.RQL.Response.CloudType
      description: 'The cloud type.'
      type: String
    - contextPath: Redlock.RQL.Response.Data
      description: 'The data object returned by the RQL response.'
      type: Object
    - contextPath: Redlock.RQL.Response.Deleted
      description: 'Flag if deleted.'
      type: Boolean
    - contextPath: Redlock.RQL.Response.HasAlert
      description: 'Flag to check if RQL response has alerts.'
      type: Boolean
    - contextPath: Redlock.RQL.Response.HasExtFindingRiskFactors
      description: 'Flag if query returns external risk factors.'
      type: Boolean
    - contextPath: Redlock.RQL.Response.HasExternalFinding
      description: 'Flag for external findings.'
      type: Boolean
    - contextPath: Redlock.RQL.Response.HasExternalIntegration
      description: 'Flag for external integration.'
      type: Boolean
    - contextPath: Redlock.RQL.Response.HasNetwork
      description: 'Flag for determining if network exists.'
      type: Boolean
    - contextPath: Redlock.RQL.Response.Id
      description: 'The RQL response ID.'
      type: String
    - contextPath: Redlock.RQL.Response.InsertTs
      description: 'The response time.'
      type: Date
    - contextPath: Redlock.RQL.Response.Name
      description: 'The RQL response name.'
      type: String
    - contextPath: Redlock.RQL.Response.RegionId
      description: 'The cloud region ID.'
      type: String
    - contextPath: Redlock.RQL.Response.RegionName
      description: 'The cloud region name.'
      type: String
    - contextPath: Redlock.RQL.Response.ResourceType
      description: 'The resource type.'
      type: String
    - contextPath: Redlock.RQL.Response.Rrn
      description: 'The account RRN.'
      type: String
    - contextPath: Redlock.RQL.Response.Service
      description: 'The RQL response service.'
      type: String
    - contextPath: Redlock.RQL.Response.StateId
      description: 'The response state ID.'
      type: String
  - name: redlock-remediate-alerts
    description: Remediate alerts in Prisma Cloud.
    arguments:
    - name: alert-id
      required: true
      default: false
      isArray: true
      description: The ID of the alert to remediate. You can retrieve alerts using
        the redlock-search-alerts command.
  - name: redlock-search-alerts
    arguments:
    - name: time-range-date-from
      description: The start date for which to search in the following format - MM/DD/YYYY
    - name: time-range-date-to
      description: The end date for which to search in the following format - MM/DD/YYYY
    - name: time-range-value
      description: The number of units to search.
    - name: time-range-unit
      auto: PREDEFINED
      predefined:
      - hour
      - day
      - week
      - month
      - year
      - login
      - epoch
      description: 'The time range unit. Possible values are: "hour", "day", "week",
        "month", "year", "login", and "epoch". "login" and "epoch" are only available
        if time-range-value is not provided.'
    - name: policy-name
      auto: PREDEFINED
      predefined:
      - IAM password policy does not have a symbol
      - IAM password policy does not expire in 90 days
      - IAM password policy does not have a lowercase character
      - IAM password policy does not have a minimum of 14 characters
      - IAM password policy allows password reuse
      - Default Security Group does not restrict all traffic
      - IAM password policy does not have password expiration period
      - IAM password policy does not exist
      - Access keys are not rotated for 90 days
      - Security Groups allow internet traffic from internet to RDP port (3389)
      - Internet connectivity via tcp over insecure port
      - IAM policy allow full administrative privileges
      - Primitive IAM roles should not be used
      - Internet exposed instances
      - IAM user has both Console access and Access Keys
      - S3 buckets are accessible to public
      - Access logging not enabled on all CloudTrail buckets
      - CloudTrail trail is not integrated with CloudWatch Log
      - Security Groups allow internet traffic to SSH port (22)
      - CloudTrail logs are not encrypted using Customer Master Keys (CMKs)
      - Excessive login failures
      - VPC endpoints were not used for consuming S3 storage from within the VPC
      - Access logging not enabled on S3 buckets
      - S3 buckets do not have server side encryption
      - Account hijacking attempts
      - Security groups allow internet traffic
      - VPC subnets should not allow automatic public IP assignment
      - VPC Flow Logs not enabled
      - MFA not enabled for IAM users
      - Inactive users for more than 30 days
      description: The policy name.
    - name: policy-label
      description: The policy label.
    - name: policy-compliance-standard
      description: The policy compliance standard.
    - name: cloud-account
      description: The cloud account.
    - name: cloud-region
      description: The cloud region.
    - name: alert-rule-name
      description: The alert rule name.
    - name: resource-id
      description: The resource ID.
    - name: resource-name
      description: The resource name.
    - name: resource-type
      description: The resource type.
    - name: alert-status
      auto: PREDEFINED
      predefined:
      - open
      - resolved
      - dismissed
      description: 'The alert status. Possible values are: "open", "resolved", and
        "dismissed". Default is "open".'
      defaultValue: open
    - name: alert-id
      description: The alert ID.
    - name: cloud-type
      auto: PREDEFINED
      predefined:
      - aws
      - azure
      - gcp
      description: 'The cloud type. Possible values are: "aws", "azure", and "gcp".'
    - name: risk-grade
      auto: PREDEFINED
      predefined:
      - A
      - B
      - C
      - F
      description: 'The risk grade. Possible values are: "A", "B", "C", and "F".'
    - name: policy-type
      auto: PREDEFINED
      predefined:
      - anomaly
      - audit_event
      - config
      - network
      description: 'The policy type. Possible values are: "high", "medium", and "low".'
    - name: policy-severity
      auto: PREDEFINED
      predefined:
      - high
      - medium
      - low
      description: The policy severity.
    outputs:
    - contextPath: Redlock.Alert.ID
      description: The ID of the returned alert.
      type: string
    - contextPath: Redlock.Alert.Status
      description: The status of the returned alert.
      type: string
    - contextPath: Redlock.Alert.AlertTime
      description: The time of the returned alert.
      type: string
    - contextPath: Redlock.Alert.Policy.ID
      description: The policy ID of the returned alert.
      type: string
    - contextPath: Redlock.Alert.Policy.Name
      description: The policy name of the returned alert.
      type: string
    - contextPath: Redlock.Alert.Policy.Type
      description: The policy type of the returned alert.
      type: string
    - contextPath: Redlock.Alert.Policy.Severity
      description: The policy severity of the returned alert.
      type: string
    - contextPath: Redlock.Alert.Policy.Remediable
      description: Whether or not the policy is remediable.
      type: boolean
    - contextPath: Redlock.Alert.RiskDetail.Rating
      description: The risk rating of the returned alert.
      type: string
    - contextPath: Redlock.Alert.RiskDetail.Score
      description: The risk score of the returned alert.
      type: string
    - contextPath: Redlock.Metadata.CountOfAlerts
      description: The number of alerts found.
      type: number
    description: Search alerts on the Prisma Cloud (RedLock) platform.
  - name: redlock-get-alert-details
    arguments:
    - name: alert-id
      required: true
      default: true
      description: The alert ID
    - name: detailed
      auto: PREDEFINED
      predefined:
      - "true"
      - "false"
      description: Allows for retrieving entire / trimmed alert model
      defaultValue: "true"
    outputs:
    - contextPath: Redlock.Alert.ID
      description: The alert ID
      type: string
    - contextPath: Redlock.Alert.Status
      description: The alert status
      type: string
    - contextPath: Redlock.Alert.AlertTime
      description: The time of the alert
      type: date
    - contextPath: Redlock.Alert.AlertRules
      description: Names of the alert rules that triggered this alert.
      type: string
    - contextPath: Redlock.Alert.Policy.ID
      description: The policy ID
      type: string
    - contextPath: Redlock.Alert.Policy.Name
      description: The policy name
      type: string
    - contextPath: Redlock.Alert.Policy.Type
      description: The type of policy
      type: string
    - contextPath: Redlock.Alert.Policy.Severity
      description: The policy severity
      type: string
    - contextPath: Redlock.Alert.Policy.Remediable
      description: Whether or not the policy is remediable
      type: boolean
    - contextPath: Redlock.Alert.RiskDetail.Rating
      description: The risk rating
      type: string
    - contextPath: Redlock.Alert.RiskDetail.Score
      description: The risk score
      type: string
    description: Gets the details of an alert based on alert ID
  - name: redlock-dismiss-alerts
    arguments:
    - name: alert-id
      description: comma separated list of string IDs to be dismissed
    - name: snooze-value
      required: false
      description: The amount of time to snooze. Both snooze value and unit must be
        specified
    - name: snooze-unit
      required: false
      auto: PREDEFINED
      predefined:
      - hour
      - day
      - week
      - month
      - year
      - epoch
      description: The time unit for if snoozing alert.  Both snooze value and unit
        must be specified if snoozing.
    - name: dismissal-note
      required: true
      description: Reason for dismissal
    - name: time-range-date-from
      description: Start time for search in the following string format -  MM/DD/YYYY
    - name: time-range-date-to
      description: End time for search in the following format -  MM/DD/YYYY
    - name: time-range-value
      description: The amount of units to go back in time
    - name: time-range-unit
      auto: PREDEFINED
      predefined:
      - hour
      - day
      - week
      - month
      - year
      - login
      - epoch
      description: The search unit
    - name: policy-name
      auto: PREDEFINED
      predefined:
      - IAM password policy does not have a symbol
      - IAM password policy does not expire in 90 days
      - IAM password policy does not have a lowercase character
      - IAM password policy does not have a minimum of 14 characters
      - IAM password policy allows password reuse
      - Default Security Group does not restrict all traffic
      - IAM password policy does not have password expiration period
      - IAM password policy does not exist
      - Access keys are not rotated for 90 days
      - Security Groups allow internet traffic from internet to RDP port (3389)
      - Internet connectivity via tcp over insecure port
      - IAM policy allow full administrative privileges
      - Primitive IAM roles should not be used
      - Internet exposed instances
      - IAM user has both Console access and Access Keys
      - S3 buckets are accessible to public
      - Access logging not enabled on all CloudTrail buckets
      - CloudTrail trail is not integrated with CloudWatch Log
      - Security Groups allow internet traffic to SSH port (22)
      - CloudTrail logs are not encrypted using Customer Master Keys (CMKs)
      - Excessive login failures
      - VPC endpoints were not used for consuming S3 storage from within the VPC
      - Access logging not enabled on S3 buckets
      - S3 buckets do not have server side encryption
      - Account hijacking attempts
      - Security groups allow internet traffic
      - VPC subnets should not allow automatic public IP assignment
      - VPC Flow Logs not enabled
      - MFA not enabled for IAM users
      - Inactive users for more than 30 days
      description: The policy name
    - name: policy-label
      description: The policy label
    - name: policy-compliance-standard
      description: The policy compliance standard
    - name: cloud-account
      description: The cloud account
    - name: cloud-region
      description: The cloud region
    - name: alert-rule-name
      description: The alert rule name
    - name: resource-id
      description: The resource ID
    - name: resource-name
      description: The resource name
    - name: resource-type
      description: The resource type
    - name: alert-status
      auto: PREDEFINED
      predefined:
      - open
      - resolved
      - dismissed
      description: The alert status
    - name: cloud-type
      auto: PREDEFINED
      predefined:
      - aws
      - azure
      - gcp
      description: The cloud type
    - name: risk-grade
      auto: PREDEFINED
      predefined:
      - A
      - B
      - C
      - F
      description: The risk grade
    - name: policy-type
      auto: PREDEFINED
      predefined:
      - anomaly
      - audit_event
      - config
      - network
      description: The policy type
    - name: policy-severity
      auto: PREDEFINED
      predefined:
      - high
      - medium
      - low
      description: The policy severity
    - name: policy-id
      description: comma separated string of policy IDs
    outputs:
    - contextPath: Redlock.DismissedAlert.ID
      description: The IDs of the dismissed alerts
      type: string
    description: Dismiss the alerts matching the given filter. Must provide either
      policy IDs or alert IDs.
    execution: true
  - name: redlock-reopen-alerts
    arguments:
    - name: alert-id
      description: The IDs of alerts to reopen
    - name: time-range-date-from
      description: Start time for search in the following string format -  MM/DD/YYYY
    - name: time-range-date-to
      description: End time for search in the following format -  MM/DD/YYYY
    - name: time-range-value
      description: The amount of units to go back in time
    - name: time-range-unit
      auto: PREDEFINED
      predefined:
      - hour
      - day
      - week
      - month
      - year
      - login
      - epoch
      description: The search unit
    - name: policy-name
      auto: PREDEFINED
      predefined:
      - IAM password policy does not have a symbol
      - IAM password policy does not expire in 90 days
      - IAM password policy does not have a lowercase character
      - IAM password policy does not have a minimum of 14 characters
      - IAM password policy allows password reuse
      - Default Security Group does not restrict all traffic
      - IAM password policy does not have password expiration period
      - IAM password policy does not exist
      - Access keys are not rotated for 90 days
      - Security Groups allow internet traffic from internet to RDP port (3389)
      - Internet connectivity via tcp over insecure port
      - IAM policy allow full administrative privileges
      - Primitive IAM roles should not be used
      - Internet exposed instances
      - IAM user has both Console access and Access Keys
      - S3 buckets are accessible to public
      - Access logging not enabled on all CloudTrail buckets
      - CloudTrail trail is not integrated with CloudWatch Log
      - Security Groups allow internet traffic to SSH port (22)
      - CloudTrail logs are not encrypted using Customer Master Keys (CMKs)
      - Excessive login failures
      - VPC endpoints were not used for consuming S3 storage from within the VPC
      - Access logging not enabled on S3 buckets
      - S3 buckets do not have server side encryption
      - Account hijacking attempts
      - Security groups allow internet traffic
      - VPC subnets should not allow automatic public IP assignment
      - VPC Flow Logs not enabled
      - MFA not enabled for IAM users
      - Inactive users for more than 30 days
      description: The policy name
    - name: policy-label
      description: The policy label
    - name: policy-compliance-standard
      description: The policy compliance standard
    - name: cloud-account
      description: The cloud account
    - name: cloud-region
      description: The cloud region
    - name: alert-rule-name
      description: The alert rule name
    - name: resource-id
      description: The resource ID
    - name: resource-name
      description: The resource name
    - name: resource-type
      description: The resource type
    - name: alert-status
      auto: PREDEFINED
      predefined:
      - open
      - resolved
      - dismissed
      description: The alert status
    - name: cloud-type
      auto: PREDEFINED
      predefined:
      - aws
      - azure
      - gcp
      description: The cloud type
    - name: risk-grade
      auto: PREDEFINED
      predefined:
      - A
      - B
      - C
      - F
      description: The risk grade
    - name: policy-type
      auto: PREDEFINED
      predefined:
      - anomaly
      - audit_event
      - config
      - network
      description: The policy type
    - name: policy-severity
      auto: PREDEFINED
      predefined:
      - high
      - medium
      - low
      description: The policy severity
    outputs:
    - contextPath: Redlock.ReopenedAlert.ID
      description: IDs of the re-opened alerts
      type: string
    description: Re-open the alerts matching the given filter.  Must provide either
      policy IDs or alert IDs.
    execution: true
  - name: redlock-list-alert-filters
    arguments: []
    description: List the acceptable filters and values for alerts
  - name: redlock-get-remediation-details
    description: Gets remediation details for the given alert.
    outputs:
    - contextPath: Redlock.Alert.Remediation.Description
      description: Description of CLI remediation instructions.
      type: string
    - contextPath: Redlock.Alert.ID
      description: The ID of the alert to which the remediation details apply.
      type: string
    - contextPath: Redlock.Alert.Remediation.CLI
      description: The exact CLI command string.
      type: string
    arguments:
    - name: alert-id
      description: The alert ID for which to get remediation details.
  isfetch: true
  runonce: false
fromversion: 5.0.0
