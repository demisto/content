id: MISP V3 Test
version: -1
description: Test playbook for MISP V3 integration
name: MISP V3 Test
fromversion: 5.5.0
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 1b406fdf-0da4-482d-873b-c3ea0a491937
    type: start
    task:
      id: 1b406fdf-0da4-482d-873b-c3ea0a491937
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 8232273d-c4c6-47c9-8ee7-8e9435bdf8e2
    type: regular
    task:
      id: 8232273d-c4c6-47c9-8ee7-8e9435bdf8e2
      version: -1
      name: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: 52f3c97a-7745-4076-854a-280a004f6419
    type: regular
    task:
      id: 52f3c97a-7745-4076-854a-280a004f6419
      version: -1
      name: misp-search-events by event_id
      script: '|||misp-search-events'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      event_id:
        simple: ${MISP.Event.ID}
      limit:
        simple: "1"
      page:
        simple: "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 865
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 6369a35c-628f-4cbc-8b2a-4b0d307e8481
    type: condition
    task:
      id: 6369a35c-628f-4cbc-8b2a-4b0d307e8481
      version: -1
      name: Verify Search Event Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "16"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.ID
            iscontext: true
          right:
            value:
              simple: ${MISP.Event.ID}
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.Distribution
            iscontext: true
          right:
            value:
              simple: "0"
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.ThreatLevelID
            iscontext: true
          right:
            value:
              simple: "3"
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.Info
            iscontext: true
          right:
            value:
              simple: TPB-New-Event
      - - operator: greaterThanOrEqual
          left:
            value:
              simple: MISP.Event.AttributeCount
            iscontext: true
          right:
            value:
              simple: "1"
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.UUID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Analysis
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.SharingGroupID
            iscontext: true
          right:
            value:
              simple: "0"
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: e3f86f3f-8003-424d-8802-b4417c80e1b8
    type: regular
    task:
      id: e3f86f3f-8003-424d-8802-b4417c80e1b8
      version: -1
      name: domain
      description: Checks the reputation of the given domain.
      script: MISP V3|||domain
      type: regular
      iscommand: true
      brand: MISP V3
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      domain:
        simple: google.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4860
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: da1c8c0f-b6cf-4b91-8175-20c98ef75f6c
    type: condition
    task:
      id: da1c8c0f-b6cf-4b91-8175-20c98ef75f6c
      version: -1
      name: Verify  Domain Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "51"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Domain.Name
            iscontext: true
          right:
            value:
              simple: google.com
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Type
            iscontext: true
          right:
            value:
              simple: domain
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "0"
        - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "3"
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
          right:
            value:
              simple: google.com
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5035
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: a0513772-7fd4-4d2e-81e7-f03cb65db6d5
    type: regular
    task:
      id: a0513772-7fd4-4d2e-81e7-f03cb65db6d5
      version: -1
      name: email
      description: Checks the reputation of the given email address.
      script: MISP V3|||email
      type: regular
      iscommand: true
      brand: MISP V3
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      email:
        simple: email@email.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4860
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: aa6cb18b-6894-4661-8209-35c0d664368a
    type: condition
    task:
      id: aa6cb18b-6894-4661-8209-35c0d664368a
      version: -1
      name: Verify Email Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "51"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Email.Address
            iscontext: true
          right:
            value:
              simple: email@email.com
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
          right:
            value:
              simple: email@email.com
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Type
            iscontext: true
          right:
            value:
              simple: email
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "0"
        - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "3"
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5035
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 566fc853-5a38-4087-8a30-1f7c11917cf9
    type: regular
    task:
      id: 566fc853-5a38-4087-8a30-1f7c11917cf9
      version: -1
      name: file
      description: Checks the file reputation of the given hash.
      script: MISP V3|||file
      type: regular
      iscommand: true
      brand: MISP V3
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      file:
        simple: 098f6bcd4621d373cade4e832627b4f6
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 4860
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: 25b68843-7587-4943-827f-c93d4e2a8106
    type: condition
    task:
      id: 25b68843-7587-4943-827f-c93d4e2a8106
      version: -1
      name: Verify File Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "51"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: File.MD5
            iscontext: true
          right:
            value:
              simple: 098f6bcd4621d373cade4e832627b4f6
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
          right:
            value:
              simple: 098f6bcd4621d373cade4e832627b4f6
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Type
            iscontext: true
          right:
            value:
              simple: file
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "0"
        - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "3"
    view: |-
      {
        "position": {
          "x": 910,
          "y": 5035
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: 4681d989-ddd3-4ddb-8dde-bbc07e07e4be
    type: regular
    task:
      id: 4681d989-ddd3-4ddb-8dde-bbc07e07e4be
      version: -1
      name: url
      description: Checks the reputation of the given URL.
      script: MISP V3|||url
      type: regular
      iscommand: true
      brand: MISP V3
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      url:
        simple: www.example.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 4860
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 36513751-be0c-4575-826a-23e4fccbc0c4
    type: condition
    task:
      id: 36513751-be0c-4575-826a-23e4fccbc0c4
      version: -1
      name: 'Verify URL Outputs '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "51"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: URL.Data
            iscontext: true
          right:
            value:
              simple: www.example.com
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
          right:
            value:
              simple: www.example.com
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Type
            iscontext: true
          right:
            value:
              simple: url
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "0"
        - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "3"
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 5035
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: 00f15c78-9278-4558-8f12-bced77380df2
    type: regular
    task:
      id: 00f15c78-9278-4558-8f12-bced77380df2
      version: -1
      name: ip
      description: Checks the reputation of an IP address.
      script: MISP V3|||ip
      type: regular
      iscommand: true
      brand: MISP V3
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      ip:
        simple: 1.2.3.4
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 4860
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: 3b598779-04fe-41ca-83e9-ea4c6f8f07e6
    type: condition
    task:
      id: 3b598779-04fe-41ca-83e9-ea4c6f8f07e6
      version: -1
      name: Verify IP Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "51"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: IP.Address
            iscontext: true
          right:
            value:
              simple: 1.2.3.4
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
          right:
            value:
              simple: 1.2.3.4
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Type
            iscontext: true
          right:
            value:
              simple: ip
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "0"
        - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "3"
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 5035
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: e7df5780-9d84-4805-8abb-ff5be8cc8be1
    type: regular
    task:
      id: e7df5780-9d84-4805-8abb-ff5be8cc8be1
      version: -1
      name: misp-create-event
      script: '|||misp-create-event'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "50"
    scriptarguments:
      info:
        simple: TPB-New-Event
      threat_level_id:
        simple: Low
      value:
        simple: 1.1.1.1
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: b33a41ba-87fb-426a-8676-434c6774df56
    type: condition
    task:
      id: b33a41ba-87fb-426a-8676-434c6774df56
      version: -1
      name: Verify New Event Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "2"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.ID
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.Distribution
            iscontext: true
          right:
            value:
              simple: "0"
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.ThreatLevelID
            iscontext: true
          right:
            value:
              simple: "3"
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.EventCreatorEmail
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.Info
            iscontext: true
          right:
            value:
              simple: TPB-New-Event
      - - operator: greaterThanOrEqual
          left:
            value:
              simple: MISP.Event.AttributeCount
            iscontext: true
          right:
            value:
              simple: "1"
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.OrganizationID
            iscontext: true
          right:
            value:
              simple: "1"
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.Organization.ID
            iscontext: true
          right:
            value:
              simple: "1"
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.Organization.Name
            iscontext: true
          right:
            value:
              simple: ORGNAME
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Organization.UUID
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.OwnerOrganization.ID
            iscontext: true
          right:
            value:
              simple: "1"
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.OwnerOrganization.Name
            iscontext: true
          right:
            value:
              simple: ORGNAME
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.OwnerOrganization.UUID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.LastChanged
            iscontext: true
      - - operator: isFalse
          left:
            value:
              simple: MISP.Event.Published
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.UUID
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.Analysis
            iscontext: true
          right:
            value:
              simple: "0"
    view: |-
      {
        "position": {
          "x": 910,
          "y": 690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: bcdf7573-76ac-45d1-8b8e-ac5f6d72b25f
    type: regular
    task:
      id: bcdf7573-76ac-45d1-8b8e-ac5f6d72b25f
      version: -1
      name: misp-add-attribute
      script: '|||misp-add-attribute'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      comment:
        simple: test-add-attribute
      event_id:
        simple: ${MISP.Event.ID}
      value:
        simple: "10"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1215
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: 3a7b118c-20a9-42ab-855c-5e59dfd4bd7c
    type: condition
    task:
      id: 3a7b118c-20a9-42ab-855c-5e59dfd4bd7c
      version: -1
      name: Verify Add Attribute Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "65"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.Distribution
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Value
            iscontext: true
          right:
            value:
              simple: "10"
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.EventID
            iscontext: true
          right:
            value:
              simple: ${MISP.Event.ID}
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.LastChanged
            iscontext: true
      - - operator: isFalse
          left:
            value:
              simple: MISP.Attribute.Deleted
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Type
            iscontext: true
          right:
            value:
              simple: other
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.UUID
            iscontext: true
      - - operator: isTrue
          left:
            value:
              simple: MISP.Attribute.ToIDs
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Category
            iscontext: true
          right:
            value:
              simple: External analysis
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Comment
            iscontext: true
          right:
            value:
              simple: test-add-attribute
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Event.ID
            iscontext: true
          right:
            value:
              simple: ${MISP.Event.ID}
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Event.Distribution
            iscontext: true
          right:
            value:
              simple: "0"
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Event.Info
            iscontext: true
          right:
            value:
              simple: TPB-New-Event
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.Event.UUID
            iscontext: true
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: a5a78b5e-2878-4b59-8a5d-e4f9eb2fb161
    type: regular
    task:
      id: a5a78b5e-2878-4b59-8a5d-e4f9eb2fb161
      version: -1
      name: misp-add-tag-to-event
      script: '|||misp-add-tag-to-event'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      tag:
        simple: EventTag
      uuid:
        simple: ${MISP.Event.UUID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 5880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 0c773cf9-064f-450d-8d8b-becde4e485cd
    type: condition
    task:
      id: 0c773cf9-064f-450d-8d8b-becde4e485cd
      version: -1
      name: Verify Event Tags
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "60"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Info
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.UUID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Analysis
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.Tag.Name
            iscontext: true
          right:
            value:
              simple: EventTag
      - - operator: isFalse
          left:
            value:
              simple: MISP.Event.Tag.is_galaxy
            iscontext: true
    view: |-
      {
        "position": {
          "x": 910,
          "y": 6055
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: 7546281e-1c7e-43a3-8ecb-e525d4d02b7f
    type: regular
    task:
      id: 7546281e-1c7e-43a3-8ecb-e525d4d02b7f
      version: -1
      name: misp-add-tag-to-attribute
      script: '|||misp-add-tag-to-attribute'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      tag:
        simple: TestPlaybook
      uuid:
        simple: ${MISP.Attribute.UUID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 0a4f5663-29c0-44f3-8284-ba32defa08ce
    type: condition
    task:
      id: 0a4f5663-29c0-44f3-8284-ba32defa08ce
      version: -1
      name: Verify Attribute Tags
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "61"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Value
            iscontext: true
          right:
            value:
              simple: "10"
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.UUID
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Tag.Name
            iscontext: true
          right:
            value:
              simple: TestPlaybook
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2265
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: 83c4b225-63ac-4a3c-859b-4c69791d62c3
    type: regular
    task:
      id: 83c4b225-63ac-4a3c-859b-4c69791d62c3
      version: -1
      name: misp-add-sighting
      script: '|||misp-add-sighting'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      id:
        simple: ${MISP.Attribute.ID}
      type:
        simple: sighting
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: 72b9f652-d0fb-45b8-802b-de919e6d1ed7
    type: regular
    task:
      id: 72b9f652-d0fb-45b8-802b-de919e6d1ed7
      version: -1
      name: misp-add-events-from-feed
      script: '|||misp-add-events-from-feed'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "62"
    scriptarguments:
      feed:
        simple: Botvrij.eu
      limit:
        simple: "0"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3840
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: 5a0472a0-0904-49a1-8c5a-7bb37f3a039d
    type: regular
    task:
      id: 5a0472a0-0904-49a1-8c5a-7bb37f3a039d
      version: -1
      name: misp-add-file-object
      script: '|||misp-add-file-object'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "59"
    scriptarguments:
      entry_id:
        simple: ${File.EntryID}
      event_id:
        simple: ${MISP.Event.ID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 7980
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: 4c33dbfa-8a63-4c60-882a-ff6363164bec
    type: regular
    task:
      id: 4c33dbfa-8a63-4c60-882a-ff6363164bec
      version: -1
      name: misp-add-domain-object
      script: '|||misp-add-domain-object'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      dns:
        simple: 2.2.2.2
      event_id:
        simple: ${MISP.Event.ID}
      ip:
        simple: 2.2.2.2
      name:
        simple: example.com
      text:
        simple: DomainTPB
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 7455
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: 2a264e31-5c10-4d69-895f-595692d9d370
    type: condition
    task:
      id: 2a264e31-5c10-4d69-895f-595692d9d370
      version: -1
      name: Verify Domain Obj Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "58"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.ID
            iscontext: true
      - - operator: in
          left:
            value:
              simple: domain-ip
          right:
            value:
              simple: MISP.Event.Object.Name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.UUID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.Description
            iscontext: true
      - - operator: in
          left:
            value:
              simple: 2.2.2.2
          right:
            value:
              simple: ${MISP.Event.Object.Attribute.Value}
            iscontext: true
      - - operator: in
          left:
            value:
              simple: example.com
          right:
            value:
              simple: ${MISP.Event.Object.Attribute.Value}
            iscontext: true
      - - operator: in
          left:
            value:
              simple: DomainTPB
          right:
            value:
              simple: ${MISP.Event.Object.Attribute.Value}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 910,
          "y": 7630
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: 7ecd56fc-3d31-459f-80ae-15531b07a819
    type: regular
    task:
      id: 7ecd56fc-3d31-459f-80ae-15531b07a819
      version: -1
      name: misp-add-url-object
      script: '|||misp-add-url-object'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "48"
    scriptarguments:
      event_id:
        simple: ${MISP.Event.ID}
      text:
        simple: URLTPB
      url:
        simple: www.example.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 7105
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: 68bd5097-06b8-4db8-8850-79df06dc7396
    type: regular
    task:
      id: 68bd5097-06b8-4db8-8850-79df06dc7396
      version: -1
      name: misp-add-object
      script: '|||misp-add-object'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "57"
    scriptarguments:
      attributes:
        simple: '{''description'': ''Manager Ferrari'', ''make'': ''Ferrari'', ''model'':
          ''308 GTS''}'
      event_id:
        simple: ${MISP.Event.ID}
      template:
        simple: vehicle
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 6755
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: 3cf7bd7a-5f53-487f-89b4-e62c22239342
    type: regular
    task:
      id: 3cf7bd7a-5f53-487f-89b4-e62c22239342
      version: -1
      name: misp-add-ip-object
      script: '|||misp-add-ip-object'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "56"
    scriptarguments:
      event_id:
        simple: ${MISP.Event.ID}
      ip:
        simple: 3.3.3.3
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 6405
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: 91e44627-a5a3-459c-8d27-2e1473bfac9f
    type: regular
    task:
      id: 91e44627-a5a3-459c-8d27-2e1473bfac9f
      version: -1
      name: misp-search-attributes only values
      script: '|||misp-search-attributes'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "37"
    scriptarguments:
      compact:
        simple: "true"
      type:
        simple: other
      value:
        simple: "10"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2790
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: e59dc31e-3d81-42b1-8433-a6642047d146
    type: condition
    task:
      id: e59dc31e-3d81-42b1-8433-a6642047d146
      version: -1
      name: Verify Search Attribute Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "42"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: in
          left:
            value:
              simple: "10"
          right:
            value:
              simple: ${MISP.Attribute}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2965
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: 3df234c4-fd01-4040-882b-8c3ca67d5cb3
    type: title
    task:
      id: 3df234c4-fd01-4040-882b-8c3ca67d5cb3
      version: -1
      name: Test Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 8505
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: a1be6208-bef5-437f-8d9f-d45469b5b30a
    type: regular
    task:
      id: a1be6208-bef5-437f-8d9f-d45469b5b30a
      version: -1
      name: misp-search-attributes full output
      script: '|||misp-search-attributes'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "40"
    scriptarguments:
      compact:
        simple: "false"
      include_sightings:
        simple: "true"
      limit:
        simple: "1"
      page:
        simple: "1"
      type:
        simple: other
      value:
        simple: "10"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3315
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: c0bc1cda-2514-4737-8f19-4dcedd4300a8
    type: condition
    task:
      id: c0bc1cda-2514-4737-8f19-4dcedd4300a8
      version: -1
      name: Verify Search Attribute Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "67"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.Distribution
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Value
            iscontext: true
          right:
            value:
              simple: "10"
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.EventID
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Type
            iscontext: true
          right:
            value:
              simple: other
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.UUID
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Category
            iscontext: true
          right:
            value:
              simple: Person
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Comment
            iscontext: true
          right:
            value:
              simple: updated comment
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.Event.ID
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Event.Info
            iscontext: true
          right:
            value:
              simple: TPB-New-Event
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.Event.UUID
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Sighting.Type
            iscontext: true
          right:
            value:
              simple: "0"
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3490
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: 4642c59e-1227-4a49-8f15-3e44a961cbc0
    type: regular
    task:
      id: 4642c59e-1227-4a49-8f15-3e44a961cbc0
      version: -1
      name: Delete Attribute Context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      key:
        simple: MISP.Attribute
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: bb06c7de-c08e-4a12-843d-98a5c7194af9
    type: regular
    task:
      id: bb06c7de-c08e-4a12-843d-98a5c7194af9
      version: -1
      name: Delete Attribute Context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "39"
    scriptarguments:
      key:
        simple: MISP.Attribute
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: a6bb2a33-ee64-44fe-88d7-2905b22fd485
    type: regular
    task:
      id: a6bb2a33-ee64-44fe-88d7-2905b22fd485
      version: -1
      name: 'misp-add-attribute domain '
      script: '|||misp-add-attribute'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      event_id:
        simple: ${MISP.Event.ID}
      value:
        simple: google.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4685
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "44":
    id: "44"
    taskid: a60e412c-3920-4498-8704-5c663cc50741
    type: regular
    task:
      id: a60e412c-3920-4498-8704-5c663cc50741
      version: -1
      name: 'misp-add-attribute email '
      script: '|||misp-add-attribute'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      event_id:
        simple: ${MISP.Event.ID}
      value:
        simple: email@email.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4685
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: 6ba990a3-e714-4d26-8964-1817f36afd09
    type: regular
    task:
      id: 6ba990a3-e714-4d26-8964-1817f36afd09
      version: -1
      name: 'misp-add-attribute file '
      script: '|||misp-add-attribute'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      event_id:
        simple: ${MISP.Event.ID}
      value:
        simple: 098f6bcd4621d373cade4e832627b4f6
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 4685
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: d9e89015-70c8-4e96-85cc-2d7c9d27be01
    type: regular
    task:
      id: d9e89015-70c8-4e96-85cc-2d7c9d27be01
      version: -1
      name: 'misp-add-attribute ip '
      script: '|||misp-add-attribute'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      event_id:
        simple: ${MISP.Event.ID}
      value:
        simple: 1.2.3.4
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 4685
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: 7ccfe15c-8374-4da6-88b9-79627360db10
    type: regular
    task:
      id: 7ccfe15c-8374-4da6-88b9-79627360db10
      version: -1
      name: misp-add-attribute url
      script: '|||misp-add-attribute'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      event_id:
        simple: ${MISP.Event.ID}
      value:
        simple: www.example.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 4685
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: d72f68e1-07d4-48ef-8d3f-d0a0546d60fe
    type: condition
    task:
      id: d72f68e1-07d4-48ef-8d3f-d0a0546d60fe
      version: -1
      name: Verify URL Obj Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "28"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.MetaCategory
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.Distribution
            iscontext: true
      - - operator: in
          left:
            value:
              simple: url
          right:
            value:
              simple: ${MISP.Event.Object.Name}
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.UUID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.Description
            iscontext: true
      - - operator: in
          left:
            value:
              simple: www.example.com
          right:
            value:
              simple: ${MISP.Event.Object.Attribute.Value}
            iscontext: true
      - - operator: in
          left:
            value:
              simple: www.example.com
          right:
            value:
              simple: ${MISP.Event.Object.Attribute.Value}
            iscontext: true
      - - operator: in
          left:
            value:
              simple: URLTPB
          right:
            value:
              simple: ${MISP.Event.Object.Attribute.Value}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 910,
          "y": 7280
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: c77d932c-10ea-4449-8323-bf31f69e3a21
    type: title
    task:
      id: c77d932c-10ea-4449-8323-bf31f69e3a21
      version: -1
      name: Reputation Commands
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "43"
      - "44"
      - "45"
      - "46"
      - "47"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 4540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: 6ccda4fb-9e4e-4643-856a-2142797d77c6
    type: title
    task:
      id: 6ccda4fb-9e4e-4643-856a-2142797d77c6
      version: -1
      name: MISP Commands
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: 3178045f-33e8-4cdc-8ccf-ae53f52237fa
    type: regular
    task:
      id: 3178045f-33e8-4cdc-8ccf-ae53f52237fa
      version: -1
      name: Delete Event
      description: Deletes an event according to the given event ID.
      script: '|||misp-delete-event'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "52"
    scriptarguments:
      event_id:
        simple: ${MISP.Event.ID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 5210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "52":
    id: "52"
    taskid: 616d1c1e-5d81-4c13-834c-8b8910874321
    type: title
    task:
      id: 616d1c1e-5d81-4c13-834c-8b8910874321
      version: -1
      name: Object Commands
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "53"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 5385
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: 36d108de-f5b7-4411-82c3-6b318e2b2d65
    type: regular
    task:
      id: 36d108de-f5b7-4411-82c3-6b318e2b2d65
      version: -1
      name: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "55"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 5530
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "54":
    id: "54"
    taskid: 0c487011-0267-4daa-8a8b-a669ab3d099d
    type: regular
    task:
      id: 0c487011-0267-4daa-8a8b-a669ab3d099d
      version: -1
      name: Delete Event
      description: Deletes an event according to the given event ID.
      script: '|||misp-delete-event'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "38"
    scriptarguments:
      event_id:
        simple: ${MISP.Event.ID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 8330
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "55":
    id: "55"
    taskid: d8019cb7-8bb3-4402-855e-e18d4c3eb0dd
    type: regular
    task:
      id: d8019cb7-8bb3-4402-855e-e18d4c3eb0dd
      version: -1
      name: misp-create-event
      script: '|||misp-create-event'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      info:
        simple: TPB-New-Event
      threat_level_id:
        simple: Low
      value:
        simple: 1.1.1.1
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 5705
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "56":
    id: "56"
    taskid: 4a6a8d01-12fd-4c8b-8fff-76b65cf86928
    type: condition
    task:
      id: 4a6a8d01-12fd-4c8b-8fff-76b65cf86928
      version: -1
      name: Verify IP Obj Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "32"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.MetaCategory
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.Distribution
            iscontext: true
      - - operator: in
          left:
            value:
              simple: ip-port
          right:
            value:
              simple: ${MISP.Event.Object.Name}
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.UUID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.Description
            iscontext: true
      - - operator: in
          left:
            value:
              simple: 3.3.3.3
          right:
            value:
              simple: ${MISP.Event.Object.Attribute.Value}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 910,
          "y": 6580
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "57":
    id: "57"
    taskid: c46a4dfd-9c0b-4b6c-8857-2c6ce16d21ef
    type: condition
    task:
      id: c46a4dfd-9c0b-4b6c-8857-2c6ce16d21ef
      version: -1
      name: Verify Object Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "30"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.MetaCategory
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.Distribution
            iscontext: true
      - - operator: in
          left:
            value:
              simple: vehicle
          right:
            value:
              simple: MISP.Event.Object.Name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.UUID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.Description
            iscontext: true
      - - operator: in
          left:
            value:
              simple: Manager Ferrari
          right:
            value:
              simple: ${MISP.Event.Object.Attribute.Value}
            iscontext: true
      - - operator: in
          left:
            value:
              simple: Ferrari
          right:
            value:
              simple: ${MISP.Event.Object.Attribute.Value}
            iscontext: true
      - - operator: in
          left:
            value:
              simple: 308 GTS
          right:
            value:
              simple: ${MISP.Event.Object.Attribute.Value}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 910,
          "y": 6930
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "58":
    id: "58"
    taskid: 4bb38482-9721-42c2-8996-74cded964f88
    type: regular
    task:
      id: 4bb38482-9721-42c2-8996-74cded964f88
      version: -1
      name: get file
      description: Sends http request. Returns the response as json.
      scriptName: http
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "26"
    scriptarguments:
      method:
        simple: GET
      saveAsFile:
        simple: "yes"
      url:
        simple: https://github.com/demisto/content/blob/master/TestData/regular_english_file.txt
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 7805
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "59":
    id: "59"
    taskid: 3c7d83b2-b7de-42c5-8ee6-72e9d47307c4
    type: condition
    task:
      id: 3c7d83b2-b7de-42c5-8ee6-72e9d47307c4
      version: -1
      name: Verify File Obj Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "54"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.ID
            iscontext: true
      - - operator: in
          left:
            value:
              simple: file
          right:
            value:
              simple: MISP.Event.Object.Name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.UUID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.Description
            iscontext: true
    view: |-
      {
        "position": {
          "x": 910,
          "y": 8155
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: 6b11a241-64e1-495a-82b1-165a6f0da51d
    type: regular
    task:
      id: 6b11a241-64e1-495a-82b1-165a6f0da51d
      version: -1
      name: Remove Event Tag
      description: Removes a tag from the given UUID event .
      script: '|||misp-remove-tag-from-event'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      tag:
        simple: EventTag
      uuid:
        simple: ${MISP.Event.UUID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 6230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    id: "61"
    taskid: ba22cf52-e300-4b10-8fb8-f57ee8f750ec
    type: regular
    task:
      id: ba22cf52-e300-4b10-8fb8-f57ee8f750ec
      version: -1
      name: Remove Attribute Tag
      description: Removes a tag from the given UUID attribute .
      script: '|||misp-remove-tag-from-attribute'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "41"
    scriptarguments:
      tag:
        simple: TestPlaybook
      uuid:
        simple: ${MISP.Attribute.UUID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2440
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "62":
    id: "62"
    taskid: 8ea17595-6b66-4b80-807f-4dedbeb72fd5
    type: regular
    task:
      id: 8ea17595-6b66-4b80-807f-4dedbeb72fd5
      version: -1
      name: Delete Event
      description: Deletes an event according to the given event ID.
      script: '|||misp-delete-event'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "64"
    scriptarguments:
      event_id:
        simple: ${MISP.Event.ID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 4015
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: 65b9051a-2c2a-4331-8107-b8051d7ef1fb
    type: regular
    task:
      id: 65b9051a-2c2a-4331-8107-b8051d7ef1fb
      version: -1
      name: misp-create-event
      script: '|||misp-create-event'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "49"
    scriptarguments:
      info:
        simple: TPB-New-Event
      threat_level_id:
        simple: Low
      value:
        simple: 1.1.1.1
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 4365
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "64":
    id: "64"
    taskid: 8c997ad0-e2f0-4932-8e65-2c2c0fdedb2c
    type: regular
    task:
      id: 8c997ad0-e2f0-4932-8e65-2c2c0fdedb2c
      version: -1
      name: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "63"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 4190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "65":
    id: "65"
    taskid: f416812b-c7f7-4460-80c4-32be394c04b8
    type: regular
    task:
      id: f416812b-c7f7-4460-80c4-32be394c04b8
      version: -1
      name: Update attribute
      description: Update an attribute of an existing MISP event.
      script: '|||misp-update-attribute'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "66"
    scriptarguments:
      attribute_uuid:
        simple: ${MISP.Attribute.UUID}
      category:
        simple: Person
      comment:
        simple: updated comment
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1565
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "66":
    id: "66"
    taskid: a5ba3c4a-fc83-48cf-8ebb-e870f7485f13
    type: condition
    task:
      id: a5ba3c4a-fc83-48cf-8ebb-e870f7485f13
      version: -1
      name: Verify Update Attribute Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "21"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.Distribution
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Value
            iscontext: true
          right:
            value:
              simple: "10"
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.EventID
            iscontext: true
          right:
            value:
              simple: ${MISP.Event.ID}
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.LastChanged
            iscontext: true
      - - operator: isFalse
          left:
            value:
              simple: MISP.Attribute.Deleted
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Type
            iscontext: true
          right:
            value:
              simple: other
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.UUID
            iscontext: true
      - - operator: isTrue
          left:
            value:
              simple: MISP.Attribute.ToIDs
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Category
            iscontext: true
          right:
            value:
              simple: Person
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Comment
            iscontext: true
          right:
            value:
              simple: updated comment
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Event.ID
            iscontext: true
          right:
            value:
              simple: ${MISP.Event.ID}
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Event.Distribution
            iscontext: true
          right:
            value:
              simple: "0"
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Event.Info
            iscontext: true
          right:
            value:
              simple: TPB-New-Event
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.Event.UUID
            iscontext: true
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1740
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "67":
    id: "67"
    taskid: ced54c40-6830-44f0-82ab-5d864eec6ecc
    type: regular
    task:
      id: ced54c40-6830-44f0-82ab-5d864eec6ecc
      version: -1
      name: Delete Attribute
      description: Delete an attribute according to the given attribute ID.
      script: '|||misp-delete-attribute'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "24"
    scriptarguments:
      attribute_id:
        simple: ${MISP.Attribute.ID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3665
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 8520,
        "width": 2100,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []