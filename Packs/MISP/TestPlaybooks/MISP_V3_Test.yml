id: MISP V3 Test
version: 2
fromversion: 5.0.0
vcShouldKeepItemLegacyProdMachine: false
name: MISP V3 Test
description: Test playbook for MISP V3 integration
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: bc45da74-5883-4a08-80f5-9fc6240da347
    type: start
    task:
      id: bc45da74-5883-4a08-80f5-9fc6240da347
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 96e63cb3-9948-4762-8bf0-41af1806562c
    type: regular
    task:
      id: 96e63cb3-9948-4762-8bf0-41af1806562c
      version: -1
      name: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: 9e59afc5-d454-4a00-8746-906adcdd7d87
    type: regular
    task:
      id: 9e59afc5-d454-4a00-8746-906adcdd7d87
      version: -1
      name: misp-search-events by event_id
      script: '|||misp-search-events'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      event_id:
        simple: ${MISP.Event.ID}
      limit:
        simple: "1"
      page:
        simple: "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 20f4c1ac-c6ea-4715-8fba-b65047e494e1
    type: condition
    task:
      id: 20f4c1ac-c6ea-4715-8fba-b65047e494e1
      version: -1
      name: Verify Search Event Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "16"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.ID
            iscontext: true
          right:
            value:
              simple: ${MISP.Event.ID}
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.Distribution
            iscontext: true
          right:
            value:
              simple: "0"
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.ThreatLevelID
            iscontext: true
          right:
            value:
              simple: "3"
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.Info
            iscontext: true
          right:
            value:
              simple: TPB-New-Event
      - - operator: greaterThanOrEqual
          left:
            value:
              simple: MISP.Event.AttributeCount
            iscontext: true
          right:
            value:
              simple: "1"
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.UUID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Analysis
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.SharingGroupID
            iscontext: true
          right:
            value:
              simple: "0"
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1215
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: b182bf8a-d265-45f9-8730-27030e14e7af
    type: regular
    task:
      id: b182bf8a-d265-45f9-8730-27030e14e7af
      version: -1
      name: domain
      description: Checks the reputation of the given domain.
      script: MISP V3|||domain
      type: regular
      iscommand: true
      brand: MISP V3
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      domain:
        simple: google.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5035
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 534cda5a-f144-49b5-8095-4b2a22c8ed3d
    type: condition
    task:
      id: 534cda5a-f144-49b5-8095-4b2a22c8ed3d
      version: -1
      name: Verify  Domain Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "51"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Domain.Name
            iscontext: true
          right:
            value:
              simple: google.com
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Type
            iscontext: true
          right:
            value:
              simple: domain
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "0"
        - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "3"
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
          right:
            value:
              simple: google.com
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 85b00bdd-b4a0-40e4-8be0-3cca1d6241d9
    type: regular
    task:
      id: 85b00bdd-b4a0-40e4-8be0-3cca1d6241d9
      version: -1
      name: email
      description: Checks the reputation of the given email address.
      script: MISP V3|||email
      type: regular
      iscommand: true
      brand: MISP V3
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      email:
        simple: email@email.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5035
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: 9ad56a8e-cb26-48a1-8245-51e9fae72234
    type: condition
    task:
      id: 9ad56a8e-cb26-48a1-8245-51e9fae72234
      version: -1
      name: Verify Email Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "51"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Email.Address
            iscontext: true
          right:
            value:
              simple: email@email.com
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
          right:
            value:
              simple: email@email.com
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Type
            iscontext: true
          right:
            value:
              simple: email
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "0"
        - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "3"
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 1d4316d2-dfdf-4ccd-8747-04ffe0a1572e
    type: regular
    task:
      id: 1d4316d2-dfdf-4ccd-8747-04ffe0a1572e
      version: -1
      name: file
      description: Checks the file reputation of the given hash.
      script: MISP V3|||file
      type: regular
      iscommand: true
      brand: MISP V3
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      file:
        simple: 098f6bcd4621d373cade4e832627b4f6
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 5035
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: 7a510189-6aa5-4b07-8eb6-fc736a859edc
    type: condition
    task:
      id: 7a510189-6aa5-4b07-8eb6-fc736a859edc
      version: -1
      name: Verify File Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "51"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: File.MD5
            iscontext: true
          right:
            value:
              simple: 098f6bcd4621d373cade4e832627b4f6
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
          right:
            value:
              simple: 098f6bcd4621d373cade4e832627b4f6
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Type
            iscontext: true
          right:
            value:
              simple: file
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "0"
        - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "3"
    view: |-
      {
        "position": {
          "x": 910,
          "y": 5210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: fc3e8c27-c6cf-48b1-8af8-1fa88620317a
    type: regular
    task:
      id: fc3e8c27-c6cf-48b1-8af8-1fa88620317a
      version: -1
      name: url
      description: Checks the reputation of the given URL.
      script: MISP V3|||url
      type: regular
      iscommand: true
      brand: MISP V3
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      url:
        simple: www.example.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 5035
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: d30fe884-20db-40cc-875d-870470a9b945
    type: condition
    task:
      id: d30fe884-20db-40cc-875d-870470a9b945
      version: -1
      name: 'Verify URL Outputs '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "51"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: URL.Data
            iscontext: true
          right:
            value:
              simple: www.example.com
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
          right:
            value:
              simple: www.example.com
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Type
            iscontext: true
          right:
            value:
              simple: url
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "0"
        - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "3"
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 5210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: 172d54cd-324b-4d96-8ba9-989bf0d26baa
    type: regular
    task:
      id: 172d54cd-324b-4d96-8ba9-989bf0d26baa
      version: -1
      name: ip
      description: Checks the reputation of an IP address.
      script: MISP V3|||ip
      type: regular
      iscommand: true
      brand: MISP V3
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      ip:
        simple: 1.2.3.4
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 5035
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: f98f8b40-ba35-425b-84fc-f21d7d45350a
    type: condition
    task:
      id: f98f8b40-ba35-425b-84fc-f21d7d45350a
      version: -1
      name: Verify IP Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "51"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: IP.Address
            iscontext: true
          right:
            value:
              simple: 1.2.3.4
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
          right:
            value:
              simple: 1.2.3.4
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Type
            iscontext: true
          right:
            value:
              simple: ip
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "0"
        - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "3"
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 5210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: ac9a9770-85ec-427b-8180-ec2f7e7042e7
    type: regular
    task:
      id: ac9a9770-85ec-427b-8180-ec2f7e7042e7
      version: -1
      name: misp-create-event
      script: '|||misp-create-event'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "68"
    scriptarguments:
      info:
        simple: TPB-New-Event
      threat_level_id:
        simple: Low
      value:
        simple: 1.1.1.1
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: a508f47b-967a-428b-8cd0-e3a47d355bbd
    type: condition
    task:
      id: a508f47b-967a-428b-8cd0-e3a47d355bbd
      version: -1
      name: Verify New Event Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "2"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.ID
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.Distribution
            iscontext: true
          right:
            value:
              simple: "0"
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.ThreatLevelID
            iscontext: true
          right:
            value:
              simple: "3"
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.EventCreatorEmail
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.Info
            iscontext: true
          right:
            value:
              simple: TPB-New-Event
      - - operator: greaterThanOrEqual
          left:
            value:
              simple: MISP.Event.AttributeCount
            iscontext: true
          right:
            value:
              simple: "1"
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.OrganizationID
            iscontext: true
          right:
            value:
              simple: "1"
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.Organization.ID
            iscontext: true
          right:
            value:
              simple: "1"
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.Organization.Name
            iscontext: true
          right:
            value:
              simple: ORGNAME
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Organization.UUID
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.OwnerOrganization.ID
            iscontext: true
          right:
            value:
              simple: "1"
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.OwnerOrganization.Name
            iscontext: true
          right:
            value:
              simple: ORGNAME
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.OwnerOrganization.UUID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.LastChanged
            iscontext: true
      - - operator: isFalse
          left:
            value:
              simple: MISP.Event.Published
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.UUID
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.Analysis
            iscontext: true
          right:
            value:
              simple: "0"
    view: |-
      {
        "position": {
          "x": 910,
          "y": 865
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: 1b571fbc-d451-40f5-8a1c-4ac7e3d78970
    type: regular
    task:
      id: 1b571fbc-d451-40f5-8a1c-4ac7e3d78970
      version: -1
      name: misp-add-attribute
      script: '|||misp-add-attribute'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      comment:
        simple: test-add-attribute
      event_id:
        simple: ${MISP.Event.ID}
      value:
        simple: "10"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: e24c8ea7-1f7f-454c-89bf-34c0e2b8e2f1
    type: condition
    task:
      id: e24c8ea7-1f7f-454c-89bf-34c0e2b8e2f1
      version: -1
      name: Verify Add Attribute Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "65"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.Distribution
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Value
            iscontext: true
          right:
            value:
              simple: "10"
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.EventID
            iscontext: true
          right:
            value:
              simple: ${MISP.Event.ID}
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.LastChanged
            iscontext: true
      - - operator: isFalse
          left:
            value:
              simple: MISP.Attribute.Deleted
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Type
            iscontext: true
          right:
            value:
              simple: other
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.UUID
            iscontext: true
      - - operator: isTrue
          left:
            value:
              simple: MISP.Attribute.ToIDs
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Category
            iscontext: true
          right:
            value:
              simple: External analysis
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Comment
            iscontext: true
          right:
            value:
              simple: test-add-attribute
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Event.ID
            iscontext: true
          right:
            value:
              simple: ${MISP.Event.ID}
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Event.Distribution
            iscontext: true
          right:
            value:
              simple: "0"
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Event.Info
            iscontext: true
          right:
            value:
              simple: TPB-New-Event
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.Event.UUID
            iscontext: true
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1565
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: e63077a6-4731-474a-8d8f-6b10fea04def
    type: regular
    task:
      id: e63077a6-4731-474a-8d8f-6b10fea04def
      version: -1
      name: misp-add-tag-to-event
      script: '|||misp-add-tag-to-event'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      tag:
        simple: EventTag
      uuid:
        simple: ${MISP.Event.UUID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 6055
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 6f33737e-d07d-462f-899c-6ce16554709a
    type: condition
    task:
      id: 6f33737e-d07d-462f-899c-6ce16554709a
      version: -1
      name: Verify Event Tags
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "60"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Info
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.UUID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Analysis
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Event.Tag.Name
            iscontext: true
          right:
            value:
              simple: EventTag
      - - operator: isFalse
          left:
            value:
              simple: MISP.Event.Tag.is_galaxy
            iscontext: true
    view: |-
      {
        "position": {
          "x": 910,
          "y": 6230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: 9bb89ca9-6dcd-46aa-8146-0631ef210beb
    type: regular
    task:
      id: 9bb89ca9-6dcd-46aa-8146-0631ef210beb
      version: -1
      name: misp-add-tag-to-attribute
      script: '|||misp-add-tag-to-attribute'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      tag:
        simple: TestPlaybook
      uuid:
        simple: ${MISP.Attribute.UUID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 88bf5560-77a6-4aef-8702-5940cd9a8f6a
    type: condition
    task:
      id: 88bf5560-77a6-4aef-8702-5940cd9a8f6a
      version: -1
      name: Verify Attribute Tags
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "61"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Value
            iscontext: true
          right:
            value:
              simple: "10"
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.UUID
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Tag.Name
            iscontext: true
          right:
            value:
              simple: TestPlaybook
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2440
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: 28298ac2-0780-48ae-851e-7dcca8719eb6
    type: regular
    task:
      id: 28298ac2-0780-48ae-851e-7dcca8719eb6
      version: -1
      name: misp-add-sighting
      script: '|||misp-add-sighting'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      id:
        simple: ${MISP.Attribute.ID}
      type:
        simple: sighting
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2265
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: dd064a0c-bab7-4f2c-814c-ac5074b16252
    type: regular
    task:
      id: dd064a0c-bab7-4f2c-814c-ac5074b16252
      version: -1
      name: misp-add-events-from-feed
      script: '|||misp-add-events-from-feed'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "62"
    scriptarguments:
      feed:
        simple: Botvrij.eu
      limit:
        simple: "0"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 4015
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: 38eb3bc5-418d-496e-8f2e-0f171746bf8b
    type: regular
    task:
      id: 38eb3bc5-418d-496e-8f2e-0f171746bf8b
      version: -1
      name: misp-add-file-object
      script: '|||misp-add-file-object'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "59"
    scriptarguments:
      entry_id:
        simple: ${File.EntryID}
      event_id:
        simple: ${MISP.Event.ID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 8685
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: 491e5a32-f005-4f84-8de7-2488cdea7eb9
    type: regular
    task:
      id: 491e5a32-f005-4f84-8de7-2488cdea7eb9
      version: -1
      name: misp-add-domain-object
      script: '|||misp-add-domain-object'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      dns:
        simple: 2.2.2.2
      event_id:
        simple: ${MISP.Event.ID}
      ip:
        simple: 2.2.2.2
      name:
        simple: example.com
      text:
        simple: DomainTPB
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 8160
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: 44f9194f-a01b-45a0-8656-7074e315aa5d
    type: condition
    task:
      id: 44f9194f-a01b-45a0-8656-7074e315aa5d
      version: -1
      name: Verify Domain Obj Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "58"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.ID
            iscontext: true
      - - operator: in
          left:
            value:
              simple: domain-ip
          right:
            value:
              simple: MISP.Event.Object.Name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.UUID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.Description
            iscontext: true
      - - operator: in
          left:
            value:
              simple: 2.2.2.2
          right:
            value:
              simple: ${MISP.Event.Object.Attribute.Value}
            iscontext: true
      - - operator: in
          left:
            value:
              simple: example.com
          right:
            value:
              simple: ${MISP.Event.Object.Attribute.Value}
            iscontext: true
      - - operator: in
          left:
            value:
              simple: DomainTPB
          right:
            value:
              simple: ${MISP.Event.Object.Attribute.Value}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 910,
          "y": 8335
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: 17093871-9901-4140-8cdb-09f8f0ea58eb
    type: regular
    task:
      id: 17093871-9901-4140-8cdb-09f8f0ea58eb
      version: -1
      name: misp-add-url-object
      script: '|||misp-add-url-object'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "48"
    scriptarguments:
      event_id:
        simple: ${MISP.Event.ID}
      text:
        simple: URLTPB
      url:
        simple: www.example.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 7810
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: 72780275-2e96-41eb-89b3-32651c7a1677
    type: regular
    task:
      id: 72780275-2e96-41eb-89b3-32651c7a1677
      version: -1
      name: misp-add-object
      script: '|||misp-add-object'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "57"
    scriptarguments:
      attributes:
        simple: '{''description'': ''Manager Ferrari'', ''make'': ''Ferrari'', ''model'':
          ''308 GTS''}'
      event_id:
        simple: ${MISP.Event.ID}
      template:
        simple: vehicle
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 7460
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: 100dcbd4-266c-4603-8842-c7edc5ecbb56
    type: regular
    task:
      id: 100dcbd4-266c-4603-8842-c7edc5ecbb56
      version: -1
      name: misp-add-ip-object
      script: '|||misp-add-ip-object'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "56"
    scriptarguments:
      event_id:
        simple: ${MISP.Event.ID}
      ip:
        simple: 3.3.3.3
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 6580
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: f1d6619a-43b9-478e-8df8-9f9f94825031
    type: regular
    task:
      id: f1d6619a-43b9-478e-8df8-9f9f94825031
      version: -1
      name: misp-search-attributes only values
      script: '|||misp-search-attributes'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "37"
    scriptarguments:
      compact:
        simple: "true"
      type:
        simple: other
      value:
        simple: "10"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2965
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: 856acbdd-596f-40e6-8a6d-733dfce6fc68
    type: condition
    task:
      id: 856acbdd-596f-40e6-8a6d-733dfce6fc68
      version: -1
      name: Verify Search Attribute Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "42"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: in
          left:
            value:
              simple: "10"
          right:
            value:
              simple: ${MISP.Attribute}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: 79acf29a-5ab7-4543-8575-2f9f91c70455
    type: title
    task:
      id: 79acf29a-5ab7-4543-8575-2f9f91c70455
      version: -1
      name: Test Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 9210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: 0c0b8c39-25ee-474f-8062-c72c1280dfd0
    type: regular
    task:
      id: 0c0b8c39-25ee-474f-8062-c72c1280dfd0
      version: -1
      name: misp-search-attributes full output
      script: '|||misp-search-attributes'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "40"
    scriptarguments:
      compact:
        simple: "false"
      include_sightings:
        simple: "true"
      limit:
        simple: "1"
      page:
        simple: "1"
      type:
        simple: other
      value:
        simple: "10"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3490
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: 04753211-51f0-4e4d-83dc-58f185398a24
    type: condition
    task:
      id: 04753211-51f0-4e4d-83dc-58f185398a24
      version: -1
      name: Verify Search Attribute Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "67"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.Distribution
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Value
            iscontext: true
          right:
            value:
              simple: "10"
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.EventID
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Type
            iscontext: true
          right:
            value:
              simple: other
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.UUID
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Category
            iscontext: true
          right:
            value:
              simple: Person
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Comment
            iscontext: true
          right:
            value:
              simple: updated comment
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.Event.ID
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Event.Info
            iscontext: true
          right:
            value:
              simple: TPB-New-Event
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.Event.UUID
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Sighting.Type
            iscontext: true
          right:
            value:
              simple: "0"
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3665
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: daa9d583-de91-4fb1-8f4b-759b7cce9cba
    type: regular
    task:
      id: daa9d583-de91-4fb1-8f4b-759b7cce9cba
      version: -1
      name: Delete Attribute Context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      key:
        simple: MISP.Attribute
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2790
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: 7f6a6e83-4803-4f50-8a88-f631e7f4f96f
    type: regular
    task:
      id: 7f6a6e83-4803-4f50-8a88-f631e7f4f96f
      version: -1
      name: Delete Attribute Context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "39"
    scriptarguments:
      key:
        simple: MISP.Attribute
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3315
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: 3ce88ba9-04a2-4ad0-863b-537622faf313
    type: regular
    task:
      id: 3ce88ba9-04a2-4ad0-863b-537622faf313
      version: -1
      name: 'misp-add-attribute domain '
      script: '|||misp-add-attribute'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      event_id:
        simple: ${MISP.Event.ID}
      value:
        simple: google.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4860
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "44":
    id: "44"
    taskid: ab05194a-c67a-47a8-8a3a-25c27db7fa3d
    type: regular
    task:
      id: ab05194a-c67a-47a8-8a3a-25c27db7fa3d
      version: -1
      name: 'misp-add-attribute email '
      script: '|||misp-add-attribute'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      event_id:
        simple: ${MISP.Event.ID}
      value:
        simple: email@email.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4860
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: a10ffde3-19a9-44c6-8cb6-114970deea38
    type: regular
    task:
      id: a10ffde3-19a9-44c6-8cb6-114970deea38
      version: -1
      name: 'misp-add-attribute file '
      script: '|||misp-add-attribute'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      event_id:
        simple: ${MISP.Event.ID}
      value:
        simple: 098f6bcd4621d373cade4e832627b4f6
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 4860
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: 62a4e9e0-6805-4070-8535-aad00f0c787f
    type: regular
    task:
      id: 62a4e9e0-6805-4070-8535-aad00f0c787f
      version: -1
      name: 'misp-add-attribute ip '
      script: '|||misp-add-attribute'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      event_id:
        simple: ${MISP.Event.ID}
      value:
        simple: 1.2.3.4
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 4860
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: d661ea60-5c8c-4246-8f65-263caa29f788
    type: regular
    task:
      id: d661ea60-5c8c-4246-8f65-263caa29f788
      version: -1
      name: misp-add-attribute url
      script: '|||misp-add-attribute'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      event_id:
        simple: ${MISP.Event.ID}
      value:
        simple: www.example.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 4860
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: ad9772ab-96c2-46b9-8cfd-384dc3a51c87
    type: condition
    task:
      id: ad9772ab-96c2-46b9-8cfd-384dc3a51c87
      version: -1
      name: Verify URL Obj Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "28"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.MetaCategory
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.Distribution
            iscontext: true
      - - operator: in
          left:
            value:
              simple: url
          right:
            value:
              simple: ${MISP.Event.Object.Name}
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.UUID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.Description
            iscontext: true
      - - operator: in
          left:
            value:
              simple: www.example.com
          right:
            value:
              simple: ${MISP.Event.Object.Attribute.Value}
            iscontext: true
      - - operator: in
          left:
            value:
              simple: www.example.com
          right:
            value:
              simple: ${MISP.Event.Object.Attribute.Value}
            iscontext: true
      - - operator: in
          left:
            value:
              simple: URLTPB
          right:
            value:
              simple: ${MISP.Event.Object.Attribute.Value}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 910,
          "y": 7980
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: f4839d34-abbb-4b6a-88c1-30ee794cd9ec
    type: title
    task:
      id: f4839d34-abbb-4b6a-88c1-30ee794cd9ec
      version: -1
      name: Reputation Commands
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "43"
      - "44"
      - "45"
      - "46"
      - "47"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 4715
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: a45022e4-a2b1-4f5f-86fa-ee5252a96351
    type: title
    task:
      id: a45022e4-a2b1-4f5f-86fa-ee5252a96351
      version: -1
      name: MISP Commands
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: 62ca3c3e-f589-42d7-8a01-86a332030af3
    type: regular
    task:
      id: 62ca3c3e-f589-42d7-8a01-86a332030af3
      version: -1
      name: Delete Event
      description: Deletes an event according to the given event ID.
      script: '|||misp-delete-event'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "52"
    scriptarguments:
      event_id:
        simple: ${MISP.Event.ID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 5385
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "52":
    id: "52"
    taskid: aa9501d6-f5ab-4493-8306-c818641f9336
    type: title
    task:
      id: aa9501d6-f5ab-4493-8306-c818641f9336
      version: -1
      name: Object Commands
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "53"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 5560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: 0e522902-f742-4bcf-8d04-6fca7bd28903
    type: regular
    task:
      id: 0e522902-f742-4bcf-8d04-6fca7bd28903
      version: -1
      name: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "55"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 5705
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "54":
    id: "54"
    taskid: 9918fe22-f92a-4603-890e-b8954558be4c
    type: regular
    task:
      id: 9918fe22-f92a-4603-890e-b8954558be4c
      version: -1
      name: Delete Event
      description: Deletes an event according to the given event ID.
      script: '|||misp-delete-event'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "38"
    scriptarguments:
      event_id:
        simple: ${MISP.Event.ID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 9035
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "55":
    id: "55"
    taskid: dcd6965c-059e-444a-8070-2eaf9f7511ee
    type: regular
    task:
      id: dcd6965c-059e-444a-8070-2eaf9f7511ee
      version: -1
      name: misp-create-event
      script: '|||misp-create-event'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      info:
        simple: TPB-New-Event
      threat_level_id:
        simple: Low
      value:
        simple: 1.1.1.1
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 5880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "56":
    id: "56"
    taskid: 783afa31-6ae7-4750-8947-1b0f89e05717
    type: condition
    task:
      id: 783afa31-6ae7-4750-8947-1b0f89e05717
      version: -1
      name: Verify IP Obj Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "69"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.MetaCategory
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.Distribution
            iscontext: true
      - - operator: in
          left:
            value:
              simple: ip-port
          right:
            value:
              simple: ${MISP.Event.Object.Name}
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.UUID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.Description
            iscontext: true
      - - operator: in
          left:
            value:
              simple: 3.3.3.3
          right:
            value:
              simple: ${MISP.Event.Object.Attribute.Value}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 910,
          "y": 6755
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "57":
    id: "57"
    taskid: 229c7880-b938-48d3-84b4-8fe8f9b067d2
    type: condition
    task:
      id: 229c7880-b938-48d3-84b4-8fe8f9b067d2
      version: -1
      name: Verify Object Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "30"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.MetaCategory
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.Distribution
            iscontext: true
      - - operator: in
          left:
            value:
              simple: vehicle
          right:
            value:
              simple: MISP.Event.Object.Name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.UUID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.Description
            iscontext: true
      - - operator: in
          left:
            value:
              simple: Manager Ferrari
          right:
            value:
              simple: ${MISP.Event.Object.Attribute.Value}
            iscontext: true
      - - operator: in
          left:
            value:
              simple: Ferrari
          right:
            value:
              simple: ${MISP.Event.Object.Attribute.Value}
            iscontext: true
      - - operator: in
          left:
            value:
              simple: 308 GTS
          right:
            value:
              simple: ${MISP.Event.Object.Attribute.Value}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 910,
          "y": 7635
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "58":
    id: "58"
    taskid: 7105e0ca-eaae-4446-89ca-0e3d1f5d9463
    type: regular
    task:
      id: 7105e0ca-eaae-4446-89ca-0e3d1f5d9463
      version: -1
      name: get file
      description: Sends http request. Returns the response as json.
      scriptName: http
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "26"
    scriptarguments:
      method:
        simple: GET
      saveAsFile:
        simple: "yes"
      url:
        simple: https://github.com/demisto/content/blob/master/TestData/regular_english_file.txt
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 8510
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "59":
    id: "59"
    taskid: f2e0c883-0585-439c-8102-4006610cdd7c
    type: condition
    task:
      id: f2e0c883-0585-439c-8102-4006610cdd7c
      version: -1
      name: Verify File Obj Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "54"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.ID
            iscontext: true
      - - operator: in
          left:
            value:
              simple: file
          right:
            value:
              simple: MISP.Event.Object.Name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.UUID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.Description
            iscontext: true
    view: |-
      {
        "position": {
          "x": 910,
          "y": 8860
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: 46f9c827-b928-4155-8578-7d4e6e678e7d
    type: regular
    task:
      id: 46f9c827-b928-4155-8578-7d4e6e678e7d
      version: -1
      name: Remove Event Tag
      description: Removes a tag from the given UUID event .
      script: '|||misp-remove-tag-from-event'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      tag:
        simple: EventTag
      uuid:
        simple: ${MISP.Event.UUID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 6405
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    id: "61"
    taskid: d29a826a-2d2f-40bf-87d3-3e67026e8f09
    type: regular
    task:
      id: d29a826a-2d2f-40bf-87d3-3e67026e8f09
      version: -1
      name: Remove Attribute Tag
      description: Removes a tag from the given UUID attribute .
      script: '|||misp-remove-tag-from-attribute'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "41"
    scriptarguments:
      tag:
        simple: TestPlaybook
      uuid:
        simple: ${MISP.Attribute.UUID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "62":
    id: "62"
    taskid: 5d106445-20ed-4f46-89ae-919fed32b28e
    type: regular
    task:
      id: 5d106445-20ed-4f46-89ae-919fed32b28e
      version: -1
      name: Delete Event
      description: Deletes an event according to the given event ID.
      script: '|||misp-delete-event'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "64"
    scriptarguments:
      event_id:
        simple: ${MISP.Event.ID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 4190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: 0f6b9453-80f2-431a-824d-f2529911dc71
    type: regular
    task:
      id: 0f6b9453-80f2-431a-824d-f2529911dc71
      version: -1
      name: misp-create-event
      script: '|||misp-create-event'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "49"
    scriptarguments:
      info:
        simple: TPB-New-Event
      threat_level_id:
        simple: Low
      value:
        simple: 1.1.1.1
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 4540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "64":
    id: "64"
    taskid: 76a272b8-8360-4ced-87f5-2f49e85086b7
    type: regular
    task:
      id: 76a272b8-8360-4ced-87f5-2f49e85086b7
      version: -1
      name: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "63"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 4365
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "65":
    id: "65"
    taskid: c087210b-9f3f-409d-83d6-d3b49ffa860b
    type: regular
    task:
      id: c087210b-9f3f-409d-83d6-d3b49ffa860b
      version: -1
      name: Update attribute
      description: Update an attribute of an existing MISP event.
      script: '|||misp-update-attribute'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "66"
    scriptarguments:
      attribute_uuid:
        simple: ${MISP.Attribute.UUID}
      category:
        simple: Person
      comment:
        simple: updated comment
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1740
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "66":
    id: "66"
    taskid: df0682d2-1c61-4537-88ff-75e77569645c
    type: condition
    task:
      id: df0682d2-1c61-4537-88ff-75e77569645c
      version: -1
      name: Verify Update Attribute Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "21"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.Distribution
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Value
            iscontext: true
          right:
            value:
              simple: "10"
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.EventID
            iscontext: true
          right:
            value:
              simple: ${MISP.Event.ID}
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.LastChanged
            iscontext: true
      - - operator: isFalse
          left:
            value:
              simple: MISP.Attribute.Deleted
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Type
            iscontext: true
          right:
            value:
              simple: other
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.UUID
            iscontext: true
      - - operator: isTrue
          left:
            value:
              simple: MISP.Attribute.ToIDs
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Category
            iscontext: true
          right:
            value:
              simple: Person
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Comment
            iscontext: true
          right:
            value:
              simple: updated comment
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Event.ID
            iscontext: true
          right:
            value:
              simple: ${MISP.Event.ID}
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Event.Distribution
            iscontext: true
          right:
            value:
              simple: "0"
      - - operator: isEqualString
          left:
            value:
              simple: MISP.Attribute.Event.Info
            iscontext: true
          right:
            value:
              simple: TPB-New-Event
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Attribute.Event.UUID
            iscontext: true
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "67":
    id: "67"
    taskid: 8b98381d-0c42-490b-8bd2-f616815201b6
    type: regular
    task:
      id: 8b98381d-0c42-490b-8bd2-f616815201b6
      version: -1
      name: Delete Attribute
      description: Delete an attribute according to the given attribute ID.
      script: '|||misp-delete-attribute'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "24"
    scriptarguments:
      attribute_id:
        simple: ${MISP.Attribute.ID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3840
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "68":
    id: "68"
    taskid: 538d3746-85d4-410f-8a8b-0cc9f92296ae
    type: regular
    task:
      id: 538d3746-85d4-410f-8a8b-0cc9f92296ae
      version: -1
      name: misp-publish-event
      description: Publish an event.
      script: '|||misp-publish-event'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "50"
    scriptarguments:
      event_id:
        simple: ${MISP.Event.ID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "69":
    id: "69"
    taskid: 49e9d029-aa5a-4827-8875-60f14689c81a
    type: regular
    task:
      id: 49e9d029-aa5a-4827-8875-60f14689c81a
      version: -1
      name: Get EMail
      description: Sends http request. Returns the response as json.
      scriptName: http
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "70"
    scriptarguments:
      method:
        simple: GET
      saveAsFile:
        simple: "yes"
      url:
        simple: https://raw.githubusercontent.com/demisto/content/master/TestData/CheckEmailAuthenticity_test_mail.eml
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 6935
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "70":
    id: "70"
    taskid: b7da9ae3-66d0-4612-80ed-c682637c2378
    type: regular
    task:
      id: b7da9ae3-66d0-4612-80ed-c682637c2378
      version: -1
      name: Add EMail object
      description: adds an email object to given event id
      script: '|||misp-add-email-object'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "72"
    scriptarguments:
      entry_id:
        simple: ${File.EntryID}
      event_id:
        simple: ${MISP.Event.ID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 7100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "72":
    id: "72"
    taskid: bb958a0f-7979-4ddd-8434-d355cfd73c9a
    type: condition
    task:
      id: bb958a0f-7979-4ddd-8434-d355cfd73c9a
      version: -1
      name: Verify Email Obj Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "32"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.ID
            iscontext: true
          right:
            value: {}
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.MetaCategory
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.Distribution
            iscontext: true
      - - operator: in
          left:
            value:
              simple: email
          right:
            value:
              simple: MISP.Event.Object.Name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.ID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.UUID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: MISP.Event.Object.Description
            iscontext: true
      - - operator: in
          left:
            value:
              simple: Full email.eml
          right:
            value:
              simple: ${MISP.Event.Object.Attribute.Value}
            iscontext: true
      - - operator: in
          left:
            value:
              simple: foo@test.com
          right:
            value:
              simple: ${MISP.Event.Object.Attribute.Value}
    view: |-
      {
        "position": {
          "x": 910,
          "y": 7275
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "29_58_yes": 0.34,
      "48_28_yes": 0.52,
      "56_69_yes": 0.28
    },
    "paper": {
      "dimensions": {
        "height": 9225,
        "width": 2100,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
