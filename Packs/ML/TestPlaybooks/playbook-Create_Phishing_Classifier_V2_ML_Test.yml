id: Create Phishing Classifier V2 ML Test
version: -1
name: Create Phishing Classifier V2 ML Test
description: Test CreatePhishingClassifierML playbook.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 78784216-c485-4b0e-8a76-59b41dc3a90f
    type: start
    task:
      id: 78784216-c485-4b0e-8a76-59b41dc3a90f
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "6"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: 22c9ea27-2fd5-4d40-8863-229dc43f3b48
    type: regular
    task:
      id: 22c9ea27-2fd5-4d40-8863-229dc43f3b48
      version: -1
      name: Create incidents
      scriptName: TestCreateIncidentsForPhishingClassifier
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      historicListName:
        simple: test_phishing_historic_data
      numberOfIncidents:
        simple: "100"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 69b3af92-e02e-42df-8457-060166618c7e
    type: regular
    task:
      id: 69b3af92-e02e-42df-8457-060166618c7e
      version: -1
      name: Predict Tag1
      description: Predict text label using a pre-trained machine learning phishing model, and get the most important words used in the classification decision.
      scriptName: DBotPredictPhishingWords
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      emailSubject:
        simple: |-
          closed church squeamish squeamish moaning closed closed closed church squeamish squeamish moaning closed closed closed church squeamish squeamish moaning closed closed
          Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed viverra nunc sit amet elit rutrum tempor.
          fall
      labelProbabilityThreshold:
        simple: "0"
      minTextLength:
        simple: "0"
      modelName:
        simple: test_phishing_model
      modelStoreType:
        simple: mlModel
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 204180fd-5f72-4968-8e8c-c4fa68a2cf50
    type: title
    task:
      id: 204180fd-5f72-4968-8e8c-c4fa68a2cf50
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 379f5987-21fa-48e7-8009-0f259984eb50
    type: regular
    task:
      id: 379f5987-21fa-48e7-8009-0f259984eb50
      version: -1
      name: Clear context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 29c71c43-3214-4f4f-816a-3b71511bb21b
    type: regular
    task:
      id: 29c71c43-3214-4f4f-816a-3b71511bb21b
      version: -1
      name: clear context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      key:
        simple: DBotPredictPhishingWords
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: 056e0f50-15a3-4976-877f-992283bb1a6f
    type: playbook
    task:
      id: 056e0f50-15a3-4976-877f-992283bb1a6f
      version: -1
      name: DBot Create Phishing Classifier V2
      description: Create a phishing classifier using machine learning technique, based on email content
      playbookName: DBot Create Phishing Classifier V2
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      dedupThreshold:
        simple: "1"
      emailSubjectKey:
        simple: ${EmailSujbectKey}
      emailTagKey:
        simple: ${EmailTagKey}
      emailTextKey:
        simple: ${EmailBodyKey}
      historicalDataFileListName:
        simple: test_phishing_historic_data
      incidentTypes:
        simple: Simulation
      incidentsQuery:
        simple: ${IncidentsQuery}
      maxIncidentsToFetchOnTraining:
        simple: "3000"
      modelName:
        simple: test_phishing_model
      overrideModel:
        simple: "true"
      phishingLabels:
        simple: '*'
      removeShortTextThreshold:
        simple: "15"
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 50,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: c971bebc-164a-43dd-84f1-751002187ec8
    type: condition
    task:
      id: c971bebc-164a-43dd-84f1-751002187ec8
      version: -1
      name: Model evaluation exist
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "3"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotPhishingClassifier.EvaluationScores.Precision.All
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: bfc6345f-19ec-4f66-810b-44109a362a08
    type: condition
    task:
      id: bfc6345f-19ec-4f66-810b-44109a362a08
      version: -1
      name: 'Check the prediction label: Tag1'
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "8"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DBotPredictPhishingWords.Label
            iscontext: true
          right:
            value:
              simple: Tag1
      - - operator: isEqualNumber
          left:
            value:
              simple: DBotPredictPhishingWords.Probability
            iscontext: true
          right:
            value:
              simple: "0.9930823445320129"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: a995bdfc-5c08-4fc8-8d2a-146274de35d9
    type: condition
    task:
      id: a995bdfc-5c08-4fc8-8d2a-146274de35d9
      version: -1
      name: 'Check the prediction label: Tag2'
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "19"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DBotPredictPhishingWords.Label
            iscontext: true
          right:
            value:
              simple: Tag2
      - - operator: isEqualNumber
          left:
            value:
              simple: DBotPredictPhishingWords.Probability
            iscontext: true
          right:
            value:
              simple: "0.9941679239273071"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: 746ca330-8d8e-4d0f-8bdf-fae786b24e0e
    type: regular
    task:
      id: 746ca330-8d8e-4d0f-8bdf-fae786b24e0e
      version: -1
      name: Predict Tag2
      description: Predict text label using a pre-trained machine learning phishing model, and get the most important words used in the classification decision.
      scriptName: DBotPredictPhishingWords
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      emailSubject:
        simple: |-
          ntidy boy substance faulty waves type boat argument ntidy boy substance faulty waves type boat argument ntidy boy substance faulty waves type boat argument
          Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed viverra nunc sit amet elit rutrum tempor.
          closed
      labelProbabilityThreshold:
        simple: "0"
      minTextLength:
        simple: "0"
      modelName:
        simple: test_phishing_model
      modelStoreType:
        simple: mlModel
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: c4dda492-d53f-4483-8571-c926877e47df
    type: regular
    task:
      id: c4dda492-d53f-4483-8571-c926877e47df
      version: -1
      name: Predict Tag3
      description: Predict text label using a pre-trained machine learning phishing model, and get the most important words used in the classification decision.
      scriptName: DBotPredictPhishingWords
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      emailSubject:
        simple: |-
          suspend trucks aboriginal thread succeed gray last fall fall suspend trucks aboriginal thread succeed gray last fall fall suspend trucks aboriginal thread succeed gray last fall fall
          Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed viverra nunc sit amet elit rutrum tempor.
          boat
      labelProbabilityThreshold:
        simple: "0"
      minTextLength:
        simple: "0"
      modelName:
        simple: test_phishing_model
      modelStoreType:
        simple: mlModel
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: 482bab55-0675-4605-8c29-c28c3804836c
    type: regular
    task:
      id: 482bab55-0675-4605-8c29-c28c3804836c
      version: -1
      name: clear context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      key:
        simple: DBotPredictPhishingWords
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: df8d8ae6-eea4-40d0-8bce-f614ef5f9522
    type: condition
    task:
      id: df8d8ae6-eea4-40d0-8bce-f614ef5f9522
      version: -1
      name: 'Check the prediction label: Tag3'
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "5"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DBotPredictPhishingWords.Label
            iscontext: true
          right:
            value:
              simple: Tag3
      - - operator: isEqualNumber
          left:
            value:
              simple: DBotPredictPhishingWords.Probability
            iscontext: true
          right:
            value:
              simple: "0.9955088496208191"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0

    continueonerrortype: ""
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2310,
        "width": 380,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
fromversion: 6.1.0
