commonfields:
  id: IAMShowUserApplications
  version: -1
name: IAMShowUserApplications
comment: Displays the applications that the user is synced in.
script: |2-

  APPLICATIONS_HEADER = ['Brand', 'Instance Name', 'User ID', 'Active']


  user_applications = demisto.get(demisto.args()['indicator'], "CustomFields.applications")

  if user_applications:
      try:
          user_applications = json.loads(user_applications)
          md = tableToMarkdown(
          name='  ',
          t=user_applications,
          headers= APPLICATIONS_HEADER,
          headerTransform=string_to_table_header,
          removeNull=True,)
      except Exception:
          md = user_applications

      return_results(CommandResults(readable_output=md))

  else:
      return_results("The user doesn't seem to be synced into any application at the moment. This will update when IAM - App Add, IAM - App Remove or IAM - App Update incidents occur.")
type: python
tags:
- IAM
- dynamic-indicator-section
enabled: true
scripttarget: 0
subtype: python3
runonce: false
dockerimage: demisto/python3:3.10.12.68300
runas: DBotWeakRole
fromversion: 6.0.0
tests:
- No tests (auto formatted)
