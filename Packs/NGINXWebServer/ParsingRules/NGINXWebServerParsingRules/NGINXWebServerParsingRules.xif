[INGEST:vendor="nginx", product="nginx", target_dataset="nginx_nginx_raw", no_hit=drop]
alter
    date_part1 = arraystring(regextract(_raw_log, "^\d{4}\/\d{2}\/\d{2}"), ""),
    time_part1 = arraystring(regextract(_raw_log, "\s(\d{2}\:\d{2}\:\d{2})\s"), ""),
    date_part2 = arraystring(regextract(_raw_log, "\[(\d{2}\/\w{3}\/\d{4})\:"), ""),
    time_part2 = arraystring(regextract(_raw_log, "\:(\d{2}\:\d{2}\:\d{2})\s"), "")
| alter
    timestamp1 = arraystring(arraycreate(date_part1, time_part1), " "),
    timestamp2 = arraystring(arraycreate(date_part2, time_part2), " ")
| alter _time = if(_raw_log ~= "^\d{4}", parse_timestamp("%Y/%m/%d %H:%M:%S", timestamp1), parse_timestamp("%d/%b/%Y %H:%M:%S", timestamp2));