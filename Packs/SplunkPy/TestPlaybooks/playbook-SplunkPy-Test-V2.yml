id: SplunkPy-Test-V2
version: -1
contentitemfields:
  propagationLabels: []
name: SplunkPy-Test-V2
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 0c9197be-b879-4240-84b8-89eb77fa6bab
    type: start
    task:
      id: 0c9197be-b879-4240-84b8-89eb77fa6bab
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    continueonerrortype: ""
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: b919ae77-337d-4054-831f-bd369f23d2b5
    type: regular
    task:
      id: b919ae77-337d-4054-831f-bd369f23d2b5
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
      - "3"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    continueonerrortype: ""
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: ebce15e5-2050-4cbc-8d05-8b9acf0e839d
    type: regular
    task:
      id: ebce15e5-2050-4cbc-8d05-8b9acf0e839d
      version: -1
      name: Splunk search with app
      description: Searches Splunk for events.
      script: '|||splunk-search'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      app:
        simple: demisto
      earliest_time:
        simple: -10d
      event_limit:
        simple: "1"
      query:
        simple: sourcetype=*
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 770,
          "y": 380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    continueonerrortype: ""
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: c7fef74f-bd17-4cf9-8ab0-0a196135511f
    type: regular
    task:
      id: c7fef74f-bd17-4cf9-8ab0-0a196135511f
      version: -1
      name: Splunk search
      description: Searches Splunk for events.
      script: '|||splunk-search'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      earliest_time:
        simple: -1500d
      query:
        simple: '* | head 3'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 130,
          "y": 380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    continueonerrortype: ""
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 3004c2c3-6ff2-42c3-829b-2abc0a0b2c30
    type: condition
    task:
      id: 3004c2c3-6ff2-42c3-829b-2abc0a0b2c30
      version: -1
      name: 'Verify Context '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "6"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Splunk.Result.app
            iscontext: true
          right:
            value:
              simple: demisto
    view: |-
      {
        "position": {
          "x": 770,
          "y": 570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    continueonerrortype: ""
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 29b4d1b0-6391-430d-8c72-3c2ab6b46ad8
    type: condition
    task:
      id: 29b4d1b0-6391-430d-8c72-3c2ab6b46ad8
      version: -1
      name: Verify Context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "6"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: Splunk.Result
            iscontext: true
    view: |-
      {
        "position": {
          "x": 130,
          "y": 570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    continueonerrortype: ""
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: f3d76a1d-fbee-4e62-818a-1293e2bbee11
    type: regular
    task:
      id: f3d76a1d-fbee-4e62-818a-1293e2bbee11
      version: -1
      name: Get splunk indexes
      description: Prints all Splunk index names.
      script: '|||splunk-get-indexes'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "7"
      - "9"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    continueonerrortype: ""
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: 97374661-a394-4fe6-8c58-0925a1860cc8
    type: regular
    task:
      id: 97374661-a394-4fe6-8c58-0925a1860cc8
      version: -1
      name: Splunk Create job
      description: Creates a new search job in Splunk.
      script: '|||splunk-job-create'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      query:
        simple: sourcetype=pan:threat
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 60,
          "y": 1000
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    continueonerrortype: ""
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: e12d88ff-4169-4875-8aa8-de299613b1ca
    type: regular
    task:
      id: e12d88ff-4169-4875-8aa8-de299613b1ca
      version: -1
      name: Get job results
      description: Returns the results of a previous Splunk search. You can use this command in conjunction with the splunk-job-create command.
      script: '|||splunk-results'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      sid:
        simple: ${Splunk.Job}
      limit:
        simple: "200"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 60,
          "y": 1330
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    continueonerrortype: ""
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: 0b981592-355d-4c2c-8599-4bd74eb72f29
    type: regular
    task:
      id: 0b981592-355d-4c2c-8599-4bd74eb72f29
      version: -1
      name: Submit event
      description: Creates a new event in Splunk.
      script: '|||splunk-submit-event'
      type: regular
      iscommand: true
      brand: ""
    scriptarguments:
      data:
        simple: test
      host:
        simple: localhost
      index:
        simple: main
      sourcetype:
        simple: demisto-ci
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 900,
          "y": 1000
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    continueonerrortype: ""
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: 0a77fd47-c1fa-4ae1-80bc-35cb00384832
    type: regular
    task:
      id: 0a77fd47-c1fa-4ae1-80bc-35cb00384832
      version: -1
      name: Parse raw
      description: Parses the raw part of the event.
      script: '|||splunk-parse-raw'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 60,
          "y": 1500
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    continueonerrortype: ""
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 276e2ea7-8df1-42cc-88a8-03e13e251496
    type: condition
    task:
      id: 276e2ea7-8df1-42cc-88a8-03e13e251496
      version: -1
      name: Verify Context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "12"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: Splunk.Raw.Parsed
            iscontext: true
    view: |-
      {
        "position": {
          "x": 60,
          "y": 1650
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    continueonerrortype: ""
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: ab619d81-14e1-4105-83f5-16a09963fd18
    type: regular
    task:
      id: ab619d81-14e1-4105-83f5-16a09963fd18
      version: -1
      name: Add raw data
      description: Sets a value into the context with the given context key
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      key:
        simple: rawEvent
      value:
        simple: 1531041382, search_name="0 - Azure AD-Concurrent Access From Different GEO", logon_ip="xx.xx.xx.xx", logon_ip="xx.xx.xx.xx", logon_ip="xx.xx.xx.xx", logon_source_Country="Egypt", logon_source_Country="Germany", logon_source_info="Potentially_unauthorized", logon_source_info="VPN", timestamps="2018-07-08T08:22:41", timestamps="2018-07-08T08:28:50", timestamps="2018-07-08T08:35:31", country_count="2", country_in_AD="United Arab Emirates", info_max_time="+Infinity", info_min_time="0.000", muid="xx.xx.xx.xx", service="AzureActiveDirectory", user="xx.xx.xx.xx", user_type="A regular user", users_bunit="xx.xx.xx.xx"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 60,
          "y": 1830
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    continueonerrortype: ""
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: fadc0714-a55f-4a82-8d3f-50b933a5508f
    type: regular
    task:
      id: fadc0714-a55f-4a82-8d3f-50b933a5508f
      version: -1
      name: Parse raw example
      description: Parses the raw part of the event.
      script: '|||splunk-parse-raw'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      raw:
        simple: ${rawEvent}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 60,
          "y": 1990
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    continueonerrortype: ""
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 8c0ab759-6fcb-4342-864d-c5d5a4ab4948
    type: condition
    task:
      id: 8c0ab759-6fcb-4342-864d-c5d5a4ab4948
      version: -1
      name: Is the raw parsed?
      description: Check whether the values provided in arguments are equal. If either of the arguments are missing, no is returned.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "no":
      - "16"
      "yes":
      - "15"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: Splunk.Raw.Parsed
            iscontext: true
    view: |-
      {
        "position": {
          "x": 60,
          "y": 2150
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    continueonerrortype: ""
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 1600607d-9805-4fda-8220-11bd24b64b5f
    type: title
    task:
      id: 1600607d-9805-4fda-8220-11bd24b64b5f
      version: -1
      name: Success!
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -170,
          "y": 2335
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    continueonerrortype: ""
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: ca126cb6-16da-4b84-89bb-d73758e41a4e
    type: regular
    task:
      id: ca126cb6-16da-4b84-89bb-d73758e41a4e
      version: -1
      name: Oh No
      description: Prints text to war room (Markdown supported)
      scriptName: Print
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      value:
        simple: Something went wrong
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 330,
          "y": 2335
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    continueonerrortype: ""
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: 1aad8fa0-2d26-4a25-828e-6b05f5c5b1fd
    type: regular
    task:
      id: 1aad8fa0-2d26-4a25-828e-6b05f5c5b1fd
      version: -1
      name: splunk-job-status
      description: checking the status of a job
      script: '|||splunk-job-status'
      type: regular
      iscommand: true
      brand: SplunkPy
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      sid:
        simple: ${Splunk.Job}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 60,
          "y": 1165
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    continueonerrortype: ""
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2380,
        "width": 1450,
        "x": -170,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
fromversion: 5.0.0
description: ''
