id: BlockExternalIP - Test
version: -1
name: BlockExternalIP - Test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 4d5d93e9-fb25-4532-8f22-b9971449719d
    type: start
    task:
      id: 4d5d93e9-fb25-4532-8f22-b9971449719d
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: e9793f0a-0ab7-4a31-8f6e-c3dd3b628559
    type: regular
    task:
      id: e9793f0a-0ab7-4a31-8f6e-c3dd3b628559
      version: -1
      name: CIsco ASA list rules
      description: Gets a list all rules for the supplied interface.
      script: '|||cisco-asa-list-rules'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: f31513dc-b86e-4c3c-81da-6df2aa59561c
    type: title
    task:
      id: f31513dc-b86e-4c3c-81da-6df2aa59561c
      version: -1
      name: Prepare CiscoASA
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 7b3041ec-b30c-41d0-8c6a-44635b31d835
    type: condition
    task:
      id: 7b3041ec-b30c-41d0-8c6a-44635b31d835
      version: -1
      name: Does rule exist?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "4"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: CiscoASA.Rules.Dest
            iscontext: true
          right:
            value:
              simple: 8.8.8.8
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: ce840a85-e0e0-4ce5-8fdf-78d5aa0fa90d
    type: regular
    task:
      id: ce840a85-e0e0-4ce5-8fdf-78d5aa0fa90d
      version: -1
      name: Remove rule if exist
      description: Deletes a rule.
      script: '|||cisco-asa-delete-rule'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      interface_type:
        complex:
          root: CiscoASA.Rules
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: CiscoASA.Rules.Dest
                iscontext: true
              right:
                value:
                  simple: 8.8.8.8
          accessor: InterfaceType
      rule_id:
        complex:
          root: CiscoASA.Rules
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: CiscoASA.Rules.Dest
                iscontext: true
              right:
                value:
                  simple: 8.8.8.8
          accessor: ID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 710
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 8763ecaf-b69e-458b-8fec-f6107f62af58
    type: title
    task:
      id: 8763ecaf-b69e-458b-8fec-f6107f62af58
      version: -1
      name: 'Case 1: Running with cisco ASA twice'
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 3df25898-b14b-4cb4-89dc-26894c32d2fe
    type: regular
    task:
      id: 3df25898-b14b-4cb4-89dc-26894c32d2fe
      version: -1
      name: BlockExternalIP
      description: The script blocks a list of IP addresses in supported integrations.
      scriptName: block-external-ip
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      brands:
        simple: Cisco ASA
      ip_list:
        simple: 8.8.8.8
    results:
    - push_job_id
    - commit_job_id
    - panorama_responses
    - executed_brands
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: f6ee106c-ad3f-44d8-889c-aefe4ebe13a9
    type: condition
    task:
      id: f6ee106c-ad3f-44d8-889c-aefe4ebe13a9
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "8"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: BlockExternalIPResults.Result
            iscontext: true
          right:
            value:
              simple: Success
      - - operator: isEqualString
          left:
            value:
              simple: BlockExternalIPResults.IP
            iscontext: true
          right:
            value:
              simple: 8.8.8.8
      - - operator: isEqualString
          left:
            value:
              simple: BlockExternalIPResults.Brand
            iscontext: true
          right:
            value:
              simple: Cisco ASA
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 896fbcf3-3afe-49b5-8e32-9538e6b52a19
    type: regular
    task:
      id: 896fbcf3-3afe-49b5-8e32-9538e6b52a19
      version: -1
      name: Clear context
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: 7e1da896-1262-4301-83b8-c9f70931c57e
    type: condition
    task:
      id: 7e1da896-1262-4301-83b8-c9f70931c57e
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "11"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: BlockExternalIPResults.Result
            iscontext: true
          right:
            value:
              simple: Failed
      - - operator: isEqualString
          left:
            value:
              simple: BlockExternalIPResults.IP
            iscontext: true
          right:
            value:
              simple: 8.8.8.8
      - - operator: isEqualString
          left:
            value:
              simple: BlockExternalIPResults.Brand
            iscontext: true
          right:
            value:
              simple: Cisco ASA
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: 267c15ee-ccba-4b3e-816d-1ee9a6b2d703
    type: regular
    task:
      id: 267c15ee-ccba-4b3e-816d-1ee9a6b2d703
      version: -1
      name: BlockExternalIP
      description: The script blocks a list of IP addresses in supported integrations.
      scriptName: block-external-ip
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      brands:
        simple: Cisco ASA
      ip_list:
        simple: 8.8.8.8
    results:
    - push_job_id
    - commit_job_id
    - panorama_responses
    - executed_brands
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 74cc3d55-1694-4859-8776-854daccde516
    type: title
    task:
      id: 74cc3d55-1694-4859-8776-854daccde516
      version: -1
      name: 'Case 2: Run BlockExternalIP with Panorama'
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "27"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: eb9c8ad8-295e-4f20-8159-c0eb99a87002
    type: regular
    task:
      id: eb9c8ad8-295e-4f20-8159-c0eb99a87002
      version: -1
      name: Get Timestamp
      description: |
        Retrieves the current date and time.
      scriptName: GetTime
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: b93e6c00-4352-4bd1-89d2-111040a087b8
    type: regular
    task:
      id: b93e6c00-4352-4bd1-89d2-111040a087b8
      version: -1
      name: BlockExternalIP
      description: The script blocks a list of IP addresses in supported integrations.
      scriptName: block-external-ip
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      address_group:
        simple: test-${TimeNowUnix}
      brands:
        simple: Panorama
      ip_list:
        simple: 1.1.1.1
      rule_name:
        simple: test-${TimeNowUnix}
      tag:
        simple: test-${TimeNowUnix}
    results:
    - push_job_id
    - commit_job_id
    - panorama_responses
    - executed_brands
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: de17242b-c831-4dc6-8d84-5fc97e2ae089
    type: title
    task:
      id: de17242b-c831-4dc6-8d84-5fc97e2ae089
      version: -1
      name: 'Case 3: Running with F5Silverline & tag'
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "28"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2900
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: 897808c7-fee1-4784-87c6-1d37ba122c21
    type: regular
    task:
      id: 897808c7-fee1-4784-87c6-1d37ba122c21
      version: -1
      name: Silverline list ip objects
      description: Gets a dynamic list of threatening IP addresses by the given list
        type.
      script: '|||f5-silverline-ip-objects-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      list_type:
        simple: denylist
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: 3d0a90ee-8981-45bf-8c8b-d047369dd1c2
    type: condition
    task:
      id: 3d0a90ee-8981-45bf-8c8b-d047369dd1c2
      version: -1
      name: Is IP in the list?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "20"
      "yes":
      - "19"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: F5Silverline.IPObjectList.attributes.ip
            iscontext: true
          right:
            value:
              simple: 8.8.8.8/32
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: cbe0df64-7681-411e-89bc-089e631d5b8c
    type: regular
    task:
      id: cbe0df64-7681-411e-89bc-089e631d5b8c
      version: -1
      name: F5 Delete IP from list
      description: Delete an existing particular threatening IP address object by
        its object ID or by its IP address. If both id and ip are given, delete operation
        will be done by the given object_id.
      script: '|||f5-silverline-ip-object-delete'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      list_type:
        simple: denylist
      object_ip:
        simple: 8.8.8.8
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 3570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: bd80a773-7a4a-4b44-8646-241d9d093676
    type: regular
    task:
      id: bd80a773-7a4a-4b44-8646-241d9d093676
      version: -1
      name: BlockExternalIP
      description: The script blocks a list of IP addresses in supported integrations.
      scriptName: block-external-ip
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      brands:
        simple: F5Silverline
      ip_list:
        simple: 8.8.8.8
      tag:
        simple: test
    results:
    - push_job_id
    - commit_job_id
    - panorama_responses
    - executed_brands
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3740
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: 2b7ebcbe-80e1-42b7-84d8-0881c78bc2e9
    type: condition
    task:
      id: 2b7ebcbe-80e1-42b7-84d8-0881c78bc2e9
      version: -1
      name: Verify outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "34"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: BlockExternalIPResults
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: BlockExternalIPResults.Brand
                      iscontext: true
                    right:
                      value:
                        simple: F5Silverline
                accessor: Result
            iscontext: true
          right:
            value:
              simple: Success
      - - operator: containsGeneral
          left:
            value:
              simple: F5Silverline.IPObjectList.attributes.ip
            iscontext: true
          right:
            value:
              simple: 8.8.8.8
      - - operator: isEqualString
          left:
            value:
              complex:
                root: F5Silverline.IPObjectList
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: F5Silverline.IPObjectList.attributes.ip
                      iscontext: true
                    right:
                      value:
                        simple: 8.8.8.8
                accessor: meta.tags
            iscontext: true
          right:
            value:
              simple: test
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4080
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 780af146-ea13-4e50-83c3-54620dd6402a
    type: regular
    task:
      id: 780af146-ea13-4e50-83c3-54620dd6402a
      version: -1
      name: Silverline list ip objects
      description: Gets a dynamic list of threatening IP addresses by the given list
        type.
      script: '|||f5-silverline-ip-objects-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "21"
    scriptarguments:
      list_type:
        simple: denylist
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3910
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: 270ada6e-b102-4868-89d3-bdf7a4351692
    type: title
    task:
      id: 270ada6e-b102-4868-89d3-bdf7a4351692
      version: -1
      name: 'Case 5: non existing IP'
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "33"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5940
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: e22883a1-5a03-42e9-8fb4-23521a00c818
    type: regular
    task:
      id: e22883a1-5a03-42e9-8fb4-23521a00c818
      version: -1
      name: Clear context
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: 158c8deb-583c-40bb-8ea5-598b4a567d4f
    type: regular
    task:
      id: 158c8deb-583c-40bb-8ea5-598b4a567d4f
      version: -1
      name: Clear context
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3060
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: 8c284b10-230d-4381-87fc-5f43268ca89d
    type: condition
    task:
      id: 8c284b10-230d-4381-87fc-5f43268ca89d
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "45"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: BlockExternalIPResults.Result
            iscontext: true
          right:
            value:
              simple: Success
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: 53ab09f2-ce93-40d9-805c-64dbd87280ed
    type: regular
    task:
      id: 53ab09f2-ce93-40d9-805c-64dbd87280ed
      version: -1
      name: BlockExternalIP
      description: The script blocks a list of IP addresses in supported integrations.
      scriptName: block-external-ip
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      brands:
        simple: F5Silverline,Cisco ASA
      ip_list:
        simple: non-existing-ip-list
    results:
    - push_job_id
    - commit_job_id
    - panorama_responses
    - executed_brands
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: 8dfd5ca6-411b-4b74-8977-4ef447bb7ff1
    type: condition
    task:
      id: 8dfd5ca6-411b-4b74-8977-4ef447bb7ff1
      version: -1
      name: Verify outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "32"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: notContainsGeneral
          left:
            value:
              simple: BlockExternalIPResults.Result
            iscontext: true
          right:
            value:
              simple: Success
      - - operator: isEqualString
          left:
            value:
              simple: BlockExternalIPResults.Result
            iscontext: true
          right:
            value:
              simple: Failed
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6440
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: 14aa7f5e-13ed-46bf-87bd-8d9dbb21faa3
    type: title
    task:
      id: 14aa7f5e-13ed-46bf-87bd-8d9dbb21faa3
      version: -1
      name: Finish
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6610
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: d2237dcb-6d60-48df-87ae-2717d3c16e4c
    type: regular
    task:
      id: d2237dcb-6d60-48df-87ae-2717d3c16e4c
      version: -1
      name: Clear context
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: 5134a04f-2f17-48d9-875b-715c4d068652
    type: title
    task:
      id: 5134a04f-2f17-48d9-875b-715c4d068652
      version: -1
      name: 'Case 4: Running with 2 brands'
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "36"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4250
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: 19ce9338-6233-4704-8e17-cb48d4c04e72
    type: regular
    task:
      id: 19ce9338-6233-4704-8e17-cb48d4c04e72
      version: -1
      name: Clear context
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "37"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: 4054f514-234d-4031-84cf-c38e7fbd7913
    type: regular
    task:
      id: 4054f514-234d-4031-84cf-c38e7fbd7913
      version: -1
      name: Silverline list ip objects
      description: Gets a dynamic list of threatening IP addresses by the given list
        type.
      script: '|||f5-silverline-ip-objects-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "38"
    scriptarguments:
      list_type:
        simple: denylist
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4580
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: d07aa729-0c12-4a91-867a-a74d8490b89b
    type: condition
    task:
      id: d07aa729-0c12-4a91-867a-a74d8490b89b
      version: -1
      name: Is IP in the list?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "40"
      "yes":
      - "39"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: F5Silverline.IPObjectList.attributes.ip
            iscontext: true
          right:
            value:
              simple: 8.8.8.8/32
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: 3cbae453-7943-49a1-8755-3130aef00218
    type: regular
    task:
      id: 3cbae453-7943-49a1-8755-3130aef00218
      version: -1
      name: F5 Delete IP from list
      description: Delete an existing particular threatening IP address object by
        its object ID or by its IP address. If both id and ip are given, delete operation
        will be done by the given object_id.
      script: '|||f5-silverline-ip-object-delete'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "40"
    scriptarguments:
      list_type:
        simple: denylist
      object_ip:
        simple: 8.8.8.8
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 4920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: 4fa1ac4e-6494-48ef-815c-447d769dda91
    type: regular
    task:
      id: 4fa1ac4e-6494-48ef-815c-447d769dda91
      version: -1
      name: CIsco ASA list rules
      description: Gets a list all rules for the supplied interface.
      script: '|||cisco-asa-list-rules'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "41"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: 046ae33a-f20b-4147-8737-433105c60ece
    type: condition
    task:
      id: 046ae33a-f20b-4147-8737-433105c60ece
      version: -1
      name: Does rule exist?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "43"
      "yes":
      - "42"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: CiscoASA.Rules.Dest
            iscontext: true
          right:
            value:
              simple: 8.8.8.8
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5260
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: 9cf85875-95d7-4609-88db-3f4b30082458
    type: regular
    task:
      id: 9cf85875-95d7-4609-88db-3f4b30082458
      version: -1
      name: Remove rule if exist
      description: Deletes a rule.
      script: '|||cisco-asa-delete-rule'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "43"
    scriptarguments:
      interface_type:
        complex:
          root: CiscoASA.Rules
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: CiscoASA.Rules.Dest
                iscontext: true
              right:
                value:
                  simple: 8.8.8.8
          accessor: InterfaceType
      rule_id:
        complex:
          root: CiscoASA.Rules
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: CiscoASA.Rules.Dest
                iscontext: true
              right:
                value:
                  simple: 8.8.8.8
          accessor: ID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 5430
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: 625324e1-4f70-49d3-8655-07256f3ae816
    type: regular
    task:
      id: 625324e1-4f70-49d3-8655-07256f3ae816
      version: -1
      name: BlockExternalIP
      description: The script blocks a list of IP addresses in supported integrations.
      scriptName: block-external-ip
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "44"
    scriptarguments:
      brands:
        simple: F5Silverline,Cisco ASA
      ip_list:
        simple: 8.8.8.8
    results:
    - push_job_id
    - commit_job_id
    - panorama_responses
    - executed_brands
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5600
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "44":
    id: "44"
    taskid: 73dba813-cfee-40d6-8dbb-b5ff0a10554c
    type: condition
    task:
      id: 73dba813-cfee-40d6-8dbb-b5ff0a10554c
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "23"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualNumber
          left:
            value:
              complex:
                root: BlockExternalIPResults.Result
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: BlockExternalIPResults.Result
                      iscontext: true
                    right:
                      value:
                        simple: Success
                transformers:
                - operator: count
            iscontext: true
          right:
            value:
              simple: "2"
      - - operator: containsGeneral
          left:
            value:
              simple: BlockExternalIPResults.Brand
            iscontext: true
          right:
            value:
              simple: Cisco ASA
      - - operator: containsGeneral
          left:
            value:
              simple: BlockExternalIPResults.Brand
            iscontext: true
          right:
            value:
              simple: F5Silverline
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: f90bce0a-6012-4972-8329-4b973b190b1f
    type: regular
    task:
      id: f90bce0a-6012-4972-8329-4b973b190b1f
      version: -1
      name: Delete Rule
      description: Deletes a policy rule.
      script: Panorama|||pan-os-delete-rule
      type: regular
      iscommand: true
      brand: Panorama
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      pre_post:
        simple: pre-rulebase
      rulename:
        simple: test-${TimeNowUnix}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "18_19_yes": 0.46,
      "31_32_yes": 0.5,
      "38_39_yes": 0.52,
      "3_4_yes": 0.48,
      "41_42_yes": 0.53,
      "44_23_yes": 0.45,
      "7_8_yes": 0.43,
      "9_11_yes": 0.46
    },
    "paper": {
      "dimensions": {
        "height": 6620,
        "width": 492.5,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
fromversion: 6.10.0
description: ''