id: FileEnrichment - Test
version: -1
vcShouldKeepItemLegacyProdMachine: false
name: FileEnrichment - Test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: d0dcb500-d703-41df-81df-538ebad1ba0c
    type: start
    task:
      id: d0dcb500-d703-41df-81df-538ebad1ba0c
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 058eeda6-b8b3-4350-8724-3f0ad32dc336
    type: regular
    task:
      id: 058eeda6-b8b3-4350-8724-3f0ad32dc336
      version: -1
      name: Delete Context
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "52"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: 8ce4fb1b-ee8d-473d-8a36-906ddaeac579
    type: regular
    task:
      id: 8ce4fb1b-ee8d-473d-8a36-906ddaeac579
      version: -1
      name: Create SHA256
      description: |
        Creating a hash of a given input, support sha1, sha256, sha512, md5 and blake. Wrapper for https://docs.python.org/3/library/hashlib.html.
      scriptName: CreateHash
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      text:
        simple: ${RandomString}
      type:
        simple: sha256
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 710
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: ca6c64f1-935d-4418-8b73-81b1ca01f52d
    type: regular
    task:
      id: ca6c64f1-935d-4418-8b73-81b1ca01f52d
      version: -1
      name: File Enrichment Internal
      description: This script gathers file reputation data from multiple integrations
        and returns a "FileEnrichment" object with consolidated information to the
        context output.
      scriptName: file-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "4"
      - "12"
      - "25"
      - "51"
    scriptarguments:
      file_hash:
        simple: ${CreateHash}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 19cf1724-a6a1-4265-80dc-0ec53e628a21
    type: condition
    task:
      id: 19cf1724-a6a1-4265-80dc-0ec53e628a21
      version: -1
      name: |
        Validate Brand
      description: Pretty-print the contents of the playbook context.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "10"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: FileEnrichment.Brand
            iscontext: true
          right:
            value:
              simple: WildFire-v2
      - - operator: containsGeneral
          left:
            value:
              simple: FileEnrichment.Brand
            iscontext: true
          right:
            value:
              simple: TIM
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 7c31acee-a806-48ae-81cd-ca99fcb50f7f
    type: regular
    task:
      id: 7c31acee-a806-48ae-81cd-ca99fcb50f7f
      version: -1
      name: File Enrichment External
      description: This script gathers file reputation data from multiple integrations
        and returns a "FileEnrichment" object with consolidated information to the
        context output.
      scriptName: file-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "15"
      - "16"
      - "17"
      - "26"
    scriptarguments:
      brands:
        simple: VirusTotal (API v3)
      file_hash:
        simple: ${CreateHash}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: 7e432d7e-f126-44b3-b1ab-b40426204811
    type: regular
    task:
      id: 7e432d7e-f126-44b3-b1ab-b40426204811
      version: -1
      name: Create File Indicator SHA256
      description: commands.local.cmd.new.indicator
      script: Builtin|||createNewIndicator
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      tags:
        simple: FileEnrichmentTest
      type:
        simple: File
      value:
        simple: ${CreateHash}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: 5a2c4c88-ac67-434a-8baf-9d67da59ab10
    type: title
    task:
      id: 5a2c4c88-ac67-434a-8baf-9d67da59ab10
      version: -1
      name: External Enrichment
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 4e0e79d8-37b5-4a68-8ba8-0d47a8e454cb
    type: title
    task:
      id: 4e0e79d8-37b5-4a68-8ba8-0d47a8e454cb
      version: -1
      name: 'Internal Enrichment '
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: 631cfe4c-767b-497c-a58f-0733a499dac2
    type: condition
    task:
      id: 631cfe4c-767b-497c-a58f-0733a499dac2
      version: -1
      name: Validate Indicator
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "10"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: FileEnrichment.SHA256
            iscontext: true
          right:
            value:
              simple: CreateHash
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 3ba4a398-c45c-4c91-b9f4-c063e2881ab7
    type: regular
    task:
      id: 3ba4a398-c45c-4c91-b9f4-c063e2881ab7
      version: -1
      name: Delete Context
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: CreateHash, RandomString
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 9e055155-1b2a-4080-849d-e69f8756c808
    type: condition
    task:
      id: 9e055155-1b2a-4080-849d-e69f8756c808
      version: -1
      name: |
        Validate Brand
      description: Pretty-print the contents of the playbook context.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "18"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: FileEnrichment.Brand
            iscontext: true
          right:
            value:
              simple: VirusTotal (API v3)
      - - operator: containsGeneral
          left:
            value:
              simple: FileEnrichment.Brand
            iscontext: true
          right:
            value:
              simple: TIM
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: 048e6c9d-c88f-4e8a-8c8b-1bda22983e48
    type: condition
    task:
      id: 048e6c9d-c88f-4e8a-8c8b-1bda22983e48
      version: -1
      name: Validate Indicator
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "18"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: FileEnrichment.SHA256
            iscontext: true
          right:
            value:
              simple: CreateHash
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: 6aaf819f-5655-4f85-821b-16208e1af097
    type: condition
    task:
      id: 6aaf819f-5655-4f85-821b-16208e1af097
      version: -1
      name: Validate Score
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "18"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: FileEnrichment.Score
            iscontext: true
          right:
            value:
              simple: "0"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: 3f82c133-4c26-47e4-833d-6c23aee46fb0
    type: title
    task:
      id: 3f82c133-4c26-47e4-833d-6c23aee46fb0
      version: -1
      name: Internal and External Enrichment
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "19"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2060
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: 24d1d2e1-087c-45e9-801a-94253cac061f
    type: regular
    task:
      id: 24d1d2e1-087c-45e9-801a-94253cac061f
      version: -1
      name: Delete Context
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: RandomString
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 8243ce1d-e45f-4ba8-b962-082ef384e83f
    type: regular
    task:
      id: 8243ce1d-e45f-4ba8-b962-082ef384e83f
      version: -1
      name: Create Hash MD5
      description: |
        Creating a hash of a given input, support sha1, sha256, sha512, md5 and blake. Wrapper for https://docs.python.org/3/library/hashlib.html.
      scriptName: CreateHash
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "21"
    scriptarguments:
      text:
        simple: ${RandomString}
      type:
        simple: md5
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: 736980a1-2358-47cd-b621-a70e49f38145
    type: regular
    task:
      id: 736980a1-2358-47cd-b621-a70e49f38145
      version: -1
      name: Create File Indicator MD5
      description: commands.local.cmd.new.indicator
      script: Builtin|||createNewIndicator
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      tags:
        simple: FileEnrichmentTest
      type:
        simple: File
      value:
        simple: ${CreateHash}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: e8a72579-51c2-4a24-8486-c933c5e6f915
    type: regular
    task:
      id: e8a72579-51c2-4a24-8486-c933c5e6f915
      version: -1
      name: File Enrichment Internal and External
      description: This script gathers file reputation data from multiple integrations
        and returns a "FileEnrichment" object with consolidated information to the
        context output.
      scriptName: file-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "27"
      - "28"
      - "29"
      - "30"
    scriptarguments:
      brands:
        simple: VirusTotal (API v3),WildFire-v2
      file_hash:
        simple: ${CreateHash}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: 7f951085-52e5-4fe0-8b9a-443082e62467
    type: title
    task:
      id: 7f951085-52e5-4fe0-8b9a-443082e62467
      version: -1
      name: Case 4 - Some Hash Malformed
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "45"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 3070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "25":
    id: "25"
    taskid: bb00d571-9985-4c1f-8521-87ac1ee4ee09
    type: condition
    task:
      id: bb00d571-9985-4c1f-8521-87ac1ee4ee09
      version: -1
      name: Validate DBotScore
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "10"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEmpty
          left:
            value:
              simple: DBotScore
            iscontext: true
          right:
            value: {}
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: d306be45-d560-494f-80c1-45f279df3499
    type: condition
    task:
      id: d306be45-d560-494f-80c1-45f279df3499
      version: -1
      name: Validate DBotScore
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "18"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
          right:
            value:
              simple: CreateHash
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Vendor
            iscontext: true
          right:
            value:
              simple: VirusTotal (API v3)
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: b4388142-5f26-4ba8-b260-9b0ab6ecaf47
    type: condition
    task:
      id: b4388142-5f26-4ba8-b260-9b0ab6ecaf47
      version: -1
      name: |
        Validate Brand
      description: Pretty-print the contents of the playbook context.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "24"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: FileEnrichment.Brand
            iscontext: true
          right:
            value:
              simple: VirusTotal (API v3)
      - - operator: containsGeneral
          left:
            value:
              simple: FileEnrichment.Brand
            iscontext: true
          right:
            value:
              simple: TIM
      - - operator: containsGeneral
          left:
            value:
              simple: FileEnrichment.Brand
            iscontext: true
          right:
            value:
              simple: WildFire-v2
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2900
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: fd9db349-55df-4378-8968-ab738650b038
    type: condition
    task:
      id: fd9db349-55df-4378-8968-ab738650b038
      version: -1
      name: Validate Indicator
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "24"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: FileEnrichment.MD5
            iscontext: true
          right:
            value:
              simple: CreateHash
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 2900
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: 583c8fb7-be60-4bbf-ac73-f60d59e1c232
    type: condition
    task:
      id: 583c8fb7-be60-4bbf-ac73-f60d59e1c232
      version: -1
      name: Validate Score
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "24"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: FileEnrichment.Score
            iscontext: true
          right:
            value:
              simple: "0"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 2900
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: ad94a8fb-e0f9-4e07-a76c-9499bd444167
    type: condition
    task:
      id: ad94a8fb-e0f9-4e07-a76c-9499bd444167
      version: -1
      name: Validate DBotScore
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "24"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
          right:
            value:
              simple: CreateHash
            iscontext: true
      - - operator: containsGeneral
          left:
            value:
              simple: DBotScore.Vendor
            iscontext: true
          right:
            value:
              simple: VirusTotal (API v3)
      - - operator: containsGeneral
          left:
            value:
              simple: DBotScore.Vendor
            iscontext: true
          right:
            value:
              simple: WildFire-v2
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1555,
          "y": 2900
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: 30b98f10-d224-448d-9640-3bb9ab899c09
    type: regular
    task:
      id: 30b98f10-d224-448d-9640-3bb9ab899c09
      version: -1
      name: File Enrichment
      description: This script gathers file reputation data from multiple integrations
        and returns a "FileEnrichment" object with consolidated information to the
        context output.
      scriptName: file-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#error#':
      - "53"
      '#none#':
      - "39"
    scriptarguments:
      additional_fields:
        simple: "true"
      brands:
        simple: dummy
      file_hash:
        simple: ${CreateHash}
    separatecontext: false
    continueonerror: true
    continueonerrortype: errorPath
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: 872c502b-5611-4ea2-89d2-343ed90e35c8
    type: title
    task:
      id: 872c502b-5611-4ea2-89d2-343ed90e35c8
      version: -1
      name: A Brand Does Not Exist
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: 92dd8b63-ef05-4dcf-886a-0063594bee88
    type: title
    task:
      id: 92dd8b63-ef05-4dcf-886a-0063594bee88
      version: -1
      name: No Arguments
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "37"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 3900
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: f65e4943-98ee-4438-8f0f-283fd610dae4
    type: regular
    task:
      id: f65e4943-98ee-4438-8f0f-283fd610dae4
      version: -1
      name: File Enrichment
      description: This script gathers file reputation data from multiple integrations
        and returns a "FileEnrichment" object with consolidated information to the
        context output.
      scriptName: file-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#error#':
      - "41"
      '#none#':
      - "39"
    scriptarguments:
      additional_fields:
        simple: "true"
    separatecontext: false
    continueonerror: true
    continueonerrortype: errorPath
    view: |-
      {
        "position": {
          "x": 695,
          "y": 4060
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: e4d8f52f-46a0-4032-8e9a-dec5af8b3e3e
    type: condition
    task:
      id: e4d8f52f-46a0-4032-8e9a-dec5af8b3e3e
      version: -1
      name: Failure
      type: condition
      iscommand: false
      brand: ""
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualNumber
          left:
            value:
              simple: "1"
            iscontext: true
          right:
            value:
              simple: "2"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 4890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: 3041f980-bdcf-46ab-8bb0-7428ceb257ad
    type: title
    task:
      id: 3041f980-bdcf-46ab-8bb0-7428ceb257ad
      version: -1
      name: Finish
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 5060
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: 9e960836-4880-4666-8431-70e452b71645
    type: title
    task:
      id: 9e960836-4880-4666-8431-70e452b71645
      version: -1
      name: Malformed Hash
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "43"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 582.5,
          "y": 4230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: 02df73cc-459f-44f6-8a3b-5a4e00e1df23
    type: regular
    task:
      id: 02df73cc-459f-44f6-8a3b-5a4e00e1df23
      version: -1
      name: File Enrichment
      description: This script gathers file reputation data from multiple integrations
        and returns a "FileEnrichment" object with consolidated information to the
        context output.
      scriptName: file-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#error#':
      - "34"
      '#none#':
      - "39"
    scriptarguments:
      additional_fields:
        simple: "true"
      file_hash:
        simple: dummy
    separatecontext: false
    continueonerror: true
    continueonerrortype: errorPath
    view: |-
      {
        "position": {
          "x": 582.5,
          "y": 4390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "44":
    id: "44"
    taskid: 0f4ad71a-c11c-4017-8bc9-ba21e9c65743
    type: title
    task:
      id: 0f4ad71a-c11c-4017-8bc9-ba21e9c65743
      version: -1
      name: Sad Flows
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "35"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 3740
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: acb120d6-e0b3-4472-87f3-9a8057bcc231
    type: regular
    task:
      id: acb120d6-e0b3-4472-87f3-9a8057bcc231
      version: -1
      name: Delete Context
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "46"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: CreateHash
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 3230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: c692a586-64e2-4850-8dee-7dbe493abd39
    type: regular
    task:
      id: c692a586-64e2-4850-8dee-7dbe493abd39
      version: -1
      name: File Enrichment Hash Malformed
      description: This script gathers file reputation data from multiple integrations
        and returns a "FileEnrichment" object with consolidated information to the
        context output.
      scriptName: file-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "47"
      - "48"
      - "49"
      - "50"
    scriptarguments:
      brands:
        simple: VirusTotal (API v3),WildFire-v2
      file_hash:
        simple: ${CreateHash}, 1
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 3400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: 5f4c7103-3b6a-4bb1-bd78-5c87cafc68f6
    type: condition
    task:
      id: 5f4c7103-3b6a-4bb1-bd78-5c87cafc68f6
      version: -1
      name: |
        Validate Brand
      description: Pretty-print the contents of the playbook context.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "44"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: FileEnrichment.Brand
            iscontext: true
          right:
            value:
              simple: VirusTotal (API v3)
      - - operator: containsGeneral
          left:
            value:
              simple: FileEnrichment.Brand
            iscontext: true
          right:
            value:
              simple: TIM
      - - operator: containsGeneral
          left:
            value:
              simple: FileEnrichment.Brand
            iscontext: true
          right:
            value:
              simple: WildFire-v2
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: 9ccf01a5-7543-4e36-8dca-93db7d087a33
    type: condition
    task:
      id: 9ccf01a5-7543-4e36-8dca-93db7d087a33
      version: -1
      name: Validate Indicator
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "44"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: FileEnrichment.MD5
            iscontext: true
          right:
            value:
              simple: CreateHash
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 3570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: bf60235f-9eed-4588-af18-a143fb2c381d
    type: condition
    task:
      id: bf60235f-9eed-4588-af18-a143fb2c381d
      version: -1
      name: Validate Score
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "44"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: FileEnrichment.Score
            iscontext: true
          right:
            value:
              simple: "0"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 3570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: 99bd2444-89ab-426d-bb00-29bb56941128
    type: condition
    task:
      id: 99bd2444-89ab-426d-bb00-29bb56941128
      version: -1
      name: Validate DBotScore
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "44"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
          right:
            value:
              simple: CreateHash
            iscontext: true
      - - operator: containsGeneral
          left:
            value:
              simple: DBotScore.Vendor
            iscontext: true
          right:
            value:
              simple: VirusTotal (API v3)
      - - operator: containsGeneral
          left:
            value:
              simple: DBotScore.Vendor
            iscontext: true
          right:
            value:
              simple: WildFire-v2
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1555,
          "y": 3570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: 6c955236-bdeb-4028-8a8a-82640f182cc6
    type: condition
    task:
      id: 6c955236-bdeb-4028-8a8a-82640f182cc6
      version: -1
      name: Validate Score
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "10"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: FileEnrichment.Score
            iscontext: true
          right:
            value:
              simple: "0"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "52":
    id: "52"
    taskid: 91954582-d29c-4960-b2e1-06dc182fa0ad
    type: regular
    task:
      id: 91954582-d29c-4960-b2e1-06dc182fa0ad
      version: -1
      name: Generate Random String
      description: Generates random string
      scriptName: GenerateRandomString
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      Digits:
        simple: "False"
      Length:
        simple: "10"
      Lowercase:
        simple: "True"
      Punctuation:
        simple: "False"
      Uppercase:
        simple: "False"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: bd90e289-94ac-4161-b3fa-ff4af34153e9
    type: regular
    task:
      id: bd90e289-94ac-4161-b3fa-ff4af34153e9
      version: -1
      name: 'Success '
      description: Prints text to war room (Markdown supported)
      scriptName: Print
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "40"
    scriptarguments:
      value:
        simple: '"Done"'
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 4890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 5070,
        "width": 1885,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
quiet: true
dirtyInputs: true
