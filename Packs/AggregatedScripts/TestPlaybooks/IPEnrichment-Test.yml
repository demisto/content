id: IPEnrichment-Test
version: -1
vcShouldKeepItemLegacyProdMachine: false
name: IPEnrichment-Test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: f19c4196-23f5-4c9b-8968-45e25a4a4523
    type: start
    task:
      id: f19c4196-23f5-4c9b-8968-45e25a4a4523
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 787.5,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 225d338d-a6cd-4653-88e9-4811ef3018d2
    type: regular
    task:
      id: 225d338d-a6cd-4653-88e9-4811ef3018d2
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 787.5,
          "y": 390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 37a1487d-9cca-433d-bdae-c51dca055593
    type: regular
    task:
      id: 37a1487d-9cca-433d-bdae-c51dca055593
      version: -1
      name: Run ip enrichment script
      description: This script gathers ip reputation data from multiple integrations
        and returns an ip entity with consolidated information to the context.
      scriptName: ip-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#error#':
      - "94"
      '#none#':
      - "13"
      - "14"
      - "15"
      - "60"
    scriptarguments:
      additional_fields:
        simple: "false"
      external_enrichment:
        simple: "false"
      ip_list:
        simple: ${CrowdStrike.Device.[0].LocalIP}
      verbose:
        simple: "false"
    separatecontext: false
    continueonerror: true
    continueonerrortype: errorPath
    view: |-
      {
        "position": {
          "x": 787.5,
          "y": 760
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: 9d3315e1-4ab4-40f7-8590-56dce34f4f20
    type: title
    task:
      id: 9d3315e1-4ab4-40f7-8590-56dce34f4f20
      version: -1
      name: Case 2 - External Enrichment
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "51"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1002.5,
          "y": 1500
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: 90a00935-501d-4a53-84d3-7b689452edfa
    type: title
    task:
      id: 90a00935-501d-4a53-84d3-7b689452edfa
      version: -1
      name: Case 1 - Base (Internal IP)
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 787.5,
          "y": 220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: c4795765-492c-4487-8307-dd8a45fed136
    type: condition
    task:
      id: c4795765-492c-4487-8307-dd8a45fed136
      version: -1
      name: Endpoint Data Returned
      description: Make sure Context output from wildfire
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "7"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: EndpointData.IPAddress
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: EndpointData.IPAddress
                      iscontext: true
                    right:
                      value:
                        simple: ${CrowdStrike.Device.[0].LocalIP}
                      iscontext: true
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 152.5,
          "y": 1315
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 4da2e36b-c4b7-4b8f-8ae0-7af4478911f2
    type: condition
    task:
      id: 4da2e36b-c4b7-4b8f-8ae0-7af4478911f2
      version: -1
      name: Main Keys Exists
      description: MaxScore And MaxVerdict enriched for https://google.com
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "7"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: IPEnrichment.Value
            iscontext: true
          right:
            value:
              simple: ${CrowdStrike.Device.[0].LocalIP}
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: CrowdStrike.Device.[0].LocalIP
                      iscontext: true
                accessor: MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: CrowdStrike.Device.[0].LocalIP
                      iscontext: true
                accessor: MaxVerdict
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: IPEnrichment.TIMScore
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 582.5,
          "y": 1315
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: f5a754ca-3d85-499b-810b-4ed299b435f1
    type: condition
    task:
      id: f5a754ca-3d85-499b-810b-4ed299b435f1
      version: -1
      name: No additional fields
      description: Additional fields empty
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "7"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              simple: IPEnrichment.Results.AdditionalFields
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1012.5,
          "y": 1315
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: b3d3b7e9-9174-4441-874c-db2f8de6eb69
    type: title
    task:
      id: b3d3b7e9-9174-4441-874c-db2f8de6eb69
      version: -1
      name: Case 3 - Brands No Internal
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "52"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1002.5,
          "y": 2780
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: f81fd42d-9c9f-4a57-8f86-8112c6e80546
    type: title
    task:
      id: f81fd42d-9c9f-4a57-8f86-8112c6e80546
      version: -1
      name: Case 4 - External Enrichment + Additional Fields
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "59"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 3690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: 7d8954cd-22a7-4d41-8f12-7cc0dd21cd6a
    type: title
    task:
      id: 7d8954cd-22a7-4d41-8f12-7cc0dd21cd6a
      version: -1
      name: Case 5 Multiple Inputs
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "84"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 4600
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: 016e08cf-d2be-4c71-8de8-2d6df323a9a3
    type: regular
    task:
      id: 016e08cf-d2be-4c71-8de8-2d6df323a9a3
      version: -1
      name: Get Endpoint IP Address
      description: Gets the list of host group members.
      script: '|||cs-falcon-list-host-group-members'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 787.5,
          "y": 575
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: 10e8cc82-2acd-4a6e-8949-359b4618f00d
    type: regular
    task:
      id: 10e8cc82-2acd-4a6e-8949-359b4618f00d
      version: -1
      name: Run ip enrichment script
      description: This script gathers ip reputation data from multiple integrations
        and returns an ip entity with consolidated information to the context.
      scriptName: ip-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "40"
      - "43"
      - "63"
      - "67"
    scriptarguments:
      additional_fields:
        simple: "false"
      external_enrichment:
        simple: "true"
      ip_list:
        simple: ${CrowdStrike.Device.[0].ExternalIP}
      verbose:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1002.5,
          "y": 2040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: 3ff33c75-82e9-45e2-8dcf-86760425eb6b
    type: regular
    task:
      id: 3ff33c75-82e9-45e2-8dcf-86760425eb6b
      version: -1
      name: Get Endpoint IP Address
      description: Gets the list of host group members.
      script: '|||cs-falcon-list-host-group-members'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "38"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1002.5,
          "y": 1855
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: a2b725a0-393b-4a64-8801-b2006e638d27
    type: condition
    task:
      id: a2b725a0-393b-4a64-8801-b2006e638d27
      version: -1
      name: Both Indicator Exists
      description: Make sure the Virus Total indicator returned from tim
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "20"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: CrowdStrike.Device.[0].ExternalIP
                      iscontext: true
                accessor: Results.Brand
            iscontext: true
          right:
            value:
              simple: VirusTotal (API v3)
      - - operator: isEqualString
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: CrowdStrike.Device.[0].ExternalIP
                      iscontext: true
                accessor: Results.Brand
            iscontext: true
          right:
            value:
              simple: AlienVault OTX v2
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 142.5,
          "y": 2595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: 89c68c9d-7a9e-4935-8197-9867f3e98dd6
    type: condition
    task:
      id: 89c68c9d-7a9e-4935-8197-9867f3e98dd6
      version: -1
      name: No additional fields
      description: Additional fields empty
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "20"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              simple: IPEnrichment.Results.AdditionalFields
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1002.5,
          "y": 2595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: 0efd36ba-7348-487d-8195-72a1cbf725f8
    type: regular
    task:
      id: 0efd36ba-7348-487d-8195-72a1cbf725f8
      version: -1
      name: Run ip enrichment script
      description: This script gathers ip reputation data from multiple integrations
        and returns an ip entity with consolidated information to the context.
      scriptName: ip-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "47"
      - "50"
      - "66"
      - "68"
    scriptarguments:
      additional_fields:
        simple: "false"
      brands:
        simple: VirusTotal (API v3)
      external_enrichment:
        simple: "false"
      ip_list:
        simple: ${CrowdStrike.Device.[0].ExternalIP}
      verbose:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1002.5,
          "y": 3320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: 34a60a01-5952-4fee-89d1-97d47f68a9a1
    type: regular
    task:
      id: 34a60a01-5952-4fee-89d1-97d47f68a9a1
      version: -1
      name: Get Endpoint IP Address
      description: Gets the list of host group members.
      script: '|||cs-falcon-list-host-group-members'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "45"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1002.5,
          "y": 3135
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: a24b6fc3-5a43-421b-817f-b5bcf044c6d9
    type: condition
    task:
      id: a24b6fc3-5a43-421b-817f-b5bcf044c6d9
      version: -1
      name: Virus Total Indicator Exists
      description: Make sure the Virus Total indicator returned from tim
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "28"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: CrowdStrike.Device.[0].ExternalIP
                      iscontext: true
                accessor: Results.Brand
            iscontext: true
          right:
            value:
              simple: VirusTotal (API v3)
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3505
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: 5aeb3525-970e-43e3-8a78-822aa460ff45
    type: condition
    task:
      id: 5aeb3525-970e-43e3-8a78-822aa460ff45
      version: -1
      name: No additional fields
      description: Additional fields empty
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "28"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              simple: IPEnrichment.Results.AdditionalFields
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3505
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: de84fdb4-11de-40be-841b-e4dc8d2d5475
    type: regular
    task:
      id: de84fdb4-11de-40be-841b-e4dc8d2d5475
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "39"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1002.5,
          "y": 1670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "52":
    id: "52"
    taskid: 3110bf0c-dde3-42f9-89b7-d591321b3520
    type: regular
    task:
      id: 3110bf0c-dde3-42f9-89b7-d591321b3520
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "46"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1002.5,
          "y": 2950
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: 7a89238d-0ba6-4ce6-8403-2d31428c1a68
    type: regular
    task:
      id: 7a89238d-0ba6-4ce6-8403-2d31428c1a68
      version: -1
      name: Run ip enrichment script
      description: This script gathers ip reputation data from multiple integrations
        and returns an ip entity with consolidated information to the context.
      scriptName: ip-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "55"
      - "58"
      - "69"
    scriptarguments:
      additional_fields:
        simple: "true"
      external_enrichment:
        simple: "true"
      ip_list:
        simple: ${CrowdStrike.Device.[0].ExternalIP}
      verbose:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 4230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "54":
    id: "54"
    taskid: 33dcf250-ff11-4d63-8a2e-74e4b74d94ea
    type: regular
    task:
      id: 33dcf250-ff11-4d63-8a2e-74e4b74d94ea
      version: -1
      name: Get Endpoint IP Address
      description: Gets the list of host group members.
      script: '|||cs-falcon-list-host-group-members'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "53"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 4045
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "55":
    id: "55"
    taskid: 36222e65-628e-4cab-8782-bd0c2268f77a
    type: condition
    task:
      id: 36222e65-628e-4cab-8782-bd0c2268f77a
      version: -1
      name: Virus Total Indicator Exists
      description: Make sure the Virus Total indicator returned from tim
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "35"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: CrowdStrike.Device.[0].ExternalIP
                      iscontext: true
                accessor: Results.Brand
            iscontext: true
          right:
            value:
              simple: VirusTotal (API v3)
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 4415
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "58":
    id: "58"
    taskid: 2139584d-bce5-4321-8a5a-201bc852ace8
    type: condition
    task:
      id: 2139584d-bce5-4321-8a5a-201bc852ace8
      version: -1
      name: additional fields Exists
      description: Additional fields empty
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "35"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: IPEnrichment.Results.AdditionalFields
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 4415
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "59":
    id: "59"
    taskid: 481190b9-c921-4581-8a71-9b1d48a6a6a4
    type: regular
    task:
      id: 481190b9-c921-4581-8a71-9b1d48a6a6a4
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "54"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 3860
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: 0e3e0719-52a9-4835-8511-5940a1c13ca1
    type: condition
    task:
      id: 0e3e0719-52a9-4835-8511-5940a1c13ca1
      version: -1
      name: Core Returned
      description: Make sure Context output from wildfire
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "61"
      "yes":
      - "7"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Core.AnalyticsPrevalence.Ip
            iscontext: true
          right:
            value:
              simple: https://google.com
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1555,
          "y": 945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    id: "61"
    taskid: 3eb60d13-05d8-4c8d-8a26-dd267ae2c3bd
    type: regular
    task:
      id: 3eb60d13-05d8-4c8d-8a26-dd267ae2c3bd
      version: -1
      name: Run core-get-IP-analytics-prevalence
      description: Get the prevalence of an ip, identified by ip_address.
      script: '|||core-get-IP-analytics-prevalence'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "62"
    scriptarguments:
      ip_address:
        simple: ${CrowdStrike.Device.[0].ExternalIP}
    separatecontext: false
    continueonerror: true
    continueonerrortype: errorPath
    view: |-
      {
        "position": {
          "x": 1442.5,
          "y": 1130
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "62":
    id: "62"
    taskid: 7c3865fe-2c0e-4158-82c8-100b9ab08e31
    type: condition
    task:
      id: 7c3865fe-2c0e-4158-82c8-100b9ab08e31
      version: -1
      name: Make sure analytics not exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "7"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              simple: Core.AnalyticsPrevalence.Ip
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1442.5,
          "y": 1315
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: 62ab867f-ca78-4794-81ed-5ed3d2122403
    type: condition
    task:
      id: 62ab867f-ca78-4794-81ed-5ed3d2122403
      version: -1
      name: Core Returned
      description: Make sure Context output from wildfire
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "64"
      "yes":
      - "20"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Core.AnalyticsPrevalence.Ip
            iscontext: true
          right:
            value:
              simple: https://google.com
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1545,
          "y": 2225
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "64":
    id: "64"
    taskid: 21b6fef7-8edf-4598-8356-54ef8f1d1bca
    type: regular
    task:
      id: 21b6fef7-8edf-4598-8356-54ef8f1d1bca
      version: -1
      name: Run core-get-IP-analytics-prevalence
      description: Get the prevalence of an ip, identified by ip_address.
      script: '|||core-get-IP-analytics-prevalence'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "65"
    scriptarguments:
      ip_address:
        simple: ${CrowdStrike.Device.[0].ExternalIP}
    separatecontext: false
    continueonerror: true
    continueonerrortype: errorPath
    view: |-
      {
        "position": {
          "x": 1432.5,
          "y": 2410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "65":
    id: "65"
    taskid: 46a0d3a8-cc09-4958-8bbf-a835f93cc7e2
    type: condition
    task:
      id: 46a0d3a8-cc09-4958-8bbf-a835f93cc7e2
      version: -1
      name: Make sure analytics not exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "20"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              simple: Core.AnalyticsPrevalence.Ip
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1432.5,
          "y": 2595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "66":
    id: "66"
    taskid: 58df4ac2-2785-4333-81e3-3875e54a361d
    type: condition
    task:
      id: 58df4ac2-2785-4333-81e3-3875e54a361d
      version: -1
      name: Make sure analytics not exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "28"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              simple: Core.AnalyticsPrevalence.Ip
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 3505
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "67":
    id: "67"
    taskid: 743d5184-e53f-426a-8703-864f9830cca9
    type: condition
    task:
      id: 743d5184-e53f-426a-8703-864f9830cca9
      version: -1
      name: Main Keys Exists
      description: MaxScore And MaxVerdict enriched for https://google.com
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "20"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: IPEnrichment.Value
            iscontext: true
          right:
            value:
              simple: ${CrowdStrike.Device.[0].ExternalIP}
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: CrowdStrike.Device.[0].ExternalIP
                      iscontext: true
                accessor: MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: CrowdStrike.Device.[0].ExternalIP
                      iscontext: true
                accessor: MaxVerdict
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: IPEnrichment.Status
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: IPEnrichment.TIMScore
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1882.5,
          "y": 2595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "68":
    id: "68"
    taskid: a917693e-4a3f-4b70-879a-2cd9f6ccb8b8
    type: condition
    task:
      id: a917693e-4a3f-4b70-879a-2cd9f6ccb8b8
      version: -1
      name: Main Keys Exists
      description: MaxScore And MaxVerdict enriched for https://google.com
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "28"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: IPEnrichment.Value
            iscontext: true
          right:
            value:
              simple: ${CrowdStrike.Device.[0].ExternalIP}
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: CrowdStrike.Device.[0].ExternalIP
                      iscontext: true
                accessor: MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: CrowdStrike.Device.[0].ExternalIP
                      iscontext: true
                accessor: MaxVerdict
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: IPEnrichment.Status
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: IPEnrichment.TIMScore
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 3505
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "69":
    id: "69"
    taskid: 233b16d0-0456-4f60-867a-24f6eb040ba5
    type: condition
    task:
      id: 233b16d0-0456-4f60-867a-24f6eb040ba5
      version: -1
      name: Main Keys Exists
      description: MaxScore And MaxVerdict enriched for https://google.com
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "35"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: IPEnrichment.Value
            iscontext: true
          right:
            value:
              simple: ${CrowdStrike.Device.[0].ExternalIP}
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: CrowdStrike.Device.[0].ExternalIP
                      iscontext: true
                accessor: MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: CrowdStrike.Device.[0].ExternalIP
                      iscontext: true
                accessor: MaxVerdict
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: IPEnrichment.Status
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: IPEnrichment.TIMScore
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1555,
          "y": 4415
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "70":
    id: "70"
    taskid: 78c83b30-1a1e-47f7-8639-e143eb7014ed
    type: title
    task:
      id: 78c83b30-1a1e-47f7-8639-e143eb7014ed
      version: -1
      name: Case 1 - Bad Input
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "72"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 6220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "72":
    id: "72"
    taskid: fdb9016d-0abd-44d9-8b73-a4573dd2f1ea
    type: regular
    task:
      id: fdb9016d-0abd-44d9-8b73-a4573dd2f1ea
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "73"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 6390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "73":
    id: "73"
    taskid: 9268a7ad-291c-483c-8840-ed7b90d0345d
    type: regular
    task:
      id: 9268a7ad-291c-483c-8840-ed7b90d0345d
      version: -1
      name: Run ip enrichment script
      description: This script gathers ip reputation data from multiple integrations
        and returns an ip entity with consolidated information to the context.
      scriptName: ip-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#error#':
      - "74"
      '#none#':
      - "75"
    scriptarguments:
      additional_fields:
        simple: "true"
      external_enrichment:
        simple: "true"
      ip_list:
        simple: asdasd
      verbose:
        simple: "false"
    separatecontext: false
    continueonerror: true
    continueonerrortype: errorPath
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 6575
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "74":
    id: "74"
    taskid: d9e49915-3dc8-4a6d-8476-22bee495b84d
    type: title
    task:
      id: d9e49915-3dc8-4a6d-8476-22bee495b84d
      version: -1
      name: Case 2 - Bad Brand
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "76"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 715,
          "y": 6760
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "75":
    id: "75"
    taskid: bc1fa42e-2325-408c-8e1d-5b24cc42fb04
    type: condition
    task:
      id: bc1fa42e-2325-408c-8e1d-5b24cc42fb04
      version: -1
      name: Failure
      type: condition
      iscommand: false
      brand: ""
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: "1"
          right:
            value:
              simple: "2"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 7300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "76":
    id: "76"
    taskid: 39e13bd2-4e57-4491-8fe7-9930b2b8850a
    type: regular
    task:
      id: 39e13bd2-4e57-4491-8fe7-9930b2b8850a
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "77"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 715,
          "y": 6930
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "77":
    id: "77"
    taskid: 0a352716-1e68-4b89-81bf-364cf9e308a9
    type: regular
    task:
      id: 0a352716-1e68-4b89-81bf-364cf9e308a9
      version: -1
      name: Run ip enrichment script
      description: This script gathers ip reputation data from multiple integrations
        and returns an ip entity with consolidated information to the context.
      scriptName: ip-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#error#':
      - "78"
      '#none#':
      - "75"
    scriptarguments:
      additional_fields:
        simple: "true"
      brands:
        simple: asdasd
      external_enrichment:
        simple: "true"
      ip_list:
        simple: ${CrowdStrike.Device.[0].ExternalIP}
      verbose:
        simple: "false"
    separatecontext: false
    continueonerror: true
    continueonerrortype: errorPath
    view: |-
      {
        "position": {
          "x": 715,
          "y": 7115
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "78":
    id: "78"
    taskid: 3ff44cd5-2d48-4f82-8894-2a260de117b7
    type: title
    task:
      id: 3ff44cd5-2d48-4f82-8894-2a260de117b7
      version: -1
      name: Pass
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 7307.5
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "79":
    id: "79"
    taskid: ea755671-46b0-4d98-8916-940a63fd2a22
    type: regular
    task:
      id: ea755671-46b0-4d98-8916-940a63fd2a22
      version: -1
      name: Run ip enrichment script
      description: This script gathers ip reputation data from multiple integrations
        and returns an ip entity with consolidated information to the context.
      scriptName: ip-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "83"
      - "85"
      - "87"
    scriptarguments:
      additional_fields:
        simple: "true"
      external_enrichment:
        simple: "true"
      ip_list:
        simple: 1.1.1.1,8.8.8.8
      verbose:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 4955
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "83":
    id: "83"
    taskid: 6c70eb76-0229-4671-8130-04b2dff3c81a
    type: condition
    task:
      id: 6c70eb76-0229-4671-8130-04b2dff3c81a
      version: -1
      name: additional fields Exists
      description: Additional fields empty
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "86"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: IPEnrichment.Results.AdditionalFields
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "84":
    id: "84"
    taskid: 390aa094-887e-480d-83be-b85c013021d3
    type: regular
    task:
      id: 390aa094-887e-480d-83be-b85c013021d3
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "79"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 4770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "85":
    id: "85"
    taskid: 2c6b5d32-ef9c-4b84-8e52-45f09b2a4b82
    type: condition
    task:
      id: 2c6b5d32-ef9c-4b84-8e52-45f09b2a4b82
      version: -1
      name: Main Keys For 1.1.1.1
      description: MaxScore And MaxVerdict enriched for https://google.com
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "86"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: IPEnrichment.Value
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 1.1.1.1
            iscontext: true
          right:
            value:
              simple: 1.1.1.1
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 1.1.1.1
                accessor: MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 1.1.1.1
                accessor: MaxVerdict
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 1.1.1.1
                accessor: Status
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 1.1.1.1
                accessor: TIMScore
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 5140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "86":
    id: "86"
    taskid: 51dc23c5-2642-41bb-85a0-0467f1343266
    type: title
    task:
      id: 51dc23c5-2642-41bb-85a0-0467f1343266
      version: -1
      name: Case 6 One Invalid One Valid
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "90"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 5325
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "87":
    id: "87"
    taskid: e31dd041-011d-462e-8bf9-f5b0ce1b877c
    type: condition
    task:
      id: e31dd041-011d-462e-8bf9-f5b0ce1b877c
      version: -1
      name: Main Keys For 8.8.8.8
      description: MaxScore And MaxVerdict enriched for https://google.com
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "86"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: IPEnrichment.Value
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 8.8.8.8
            iscontext: true
          right:
            value:
              simple: 8.8.8.8
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 8.8.8.8
                accessor: MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 8.8.8.8
                accessor: MaxVerdict
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 8.8.8.8
                accessor: Status
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 8.8.8.8
                accessor: TIMScore
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 5140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "88":
    id: "88"
    taskid: 38ef5d55-3f1c-4500-8e5f-ed0f1c825e7b
    type: regular
    task:
      id: 38ef5d55-3f1c-4500-8e5f-ed0f1c825e7b
      version: -1
      name: Run ip enrichment script
      description: This script gathers ip reputation data from multiple integrations
        and returns an ip entity with consolidated information to the context.
      scriptName: ip-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "91"
      - "92"
    scriptarguments:
      additional_fields:
        simple: "false"
      external_enrichment:
        simple: "true"
      ip_list:
        simple: 1.1.1.1,8.8.8.8/24
      verbose:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 5680
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "90":
    id: "90"
    taskid: 3c723ad2-7fe7-4fb1-8f41-1e7bc7d366fa
    type: regular
    task:
      id: 3c723ad2-7fe7-4fb1-8f41-1e7bc7d366fa
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "88"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 5495
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "91":
    id: "91"
    taskid: 3afbfff3-2988-441d-8c0b-82a91ebaf005
    type: condition
    task:
      id: 3afbfff3-2988-441d-8c0b-82a91ebaf005
      version: -1
      name: Main Keys For 1.1.1.1
      description: MaxScore And MaxVerdict enriched for https://google.com
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "93"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: IPEnrichment.Value
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 1.1.1.1
            iscontext: true
          right:
            value:
              simple: 1.1.1.1
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 1.1.1.1
                accessor: MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 1.1.1.1
                accessor: MaxVerdict
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 1.1.1.1
                accessor: Status
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 1.1.1.1
                accessor: TIMScore
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 5865
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "92":
    id: "92"
    taskid: 5b796544-4a4a-4427-8fea-7e718daa7d7a
    type: condition
    task:
      id: 5b796544-4a4a-4427-8fea-7e718daa7d7a
      version: -1
      name: Invalid Entry for 8.8.8.8/24
      description: MaxScore And MaxVerdict enriched for https://google.com
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "93"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 8.8.8.8/24
                accessor: Value
            iscontext: true
          right:
            value:
              simple: 8.8.8.8/24
      - - operator: isEqualString
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 8.8.8.8/24
                accessor: Status
            iscontext: true
          right:
            value:
              simple: Error
      - - operator: isEqualString
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 8.8.8.8/24
                accessor: Message
            iscontext: true
          right:
            value:
              simple: Invalid
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 5865
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "93":
    id: "93"
    taskid: 05f06466-ebe0-4f1c-8102-44db2032c78d
    type: title
    task:
      id: 05f06466-ebe0-4f1c-8102-44db2032c78d
      version: -1
      name: Sad Flows
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "70"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 6050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "94":
    id: "94"
    taskid: 39f826a6-5358-48dc-bcc8-fe251a2c6c13
    type: regular
    task:
      id: 39f826a6-5358-48dc-bcc8-fe251a2c6c13
      version: -1
      name: Untitled Task
      description: Extracts domains and FQDNs from URLs and emails.
      scriptName: ExtractDomainAndFQDNFromUrlAndEmail
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      input:
        simple: ${CrowdStrike.Device.[0].LocalIP}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -30,
          "y": 820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "62_7_yes": 0.76
    },
    "paper": {
      "dimensions": {
        "height": 7325,
        "width": 2292.5,
        "x": -30,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
sourceplaybookid: 110f76de-5574-4854-853e-8675a01d8eb0
dirtyInputs: true
adopted: true
