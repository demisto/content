id: IPEnrichment-Test
version: -1
vcShouldKeepItemLegacyProdMachine: false
name: IPEnrichment-Test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 2b456c22-bc7d-45d8-8730-0f3709e0e7e3
    type: start
    task:
      id: 2b456c22-bc7d-45d8-8730-0f3709e0e7e3
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 787.5,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: ce5f8892-beb8-4d22-8c29-09c76c751075
    type: regular
    task:
      id: ce5f8892-beb8-4d22-8c29-09c76c751075
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 787.5,
          "y": 390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 2a5644d4-89aa-42b5-81b3-50e569df9832
    type: regular
    task:
      id: 2a5644d4-89aa-42b5-81b3-50e569df9832
      version: -1
      name: Run ip enrichment script
      description: This script gathers ip reputation data from multiple integrations
        and returns an ip entity with consolidated information to the context.
      scriptName: ip-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "13"
      - "14"
      - "15"
      - "60"
    scriptarguments:
      additional_fields:
        simple: "false"
      external_enrichment:
        simple: "false"
      ip_list:
        simple: ${CrowdStrike.Device.[0].LocalIP}
      verbose:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 787.5,
          "y": 760
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: 1dc45010-ab66-48b1-83d8-b54f18d54ebe
    type: title
    task:
      id: 1dc45010-ab66-48b1-83d8-b54f18d54ebe
      version: -1
      name: Case 2 - External Enrichment
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "51"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1002.5,
          "y": 1500
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: ed6bbd8e-9a94-49b7-9a82-320236f249d2
    type: title
    task:
      id: ed6bbd8e-9a94-49b7-9a82-320236f249d2
      version: -1
      name: Case 1 - Base (Internal IP)
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 787.5,
          "y": 220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: 10d05224-dea7-4911-8f00-b77898d4b578
    type: condition
    task:
      id: 10d05224-dea7-4911-8f00-b77898d4b578
      version: -1
      name: Endpoint Data Returned
      description: Make sure Context output from wildfire
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "7"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: EndpointData.IPAddress
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: EndpointData.IPAddress
                      iscontext: true
                    right:
                      value:
                        simple: ${CrowdStrike.Device.[0].LocalIP}
                      iscontext: true
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 152.5,
          "y": 1315
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 44315b7e-054f-4892-a1d2-7b8df8ad0735
    type: condition
    task:
      id: 44315b7e-054f-4892-a1d2-7b8df8ad0735
      version: -1
      name: Main Keys Exists
      description: MaxScore And MaxVerdict enriched for https://google.com
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "7"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: IPEnrichment.Value
            iscontext: true
          right:
            value:
              simple: ${CrowdStrike.Device.[0].LocalIP}
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: CrowdStrike.Device.[0].LocalIP
                      iscontext: true
                accessor: MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: CrowdStrike.Device.[0].LocalIP
                      iscontext: true
                accessor: MaxVerdict
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: IPEnrichment.TIMScore
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 582.5,
          "y": 1315
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: ff0b9fa8-bd7a-40e8-8d5b-d43c6a507a15
    type: condition
    task:
      id: ff0b9fa8-bd7a-40e8-8d5b-d43c6a507a15
      version: -1
      name: No additional fields
      description: Additional fields empty
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "7"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              simple: IPEnrichment.Results.AdditionalFields
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1012.5,
          "y": 1315
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 9a2f6cbc-6aaf-4f76-8223-ef9c92e03430
    type: title
    task:
      id: 9a2f6cbc-6aaf-4f76-8223-ef9c92e03430
      version: -1
      name: Case 3 - Brands No Internal
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "52"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1002.5,
          "y": 2780
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: f1c48efa-064f-431a-8ed5-7a53325d2eff
    type: title
    task:
      id: f1c48efa-064f-431a-8ed5-7a53325d2eff
      version: -1
      name: Case 4 - External Enrichment + Additional Fields
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "59"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 3690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: 3614497b-1120-48ab-8974-498062d5d8f4
    type: title
    task:
      id: 3614497b-1120-48ab-8974-498062d5d8f4
      version: -1
      name: Case 5 Multiple Inputs
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "84"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 4600
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: 929b4c61-fb91-4ac9-83fc-1d44b5c5f241
    type: regular
    task:
      id: 929b4c61-fb91-4ac9-83fc-1d44b5c5f241
      version: -1
      name: Get Endpoint IP Address
      description: Gets the list of host group members.
      script: '|||cs-falcon-list-host-group-members'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 787.5,
          "y": 575
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: 8f5f2693-818d-4510-a209-5b1f13faceae
    type: regular
    task:
      id: 8f5f2693-818d-4510-a209-5b1f13faceae
      version: -1
      name: Run ip enrichment script
      description: This script gathers ip reputation data from multiple integrations
        and returns an ip entity with consolidated information to the context.
      scriptName: ip-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "40"
      - "43"
      - "63"
      - "67"
    scriptarguments:
      additional_fields:
        simple: "false"
      external_enrichment:
        simple: "true"
      ip_list:
        simple: ${CrowdStrike.Device.[0].ExternalIP}
      verbose:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1002.5,
          "y": 2040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: f833608b-49da-430e-8ca8-5f3f29c14d6f
    type: regular
    task:
      id: f833608b-49da-430e-8ca8-5f3f29c14d6f
      version: -1
      name: Get Endpoint IP Address
      description: Gets the list of host group members.
      script: '|||cs-falcon-list-host-group-members'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "38"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1002.5,
          "y": 1855
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: 36a60e64-dbe0-4815-946f-39d08c0cc8ed
    type: condition
    task:
      id: 36a60e64-dbe0-4815-946f-39d08c0cc8ed
      version: -1
      name: Both Indicator Exists
      description: Make sure the Virus Total indicator returned from tim
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "20"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: CrowdStrike.Device.[0].ExternalIP
                      iscontext: true
                accessor: Results.Brand
            iscontext: true
          right:
            value:
              simple: VirusTotal (API v3)
      - - operator: isEqualString
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: CrowdStrike.Device.[0].ExternalIP
                      iscontext: true
                accessor: Results.Brand
            iscontext: true
          right:
            value:
              simple: AlienVault OTX v2
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 142.5,
          "y": 2595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: 42db2444-b1f2-4740-8c03-2d4a86b1bb1b
    type: condition
    task:
      id: 42db2444-b1f2-4740-8c03-2d4a86b1bb1b
      version: -1
      name: No additional fields
      description: Additional fields empty
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "20"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              simple: IPEnrichment.Results.AdditionalFields
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1002.5,
          "y": 2595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: 7d731fd5-4af8-46aa-8e48-78820400e983
    type: regular
    task:
      id: 7d731fd5-4af8-46aa-8e48-78820400e983
      version: -1
      name: Run ip enrichment script
      description: This script gathers ip reputation data from multiple integrations
        and returns an ip entity with consolidated information to the context.
      scriptName: ip-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "47"
      - "50"
      - "66"
      - "68"
    scriptarguments:
      additional_fields:
        simple: "false"
      brands:
        simple: VirusTotal (API v3)
      external_enrichment:
        simple: "false"
      ip_list:
        simple: ${CrowdStrike.Device.[0].ExternalIP}
      verbose:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1002.5,
          "y": 3320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: e415239a-7ffc-467d-8b04-580eed65a503
    type: regular
    task:
      id: e415239a-7ffc-467d-8b04-580eed65a503
      version: -1
      name: Get Endpoint IP Address
      description: Gets the list of host group members.
      script: '|||cs-falcon-list-host-group-members'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "45"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1002.5,
          "y": 3135
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: 75a937e9-84ce-42f3-b968-f5fbfc9594ca
    type: condition
    task:
      id: 75a937e9-84ce-42f3-b968-f5fbfc9594ca
      version: -1
      name: Virus Total Indicator Exists
      description: Make sure the Virus Total indicator returned from tim
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "28"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: CrowdStrike.Device.[0].ExternalIP
                      iscontext: true
                accessor: Results.Brand
            iscontext: true
          right:
            value:
              simple: VirusTotal (API v3)
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3505
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: 44896d33-2838-4444-9fdc-107c7cf8325f
    type: condition
    task:
      id: 44896d33-2838-4444-9fdc-107c7cf8325f
      version: -1
      name: No additional fields
      description: Additional fields empty
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "28"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              simple: IPEnrichment.Results.AdditionalFields
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3505
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: b8ce6a90-2eb2-494f-882d-0b38958e5f35
    type: regular
    task:
      id: b8ce6a90-2eb2-494f-882d-0b38958e5f35
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "39"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1002.5,
          "y": 1670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "52":
    id: "52"
    taskid: bdf8340b-e367-41fa-8a02-00ca99376245
    type: regular
    task:
      id: bdf8340b-e367-41fa-8a02-00ca99376245
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "46"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1002.5,
          "y": 2950
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: bc73a826-b2f9-40c3-adb4-be3ebf7c8343
    type: regular
    task:
      id: bc73a826-b2f9-40c3-adb4-be3ebf7c8343
      version: -1
      name: Run ip enrichment script
      description: This script gathers ip reputation data from multiple integrations
        and returns an ip entity with consolidated information to the context.
      scriptName: ip-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "55"
      - "58"
      - "69"
    scriptarguments:
      additional_fields:
        simple: "true"
      external_enrichment:
        simple: "true"
      ip_list:
        simple: ${CrowdStrike.Device.[0].ExternalIP}
      verbose:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 4230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "54":
    id: "54"
    taskid: 73007d25-6ab3-403b-89bf-b0764f65b01d
    type: regular
    task:
      id: 73007d25-6ab3-403b-89bf-b0764f65b01d
      version: -1
      name: Get Endpoint IP Address
      description: Gets the list of host group members.
      script: '|||cs-falcon-list-host-group-members'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "53"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 4045
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "55":
    id: "55"
    taskid: 2c9abb7f-7891-4564-afc1-f1b36e103744
    type: condition
    task:
      id: 2c9abb7f-7891-4564-afc1-f1b36e103744
      version: -1
      name: Virus Total Indicator Exists
      description: Make sure the Virus Total indicator returned from tim
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "35"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: CrowdStrike.Device.[0].ExternalIP
                      iscontext: true
                accessor: Results.Brand
            iscontext: true
          right:
            value:
              simple: VirusTotal (API v3)
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 4415
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "58":
    id: "58"
    taskid: 268223c7-d8cd-469d-a199-af6d7b764368
    type: condition
    task:
      id: 268223c7-d8cd-469d-a199-af6d7b764368
      version: -1
      name: additional fields Exists
      description: Additional fields empty
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "35"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: IPEnrichment.Results.AdditionalFields
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 4415
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "59":
    id: "59"
    taskid: ba994758-5af3-4dc8-80eb-90deaad79353
    type: regular
    task:
      id: ba994758-5af3-4dc8-80eb-90deaad79353
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "54"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 3860
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: e64d66a7-32e6-4648-864f-d6bb4bbb378c
    type: condition
    task:
      id: e64d66a7-32e6-4648-864f-d6bb4bbb378c
      version: -1
      name: Core Returned
      description: Make sure Context output from wildfire
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "61"
      "yes":
      - "7"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Core.AnalyticsPrevalence.Ip
            iscontext: true
          right:
            value:
              simple: https://google.com
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1555,
          "y": 945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    id: "61"
    taskid: dcaa82c5-3972-4969-8e20-d4cba681fadf
    type: regular
    task:
      id: dcaa82c5-3972-4969-8e20-d4cba681fadf
      version: -1
      name: Run core-get-IP-analytics-prevalence
      description: Get the prevalence of an ip, identified by ip_address.
      script: '|||core-get-IP-analytics-prevalence'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "62"
    scriptarguments:
      ip_address:
        simple: ${CrowdStrike.Device.[0].ExternalIP}
    separatecontext: false
    continueonerror: true
    continueonerrortype: errorPath
    view: |-
      {
        "position": {
          "x": 1442.5,
          "y": 1130
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "62":
    id: "62"
    taskid: bb60e1db-01f7-4bd4-8d32-6b6017fc29cf
    type: condition
    task:
      id: bb60e1db-01f7-4bd4-8d32-6b6017fc29cf
      version: -1
      name: Make sure analytics not exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "7"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              simple: Core.AnalyticsPrevalence.Ip
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1442.5,
          "y": 1315
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: 7a57da44-56ad-4a12-8092-607f77e36460
    type: condition
    task:
      id: 7a57da44-56ad-4a12-8092-607f77e36460
      version: -1
      name: Core Returned
      description: Make sure Context output from wildfire
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "64"
      "yes":
      - "20"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Core.AnalyticsPrevalence.Ip
            iscontext: true
          right:
            value:
              simple: https://google.com
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1545,
          "y": 2225
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "64":
    id: "64"
    taskid: ce2a445b-7032-42d0-8cd3-569ecd0f9f40
    type: regular
    task:
      id: ce2a445b-7032-42d0-8cd3-569ecd0f9f40
      version: -1
      name: Run core-get-IP-analytics-prevalence
      description: Get the prevalence of an ip, identified by ip_address.
      script: '|||core-get-IP-analytics-prevalence'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "65"
    scriptarguments:
      ip_address:
        simple: ${CrowdStrike.Device.[0].ExternalIP}
    separatecontext: false
    continueonerror: true
    continueonerrortype: errorPath
    view: |-
      {
        "position": {
          "x": 1432.5,
          "y": 2410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "65":
    id: "65"
    taskid: 55a9f789-9091-45f2-8bac-d019b852141f
    type: condition
    task:
      id: 55a9f789-9091-45f2-8bac-d019b852141f
      version: -1
      name: Make sure analytics not exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "20"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              simple: Core.AnalyticsPrevalence.Ip
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1432.5,
          "y": 2595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "66":
    id: "66"
    taskid: 7e360b9b-be0d-4810-8a33-9c90c353f968
    type: condition
    task:
      id: 7e360b9b-be0d-4810-8a33-9c90c353f968
      version: -1
      name: Make sure analytics not exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "28"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              simple: Core.AnalyticsPrevalence.Ip
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 3505
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "67":
    id: "67"
    taskid: 527c233d-0761-4028-b175-066a7e08cda0
    type: condition
    task:
      id: 527c233d-0761-4028-b175-066a7e08cda0
      version: -1
      name: Main Keys Exists
      description: MaxScore And MaxVerdict enriched for https://google.com
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "20"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: IPEnrichment.Value
            iscontext: true
          right:
            value:
              simple: ${CrowdStrike.Device.[0].ExternalIP}
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: CrowdStrike.Device.[0].ExternalIP
                      iscontext: true
                accessor: MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: CrowdStrike.Device.[0].ExternalIP
                      iscontext: true
                accessor: MaxVerdict
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: IPEnrichment.Status
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: IPEnrichment.TIMScore
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1882.5,
          "y": 2595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "68":
    id: "68"
    taskid: c59c7899-5ab0-4e4f-aeea-a404a4e80b07
    type: condition
    task:
      id: c59c7899-5ab0-4e4f-aeea-a404a4e80b07
      version: -1
      name: Main Keys Exists
      description: MaxScore And MaxVerdict enriched for https://google.com
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "28"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: IPEnrichment.Value
            iscontext: true
          right:
            value:
              simple: ${CrowdStrike.Device.[0].ExternalIP}
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: CrowdStrike.Device.[0].ExternalIP
                      iscontext: true
                accessor: MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: CrowdStrike.Device.[0].ExternalIP
                      iscontext: true
                accessor: MaxVerdict
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: IPEnrichment.Status
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: IPEnrichment.TIMScore
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 3505
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "69":
    id: "69"
    taskid: c4b6c721-5930-48ef-8ac1-12b76e1908bb
    type: condition
    task:
      id: c4b6c721-5930-48ef-8ac1-12b76e1908bb
      version: -1
      name: Main Keys Exists
      description: MaxScore And MaxVerdict enriched for https://google.com
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "35"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: IPEnrichment.Value
            iscontext: true
          right:
            value:
              simple: ${CrowdStrike.Device.[0].ExternalIP}
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: CrowdStrike.Device.[0].ExternalIP
                      iscontext: true
                accessor: MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: CrowdStrike.Device.[0].ExternalIP
                      iscontext: true
                accessor: MaxVerdict
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: IPEnrichment.Status
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: IPEnrichment.TIMScore
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1555,
          "y": 4415
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "70":
    id: "70"
    taskid: 24fb6820-399c-42fa-8cbc-c81ef859896c
    type: title
    task:
      id: 24fb6820-399c-42fa-8cbc-c81ef859896c
      version: -1
      name: Case 1 - Bad Input
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "72"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 6220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "72":
    id: "72"
    taskid: 5fa5c45f-a2c4-4982-8b5c-cd94356f4acd
    type: regular
    task:
      id: 5fa5c45f-a2c4-4982-8b5c-cd94356f4acd
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "73"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 6390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "73":
    id: "73"
    taskid: dcec0abb-cfb7-4496-833b-eb53e7f01bd4
    type: regular
    task:
      id: dcec0abb-cfb7-4496-833b-eb53e7f01bd4
      version: -1
      name: Run ip enrichment script
      description: This script gathers ip reputation data from multiple integrations
        and returns an ip entity with consolidated information to the context.
      scriptName: ip-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#error#':
      - "74"
      '#none#':
      - "75"
    scriptarguments:
      additional_fields:
        simple: "true"
      external_enrichment:
        simple: "true"
      ip_list:
        simple: asdasd
      verbose:
        simple: "false"
    separatecontext: false
    continueonerror: true
    continueonerrortype: errorPath
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 6575
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "74":
    id: "74"
    taskid: c93a310a-08b5-4c04-85f1-2d8cf53df95d
    type: title
    task:
      id: c93a310a-08b5-4c04-85f1-2d8cf53df95d
      version: -1
      name: Case 2 - Bad Brand
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "76"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 715,
          "y": 6760
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "75":
    id: "75"
    taskid: b753796d-8363-472c-8af6-9691e2130214
    type: condition
    task:
      id: b753796d-8363-472c-8af6-9691e2130214
      version: -1
      name: Failure
      type: condition
      iscommand: false
      brand: ""
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: "1"
          right:
            value:
              simple: "2"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 7300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "76":
    id: "76"
    taskid: 54fa509d-e8f7-4a89-8177-5c50df7b7213
    type: regular
    task:
      id: 54fa509d-e8f7-4a89-8177-5c50df7b7213
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "77"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 715,
          "y": 6930
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "77":
    id: "77"
    taskid: 69e88a0c-0019-44ef-8f86-5ae7014b0901
    type: regular
    task:
      id: 69e88a0c-0019-44ef-8f86-5ae7014b0901
      version: -1
      name: Run ip enrichment script
      description: This script gathers ip reputation data from multiple integrations
        and returns an ip entity with consolidated information to the context.
      scriptName: ip-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#error#':
      - "78"
      '#none#':
      - "75"
    scriptarguments:
      additional_fields:
        simple: "true"
      brands:
        simple: asdasd
      external_enrichment:
        simple: "true"
      ip_list:
        simple: ${CrowdStrike.Device.[0].ExternalIP}
      verbose:
        simple: "false"
    separatecontext: false
    continueonerror: true
    continueonerrortype: errorPath
    view: |-
      {
        "position": {
          "x": 715,
          "y": 7115
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "78":
    id: "78"
    taskid: 8383fe64-27b9-4917-87bc-ec098ddc51f6
    type: title
    task:
      id: 8383fe64-27b9-4917-87bc-ec098ddc51f6
      version: -1
      name: Pass
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 7307.5
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "79":
    id: "79"
    taskid: 858e1467-ff90-41b6-8dfe-9c5cc7ded911
    type: regular
    task:
      id: 858e1467-ff90-41b6-8dfe-9c5cc7ded911
      version: -1
      name: Run ip enrichment script
      description: This script gathers ip reputation data from multiple integrations
        and returns an ip entity with consolidated information to the context.
      scriptName: ip-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "83"
      - "85"
      - "87"
    scriptarguments:
      additional_fields:
        simple: "true"
      external_enrichment:
        simple: "true"
      ip_list:
        simple: 1.1.1.1,8.8.8.8
      verbose:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 4955
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "83":
    id: "83"
    taskid: d9b26a42-81c8-45dc-8be4-2414edf3bdcb
    type: condition
    task:
      id: d9b26a42-81c8-45dc-8be4-2414edf3bdcb
      version: -1
      name: additional fields Exists
      description: Additional fields empty
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "86"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: IPEnrichment.Results.AdditionalFields
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "84":
    id: "84"
    taskid: 27cafb46-0895-47f7-88a8-161d663cfba2
    type: regular
    task:
      id: 27cafb46-0895-47f7-88a8-161d663cfba2
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "79"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 4770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "85":
    id: "85"
    taskid: 447fd465-0096-43a4-8a6c-dd43381ef16d
    type: condition
    task:
      id: 447fd465-0096-43a4-8a6c-dd43381ef16d
      version: -1
      name: Main Keys For 1.1.1.1
      description: MaxScore And MaxVerdict enriched for https://google.com
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "86"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: IPEnrichment.Value
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 1.1.1.1
            iscontext: true
          right:
            value:
              simple: 1.1.1.1
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 1.1.1.1
                accessor: MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 1.1.1.1
                accessor: MaxVerdict
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 1.1.1.1
                accessor: Status
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 1.1.1.1
                accessor: TIMScore
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 5140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "86":
    id: "86"
    taskid: 0b9ef512-b2a4-4337-82e2-255a0de5a12a
    type: title
    task:
      id: 0b9ef512-b2a4-4337-82e2-255a0de5a12a
      version: -1
      name: Case 6 One Invalid One Valid
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "90"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 5325
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "87":
    id: "87"
    taskid: 8211fef2-c110-4994-87b7-cca624b45499
    type: condition
    task:
      id: 8211fef2-c110-4994-87b7-cca624b45499
      version: -1
      name: Main Keys For 8.8.8.8
      description: MaxScore And MaxVerdict enriched for https://google.com
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "86"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: IPEnrichment.Value
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 8.8.8.8
            iscontext: true
          right:
            value:
              simple: 8.8.8.8
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 8.8.8.8
                accessor: MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 8.8.8.8
                accessor: MaxVerdict
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 8.8.8.8
                accessor: Status
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 8.8.8.8
                accessor: TIMScore
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 5140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "88":
    id: "88"
    taskid: ed407c6d-0c8d-4152-8087-c08085510c45
    type: regular
    task:
      id: ed407c6d-0c8d-4152-8087-c08085510c45
      version: -1
      name: Run ip enrichment script
      description: This script gathers ip reputation data from multiple integrations
        and returns an ip entity with consolidated information to the context.
      scriptName: ip-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "91"
      - "92"
    scriptarguments:
      additional_fields:
        simple: "false"
      external_enrichment:
        simple: "true"
      ip_list:
        simple: 1.1.1.1,8.8.8.8/24
      verbose:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 5680
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "90":
    id: "90"
    taskid: e9e1663b-81bd-4eb8-84d7-ed420e0bebdd
    type: regular
    task:
      id: e9e1663b-81bd-4eb8-84d7-ed420e0bebdd
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "88"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 5495
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "91":
    id: "91"
    taskid: 2075570c-7175-4650-8921-48c438d074c0
    type: condition
    task:
      id: 2075570c-7175-4650-8921-48c438d074c0
      version: -1
      name: Main Keys For 1.1.1.1
      description: MaxScore And MaxVerdict enriched for https://google.com
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "93"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: IPEnrichment.Value
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 1.1.1.1
            iscontext: true
          right:
            value:
              simple: 1.1.1.1
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 1.1.1.1
                accessor: MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 1.1.1.1
                accessor: MaxVerdict
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 1.1.1.1
                accessor: Status
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 1.1.1.1
                accessor: TIMScore
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 5865
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "92":
    id: "92"
    taskid: c8a914e7-805c-436f-88e6-5e99d24240c1
    type: condition
    task:
      id: c8a914e7-805c-436f-88e6-5e99d24240c1
      version: -1
      name: Invalid Entry for 8.8.8.8/24
      description: MaxScore And MaxVerdict enriched for https://google.com
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "93"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 8.8.8.8/24
                accessor: Value
            iscontext: true
          right:
            value:
              simple: 8.8.8.8/24
      - - operator: isEqualString
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 8.8.8.8/24
                accessor: Status
            iscontext: true
          right:
            value:
              simple: Error
      - - operator: isEqualString
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 8.8.8.8/24
                accessor: Message
            iscontext: true
          right:
            value:
              simple: Invalid
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 5865
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "93":
    id: "93"
    taskid: 13265901-bec1-486b-8bab-272eeb3f5dc0
    type: title
    task:
      id: 13265901-bec1-486b-8bab-272eeb3f5dc0
      version: -1
      name: Sad Flows
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "70"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 6050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "62_7_yes": 0.76
    },
    "paper": {
      "dimensions": {
        "height": 7325,
        "width": 2120,
        "x": 142.5,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
sourceplaybookid: 110f76de-5574-4854-853e-8675a01d8eb0
dirtyInputs: true
adopted: true
