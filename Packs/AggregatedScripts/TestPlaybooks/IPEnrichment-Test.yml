id: IPEnrichment-Test
version: -1
vcShouldKeepItemLegacyProdMachine: false
name: IPEnrichment-Test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: e701f0d0-6334-4271-8a44-04c0e088d0c3
    type: start
    task:
      id: e701f0d0-6334-4271-8a44-04c0e088d0c3
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1022.5,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: fee0cf2c-917a-4920-82a1-e264cf622601
    type: regular
    task:
      id: fee0cf2c-917a-4920-82a1-e264cf622601
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1022.5,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 1960d7ed-a66e-40e1-8d44-0d00bdc204c1
    type: regular
    task:
      id: 1960d7ed-a66e-40e1-8d44-0d00bdc204c1
      version: -1
      name: Run ip enrichment script
      description: This script gathers ip reputation data from multiple integrations
        and returns an ip entity with consolidated information to the context.
      scriptName: ip-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "13"
      - "14"
      - "15"
      - "60"
    scriptarguments:
      additional_fields:
        simple: "false"
      external_enrichment:
        simple: "false"
      ip_list:
        simple: ${CrowdStrike.Device.[0].ExternalIP}
      verbose:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1022.5,
          "y": 710
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: d33d2374-51a8-4544-8110-dc7ebd198cef
    type: title
    task:
      id: d33d2374-51a8-4544-8110-dc7ebd198cef
      version: -1
      name: Case 2 - External Enrichment
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "51"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1115,
          "y": 1390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: 7705f95e-9ca7-4b89-846e-1658f117a9d1
    type: title
    task:
      id: 7705f95e-9ca7-4b89-846e-1658f117a9d1
      version: -1
      name: Case 1 - Base
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1022.5,
          "y": 210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: 9d3655db-5069-4fc0-8cb0-c3a66682abad
    type: condition
    task:
      id: 9d3655db-5069-4fc0-8cb0-c3a66682abad
      version: -1
      name: Endpoint Data Returned
      description: Make sure Context output from wildfire
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "7"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: EndpointData.IPAddress
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: EndpointData.IPAddress
                      iscontext: true
                    right:
                      value:
                        simple: ${CrowdStrike.Device.[0].LocalIP}
                      iscontext: true
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: fe9a9470-9fd3-4a39-82b2-89b539b29677
    type: condition
    task:
      id: fe9a9470-9fd3-4a39-82b2-89b539b29677
      version: -1
      name: Main Keys Exists
      description: MaxScore And MaxVerdict enriched for https://google.com
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "7"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: IPEnrichment.Value
            iscontext: true
          right:
            value:
              simple: ${CrowdStrike.Device.[0].ExternalIP}
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: CrowdStrike.Device.[0].ExternalIP
                      iscontext: true
                accessor: MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: CrowdStrike.Device.[0].ExternalIP
                      iscontext: true
                accessor: MaxVerdict
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: IPEnrichment.TIMScore
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: c3b4a71b-8175-451b-8847-685174b51bc5
    type: condition
    task:
      id: c3b4a71b-8175-451b-8847-685174b51bc5
      version: -1
      name: No additional fields
      description: Additional fields empty
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "7"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              simple: IPEnrichment.Results.AdditionalFields
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 0bed4b91-4612-4e60-8136-95f5f3b91ef6
    type: title
    task:
      id: 0bed4b91-4612-4e60-8136-95f5f3b91ef6
      version: -1
      name: Case 3 - Brands No Internal
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "52"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1115,
          "y": 2570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: 9a5ddb38-39e3-4c1e-8118-00fead568a3e
    type: title
    task:
      id: 9a5ddb38-39e3-4c1e-8118-00fead568a3e
      version: -1
      name: Case 4 - External Enrichment + Additional Fields
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "59"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1237.5,
          "y": 3410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: 87ad9b3f-7e79-459c-861b-35f89d76bed5
    type: title
    task:
      id: 87ad9b3f-7e79-459c-861b-35f89d76bed5
      version: -1
      name: Case 5 Multiple Inputs
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "84"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1237.5,
          "y": 4250
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: bfe7c77b-7365-47c0-87cb-556a651dac43
    type: regular
    task:
      id: bfe7c77b-7365-47c0-87cb-556a651dac43
      version: -1
      name: Get Endpoint IP Address
      description: Gets the list of host group members.
      script: '|||cs-falcon-list-host-group-members'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1022.5,
          "y": 540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: c47639ba-75df-4a44-8bf7-6b56511d1dcb
    type: regular
    task:
      id: c47639ba-75df-4a44-8bf7-6b56511d1dcb
      version: -1
      name: Run ip enrichment script
      description: This script gathers ip reputation data from multiple integrations
        and returns an ip entity with consolidated information to the context.
      scriptName: ip-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "40"
      - "41"
      - "43"
      - "63"
      - "67"
    scriptarguments:
      additional_fields:
        simple: "false"
      external_enrichment:
        simple: "true"
      ip_list:
        simple: ${CrowdStrike.Device.[0].ExternalIP}
      verbose:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1115,
          "y": 1890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: 81be5600-1f0d-4d46-87b2-63867514ad94
    type: regular
    task:
      id: 81be5600-1f0d-4d46-87b2-63867514ad94
      version: -1
      name: Get Endpoint IP Address
      description: Gets the list of host group members.
      script: '|||cs-falcon-list-host-group-members'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "38"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1115,
          "y": 1720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: e2f2896c-83c4-456f-836a-a291a876dc47
    type: condition
    task:
      id: e2f2896c-83c4-456f-836a-a291a876dc47
      version: -1
      name: Both Indicator Exists
      description: Make sure the Virus Total indicator returned from tim
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "20"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: CrowdStrike.Device.[0].ExternalIP
                      iscontext: true
                accessor: Results.Brand
            iscontext: true
          right:
            value:
              simple: VirusTotal (API v3)
      - - operator: isEqualString
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: CrowdStrike.Device.[0].ExternalIP
                      iscontext: true
                accessor: Results.Brand
            iscontext: true
          right:
            value:
              simple: AlienVault OTX v2
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 255,
          "y": 2400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: 3c87cc95-0eda-467b-83a4-c6a66405dfc8
    type: condition
    task:
      id: 3c87cc95-0eda-467b-83a4-c6a66405dfc8
      version: -1
      name: Endpoint Data Returned
      description: Make sure Context output from wildfire
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "20"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: EndpointData.IPAddress
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: EndpointData.IPAddress
                      iscontext: true
                    right:
                      value:
                        simple: ${CrowdStrike.Device.[0].LocalIP}
                      iscontext: true
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 685,
          "y": 2400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: 6e5b5bcb-512e-4390-8337-18006e1bf1ee
    type: condition
    task:
      id: 6e5b5bcb-512e-4390-8337-18006e1bf1ee
      version: -1
      name: No additional fields
      description: Additional fields empty
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "20"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              simple: IPEnrichment.Results.AdditionalFields
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1115,
          "y": 2400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: 057eca65-f14b-499f-8c12-6362eada87d4
    type: regular
    task:
      id: 057eca65-f14b-499f-8c12-6362eada87d4
      version: -1
      name: Run ip enrichment script
      description: This script gathers ip reputation data from multiple integrations
        and returns an ip entity with consolidated information to the context.
      scriptName: ip-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "48"
      - "47"
      - "50"
      - "66"
      - "68"
    scriptarguments:
      additional_fields:
        simple: "false"
      brands:
        simple: VirusTotal (API v3)
      external_enrichment:
        simple: "false"
      ip_list:
        simple: ${CrowdStrike.Device.[0].ExternalIP}
      verbose:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1115,
          "y": 3070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: 66f17d8b-9a2b-4c09-8829-b7bdcab2cc0c
    type: regular
    task:
      id: 66f17d8b-9a2b-4c09-8829-b7bdcab2cc0c
      version: -1
      name: Get Endpoint IP Address
      description: Gets the list of host group members.
      script: '|||cs-falcon-list-host-group-members'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "45"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1115,
          "y": 2900
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: a08dcafe-d7b3-4353-8430-1dd23dcfa8d9
    type: condition
    task:
      id: a08dcafe-d7b3-4353-8430-1dd23dcfa8d9
      version: -1
      name: Virus Total Indicator Exists
      description: Make sure the Virus Total indicator returned from tim
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "28"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: CrowdStrike.Device.[0].ExternalIP
                      iscontext: true
                accessor: Results.Brand
            iscontext: true
          right:
            value:
              simple: VirusTotal (API v3)
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 3240
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: f36ad019-5a80-46dc-8a80-9f219dbcea11
    type: condition
    task:
      id: f36ad019-5a80-46dc-8a80-9f219dbcea11
      version: -1
      name: No Endpoint Data Returned
      description: Make sure Context output from wildfire
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "28"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              complex:
                root: EndpointData.IPAddress
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: EndpointData.IPAddress
                      iscontext: true
                    right:
                      value:
                        simple: ${CrowdStrike.Device.[0].LocalIP}
                      iscontext: true
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 3240
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: c8bdb931-433b-4d2e-816c-793c27c1e411
    type: condition
    task:
      id: c8bdb931-433b-4d2e-816c-793c27c1e411
      version: -1
      name: No additional fields
      description: Additional fields empty
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "28"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              simple: IPEnrichment.Results.AdditionalFields
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1022.5,
          "y": 3240
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: f26f80af-afec-4ce9-842f-f19451972184
    type: regular
    task:
      id: f26f80af-afec-4ce9-842f-f19451972184
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "39"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1115,
          "y": 1550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "52":
    id: "52"
    taskid: 590d31dc-4329-485c-8db9-2eafb12795ac
    type: regular
    task:
      id: 590d31dc-4329-485c-8db9-2eafb12795ac
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "46"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1115,
          "y": 2730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: b34e73cf-1e03-4729-8ee3-5532360894a6
    type: regular
    task:
      id: b34e73cf-1e03-4729-8ee3-5532360894a6
      version: -1
      name: Run ip enrichment script
      description: This script gathers ip reputation data from multiple integrations
        and returns an ip entity with consolidated information to the context.
      scriptName: ip-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "56"
      - "55"
      - "58"
      - "69"
    scriptarguments:
      additional_fields:
        simple: "true"
      external_enrichment:
        simple: "true"
      ip_list:
        simple: ${CrowdStrike.Device.[0].ExternalIP}
      verbose:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1237.5,
          "y": 3910
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "54":
    id: "54"
    taskid: fa80f04c-1b91-4263-8cf4-e592d67866cd
    type: regular
    task:
      id: fa80f04c-1b91-4263-8cf4-e592d67866cd
      version: -1
      name: Get Endpoint IP Address
      description: Gets the list of host group members.
      script: '|||cs-falcon-list-host-group-members'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "53"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1237.5,
          "y": 3740
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "55":
    id: "55"
    taskid: f251d7f1-7830-4357-80c0-330ccd0e0f2b
    type: condition
    task:
      id: f251d7f1-7830-4357-80c0-330ccd0e0f2b
      version: -1
      name: Virus Total Indicator Exists
      description: Make sure the Virus Total indicator returned from tim
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "35"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: CrowdStrike.Device.[0].ExternalIP
                      iscontext: true
                accessor: Results.Brand
            iscontext: true
          right:
            value:
              simple: VirusTotal (API v3)
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 4080
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "56":
    id: "56"
    taskid: d5ac41b1-2ff3-48ec-883a-792c92d6938d
    type: condition
    task:
      id: d5ac41b1-2ff3-48ec-883a-792c92d6938d
      version: -1
      name: Endpoint Data Returned
      description: Make sure Context output from wildfire
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "35"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: EndpointData.IPAddress
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: EndpointData.IPAddress
                      iscontext: true
                    right:
                      value:
                        simple: ${CrowdStrike.Device.[0].LocalIP}
                      iscontext: true
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 4080
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "58":
    id: "58"
    taskid: 37d78d7c-5ca7-4e69-85fc-573c4e5fbf47
    type: condition
    task:
      id: 37d78d7c-5ca7-4e69-85fc-573c4e5fbf47
      version: -1
      name: additional fields Exists
      description: Additional fields empty
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "35"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: IPEnrichment.Results.AdditionalFields
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1237.5,
          "y": 4080
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "59":
    id: "59"
    taskid: 911a09b5-a7a9-4a3e-8e4e-452fd6f09589
    type: regular
    task:
      id: 911a09b5-a7a9-4a3e-8e4e-452fd6f09589
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "54"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1237.5,
          "y": 3570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: 03c2c8a7-cad0-4866-8a5e-066e1620fe22
    type: condition
    task:
      id: 03c2c8a7-cad0-4866-8a5e-066e1620fe22
      version: -1
      name: Core Returned
      description: Make sure Context output from wildfire
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "61"
      "yes":
      - "7"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Core.AnalyticsPrevalence.Ip
            iscontext: true
          right:
            value:
              simple: https://google.com
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1882.5,
          "y": 880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    id: "61"
    taskid: af17a5d3-4dd1-42fd-87e7-9e190c4dcfec
    type: regular
    task:
      id: af17a5d3-4dd1-42fd-87e7-9e190c4dcfec
      version: -1
      name: Run core-get-IP-analytics-prevalence
      description: Get the prevalence of an ip, identified by ip_address.
      script: '|||core-get-IP-analytics-prevalence'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "62"
    scriptarguments:
      ip_address:
        simple: ${CrowdStrike.Device.[0].ExternalIP}
    separatecontext: false
    continueonerror: true
    continueonerrortype: errorPath
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 1050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "62":
    id: "62"
    taskid: 453b3dda-dbd4-4741-8148-5027a6086933
    type: condition
    task:
      id: 453b3dda-dbd4-4741-8148-5027a6086933
      version: -1
      name: Make sure analytics not exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "7"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              simple: Core.AnalyticsPrevalence.Ip
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 1220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: e2af38c6-0f1e-4d35-87c4-a91f0c3b1d0f
    type: condition
    task:
      id: e2af38c6-0f1e-4d35-87c4-a91f0c3b1d0f
      version: -1
      name: Core Returned
      description: Make sure Context output from wildfire
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "64"
      "yes":
      - "20"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Core.AnalyticsPrevalence.Ip
            iscontext: true
          right:
            value:
              simple: https://google.com
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1657.5,
          "y": 2060
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "64":
    id: "64"
    taskid: c41c6a49-a93d-4e82-8ef3-ec33ca563435
    type: regular
    task:
      id: c41c6a49-a93d-4e82-8ef3-ec33ca563435
      version: -1
      name: Run core-get-IP-analytics-prevalence
      description: Get the prevalence of an ip, identified by ip_address.
      script: '|||core-get-IP-analytics-prevalence'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "65"
    scriptarguments:
      ip_address:
        simple: ${CrowdStrike.Device.[0].ExternalIP}
    separatecontext: false
    continueonerror: true
    continueonerrortype: errorPath
    view: |-
      {
        "position": {
          "x": 1545,
          "y": 2230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "65":
    id: "65"
    taskid: fad567ac-8e5f-47b3-8b08-468685d87041
    type: condition
    task:
      id: fad567ac-8e5f-47b3-8b08-468685d87041
      version: -1
      name: Make sure analytics not exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "20"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              simple: Core.AnalyticsPrevalence.Ip
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1545,
          "y": 2400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "66":
    id: "66"
    taskid: c46442b7-d2fb-40f1-8ec3-8c2f71bee134
    type: condition
    task:
      id: c46442b7-d2fb-40f1-8ec3-8c2f71bee134
      version: -1
      name: Make sure analytics not exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "28"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              simple: Core.AnalyticsPrevalence.Ip
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1452.5,
          "y": 3240
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "67":
    id: "67"
    taskid: 7c3e6694-7352-44d0-814c-697d1d1731e3
    type: condition
    task:
      id: 7c3e6694-7352-44d0-814c-697d1d1731e3
      version: -1
      name: Main Keys Exists
      description: MaxScore And MaxVerdict enriched for https://google.com
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "20"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: IPEnrichment.Value
            iscontext: true
          right:
            value:
              simple: ${CrowdStrike.Device.[0].ExternalIP}
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: CrowdStrike.Device.[0].ExternalIP
                      iscontext: true
                accessor: MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: CrowdStrike.Device.[0].ExternalIP
                      iscontext: true
                accessor: MaxVerdict
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: IPEnrichment.Status
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: IPEnrichment.TIMScore
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1995,
          "y": 2400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "68":
    id: "68"
    taskid: 4e7a7b61-edff-4510-8a1b-20e78caaa2d4
    type: condition
    task:
      id: 4e7a7b61-edff-4510-8a1b-20e78caaa2d4
      version: -1
      name: Main Keys Exists
      description: MaxScore And MaxVerdict enriched for https://google.com
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "28"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: IPEnrichment.Value
            iscontext: true
          right:
            value:
              simple: ${CrowdStrike.Device.[0].ExternalIP}
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: CrowdStrike.Device.[0].ExternalIP
                      iscontext: true
                accessor: MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: CrowdStrike.Device.[0].ExternalIP
                      iscontext: true
                accessor: MaxVerdict
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: IPEnrichment.Status
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: IPEnrichment.TIMScore
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1882.5,
          "y": 3240
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "69":
    id: "69"
    taskid: 92a95a6d-b073-4a0e-8ed6-4bc4950c756c
    type: condition
    task:
      id: 92a95a6d-b073-4a0e-8ed6-4bc4950c756c
      version: -1
      name: Main Keys Exists
      description: MaxScore And MaxVerdict enriched for https://google.com
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "35"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: IPEnrichment.Value
            iscontext: true
          right:
            value:
              simple: ${CrowdStrike.Device.[0].ExternalIP}
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: CrowdStrike.Device.[0].ExternalIP
                      iscontext: true
                accessor: MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: CrowdStrike.Device.[0].ExternalIP
                      iscontext: true
                accessor: MaxVerdict
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: IPEnrichment.Status
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: IPEnrichment.TIMScore
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1667.5,
          "y": 4080
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "70":
    id: "70"
    taskid: 3505c3ba-b666-4cb5-82be-e98fe54337d2
    type: title
    task:
      id: 3505c3ba-b666-4cb5-82be-e98fe54337d2
      version: -1
      name: Case 1 - Bad Input
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "72"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1237.5,
          "y": 5080
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "72":
    id: "72"
    taskid: f4f8d8c1-e360-4138-8836-7118f7a0d147
    type: regular
    task:
      id: f4f8d8c1-e360-4138-8836-7118f7a0d147
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "73"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1237.5,
          "y": 5240
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "73":
    id: "73"
    taskid: 8cd46a5f-a49d-4276-8ba9-68a2db83f43b
    type: regular
    task:
      id: 8cd46a5f-a49d-4276-8ba9-68a2db83f43b
      version: -1
      name: Run ip enrichment script
      description: This script gathers ip reputation data from multiple integrations
        and returns an ip entity with consolidated information to the context.
      scriptName: ip-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#error#':
      - "74"
      '#none#':
      - "75"
    scriptarguments:
      additional_fields:
        simple: "true"
      external_enrichment:
        simple: "true"
      ip_list:
        simple: asdasd
      verbose:
        simple: "false"
    separatecontext: false
    continueonerror: true
    continueonerrortype: errorPath
    view: |-
      {
        "position": {
          "x": 1237.5,
          "y": 5410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "74":
    id: "74"
    taskid: f15bacae-9993-40f9-8287-d195449ec426
    type: title
    task:
      id: f15bacae-9993-40f9-8287-d195449ec426
      version: -1
      name: Case 2 - Bad Brand
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "76"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 827.5,
          "y": 5580
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "75":
    id: "75"
    taskid: 6f7b1f08-4cc5-41a7-8cd3-ffb0f177a776
    type: condition
    task:
      id: 6f7b1f08-4cc5-41a7-8cd3-ffb0f177a776
      version: -1
      name: Failure
      type: condition
      iscommand: false
      brand: ""
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: "1"
          right:
            value:
              simple: "2"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1237.5,
          "y": 6080
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "76":
    id: "76"
    taskid: 89e23a18-ecbf-4b85-8634-69a768574721
    type: regular
    task:
      id: 89e23a18-ecbf-4b85-8634-69a768574721
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "77"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 827.5,
          "y": 5740
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "77":
    id: "77"
    taskid: 1f2712e6-6d56-4ea2-8fb3-63fafe57ae56
    type: regular
    task:
      id: 1f2712e6-6d56-4ea2-8fb3-63fafe57ae56
      version: -1
      name: Run ip enrichment script
      description: This script gathers ip reputation data from multiple integrations
        and returns an ip entity with consolidated information to the context.
      scriptName: ip-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#error#':
      - "78"
      '#none#':
      - "75"
    scriptarguments:
      additional_fields:
        simple: "true"
      brands:
        simple: asdasd
      external_enrichment:
        simple: "true"
      ip_list:
        simple: ${CrowdStrike.Device.[0].ExternalIP}
      verbose:
        simple: "false"
    separatecontext: false
    continueonerror: true
    continueonerrortype: errorPath
    view: |-
      {
        "position": {
          "x": 827.5,
          "y": 5910
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "78":
    id: "78"
    taskid: 1eed142a-b25e-4d64-8895-ca646d143ed9
    type: title
    task:
      id: 1eed142a-b25e-4d64-8895-ca646d143ed9
      version: -1
      name: Pass
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 6085
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "79":
    id: "79"
    taskid: 25b42dcb-43a1-4d93-8bd9-70e4fbda7507
    type: regular
    task:
      id: 25b42dcb-43a1-4d93-8bd9-70e4fbda7507
      version: -1
      name: Run ip enrichment script
      description: This script gathers ip reputation data from multiple integrations
        and returns an ip entity with consolidated information to the context.
      scriptName: ip-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "83"
      - "85"
      - "87"
    scriptarguments:
      additional_fields:
        simple: "true"
      external_enrichment:
        simple: "true"
      ip_list:
        simple: 1.1.1.1,8.8.8.8
      verbose:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1237.5,
          "y": 4580
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "83":
    id: "83"
    taskid: 0f4aea93-7f79-4075-8027-d432c7c5c771
    type: condition
    task:
      id: 0f4aea93-7f79-4075-8027-d432c7c5c771
      version: -1
      name: additional fields Exists
      description: Additional fields empty
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "86"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: IPEnrichment.Results.AdditionalFields
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 4750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "84":
    id: "84"
    taskid: 52de41e0-6289-424e-8563-fe90bdf03a50
    type: regular
    task:
      id: 52de41e0-6289-424e-8563-fe90bdf03a50
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "79"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1237.5,
          "y": 4410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "85":
    id: "85"
    taskid: 26559a02-a000-4c16-8c17-9075ed861a97
    type: condition
    task:
      id: 26559a02-a000-4c16-8c17-9075ed861a97
      version: -1
      name: Main Keys For 1.1.1.1
      description: MaxScore And MaxVerdict enriched for https://google.com
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "86"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: IPEnrichment.Value
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 1.1.1.1
            iscontext: true
          right:
            value:
              simple: 1.1.1.1
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 1.1.1.1
                accessor: MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 1.1.1.1
                accessor: MaxVerdict
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 1.1.1.1
                accessor: Status
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 1.1.1.1
                accessor: TIMScore
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1022.5,
          "y": 4750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "86":
    id: "86"
    taskid: b2dbb1c8-6915-4d1f-8b00-6a79e50ac180
    type: title
    task:
      id: b2dbb1c8-6915-4d1f-8b00-6a79e50ac180
      version: -1
      name: Sad Flows
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "70"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1237.5,
          "y": 4920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "87":
    id: "87"
    taskid: 9762a46b-6b0d-4915-8073-262332146640
    type: condition
    task:
      id: 9762a46b-6b0d-4915-8073-262332146640
      version: -1
      name: Main Keys For 8.8.8.8
      description: MaxScore And MaxVerdict enriched for https://google.com
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "86"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: IPEnrichment.Value
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 8.8.8.8
            iscontext: true
          right:
            value:
              simple: 8.8.8.8
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 8.8.8.8
                accessor: MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 8.8.8.8
                accessor: MaxVerdict
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 8.8.8.8
                accessor: Status
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: IPEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: IPEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: 8.8.8.8
                accessor: TIMScore
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1452.5,
          "y": 4750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "62_7_yes": 0.76
    },
    "paper": {
      "dimensions": {
        "height": 6100,
        "width": 2212.5,
        "x": 162.5,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
sourceplaybookid: 110f76de-5574-4854-853e-8675a01d8eb0
dirtyInputs: true
marketplaces:
- platform
- marketplacev2
- xsoar