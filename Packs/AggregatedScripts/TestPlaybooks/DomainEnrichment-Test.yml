id: DomainEnrichment-Test
version: -1
vcShouldKeepItemLegacyProdMachine: false
name: DomainEnrichment-Test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: ab0b0828-8903-445a-84c6-41b580146b48
    type: start
    task:
      id: ab0b0828-8903-445a-84c6-41b580146b48
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 3f0bc1c1-2b6c-4736-8c6d-d16fa0172411
    type: regular
    task:
      id: 3f0bc1c1-2b6c-4736-8c6d-d16fa0172411
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 2b1e42f0-5468-42d9-89cf-9077fe40b0e4
    type: regular
    task:
      id: 2b1e42f0-5468-42d9-89cf-9077fe40b0e4
      version: -1
      name: Run domain enrichment script
      description: This script gathers domain reputation data from multiple integrations
        and returns a "DomainEnrichment" object with consolidated information to the
        context output.
      scriptName: domain-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "6"
      - "14"
      - "15"
      - "13"
    scriptarguments:
      additional_fields:
        simple: "false"
      domain_list:
        simple: google.com
      external_enrichment:
        simple: "false"
      verbose:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 9ab5d385-ebb9-4e41-860e-18f66ab99048
    type: condition
    task:
      id: 9ab5d385-ebb9-4e41-860e-18f66ab99048
      version: -1
      name: Virus Total Indicator Exists
      description: Make sure the Virus Total indicator returned from tim
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "7"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: DomainEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: google.com
                accessor: Results.Brand
            iscontext: true
          right:
            value:
              simple: VirusTotal (API v3)
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: 3400d958-0b2a-40f7-8054-68ca23d28c40
    type: title
    task:
      id: 3400d958-0b2a-40f7-8054-68ca23d28c40
      version: -1
      name: Case 2 - Base Unknown URL
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "58"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 1220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: 685e8aa2-cc1b-4a1d-8889-bb8203661002
    type: title
    task:
      id: 685e8aa2-cc1b-4a1d-8889-bb8203661002
      version: -1
      name: Case 1 - Base Make Sure Internal is running
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: 22e0517b-6243-4c61-8ad9-ca3103d32770
    type: condition
    task:
      id: 22e0517b-6243-4c61-8ad9-ca3103d32770
      version: -1
      name: Core Returned
      description: Make sure Context output from wildfire
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "36"
      "yes":
      - "7"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Core.AnalyticsPrevalence.Domain
            iscontext: true
          right:
            value:
              simple: https://google.com
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1452.5,
          "y": 710
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 54a45b22-9d09-40be-9282-b731d7ab3b95
    type: condition
    task:
      id: 54a45b22-9d09-40be-9282-b731d7ab3b95
      version: -1
      name: Is Indicator Enrichment
      description: MaxScore And MaxVerdict enriched for https://google.com
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "7"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DomainEnrichment.Value
            iscontext: true
          right:
            value:
              simple: google.com
      - - operator: isExists
          left:
            value:
              complex:
                root: DomainEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: google.com
                accessor: MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: DomainEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: google.com
                accessor: MaxVerdict
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: DomainEnrichment.Status
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              complex:
                root: DomainEnrichment.Results.Brand
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: TIM
            iscontext: true
          right:
            value:
              simple: TIM
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 2af2d3c1-2aef-4b18-8d4c-e8d4f2935812
    type: condition
    task:
      id: 2af2d3c1-2aef-4b18-8d4c-e8d4f2935812
      version: -1
      name: No additional fields
      description: Additional fields empty
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "7"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              simple: DomainEnrichment.Results.AdditionalFields
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: ca296623-123e-4b58-83a0-74186026bff3
    type: title
    task:
      id: ca296623-123e-4b58-83a0-74186026bff3
      version: -1
      name: Case 5 - Brands No Internal
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "21"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2900
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: 39e8320f-99a6-4524-8304-0fc4c78c3ad8
    type: regular
    task:
      id: 39e8320f-99a6-4524-8304-0fc4c78c3ad8
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3060
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: 06c482a0-3942-43f4-83f4-1885ea12965a
    type: regular
    task:
      id: 06c482a0-3942-43f4-83f4-1885ea12965a
      version: -1
      name: Run domain enrichment script
      description: This script gathers domain reputation data from multiple integrations
        and returns a "DomainEnrichment" object with consolidated information to the
        context output.
      scriptName: domain-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "46"
      - "45"
      - "47"
      - "48"
    scriptarguments:
      additional_fields:
        simple: "false"
      brands:
        simple: AlienVault OTX v2
      domain_list:
        simple: google.com
      external_enrichment:
        simple: "true"
      verbose:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: cb976cb4-e6de-4bfc-8da2-078a1e6aedd4
    type: title
    task:
      id: cb976cb4-e6de-4bfc-8da2-078a1e6aedd4
      version: -1
      name: Case 6 - External Enrichment + Additional Fields
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: cf67494e-ef5e-41ae-8769-b89f949613e6
    type: regular
    task:
      id: cf67494e-ef5e-41ae-8769-b89f949613e6
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: b0087be1-a2b9-423b-83f6-7a5ed16ba14f
    type: regular
    task:
      id: b0087be1-a2b9-423b-83f6-7a5ed16ba14f
      version: -1
      name: Run domain enrichment script
      description: This script gathers domain reputation data from multiple integrations
        and returns a "DomainEnrichment" object with consolidated information to the
        context output.
      scriptName: domain-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "50"
      - "49"
      - "51"
    scriptarguments:
      additional_fields:
        simple: "true"
      domain_list:
        simple: google.com
      external_enrichment:
        simple: "true"
      verbose:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3900
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: cd2ff690-d70d-4f50-86f1-560f4db054be
    type: title
    task:
      id: cd2ff690-d70d-4f50-86f1-560f4db054be
      version: -1
      name: Case 7 - Multiple Inputs
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "80"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 4240
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: 97d8b7af-003a-4218-81a8-2ef8e387483e
    type: regular
    task:
      id: 97d8b7af-003a-4218-81a8-2ef8e387483e
      version: -1
      name: Run core-get-domain-analytics-prevalence
      description: Get the prevalence of a domain, identified by domain_name.
      script: '|||core-get-domain-analytics-prevalence'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "38"
    scriptarguments:
      domain_name:
        simple: google.com
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: b45057ef-0b55-4114-844d-93897bdb9942
    type: condition
    task:
      id: b45057ef-0b55-4114-844d-93897bdb9942
      version: -1
      name: Make sure analytics not exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "7"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              simple: Core.AnalyticsPrevalence.Domain
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: 79cc057c-8e69-41a0-8c8e-6b0c3b94958c
    type: condition
    task:
      id: 79cc057c-8e69-41a0-8c8e-6b0c3b94958c
      version: -1
      name: Both Indicator Exists
      description: Make sure the Virus Total indicator returned from tim
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "28"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: DomainEnrichment.Results.Brand
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: AlienVault OTX v2
            iscontext: true
          right:
            value:
              simple: AlienVault OTX v2
      - - operator: isEqualString
          left:
            value:
              complex:
                root: DomainEnrichment.Results.Brand
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: VirusTotal (API v3)
            iscontext: true
          right:
            value:
              simple: VirusTotal (API v3)
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 3400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: 488376d2-e22c-4030-81a3-50b92694eb47
    type: condition
    task:
      id: 488376d2-e22c-4030-81a3-50b92694eb47
      version: -1
      name: Is Indicator Enrichment
      description: MaxScore And MaxVerdict enriched for https://google.com
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "28"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DomainEnrichment.Value
            iscontext: true
          right:
            value:
              simple: google.com
      - - operator: isExists
          left:
            value:
              complex:
                root: DomainEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: google.com
                accessor: MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: DomainEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: google.com
                accessor: MaxVerdict
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 3400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: 94744203-7f19-434c-8e13-ea5505ed2b64
    type: condition
    task:
      id: 94744203-7f19-434c-8e13-ea5505ed2b64
      version: -1
      name: No additional fields
      description: Additional fields empty
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "28"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              simple: DomainEnrichment.Results.AdditionalFields
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1022.5,
          "y": 3400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: de993709-4f4a-4af5-881b-4cafe54fa203
    type: condition
    task:
      id: de993709-4f4a-4af5-881b-4cafe54fa203
      version: -1
      name: Make sure analytics not exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "28"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              simple: Core.AnalyticsPrevalence.Domain
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1452.5,
          "y": 3400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: d6dcc632-f40f-413b-8f26-cdad9c472cd8
    type: condition
    task:
      id: d6dcc632-f40f-413b-8f26-cdad9c472cd8
      version: -1
      name: Both Indicator Exists
      description: Make sure the Virus Total indicator returned from tim
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "35"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: DomainEnrichment.Results.Brand
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: AlienVault OTX v2
            iscontext: true
          right:
            value:
              simple: AlienVault OTX v2
      - - operator: isEqualString
          left:
            value:
              complex:
                root: DomainEnrichment.Results.Brand
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: VirusTotal (API v3)
            iscontext: true
          right:
            value:
              simple: VirusTotal (API v3)
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 4070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: e2a6ecfd-e2cc-418d-82ae-63ec480afdb1
    type: condition
    task:
      id: e2a6ecfd-e2cc-418d-82ae-63ec480afdb1
      version: -1
      name: Is Indicator Enrichment
      description: MaxScore And MaxVerdict enriched for https://google.com
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "35"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DomainEnrichment.Value
            iscontext: true
          right:
            value:
              simple: google.com
      - - operator: isExists
          left:
            value:
              complex:
                root: DomainEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: google.com
                accessor: MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: DomainEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: google.com
                accessor: MaxVerdict
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 4070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: a6e392e8-55ad-4406-8381-5b1706a8509c
    type: condition
    task:
      id: a6e392e8-55ad-4406-8381-5b1706a8509c
      version: -1
      name: Additional fields Exists
      description: Additional fields empty
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "35"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: DomainEnrichment.Results.AdditionalFields
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1237.5,
          "y": 4070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "58":
    id: "58"
    taskid: 563814ca-57f0-40b9-89ea-0bd70e6f80be
    type: regular
    task:
      id: 563814ca-57f0-40b9-89ea-0bd70e6f80be
      version: -1
      name: Delete Context
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "59"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 1380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "59":
    id: "59"
    taskid: 9702fe91-c3a6-4e71-85a0-ab7c381922d2
    type: regular
    task:
      id: 9702fe91-c3a6-4e71-85a0-ab7c381922d2
      version: -1
      name: Get Time
      description: |
        Retrieves the current date and time.
      scriptName: GetTime
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "60"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 1550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: 3a0b9130-ca9f-4f8c-882f-255d65873acb
    type: regular
    task:
      id: 3a0b9130-ca9f-4f8c-882f-255d65873acb
      version: -1
      name: Run Domain Enrichment
      description: This script gathers domain reputation data from multiple integrations
        and returns a "DomainEnrichment" object with consolidated information to the
        context output.
      scriptName: domain-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "61"
      - "62"
      - "63"
    scriptarguments:
      additional_fields:
        simple: "false"
      brands:
        simple: AlienVault OTX v2
      domain_list:
        complex:
          root: TimeNowUnix
          transformers:
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: .com
      external_enrichment:
        simple: "false"
      verbose:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 1720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    id: "61"
    taskid: 42dd0fbc-270d-4e56-8dd3-3a64905044fd
    type: condition
    task:
      id: 42dd0fbc-270d-4e56-8dd3-3a64905044fd
      version: -1
      name: Main Keys Exists With No Results
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "64"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DomainEnrichment.Value
            iscontext: true
          right:
            value:
              complex:
                root: TimeNowUnix
                transformers:
                - operator: concat
                  args:
                    prefix: {}
                    suffix:
                      value:
                        simple: .com
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: DomainEnrichment.MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: DomainEnrichment.MaxVerdict
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: DomainEnrichment.Results
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: DomainEnrichment.TIMScore
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: DomainEnrichment.Status
            iscontext: true
          right:
            value:
              simple: Fresh
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "62":
    id: "62"
    taskid: 6aeea833-7872-48a5-803b-e7fa06cc151a
    type: condition
    task:
      id: 6aeea833-7872-48a5-803b-e7fa06cc151a
      version: -1
      name: No Additional Fields
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "64"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              simple: DomainEnrichment.Results.AdditionalFields
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: ad9ff4bd-477a-41d4-8753-be1a81eacc8c
    type: condition
    task:
      id: ad9ff4bd-477a-41d4-8753-be1a81eacc8c
      version: -1
      name: AlienVault OTX v2 Result Only Exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "64"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DomainEnrichment.Results.Brand
            iscontext: true
          right:
            value:
              simple: AlienVault OTX v2
      - - operator: isEqualString
          left:
            value:
              complex:
                root: DomainEnrichment.Results
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: AlienVault OTX v2
                accessor: Name
            iscontext: true
          right:
            value:
              complex:
                root: TimeNowUnix
                transformers:
                - operator: concat
                  args:
                    prefix: {}
                    suffix:
                      value:
                        simple: .com
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: DomainEnrichment.Results
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: AlienVault OTX v2
                accessor: Score
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: DomainEnrichment.Results
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: AlienVault OTX v2
                accessor: Verdict
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "64":
    id: "64"
    taskid: e89eb3f9-7693-4a84-8513-fee85ef05c3b
    type: title
    task:
      id: e89eb3f9-7693-4a84-8513-fee85ef05c3b
      version: -1
      name: Case 4 - Unknown Domain External Enrichment
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "65"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 2060
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "65":
    id: "65"
    taskid: 192c7644-c72e-4a04-86cc-5787ae781526
    type: regular
    task:
      id: 192c7644-c72e-4a04-86cc-5787ae781526
      version: -1
      name: Delete Context
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "66"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 2220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "66":
    id: "66"
    taskid: 70b3c02e-4d31-4687-8166-e2184977314d
    type: regular
    task:
      id: 70b3c02e-4d31-4687-8166-e2184977314d
      version: -1
      name: Get Time
      description: |
        Retrieves the current date and time.
      scriptName: GetTime
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "67"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 2390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "67":
    id: "67"
    taskid: 6f5c9de0-b46b-48e9-8208-119adc986bb0
    type: regular
    task:
      id: 6f5c9de0-b46b-48e9-8208-119adc986bb0
      version: -1
      name: Run Domain Enrichment
      description: This script gathers domain reputation data from multiple integrations
        and returns a "DomainEnrichment" object with consolidated information to the
        context output.
      scriptName: domain-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "68"
      - "69"
      - "70"
      - "71"
    scriptarguments:
      additional_fields:
        simple: "false"
      domain_list:
        complex:
          root: TimeNowUnix
          transformers:
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: .com
      external_enrichment:
        simple: "true"
      verbose:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 2560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "68":
    id: "68"
    taskid: 9085ea0e-10a5-45bd-8792-ba454858cbb2
    type: condition
    task:
      id: 9085ea0e-10a5-45bd-8792-ba454858cbb2
      version: -1
      name: Main Keys Exists With No Results
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "20"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DomainEnrichment.Value
            iscontext: true
          right:
            value:
              complex:
                root: TimeNowUnix
                transformers:
                - operator: concat
                  args:
                    prefix: {}
                    suffix:
                      value:
                        simple: .com
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: DomainEnrichment.MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: DomainEnrichment.MaxVerdict
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: DomainEnrichment.Results
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: DomainEnrichment.TIMScore
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: DomainEnrichment.Status
            iscontext: true
          right:
            value:
              simple: Fresh
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "69":
    id: "69"
    taskid: 6c6912b3-77a0-42b7-8836-0bfa6205a033
    type: condition
    task:
      id: 6c6912b3-77a0-42b7-8836-0bfa6205a033
      version: -1
      name: No Additional Fields
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "20"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              simple: DomainEnrichment.Results.AdditionalFields
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 2730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "70":
    id: "70"
    taskid: 61e3ad30-33f2-4f26-8aa0-abb5642021d5
    type: condition
    task:
      id: 61e3ad30-33f2-4f26-8aa0-abb5642021d5
      version: -1
      name: AlienVault OTX v2 Result Exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "20"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: DomainEnrichment.Results
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: AlienVault OTX v2
                accessor: Name
            iscontext: true
          right:
            value:
              complex:
                root: TimeNowUnix
                transformers:
                - operator: concat
                  args:
                    prefix: {}
                    suffix:
                      value:
                        simple: .com
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: DomainEnrichment.Results
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: AlienVault OTX v2
                accessor: Score
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: DomainEnrichment.Results
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: AlienVault OTX v2
                accessor: Verdict
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 2730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "71":
    id: "71"
    taskid: ff5ccde6-df7a-4c86-81f2-bda068eb7d2b
    type: condition
    task:
      id: ff5ccde6-df7a-4c86-81f2-bda068eb7d2b
      version: -1
      name: VirusTotal (API v3) Result Exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "20"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: DomainEnrichment.Results
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: VirusTotal (API v3)
                accessor: Name
            iscontext: true
          right:
            value:
              complex:
                root: TimeNowUnix
                transformers:
                - operator: concat
                  args:
                    prefix: {}
                    suffix:
                      value:
                        simple: .com
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: DomainEnrichment.Results
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: VirusTotal (API v3)
                accessor: Score
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: DomainEnrichment.Results
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: VirusTotal (API v3)
                accessor: Verdict
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1555,
          "y": 2730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "72":
    id: "72"
    taskid: 8c630a7d-ffcb-4d60-827d-f557d841eb1f
    type: regular
    task:
      id: 8c630a7d-ffcb-4d60-827d-f557d841eb1f
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "73"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 5230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "73":
    id: "73"
    taskid: bccc5573-12b7-44d6-8010-0e90687baff3
    type: regular
    task:
      id: bccc5573-12b7-44d6-8010-0e90687baff3
      version: -1
      name: Run domain enrichment script
      description: This script gathers domain reputation data from multiple integrations
        and returns a "DomainEnrichment" object with consolidated information to the
        context output.
      scriptName: domain-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#error#':
      - "76"
      '#none#':
      - "75"
    scriptarguments:
      additional_fields:
        simple: "true"
      domain_list:
        simple: asdasdasd
      external_enrichment:
        simple: "true"
      verbose:
        simple: "false"
    separatecontext: false
    continueonerror: true
    continueonerrortype: errorPath
    view: |-
      {
        "position": {
          "x": 910,
          "y": 5400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "74":
    id: "74"
    taskid: 8137c69d-092c-4024-8e9d-cc8ae3c709fc
    type: title
    task:
      id: 8137c69d-092c-4024-8e9d-cc8ae3c709fc
      version: -1
      name: Case 1 - Bad Input
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "72"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 5070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "75":
    id: "75"
    taskid: 9d04b5a0-6186-4bc0-8903-241245023f50
    type: condition
    task:
      id: 9d04b5a0-6186-4bc0-8903-241245023f50
      version: -1
      name: Failure
      type: condition
      iscommand: false
      brand: ""
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: "1"
          right:
            value:
              simple: "2"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1022.5,
          "y": 6070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "76":
    id: "76"
    taskid: 57dd4e49-204f-41d0-866b-073037811289
    type: title
    task:
      id: 57dd4e49-204f-41d0-866b-073037811289
      version: -1
      name: Case 2 - Bad Brand
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "77"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 612.5,
          "y": 5570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "77":
    id: "77"
    taskid: d7cdddec-6d03-4afa-8ac6-99b5de558a22
    type: regular
    task:
      id: d7cdddec-6d03-4afa-8ac6-99b5de558a22
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "78"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 612.5,
          "y": 5730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "78":
    id: "78"
    taskid: bf71b7c3-c24f-445e-8125-0649b831da41
    type: regular
    task:
      id: bf71b7c3-c24f-445e-8125-0649b831da41
      version: -1
      name: Run domain enrichment script
      description: This script gathers domain reputation data from multiple integrations
        and returns a "DomainEnrichment" object with consolidated information to the
        context output.
      scriptName: domain-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#error#':
      - "79"
      '#none#':
      - "75"
    scriptarguments:
      additional_fields:
        simple: "true"
      brands:
        simple: asdasd
      domain_list:
        simple: google.com
      external_enrichment:
        simple: "true"
      verbose:
        simple: "false"
    separatecontext: false
    continueonerror: true
    continueonerrortype: errorPath
    view: |-
      {
        "position": {
          "x": 612.5,
          "y": 5900
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "79":
    id: "79"
    taskid: 6c8b9f57-a2b3-4acc-8172-3557ff38e5b2
    type: title
    task:
      id: 6c8b9f57-a2b3-4acc-8172-3557ff38e5b2
      version: -1
      name: Pass
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 6075
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "80":
    id: "80"
    taskid: 4387dccd-5040-4503-8b15-04d773578e98
    type: regular
    task:
      id: 4387dccd-5040-4503-8b15-04d773578e98
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "81"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 4400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "81":
    id: "81"
    taskid: 0e209274-a22a-46c5-8419-61607edd37bb
    type: regular
    task:
      id: 0e209274-a22a-46c5-8419-61607edd37bb
      version: -1
      name: Run domain enrichment script
      description: This script gathers domain reputation data from multiple integrations
        and returns a "DomainEnrichment" object with consolidated information to the
        context output.
      scriptName: domain-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "83"
      - "84"
      - "86"
    scriptarguments:
      additional_fields:
        simple: "true"
      domain_list:
        simple: google.com,facebook.com
      external_enrichment:
        simple: "true"
      verbose:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 4570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "83":
    id: "83"
    taskid: dfda5488-4d61-4813-85c2-40a2f2a0f215
    type: condition
    task:
      id: dfda5488-4d61-4813-85c2-40a2f2a0f215
      version: -1
      name: Facebook exists
      description: MaxScore And MaxVerdict enriched for https://google.com
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "85"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: DomainEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: facebook.com
                accessor: Value
            iscontext: true
          right:
            value:
              simple: facebook.com
      - - operator: isExists
          left:
            value:
              complex:
                root: DomainEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: facebook.com
                accessor: MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: DomainEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: facebook.com
                accessor: MaxVerdict
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 4740
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "84":
    id: "84"
    taskid: 84be4963-44e3-4d8a-89d9-0a1a546fdf5e
    type: condition
    task:
      id: 84be4963-44e3-4d8a-89d9-0a1a546fdf5e
      version: -1
      name: Additional fields Exists
      description: Additional fields empty
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "85"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: DomainEnrichment.Results.AdditionalFields
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 4740
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "85":
    id: "85"
    taskid: b816d2c2-31d2-4b6e-8a52-c77aa4d09f43
    type: title
    task:
      id: b816d2c2-31d2-4b6e-8a52-c77aa4d09f43
      version: -1
      name: Sad Flows
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "74"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 4910
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "86":
    id: "86"
    taskid: 646c6cf5-676a-459d-87a7-114f3997b1c4
    type: condition
    task:
      id: 646c6cf5-676a-459d-87a7-114f3997b1c4
      version: -1
      name: Google exists
      description: MaxScore And MaxVerdict enriched for https://google.com
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "85"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: DomainEnrichment.Value
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: google.com
            iscontext: true
          right:
            value:
              simple: google.com
      - - operator: isExists
          left:
            value:
              complex:
                root: DomainEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: google.com
                accessor: MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: DomainEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: google.com
                accessor: MaxVerdict
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1237.5,
          "y": 4740
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 6090,
        "width": 1885,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
sourceplaybookid: 110f76de-5574-4854-853e-8675a01d8eb0
quiet: true
dirtyInputs: true
marketplaces:
- platform
- marketplacev2
- xsoar