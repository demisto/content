id: DomainEnrichment-Test
version: -1
vcShouldKeepItemLegacyProdMachine: false
name: DomainEnrichment-Test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: aaf2c15f-8e4b-4719-8296-789c29ab487c
    type: start
    task:
      id: aaf2c15f-8e4b-4719-8296-789c29ab487c
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 95e29254-64b9-4a4a-8721-7c2b67954833
    type: regular
    task:
      id: 95e29254-64b9-4a4a-8721-7c2b67954833
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 4f6eaaab-88cc-4eff-a489-6443ce905628
    type: regular
    task:
      id: 4f6eaaab-88cc-4eff-a489-6443ce905628
      version: -1
      name: Run domain enrichment script
      description: This script gathers domain reputation data from multiple integrations
        and returns a "DomainEnrichment" object with consolidated information to the
        context output.
      scriptName: domain-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "6"
      - "14"
      - "15"
      - "13"
    scriptarguments:
      additional_fields:
        simple: "false"
      brands:
        simple: VirusTotal (API v3), Cortex Core - IR
      domain_list:
        simple: google.com
      external_enrichment:
        simple: "false"
      verbose:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 8f837824-3227-4196-aa82-083af42cd960
    type: condition
    task:
      id: 8f837824-3227-4196-aa82-083af42cd960
      version: -1
      name: Virus Total Indicator Exists
      description: Make sure the Virus Total indicator returned from tim
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "7"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: DomainEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: google.com
                accessor: Results.Brand
            iscontext: true
          right:
            value:
              simple: VirusTotal (API v3)
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: 372abe04-f2b5-4777-8278-ef79802ba5a2
    type: title
    task:
      id: 372abe04-f2b5-4777-8278-ef79802ba5a2
      version: -1
      name: Case 2 - Base Unknown URL
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "58"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 1220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: a5715f46-60fe-4b72-88c7-2c182dbe7716
    type: title
    task:
      id: a5715f46-60fe-4b72-88c7-2c182dbe7716
      version: -1
      name: Case 1 - Base Make Sure Internal is running
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: b498492e-2e1d-4788-83e7-ccccc83aa8bf
    type: condition
    task:
      id: b498492e-2e1d-4788-83e7-ccccc83aa8bf
      version: -1
      name: Core Returned
      description: Make sure Context output from wildfire
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "36"
      "yes":
      - "7"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Core.AnalyticsPrevalence.Domain
            iscontext: true
          right:
            value:
              simple: https://google.com
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1452.5,
          "y": 710
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 6af06c2b-0e4b-4f10-83b9-2bfdf45af26b
    type: condition
    task:
      id: 6af06c2b-0e4b-4f10-83b9-2bfdf45af26b
      version: -1
      name: Is Indicator Enrichment
      description: MaxScore And MaxVerdict enriched for https://google.com
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "7"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DomainEnrichment.Value
            iscontext: true
          right:
            value:
              simple: google.com
      - - operator: isExists
          left:
            value:
              complex:
                root: DomainEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: google.com
                accessor: MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: DomainEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: google.com
                accessor: MaxVerdict
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: DomainEnrichment.Status
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              complex:
                root: DomainEnrichment.Results.Brand
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: TIM
            iscontext: true
          right:
            value:
              simple: TIM
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 44ff341b-5a51-4756-838c-96228e85080d
    type: condition
    task:
      id: 44ff341b-5a51-4756-838c-96228e85080d
      version: -1
      name: No additional fields
      description: Additional fields empty
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "7"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              simple: DomainEnrichment.Results.AdditionalFields
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: cbdb9f9d-17d5-4d38-885e-b5b3eef4c6a1
    type: title
    task:
      id: cbdb9f9d-17d5-4d38-885e-b5b3eef4c6a1
      version: -1
      name: Case 5 - Brands No Internal
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "21"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2900
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: 97ae99d6-ca6c-46de-80d4-105856cdab93
    type: regular
    task:
      id: 97ae99d6-ca6c-46de-80d4-105856cdab93
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3060
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: a31b161c-406d-4c38-8d18-76597a9caf40
    type: regular
    task:
      id: a31b161c-406d-4c38-8d18-76597a9caf40
      version: -1
      name: Run domain enrichment script
      description: This script gathers domain reputation data from multiple integrations
        and returns a "DomainEnrichment" object with consolidated information to the
        context output.
      scriptName: domain-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "46"
      - "45"
      - "47"
      - "48"
    scriptarguments:
      additional_fields:
        simple: "false"
      brands:
        simple: AlienVault OTX v2
      domain_list:
        simple: google.com
      external_enrichment:
        simple: "true"
      verbose:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: 6881d01a-bc89-4611-8540-50c892987986
    type: title
    task:
      id: 6881d01a-bc89-4611-8540-50c892987986
      version: -1
      name: Case 6 - External Enrichment + Additional Fields
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: a2a771b4-9d3c-4bf7-8ed8-f260fd87e40a
    type: regular
    task:
      id: a2a771b4-9d3c-4bf7-8ed8-f260fd87e40a
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: b5230880-2ccc-4ff3-85b9-39ae125896c3
    type: regular
    task:
      id: b5230880-2ccc-4ff3-85b9-39ae125896c3
      version: -1
      name: Run domain enrichment script
      description: This script gathers domain reputation data from multiple integrations
        and returns a "DomainEnrichment" object with consolidated information to the
        context output.
      scriptName: domain-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "50"
      - "49"
      - "51"
    scriptarguments:
      additional_fields:
        simple: "true"
      domain_list:
        simple: google.com
      external_enrichment:
        simple: "true"
      verbose:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3900
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: 58033556-6a49-4c61-8758-999fc1144eb7
    type: title
    task:
      id: 58033556-6a49-4c61-8758-999fc1144eb7
      version: -1
      name: Case 7 - Multiple Inputs
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "80"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 4240
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: a3719cac-6352-49f7-84de-1f61beafef7a
    type: regular
    task:
      id: a3719cac-6352-49f7-84de-1f61beafef7a
      version: -1
      name: Run core-get-domain-analytics-prevalence
      description: Get the prevalence of a domain, identified by domain_name.
      script: '|||core-get-domain-analytics-prevalence'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "38"
    scriptarguments:
      domain_name:
        simple: google.com
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 880
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: 0d9ef80d-28ee-4988-88c5-8b0328a7e5a3
    type: condition
    task:
      id: 0d9ef80d-28ee-4988-88c5-8b0328a7e5a3
      version: -1
      name: Make sure analytics not exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "7"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              simple: Core.AnalyticsPrevalence.Domain
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: f1d10336-6001-4fb7-8bc6-d369ad3e1df9
    type: condition
    task:
      id: f1d10336-6001-4fb7-8bc6-d369ad3e1df9
      version: -1
      name: Both Indicator Exists
      description: Make sure the Virus Total indicator returned from tim
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "28"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: DomainEnrichment.Results.Brand
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: AlienVault OTX v2
            iscontext: true
          right:
            value:
              simple: AlienVault OTX v2
      - - operator: isEqualString
          left:
            value:
              complex:
                root: DomainEnrichment.Results.Brand
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: VirusTotal (API v3)
            iscontext: true
          right:
            value:
              simple: VirusTotal (API v3)
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 3400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: 5d934e6f-a5d3-40f5-87b7-589f6a125b97
    type: condition
    task:
      id: 5d934e6f-a5d3-40f5-87b7-589f6a125b97
      version: -1
      name: Is Indicator Enrichment
      description: MaxScore And MaxVerdict enriched for https://google.com
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "28"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DomainEnrichment.Value
            iscontext: true
          right:
            value:
              simple: google.com
      - - operator: isExists
          left:
            value:
              complex:
                root: DomainEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: google.com
                accessor: MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: DomainEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: google.com
                accessor: MaxVerdict
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 3400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: cce71197-8ec0-4b9b-89eb-12481aeeb749
    type: condition
    task:
      id: cce71197-8ec0-4b9b-89eb-12481aeeb749
      version: -1
      name: No additional fields
      description: Additional fields empty
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "28"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              simple: DomainEnrichment.Results.AdditionalFields
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1022.5,
          "y": 3400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: ab8473bd-3537-43b5-8e78-5ff1a6a18751
    type: condition
    task:
      id: ab8473bd-3537-43b5-8e78-5ff1a6a18751
      version: -1
      name: Make sure analytics not exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "28"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              simple: Core.AnalyticsPrevalence.Domain
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1452.5,
          "y": 3400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: 837f1fa2-cb5d-44d5-8e8b-e40987fd21d1
    type: condition
    task:
      id: 837f1fa2-cb5d-44d5-8e8b-e40987fd21d1
      version: -1
      name: Both Indicator Exists
      description: Make sure the Virus Total indicator returned from tim
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "35"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: DomainEnrichment.Results.Brand
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: AlienVault OTX v2
            iscontext: true
          right:
            value:
              simple: AlienVault OTX v2
      - - operator: isEqualString
          left:
            value:
              complex:
                root: DomainEnrichment.Results.Brand
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: VirusTotal (API v3)
            iscontext: true
          right:
            value:
              simple: VirusTotal (API v3)
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 4070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: c3ab09a2-0bfe-4acb-87be-7157217f6d54
    type: condition
    task:
      id: c3ab09a2-0bfe-4acb-87be-7157217f6d54
      version: -1
      name: Is Indicator Enrichment
      description: MaxScore And MaxVerdict enriched for https://google.com
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "35"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DomainEnrichment.Value
            iscontext: true
          right:
            value:
              simple: google.com
      - - operator: isExists
          left:
            value:
              complex:
                root: DomainEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: google.com
                accessor: MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: DomainEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: google.com
                accessor: MaxVerdict
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 4070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: 01a9015b-7844-4a08-8fc5-d94f86e30238
    type: condition
    task:
      id: 01a9015b-7844-4a08-8fc5-d94f86e30238
      version: -1
      name: Additional fields Exists
      description: Additional fields empty
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "35"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: DomainEnrichment.Results.AdditionalFields
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1237.5,
          "y": 4070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "58":
    id: "58"
    taskid: 6d89dbe8-bff4-43ea-8ef3-26f46a540042
    type: regular
    task:
      id: 6d89dbe8-bff4-43ea-8ef3-26f46a540042
      version: -1
      name: Delete Context
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "59"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 1380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "59":
    id: "59"
    taskid: cbfd20ac-a2a8-4433-851a-2fe21b51f9e8
    type: regular
    task:
      id: cbfd20ac-a2a8-4433-851a-2fe21b51f9e8
      version: -1
      name: Get Time
      description: |
        Retrieves the current date and time.
      scriptName: GetTime
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "60"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 1550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: bd275d96-8100-464b-ad44-90dadf758e6e
    type: regular
    task:
      id: bd275d96-8100-464b-ad44-90dadf758e6e
      version: -1
      name: Run Domain Enrichment
      description: This script gathers domain reputation data from multiple integrations
        and returns a "DomainEnrichment" object with consolidated information to the
        context output.
      scriptName: domain-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "61"
      - "62"
      - "63"
    scriptarguments:
      additional_fields:
        simple: "false"
      brands:
        simple: VirusTotal (API v3)
      domain_list:
        complex:
          root: TimeNowUnix
          transformers:
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: .com
      external_enrichment:
        simple: "false"
      verbose:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 1720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    id: "61"
    taskid: 3753b4c6-e743-40ab-8440-2cd33b340a24
    type: condition
    task:
      id: 3753b4c6-e743-40ab-8440-2cd33b340a24
      version: -1
      name: Main Keys Exists With No Results
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "64"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DomainEnrichment.Value
            iscontext: true
          right:
            value:
              complex:
                root: TimeNowUnix
                transformers:
                - operator: concat
                  args:
                    prefix: {}
                    suffix:
                      value:
                        simple: .com
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: DomainEnrichment.MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: DomainEnrichment.MaxVerdict
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: DomainEnrichment.Results
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: DomainEnrichment.TIMScore
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: DomainEnrichment.Status
            iscontext: true
          right:
            value:
              simple: Fresh
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "62":
    id: "62"
    taskid: 96b0962e-5bf5-4d5d-8cc4-e13d63953c68
    type: condition
    task:
      id: 96b0962e-5bf5-4d5d-8cc4-e13d63953c68
      version: -1
      name: No Additional Fields
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "64"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              simple: DomainEnrichment.Results.AdditionalFields
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: 80e15bf0-894f-4154-8549-d63a840f3b39
    type: condition
    task:
      id: 80e15bf0-894f-4154-8549-d63a840f3b39
      version: -1
      name: AlienVault OTX v2 Result Only Exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "64"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DomainEnrichment.Results.Brand
            iscontext: true
          right:
            value:
              simple: VirusTotal (API v3)
      - - operator: isEqualString
          left:
            value:
              complex:
                root: DomainEnrichment.Results
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: VirusTotal (API v3)
                accessor: Name
            iscontext: true
          right:
            value:
              complex:
                root: TimeNowUnix
                transformers:
                - operator: concat
                  args:
                    prefix: {}
                    suffix:
                      value:
                        simple: .com
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: DomainEnrichment.Results
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: VirusTotal (API v3)
                accessor: Score
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: DomainEnrichment.Results
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: VirusTotal (API v3)
                accessor: Verdict
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "64":
    id: "64"
    taskid: 99c67aa1-9d7c-4c0b-a905-46d8043fed82
    type: title
    task:
      id: 99c67aa1-9d7c-4c0b-a905-46d8043fed82
      version: -1
      name: "Case 4 - \nknown Domain External Enrichment"
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "65"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 2060
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "65":
    id: "65"
    taskid: 95f18855-eac6-43dc-8850-8a0a3b250b9f
    type: regular
    task:
      id: 95f18855-eac6-43dc-8850-8a0a3b250b9f
      version: -1
      name: Delete Context
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "66"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 2220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "66":
    id: "66"
    taskid: 4319ad26-c35c-40af-8295-bcc86f8e17a9
    type: regular
    task:
      id: 4319ad26-c35c-40af-8295-bcc86f8e17a9
      version: -1
      name: Get Time
      description: |
        Retrieves the current date and time.
      scriptName: GetTime
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "67"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 2390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "67":
    id: "67"
    taskid: 0ed20dbb-6a0e-4fd3-b7d3-a66f45a465fa
    type: regular
    task:
      id: 0ed20dbb-6a0e-4fd3-b7d3-a66f45a465fa
      version: -1
      name: Run Domain Enrichment
      description: This script gathers domain reputation data from multiple integrations
        and returns a "DomainEnrichment" object with consolidated information to the
        context output.
      scriptName: domain-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "68"
      - "69"
      - "70"
      - "71"
    scriptarguments:
      additional_fields:
        simple: "false"
      domain_list:
        simple: google.com
      external_enrichment:
        simple: "true"
      verbose:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 2560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "68":
    id: "68"
    taskid: 81394217-969a-417e-a826-20102eb0feae
    type: condition
    task:
      id: 81394217-969a-417e-a826-20102eb0feae
      version: -1
      name: Main Keys Exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "20"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DomainEnrichment.Value
            iscontext: true
          right:
            value:
              simple: google.com
      - - operator: isExists
          left:
            value:
              simple: DomainEnrichment.MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: DomainEnrichment.MaxVerdict
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: DomainEnrichment.Results
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: DomainEnrichment.TIMScore
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: DomainEnrichment.Status
            iscontext: true
          right:
            value:
              simple: Fresh
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "69":
    id: "69"
    taskid: fe9480c3-7bca-4211-8748-dd01967ae596
    type: condition
    task:
      id: fe9480c3-7bca-4211-8748-dd01967ae596
      version: -1
      name: No Additional Fields
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "20"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              simple: DomainEnrichment.Results.AdditionalFields
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 2730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "70":
    id: "70"
    taskid: 0ebd71e8-bdf3-4676-bc44-3369f20f7956
    type: condition
    task:
      id: 0ebd71e8-bdf3-4676-bc44-3369f20f7956
      version: -1
      name: AlienVault OTX v2 Result Exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "20"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: DomainEnrichment.Results
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: AlienVault OTX v2
                accessor: Name
            iscontext: true
          right:
            value:
              simple: google.com
      - - operator: isExists
          left:
            value:
              complex:
                root: DomainEnrichment.Results
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: AlienVault OTX v2
                accessor: Score
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: DomainEnrichment.Results
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: AlienVault OTX v2
                accessor: Verdict
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 2730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "71":
    id: "71"
    taskid: e87b4ad4-9e5f-4890-8b14-24eba0cd3a89
    type: condition
    task:
      id: e87b4ad4-9e5f-4890-8b14-24eba0cd3a89
      version: -1
      name: VirusTotal (API v3) Result Exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "20"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: DomainEnrichment.Results
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: VirusTotal (API v3)
                accessor: Name
            iscontext: true
          right:
            value:
              simple: google.com
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: DomainEnrichment.Results
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: VirusTotal (API v3)
                accessor: Score
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: DomainEnrichment.Results
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: VirusTotal (API v3)
                accessor: Verdict
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1555,
          "y": 2730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "72":
    id: "72"
    taskid: 782e4d7e-d3df-4bad-8f63-22b09a59bb80
    type: regular
    task:
      id: 782e4d7e-d3df-4bad-8f63-22b09a59bb80
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "73"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 5230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "73":
    id: "73"
    taskid: 13476ee3-def7-46c0-8783-0e96e801ad94
    type: regular
    task:
      id: 13476ee3-def7-46c0-8783-0e96e801ad94
      version: -1
      name: Run domain enrichment script
      description: This script gathers domain reputation data from multiple integrations
        and returns a "DomainEnrichment" object with consolidated information to the
        context output.
      scriptName: domain-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#error#':
      - "76"
      '#none#':
      - "75"
    scriptarguments:
      additional_fields:
        simple: "true"
      domain_list:
        simple: asdasdasd
      external_enrichment:
        simple: "true"
      verbose:
        simple: "false"
    separatecontext: false
    continueonerror: true
    continueonerrortype: errorPath
    view: |-
      {
        "position": {
          "x": 910,
          "y": 5400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "74":
    id: "74"
    taskid: 9bea50b8-398d-4e44-82cf-8545272b07ca
    type: title
    task:
      id: 9bea50b8-398d-4e44-82cf-8545272b07ca
      version: -1
      name: Case 1 - Bad Input
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "72"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 5070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "75":
    id: "75"
    taskid: 8f76ef65-1123-4067-8f7f-fc5f0e46c9c9
    type: condition
    task:
      id: 8f76ef65-1123-4067-8f7f-fc5f0e46c9c9
      version: -1
      name: Failure
      type: condition
      iscommand: false
      brand: ""
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: "1"
          right:
            value:
              simple: "2"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1022.5,
          "y": 6070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "76":
    id: "76"
    taskid: 366e870e-3bce-4b93-8714-79a27f58160f
    type: title
    task:
      id: 366e870e-3bce-4b93-8714-79a27f58160f
      version: -1
      name: Case 2 - Bad Brand
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "77"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 612.5,
          "y": 5570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "77":
    id: "77"
    taskid: 1befc3bd-f2e6-40e2-895f-2b25a80525c7
    type: regular
    task:
      id: 1befc3bd-f2e6-40e2-895f-2b25a80525c7
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "78"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 612.5,
          "y": 5730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "78":
    id: "78"
    taskid: 118eeaf1-ade5-4b6b-8538-aef3576ded54
    type: regular
    task:
      id: 118eeaf1-ade5-4b6b-8538-aef3576ded54
      version: -1
      name: Run domain enrichment script
      description: This script gathers domain reputation data from multiple integrations
        and returns a "DomainEnrichment" object with consolidated information to the
        context output.
      scriptName: domain-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#error#':
      - "79"
      '#none#':
      - "75"
    scriptarguments:
      additional_fields:
        simple: "true"
      brands:
        simple: asdasd
      domain_list:
        simple: google.com
      external_enrichment:
        simple: "true"
      verbose:
        simple: "false"
    separatecontext: false
    continueonerror: true
    continueonerrortype: errorPath
    view: |-
      {
        "position": {
          "x": 612.5,
          "y": 5900
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "79":
    id: "79"
    taskid: 49e44145-d649-431d-8277-8a97913a5644
    type: title
    task:
      id: 49e44145-d649-431d-8277-8a97913a5644
      version: -1
      name: Pass
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 6075
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "80":
    id: "80"
    taskid: 36fd6d57-32fa-4d2b-8adf-9ff8bdebb547
    type: regular
    task:
      id: 36fd6d57-32fa-4d2b-8adf-9ff8bdebb547
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "81"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 4400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "81":
    id: "81"
    taskid: 801d544a-a48d-4858-846e-5a85fc116e37
    type: regular
    task:
      id: 801d544a-a48d-4858-846e-5a85fc116e37
      version: -1
      name: Run domain enrichment script
      description: This script gathers domain reputation data from multiple integrations
        and returns a "DomainEnrichment" object with consolidated information to the
        context output.
      scriptName: domain-enrichment
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "83"
      - "84"
      - "86"
    scriptarguments:
      additional_fields:
        simple: "true"
      domain_list:
        simple: google.com,facebook.com
      external_enrichment:
        simple: "true"
      verbose:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 4570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "83":
    id: "83"
    taskid: 99db5166-4c37-4481-85a1-f17ad8268ced
    type: condition
    task:
      id: 99db5166-4c37-4481-85a1-f17ad8268ced
      version: -1
      name: Facebook exists
      description: MaxScore And MaxVerdict enriched for https://google.com
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "85"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: DomainEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: facebook.com
                accessor: Value
            iscontext: true
          right:
            value:
              simple: facebook.com
      - - operator: isExists
          left:
            value:
              complex:
                root: DomainEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: facebook.com
                accessor: MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: DomainEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: facebook.com
                accessor: MaxVerdict
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 4740
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "84":
    id: "84"
    taskid: d34adeef-5813-4522-89c4-8c608f99c4eb
    type: condition
    task:
      id: d34adeef-5813-4522-89c4-8c608f99c4eb
      version: -1
      name: Additional fields Exists
      description: Additional fields empty
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "85"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: DomainEnrichment.Results.AdditionalFields
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 4740
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "85":
    id: "85"
    taskid: 0dee2b79-0877-4312-83a8-00cd89b8cb69
    type: title
    task:
      id: 0dee2b79-0877-4312-83a8-00cd89b8cb69
      version: -1
      name: Sad Flows
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "74"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 4910
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "86":
    id: "86"
    taskid: b8a79f9e-155d-4449-81a7-cb41576327db
    type: condition
    task:
      id: b8a79f9e-155d-4449-81a7-cb41576327db
      version: -1
      name: Google exists
      description: MaxScore And MaxVerdict enriched for https://google.com
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "85"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: DomainEnrichment.Value
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: google.com
            iscontext: true
          right:
            value:
              simple: google.com
      - - operator: isExists
          left:
            value:
              complex:
                root: DomainEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: google.com
                accessor: MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: DomainEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: DomainEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: google.com
                accessor: MaxVerdict
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1237.5,
          "y": 4740
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 6090,
        "width": 1885,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
sourceplaybookid: 110f76de-5574-4854-853e-8675a01d8eb0
dirtyInputs: true
marketplaces:
- platform
- marketplacev2
- xsoar