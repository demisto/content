id: BlockExternalIP - Test
version: -1
name: BlockExternalIP - Test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 6c1722cd-e0c1-4655-80b1-b2977a904f8b
    type: start
    task:
      id: 6c1722cd-e0c1-4655-80b1-b2977a904f8b
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "2"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 60
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 2dffdd93-da14-45d8-9b4e-b2b2ffe5dd11
    type: regular
    task:
      id: 2dffdd93-da14-45d8-9b4e-b2b2ffe5dd11
      version: -1
      name: CIsco ASA list rules
      description: Gets a list all rules for the supplied interface.
      script: '|||cisco-asa-list-rules'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 360
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: 0428c50a-4f33-43f1-ba98-cd24ac45b5ae
    type: title
    task:
      id: 0428c50a-4f33-43f1-ba98-cd24ac45b5ae
      version: -1
      name: Prepare CiscoASA
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 200
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 59356e40-5e0c-427f-ab73-b344102ebe58
    type: condition
    task:
      id: 59356e40-5e0c-427f-ab73-b344102ebe58
      version: -1
      name: Does rule exist?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "4"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: CiscoASA.Rules.Dest
            iscontext: true
          right:
            value:
              simple: 8.8.8.8
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: a7c98393-0ac2-439e-abcb-6c29f4a9844e
    type: regular
    task:
      id: a7c98393-0ac2-439e-abcb-6c29f4a9844e
      version: -1
      name: Remove rule if exist
      description: Deletes a rule.
      script: '|||cisco-asa-delete-rule'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      interface_type:
        complex:
          root: CiscoASA.Rules
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: CiscoASA.Rules.Dest
                iscontext: true
              right:
                value:
                  simple: 8.8.8.8
          accessor: InterfaceType
      rule_id:
        complex:
          root: CiscoASA.Rules
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: CiscoASA.Rules.Dest
                iscontext: true
              right:
                value:
                  simple: 8.8.8.8
          accessor: ID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 69936d93-ae23-449d-b0d9-31d86f2fa91d
    type: title
    task:
      id: 69936d93-ae23-449d-b0d9-31d86f2fa91d
      version: -1
      name: 'Case 1: Running with cisco ASA twice'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "6"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 830
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: dbd0e297-7ae8-4522-859f-d99f34b4e8ae
    type: regular
    task:
      id: dbd0e297-7ae8-4522-859f-d99f34b4e8ae
      version: -1
      name: BlockExternalIP
      description: The script blocks a list of IP addresses in supported integrations.
      scriptName: block-external-ip
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      brands:
        simple: Cisco ASA
      ip_list:
        simple: 8.8.8.8
    results:
    - push_job_id
    - commit_job_id
    - panorama_responses
    - executed_brands
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 980
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: 43ef0c7d-dece-4991-85ee-9b515775e347
    type: condition
    task:
      id: 43ef0c7d-dece-4991-85ee-9b515775e347
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "8"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: BlockExternalIPResults.Result
            iscontext: true
          right:
            value:
              simple: Success
      - - operator: isEqualString
          left:
            value:
              simple: BlockExternalIPResults.IP
            iscontext: true
          right:
            value:
              simple: 8.8.8.8
      - - operator: isEqualString
          left:
            value:
              simple: BlockExternalIPResults.Brand
            iscontext: true
          right:
            value:
              simple: Cisco ASA
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 11d217b8-0314-4409-8bc7-cb9d2544b41e
    type: regular
    task:
      id: 11d217b8-0314-4409-8bc7-cb9d2544b41e
      version: -1
      name: Clear context
      description: "Delete field from context.\n\nThis automation runs using the default Limited User role, unless you explicitly change the permissions.\nFor more information, see the section about permissions here:\n- For Cortex XSOAR 6 see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n- For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: 70be6d15-67c4-456b-ab15-be19719cc6ec
    type: condition
    task:
      id: 70be6d15-67c4-456b-ab15-be19719cc6ec
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "11"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: BlockExternalIPResults.Result
            iscontext: true
          right:
            value:
              simple: Failed
      - - operator: isEqualString
          left:
            value:
              simple: BlockExternalIPResults.IP
            iscontext: true
          right:
            value:
              simple: 8.8.8.8
      - - operator: isEqualString
          left:
            value:
              simple: BlockExternalIPResults.Brand
            iscontext: true
          right:
            value:
              simple: Cisco ASA
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: 77865b8e-595e-476a-8f18-b1583da90cc8
    type: regular
    task:
      id: 77865b8e-595e-476a-8f18-b1583da90cc8
      version: -1
      name: BlockExternalIP
      description: The script blocks a list of IP addresses in supported integrations.
      scriptName: block-external-ip
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      brands:
        simple: Cisco ASA
      ip_list:
        simple: 8.8.8.8
    results:
    - push_job_id
    - commit_job_id
    - panorama_responses
    - executed_brands
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1455
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 05c9866e-75b4-48b6-ae87-c71c67cb7301
    type: title
    task:
      id: 05c9866e-75b4-48b6-ae87-c71c67cb7301
      version: -1
      name: 'Case 2: Run BlockExternalIP with Panorama'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "27"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1810
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: de336cc5-bb93-492e-8845-4b16e04fc444
    type: regular
    task:
      id: de336cc5-bb93-492e-8845-4b16e04fc444
      version: -1
      name: Get Timestamp
      description: |
        Retrieves the current date and time.
      scriptName: GetTime
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: db0e0d0f-0092-4e35-9e76-d473430e3524
    type: regular
    task:
      id: db0e0d0f-0092-4e35-9e76-d473430e3524
      version: -1
      name: BlockExternalIP
      description: The script blocks a list of IP addresses in supported integrations.
      scriptName: block-external-ip
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      address_group:
        simple: test-${TimeNowUnix}
      brands:
        simple: Panorama
      ip_list:
        simple: 8.8.8.8
      rule_name:
        simple: test-${TimeNowUnix}
      tag:
        simple: test-${TimeNowUnix}
    results:
    - push_job_id
    - commit_job_id
    - panorama_responses
    - executed_brands
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 2290
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: 610fda9f-661f-411a-a292-8b6f1286dc94
    type: title
    task:
      id: 610fda9f-661f-411a-a292-8b6f1286dc94
      version: -1
      name: 'Case 3: Running with F5Silverline & tag'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "28"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 2658.75
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: d07aefa6-f22f-414c-beab-624f56122e95
    type: regular
    task:
      id: d07aefa6-f22f-414c-beab-624f56122e95
      version: -1
      name: Silverline list ip objects
      description: Gets a dynamic list of threatening IP addresses by the given list type.
      script: '|||f5-silverline-ip-objects-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      list_type:
        simple: denylist
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 2970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: b856e858-1ed3-4c72-9fd1-afeeab4a688b
    type: condition
    task:
      id: b856e858-1ed3-4c72-9fd1-afeeab4a688b
      version: -1
      name: Is IP in the list?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "20"
      "yes":
      - "19"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: F5Silverline.IPObjectList.attributes.ip
            iscontext: true
          right:
            value:
              simple: 8.8.8.8/32
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 3110
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: eac9a0c7-89bf-42db-a9d7-e29a80c62169
    type: regular
    task:
      id: eac9a0c7-89bf-42db-a9d7-e29a80c62169
      version: -1
      name: F5 Delete IP from list
      description: Delete an existing particular threatening IP address object by its object ID or by its IP address. If both id and ip are given, delete operation will be done by the given object_id.
      script: '|||f5-silverline-ip-object-delete'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      list_type:
        simple: denylist
      object_ip:
        simple: 8.8.8.8
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 3260
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 60d3f289-91f1-425c-b671-7e177c530e53
    type: regular
    task:
      id: 60d3f289-91f1-425c-b671-7e177c530e53
      version: -1
      name: BlockExternalIP
      description: The script blocks a list of IP addresses in supported integrations.
      scriptName: block-external-ip
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      brands:
        simple: F5Silverline
      ip_list:
        simple: 8.8.8.8
      tag:
        simple: test
    results:
    - push_job_id
    - commit_job_id
    - panorama_responses
    - executed_brands
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 3410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: 186b18d2-c6c0-48ff-aa4f-3593918bacd8
    type: condition
    task:
      id: 186b18d2-c6c0-48ff-aa4f-3593918bacd8
      version: -1
      name: Verify outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "34"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: BlockExternalIPResults
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: BlockExternalIPResults.Brand
                      iscontext: true
                    right:
                      value:
                        simple: F5Silverline
                accessor: Result
            iscontext: true
          right:
            value:
              simple: Success
      - - operator: containsGeneral
          left:
            value:
              simple: F5Silverline.IPObjectList.attributes.ip
            iscontext: true
          right:
            value:
              simple: 8.8.8.8
      - - operator: isEqualString
          left:
            value:
              complex:
                root: F5Silverline.IPObjectList
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: F5Silverline.IPObjectList.attributes.ip
                      iscontext: true
                    right:
                      value:
                        simple: 8.8.8.8
                accessor: meta.tags
            iscontext: true
          right:
            value:
              simple: test
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 3730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: a37b0e4c-94ca-43f4-8563-e4a11f835bcd
    type: regular
    task:
      id: a37b0e4c-94ca-43f4-8563-e4a11f835bcd
      version: -1
      name: Silverline list ip objects
      description: Gets a dynamic list of threatening IP addresses by the given list type.
      script: '|||f5-silverline-ip-objects-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "21"
    scriptarguments:
      list_type:
        simple: denylist
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 3576.25
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: 6236dd4d-41d5-47e6-948b-4ef6b6ee57f9
    type: title
    task:
      id: 6236dd4d-41d5-47e6-948b-4ef6b6ee57f9
      version: -1
      name: 'Case 5: non existing IP'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "33"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 5445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: 39e70163-c5ee-451c-8360-420856e3873f
    type: regular
    task:
      id: 39e70163-c5ee-451c-8360-420856e3873f
      version: -1
      name: Clear context
      description: "Delete field from context.\n\nThis automation runs using the default Limited User role, unless you explicitly change the permissions.\nFor more information, see the section about permissions here:\n- For Cortex XSOAR 6 see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n- For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1953.75
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: b3e882c2-7ddb-49ba-8c52-d4a47d670a81
    type: regular
    task:
      id: b3e882c2-7ddb-49ba-8c52-d4a47d670a81
      version: -1
      name: Clear context
      description: "Delete field from context.\n\nThis automation runs using the default Limited User role, unless you explicitly change the permissions.\nFor more information, see the section about permissions here:\n- For Cortex XSOAR 6 see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n- For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 2823.75
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: 8986ea6d-7fb7-498f-baaa-3e5f1276ac72
    type: condition
    task:
      id: 8986ea6d-7fb7-498f-baaa-3e5f1276ac72
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "16"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: BlockExternalIPResults.Result
            iscontext: true
          right:
            value:
              simple: Success
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: f8a59e6b-38cf-46db-87b3-d1c0a281dc34
    type: regular
    task:
      id: f8a59e6b-38cf-46db-87b3-d1c0a281dc34
      version: -1
      name: BlockExternalIP
      description: The script blocks a list of IP addresses in supported integrations.
      scriptName: block-external-ip
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      ip_list:
        simple: non-existing-ip-list
      brands:
        simple: F5Silverline,Cisco ASA
    results:
    - push_job_id
    - commit_job_id
    - panorama_responses
    - executed_brands
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 5755
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: 85f1bfb4-0b04-43ed-baef-ca14be36f8dd
    type: condition
    task:
      id: 85f1bfb4-0b04-43ed-baef-ca14be36f8dd
      version: -1
      name: Verify outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "32"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: notContainsGeneral
          left:
            value:
              simple: BlockExternalIPResults.Result
            iscontext: true
          right:
            value:
              simple: Success
      - - operator: isEqualString
          left:
            value:
              simple: BlockExternalIPResults.Result
            iscontext: true
          right:
            value:
              simple: Failed
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 5910
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: cc3a766b-e87c-4dc1-85dd-a3d9fd50ee62
    type: title
    task:
      id: cc3a766b-e87c-4dc1-85dd-a3d9fd50ee62
      version: -1
      name: Finish
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 6100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: 17c54df8-cf1e-447d-8772-66abb98829af
    type: regular
    task:
      id: 17c54df8-cf1e-447d-8772-66abb98829af
      version: -1
      name: Clear context
      description: "Delete field from context.\n\nThis automation runs using the default Limited User role, unless you explicitly change the permissions.\nFor more information, see the section about permissions here:\n- For Cortex XSOAR 6 see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n- For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 5595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: 32d6309b-a60d-462f-8b23-31846560d5fb
    type: title
    task:
      id: 32d6309b-a60d-462f-8b23-31846560d5fb
      version: -1
      name: 'Case 4: Running with 2 brands'
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "36"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 3890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: c9c05fb9-c6c4-4573-bc50-bba8615cb922
    type: regular
    task:
      id: c9c05fb9-c6c4-4573-bc50-bba8615cb922
      version: -1
      name: Clear context
      description: "Delete field from context.\n\nThis automation runs using the default Limited User role, unless you explicitly change the permissions.\nFor more information, see the section about permissions here:\n- For Cortex XSOAR 6 see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n- For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "37"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 4040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: 02826eba-5f7c-46ec-8501-1db246c250e5
    type: regular
    task:
      id: 02826eba-5f7c-46ec-8501-1db246c250e5
      version: -1
      name: Silverline list ip objects
      description: Gets a dynamic list of threatening IP addresses by the given list type.
      script: '|||f5-silverline-ip-objects-list'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "38"
    scriptarguments:
      list_type:
        simple: denylist
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 4186.25
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: 1d6cddfe-2da5-4ba8-8574-1ac496e3fa2c
    type: condition
    task:
      id: 1d6cddfe-2da5-4ba8-8574-1ac496e3fa2c
      version: -1
      name: Is IP in the list?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "40"
      "yes":
      - "39"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: F5Silverline.IPObjectList.attributes.ip
            iscontext: true
          right:
            value:
              simple: 8.8.8.8/32
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 4326.25
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: fca8b856-c903-4ab7-8bfe-2daaa6730efc
    type: regular
    task:
      id: fca8b856-c903-4ab7-8bfe-2daaa6730efc
      version: -1
      name: F5 Delete IP from list
      description: Delete an existing particular threatening IP address object by its object ID or by its IP address. If both id and ip are given, delete operation will be done by the given object_id.
      script: '|||f5-silverline-ip-object-delete'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "40"
    scriptarguments:
      list_type:
        simple: denylist
      object_ip:
        simple: 8.8.8.8
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 4476.25
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: f7c4dba4-c86f-40a7-884c-b8bf27733bfc
    type: regular
    task:
      id: f7c4dba4-c86f-40a7-884c-b8bf27733bfc
      version: -1
      name: CIsco ASA list rules
      description: Gets a list all rules for the supplied interface.
      script: '|||cisco-asa-list-rules'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "41"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 4635
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: 4aca05f3-9dce-4c3d-8a92-dac627c7cf52
    type: condition
    task:
      id: 4aca05f3-9dce-4c3d-8a92-dac627c7cf52
      version: -1
      name: Does rule exist?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "43"
      "yes":
      - "42"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: CiscoASA.Rules.Dest
            iscontext: true
          right:
            value:
              simple: 8.8.8.8
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 4795
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: 75c7cf48-2eff-47d5-8635-f1260e9a0a81
    type: regular
    task:
      id: 75c7cf48-2eff-47d5-8635-f1260e9a0a81
      version: -1
      name: Remove rule if exist
      description: Deletes a rule.
      script: '|||cisco-asa-delete-rule'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "43"
    scriptarguments:
      interface_type:
        complex:
          root: CiscoASA.Rules
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: CiscoASA.Rules.Dest
                iscontext: true
              right:
                value:
                  simple: 8.8.8.8
          accessor: InterfaceType
      rule_id:
        complex:
          root: CiscoASA.Rules
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: CiscoASA.Rules.Dest
                iscontext: true
              right:
                value:
                  simple: 8.8.8.8
          accessor: ID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 4965
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: db717f16-1656-4a6a-987a-cf390cb7b158
    type: regular
    task:
      id: db717f16-1656-4a6a-987a-cf390cb7b158
      version: -1
      name: BlockExternalIP
      description: The script blocks a list of IP addresses in supported integrations.
      scriptName: block-external-ip
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "44"
    scriptarguments:
      brands:
        simple: F5Silverline,Cisco ASA
      ip_list:
        simple: 8.8.8.8
    results:
    - push_job_id
    - commit_job_id
    - panorama_responses
    - executed_brands
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 5131.25
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "44":
    id: "44"
    taskid: 751d580e-335c-4745-9e2f-d2eba64d1373
    type: condition
    task:
      id: 751d580e-335c-4745-9e2f-d2eba64d1373
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "23"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualNumber
          left:
            value:
              complex:
                root: BlockExternalIPResults.Result
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: BlockExternalIPResults.Result
                      iscontext: true
                    right:
                      value:
                        simple: Success
                transformers:
                - operator: count
            iscontext: true
          right:
            value:
              simple: "2"
      - - operator: containsGeneral
          left:
            value:
              simple: BlockExternalIPResults.Brand
            iscontext: true
          right:
            value:
              simple: Cisco ASA
      - - operator: containsGeneral
          left:
            value:
              simple: BlockExternalIPResults.Brand
            iscontext: true
          right:
            value:
              simple: F5Silverline
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 450,
          "y": 5280
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "18_19_yes": 0.46,
      "31_32_yes": 0.5,
      "38_39_yes": 0.52,
      "3_4_yes": 0.48,
      "41_42_yes": 0.53,
      "44_23_yes": 0.45,
      "7_8_yes": 0.43,
      "9_11_yes": 0.46
    },
    "paper": {
      "dimensions": {
        "height": 6100,
        "width": 380,
        "x": 450,
        "y": 60
      }
    }
  }
inputs: []
outputs: []
fromversion: 6.10.0
description: ''
