id: URLEnrichment-Test
version: -1
vcShouldKeepItemLegacyProdMachine: false
name: URLEnrichment-Test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: e7c247c7-d5e6-4971-8a3e-81c66b61ac6c
    type: start
    task:
      id: e7c247c7-d5e6-4971-8a3e-81c66b61ac6c
      version: -1
      name: ""
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "10"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 15b4a671-0c10-47d6-8f75-d4b748237765
    type: regular
    task:
      id: 15b4a671-0c10-47d6-8f75-d4b748237765
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 8eaea17f-8d75-46dc-860c-14cc3dc965b7
    type: regular
    task:
      id: 8eaea17f-8d75-46dc-860c-14cc3dc965b7
      version: -1
      name: Run url enrichment script
      description: |-
        Running !url-enrichemnt on the base case without external enrichment or additional fields.
        !url-enrichment url_litst="https://google.com"
      scriptName: url-enrichment
      type: regular
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "6"
      - "14"
    scriptarguments:
      additional_fields:
        simple: "false"
      external_enrichment:
        simple: "false"
      url_list:
        simple: https://${TimeNowUnix}.com
      verbose:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 760
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: fb0ed209-62a3-4af4-8fed-de09be714639
    type: condition
    task:
      id: fb0ed209-62a3-4af4-8fed-de09be714639
      version: -1
      name: TIM Result exists
      description: Make sure the Virus Total indicator returned from tim
      type: condition
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      "yes":
      - "7"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: URLEnrichment.Results.Brand
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: URLEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: TIM
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: 0b892f9f-f966-47c1-88fd-7d9c8bda7305
    type: title
    task:
      id: 0b892f9f-f966-47c1-88fd-7d9c8bda7305
      version: -1
      name: Case 2 - One Brand
      type: title
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "8"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 1130
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 59ec686c-f4e2-4c44-8ee8-f64a3c4d5106
    type: regular
    task:
      id: 59ec686c-f4e2-4c44-8ee8-f64a3c4d5106
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "37"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 1300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: 57be8f70-cd36-44d6-84ce-6b6cb14d52f5
    type: title
    task:
      id: 57be8f70-cd36-44d6-84ce-6b6cb14d52f5
      version: -1
      name: Case 1 - Base
      type: title
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: cb1595fa-ac96-44c4-8c6b-88bcff1c6ba4
    type: condition
    task:
      id: cb1595fa-ac96-44c4-8c6b-88bcff1c6ba4
      version: -1
      name: Indicator Main Keys Exists
      description: MaxScore And MaxVerdict enriched for https://google.com
      type: condition
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      "yes":
      - "7"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: URLEnrichment.Value
            iscontext: true
          right:
            value:
              complex:
                root: TimeNowUnix
                transformers:
                - operator: concat
                  args:
                    prefix:
                      value:
                        simple: https://
                    suffix:
                      value:
                        simple: .com
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: URLEnrichment.MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: URLEnrichment.MaxVerdict
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: URLEnrichment.TIMScore
            iscontext: true
      - - operator: isNotExists
          left:
            value:
              simple: URLEnrichment.Status
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: 9197c3b1-53d7-44a1-8017-ed3187d631d0
    type: condition
    task:
      id: 9197c3b1-53d7-44a1-8017-ed3187d631d0
      version: -1
      name: No additional fields
      description: Additional fields empty
      type: condition
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      "yes":
      - "20"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              simple: URLEnrichment.Results.AdditionalFields
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 1855
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: e07941c5-ed78-4fcd-87cc-713393bf1f8c
    type: title
    task:
      id: e07941c5-ed78-4fcd-87cc-713393bf1f8c
      version: -1
      name: Case 3 - External Enrichment
      type: title
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "21"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 2040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: 385fb5bf-bd39-4835-8dad-8d8251c937d7
    type: regular
    task:
      id: 385fb5bf-bd39-4835-8dad-8d8251c937d7
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "41"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 2210
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: 41f20e96-42d8-4464-814b-550e8c4b07c3
    type: regular
    task:
      id: 41f20e96-42d8-4464-814b-550e8c4b07c3
      version: -1
      name: Run url enrichment script
      description: |-
        Running !url-enrichemnt on the base case without external enrichment or additional fields.
        !url-enrichment url_litst="https://google.com"
      scriptName: url-enrichment
      type: regular
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "42"
      - "45"
      - "46"
      - "60"
    scriptarguments:
      additional_fields:
        simple: "false"
      external_enrichment:
        simple: "true"
      url_list:
        complex:
          root: TimeNowUnix
          transformers:
          - operator: concat
            args:
              prefix:
                value:
                  simple: https://
              suffix:
                value:
                  simple: .com
      verbose:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 2580
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: c384e196-9d1d-4615-8572-a6908bb6874b
    type: title
    task:
      id: c384e196-9d1d-4615-8572-a6908bb6874b
      version: -1
      name: Case 4 - External Enrichment + Additional Fields
      type: title
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "29"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 2950
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: 3027361d-f54c-4305-8fb9-5622a24fba60
    type: regular
    task:
      id: 3027361d-f54c-4305-8fb9-5622a24fba60
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "51"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 3120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: 77c5515b-b67b-4d11-8ff4-6b7624d7cc37
    type: title
    task:
      id: 77c5515b-b67b-4d11-8ff4-6b7624d7cc37
      version: -1
      name: Case 5 - Multiple Inputs
      type: title
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "62"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 3860
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: e63cabb1-688d-4a6c-86e5-709344fccede
    type: regular
    task:
      id: e63cabb1-688d-4a6c-86e5-709344fccede
      version: -1
      name: Get Time
      description: |
        Retrieves the current date and time.
      scriptName: GetTime
      type: regular
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "5"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 575
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: 7cc6a9b3-faa8-4147-85fa-fa5ccf0945f4
    type: regular
    task:
      id: 7cc6a9b3-faa8-4147-85fa-fa5ccf0945f4
      version: -1
      name: Get Time
      description: |
        Retrieves the current date and time.
      scriptName: GetTime
      type: regular
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "38"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 1485
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: efd54861-b360-4cf5-8354-83d9b2ea5100
    type: regular
    task:
      id: efd54861-b360-4cf5-8354-83d9b2ea5100
      version: -1
      name: Run url enrichment script
      description: |-
        Running !url-enrichemnt on the base case without external enrichment or additional fields.
        !url-enrichment url_litst="https://google.com"
      scriptName: url-enrichment
      type: regular
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "39"
      - "40"
      - "19"
    scriptarguments:
      additional_fields:
        simple: "false"
      brands:
        simple: AlienVault OTX v2
      external_enrichment:
        simple: "false"
      url_list:
        simple: https://${TimeNowUnix}.com
      verbose:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 1670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: 83c9fbce-02a2-45be-8b47-5757ded3990d
    type: condition
    task:
      id: 83c9fbce-02a2-45be-8b47-5757ded3990d
      version: -1
      name: AlienVault OTX v2 Result Only
      description: Make sure the Virus Total indicator returned from tim
      type: condition
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      "yes":
      - "20"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: URLEnrichment.Results.Brand
            iscontext: true
          right:
            value:
              simple: AlienVault OTX v2
      - - operator: isExists
          left:
            value:
              complex:
                root: URLEnrichment.Results
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: URLEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: AlienVault OTX v2
                accessor: Score
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              complex:
                root: URLEnrichment.Results
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: URLEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: AlienVault OTX v2
                accessor: Data
            iscontext: true
          right:
            value:
              complex:
                root: TimeNowUnix
                transformers:
                - operator: concat
                  args:
                    prefix:
                      value:
                        simple: https://
                    suffix:
                      value:
                        simple: .com
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: URLEnrichment.Results
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: URLEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: AlienVault OTX v2
                accessor: Verdict
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1855
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: a4e2dcbc-2774-4fc3-87b6-dea5ff31c30a
    type: condition
    task:
      id: a4e2dcbc-2774-4fc3-87b6-dea5ff31c30a
      version: -1
      name: Indicator Main Keys Exists
      description: MaxScore And MaxVerdict enriched for https://google.com
      type: condition
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      "yes":
      - "20"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: URLEnrichment.Value
            iscontext: true
          right:
            value:
              complex:
                root: TimeNowUnix
                transformers:
                - operator: concat
                  args:
                    prefix:
                      value:
                        simple: https://
                    suffix:
                      value:
                        simple: .com
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: URLEnrichment.MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: URLEnrichment.MaxVerdict
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: URLEnrichment.TIMScore
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: URLEnrichment.Status
            iscontext: true
          right:
            value:
              simple: Fresh
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 1855
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: f5c2ff22-1000-4675-83f2-ba64a7713c85
    type: regular
    task:
      id: f5c2ff22-1000-4675-83f2-ba64a7713c85
      version: -1
      name: Get Time
      description: |
        Retrieves the current date and time.
      scriptName: GetTime
      type: regular
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "23"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 2395
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: 8f87dc0a-1018-4465-8806-4e6037ee39a6
    type: condition
    task:
      id: 8f87dc0a-1018-4465-8806-4e6037ee39a6
      version: -1
      name: Indicator Main Keys Exists
      description: MaxScore And MaxVerdict enriched for https://google.com
      type: condition
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      "yes":
      - "28"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: URLEnrichment.Value
            iscontext: true
          right:
            value:
              complex:
                root: TimeNowUnix
                transformers:
                - operator: concat
                  args:
                    prefix:
                      value:
                        simple: https://
                    suffix:
                      value:
                        simple: .com
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: URLEnrichment.MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: URLEnrichment.MaxVerdict
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: URLEnrichment.TIMScore
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: URLEnrichment.Status
            iscontext: true
          right:
            value:
              simple: Fresh
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2765
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: 18e42aec-936a-4660-85ff-6ccb92d86cac
    type: condition
    task:
      id: 18e42aec-936a-4660-85ff-6ccb92d86cac
      version: -1
      name: AlienVault OTX v2 Result
      description: Make sure the Virus Total indicator returned from tim
      type: condition
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      "yes":
      - "28"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: URLEnrichment.Results
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: URLEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: AlienVault OTX v2
                accessor: Score
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              complex:
                root: URLEnrichment.Results
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: URLEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: AlienVault OTX v2
                accessor: Data
            iscontext: true
          right:
            value:
              complex:
                root: TimeNowUnix
                transformers:
                - operator: concat
                  args:
                    prefix:
                      value:
                        simple: https://
                    suffix:
                      value:
                        simple: .com
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: URLEnrichment.Results
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: URLEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: AlienVault OTX v2
                accessor: Verdict
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2765
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: dc0e28d0-aea5-471b-8a18-73d5d27b5b9a
    type: condition
    task:
      id: dc0e28d0-aea5-471b-8a18-73d5d27b5b9a
      version: -1
      name: VirusTotal (API v3) Result
      description: Make sure the Virus Total indicator returned from tim
      type: condition
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      "yes":
      - "28"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: URLEnrichment.Results
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: URLEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: VirusTotal (API v3)
                accessor: Score
            iscontext: true
          right:
            value: {}
      - - operator: isEqualString
          left:
            value:
              complex:
                root: URLEnrichment.Results
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: URLEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: VirusTotal (API v3)
                accessor: Data
            iscontext: true
          right:
            value:
              complex:
                root: TimeNowUnix
                transformers:
                - operator: concat
                  args:
                    prefix:
                      value:
                        simple: https://
                    suffix:
                      value:
                        simple: .com
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: URLEnrichment.Results
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: URLEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: VirusTotal (API v3)
                accessor: Verdict
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2765
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: bfec531a-800f-4f25-8442-35daa31bf2af
    type: condition
    task:
      id: bfec531a-800f-4f25-8442-35daa31bf2af
      version: -1
      name: Indicator Main Keys Exists
      description: MaxScore And MaxVerdict enriched for https://google.com
      type: condition
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      "yes":
      - "35"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: URLEnrichment.Value
            iscontext: true
          right:
            value:
              complex:
                root: TimeNowUnix
                transformers:
                - operator: concat
                  args:
                    prefix:
                      value:
                        simple: https://
                    suffix:
                      value:
                        simple: .com
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: URLEnrichment.MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: URLEnrichment.MaxVerdict
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: URLEnrichment.TIMScore
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: URLEnrichment.Status
            iscontext: true
          right:
            value:
              simple: Fresh
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3675
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: 5175cb80-a438-434a-8bea-a12bb4059d42
    type: condition
    task:
      id: 5175cb80-a438-434a-8bea-a12bb4059d42
      version: -1
      name: AlienVault OTX v2 Result
      description: Make sure the Virus Total indicator returned from tim
      type: condition
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      "yes":
      - "35"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: URLEnrichment.Results
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: URLEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: AlienVault OTX v2
                accessor: Score
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              complex:
                root: URLEnrichment.Results
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: URLEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: AlienVault OTX v2
                accessor: Data
            iscontext: true
          right:
            value:
              complex:
                root: TimeNowUnix
                transformers:
                - operator: concat
                  args:
                    prefix:
                      value:
                        simple: https://
                    suffix:
                      value:
                        simple: .com
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: URLEnrichment.Results
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: URLEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: AlienVault OTX v2
                accessor: Verdict
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3675
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: 79f92ce4-ec3c-4d86-8bc1-4f8b0f0a2352
    type: condition
    task:
      id: 79f92ce4-ec3c-4d86-8bc1-4f8b0f0a2352
      version: -1
      name: VirusTotal (API v3) Result
      description: Make sure the Virus Total indicator returned from tim
      type: condition
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      "yes":
      - "35"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: URLEnrichment.Results
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: URLEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: VirusTotal (API v3)
                accessor: Score
            iscontext: true
          right:
            value: {}
      - - operator: isEqualString
          left:
            value:
              complex:
                root: URLEnrichment.Results
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: URLEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: VirusTotal (API v3)
                accessor: Data
            iscontext: true
          right:
            value:
              complex:
                root: TimeNowUnix
                transformers:
                - operator: concat
                  args:
                    prefix:
                      value:
                        simple: https://
                    suffix:
                      value:
                        simple: .com
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: URLEnrichment.Results
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: URLEnrichment.Results.Brand
                      iscontext: true
                    right:
                      value:
                        simple: VirusTotal (API v3)
                accessor: Verdict
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3675
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: f5173704-6944-43e1-8e6a-f1d7c7481cbc
    type: regular
    task:
      id: f5173704-6944-43e1-8e6a-f1d7c7481cbc
      version: -1
      name: Run url enrichment script
      description: |-
        Running !url-enrichemnt on the base case without external enrichment or additional fields.
        !url-enrichment url_litst="https://google.com"
      scriptName: url-enrichment
      type: regular
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "47"
      - "49"
      - "48"
      - "61"
    scriptarguments:
      additional_fields:
        simple: "true"
      external_enrichment:
        simple: "true"
      url_list:
        complex:
          root: TimeNowUnix
          transformers:
          - operator: concat
            args:
              prefix:
                value:
                  simple: https://
              suffix:
                value:
                  simple: .com
      verbose:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 3490
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: eec71c3e-b694-4a72-88d1-d4db2ee70930
    type: regular
    task:
      id: eec71c3e-b694-4a72-88d1-d4db2ee70930
      version: -1
      name: Get Time
      description: |
        Retrieves the current date and time.
      scriptName: GetTime
      type: regular
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "50"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 3305
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "52":
    id: "52"
    taskid: 7ce684dd-2a91-41bd-8bc2-362014a58c1d
    type: title
    task:
      id: 7ce684dd-2a91-41bd-8bc2-362014a58c1d
      version: -1
      name: Case 1 - Wrong Brand
      type: title
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "53"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 5480
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: 1dabe6f1-894f-4d68-8ff7-6cb906bc9254
    type: regular
    task:
      id: 1dabe6f1-894f-4d68-8ff7-6cb906bc9254
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "54"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 5650
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "54":
    id: "54"
    taskid: e393cff9-eaa8-477c-83d2-1e09f24ea95b
    type: regular
    task:
      id: e393cff9-eaa8-477c-83d2-1e09f24ea95b
      version: -1
      name: Run url enrichment script
      description: |-
        Running !url-enrichemnt on the base case without external enrichment or additional fields.
        !url-enrichment url_litst="https://google.com"
      scriptName: url-enrichment
      type: regular
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#error#':
      - "55"
      '#none#':
      - "58"
    scriptarguments:
      additional_fields:
        simple: "true"
      brands:
        simple: aabcd
      external_enrichment:
        simple: "true"
      url_list:
        complex:
          root: TimeNowUnix
          transformers:
          - operator: concat
            args:
              prefix:
                value:
                  simple: https://
              suffix:
                value:
                  simple: .com
      verbose:
        simple: "false"
    separatecontext: false
    continueonerror: true
    continueonerrortype: errorPath
    view: |-
      {
        "position": {
          "x": 695,
          "y": 5835
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "55":
    id: "55"
    taskid: 858064e5-368d-4330-8d56-10f0032d9287
    type: title
    task:
      id: 858064e5-368d-4330-8d56-10f0032d9287
      version: -1
      name: Case 2 - Wrong Input
      type: title
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "56"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 490,
          "y": 6020
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "56":
    id: "56"
    taskid: 83a45728-2e93-4c96-887b-affc450e4dab
    type: regular
    task:
      id: 83a45728-2e93-4c96-887b-affc450e4dab
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "57"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 490,
          "y": 6190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "57":
    id: "57"
    taskid: 130f48ac-4e68-467a-89d5-9b0c03e30f12
    type: regular
    task:
      id: 130f48ac-4e68-467a-89d5-9b0c03e30f12
      version: -1
      name: Run url enrichment script
      description: |-
        Running !url-enrichemnt on the base case without external enrichment or additional fields.
        !url-enrichment url_litst="https://google.com"
      scriptName: url-enrichment
      type: regular
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#error#':
      - "59"
      '#none#':
      - "58"
    scriptarguments:
      additional_fields:
        simple: "true"
      external_enrichment:
        simple: "true"
      url_list:
        simple: abcd
      verbose:
        simple: "false"
    separatecontext: false
    continueonerror: true
    continueonerrortype: errorPath
    view: |-
      {
        "position": {
          "x": 490,
          "y": 6375
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "58":
    id: "58"
    taskid: cfd83c14-cfef-4900-8375-b40a70b90993
    type: condition
    task:
      id: cfd83c14-cfef-4900-8375-b40a70b90993
      version: -1
      name: Failure
      type: condition
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: "1"
          right:
            value:
              simple: "2"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 6560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "59":
    id: "59"
    taskid: 6b3c95df-7387-4513-8cf0-25457ae8ae9e
    type: title
    task:
      id: 6b3c95df-7387-4513-8cf0-25457ae8ae9e
      version: -1
      name: Pass
      type: title
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 6567.5
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: 16ac858b-5d13-4c73-839e-1a7fe526aaea
    type: condition
    task:
      id: 16ac858b-5d13-4c73-839e-1a7fe526aaea
      version: -1
      name: No additional fields
      description: Additional fields empty
      type: condition
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      "yes":
      - "28"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              simple: URLEnrichment.Results.AdditionalFields
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 2765
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    id: "61"
    taskid: ce7cb0e4-df5d-4498-81e8-4cd9e224c270
    type: condition
    task:
      id: ce7cb0e4-df5d-4498-81e8-4cd9e224c270
      version: -1
      name: Additional Fields Exists
      description: Additional fields empty
      type: condition
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      "yes":
      - "35"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: URLEnrichment.Results.AdditionalFields
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 3675
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "62":
    id: "62"
    taskid: 8be46062-64d2-4918-8575-2222a749e2ef
    type: regular
    task:
      id: 8be46062-64d2-4918-8575-2222a749e2ef
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "63"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 4030
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: 086e258d-668b-4943-8810-018fe0aa0ceb
    type: regular
    task:
      id: 086e258d-668b-4943-8810-018fe0aa0ceb
      version: -1
      name: Run url enrichment script
      description: |-
        Running !url-enrichemnt on the base case without external enrichment or additional fields.
        !url-enrichment url_litst="https://google.com"
      scriptName: url-enrichment
      type: regular
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "70"
      - "71"
    scriptarguments:
      additional_fields:
        simple: "false"
      external_enrichment:
        simple: "true"
      url_list:
        simple: '"[\"https://google.com\", \"https://facebook.com\"]"'
      verbose:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 4215
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "69":
    id: "69"
    taskid: 3379b561-ac07-48f3-ae63-e97edc8bec9c
    type: title
    task:
      id: 3379b561-ac07-48f3-ae63-e97edc8bec9c
      version: -1
      name: Case 6 - One Valid One Invalid
      type: title
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "73"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 4585
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "70":
    id: "70"
    taskid: b7a45795-8efc-4c69-8d8d-e57bc2cfd5d2
    type: condition
    task:
      id: b7a45795-8efc-4c69-8d8d-e57bc2cfd5d2
      version: -1
      name: Google Exists
      type: condition
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      "yes":
      - "69"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: URLEnrichment.Value
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: URLEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: https://google.com
            iscontext: true
          right:
            value:
              simple: https://google.com
      - - operator: isExists
          left:
            value:
              complex:
                root: URLEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: URLEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: https://google.com
                accessor: MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: URLEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: URLEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: https://google.com
                accessor: TIMScore
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "71":
    id: "71"
    taskid: 369b1204-2826-48c6-9610-0162ef0921a5
    type: condition
    task:
      id: 369b1204-2826-48c6-9610-0162ef0921a5
      version: -1
      name: Facebook Exists
      type: condition
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      "yes":
      - "69"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: URLEnrichment.Value
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: URLEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: https://facebook.com
            iscontext: true
          right:
            value:
              simple: https://facebook.com
      - - operator: isExists
          left:
            value:
              complex:
                root: URLEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: URLEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: https://facebook.com
                accessor: MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: URLEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: URLEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: https://facebook.com
                accessor: TIMScore
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 4400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "72":
    id: "72"
    taskid: dc89f0f2-23d2-418c-8a1e-e61c5dc44921
    type: title
    task:
      id: dc89f0f2-23d2-418c-8a1e-e61c5dc44921
      version: -1
      name: Sad Flows
      type: title
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "52"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 5310
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "73":
    id: "73"
    taskid: af5423fd-31b1-47ca-8185-3fd8ca930742
    type: regular
    task:
      id: af5423fd-31b1-47ca-8185-3fd8ca930742
      version: -1
      name: DeleteContext
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex XSOAR 6
        see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "74"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 4755
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "74":
    id: "74"
    taskid: a62bc248-4be7-4ff2-96d1-468cc54de30a
    type: regular
    task:
      id: a62bc248-4be7-4ff2-96d1-468cc54de30a
      version: -1
      name: Run url enrichment script
      description: |-
        Running !url-enrichemnt on the base case without external enrichment or additional fields.
        !url-enrichment url_litst="https://google.com"
      scriptName: url-enrichment
      type: regular
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "75"
      - "76"
    scriptarguments:
      additional_fields:
        simple: "false"
      external_enrichment:
        simple: "true"
      url_list:
        simple: https://google.com,test
      verbose:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 695,
          "y": 4940
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "75":
    id: "75"
    taskid: 950d6adc-e4d8-43e4-8d8e-048d41ab93da
    type: condition
    task:
      id: 950d6adc-e4d8-43e4-8d8e-048d41ab93da
      version: -1
      name: Google Exists
      type: condition
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      "yes":
      - "72"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: URLEnrichment.Value
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: URLEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: https://google.com
            iscontext: true
          right:
            value:
              simple: https://google.com
      - - operator: isExists
          left:
            value:
              complex:
                root: URLEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: URLEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: https://google.com
                accessor: MaxScore
            iscontext: true
      - - operator: isExists
          left:
            value:
              complex:
                root: URLEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: URLEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: https://google.com
                accessor: TIMScore
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5125
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "76":
    id: "76"
    taskid: bca9c626-6cf9-49fc-9b6f-c2aa9602f6a0
    type: condition
    task:
      id: bca9c626-6cf9-49fc-9b6f-c2aa9602f6a0
      version: -1
      name: Invalid Entry Exists
      type: condition
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      "yes":
      - "72"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: URLEnrichment.Value
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: URLEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: test
            iscontext: true
          right:
            value:
              simple: test
      - - operator: isEqualString
          left:
            value:
              complex:
                root: URLEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: URLEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: test
                accessor: Status
            iscontext: true
          right:
            value:
              simple: Error
      - - operator: isEqualString
          left:
            value:
              complex:
                root: URLEnrichment
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: URLEnrichment.Value
                      iscontext: true
                    right:
                      value:
                        simple: test
                accessor: Message
            iscontext: true
          right:
            value:
              simple: Invalid
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 910,
          "y": 5125
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 6585,
        "width": 1670,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
dirtyInputs: true
adopted: true
