commonfields:
  id: BlockUserAppAccessWithCAPolicy
  version: -1
name: BlockUserAppAccessWithCAPolicy
script: ''
type: python
tags:
- Azure
- Conditional Access
- Access Control
comment: Checks if a CA policy exists. If yes, adds the user if needed. If no, creates a new CA policy to block access to a specific app for a user.
enabled: true
args:
- name: policy_name
  required: false
  description: The display name of the Conditional Access policy to check or create.
- name: username
  required: true
  description: The UPN of the user to block.
- name: app_name
  required: true
  description: The name of the app to block access to.
scripttarget: 0
subtype: python3
runonce: false
dockerimage: demisto/python3:3.12.11.4508456
runas: DBotWeakRole
engineinfo: {}
fromversion: 6.10.0
dependson:
  must: ['|||msgraph-identity-ca-policies-list', '|||msgraph-apps-service-principal-list']
tests:
- No tests (auto formatted)
