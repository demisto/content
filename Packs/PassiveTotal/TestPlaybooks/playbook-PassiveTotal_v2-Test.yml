id: PassiveTotal_v2-Test
version: -1
name: PassiveTotal_v2-Test
description: This playbook uses the PassiveTotal integration and tests the scenarios
  of the various commands like pt-whois-search, pt-get-components, pt-get-trackers,
  pt-get-pdns-details, pt-ssl-cert-search, pt-get-host-pairs, pt-get-cookies, pt-get-services,
  pt-get-whois and pt-get-articles.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 3bbc9faa-952c-45df-81f2-7c3df714d86e
    type: start
    task:
      id: 3bbc9faa-952c-45df-81f2-7c3df714d86e
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "1":
    id: "1"
    taskid: ebca507a-6c3c-4e7a-8b43-ce8352a710f8
    type: regular
    task:
      id: ebca507a-6c3c-4e7a-8b43-ce8352a710f8
      version: -1
      name: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "2":
    id: "2"
    taskid: c8c773a8-89e5-4055-8da2-0adbad5f8bc7
    type: regular
    task:
      id: c8c773a8-89e5-4055-8da2-0adbad5f8bc7
      version: -1
      name: pt-whois-search
      script: '|||pt-whois-search'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      field:
        simple: domain
      query:
        simple: ituiguang.cc
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "3":
    id: "3"
    taskid: b03688ed-351a-4a56-8673-e322886736ab
    type: condition
    task:
      id: b03688ed-351a-4a56-8673-e322886736ab
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "4"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.Name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.WHOIS.CreationDate
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.WHOIS.UpdatedDate
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.WHOIS.ExpirationDate
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.WHOIS.NameServers
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.Admin.Email
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.Admin.Name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.Admin.Phone
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.Admin.Country
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.Registrant.Email
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.Registrant.Name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.Registrant.Phone
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.Registrant.Country
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.WHOIS.Admin.Email
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.WHOIS.Admin.Name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.WHOIS.Admin.Phone
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.WHOIS.Admin.Country
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.WHOIS.Registrar.Name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.WHOIS.Registrant.Email
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.WHOIS.Registrant.Name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.WHOIS.Registrant.Phone
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.WHOIS.Registrant.Country
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.WHOIS.domain
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.WHOIS.registrar
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.WHOIS.whoisServer
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.WHOIS.registered
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.WHOIS.expiresAt
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.WHOIS.registryUpdatedAt
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.WHOIS.lastLoadedAt
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.WHOIS.nameServers
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.WHOIS.contactEmail
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.WHOIS.registrantEmail
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.WHOIS.registrantName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.WHOIS.registrantOrganization
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.WHOIS.registrantStreet
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.WHOIS.registrantCity
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.WHOIS.registrantState
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.WHOIS.registrantPostalCode
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.WHOIS.registrantCountry
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.WHOIS.registrantTelephone
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.WHOIS.adminEmail
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.WHOIS.adminName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.WHOIS.adminOrganization
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.WHOIS.adminStreet
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.WHOIS.adminCity
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.WHOIS.adminState
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.WHOIS.adminPostalCode
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.WHOIS.adminCountry
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.WHOIS.adminTelephone
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.WHOIS.techEmail
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.WHOIS.techName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.WHOIS.techOrganization
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.WHOIS.techStreet
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.WHOIS.techCity
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.WHOIS.techState
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.WHOIS.techPostalCode
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.WHOIS.techCountry
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.WHOIS.techTelephone
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "4":
    id: "4"
    taskid: 4852f78b-4f8f-4aa7-81bd-17dcb50fe061
    type: regular
    task:
      id: 4852f78b-4f8f-4aa7-81bd-17dcb50fe061
      version: -1
      name: pt-get-components
      script: '|||pt-get-components'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      end: {}
      query:
        simple: www.furth.com.ar
      start: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "5":
    id: "5"
    taskid: c8de59d3-9b64-48d8-8e41-a0fc2372f699
    type: condition
    task:
      id: c8de59d3-9b64-48d8-8e41-a0fc2372f699
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "6"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.Name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotScore.Type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotScore.Vendor
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.Component.firstSeen
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.Component.lastSeen
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.Component.category
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.Component.label
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.Component.hostname
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "6":
    id: "6"
    taskid: ba00f2c6-cb71-4214-8e36-58b047f7979a
    type: regular
    task:
      id: ba00f2c6-cb71-4214-8e36-58b047f7979a
      version: -1
      name: pt-get-trackers
      script: '|||pt-get-trackers'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      end: {}
      query:
        simple: filmesonlinegratis.net
      start: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "7":
    id: "7"
    taskid: 4b181f2b-dbe2-43b7-835e-c83a1c7a5245
    type: condition
    task:
      id: 4b181f2b-dbe2-43b7-835e-c83a1c7a5245
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "8"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Domain.Name
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotScore.Type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotScore.Vendor
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.Tracker.firstSeen
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.Tracker.lastSeen
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.Tracker.attributeValue
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.Tracker.attributeType
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.Tracker.hostname
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "8":
    id: "8"
    taskid: 5819495a-3467-4238-8a37-72e79724eddd
    type: regular
    task:
      id: 5819495a-3467-4238-8a37-72e79724eddd
      version: -1
      name: pt-get-pdns-details
      script: '|||pt-get-pdns-details'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      end: {}
      query:
        simple: www.furth.com.ar
      start: {}
      timeout: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "9":
    id: "9"
    taskid: 02da5749-7ef2-4098-88d9-0f5bed579d8b
    type: condition
    task:
      id: 02da5749-7ef2-4098-88d9-0f5bed579d8b
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "10"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.PDNS.resolve
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.PDNS.resolveType
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.PDNS.value
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.PDNS.source
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.PDNS.firstSeen
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.PDNS.lastSeen
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.PDNS.collected
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.PDNS.recordType
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.PDNS.recordHash
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "10":
    id: "10"
    taskid: 04ba6d1f-6be4-4fa7-8381-ec5f72abb163
    type: regular
    task:
      id: 04ba6d1f-6be4-4fa7-8381-ec5f72abb163
      version: -1
      name: pt-ssl-cert-search
      script: '|||pt-ssl-cert-search'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      field:
        simple: serialNumber
      query:
        simple: 61135c80f8ed28d2
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "11":
    id: "11"
    taskid: a66ee29b-e097-4657-86ed-85ee22938a36
    type: condition
    task:
      id: a66ee29b-e097-4657-86ed-85ee22938a36
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "12"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.SSL.firstSeen
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.SSL.lastSeen
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.SSL.fingerprint
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.SSL.sslVersion
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.SSL.expirationDate
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.SSL.issueDate
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.SSL.sha1
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.SSL.serialNumber
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.SSL.issuerCountry
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.SSL.issuerCommonName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.SSL.issuerOrganizationName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.SSL.subjectCommonName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.SSL.subjectOrganizationName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.SSL.subjectLocalityName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.SSL.subjectProvince
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.SSL.subjectStateOrProvinceName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.SSL.subjectCountry
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.SSL.subjectAlternativeNames
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "12":
    id: "12"
    taskid: a06c4c15-2fed-448e-81b0-407203277c7c
    type: regular
    task:
      id: a06c4c15-2fed-448e-81b0-407203277c7c
      version: -1
      name: pt-get-host-pairs
      script: '|||pt-get-host-pairs'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      direction:
        simple: children
      end: {}
      query:
        simple: ns1.furth.com.ar
      start: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "13":
    id: "13"
    taskid: cae0dd0e-2bf4-4b27-8b5e-cc7c2f6efcf8
    type: condition
    task:
      id: cae0dd0e-2bf4-4b27-8b5e-cc7c2f6efcf8
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "15"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.HostPair.firstSeen
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.HostPair.lastSeen
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.HostPair.cause
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.HostPair.parent
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PassiveTotal.HostPair.child
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "14":
    id: "14"
    taskid: 40268b1a-e258-4765-85a5-84b5d091daaf
    type: title
    task:
      id: 40268b1a-e258-4765-85a5-84b5d091daaf
      version: -1
      name: Test Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "15":
    id: "15"
    taskid: fcb6b9e6-5df9-479e-8aa2-65b68e501cc1
    type: regular
    task:
      id: fcb6b9e6-5df9-479e-8aa2-65b68e501cc1
      version: -1
      name: pt-get-cookies
      description: Retrieves cookies addresses or hostname information based on cookie
        name or domain.
      script: '|||pt-get-cookies'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      order: {}
      page: {}
      query:
        simple: _fg
      search_by:
        simple: get addresses by cookie name
      sort: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "16":
    id: "16"
    taskid: e5ef86ff-0121-4dd0-86f2-885db0265806
    type: condition
    task:
      id: e5ef86ff-0121-4dd0-86f2-885db0265806
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "17"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.Cookie
                accessor: hostname
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.Cookie
                accessor: cookieName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.Cookie
                accessor: cookieDomain
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.Cookie
                accessor: firstSeen
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.Cookie
                accessor: lastSeen
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "17":
    id: "17"
    taskid: b7b0a175-2967-46c9-80cb-729e41fe3ecf
    type: regular
    task:
      id: b7b0a175-2967-46c9-80cb-729e41fe3ecf
      version: -1
      name: pt-get-services
      description: Retrieves exposed services on the recently open ports for an IP
        address.
      script: '|||pt-get-services'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      ip:
        simple: 2.2.2.2
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2840
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "18":
    id: "18"
    taskid: c7ea4c0c-b000-45df-8618-a1baadbfa695
    type: condition
    task:
      id: c7ea4c0c-b000-45df-8618-a1baadbfa695
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "23"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.Service
                accessor: ip
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.Service
                accessor: portNumber
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.Service
                accessor: firstSeen
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.Service
                accessor: lastSeen
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.Service
                accessor: lastScan
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.Service
                accessor: protocol
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.Service
                accessor: count
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.Service.currentServices
                accessor: label
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.Service
                accessor: status
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3005
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "19":
    id: "19"
    taskid: 9cdf018a-f3ca-4432-8439-d94f62448c2e
    type: regular
    task:
      id: 9cdf018a-f3ca-4432-8439-d94f62448c2e
      version: -1
      name: pt-get-whois
      description: Gets WHOIS information records based on queries.
      script: '|||pt-get-whois'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      history: {}
      query:
        simple: ituiguang.cc
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "20":
    id: "20"
    taskid: 695c64b8-0fc6-4ecc-8d39-425d55f43060
    type: condition
    task:
      id: 695c64b8-0fc6-4ecc-8d39-425d55f43060
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "21"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.WHOIS
                accessor: domain
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.WHOIS
                accessor: registrar
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.WHOIS
                accessor: whoisServer
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.WHOIS
                accessor: registered
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.WHOIS
                accessor: expiresAt
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.WHOIS
                accessor: registryUpdatedAt
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.WHOIS
                accessor: lastLoadedAt
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.WHOIS
                accessor: nameServers
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.WHOIS
                accessor: contactEmail
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.WHOIS
                accessor: registrantEmail
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.WHOIS
                accessor: registrantName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.WHOIS
                accessor: registrantOrganization
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.WHOIS
                accessor: registrantStreet
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.WHOIS
                accessor: registrantCity
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.WHOIS
                accessor: registrantState
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.WHOIS
                accessor: registrantPostalCode
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.WHOIS
                accessor: registrantCountry
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.WHOIS
                accessor: registrantTelephone
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.WHOIS
                accessor: adminEmail
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.WHOIS
                accessor: adminName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.WHOIS
                accessor: adminOrganization
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.WHOIS
                accessor: adminStreet
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.WHOIS
                accessor: adminCity
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.WHOIS
                accessor: adminState
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.WHOIS
                accessor: adminPostalCode
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.WHOIS
                accessor: adminCountry
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.WHOIS
                accessor: adminTelephone
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.WHOIS
                accessor: techEmail
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.WHOIS
                accessor: techName
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.WHOIS
                accessor: techOrganization
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.WHOIS
                accessor: techStreet
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.WHOIS
                accessor: techCity
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.WHOIS
                accessor: techState
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.WHOIS
                accessor: techPostalCode
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.WHOIS
                accessor: techCountry
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.WHOIS
                accessor: techTelephone
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3600
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "21":
    id: "21"
    taskid: 499f77e0-2817-4421-8b64-4adc2a5d2b42
    type: regular
    task:
      id: 499f77e0-2817-4421-8b64-4adc2a5d2b42
      version: -1
      name: pt-get-articles
      description: Retrieves information related to articles for a specific indicator.
      script: '|||pt-get-articles'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      query:
        simple: T1125
      type: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3790
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "22":
    id: "22"
    taskid: 8c257413-1197-4845-8dc7-d6a4b9c74ef5
    type: condition
    task:
      id: 8c257413-1197-4845-8dc7-d6a4b9c74ef5
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "14"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.Article
                accessor: guid
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.Article
                accessor: title
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.Article
                accessor: type
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PassiveTotal.Article
                accessor: link
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4000
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "23":
    id: "23"
    taskid: 77e0a6ee-73bf-4e2f-8d39-f5a23ba07ea7
    type: regular
    task:
      id: 77e0a6ee-73bf-4e2f-8d39-f5a23ba07ea7
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      all:
        simple: "no"
      index: {}
      key:
        simple: PassiveTotal.WHOIS
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
view: |-
  {
    "linkLabelsPosition": {
      "16_17_yes": 0.9,
      "18_23_yes": 0.88
    },
    "paper": {
      "dimensions": {
        "height": 4205,
        "width": 380,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
fromversion: 5.0.0
