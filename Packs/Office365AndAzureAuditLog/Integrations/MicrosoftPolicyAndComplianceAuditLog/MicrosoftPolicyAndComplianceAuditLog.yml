category: Data Enrichment & Threat Intelligence
commonfields:
  id: MicrosoftPolicyAndComplianceAuditLog
  version: -1
configuration:
- display: Exchange Online URL
  name: url
  defaultvalue: https://outlook.office365.com
  type: 0
  required: true
- display: Email (Password for basic authentication only)
  name: credentials
  type: 9
  required: false
- display: Trust any certificate (not secure)
  name: insecure
  type: 8
  required: false
description: '[Enter a comprehensive, yet concise, description of what the integration does, what use cases it is designed for, etc.]'
display: Microsoft Policy And Compliance (Audit Log)
name: MicrosoftPolicyAndComplianceAuditLog
script:
  commands:
  - name: o365-auditlog-auth-start
    arguments: [ ]
    description: Starts the OAuth2.0 authorization process.
  - name: o365-auditlog-auth-complete
    arguments: [ ]
    description: Completes the OAuth2.0 authorization process.
  - name: o365-auditlog-auth-test
    arguments: [ ]
    description: Tests the OAuth2.0 authorization process.
  - name: o365-search-auditlog
    arguments:
    - name: start_date
      required: true
      description: The start_date parameter specifies the start date of the date range. Entries are stored in the unified audit log in Coordinated Universal Time (UTC). If you specify a date/time value without a time zone, the value is in UTC.
    - name: end_date
      required: true
      description: The end_date parameter specifies the end date of the date range. Entries are stored in the unified audit log in Coordinated Universal Time (UTC). If you specify a date/time value without a time zone, the value is in UTC.
    - name: free_text
      required: false
      description: The free_text parameter filters the log entries by the specified text string. If the value contains spaces, enclose the value in quotation marks (").
    - name: record_type
      required: false
      description: The record_type parameter filters the log entries by record type. [Available record type](https://docs.microsoft.com/en-us/office/office-365-management-api/office-365-management-activity-api-schema#auditlogrecordtype)
    - name: ip_addresses
      required: false
      isArray: true
      description: The ip_addresses parameter filters the log entries by the specified IP addresses. You specify multiple IP addresses separated by commas.
    - name: operations
      required: false
      isArray: true
      description: he operations parameter filters the log entries by operation. The available values for this parameter depend on the record_types value. [Available values](https://docs.microsoft.com/en-us/microsoft-365/compliance/search-the-audit-log-in-security-and-compliance?view=o365-worldwide#audited-activities)
    - name: user_ids
      required: false
      isArray: true
      description: The UserIds parameter filters the log entries by the ID of the user who performed the action. You can enter multiple values separated by commas.
    - name: result_size
      required: false
      defaultValue: 10
      description: The result_size parameter specifies the maximum number of results to return.
    outputs:
      - contextPath: O365.AuditLog.Actor.ID
        description: ''
        type: String
      - contextPath: O365.AuditLog.Actor.Type
        description: ''
        type: Number
      - contextPath: O365.AuditLog.ActorContextId
        description: ''
        type: String
      - contextPath: O365.AuditLog.ActorIpAddress
        description: ''
        type: String
      - contextPath: O365.AuditLog.ApplicationId
        description: ''
        type: String
      - contextPath: O365.AuditLog.AzureActiveDirectoryEventType
        description: ''
        type: Number
      - contextPath: O365.AuditLog.ClientIP
        description: ''
        type: String
      - contextPath: O365.AuditLog.CreationTime
        description: ''
        type: Date
      - contextPath: O365.AuditLog.ExtendedProperties.Name
        description: ''
        type: String
      - contextPath: O365.AuditLog.ExtendedProperties.Value
        description: ''
        type: String
      - contextPath: O365.AuditLog.Id
        description: ''
        type: String
      - contextPath: O365.AuditLog.InterSystemsId
        description: ''
        type: String
      - contextPath: O365.AuditLog.IntraSystemId
        description: ''
        type: String
      - contextPath: O365.AuditLog.LogonError
        description: ''
        type: String
      - contextPath: O365.AuditLog.ObjectId
        description: ''
        type: String
      - contextPath: O365.AuditLog.Operation
        description: ''
        type: String
      - contextPath: O365.AuditLog.OrganizationId
        description: ''
        type: String
      - contextPath: O365.AuditLog.RecordType
        description: ''
        type: Number
      - contextPath: O365.AuditLog.ResultStatus
        description: ''
        type: String
      - contextPath: O365.AuditLog.SupportTicketId
        description: ''
        type: String
      - contextPath: O365.AuditLog.Target.ID
        description: ''
        type: String
      - contextPath: O365.AuditLog.Target.Type
        description: ''
        type: Number
      - contextPath: O365.AuditLog.TargetContextId
        description: ''
        type: String
      - contextPath: O365.AuditLog.UserId
        description: ''
        type: String
      - contextPath: O365.AuditLog.UserKey
        description: ''
        type: String
      - contextPath: O365.AuditLog.UserType
        description: ''
        type: Number
      - contextPath: O365.AuditLog.Version
        description: ''
        type: Number
      - contextPath: O365.AuditLog.Workload
        description: ''
        type: String
    description: Tests the OAuth2.0 authorization process.
  isfetch: false
  runonce: false
  script: '-'
  type: powershell
  dockerimage: demisto/powershell-ubuntu:7.0.3.12001
fromversion: 5.5.0
tests:
- No tests (auto formatted)
