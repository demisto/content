description: Extracts and Enriches Expanse from Indicator Assets
id: Extract Expanse Indicators
inputs:
- description: Expanse Assets to Extract and Enrich
  key: Expanse Assets
  playbookInputQuery:
  required: false
  value:
    complex:
      accessor: expanseasset
      root: incident
- description: Create Indicators for types that are not handled by AutoExtract, such
    as Certificates, Domains and DomainGlobs
  key: Create Indicators
  playbookInputQuery:
  required: false
  value:
    simple: "true"
- description: IP from the Expanse Incident
  key: Expanse IP
  playbookInputQuery:
  required: false
  value:
    complex:
      accessor: expanseip
      root: incident
name: Extract Expanse Indicators
outputs:
- contextPath: Expanse.Certificate
  description: Expanse Certificate Information
  type: unknown
- contextPath: Expanse.IPRange
  description: Expanse IP Range
  type: unknown
- contextPath: Domain
  description: The domain objects.
  type: unknown
- contextPath: DBotScore
  description: Indicator, Score, Type, and Vendor.
  type: unknown
- contextPath: IP
  description: The IP objects
  type: unknown
- contextPath: Endpoint
  description: The Endpoint's object
  type: unknown
- contextPath: Expanse.Domain
  description: Expanse Domain
  type: unknown
- contextPath: DomainDNSDetails
  description: Domain DNS Details
  type: Unknown
starttaskid: "0"
tasks:
  "0":
    id: "0"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "172"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 569aafc5-1607-4b78-83d2-c6bfe05c2a07
      iscommand: false
      name: ""
      version: -1
      description: ''
    taskid: 569aafc5-1607-4b78-83d2-c6bfe05c2a07
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 1327.5,
          "y": -1070
        }
      }
  "29":
    id: "29"
    ignoreworker: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 35ccc89e-ee40-4851-8b29-075e6954c661
      iscommand: false
      name: Done Enrichment
      type: title
      version: -1
      description: ''
    taskid: 35ccc89e-ee40-4851-8b29-075e6954c661
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1327.5,
          "y": 1130
        }
      }
  "41":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: inputs.Expanse Assets.assettype
                    operator: isEqualString
                    right:
                      value:
                        simple: Certificate
                root: inputs.Expanse Assets
                transformers:
                - args:
                    field:
                      value:
                        simple: assetkey
                  operator: getField
          operator: isNotEmpty
      label: "yes"
    id: "41"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "174"
      "yes":
      - "179"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bf7ad01f-8415-4226-815c-92ecda78e386
      iscommand: false
      name: Are there Certificates to enrich?
      description: Check if there are Expanse Certificates in the inputs.
      type: condition
      version: -1
    taskid: bf7ad01f-8415-4226-815c-92ecda78e386
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 580,
          "y": -520
        }
      }
  "42":
    id: "42"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "43"
    note: false
    quietmode: 0
    scriptarguments:
      accounttype: {}
      actor: {}
      admincountry: {}
      adminemail: {}
      adminname: {}
      adminphone: {}
      asn: {}
      assignedrole: {}
      assigneduser: {}
      associatedfilenames: {}
      associations: {}
      biosversion: {}
      campaign: {}
      category: {}
      city: {}
      costcenter: {}
      costcentercode: {}
      countryname: {}
      creationdate: {}
      customFields: {}
      cvedescription: {}
      cvemodified: {}
      cvss: {}
      department: {}
      description: {}
      detectionengines: {}
      devicemodel: {}
      dhcpserver: {}
      displayname: {}
      dns: {}
      domainidnname: {}
      domainname: {}
      domainreferringips: {}
      domainreferringsubnets: {}
      domainstatus: {}
      email: {}
      emailaddress: {}
      entryid: {}
      expanseassettype: {}
      expansebusinessunits: {}
      expansecertificateadvertisementstatus: {}
      expansecommonname: {}
      expansedateadded: {}
      expansednsresolutionstatus: {}
      expansedomain: {}
      expansefirstobserved: {}
      expanseissuerdn: {}
      expanselastobserved: {}
      expansepemmd5hash: {}
      expanseproperties: {}
      expanseprovidername: {}
      expansesans: {}
      expanseserialnumber: {}
      expanseservicestatus: {}
      expansesha256fingerprint: {}
      expansesourcedomain: {}
      expansesubjectdn: {}
      expansetags: {}
      expansetenantname: {}
      expansetype: {}
      expansevalidnotafter: {}
      expansevalidnotbefore: {}
      expirationdate: {}
      feedrelatedindicators: {}
      fileextension: {}
      filetype: {}
      firstseenbysource: {}
      geocountry: {}
      geolocation: {}
      givenname: {}
      groups: {}
      hostname: {}
      imphash: {}
      indicatoridentification: {}
      internal: {}
      ipaddress: {}
      jobcode: {}
      jobfamily: {}
      jobfunction: {}
      lastseenbysource: {}
      leadership: {}
      location: {}
      locationregion: {}
      macaddress: {}
      malwarefamily: {}
      manageremailaddress: {}
      managername: {}
      md5: {}
      memory: {}
      merge: {}
      mobilephone: {}
      name: {}
      namefield: {}
      nameservers: {}
      office365category: {}
      office365expressroute: {}
      office365required: {}
      operatingsystem: {}
      operatingsystemversion: {}
      organization: {}
      organizationalunitou: {}
      osversion: {}
      path: {}
      personalemail: {}
      port: {}
      positivedetections: {}
      processor: {}
      processors: {}
      published: {}
      quarantined: {}
      region: {}
      registrantcountry: {}
      registrantemail: {}
      registrantname: {}
      registrantphone: {}
      registrarabuseemail: {}
      registrarabusephone: {}
      registrarname: {}
      relateToIncident: {}
      relatedIncidents: {}
      reportedby: {}
      reputation: {}
      seenNow: {}
      service: {}
      sha1: {}
      sha256: {}
      sha512: {}
      signatureauthentihash: {}
      signaturecopyright: {}
      signaturedescription: {}
      signaturefileversion: {}
      signatureinternalname: {}
      signed: {}
      size: {}
      source:
        simple: DBot
      sourceTimeStamp: {}
      sourceoriginalseverity: {}
      ssdeep: {}
      state: {}
      stixaliases: {}
      stixdescription: {}
      stixgoals: {}
      stixid: {}
      stixismalwarefamily: {}
      stixkillchainphases: {}
      stixmalwaretypes: {}
      stixprimarymotivation: {}
      stixresourcelevel: {}
      stixroles: {}
      stixsecondarymotivations: {}
      stixsophistication: {}
      stixthreatactortypes: {}
      stixtooltypes: {}
      stixtoolversion: {}
      streetaddress: {}
      subdomains: {}
      surname: {}
      tags: {}
      threattypes: {}
      title: {}
      trafficlightprotocol: {}
      type:
        simple: ExpanseCertificate
      updateddate: {}
      username: {}
      value:
        complex:
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: incident.expanseasset.assettype
              operator: isEqualString
              right:
                value:
                  simple: Certificate
          root: incident.expanseasset
          transformers:
          - args:
              field:
                value:
                  simple: assetkey
            operator: getField
      workphone: {}
      xdrstatus: {}
      zipcode: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 55613c6b-131d-4693-8869-944b881bd126
      iscommand: true
      name: Create Certificate Indicators
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 55613c6b-131d-4693-8869-944b881bd126
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 30,
          "y": -120
        }
      }
  "43":
    id: "43"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "100"
    note: false
    quietmode: 0
    scriptarguments:
      indicatorsValues:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.Expanse Assets.assettype
              operator: isEqualString
              right:
                value:
                  simple: Certificate
          root: inputs.Expanse Assets
          transformers:
          - args:
              field:
                value:
                  simple: assetkey
            operator: getField
      using-brand: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.enrich.indicators
      id: e335c8db-2e3f-402d-8977-ca66214fefa2
      iscommand: true
      name: Enrich Certificate Indicators
      script: Builtin|||enrichIndicators
      type: regular
      version: -1
    taskid: e335c8db-2e3f-402d-8977-ca66214fefa2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 30,
          "y": 50
        }
      }
  "100":
    id: "100"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "174"
    note: false
    quietmode: 0
    scriptarguments:
      businessunitnames: {}
      businessunits: {}
      has_active_service: {}
      has_certificate_advertisement: {}
      has_related_cloud_resources: {}
      last_observed_date: {}
      pem_md5_hash:
        complex:
          accessor: assetkey
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.Expanse Assets.assettype
              operator: isEqualString
              right:
                value:
                  simple: Certificate
          root: inputs.Expanse Assets
      providernames: {}
      providers: {}
      search: {}
      tagnames: {}
      tags: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Get certificate details by certificate md5 hash or search certificates
      id: ef595f31-b333-45d8-8737-167bec6eb71b
      iscommand: true
      name: Add Certificate details to Context
      script: '|||expanse-get-certificate'
      type: regular
      version: -1
    taskid: ef595f31-b333-45d8-8737-167bec6eb71b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 340,
          "y": 240
        }
      }
  "101":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: ExtractedExpanseDomains
          operator: isNotEmpty
      label: "yes"
    id: "101"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "176"
      "yes":
      - "180"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 952402a0-5d10-4c85-8c80-42245aa27955
      iscommand: false
      name: Are there Domains to enrich?
      type: condition
      version: -1
      description: Check if there are Expanse Domains in the inputs.
    taskid: 952402a0-5d10-4c85-8c80-42245aa27955
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1327.5,
          "y": -360
        }
      }
  "131":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: inputs.Expanse Assets.assettype
                    operator: isEqualString
                    right:
                      value:
                        simple: IpRange
                root: inputs.Expanse Assets
                transformers:
                - args:
                    field:
                      value:
                        simple: assetkey
                  operator: getField
                - operator: toUpperCase
          operator: isNotEmpty
      label: "yes"
    id: "131"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "190"
      "yes":
      - "132"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: aff37567-6d54-482c-8767-598fd04528b7
      iscommand: false
      name: Are there IP Ranges to enrich?
      type: condition
      version: -1
      description: Check if there are Expanse IP Ranges in the inputs.
    taskid: aff37567-6d54-482c-8767-598fd04528b7
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2790,
          "y": -520
        }
      }
  "132":
    id: "132"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "190"
    note: false
    quietmode: 0
    scriptarguments:
      businessunitnames: {}
      businessunits: {}
      id:
        complex:
          accessor: assetkey
          filters:
          - - left:
                iscontext: true
                value:
                  simple: incident.expanseasset.assettype
              operator: isEqualString
              right:
                value:
                  simple: IpRange
          root: incident.expanseasset
      include: {}
      inet: {}
      tagnames: {}
      tags: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Get ip-range by id or search ip-ranges
      id: e5276578-71b2-49cc-81ba-ec669d4590e4
      iscommand: true
      name: Add IP Range details to Context
      script: '|||expanse-get-iprange'
      type: regular
      version: -1
    taskid: e5276578-71b2-49cc-81ba-ec669d4590e4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2570,
          "y": -340
        }
      }
  "169":
    id: "169"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "101"
    note: false
    quietmode: 0
    scriptarguments:
      append: {}
      key:
        simple: ExtractedExpanseDomains
      stringify: {}
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: inputs.Expanse Assets.assettype
              operator: isEqualString
              right:
                value:
                  simple: Domain
          - - left:
                iscontext: true
                value:
                  simple: inputs.Expanse Assets.assetkey
              operator: notStartWith
              right:
                value:
                  simple: '*.'
          root: inputs.Expanse Assets
          transformers:
          - args:
              field:
                value:
                  simple: assetkey
            operator: getField
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: 90af787a-a5ce-473b-8adf-e11e02271557
      iscommand: false
      name: Extract Domain Indicators from Expanse Assets
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 90af787a-a5ce-473b-8adf-e11e02271557
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1327.5,
          "y": -520
        }
      }
  "170":
    id: "170"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "183"
    note: false
    quietmode: 0
    scriptarguments:
      append: {}
      key:
        simple: ExtractedExpanseDomainGlobs
      stringify: {}
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: incident.expanseasset.assettype
              operator: isEqualString
              right:
                value:
                  simple: Domain
          - - left:
                iscontext: true
                value:
                  simple: incident.expanseasset.assetkey
              operator: startWith
              right:
                value:
                  simple: '*.'
          root: incident.expanseasset
          transformers:
          - args:
              field:
                value:
                  simple: assetkey
            operator: getField
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: 6b1fe0f5-a919-40d3-868f-f44bfeba3e60
      iscommand: false
      name: Extract DomainGlob indicators from Expanse Assets
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 6b1fe0f5-a919-40d3-868f-f44bfeba3e60
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2090,
          "y": -520
        }
      }
  "172":
    id: "172"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "173"
      - "175"
      - "182"
      - "189"
      - "191"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 767ed130-a476-43dc-8e72-77a899ad0dd3
      iscommand: false
      name: Create and Enrich Indicators
      type: title
      version: -1
      description: ''
    taskid: 767ed130-a476-43dc-8e72-77a899ad0dd3
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1327.5,
          "y": -850
        }
      }
  "173":
    id: "173"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "41"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6413ba4a-5daf-49a9-8299-0b14eadb2c17
      iscommand: false
      name: Certificates
      type: title
      version: -1
      description: ''
    taskid: 6413ba4a-5daf-49a9-8299-0b14eadb2c17
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 580,
          "y": -655
        }
      }
  "174":
    id: "174"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b3a9fc2a-17c5-4bb9-85a6-c5628c8b4041
      iscommand: false
      name: Done with Certificates
      type: title
      version: -1
      description: ''
    taskid: b3a9fc2a-17c5-4bb9-85a6-c5628c8b4041
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 570,
          "y": 540
        }
      }
  "175":
    id: "175"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "169"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9b19f74f-f9da-4568-8dd8-dd607a64a46f
      iscommand: false
      name: Domains
      type: title
      version: -1
      description: ''
    taskid: 9b19f74f-f9da-4568-8dd8-dd607a64a46f
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1327.5,
          "y": -655
        }
      }
  "176":
    id: "176"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 094bfbba-ec0c-4e52-8921-537ad46ea5d0
      iscommand: false
      name: Done with Domains
      type: title
      version: -1
      description: ''
    taskid: 094bfbba-ec0c-4e52-8921-537ad46ea5d0
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1327.5,
          "y": 890
        }
      }
  "177":
    id: "177"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "178"
    note: false
    quietmode: 0
    scriptarguments:
      accounttype: {}
      actor: {}
      admincountry: {}
      adminemail: {}
      adminname: {}
      adminphone: {}
      asn: {}
      assignedrole: {}
      assigneduser: {}
      associatedfilenames: {}
      associations: {}
      biosversion: {}
      campaign: {}
      category: {}
      city: {}
      costcenter: {}
      costcentercode: {}
      countryname: {}
      creationdate: {}
      customFields: {}
      cvedescription: {}
      cvemodified: {}
      cvss: {}
      department: {}
      description: {}
      detectionengines: {}
      devicemodel: {}
      dhcpserver: {}
      displayname: {}
      dns: {}
      domainidnname: {}
      domainname: {}
      domainreferringips: {}
      domainreferringsubnets: {}
      domainstatus: {}
      email: {}
      emailaddress: {}
      entryid: {}
      expanseassettype: {}
      expansebusinessunits: {}
      expansecertificateadvertisementstatus: {}
      expansecommonname: {}
      expansedateadded: {}
      expansednsresolutionstatus: {}
      expansedomain: {}
      expansefirstobserved: {}
      expanseissuerdn: {}
      expanselastobserved: {}
      expansepemmd5hash: {}
      expanseproperties: {}
      expanseprovidername: {}
      expansesans: {}
      expanseserialnumber: {}
      expanseservicestatus: {}
      expansesha256fingerprint: {}
      expansesourcedomain: {}
      expansesubjectdn: {}
      expansetags: {}
      expansetenantname: {}
      expansetype: {}
      expansevalidnotafter: {}
      expansevalidnotbefore: {}
      expirationdate: {}
      feedrelatedindicators: {}
      fileextension: {}
      filetype: {}
      firstseenbysource: {}
      geocountry: {}
      geolocation: {}
      givenname: {}
      groups: {}
      hostname: {}
      imphash: {}
      indicatoridentification: {}
      internal: {}
      ipaddress: {}
      jobcode: {}
      jobfamily: {}
      jobfunction: {}
      lastseenbysource: {}
      leadership: {}
      location: {}
      locationregion: {}
      macaddress: {}
      malwarefamily: {}
      manageremailaddress: {}
      managername: {}
      md5: {}
      memory: {}
      merge: {}
      mobilephone: {}
      name: {}
      namefield: {}
      nameservers: {}
      office365category: {}
      office365expressroute: {}
      office365required: {}
      operatingsystem: {}
      operatingsystemversion: {}
      organization: {}
      organizationalunitou: {}
      osversion: {}
      path: {}
      personalemail: {}
      port: {}
      positivedetections: {}
      processor: {}
      processors: {}
      published: {}
      quarantined: {}
      region: {}
      registrantcountry: {}
      registrantemail: {}
      registrantname: {}
      registrantphone: {}
      registrarabuseemail: {}
      registrarabusephone: {}
      registrarname: {}
      relateToIncident: {}
      relatedIncidents: {}
      reportedby: {}
      reputation: {}
      seenNow: {}
      service: {}
      sha1: {}
      sha256: {}
      sha512: {}
      signatureauthentihash: {}
      signaturecopyright: {}
      signaturedescription: {}
      signaturefileversion: {}
      signatureinternalname: {}
      signed: {}
      size: {}
      source:
        simple: DBot
      sourceTimeStamp: {}
      sourceoriginalseverity: {}
      ssdeep: {}
      state: {}
      stixaliases: {}
      stixdescription: {}
      stixgoals: {}
      stixid: {}
      stixismalwarefamily: {}
      stixkillchainphases: {}
      stixmalwaretypes: {}
      stixprimarymotivation: {}
      stixresourcelevel: {}
      stixroles: {}
      stixsecondarymotivations: {}
      stixsophistication: {}
      stixthreatactortypes: {}
      stixtooltypes: {}
      stixtoolversion: {}
      streetaddress: {}
      subdomains: {}
      surname: {}
      tags: {}
      threattypes: {}
      title: {}
      trafficlightprotocol: {}
      type:
        simple: Domain
      updateddate: {}
      username: {}
      value:
        complex:
          root: ExtractedExpanseDomains
      workphone: {}
      xdrstatus: {}
      zipcode: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 36f73b85-24de-405d-8346-c66bc9a16983
      iscommand: true
      name: Create Domain Indicators
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 36f73b85-24de-405d-8346-c66bc9a16983
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 890,
          "y": 5
        }
      }
  "178":
    id: "178"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "181"
    note: false
    quietmode: 0
    scriptarguments:
      indicatorsValues:
        complex:
          root: ExtractedExpanseDomains
      using-brand: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.enrich.indicators
      id: 3251aae8-00d4-4961-8a93-86badf85f133
      iscommand: true
      name: Enrich Domain Indicators
      script: Builtin|||enrichIndicators
      type: regular
      version: -1
    taskid: 3251aae8-00d4-4961-8a93-86badf85f133
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 890,
          "y": 165
        }
      }
  "179":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.Create Indicators
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    id: "179"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "100"
      "yes":
      - "42"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 60de1375-77c9-4c2f-841b-f694bf822943
      iscommand: false
      name: Create Indicators?
      type: condition
      version: -1
      description: Check whether the playbook should create new indicators.
    taskid: 60de1375-77c9-4c2f-841b-f694bf822943
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 340,
          "y": -315
        }
      }
  "180":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.Create Indicators
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    id: "180"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "181"
      "yes":
      - "177"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: de299d21-d25c-4895-82fc-89b882f6406e
      iscommand: false
      name: Create Indicators?
      type: condition
      version: -1
      description: Check whether the playbook should create new indicators.
    taskid: de299d21-d25c-4895-82fc-89b882f6406e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1100,
          "y": -190
        }
      }
  "181":
    id: "181"
    ignoreworker: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "196"
    note: false
    quietmode: 0
    scriptarguments:
      Domain:
        complex:
          root: ExtractedExpanseDomains
          transformers:
          - operator: uniq
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: a9af30c6-6f95-4a50-816c-fc21a66f4084
      iscommand: false
      name: Domain Enrichment - Generic v2
      playbookId: Domain Enrichment - Generic v2
      type: playbook
      version: -1
      description: ''
    taskid: a9af30c6-6f95-4a50-816c-fc21a66f4084
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1100,
          "y": 355
        }
      }
  "182":
    id: "182"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "170"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6a570da2-8f10-4173-8fcc-5cc57d15ef3d
      iscommand: false
      name: DomainGlobs
      type: title
      version: -1
      description: ''
    taskid: 6a570da2-8f10-4173-8fcc-5cc57d15ef3d
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2090,
          "y": -655
        }
      }
  "183":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: ExtractedExpanseDomainGlobs
          operator: isNotEmpty
      label: "yes"
    id: "183"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "184"
      "yes":
      - "185"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e8297287-0165-42a2-8048-7f23d6c3b1e6
      iscommand: false
      name: Are there DomainGlobs to enrich?
      type: condition
      description: Check if there are Expanse Domain Globs in the inputs.
      version: -1
    taskid: e8297287-0165-42a2-8048-7f23d6c3b1e6
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2090,
          "y": -370
        }
      }
  "184":
    id: "184"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d9b45534-8646-4f32-82fb-49d1f2929189
      iscommand: false
      name: Done with DomainGlobs
      type: title
      version: -1
      description: ''
    taskid: d9b45534-8646-4f32-82fb-49d1f2929189
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2090,
          "y": 730
        }
      }
  "185":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.Create Indicators
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    id: "185"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "186"
      "yes":
      - "187"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a2665b65-4a67-4840-8e1d-ffb9a7fc505d
      iscommand: false
      name: Create Indicators?
      type: condition
      version: -1
      description: Check whether the playbook should create new indicators.
    taskid: a2665b65-4a67-4840-8e1d-ffb9a7fc505d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1840,
          "y": -190
        }
      }
  "186":
    id: "186"
    ignoreworker: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "195"
    note: false
    quietmode: 0
    scriptarguments:
      Domain:
        complex:
          root: ExtractedExpanseDomainGlobs
          transformers:
          - operator: uniq
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: ca44d40a-29a2-4771-8e88-ea008c16d5b9
      iscommand: false
      name: Domain Enrichment - Generic v2
      playbookId: Domain Enrichment - Generic v2
      type: playbook
      version: -1
      description: ''
    taskid: ca44d40a-29a2-4771-8e88-ea008c16d5b9
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1840,
          "y": 355
        }
      }
  "187":
    id: "187"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "188"
    note: false
    quietmode: 0
    scriptarguments:
      accounttype: {}
      actor: {}
      admincountry: {}
      adminemail: {}
      adminname: {}
      adminphone: {}
      asn: {}
      assignedrole: {}
      assigneduser: {}
      associatedfilenames: {}
      associations: {}
      biosversion: {}
      campaign: {}
      category: {}
      city: {}
      costcenter: {}
      costcentercode: {}
      countryname: {}
      creationdate: {}
      customFields: {}
      cvedescription: {}
      cvemodified: {}
      cvss: {}
      department: {}
      description: {}
      detectionengines: {}
      devicemodel: {}
      dhcpserver: {}
      displayname: {}
      dns: {}
      domainidnname: {}
      domainname: {}
      domainreferringips: {}
      domainreferringsubnets: {}
      domainstatus: {}
      email: {}
      emailaddress: {}
      entryid: {}
      expanseassettype: {}
      expansebusinessunits: {}
      expansecertificateadvertisementstatus: {}
      expansecommonname: {}
      expansedateadded: {}
      expansednsresolutionstatus: {}
      expansedomain: {}
      expansefirstobserved: {}
      expanseissuerdn: {}
      expanselastobserved: {}
      expansepemmd5hash: {}
      expanseproperties: {}
      expanseprovidername: {}
      expansesans: {}
      expanseserialnumber: {}
      expanseservicestatus: {}
      expansesha256fingerprint: {}
      expansesourcedomain: {}
      expansesubjectdn: {}
      expansetags: {}
      expansetenantname: {}
      expansetype: {}
      expansevalidnotafter: {}
      expansevalidnotbefore: {}
      expirationdate: {}
      feedrelatedindicators: {}
      fileextension: {}
      filetype: {}
      firstseenbysource: {}
      geocountry: {}
      geolocation: {}
      givenname: {}
      groups: {}
      hostname: {}
      imphash: {}
      indicatoridentification: {}
      internal: {}
      ipaddress: {}
      jobcode: {}
      jobfamily: {}
      jobfunction: {}
      lastseenbysource: {}
      leadership: {}
      location: {}
      locationregion: {}
      macaddress: {}
      malwarefamily: {}
      manageremailaddress: {}
      managername: {}
      md5: {}
      memory: {}
      merge: {}
      mobilephone: {}
      name: {}
      namefield: {}
      nameservers: {}
      office365category: {}
      office365expressroute: {}
      office365required: {}
      operatingsystem: {}
      operatingsystemversion: {}
      organization: {}
      organizationalunitou: {}
      osversion: {}
      path: {}
      personalemail: {}
      port: {}
      positivedetections: {}
      processor: {}
      processors: {}
      published: {}
      quarantined: {}
      region: {}
      registrantcountry: {}
      registrantemail: {}
      registrantname: {}
      registrantphone: {}
      registrarabuseemail: {}
      registrarabusephone: {}
      registrarname: {}
      relateToIncident: {}
      relatedIncidents: {}
      reportedby: {}
      reputation: {}
      seenNow: {}
      service: {}
      sha1: {}
      sha256: {}
      sha512: {}
      signatureauthentihash: {}
      signaturecopyright: {}
      signaturedescription: {}
      signaturefileversion: {}
      signatureinternalname: {}
      signed: {}
      size: {}
      source:
        simple: DBot
      sourceTimeStamp: {}
      sourceoriginalseverity: {}
      ssdeep: {}
      state: {}
      stixaliases: {}
      stixdescription: {}
      stixgoals: {}
      stixid: {}
      stixismalwarefamily: {}
      stixkillchainphases: {}
      stixmalwaretypes: {}
      stixprimarymotivation: {}
      stixresourcelevel: {}
      stixroles: {}
      stixsecondarymotivations: {}
      stixsophistication: {}
      stixthreatactortypes: {}
      stixtooltypes: {}
      stixtoolversion: {}
      streetaddress: {}
      subdomains: {}
      surname: {}
      tags: {}
      threattypes: {}
      title: {}
      trafficlightprotocol: {}
      type:
        simple: DomainGlob
      updateddate: {}
      username: {}
      value:
        complex:
          root: ExtractedExpanseDomainGlobs
      workphone: {}
      xdrstatus: {}
      zipcode: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.new.indicator
      id: 53cba84c-6461-49a7-8b68-2177ce3606ac
      iscommand: true
      name: Create DomainGlob Indicators
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: 53cba84c-6461-49a7-8b68-2177ce3606ac
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1600,
          "y": 5
        }
      }
  "188":
    id: "188"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "186"
    note: false
    quietmode: 0
    scriptarguments:
      indicatorsValues:
        complex:
          root: ExtractedExpanseDomainGlobs
      using-brand: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.enrich.indicators
      id: ec249e40-bf80-4211-8ba3-86677077631d
      iscommand: true
      name: Enrich DomainGlob Indicators
      script: Builtin|||enrichIndicators
      type: regular
      version: -1
    taskid: ec249e40-bf80-4211-8ba3-86677077631d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1600,
          "y": 165
        }
      }
  "189":
    id: "189"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "131"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c7e4f2a6-1f7c-44a8-88e0-d9a4bb89b4a9
      iscommand: false
      name: IP Ranges
      type: title
      version: -1
      description: ''
    taskid: c7e4f2a6-1f7c-44a8-88e0-d9a4bb89b4a9
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2790,
          "y": -655
        }
      }
  "190":
    id: "190"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ed986f68-03e3-454b-8678-9097b18cb17d
      iscommand: false
      name: Done with IP Ranges
      type: title
      version: -1
      description: ''
    taskid: ed986f68-03e3-454b-8678-9097b18cb17d
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2790,
          "y": 540
        }
      }
  "191":
    id: "191"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "192"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1e17a9b0-e8cd-4563-8838-d10dcf3f3954
      iscommand: false
      name: IP
      type: title
      version: -1
      description: ''
    taskid: 1e17a9b0-e8cd-4563-8838-d10dcf3f3954
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 3410,
          "y": -655
        }
      }
  "192":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.Expanse IP
          operator: isNotEmpty
      label: "yes"
    id: "192"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "193"
      "yes":
      - "194"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5059cc4e-dd79-41e4-898b-c84efc2d8b6f
      iscommand: false
      name: Is there an IP to enrich?
      type: condition
      version: -1
      description: Check if there are Expanse Certificates in the inputs.
    taskid: 5059cc4e-dd79-41e4-898b-c84efc2d8b6f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 3410,
          "y": -520
        }
      }
  "193":
    id: "193"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f28cb932-fa0b-4ca2-8375-e178dab20a55
      iscommand: false
      name: Done with IP
      type: title
      version: -1
      description: ''
    taskid: f28cb932-fa0b-4ca2-8375-e178dab20a55
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 3410,
          "y": 540
        }
      }
  "194":
    id: "194"
    ignoreworker: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "193"
    note: false
    quietmode: 0
    scriptarguments:
      IP:
        complex:
          root: inputs.Expanse IP
          transformers:
          - operator: uniq
      InternalRange: {}
      ResolveIP:
        simple: "True"
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Enrich IP addresses using one or more integrations.

        - Resolve IP addresses to hostnames (DNS)
        - Provide threat information
        - Separate internal and external IP addresses
        - For internal IP addresses, get host information
      id: 2766bce6-380e-4f7e-8009-bf6eae1453d7
      iscommand: false
      name: IP Enrichment - Generic v2
      playbookId: IP Enrichment - Generic v2
      type: playbook
      version: -1
    taskid: 2766bce6-380e-4f7e-8009-bf6eae1453d7
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 3190,
          "y": -330
        }
      }
  "195":
    id: "195"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "184"
    note: false
    quietmode: 0
    scriptarguments:
      businessunitnames: {}
      businessunits: {}
      domain:
        complex:
          root: ExtractedExpanseDomainGlobs
          transformers:
          - operator: uniq
      has_active_service: {}
      has_dns_resolution: {}
      has_related_cloud_resources: {}
      last_observed_date: {}
      providernames: {}
      providers: {}
      search: {}
      tagnames: {}
      tags: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Get domain details by domain name or search certificates
      id: a9682474-0346-4376-8707-46b6046f919f
      iscommand: true
      name: Add Expanse Domain Details to Context
      script: '|||expanse-get-domain'
      type: regular
      version: -1
    taskid: a9682474-0346-4376-8707-46b6046f919f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1840,
          "y": 520
        }
      }
  "196":
    id: "196"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "197"
    note: false
    quietmode: 0
    scriptarguments:
      businessunitnames: {}
      businessunits: {}
      domain:
        complex:
          root: ExtractedExpanseDomains
          transformers:
          - operator: uniq
      has_active_service: {}
      has_dns_resolution: {}
      has_related_cloud_resources: {}
      last_observed_date: {}
      providernames: {}
      providers: {}
      search: {}
      tagnames: {}
      tags: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Get domain details by domain name or search certificates
      id: 9cec6cb8-cd47-4351-8156-3592b7ac0307
      iscommand: true
      name: Add Expanse Domain Details to Context
      script: '|||expanse-get-domain'
      type: regular
      version: -1
    taskid: 9cec6cb8-cd47-4351-8156-3592b7ac0307
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1100,
          "y": 525
        }
      }
  "197":
    id: "197"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "176"
    note: false
    quietmode: 0
    scriptarguments:
      domain:
        complex:
          root: ExtractedExpanseDomains
      qtype: {}
      server: {}
      use_tcp: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns DNS details for a domain
      id: 54bd3a7c-fbd5-4622-8538-c08aecf8a9e4
      iscommand: false
      name: Get Domain DNS Details
      script: GetDomainDNSDetails
      type: regular
      version: -1
    taskid: 54bd3a7c-fbd5-4622-8538-c08aecf8a9e4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1100,
          "y": 700
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2265,
        "width": 3760,
        "x": 30,
        "y": -1070
      }
    }
  }
tests:
- No tests (auto formatted)
fromversion: 6.0.0
