description: Main playbook for Expanse Issues
id: Handle Expanse Incident
inputs:
- description: |-
    Minimum Incident Priority for Auto Remediation:
    1 - Low
    2 - Medium
    3 - High
    4 - Critical
  key: MinPriorityForAutoRemediation
  playbookInputQuery:
  required: false
  value:
    simple: "1"
- description: Name of XSOAR List that contains the mapping between Expanse tags and
    XSOAR PANOS Instances.
  key: FirewallTagListName
  playbookInputQuery:
  required: false
  value:
    simple: ExpanseTagsToPANOSDeviceGroup
- description: Prefix for XSOAR related Expanse tags
  key: TagPrefix
  playbookInputQuery:
  required: false
  value:
    simple: xsoar-
- description: PAN-OS Log Forwarding Profile Name
  key: LogForwarding
  playbookInputQuery:
  required: false
  value: {}
- description: Panorama Auto Commit
  key: AutoCommit
  playbookInputQuery:
  required: false
  value:
    simple: "Yes"
- description: Comma separated list of tags to be used to identify IP ranges attributed
    with low confidence
  key: IPRangeLowConfidenceTagList
  playbookInputQuery:
  required: false
  value:
    simple: low confidence
- description: Tag to be used for assets that do not belong to org
  key: FalsePositiveTag
  playbookInputQuery:
  required: false
  value:
    simple: xsoar-false-positive
- description: Write data back to Expanse?
  key: WriteToExpanse
  playbookInputQuery:
  required: false
  value:
    simple: "True"
name: Handle Expanse Incident
outputs: []
starttaskid: "0"
tasks:
  "0":
    id: "0"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "163"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 569aafc5-1607-4b78-83d2-c6bfe05c2a07
      iscommand: false
      name: ""
      version: -1
      description: ''
    taskid: 569aafc5-1607-4b78-83d2-c6bfe05c2a07
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 1327.5,
          "y": -2180
        }
      }
  "1":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: ExpanseDeviceGroupAssetTags
          operator: isNotEmpty
      label: "yes"
    defaultassigneecomplex: {}
    id: "1"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "2"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 45f02621-d6a4-430b-8ec8-f48af14abbe4
      iscommand: false
      name: Are there Expanse Asset Tags for this incident?
      type: condition
      version: -1
      description: Check whether Expanse Asset tags are present in this incident.
    taskid: 45f02621-d6a4-430b-8ec8-f48af14abbe4
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1950,
          "y": 6545
        }
      }
  "2":
    id: "2"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8abd32f1-2d7d-4f84-8231-b4b53679dfce
      iscommand: false
      name: Use Device Groups from Expanse Asset Tags
      type: title
      version: -1
      description: ''
    taskid: 8abd32f1-2d7d-4f84-8231-b4b53679dfce
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2330,
          "y": 6735
        }
      }
  "3":
    id: "3"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c2b6fadc-4a9c-4716-8927-62d092b93300
      iscommand: false
      name: Search Device Groups from Logs
      type: title
      version: -1
      description: ''
    taskid: c2b6fadc-4a9c-4716-8927-62d092b93300
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1707.5,
          "y": 6725
        }
      }
  "4":
    id: "4"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    scriptarguments:
      append: {}
      key:
        simple: TargetFirewalls
      stringify: {}
      value:
        complex:
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: Expanse.AttributionDevice.exposing_service
              operator: isTrue
          - - left:
                iscontext: true
                value:
                  simple: Expanse.AttributionDevice.sightings
              operator: greaterThan
              right:
                value:
                  simple: "0"
          root: Expanse.AttributionDevice
          transformers:
          - operator: Stringify
          - args:
              limit: {}
              replaceWith:
                value:
                  simple: devicegroup
              toReplace:
                value:
                  simple: device-group
            operator: replace
          - operator: ParseJSON
          - args:
              expression:
                value:
                  simple: '{deviceGroup: devicegroup, source: ''From Logs'', sightings:sightings}'
            operator: jmespath
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: 5c2b7a69-6aea-475f-8a87-969db058748b
      iscommand: false
      name: Find Possible Device Groups
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 5c2b7a69-6aea-475f-8a87-969db058748b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1707.5,
          "y": 6850
        }
      }
  "5":
    id: "5"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "12"
      - "122"
      - "138"
      - "65"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8a16bf45-2f5c-402e-81f5-25bf2102e9be
      iscommand: false
      name: Set Up Context Variables
      type: title
      version: -1
      description: ''
    taskid: 8a16bf45-2f5c-402e-81f5-25bf2102e9be
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1327.5,
          "y": -1450
        }
      }
  "6":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: incident.severity
          operator: greaterThanOrEqual
          right:
            iscontext: true
            value:
              simple: inputs.MinPriorityForAutoRemediation
      label: "yes"
    id: "6"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "14"
      "yes":
      - "124"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f99f654b-2634-4ef6-8318-c9d4acf9f1a8
      iscommand: false
      name: Is Incident Priority Above AutoRemediation Threshold?
      type: condition
      version: -1
      description: Check whether incident priority is above autoremediation threshold.
    taskid: f99f654b-2634-4ef6-8318-c9d4acf9f1a8
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1447.5,
          "y": 6035
        }
      }
  "8":
    id: "8"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "75"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fd226ddd-8180-4c2f-87bc-4743cf7cff4e
      iscommand: false
      name: Done Network  Remediation
      type: title
      version: -1
      description: ''
    taskid: fd226ddd-8180-4c2f-87bc-4743cf7cff4e
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1447.5,
          "y": 9905
        }
      }
  "9":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expanseip
                root: incident
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expanseport
                root: incident
          operator: InRange
          right:
            value:
              simple: 1,65535
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: expanseprotocol
                root: incident
          operator: inList
          right:
            value:
              simple: tcp,udp
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expanseprovider
                root: incident
          operator: isEqualString
          right:
            value:
              simple: On Prem
      label: "Yes"
    id: "9"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "14"
      "Yes":
      - "6"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b7b6aebf-bdb3-4a5f-8189-530e60b1a382
      iscommand: false
      name: Is Issue AutoRemediable with PAN-OS? (On-Prem and has IP:Port)
      type: condition
      version: -1
      description: Check whether the issue can be auto-remediated with PAN-OS (on-prem and ip/port found)
    taskid: b7b6aebf-bdb3-4a5f-8189-530e60b1a382
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1102.5,
          "y": 5860
        }
      }
  "10":
    id: "10"
    ignoreworker: false
    nexttasks:
      ✅ Yes:
      - "24"
      ❌ No:
      - "14"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 329b6e95-45d7-436a-82d3-1fa10bf8c65c
      iscommand: false
      name: Block ${incident.expanseip}:${incident.expanseport}/${incident.expanseprotocol}
        on ${PanOSDeviceGroups} ?
      type: condition
      version: -1
      description: Ask the user confirmation on whether blocking the service.
    taskid: 329b6e95-45d7-436a-82d3-1fa10bf8c65c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1952.5,
          "y": 9010
        }
      }
  "11":
    id: "11"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: TargetFirewalls
      stringify: {}
      value:
        complex:
          accessor: =[]}
          root: ${
          transformers:
          - args:
              key:
                iscontext: true
                value:
                  simple: FirewallTagList
              list:
                iscontext: true
                value:
                  simple: ExpanseDeviceGroupAssetTags
            operator: GetValuesOfMultipleFields
          - args:
              prefix:
                value:
                  simple: '{"dg":"'
              suffix:
                value:
                  simple: '"}'
            operator: concat
          - args:
              separator:
                value:
                  simple: ','
            operator: join
          - args:
              prefix:
                value:
                  simple: '['
              suffix:
                value:
                  simple: ']'
            operator: concat
          - operator: ParseJSON
          - args:
              expression:
                value:
                  simple: '{deviceGroup:dg, source: ''From Expanse Tags'', sightings:''N/A''}'
            operator: jmespath
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: b76aa0d9-da6b-4722-8d19-2d4382102f31
      iscommand: false
      name: Set Target Device Groups from Expanse Tags
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: b76aa0d9-da6b-4722-8d19-2d4382102f31
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2330,
          "y": 6850
        }
      }
  "12":
    id: "12"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "159"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: ExpanseXSOARIssueTags
      stringify: {}
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: incident.expansetags
              operator: startWith
              right:
                iscontext: true
                value:
                  simple: inputs.TagPrefix
          root: incident.expansetags
          transformers:
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: 99559d4e-9129-4847-8731-9988a6855c9a
      iscommand: false
      name: Extract XSOAR Incident Tags from Expanse
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 99559d4e-9129-4847-8731-9988a6855c9a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 907.5,
          "y": -1305
        }
      }
  "13":
    id: "13"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8a6751fd-3b71-4116-8698-f483ef5f821d
      iscommand: false
      name: Manual Block on Network
      type: regular
      version: -1
      description: Perform manual block on the network
    taskid: 8a6751fd-3b71-4116-8698-f483ef5f821d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1447.5,
          "y": 9420
        }
      }
  "14":
    id: "14"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 66143cb9-a83e-496c-8885-0eec70cfcd1c
      iscommand: false
      name: Manual Network Remediation
      type: title
      version: -1
      description: ''
    taskid: 66143cb9-a83e-496c-8885-0eec70cfcd1c
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1447.5,
          "y": 9225
        }
      }
  "15":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: TargetFirewalls
          operator: isNotEmpty
      label: "yes"
    id: "15"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "16"
      "yes":
      - "66"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6c7bccc6-6de9-4d33-8fc4-c7a7c8aa6a00
      iscommand: false
      name: Device Groups found?
      type: condition
      version: -1
      description: Check whether a target device group is found
    taskid: 6c7bccc6-6de9-4d33-8fc4-c7a7c8aa6a00
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2045,
          "y": 7040
        }
      }
  "16":
    form:
      description: Choose Device Group
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: What Device Group do you want to apply the configuration on?
        options: []
        optionsarg:
        - complex:
            root: FirewallTagList
            transformers:
            - args:
                expression:
                  value:
                    simple: values(@)
              operator: jmespath
        - simple: ➕ Add New
        - simple: "\U0001F525 Firewall Only (No Panorama)"
        - simple: ❌ Manual Configuration
        placeholder: ""
        readonly: false
        required: true
        tooltip: Choose Device Group
        type: singleSelect
      sender: ""
      title: Choose Device Group
      totalanswers: 0
    id: "16"
    ignoreworker: false
    message:
      bcc:
      body:
        simple: Choose target Device Group
      cc:
      format: ""
      methods: []
      subject:
        simple: Choose target Device Group
      timings:
        completeafterreplies: 1
        retriescount: 2
        retriesinterval: 360
      to:
        simple: Analyst
    nexttasks:
      '#none#':
      - "119"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8f8da62c-0473-459b-83db-c93251bf0a17
      iscommand: false
      name: Choose Device Group to enforce policy
      type: collection
      version: -1
      description: Ask the user on which Device Group to enforce the policy change.
    taskid: 8f8da62c-0473-459b-83db-c93251bf0a17
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 2045,
          "y": 7395
        }
      }
  "18":
    id: "18"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "120"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4f1c5dbe-cd56-41c6-8407-6358e3a53197
      iscommand: false
      name: DG Tagging
      type: title
      version: -1
      description: ''
    taskid: 4f1c5dbe-cd56-41c6-8407-6358e3a53197
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2742.5,
          "y": 7775
        }
      }
  "22":
    id: "22"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "36"
      - "34"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Start validation of Incident
      id: 3b49faad-6d9d-4492-86e4-16605f47d2e9
      iscommand: false
      name: Start Validation
      type: title
      version: -1
    taskid: 3b49faad-6d9d-4492-86e4-16605f47d2e9
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1320,
          "y": -110
        }
      }
  "23":
    id: "23"
    ignoreworker: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      AutoCommit:
        complex:
          root: inputs.AutoCommit
      DeviceGroup:
        complex:
          root: PanOSDeviceGroups
      IP:
        complex:
          accessor: expanseip
          root: incident
      LogForwarding:
        complex:
          root: inputs.LogForwarding
      Port:
        complex:
          accessor: expanseport
          root: incident
          transformers:
          - operator: Stringify
      Protocol:
        complex:
          accessor: expanseprotocol
          root: incident
          transformers:
          - operator: toLowerCase
      RuleNamePrefix:
        simple: xsoar-rule-
      ServiceNamePrefix:
        simple: xsoar-service-
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: This playbook blocks a Destination IP and Service (tcp or udp port)
        by creating a rule on a specific Device Group
      id: f45fed1b-6819-41bf-802c-a1822e895791
      iscommand: false
      name: PAN-OS - Block Destination Service
      playbookId: PAN-OS - Block Destination Service
      type: playbook
      version: -1
    taskid: f45fed1b-6819-41bf-802c-a1822e895791
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 2475,
          "y": 9715
        }
      }
  "24":
    id: "24"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f220a32c-88cd-489f-8852-344d7d083442
      iscommand: false
      name: Block Service
      type: title
      version: -1
      description: ''
    taskid: f220a32c-88cd-489f-8852-344d7d083442
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2262.5,
          "y": 9205
        }
      }
  "25":
    id: "25"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    scriptarguments:
      target: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Show firewall device software version.
      id: b0acef1e-ed1e-4b52-8a89-cf2b486ea57b
      iscommand: true
      name: Get PAN-OS Version
      script: '|||panorama-show-device-version'
      type: regular
      version: -1
    taskid: b0acef1e-ed1e-4b52-8a89-cf2b486ea57b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2262.5,
          "y": 9365
        }
      }
  "26":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: Model
                root: Panorama.Device.Info
          operator: isEqualString
          right:
            value:
              simple: panorama
      label: Panorama
    id: "26"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "27"
      Panorama:
      - "23"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 95c91fc0-fc7c-453d-8722-4992809f1b95
      iscommand: false
      name: Firewall or Panorama?
      type: condition
      version: -1
      description: Check whether target device is a Firewall or Panorama
    taskid: 95c91fc0-fc7c-453d-8722-4992809f1b95
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2262.5,
          "y": 9540
        }
      }
  "27":
    id: "27"
    ignoreworker: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      AutoCommit:
        complex:
          root: inputs.AutoCommit
      DeviceGroup: {}
      IP:
        complex:
          accessor: expanseip
          root: incident
      LogForwarding:
        complex:
          root: inputs.LogForwarding
      Port:
        complex:
          accessor: expanseport
          root: incident
          transformers:
          - operator: Stringify
      Protocol:
        complex:
          accessor: expanseprotocol
          root: incident
          transformers:
          - operator: toLowerCase
      RuleNamePrefix:
        simple: xsoar-rule-
      ServiceNamePrefix:
        simple: xsoar-service-
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: 2bd40b15-6240-49a3-8d02-75f6aedda6cf
      iscommand: false
      name: PAN-OS - Block Destination Service
      playbookId: PAN-OS - Block Destination Service
      type: playbook
      version: -1
      description: ''
    taskid: 2bd40b15-6240-49a3-8d02-75f6aedda6cf
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 2055,
          "y": 9715
        }
      }
  "28":
    id: "28"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "167"
      - "141"
      - "31"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 44d8a368-09a4-4479-8869-e697ff235fd4
      iscommand: false
      name: Enrichment
      type: title
      version: -1
      description: ''
    taskid: 44d8a368-09a4-4479-8869-e697ff235fd4
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1327.5,
          "y": -880
        }
      }
  "29":
    id: "29"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0e650070-017f-4615-8c82-2650aa30895b
      iscommand: false
      name: Done Enrichment
      type: title
      version: -1
      description: ''
    taskid: 0e650070-017f-4615-8c82-2650aa30895b
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1327.5,
          "y": -290
        }
      }
  "30":
    id: "30"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "81"
      - "82"
      - "84"
      - "109"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 44c2fff0-4c02-445e-8bcd-76475722f25d
      iscommand: false
      name: Remediation
      type: title
      version: -1
      description: ''
    taskid: 44c2fff0-4c02-445e-8bcd-76475722f25d
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 600,
          "y": 5550
        }
      }
  "31":
    evidencedata:
      customfields: {}
      description:
        simple: Risky Flows from Expanse Behavior for this incident's IP
    id: "31"
    ignoreworker: false
    note: true
    quietmode: 0
    scriptarguments:
      created_after: {}
      created_before: {}
      internal_ip_range:
        complex:
          accessor: expanseip
          root: incident
      limit: {}
      risk-rule: {}
      tagnames: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Retrieve Expanse Behavior Risky Flows
      id: a65bc13f-f976-4882-8d9d-67067b052ffe
      iscommand: true
      name: Extract Risky Flows from Behavior
      script: '|||expanse-get-risky-flows'
      type: regular
      version: -1
    taskid: a65bc13f-f976-4882-8d9d-67067b052ffe
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 622.5,
          "y": -600
        }
      }
  "34":
    id: "34"
    ignoreworker: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "147"
    note: false
    quietmode: 0
    scriptarguments:
      Asset:
        simple: ${incident.labels.assets[0]}
      Domain:
        simple: ${incident.expansedomain}
      IP:
        simple: ${incident.expanseip}
      InternalIPRange: {}
      Port:
        simple: ${incident.expanseport}
      Protocol:
        simple: ${incident.expanseprotocol}
      Provider:
        simple: ${incident.labels.providers[0].name}
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: "Given an Expanse Asset, Issue IP, Issue Provider, Issue Domain,\
        \ Issue Port and Issue Protocol hunts for internal activity on the detected\
        \ service. \nReturns a list of potential owner BUs, owner Users, Device and\
        \ Notes"
      id: 9a6818d9-3ace-4534-8571-af2c88f3ac08
      iscommand: false
      name: Expanse Attribution Subplaybook
      playbookId: Expanse Attribution Subplaybook
      type: playbook
      version: -1
    taskid: 9a6818d9-3ace-4534-8571-af2c88f3ac08
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 830,
          "y": 365
        }
      }
  "36":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: expanseprovider
                root: incident
          operator: isNotEqualString
          right:
            value:
              simple: On Prem
      label: "yes"
    id: "36"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "147"
      "yes":
      - "171"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1241ad4f-aff1-4283-8c5c-7d596a0a0258
      iscommand: false
      name: Is Issue Related To Cloud Asset?
      type: condition
      version: -1
      description: Check whether the asset is on prem or cloud.
    taskid: 1241ad4f-aff1-4283-8c5c-7d596a0a0258
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1440,
          "y": 50
        }
      }
  "40":
    id: "40"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "158"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: SuggestedShadowITAnswer
      stringify: {}
      value:
        simple: "Yes"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Set a value in context under the key you entered.
      id: 288b78f4-88cc-40cd-8ffe-f0e3668737fc
      iscommand: false
      name: Suggest possible Shadow IT
      script: Set
      type: regular
      version: -1
    taskid: 288b78f4-88cc-40cd-8ffe-f0e3668737fc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 960,
          "y": 2465
        }
      }
  "48":
    form:
      description: |-
        Playbook automatically collected details from different sources to help the identification of the owner of the asset. Please check the Evidence board for additional details that could help in your investigation.

        To continue your investigation, please decide:
        - the **Organization Unit** this asset belongs to. This will be used for notifications and remediations actions. If you don't know, you can select *Unknown*. If the asset doesn't belong to your organization, select *False Positive*. If the OU is not listed select *Add New* to add a new OU.
        - if the asset should be considered **Shadow IT**
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Select the Organization Unit owning this asset
        options: []
        optionsarg:
        - complex:
            accessor: ExpanseOrganizationUnitsToOwner
            root: lists
            transformers:
            - args:
                expression:
                  value:
                    simple: keys(@)
              operator: jmespath
        - simple: ❓Unknown
        - simple: ➕ Add New
        - simple: ❌ False Positive
        placeholder: ""
        readonly: false
        required: true
        tooltip: Select the Organization Unit owning this asset
        type: singleSelect
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "1"
        label: ""
        labelarg:
          complex:
            root: SuggestedShadowITAnswer
            transformers:
            - args:
                else:
                  value:
                    simple: Automatic analysis suggests that the asset is not Shadow
                      IT. Is the asset Shadow IT?
                equals:
                  value:
                    simple: "Yes"
                then:
                  value:
                    simple: Automatic analysis identified the asset as a possible
                      Shadow IT asset. Is the asset Shadow IT?
              operator: If-Then-Else
        options: []
        optionsarg:
        - simple: "No"
        - simple: ❓Undecided
        - simple: "Yes"
        placeholder: ""
        readonly: false
        required: true
        tooltip: Decide whether this a Shadow IT asset
        type: singleSelect
      sender: Your SOC team
      title: Analysis of Asset Attribution
      totalanswers: 0
    id: "48"
    ignoreworker: false
    message:
      bcc:
      body:
        complex:
          accessor: id
          root: incident
          transformers:
          - args:
              prefix:
                value:
                  simple: 'Input needed to help attribution in Expanse Issue  '
              suffix: {}
            operator: concat
      cc:
      format: ""
      methods: []
      subject:
        simple: '** not used **'
      timings:
        completeafterreplies: 1
        retriescount: 2
        retriesinterval: 360
      to:
        simple: Analyst
    nexttasks:
      '#none#':
      - "88"
      - "136"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 018db405-95bb-49bf-81af-cb520d34b50f
      iscommand: false
      name: 'Ask: What Is The Organization Unit?'
      type: collection
      version: -1
      description: Ask the user to perform attribution.
    taskid: 018db405-95bb-49bf-81af-cb520d34b50f
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 1247.5,
          "y": 3195
        }
      }
  "49":
    id: "49"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "93"
    note: false
    quietmode: 0
    scriptarguments:
      accountid: {}
      accountname: {}
      addLabels: {}
      agentid: {}
      app: {}
      appendMultiSelect: {}
      assetid: {}
      assigneduser: {}
      assignmentgroup: {}
      attachmentcount: {}
      attachmentextension: {}
      attachmenthash: {}
      attachmentid: {}
      attachmentname: {}
      attachmentsize: {}
      attachmenttype: {}
      blockedaction: {}
      bugtraq: {}
      caller: {}
      city: {}
      closeNotes: {}
      closeReason: {}
      cloudservice: {}
      commandline: {}
      costcenter: {}
      costcentercode: {}
      country: {}
      countryname: {}
      criticalassets: {}
      customFields: {}
      cve: {}
      cvss: {}
      dbotMirrorDirection: {}
      dbotMirrorId: {}
      dbotMirrorInstance: {}
      dbotMirrorTags: {}
      dbotprediction: {}
      dbotpredictionprobability: {}
      dbottextsuggestionhighlighted: {}
      deleteEmptyField: {}
      department: {}
      dest: {}
      desthostname: {}
      destinationhostname: {}
      destinationip: {}
      destinationnetwork: {}
      destinationport: {}
      destntdomain: {}
      destos: {}
      details: {}
      detectedexternalhosts: {}
      detectedexternalips: {}
      detectedinternalhosts: {}
      detectedinternalips: {}
      detectedusers: {}
      detectionendtime: {}
      detectionid: {}
      detectionupdatetime: {}
      detectionurl: {}
      deviceexternalip: {}
      devicehash: {}
      devicelocalip: {}
      devicemodel: {}
      devicename: {}
      displayname: {}
      duration: {}
      email: {}
      emailauthenticitycheck: {}
      emailbcc: {}
      emailbody: {}
      emailbodyformat: {}
      emailbodyhtml: {}
      emailcc: {}
      emailclassification: {}
      emailclientname: {}
      emailfrom: {}
      emailheaders: {}
      emailhtml: {}
      emailinreplyto: {}
      emailkeywords: {}
      emailmessageid: {}
      emailreceived: {}
      emailreplyto: {}
      emailreturnpath: {}
      emailsenderip: {}
      emailsize: {}
      emailsource: {}
      emailsubject: {}
      emailto: {}
      emailtocount: {}
      emailurlclicked: {}
      employeedisplayname: {}
      employeeemail: {}
      employeemanageremail: {}
      escalation: {}
      eventaction: {}
      eventid: {}
      eventtype: {}
      expanseactivitystatus: {}
      expanseasset: {}
      expanseassetorganizationunit:
        complex:
          accessor: "0"
          root: Analysis of Asset Attribution.Answers
          transformers:
          - operator: FirstArrayElement
      expanseassetowner: {}
      expanseassignee: {}
      expansebusinessunits: {}
      expansecategory: {}
      expansecertificate: {}
      expansecreated: {}
      expansedomain: {}
      expanseinitialevidence: {}
      expanseip: {}
      expanseissueid: {}
      expanseissuetype: {}
      expanselatestevidence: {}
      expansemodified: {}
      expanseport: {}
      expansepriority: {}
      expanseprogressstatus: {}
      expanseprotocol: {}
      expanseprovider: {}
      expanseshadowit: {}
      expansetags: {}
      externaladdresses: {}
      filehash: {}
      filename: {}
      filepath: {}
      filesize: {}
      firstname: {}
      firstseen: {}
      givenname: {}
      helloworldid: {}
      helloworldstatus: {}
      helloworldtype: {}
      hostname: {}
      id: {}
      incomingmirrorerror: {}
      infectedhosts: {}
      internaladdresses: {}
      investigationstage: {}
      isolated: {}
      jobcode: {}
      jobfamily: {}
      jobfunction: {}
      labels: {}
      lastmodifiedby: {}
      lastmodifiedon: {}
      lastname: {}
      lastseen: {}
      leadership: {}
      location: {}
      locationregion: {}
      logsource: {}
      macaddress: {}
      maliciousbehavior: {}
      malwarefamily: {}
      malwarename: {}
      manageremailaddress: {}
      managername: {}
      md5: {}
      mobiledevicemodel: {}
      mobilephone: {}
      name: {}
      occurred: {}
      os: {}
      osversion: {}
      outgoingmirrorerror: {}
      owner: {}
      parentprocessid: {}
      personalemail: {}
      phase: {}
      phishingsubtype: {}
      phonenumber: {}
      pid: {}
      policydeleted: {}
      policydescription: {}
      policydetails: {}
      policyid: {}
      policyrecommendation: {}
      policyremediable: {}
      policyseverity: {}
      policytype: {}
      prismacloudid: {}
      prismacloudreason: {}
      prismacloudrules: {}
      prismacloudstatus: {}
      prismacloudtime: {}
      protocol: {}
      protocols: {}
      quarantined: {}
      rating: {}
      region: {}
      regionid: {}
      replacePlaybook: {}
      reporteremailaddress: {}
      resourceapiname: {}
      resourcecloudtype: {}
      resourceid: {}
      resourcename: {}
      resourcetype: {}
      riskrating: {}
      riskscore: {}
      roles: {}
      rrn: {}
      samaccountname: {}
      severity: {}
      sha256: {}
      shadowitaccountowneremail: {}
      shadowitaccountownername: {}
      shadowitcloudaccountid: {}
      shadowitcloudaccounttype: {}
      signature: {}
      skuname: {}
      skutier: {}
      sla: {}
      slaField: {}
      sourcehostname: {}
      sourceip: {}
      sourcenetwork: {}
      sourceport: {}
      sourceusername: {}
      src: {}
      srchostname: {}
      srcntdomain: {}
      srcos: {}
      srcuser: {}
      state: {}
      streetaddress: {}
      subcategory: {}
      subscriptionassignedby: {}
      subscriptioncreatedby: {}
      subscriptioncreatedon: {}
      subscriptiondescription: {}
      subscriptionid: {}
      subscriptionname: {}
      subscriptiontype: {}
      subscriptionupdatedby: {}
      subscriptionupdatedon: {}
      subtype: {}
      surname: {}
      systemdefault: {}
      systems: {}
      targetfirewallversion: {}
      tenantname: {}
      terminatedaction: {}
      threatactor: {}
      ticketcloseddate: {}
      ticketnumber: {}
      ticketopeneddate: {}
      title: {}
      triggeredsecurityprofile: {}
      type: {}
      uniqueports: {}
      urlsslverification: {}
      user: {}
      useraccountcontrol: {}
      username: {}
      vendorid: {}
      vendorproduct: {}
      vpcid: {}
      vulnerabilitycategory: {}
      workphone: {}
      xdralertcount: {}
      xdralerts: {}
      xdrassigneduseremail: {}
      xdrassigneduserprettyname: {}
      xdrdescription: {}
      xdrdetectiontime: {}
      xdrfileartifacts: {}
      xdrhighseverityalertcount: {}
      xdrhostcount: {}
      xdrincidentid: {}
      xdrlowseverityalertcount: {}
      xdrmediumseverityalertcount: {}
      xdrnetworkartifacts: {}
      xdrnotes: {}
      xdrresolvecomment: {}
      xdrstatus: {}
      xdrstatusv2: {}
      xdrurl: {}
      xdrusercount: {}
      zipcode: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 7672d99c-665d-48b5-853e-ab4ed11d22de
      iscommand: true
      name: Set Organization Unit
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 7672d99c-665d-48b5-853e-ab4ed11d22de
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1052.5,
          "y": 4070
        }
      }
  "50":
    continueonerror: true
    id: "50"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "48"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        complex:
          accessor: ou
          filters:
          - - left:
                iscontext: true
                value:
                  simple: lists.ExpanseOrganizationUnitsToTag.tag
              operator: inList
              right:
                iscontext: true
                value:
                  simple: incident.expansetags
          root: lists.ExpanseOrganizationUnitsToTag
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: No Suggestion
            operator: SetIfEmpty
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Prints text to war room (Markdown supported)
      id: 8e187ea1-71ed-4cae-8a60-32739a2729ac
      iscommand: false
      name: 'TODO Suggest Organization Unit '
      script: Print
      type: regular
      version: -1
    taskid: 8e187ea1-71ed-4cae-8a60-32739a2729ac
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 622.5,
          "y": 3020
        }
      }
  "51":
    id: "51"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "53"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bcdd7d70-f62f-4760-87ce-3202cec3f116
      iscommand: false
      name: Setup Vulnerability Assessment Tool To Scan The Asset
      type: regular
      version: -1
      description: Add this discovered asset to Vulnerability Management tools.
    taskid: bcdd7d70-f62f-4760-87ce-3202cec3f116
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -600,
          "y": 7880
        }
      }
  "52":
    id: "52"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "51"
      "Yes":
      - "53"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 52afb204-38f6-4cae-85e1-74c38c7ef38c
      iscommand: false
      name: |-
        Check if the system is scanned by Vulnerability Assessment systems.

        Is this protected?
      type: condition
      description: Check if this system is scanned by Vulnerability Management systems.
      version: -1
    taskid: 52afb204-38f6-4cae-85e1-74c38c7ef38c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -277.5,
          "y": 7680
        }
      }
  "53":
    id: "53"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "75"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a9052553-9595-4ccc-8f7e-ae7b67791fea
      iscommand: false
      name: Done Vulnerability Assessment
      type: title
      version: -1
      description: ''
    taskid: a9052553-9595-4ccc-8f7e-ae7b67791fea
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -357.5,
          "y": 9410
        }
      }
  "56":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              simple: incident.expanseassetorganizationunit
          operator: notContainsString
          right:
            value:
              simple: Unknown
      - - left:
            iscontext: true
            value:
              simple: incident.expanseassetorganizationunit
          operator: notContainsString
          right:
            value:
              simple: False Positive
      label: "yes"
    id: "56"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "83"
      "yes":
      - "58"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e2e59b31-0bc6-49af-8d45-dba22b1d9b5d
      iscommand: false
      name: Is Asset Organization Unit Known?
      type: condition
      version: -1
      description: Check the attributed Organization Unit.
    taskid: e2e59b31-0bc6-49af-8d45-dba22b1d9b5d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 582.5,
          "y": 7375
        }
      }
  "58":
    continueonerror: true
    id: "58"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "83"
    note: false
    quietmode: 0
    scriptarguments:
      additionalHeader: {}
      attachCIDs: {}
      attachIDs: {}
      attachNames: {}
      bcc: {}
      body:
        simple: XXX
      cc: {}
      htmlBody: {}
      raw_message: {}
      replyTo: {}
      subject:
        simple: New security issue on a public service owned by your team
      templateParams: {}
      to:
        complex:
          accessor: ExpanseOrganizationUnitsToOwner
          root: lists
          transformers:
          - args:
              field:
                iscontext: true
                value:
                  simple: incident.expanseassetorganizationunit
            operator: getField
          - operator: ParseJSON
          - args:
              field:
                value:
                  simple: email
            operator: getField
      transientFile: {}
      transientFileCID: {}
      transientFileContent: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Send an email
      id: 1318174e-1e9d-4c31-8411-758987e6b0b2
      iscommand: true
      name: Notify OU Owner
      script: '|||send-mail'
      type: regular
      version: -1
    taskid: 1318174e-1e9d-4c31-8411-758987e6b0b2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 582.5,
          "y": 7615
        }
      }
  "59":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: ShadowITCondition.value
                    operator: isTrue
                root: ShadowITCondition
          operator: isNotEmpty
      label: Possible
    id: "59"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "40"
      Possible:
      - "133"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ee9d4e40-eb81-4e91-85d6-3e31063e5c00
      iscommand: false
      name: Check for Possible Shadow IT?
      type: condition
      version: -1
      description: Check if the incident is a possible Shadow IT one.
    taskid: ee9d4e40-eb81-4e91-85d6-3e31063e5c00
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1287.5,
          "y": 2230
        }
      }
  "62":
    id: "62"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "154"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8cf5fe6e-ac93-4f74-82ac-8b196865d062
      iscommand: false
      name: Shadow IT
      type: title
      version: -1
      description: ''
    taskid: 8cf5fe6e-ac93-4f74-82ac-8b196865d062
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1287.5,
          "y": 1310
        }
      }
  "63":
    id: "63"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "50"
      - "68"
      - "69"
      - "70"
      - "108"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4536e1b5-b453-4346-8d46-9ce3cac6d871
      iscommand: false
      name: Organization Unit
      type: title
      version: -1
      description: ''
    taskid: 4536e1b5-b453-4346-8d46-9ce3cac6d871
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1247.5,
          "y": 2875
        }
      }
  "65":
    id: "65"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: IPRangeLowConfidenceTag
      stringify: {}
      value:
        complex:
          root: inputs.IPRangeLowConfidenceTagList
          transformers:
          - args:
              delimiter:
                value:
                  simple: ','
            operator: splitAndTrim
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: 4b14142b-39e7-4017-8d16-c92cd9547d7b
      iscommand: false
      name: Extract List of Low Confidence Discovery tags from PB Inputs
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 4b14142b-39e7-4017-8d16-c92cd9547d7b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1327.5,
          "y": -1130
        }
      }
  "66":
    evidencedata:
      customfields: {}
      description:
        simple: Potential PAN-OS Target Device Groups
    id: "66"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "16"
    note: true
    quietmode: 0
    scriptarguments:
      columns: {}
      data:
        complex:
          root: TargetFirewalls
      title:
        simple: Possible target Device Groups for Remediation
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Convert an array to a nice table display. Usually, from the context.
      id: 440c08c2-a462-4f71-8511-51758a75561e
      iscommand: false
      name: Print Target Device Group suggestions
      script: ToTable
      type: regular
      version: -1
    taskid: 440c08c2-a462-4f71-8511-51758a75561e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2320,
          "y": 7210
        }
      }
  "67":
    id: "67"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "170"
    note: false
    quietmode: 0
    scriptarguments:
      append: {}
      key:
        simple: PanOSDeviceGroups
      stringify: {}
      value:
        complex:
          accessor: "0"
          root: Choose Device Group.Answers
          transformers:
          - operator: LastArrayElement
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: e164a935-e581-4341-8ef4-b05902e75a49
      iscommand: false
      name: Set Target Device Groups based on user input
      script: Set
      type: regular
      version: -1
    taskid: e164a935-e581-4341-8ef4-b05902e75a49
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2210,
          "y": 8360
        }
      }
  "68":
    id: "68"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "48"
    note: false
    quietmode: 0
    scriptarguments:
      columns: {}
      data:
        complex:
          accessor: AttributionUser
          root: Expanse
          transformers:
          - args:
              applyIfEmpty:
                value:
                  simple: "true"
              defaultValue:
                value:
                  simple: '[]'
            operator: SetIfEmpty
      title:
        simple: List of Users who connected to the asset in the past 7 days
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Convert an array to a nice table display. Usually, from the context.
      id: 6626f11e-ebe7-4baa-8ccc-6a3d8d521e0f
      iscommand: false
      name: Print Target Users suggestions
      script: ToTable
      tags:
      - ExpanseSuggestion
      type: regular
      version: -1
    taskid: 6626f11e-ebe7-4baa-8ccc-6a3d8d521e0f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1052.5,
          "y": 3020
        }
      }
  "69":
    id: "69"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "48"
    note: false
    quietmode: 0
    scriptarguments:
      columns: {}
      data:
        complex:
          accessor: AttributionIP
          root: Expanse
          transformers:
          - args:
              applyIfEmpty:
                value:
                  simple: "true"
              defaultValue:
                value:
                  simple: '[]'
            operator: SetIfEmpty
      title:
        simple: List of Source IP that connected to the asset in the past 7 days
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Convert an array to a nice table display. Usually, from the context.
      id: 387ba234-2e59-408a-8eec-d8c95b9f0567
      iscommand: false
      name: Print Target IP suggestions
      script: ToTable
      tags:
      - ExpanseSuggestion
      type: regular
      version: -1
    taskid: 387ba234-2e59-408a-8eec-d8c95b9f0567
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1492.5,
          "y": 3020
        }
      }
  "70":
    id: "70"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "48"
    note: false
    quietmode: 0
    scriptarguments:
      columns: {}
      data:
        complex:
          accessor: AttributionDevice
          root: Expanse
          transformers:
          - args:
              applyIfEmpty:
                value:
                  simple: "true"
              defaultValue:
                value:
                  simple: '[]'
            operator: SetIfEmpty
      title:
        simple: List of Devices that permitted traffic to asset in the past 7 days
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Convert an array to a nice table display. Usually, from the context.
      id: 4f28fb04-e29d-4d4f-8a9c-99c8ff359b15
      iscommand: false
      name: Print Target Devices suggestions
      script: ToTable
      tags:
      - ExpanseSuggestion
      type: regular
      version: -1
    taskid: 4f28fb04-e29d-4d4f-8a9c-99c8ff359b15
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1912.5,
          "y": 3020
        }
      }
  "73":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expanseshadowit
                root: incident
          operator: isTrue
      label: "yes"
    id: "73"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "86"
      "Yes":
      - "74"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 761cc3ca-351f-434f-8e76-a85bc2872a95
      iscommand: false
      name: Is this shadow IT?
      type: condition
      version: -1
      description: Check if the incident is marked as Shadow IT.
    taskid: 761cc3ca-351f-434f-8e76-a85bc2872a95
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 3832.5,
          "y": 8145
        }
      }
  "74":
    id: "74"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "105"
    note: false
    quietmode: 0
    scriptarguments:
      accountid: {}
      accountname: {}
      agentid: {}
      app: {}
      assetid: {}
      assigneduser: {}
      assignmentgroup: {}
      attachmentcount: {}
      attachmentextension: {}
      attachmenthash: {}
      attachmentid: {}
      attachmentname: {}
      attachmentsize: {}
      attachmenttype: {}
      blockedaction: {}
      bugtraq: {}
      caller: {}
      city: {}
      cloudservice: {}
      commandline: {}
      costcenter: {}
      costcentercode: {}
      country: {}
      countryname: {}
      criticalassets: {}
      customFields: {}
      cve: {}
      cvss: {}
      dbotprediction: {}
      dbotpredictionprobability: {}
      dbottextsuggestionhighlighted: {}
      department: {}
      dest: {}
      desthostname: {}
      destinationhostname: {}
      destinationip: {}
      destinationnetwork: {}
      destinationport: {}
      destntdomain: {}
      destos: {}
      details: {}
      detectedexternalhosts: {}
      detectedexternalips: {}
      detectedinternalhosts: {}
      detectedinternalips: {}
      detectedusers: {}
      detectionendtime: {}
      detectionid: {}
      detectionupdatetime: {}
      detectionurl: {}
      deviceexternalip: {}
      devicehash: {}
      devicelocalip: {}
      devicemodel: {}
      devicename: {}
      displayname: {}
      duration: {}
      email: {}
      emailauthenticitycheck: {}
      emailbcc: {}
      emailbody: {}
      emailbodyformat: {}
      emailbodyhtml: {}
      emailcc: {}
      emailclassification: {}
      emailclientname: {}
      emailfrom: {}
      emailheaders: {}
      emailhtml: {}
      emailinreplyto: {}
      emailkeywords: {}
      emailmessageid: {}
      emailreceived: {}
      emailreplyto: {}
      emailreturnpath: {}
      emailsenderip: {}
      emailsize: {}
      emailsource: {}
      emailsubject: {}
      emailto: {}
      emailtocount: {}
      emailurlclicked: {}
      employeedisplayname: {}
      employeeemail: {}
      employeemanageremail: {}
      entryIDs: {}
      escalation: {}
      eventaction: {}
      eventid: {}
      eventtype: {}
      expanseactivitystatus: {}
      expanseasset: {}
      expanseassetorganizationunit: {}
      expanseassetowner: {}
      expanseassignee: {}
      expansebusinessunits: {}
      expansecategory: {}
      expansecertificate: {}
      expansecreated: {}
      expansedomain: {}
      expansegeolocation: {}
      expanseinitialevidence: {}
      expanseip: {}
      expanseissueid: {}
      expanseissuetype: {}
      expanselatestevidence: {}
      expanselatestevidencegeolocation: {}
      expansemlfeatures: {}
      expansemodified: {}
      expanseport: {}
      expansepriority: {}
      expanseprogressstatus: {}
      expanseprotocol: {}
      expanseprovider: {}
      expanseregion: {}
      expanseservice: {}
      expanseshadowit: {}
      expansetags: {}
      externaladdresses: {}
      filehash: {}
      filename: {}
      filepath: {}
      filesize: {}
      firstname: {}
      firstseen: {}
      givenname: {}
      helloworldid: {}
      helloworldstatus: {}
      helloworldtype: {}
      hostname: {}
      incomingmirrorerror: {}
      infectedhosts: {}
      internaladdresses: {}
      investigationstage: {}
      isolated: {}
      jobcode: {}
      jobfamily: {}
      jobfunction: {}
      labels: {}
      lastmodifiedby: {}
      lastmodifiedon: {}
      lastname: {}
      lastseen: {}
      leadership: {}
      location: {}
      locationregion: {}
      logsource: {}
      macaddress: {}
      maliciousbehavior: {}
      malwarefamily: {}
      malwarename: {}
      manageremailaddress: {}
      managername: {}
      md5: {}
      mobiledevicemodel: {}
      mobilephone: {}
      name:
        complex:
          accessor: expanseip
          root: incident
          transformers:
          - args:
              prefix:
                value:
                  simple: 'Shadow IT Detected by Expanse on IP: '
              suffix: {}
            operator: concat
      occurred: {}
      os: {}
      osversion: {}
      outgoingmirrorerror: {}
      owner: {}
      parentprocessid: {}
      personalemail: {}
      phase: {}
      phishingsubtype: {}
      phonenumber: {}
      pid: {}
      policydeleted: {}
      policydescription: {}
      policydetails: {}
      policyid: {}
      policyrecommendation: {}
      policyremediable: {}
      policyseverity: {}
      policytype: {}
      prismacloudid: {}
      prismacloudreason: {}
      prismacloudrules: {}
      prismacloudstatus: {}
      prismacloudtime: {}
      protocol: {}
      protocols: {}
      quarantined: {}
      rating: {}
      region: {}
      regionid: {}
      reporteremailaddress: {}
      resourceapiname: {}
      resourcecloudtype: {}
      resourceid: {}
      resourcename: {}
      resourcetype: {}
      riskrating: {}
      riskscore: {}
      roles: {}
      rrn: {}
      samaccountname: {}
      severity:
        complex:
          accessor: severity
          root: incident
      sha256: {}
      shadowitaccountowneremail: {}
      shadowitaccountownername: {}
      shadowitbilledtocorp: {}
      shadowitcertificate:
        complex:
          accessor: expansecertificate
          root: incident
      shadowitcloudaccountid: {}
      shadowitcloudaccounttype: {}
      shadowitfqdn:
        complex:
          accessor: expansedomain
          root: incident
      shadowitip:
        complex:
          accessor: expanseip
          root: incident
      shadowitorganizationalunit:
        complex:
          accessor: expanseassetorganizationunit
          root: incident
      shadowitoucontactemail:
        complex:
          accessor: ExpanseOrganizationUnitsToOwner
          root: lists
          transformers:
          - args:
              field:
                iscontext: true
                value:
                  simple: incident.expanseassetorganizationunit
            operator: getField
          - operator: ParseJSON
          - args:
              field:
                value:
                  simple: email
            operator: getField
      shadowitoucontactname:
        complex:
          accessor: ExpanseOrganizationUnitsToOwner
          root: lists
          transformers:
          - args:
              field:
                iscontext: true
                value:
                  simple: incident.expanseassetorganizationunit
            operator: getField
          - operator: ParseJSON
          - args:
              field:
                value:
                  simple: name
            operator: getField
      shadowitport:
        complex:
          accessor: expanseport
          root: incident
      shadowitprovider:
        complex:
          accessor: expanseprovider
          root: incident
      shadowitregion: {}
      shadowitrisk: {}
      shadowitsactionedservice: {}
      shadowitsensitivedata: {}
      shadowitservice: {}
      shadowitservicepurpose: {}
      shadowitsource:
        simple: Expanse
      shadowitusersuggestions:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: Expanse.AttributionUser
              operator: isNotEmpty
          root: Expanse.AttributionUser
          transformers:
          - args:
              expression:
                value:
                  simple: '{name: username, email: mail, notes: join('' '', [''Found
                    '', to_string(sightings), '' log entries''])}'
            operator: jmespath
      shadowusersuggestions: {}
      signature: {}
      skuname: {}
      skutier: {}
      sla: {}
      slaField: {}
      sourcehostname: {}
      sourceip: {}
      sourcenetwork: {}
      sourceport: {}
      sourceusername: {}
      src: {}
      srchostname: {}
      srcntdomain: {}
      srcos: {}
      srcuser: {}
      state: {}
      streetaddress: {}
      subcategory: {}
      subscriptionassignedby: {}
      subscriptioncreatedby: {}
      subscriptioncreatedon: {}
      subscriptiondescription: {}
      subscriptionid: {}
      subscriptionname: {}
      subscriptiontype: {}
      subscriptionupdatedby: {}
      subscriptionupdatedon: {}
      subtype: {}
      surname: {}
      systemdefault: {}
      systems: {}
      targetfirewallversion: {}
      tenantname: {}
      terminatedaction: {}
      threatactor: {}
      ticketcloseddate: {}
      ticketnumber: {}
      ticketopeneddate: {}
      title: {}
      triggeredsecurityprofile: {}
      type:
        simple: Shadow IT
      uniqueports: {}
      urlsslverification: {}
      user: {}
      useraccountcontrol: {}
      username: {}
      vendorid: {}
      vendorproduct: {}
      vpcid: {}
      vulnerabilitycategory: {}
      workphone: {}
      xdralertcount: {}
      xdralerts: {}
      xdrassigneduseremail: {}
      xdrassigneduserprettyname: {}
      xdrdescription: {}
      xdrdetectiontime: {}
      xdrfileartifacts: {}
      xdrhighseverityalertcount: {}
      xdrhostcount: {}
      xdrincidentid: {}
      xdrlowseverityalertcount: {}
      xdrmediumseverityalertcount: {}
      xdrnetworkartifacts: {}
      xdrnotes: {}
      xdrresolvecomment: {}
      xdrstatus: {}
      xdrstatusv2: {}
      xdrurl: {}
      xdrusercount: {}
      zipcode: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.create.inc
      id: ba50096d-38a2-4924-8a3b-420d7f75c696
      iscommand: true
      name: Create Shadow IT Incident
      script: Builtin|||createNewIncident
      type: regular
      version: -1
    taskid: ba50096d-38a2-4924-8a3b-420d7f75c696
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 4130,
          "y": 8325
        }
      }
  "75":
    id: "75"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "76"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f6fb92c6-f797-44af-8e79-55c91a8244d5
      iscommand: false
      name: Close Investigation
      type: title
      version: -1
      description: ''
    taskid: f6fb92c6-f797-44af-8e79-55c91a8244d5
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1277.5,
          "y": 10135
        }
      }
  "76":
    id: "76"
    ignoreworker: false
    nexttasks:
      ✅ Yes:
      - "77"
      ❌ No:
      - "78"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a6416f01-09ef-47fc-893b-4c1ab7d87930
      iscommand: false
      name: Close Investigation?
      type: condition
      version: -1
      description: Ask the user whether to close the investigation.
    taskid: a6416f01-09ef-47fc-893b-4c1ab7d87930
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1277.5,
          "y": 10280
        }
      }
  "77":
    id: "77"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "78"
    note: false
    quietmode: 0
    scriptarguments:
      assetid: {}
      closeNotes: {}
      closeReason: {}
      emailclassification: {}
      id: {}
      incomingmirrorerror: {}
      outgoingmirrorerror: {}
      phishingsubtype: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 1a1cc7b2-5b74-4e12-8233-d6b6c88e4f4a
      iscommand: true
      name: Close Investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 1a1cc7b2-5b74-4e12-8233-d6b6c88e4f4a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1550,
          "y": 10510
        }
      }
  "78":
    id: "78"
    ignoreworker: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3f0f0af0-3d1b-4e2e-8469-e3d029cbf695
      iscommand: false
      name: All done
      type: title
      version: -1
      description: ''
    taskid: 3f0f0af0-3d1b-4e2e-8469-e3d029cbf695
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1277.5,
          "y": 10750
        }
      }
  "81":
    id: "81"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "52"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 41421085-f82c-429f-86c2-6fdfb5016e56
      iscommand: false
      name: Vulnerability Assessment
      type: title
      version: -1
      description: ''
    taskid: 41421085-f82c-429f-86c2-6fdfb5016e56
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -277.5,
          "y": 7520
        }
      }
  "82":
    id: "82"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "56"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a29e138b-03e7-499c-8b1c-9031adf12add
      iscommand: false
      name: Notification Flow
      type: title
      version: -1
      description: ''
    taskid: a29e138b-03e7-499c-8b1c-9031adf12add
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 582.5,
          "y": 7180
        }
      }
  "83":
    id: "83"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "75"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 00dfaa6a-3e80-49a1-8097-ee687b9a343b
      iscommand: false
      name: Done Notification
      type: title
      version: -1
      description: ''
    taskid: 00dfaa6a-3e80-49a1-8097-ee687b9a343b
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 552.5,
          "y": 9410
        }
      }
  "84":
    id: "84"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9eeadd67-990b-4e38-8ec2-8c7907c3e1c7
      iscommand: false
      name: Network Remediation
      type: title
      version: -1
      description: ''
    taskid: 9eeadd67-990b-4e38-8ec2-8c7907c3e1c7
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1102.5,
          "y": 5700
        }
      }
  "85":
    id: "85"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "73"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c3a9e690-0755-4991-87f1-f0d217517709
      iscommand: false
      name: Shadow IT
      type: title
      version: -1
      description: ''
    taskid: c3a9e690-0755-4991-87f1-f0d217517709
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 3832.5,
          "y": 7985
        }
      }
  "86":
    id: "86"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "75"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cedc07cd-64b5-4f6b-876b-eb8adfdd349f
      iscommand: false
      name: Done Shadow IT
      type: title
      version: -1
      description: ''
    taskid: cedc07cd-64b5-4f6b-876b-eb8adfdd349f
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 3832.5,
          "y": 9860
        }
      }
  "88":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Analysis of Asset Attribution.Answers.0
          operator: containsString
          right:
            value:
              simple: Add New
      label: "yes"
    id: "88"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "49"
      "yes":
      - "89"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3752d545-238e-4d2b-8874-2c430c22159f
      iscommand: false
      name: Should Add New OU?
      type: condition
      version: -1
      description: Determine if a new OU has to be added.
    taskid: 3752d545-238e-4d2b-8874-2c430c22159f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1052.5,
          "y": 3370
        }
      }
  "89":
    form:
      description: Specify thew Organization Unit name, name and email of the assets
        owner.
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Organization Unit Name
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: shortText
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "1"
        label: ""
        labelarg:
          simple: Expanse Tag
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: The tag to be used on Expanse to tag assets belonging to this Organization
          Unit
        type: shortText
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "2"
        label: ""
        labelarg:
          simple: Organization Unit Asset Owner Name
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: shortText
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "3"
        label: ""
        labelarg:
          simple: Organization Unit Asset Owner Email
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: shortText
      sender: Your SOC team
      title: Add New Organization Unit
      totalanswers: 0
    id: "89"
    ignoreworker: false
    message:
      bcc:
      body:
        simple: Add New OU
      cc:
      format: ""
      methods: []
      subject:
      timings:
        completeafterreplies: 1
        retriescount: 2
        retriesinterval: 360
      to:
    nexttasks:
      '#none#':
      - "90"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 980d214e-ed07-4dbc-82a0-455678d9bb9a
      iscommand: false
      name: Add New OU
      type: collection
      version: -1
      description: Collect new OU details from the user.
    taskid: 980d214e-ed07-4dbc-82a0-455678d9bb9a
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 1482.5,
          "y": 3545
        }
      }
  "90":
    id: "90"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "94"
    note: false
    quietmode: 0
    scriptarguments:
      allowDups: {}
      append:
        simple: "true"
      keyName:
        complex:
          accessor: "0"
          root: Add New Organization Unit.Answers
      listName:
        simple: ExpanseOrganizationUnitsToOwner
      value:
        complex:
          accessor: "2"
          root: Add New Organization Unit.Answers
          transformers:
          - args:
              prefix:
                value:
                  simple: '{"name": "'
              suffix:
                value:
                  simple: '", "email": "'
            operator: concat
          - args:
              prefix: {}
              suffix:
                iscontext: true
                value:
                  simple: Add New Organization Unit.Answers.3
            operator: concat
          - args:
              prefix: {}
              suffix:
                value:
                  simple: '"}'
            operator: concat
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Adds/Replaces a key in key/value store backed by an XSOAR list.
      id: 9bbd44d7-61ea-463e-879f-7c964239c486
      iscommand: false
      name: Save New Organization Unit to List
      script: AddKeyToList
      type: regular
      version: -1
    taskid: 9bbd44d7-61ea-463e-879f-7c964239c486
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1482.5,
          "y": 3720
        }
      }
  "91":
    id: "91"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "93"
    note: false
    quietmode: 0
    scriptarguments:
      accountid: {}
      accountname: {}
      addLabels: {}
      agentid: {}
      app: {}
      appendMultiSelect: {}
      assetid: {}
      assigneduser: {}
      assignmentgroup: {}
      attachmentcount: {}
      attachmentextension: {}
      attachmenthash: {}
      attachmentid: {}
      attachmentname: {}
      attachmentsize: {}
      attachmenttype: {}
      blockedaction: {}
      bugtraq: {}
      caller: {}
      city: {}
      closeNotes: {}
      closeReason: {}
      cloudservice: {}
      commandline: {}
      costcenter: {}
      costcentercode: {}
      country: {}
      countryname: {}
      criticalassets: {}
      customFields: {}
      cve: {}
      cvss: {}
      dbotMirrorDirection: {}
      dbotMirrorId: {}
      dbotMirrorInstance: {}
      dbotMirrorTags: {}
      dbotprediction: {}
      dbotpredictionprobability: {}
      dbottextsuggestionhighlighted: {}
      deleteEmptyField: {}
      department: {}
      dest: {}
      desthostname: {}
      destinationhostname: {}
      destinationip: {}
      destinationnetwork: {}
      destinationport: {}
      destntdomain: {}
      destos: {}
      details: {}
      detectedexternalhosts: {}
      detectedexternalips: {}
      detectedinternalhosts: {}
      detectedinternalips: {}
      detectedusers: {}
      detectionendtime: {}
      detectionid: {}
      detectionupdatetime: {}
      detectionurl: {}
      deviceexternalip: {}
      devicehash: {}
      devicelocalip: {}
      devicemodel: {}
      devicename: {}
      displayname: {}
      duration: {}
      email: {}
      emailauthenticitycheck: {}
      emailbcc: {}
      emailbody: {}
      emailbodyformat: {}
      emailbodyhtml: {}
      emailcc: {}
      emailclassification: {}
      emailclientname: {}
      emailfrom: {}
      emailheaders: {}
      emailhtml: {}
      emailinreplyto: {}
      emailkeywords: {}
      emailmessageid: {}
      emailreceived: {}
      emailreplyto: {}
      emailreturnpath: {}
      emailsenderip: {}
      emailsize: {}
      emailsource: {}
      emailsubject: {}
      emailto: {}
      emailtocount: {}
      emailurlclicked: {}
      employeedisplayname: {}
      employeeemail: {}
      employeemanageremail: {}
      escalation: {}
      eventaction: {}
      eventid: {}
      eventtype: {}
      expanseactivitystatus: {}
      expanseasset: {}
      expanseassetorganizationunit:
        complex:
          accessor: "0"
          root: Add New Organization Unit.Answers
          transformers:
          - operator: FirstArrayElement
      expanseassetowner: {}
      expanseassignee: {}
      expansebusinessunits: {}
      expansecategory: {}
      expansecertificate: {}
      expansecreated: {}
      expansedomain: {}
      expanseinitialevidence: {}
      expanseip: {}
      expanseissueid: {}
      expanseissuetype: {}
      expanselatestevidence: {}
      expansemodified: {}
      expanseport: {}
      expansepriority: {}
      expanseprogressstatus: {}
      expanseprotocol: {}
      expanseprovider: {}
      expanseshadowit: {}
      expansetags: {}
      externaladdresses: {}
      filehash: {}
      filename: {}
      filepath: {}
      filesize: {}
      firstname: {}
      firstseen: {}
      givenname: {}
      helloworldid: {}
      helloworldstatus: {}
      helloworldtype: {}
      hostname: {}
      id: {}
      incomingmirrorerror: {}
      infectedhosts: {}
      internaladdresses: {}
      investigationstage: {}
      isolated: {}
      jobcode: {}
      jobfamily: {}
      jobfunction: {}
      labels: {}
      lastmodifiedby: {}
      lastmodifiedon: {}
      lastname: {}
      lastseen: {}
      leadership: {}
      location: {}
      locationregion: {}
      logsource: {}
      macaddress: {}
      maliciousbehavior: {}
      malwarefamily: {}
      malwarename: {}
      manageremailaddress: {}
      managername: {}
      md5: {}
      mobiledevicemodel: {}
      mobilephone: {}
      name: {}
      occurred: {}
      os: {}
      osversion: {}
      outgoingmirrorerror: {}
      owner: {}
      parentprocessid: {}
      personalemail: {}
      phase: {}
      phishingsubtype: {}
      phonenumber: {}
      pid: {}
      policydeleted: {}
      policydescription: {}
      policydetails: {}
      policyid: {}
      policyrecommendation: {}
      policyremediable: {}
      policyseverity: {}
      policytype: {}
      prismacloudid: {}
      prismacloudreason: {}
      prismacloudrules: {}
      prismacloudstatus: {}
      prismacloudtime: {}
      protocol: {}
      protocols: {}
      quarantined: {}
      rating: {}
      region: {}
      regionid: {}
      replacePlaybook: {}
      reporteremailaddress: {}
      resourceapiname: {}
      resourcecloudtype: {}
      resourceid: {}
      resourcename: {}
      resourcetype: {}
      riskrating: {}
      riskscore: {}
      roles: {}
      rrn: {}
      samaccountname: {}
      severity: {}
      sha256: {}
      signature: {}
      skuname: {}
      skutier: {}
      sla: {}
      slaField: {}
      sourcehostname: {}
      sourceip: {}
      sourcenetwork: {}
      sourceport: {}
      sourceusername: {}
      src: {}
      srchostname: {}
      srcntdomain: {}
      srcos: {}
      srcuser: {}
      state: {}
      streetaddress: {}
      subcategory: {}
      subscriptionassignedby: {}
      subscriptioncreatedby: {}
      subscriptioncreatedon: {}
      subscriptiondescription: {}
      subscriptionid: {}
      subscriptionname: {}
      subscriptiontype: {}
      subscriptionupdatedby: {}
      subscriptionupdatedon: {}
      subtype: {}
      surname: {}
      systemdefault: {}
      systems: {}
      targetfirewallversion: {}
      tenantname: {}
      terminatedaction: {}
      threatactor: {}
      ticketcloseddate: {}
      ticketnumber: {}
      ticketopeneddate: {}
      title: {}
      triggeredsecurityprofile: {}
      type: {}
      uniqueports: {}
      urlsslverification: {}
      user: {}
      useraccountcontrol: {}
      username: {}
      vendorid: {}
      vendorproduct: {}
      vpcid: {}
      vulnerabilitycategory: {}
      workphone: {}
      xdralertcount: {}
      xdralerts: {}
      xdrassigneduseremail: {}
      xdrassigneduserprettyname: {}
      xdrdescription: {}
      xdrdetectiontime: {}
      xdrfileartifacts: {}
      xdrhighseverityalertcount: {}
      xdrhostcount: {}
      xdrincidentid: {}
      xdrlowseverityalertcount: {}
      xdrmediumseverityalertcount: {}
      xdrnetworkartifacts: {}
      xdrnotes: {}
      xdrresolvecomment: {}
      xdrstatus: {}
      xdrstatusv2: {}
      xdrurl: {}
      xdrusercount: {}
      zipcode: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: ef5f7179-b689-4ae9-8e9f-10cdb6f80a89
      iscommand: true
      name: Set Organization Unit
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: ef5f7179-b689-4ae9-8e9f-10cdb6f80a89
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1482.5,
          "y": 4070
        }
      }
  "93":
    id: "93"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "85"
      - "165"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 82c08c4e-3e8f-4a16-8370-77523eb45b26
      iscommand: false
      name: Done Organization Unit
      type: title
      version: -1
      description: ''
    taskid: 82c08c4e-3e8f-4a16-8370-77523eb45b26
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1247.5,
          "y": 4245
        }
      }
  "94":
    id: "94"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "91"
    note: false
    quietmode: 0
    scriptarguments:
      allowDups: {}
      append:
        simple: "false"
      keyName:
        complex:
          accessor: "0"
          root: Add New Organization Unit.Answers
      listName:
        simple: ExpanseOrganizationUnitsToTag
      value:
        complex:
          accessor: "1"
          root: Add New Organization Unit.Answers
          transformers:
          - args:
              prefix:
                value:
                  simple: ou-
              suffix: {}
            operator: concat
          - args:
              prefix:
                iscontext: true
                value:
                  simple: inputs.TagPrefix
              suffix: {}
            operator: concat
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Adds/Replaces a key in key/value store backed by an XSOAR list.
      id: 29ca9aaa-8d54-4c84-8541-082c26853558
      iscommand: false
      name: Save New Organization Tag to List
      script: AddKeyToList
      type: regular
      version: -1
    taskid: 29ca9aaa-8d54-4c84-8541-082c26853558
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1482.5,
          "y": 3895
        }
      }
  "95":
    id: "95"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "99"
    note: false
    quietmode: 0
    scriptarguments:
      description:
        simple: Created by XSOAR for Organization Unit tagging
      name:
        complex:
          root: AssetTag
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Create a new tag in Expanse.
      id: a76d40b3-8c5b-4a3c-81e9-567f24dc234b
      iscommand: true
      name: Create Tag in Expanse (if it doesn't exist already)
      script: '|||expanse-create-tag'
      type: regular
      version: -1
    taskid: a76d40b3-8c5b-4a3c-81e9-567f24dc234b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -90,
          "y": 5100
        }
      }
  "96":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: ExpanseOrganizationUnitsToTag
                root: lists
                transformers:
                - args:
                    field:
                      iscontext: true
                      value:
                        simple: incident.expanseassetorganizationunit
                  operator: getField
                - args:
                    applyIfEmpty: {}
                    defaultValue:
                      value:
                        simple: '**NoTag**'
                  operator: SetIfEmpty
          operator: isNotEqualString
          right:
            value:
              simple: '**NoTag**'
      label: known-ou
    - condition:
      - - left:
            iscontext: true
            value:
              simple: incident.expanseassetorganizationunit
          operator: containsString
          right:
            value:
              simple: False Positive
      label: false-positive
    id: "96"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "166"
      false-positive:
      - "104"
      known-ou:
      - "103"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a573e752-0707-45e3-8cdb-7fece0dafff4
      iscommand: false
      name: Do We Have Tag To Use?
      type: condition
      version: -1
      description: Branch depending on the OU.
    taskid: a573e752-0707-45e3-8cdb-7fece0dafff4
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 290,
          "y": 4700
        }
      }
  "99":
    continueonerror: true
    id: "99"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "166"
    note: false
    quietmode: 0
    scriptarguments:
      asset_id:
        complex:
          accessor: id
          root: incident.expanseasset
      asset_type:
        complex:
          accessor: assettype
          root: incident.expanseasset
      tagnames:
        complex:
          root: AssetTag
      tags: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Assign tags to Asset.
      id: 1de4b346-29d6-49c8-8c40-8d4d6b0296aa
      iscommand: true
      name: Tag Assets on Expanse with AssetTag
      script: '|||expanse-assign-tags-to-asset'
      type: regular
      version: -1


    taskid: 1de4b346-29d6-49c8-8c40-8d4d6b0296aa
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -90,
          "y": 5255
        }
      }
  "103":
    id: "103"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "95"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: AssetTag
      stringify: {}
      value:
        complex:
          accessor: ExpanseOrganizationUnitsToTag
          root: lists
          transformers:
          - args:
              field:
                iscontext: true
                value:
                  simple: incident.expanseassetorganizationunit
            operator: getField
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 3cda2c56-4c03-423c-8600-c60755b304dc
      iscommand: false
      name: Set AssetTag with Known OU Tag
      script: Set
      type: regular
      version: -1
    taskid: 3cda2c56-4c03-423c-8600-c60755b304dc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 160,
          "y": 4920
        }
      }
  "104":
    id: "104"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "95"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: AssetTag
      stringify: {}
      value:
        simple: ${inputs.FalsePositiveTag}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 07ca8506-f9d5-4561-82a3-da00fee6c51f
      iscommand: false
      name: Set AssetTag with False Positive Tag from Inputs
      script: Set
      type: regular
      version: -1
    taskid: 07ca8506-f9d5-4561-82a3-da00fee6c51f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -277.5,
          "y": 4920
        }
      }
  "105":
    id: "105"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "106"
    note: false
    quietmode: 0
    scriptarguments:
      action:
        simple: link
      incidentId: {}
      linkedIncidentIDs:
        complex:
          root: CreatedIncidentID
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.linkIncidents
      id: aed90f6f-f291-4518-89e3-fd0961de6efe
      iscommand: true
      name: Link Incidents
      script: Builtin|||linkIncidents
      type: regular
      version: -1
    taskid: aed90f6f-f291-4518-89e3-fd0961de6efe
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 4130,
          "y": 8500
        }
      }
  "106":
    id: "106"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "86"
    note: false
    quietmode: 0
    scriptarguments:
      tags:
        simple: ExpanseSuggestion
      target_incident:
        complex:
          root: CreatedIncidentID
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Copy notes from current incident to a remote incident
      id: 29ec4c92-a837-46ed-833e-6bf212a37c51
      iscommand: false
      name: Copy Suggestion Notes to Created Incident
      script: defa3794-aa97-4659-80a3-fb8779e70b70
      type: regular
      version: -1
    taskid: 29ec4c92-a837-46ed-833e-6bf212a37c51
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 4130,
          "y": 8680
        }
      }
  "108":
    id: "108"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "48"
    note: false
    quietmode: 0
    scriptarguments:
      columns: {}
      data:
        complex:
          accessor: Attribution
          root: PrismaCloud
          transformers:
          - args:
              applyIfEmpty:
                value:
                  simple: "true"
              defaultValue:
                value:
                  simple: '[]'
            operator: SetIfEmpty
      title:
        simple: List of related assets discovered in Prisma Cloud
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Convert an array to a nice table display. Usually, from the context.
      id: 127914a4-cec8-443c-809a-42750550e97a
      iscommand: false
      name: Print Prisma Cloud suggestions
      script: ToTable
      tags:
      - ExpanseSuggestion
      type: regular
      version: -1
    taskid: 127914a4-cec8-443c-809a-42750550e97a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2340,
          "y": 3020
        }
      }
  "109":
    id: "109"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "110"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 37dbf3c9-e00b-4171-8cf7-f6b6245d5b69
      iscommand: false
      name: Prisma Cloud Alert Detection
      type: title
      version: -1
      description: ''
    taskid: 37dbf3c9-e00b-4171-8cf7-f6b6245d5b69
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -1190,
          "y": 5720
        }
      }
  "110":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Attribution
                root: PrismaCloud
          operator: isNotEmpty
      label: "yes"
    id: "110"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "111"
      "yes":
      - "172"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b2a7f94d-5abb-429e-859d-e5521a09b66d
      iscommand: false
      name: Are assets in Prisma Cloud found?
      type: condition
      version: -1
      description: Check whether assets are found in Prisma Cloud
    taskid: b2a7f94d-5abb-429e-859d-e5521a09b66d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1190,
          "y": 5990
        }
      }
  "111":
    id: "111"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "75"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ab24e389-a3e9-4bfc-8019-67767ecdc44c
      iscommand: false
      name: Done Prisma Cloud Alert Detection
      type: title
      version: -1
      description: ''
    taskid: ab24e389-a3e9-4bfc-8019-67767ecdc44c
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -1190,
          "y": 9415
        }
      }
  "116":
    id: "116"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "170"
    note: false
    quietmode: 0
    scriptarguments:
      description:
        simple: Created by XSOAR for Device Group tagging
      name:
        complex:
          root: NewDGTagName
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Create a new tag in Expanse.
      id: 76dca3f2-7ea3-4673-8182-19d3c576a8a8
      iscommand: true
      name: Create DG Tag in Expanse (if it doesn't already exist)
      script: '|||expanse-create-tag'
      type: regular
      version: -1
    taskid: 76dca3f2-7ea3-4673-8182-19d3c576a8a8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2530,
          "y": 8530
        }
      }
  "117":
    continueonerror: true
    id: "117"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "121"
    note: false
    quietmode: 0
    scriptarguments:
      asset_id:
        complex:
          accessor: id
          root: incident.expanseasset
      asset_type:
        complex:
          accessor: assettype
          root: incident.expanseasset
      tagnames:
        complex:
          root: NewDGTagName
      tags: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Assign tags to Asset.
      id: a6bd6494-1088-4dea-8715-7d69a923a1c0
      iscommand: true
      name: Tag Assets on Expanse
      script: '|||expanse-assign-tags-to-asset'
      type: regular
      version: -1
    taskid: a6bd6494-1088-4dea-8715-7d69a923a1c0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2150,
          "y": 8830
        }
      }
  "118":
    id: "118"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "169"
    note: false
    quietmode: 0
    scriptarguments:
      allowDups: {}
      append:
        simple: "false"
      keyName:
        complex:
          root: NewDGTagName
      listName:
        complex:
          root: inputs.FirewallTagListName
      value:
        complex:
          accessor: "0"
          root: Choose Device Group Name and Tag.Answers
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Adds/Replaces a key in key/value store backed by an XSOAR list.
      id: 9844977f-7ca5-4cbc-8261-3879ec7f18d0
      iscommand: false
      name: Save DG Tag to List
      script: AddKeyToList
      type: regular
      version: -1
    taskid: 9844977f-7ca5-4cbc-8261-3879ec7f18d0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2742.5,
          "y": 8215
        }
      }
  "119":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Choose Device Group.Answers
          operator: containsString
          right:
            value:
              simple: Add New
      label: ADD-NEW
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Choose Device Group.Answers
          operator: containsString
          right:
            value:
              simple: Manual Configuration
      label: MANUAL
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Choose Device Group.Answers
          operator: containsString
          right:
            value:
              simple: Firewall Only (No Panorama)
      label: NO-PANORAMA
    id: "119"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "67"
      ADD-NEW:
      - "18"
      MANUAL:
      - "14"
      NO-PANORAMA:
      - "10"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3ee5d1cc-7086-4dbb-8a44-96d36046cf62
      iscommand: false
      name: Determine Target
      type: condition
      version: -1
      description: Determine the target Device Group
    taskid: 3ee5d1cc-7086-4dbb-8a44-96d36046cf62
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2045,
          "y": 7550
        }
      }
  "120":
    form:
      description: Insert Device Group name to enforce this policy, and the corresponding
        tag to attach to the asset
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Insert Device Group Name
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: The Device Group must be managed by Panorama
        type: shortText
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "1"
        label: ""
        labelarg:
          simple: Insert Expanse Tag (without prefix)
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: The tag name will be added to the Expanse assets (prefix will be
          added automatically)
        type: shortText
      sender: ""
      title: Choose Device Group Name and Tag
      totalanswers: 0
    id: "120"
    ignoreworker: false
    message:
      bcc:
      body:
        simple: Select Device Group Name and Tag
      cc:
      format: ""
      methods: []
      subject:
        simple: Select Device Group Name and Tag
      timings:
        completeafterreplies: 1
        retriescount: 2
        retriesinterval: 360
      to:
        simple: Analyst
    nexttasks:
      '#none#':
      - "137"
      - "140"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 171e23a1-3724-456a-8af6-9605ae5c02b4
      iscommand: false
      name: Insert Device Group name and tag
      type: collection
      version: -1
      description: Collect Device Group information from user.
    taskid: 171e23a1-3724-456a-8af6-9605ae5c02b4
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 2742.5,
          "y": 7905
        }
      }
  "121":
    id: "121"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 103ef1d1-f68b-4d62-8f99-530dcc1e1e85
      iscommand: false
      name: Done DG Tagging
      type: title
      version: -1
      description: ''
    taskid: 103ef1d1-f68b-4d62-8f99-530dcc1e1e85
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2742.5,
          "y": 8860
        }
      }
  "122":
    id: "122"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "123"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: ExpanseAllAssetTags
      stringify: {}
      value:
        complex:
          accessor: tags
          root: incident.expanseasset
          transformers:
          - args:
              delimiter:
                value:
                  simple: \n
            operator: split
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: b84bb0cd-084a-41b3-85d1-e033abf14fc4
      iscommand: false
      name: Extract All Asset Tags from Expanse
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: b84bb0cd-084a-41b3-85d1-e033abf14fc4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 460,
          "y": -1305
        }
      }
  "123":
    id: "123"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: ExpanseXSOARAssetTags
      stringify: {}
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ExpanseAllAssetTags
              operator: startWith
              right:
                iscontext: true
                value:
                  simple: inputs.TagPrefix
          root: ExpanseAllAssetTags
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: 7ff9610d-922f-4f9d-8d0b-67b55eeaee4d
      iscommand: false
      name: Extract only XSOAR-related Asset Tags
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 7ff9610d-922f-4f9d-8d0b-67b55eeaee4d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 460,
          "y": -1130
        }
      }
  "124":
    id: "124"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "125"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: XSOARTagDGPrefix
      stringify: {}
      value:
        complex:
          root: inputs.TagPrefix
          transformers:
          - args:
              prefix: {}
              suffix:
                value:
                  simple: dg-
            operator: concat
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 7c8cedf7-1bf1-4eec-839b-ea495cae7222
      iscommand: false
      name: Set Device Group Tag Prefix
      script: Set
      type: regular
      version: -1
    taskid: 7c8cedf7-1bf1-4eec-839b-ea495cae7222
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1950,
          "y": 6220
        }
      }
  "125":
    id: "125"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: ExpanseDeviceGroupAssetTags
      stringify: {}
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ExpanseXSOARAssetTags
              operator: startWith
              right:
                iscontext: true
                value:
                  simple: XSOARTagDGPrefix
          root: ExpanseXSOARAssetTags
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: bd3a281a-71bb-4ce5-80c6-848ada4fc9ce
      iscommand: false
      name: Find Device Group Tags
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: bd3a281a-71bb-4ce5-80c6-848ada4fc9ce
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1950,
          "y": 6380
        }
      }
  "133":
    id: "133"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "158"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: SuggestedShadowITAnswer
      stringify: {}
      value:
        simple: "No"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Set a value in context under the key you entered.
      id: 56933ed7-6e98-46d7-8990-216f21fe483a
      iscommand: false
      name: Suggest No Shadow IT
      script: Set
      type: regular
      version: -1
    taskid: 56933ed7-6e98-46d7-8990-216f21fe483a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1667.5,
          "y": 2465
        }
      }
  "135":
    id: "135"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "93"
    note: false
    quietmode: 0
    scriptarguments:
      accountid: {}
      accountname: {}
      addLabels: {}
      agentid: {}
      app: {}
      appendMultiSelect: {}
      assetid: {}
      assigneduser: {}
      assignmentgroup: {}
      attachmentcount: {}
      attachmentextension: {}
      attachmenthash: {}
      attachmentid: {}
      attachmentname: {}
      attachmentsize: {}
      attachmenttype: {}
      blockedaction: {}
      bugtraq: {}
      caller: {}
      city: {}
      closeNotes: {}
      closeReason: {}
      cloudservice: {}
      commandline: {}
      costcenter: {}
      costcentercode: {}
      country: {}
      countryname: {}
      criticalassets: {}
      customFields: {}
      cve: {}
      cvss: {}
      dbotMirrorDirection: {}
      dbotMirrorId: {}
      dbotMirrorInstance: {}
      dbotMirrorTags: {}
      dbotprediction: {}
      dbotpredictionprobability: {}
      dbottextsuggestionhighlighted: {}
      deleteEmptyField: {}
      department: {}
      dest: {}
      desthostname: {}
      destinationhostname: {}
      destinationip: {}
      destinationnetwork: {}
      destinationport: {}
      destntdomain: {}
      destos: {}
      details: {}
      detectedexternalhosts: {}
      detectedexternalips: {}
      detectedinternalhosts: {}
      detectedinternalips: {}
      detectedusers: {}
      detectionendtime: {}
      detectionid: {}
      detectionupdatetime: {}
      detectionurl: {}
      deviceexternalip: {}
      devicehash: {}
      devicelocalip: {}
      devicemodel: {}
      devicename: {}
      displayname: {}
      duration: {}
      email: {}
      emailauthenticitycheck: {}
      emailbcc: {}
      emailbody: {}
      emailbodyformat: {}
      emailbodyhtml: {}
      emailcc: {}
      emailclassification: {}
      emailclientname: {}
      emailfrom: {}
      emailheaders: {}
      emailhtml: {}
      emailinreplyto: {}
      emailkeywords: {}
      emailmessageid: {}
      emailreceived: {}
      emailreplyto: {}
      emailreturnpath: {}
      emailsenderip: {}
      emailsize: {}
      emailsource: {}
      emailsubject: {}
      emailto: {}
      emailtocount: {}
      emailurlclicked: {}
      employeedisplayname: {}
      employeeemail: {}
      employeemanageremail: {}
      escalation: {}
      eventaction: {}
      eventid: {}
      eventtype: {}
      expanseactivitystatus: {}
      expanseasset: {}
      expanseassetorganizationunit: {}
      expanseassetowner: {}
      expanseassignee: {}
      expansebusinessunits: {}
      expansecategory: {}
      expansecertificate: {}
      expansecreated: {}
      expansedomain: {}
      expanseinitialevidence: {}
      expanseip: {}
      expanseissueid: {}
      expanseissuetype: {}
      expanselatestevidence: {}
      expansemodified: {}
      expanseport: {}
      expansepriority: {}
      expanseprogressstatus: {}
      expanseprotocol: {}
      expanseprovider: {}
      expanseshadowit:
        complex:
          accessor: "1"
          root: Analysis of Asset Attribution.Answers
          transformers:
          - args:
              else:
                value:
                  simple: "false"
              equals:
                value:
                  simple: "Yes"
              then:
                value:
                  simple: "true"
            operator: If-Then-Else
      expansetags: {}
      externaladdresses: {}
      filehash: {}
      filename: {}
      filepath: {}
      filesize: {}
      firstname: {}
      firstseen: {}
      givenname: {}
      helloworldid: {}
      helloworldstatus: {}
      helloworldtype: {}
      hostname: {}
      id: {}
      incomingmirrorerror: {}
      infectedhosts: {}
      internaladdresses: {}
      investigationstage: {}
      isolated: {}
      jobcode: {}
      jobfamily: {}
      jobfunction: {}
      labels: {}
      lastmodifiedby: {}
      lastmodifiedon: {}
      lastname: {}
      lastseen: {}
      leadership: {}
      location: {}
      locationregion: {}
      logsource: {}
      macaddress: {}
      maliciousbehavior: {}
      malwarefamily: {}
      malwarename: {}
      manageremailaddress: {}
      managername: {}
      md5: {}
      mobiledevicemodel: {}
      mobilephone: {}
      name: {}
      occurred: {}
      os: {}
      osversion: {}
      outgoingmirrorerror: {}
      owner: {}
      parentprocessid: {}
      personalemail: {}
      phase: {}
      phishingsubtype: {}
      phonenumber: {}
      pid: {}
      policydeleted: {}
      policydescription: {}
      policydetails: {}
      policyid: {}
      policyrecommendation: {}
      policyremediable: {}
      policyseverity: {}
      policytype: {}
      prismacloudid: {}
      prismacloudreason: {}
      prismacloudrules: {}
      prismacloudstatus: {}
      prismacloudtime: {}
      protocol: {}
      protocols: {}
      quarantined: {}
      rating: {}
      region: {}
      regionid: {}
      replacePlaybook: {}
      reporteremailaddress: {}
      resourceapiname: {}
      resourcecloudtype: {}
      resourceid: {}
      resourcename: {}
      resourcetype: {}
      riskrating: {}
      riskscore: {}
      roles: {}
      rrn: {}
      samaccountname: {}
      severity: {}
      sha256: {}
      shadowitaccountowneremail: {}
      shadowitaccountownername: {}
      shadowitbilledtocorp: {}
      shadowitcertificate: {}
      shadowitcloudaccountid: {}
      shadowitcloudaccounttype: {}
      shadowitfqdn: {}
      shadowitip: {}
      shadowitorganizationalunit: {}
      shadowitoucontactemail: {}
      shadowitoucontactname: {}
      shadowitport: {}
      shadowitprovider: {}
      shadowitrisk: {}
      shadowitsactionedservice: {}
      shadowitsource: {}
      shadowusersuggestions: {}
      signature: {}
      skuname: {}
      skutier: {}
      sla: {}
      slaField: {}
      sourcehostname: {}
      sourceip: {}
      sourcenetwork: {}
      sourceport: {}
      sourceusername: {}
      src: {}
      srchostname: {}
      srcntdomain: {}
      srcos: {}
      srcuser: {}
      state: {}
      streetaddress: {}
      subcategory: {}
      subscriptionassignedby: {}
      subscriptioncreatedby: {}
      subscriptioncreatedon: {}
      subscriptiondescription: {}
      subscriptionid: {}
      subscriptionname: {}
      subscriptiontype: {}
      subscriptionupdatedby: {}
      subscriptionupdatedon: {}
      subtype: {}
      surname: {}
      systemdefault: {}
      systems: {}
      targetfirewallversion: {}
      tenantname: {}
      terminatedaction: {}
      threatactor: {}
      ticketcloseddate: {}
      ticketnumber: {}
      ticketopeneddate: {}
      title: {}
      triggeredsecurityprofile: {}
      type: {}
      uniqueports: {}
      urlsslverification: {}
      user: {}
      useraccountcontrol: {}
      username: {}
      vendorid: {}
      vendorproduct: {}
      vpcid: {}
      vulnerabilitycategory: {}
      workphone: {}
      xdralertcount: {}
      xdralerts: {}
      xdrassigneduseremail: {}
      xdrassigneduserprettyname: {}
      xdrdescription: {}
      xdrdetectiontime: {}
      xdrfileartifacts: {}
      xdrhighseverityalertcount: {}
      xdrhostcount: {}
      xdrincidentid: {}
      xdrlowseverityalertcount: {}
      xdrmediumseverityalertcount: {}
      xdrnetworkartifacts: {}
      xdrnotes: {}
      xdrresolvecomment: {}
      xdrstatus: {}
      xdrstatusv2: {}
      xdrurl: {}
      xdrusercount: {}
      zipcode: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: a0d56a1f-8102-40c7-8820-ec68061dd743
      iscommand: true
      name: Set Shadow IT flag based on User response
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: a0d56a1f-8102-40c7-8820-ec68061dd743
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 640,
          "y": 4070
        }
      }
  "136":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: "1"
                root: Analysis of Asset Attribution.Answers
          operator: notContainsString
          right:
            value:
              simple: Undecided
      label: "yes"
    id: "136"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "93"
      "yes":
      - "135"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5195bd32-4758-4a1c-8f5d-ff251f249a87
      iscommand: false
      name: Did User reply to the Shadow IT question?
      type: condition
      description: Check whether user answered to the Shadow IT question.
      version: -1
    taskid: 5195bd32-4758-4a1c-8f5d-ff251f249a87
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 287.5,
          "y": 3370
        }
      }
  "137":
    id: "137"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "121"
    note: false
    quietmode: 0
    scriptarguments:
      append: {}
      key:
        simple: PanOSDeviceGroups
      stringify: {}
      value:
        complex:
          accessor: "0"
          root: Choose Device Group Name and Tag.Answers
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 211b7713-9938-4b7e-8dbc-1c8e12f7999b
      iscommand: false
      name: Set Target Device Groups based on user input
      script: Set
      type: regular
      version: -1
    taskid: 211b7713-9938-4b7e-8dbc-1c8e12f7999b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 3350,
          "y": 8080
        }
      }
  "138":
    id: "138"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "139"
    note: false
    quietmode: 0
    scriptarguments:
      extend-context:
        simple: FirewallTagListText=
      ignore-outputs:
        simple: "true"
      listName:
        complex:
          root: inputs.FirewallTagListName
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.get
      id: 47237470-501b-4f3d-8916-14864ebb6c60
      iscommand: true
      name: Load Firewall Tag List
      script: Builtin|||getList
      type: regular
      version: -1
    taskid: 47237470-501b-4f3d-8916-14864ebb6c60
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1755,
          "y": -1305
        }
      }
  "139":
    id: "139"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      append: {}
      key:
        simple: FirewallTagList
      stringify: {}
      value:
        complex:
          root: FirewallTagListText
          transformers:
          - operator: ParseJSON
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: bdf5137a-41a9-4832-8075-1f435f343331
      iscommand: false
      name: Parse Firewall Tag List
      script: Set
      type: regular
      version: -1
    taskid: bdf5137a-41a9-4832-8075-1f435f343331
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1755,
          "y": -1130
        }
      }
  "140":
    id: "140"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "118"
    note: false
    quietmode: 0
    scriptarguments:
      append: {}
      key:
        simple: NewDGTagName
      stringify: {}
      value:
        complex:
          accessor: "1"
          root: Choose Device Group Name and Tag.Answers
          transformers:
          - args:
              prefix:
                value:
                  simple: dg-
              suffix: {}
            operator: concat
          - args:
              prefix:
                iscontext: true
                value:
                  simple: inputs.TagPrefix
              suffix: {}
            operator: concat
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 20699277-a6a3-4631-81b5-1d7a00801249
      iscommand: false
      name: Set New DG Tag Name
      script: Set
      type: regular
      version: -1
    taskid: 20699277-a6a3-4631-81b5-1d7a00801249
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2742.5,
          "y": 8080
        }
      }
  "141":
    evidencedata:
      customfields: {}
      description:
        simple: Issue Comments in Expanse
    id: "141"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "29"
    note: true
    quietmode: 0
    scriptarguments:
      created_after: {}
      issue_id:
        complex:
          accessor: expanseissueid
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Retrieve issue comments (subset of updates)
      id: 740b4104-5654-4e75-879b-d66f0fdcae30
      iscommand: true
      name: Get Expanse Comments
      script: '|||expanse-get-issue-comments'
      type: regular
      version: -1
    taskid: 740b4104-5654-4e75-879b-d66f0fdcae30
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1060,
          "y": -600
        }
      }
  "147":
    id: "147"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "62"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e14cde57-d32c-4707-8ab5-474121788f85
      iscommand: false
      name: Done Public Cloud Enrichment
      type: title
      version: -1
      description: ''
    taskid: e14cde57-d32c-4707-8ab5-474121788f85
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1287.5,
          "y": 1090
        }
      }
  "151":
    id: "151"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "155"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: ShadowITCondition
      stringify: {}
      value:
        complex:
          accessor: Attribution
          root: PrismaCloud
          transformers:
          - operator: count
          - args:
              else:
                value:
                  simple: '{"condition":"Asset found on Prisma Cloud", "value":true}'
              equals:
                value:
                  simple: "0"
              then:
                value:
                  simple: '{"condition":"Asset found on Prisma Cloud", "value":false}'
            operator: If-Then-Else
          - operator: ParseJSON
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: 14e233a8-9dca-423f-849c-27606693cce6
      iscommand: false
      name: 'Set Shadow IT Condition variable: On Prisma Cloud?'
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 14e233a8-9dca-423f-849c-27606693cce6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 702.5,
          "y": 1730
        }
      }
  "152":
    id: "152"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "155"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: ShadowITCondition
      stringify: {}
      value:
        complex:
          root: UNEXISTINGFIELD
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: '{"condition":"Asset is On Prem with high confidence", "value":true}'
            operator: SetIfEmpty
          - operator: ParseJSON
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: 431c76d4-3dce-4344-8b0d-b4f0afa0548d
      iscommand: false
      name: 'Set Shadow IT Condition variable: On Prem high confidence to True'
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 431c76d4-3dce-4344-8b0d-b4f0afa0548d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1060,
          "y": 1900
        }
      }
  "153":
    id: "153"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "155"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: ShadowITCondition
      stringify: {}
      value:
        complex:
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: Expanse.AttributionDevice.exposing_service
              operator: isEqualString
              right:
                value:
                  simple: "true"
          root: Expanse.AttributionDevice
          transformers:
          - operator: count
          - args:
              else:
                value:
                  simple: '{"condition":"Found Firewall exposing service", "value":true}'
              equals:
                value:
                  simple: "0"
              then:
                value:
                  simple: '{"condition":"Found Firewall exposing service", "value":false}'
            operator: If-Then-Else
          - operator: ParseJSON
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: 39177876-aad0-40c1-8fdc-8064911876a8
      iscommand: false
      name: 'Set Shadow IT Condition variable: any Firewall exposing service?'
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 39177876-aad0-40c1-8fdc-8064911876a8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1912.5,
          "y": 1730
        }
      }
  "154":
    id: "154"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "151"
      - "153"
      - "156"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: eacd7dab-2d85-4677-8c4e-db70b3dd49d8
      iscommand: false
      name: Set up Shadow IT Condition Variables for report
      type: title
      version: -1
      description: ''
    taskid: eacd7dab-2d85-4677-8c4e-db70b3dd49d8
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1287.5,
          "y": 1540
        }
      }
  "155":
    id: "155"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "59"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7a52930a-c1f1-404e-8a89-669768230cd7
      iscommand: false
      name: Done Setting up Shadow IT Conditions for Report
      type: title
      version: -1
      description: ''
    taskid: 7a52930a-c1f1-404e-8a89-669768230cd7
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1287.5,
          "y": 2080
        }
      }
  "156":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expanseprovider
                root: incident
          operator: isEqualString
          right:
            value:
              simple: On Prem
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: ExpanseAllAssetTags
                    operator: inList
                    right:
                      iscontext: true
                      value:
                        simple: IPRangeLowConfidenceTag
                root: ExpanseAllAssetTags
                transformers:
                - operator: count
          operator: isEqualNumber
          right:
            value:
              simple: "0"
      label: "yes"
    id: "156"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "157"
      "yes":
      - "152"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 023fdf49-8863-47b1-889b-576b550258a5
      iscommand: false
      name: On-prem with high confidence?
      type: condition
      version: -1
      description: Check whether the asset is market as on prem with a high degree of confidence.
    taskid: 023fdf49-8863-47b1-889b-576b550258a5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1287.5,
          "y": 1720
        }
      }
  "157":
    id: "157"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "155"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: ShadowITCondition
      stringify: {}
      value:
        complex:
          root: UNEXISTINGFIELD
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: '{"condition":"Asset is On Prem with high confidence", "value":false}'
            operator: SetIfEmpty
          - operator: ParseJSON
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: fc97e33b-5328-453c-8aab-db27ac96c598
      iscommand: false
      name: 'Set Shadow IT Condition variable: On Prem high confidence to False'
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: fc97e33b-5328-453c-8aab-db27ac96c598
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1507.5,
          "y": 1900
        }
      }
  "158":
    evidencedata:
      customfields: {}
      description:
        simple: Expanse Enrichment Information
    id: "158"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "63"
    note: true
    quietmode: 0
    scriptarguments:
      expanseassettags:
        complex:
          root: ExpanseAllAssetTags
      expansebusinessunits:
        complex:
          accessor: expansebusinessunits
          root: incident
      expansedevices:
        complex:
          accessor: AttributionDevice
          root: Expanse
      expanseips:
        complex:
          accessor: AttributionIP
          root: Expanse
      expanseissuetags:
        complex:
          accessor: expansetags
          root: incident
      expansetags:
        complex:
          root: ExpanseXSOAROUTags
      expanseusers:
        complex:
          accessor: AttributionUser
          root: Expanse
      fqdn:
        complex:
          accessor: expansedomain
          root: incident
      ip:
        complex:
          accessor: expanseip
          root: incident
      port:
        complex:
          accessor: expanseport
          root: incident
      prismacloudassets:
        complex:
          accessor: Attribution
          root: PrismaCloud
      provider:
        complex:
          accessor: expanseprovider
          root: incident
      region:
        complex:
          accessor: expanseregion
          root: incident
      service:
        complex:
          accessor: expanseservice
          root: incident
      shadowit:
        complex:
          root: ShadowITCondition
      shadowitreasons: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: 'Print '
      id: 2a7a25ed-9c22-4f7d-8015-7aec8c2647a6
      iscommand: false
      name: Generate Report for Attribution
      script: 00e01110-5902-4fad-8c07-c4b6474fdece
      type: regular
      version: -1
    taskid: 2a7a25ed-9c22-4f7d-8015-7aec8c2647a6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1287.5,
          "y": 2640
        }
      }
  "159":
    id: "159"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      append: {}
      key:
        simple: ExpanseXSOAROUIssueTags
      stringify: {}
      value:
        complex:
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: ExpanseXSOARIssueTags
              operator: StringContainsArray
              right:
                value:
                  simple: -ou-
          root: ExpanseXSOARIssueTags
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: c16018a6-9317-46e5-8d6a-a21e17cdf152
      iscommand: false
      name: 'Extract XSOAR Incident Tags related to OU Attribtion '
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: c16018a6-9317-46e5-8d6a-a21e17cdf152
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 907.5,
          "y": -1130
        }
      }
  "161":
    id: "161"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "162"
    note: false
    quietmode: 0
    scriptarguments:
      issue_id:
        complex:
          accessor: expanseissueid
          root: incident
      update_type:
        simple: ProgressStatus
      value:
        simple: Investigating
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Update Expanse issue.
      id: ec959989-3a7a-4248-8407-2cb8afa72bad
      iscommand: true
      name: Set Progress Status to Investigating in Expanse issue
      script: '|||expanse-update-issue'
      type: regular
      version: -1
    taskid: ec959989-3a7a-4248-8407-2cb8afa72bad
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1740,
          "y": -1840
        }
      }
  "162":
    id: "162"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      issue_id:
        complex:
          accessor: expanseissueid
          root: incident
      update_type:
        simple: Comment
      value:
        simple: This Issue is being investigated by the SOC through Cortex XSOAR
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Update Expanse issue.
      id: db886e09-c8cf-4345-8600-c71b1db84ceb
      iscommand: true
      name: Add "Being investigated by XSOAR" comment to Expanse issue
      script: '|||expanse-update-issue'
      type: regular
      version: -1
    taskid: db886e09-c8cf-4345-8600-c71b1db84ceb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1740,
          "y": -1680
        }
      }
  "163":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.WriteToExpanse
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    id: "163"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "161"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ad76e2ab-c4f0-4ee5-8989-a3b81cf363e7
      iscommand: false
      name: Are we writing to Expanse?
      type: condition
      version: -1
      description: Determine whether playbook should write data back to Expanse.
    taskid: ad76e2ab-c4f0-4ee5-8989-a3b81cf363e7
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1327.5,
          "y": -2040
        }
      }
  "164":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.WriteToExpanse
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    id: "164"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "166"
      "yes":
      - "96"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2a587bee-453b-4d2c-886f-57b52f2bd279
      iscommand: false
      name: Are we writing to Expanse?
      type: condition
      version: -1
      description: Determine whether playbook should write data back to Expanse.
    taskid: 2a587bee-453b-4d2c-886f-57b52f2bd279
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 600,
          "y": 4530
        }
      }
  "165":
    id: "165"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "164"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c65081f9-3e51-43d0-89c5-b886965c5116
      iscommand: false
      name: Tag Assets
      type: title
      version: -1
      description: ''
    taskid: c65081f9-3e51-43d0-89c5-b886965c5116
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 600,
          "y": 4390
        }
      }
  "166":
    id: "166"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "30"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 806ec305-4ee3-42e3-8fe6-ef03b068856d
      iscommand: false
      name: Done Tagging
      type: title
      version: -1
      description: ''
    taskid: 806ec305-4ee3-42e3-8fe6-ef03b068856d
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 600,
          "y": 5440
        }
      }
  "167":
    id: "167"
    ignoreworker: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    scriptarguments:
      Create Indicators:
        simple: "true"
      Expanse Assets:
        complex:
          accessor: expanseasset
          root: incident
      Expanse IP:
        complex:
          accessor: expanseip
          root: incident
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: 2f062839-f8bd-470f-8f84-62ed86d152c4
      iscommand: false
      name: Extract Expanse Indicators
      playbookId: Extract Expanse Indicators
      type: playbook
      version: -1
      description: Extracts and Enriches Expanse from Indicator Assets
    taskid: 2f062839-f8bd-470f-8f84-62ed86d152c4
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1610,
          "y": -600
        }
      }
  "169":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.WriteToExpanse
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    id: "169"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "121"
      "yes":
      - "116"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3ea60347-930a-4a4f-8f58-9cf7521b3df5
      iscommand: false
      name: Are we writing to Expanse?
      type: condition
      version: -1
      description: Determine whether playbook should write data back to Expanse.
    taskid: 3ea60347-930a-4a4f-8f58-9cf7521b3df5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2742.5,
          "y": 8370
        }
      }
  "170":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.WriteToExpanse
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    id: "170"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "121"
      "yes":
      - "117"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 86f8a2f0-08d7-4c01-8e51-0f36b0c2d9a2
      iscommand: false
      name: Are we writing to Expanse?
      type: condition
      version: -1
      description: Determine whether playbook should write data back to Expanse.
    taskid: 86f8a2f0-08d7-4c01-8e51-0f36b0c2d9a2
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2292.5,
          "y": 8670
        }
      }
  "171":
    id: "171"
    ignoreworker: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "147"
    note: false
    quietmode: 0
    scriptarguments:
      AWSIndicatorTags:
        simple: AWS
      AzureIndicatorTags:
        simple: Azure
      FQDN:
        complex:
          accessor: expansedomain
          root: incident
      GCPIndicatorTags:
        simple: GCP
      IP:
        complex:
          accessor: expanseip
          root: incident
      Provider:
        complex:
          accessor: expanseprovider
          root: incident
      Update Incident:
        simple: "True"
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: d94a9a3f-4d4e-44c3-88c5-aa4f508b1544
      iscommand: false
      name: Find Cloud IP Address Region and Service
      playbookId: Find Cloud IP Address Region and Service
      type: playbook
      version: -1
      description: ''
    taskid: d94a9a3f-4d4e-44c3-88c5-aa4f508b1544
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1755,
          "y": 365
        }
      }
  "172":
    id: "172"
    ignoreworker: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "111"
    note: false
    quietmode: 0
    scriptarguments:
      Link Incidents:
        simple: "True"
      Prisma Cloud Attribution:
        complex:
          accessor: Attribution
          root: PrismaCloud
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: a6ceed46-7a4d-47b5-8a2f-fd8f462c6aef
      iscommand: false
      name: Prisma Cloud Correlate Alerts
      playbookId: Prisma Cloud Correlate Alerts
      type: playbook
      version: -1
      description: ''
    taskid: a6ceed46-7a4d-47b5-8a2f-fd8f462c6aef
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -1610,
          "y": 7320
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "170_117_yes": 0.63,
      "73_86_#default#": 0.11,
      "96_166_#default#": 0.4,
      "9_14_#default#": 0.69
    },
    "paper": {
      "dimensions": {
        "height": 12995,
        "width": 6120,
        "x": -1610,
        "y": -2180
      }
    }
  }
tests:
- No tests (auto formatted)
fromversion: 6.0.0
