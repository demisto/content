description: Main playbook for Expanse Issues
id: Handle Expanse Incident
inputs:
- description: |-
    Minimum Incident Priority for Auto Remediation:
    1 - Low
    2 - Medium
    3 - High
    4 - Critical
  key: MinPriorityForAutoRemediation
  playbookInputQuery:
  required: false
  value:
    simple: "1"
- description: Name of XSOAR List that contains the mapping between Expanse tags and
    XSOAR PANOS Instances.
  key: FirewallTagListName
  playbookInputQuery:
  required: false
  value:
    simple: ExpanseTagsToPANOSDeviceGroup
- description: Prefix for XSOAR related Expanse tags
  key: TagPrefix
  playbookInputQuery:
  required: false
  value:
    simple: xsoar-
- description: PAN-OS Log Forwarding Profile Name
  key: LogForwarding
  playbookInputQuery:
  required: false
  value: {}
- description: Panorama Auto Commit
  key: AutoCommit
  playbookInputQuery:
  required: false
  value:
    simple: "Yes"
- description: Comma separated list of tags to be used to identify IP ranges attributed
    with low confidence
  key: IPRangeLowConfidenceTagList
  playbookInputQuery:
  required: false
  value:
    simple: low confidence
- description: Tag to be used for assets that do not belong to org
  key: FalsePositiveTag
  playbookInputQuery:
  required: false
  value:
    simple: xsoar-false-positive
- description: Write data back to Expanse?
  key: WriteToExpanse
  playbookInputQuery:
  required: false
  value:
    simple: "True"
- description: Subject of the email to send to the OU Owner.
  key: OwnerNotificationSubject
  playbookInputQuery:
  required: false
  value:
    simple: New security issue on a public service owned by your team
- description: Body of the email to send to the OU Owner.
  key: OwnerNotificationBody
  playbookInputQuery:
  required: false
  value:
    simple: Infosec identified a security issue on a service owned by your team and
      exposed on Internet. Please get in touch with your Infosec team to define proper
      remediation access.
- description: Enrich flows using Expanse Behavior.
  key: UseBehavior
  playbookInputQuery:
  required: false
  value:
    simple: "True"
- description: If set, specifies the type of Incident that gets automatically created
    during the Shadow IT flow. If not set, the Incident is to be created manually.
  key: ShadowITIncidentType
  playbookInputQuery:
  required: false
  value:
    simple: Shadow IT
name: Handle Expanse Incident
outputs: []
starttaskid: "0"
tasks:
  "0":
    id: "0"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "163"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 51c3a318-8410-4747-8095-4cc20f00e6ae
      iscommand: false
      name: ""
      version: -1
      description: ''
    taskid: 51c3a318-8410-4747-8095-4cc20f00e6ae
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 1327.5,
          "y": -2180
        }
      }
  "1":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: ExpanseDeviceGroupAssetTags
          operator: isNotEmpty
      label: "yes"
    defaultassigneecomplex: {}
    id: "1"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "2"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether Expanse Asset tags are present in this incident.
      id: a43857f5-ff46-49b2-84ac-1084d74be59c
      iscommand: false
      name: Are there Expanse Asset Tags for this incident?
      type: condition
      version: -1
    taskid: a43857f5-ff46-49b2-84ac-1084d74be59c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1960,
          "y": 6685
        }
      }
  "2":
    id: "2"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 570b27a0-6613-4c4c-8d12-db661c731de8
      iscommand: false
      name: Use Device Groups from Expanse Asset Tags
      type: title
      version: -1
      description: ''
    taskid: 570b27a0-6613-4c4c-8d12-db661c731de8
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2340,
          "y": 6875
        }
      }
  "3":
    id: "3"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 559165da-09d1-4d75-80ea-b816f1938693
      iscommand: false
      name: Search Device Groups from Logs
      type: title
      version: -1
      description: ''
    taskid: 559165da-09d1-4d75-80ea-b816f1938693
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1717.5,
          "y": 6865
        }
      }
  "4":
    id: "4"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    scriptarguments:
      append: {}
      key:
        simple: TargetFirewalls
      stringify: {}
      value:
        complex:
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: Expanse.AttributionDevice.exposing_service
              operator: isTrue
          - - left:
                iscontext: true
                value:
                  simple: Expanse.AttributionDevice.sightings
              operator: greaterThan
              right:
                value:
                  simple: "0"
          root: Expanse.AttributionDevice
          transformers:
          - operator: Stringify
          - args:
              limit: {}
              replaceWith:
                value:
                  simple: devicegroup
              toReplace:
                value:
                  simple: device-group
            operator: replace
          - operator: ParseJSON
          - args:
              expression:
                value:
                  simple: '{deviceGroup: devicegroup, source: ''From Logs'', sightings:sightings}'
            operator: jmespath
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: 91ffcf80-d566-4b99-8c40-67c0d3082ea4
      iscommand: false
      name: Find Possible Device Groups
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 91ffcf80-d566-4b99-8c40-67c0d3082ea4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1717.5,
          "y": 6990
        }
      }
  "5":
    id: "5"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "12"
      - "138"
      - "65"
      - "173"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bb1c069a-6c84-40c0-8aa8-baec3e44ba53
      iscommand: false
      name: Set Up Context Variables
      type: title
      version: -1
      description: ''
    taskid: bb1c069a-6c84-40c0-8aa8-baec3e44ba53
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1327.5,
          "y": -1450
        }
      }
  "6":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: incident.severity
          operator: greaterThanOrEqual
          right:
            iscontext: true
            value:
              simple: inputs.MinPriorityForAutoRemediation
      label: "yes"
    id: "6"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "14"
      "yes":
      - "124"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether incident priority is above autoremediation threshold.
      id: a79fac58-9d1e-45b8-83c7-8a788bfa4838
      iscommand: false
      name: Is Incident Priority Above AutoRemediation Threshold?
      type: condition
      version: -1
    taskid: a79fac58-9d1e-45b8-83c7-8a788bfa4838
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1457.5,
          "y": 6175
        }
      }
  "8":
    id: "8"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "75"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b070e46a-580e-48be-890a-eb93123e1ac9
      iscommand: false
      name: Done Network  Remediation
      type: title
      version: -1
      description: ''
    taskid: b070e46a-580e-48be-890a-eb93123e1ac9
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1457.5,
          "y": 10045
        }
      }
  "9":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expanseip
                root: incident
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expanseport
                root: incident
          operator: InRange
          right:
            value:
              simple: 1,65535
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: expanseprotocol
                root: incident
          operator: inList
          right:
            value:
              simple: tcp,udp
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expanseprovider
                root: incident
          operator: isEqualString
          right:
            value:
              simple: On Prem
      label: "Yes"
    id: "9"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "14"
      "Yes":
      - "6"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether the issue can be auto-remediated with PAN-OS (on-prem
        and ip/port found)
      id: 60c5d12b-336c-46b5-802f-dbf06a6abd56
      iscommand: false
      name: Is Issue AutoRemediable with PAN-OS? (On-Prem and has IP:Port)
      type: condition
      version: -1
    taskid: 60c5d12b-336c-46b5-802f-dbf06a6abd56
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1112.5,
          "y": 6000
        }
      }
  "10":
    id: "10"
    ignoreworker: false
    nexttasks:
      ✅ Yes:
      - "24"
      ❌ No:
      - "14"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Ask the user confirmation on whether blocking the service.
      id: eb8e3613-9e79-4800-8bd5-05859940ea6c
      iscommand: false
      name: Block ${incident.expanseip}:${incident.expanseport}/${incident.expanseprotocol}
        on ${PanOSDeviceGroups} ?
      type: condition
      version: -1
    taskid: eb8e3613-9e79-4800-8bd5-05859940ea6c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1962.5,
          "y": 9150
        }
      }
  "11":
    id: "11"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: TargetFirewalls
      stringify: {}
      value:
        complex:
          accessor: =[]}
          root: ${
          transformers:
          - args:
              key:
                iscontext: true
                value:
                  simple: FirewallTagList
              list:
                iscontext: true
                value:
                  simple: ExpanseDeviceGroupAssetTags
            operator: GetValuesOfMultipleFields
          - args:
              prefix:
                value:
                  simple: '{"dg":"'
              suffix:
                value:
                  simple: '"}'
            operator: concat
          - args:
              separator:
                value:
                  simple: ','
            operator: join
          - args:
              prefix:
                value:
                  simple: '['
              suffix:
                value:
                  simple: ']'
            operator: concat
          - operator: ParseJSON
          - args:
              expression:
                value:
                  simple: '{deviceGroup:dg, source: ''From Expanse Tags'', sightings:''N/A''}'
            operator: jmespath
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: fbcce3ca-91b3-4921-893c-59949f342804
      iscommand: false
      name: Set Target Device Groups from Expanse Tags
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: fbcce3ca-91b3-4921-893c-59949f342804
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2340,
          "y": 6990
        }
      }
  "12":
    id: "12"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "159"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: ExpanseXSOARIssueTags
      stringify: {}
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: incident.expansetags
              operator: startWith
              right:
                iscontext: true
                value:
                  simple: inputs.TagPrefix
          root: incident.expansetags
          transformers:
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: 9dad11d3-aa79-4787-80f0-92666021632e
      iscommand: false
      name: Extract XSOAR Incident Tags from Expanse
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 9dad11d3-aa79-4787-80f0-92666021632e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 907.5,
          "y": -1305
        }
      }
  "13":
    id: "13"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Perform manual block on the network
      id: 8fe104a2-1fee-4319-8b55-bda1995cec2f
      iscommand: false
      name: Manual Block on Network
      type: regular
      version: -1
    taskid: 8fe104a2-1fee-4319-8b55-bda1995cec2f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1457.5,
          "y": 9560
        }
      }
  "14":
    id: "14"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9f85b5a2-ca3a-4bc5-8844-55e3a56d1afa
      iscommand: false
      name: Manual Network Remediation
      type: title
      version: -1
      description: ''
    taskid: 9f85b5a2-ca3a-4bc5-8844-55e3a56d1afa
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1457.5,
          "y": 9365
        }
      }
  "15":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: TargetFirewalls
          operator: isNotEmpty
      label: "yes"
    id: "15"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "16"
      "yes":
      - "66"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether a target device group is found
      id: 7b910836-c1b5-4351-8768-e8bcea17ee9f
      iscommand: false
      name: Device Groups found?
      type: condition
      version: -1
    taskid: 7b910836-c1b5-4351-8768-e8bcea17ee9f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2055,
          "y": 7180
        }
      }
  "16":
    form:
      description: Choose Device Group
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: What Device Group do you want to apply the configuration on?
        options: []
        optionsarg:
        - complex:
            root: FirewallTagList
            transformers:
            - args:
                expression:
                  value:
                    simple: values(@)
              operator: jmespath
        - simple: ➕ Add New
        - simple: "\U0001F525 Firewall Only (No Panorama)"
        - simple: ❌ Manual Configuration
        placeholder: ""
        readonly: false
        required: true
        tooltip: Choose Device Group
        type: singleSelect
      sender: ""
      title: Choose Device Group
      totalanswers: 0
    id: "16"
    ignoreworker: false
    message:
      bcc:
      body:
        simple: Choose target Device Group
      cc:
      format: ""
      methods: []
      subject:
        simple: Choose target Device Group
      timings:
        completeafterreplies: 1
        retriescount: 2
        retriesinterval: 360
      to:
        simple: Analyst
    nexttasks:
      '#none#':
      - "119"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Ask the user on which Device Group to enforce the policy change.
      id: 71d450d4-491b-407b-8feb-b728ea4f86d3
      iscommand: false
      name: Choose Device Group to enforce policy
      type: collection
      version: -1
    taskid: 71d450d4-491b-407b-8feb-b728ea4f86d3
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 2055,
          "y": 7535
        }
      }
  "18":
    id: "18"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "120"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 66a58c08-2d75-41b2-886b-7ac41e53b5f3
      iscommand: false
      name: DG Tagging
      type: title
      version: -1
      description: ''
    taskid: 66a58c08-2d75-41b2-886b-7ac41e53b5f3
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2752.5,
          "y": 7915
        }
      }
  "22":
    id: "22"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "36"
      - "34"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Start validation of Incident
      id: b97f49cc-0494-4299-8f1e-3227085fad8a
      iscommand: false
      name: Start Validation
      type: title
      version: -1
    taskid: b97f49cc-0494-4299-8f1e-3227085fad8a
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1330,
          "y": 30
        }
      }
  "23":
    id: "23"
    ignoreworker: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      AutoCommit:
        complex:
          root: inputs.AutoCommit
      DeviceGroup:
        complex:
          root: PanOSDeviceGroups
      IP:
        complex:
          accessor: expanseip
          root: incident
      LogForwarding:
        complex:
          root: inputs.LogForwarding
      Port:
        complex:
          accessor: expanseport
          root: incident
          transformers:
          - operator: Stringify
      Protocol:
        complex:
          accessor: expanseprotocol
          root: incident
          transformers:
          - operator: toLowerCase
      RuleNamePrefix:
        simple: xsoar-rule-
      ServiceNamePrefix:
        simple: xsoar-service-
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: This playbook blocks a Destination IP and Service (tcp or udp port)
        by creating a rule on a specific Device Group
      id: 5f7fdefc-2234-4bf6-8149-78fa14121e8a
      iscommand: false
      name: PAN-OS - Block Destination Service
      playbookId: PAN-OS - Block Destination Service
      type: playbook
      version: -1
    taskid: 5f7fdefc-2234-4bf6-8149-78fa14121e8a
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 2485,
          "y": 9855
        }
      }
  "24":
    id: "24"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 204c7dc1-24c5-4e54-8b9c-84ee99a0aafb
      iscommand: false
      name: Block Service
      type: title
      version: -1
      description: ''
    taskid: 204c7dc1-24c5-4e54-8b9c-84ee99a0aafb
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2272.5,
          "y": 9345
        }
      }
  "25":
    id: "25"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    scriptarguments:
      target: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Show firewall device software version.
      id: d9676706-1ecc-48e1-8335-ca54777eb1dd
      iscommand: true
      name: Get PAN-OS Version
      script: '|||panorama-show-device-version'
      type: regular
      version: -1
    taskid: d9676706-1ecc-48e1-8335-ca54777eb1dd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2272.5,
          "y": 9505
        }
      }
  "26":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: Model
                root: Panorama.Device.Info
          operator: isEqualString
          right:
            value:
              simple: panorama
      label: Panorama
    id: "26"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "27"
      Panorama:
      - "23"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether target device is a Firewall or Panorama
      id: 5fcfdb3e-cd01-4137-86d3-f7ab4168d3c9
      iscommand: false
      name: Firewall or Panorama?
      type: condition
      version: -1
    taskid: 5fcfdb3e-cd01-4137-86d3-f7ab4168d3c9
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2272.5,
          "y": 9680
        }
      }
  "27":
    id: "27"
    ignoreworker: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      AutoCommit:
        complex:
          root: inputs.AutoCommit
      DeviceGroup: {}
      IP:
        complex:
          accessor: expanseip
          root: incident
      LogForwarding:
        complex:
          root: inputs.LogForwarding
      Port:
        complex:
          accessor: expanseport
          root: incident
          transformers:
          - operator: Stringify
      Protocol:
        complex:
          accessor: expanseprotocol
          root: incident
          transformers:
          - operator: toLowerCase
      RuleNamePrefix:
        simple: xsoar-rule-
      ServiceNamePrefix:
        simple: xsoar-service-
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: fe3676cd-ab27-411b-81e0-45c88e6f1494
      iscommand: false
      name: PAN-OS - Block Destination Service
      playbookId: PAN-OS - Block Destination Service
      type: playbook
      version: -1
      description: ''
    taskid: fe3676cd-ab27-411b-81e0-45c88e6f1494
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 2065,
          "y": 9855
        }
      }
  "28":
    id: "28"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "167"
      - "141"
      - "176"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 595fff52-e474-4874-8313-527334304e94
      iscommand: false
      name: Enrichment
      type: title
      version: -1
      description: ''
    taskid: 595fff52-e474-4874-8313-527334304e94
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1337.5,
          "y": -740
        }
      }
  "29":
    id: "29"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ec1ff552-9a1f-416d-89ba-97d664c8ac11
      iscommand: false
      name: Done Enrichment
      type: title
      version: -1
      description: ''
    taskid: ec1ff552-9a1f-416d-89ba-97d664c8ac11
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1337.5,
          "y": -150
        }
      }
  "30":
    id: "30"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "81"
      - "82"
      - "84"
      - "109"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 31015e8f-52fd-497f-8fd7-19d585623521
      iscommand: false
      name: Remediation
      type: title
      version: -1
      description: ''
    taskid: 31015e8f-52fd-497f-8fd7-19d585623521
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 610,
          "y": 5690
        }
      }
  "31":
    evidencedata:
      customfields: {}
      description:
        simple: Risky Flows from Expanse Behavior for this incident's IP
    id: "31"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "29"
    note: true
    quietmode: 0
    scriptarguments:
      created_after: {}
      created_before: {}
      internal_ip_range:
        complex:
          accessor: expanseip
          root: incident
      limit: {}
      risk-rule: {}
      tagnames: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Retrieve Expanse Behavior Risky Flows
      id: 3945ef17-0350-4ef6-8e71-9d27b32829df
      iscommand: true
      name: Extract Risky Flows from Behavior
      script: '|||expanse-get-risky-flows'
      type: regular
      version: -1
    taskid: 3945ef17-0350-4ef6-8e71-9d27b32829df
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 270,
          "y": -390
        }
      }
  "34":
    id: "34"
    ignoreworker: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "147"
    note: false
    quietmode: 0
    scriptarguments:
      Asset:
        simple: ${incident.labels.assets[0]}
      Domain:
        simple: ${incident.expansedomain}
      IP:
        simple: ${incident.expanseip}
      InternalIPRange: {}
      Port:
        simple: ${incident.expanseport}
      Protocol:
        simple: ${incident.expanseprotocol}
      Provider:
        simple: ${incident.labels.providers[0].name}
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: "Given an Expanse Asset, Issue IP, Issue Provider, Issue Domain,\
        \ Issue Port and Issue Protocol hunts for internal activity on the detected\
        \ service. \nReturns a list of potential owner BUs, owner Users, Device and\
        \ Notes"
      id: c9628b6d-3ff2-4dc8-82b5-47a6b2a3c1b9
      iscommand: false
      name: Expanse Attribution Subplaybook
      playbookId: Expanse Attribution Subplaybook
      type: playbook
      version: -1
    taskid: c9628b6d-3ff2-4dc8-82b5-47a6b2a3c1b9
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 840,
          "y": 505
        }
      }
  "36":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: expanseprovider
                root: incident
          operator: isNotEqualString
          right:
            value:
              simple: On Prem
      label: "yes"
    id: "36"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "147"
      "yes":
      - "171"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether the asset is on prem or cloud.
      id: c980f7c3-8e0c-44fc-809d-027a89226555
      iscommand: false
      name: Is Issue Related To Cloud Asset?
      type: condition
      version: -1
    taskid: c980f7c3-8e0c-44fc-809d-027a89226555
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1450,
          "y": 190
        }
      }
  "40":
    id: "40"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "158"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: SuggestedShadowITAnswer
      stringify: {}
      value:
        simple: "Yes"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Set a value in context under the key you entered.
      id: 4ea797c2-8102-45a5-8eb8-f492100a83b7
      iscommand: false
      name: Suggest possible Shadow IT
      script: Set
      type: regular
      version: -1
    taskid: 4ea797c2-8102-45a5-8eb8-f492100a83b7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 970,
          "y": 2605
        }
      }
  "48":
    form:
      description: |-
        Playbook automatically collected details from different sources to help the identification of the owner of the asset. Please check the Evidence board for additional details that could help in your investigation.

        To continue your investigation, please decide:
        - the **Organization Unit** this asset belongs to. This will be used for notifications and remediations actions. If you don't know, you can select *Unknown*. If the asset doesn't belong to your organization, select *False Positive*. If the OU is not listed select *Add New* to add a new OU.
        - if the asset should be considered **Shadow IT**
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Select the Organization Unit owning this asset
        options: []
        optionsarg:
        - complex:
            accessor: ExpanseOrganizationUnitsToOwner
            root: lists
            transformers:
            - args:
                expression:
                  value:
                    simple: keys(@)
              operator: jmespath
        - simple: ❓Unknown
        - simple: ➕ Add New
        - simple: ❌ False Positive
        placeholder: ""
        readonly: false
        required: true
        tooltip: Select the Organization Unit owning this asset
        type: singleSelect
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "1"
        label: ""
        labelarg:
          complex:
            root: SuggestedShadowITAnswer
            transformers:
            - args:
                else:
                  value:
                    simple: Automatic analysis suggests that the asset is not Shadow
                      IT. Is the asset Shadow IT?
                equals:
                  value:
                    simple: "Yes"
                then:
                  value:
                    simple: Automatic analysis identified the asset as a possible
                      Shadow IT asset. Is the asset Shadow IT?
              operator: If-Then-Else
        options: []
        optionsarg:
        - simple: "No"
        - simple: ❓Undecided
        - simple: "Yes"
        placeholder: ""
        readonly: false
        required: true
        tooltip: Decide whether this a Shadow IT asset
        type: singleSelect
      sender: Your SOC team
      title: Analysis of Asset Attribution
      totalanswers: 0
    id: "48"
    ignoreworker: false
    message:
      bcc:
      body:
        complex:
          accessor: id
          root: incident
          transformers:
          - args:
              prefix:
                value:
                  simple: 'Input needed to help attribution in Expanse Issue  '
              suffix: {}
            operator: concat
      cc:
      format: ""
      methods: []
      subject:
        simple: '** not used **'
      timings:
        completeafterreplies: 1
        retriescount: 2
        retriesinterval: 360
      to:
        simple: Analyst
    nexttasks:
      '#none#':
      - "88"
      - "136"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Ask the user to perform attribution.
      id: fd904756-fe34-40e1-82ca-044a10e6a743
      iscommand: false
      name: 'Ask: What Is The Organization Unit?'
      type: collection
      version: -1
    taskid: fd904756-fe34-40e1-82ca-044a10e6a743
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 1257.5,
          "y": 3335
        }
      }
  "49":
    id: "49"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "93"
    note: false
    quietmode: 0
    scriptarguments:
      accountid: {}
      accountname: {}
      addLabels: {}
      agentid: {}
      app: {}
      appendMultiSelect: {}
      assetid: {}
      assigneduser: {}
      assignmentgroup: {}
      attachmentcount: {}
      attachmentextension: {}
      attachmenthash: {}
      attachmentid: {}
      attachmentname: {}
      attachmentsize: {}
      attachmenttype: {}
      blockedaction: {}
      bugtraq: {}
      caller: {}
      city: {}
      closeNotes: {}
      closeReason: {}
      cloudservice: {}
      commandline: {}
      costcenter: {}
      costcentercode: {}
      country: {}
      countryname: {}
      criticalassets: {}
      customFields: {}
      cve: {}
      cvss: {}
      dbotMirrorDirection: {}
      dbotMirrorId: {}
      dbotMirrorInstance: {}
      dbotMirrorTags: {}
      dbotprediction: {}
      dbotpredictionprobability: {}
      dbottextsuggestionhighlighted: {}
      deleteEmptyField: {}
      department: {}
      dest: {}
      desthostname: {}
      destinationhostname: {}
      destinationip: {}
      destinationnetwork: {}
      destinationport: {}
      destntdomain: {}
      destos: {}
      details: {}
      detectedexternalhosts: {}
      detectedexternalips: {}
      detectedinternalhosts: {}
      detectedinternalips: {}
      detectedusers: {}
      detectionendtime: {}
      detectionid: {}
      detectionupdatetime: {}
      detectionurl: {}
      deviceexternalip: {}
      devicehash: {}
      devicelocalip: {}
      devicemodel: {}
      devicename: {}
      displayname: {}
      duration: {}
      email: {}
      emailauthenticitycheck: {}
      emailbcc: {}
      emailbody: {}
      emailbodyformat: {}
      emailbodyhtml: {}
      emailcc: {}
      emailclassification: {}
      emailclientname: {}
      emailfrom: {}
      emailheaders: {}
      emailhtml: {}
      emailinreplyto: {}
      emailkeywords: {}
      emailmessageid: {}
      emailreceived: {}
      emailreplyto: {}
      emailreturnpath: {}
      emailsenderip: {}
      emailsize: {}
      emailsource: {}
      emailsubject: {}
      emailto: {}
      emailtocount: {}
      emailurlclicked: {}
      employeedisplayname: {}
      employeeemail: {}
      employeemanageremail: {}
      escalation: {}
      eventaction: {}
      eventid: {}
      eventtype: {}
      expanseactivitystatus: {}
      expanseasset: {}
      expanseassetorganizationunit:
        complex:
          accessor: "0"
          root: Analysis of Asset Attribution.Answers
          transformers:
          - operator: FirstArrayElement
      expanseassetowner: {}
      expanseassignee: {}
      expansebusinessunits: {}
      expansecategory: {}
      expansecertificate: {}
      expansecreated: {}
      expansedomain: {}
      expanseinitialevidence: {}
      expanseip: {}
      expanseissueid: {}
      expanseissuetype: {}
      expanselatestevidence: {}
      expansemodified: {}
      expanseport: {}
      expansepriority: {}
      expanseprogressstatus: {}
      expanseprotocol: {}
      expanseprovider: {}
      expanseshadowit: {}
      expansetags: {}
      externaladdresses: {}
      filehash: {}
      filename: {}
      filepath: {}
      filesize: {}
      firstname: {}
      firstseen: {}
      givenname: {}
      helloworldid: {}
      helloworldstatus: {}
      helloworldtype: {}
      hostname: {}
      id: {}
      incomingmirrorerror: {}
      infectedhosts: {}
      internaladdresses: {}
      investigationstage: {}
      isolated: {}
      jobcode: {}
      jobfamily: {}
      jobfunction: {}
      labels: {}
      lastmodifiedby: {}
      lastmodifiedon: {}
      lastname: {}
      lastseen: {}
      leadership: {}
      location: {}
      locationregion: {}
      logsource: {}
      macaddress: {}
      maliciousbehavior: {}
      malwarefamily: {}
      malwarename: {}
      manageremailaddress: {}
      managername: {}
      md5: {}
      mobiledevicemodel: {}
      mobilephone: {}
      name: {}
      occurred: {}
      os: {}
      osversion: {}
      outgoingmirrorerror: {}
      owner: {}
      parentprocessid: {}
      personalemail: {}
      phase: {}
      phishingsubtype: {}
      phonenumber: {}
      pid: {}
      policydeleted: {}
      policydescription: {}
      policydetails: {}
      policyid: {}
      policyrecommendation: {}
      policyremediable: {}
      policyseverity: {}
      policytype: {}
      prismacloudid: {}
      prismacloudreason: {}
      prismacloudrules: {}
      prismacloudstatus: {}
      prismacloudtime: {}
      protocol: {}
      protocols: {}
      quarantined: {}
      rating: {}
      region: {}
      regionid: {}
      replacePlaybook: {}
      reporteremailaddress: {}
      resourceapiname: {}
      resourcecloudtype: {}
      resourceid: {}
      resourcename: {}
      resourcetype: {}
      riskrating: {}
      riskscore: {}
      roles: {}
      rrn: {}
      samaccountname: {}
      severity: {}
      sha256: {}
      shadowitaccountowneremail: {}
      shadowitaccountownername: {}
      shadowitcloudaccountid: {}
      shadowitcloudaccounttype: {}
      signature: {}
      skuname: {}
      skutier: {}
      sla: {}
      slaField: {}
      sourcehostname: {}
      sourceip: {}
      sourcenetwork: {}
      sourceport: {}
      sourceusername: {}
      src: {}
      srchostname: {}
      srcntdomain: {}
      srcos: {}
      srcuser: {}
      state: {}
      streetaddress: {}
      subcategory: {}
      subscriptionassignedby: {}
      subscriptioncreatedby: {}
      subscriptioncreatedon: {}
      subscriptiondescription: {}
      subscriptionid: {}
      subscriptionname: {}
      subscriptiontype: {}
      subscriptionupdatedby: {}
      subscriptionupdatedon: {}
      subtype: {}
      surname: {}
      systemdefault: {}
      systems: {}
      targetfirewallversion: {}
      tenantname: {}
      terminatedaction: {}
      threatactor: {}
      ticketcloseddate: {}
      ticketnumber: {}
      ticketopeneddate: {}
      title: {}
      triggeredsecurityprofile: {}
      type: {}
      uniqueports: {}
      urlsslverification: {}
      user: {}
      useraccountcontrol: {}
      username: {}
      vendorid: {}
      vendorproduct: {}
      vpcid: {}
      vulnerabilitycategory: {}
      workphone: {}
      xdralertcount: {}
      xdralerts: {}
      xdrassigneduseremail: {}
      xdrassigneduserprettyname: {}
      xdrdescription: {}
      xdrdetectiontime: {}
      xdrfileartifacts: {}
      xdrhighseverityalertcount: {}
      xdrhostcount: {}
      xdrincidentid: {}
      xdrlowseverityalertcount: {}
      xdrmediumseverityalertcount: {}
      xdrnetworkartifacts: {}
      xdrnotes: {}
      xdrresolvecomment: {}
      xdrstatus: {}
      xdrstatusv2: {}
      xdrurl: {}
      xdrusercount: {}
      zipcode: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 682482db-87c5-4422-823e-d1d5996847cb
      iscommand: true
      name: Set Organization Unit
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 682482db-87c5-4422-823e-d1d5996847cb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1062.5,
          "y": 4210
        }
      }
  "51":
    id: "51"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "53"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Add this discovered asset to Vulnerability Management tools.
      id: 6347173d-39fb-41da-89f5-6c3101a97626
      iscommand: false
      name: Setup Vulnerability Assessment Tool To Scan The Asset
      type: regular
      version: -1
    taskid: 6347173d-39fb-41da-89f5-6c3101a97626
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -590,
          "y": 8020
        }
      }
  "52":
    id: "52"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "51"
      "Yes":
      - "53"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if this system is scanned by Vulnerability Management systems.
      id: 9666af5e-a403-4638-8315-4bb9e2c8155c
      iscommand: false
      name: |-
        Check if the system is scanned by Vulnerability Assessment systems.

        Is this protected?
      type: condition
      version: -1
    taskid: 9666af5e-a403-4638-8315-4bb9e2c8155c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -267.5,
          "y": 7820
        }
      }
  "53":
    id: "53"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "75"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 562517c6-c040-4b9c-88b8-eb86d6211525
      iscommand: false
      name: Done Vulnerability Assessment
      type: title
      version: -1
      description: ''
    taskid: 562517c6-c040-4b9c-88b8-eb86d6211525
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -347.5,
          "y": 9550
        }
      }
  "56":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              simple: incident.expanseassetorganizationunit
          operator: notContainsString
          right:
            value:
              simple: Unknown
      - - left:
            iscontext: true
            value:
              simple: incident.expanseassetorganizationunit
          operator: notContainsString
          right:
            value:
              simple: False Positive
      label: "yes"
    id: "56"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "83"
      "yes":
      - "58"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check the attributed Organization Unit.
      id: 45eea1cc-b700-49ed-8c4a-9d3e7f684f8d
      iscommand: false
      name: Is Asset Organization Unit Known?
      type: condition
      version: -1
    taskid: 45eea1cc-b700-49ed-8c4a-9d3e7f684f8d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 7515
        }
      }
  "58":
    continueonerror: true
    id: "58"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "83"
    note: false
    quietmode: 0
    scriptarguments:
      additionalHeader: {}
      attachCIDs: {}
      attachIDs: {}
      attachNames: {}
      bcc: {}
      body:
        complex:
          root: inputs.OwnerNotificationBody
      cc: {}
      htmlBody: {}
      raw_message: {}
      replyTo: {}
      subject:
        complex:
          root: inputs.OwnerNotificationSubject
      templateParams: {}
      to:
        complex:
          accessor: ExpanseOrganizationUnitsToOwner
          root: lists
          transformers:
          - args:
              field:
                iscontext: true
                value:
                  simple: incident.expanseassetorganizationunit
            operator: getField
          - operator: ParseJSON
          - args:
              field:
                value:
                  simple: email
            operator: getField
      transientFile: {}
      transientFileCID: {}
      transientFileContent: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Send an email
      id: db6ce1c7-c218-46ec-8292-6b1db2411666
      iscommand: true
      name: Notify OU Owner
      script: '|||send-mail'
      type: regular
      version: -1
    taskid: db6ce1c7-c218-46ec-8292-6b1db2411666
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 7755
        }
      }
  "59":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: ShadowITCondition.value
                    operator: isTrue
                root: ShadowITCondition
          operator: isNotEmpty
      label: Possible
    id: "59"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "40"
      Possible:
      - "133"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if the incident is a possible Shadow IT one.
      id: c7180dc0-21ec-4ac7-8797-c6f16922b9fd
      iscommand: false
      name: Check for Possible Shadow IT?
      type: condition
      version: -1
    taskid: c7180dc0-21ec-4ac7-8797-c6f16922b9fd
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1297.5,
          "y": 2370
        }
      }
  "62":
    id: "62"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "154"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3124e0e1-8acb-4799-87c3-6320d1b1a955
      iscommand: false
      name: Shadow IT
      type: title
      version: -1
      description: ''
    taskid: 3124e0e1-8acb-4799-87c3-6320d1b1a955
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1297.5,
          "y": 1450
        }
      }
  "63":
    id: "63"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "68"
      - "69"
      - "70"
      - "108"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 45994c86-fdb8-40f5-8a3f-809735859db9
      iscommand: false
      name: Organization Unit
      type: title
      version: -1
      description: ''
    taskid: 45994c86-fdb8-40f5-8a3f-809735859db9
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1257.5,
          "y": 3015
        }
      }
  "65":
    id: "65"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: IPRangeLowConfidenceTag
      stringify: {}
      value:
        complex:
          root: inputs.IPRangeLowConfidenceTagList
          transformers:
          - args:
              delimiter:
                value:
                  simple: ','
            operator: splitAndTrim
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: bfa306ad-cd4a-4008-8f18-5a03af2d7ab9
      iscommand: false
      name: Extract List of Low Confidence Discovery tags from PB Inputs
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: bfa306ad-cd4a-4008-8f18-5a03af2d7ab9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1327.5,
          "y": -1130
        }
      }
  "66":
    evidencedata:
      customfields: {}
      description:
        simple: Potential PAN-OS Target Device Groups
    id: "66"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "16"
    note: true
    quietmode: 0
    scriptarguments:
      columns: {}
      data:
        complex:
          root: TargetFirewalls
      title:
        simple: Possible target Device Groups for Remediation
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Convert an array to a nice table display. Usually, from the context.
      id: d2ada046-e9ae-453b-881c-f51b62d3742d
      iscommand: false
      name: Print Target Device Group suggestions
      script: ToTable
      type: regular
      version: -1
    taskid: d2ada046-e9ae-453b-881c-f51b62d3742d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2330,
          "y": 7350
        }
      }
  "67":
    id: "67"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "170"
    note: false
    quietmode: 0
    scriptarguments:
      append: {}
      key:
        simple: PanOSDeviceGroups
      stringify: {}
      value:
        complex:
          accessor: "0"
          root: Choose Device Group.Answers
          transformers:
          - operator: LastArrayElement
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: f1b49a6c-3085-40b0-8fc8-ca7672cfcf2c
      iscommand: false
      name: Set Target Device Groups based on user input
      script: Set
      type: regular
      version: -1
    taskid: f1b49a6c-3085-40b0-8fc8-ca7672cfcf2c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2220,
          "y": 8500
        }
      }
  "68":
    id: "68"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "48"
    note: false
    quietmode: 0
    scriptarguments:
      columns: {}
      data:
        complex:
          accessor: AttributionUser
          root: Expanse
          transformers:
          - args:
              applyIfEmpty:
                value:
                  simple: "true"
              defaultValue:
                value:
                  simple: '[]'
            operator: SetIfEmpty
      title:
        simple: List of Users who connected to the asset in the past 7 days
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Convert an array to a nice table display. Usually, from the context.
      id: 81b79dd9-9d97-4dd2-8fb7-bf7e44622a3a
      iscommand: false
      name: Print Target Users suggestions
      script: ToTable
      tags:
      - ExpanseSuggestion
      type: regular
      version: -1
    taskid: 81b79dd9-9d97-4dd2-8fb7-bf7e44622a3a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1062.5,
          "y": 3160
        }
      }
  "69":
    id: "69"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "48"
    note: false
    quietmode: 0
    scriptarguments:
      columns: {}
      data:
        complex:
          accessor: AttributionIP
          root: Expanse
          transformers:
          - args:
              applyIfEmpty:
                value:
                  simple: "true"
              defaultValue:
                value:
                  simple: '[]'
            operator: SetIfEmpty
      title:
        simple: List of Source IP that connected to the asset in the past 7 days
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Convert an array to a nice table display. Usually, from the context.
      id: 9c0fe43b-4ae0-4405-8fb3-db0e3f5deca3
      iscommand: false
      name: Print Target IP suggestions
      script: ToTable
      tags:
      - ExpanseSuggestion
      type: regular
      version: -1
    taskid: 9c0fe43b-4ae0-4405-8fb3-db0e3f5deca3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1502.5,
          "y": 3160
        }
      }
  "70":
    id: "70"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "48"
    note: false
    quietmode: 0
    scriptarguments:
      columns: {}
      data:
        complex:
          accessor: AttributionDevice
          root: Expanse
          transformers:
          - args:
              applyIfEmpty:
                value:
                  simple: "true"
              defaultValue:
                value:
                  simple: '[]'
            operator: SetIfEmpty
      title:
        simple: List of Devices that permitted traffic to asset in the past 7 days
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Convert an array to a nice table display. Usually, from the context.
      id: 642bd438-ba6e-43ed-8e52-1ea22d0e00cd
      iscommand: false
      name: Print Target Devices suggestions
      script: ToTable
      tags:
      - ExpanseSuggestion
      type: regular
      version: -1
    taskid: 642bd438-ba6e-43ed-8e52-1ea22d0e00cd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1922.5,
          "y": 3160
        }
      }
  "73":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expanseshadowit
                root: incident
          operator: isTrue
      label: "yes"
    id: "73"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "86"
      "yes":
      - "177"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if the incident is marked as Shadow IT.
      id: decf423c-a33d-47c8-8e21-522a38157ca1
      iscommand: false
      name: Is this shadow IT?
      type: condition
      version: -1
    taskid: decf423c-a33d-47c8-8e21-522a38157ca1
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 3842.5,
          "y": 8285
        }
      }
  "74":
    id: "74"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "105"
    note: false
    quietmode: 0
    scriptarguments:
      accountid: {}
      accountname: {}
      agentid: {}
      alertid: {}
      alertname: {}
      app: {}
      applicationid: {}
      applicationname: {}
      assetid: {}
      assigneduser: {}
      assignmentgroup: {}
      attachmentcount: {}
      attachmentextension: {}
      attachmenthash: {}
      attachmentid: {}
      attachmentname: {}
      attachmentsize: {}
      attachmenttype: {}
      blockedaction: {}
      bugtraq: {}
      caller: {}
      categorycount: {}
      city: {}
      closetime: {}
      closingreason: {}
      closinguser: {}
      cloudservice: {}
      commandline: {}
      compliancenotes: {}
      costcenter: {}
      costcentercode: {}
      country: {}
      countryname: {}
      criticalassets: {}
      customFields: {}
      cve: {}
      cvss: {}
      cvssavailabilityrequirement: {}
      cvsscollateraldamagepotential: {}
      cvssconfidentialityrequirement: {}
      cvssintegrityrequirement: {}
      dbotprediction: {}
      dbotpredictionprobability: {}
      dbottextsuggestionhighlighted: {}
      department: {}
      dest: {}
      desthostname: {}
      destinationgeolocation: {}
      destinationhostname: {}
      destinationip: {}
      destinationips: {}
      destinationipv6: {}
      destinationmacaddress: {}
      destinationnetwork: {}
      destinationport: {}
      destntdomain: {}
      destos: {}
      details: {}
      detectedexternalhosts: {}
      detectedexternalips: {}
      detectedinternalhosts: {}
      detectedinternalips: {}
      detectedusers: {}
      detectionendtime: {}
      detectionid: {}
      detectionupdatetime: {}
      detectionurl: {}
      deviceexternalip: {}
      devicehash: {}
      devicelocalip: {}
      devicemodel: {}
      devicename: {}
      devicetime: {}
      displayname: {}
      dnsname: {}
      dstports: {}
      duration: {}
      email: {}
      emailauthenticitycheck: {}
      emailbcc: {}
      emailbody: {}
      emailbodyformat: {}
      emailbodyhtml: {}
      emailcc: {}
      emailclassification: {}
      emailclientname: {}
      emailfrom: {}
      emailheaders: {}
      emailhtml: {}
      emailhtmlimage: {}
      emailinreplyto: {}
      emailkeywords: {}
      emaillabels: {}
      emaillatestmessage: {}
      emailmessageid: {}
      emailreceived: {}
      emailreplyto: {}
      emailreturnpath: {}
      emailsenderip: {}
      emailsize: {}
      emailsource: {}
      emailsubject: {}
      emailto: {}
      emailtocount: {}
      emailurlclicked: {}
      employeedisplayname: {}
      employeeemail: {}
      employeemanageremail: {}
      entryIDs: {}
      errorcode: {}
      errormessage: {}
      escalation: {}
      eventaction: {}
      eventdescriptions: {}
      eventid: {}
      eventnames: {}
      events: {}
      eventtype: {}
      expanseactivitystatus: {}
      expanseasset: {}
      expanseassetorganizationunit: {}
      expanseassetowner: {}
      expanseassignee: {}
      expansebusinessunits: {}
      expansecategory: {}
      expansecertificate: {}
      expansecreated: {}
      expansedomain: {}
      expansegeolocation: {}
      expanseinitialevidence: {}
      expanseip: {}
      expanseissueid: {}
      expanseissuetype: {}
      expanselatestevidence: {}
      expanselatestevidencegeolocation: {}
      expansemlfeatures: {}
      expansemodified: {}
      expanseport: {}
      expansepriority: {}
      expanseprogressstatus: {}
      expanseprotocol: {}
      expanseprovider: {}
      expanseregion: {}
      expanseservice: {}
      expanseshadowit: {}
      expansetags: {}
      externaladdresses: {}
      filehash: {}
      filename: {}
      filepath: {}
      filesize: {}
      firstname: {}
      firstseen: {}
      followup: {}
      givenname: {}
      helloworldid: {}
      helloworldstatus: {}
      helloworldtype: {}
      highlevelcategories: {}
      hostname: {}
      incomingmirrorerror: {}
      infectedhosts: {}
      internaladdresses: {}
      investigationstage: {}
      isolated: {}
      jobcode: {}
      jobfamily: {}
      jobfunction: {}
      labels: {}
      lastmodifiedby: {}
      lastmodifiedon: {}
      lastname: {}
      lastseen: {}
      lastupdatetime: {}
      leadership: {}
      listofrulesevent: {}
      location: {}
      locationregion: {}
      logsource: {}
      logsourcename: {}
      logsourcetype: {}
      lowlevelcategoriesevents: {}
      macaddress: {}
      maliciousbehavior: {}
      malwarefamily: {}
      malwarename: {}
      manageremailaddress: {}
      managername: {}
      md5: {}
      mobiledevicemodel: {}
      mobilephone: {}
      name:
        complex:
          accessor: expanseip
          root: incident
          transformers:
          - args:
              prefix:
                value:
                  simple: 'Shadow IT Detected by Expanse on IP: '
              suffix: {}
            operator: concat
      numberoflogsources: {}
      occurred: {}
      os: {}
      osversion: {}
      outgoingmirrorerror: {}
      owner: {}
      parentprocessid: {}
      personalemail: {}
      phase: {}
      phishingsubtype: {}
      phonenumber: {}
      pid: {}
      policydeleted: {}
      policydescription: {}
      policydetails: {}
      policyid: {}
      policyrecommendation: {}
      policyremediable: {}
      policyseverity: {}
      policytype: {}
      postnatdestinationip: {}
      postnatdestinationport: {}
      postnatsourceip: {}
      postnatsourceport: {}
      prenatdestinationport: {}
      prenatsourceip: {}
      prenatsourceport: {}
      prismacloudid: {}
      prismacloudreason: {}
      prismacloudrules: {}
      prismacloudstatus: {}
      prismacloudtime: {}
      protocol: {}
      protocolevent: {}
      protocols: {}
      quarantined: {}
      rating: {}
      rawevent: {}
      region: {}
      regionid: {}
      reporteremailaddress: {}
      resourceapiname: {}
      resourcecloudtype: {}
      resourceid: {}
      resourcename: {}
      resourcetype: {}
      riskrating: {}
      riskscore: {}
      roles: {}
      rrn: {}
      samaccountname: {}
      severity:
        complex:
          accessor: severity
          root: incident
      sha256: {}
      shadowitaccountowneremail: {}
      shadowitaccountownername: {}
      shadowitbilledtocorp: {}
      shadowitcertificate: {}
      shadowitcloudaccountid: {}
      shadowitcloudaccounttype: {}
      shadowitfqdn: {}
      shadowitip: {}
      shadowitorganizationalunit: {}
      shadowitoucontactemail: {}
      shadowitoucontactname: {}
      shadowitport: {}
      shadowitprovider: {}
      shadowitregion: {}
      shadowitrisk: {}
      shadowitsactionedservice: {}
      shadowitsensitivedata: {}
      shadowitservice: {}
      shadowitservicepurpose: {}
      shadowitsource: {}
      shadowitusersuggestions: {}
      shadowusersuggestions: {}
      signature: {}
      skuname: {}
      skutier: {}
      sla: {}
      slaField: {}
      sourcegeolocation: {}
      sourcehostname: {}
      sourceip: {}
      sourceips: {}
      sourceipv6: {}
      sourcemacaddress: {}
      sourcenetwork: {}
      sourceport: {}
      sourceusername: {}
      src: {}
      srchostname: {}
      srcntdomain: {}
      srcos: {}
      srcports: {}
      srcuser: {}
      starttime: {}
      state: {}
      streetaddress: {}
      subcategory: {}
      subscriptionassignedby: {}
      subscriptioncreatedby: {}
      subscriptioncreatedon: {}
      subscriptiondescription: {}
      subscriptionid: {}
      subscriptionname: {}
      subscriptiontype: {}
      subscriptionupdatedby: {}
      subscriptionupdatedon: {}
      subtype: {}
      surname: {}
      systemdefault: {}
      systems: {}
      targetfirewallversion: {}
      technicalowner: {}
      technicalownercontact: {}
      technicaluser: {}
      tenantname: {}
      terminatedaction: {}
      threatactor: {}
      ticketcloseddate: {}
      ticketnumber: {}
      ticketopeneddate: {}
      title: {}
      trafficdirection: {}
      triggeredsecurityprofile: {}
      type:
        complex:
          root: inputs.ShadowITIncidentType
      uniqueports: {}
      urlsslverification: {}
      user: {}
      useraccountcontrol: {}
      userid: {}
      username: {}
      usernames: {}
      vendorid: {}
      vendorproduct: {}
      vpcid: {}
      vulnerabilitycategory: {}
      workphone: {}
      xdralertcount: {}
      xdralerts: {}
      xdrassigneduseremail: {}
      xdrassigneduserprettyname: {}
      xdrdescription: {}
      xdrdetectiontime: {}
      xdrfileartifacts: {}
      xdrhighseverityalertcount: {}
      xdrhostcount: {}
      xdrincidentid: {}
      xdrlowseverityalertcount: {}
      xdrmediumseverityalertcount: {}
      xdrnetworkartifacts: {}
      xdrnotes: {}
      xdrresolvecomment: {}
      xdrstatus: {}
      xdrstatusv2: {}
      xdrurl: {}
      xdrusercount: {}
      zipcode: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.create.inc
      id: e5d6e27e-66cd-4ed0-839b-0fb9dc4590d2
      iscommand: true
      name: Create Shadow IT Incident
      script: Builtin|||createNewIncident
      type: regular
      version: -1
    taskid: e5d6e27e-66cd-4ed0-839b-0fb9dc4590d2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 4610,
          "y": 8690
        }
      }
  "75":
    id: "75"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "76"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 92bf6716-2d49-4a73-8e5f-3a796b282108
      iscommand: false
      name: Close Investigation
      type: title
      version: -1
      description: ''
    taskid: 92bf6716-2d49-4a73-8e5f-3a796b282108
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1287.5,
          "y": 10275
        }
      }
  "76":
    id: "76"
    ignoreworker: false
    nexttasks:
      ✅ Yes:
      - "77"
      ❌ No:
      - "78"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Ask the user whether to close the investigation.
      id: 9947d948-dc9e-448d-8408-e158066026ec
      iscommand: false
      name: Close Investigation?
      type: condition
      version: -1
    taskid: 9947d948-dc9e-448d-8408-e158066026ec
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1287.5,
          "y": 10420
        }
      }
  "77":
    id: "77"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "78"
    note: false
    quietmode: 0
    scriptarguments:
      assetid: {}
      closeNotes: {}
      closeReason: {}
      emailclassification: {}
      id: {}
      incomingmirrorerror: {}
      outgoingmirrorerror: {}
      phishingsubtype: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 483bc19c-4bd7-4915-8930-e6cdc3fa551f
      iscommand: true
      name: Close Investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 483bc19c-4bd7-4915-8930-e6cdc3fa551f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1560,
          "y": 10650
        }
      }
  "78":
    id: "78"
    ignoreworker: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ffdf7bd3-4a7a-41e1-86b5-f429bccd1f06
      iscommand: false
      name: All done
      type: title
      version: -1
      description: ''
    taskid: ffdf7bd3-4a7a-41e1-86b5-f429bccd1f06
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1287.5,
          "y": 10890
        }
      }
  "81":
    id: "81"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "52"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0feb3076-6601-4725-88c7-7884b8b5100f
      iscommand: false
      name: Vulnerability Assessment
      type: title
      version: -1
      description: ''
    taskid: 0feb3076-6601-4725-88c7-7884b8b5100f
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -267.5,
          "y": 7660
        }
      }
  "82":
    id: "82"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "56"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2270c36f-7122-47db-8ae7-05e8ebc51057
      iscommand: false
      name: Notification Flow
      type: title
      version: -1
      description: ''
    taskid: 2270c36f-7122-47db-8ae7-05e8ebc51057
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 7320
        }
      }
  "83":
    id: "83"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "75"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 08333912-5ede-422d-8400-5a258a26509b
      iscommand: false
      name: Done Notification
      type: title
      version: -1
      description: ''
    taskid: 08333912-5ede-422d-8400-5a258a26509b
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 562.5,
          "y": 9550
        }
      }
  "84":
    id: "84"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6bcb7a78-25f8-42c7-8317-8856c7534813
      iscommand: false
      name: Network Remediation
      type: title
      version: -1
      description: ''
    taskid: 6bcb7a78-25f8-42c7-8317-8856c7534813
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1112.5,
          "y": 5840
        }
      }
  "85":
    id: "85"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "73"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8c36ce82-baca-4842-81b0-8fe97ef67d10
      iscommand: false
      name: Shadow IT
      type: title
      version: -1
      description: ''
    taskid: 8c36ce82-baca-4842-81b0-8fe97ef67d10
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 3842.5,
          "y": 8125
        }
      }
  "86":
    id: "86"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "75"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5696f7b5-51e5-476c-8401-fbc0fccef8b5
      iscommand: false
      name: Done Shadow IT
      type: title
      version: -1
      description: ''
    taskid: 5696f7b5-51e5-476c-8401-fbc0fccef8b5
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 3842.5,
          "y": 10000
        }
      }
  "88":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Analysis of Asset Attribution.Answers.0
          operator: containsString
          right:
            value:
              simple: Add New
      label: "yes"
    id: "88"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "49"
      "yes":
      - "89"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determine if a new OU has to be added.
      id: 6701d177-5189-4309-8534-a57371069169
      iscommand: false
      name: Should Add New OU?
      type: condition
      version: -1
    taskid: 6701d177-5189-4309-8534-a57371069169
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1062.5,
          "y": 3510
        }
      }
  "89":
    form:
      description: Specify thew Organization Unit name, name and email of the assets
        owner.
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Organization Unit Name
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: shortText
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "1"
        label: ""
        labelarg:
          simple: Expanse Tag
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: The tag to be used on Expanse to tag assets belonging to this Organization
          Unit
        type: shortText
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "2"
        label: ""
        labelarg:
          simple: Organization Unit Asset Owner Name
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: shortText
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "3"
        label: ""
        labelarg:
          simple: Organization Unit Asset Owner Email
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: shortText
      sender: Your SOC team
      title: Add New Organization Unit
      totalanswers: 0
    id: "89"
    ignoreworker: false
    message:
      bcc:
      body:
        simple: Add New OU
      cc:
      format: ""
      methods: []
      subject:
      timings:
        completeafterreplies: 1
        retriescount: 2
        retriesinterval: 360
      to:
    nexttasks:
      '#none#':
      - "90"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Collect new OU details from the user.
      id: 43a719a2-eac2-4540-8917-8fabf478067a
      iscommand: false
      name: Add New OU
      type: collection
      version: -1
    taskid: 43a719a2-eac2-4540-8917-8fabf478067a
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 1492.5,
          "y": 3685
        }
      }
  "90":
    id: "90"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "94"
    note: false
    quietmode: 0
    scriptarguments:
      allowDups: {}
      append:
        simple: "true"
      keyName:
        complex:
          accessor: "0"
          root: Add New Organization Unit.Answers
      listName:
        simple: ExpanseOrganizationUnitsToOwner
      value:
        complex:
          accessor: "2"
          root: Add New Organization Unit.Answers
          transformers:
          - args:
              prefix:
                value:
                  simple: '{"name": "'
              suffix:
                value:
                  simple: '", "email": "'
            operator: concat
          - args:
              prefix: {}
              suffix:
                iscontext: true
                value:
                  simple: Add New Organization Unit.Answers.3
            operator: concat
          - args:
              prefix: {}
              suffix:
                value:
                  simple: '"}'
            operator: concat
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Adds/Replaces a key in key/value store backed by an XSOAR list.
      id: 70289222-7dc2-4590-88cf-2f597fcb64c6
      iscommand: false
      name: Save New Organization Unit to List
      script: AddKeyToList
      type: regular
      version: -1
    taskid: 70289222-7dc2-4590-88cf-2f597fcb64c6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1492.5,
          "y": 3860
        }
      }
  "91":
    id: "91"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "93"
    note: false
    quietmode: 0
    scriptarguments:
      accountid: {}
      accountname: {}
      addLabels: {}
      agentid: {}
      app: {}
      appendMultiSelect: {}
      assetid: {}
      assigneduser: {}
      assignmentgroup: {}
      attachmentcount: {}
      attachmentextension: {}
      attachmenthash: {}
      attachmentid: {}
      attachmentname: {}
      attachmentsize: {}
      attachmenttype: {}
      blockedaction: {}
      bugtraq: {}
      caller: {}
      city: {}
      closeNotes: {}
      closeReason: {}
      cloudservice: {}
      commandline: {}
      costcenter: {}
      costcentercode: {}
      country: {}
      countryname: {}
      criticalassets: {}
      customFields: {}
      cve: {}
      cvss: {}
      dbotMirrorDirection: {}
      dbotMirrorId: {}
      dbotMirrorInstance: {}
      dbotMirrorTags: {}
      dbotprediction: {}
      dbotpredictionprobability: {}
      dbottextsuggestionhighlighted: {}
      deleteEmptyField: {}
      department: {}
      dest: {}
      desthostname: {}
      destinationhostname: {}
      destinationip: {}
      destinationnetwork: {}
      destinationport: {}
      destntdomain: {}
      destos: {}
      details: {}
      detectedexternalhosts: {}
      detectedexternalips: {}
      detectedinternalhosts: {}
      detectedinternalips: {}
      detectedusers: {}
      detectionendtime: {}
      detectionid: {}
      detectionupdatetime: {}
      detectionurl: {}
      deviceexternalip: {}
      devicehash: {}
      devicelocalip: {}
      devicemodel: {}
      devicename: {}
      displayname: {}
      duration: {}
      email: {}
      emailauthenticitycheck: {}
      emailbcc: {}
      emailbody: {}
      emailbodyformat: {}
      emailbodyhtml: {}
      emailcc: {}
      emailclassification: {}
      emailclientname: {}
      emailfrom: {}
      emailheaders: {}
      emailhtml: {}
      emailinreplyto: {}
      emailkeywords: {}
      emailmessageid: {}
      emailreceived: {}
      emailreplyto: {}
      emailreturnpath: {}
      emailsenderip: {}
      emailsize: {}
      emailsource: {}
      emailsubject: {}
      emailto: {}
      emailtocount: {}
      emailurlclicked: {}
      employeedisplayname: {}
      employeeemail: {}
      employeemanageremail: {}
      escalation: {}
      eventaction: {}
      eventid: {}
      eventtype: {}
      expanseactivitystatus: {}
      expanseasset: {}
      expanseassetorganizationunit:
        complex:
          accessor: "0"
          root: Add New Organization Unit.Answers
          transformers:
          - operator: FirstArrayElement
      expanseassetowner: {}
      expanseassignee: {}
      expansebusinessunits: {}
      expansecategory: {}
      expansecertificate: {}
      expansecreated: {}
      expansedomain: {}
      expanseinitialevidence: {}
      expanseip: {}
      expanseissueid: {}
      expanseissuetype: {}
      expanselatestevidence: {}
      expansemodified: {}
      expanseport: {}
      expansepriority: {}
      expanseprogressstatus: {}
      expanseprotocol: {}
      expanseprovider: {}
      expanseshadowit: {}
      expansetags: {}
      externaladdresses: {}
      filehash: {}
      filename: {}
      filepath: {}
      filesize: {}
      firstname: {}
      firstseen: {}
      givenname: {}
      helloworldid: {}
      helloworldstatus: {}
      helloworldtype: {}
      hostname: {}
      id: {}
      incomingmirrorerror: {}
      infectedhosts: {}
      internaladdresses: {}
      investigationstage: {}
      isolated: {}
      jobcode: {}
      jobfamily: {}
      jobfunction: {}
      labels: {}
      lastmodifiedby: {}
      lastmodifiedon: {}
      lastname: {}
      lastseen: {}
      leadership: {}
      location: {}
      locationregion: {}
      logsource: {}
      macaddress: {}
      maliciousbehavior: {}
      malwarefamily: {}
      malwarename: {}
      manageremailaddress: {}
      managername: {}
      md5: {}
      mobiledevicemodel: {}
      mobilephone: {}
      name: {}
      occurred: {}
      os: {}
      osversion: {}
      outgoingmirrorerror: {}
      owner: {}
      parentprocessid: {}
      personalemail: {}
      phase: {}
      phishingsubtype: {}
      phonenumber: {}
      pid: {}
      policydeleted: {}
      policydescription: {}
      policydetails: {}
      policyid: {}
      policyrecommendation: {}
      policyremediable: {}
      policyseverity: {}
      policytype: {}
      prismacloudid: {}
      prismacloudreason: {}
      prismacloudrules: {}
      prismacloudstatus: {}
      prismacloudtime: {}
      protocol: {}
      protocols: {}
      quarantined: {}
      rating: {}
      region: {}
      regionid: {}
      replacePlaybook: {}
      reporteremailaddress: {}
      resourceapiname: {}
      resourcecloudtype: {}
      resourceid: {}
      resourcename: {}
      resourcetype: {}
      riskrating: {}
      riskscore: {}
      roles: {}
      rrn: {}
      samaccountname: {}
      severity: {}
      sha256: {}
      signature: {}
      skuname: {}
      skutier: {}
      sla: {}
      slaField: {}
      sourcehostname: {}
      sourceip: {}
      sourcenetwork: {}
      sourceport: {}
      sourceusername: {}
      src: {}
      srchostname: {}
      srcntdomain: {}
      srcos: {}
      srcuser: {}
      state: {}
      streetaddress: {}
      subcategory: {}
      subscriptionassignedby: {}
      subscriptioncreatedby: {}
      subscriptioncreatedon: {}
      subscriptiondescription: {}
      subscriptionid: {}
      subscriptionname: {}
      subscriptiontype: {}
      subscriptionupdatedby: {}
      subscriptionupdatedon: {}
      subtype: {}
      surname: {}
      systemdefault: {}
      systems: {}
      targetfirewallversion: {}
      tenantname: {}
      terminatedaction: {}
      threatactor: {}
      ticketcloseddate: {}
      ticketnumber: {}
      ticketopeneddate: {}
      title: {}
      triggeredsecurityprofile: {}
      type: {}
      uniqueports: {}
      urlsslverification: {}
      user: {}
      useraccountcontrol: {}
      username: {}
      vendorid: {}
      vendorproduct: {}
      vpcid: {}
      vulnerabilitycategory: {}
      workphone: {}
      xdralertcount: {}
      xdralerts: {}
      xdrassigneduseremail: {}
      xdrassigneduserprettyname: {}
      xdrdescription: {}
      xdrdetectiontime: {}
      xdrfileartifacts: {}
      xdrhighseverityalertcount: {}
      xdrhostcount: {}
      xdrincidentid: {}
      xdrlowseverityalertcount: {}
      xdrmediumseverityalertcount: {}
      xdrnetworkartifacts: {}
      xdrnotes: {}
      xdrresolvecomment: {}
      xdrstatus: {}
      xdrstatusv2: {}
      xdrurl: {}
      xdrusercount: {}
      zipcode: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: fc957bba-2273-413a-8311-e4998e32eeef
      iscommand: true
      name: Set Organization Unit
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: fc957bba-2273-413a-8311-e4998e32eeef
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1492.5,
          "y": 4210
        }
      }
  "93":
    id: "93"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "85"
      - "165"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2f7dea43-1ac4-4370-8e6f-3e5115c9e33e
      iscommand: false
      name: Done Organization Unit
      type: title
      version: -1
      description: ''
    taskid: 2f7dea43-1ac4-4370-8e6f-3e5115c9e33e
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1257.5,
          "y": 4385
        }
      }
  "94":
    id: "94"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "91"
    note: false
    quietmode: 0
    scriptarguments:
      allowDups: {}
      append:
        simple: "false"
      keyName:
        complex:
          accessor: "0"
          root: Add New Organization Unit.Answers
      listName:
        simple: ExpanseOrganizationUnitsToTag
      value:
        complex:
          accessor: "1"
          root: Add New Organization Unit.Answers
          transformers:
          - args:
              prefix:
                value:
                  simple: ou-
              suffix: {}
            operator: concat
          - args:
              prefix:
                iscontext: true
                value:
                  simple: inputs.TagPrefix
              suffix: {}
            operator: concat
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Adds/Replaces a key in key/value store backed by an XSOAR list.
      id: fea97f7c-e3fd-4230-86f9-4a87f508529f
      iscommand: false
      name: Save New Organization Tag to List
      script: AddKeyToList
      type: regular
      version: -1
    taskid: fea97f7c-e3fd-4230-86f9-4a87f508529f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1492.5,
          "y": 4035
        }
      }
  "95":
    id: "95"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "99"
    note: false
    quietmode: 0
    scriptarguments:
      description:
        simple: Created by XSOAR for Organization Unit tagging
      name:
        complex:
          root: AssetTag
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Create a new tag in Expanse.
      id: e5fc9a63-8d4a-4cc6-84ea-b50f56b319e3
      iscommand: true
      name: Create Tag in Expanse (if it doesn't exist already)
      script: '|||expanse-create-tag'
      type: regular
      version: -1
    taskid: e5fc9a63-8d4a-4cc6-84ea-b50f56b319e3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -80,
          "y": 5240
        }
      }
  "96":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: ExpanseOrganizationUnitsToTag
                root: lists
                transformers:
                - args:
                    field:
                      iscontext: true
                      value:
                        simple: incident.expanseassetorganizationunit
                  operator: getField
                - args:
                    applyIfEmpty: {}
                    defaultValue:
                      value:
                        simple: '**NoTag**'
                  operator: SetIfEmpty
          operator: isNotEqualString
          right:
            value:
              simple: '**NoTag**'
      label: known-ou
    - condition:
      - - left:
            iscontext: true
            value:
              simple: incident.expanseassetorganizationunit
          operator: containsString
          right:
            value:
              simple: False Positive
      label: false-positive
    id: "96"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "166"
      false-positive:
      - "104"
      known-ou:
      - "103"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Branch depending on the OU.
      id: d7c4ac50-0f74-4a49-8cc1-47eb8ab3aab9
      iscommand: false
      name: Do We Have Tag To Use?
      type: condition
      version: -1
    taskid: d7c4ac50-0f74-4a49-8cc1-47eb8ab3aab9
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 300,
          "y": 4840
        }
      }
  "99":
    continueonerror: true
    id: "99"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "175"
    note: false
    quietmode: 0
    scriptarguments:
      asset_id:
        complex:
          accessor: id
          root: incident.expanseasset
      asset_type:
        complex:
          accessor: assettype
          root: incident.expanseasset
      tagnames:
        complex:
          root: AssetTag
      tags: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Assign tags to Asset.
      id: 038b0eef-5ac9-459a-83cf-9ced81216801
      iscommand: true
      name: Tag Assets on Expanse with AssetTag
      script: '|||expanse-assign-tags-to-asset'
      type: regular
      version: -1
    taskid: 038b0eef-5ac9-459a-83cf-9ced81216801
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -80,
          "y": 5395
        }
      }
  "103":
    id: "103"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "95"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: AssetTag
      stringify: {}
      value:
        complex:
          accessor: ExpanseOrganizationUnitsToTag
          root: lists
          transformers:
          - args:
              field:
                iscontext: true
                value:
                  simple: incident.expanseassetorganizationunit
            operator: getField
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 05965a20-e981-4b50-8ff8-1c354c42ef05
      iscommand: false
      name: Set AssetTag with Known OU Tag
      script: Set
      type: regular
      version: -1
    taskid: 05965a20-e981-4b50-8ff8-1c354c42ef05
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 170,
          "y": 5060
        }
      }
  "104":
    id: "104"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "95"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: AssetTag
      stringify: {}
      value:
        simple: ${inputs.FalsePositiveTag}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 231519d4-42e0-45cb-88ce-005ffdb706b7
      iscommand: false
      name: Set AssetTag with False Positive Tag from Inputs
      script: Set
      type: regular
      version: -1
    taskid: 231519d4-42e0-45cb-88ce-005ffdb706b7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -267.5,
          "y": 5060
        }
      }
  "105":
    id: "105"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "179"
    note: false
    quietmode: 0
    scriptarguments:
      action:
        simple: link
      incidentId: {}
      linkedIncidentIDs:
        complex:
          root: CreatedIncidentID
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.linkIncidents
      id: 258088c9-b692-40c4-87c7-015f030792f1
      iscommand: true
      name: Link Incidents
      script: Builtin|||linkIncidents
      type: regular
      version: -1
    taskid: 258088c9-b692-40c4-87c7-015f030792f1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 4610,
          "y": 8875
        }
      }
  "106":
    id: "106"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "86"
    note: false
    quietmode: 0
    scriptarguments:
      tags:
        simple: ExpanseSuggestion
      target_incident:
        complex:
          root: CreatedIncidentID
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Copy notes from current incident to a remote incident
      id: 04d3f02a-bf86-44a4-826b-367e6c776106
      iscommand: false
      name: Copy Suggestion Notes to Created Incident
      script: CopyNotesToIncident
      type: regular
      version: -1
    taskid: 04d3f02a-bf86-44a4-826b-367e6c776106
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 4610,
          "y": 9305
        }
      }
  "108":
    id: "108"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "48"
    note: false
    quietmode: 0
    scriptarguments:
      columns: {}
      data:
        complex:
          accessor: Attribution
          root: PrismaCloud
          transformers:
          - args:
              applyIfEmpty:
                value:
                  simple: "true"
              defaultValue:
                value:
                  simple: '[]'
            operator: SetIfEmpty
      title:
        simple: List of related assets discovered in Prisma Cloud
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Convert an array to a nice table display. Usually, from the context.
      id: 041ae5c1-5754-451d-873a-3cf22bf885b6
      iscommand: false
      name: Print Prisma Cloud suggestions
      script: ToTable
      tags:
      - ExpanseSuggestion
      type: regular
      version: -1
    taskid: 041ae5c1-5754-451d-873a-3cf22bf885b6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2350,
          "y": 3160
        }
      }
  "109":
    id: "109"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "110"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 230dec87-d76a-4c0a-83f3-020901fafd7f
      iscommand: false
      name: Prisma Cloud Alert Detection
      type: title
      version: -1
      description: ''
    taskid: 230dec87-d76a-4c0a-83f3-020901fafd7f
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -1180,
          "y": 5860
        }
      }
  "110":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Attribution
                root: PrismaCloud
          operator: isNotEmpty
      label: "yes"
    id: "110"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "111"
      "yes":
      - "172"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether assets are found in Prisma Cloud
      id: cd6f343a-41dc-45fb-85c3-6df7281e2310
      iscommand: false
      name: Are assets in Prisma Cloud found?
      type: condition
      version: -1
    taskid: cd6f343a-41dc-45fb-85c3-6df7281e2310
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1180,
          "y": 6130
        }
      }
  "111":
    id: "111"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "75"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 160206c9-fa11-4203-8072-da610a935176
      iscommand: false
      name: Done Prisma Cloud Alert Detection
      type: title
      version: -1
      description: ''
    taskid: 160206c9-fa11-4203-8072-da610a935176
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -1180,
          "y": 9555
        }
      }
  "116":
    id: "116"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "170"
    note: false
    quietmode: 0
    scriptarguments:
      description:
        simple: Created by XSOAR for Device Group tagging
      name:
        complex:
          root: NewDGTagName
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Create a new tag in Expanse.
      id: 43bedabd-3128-4afd-8e33-243fa8e7fb57
      iscommand: true
      name: Create DG Tag in Expanse (if it doesn't already exist)
      script: '|||expanse-create-tag'
      type: regular
      version: -1
    taskid: 43bedabd-3128-4afd-8e33-243fa8e7fb57
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2540,
          "y": 8670
        }
      }
  "117":
    continueonerror: true
    id: "117"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "121"
    note: false
    quietmode: 0
    scriptarguments:
      asset_id:
        complex:
          accessor: id
          root: incident.expanseasset
      asset_type:
        complex:
          accessor: assettype
          root: incident.expanseasset
      tagnames:
        complex:
          root: NewDGTagName
      tags: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Assign tags to Asset.
      id: 0ef176b7-0737-4f6b-8231-bf9ec00db8a1
      iscommand: true
      name: Tag Assets on Expanse
      script: '|||expanse-assign-tags-to-asset'
      type: regular
      version: -1
    taskid: 0ef176b7-0737-4f6b-8231-bf9ec00db8a1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2160,
          "y": 8970
        }
      }
  "118":
    id: "118"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "169"
    note: false
    quietmode: 0
    scriptarguments:
      allowDups: {}
      append:
        simple: "false"
      keyName:
        complex:
          root: NewDGTagName
      listName:
        complex:
          root: inputs.FirewallTagListName
      value:
        complex:
          accessor: "0"
          root: Choose Device Group Name and Tag.Answers
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Adds/Replaces a key in key/value store backed by an XSOAR list.
      id: 8074da38-bedd-4b98-8a07-9650238507ec
      iscommand: false
      name: Save DG Tag to List
      script: AddKeyToList
      type: regular
      version: -1
    taskid: 8074da38-bedd-4b98-8a07-9650238507ec
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2752.5,
          "y": 8355
        }
      }
  "119":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Choose Device Group.Answers
          operator: containsString
          right:
            value:
              simple: Add New
      label: ADD-NEW
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Choose Device Group.Answers
          operator: containsString
          right:
            value:
              simple: Manual Configuration
      label: MANUAL
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Choose Device Group.Answers
          operator: containsString
          right:
            value:
              simple: Firewall Only (No Panorama)
      label: NO-PANORAMA
    id: "119"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "67"
      ADD-NEW:
      - "18"
      MANUAL:
      - "14"
      NO-PANORAMA:
      - "10"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determine the target Device Group
      id: dd1b5382-e04a-4543-8c47-2d8100ada9e6
      iscommand: false
      name: Determine Target
      type: condition
      version: -1
    taskid: dd1b5382-e04a-4543-8c47-2d8100ada9e6
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2055,
          "y": 7690
        }
      }
  "120":
    form:
      description: Insert Device Group name to enforce this policy, and the corresponding
        tag to attach to the asset
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Insert Device Group Name
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: The Device Group must be managed by Panorama
        type: shortText
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "1"
        label: ""
        labelarg:
          simple: Insert Expanse Tag (without prefix)
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: The tag name will be added to the Expanse assets (prefix will be
          added automatically)
        type: shortText
      sender: ""
      title: Choose Device Group Name and Tag
      totalanswers: 0
    id: "120"
    ignoreworker: false
    message:
      bcc:
      body:
        simple: Select Device Group Name and Tag
      cc:
      format: ""
      methods: []
      subject:
        simple: Select Device Group Name and Tag
      timings:
        completeafterreplies: 1
        retriescount: 2
        retriesinterval: 360
      to:
        simple: Analyst
    nexttasks:
      '#none#':
      - "137"
      - "140"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Collect Device Group information from user.
      id: 1db6d6a8-9dff-41d9-894c-ca85bbd8553c
      iscommand: false
      name: Insert Device Group name and tag
      type: collection
      version: -1
    taskid: 1db6d6a8-9dff-41d9-894c-ca85bbd8553c
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 2752.5,
          "y": 8045
        }
      }
  "121":
    id: "121"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "174"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |
        Script to refresh tags and attribution reasons of assets inside Expanse Issue. The script should be used inside the Expanse Issue incident context.
      id: a8149cda-4618-48c0-8cac-2d789c8cb11a
      iscommand: false
      name: Refresh Assets
      script: ExpanseRefreshIssueAssets
      type: regular
      version: -1
    taskid: a8149cda-4618-48c0-8cac-2d789c8cb11a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2752.5,
          "y": 9000
        }
      }
  "122":
    id: "122"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "123"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: ExpanseAllAssetTags
      stringify: {}
      value:
        complex:
          accessor: tags
          root: incident.expanseasset
          transformers:
          - args:
              delimiter:
                value:
                  simple: \n
            operator: split
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: 1613ccf6-4b01-4e3a-8e14-16ea02937fcb
      iscommand: false
      name: Extract All Asset Tags from Expanse
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 1613ccf6-4b01-4e3a-8e14-16ea02937fcb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": -1130
        }
      }
  "123":
    id: "123"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: ExpanseXSOARAssetTags
      stringify: {}
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ExpanseAllAssetTags
              operator: startWith
              right:
                iscontext: true
                value:
                  simple: inputs.TagPrefix
          root: ExpanseAllAssetTags
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: 48d7206e-c1ce-4886-8781-c81b5c71f30d
      iscommand: false
      name: Extract only XSOAR-related Asset Tags
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 48d7206e-c1ce-4886-8781-c81b5c71f30d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": -950
        }
      }
  "124":
    id: "124"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "125"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: XSOARTagDGPrefix
      stringify: {}
      value:
        complex:
          root: inputs.TagPrefix
          transformers:
          - args:
              prefix: {}
              suffix:
                value:
                  simple: dg-
            operator: concat
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 20436b5f-3316-4c72-8bf0-60e5853c5412
      iscommand: false
      name: Set Device Group Tag Prefix
      script: Set
      type: regular
      version: -1
    taskid: 20436b5f-3316-4c72-8bf0-60e5853c5412
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1960,
          "y": 6360
        }
      }
  "125":
    id: "125"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: ExpanseDeviceGroupAssetTags
      stringify: {}
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: ExpanseXSOARAssetTags
              operator: startWith
              right:
                iscontext: true
                value:
                  simple: XSOARTagDGPrefix
          root: ExpanseXSOARAssetTags
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: 7ba7664e-7cd1-4820-87b1-628927a88422
      iscommand: false
      name: Find Device Group Tags
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 7ba7664e-7cd1-4820-87b1-628927a88422
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1960,
          "y": 6520
        }
      }
  "133":
    id: "133"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "158"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: SuggestedShadowITAnswer
      stringify: {}
      value:
        simple: "No"
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Set a value in context under the key you entered.
      id: 6d4ffb2f-c96d-47e8-8e85-ffe65d6c027a
      iscommand: false
      name: Suggest No Shadow IT
      script: Set
      type: regular
      version: -1
    taskid: 6d4ffb2f-c96d-47e8-8e85-ffe65d6c027a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1677.5,
          "y": 2605
        }
      }
  "135":
    id: "135"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "93"
    note: false
    quietmode: 0
    scriptarguments:
      accountid: {}
      accountname: {}
      addLabels: {}
      agentid: {}
      app: {}
      appendMultiSelect: {}
      assetid: {}
      assigneduser: {}
      assignmentgroup: {}
      attachmentcount: {}
      attachmentextension: {}
      attachmenthash: {}
      attachmentid: {}
      attachmentname: {}
      attachmentsize: {}
      attachmenttype: {}
      blockedaction: {}
      bugtraq: {}
      caller: {}
      city: {}
      closeNotes: {}
      closeReason: {}
      cloudservice: {}
      commandline: {}
      costcenter: {}
      costcentercode: {}
      country: {}
      countryname: {}
      criticalassets: {}
      customFields: {}
      cve: {}
      cvss: {}
      dbotMirrorDirection: {}
      dbotMirrorId: {}
      dbotMirrorInstance: {}
      dbotMirrorTags: {}
      dbotprediction: {}
      dbotpredictionprobability: {}
      dbottextsuggestionhighlighted: {}
      deleteEmptyField: {}
      department: {}
      dest: {}
      desthostname: {}
      destinationhostname: {}
      destinationip: {}
      destinationnetwork: {}
      destinationport: {}
      destntdomain: {}
      destos: {}
      details: {}
      detectedexternalhosts: {}
      detectedexternalips: {}
      detectedinternalhosts: {}
      detectedinternalips: {}
      detectedusers: {}
      detectionendtime: {}
      detectionid: {}
      detectionupdatetime: {}
      detectionurl: {}
      deviceexternalip: {}
      devicehash: {}
      devicelocalip: {}
      devicemodel: {}
      devicename: {}
      displayname: {}
      duration: {}
      email: {}
      emailauthenticitycheck: {}
      emailbcc: {}
      emailbody: {}
      emailbodyformat: {}
      emailbodyhtml: {}
      emailcc: {}
      emailclassification: {}
      emailclientname: {}
      emailfrom: {}
      emailheaders: {}
      emailhtml: {}
      emailinreplyto: {}
      emailkeywords: {}
      emailmessageid: {}
      emailreceived: {}
      emailreplyto: {}
      emailreturnpath: {}
      emailsenderip: {}
      emailsize: {}
      emailsource: {}
      emailsubject: {}
      emailto: {}
      emailtocount: {}
      emailurlclicked: {}
      employeedisplayname: {}
      employeeemail: {}
      employeemanageremail: {}
      escalation: {}
      eventaction: {}
      eventid: {}
      eventtype: {}
      expanseactivitystatus: {}
      expanseasset: {}
      expanseassetorganizationunit: {}
      expanseassetowner: {}
      expanseassignee: {}
      expansebusinessunits: {}
      expansecategory: {}
      expansecertificate: {}
      expansecreated: {}
      expansedomain: {}
      expanseinitialevidence: {}
      expanseip: {}
      expanseissueid: {}
      expanseissuetype: {}
      expanselatestevidence: {}
      expansemodified: {}
      expanseport: {}
      expansepriority: {}
      expanseprogressstatus: {}
      expanseprotocol: {}
      expanseprovider: {}
      expanseshadowit:
        complex:
          accessor: "1"
          root: Analysis of Asset Attribution.Answers
          transformers:
          - args:
              else:
                value:
                  simple: "false"
              equals:
                value:
                  simple: "Yes"
              then:
                value:
                  simple: "true"
            operator: If-Then-Else
      expansetags: {}
      externaladdresses: {}
      filehash: {}
      filename: {}
      filepath: {}
      filesize: {}
      firstname: {}
      firstseen: {}
      givenname: {}
      helloworldid: {}
      helloworldstatus: {}
      helloworldtype: {}
      hostname: {}
      id: {}
      incomingmirrorerror: {}
      infectedhosts: {}
      internaladdresses: {}
      investigationstage: {}
      isolated: {}
      jobcode: {}
      jobfamily: {}
      jobfunction: {}
      labels: {}
      lastmodifiedby: {}
      lastmodifiedon: {}
      lastname: {}
      lastseen: {}
      leadership: {}
      location: {}
      locationregion: {}
      logsource: {}
      macaddress: {}
      maliciousbehavior: {}
      malwarefamily: {}
      malwarename: {}
      manageremailaddress: {}
      managername: {}
      md5: {}
      mobiledevicemodel: {}
      mobilephone: {}
      name: {}
      occurred: {}
      os: {}
      osversion: {}
      outgoingmirrorerror: {}
      owner: {}
      parentprocessid: {}
      personalemail: {}
      phase: {}
      phishingsubtype: {}
      phonenumber: {}
      pid: {}
      policydeleted: {}
      policydescription: {}
      policydetails: {}
      policyid: {}
      policyrecommendation: {}
      policyremediable: {}
      policyseverity: {}
      policytype: {}
      prismacloudid: {}
      prismacloudreason: {}
      prismacloudrules: {}
      prismacloudstatus: {}
      prismacloudtime: {}
      protocol: {}
      protocols: {}
      quarantined: {}
      rating: {}
      region: {}
      regionid: {}
      replacePlaybook: {}
      reporteremailaddress: {}
      resourceapiname: {}
      resourcecloudtype: {}
      resourceid: {}
      resourcename: {}
      resourcetype: {}
      riskrating: {}
      riskscore: {}
      roles: {}
      rrn: {}
      samaccountname: {}
      severity: {}
      sha256: {}
      shadowitaccountowneremail: {}
      shadowitaccountownername: {}
      shadowitbilledtocorp: {}
      shadowitcertificate: {}
      shadowitcloudaccountid: {}
      shadowitcloudaccounttype: {}
      shadowitfqdn: {}
      shadowitip: {}
      shadowitorganizationalunit: {}
      shadowitoucontactemail: {}
      shadowitoucontactname: {}
      shadowitport: {}
      shadowitprovider: {}
      shadowitrisk: {}
      shadowitsactionedservice: {}
      shadowitsource: {}
      shadowusersuggestions: {}
      signature: {}
      skuname: {}
      skutier: {}
      sla: {}
      slaField: {}
      sourcehostname: {}
      sourceip: {}
      sourcenetwork: {}
      sourceport: {}
      sourceusername: {}
      src: {}
      srchostname: {}
      srcntdomain: {}
      srcos: {}
      srcuser: {}
      state: {}
      streetaddress: {}
      subcategory: {}
      subscriptionassignedby: {}
      subscriptioncreatedby: {}
      subscriptioncreatedon: {}
      subscriptiondescription: {}
      subscriptionid: {}
      subscriptionname: {}
      subscriptiontype: {}
      subscriptionupdatedby: {}
      subscriptionupdatedon: {}
      subtype: {}
      surname: {}
      systemdefault: {}
      systems: {}
      targetfirewallversion: {}
      tenantname: {}
      terminatedaction: {}
      threatactor: {}
      ticketcloseddate: {}
      ticketnumber: {}
      ticketopeneddate: {}
      title: {}
      triggeredsecurityprofile: {}
      type: {}
      uniqueports: {}
      urlsslverification: {}
      user: {}
      useraccountcontrol: {}
      username: {}
      vendorid: {}
      vendorproduct: {}
      vpcid: {}
      vulnerabilitycategory: {}
      workphone: {}
      xdralertcount: {}
      xdralerts: {}
      xdrassigneduseremail: {}
      xdrassigneduserprettyname: {}
      xdrdescription: {}
      xdrdetectiontime: {}
      xdrfileartifacts: {}
      xdrhighseverityalertcount: {}
      xdrhostcount: {}
      xdrincidentid: {}
      xdrlowseverityalertcount: {}
      xdrmediumseverityalertcount: {}
      xdrnetworkartifacts: {}
      xdrnotes: {}
      xdrresolvecomment: {}
      xdrstatus: {}
      xdrstatusv2: {}
      xdrurl: {}
      xdrusercount: {}
      zipcode: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: fe93c307-6a19-44be-8f45-556b3364c582
      iscommand: true
      name: Set Shadow IT flag based on User response
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: fe93c307-6a19-44be-8f45-556b3364c582
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 650,
          "y": 4210
        }
      }
  "136":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: "1"
                root: Analysis of Asset Attribution.Answers
          operator: notContainsString
          right:
            value:
              simple: Undecided
      label: "yes"
    id: "136"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "93"
      "yes":
      - "135"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether user answered to the Shadow IT question.
      id: a3aae37e-afae-413a-8861-d688af288b1b
      iscommand: false
      name: Did User reply to the Shadow IT question?
      type: condition
      version: -1
    taskid: a3aae37e-afae-413a-8861-d688af288b1b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 297.5,
          "y": 3510
        }
      }
  "137":
    id: "137"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "121"
    note: false
    quietmode: 0
    scriptarguments:
      append: {}
      key:
        simple: PanOSDeviceGroups
      stringify: {}
      value:
        complex:
          accessor: "0"
          root: Choose Device Group Name and Tag.Answers
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 3d1e9309-7760-4e53-89e3-99aabf93035c
      iscommand: false
      name: Set Target Device Groups based on user input
      script: Set
      type: regular
      version: -1
    taskid: 3d1e9309-7760-4e53-89e3-99aabf93035c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 3360,
          "y": 8220
        }
      }
  "138":
    id: "138"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "139"
    note: false
    quietmode: 0
    scriptarguments:
      extend-context:
        simple: FirewallTagListText=
      ignore-outputs:
        simple: "true"
      listName:
        complex:
          root: inputs.FirewallTagListName
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.get
      id: 048b8ef2-811f-410c-88b5-5b6ba0b0abe3
      iscommand: true
      name: Load Firewall Tag List
      script: Builtin|||getList
      type: regular
      version: -1
    taskid: 048b8ef2-811f-410c-88b5-5b6ba0b0abe3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1755,
          "y": -1305
        }
      }
  "139":
    id: "139"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      append: {}
      key:
        simple: FirewallTagList
      stringify: {}
      value:
        complex:
          root: FirewallTagListText
          transformers:
          - operator: ParseJSON
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: d35a6501-f799-411f-81b7-d9925279fe3a
      iscommand: false
      name: Parse Firewall Tag List
      script: Set
      type: regular
      version: -1
    taskid: d35a6501-f799-411f-81b7-d9925279fe3a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1755,
          "y": -1130
        }
      }
  "140":
    id: "140"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "118"
    note: false
    quietmode: 0
    scriptarguments:
      append: {}
      key:
        simple: NewDGTagName
      stringify: {}
      value:
        complex:
          accessor: "1"
          root: Choose Device Group Name and Tag.Answers
          transformers:
          - args:
              prefix:
                value:
                  simple: dg-
              suffix: {}
            operator: concat
          - args:
              prefix:
                iscontext: true
                value:
                  simple: inputs.TagPrefix
              suffix: {}
            operator: concat
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: dae8b180-0072-417a-892b-352c9c0b6dcf
      iscommand: false
      name: Set New DG Tag Name
      script: Set
      type: regular
      version: -1
    taskid: dae8b180-0072-417a-892b-352c9c0b6dcf
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2752.5,
          "y": 8220
        }
      }
  "141":
    evidencedata:
      customfields: {}
      description:
        simple: Issue Comments in Expanse
    id: "141"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "29"
    note: true
    quietmode: 0
    scriptarguments:
      created_after: {}
      issue_id:
        complex:
          accessor: expanseissueid
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Retrieve issue comments (subset of updates)
      id: da3d20ee-3185-40ea-869b-e0bd1bdb3f7e
      iscommand: true
      name: Get Expanse Comments
      script: '|||expanse-get-issue-comments'
      type: regular
      version: -1
    taskid: da3d20ee-3185-40ea-869b-e0bd1bdb3f7e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1070,
          "y": -460
        }
      }
  "147":
    id: "147"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "62"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e45683cf-6336-41b1-867d-adaee3cdac35
      iscommand: false
      name: Done Public Cloud Enrichment
      type: title
      version: -1
      description: ''
    taskid: e45683cf-6336-41b1-867d-adaee3cdac35
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1297.5,
          "y": 1230
        }
      }
  "151":
    id: "151"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "155"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: ShadowITCondition
      stringify: {}
      value:
        complex:
          accessor: Attribution
          root: PrismaCloud
          transformers:
          - operator: count
          - args:
              else:
                value:
                  simple: '{"condition":"Asset found on Prisma Cloud", "value":true}'
              equals:
                value:
                  simple: "0"
              then:
                value:
                  simple: '{"condition":"Asset found on Prisma Cloud", "value":false}'
            operator: If-Then-Else
          - operator: ParseJSON
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: 8a7cec49-9c04-4f4e-863b-b4bb4cbcc506
      iscommand: false
      name: 'Set Shadow IT Condition variable: On Prisma Cloud?'
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 8a7cec49-9c04-4f4e-863b-b4bb4cbcc506
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 712.5,
          "y": 1870
        }
      }
  "152":
    id: "152"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "155"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: ShadowITCondition
      stringify: {}
      value:
        complex:
          root: UNEXISTINGFIELD
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: '{"condition":"Asset is On Prem with high confidence", "value":true}'
            operator: SetIfEmpty
          - operator: ParseJSON
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: 690309fc-d9f2-4d39-8ebd-36fc3d93b3da
      iscommand: false
      name: 'Set Shadow IT Condition variable: On Prem high confidence to True'
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 690309fc-d9f2-4d39-8ebd-36fc3d93b3da
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1070,
          "y": 2040
        }
      }
  "153":
    id: "153"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "155"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: ShadowITCondition
      stringify: {}
      value:
        complex:
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: Expanse.AttributionDevice.exposing_service
              operator: isEqualString
              right:
                value:
                  simple: "true"
          root: Expanse.AttributionDevice
          transformers:
          - operator: count
          - args:
              else:
                value:
                  simple: '{"condition":"Found Firewall exposing service", "value":true}'
              equals:
                value:
                  simple: "0"
              then:
                value:
                  simple: '{"condition":"Found Firewall exposing service", "value":false}'
            operator: If-Then-Else
          - operator: ParseJSON
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: 1cbf795e-3064-40ef-88cd-ad344f560740
      iscommand: false
      name: 'Set Shadow IT Condition variable: any Firewall exposing service?'
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 1cbf795e-3064-40ef-88cd-ad344f560740
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1922.5,
          "y": 1870
        }
      }
  "154":
    id: "154"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "151"
      - "153"
      - "156"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 379a2e81-db69-4068-8c3b-ee7466861db6
      iscommand: false
      name: Set up Shadow IT Condition Variables for report
      type: title
      version: -1
      description: ''
    taskid: 379a2e81-db69-4068-8c3b-ee7466861db6
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1297.5,
          "y": 1680
        }
      }
  "155":
    id: "155"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "59"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9471d387-fd4d-4cc6-84ef-05b93579d409
      iscommand: false
      name: Done Setting up Shadow IT Conditions for Report
      type: title
      version: -1
      description: ''
    taskid: 9471d387-fd4d-4cc6-84ef-05b93579d409
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1297.5,
          "y": 2220
        }
      }
  "156":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: expanseprovider
                root: incident
          operator: isEqualString
          right:
            value:
              simple: On Prem
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: ExpanseAllAssetTags
                    operator: inList
                    right:
                      iscontext: true
                      value:
                        simple: IPRangeLowConfidenceTag
                root: ExpanseAllAssetTags
                transformers:
                - operator: count
          operator: isEqualNumber
          right:
            value:
              simple: "0"
      label: "yes"
    id: "156"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "157"
      "yes":
      - "152"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether the asset is market as on prem with a high degree
        of confidence.
      id: 1bc98894-33b7-4807-874b-910fca5f0bbb
      iscommand: false
      name: On-prem with high confidence?
      type: condition
      version: -1
    taskid: 1bc98894-33b7-4807-874b-910fca5f0bbb
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1297.5,
          "y": 1860
        }
      }
  "157":
    id: "157"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "155"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: ShadowITCondition
      stringify: {}
      value:
        complex:
          root: UNEXISTINGFIELD
          transformers:
          - args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: '{"condition":"Asset is On Prem with high confidence", "value":false}'
            operator: SetIfEmpty
          - operator: ParseJSON
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: e94e1f18-e35e-4e0f-86e5-fbbdc6772cc7
      iscommand: false
      name: 'Set Shadow IT Condition variable: On Prem high confidence to False'
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: e94e1f18-e35e-4e0f-86e5-fbbdc6772cc7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1517.5,
          "y": 2040
        }
      }
  "158":
    evidencedata:
      customfields: {}
      description:
        simple: Expanse Enrichment Information
    id: "158"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "63"
    note: true
    quietmode: 0
    scriptarguments:
      expanseassettags:
        complex:
          root: ExpanseAllAssetTags
      expansebusinessunits:
        complex:
          accessor: expansebusinessunits
          root: incident
      expansedevices:
        complex:
          accessor: AttributionDevice
          root: Expanse
      expanseips:
        complex:
          accessor: AttributionIP
          root: Expanse
      expanseissuetags:
        complex:
          accessor: expansetags
          root: incident
      expansetags:
        complex:
          root: ExpanseXSOAROUTags
      expanseusers:
        complex:
          accessor: AttributionUser
          root: Expanse
      fqdn:
        complex:
          accessor: expansedomain
          root: incident
      ip:
        complex:
          accessor: expanseip
          root: incident
      port:
        complex:
          accessor: expanseport
          root: incident
      prismacloudassets:
        complex:
          accessor: Attribution
          root: PrismaCloud
      provider:
        complex:
          accessor: expanseprovider
          root: incident
      region:
        complex:
          accessor: expanseregion
          root: incident
      service:
        complex:
          accessor: expanseservice
          root: incident
      shadowit:
        complex:
          root: ShadowITCondition
      shadowitreasons: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: 'Print '
      id: 66e7ad78-80ba-4208-8103-c701f9612f77
      iscommand: false
      name: Generate Report for Attribution
      script: ExpansePrintSuggestions
      type: regular
      version: -1
    taskid: 66e7ad78-80ba-4208-8103-c701f9612f77
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1297.5,
          "y": 2780
        }
      }
  "159":
    id: "159"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      append: {}
      key:
        simple: ExpanseXSOAROUIssueTags
      stringify: {}
      value:
        complex:
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: ExpanseXSOARIssueTags
              operator: StringContainsArray
              right:
                value:
                  simple: -ou-
          root: ExpanseXSOARIssueTags
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: 8bcd47ff-2207-46d0-862c-dadd45a2758d
      iscommand: false
      name: 'Extract XSOAR Incident Tags related to OU Attribtion '
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 8bcd47ff-2207-46d0-862c-dadd45a2758d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 907.5,
          "y": -1130
        }
      }
  "161":
    id: "161"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "162"
    note: false
    quietmode: 0
    scriptarguments:
      issue_id:
        complex:
          accessor: expanseissueid
          root: incident
      update_type:
        simple: ProgressStatus
      value:
        simple: Investigating
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Update Expanse issue.
      id: 95dadfef-57da-4d84-8450-9bf70fec5b8b
      iscommand: true
      name: Set Progress Status to Investigating in Expanse issue
      script: '|||expanse-update-issue'
      type: regular
      version: -1
    taskid: 95dadfef-57da-4d84-8450-9bf70fec5b8b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1740,
          "y": -1840
        }
      }
  "162":
    id: "162"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      issue_id:
        complex:
          accessor: expanseissueid
          root: incident
      update_type:
        simple: Comment
      value:
        simple: This Issue is being investigated by the SOC through Cortex XSOAR
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Update Expanse issue.
      id: af03a742-354d-4955-8a54-66d54c0da905
      iscommand: true
      name: Add "Being investigated by XSOAR" comment to Expanse issue
      script: '|||expanse-update-issue'
      type: regular
      version: -1
    taskid: af03a742-354d-4955-8a54-66d54c0da905
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1740,
          "y": -1680
        }
      }
  "163":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.WriteToExpanse
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    id: "163"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "161"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determine whether playbook should write data back to Expanse.
      id: 7e9763d9-d217-45a8-854a-1a18f0023e32
      iscommand: false
      name: Are we writing to Expanse?
      type: condition
      version: -1
    taskid: 7e9763d9-d217-45a8-854a-1a18f0023e32
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1327.5,
          "y": -2040
        }
      }
  "164":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.WriteToExpanse
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    id: "164"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "166"
      "yes":
      - "96"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determine whether playbook should write data back to Expanse.
      id: cdb1e3fd-6636-44d8-8256-b79581889830
      iscommand: false
      name: Are we writing to Expanse?
      type: condition
      version: -1
    taskid: cdb1e3fd-6636-44d8-8256-b79581889830
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 610,
          "y": 4670
        }
      }
  "165":
    id: "165"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "164"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7a0e7d3d-5399-4f07-84c7-a7d9499fb5a2
      iscommand: false
      name: Tag Assets
      type: title
      version: -1
      description: ''
    taskid: 7a0e7d3d-5399-4f07-84c7-a7d9499fb5a2
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 610,
          "y": 4530
        }
      }
  "166":
    id: "166"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "30"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 538a9a9e-8430-4714-8dbb-1520968c84ff
      iscommand: false
      name: Done Tagging
      type: title
      version: -1
      description: ''
    taskid: 538a9a9e-8430-4714-8dbb-1520968c84ff
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 610,
          "y": 5580
        }
      }
  "167":
    id: "167"
    ignoreworker: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    scriptarguments:
      Create Indicators:
        simple: "true"
      Expanse Assets:
        complex:
          accessor: expanseasset
          root: incident
      Expanse IP:
        complex:
          accessor: expanseip
          root: incident
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: Extracts and Enriches Expanse from Indicator Assets
      id: 4ab4a9e6-9181-4e27-8835-ab57ba552195
      iscommand: false
      name: Extract Expanse Indicators
      playbookId: Extract Expanse Indicators
      type: playbook
      version: -1
    taskid: 4ab4a9e6-9181-4e27-8835-ab57ba552195
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1620,
          "y": -460
        }
      }
  "169":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.WriteToExpanse
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    id: "169"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "121"
      "yes":
      - "116"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determine whether playbook should write data back to Expanse.
      id: cdf61501-f0d1-4f56-8cf9-4891e949e65e
      iscommand: false
      name: Are we writing to Expanse?
      type: condition
      version: -1
    taskid: cdf61501-f0d1-4f56-8cf9-4891e949e65e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2752.5,
          "y": 8510
        }
      }
  "170":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.WriteToExpanse
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    id: "170"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "121"
      "yes":
      - "117"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determine whether playbook should write data back to Expanse.
      id: 8c3c3850-3cc5-4f12-89ee-a6832145dc78
      iscommand: false
      name: Are we writing to Expanse?
      type: condition
      version: -1
    taskid: 8c3c3850-3cc5-4f12-89ee-a6832145dc78
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2302.5,
          "y": 8810
        }
      }
  "171":
    id: "171"
    ignoreworker: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "147"
    note: false
    quietmode: 0
    scriptarguments:
      AWSIndicatorTags:
        simple: AWS
      AzureIndicatorTags:
        simple: Azure
      FQDN:
        complex:
          accessor: expansedomain
          root: incident
      GCPIndicatorTags:
        simple: GCP
      IP:
        complex:
          accessor: expanseip
          root: incident
      Provider:
        complex:
          accessor: expanseprovider
          root: incident
      Update Incident:
        simple: "True"
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: e6844f88-c6db-426d-854c-156aaf09cfcd
      iscommand: false
      name: Find Cloud IP Address Region and Service
      playbookId: Find Cloud IP Address Region and Service
      type: playbook
      version: -1
      description: ''
    taskid: e6844f88-c6db-426d-854c-156aaf09cfcd
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1765,
          "y": 505
        }
      }
  "172":
    id: "172"
    ignoreworker: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "111"
    note: false
    quietmode: 0
    scriptarguments:
      Link Incidents:
        simple: "True"
      Prisma Cloud Attribution:
        complex:
          accessor: Attribution
          root: PrismaCloud
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: 903ff92f-0077-473b-881f-7fc0fc6dc46d
      iscommand: false
      name: Prisma Cloud Correlate Alerts
      playbookId: Prisma Cloud Correlate Alerts
      type: playbook
      version: -1
      description: ''
    taskid: 903ff92f-0077-473b-881f-7fc0fc6dc46d
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -1600,
          "y": 7460
        }
      }
  "173":
    id: "173"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "122"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |
        Script to refresh tags and attribution reasons of assets inside Expanse Issue. The script should be used inside the Expanse Issue incident context.
      id: 70664145-a2d5-4f08-82ca-159b98fe0c8e
      iscommand: false
      name: Refresh Assets
      script: ExpanseRefreshIssueAssets
      type: regular
      version: -1
    taskid: 70664145-a2d5-4f08-82ca-159b98fe0c8e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": -1305
        }
      }
  "174":
    id: "174"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1c85401b-7870-4d74-8f27-1991d5158363
      iscommand: false
      name: Done DG Tagging
      type: title
      version: -1
      description: ''
    taskid: 1c85401b-7870-4d74-8f27-1991d5158363
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2752.5,
          "y": 9170
        }
      }
  "175":
    id: "175"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "166"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |
        Script to refresh tags and attribution reasons of assets inside Expanse Issue. The script should be used inside the Expanse Issue incident context.
      id: c21247cb-a1fd-493b-8f62-6c1fc94cad54
      iscommand: false
      name: Refresh Assets
      script: ExpanseRefreshIssueAssets
      type: regular
      version: -1
    taskid: c21247cb-a1fd-493b-8f62-6c1fc94cad54
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -80,
          "y": 5550
        }
      }
  "176":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.UseBehavior
          operator: isEqualString
          right:
            value:
              simple: "true"
      label: "yes"
    id: "176"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "29"
      "yes":
      - "31"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Collect Risky Flows for the IP address from Expanse Behavior?
      id: 0407024b-bad5-419d-8bf5-e2aa7c42147e
      iscommand: false
      name: Collect Risky Flows from Behavior?
      type: condition
      version: -1
    taskid: 0407024b-bad5-419d-8bf5-e2aa7c42147e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 620,
          "y": -590
        }
      }
  "177":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.ShadowITIncidentType
          operator: isNotEmpty
      label: "yes"
    id: "177"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "178"
      "yes":
      - "74"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: If the ShadowITIncidentType input is set, an incident of this type
        is automatically created and notes are copied to it.
      id: 0028b7ba-f73c-4314-8631-4063c362946d
      iscommand: false
      name: Create Shadow IT Incident automatically?
      type: condition
      version: -1
    taskid: 0028b7ba-f73c-4314-8631-4063c362946d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 4222.5,
          "y": 8500
        }
      }
  "178":
    defaultassigneecomplex: {}
    id: "178"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "86"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Manually create an Incident to handle the Shadow IT investigation.
      id: 0f0e353c-11e9-4519-882b-54510aa26ffe
      iscommand: false
      name: Manually create Shadow IT Incident
      type: regular
      version: -1
    taskid: 0f0e353c-11e9-4519-882b-54510aa26ffe
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 4060,
          "y": 8680
        }
      }
  "179":
    id: "179"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "106"
    note: false
    quietmode: 0
    scriptarguments:
      accountid: {}
      accountname: {}
      addLabels: {}
      agentid: {}
      alertid: {}
      alertname: {}
      app: {}
      appendMultiSelect: {}
      applicationid: {}
      applicationname: {}
      assetid: {}
      assigneduser: {}
      assignmentgroup: {}
      attachmentcount: {}
      attachmentextension: {}
      attachmenthash: {}
      attachmentid: {}
      attachmentname: {}
      attachmentsize: {}
      attachmenttype: {}
      blockedaction: {}
      bugtraq: {}
      caller: {}
      categorycount: {}
      city: {}
      closeNotes: {}
      closeReason: {}
      closetime: {}
      closingreason: {}
      closinguser: {}
      cloudservice: {}
      commandline: {}
      compliancenotes: {}
      costcenter: {}
      costcentercode: {}
      country: {}
      countryname: {}
      criticalassets: {}
      customFields: {}
      cve: {}
      cvss: {}
      cvssavailabilityrequirement: {}
      cvsscollateraldamagepotential: {}
      cvssconfidentialityrequirement: {}
      cvssintegrityrequirement: {}
      dbotMirrorDirection: {}
      dbotMirrorId: {}
      dbotMirrorInstance: {}
      dbotMirrorTags: {}
      dbotprediction: {}
      dbotpredictionprobability: {}
      dbottextsuggestionhighlighted: {}
      deleteEmptyField: {}
      department: {}
      dest: {}
      desthostname: {}
      destinationgeolocation: {}
      destinationhostname: {}
      destinationip: {}
      destinationips: {}
      destinationipv6: {}
      destinationmacaddress: {}
      destinationnetwork: {}
      destinationport: {}
      destntdomain: {}
      destos: {}
      details: {}
      detectedexternalhosts: {}
      detectedexternalips: {}
      detectedinternalhosts: {}
      detectedinternalips: {}
      detectedusers: {}
      detectionendtime: {}
      detectionid: {}
      detectionupdatetime: {}
      detectionurl: {}
      deviceexternalip: {}
      devicehash: {}
      devicelocalip: {}
      devicemodel: {}
      devicename: {}
      devicetime: {}
      displayname: {}
      dnsname: {}
      dstports: {}
      duration: {}
      email: {}
      emailauthenticitycheck: {}
      emailbcc: {}
      emailbody: {}
      emailbodyformat: {}
      emailbodyhtml: {}
      emailcc: {}
      emailclassification: {}
      emailclientname: {}
      emailfrom: {}
      emailheaders: {}
      emailhtml: {}
      emailhtmlimage: {}
      emailinreplyto: {}
      emailkeywords: {}
      emaillabels: {}
      emaillatestmessage: {}
      emailmessageid: {}
      emailreceived: {}
      emailreplyto: {}
      emailreturnpath: {}
      emailsenderip: {}
      emailsize: {}
      emailsource: {}
      emailsubject: {}
      emailto: {}
      emailtocount: {}
      emailurlclicked: {}
      employeedisplayname: {}
      employeeemail: {}
      employeemanageremail: {}
      errorcode: {}
      errormessage: {}
      escalation: {}
      eventaction: {}
      eventdescriptions: {}
      eventid: {}
      eventnames: {}
      events: {}
      eventtype: {}
      expanseactivitystatus: {}
      expanseasset: {}
      expanseassetorganizationunit: {}
      expanseassetowner: {}
      expanseassignee: {}
      expansebusinessunits: {}
      expansecategory: {}
      expansecertificate: {}
      expansecreated: {}
      expansedomain: {}
      expansegeolocation: {}
      expanseinitialevidence: {}
      expanseip: {}
      expanseissueid: {}
      expanseissuetype: {}
      expanselatestevidence: {}
      expanselatestevidencegeolocation: {}
      expansemlfeatures: {}
      expansemodified: {}
      expanseport: {}
      expansepriority: {}
      expanseprogressstatus: {}
      expanseprotocol: {}
      expanseprovider: {}
      expanseregion: {}
      expanseservice: {}
      expanseshadowit: {}
      expansetags: {}
      externaladdresses: {}
      filehash: {}
      filename: {}
      filepath: {}
      filesize: {}
      firstname: {}
      firstseen: {}
      followup: {}
      givenname: {}
      helloworldid: {}
      helloworldstatus: {}
      helloworldtype: {}
      highlevelcategories: {}
      hostname: {}
      id:
        complex:
          root: CreatedIncidentID
      incomingmirrorerror: {}
      infectedhosts: {}
      internaladdresses: {}
      investigationstage: {}
      isolated: {}
      jobcode: {}
      jobfamily: {}
      jobfunction: {}
      labels: {}
      lastmodifiedby: {}
      lastmodifiedon: {}
      lastname: {}
      lastseen: {}
      lastupdatetime: {}
      leadership: {}
      listofrulesevent: {}
      location: {}
      locationregion: {}
      logsource: {}
      logsourcename: {}
      logsourcetype: {}
      lowlevelcategoriesevents: {}
      macaddress: {}
      maliciousbehavior: {}
      malwarefamily: {}
      malwarename: {}
      manageremailaddress: {}
      managername: {}
      md5: {}
      mobiledevicemodel: {}
      mobilephone: {}
      name: {}
      numberoflogsources: {}
      occurred: {}
      os: {}
      osversion: {}
      outgoingmirrorerror: {}
      owner: {}
      parentprocessid: {}
      personalemail: {}
      phase: {}
      phishingsubtype: {}
      phonenumber: {}
      pid: {}
      policydeleted: {}
      policydescription: {}
      policydetails: {}
      policyid: {}
      policyrecommendation: {}
      policyremediable: {}
      policyseverity: {}
      policytype: {}
      postnatdestinationip: {}
      postnatdestinationport: {}
      postnatsourceip: {}
      postnatsourceport: {}
      prenatdestinationport: {}
      prenatsourceip: {}
      prenatsourceport: {}
      prismacloudid: {}
      prismacloudreason: {}
      prismacloudrules: {}
      prismacloudstatus: {}
      prismacloudtime: {}
      protocol: {}
      protocolevent: {}
      protocols: {}
      quarantined: {}
      rating: {}
      rawevent: {}
      region: {}
      regionid: {}
      replacePlaybook: {}
      reporteremailaddress: {}
      resourceapiname: {}
      resourcecloudtype: {}
      resourceid: {}
      resourcename: {}
      resourcetype: {}
      riskrating: {}
      riskscore: {}
      roles: {}
      rrn: {}
      samaccountname: {}
      severity: {}
      sha256: {}
      shadowitaccountowneremail: {}
      shadowitaccountownername: {}
      shadowitbilledtocorp: {}
      shadowitcertificate:
        complex:
          accessor: expansecertificate
          root: incident
      shadowitcloudaccountid: {}
      shadowitcloudaccounttype: {}
      shadowitfqdn:
        complex:
          accessor: expansedomain
          root: incident
      shadowitip:
        complex:
          accessor: expanseip
          root: incident
      shadowitorganizationalunit:
        complex:
          accessor: expanseassetorganizationunit
          root: incident
      shadowitoucontactemail:
        complex:
          accessor: ExpanseOrganizationUnitsToOwner
          root: lists
          transformers:
          - args:
              field:
                iscontext: true
                value:
                  simple: incident.expanseassetorganizationunit
            operator: getField
          - operator: ParseJSON
          - args:
              field:
                value:
                  simple: email
            operator: getField
      shadowitoucontactname:
        complex:
          accessor: ExpanseOrganizationUnitsToOwner
          root: lists
          transformers:
          - args:
              field:
                iscontext: true
                value:
                  simple: incident.expanseassetorganizationunit
            operator: getField
          - operator: ParseJSON
          - args:
              field:
                value:
                  simple: name
            operator: getField
      shadowitport:
        complex:
          accessor: expanseport
          root: incident
      shadowitprovider:
        complex:
          accessor: expanseprovider
          root: incident
      shadowitregion: {}
      shadowitrisk: {}
      shadowitsactionedservice: {}
      shadowitsensitivedata: {}
      shadowitservice: {}
      shadowitservicepurpose: {}
      shadowitsource:
        simple: Expanse
      shadowitusersuggestions:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: Expanse.AttributionUser
              operator: isNotEmpty
          root: Expanse.AttributionUser
          transformers:
          - args:
              expression:
                value:
                  simple: '{name: username, email: mail, notes: join('' '', [''Found
                    '', to_string(sightings), '' log entries''])}'
            operator: jmespath
      signature: {}
      skuname: {}
      skutier: {}
      sla: {}
      slaField: {}
      sourcegeolocation: {}
      sourcehostname: {}
      sourceip: {}
      sourceips: {}
      sourceipv6: {}
      sourcemacaddress: {}
      sourcenetwork: {}
      sourceport: {}
      sourceusername: {}
      src: {}
      srchostname: {}
      srcntdomain: {}
      srcos: {}
      srcports: {}
      srcuser: {}
      starttime: {}
      state: {}
      streetaddress: {}
      subcategory: {}
      subscriptionassignedby: {}
      subscriptioncreatedby: {}
      subscriptioncreatedon: {}
      subscriptiondescription: {}
      subscriptionid: {}
      subscriptionname: {}
      subscriptiontype: {}
      subscriptionupdatedby: {}
      subscriptionupdatedon: {}
      subtype: {}
      surname: {}
      systemdefault: {}
      systems: {}
      targetfirewallversion: {}
      technicalowner: {}
      technicalownercontact: {}
      technicaluser: {}
      tenantname: {}
      terminatedaction: {}
      threatactor: {}
      ticketcloseddate: {}
      ticketnumber: {}
      ticketopeneddate: {}
      title: {}
      trafficdirection: {}
      triggeredsecurityprofile: {}
      type: {}
      uniqueports: {}
      urlsslverification: {}
      user: {}
      useraccountcontrol: {}
      userid: {}
      username: {}
      usernames: {}
      vendorid: {}
      vendorproduct: {}
      vpcid: {}
      vulnerabilitycategory: {}
      workphone: {}
      xdralertcount: {}
      xdralerts: {}
      xdrassigneduseremail: {}
      xdrassigneduserprettyname: {}
      xdrdescription: {}
      xdrdetectiontime: {}
      xdrfileartifacts: {}
      xdrhighseverityalertcount: {}
      xdrhostcount: {}
      xdrincidentid: {}
      xdrlowseverityalertcount: {}
      xdrmediumseverityalertcount: {}
      xdrnetworkartifacts: {}
      xdrnotes: {}
      xdrresolvecomment: {}
      xdrstatus: {}
      xdrstatusv2: {}
      xdrurl: {}
      xdrusercount: {}
      zipcode: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: If the Shadow IT content pack is enabled and the Shadow IT incident
        fields are provided, this tasks sets the fields accordingly. If the Pack is
        not enabled, no change happens.
      id: 44c2e338-b385-4228-8f44-77fc46050df2
      iscommand: true
      name: Set Shadow IT Pack Incident Fields
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 44c2e338-b385-4228-8f44-77fc46050df2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 4610,
          "y": 9095
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "170_117_yes": 0.63,
      "177_178_#default#": 0.62,
      "73_86_#default#": 0.11,
      "96_166_#default#": 0.4,
      "9_14_#default#": 0.69
    },
    "paper": {
      "dimensions": {
        "height": 13135,
        "width": 6590,
        "x": -1600,
        "y": -2180
      }
    }
  }
fromversion: 6.0.0
tests:
- No tests (auto formatted)
