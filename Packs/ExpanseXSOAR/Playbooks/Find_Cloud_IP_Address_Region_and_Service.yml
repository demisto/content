description: Find Region and Service for IP Address belonging to Public Cloud, using
  Indicators (CIDRs)
id: Find Cloud IP Address Region and Service
inputs:
- description: IP Address to find
  key: ip
  playbookInputQuery:
  required: true
  value:
    simple: ${IP.Address}
- description: Cloud Provider (Google,Amazon web services,Microsoft azure) or empty
    to search in all
  key: Provider
  playbookInputQuery:
  required: false
  value: {}
- description: Tags to search for AWS Indicators
  key: AWSIndicatorTags
  playbookInputQuery:
  required: false
  value:
    simple: AWS
- description: Tags to search for GCP Indicators
  key: GCPIndicatorTags
  playbookInputQuery:
  required: false
  value:
    simple: GCP
- description: Tags to search for Azure Indicators
  key: AzureIndicatorTags
  playbookInputQuery:
  required: false
  value:
    simple: Azure
name: Find Cloud IP Address Region and Service
outputs:
- contextPath: MatchingCIDRIndicator
  description: Matching CIDR Indicator
starttaskid: "0"
tasks:
  "0":
    id: "0"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: aa318689-86f5-4fb2-84e0-3c46d3aca664
      iscommand: false
      name: ""
      version: -1
      description: ''
    taskid: aa318689-86f5-4fb2-84e0-3c46d3aca664
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 450,
          "y": 50
        }
      }
  "1":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.Provider
          operator: inList
          right:
            value:
              simple: AWS,Amazon Web Services,Amazon
      label: AWS
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.Provider
          operator: inList
          right:
            value:
              simple: Google,GCP,Google Cloud Platform
      label: GCP
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.Provider
          operator: inList
          right:
            value:
              simple: Microsoft,Microsoft Azure,Azure
      label: AZURE
    id: "1"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "5"
      AWS:
      - "2"
      AZURE:
      - "4"
      GCP:
      - "3"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e689a6a5-2163-4dfd-80e2-e3f567586a12
      iscommand: false
      name: Cloud Provider Selector
      type: condition
      version: -1
      description: Select the appropriate branch depending on the Cloud Provider
    taskid: e689a6a5-2163-4dfd-80e2-e3f567586a12
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 450,
          "y": 210
        }
      }
  "2":
    id: "2"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ip:
        complex:
          root: inputs.ip
      tags:
        complex:
          root: inputs.AWSIndicatorTags
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Match IP address in all the CIDRs indicators (longest match)
      id: 148e2a46-7809-4536-8452-08bcf3a66ee1
      iscommand: false
      name: Match IP in AWS CIDR Indicators
      script: MatchIPinCIDRIndicators
      type: regular
      version: -1
    taskid: 148e2a46-7809-4536-8452-08bcf3a66ee1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -20,
          "y": 670
        }
      }
  "3":
    id: "3"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ip:
        complex:
          root: inputs.ip
      tags:
        complex:
          root: inputs.GCPIndicatorTags
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Match IP address in all the CIDRs indicators (longest match)
      id: 8e6e332f-0c8f-4ed5-8370-d85f7abc9166
      iscommand: false
      name: Match IP in GCP CIDR Indicators
      script: MatchIPinCIDRIndicators
      type: regular
      version: -1
    taskid: 8e6e332f-0c8f-4ed5-8370-d85f7abc9166
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 460,
          "y": 670
        }
      }
  "4":
    id: "4"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      ip:
        complex:
          root: inputs.ip
      tags:
        complex:
          root: inputs.AzureIndicatorTags
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Match IP address in all the CIDRs indicators (longest match)
      id: 776c1eb0-eaa7-4f02-84ed-a9a56d10f9ad
      iscommand: false
      name: Match IP in AZURE CIDR Indicators
      script: MatchIPinCIDRIndicators
      type: regular
      version: -1
    taskid: 776c1eb0-eaa7-4f02-84ed-a9a56d10f9ad
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 930,
          "y": 670
        }
      }
  "5":
    id: "5"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "2"
      - "3"
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2020bab6-5a76-4897-8144-133c7026d71e
      iscommand: false
      name: Check All Providers
      type: title
      version: -1
      description: ''
    taskid: 2020bab6-5a76-4897-8144-133c7026d71e
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 930,
          "y": 410
        }
      }
  "6":
    id: "6"
    ignoreworker: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0b1adba9-964f-4e60-8b94-b7fe46038b71
      iscommand: false
      name: Done
      type: title
      version: -1
      description: ''
    taskid: 0b1adba9-964f-4e60-8b94-b7fe46038b71
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 460,
          "y": 1090
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1105,
        "width": 1330,
        "x": -20,
        "y": 50
      }
    }
  }
fromversion: 6.0.0
tests:
- No tests (auto formatted)
