id: ZeroFox-Test
version: -1
name: ZeroFox-Test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 556675c7-b312-429e-854f-f2c5cb6018ad
    type: start
    task:
      id: 556675c7-b312-429e-854f-f2c5cb6018ad
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "1":
    id: "1"
    taskid: f9809f04-e5e2-4f8c-8080-e5a19c5ac2fa
    type: regular
    task:
      id: f9809f04-e5e2-4f8c-8080-e5a19c5ac2fa
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "2":
    id: "2"
    taskid: cf2d95cb-ece6-4ced-8efd-86e218052fca
    type: regular
    task:
      id: cf2d95cb-ece6-4ced-8efd-86e218052fca
      version: -1
      name: zerofox-list-alerts
      description: Returns alerts matching given/default filters and parameters. By
        default, no filters are applied and results are sorted by timestamp.
      script: ZeroFox|||zerofox-list-alerts
      type: regular
      iscommand: true
      brand: ZeroFox
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      account: {}
      alert_id: {}
      alert_type: {}
      assignee: {}
      entity: {}
      entity_search: {}
      entity_term: {}
      escalated: {}
      last_modified: {}
      limit:
        simple: "1"
      max_timestamp: {}
      min_timestamp: {}
      network: {}
      offset: {}
      page_id: {}
      page_url: {}
      pages: {}
      perpetrator_search: {}
      post: {}
      pro_social_obj_search: {}
      rule_id: {}
      rule_name: {}
      severity: {}
      sort_direction: {}
      sort_field: {}
      status:
        simple: open
      tags: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "3":
    id: "3"
    taskid: 70095228-35a6-4c74-8381-9aa3aeb4e61a
    type: regular
    task:
      id: 70095228-35a6-4c74-8381-9aa3aeb4e61a
      version: -1
      name: GenerateRandomString
      description: Generates random string
      scriptName: GenerateRandomString
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      Digits:
        simple: "False"
      Length:
        simple: "12"
      Lowercase:
        simple: "False"
      Punctuation:
        simple: "False"
      Uppercase:
        simple: "True"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "4":
    id: "4"
    taskid: 7b05a4cb-421c-487a-86ea-04bf22e5a3d7
    type: regular
    task:
      id: 7b05a4cb-421c-487a-86ea-04bf22e5a3d7
      version: -1
      name: zerofox-alert-user-assignment
      description: Assigns an alert to a user
      script: ZeroFox|||zerofox-alert-user-assignment
      type: regular
      iscommand: true
      brand: ZeroFox
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      alert_id:
        complex:
          root: ZeroFox
          accessor: Alert.ID
      subject_email:
        simple: kkk@gmail.com #disable-secrets-detection
      subject_name:
        complex:
          root: RandomString
      username:
        complex:
          root: RandomString
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "5":
    id: "5"
    taskid: 52d91681-1743-490a-8fe7-8e7e12c74f6a
    type: regular
    task:
      id: 52d91681-1743-490a-8fe7-8e7e12c74f6a
      version: -1
      name: zerofox-get-alert
      description: Fetches an alert by ID
      script: ZeroFox|||zerofox-get-alert
      type: regular
      iscommand: true
      brand: ZeroFox
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      alert_id:
        complex:
          root: ZeroFox
          accessor: Alert.ID
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "6":
    id: "6"
    taskid: 444c9201-659a-436f-82c6-a881bf41d2a2
    type: condition
    task:
      id: 444c9201-659a-436f-82c6-a881bf41d2a2
      version: -1
      name: Verify Asignee
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "7"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: ZeroFox
                accessor: Alert.Assignee
            iscontext: true
          right:
            value:
              complex:
                root: RandomString
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "7":
    id: "7"
    taskid: 96738ebc-05c1-4d00-87b4-f76df5ddc85e
    type: regular
    task:
      id: 96738ebc-05c1-4d00-87b4-f76df5ddc85e
      version: -1
      name: zerofox-modify-alert-tags
      description: adds/removes tags to/from a specific alert
      script: ZeroFox|||zerofox-modify-alert-tags
      type: regular
      iscommand: true
      brand: ZeroFox
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      addition: {}
      alert_id:
        complex:
          root: ZeroFox
          accessor: Alert.ID
      tags:
        simple: tag1,tag2,tag3
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "8":
    id: "8"
    taskid: fc9e9bb9-4f43-4ff7-8c88-2d342b5e54b5
    type: regular
    task:
      id: fc9e9bb9-4f43-4ff7-8c88-2d342b5e54b5
      version: -1
      name: zerofox-get-alert
      description: Fetches an alert by ID
      script: ZeroFox|||zerofox-get-alert
      type: regular
      iscommand: true
      brand: ZeroFox
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      alert_id:
        complex:
          root: ZeroFox
          accessor: Alert.ID
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "9":
    id: "9"
    taskid: 54d83825-988d-4dac-8854-c9460a479f3e
    type: condition
    task:
      id: 54d83825-988d-4dac-8854-c9460a479f3e
      version: -1
      name: Verify Tags
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "10"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: ZeroFox
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: ZeroFox.Alert.Tags
                      iscontext: true
                    right:
                      value:
                        simple: tag1
                - - operator: isEqualString
                    left:
                      value:
                        simple: ZeroFox.Alert.Tags
                      iscontext: true
                    right:
                      value:
                        simple: tag2
                - - operator: isEqualString
                    left:
                      value:
                        simple: ZeroFox.Alert.Tags
                      iscontext: true
                    right:
                      value:
                        simple: tag3
                accessor: Alert.Tags
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "10":
    id: "10"
    taskid: afa29df6-3350-401f-8959-6ee2d111f7e3
    type: regular
    task:
      id: afa29df6-3350-401f-8959-6ee2d111f7e3
      version: -1
      name: zerofox-modify-alert-tags
      description: adds/removes tags to/from a specific alert
      script: ZeroFox|||zerofox-modify-alert-tags
      type: regular
      iscommand: true
      brand: ZeroFox
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      addition:
        simple: "false"
      alert_id:
        complex:
          root: ZeroFox
          accessor: Alert.ID
      tags:
        simple: tag3
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "11":
    id: "11"
    taskid: 4da3a5a3-23e5-46e9-85fd-a76d6303e67c
    type: regular
    task:
      id: 4da3a5a3-23e5-46e9-85fd-a76d6303e67c
      version: -1
      name: zerofox-get-alert
      description: Fetches an alert by ID
      script: ZeroFox|||zerofox-get-alert
      type: regular
      iscommand: true
      brand: ZeroFox
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      alert_id:
        complex:
          root: ZeroFox
          accessor: Alert.ID
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "12":
    id: "12"
    taskid: 21209b7d-9ffa-4a14-87fa-63773dac6e09
    type: condition
    task:
      id: 21209b7d-9ffa-4a14-87fa-63773dac6e09
      version: -1
      name: Verify Tags
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "13"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: ZeroFox
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: ZeroFox.Alert.Tags
                      iscontext: true
                    right:
                      value:
                        simple: tag1
                - - operator: isEqualString
                    left:
                      value:
                        simple: ZeroFox.Alert.Tags
                      iscontext: true
                    right:
                      value:
                        simple: tag2
                accessor: Alert.Tags
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "13":
    id: "13"
    taskid: 7af9a6b9-d564-4cef-8133-a3384a9dc9be
    type: regular
    task:
      id: 7af9a6b9-d564-4cef-8133-a3384a9dc9be
      version: -1
      name: zerofox-alert-request-takedown
      description: Requests takedown of a specific alert
      script: ZeroFox|||zerofox-alert-request-takedown
      type: regular
      iscommand: true
      brand: ZeroFox
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      alert_id:
        complex:
          root: ZeroFox
          accessor: Alert.ID
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "14":
    id: "14"
    taskid: 0effc821-3efa-40b4-8763-f1173b565bb9
    type: regular
    task:
      id: 0effc821-3efa-40b4-8763-f1173b565bb9
      version: -1
      name: zerofox-get-alert
      description: Fetches an alert by ID
      script: ZeroFox|||zerofox-get-alert
      type: regular
      iscommand: true
      brand: ZeroFox
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      alert_id:
        complex:
          root: ZeroFox
          accessor: Alert.ID
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "15":
    id: "15"
    taskid: 7c878b0d-2369-45d4-86a1-ba8026b67e79
    type: regular
    task:
      id: 7c878b0d-2369-45d4-86a1-ba8026b67e79
      version: -1
      name: zerofox-alert-cancel-takedown
      description: Cancels takedown of a specific alert
      script: ZeroFox|||zerofox-alert-cancel-takedown
      type: regular
      iscommand: true
      brand: ZeroFox
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      alert_id:
        complex:
          root: ZeroFox
          accessor: Alert.ID
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "16":
    id: "16"
    taskid: b50d700e-8bcf-4bb5-8a9a-efcff92dc1dc
    type: regular
    task:
      id: b50d700e-8bcf-4bb5-8a9a-efcff92dc1dc
      version: -1
      name: zerofox-get-alert
      description: Fetches an alert by ID
      script: ZeroFox|||zerofox-get-alert
      type: regular
      iscommand: true
      brand: ZeroFox
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      alert_id:
        complex:
          root: ZeroFox
          accessor: Alert.ID
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "17":
    id: "17"
    taskid: f885ce55-034b-4dbc-8753-78edb81c7909
    type: condition
    task:
      id: f885ce55-034b-4dbc-8753-78edb81c7909
      version: -1
      name: Verify Open
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "18"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: ZeroFox
                accessor: Alert.Status
            iscontext: true
          right:
            value:
              simple: Open
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "18":
    id: "18"
    taskid: 0cd9ec7a-3257-4fdb-8405-0f301998eca2
    type: regular
    task:
      id: 0cd9ec7a-3257-4fdb-8405-0f301998eca2
      version: -1
      name: zerofox-close-alert
      description: Closes an alert
      script: ZeroFox|||zerofox-close-alert
      type: regular
      iscommand: true
      brand: ZeroFox
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      alert_id:
        complex:
          root: ZeroFox
          accessor: Alert.ID
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "19":
    id: "19"
    taskid: adc02c74-6a93-410b-85db-73d5892d5236
    type: regular
    task:
      id: adc02c74-6a93-410b-85db-73d5892d5236
      version: -1
      name: zerofox-get-alert
      description: Fetches an alert by ID
      script: ZeroFox|||zerofox-get-alert
      type: regular
      iscommand: true
      brand: ZeroFox
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      alert_id:
        complex:
          root: ZeroFox
          accessor: Alert.ID
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "20":
    id: "20"
    taskid: a98bf8eb-5b11-42f7-8e02-2a027d51d9ab
    type: condition
    task:
      id: a98bf8eb-5b11-42f7-8e02-2a027d51d9ab
      version: -1
      name: Verify Closed
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "21"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: ZeroFox
                accessor: Alert.Status
            iscontext: true
          right:
            value:
              simple: Closed
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "21":
    id: "21"
    taskid: feeb2d17-c88f-4e81-8c76-f7f3793a5e0c
    type: regular
    task:
      id: feeb2d17-c88f-4e81-8c76-f7f3793a5e0c
      version: -1
      name: zerofox-open-alert
      description: Opens an alert'
      script: ZeroFox|||zerofox-open-alert
      type: regular
      iscommand: true
      brand: ZeroFox
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      alert_id:
        complex:
          root: ZeroFox
          accessor: Alert.ID
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3695
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "22":
    id: "22"
    taskid: eab07206-c1f6-4060-8981-35273892fd62
    type: regular
    task:
      id: eab07206-c1f6-4060-8981-35273892fd62
      version: -1
      name: zerofox-get-alert
      description: Fetches an alert by ID
      script: ZeroFox|||zerofox-get-alert
      type: regular
      iscommand: true
      brand: ZeroFox
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      alert_id:
        complex:
          root: ZeroFox
          accessor: Alert.ID
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "23":
    id: "23"
    taskid: 8ded6457-c88c-45e2-836d-c00d421c0ae7
    type: condition
    task:
      id: 8ded6457-c88c-45e2-836d-c00d421c0ae7
      version: -1
      name: Verify Open
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "24"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: ZeroFox
                accessor: Alert.Status
            iscontext: true
          right:
            value:
              simple: Open
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4045
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "24":
    id: "24"
    taskid: e00f232f-9bff-4931-8a7e-c4ce740cca60
    type: regular
    task:
      id: e00f232f-9bff-4931-8a7e-c4ce740cca60
      version: -1
      name: Fetch Incidents Test
      scriptName: FetchFromInstance
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "26"
    scriptarguments:
      instance_name:
        complex:
          root: modules
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: modules.brand
                iscontext: true
              right:
                value:
                  simple: ZeroFox
          accessor: name
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "25":
    id: "25"
    taskid: d7e52928-6e30-4f63-8f66-0cef0f83636b
    type: title
    task:
      id: d7e52928-6e30-4f63-8f66-0cef0f83636b
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "26":
    id: "26"
    taskid: 3c5dc9e4-1637-460b-8c96-704069aff496
    type: regular
    task:
      id: 3c5dc9e4-1637-460b-8c96-704069aff496
      version: -1
      name: zerofox-get-policy-types
      description: Shows in the war room a table of all policy type names & IDs
      script: ZeroFox|||zerofox-get-policy-types
      type: regular
      iscommand: true
      brand: ZeroFox
    nexttasks:
      '#none#':
      - "27"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4395
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "27":
    id: "27"
    taskid: 78f91ae1-bc16-4bc1-85e1-9732d5cf75fc
    type: regular
    task:
      id: 78f91ae1-bc16-4bc1-85e1-9732d5cf75fc
      version: -1
      name: zerofox-create-entity
      description: Creates a new entity on the company of the authorized user.
      script: ZeroFox|||zerofox-create-entity
      type: regular
      iscommand: true
      brand: ZeroFox
    nexttasks:
      '#none#':
      - "28"
    scriptarguments:
      name:
        simple: pb_test
      organization: {}
      policy_id:
        simple: "34778"
      strict_name_matching: {}
      tags: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "28":
    id: "28"
    taskid: 306867ae-9d66-4be3-86b6-4a1d92840e05
    type: regular
    task:
      id: 306867ae-9d66-4be3-86b6-4a1d92840e05
      version: -1
      name: zerofox-list-entities
      description: Lists all entities on the company of the authorized user.
      script: ZeroFox|||zerofox-list-entities
      type: regular
      iscommand: true
      brand: ZeroFox
    nexttasks:
      '#none#':
      - "25"
    scriptarguments:
      email_address: {}
      group: {}
      label: {}
      network: {}
      networks: {}
      page: {}
      policy:
        complex:
          root: ZeroFox
          accessor: Entity.PolicyID
      type: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 4935,
        "width": 380,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
