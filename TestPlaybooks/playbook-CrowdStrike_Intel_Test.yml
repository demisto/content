id: CrowdStrike Falcon Intel v2
version: 7
name: CrowdStrike Falcon Intel v2
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 8fc39449-a01e-4f31-8397-79e8f3b48660
    type: start
    task:
      id: 8fc39449-a01e-4f31-8397-79e8f3b48660
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 50
        }
      }
  "1":
    id: "1"
    taskid: ecb402a0-cecb-4764-89b3-7d6dd97fcc3a
    type: regular
    task:
      id: ecb402a0-cecb-4764-89b3-7d6dd97fcc3a
      version: -1
      name: Check IP Address
      script: FalconIntel|||ip
      type: regular
      iscommand: true
      brand: FalconIntel
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      ip:
        simple: 4.4.4.4
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 391
        }
      }
  "2":
    id: "2"
    taskid: 351f2b7b-a641-43a4-8154-c55745f22901
    type: regular
    task:
      id: 351f2b7b-a641-43a4-8154-c55745f22901
      version: -1
      name: Delete Context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 451,
          "y": 225
        }
      }
  "3":
    id: "3"
    taskid: 169008a1-10d8-43bf-8d48-45a0cd8a26d6
    type: regular
    task:
      id: 169008a1-10d8-43bf-8d48-45a0cd8a26d6
      version: -1
      name: Check File
      script: FalconIntel|||file
      type: regular
      iscommand: true
      brand: FalconIntel
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      file:
        simple: 369c8fc6532ba547d7ef5985bb5e880a
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 556
        }
      }
  "4":
    id: "4"
    taskid: 1b53ee0b-9ea4-4fbb-8a76-0d0b2a502460
    type: regular
    task:
      id: 1b53ee0b-9ea4-4fbb-8a76-0d0b2a502460
      version: -1
      name: Check URL
      script: FalconIntel|||url
      type: regular
      iscommand: true
      brand: FalconIntel
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      url:
        simple: http://8.8.8.8/google.doc
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 709
        }
      }
  "5":
    id: "5"
    taskid: d0436374-037b-45d5-809c-04291af5289c
    type: regular
    task:
      id: d0436374-037b-45d5-809c-04291af5289c
      version: -1
      name: Check Domain
      script: FalconIntel|||domain
      type: regular
      iscommand: true
      brand: FalconIntel
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      domain:
        simple: dns02.hpupdat.net
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 892
        }
      }
  "6":
    id: "6"
    taskid: d2138ff6-3e9f-4a8b-80e0-cd6c0f1703c9
    type: condition
    task:
      id: d2138ff6-3e9f-4a8b-80e0-cd6c0f1703c9
      version: -1
      name: Test if values exist from API calls
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "8"
      "yes":
      - "9"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: string.isEqual
          left:
            value:
              simple: DBotScore.Type
            iscontext: true
          right:
            value:
              simple: ip
      - - operator: string.isEqual
          left:
            value:
              simple: DBotScore.Type
            iscontext: true
          right:
            value:
              simple: hash
      - - operator: string.isEqual
          left:
            value:
              simple: DBotScore.Type
            iscontext: true
          right:
            value:
              simple: url
      - - operator: string.isEqual
          left:
            value:
              simple: DBotScore.Type
            iscontext: true
          right:
            value:
              simple: domain
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1057
        }
      }
  "7":
    id: "7"
    taskid: 3d4f35d2-b6bd-41b8-864b-e74d55d28c13
    type: title
    task:
      id: 3d4f35d2-b6bd-41b8-864b-e74d55d28c13
      version: -1
      name: Hooray!
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 98,
          "y": 1915
        }
      }
  "8":
    id: "8"
    taskid: 4efee843-f1c8-4829-8940-81c213af0021
    type: regular
    task:
      id: 4efee843-f1c8-4829-8940-81c213af0021
      version: -1
      name: Some value was not found
      scriptName: ThrowException
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      error:
        simple: Some value was not found
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 926,
          "y": 1205
        }
      }
  "9":
    id: "9"
    taskid: 4ee91ed0-0064-4f19-848b-08c6d696d2d8
    type: regular
    task:
      id: 4ee91ed0-0064-4f19-848b-08c6d696d2d8
      version: -1
      name: Search known actors
      script: FalconIntel|||cs-actors
      type: regular
      iscommand: true
      brand: FalconIntel
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      desc: {}
      limit:
        simple: "1"
      maxLastActivityDate: {}
      maxLastModifiedDate: {}
      minLastActivityDate: {}
      minLastModifiedDate: {}
      motivations: {}
      name: {}
      offset: {}
      origins: {}
      q:
        simple: google
      slug: {}
      sort: {}
      targetCountries: {}
      targetIndustries: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 101,
          "y": 1229
        }
      }
  "10":
    id: "10"
    taskid: 474531c2-7aef-486b-8b5a-071d812445fb
    type: regular
    task:
      id: 474531c2-7aef-486b-8b5a-071d812445fb
      version: -1
      name: Search known indicators
      script: FalconIntel|||cs-indicators
      type: regular
      iscommand: true
      brand: FalconIntel
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      filter:
        simple: equal
      page:
        simple: "1"
      pageSize: {}
      parameter:
        simple: indicator
      sort: {}
      value:
        simple: panda
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 101,
          "y": 1401
        }
      }
  "11":
    id: "11"
    taskid: d9c30128-a54a-4f21-8f53-d3b7583ebe3a
    type: regular
    task:
      id: d9c30128-a54a-4f21-8f53-d3b7583ebe3a
      version: -1
      name: Query CrowdStrike intelligence publications
      script: FalconIntel|||cs-reports
      type: regular
      iscommand: true
      brand: FalconIntel
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      actor:
        simple: panda
      description: {}
      limit:
        simple: "2"
      maxLastModifiedDate: {}
      minLastModifiedDate: {}
      motivations: {}
      name: {}
      offset: {}
      q: {}
      slug: {}
      sort: {}
      subType: {}
      tags: {}
      targetCountries: {}
      targetIndustries: {}
      type: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 98,
          "y": 1566
        }
      }
  "12":
    id: "12"
    taskid: 7f86c752-3185-4618-8184-60515c785ee3
    type: regular
    task:
      id: 7f86c752-3185-4618-8184-60515c785ee3
      version: -1
      name: Retrieve Falcon Intel Report PDFcrowd
      script: FalconIntel|||cs-report-pdf
      type: regular
      iscommand: true
      brand: FalconIntel
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      id:
        simple: "588"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 96,
          "y": 1743
        }
      }
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1930,
        "width": 1210,
        "x": 96,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
