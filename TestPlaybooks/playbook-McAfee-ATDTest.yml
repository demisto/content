id: Test Playbook McAfee ATD
version: -1
name: Test Playbook McAfee ATD
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 1695be4e-86eb-460d-8f57-1c6fb1da76c8
    type: start
    task:
      id: 1695be4e-86eb-460d-8f57-1c6fb1da76c8
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 447,
          "y": -95
        }
      }
    note: false
  "1":
    id: "1"
    taskid: 76832232-858b-4af1-8405-abe340e809af
    type: regular
    task:
      id: 76832232-858b-4af1-8405-abe340e809af
      version: -1
      name: atd-login
      description: Returns a logon result for ATD
      script: McAfee Advanced Threat Defense|||atd-login
      type: regular
      iscommand: true
      brand: McAfee Advanced Threat Defense
    nexttasks:
      '#none#':
      - "4"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 364
        }
      }
    note: false
  "2":
    id: "2"
    taskid: 0364ee54-17ad-4f94-85be-c832da7680d0
    type: regular
    task:
      id: 0364ee54-17ad-4f94-85be-c832da7680d0
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 447,
          "y": 199
        }
      }
    note: false
  "3":
    id: "3"
    taskid: a3af1124-c93a-4418-82b5-a04e68ed0390
    type: title
    task:
      id: a3af1124-c93a-4418-82b5-a04e68ed0390
      version: -1
      name: Test Playbook McAfee ATD
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 447,
          "y": 48
        }
      }
    note: false
  "4":
    id: "4"
    taskid: 205d1e49-816d-4cb2-8d5a-9b38a901ffcf
    type: condition
    task:
      id: 205d1e49-816d-4cb2-8d5a-9b38a901ffcf
      version: -1
      name: atd-login AreValuesEqual
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, no is returned.
      scriptName: AreValuesEqual
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "5"
    scriptarguments:
      left:
        simple: ${ATD.Session.UserId}
      right:
        simple: "1"
    results:
    - AreValuesEqual
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 447,
          "y": 551
        }
      }
    note: false
  "5":
    id: "5"
    taskid: a325df6f-a81b-4977-86c5-6240758b6f1b
    type: regular
    task:
      id: a325df6f-a81b-4977-86c5-6240758b6f1b
      version: -1
      name: atd-list-user
      description: ' displays the user profile information present on the McAfee Advanced
        Threat Defense.'
      script: McAfee Advanced Threat Defense|||atd-list-user
      type: regular
      iscommand: true
      brand: McAfee Advanced Threat Defense
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      userType: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 447,
          "y": 731
        }
      }
    note: false
  "6":
    id: "6"
    taskid: e7b0d713-fe33-4e8f-8031-deb06d75059e
    type: condition
    task:
      id: e7b0d713-fe33-4e8f-8031-deb06d75059e
      version: -1
      name: AreValuesEqual
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, no is returned.
      scriptName: AreValuesEqual
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "7"
    scriptarguments:
      left:
        complex:
          root: ATD
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: ATD.Users.FullName
                iscontext: true
              right:
                value:
                  simple: dxl
          accessor: Users.FullName
      right:
        simple: dxl
    results:
    - AreValuesEqual
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 447,
          "y": 911
        }
      }
    note: false
  "7":
    id: "7"
    taskid: e9c304e9-6d55-4b55-8de3-28ac89b12028
    type: regular
    task:
      id: e9c304e9-6d55-4b55-8de3-28ac89b12028
      version: -1
      name: atd-list-analyzer-profiles
      description: ' display the analyzer profiles. Only the analyzer profiles to
        which the user has access are displayed.'
      script: McAfee Advanced Threat Defense|||atd-list-analyzer-profiles
      type: regular
      iscommand: true
      brand: McAfee Advanced Threat Defense
    nexttasks:
      '#none#':
      - "8"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 447,
          "y": 1091
        }
      }
    note: false
  "8":
    id: "8"
    taskid: 716b76f9-2b49-44bd-8ac8-6747c1e38f51
    type: condition
    task:
      id: 716b76f9-2b49-44bd-8ac8-6747c1e38f51
      version: -1
      name: Exists
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      scriptName: Exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "10"
    scriptarguments:
      value:
        simple: ${ATD.ListAnalyzerProfiles}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 447,
          "y": 1271
        }
      }
    note: false
  "9":
    id: "9"
    taskid: 5516d48e-86d5-4e8a-81cd-e8f0638a3602
    type: regular
    task:
      id: 5516d48e-86d5-4e8a-81cd-e8f0638a3602
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 447,
          "y": 2301
        }
      }
    note: false
  "10":
    id: "10"
    taskid: 8f121db1-dd42-4ab3-8bcb-3d6d0949c63a
    type: regular
    task:
      id: 8f121db1-dd42-4ab3-8bcb-3d6d0949c63a
      version: -1
      name: detonate-url
      description: Detonate URL through McAfee ATD
      script: McAfee Advanced Threat Defense|||detonate-url
      type: regular
      iscommand: true
      brand: McAfee Advanced Threat Defense
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      format:
        simple: json
      threshold: {}
      timeout: {}
      url:
        simple: https://demisto.com
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 447,
          "y": 1527
        }
      }
    note: false
  "11":
    id: "11"
    taskid: 8af01ba9-663c-4562-8d74-81df87f5940f
    type: condition
    task:
      id: 8af01ba9-663c-4562-8d74-81df87f5940f
      version: -1
      name: AreValuesEqual
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, no is returned.
      scriptName: AreValuesEqual
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "12"
    scriptarguments:
      left:
        simple: ${ATD.Task.url}
      right:
        simple: https://demisto.com
    results:
    - AreValuesEqual
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 447,
          "y": 1707
        }
      }
    note: false
  "12":
    id: "12"
    taskid: 75d0f8db-ba3e-417a-8176-1ab5f64b571b
    type: regular
    task:
      id: 75d0f8db-ba3e-417a-8176-1ab5f64b571b
      version: -1
      name: FileCreateAndUpload
      description: |
        Will create a file (using the given data input or entry ID) and upload it to current investigation war room.
      scriptName: FileCreateAndUpload
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      data:
        simple: qwerty
      entryId: {}
      filename:
        simple: test_file
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 447,
          "y": 1927
        }
      }
    note: false
  "13":
    id: "13"
    taskid: 6a8ca3ec-906d-4c8f-8003-6ef6ab7e5d01
    type: regular
    task:
      id: 6a8ca3ec-906d-4c8f-8003-6ef6ab7e5d01
      version: -1
      name: detonate-file
      description: Detonate file through McAfee ATD
      script: McAfee Advanced Threat Defense|||detonate-file
      type: regular
      iscommand: true
      brand: McAfee Advanced Threat Defense
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      fileName: {}
      format: {}
      threshold: {}
      timeout: {}
      upload:
        simple: ${File.EntryID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 447,
          "y": 2107
        }
      }
    note: false
  "14":
    id: "14"
    taskid: eb1afe30-f813-4af2-839b-06f93377646a
    type: playbook
    task:
      id: eb1afe30-f813-4af2-839b-06f93377646a
      version: -1
      name: McAfee ATD Detonate File
      playbookName: McAfee ATD Detonate File
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      EntryID:
        simple: ${File.EntryID}
      interval:
        simple: "1"
      timeout:
        simple: "15"
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
    view: |-
      {
        "position": {
          "x": 450,
          "y": 3195
        }
      }
    note: false
  "15":
    id: "15"
    taskid: 0fa7a0de-e06d-4d30-80fe-7d28eea3ba34
    type: playbook
    task:
      id: 0fa7a0de-e06d-4d30-80fe-7d28eea3ba34
      version: -1
      name: McAfee ATD Detonate URL
      playbookName: McAfee ATD Detonate URL
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      URL:
        simple: https://www.demisto.com
      interval:
        simple: "1"
      timeout:
        simple: "15"
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
    view: |-
      {
        "position": {
          "x": 445,
          "y": 2516
        }
      }
    note: false
  "16":
    id: "16"
    taskid: 5489b7a2-8d1a-4374-8dcf-3652312cb337
    type: regular
    task:
      id: 5489b7a2-8d1a-4374-8dcf-3652312cb337
      version: -1
      name: FileCreateAndUpload
      description: |
        Will create a file (using the given data input or entry ID) and upload it to current investigation war room.
      scriptName: FileCreateAndUpload
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      data:
        simple: dancingqueen
      entryId: {}
      filename:
        simple: abba
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 2972
        }
      }
    note: false
  "17":
    id: "17"
    taskid: fc39a322-b385-402e-89e5-6716c5d470a2
    type: regular
    task:
      id: fc39a322-b385-402e-89e5-6716c5d470a2
      version: -1
      name: DeleteContext
      description: Delete all fields from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
      keysToKeep: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 2722
        }
      }
    note: false
  "18":
    id: "18"
    taskid: bc5c47ef-2c4c-4b43-8b17-229aaf55bb8d
    type: regular
    task:
      id: bc5c47ef-2c4c-4b43-8b17-229aaf55bb8d
      version: -1
      name: DeleteContext
      description: Delete all fields from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      all:
        simple: "yes"
      key: {}
      keysToKeep: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 447,
          "y": 3420
        }
      }
    note: false
view: |-
  {
    "linkLabelsPosition": {
      "11_12_yes": 0.89
    },
    "paper": {
      "dimensions": {
        "height": 3610,
        "width": 385,
        "x": 445,
        "y": -95
      }
    }
  }
inputs: []
outputs: []
