commonfields:
  id: 722fe2ef-982a-49cc-8855-3735f9dd3b2c
  version: 18
name: VerifyTableToMarkDown
script: |-
  var simpleData = '{'+
      '"key": "value"' +
  '}';
  var hrSimple = "### Simple\nkey|\n-|\nvalue|\n";

  var dataWithEscapeCharacters = '{'+
      '"key1": "value1\\r\\nvalue1",'+
      '"key2": "value2\\nvalue2",'+
      '"key3": "value3\\rvalue3"'+
  '}';
  var hrWithEscapeCharacters = "### Escape\nkey1|key2|key3\n-|-|-\nvalue1<br>value1|value2<br>value2|value3<br>value3\n";

  var dataContainingDotHeaders = '{'+
      '"key.key": "dot header"'+
  '}';
  var hrContainingDotHeaders = "### Dot\nkey.key|\n-|\ndot header|\n";

  var dataWithNestedObject = '{'+
      '"x" : {"y": 1}'+
  '}';
  var hrWithNestedObject = "### Nested\nx|\n-|\n\\{\"y\":1\\}|\n";
  var hrWithNestedObjectAfterFlat = "### Nested\nx.y|\n-|\n1|\n";


  var h = tableToMarkdown("Simple", JSON.parse(simpleData))
  if ( h!== hrSimple) {
      throw "Simple Data failed to be converted to RIGHT Human Redable fotmat. Got: " + h;
  }

  h = tableToMarkdown("Escape", JSON.parse(dataWithEscapeCharacters))
  if(h !== hrWithEscapeCharacters){
          throw "Data with escape characters failed to be converted to RIGHT Human Redable fotmat. Got: " + h;
  }

  h = tableToMarkdown("Dot", JSON.parse(dataContainingDotHeaders))
  if(h !== hrContainingDotHeaders){
          throw "Data with dot header failed to be converted to RIGHT Human Redable fotmat. Got: " + h;
  }

  h = tableToMarkdown("Nested", JSON.parse(dataWithNestedObject));
  if(h !== hrWithNestedObject){
          throw "Data with nested object(w/o flatten) failed to be converted to RIGHT Human Redable fotmat. Got: " + h;
  }

  h = tableToMarkdown("Nested", treeToFlattenObject(JSON.parse(dataWithNestedObject)))
  if(h !== hrWithNestedObjectAfterFlat){
          throw "Data with nested object(w/ flatten) failed to be converted to RIGHT Human Redable fotmat. Got: " + h;
  }

  return true;
type: javascript
tags: []
enabled: true
scripttarget: 0
