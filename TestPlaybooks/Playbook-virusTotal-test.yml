id: virusTotal-test-playbook
version: -1
name: virusTotal-test-playbook
description: |
  Test playbook for vt.

  vt has a quota of requests per minute that we exceed in the test playbook.

  Sleep for 60 seconds.

  https://support.virustotal.com/hc/en-us/articles/115002118525-The-4-requests-minute-limitation-of-the-Public-API-is-too-low-for-me-how-can-I-have-access-to-a-higher-quota-
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: f3c467ae-dafa-4562-8487-ae4fea70f8dd
    type: start
    task:
      id: f3c467ae-dafa-4562-8487-ae4fea70f8dd
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
    note: false
  "1":
    id: "1"
    taskid: 0170c6e0-9a24-4ec8-85a7-080112cbff1f
    type: regular
    task:
      id: 0170c6e0-9a24-4ec8-85a7-080112cbff1f
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
      keysToKeep: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 195
        }
      }
    note: false
  "2":
    id: "2"
    taskid: 5103980e-f7a0-4c07-884f-912205789645
    type: regular
    task:
      id: 5103980e-f7a0-4c07-884f-912205789645
      version: -1
      name: ip
      description: Check IP Reputation
      script: VirusTotal|||ip
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      ip:
        simple: 8.8.8.8
      long: {}
      retries: {}
      sampleSize: {}
      threshold: {}
      wait: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 555
        }
      }
    note: false
  "3":
    id: "3"
    taskid: 9c21e490-9285-4092-839d-ae73ede2bf6f
    type: regular
    task:
      id: 9c21e490-9285-4092-839d-ae73ede2bf6f
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      expectedValue:
        simple: 8.8.8.8
      fields: {}
      path:
        simple: DBotScore.Indicator
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 730
        }
      }
    note: false
  "4":
    id: "4"
    taskid: 794c3055-29d8-4531-83b1-a26924d8c691
    type: regular
    task:
      id: 794c3055-29d8-4531-83b1-a26924d8c691
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
      keysToKeep: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 905
        }
      }
    note: false
  "5":
    id: "5"
    taskid: 2f38f9fb-56b0-41d1-8219-bae4c31d9267
    type: regular
    task:
      id: 2f38f9fb-56b0-41d1-8219-bae4c31d9267
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      expectedValue:
        simple: demisto.com
      fields: {}
      path:
        simple: DBotScore.Indicator
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1255
        }
      }
    note: false
  "6":
    id: "6"
    taskid: 5899d1ca-b555-44dd-8a0e-9466c58f9524
    type: regular
    task:
      id: 5899d1ca-b555-44dd-8a0e-9466c58f9524
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "26"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
      keysToKeep: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1430
        }
      }
    note: false
  "7":
    id: "7"
    taskid: a54293ff-3883-4e47-8fd1-c96cdb9f9065
    type: regular
    task:
      id: a54293ff-3883-4e47-8fd1-c96cdb9f9065
      version: -1
      name: domain
      description: Check domain reputation
      script: VirusTotal|||domain
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      domain:
        simple: demisto.com
      fullResponse: {}
      long: {}
      retries: {}
      sampleSize: {}
      threshold: {}
      wait: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1080
        }
      }
    note: false
  "8":
    id: "8"
    taskid: 4ad0ce45-dfc0-498b-8268-379442e36223
    type: regular
    task:
      id: 4ad0ce45-dfc0-498b-8268-379442e36223
      version: -1
      name: file
      description: Check file reputation of the given hash
      script: VirusTotal|||file
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      file:
        simple: 7657fcb7d772448a6d8504e4b20168b8
      long: {}
      retries: {}
      threshold: {}
      wait: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1800
        }
      }
    note: false
  "9":
    id: "9"
    taskid: 6e7b6550-29cb-4243-812b-a69aa2616c88
    type: regular
    task:
      id: 6e7b6550-29cb-4243-812b-a69aa2616c88
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      expectedValue:
        simple: 7657fcb7d772448a6d8504e4b20168b8
      fields: {}
      path:
        simple: File.MD5
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1980
        }
      }
    note: false
  "10":
    id: "10"
    taskid: 653d3c0c-8b73-40e2-89d1-84b86141d5ca
    type: regular
    task:
      id: 653d3c0c-8b73-40e2-89d1-84b86141d5ca
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
      keysToKeep: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2170
        }
      }
    note: false
  "14":
    id: "14"
    taskid: 52781f75-882a-49b9-8ed2-d51e1596c2b0
    type: regular
    task:
      id: 52781f75-882a-49b9-8ed2-d51e1596c2b0
      version: -1
      name: url
      description: Check URL Reputation
      script: VirusTotal|||url
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      long: {}
      retries: {}
      sampleSize: {}
      submitWait: {}
      threshold: {}
      url:
        simple: www.demisto.com
      wait: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 5715
        }
      }
    note: false
  "15":
    id: "15"
    taskid: 3022e73d-b7ee-4a08-84e0-30d596a2ef35
    type: regular
    task:
      id: 3022e73d-b7ee-4a08-84e0-30d596a2ef35
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      expectedValue:
        simple: www.demisto.com
      fields: {}
      path:
        simple: DBotScore.Indicator
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 5900
        }
      }
    note: false
  "16":
    id: "16"
    taskid: d36a7b99-a127-4912-8506-00da3acd70f5
    type: regular
    task:
      id: d36a7b99-a127-4912-8506-00da3acd70f5
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "46"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
      keysToKeep: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 6065
        }
      }
    note: false
  "17":
    id: "17"
    taskid: 4144b077-7d4b-476a-889e-fdc45f5346c0
    type: regular
    task:
      id: 4144b077-7d4b-476a-889e-fdc45f5346c0
      version: -1
      name: Sleep
      description: |
        vt has a quota of requests per minute that we exceed in the test playbook.

        Sleep for 60 seconds.

        https://support.virustotal.com/hc/en-us/articles/115002118525-The-4-requests-minute-limitation-of-the-Public-API-is-too-low-for-me-how-can-I-have-access-to-a-higher-quota-
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      seconds:
        simple: "60"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 4040
        }
      }
    note: false
  "18":
    id: "18"
    taskid: c1e629c9-d8f5-4696-8ca4-efe9b2d85663
    type: regular
    task:
      id: c1e629c9-d8f5-4696-8ca4-efe9b2d85663
      version: -1
      name: Sleep
      description: |
        vt has a quota of requests per minute that we exceed in the test playbook.

        Sleep for 60 seconds.

        https://support.virustotal.com/hc/en-us/articles/115002118525-The-4-requests-minute-limitation-of-the-Public-API-is-too-low-for-me-how-can-I-have-access-to-a-higher-quota-
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      seconds:
        simple: "61"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 370
        }
      }
    note: false
  "19":
    id: "19"
    taskid: 9593d3aa-cf74-46ce-85c1-09d1e14819db
    type: regular
    task:
      id: 9593d3aa-cf74-46ce-85c1-09d1e14819db
      version: -1
      name: Sleep
      description: |
        vt has a quota of requests per minute that we exceed in the test playbook.

        Sleep for 60 seconds.

        https://support.virustotal.com/hc/en-us/articles/115002118525-The-4-requests-minute-limitation-of-the-Public-API-is-too-low-for-me-how-can-I-have-access-to-a-higher-quota-
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      seconds:
        simple: "60"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2900
        }
      }
    note: false
  "20":
    id: "20"
    taskid: 62b4629c-fe56-4af7-80bc-c4399d6a0713
    type: regular
    task:
      id: 62b4629c-fe56-4af7-80bc-c4399d6a0713
      version: -1
      name: file
      description: Check file reputation of the given hash
      script: VirusTotal|||file
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "21"
    scriptarguments:
      file:
        simple: d41d8cd98f00b204e9800998ecf8427e
      long: {}
      retries: {}
      threshold: {}
      wait: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3070
        }
      }
    note: false
  "21":
    id: "21"
    taskid: 8dc2e1de-98f2-44bc-8e85-53d8367f991c
    type: regular
    task:
      id: 8dc2e1de-98f2-44bc-8e85-53d8367f991c
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      expectedValue:
        simple: d41d8cd98f00b204e9800998ecf8427e
      fields: {}
      path:
        simple: File.MD5
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 3250
        }
      }
    note: false
  "22":
    id: "22"
    taskid: 60838847-6822-4884-801b-8d69829b319e
    type: regular
    task:
      id: 60838847-6822-4884-801b-8d69829b319e
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
      keysToKeep: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 3415
        }
      }
    note: false
  "23":
    id: "23"
    taskid: d635a8b1-0404-40d5-8360-01c88ded65f5
    type: regular
    task:
      id: d635a8b1-0404-40d5-8360-01c88ded65f5
      version: -1
      name: file
      description: Check file reputation of the given hash
      script: VirusTotal|||file
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "25"
    scriptarguments:
      file:
        simple: d41d8cd98f00b204e9800998ecf8427e
      long:
        simple: "true"
      retries: {}
      threshold: {}
      wait: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 3570
        }
      }
    note: false
  "24":
    id: "24"
    taskid: 255060b2-8ce1-4545-8fde-6d19e8eedbf2
    type: regular
    task:
      id: 255060b2-8ce1-4545-8fde-6d19e8eedbf2
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
      keysToKeep: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 3890
        }
      }
    note: false
  "25":
    id: "25"
    taskid: 29b8c789-e030-4bfe-89c7-235b61e5b958
    type: regular
    task:
      id: 29b8c789-e030-4bfe-89c7-235b61e5b958
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "24"
    scriptarguments:
      expectedValue:
        simple: d41d8cd98f00b204e9800998ecf8427e
      fields: {}
      path:
        simple: File.MD5
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 3730
        }
      }
    note: false
  "26":
    id: "26"
    taskid: 1a78e0a8-cf81-42b7-8761-da7f979bf136
    type: regular
    task:
      id: 1a78e0a8-cf81-42b7-8761-da7f979bf136
      version: -1
      name: Sleep
      description: |
        vt has a quota of requests per minute that we exceed in the test playbook.

        Sleep for 60 seconds.

        https://support.virustotal.com/hc/en-us/articles/115002118525-The-4-requests-minute-limitation-of-the-Public-API-is-too-low-for-me-how-can-I-have-access-to-a-higher-quota-
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      seconds:
        simple: "60"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1590
        }
      }
    note: false
  "27":
    id: "27"
    taskid: 348b033a-6f76-49cd-8f50-c66759f33fa8
    type: regular
    task:
      id: 348b033a-6f76-49cd-8f50-c66759f33fa8
      version: -1
      name: file
      description: Check file reputation of the given hash
      script: VirusTotal|||file
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "28"
    scriptarguments:
      file:
        simple: 7657fcb7d772448a6d8504e4b20168b8
      long:
        simple: "true"
      retries: {}
      threshold: {}
      wait: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2350
        }
      }
    note: false
  "28":
    id: "28"
    taskid: 5989c57a-27c5-4ad5-892b-44b3313d3590
    type: regular
    task:
      id: 5989c57a-27c5-4ad5-892b-44b3313d3590
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      expectedValue:
        simple: 7657fcb7d772448a6d8504e4b20168b8
      fields: {}
      path:
        simple: File.MD5
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2510
        }
      }
    note: false
  "29":
    id: "29"
    taskid: 5088b82b-b45c-42e4-809b-a71fb271788b
    type: regular
    task:
      id: 5088b82b-b45c-42e4-809b-a71fb271788b
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
      keysToKeep: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2695
        }
      }
    note: false
  "30":
    id: "30"
    taskid: 36ee28c5-e342-4eff-8dac-92165e7a3b3b
    type: regular
    task:
      id: 36ee28c5-e342-4eff-8dac-92165e7a3b3b
      version: -1
      name: url
      description: Check URL Reputation
      script: VirusTotal|||url
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      long: {}
      retries: {}
      sampleSize: {}
      submitWait: {}
      threshold:
        simple: "0"
      url:
        simple: http://coffeedoesgood.com
      wait: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 4230
        }
      }
    note: false
  "31":
    id: "31"
    taskid: 3e38651c-6c0e-4d80-848a-f3bb6b89227d
    type: regular
    task:
      id: 3e38651c-6c0e-4d80-848a-f3bb6b89227d
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      expectedValue:
        simple: http://coffeedoesgood.com
      fields: {}
      path:
        simple: DBotScore.Indicator
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 4390
        }
      }
    note: false
  "32":
    id: "32"
    taskid: 3992aef6-74e9-40d3-8496-ae9ab5cd5780
    type: regular
    task:
      id: 3992aef6-74e9-40d3-8496-ae9ab5cd5780
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "33"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
      keysToKeep: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 4550
        }
      }
    note: false
  "33":
    id: "33"
    taskid: 893241ac-4bea-40ab-8f1e-170fd25bebf7
    type: regular
    task:
      id: 893241ac-4bea-40ab-8f1e-170fd25bebf7
      version: -1
      name: url
      description: Check URL Reputation
      script: VirusTotal|||url
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      long:
        simple: "true"
      retries: {}
      sampleSize: {}
      submitWait: {}
      threshold:
        simple: "0"
      url:
        simple: http://coffeedoesgood.com
      wait: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 4720
        }
      }
    note: false
  "34":
    id: "34"
    taskid: 617f7ec2-8681-4603-8da8-17edcbfdadec
    type: regular
    task:
      id: 617f7ec2-8681-4603-8da8-17edcbfdadec
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "35"
    scriptarguments:
      expectedValue:
        simple: http://coffeedoesgood.com
      fields: {}
      path:
        simple: DBotScore.Indicator
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 4880
        }
      }
    note: false
  "35":
    id: "35"
    taskid: 25108a2a-3e5f-4730-8718-4506bcdd7324
    type: regular
    task:
      id: 25108a2a-3e5f-4730-8718-4506bcdd7324
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
      keysToKeep: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 5040
        }
      }
    note: false
  "36":
    id: "36"
    taskid: 397abaf6-4d79-439c-8ca3-683f7592b8fa
    type: regular
    task:
      id: 397abaf6-4d79-439c-8ca3-683f7592b8fa
      version: -1
      name: url
      description: Check URL Reputation
      script: VirusTotal|||url
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "37"
    scriptarguments:
      long:
        simple: "true"
      retries: {}
      sampleSize: {}
      submitWait: {}
      threshold: {}
      url:
        simple: www.demisto.com
      wait: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 5215
        }
      }
    note: false
  "37":
    id: "37"
    taskid: 1a70cb25-36d8-42c3-82bd-a5a1b7f72718
    type: regular
    task:
      id: 1a70cb25-36d8-42c3-82bd-a5a1b7f72718
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "38"
    scriptarguments:
      expectedValue:
        simple: www.demisto.com
      fields: {}
      path:
        simple: DBotScore.Indicator
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 5360
        }
      }
    note: false
  "38":
    id: "38"
    taskid: f53040f5-03d6-46c4-84ad-b9addcead546
    type: regular
    task:
      id: f53040f5-03d6-46c4-84ad-b9addcead546
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
      keysToKeep: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 5530
        }
      }
    note: false
  "39":
    id: "39"
    taskid: bf96674a-d492-44c1-8438-9f475cf6f2e7
    type: regular
    task:
      id: bf96674a-d492-44c1-8438-9f475cf6f2e7
      version: -1
      name: ip
      description: Check IP Reputation
      script: VirusTotal|||ip
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "40"
    scriptarguments:
      fullResponse: {}
      ip:
        simple: 8.8.8.8
      long: {}
      retries: {}
      sampleSize: {}
      threshold:
        simple: "0"
      wait: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 6365
        }
      }
    note: false
  "40":
    id: "40"
    taskid: a3452d07-29ce-4946-80e2-71b5ecd177ea
    type: regular
    task:
      id: a3452d07-29ce-4946-80e2-71b5ecd177ea
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "41"
    scriptarguments:
      expectedValue:
        simple: 8.8.8.8
      fields: {}
      path:
        simple: DBotScore.Indicator
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 6530
        }
      }
    note: false
  "41":
    id: "41"
    taskid: e5d2f68b-1d42-4a72-80c4-e9056367d22d
    type: regular
    task:
      id: e5d2f68b-1d42-4a72-80c4-e9056367d22d
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "42"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
      keysToKeep: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 6705
        }
      }
    note: false
  "42":
    id: "42"
    taskid: c33da2eb-fb44-42d5-8bbd-233e5a9ef7a1
    type: regular
    task:
      id: c33da2eb-fb44-42d5-8bbd-233e5a9ef7a1
      version: -1
      name: domain
      description: Check domain reputation
      script: VirusTotal|||domain
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "43"
    scriptarguments:
      domain:
        simple: demisto.com
      fullResponse: {}
      long: {}
      retries: {}
      sampleSize: {}
      threshold:
        simple: "0"
      wait: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 6880
        }
      }
    note: false
  "43":
    id: "43"
    taskid: 432015fb-fabd-4ee5-8638-960d4c322096
    type: regular
    task:
      id: 432015fb-fabd-4ee5-8638-960d4c322096
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "44"
    scriptarguments:
      expectedValue:
        simple: demisto.com
      fields: {}
      path:
        simple: DBotScore.Indicator
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 30,
          "y": 7055
        }
      }
    note: false
  "44":
    id: "44"
    taskid: e5d35c0f-0fd6-4d71-8208-ad5f36d929f8
    type: regular
    task:
      id: e5d35c0f-0fd6-4d71-8208-ad5f36d929f8
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "45"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
      keysToKeep: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 20,
          "y": 7220
        }
      }
    note: false
  "45":
    id: "45"
    taskid: 9354cb25-cebb-4e98-8058-cfc2d32d4f26
    type: regular
    task:
      id: 9354cb25-cebb-4e98-8058-cfc2d32d4f26
      version: -1
      name: Sleep
      description: |
        vt has a quota of requests per minute that we exceed in the test playbook.

        Sleep for 60 seconds.

        https://support.virustotal.com/hc/en-us/articles/115002118525-The-4-requests-minute-limitation-of-the-Public-API-is-too-low-for-me-how-can-I-have-access-to-a-higher-quota-
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "47"
    scriptarguments:
      seconds:
        simple: "60"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 20,
          "y": 7390
        }
      }
    note: false
  "46":
    id: "46"
    taskid: cf2485e8-53ab-4f3f-8584-30e2c5bc0a26
    type: regular
    task:
      id: cf2485e8-53ab-4f3f-8584-30e2c5bc0a26
      version: -1
      name: Sleep
      description: |
        vt has a quota of requests per minute that we exceed in the test playbook.

        Sleep for 60 seconds.

        https://support.virustotal.com/hc/en-us/articles/115002118525-The-4-requests-minute-limitation-of-the-Public-API-is-too-low-for-me-how-can-I-have-access-to-a-higher-quota-
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "39"
    scriptarguments:
      seconds:
        simple: "60"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 6215
        }
      }
    note: false
  "47":
    id: "47"
    taskid: 930ba5a0-67db-43ab-8b58-70ebd4bb12fe
    type: regular
    task:
      id: 930ba5a0-67db-43ab-8b58-70ebd4bb12fe
      version: -1
      name: url
      description: Check URL Reputation
      script: VirusTotal|||url
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "48"
    scriptarguments:
      long:
        simple: "true"
      retries: {}
      sampleSize: {}
      submitWait: {}
      threshold: {}
      url:
        simple: www.demisto.com
      wait: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 20,
          "y": 7560
        }
      }
    note: false
  "48":
    id: "48"
    taskid: e59f970a-0f13-45c7-87cb-476d949c35d9
    type: regular
    task:
      id: e59f970a-0f13-45c7-87cb-476d949c35d9
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "49"
    scriptarguments:
      expectedValue:
        simple: www.demisto.com
      fields: {}
      path:
        simple: DBotScore.Indicator
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 20,
          "y": 7750
        }
      }
    note: false
  "49":
    id: "49"
    taskid: 28684509-01f9-4c50-8b5a-24d26f63bc21
    type: regular
    task:
      id: 28684509-01f9-4c50-8b5a-24d26f63bc21
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      all:
        simple: "yes"
      key: {}
      keysToKeep: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 20,
          "y": 7915
        }
      }
    note: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 7960,
        "width": 410,
        "x": 20,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
